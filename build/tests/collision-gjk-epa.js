(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.Collisiongjkepa = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
'use strict';

/**
 * Class to help in the collision in 2D and 3D.
 * To works the algorithm needs two convexe point cloud
 * like bounding box or smthg like this.
 * The function functions intersect and isIntersecting
 * helps to have informations about the collision between two object.
 *
 * @class wnp.helpers.CollisionGjkEpa
 * @constructor
 */
var Triangle = function(a, b, c) {
      this.a = a;
      this.b = b;
      this.c = c;
      this.n = a.constructor.Cross(b.subtract(a), c.subtract(a)).normalize();
  };


var CollisionGjkEpa = {

    EPSILON: 0.000001,

    /**
     * Method to get a normal of 3 points in 2D and 3D.
     *
     * @method _getNormal
     * @private
     * @param {BABYLON.Vector2|BABYLON.Vector3} a
     * @param {BABYLON.Vector2|BABYLON.Vector3} b
     * @param {BABYLON.Vector2|BABYLON.Vector3} c
     * @return {BABYLON.Vector2|BABYLON.Vector3} The normal.
     */
    _getNormal: function(a, b, c) {
        var Dot = a.constructor.Dot;
        var ac = Dot(a, c); // perform aDot(c)
        var bc = Dot(b, c); // perform bDot(c)

        // perform b * a.Dot(c) - a * b.Dot(c)
        var r = b.scale(ac).subtract(a.scale(bc)).normalize();
        return r;
    },

    /**
     * Gets the barycenter of a cloud points.
     *
     * @method _getBarycenter
     * @private
     * @param {BABYLON.Vector2|BABYLON.Vector3[]} vertices the cloud points
     * @return {BABYLON.Vector2|BABYLON.Vector3} The barycenter.
     */
    _getBarycenter: function(vertices) {
        var avg = vertices[0].constructor.Zero();
        for (var i = 0; i < vertices.length; i++) {
            avg.addToRef(vertices[i], avg);
        }
        avg.scaleInPlace(1 / vertices.length, avg);
        return avg;
    },

    /**
     * Gets the farthest point of a cloud points.
     *
     * @method _getFarthestPointInDirection
     * @private
     * @param {BABYLON.Vector2|BABYLON.Vector3[]} vertices the cloud points.
     * @param {BABYLON.Vector2|BABYLON.Vector3} d The direction to search.
     * @return {BABYLON.Vector2|BABYLON.Vector3} The barycenter.
     */
    _getFarthestPointInDirection: function(vertices, d) {
        var Dot = vertices[0].constructor.Dot;
        var maxProduct = Dot(vertices[0], d);
        var index = 0;
        for (var i = 1; i < vertices.length; i++) {
            var product = Dot(vertices[i], d);
            if (product > maxProduct) {
                maxProduct = product;
                index = i;
            }
        }
        return vertices[index];
    },

    /**
     * Gets the nearest edge of the simplex.
     *
     * @method _getNearestEdge
     * @private
     * @param {BABYLON.Vector2|BABYLON.Vector3[]} simplex The simplex.
     * @return {Object} Informations about the nearest edge (distance, index and normal).
     */
    _getNearestEdge: function(simplex) {
        var distance = Infinity,
            index, normal;

        for (var i = 0; i < simplex.length; i++) {
            var j = (i + 1) % simplex.length;
            var v1 = simplex[i];
            var v2 = simplex[j];

            var edge = v2.subtract(v1);
            if (edge.lengthSquared() === 0) {
                continue;
            }

            var originTov1 = v1;

            var n = this._getNormal(edge, originTov1, edge);

            if (n.lengthSquared() === 0) {
                n.y = -edge.x;
                n.x = edge.y;
            }

            //n = n.scale(1 / n.length()); //normalize
            var dist = Math.abs(n.constructor.Dot(n, v1)); //distance from origin to edge

            if (dist < distance) {
                distance = dist;
                index = j;
                normal = n;
            }
        }

        return {
            distance: distance,
            index: index,
            normal: normal
        };

    },

    /**
     * Gets the nearest Triangle of the polytope.
     *
     * @method _getNearestTriangle
     * @private
     * @param {BABYLON.Triangle[]} polytope The polytope.
     * @return {Object} Informations about the nearest edge (distance and index).
     */
    _getNearestTriangle: function(polytope) {
        var distance = Infinity,
            index;

        for (var i = 0; i < polytope.length; i++) {

            var triangle = polytope[i];
            var dist = Math.abs(triangle.n.constructor.Dot(triangle.n, triangle.a));

            if (dist < distance) {
                distance = dist;
                index = i;
            }

        }

        return {
            distance: distance,
            index: index
        };
    },

    /**
     * Checks if the origin is in a line.
     *
     * @method _containsLine
     * @private
     * @param {BABYLON.Vector2|BABYLON.Vector3[]} simplex The simplex.
     * @param {BABYLON.Vector2|BABYLON.Vector3} dir The direction.
     * @return {Boolean} False in any case because the algorithm just begin.
     */
    _containsLine: function(simplex, dir) {
        var a = simplex[1];
        var b = simplex[0];
        var ab = b.subtract(a);
        var ao = a.scale(-1);
        if (ab.lengthSquared() !== 0) {
            dir.copyFrom(this._getNormal(ab, ao, ab));
        } else {
            dir.copyFrom(ao);
        }

        return false;
    },

    /**
     * Checks if the origin is in a triangle.
     *
     * @method _containsTriangle
     * @private
     * @param {BABYLON.Vector2|BABYLON.Vector3[]} simplex The simplex.
     * @param {BABYLON.Vector2|BABYLON.Vector3} dir The direction.
     * @return {Boolean} If in 2D case, may return true if the origin is in the triangle.
     */
    _containsTriangle: function(simplex, dir) {
        var a = simplex[2];
        var Dot = simplex[2].constructor.Dot;
        var b = simplex[1];
        var c = simplex[0];
        var ab = b.subtract(a);
        var ac = c.subtract(a);
        var ao = a.scale(-1);

        var abp = this._getNormal(ac, ab, ab);
        var acp = this._getNormal(ab, ac, ac);
        if (Dot(abp, ao) > 0) {
            simplex.splice(0, 1); // remove C
            dir.copyFrom(abp);
        } else if (Dot(acp, ao) > 0) {
            simplex.splice(1, 1); // remove B
            dir.copyFrom(acp);
        } else {
            if (dir.z === undefined) {
                return true;
            } else {
                var abc = simplex[2].constructor.Cross(ab, ac);
                dir.copyFrom(abc);
                if (Dot(abc, ao) <= 0) {
                    //upside down tetrahedron
                    simplex[0] = b;
                    simplex[1] = c;
                    simplex[2] = a;
                    dir.copyFrom(abc.scale(-1));
                }

                return false;
            }
        }
    },

    /**
     * Checks if the origin is in a tetrahedron.
     *
     * @method _containsTetrahedron
     * @private
     * @param {BABYLON.Vector2|BABYLON.Vector3[]} simplex The simplex.
     * @param {BABYLON.Vector2|BABYLON.Vector3} dir The direction.
     * @return {Boolean} Return true if the origin is in the tetrahedron.
     */
    _containsTetrahedron: function(simplex, dir) {
        var a = simplex[3];
        var Dot = a.constructor.Dot;
        var Cross = a.constructor.Cross;
        var b = simplex[2];
        var c = simplex[1];
        var d = simplex[0];
        var ab = b.subtract(a);
        var ac = c.subtract(a);
        var ad = d.subtract(a);
        var ao = a.scale(-1);

        var abc = Cross(ab, ac);
        var acd = Cross(ac, ad);
        var adb = Cross(ad, ab);

        var abcTest = 0x1,
            acdTest = 0x2,
            adbTest = 0x4;

        var planeTests = (Dot(abc, ao) > 0 ? abcTest : 0) |
            (Dot(acd, ao) > 0 ? acdTest : 0) |
            (Dot(adb, ao) > 0 ? adbTest : 0);

        switch (planeTests) {
            case abcTest:
                return this._checkTetrahedron(ao, ab, ac, abc, dir, simplex);
            case acdTest:
                simplex[2] = c;
                simplex[1] = d;
                return this._checkTetrahedron(ao, ac, ad, acd, dir, simplex);
            case adbTest:
                //in front of triangle ADB
                simplex[1] = b;
                simplex[2] = d;
                return this._checkTetrahedron(ao, ad, ab, adb, dir, simplex);
            case abcTest | acdTest:
                return this._checkTwoTetrahedron(ao, ab, ac, abc, dir, simplex);
            case acdTest | adbTest:
                simplex[2] = c;
                simplex[1] = d;
                simplex[0] = b;
                return this._checkTwoTetrahedron(ao, ac, ad, acd, dir, simplex);
            case adbTest | abcTest:
                simplex[1] = b;
                simplex[2] = d;
                simplex[0] = c;
                return this._checkTwoTetrahedron(ao, ad, ab, adb, dir, simplex);
            default:
                break;
        }

        //origin in tetrahedron
        return true;
    },

    /**
     * @method _checkTwoTetrahedron
     * @private
     */
    _checkTwoTetrahedron: function(ao, ab, ac, abc, dir, simplex) {
        var abc_ac = abc.constructor.Cross(abc, ac);

        if (abc_ac.constructor.Dot(abc_ac, ao) > 0) {
            //the origin is beyond AC from ABC's
            //perspective, effectively excluding
            //ACD from consideration

            //we thus need test only ACD
            simplex[2] = simplex[1];
            simplex[1] = simplex[0];

            ab = simplex[2].subtract(simplex[3]);
            ac = simplex[1].subtract(simplex[3]);
            abc = ab.constructor.Cross(ab, ac);

            return this._checkTetrahedron(ao, ab, ac, abc, dir, simplex);
        }

        var ab_abc = abc.constructor.Cross(ab, abc);

        if (ab_abc.constructor.Dot(ab_abc, ao) > 0) {

            simplex.splice(0, 2);
            //dir is not ab_abc because it's not point towards the origin;
            //ABxA0xAB direction we are looking for
            dir.copyFrom(this._getNormal(ab, ao, ab));

            return false;
        }

    },

    /**
     * @method _checkTetrahedron
     * @private
     */
    _checkTetrahedron: function(ao, ab, ac, abc, dir, simplex) {

        var acp = abc.constructor.Cross(abc, ac);

        if (acp.constructor.Dot(acp, ao) > 0) {

            simplex[2] = simplex[3];
            simplex.splice(3, 1);
            simplex.splice(0, 1);
            //dir is not abc_ac because it's not point towards the origin;
            //ACxA0xAC direction we are looking for
            dir.copyFrom(this._getNormal(ac, ao, ac));

            return false;
        }

        //almost the same like triangle checks
        var ab_abc = ab.constructor.Cross(ab, abc);

        if (ab_abc.constructor.Dot(ab_abc, ao) > 0) {

            simplex.splice(0, 2);
            //dir is not ab_abc because it's not point towards the origin;
            //ABxA0xAB direction we are looking for
            dir.copyFrom(this._getNormal(ab, ao, ab));

            return false;
        }

        //build new tetrahedron with new base
        simplex.splice(0, 1);

        dir.copyFrom(abc);

        return false;
    },

    /**
     * Adds adge to the list and checks if the edge if not in.
     *
     * @method _addEdge
     * @private
     * @param {Object[]} edges The edges.
     * @param {Object} dir The edge to check.
     */
    _addEdge: function(edges, edge) {
        for (var j = 0; j < edges.length; j++) {
            if (edges[j].a === edge.b && edges[j].b === edge.a) {
                edges.splice(j, 1);
                return;
            }
        }
        edges.push(edge);
    },

    /**
     * The support function.
     *
     * @method support
     * @param {BABYLON.Vector2|BABYLON.Vector3[]} colliderPoints The convexe collider object.
     * @param {BABYLON.Vector2|BABYLON.Vector3[]} collidedPoints The convexe collided object.
     * @param {BABYLON.Vector2|BABYLON.Vector3} direction The direction.
     * @return {BABYLON.Vector2|BABYLON.Vector3} The support points.
     */
    support: function(colliderPoints, collidedPoints, direction) {
        // d is a vector direction (doesn't have to be normalized)
        // get points on the edge of the shapes in opposite directions
        direction.normalize();
        var p1 = this._getFarthestPointInDirection(colliderPoints, direction);
        var p2 = this._getFarthestPointInDirection(collidedPoints, direction.scale(-1));
        // perform the Minkowski Difference
        var p3 = p1.subtract(p2);
        // p3 is now a point in Minkowski space on the edge of the Minkowski Difference
        return p3;
    },

    /**
     * Checks if the simplex contains the origin.
     *
     * @method findResponseWithEdge
     * @param {BABYLON.Vector2|BABYLON.Vector3[]} simplexThe simplex or false if no intersection.
     * @param {BABYLON.Vector2|BABYLON.Vector3} dir The direction to test.
     * @return {Boolean} Contains or not.
     */
    containsOrigin: function(simplex, dir) {
        if (simplex.length === 2) {
            return this._containsLine(simplex, dir);
        }
        if (simplex.length === 3) {
            return this._containsTriangle(simplex, dir);
        }
        if (simplex.length === 4) {
            return this._containsTetrahedron(simplex, dir);
        }
        return false;
    },

    /**
     * The GJK (Gilbert–Johnson–Keerthi) algorithm.
     * Computes support points to build the Minkowsky difference and
     * create a simplex. The points of the collider and the collided object
     * must be convexe.
     *
     * @method findResponseWithEdge
     * @param {BABYLON.Vector2|BABYLON.Vector3[]} colliderPoints The convexe collider object.
     * @param {BABYLON.Vector2|BABYLON.Vector3[]} collidedPoints The convexe collided object.
     * @return {BABYLON.Vector2|BABYLON.Vector3[]} The simplex or false if no intersection.
     */
    check: function(colliderPoints, collidedPoints) {
        var it = 0;
        var a, simplex = [];

        var colliderCenter = this._getBarycenter(colliderPoints);
        var collidedCenter = this._getBarycenter(collidedPoints);

        // initial direction from the center of 1st body to the center of 2nd body
        var dir = colliderCenter.subtract(collidedCenter).normalize();

        // if initial direction is zero – set it to any arbitrary axis (we choose X)
        if (dir.lengthSquared() < this.EPSILON) {
            dir.x = 1;
        }

        // set the first support as initial point of the new simplex
        a = simplex[0] = this.support(colliderPoints, collidedPoints, dir);

        if (a.constructor.Dot(a, dir) <= 0) {
            return false;
        }

        dir.scaleInPlace(-1, dir); // we will be searching in the opposite direction next

        var max = collidedPoints.length * colliderPoints.length;
        while (it < max) {
            if (dir.lengthSquared() === 0 && simplex.length >= 2) {
                // Get perpendicular direction to last simplex
                dir = simplex[simplex.length - 1].subtract(simplex[simplex.length - 2]);
                var tmp = dir.y;
                dir.y = -dir.x;
                dir.x = tmp;
            }

            a = this.support(colliderPoints, collidedPoints, dir);

            // make sure that the last point we added actually passed the origin
            if (a.constructor.Dot(a, dir) <= 0) {
                // if the point added last was not past the origin in the direction of d
                // then the Minkowski Sum cannot possibly contain the origin since
                // the last point added is on the edge of the Minkowski Difference
                return false;
            }

            simplex.push(a);
            // otherwise we need to determine if the origin is in
            // the current simplex

            if (this.containsOrigin(simplex, dir)) {
                return simplex;
            }
            it++;
        }
    },

    /**
     * Finds the response with the simplex (edges) of the gjk algorithm.
     *
     * @method findResponseWithEdge
     * @param {BABYLON.Vector2[]} colliderPoints The convexe collider object.
     * @param {BABYLON.Vector2[]} collidedPoints The convexe collided object.
     * @param {BABYLON.Vector2[]} simplex The simplex.
     * @return {BABYLON.Vector2|BABYLON.Vector3} The penetration vector.
     */
    findResponseWithEdge: function(colliderPoints, collidedPoints, simplex) {
        var edge = this._getNearestEdge(simplex);
        var sup = this.support(colliderPoints, collidedPoints, edge.normal); //get support point in direction of edge's normal
        var d = Math.abs(sup.constructor.Dot(sup, edge.normal));

        if (d - edge.distance <= this.EPSILON) {
            return edge.normal.scale(edge.distance);
        } else {
            simplex.splice(edge.index, 0, sup);
        }
        return false;
    },

    /**
     * Finds the response with the polytope done with the simplex of the gjk algorithm.
     *
     * @method findResponseWithTriangle
     * @param {BABYLON.Vector3[]} colliderPoints The convexe collider object.
     * @param {BABYLON.Vector3[]} collidedPoints The convexe collided object.
     * @param {Triangle[]} polytope The polytope done with the simplex.
     * @return {BABYLON.Vector2|BABYLON.Vector3} The penetration vector.
     */
    findResponseWithTriangle: function(colliderPoints, collidedPoints, polytope) {

        if (polytope.length === 0) {
            return false;
        }

        var nearest = this._getNearestTriangle(polytope);
        var triangle = polytope[nearest.index];

        var sup = this.support(colliderPoints, collidedPoints, triangle.n);

        var d = Math.abs(sup.constructor.Dot(sup, triangle.n));

        if ((d - nearest.distance <= this.EPSILON)) {
            return triangle.n.scale(nearest.distance);
        } else {
            var edges = [];
            for (var i = polytope.length - 1; i >= 0; i--) {
                triangle = polytope[i];
                // can this face be 'seen' by entry_cur_support?
                if (triangle.n.constructor.Dot(triangle.n, sup.subtract(polytope[i].a)) > 0) {
                    this._addEdge(edges, {
                        a: triangle.a,
                        b: triangle.b
                    });
                    this._addEdge(edges, {
                        a: triangle.b,
                        b: triangle.c
                    });
                    this._addEdge(edges, {
                        a: triangle.c,
                        b: triangle.a
                    });
                    polytope.splice(i, 1);
                }
            }

            // create new triangles from the edges in the edge list
            for (var i = 0; i < edges.length; i++) {
                triangle = new Triangle(sup, edges[i].a, edges[i].b);
                if (triangle.n.length() !== 0) {
                    polytope.push(triangle);
                }
            }
        }

        return false;
    },

    /**
     * Gets the response of the penetration vector with the simplex.
     *
     * @method getResponse
     * @param {BABYLON.Vector2|BABYLON.Vector3[]} colliderPoints The convexe collider object.
     * @param {BABYLON.Vector2|BABYLON.Vector3[]} collidedPoints The convexe collided object.
     * @param {BABYLON.Vector2|BABYLON.Vector3[]} simplex The simplex of the Minkowsky difference.
     * @return {BABYLON.Vector2|BABYLON.Vector3} The penetration vector.
     */
    getResponse: function(colliderPoints, collidedPoints, simplex) {
        var it = 0,
            response;
        var polytope = simplex[0].z !== undefined ? [new Triangle(simplex[0], simplex[1], simplex[2]),
            new Triangle(simplex[0], simplex[2], simplex[3]),
            new Triangle(simplex[0], simplex[3], simplex[1]),
            new Triangle(simplex[1], simplex[3], simplex[2])
        ] : null;

        var max = collidedPoints.length * colliderPoints.length;
        while (it < max) {
            if (simplex[0].z === undefined) {
                response = this.findResponseWithEdge(colliderPoints, collidedPoints, simplex);
            } else {
                response = this.findResponseWithTriangle(colliderPoints, collidedPoints, polytope);
            }
            if (response) {
                var norm = response.clone().normalize().scaleInPlace(this.EPSILON);
                return response.addToRef(norm, response);
            }
            it++;
        }
        return false;
    },

    /**
     * Checks if the collider and the collided object are intersecting.
     *
     * @method isIntersecting
     * @param {BABYLON.Vector2|BABYLON.Vector3[]} colliderPoints The convexe collider object.
     * @param {BABYLON.Vector2|BABYLON.Vector3[]} collidedPoints The convexe collided object.
     * @return {Boolean} Is intersecting or not.
     */
    isIntersecting: function(colliderPoints, collidedPoints) {
        return !!this.check(colliderPoints, collidedPoints);
    },

    /**
     * Checks if the collider and the collided object are intersecting
     * and give the response to be out of the object.
     *
     * @method intersect
     * @param {BABYLON.Vector2|BABYLON.Vector3[]} colliderPoints The convexe collider object.
     * @param {BABYLON.Vector2|BABYLON.Vector3[]} collidedPoints The convexe collided object.
     * @return {BABYLON.Vector2|BABYLON.Vector3} The penetration vector.
     */
    intersect: function(colliderPoints, collidedPoints) {
        var simplex = this.check(colliderPoints, collidedPoints);

        //this.cube = this.cube || [];
        if (simplex) {
            return this.getResponse(colliderPoints, collidedPoints, simplex);
        }

        return false;
    }
};

module.exports = CollisionGjkEpa;

},{}],2:[function(require,module,exports){
var __decorate=this&&this.__decorate||function(e,t,i,r){var n,o=arguments.length,s=3>o?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(3>o?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},__extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);i.prototype=t.prototype,e.prototype=new i},BABYLON;!function(e){e.ToGammaSpace=1/2.2,e.ToLinearSpace=2.2,e.Epsilon=.001;var t=function(){function e(){}return e.WithinEpsilon=function(e,t,i){void 0===i&&(i=1.401298e-45);var r=e-t;return r>=-i&&i>=r},e.ToHex=function(e){var t=e.toString(16);return 15>=e?("0"+t).toUpperCase():t.toUpperCase()},e.Sign=function(e){return e=+e,0===e||isNaN(e)?e:e>0?1:-1},e.Clamp=function(e,t,i){return void 0===t&&(t=0),void 0===i&&(i=1),Math.min(i,Math.max(t,e))},e}();e.MathTools=t;var i=function(){function i(e,t,i){void 0===e&&(e=0),void 0===t&&(t=0),void 0===i&&(i=0),this.r=e,this.g=t,this.b=i}return i.prototype.toString=function(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+"}"},i.prototype.getClassName=function(){return"Color3"},i.prototype.getHashCode=function(){var e=this.r||0;return e=397*e^(this.g||0),e=397*e^(this.b||0)},i.prototype.toArray=function(e,t){return void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,this},i.prototype.toColor4=function(e){return void 0===e&&(e=1),new r(this.r,this.g,this.b,e)},i.prototype.asArray=function(){var e=[];return this.toArray(e,0),e},i.prototype.toLuminance=function(){return.3*this.r+.59*this.g+.11*this.b},i.prototype.multiply=function(e){return new i(this.r*e.r,this.g*e.g,this.b*e.b)},i.prototype.multiplyToRef=function(e,t){return t.r=this.r*e.r,t.g=this.g*e.g,t.b=this.b*e.b,this},i.prototype.equals=function(e){return e&&this.r===e.r&&this.g===e.g&&this.b===e.b},i.prototype.equalsFloats=function(e,t,i){return this.r===e&&this.g===t&&this.b===i},i.prototype.scale=function(e){return new i(this.r*e,this.g*e,this.b*e)},i.prototype.scaleToRef=function(e,t){return t.r=this.r*e,t.g=this.g*e,t.b=this.b*e,this},i.prototype.add=function(e){return new i(this.r+e.r,this.g+e.g,this.b+e.b)},i.prototype.addToRef=function(e,t){return t.r=this.r+e.r,t.g=this.g+e.g,t.b=this.b+e.b,this},i.prototype.subtract=function(e){return new i(this.r-e.r,this.g-e.g,this.b-e.b)},i.prototype.subtractToRef=function(e,t){return t.r=this.r-e.r,t.g=this.g-e.g,t.b=this.b-e.b,this},i.prototype.clone=function(){return new i(this.r,this.g,this.b)},i.prototype.copyFrom=function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},i.prototype.copyFromFloats=function(e,t,i){return this.r=e,this.g=t,this.b=i,this},i.prototype.toHexString=function(){var e=255*this.r|0,i=255*this.g|0,r=255*this.b|0;return"#"+t.ToHex(e)+t.ToHex(i)+t.ToHex(r)},i.prototype.toLinearSpace=function(){var e=new i;return this.toLinearSpaceToRef(e),e},i.prototype.toLinearSpaceToRef=function(t){return t.r=Math.pow(this.r,e.ToLinearSpace),t.g=Math.pow(this.g,e.ToLinearSpace),t.b=Math.pow(this.b,e.ToLinearSpace),this},i.prototype.toGammaSpace=function(){var e=new i;return this.toGammaSpaceToRef(e),e},i.prototype.toGammaSpaceToRef=function(t){return t.r=Math.pow(this.r,e.ToGammaSpace),t.g=Math.pow(this.g,e.ToGammaSpace),t.b=Math.pow(this.b,e.ToGammaSpace),this},i.FromHexString=function(e){if("#"!==e.substring(0,1)||7!==e.length)return new i(0,0,0);var t=parseInt(e.substring(1,3),16),r=parseInt(e.substring(3,5),16),n=parseInt(e.substring(5,7),16);return i.FromInts(t,r,n)},i.FromArray=function(e,t){return void 0===t&&(t=0),new i(e[t],e[t+1],e[t+2])},i.FromInts=function(e,t,r){return new i(e/255,t/255,r/255)},i.Lerp=function(e,t,r){var n=e.r+(t.r-e.r)*r,o=e.g+(t.g-e.g)*r,s=e.b+(t.b-e.b)*r;return new i(n,o,s)},i.Red=function(){return new i(1,0,0)},i.Green=function(){return new i(0,1,0)},i.Blue=function(){return new i(0,0,1)},i.Black=function(){return new i(0,0,0)},i.White=function(){return new i(1,1,1)},i.Purple=function(){return new i(.5,0,.5)},i.Magenta=function(){return new i(1,0,1)},i.Yellow=function(){return new i(1,1,0)},i.Gray=function(){return new i(.5,.5,.5)},i}();e.Color3=i;var r=function(){function e(e,t,i,r){this.r=e,this.g=t,this.b=i,this.a=r}return e.prototype.addInPlace=function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this.a+=e.a,this},e.prototype.asArray=function(){var e=[];return this.toArray(e,0),e},e.prototype.toArray=function(e,t){return void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e[t+3]=this.a,this},e.prototype.add=function(t){return new e(this.r+t.r,this.g+t.g,this.b+t.b,this.a+t.a)},e.prototype.subtract=function(t){return new e(this.r-t.r,this.g-t.g,this.b-t.b,this.a-t.a)},e.prototype.subtractToRef=function(e,t){return t.r=this.r-e.r,t.g=this.g-e.g,t.b=this.b-e.b,t.a=this.a-e.a,this},e.prototype.scale=function(t){return new e(this.r*t,this.g*t,this.b*t,this.a*t)},e.prototype.scaleToRef=function(e,t){return t.r=this.r*e,t.g=this.g*e,t.b=this.b*e,t.a=this.a*e,this},e.prototype.multiply=function(t){return new e(this.r*t.r,this.g*t.g,this.b*t.b,this.a*t.a)},e.prototype.multiplyToRef=function(e,t){return t.r=this.r*e.r,t.g=this.g*e.g,t.b=this.b*e.b,t.a=this.a*e.a,t},e.prototype.toString=function(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+" A:"+this.a+"}"},e.prototype.getClassName=function(){return"Color4"},e.prototype.getHashCode=function(){var e=this.r||0;return e=397*e^(this.g||0),e=397*e^(this.b||0),e=397*e^(this.a||0)},e.prototype.clone=function(){return new e(this.r,this.g,this.b,this.a)},e.prototype.copyFrom=function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a,this},e.prototype.toHexString=function(){var e=255*this.r|0,i=255*this.g|0,r=255*this.b|0,n=255*this.a|0;return"#"+t.ToHex(e)+t.ToHex(i)+t.ToHex(r)+t.ToHex(n)},e.FromHexString=function(t){if("#"!==t.substring(0,1)||9!==t.length)return new e(0,0,0,0);var i=parseInt(t.substring(1,3),16),r=parseInt(t.substring(3,5),16),n=parseInt(t.substring(5,7),16),o=parseInt(t.substring(7,9),16);return e.FromInts(i,r,n,o)},e.Lerp=function(t,i,r){var n=new e(0,0,0,0);return e.LerpToRef(t,i,r,n),n},e.LerpToRef=function(e,t,i,r){r.r=e.r+(t.r-e.r)*i,r.g=e.g+(t.g-e.g)*i,r.b=e.b+(t.b-e.b)*i,r.a=e.a+(t.a-e.a)*i},e.FromArray=function(t,i){return void 0===i&&(i=0),new e(t[i],t[i+1],t[i+2],t[i+3])},e.FromInts=function(t,i,r,n){return new e(t/255,i/255,r/255,n/255)},e.CheckColors4=function(e,t){if(e.length===3*t){for(var i=[],r=0;r<e.length;r+=3){var n=r/3*4;i[n]=e[r],i[n+1]=e[r+1],i[n+2]=e[r+2],i[n+3]=1}return i}return e},e}();e.Color4=r;var n=function(){function i(e,t){this.x=e,this.y=t}return i.prototype.toString=function(){return"{X: "+this.x+" Y:"+this.y+"}"},i.prototype.getClassName=function(){return"Vector2"},i.prototype.getHashCode=function(){var e=this.x||0;return e=397*e^(this.y||0)},i.prototype.toArray=function(e,t){return void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,this},i.prototype.asArray=function(){var e=[];return this.toArray(e,0),e},i.prototype.copyFrom=function(e){return this.x=e.x,this.y=e.y,this},i.prototype.copyFromFloats=function(e,t){return this.x=e,this.y=t,this},i.prototype.add=function(e){return new i(this.x+e.x,this.y+e.y)},i.prototype.addToRef=function(e,t){return t.x=this.x+e.x,t.y=this.y+e.y,this},i.prototype.addVector3=function(e){return new i(this.x+e.x,this.y+e.y)},i.prototype.subtract=function(e){return new i(this.x-e.x,this.y-e.y)},i.prototype.subtractToRef=function(e,t){return t.x=this.x-e.x,t.y=this.y-e.y,this},i.prototype.subtractInPlace=function(e){return this.x-=e.x,this.y-=e.y,this},i.prototype.multiplyInPlace=function(e){return this.x*=e.x,this.y*=e.y,this},i.prototype.multiply=function(e){return new i(this.x*e.x,this.y*e.y)},i.prototype.multiplyToRef=function(e,t){return t.x=this.x*e.x,t.y=this.y*e.y,this},i.prototype.multiplyByFloats=function(e,t){return new i(this.x*e,this.y*t)},i.prototype.divide=function(e){return new i(this.x/e.x,this.y/e.y)},i.prototype.divideToRef=function(e,t){return t.x=this.x/e.x,t.y=this.y/e.y,this},i.prototype.negate=function(){return new i(-this.x,-this.y)},i.prototype.scaleInPlace=function(e){return this.x*=e,this.y*=e,this},i.prototype.scale=function(e){return new i(this.x*e,this.y*e)},i.prototype.equals=function(e){return e&&this.x===e.x&&this.y===e.y},i.prototype.equalsWithEpsilon=function(i,r){return void 0===r&&(r=e.Epsilon),i&&t.WithinEpsilon(this.x,i.x,r)&&t.WithinEpsilon(this.y,i.y,r)},i.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},i.prototype.lengthSquared=function(){return this.x*this.x+this.y*this.y},i.prototype.normalize=function(){var e=this.length();if(0===e)return this;var t=1/e;return this.x*=t,this.y*=t,this},i.prototype.clone=function(){return new i(this.x,this.y)},i.Zero=function(){return new i(0,0)},i.FromArray=function(e,t){return void 0===t&&(t=0),new i(e[t],e[t+1])},i.FromArrayToRef=function(e,t,i){i.x=e[t],i.y=e[t+1]},i.CatmullRom=function(e,t,r,n,o){var s=o*o,a=o*s,h=.5*(2*t.x+(-e.x+r.x)*o+(2*e.x-5*t.x+4*r.x-n.x)*s+(-e.x+3*t.x-3*r.x+n.x)*a),c=.5*(2*t.y+(-e.y+r.y)*o+(2*e.y-5*t.y+4*r.y-n.y)*s+(-e.y+3*t.y-3*r.y+n.y)*a);return new i(h,c)},i.Clamp=function(e,t,r){var n=e.x;n=n>r.x?r.x:n,n=n<t.x?t.x:n;var o=e.y;return o=o>r.y?r.y:o,o=o<t.y?t.y:o,new i(n,o)},i.Hermite=function(e,t,r,n,o){var s=o*o,a=o*s,h=2*a-3*s+1,c=-2*a+3*s,l=a-2*s+o,u=a-s,f=e.x*h+r.x*c+t.x*l+n.x*u,d=e.y*h+r.y*c+t.y*l+n.y*u;return new i(f,d)},i.Lerp=function(e,t,r){var n=e.x+(t.x-e.x)*r,o=e.y+(t.y-e.y)*r;return new i(n,o)},i.Dot=function(e,t){return e.x*t.x+e.y*t.y},i.Normalize=function(e){var t=e.clone();return t.normalize(),t},i.Minimize=function(e,t){var r=e.x<t.x?e.x:t.x,n=e.y<t.y?e.y:t.y;return new i(r,n)},i.Maximize=function(e,t){var r=e.x>t.x?e.x:t.x,n=e.y>t.y?e.y:t.y;return new i(r,n)},i.Transform=function(e,t){var r=i.Zero();return i.TransformToRef(e,t,r),r},i.TransformToRef=function(e,t,i){var r=e.x*t.m[0]+e.y*t.m[4]+t.m[12],n=e.x*t.m[1]+e.y*t.m[5]+t.m[13];i.x=r,i.y=n},i.PointInTriangle=function(e,t,i,r){var n=.5*(-i.y*r.x+t.y*(-i.x+r.x)+t.x*(i.y-r.y)+i.x*r.y),o=0>n?-1:1,s=(t.y*r.x-t.x*r.y+(r.y-t.y)*e.x+(t.x-r.x)*e.y)*o,a=(t.x*i.y-t.y*i.x+(t.y-i.y)*e.x+(i.x-t.x)*e.y)*o;return s>0&&a>0&&2*n*o>s+a},i.Distance=function(e,t){return Math.sqrt(i.DistanceSquared(e,t))},i.DistanceSquared=function(e,t){var i=e.x-t.x,r=e.y-t.y;return i*i+r*r},i.DistanceOfPointFromSegment=function(e,t,r){var n=i.DistanceSquared(t,r);if(0===n)return i.Distance(e,t);var o=r.subtract(t),s=Math.max(0,Math.min(1,i.Dot(e.subtract(t),o)/n)),a=t.add(o.multiplyByFloats(s,s));return i.Distance(e,a)},i}();e.Vector2=n;var o=function(){function i(e,t,i){this.x=e,this.y=t,this.z=i}return i.prototype.toString=function(){return"{X: "+this.x+" Y:"+this.y+" Z:"+this.z+"}"},i.prototype.getClassName=function(){return"Vector3"},i.prototype.getHashCode=function(){var e=this.x||0;return e=397*e^(this.y||0),e=397*e^(this.z||0)},i.prototype.asArray=function(){var e=[];return this.toArray(e,0),e},i.prototype.toArray=function(e,t){return void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,this},i.prototype.toQuaternion=function(){var e=new h(0,0,0,1),t=Math.cos(.5*(this.x+this.z)),i=Math.sin(.5*(this.x+this.z)),r=Math.cos(.5*(this.z-this.x)),n=Math.sin(.5*(this.z-this.x)),o=Math.cos(.5*this.y),s=Math.sin(.5*this.y);return e.x=r*s,e.y=-n*s,e.z=i*o,e.w=t*o,e},i.prototype.addInPlace=function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this},i.prototype.add=function(e){return new i(this.x+e.x,this.y+e.y,this.z+e.z)},i.prototype.addToRef=function(e,t){return t.x=this.x+e.x,t.y=this.y+e.y,t.z=this.z+e.z,this},i.prototype.subtractInPlace=function(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this},i.prototype.subtract=function(e){return new i(this.x-e.x,this.y-e.y,this.z-e.z)},i.prototype.subtractToRef=function(e,t){return t.x=this.x-e.x,t.y=this.y-e.y,t.z=this.z-e.z,this},i.prototype.subtractFromFloats=function(e,t,r){return new i(this.x-e,this.y-t,this.z-r)},i.prototype.subtractFromFloatsToRef=function(e,t,i,r){return r.x=this.x-e,r.y=this.y-t,r.z=this.z-i,this},i.prototype.negate=function(){return new i(-this.x,-this.y,-this.z)},i.prototype.scaleInPlace=function(e){return this.x*=e,this.y*=e,this.z*=e,this},i.prototype.scale=function(e){return new i(this.x*e,this.y*e,this.z*e)},i.prototype.scaleToRef=function(e,t){t.x=this.x*e,t.y=this.y*e,t.z=this.z*e},i.prototype.equals=function(e){return e&&this.x===e.x&&this.y===e.y&&this.z===e.z},i.prototype.equalsWithEpsilon=function(i,r){return void 0===r&&(r=e.Epsilon),i&&t.WithinEpsilon(this.x,i.x,r)&&t.WithinEpsilon(this.y,i.y,r)&&t.WithinEpsilon(this.z,i.z,r)},i.prototype.equalsToFloats=function(e,t,i){return this.x===e&&this.y===t&&this.z===i},i.prototype.multiplyInPlace=function(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this},i.prototype.multiply=function(e){return new i(this.x*e.x,this.y*e.y,this.z*e.z)},i.prototype.multiplyToRef=function(e,t){return t.x=this.x*e.x,t.y=this.y*e.y,t.z=this.z*e.z,this},i.prototype.multiplyByFloats=function(e,t,r){return new i(this.x*e,this.y*t,this.z*r)},i.prototype.divide=function(e){return new i(this.x/e.x,this.y/e.y,this.z/e.z)},i.prototype.divideToRef=function(e,t){return t.x=this.x/e.x,t.y=this.y/e.y,t.z=this.z/e.z,this},i.prototype.MinimizeInPlace=function(e){return e.x<this.x&&(this.x=e.x),e.y<this.y&&(this.y=e.y),e.z<this.z&&(this.z=e.z),this},i.prototype.MaximizeInPlace=function(e){return e.x>this.x&&(this.x=e.x),e.y>this.y&&(this.y=e.y),e.z>this.z&&(this.z=e.z),this},i.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},i.prototype.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z},i.prototype.normalize=function(){var e=this.length();if(0===e||1===e)return this;var t=1/e;return this.x*=t,this.y*=t,this.z*=t,this},i.prototype.clone=function(){return new i(this.x,this.y,this.z)},i.prototype.copyFrom=function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},i.prototype.copyFromFloats=function(e,t,i){return this.x=e,this.y=t,this.z=i,this},i.GetClipFactor=function(e,t,r,n){var o=i.Dot(e,r)-n,s=i.Dot(t,r)-n,a=o/(o-s);return a},i.FromArray=function(e,t){return t||(t=0),new i(e[t],e[t+1],e[t+2])},i.FromFloatArray=function(e,t){return t||(t=0),new i(e[t],e[t+1],e[t+2])},i.FromArrayToRef=function(e,t,i){i.x=e[t],i.y=e[t+1],i.z=e[t+2]},i.FromFloatArrayToRef=function(e,t,i){i.x=e[t],i.y=e[t+1],i.z=e[t+2]},i.FromFloatsToRef=function(e,t,i,r){r.x=e,r.y=t,r.z=i},i.Zero=function(){return new i(0,0,0)},i.Up=function(){return new i(0,1,0)},i.TransformCoordinates=function(e,t){var r=i.Zero();return i.TransformCoordinatesToRef(e,t,r),r},i.TransformCoordinatesToRef=function(e,t,i){var r=e.x*t.m[0]+e.y*t.m[4]+e.z*t.m[8]+t.m[12],n=e.x*t.m[1]+e.y*t.m[5]+e.z*t.m[9]+t.m[13],o=e.x*t.m[2]+e.y*t.m[6]+e.z*t.m[10]+t.m[14],s=e.x*t.m[3]+e.y*t.m[7]+e.z*t.m[11]+t.m[15];i.x=r/s,i.y=n/s,i.z=o/s},i.TransformCoordinatesFromFloatsToRef=function(e,t,i,r,n){var o=e*r.m[0]+t*r.m[4]+i*r.m[8]+r.m[12],s=e*r.m[1]+t*r.m[5]+i*r.m[9]+r.m[13],a=e*r.m[2]+t*r.m[6]+i*r.m[10]+r.m[14],h=e*r.m[3]+t*r.m[7]+i*r.m[11]+r.m[15];n.x=o/h,n.y=s/h,n.z=a/h},i.TransformNormal=function(e,t){var r=i.Zero();return i.TransformNormalToRef(e,t,r),r},i.TransformNormalToRef=function(e,t,i){i.x=e.x*t.m[0]+e.y*t.m[4]+e.z*t.m[8],i.y=e.x*t.m[1]+e.y*t.m[5]+e.z*t.m[9],i.z=e.x*t.m[2]+e.y*t.m[6]+e.z*t.m[10]},i.TransformNormalFromFloatsToRef=function(e,t,i,r,n){n.x=e*r.m[0]+t*r.m[4]+i*r.m[8],n.y=e*r.m[1]+t*r.m[5]+i*r.m[9],n.z=e*r.m[2]+t*r.m[6]+i*r.m[10]},i.CatmullRom=function(e,t,r,n,o){var s=o*o,a=o*s,h=.5*(2*t.x+(-e.x+r.x)*o+(2*e.x-5*t.x+4*r.x-n.x)*s+(-e.x+3*t.x-3*r.x+n.x)*a),c=.5*(2*t.y+(-e.y+r.y)*o+(2*e.y-5*t.y+4*r.y-n.y)*s+(-e.y+3*t.y-3*r.y+n.y)*a),l=.5*(2*t.z+(-e.z+r.z)*o+(2*e.z-5*t.z+4*r.z-n.z)*s+(-e.z+3*t.z-3*r.z+n.z)*a);return new i(h,c,l)},i.Clamp=function(e,t,r){var n=e.x;n=n>r.x?r.x:n,n=n<t.x?t.x:n;var o=e.y;o=o>r.y?r.y:o,o=o<t.y?t.y:o;var s=e.z;return s=s>r.z?r.z:s,s=s<t.z?t.z:s,new i(n,o,s)},i.Hermite=function(e,t,r,n,o){var s=o*o,a=o*s,h=2*a-3*s+1,c=-2*a+3*s,l=a-2*s+o,u=a-s,f=e.x*h+r.x*c+t.x*l+n.x*u,d=e.y*h+r.y*c+t.y*l+n.y*u,p=e.z*h+r.z*c+t.z*l+n.z*u;return new i(f,d,p)},i.Lerp=function(e,t,r){var n=e.x+(t.x-e.x)*r,o=e.y+(t.y-e.y)*r,s=e.z+(t.z-e.z)*r;return new i(n,o,s)},i.Dot=function(e,t){return e.x*t.x+e.y*t.y+e.z*t.z},i.Cross=function(e,t){var r=i.Zero();return i.CrossToRef(e,t,r),r},i.CrossToRef=function(e,t,i){E.Vector3[0].x=e.y*t.z-e.z*t.y,E.Vector3[0].y=e.z*t.x-e.x*t.z,E.Vector3[0].z=e.x*t.y-e.y*t.x,i.copyFrom(E.Vector3[0])},i.Normalize=function(e){var t=i.Zero();return i.NormalizeToRef(e,t),t},i.NormalizeToRef=function(e,t){t.copyFrom(e),t.normalize()},i.Project=function(e,t,r,n){var o=n.width,s=n.height,a=n.x,h=n.y,l=c.FromValues(o/2,0,0,0,0,-s/2,0,0,0,0,1,0,a+o/2,s/2+h,0,1),u=t.multiply(r).multiply(l);return i.TransformCoordinates(e,u)},i.UnprojectFromTransform=function(e,r,n,o,s){var a=o.multiply(s);a.invert(),e.x=e.x/r*2-1,e.y=-(e.y/n*2-1);var h=i.TransformCoordinates(e,a),c=e.x*a.m[3]+e.y*a.m[7]+e.z*a.m[11]+a.m[15];return t.WithinEpsilon(c,1)&&(h=h.scale(1/c)),h},i.Unproject=function(e,r,n,o,s,a){var h=o.multiply(s).multiply(a);h.invert();var c=new i(e.x/r*2-1,-(e.y/n*2-1),e.z),l=i.TransformCoordinates(c,h),u=c.x*h.m[3]+c.y*h.m[7]+c.z*h.m[11]+h.m[15];return t.WithinEpsilon(u,1)&&(l=l.scale(1/u)),l},i.Minimize=function(e,t){var i=e.clone();return i.MinimizeInPlace(t),i},i.Maximize=function(e,t){var i=e.clone();return i.MaximizeInPlace(t),i},i.Distance=function(e,t){return Math.sqrt(i.DistanceSquared(e,t))},i.DistanceSquared=function(e,t){var i=e.x-t.x,r=e.y-t.y,n=e.z-t.z;return i*i+r*r+n*n},i.Center=function(e,t){var i=e.add(t);return i.scaleInPlace(.5),i},i.RotationFromAxis=function(e,t,r){var n=i.Zero();return i.RotationFromAxisToRef(e,t,r,n),n},i.RotationFromAxisToRef=function(r,n,o,s){var a=r.normalize(),h=o.normalize(),c=d.X,l=d.Y,u=0,f=0,p=0,_=0,m=0,g=0,v=0,y=-1,x=0,b=E.Vector3[0],P=0,A=E.Vector3[1];t.WithinEpsilon(h.z,0,e.Epsilon)?g=1:t.WithinEpsilon(h.x,0,e.Epsilon)?_=1:(v=h.z/h.x,_=-v*Math.sqrt(1/(1+v*v)),g=Math.sqrt(1/(1+v*v))),A.x=_,A.y=m,A.z=g,A.normalize(),i.CrossToRef(a,A,b),b.normalize(),i.Dot(h,b)<0&&(y=1),P=i.Dot(a,A),P=Math.min(1,Math.max(-1,P)),p=Math.acos(P)*y,i.Dot(A,c)<0&&(p=Math.PI+p,A=A.scaleInPlace(-1),x++);var T=E.Vector3[2],C=E.Vector3[3];_=0,m=0,g=0,y=-1,t.WithinEpsilon(h.z,0,e.Epsilon)?_=1:(v=A.z/A.x,_=-v*Math.sqrt(1/(1+v*v)),g=Math.sqrt(1/(1+v*v))),T.x=_,T.y=m,T.z=g,T.normalize(),i.CrossToRef(T,A,C),C.normalize(),i.CrossToRef(h,T,b),b.normalize(),i.Dot(A,b)<0&&(y=1),P=i.Dot(h,T),P=Math.min(1,Math.max(-1,P)),f=Math.acos(P)*y,i.Dot(C,l)<0&&(f=Math.PI+f,x++),y=-1,i.CrossToRef(c,A,b),b.normalize(),i.Dot(b,l)<0&&(y=1),P=i.Dot(A,c),P=Math.min(1,Math.max(-1,P)),u=-Math.acos(P)*y,0>P&&2>x&&(u=Math.PI+u),s.x=f,s.y=u,s.z=p},i}();e.Vector3=o;var s=function(){function i(e,t,i,r){this.x=e,this.y=t,this.z=i,this.w=r}return i.prototype.toString=function(){return"{X: "+this.x+" Y:"+this.y+" Z:"+this.z+"W:"+this.w+"}"},i.prototype.getClassName=function(){return"Vector4"},i.prototype.getHashCode=function(){var e=this.x||0;return e=397*e^(this.y||0),e=397*e^(this.z||0),e=397*e^(this.w||0)},i.prototype.asArray=function(){var e=[];return this.toArray(e,0),e},i.prototype.toArray=function(e,t){return void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,this},i.prototype.addInPlace=function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this},i.prototype.add=function(e){return new i(this.x+e.x,this.y+e.y,this.z+e.z,this.w+e.w)},i.prototype.addToRef=function(e,t){return t.x=this.x+e.x,t.y=this.y+e.y,t.z=this.z+e.z,t.w=this.w+e.w,this},i.prototype.subtractInPlace=function(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this},i.prototype.subtract=function(e){return new i(this.x-e.x,this.y-e.y,this.z-e.z,this.w-e.w)},i.prototype.subtractToRef=function(e,t){return t.x=this.x-e.x,t.y=this.y-e.y,t.z=this.z-e.z,t.w=this.w-e.w,this},i.prototype.subtractFromFloats=function(e,t,r,n){return new i(this.x-e,this.y-t,this.z-r,this.w-n)},i.prototype.subtractFromFloatsToRef=function(e,t,i,r,n){return n.x=this.x-e,n.y=this.y-t,n.z=this.z-i,n.w=this.w-r,this},i.prototype.negate=function(){return new i(-this.x,-this.y,-this.z,-this.w)},i.prototype.scaleInPlace=function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},i.prototype.scale=function(e){return new i(this.x*e,this.y*e,this.z*e,this.w*e)},i.prototype.scaleToRef=function(e,t){t.x=this.x*e,t.y=this.y*e,t.z=this.z*e,t.w=this.w*e},i.prototype.equals=function(e){return e&&this.x===e.x&&this.y===e.y&&this.z===e.z&&this.w===e.w},i.prototype.equalsWithEpsilon=function(i,r){return void 0===r&&(r=e.Epsilon),i&&t.WithinEpsilon(this.x,i.x,r)&&t.WithinEpsilon(this.y,i.y,r)&&t.WithinEpsilon(this.z,i.z,r)&&t.WithinEpsilon(this.w,i.w,r)},i.prototype.equalsToFloats=function(e,t,i,r){return this.x===e&&this.y===t&&this.z===i&&this.w===r},i.prototype.multiplyInPlace=function(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this},i.prototype.multiply=function(e){return new i(this.x*e.x,this.y*e.y,this.z*e.z,this.w*e.w)},i.prototype.multiplyToRef=function(e,t){return t.x=this.x*e.x,t.y=this.y*e.y,t.z=this.z*e.z,t.w=this.w*e.w,this},i.prototype.multiplyByFloats=function(e,t,r,n){return new i(this.x*e,this.y*t,this.z*r,this.w*n)},i.prototype.divide=function(e){return new i(this.x/e.x,this.y/e.y,this.z/e.z,this.w/e.w)},i.prototype.divideToRef=function(e,t){return t.x=this.x/e.x,t.y=this.y/e.y,t.z=this.z/e.z,t.w=this.w/e.w,this},i.prototype.MinimizeInPlace=function(e){return e.x<this.x&&(this.x=e.x),e.y<this.y&&(this.y=e.y),e.z<this.z&&(this.z=e.z),e.w<this.w&&(this.w=e.w),this},i.prototype.MaximizeInPlace=function(e){return e.x>this.x&&(this.x=e.x),e.y>this.y&&(this.y=e.y),e.z>this.z&&(this.z=e.z),e.w>this.w&&(this.w=e.w),this},i.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},i.prototype.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},i.prototype.normalize=function(){var e=this.length();if(0===e)return this;var t=1/e;return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},i.prototype.toVector3=function(){return new o(this.x,this.y,this.z)},i.prototype.clone=function(){return new i(this.x,this.y,this.z,this.w)},i.prototype.copyFrom=function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this},i.prototype.copyFromFloats=function(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this},i.FromArray=function(e,t){return t||(t=0),new i(e[t],e[t+1],e[t+2],e[t+3])},i.FromArrayToRef=function(e,t,i){i.x=e[t],i.y=e[t+1],i.z=e[t+2],i.w=e[t+3]},i.FromFloatArrayToRef=function(e,t,i){i.x=e[t],i.y=e[t+1],i.z=e[t+2],i.w=e[t+3]},i.FromFloatsToRef=function(e,t,i,r,n){n.x=e,n.y=t,n.z=i,n.w=r},i.Zero=function(){return new i(0,0,0,0)},i.Normalize=function(e){var t=i.Zero();return i.NormalizeToRef(e,t),t},i.NormalizeToRef=function(e,t){t.copyFrom(e),t.normalize()},i.Minimize=function(e,t){var i=e.clone();return i.MinimizeInPlace(t),i},i.Maximize=function(e,t){var i=e.clone();return i.MaximizeInPlace(t),i},i.Distance=function(e,t){return Math.sqrt(i.DistanceSquared(e,t))},i.DistanceSquared=function(e,t){var i=e.x-t.x,r=e.y-t.y,n=e.z-t.z,o=e.w-t.w;return i*i+r*r+n*n+o*o},i.Center=function(e,t){var i=e.add(t);return i.scaleInPlace(.5),i},i}();e.Vector4=s;var a=function(){function e(e,t){this.width=e,this.height=t}return e.prototype.toString=function(){return"{W: "+this.width+", H: "+this.height+"}"},e.prototype.getClassName=function(){return"Size"},e.prototype.getHashCode=function(){var e=this.width||0;return e=397*e^(this.height||0)},e.prototype.copyFrom=function(e){this.width=e.width,this.height=e.height},e.prototype.clone=function(){return new e(this.width,this.height)},e.prototype.equals=function(e){return e?this.width===e.width&&this.height===e.height:!1},Object.defineProperty(e.prototype,"surface",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),e.Zero=function(){return new e(0,0)},e.prototype.add=function(t){var i=new e(this.width+t.width,this.height+t.height);return i},e.prototype.substract=function(t){var i=new e(this.width-t.width,this.height-t.height);return i},e.Lerp=function(t,i,r){var n=t.width+(i.width-t.width)*r,o=t.height+(i.height-t.height)*r;return new e(n,o)},e}();e.Size=a;var h=function(){function e(e,t,i,r){void 0===e&&(e=0),void 0===t&&(t=0),void 0===i&&(i=0),void 0===r&&(r=1),this.x=e,this.y=t,this.z=i,this.w=r}return e.prototype.toString=function(){return"{X: "+this.x+" Y:"+this.y+" Z:"+this.z+" W:"+this.w+"}"},e.prototype.getClassName=function(){return"Quaternion"},e.prototype.getHashCode=function(){var e=this.x||0;return e=397*e^(this.y||0),e=397*e^(this.z||0),e=397*e^(this.w||0)},e.prototype.asArray=function(){return[this.x,this.y,this.z,this.w]},e.prototype.equals=function(e){return e&&this.x===e.x&&this.y===e.y&&this.z===e.z&&this.w===e.w},e.prototype.clone=function(){return new e(this.x,this.y,this.z,this.w)},e.prototype.copyFrom=function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this},e.prototype.copyFromFloats=function(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this},e.prototype.add=function(t){return new e(this.x+t.x,this.y+t.y,this.z+t.z,this.w+t.w)},e.prototype.subtract=function(t){return new e(this.x-t.x,this.y-t.y,this.z-t.z,this.w-t.w)},e.prototype.scale=function(t){return new e(this.x*t,this.y*t,this.z*t,this.w*t)},e.prototype.multiply=function(t){var i=new e(0,0,0,1);return this.multiplyToRef(t,i),i},e.prototype.multiplyToRef=function(e,t){var i=this.x*e.w+this.y*e.z-this.z*e.y+this.w*e.x,r=-this.x*e.z+this.y*e.w+this.z*e.x+this.w*e.y,n=this.x*e.y-this.y*e.x+this.z*e.w+this.w*e.z,o=-this.x*e.x-this.y*e.y-this.z*e.z+this.w*e.w;return t.copyFromFloats(i,r,n,o),this},e.prototype.multiplyInPlace=function(e){return this.multiplyToRef(e,this),this},e.prototype.conjugateToRef=function(e){return e.copyFromFloats(-this.x,-this.y,-this.z,this.w),this},e.prototype.conjugateInPlace=function(){return this.x*=-1,this.y*=-1,this.z*=-1,this},e.prototype.conjugate=function(){var t=new e(-this.x,-this.y,-this.z,this.w);return t},e.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},e.prototype.normalize=function(){var e=1/this.length();return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},e.prototype.toEulerAngles=function(e){void 0===e&&(e="YZX");var t=o.Zero();return this.toEulerAnglesToRef(t,e),t},e.prototype.toEulerAnglesToRef=function(e,t){void 0===t&&(t="YZX");var i,r,n,o=this.x,s=this.y,a=this.z,h=this.w;switch(t){case"YZX":var c=o*s+a*h;if(c>.499&&(i=2*Math.atan2(o,h),r=Math.PI/2,n=0),-.499>c&&(i=-2*Math.atan2(o,h),r=-Math.PI/2,n=0),isNaN(i)){var l=o*o,u=s*s,f=a*a;i=Math.atan2(2*s*h-2*o*a,1-2*u-2*f),r=Math.asin(2*c),n=Math.atan2(2*o*h-2*s*a,1-2*l-2*f)}break;default:throw new Error("Euler order "+t+" not supported yet.")}return e.y=i,e.z=r,e.x=n,this},e.prototype.toRotationMatrix=function(e){var t=this.x*this.x,i=this.y*this.y,r=this.z*this.z,n=this.x*this.y,o=this.z*this.w,s=this.z*this.x,a=this.y*this.w,h=this.y*this.z,c=this.x*this.w;return e.m[0]=1-2*(i+r),e.m[1]=2*(n+o),e.m[2]=2*(s-a),e.m[3]=0,e.m[4]=2*(n-o),e.m[5]=1-2*(r+t),e.m[6]=2*(h+c),e.m[7]=0,e.m[8]=2*(s+a),e.m[9]=2*(h-c),e.m[10]=1-2*(i+t),e.m[11]=0,e.m[12]=0,e.m[13]=0,e.m[14]=0,e.m[15]=1,this},e.prototype.fromRotationMatrix=function(t){return e.FromRotationMatrixToRef(t,this),this},e.FromRotationMatrix=function(t){var i=new e;return e.FromRotationMatrixToRef(t,i),i},e.FromRotationMatrixToRef=function(e,t){var i,r=e.m,n=r[0],o=r[4],s=r[8],a=r[1],h=r[5],c=r[9],l=r[2],u=r[6],f=r[10],d=n+h+f;d>0?(i=.5/Math.sqrt(d+1),t.w=.25/i,t.x=(u-c)*i,t.y=(s-l)*i,t.z=(a-o)*i):n>h&&n>f?(i=2*Math.sqrt(1+n-h-f),t.w=(u-c)/i,t.x=.25*i,t.y=(o+a)/i,t.z=(s+l)/i):h>f?(i=2*Math.sqrt(1+h-n-f),t.w=(s-l)/i,t.x=(o+a)/i,t.y=.25*i,t.z=(c+u)/i):(i=2*Math.sqrt(1+f-n-h),t.w=(a-o)/i,t.x=(s+l)/i,t.y=(c+u)/i,t.z=.25*i)},e.Inverse=function(t){return new e(-t.x,-t.y,-t.z,t.w)},e.Identity=function(){return new e(0,0,0,1)},e.RotationAxis=function(t,i){var r=new e,n=Math.sin(i/2);return t.normalize(),r.w=Math.cos(i/2),r.x=t.x*n,r.y=t.y*n,r.z=t.z*n,r},e.FromArray=function(t,i){return i||(i=0),new e(t[i],t[i+1],t[i+2],t[i+3])},e.RotationYawPitchRoll=function(t,i,r){var n=new e;return e.RotationYawPitchRollToRef(t,i,r,n),n},e.RotationYawPitchRollToRef=function(e,t,i,r){var n=.5*i,o=.5*t,s=.5*e,a=Math.sin(n),h=Math.cos(n),c=Math.sin(o),l=Math.cos(o),u=Math.sin(s),f=Math.cos(s);r.x=f*c*h+u*l*a,r.y=u*l*h-f*c*a,r.z=f*l*a-u*c*h,r.w=f*l*h+u*c*a},e.RotationAlphaBetaGamma=function(t,i,r){var n=new e;return e.RotationAlphaBetaGammaToRef(t,i,r,n),n},e.RotationAlphaBetaGammaToRef=function(e,t,i,r){var n=.5*(i+e),o=.5*(i-e),s=.5*t;r.x=Math.cos(o)*Math.sin(s),r.y=Math.sin(o)*Math.sin(s),r.z=Math.sin(n)*Math.cos(s),r.w=Math.cos(n)*Math.cos(s)},e.Slerp=function(t,i,r){var n,o,s=r,a=t.x*i.x+t.y*i.y+t.z*i.z+t.w*i.w,h=!1;if(0>a&&(h=!0,a=-a),a>.999999)o=1-s,n=h?-s:s;else{var c=Math.acos(a),l=1/Math.sin(c);o=Math.sin((1-s)*c)*l,n=h?-Math.sin(s*c)*l:Math.sin(s*c)*l}return new e(o*t.x+n*i.x,o*t.y+n*i.y,o*t.z+n*i.z,o*t.w+n*i.w)},e}();e.Quaternion=h;var c=function(){function e(){this.m=new Float32Array(16)}return e.prototype.isIdentity=function(){return 1!==this.m[0]||1!==this.m[5]||1!==this.m[10]||1!==this.m[15]?!1:0===this.m[1]&&0===this.m[2]&&0===this.m[3]&&0===this.m[4]&&0===this.m[6]&&0===this.m[7]&&0===this.m[8]&&0===this.m[9]&&0===this.m[11]&&0===this.m[12]&&0===this.m[13]&&0===this.m[14]},e.prototype.determinant=function(){var e=this.m[10]*this.m[15]-this.m[11]*this.m[14],t=this.m[9]*this.m[15]-this.m[11]*this.m[13],i=this.m[9]*this.m[14]-this.m[10]*this.m[13],r=this.m[8]*this.m[15]-this.m[11]*this.m[12],n=this.m[8]*this.m[14]-this.m[10]*this.m[12],o=this.m[8]*this.m[13]-this.m[9]*this.m[12];return this.m[0]*(this.m[5]*e-this.m[6]*t+this.m[7]*i)-this.m[1]*(this.m[4]*e-this.m[6]*r+this.m[7]*n)+this.m[2]*(this.m[4]*t-this.m[5]*r+this.m[7]*o)-this.m[3]*(this.m[4]*i-this.m[5]*n+this.m[6]*o)},e.prototype.toArray=function(){return this.m},e.prototype.asArray=function(){return this.toArray()},e.prototype.invert=function(){return this.invertToRef(this),this},e.prototype.reset=function(){for(var e=0;16>e;e++)this.m[e]=0;return this},e.prototype.add=function(t){var i=new e;return this.addToRef(t,i),i},e.prototype.addToRef=function(e,t){for(var i=0;16>i;i++)t.m[i]=this.m[i]+e.m[i];return this},e.prototype.addToSelf=function(e){for(var t=0;16>t;t++)this.m[t]+=e.m[t];return this},e.prototype.invertToRef=function(e){var t=this.m[0],i=this.m[1],r=this.m[2],n=this.m[3],o=this.m[4],s=this.m[5],a=this.m[6],h=this.m[7],c=this.m[8],l=this.m[9],u=this.m[10],f=this.m[11],d=this.m[12],p=this.m[13],_=this.m[14],m=this.m[15],g=u*m-f*_,v=l*m-f*p,y=l*_-u*p,x=c*m-f*d,b=c*_-u*d,P=c*p-l*d,A=s*g-a*v+h*y,T=-(o*g-a*x+h*b),E=o*v-s*x+h*P,C=-(o*y-s*b+a*P),S=1/(t*A+i*T+r*E+n*C),M=a*m-h*_,I=s*m-h*p,D=s*_-a*p,R=o*m-h*d,O=o*_-a*d,w=o*p-s*d,L=a*f-h*u,B=s*f-h*l,V=s*u-a*l,F=o*f-h*c,N=o*u-a*c,z=o*l-s*c;return e.m[0]=A*S,e.m[4]=T*S,e.m[8]=E*S,e.m[12]=C*S,e.m[1]=-(i*g-r*v+n*y)*S,e.m[5]=(t*g-r*x+n*b)*S,e.m[9]=-(t*v-i*x+n*P)*S,e.m[13]=(t*y-i*b+r*P)*S,e.m[2]=(i*M-r*I+n*D)*S,e.m[6]=-(t*M-r*R+n*O)*S,e.m[10]=(t*I-i*R+n*w)*S,e.m[14]=-(t*D-i*O+r*w)*S,e.m[3]=-(i*L-r*B+n*V)*S,e.m[7]=(t*L-r*F+n*N)*S,e.m[11]=-(t*B-i*F+n*z)*S,e.m[15]=(t*V-i*N+r*z)*S,this},e.prototype.setTranslation=function(e){return this.m[12]=e.x,this.m[13]=e.y,this.m[14]=e.z,this},e.prototype.getTranslation=function(){return new o(this.m[12],this.m[13],this.m[14])},e.prototype.multiply=function(t){var i=new e;return this.multiplyToRef(t,i),i},e.prototype.copyFrom=function(e){for(var t=0;16>t;t++)this.m[t]=e.m[t];return this},e.prototype.copyToArray=function(e,t){void 0===t&&(t=0);for(var i=0;16>i;i++)e[t+i]=this.m[i];return this},e.prototype.multiplyToRef=function(e,t){return this.multiplyToArray(e,t.m,0),this},e.prototype.multiplyToArray=function(e,t,i){var r=this.m[0],n=this.m[1],o=this.m[2],s=this.m[3],a=this.m[4],h=this.m[5],c=this.m[6],l=this.m[7],u=this.m[8],f=this.m[9],d=this.m[10],p=this.m[11],_=this.m[12],m=this.m[13],g=this.m[14],v=this.m[15],y=e.m[0],x=e.m[1],b=e.m[2],P=e.m[3],A=e.m[4],T=e.m[5],E=e.m[6],C=e.m[7],S=e.m[8],M=e.m[9],I=e.m[10],D=e.m[11],R=e.m[12],O=e.m[13],w=e.m[14],L=e.m[15];
return t[i]=r*y+n*A+o*S+s*R,t[i+1]=r*x+n*T+o*M+s*O,t[i+2]=r*b+n*E+o*I+s*w,t[i+3]=r*P+n*C+o*D+s*L,t[i+4]=a*y+h*A+c*S+l*R,t[i+5]=a*x+h*T+c*M+l*O,t[i+6]=a*b+h*E+c*I+l*w,t[i+7]=a*P+h*C+c*D+l*L,t[i+8]=u*y+f*A+d*S+p*R,t[i+9]=u*x+f*T+d*M+p*O,t[i+10]=u*b+f*E+d*I+p*w,t[i+11]=u*P+f*C+d*D+p*L,t[i+12]=_*y+m*A+g*S+v*R,t[i+13]=_*x+m*T+g*M+v*O,t[i+14]=_*b+m*E+g*I+v*w,t[i+15]=_*P+m*C+g*D+v*L,this},e.prototype.equals=function(e){return e&&this.m[0]===e.m[0]&&this.m[1]===e.m[1]&&this.m[2]===e.m[2]&&this.m[3]===e.m[3]&&this.m[4]===e.m[4]&&this.m[5]===e.m[5]&&this.m[6]===e.m[6]&&this.m[7]===e.m[7]&&this.m[8]===e.m[8]&&this.m[9]===e.m[9]&&this.m[10]===e.m[10]&&this.m[11]===e.m[11]&&this.m[12]===e.m[12]&&this.m[13]===e.m[13]&&this.m[14]===e.m[14]&&this.m[15]===e.m[15]},e.prototype.clone=function(){return e.FromValues(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5],this.m[6],this.m[7],this.m[8],this.m[9],this.m[10],this.m[11],this.m[12],this.m[13],this.m[14],this.m[15])},e.prototype.getClassName=function(){return"Matrix"},e.prototype.getHashCode=function(){for(var e=this.m[0]||0,t=1;16>t;t++)e=397*e^(this.m[t]||0);return e},e.prototype.decompose=function(i,r,n){n.x=this.m[12],n.y=this.m[13],n.z=this.m[14];var o=t.Sign(this.m[0]*this.m[1]*this.m[2]*this.m[3])<0?-1:1,s=t.Sign(this.m[4]*this.m[5]*this.m[6]*this.m[7])<0?-1:1,a=t.Sign(this.m[8]*this.m[9]*this.m[10]*this.m[11])<0?-1:1;if(i.x=o*Math.sqrt(this.m[0]*this.m[0]+this.m[1]*this.m[1]+this.m[2]*this.m[2]),i.y=s*Math.sqrt(this.m[4]*this.m[4]+this.m[5]*this.m[5]+this.m[6]*this.m[6]),i.z=a*Math.sqrt(this.m[8]*this.m[8]+this.m[9]*this.m[9]+this.m[10]*this.m[10]),0===i.x||0===i.y||0===i.z)return r.x=0,r.y=0,r.z=0,r.w=1,!1;var c=e.FromValues(this.m[0]/i.x,this.m[1]/i.x,this.m[2]/i.x,0,this.m[4]/i.y,this.m[5]/i.y,this.m[6]/i.y,0,this.m[8]/i.z,this.m[9]/i.z,this.m[10]/i.z,0,0,0,0,1);return h.FromRotationMatrixToRef(c,r),!0},e.FromArray=function(t,i){var r=new e;return i||(i=0),e.FromArrayToRef(t,i,r),r},e.FromArrayToRef=function(e,t,i){for(var r=0;16>r;r++)i.m[r]=e[r+t]},e.FromFloat32ArrayToRefScaled=function(e,t,i,r){for(var n=0;16>n;n++)r.m[n]=e[n+t]*i},e.FromValuesToRef=function(e,t,i,r,n,o,s,a,h,c,l,u,f,d,p,_,m){m.m[0]=e,m.m[1]=t,m.m[2]=i,m.m[3]=r,m.m[4]=n,m.m[5]=o,m.m[6]=s,m.m[7]=a,m.m[8]=h,m.m[9]=c,m.m[10]=l,m.m[11]=u,m.m[12]=f,m.m[13]=d,m.m[14]=p,m.m[15]=_},e.prototype.getRow=function(e){if(0>e||e>3)return null;var t=4*e;return new s(this.m[t+0],this.m[t+1],this.m[t+2],this.m[t+3])},e.prototype.setRow=function(e,t){if(0>e||e>3)return this;var i=4*e;return this.m[i+0]=t.x,this.m[i+1]=t.y,this.m[i+2]=t.z,this.m[i+3]=t.w,this},e.FromValues=function(t,i,r,n,o,s,a,h,c,l,u,f,d,p,_,m){var g=new e;return g.m[0]=t,g.m[1]=i,g.m[2]=r,g.m[3]=n,g.m[4]=o,g.m[5]=s,g.m[6]=a,g.m[7]=h,g.m[8]=c,g.m[9]=l,g.m[10]=u,g.m[11]=f,g.m[12]=d,g.m[13]=p,g.m[14]=_,g.m[15]=m,g},e.Compose=function(t,i,r){var n=e.FromValues(t.x,0,0,0,0,t.y,0,0,0,0,t.z,0,0,0,0,1),o=e.Identity();return i.toRotationMatrix(o),n=n.multiply(o),n.setTranslation(r),n},e.Identity=function(){return e.FromValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},e.IdentityToRef=function(t){e.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,t)},e.Zero=function(){return e.FromValues(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)},e.RotationX=function(t){var i=new e;return e.RotationXToRef(t,i),i},e.Invert=function(t){var i=new e;return t.invertToRef(i),i},e.RotationXToRef=function(e,t){var i=Math.sin(e),r=Math.cos(e);t.m[0]=1,t.m[15]=1,t.m[5]=r,t.m[10]=r,t.m[9]=-i,t.m[6]=i,t.m[1]=0,t.m[2]=0,t.m[3]=0,t.m[4]=0,t.m[7]=0,t.m[8]=0,t.m[11]=0,t.m[12]=0,t.m[13]=0,t.m[14]=0},e.RotationY=function(t){var i=new e;return e.RotationYToRef(t,i),i},e.RotationYToRef=function(e,t){var i=Math.sin(e),r=Math.cos(e);t.m[5]=1,t.m[15]=1,t.m[0]=r,t.m[2]=-i,t.m[8]=i,t.m[10]=r,t.m[1]=0,t.m[3]=0,t.m[4]=0,t.m[6]=0,t.m[7]=0,t.m[9]=0,t.m[11]=0,t.m[12]=0,t.m[13]=0,t.m[14]=0},e.RotationZ=function(t){var i=new e;return e.RotationZToRef(t,i),i},e.RotationZToRef=function(e,t){var i=Math.sin(e),r=Math.cos(e);t.m[10]=1,t.m[15]=1,t.m[0]=r,t.m[1]=i,t.m[4]=-i,t.m[5]=r,t.m[2]=0,t.m[3]=0,t.m[6]=0,t.m[7]=0,t.m[8]=0,t.m[9]=0,t.m[11]=0,t.m[12]=0,t.m[13]=0,t.m[14]=0},e.RotationAxis=function(t,i){var r=e.Zero();return e.RotationAxisToRef(t,i,r),r},e.RotationAxisToRef=function(e,t,i){var r=Math.sin(-t),n=Math.cos(-t),o=1-n;e.normalize(),i.m[0]=e.x*e.x*o+n,i.m[1]=e.x*e.y*o-e.z*r,i.m[2]=e.x*e.z*o+e.y*r,i.m[3]=0,i.m[4]=e.y*e.x*o+e.z*r,i.m[5]=e.y*e.y*o+n,i.m[6]=e.y*e.z*o-e.x*r,i.m[7]=0,i.m[8]=e.z*e.x*o-e.y*r,i.m[9]=e.z*e.y*o+e.x*r,i.m[10]=e.z*e.z*o+n,i.m[11]=0,i.m[15]=1},e.RotationYawPitchRoll=function(t,i,r){var n=new e;return e.RotationYawPitchRollToRef(t,i,r,n),n},e.RotationYawPitchRollToRef=function(e,t,i,r){h.RotationYawPitchRollToRef(e,t,i,this._tempQuaternion),this._tempQuaternion.toRotationMatrix(r)},e.Scaling=function(t,i,r){var n=e.Zero();return e.ScalingToRef(t,i,r,n),n},e.ScalingToRef=function(e,t,i,r){r.m[0]=e,r.m[1]=0,r.m[2]=0,r.m[3]=0,r.m[4]=0,r.m[5]=t,r.m[6]=0,r.m[7]=0,r.m[8]=0,r.m[9]=0,r.m[10]=i,r.m[11]=0,r.m[12]=0,r.m[13]=0,r.m[14]=0,r.m[15]=1},e.Translation=function(t,i,r){var n=e.Identity();return e.TranslationToRef(t,i,r,n),n},e.TranslationToRef=function(t,i,r,n){e.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,t,i,r,1,n)},e.Lerp=function(t,i,r){for(var n=e.Zero(),o=0;16>o;o++)n.m[o]=t.m[o]*(1-r)+i.m[o]*r;return n},e.DecomposeLerp=function(t,i,r){var n=new o(0,0,0),s=new h,a=new o(0,0,0);t.decompose(n,s,a);var c=new o(0,0,0),l=new h,u=new o(0,0,0);i.decompose(c,l,u);var f=o.Lerp(n,c,r),d=h.Slerp(s,l,r),p=o.Lerp(a,u,r);return e.Compose(f,d,p)},e.LookAtLH=function(t,i,r){var n=e.Zero();return e.LookAtLHToRef(t,i,r,n),n},e.LookAtLHToRef=function(t,i,r,n){i.subtractToRef(t,this._zAxis),this._zAxis.normalize(),o.CrossToRef(r,this._zAxis,this._xAxis),0===this._xAxis.lengthSquared()?this._xAxis.x=1:this._xAxis.normalize(),o.CrossToRef(this._zAxis,this._xAxis,this._yAxis),this._yAxis.normalize();var s=-o.Dot(this._xAxis,t),a=-o.Dot(this._yAxis,t),h=-o.Dot(this._zAxis,t);return e.FromValuesToRef(this._xAxis.x,this._yAxis.x,this._zAxis.x,0,this._xAxis.y,this._yAxis.y,this._zAxis.y,0,this._xAxis.z,this._yAxis.z,this._zAxis.z,0,s,a,h,1,n)},e.OrthoLH=function(t,i,r,n){var o=e.Zero();return e.OrthoLHToRef(t,i,r,n,o),o},e.OrthoLHToRef=function(t,i,r,n,o){var s=2/t,a=2/i,h=1/(n-r),c=r/(r-n);e.FromValuesToRef(s,0,0,0,0,a,0,0,0,0,h,0,0,0,c,1,o)},e.OrthoOffCenterLH=function(t,i,r,n,o,s){var a=e.Zero();return e.OrthoOffCenterLHToRef(t,i,r,n,o,s,a),a},e.OrthoOffCenterLHToRef=function(e,t,i,r,n,o,s){s.m[0]=2/(t-e),s.m[1]=s.m[2]=s.m[3]=0,s.m[5]=2/(r-i),s.m[4]=s.m[6]=s.m[7]=0,s.m[10]=-1/(n-o),s.m[8]=s.m[9]=s.m[11]=0,s.m[12]=(e+t)/(e-t),s.m[13]=(r+i)/(i-r),s.m[14]=n/(n-o),s.m[15]=1},e.PerspectiveLH=function(t,i,r,n){var o=e.Zero();return o.m[0]=2*r/t,o.m[1]=o.m[2]=o.m[3]=0,o.m[5]=2*r/i,o.m[4]=o.m[6]=o.m[7]=0,o.m[10]=-n/(r-n),o.m[8]=o.m[9]=0,o.m[11]=1,o.m[12]=o.m[13]=o.m[15]=0,o.m[14]=r*n/(r-n),o},e.PerspectiveFovLH=function(t,i,r,n){var o=e.Zero();return e.PerspectiveFovLHToRef(t,i,r,n,o),o},e.PerspectiveFovLHToRef=function(e,t,i,r,n,o){void 0===o&&(o=!0);var s=1/Math.tan(.5*e);o?n.m[0]=s/t:n.m[0]=s,n.m[1]=n.m[2]=n.m[3]=0,o?n.m[5]=s:n.m[5]=s*t,n.m[4]=n.m[6]=n.m[7]=0,n.m[8]=n.m[9]=0,n.m[10]=-r/(i-r),n.m[11]=1,n.m[12]=n.m[13]=n.m[15]=0,n.m[14]=i*r/(i-r)},e.GetFinalMatrix=function(t,i,r,n,o,s){var a=t.width,h=t.height,c=t.x,l=t.y,u=e.FromValues(a/2,0,0,0,0,-h/2,0,0,0,0,s-o,0,c+a/2,h/2+l,o,1);return i.multiply(r).multiply(n).multiply(u)},e.GetAsMatrix2x2=function(e){return new Float32Array([e.m[0],e.m[1],e.m[4],e.m[5]])},e.GetAsMatrix3x3=function(e){return new Float32Array([e.m[0],e.m[1],e.m[2],e.m[4],e.m[5],e.m[6],e.m[8],e.m[9],e.m[10]])},e.Transpose=function(t){var i=new e;return i.m[0]=t.m[0],i.m[1]=t.m[4],i.m[2]=t.m[8],i.m[3]=t.m[12],i.m[4]=t.m[1],i.m[5]=t.m[5],i.m[6]=t.m[9],i.m[7]=t.m[13],i.m[8]=t.m[2],i.m[9]=t.m[6],i.m[10]=t.m[10],i.m[11]=t.m[14],i.m[12]=t.m[3],i.m[13]=t.m[7],i.m[14]=t.m[11],i.m[15]=t.m[15],i},e.Reflection=function(t){var i=new e;return e.ReflectionToRef(t,i),i},e.ReflectionToRef=function(e,t){e.normalize();var i=e.normal.x,r=e.normal.y,n=e.normal.z,o=-2*i,s=-2*r,a=-2*n;t.m[0]=o*i+1,t.m[1]=s*i,t.m[2]=a*i,t.m[3]=0,t.m[4]=o*r,t.m[5]=s*r+1,t.m[6]=a*r,t.m[7]=0,t.m[8]=o*n,t.m[9]=s*n,t.m[10]=a*n+1,t.m[11]=0,t.m[12]=o*e.d,t.m[13]=s*e.d,t.m[14]=a*e.d,t.m[15]=1},e._tempQuaternion=new h,e._xAxis=o.Zero(),e._yAxis=o.Zero(),e._zAxis=o.Zero(),e}();e.Matrix=c;var l=function(){function e(e,t,i,r){this.normal=new o(e,t,i),this.d=r}return e.prototype.asArray=function(){return[this.normal.x,this.normal.y,this.normal.z,this.d]},e.prototype.clone=function(){return new e(this.normal.x,this.normal.y,this.normal.z,this.d)},e.prototype.getClassName=function(){return"Plane"},e.prototype.getHashCode=function(){var e=this.normal.getHashCode();return e=397*e^(this.d||0)},e.prototype.normalize=function(){var e=Math.sqrt(this.normal.x*this.normal.x+this.normal.y*this.normal.y+this.normal.z*this.normal.z),t=0;return 0!==e&&(t=1/e),this.normal.x*=t,this.normal.y*=t,this.normal.z*=t,this.d*=t,this},e.prototype.transform=function(t){var i=c.Transpose(t),r=this.normal.x,n=this.normal.y,o=this.normal.z,s=this.d,a=r*i.m[0]+n*i.m[1]+o*i.m[2]+s*i.m[3],h=r*i.m[4]+n*i.m[5]+o*i.m[6]+s*i.m[7],l=r*i.m[8]+n*i.m[9]+o*i.m[10]+s*i.m[11],u=r*i.m[12]+n*i.m[13]+o*i.m[14]+s*i.m[15];return new e(a,h,l,u)},e.prototype.dotCoordinate=function(e){return this.normal.x*e.x+this.normal.y*e.y+this.normal.z*e.z+this.d},e.prototype.copyFromPoints=function(e,t,i){var r,n=t.x-e.x,o=t.y-e.y,s=t.z-e.z,a=i.x-e.x,h=i.y-e.y,c=i.z-e.z,l=o*c-s*h,u=s*a-n*c,f=n*h-o*a,d=Math.sqrt(l*l+u*u+f*f);return r=0!==d?1/d:0,this.normal.x=l*r,this.normal.y=u*r,this.normal.z=f*r,this.d=-(this.normal.x*e.x+this.normal.y*e.y+this.normal.z*e.z),this},e.prototype.isFrontFacingTo=function(e,t){var i=o.Dot(this.normal,e);return t>=i},e.prototype.signedDistanceTo=function(e){return o.Dot(e,this.normal)+this.d},e.FromArray=function(t){return new e(t[0],t[1],t[2],t[3])},e.FromPoints=function(t,i,r){var n=new e(0,0,0,0);return n.copyFromPoints(t,i,r),n},e.FromPositionAndNormal=function(t,i){var r=new e(0,0,0,0);return i.normalize(),r.normal=i,r.d=-(i.x*t.x+i.y*t.y+i.z*t.z),r},e.SignedDistanceToPlaneFromPositionAndNormal=function(e,t,i){var r=-(t.x*e.x+t.y*e.y+t.z*e.z);return o.Dot(i,t)+r},e}();e.Plane=l;var u=function(){function e(e,t,i,r){this.x=e,this.y=t,this.width=i,this.height=r}return e.prototype.toGlobal=function(t,i){return new e(this.x*t,this.y*i,this.width*t,this.height*i)},e}();e.Viewport=u;var f=function(){function e(){}return e.GetPlanes=function(t){for(var i=[],r=0;6>r;r++)i.push(new l(0,0,0,0));return e.GetPlanesToRef(t,i),i},e.GetPlanesToRef=function(e,t){t[0].normal.x=e.m[3]+e.m[2],t[0].normal.y=e.m[7]+e.m[6],t[0].normal.z=e.m[11]+e.m[10],t[0].d=e.m[15]+e.m[14],t[0].normalize(),t[1].normal.x=e.m[3]-e.m[2],t[1].normal.y=e.m[7]-e.m[6],t[1].normal.z=e.m[11]-e.m[10],t[1].d=e.m[15]-e.m[14],t[1].normalize(),t[2].normal.x=e.m[3]+e.m[0],t[2].normal.y=e.m[7]+e.m[4],t[2].normal.z=e.m[11]+e.m[8],t[2].d=e.m[15]+e.m[12],t[2].normalize(),t[3].normal.x=e.m[3]-e.m[0],t[3].normal.y=e.m[7]-e.m[4],t[3].normal.z=e.m[11]-e.m[8],t[3].d=e.m[15]-e.m[12],t[3].normalize(),t[4].normal.x=e.m[3]-e.m[1],t[4].normal.y=e.m[7]-e.m[5],t[4].normal.z=e.m[11]-e.m[9],t[4].d=e.m[15]-e.m[13],t[4].normalize(),t[5].normal.x=e.m[3]+e.m[1],t[5].normal.y=e.m[7]+e.m[5],t[5].normal.z=e.m[11]+e.m[9],t[5].d=e.m[15]+e.m[13],t[5].normalize()},e}();e.Frustum=f,function(e){e[e.LOCAL=0]="LOCAL",e[e.WORLD=1]="WORLD"}(e.Space||(e.Space={}));var d=(e.Space,function(){function e(){}return e.X=new o(1,0,0),e.Y=new o(0,1,0),e.Z=new o(0,0,1),e}());e.Axis=d;var p=function(){function e(){}return e.interpolate=function(e,t,i,r,n){for(var o=1-3*r+3*t,s=3*r-6*t,a=3*t,h=e,c=0;5>c;c++){var l=h*h,u=l*h,f=o*u+s*l+a*h,d=1/(3*o*l+2*s*h+a);h-=(f-e)*d,h=Math.min(1,Math.max(0,h))}return 3*Math.pow(1-h,2)*h*i+3*(1-h)*Math.pow(h,2)*n+Math.pow(h,3)},e}();e.BezierCurve=p,function(e){e[e.CW=0]="CW",e[e.CCW=1]="CCW"}(e.Orientation||(e.Orientation={}));var _=e.Orientation,m=function(){function e(e){var t=this;this.degrees=function(){return 180*t._radians/Math.PI},this.radians=function(){return t._radians},this._radians=e,this._radians<0&&(this._radians+=2*Math.PI)}return e.BetweenTwoPoints=function(t,i){var r=i.subtract(t),n=Math.atan2(r.y,r.x);return new e(n)},e.FromRadians=function(t){return new e(t)},e.FromDegrees=function(t){return new e(t*Math.PI/180)},e}();e.Angle=m;var g=function(){function e(e,t,i){this.startPoint=e,this.midPoint=t,this.endPoint=i;var r=Math.pow(t.x,2)+Math.pow(t.y,2),o=(Math.pow(e.x,2)+Math.pow(e.y,2)-r)/2,s=(r-Math.pow(i.x,2)-Math.pow(i.y,2))/2,a=(e.x-t.x)*(t.y-i.y)-(t.x-i.x)*(e.y-t.y);this.centerPoint=new n((o*(t.y-i.y)-s*(e.y-t.y))/a,((e.x-t.x)*s-(t.x-i.x)*o)/a),this.radius=this.centerPoint.subtract(this.startPoint).length(),this.startAngle=m.BetweenTwoPoints(this.centerPoint,this.startPoint);var h=this.startAngle.degrees(),c=m.BetweenTwoPoints(this.centerPoint,this.midPoint).degrees(),l=m.BetweenTwoPoints(this.centerPoint,this.endPoint).degrees();c-h>180&&(c-=360),-180>c-h&&(c+=360),l-c>180&&(l-=360),-180>l-c&&(l+=360),this.orientation=0>c-h?_.CW:_.CCW,this.angle=m.FromDegrees(this.orientation===_.CW?h-l:l-h)}return e}();e.Arc2=g;var v=function(){function e(e,t){this._points=new Array,this._length=0,this.closed=!1,this._points.push(new n(e,t))}return e.prototype.addLineTo=function(e,t){if(closed)return this;var i=new n(e,t),r=this._points[this._points.length-1];return this._points.push(i),this._length+=i.subtract(r).length(),this},e.prototype.addArcTo=function(e,t,i,r,o){if(void 0===o&&(o=36),closed)return this;var s=this._points[this._points.length-1],a=new n(e,t),h=new n(i,r),c=new g(s,a,h),l=c.angle.radians()/o;c.orientation===_.CW&&(l*=-1);for(var u=c.startAngle.radians()+l,f=0;o>f;f++){var d=Math.cos(u)*c.radius+c.centerPoint.x,p=Math.sin(u)*c.radius+c.centerPoint.y;this.addLineTo(d,p),u+=l}return this},e.prototype.close=function(){return this.closed=!0,this},e.prototype.length=function(){var e=this._length;if(!this.closed){var t=this._points[this._points.length-1],i=this._points[0];e+=i.subtract(t).length()}return e},e.prototype.getPoints=function(){return this._points},e.prototype.getPointAtLengthPosition=function(e){if(0>e||e>1)return n.Zero();for(var t=e*this.length(),i=0,r=0;r<this._points.length;r++){var o=(r+1)%this._points.length,s=this._points[r],a=this._points[o],h=a.subtract(s),c=h.length()+i;if(t>=i&&c>=t){var l=h.normalize(),u=t-i;return new n(s.x+l.x*u,s.y+l.y*u)}i=c}return n.Zero()},e.StartingAt=function(t,i){return new e(t,i)},e}();e.Path2=v;var y=function(){function i(e,t,i){this.path=e,this._curve=new Array,this._distances=new Array,this._tangents=new Array,this._normals=new Array,this._binormals=new Array;for(var r=0;r<e.length;r++)this._curve[r]=e[r].clone();this._raw=i||!1,this._compute(t)}return i.prototype.getCurve=function(){return this._curve},i.prototype.getTangents=function(){return this._tangents},i.prototype.getNormals=function(){return this._normals},i.prototype.getBinormals=function(){return this._binormals},i.prototype.getDistances=function(){return this._distances},i.prototype.update=function(e,t){for(var i=0;i<e.length;i++)this._curve[i].x=e[i].x,this._curve[i].y=e[i].y,this._curve[i].z=e[i].z;return this._compute(t),this},i.prototype._compute=function(e){var t=this._curve.length;this._tangents[0]=this._getFirstNonNullVector(0),this._raw||this._tangents[0].normalize(),this._tangents[t-1]=this._curve[t-1].subtract(this._curve[t-2]),this._raw||this._tangents[t-1].normalize();var i=this._tangents[0],r=this._normalVector(this._curve[0],i,e);this._normals[0]=r,this._raw||this._normals[0].normalize(),this._binormals[0]=o.Cross(i,this._normals[0]),this._raw||this._binormals[0].normalize(),this._distances[0]=0;for(var n,s,a,h,c=1;t>c;c++)n=this._getLastNonNullVector(c),t-1>c&&(s=this._getFirstNonNullVector(c),this._tangents[c]=n.add(s),this._tangents[c].normalize()),this._distances[c]=this._distances[c-1]+n.length(),a=this._tangents[c],h=this._binormals[c-1],this._normals[c]=o.Cross(h,a),this._raw||this._normals[c].normalize(),this._binormals[c]=o.Cross(a,this._normals[c]),this._raw||this._binormals[c].normalize()},i.prototype._getFirstNonNullVector=function(e){for(var t=1,i=this._curve[e+t].subtract(this._curve[e]);0===i.length()&&e+t+1<this._curve.length;)t++,i=this._curve[e+t].subtract(this._curve[e]);return i},i.prototype._getLastNonNullVector=function(e){for(var t=1,i=this._curve[e].subtract(this._curve[e-t]);0===i.length()&&e>t+1;)t++,i=this._curve[e].subtract(this._curve[e-t]);return i},i.prototype._normalVector=function(i,r,n){var s;if(void 0===n||null===n){var a;t.WithinEpsilon(r.y,1,e.Epsilon)?t.WithinEpsilon(r.x,1,e.Epsilon)?t.WithinEpsilon(r.z,1,e.Epsilon)||(a=new o(0,0,1)):a=new o(1,0,0):a=new o(0,-1,0),s=o.Cross(r,a)}else s=o.Cross(r,n),o.CrossToRef(s,r,s);return s.normalize(),s},i}();e.Path3D=y;var x=function(){function e(e){this._length=0,this._points=e,this._length=this._computeLength(e)}return e.CreateQuadraticBezier=function(t,i,r,n){n=n>2?n:3;for(var s=new Array,a=function(e,t,i,r){var n=(1-e)*(1-e)*t+2*e*(1-e)*i+e*e*r;return n},h=0;n>=h;h++)s.push(new o(a(h/n,t.x,i.x,r.x),a(h/n,t.y,i.y,r.y),a(h/n,t.z,i.z,r.z)));return new e(s)},e.CreateCubicBezier=function(t,i,r,n,s){s=s>3?s:4;for(var a=new Array,h=function(e,t,i,r,n){var o=(1-e)*(1-e)*(1-e)*t+3*e*(1-e)*(1-e)*i+3*e*e*(1-e)*r+e*e*e*n;return o},c=0;s>=c;c++)a.push(new o(h(c/s,t.x,i.x,r.x,n.x),h(c/s,t.y,i.y,r.y,n.y),h(c/s,t.z,i.z,r.z,n.z)));return new e(a)},e.CreateHermiteSpline=function(t,i,r,n,s){for(var a=new Array,h=1/s,c=0;s>=c;c++)a.push(o.Hermite(t,i,r,n,c*h));return new e(a)},e.prototype.getPoints=function(){return this._points},e.prototype.length=function(){return this._length},e.prototype["continue"]=function(t){for(var i=this._points[this._points.length-1],r=this._points.slice(),n=t.getPoints(),o=1;o<n.length;o++)r.push(n[o].subtract(n[0]).add(i));var s=new e(r);return s},e.prototype._computeLength=function(e){for(var t=0,i=1;i<e.length;i++)t+=e[i].subtract(e[i-1]).length();return t},e}();e.Curve3=x;var b=function(){function e(){this.L00=o.Zero(),this.L1_1=o.Zero(),this.L10=o.Zero(),this.L11=o.Zero(),this.L2_2=o.Zero(),this.L2_1=o.Zero(),this.L20=o.Zero(),this.L21=o.Zero(),this.L22=o.Zero()}return e.prototype.addLight=function(e,t,i){var r=new o(t.r,t.g,t.b),n=r.scale(i);this.L00=this.L00.add(n.scale(.282095)),this.L1_1=this.L1_1.add(n.scale(.488603*e.y)),this.L10=this.L10.add(n.scale(.488603*e.z)),this.L11=this.L11.add(n.scale(.488603*e.x)),this.L2_2=this.L2_2.add(n.scale(1.092548*e.x*e.y)),this.L2_1=this.L2_1.add(n.scale(1.092548*e.y*e.z)),this.L21=this.L21.add(n.scale(1.092548*e.x*e.z)),this.L20=this.L20.add(n.scale(.315392*(3*e.z*e.z-1))),this.L22=this.L22.add(n.scale(.546274*(e.x*e.x-e.y*e.y)))},e.prototype.scale=function(e){this.L00=this.L00.scale(e),this.L1_1=this.L1_1.scale(e),this.L10=this.L10.scale(e),this.L11=this.L11.scale(e),this.L2_2=this.L2_2.scale(e),this.L2_1=this.L2_1.scale(e),this.L20=this.L20.scale(e),this.L21=this.L21.scale(e),this.L22=this.L22.scale(e)},e}();e.SphericalHarmonics=b;var P=function(){function e(){this.x=o.Zero(),this.y=o.Zero(),this.z=o.Zero(),this.xx=o.Zero(),this.yy=o.Zero(),this.zz=o.Zero(),this.xy=o.Zero(),this.yz=o.Zero(),this.zx=o.Zero()}return e.prototype.addAmbient=function(e){var t=new o(e.r,e.g,e.b);this.xx=this.xx.add(t),this.yy=this.yy.add(t),this.zz=this.zz.add(t)},e.getSphericalPolynomialFromHarmonics=function(t){var i=new e;return i.x=t.L11.scale(1.02333),i.y=t.L1_1.scale(1.02333),i.z=t.L10.scale(1.02333),i.xx=t.L00.scale(.886277).subtract(t.L20.scale(.247708)).add(t.L22.scale(.429043)),i.yy=t.L00.scale(.886277).subtract(t.L20.scale(.247708)).subtract(t.L22.scale(.429043)),i.zz=t.L00.scale(.886277).add(t.L20.scale(.495417)),i.yz=t.L2_1.scale(.858086),i.zx=t.L21.scale(.858086),i.xy=t.L2_2.scale(.858086),i},e}();e.SphericalPolynomial=P;var A=function(){function e(e,t){void 0===e&&(e=o.Zero()),void 0===t&&(t=o.Up()),this.position=e,this.normal=t}return e.prototype.clone=function(){return new e(this.position.clone(),this.normal.clone())},e}();e.PositionNormalVertex=A;var T=function(){function e(e,t,i){void 0===e&&(e=o.Zero()),void 0===t&&(t=o.Up()),void 0===i&&(i=n.Zero()),this.position=e,this.normal=t,this.uv=i}return e.prototype.clone=function(){return new e(this.position.clone(),this.normal.clone(),this.uv.clone())},e}();e.PositionNormalTextureVertex=T;var E=function(){function e(){}return e.Color3=[i.Black(),i.Black(),i.Black()],e.Vector2=[n.Zero(),n.Zero(),n.Zero()],e.Vector3=[o.Zero(),o.Zero(),o.Zero(),o.Zero(),o.Zero(),o.Zero(),o.Zero(),o.Zero(),o.Zero()],e.Vector4=[s.Zero(),s.Zero(),s.Zero()],e.Quaternion=[new h(0,0,0,0)],e.Matrix=[c.Zero(),c.Zero(),c.Zero(),c.Zero(),c.Zero(),c.Zero(),c.Zero(),c.Zero()],e}();e.Tmp=E}(BABYLON||(BABYLON={}));var BABYLON;!function(e){function t(e,t){return function(i,r){i.__serializableMembers||(i.__serializableMembers={}),i.__serializableMembers[r]={type:e,sourceName:t}}}function i(e){return t(0,e)}function r(e){return t(1,e)}function n(e){return t(2,e)}function o(e){return t(3,e)}function s(e){return t(4,e)}function a(e){return t(5,e)}function h(e){return t(6,e)}function c(e){return t(7,e)}e.serialize=i,e.serializeAsTexture=r,e.serializeAsColor3=n,e.serializeAsFresnelParameters=o,e.serializeAsVector2=s,e.serializeAsVector3=a,e.serializeAsMeshReference=h,e.serializeAsColorCurves=c;var l=function(){function t(){}return t.Serialize=function(t,i){i||(i={}),i.tags=e.Tags.GetTags(t);for(var r in t.__serializableMembers){var n=t.__serializableMembers[r],o=n.sourceName||r,s=n.type,a=t[r];if(void 0!==a&&null!==a)switch(s){case 0:i[o]=a;break;case 1:i[o]=a.serialize();break;case 2:i[o]=a.asArray();break;case 3:i[o]=a.serialize();break;case 4:i[o]=a.asArray();break;case 5:i[o]=a.asArray();break;case 6:i[o]=a.id;break;case 7:i[o]=a.serialize()}}return i},t.Parse=function(t,i,r,n){var o=t();e.Tags.AddTagsTo(o,i.tags);for(var s in o.__serializableMembers){var a=o.__serializableMembers[s],h=i[a.sourceName||s],c=a.type;if(void 0!==h&&null!==h)switch(c){case 0:o[s]=h;break;case 1:o[s]=e.Texture.Parse(h,r,n);break;case 2:o[s]=e.Color3.FromArray(h);break;case 3:o[s]=e.FresnelParameters.Parse(h);break;case 4:o[s]=e.Vector2.FromArray(h);break;case 5:o[s]=e.Vector3.FromArray(h);break;case 6:o[s]=r.getLastMeshByID(h);break;case 7:o[s]=e.ColorCurves.Parse(h)}}return o},t.Clone=function(t,i){var r=t();e.Tags.AddTagsTo(r,i.tags);for(var n in r.__serializableMembers){var o=r.__serializableMembers[n],s=i[n],a=o.type;if(void 0!==s&&null!==s)switch(a){case 0:case 6:r[n]=s;break;case 1:case 2:case 3:case 4:case 5:case 7:r[n]=s.clone()}}return r},t}();e.SerializationHelper=l}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function e(e,t){void 0===t&&(t=!1),this.mask=e,this.skipNextObservers=t}return e}();e.EventState=t;var i=function(){function e(e,t){this.callback=e,this.mask=t}return e}();e.Observer=i;var r=function(){function e(){this._observers=new Array}return e.prototype.add=function(e,t,r){if(void 0===t&&(t=-1),void 0===r&&(r=!1),!e)return null;var n=new i(e,t);return r?this._observers.unshift(n):this._observers.push(n),n},e.prototype.remove=function(e){var t=this._observers.indexOf(e);return-1!==t?(this._observers.splice(t,1),!0):!1},e.prototype.removeCallback=function(e){for(var t=0;t<this._observers.length;t++)if(this._observers[t].callback===e)return this._observers.splice(t,1),!0;return!1},e.prototype.notifyObservers=function(e,i){void 0===i&&(i=-1);for(var r=new t(i),n=0,o=this._observers;n<o.length;n++){var s=o[n];if(s.mask&i&&s.callback(e,r),r.skipNextObservers)break}},e.prototype.hasObservers=function(){return this._observers.length>0},e.prototype.clear=function(){this._observers=new Array},e.prototype.clone=function(){var t=new e;return t._observers=this._observers.slice(0),t},e}();e.Observable=r}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(e,i){this.idbFactory=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,this.callbackManifestChecked=i,this.currentSceneUrl=t.ReturnFullUrlLocation(e),this.db=null,this.enableSceneOffline=!1,this.enableTexturesOffline=!1,this.manifestVersionFound=0,this.mustUpdateRessources=!1,this.hasReachedQuota=!1,t.IDBStorageEnabled?this.checkManifestFile():this.callbackManifestChecked(!0)}return t.prototype.checkManifestFile=function(){function t(){r.enableSceneOffline=!1,r.enableTexturesOffline=!1,r.callbackManifestChecked(!1)}var i=this,r=this,n=!1,o=this.currentSceneUrl+".manifest",s=new XMLHttpRequest;navigator.onLine&&(n=!0,o=o+(null==o.match(/\?/)?"?":"&")+(new Date).getTime()),s.open("GET",o,!0),s.addEventListener("load",function(){if(200===s.status||e.Tools.ValidateXHRData(s,1))try{var r=JSON.parse(s.response);i.enableSceneOffline=r.enableSceneOffline,i.enableTexturesOffline=r.enableTexturesOffline,r.version&&!isNaN(parseInt(r.version))&&(i.manifestVersionFound=r.version),i.callbackManifestChecked&&i.callbackManifestChecked(!0)}catch(n){t()}else t()},!1),s.addEventListener("error",function(e){if(n){n=!1;var r=i.currentSceneUrl+".manifest";s.open("GET",r,!0),s.send()}else t()},!1);try{s.send()}catch(a){e.Tools.Error("Error on XHR send request."),r.callbackManifestChecked(!1)}},t.prototype.openAsync=function(t,i){function r(){o.isSupported=!1,i&&i()}var n=this,o=this;if(this.idbFactory&&(this.enableSceneOffline||this.enableTexturesOffline))if(this.db)t&&t();else{this.hasReachedQuota=!1,this.isSupported=!0;var s=this.idbFactory.open("babylonjs",1);s.onerror=function(e){r()},s.onblocked=function(t){e.Tools.Error("IDB request blocked. Please reload the page."),r()},s.onsuccess=function(e){n.db=s.result,t()},s.onupgradeneeded=function(t){n.db=t.target.result;try{n.db.createObjectStore("scenes",{keyPath:"sceneUrl"}),n.db.createObjectStore("versions",{keyPath:"sceneUrl"}),n.db.createObjectStore("textures",{keyPath:"textureUrl"})}catch(i){e.Tools.Error("Error while creating object stores. Exception: "+i.message),r()}}}else this.isSupported=!1,i&&i()},t.prototype.loadImageFromDB=function(e,i){var r=this,n=t.ReturnFullUrlLocation(e),o=function(){r.hasReachedQuota||null===r.db?i.src=e:r._saveImageIntoDBAsync(n,i)};this.mustUpdateRessources?o():this._loadImageFromDBAsync(n,i,o)},t.prototype._loadImageFromDBAsync=function(t,i,r){if(this.isSupported&&null!==this.db){var n,o=this.db.transaction(["textures"]);o.onabort=function(e){i.src=t},o.oncomplete=function(o){var s;if(n){var a=window.URL||window.webkitURL;s=a.createObjectURL(n.data,{oneTimeOnly:!0}),i.onerror=function(){e.Tools.Error("Error loading image from blob URL: "+s+" switching back to web url: "+t),i.src=t},i.src=s}else r()};var s=o.objectStore("textures").get(t);s.onsuccess=function(e){n=e.target.result},s.onerror=function(r){e.Tools.Error("Error loading texture "+t+" from DB."),i.src=t}}else e.Tools.Error("Error: IndexedDB not supported by your browser or BabylonJS Database is not open."),i.src=t},t.prototype._saveImageIntoDBAsync=function(i,r){var n=this;if(this.isSupported){var o=function(){var e;if(s){var t=window.URL||window.webkitURL;try{e=t.createObjectURL(s,{oneTimeOnly:!0})}catch(i){e=t.createObjectURL(s)}}r.src=e};if(t.IsUASupportingBlobStorage){var s,a=new XMLHttpRequest;a.open("GET",i,!0),a.responseType="blob",a.addEventListener("load",function(){if(200===a.status){s=a.response;var e=n.db.transaction(["textures"],"readwrite");e.onabort=function(e){try{e.srcElement.error&&"QuotaExceededError"===e.srcElement.error.name&&(this.hasReachedQuota=!0)}catch(t){}o()},e.oncomplete=function(e){o()};var h={textureUrl:i,data:s};try{var c=e.objectStore("textures").put(h);c.onsuccess=function(e){},c.onerror=function(e){o()}}catch(l){25===l.code&&(t.IsUASupportingBlobStorage=!1),r.src=i}}else r.src=i},!1),a.addEventListener("error",function(t){e.Tools.Error("Error in XHR request in BABYLON.Database."),r.src=i},!1),a.send()}else r.src=i}else e.Tools.Error("Error: IndexedDB not supported by your browser or BabylonJS Database is not open."),r.src=i},t.prototype._checkVersionFromDB=function(e,t){var i=this,r=function(r){i._saveVersionIntoDBAsync(e,t)};this._loadVersionFromDBAsync(e,t,r)},t.prototype._loadVersionFromDBAsync=function(t,i,r){var n=this;if(this.isSupported){var o;try{var s=this.db.transaction(["versions"]);s.oncomplete=function(e){o?n.manifestVersionFound>o.data?(n.mustUpdateRessources=!0,r()):i(o.data):(n.mustUpdateRessources=!0,r())},s.onabort=function(e){i(-1)};var a=s.objectStore("versions").get(t);a.onsuccess=function(e){o=e.target.result},a.onerror=function(r){e.Tools.Error("Error loading version for scene "+t+" from DB."),i(-1)}}catch(h){e.Tools.Error("Error while accessing 'versions' object store (READ OP). Exception: "+h.message),i(-1)}}else e.Tools.Error("Error: IndexedDB not supported by your browser or BabylonJS Database is not open."),i(-1)},t.prototype._saveVersionIntoDBAsync=function(t,i){var r=this;if(this.isSupported&&!this.hasReachedQuota)try{var n=this.db.transaction(["versions"],"readwrite");n.onabort=function(e){try{e.srcElement.error&&"QuotaExceededError"===e.srcElement.error.name&&(r.hasReachedQuota=!0)}catch(t){}i(-1)},n.oncomplete=function(e){i(r.manifestVersionFound)};var o={sceneUrl:t,data:this.manifestVersionFound},s=n.objectStore("versions").put(o);s.onsuccess=function(e){},s.onerror=function(t){e.Tools.Error("Error in DB add version request in BABYLON.Database.")}}catch(a){e.Tools.Error("Error while accessing 'versions' object store (WRITE OP). Exception: "+a.message),i(-1)}else i(-1)},t.prototype.loadFileFromDB=function(e,i,r,n,o){var s=this,a=t.ReturnFullUrlLocation(e),h=function(e){s._saveFileIntoDBAsync(a,i,r)};this._checkVersionFromDB(a,function(e){-1!==e?s.mustUpdateRessources?s._saveFileIntoDBAsync(a,i,r,o):s._loadFileFromDBAsync(a,i,h,o):n()})},t.prototype._loadFileFromDBAsync=function(t,i,r,n){if(this.isSupported){var o;o=-1!==t.indexOf(".babylon")?"scenes":"textures";var s,a=this.db.transaction([o]);a.oncomplete=function(e){s?i(s.data):r()},a.onabort=function(e){r()};var h=a.objectStore(o).get(t);h.onsuccess=function(e){s=e.target.result},h.onerror=function(i){e.Tools.Error("Error loading file "+t+" from DB."),r()}}else e.Tools.Error("Error: IndexedDB not supported by your browser or BabylonJS Database is not open."),i()},t.prototype._saveFileIntoDBAsync=function(t,i,r,n){var o=this;if(this.isSupported){var s;s=-1!==t.indexOf(".babylon")?"scenes":"textures";var a,h=new XMLHttpRequest;h.open("GET",t,!0),n&&(h.responseType="arraybuffer"),h.onprogress=r,h.addEventListener("load",function(){if(200===h.status||e.Tools.ValidateXHRData(h,n?6:1))if(a=n?h.response:h.responseText,o.hasReachedQuota)i(a);else{var r=o.db.transaction([s],"readwrite");r.onabort=function(e){try{e.srcElement.error&&"QuotaExceededError"===e.srcElement.error.name&&(this.hasReachedQuota=!0)}catch(t){}i(a)},r.oncomplete=function(e){i(a)};var c;c="scenes"===s?{sceneUrl:t,data:a,version:o.manifestVersionFound}:{textureUrl:t,data:a};try{var l=r.objectStore(s).put(c);l.onsuccess=function(e){},l.onerror=function(t){e.Tools.Error("Error in DB add file request in BABYLON.Database.")}}catch(u){i(a)}}else i()},!1),h.addEventListener("error",function(t){e.Tools.Error("error on XHR request."),i()},!1),h.send()}else e.Tools.Error("Error: IndexedDB not supported by your browser or BabylonJS Database is not open."),i()},t.IsUASupportingBlobStorage=!0,t.IDBStorageEnabled=!0,t.parseURL=function(e){var t=document.createElement("a");t.href=e;var i=e.substring(0,e.lastIndexOf("#")),r=e.substring(i.lastIndexOf("/")+1,e.length),n=e.substring(0,e.indexOf(r,0));return n},t.ReturnFullUrlLocation=function(e){return-1===e.indexOf("http:/")?t.parseURL(window.location.href)+e:e},t}();e.Database=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t;!function(t){var i=function(){function t(){}return t.GetTGAHeader=function(e){var t=0,i={id_length:e[t++],colormap_type:e[t++],image_type:e[t++],
colormap_index:e[t++]|e[t++]<<8,colormap_length:e[t++]|e[t++]<<8,colormap_size:e[t++],origin:[e[t++]|e[t++]<<8,e[t++]|e[t++]<<8],width:e[t++]|e[t++]<<8,height:e[t++]|e[t++]<<8,pixel_size:e[t++],flags:e[t++]};return i},t.UploadContent=function(i,r){if(r.length<19)return void e.Tools.Error("Unable to load TGA file - Not enough data to contain header");var n=18,o=t.GetTGAHeader(r);if(o.id_length+n>r.length)return void e.Tools.Error("Unable to load TGA file - Not enough data");n+=o.id_length;var s=!1,a=!1,h=!1,c=!1;switch(o.image_type){case t._TYPE_RLE_INDEXED:s=!0;case t._TYPE_INDEXED:a=!0;break;case t._TYPE_RLE_RGB:s=!0;case t._TYPE_RGB:h=!0;break;case t._TYPE_RLE_GREY:s=!0;case t._TYPE_GREY:c=!0}var l,u,f=(15&o.flags,o.pixel_size>>3),d=o.width*o.height*f;if(a&&(u=r.subarray(n,n+=o.colormap_length*(o.colormap_size>>3))),s){l=new Uint8Array(d);for(var p,_,m,g=0,v=new Uint8Array(f);d>n&&d>g;)if(p=r[n++],_=(127&p)+1,128&p){for(m=0;f>m;++m)v[m]=r[n++];for(m=0;_>m;++m)l.set(v,g+m*f);g+=f*_}else{for(_*=f,m=0;_>m;++m)l[g+m]=r[n++];g+=_}}else l=r.subarray(n,n+=a?o.width*o.height:d);var y,x,b,P,A,T;switch((o.flags&t._ORIGIN_MASK)>>t._ORIGIN_SHIFT){default:case t._ORIGIN_UL:y=0,b=1,T=o.width,x=0,P=1,A=o.height;break;case t._ORIGIN_BL:y=0,b=1,T=o.width,x=o.height-1,P=-1,A=-1;break;case t._ORIGIN_UR:y=o.width-1,b=-1,T=-1,x=0,P=1,A=o.height;break;case t._ORIGIN_BR:y=o.width-1,b=-1,T=-1,x=o.height-1,P=-1,A=-1}var E="_getImageData"+(c?"Grey":"")+o.pixel_size+"bits",C=t[E](o,u,l,x,P,A,y,b,T);i.texImage2D(i.TEXTURE_2D,0,i.RGBA,o.width,o.height,0,i.RGBA,i.UNSIGNED_BYTE,C)},t._getImageData8bits=function(e,t,i,r,n,o,s,a,h){var c,l,u,f=i,d=t,p=e.width,_=e.height,m=0,g=new Uint8Array(p*_*4);for(u=r;u!==o;u+=n)for(l=s;l!==h;l+=a,m++)c=f[m],g[4*(l+p*u)+3]=255,g[4*(l+p*u)+2]=d[3*c+0],g[4*(l+p*u)+1]=d[3*c+1],g[4*(l+p*u)+0]=d[3*c+2];return g},t._getImageData16bits=function(e,t,i,r,n,o,s,a,h){var c,l,u,f=i,d=e.width,p=e.height,_=0,m=new Uint8Array(d*p*4);for(u=r;u!==o;u+=n)for(l=s;l!==h;l+=a,_+=2)c=f[_+0]+(f[_+1]<<8),m[4*(l+d*u)+0]=(31744&c)>>7,m[4*(l+d*u)+1]=(992&c)>>2,m[4*(l+d*u)+2]=(31&c)>>3,m[4*(l+d*u)+3]=32768&c?0:255;return m},t._getImageData24bits=function(e,t,i,r,n,o,s,a,h){var c,l,u=i,f=e.width,d=e.height,p=0,_=new Uint8Array(f*d*4);for(l=r;l!==o;l+=n)for(c=s;c!==h;c+=a,p+=3)_[4*(c+f*l)+3]=255,_[4*(c+f*l)+2]=u[p+0],_[4*(c+f*l)+1]=u[p+1],_[4*(c+f*l)+0]=u[p+2];return _},t._getImageData32bits=function(e,t,i,r,n,o,s,a,h){var c,l,u=i,f=e.width,d=e.height,p=0,_=new Uint8Array(f*d*4);for(l=r;l!==o;l+=n)for(c=s;c!==h;c+=a,p+=4)_[4*(c+f*l)+2]=u[p+0],_[4*(c+f*l)+1]=u[p+1],_[4*(c+f*l)+0]=u[p+2],_[4*(c+f*l)+3]=u[p+3];return _},t._getImageDataGrey8bits=function(e,t,i,r,n,o,s,a,h){var c,l,u,f=i,d=e.width,p=e.height,_=0,m=new Uint8Array(d*p*4);for(u=r;u!==o;u+=n)for(l=s;l!==h;l+=a,_++)c=f[_],m[4*(l+d*u)+0]=c,m[4*(l+d*u)+1]=c,m[4*(l+d*u)+2]=c,m[4*(l+d*u)+3]=255;return m},t._getImageDataGrey16bits=function(e,t,i,r,n,o,s,a,h){var c,l,u=i,f=e.width,d=e.height,p=0,_=new Uint8Array(f*d*4);for(l=r;l!==o;l+=n)for(c=s;c!==h;c+=a,p+=2)_[4*(c+f*l)+0]=u[p+0],_[4*(c+f*l)+1]=u[p+0],_[4*(c+f*l)+2]=u[p+0],_[4*(c+f*l)+3]=u[p+1];return _},t._TYPE_NO_DATA=0,t._TYPE_INDEXED=1,t._TYPE_RGB=2,t._TYPE_GREY=3,t._TYPE_RLE_INDEXED=9,t._TYPE_RLE_RGB=10,t._TYPE_RLE_GREY=11,t._ORIGIN_MASK=48,t._ORIGIN_SHIFT=4,t._ORIGIN_BL=0,t._ORIGIN_BR=1,t._ORIGIN_UL=2,t._ORIGIN_UR=3,t}();t.TGATools=i}(t=e.Internals||(e.Internals={}))}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function e(t){this.length=0,this._duplicateId=0,this.data=new Array(t),this._id=e._GlobalId++}return e.prototype.push=function(e){this.data[this.length++]=e,this.length>this.data.length&&(this.data.length*=2),e.__smartArrayFlags||(e.__smartArrayFlags={}),e.__smartArrayFlags[this._id]=this._duplicateId},e.prototype.pushNoDuplicate=function(e){return e.__smartArrayFlags&&e.__smartArrayFlags[this._id]===this._duplicateId?!1:(this.push(e),!0)},e.prototype.sort=function(e){this.data.sort(e)},e.prototype.reset=function(){this.length=0,this._duplicateId++},e.prototype.concat=function(e){if(0!==e.length){this.length+e.length>this.data.length&&(this.data.length=2*(this.length+e.length));for(var t=0;t<e.length;t++)this.data[this.length++]=(e.data||e)[t]}},e.prototype.concatWithNoDuplicate=function(e){if(0!==e.length){this.length+e.length>this.data.length&&(this.data.length=2*(this.length+e.length));for(var t=0;t<e.length;t++){var i=(e.data||e)[t];this.pushNoDuplicate(i)}}},e.prototype.indexOf=function(e){var t=this.data.indexOf(e);return t>=this.length?-1:t},e._GlobalId=0,e}();e.SmartArray=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function e(){this._count=0,this._data={}}return e.prototype.get=function(e){var t=this._data[e];return void 0!==t?t:void 0},e.prototype.getOrAddWithFactory=function(e,t){var i=this.get(e);return void 0!==i?i:(i=t(e),i&&this.add(e,i),i)},e.prototype.getOrAdd=function(e,t){var i=this.get(e);return void 0!==i?i:(this.add(e,t),t)},e.prototype.contains=function(e){return void 0!==this._data[e]},e.prototype.add=function(e,t){return void 0!==this._data[e]?!1:(this._data[e]=t,++this._count,!0)},e.prototype.set=function(e,t){return void 0===this._data[e]?!1:(this._data[e]=t,!0)},e.prototype.remove=function(e){return this.contains(e)?(delete this._data[e],--this._count,!0):!1},e.prototype.clear=function(){this._data={},this._count=0},Object.defineProperty(e.prototype,"count",{get:function(){return this._count},enumerable:!0,configurable:!0}),e.prototype.forEach=function(e){for(var t in this._data){var i=this._data[t];e(t,i)}},e.prototype.first=function(e){for(var t in this._data){var i=this._data[t],r=e(t,i);if(r)return r}return null},e}();e.StringDictionary=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){function t(e){return function(t){t.__bjsclassName__=e}}var i,r=function(t,i){return t?t instanceof e.Mesh?null:t instanceof e.SubMesh?t.clone(i):t.clone?t.clone():null:null},n=function(){function t(){}return t.Instantiate=function(e){for(var t=e.split("."),i=window||this,r=0,n=t.length;n>r;r++)i=i[t[r]];return"function"!=typeof i?null:i},t.SetImmediate=function(e){window.setImmediate?window.setImmediate(e):setTimeout(e,1)},t.IsExponentOfTwo=function(e){var t=1;do t*=2;while(e>t);return t===e},t.GetExponentOfTwo=function(e,t){var i=1;do i*=2;while(e>i);return i>t&&(i=t),i},t.GetFilename=function(e){var t=e.lastIndexOf("/");return 0>t?e:e.substring(t+1)},t.GetDOMTextContent=function(e){for(var t="",i=e.firstChild;i;)3===i.nodeType&&(t+=i.textContent),i=i.nextSibling;return t},t.ToDegrees=function(e){return 180*e/Math.PI},t.ToRadians=function(e){return e*Math.PI/180},t.EncodeArrayBufferTobase64=function(e){for(var t,i,r,n,o,s,a,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="",l=0,u=new Uint8Array(e);l<u.length;)t=u[l++],i=l<u.length?u[l++]:Number.NaN,r=l<u.length?u[l++]:Number.NaN,n=t>>2,o=(3&t)<<4|i>>4,s=(15&i)<<2|r>>6,a=63&r,isNaN(i)?s=a=64:isNaN(r)&&(a=64),c+=h.charAt(n)+h.charAt(o)+h.charAt(s)+h.charAt(a);return"data:image/png;base64,"+c},t.ExtractMinAndMaxIndexed=function(t,i,r,n,o){void 0===o&&(o=null);for(var s=new e.Vector3(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),a=new e.Vector3(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),h=r;r+n>h;h++){var c=new e.Vector3(t[3*i[h]],t[3*i[h]+1],t[3*i[h]+2]);s=e.Vector3.Minimize(c,s),a=e.Vector3.Maximize(c,a)}return o&&(s.x-=s.x*o.x+o.y,s.y-=s.y*o.x+o.y,s.z-=s.z*o.x+o.y,a.x+=a.x*o.x+o.y,a.y+=a.y*o.x+o.y,a.z+=a.z*o.x+o.y),{minimum:s,maximum:a}},t.ExtractMinAndMax=function(t,i,r,n,o){void 0===n&&(n=null);var s=new e.Vector3(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),a=new e.Vector3(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);o||(o=3);for(var h=i;i+r>h;h++){var c=new e.Vector3(t[h*o],t[h*o+1],t[h*o+2]);s=e.Vector3.Minimize(c,s),a=e.Vector3.Maximize(c,a)}return n&&(s.x-=s.x*n.x+n.y,s.y-=s.y*n.x+n.y,s.z-=s.z*n.x+n.y,a.x+=a.x*n.x+n.y,a.y+=a.y*n.x+n.y,a.z+=a.z*n.x+n.y),{minimum:s,maximum:a}},t.Vector2ArrayFeeder=function(t){return function(i){var r=void 0!==t.BYTES_PER_ELEMENT,n=r?t.length/2:t.length;if(i>=n)return null;if(r){var o=t;return new e.Vector2(o[2*i+0],o[2*i+1])}var s=t;return s[i]}},t.ExtractMinAndMaxVector2=function(t,i){void 0===i&&(i=null);for(var r=new e.Vector2(Number.MAX_VALUE,Number.MAX_VALUE),n=new e.Vector2(-Number.MAX_VALUE,-Number.MAX_VALUE),o=0,s=t(o++);s;)r=e.Vector2.Minimize(s,r),n=e.Vector2.Maximize(s,n),s=t(o++);return i&&(r.x-=r.x*i.x+i.y,r.y-=r.y*i.x+i.y,n.x+=n.x*i.x+i.y,n.y+=n.y*i.x+i.y),{minimum:r,maximum:n}},t.MakeArray=function(e,t){return t===!0||void 0!==e&&null!=e?Array.isArray(e)?e:[e]:void 0},t.GetPointerPrefix=function(){var e="pointer";return window.PointerEvent||navigator.pointerEnabled||(e="mouse"),e},t.QueueNewFrame=function(e){window.requestAnimationFrame?window.requestAnimationFrame(e):window.msRequestAnimationFrame?window.msRequestAnimationFrame(e):window.webkitRequestAnimationFrame?window.webkitRequestAnimationFrame(e):window.mozRequestAnimationFrame?window.mozRequestAnimationFrame(e):window.oRequestAnimationFrame?window.oRequestAnimationFrame(e):window.setTimeout(e,16)},t.RequestFullscreen=function(e,t){var i=e.requestFullscreen||e.msRequestFullscreen||e.webkitRequestFullscreen||e.mozRequestFullScreen;i&&i.call(e,t)},t.ExitFullscreen=function(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msCancelFullScreen&&document.msCancelFullScreen()},t.CleanUrl=function(e){return e=e.replace(/#/gm,"%23")},t.LoadImage=function(i,r,n,o){i instanceof ArrayBuffer&&(i=t.EncodeArrayBufferTobase64(i)),i=t.CleanUrl(i);var s=new Image;if("data:"!==i.substr(0,5)&&t.CorsBehavior)switch(typeof t.CorsBehavior){case"function":var a=t.CorsBehavior(i);a&&(s.crossOrigin=a);break;case"string":default:s.crossOrigin=t.CorsBehavior}s.onload=function(){r(s)},s.onerror=function(e){t.Error("Error while trying to load texture: "+i),t.UseFallbackTexture?(s.src="data:image/jpg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QBmRXhpZgAATU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAAExAAIAAAAQAAAATgAAAAAAAABgAAAAAQAAAGAAAAABcGFpbnQubmV0IDQuMC41AP/bAEMABAIDAwMCBAMDAwQEBAQFCQYFBQUFCwgIBgkNCw0NDQsMDA4QFBEODxMPDAwSGBITFRYXFxcOERkbGRYaFBYXFv/bAEMBBAQEBQUFCgYGChYPDA8WFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFv/AABEIAQABAAMBIgACEQEDEQH/xAAfAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgv/xAC1EAACAQMDAgQDBQUEBAAAAX0BAgMABBEFEiExQQYTUWEHInEUMoGRoQgjQrHBFVLR8CQzYnKCCQoWFxgZGiUmJygpKjQ1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4eLj5OXm5+jp6vHy8/T19vf4+fr/xAAfAQADAQEBAQEBAQEBAAAAAAAAAQIDBAUGBwgJCgv/xAC1EQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/APH6KKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76P//Z",r(s)):n()};var h=function(){s.src=i},c=function(){o.loadImageFromDB(i,s)};if("data:"!==i.substr(0,5)&&o&&o.enableTexturesOffline&&e.Database.IsUASupportingBlobStorage)o.openAsync(c,h);else if(-1===i.indexOf("file:"))h();else try{var l,u=i.substring(5).toLowerCase();try{l=URL.createObjectURL(e.FilesInput.FilesTextures[u],{oneTimeOnly:!0})}catch(f){l=URL.createObjectURL(e.FilesInput.FilesTextures[u])}s.src=l}catch(d){s.src=null}return s},t.LoadFile=function(i,r,n,o,s,a){i=t.CleanUrl(i);var h=function(){var e=new XMLHttpRequest,o=t.BaseUrl+i;e.open("GET",o,!0),s&&(e.responseType="arraybuffer"),e.onprogress=n,e.onreadystatechange=function(){if(4===e.readyState)if(200===e.status||t.ValidateXHRData(e,s?6:1))r(s?e.response:e.responseText);else{if(!a)throw new Error("Error status: "+e.status+" - Unable to load "+o);a()}},e.send(null)},c=function(){o.loadFileFromDB(i,r,n,h,s)};if(-1!==i.indexOf("file:")){var l=i.substring(5).toLowerCase();t.ReadFile(e.FilesInput.FilesToLoad[l],r,n,s)}else o&&o.enableSceneOffline?o.openAsync(c,h):h()},t.ReadFileAsDataURL=function(e,t,i){var r=new FileReader;r.onload=function(e){t(e.target.result)},r.onprogress=i,r.readAsDataURL(e)},t.ReadFile=function(e,i,r,n){var o=new FileReader;o.onerror=function(r){t.Log("Error while reading file: "+e.name),i(JSON.stringify({autoClear:!0,clearColor:[1,0,0],ambientColor:[0,0,0],gravity:[0,-9.807,0],meshes:[],cameras:[],lights:[]}))},o.onload=function(e){i(e.target.result)},o.onprogress=r,n?o.readAsArrayBuffer(e):o.readAsText(e)},t.FileAsURL=function(e){var t=new Blob([e]),i=window.URL||window.webkitURL,r=i.createObjectURL(t);return r},t.Format=function(e,t){return void 0===t&&(t=2),e.toFixed(t)},t.CheckExtends=function(e,t,i){e.x<t.x&&(t.x=e.x),e.y<t.y&&(t.y=e.y),e.z<t.z&&(t.z=e.z),e.x>i.x&&(i.x=e.x),e.y>i.y&&(i.y=e.y),e.z>i.z&&(i.z=e.z)},t.DeepCopy=function(e,t,i,n){for(var o in e)if(("_"!==o[0]||n&&-1!==n.indexOf(o))&&(!i||-1===i.indexOf(o))){var s=e[o],a=typeof s;if("function"!==a)if("object"===a)if(s instanceof Array){if(t[o]=[],s.length>0)if("object"==typeof s[0])for(var h=0;h<s.length;h++){var c=r(s[h],t);-1===t[o].indexOf(c)&&t[o].push(c)}else t[o]=s.slice(0)}else t[o]=r(s,t);else t[o]=s}},t.IsEmpty=function(e){for(var t in e)return!1;return!0},t.RegisterTopRootEvents=function(e){for(var t=0;t<e.length;t++){var i=e[t];window.addEventListener(i.name,i.handler,!1);try{window.parent&&window.parent.addEventListener(i.name,i.handler,!1)}catch(r){}}},t.UnregisterTopRootEvents=function(e){for(var t=0;t<e.length;t++){var i=e[t];window.removeEventListener(i.name,i.handler);try{window.parent&&window.parent.removeEventListener(i.name,i.handler)}catch(r){}}},t.DumpFramebuffer=function(e,t,r,n){for(var o=4*e,s=t/2,a=r.readPixels(0,0,e,t),h=0;s>h;h++)for(var c=0;o>c;c++){var l=c+h*o,u=t-h-1,f=c+u*o,d=a[l];a[l]=a[f],a[f]=d}i||(i=document.createElement("canvas")),i.width=e,i.height=t;var p=i.getContext("2d"),_=p.createImageData(e,t),m=_.data;m.set(a),p.putImageData(_,0,0);var g=i.toDataURL();if(n)n(g);else if("download"in document.createElement("a")){var v=window.document.createElement("a");v.href=g;var y=new Date,x=(y.getFullYear()+"-"+(y.getMonth()+1)).slice(-2)+"-"+y.getDate()+"_"+y.getHours()+"-"+("0"+y.getMinutes()).slice(-2);v.setAttribute("download","screenshot_"+x+".png"),window.document.body.appendChild(v),v.addEventListener("click",function(){v.parentElement.removeChild(v)}),v.click()}else{var b=window.open(""),P=b.document.createElement("img");P.src=g,b.document.body.appendChild(P)}},t.CreateScreenshot=function(i,r,n,o){var s,a;if(n.precision)s=Math.round(i.getRenderWidth()*n.precision),a=Math.round(s/i.getAspectRatio(r)),n={width:s,height:a};else if(n.width&&n.height)s=n.width,a=n.height;else if(n.width&&!n.height)s=n.width,a=Math.round(s/i.getAspectRatio(r)),n={width:s,height:a};else if(n.height&&!n.width)a=n.height,s=Math.round(a*i.getAspectRatio(r)),n={width:s,height:a};else{if(isNaN(n))return void t.Error("Invalid 'size' parameter !");a=n,s=n}var h=r.getScene(),c=null;h.activeCamera!==r&&(c=h.activeCamera,h.activeCamera=r);var l=new e.RenderTargetTexture("screenShot",n,h,!1,!1);l.renderList=h.meshes,l.onAfterRenderObservable.add(function(){t.DumpFramebuffer(s,a,i,o)}),h.incrementRenderId(),h.resetCachedMaterial(),l.render(!0),l.dispose(),c&&(h.activeCamera=c),r.getProjectionMatrix(!0)},t.ValidateXHRData=function(t,i){void 0===i&&(i=7);try{if(1&i){if(t.responseText&&t.responseText.length>0)return!0;if(1===i)return!1}if(2&i){var r=e.Internals.TGATools.GetTGAHeader(t.response);if(r.width&&r.height&&r.width>0&&r.height>0)return!0;if(2===i)return!1}if(4&i){var n=new Uint8Array(t.response,0,3);return 68===n[0]&&68===n[1]&&83===n[2]}}catch(o){}return!1},Object.defineProperty(t,"NoneLogLevel",{get:function(){return t._NoneLogLevel},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MessageLogLevel",{get:function(){return t._MessageLogLevel},enumerable:!0,configurable:!0}),Object.defineProperty(t,"WarningLogLevel",{get:function(){return t._WarningLogLevel},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ErrorLogLevel",{get:function(){return t._ErrorLogLevel},enumerable:!0,configurable:!0}),Object.defineProperty(t,"AllLogLevel",{get:function(){return t._MessageLogLevel|t._WarningLogLevel|t._ErrorLogLevel},enumerable:!0,configurable:!0}),t._AddLogEntry=function(e){t._LogCache=e+t._LogCache,t.OnNewCacheEntry&&t.OnNewCacheEntry(e)},t._FormatMessage=function(e){var t=function(e){return 10>e?"0"+e:""+e},i=new Date;return"["+t(i.getHours())+":"+t(i.getMinutes())+":"+t(i.getSeconds())+"]: "+e},t._LogDisabled=function(e){},t._LogEnabled=function(e){var i=t._FormatMessage(e);console.log("BJS - "+i);var r="<div style='color:white'>"+i+"</div><br>";t._AddLogEntry(r)},t._WarnDisabled=function(e){},t._WarnEnabled=function(e){var i=t._FormatMessage(e);console.warn("BJS - "+i);var r="<div style='color:orange'>"+i+"</div><br>";t._AddLogEntry(r)},t._ErrorDisabled=function(e){},t._ErrorEnabled=function(e){t.errorsCount++;var i=t._FormatMessage(e);console.error("BJS - "+i);var r="<div style='color:red'>"+i+"</div><br>";t._AddLogEntry(r)},Object.defineProperty(t,"LogCache",{get:function(){return t._LogCache},enumerable:!0,configurable:!0}),t.ClearLogCache=function(){t._LogCache="",t.errorsCount=0},Object.defineProperty(t,"LogLevels",{set:function(e){(e&t.MessageLogLevel)===t.MessageLogLevel?t.Log=t._LogEnabled:t.Log=t._LogDisabled,(e&t.WarningLogLevel)===t.WarningLogLevel?t.Warn=t._WarnEnabled:t.Warn=t._WarnDisabled,(e&t.ErrorLogLevel)===t.ErrorLogLevel?t.Error=t._ErrorEnabled:t.Error=t._ErrorDisabled},enumerable:!0,configurable:!0}),Object.defineProperty(t,"PerformanceNoneLogLevel",{get:function(){return t._PerformanceNoneLogLevel},enumerable:!0,configurable:!0}),Object.defineProperty(t,"PerformanceUserMarkLogLevel",{get:function(){return t._PerformanceUserMarkLogLevel},enumerable:!0,configurable:!0}),Object.defineProperty(t,"PerformanceConsoleLogLevel",{get:function(){return t._PerformanceConsoleLogLevel},enumerable:!0,configurable:!0}),Object.defineProperty(t,"PerformanceLogLevel",{set:function(e){return(e&t.PerformanceUserMarkLogLevel)===t.PerformanceUserMarkLogLevel?(t.StartPerformanceCounter=t._StartUserMark,void(t.EndPerformanceCounter=t._EndUserMark)):(e&t.PerformanceConsoleLogLevel)===t.PerformanceConsoleLogLevel?(t.StartPerformanceCounter=t._StartPerformanceConsole,void(t.EndPerformanceCounter=t._EndPerformanceConsole)):(t.StartPerformanceCounter=t._StartPerformanceCounterDisabled,void(t.EndPerformanceCounter=t._EndPerformanceCounterDisabled))},enumerable:!0,configurable:!0}),t._StartPerformanceCounterDisabled=function(e,t){},t._EndPerformanceCounterDisabled=function(e,t){},t._StartUserMark=function(e,i){void 0===i&&(i=!0),i&&t._performance.mark&&t._performance.mark(e+"-Begin")},t._EndUserMark=function(e,i){void 0===i&&(i=!0),i&&t._performance.mark&&(t._performance.mark(e+"-End"),t._performance.measure(e,e+"-Begin",e+"-End"))},t._StartPerformanceConsole=function(e,i){void 0===i&&(i=!0),i&&(t._StartUserMark(e,i),console.time&&console.time(e))},t._EndPerformanceConsole=function(e,i){void 0===i&&(i=!0),i&&(t._EndUserMark(e,i),console.time&&console.timeEnd(e))},Object.defineProperty(t,"Now",{get:function(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()},enumerable:!0,configurable:!0}),t.getClassName=function(e,t){void 0===t&&(t=!1);var i=null;if(!t&&e.getClassName)i=e.getClassName();else{if(e instanceof Object){var r=t?e:Object.getPrototypeOf(e);i=r.constructor.__bjsclassName__}i||(i=typeof e)}return i},t.first=function(e,t){for(var i=0;i<e.length;i++){var r=e[i];if(t(r))return r}},t.arrayOrStringFeeder=function(e){return function(i){if(i>=e.length)return null;var r=e.charCodeAt?e.charCodeAt(i):e[i];return r&&r.getHashCode&&(r=r.getHashCode()),"string"==typeof r?t.hashCodeFromStream(t.arrayOrStringFeeder(r)):r}},t.hashCodeFromStream=function(e){for(var t=0,i=0,r=e(i++);null!=r;)t=(t<<5)-t+r,t|=0,r=e(i++);return t},t.BaseUrl="",t.CorsBehavior="anonymous",t.UseFallbackTexture=!0,t._NoneLogLevel=0,t._MessageLogLevel=1,t._WarningLogLevel=2,t._ErrorLogLevel=4,t._LogCache="",t.errorsCount=0,t.Log=t._LogEnabled,t.Warn=t._WarnEnabled,t.Error=t._ErrorEnabled,t._PerformanceNoneLogLevel=0,t._PerformanceUserMarkLogLevel=1,t._PerformanceConsoleLogLevel=2,t._performance=window.performance,t.StartPerformanceCounter=t._StartPerformanceCounterDisabled,t.EndPerformanceCounter=t._EndPerformanceCounterDisabled,t}();e.Tools=n,e.className=t;var o=function(){function e(e,t,i,r){void 0===r&&(r=0),this.iterations=e,this._fn=t,this._successCallback=i,this.index=r-1,this._done=!1}return e.prototype.executeNext=function(){this._done||(this.index+1<this.iterations?(++this.index,this._fn(this)):this.breakLoop())},e.prototype.breakLoop=function(){this._done=!0,this._successCallback()},e.Run=function(t,i,r,n){void 0===n&&(n=0);var o=new e(t,i,r,n);return o.executeNext(),o},e.SyncAsyncForLoop=function(t,i,r,n,o,s){void 0===s&&(s=0),e.Run(Math.ceil(t/i),function(e){o&&o()?e.breakLoop():setTimeout(function(){for(var n=0;i>n;++n){var s=e.index*i+n;if(s>=t)break;if(r(s),o&&o()){e.breakLoop();break}}e.executeNext()},s)},n)},e}();e.AsyncLoop=o}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t;!function(e){var t=function(){function e(){this._isAlphaBlendDirty=!1,this._isBlendFunctionParametersDirty=!1,this._alphaBlend=!1,this._blendFunctionParameters=new Array(4)}return Object.defineProperty(e.prototype,"isDirty",{get:function(){return this._isAlphaBlendDirty||this._isBlendFunctionParametersDirty},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alphaBlend",{get:function(){return this._alphaBlend},set:function(e){this._alphaBlend!==e&&(this._alphaBlend=e,this._isAlphaBlendDirty=!0)},enumerable:!0,configurable:!0}),e.prototype.setAlphaBlendFunctionParameters=function(e,t,i,r){this._blendFunctionParameters[0]===e&&this._blendFunctionParameters[1]===t&&this._blendFunctionParameters[2]===i&&this._blendFunctionParameters[3]===r||(this._blendFunctionParameters[0]=e,this._blendFunctionParameters[1]=t,this._blendFunctionParameters[2]=i,this._blendFunctionParameters[3]=r,this._isBlendFunctionParametersDirty=!0)},e.prototype.reset=function(){this._alphaBlend=!1,this._blendFunctionParameters[0]=null,this._blendFunctionParameters[1]=null,this._blendFunctionParameters[2]=null,this._blendFunctionParameters[3]=null,this._isAlphaBlendDirty=!0,this._isBlendFunctionParametersDirty=!1},e.prototype.apply=function(e){this.isDirty&&(this._isAlphaBlendDirty&&(this._alphaBlend?e.enable(e.BLEND):e.disable(e.BLEND),this._isAlphaBlendDirty=!1),this._isBlendFunctionParametersDirty&&(e.blendFuncSeparate(this._blendFunctionParameters[0],this._blendFunctionParameters[1],this._blendFunctionParameters[2],this._blendFunctionParameters[3]),this._isBlendFunctionParametersDirty=!1))},e}();e._AlphaState=t}(t=e.Internals||(e.Internals={}))}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t;!function(e){var t=function(){function e(){this._isDepthTestDirty=!1,this._isDepthMaskDirty=!1,this._isDepthFuncDirty=!1,this._isCullFaceDirty=!1,this._isCullDirty=!1,this._isZOffsetDirty=!1}return Object.defineProperty(e.prototype,"isDirty",{get:function(){return this._isDepthFuncDirty||this._isDepthTestDirty||this._isDepthMaskDirty||this._isCullFaceDirty||this._isCullDirty||this._isZOffsetDirty},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"zOffset",{get:function(){return this._zOffset},set:function(e){this._zOffset!==e&&(this._zOffset=e,this._isZOffsetDirty=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cullFace",{get:function(){return this._cullFace},set:function(e){this._cullFace!==e&&(this._cullFace=e,this._isCullFaceDirty=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cull",{get:function(){return this._cull},set:function(e){this._cull!==e&&(this._cull=e,this._isCullDirty=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"depthFunc",{get:function(){return this._depthFunc},set:function(e){this._depthFunc!==e&&(this._depthFunc=e,this._isDepthFuncDirty=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"depthMask",{get:function(){return this._depthMask},set:function(e){this._depthMask!==e&&(this._depthMask=e,this._isDepthMaskDirty=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"depthTest",{get:function(){return this._depthTest},set:function(e){this._depthTest!==e&&(this._depthTest=e,this._isDepthTestDirty=!0)},enumerable:!0,configurable:!0}),e.prototype.reset=function(){this._depthMask=!0,this._depthTest=!0,this._depthFunc=null,this._cullFace=null,this._cull=null,this._zOffset=0,this._isDepthTestDirty=!0,this._isDepthMaskDirty=!0,this._isDepthFuncDirty=!1,this._isCullFaceDirty=!1,this._isCullDirty=!1,this._isZOffsetDirty=!1},e.prototype.apply=function(e){this.isDirty&&(this._isCullDirty&&(this.cull?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this._isCullDirty=!1),this._isCullFaceDirty&&(e.cullFace(this.cullFace),this._isCullFaceDirty=!1),this._isDepthMaskDirty&&(e.depthMask(this.depthMask),this._isDepthMaskDirty=!1),this._isDepthTestDirty&&(this.depthTest?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this._isDepthTestDirty=!1),this._isDepthFuncDirty&&(e.depthFunc(this.depthFunc),this._isDepthFuncDirty=!1),this._isZOffsetDirty&&(this.zOffset?(e.enable(e.POLYGON_OFFSET_FILL),e.polygonOffset(this.zOffset,0)):e.disable(e.POLYGON_OFFSET_FILL),this._isZOffsetDirty=!1))},e}();e._DepthCullingState=t}(t=e.Internals||(e.Internals={}))}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(e,t,i,r){var n=e.createShader("vertex"===i?e.VERTEX_SHADER:e.FRAGMENT_SHADER);if(e.shaderSource(n,(r?r+"\n":"")+t),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS))throw new Error(e.getShaderInfoLog(n));return n},i=function(e,t){var i=e.UNSIGNED_BYTE;return t===c.TEXTURETYPE_FLOAT&&(i=e.FLOAT),i},r=function(t,i,r){var n=r.NEAREST,o=r.NEAREST;return t===e.Texture.BILINEAR_SAMPLINGMODE?(n=r.LINEAR,o=i?r.LINEAR_MIPMAP_NEAREST:r.LINEAR):t===e.Texture.TRILINEAR_SAMPLINGMODE?(n=r.LINEAR,o=i?r.LINEAR_MIPMAP_LINEAR:r.LINEAR):t===e.Texture.NEAREST_SAMPLINGMODE&&(n=r.NEAREST,o=i?r.NEAREST_MIPMAP_LINEAR:r.NEAREST),{min:o,mag:n}},n=function(t,i,n,o,s,a,h,c,l,u,f){void 0===f&&(f=e.Texture.TRILINEAR_SAMPLINGMODE);var d=n.getEngine(),p=e.Tools.GetExponentOfTwo(o,d.getCaps().maxTextureSize),_=e.Tools.GetExponentOfTwo(s,d.getCaps().maxTextureSize);i.bindTexture(i.TEXTURE_2D,t),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,void 0===a?1:a?1:0),t._baseWidth=o,t._baseHeight=s,t._width=p,t._height=_,t.isReady=!0,l(p,_);var m=r(f,!h,i);i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,m.mag),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,m.min),h||c||i.generateMipmap(i.TEXTURE_2D),i.bindTexture(i.TEXTURE_2D,null),d.resetTextureCache(),n._removePendingData(t),u&&u()},o=function(t,i,r,n,o){var s,a=function(){r[i]=s,r._internalCount++,n._removePendingData(s),6===r._internalCount&&o(r)},h=function(){n._removePendingData(s)};s=e.Tools.LoadImage(t,a,h,n.database),n._addPendingData(s)},s=function(e,t,i,r){var n=[];n._internalCount=0;for(var s=0;6>s;s++)o(r[s],s,n,t,i)},a=function(){function e(){}return e}();e.InstancingAttributeInfo=a;var h=function(){function e(){}return e}();e.EngineCapabilities=h;var c=function(){function o(t,i,r,n){var s=this;if(void 0===n&&(n=!0),this.isFullscreen=!1,this.isPointerLock=!1,this.cullBackFaces=!0,this.renderEvenInBackground=!0,this.enableOfflineSupport=!0,this.scenes=new Array,this._windowIsBackground=!1,this._webGLVersion="1.0",this._drawCalls=0,this._renderingQueueLaunched=!1,this._activeRenderLoops=[],this.fpsRange=60,this.previousFramesDuration=[],this.fps=60,this.deltaTime=0,this._depthCullingState=new e.Internals._DepthCullingState,this._alphaState=new e.Internals._AlphaState,this._alphaMode=o.ALPHA_DISABLE,this._loadedTexturesCache=new Array,this._maxTextureChannels=16,this._activeTexturesCache=new Array(this._maxTextureChannels),this._compiledEffects={},this._uintIndicesCurrentlySet=!1,this._currentBoundBuffer=new Array,this._currentInstanceLocations=new Array,this._currentInstanceBuffers=new Array,this._renderingCanvas=t,this._externalData=new e.StringDictionary,r=r||{},r.antialias=i,void 0===r.preserveDrawingBuffer&&(r.preserveDrawingBuffer=!1),!this._gl)try{this._gl=t.getContext("webgl",r)||t.getContext("experimental-webgl",r)}catch(a){throw new Error("WebGL not supported")}if(!this._gl)throw new Error("WebGL not supported");this._onBlur=function(){s._windowIsBackground=!0},this._onFocus=function(){s._windowIsBackground=!1},window.addEventListener("blur",this._onBlur),window.addEventListener("focus",this._onFocus);var c=r.limitDeviceRatio||window.devicePixelRatio||1;this._hardwareScalingLevel=n?1/Math.min(c,window.devicePixelRatio||1):1,this.resize(),this._caps=new h,this._caps.maxTexturesImageUnits=this._gl.getParameter(this._gl.MAX_TEXTURE_IMAGE_UNITS),this._caps.maxTextureSize=this._gl.getParameter(this._gl.MAX_TEXTURE_SIZE),this._caps.maxCubemapTextureSize=this._gl.getParameter(this._gl.MAX_CUBE_MAP_TEXTURE_SIZE),
this._caps.maxRenderTextureSize=this._gl.getParameter(this._gl.MAX_RENDERBUFFER_SIZE),this._glVersion=this._gl.getParameter(this._gl.VERSION);var l=this._gl.getExtension("WEBGL_debug_renderer_info");if(null!=l&&(this._glRenderer=this._gl.getParameter(l.UNMASKED_RENDERER_WEBGL),this._glVendor=this._gl.getParameter(l.UNMASKED_VENDOR_WEBGL)),this._glVendor||(this._glVendor="Unknown vendor"),this._glRenderer||(this._glRenderer="Unknown renderer"),this._caps.standardDerivatives=null!==this._gl.getExtension("OES_standard_derivatives"),this._caps.s3tc=this._gl.getExtension("WEBGL_compressed_texture_s3tc"),this._caps.textureFloat=null!==this._gl.getExtension("OES_texture_float"),this._caps.textureAnisotropicFilterExtension=this._gl.getExtension("EXT_texture_filter_anisotropic")||this._gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||this._gl.getExtension("MOZ_EXT_texture_filter_anisotropic"),this._caps.maxAnisotropy=this._caps.textureAnisotropicFilterExtension?this._gl.getParameter(this._caps.textureAnisotropicFilterExtension.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,this._caps.instancedArrays=this._gl.getExtension("ANGLE_instanced_arrays"),this._caps.uintIndices=null!==this._gl.getExtension("OES_element_index_uint"),this._caps.fragmentDepthSupported=null!==this._gl.getExtension("EXT_frag_depth"),this._caps.highPrecisionShaderSupported=!0,this._caps.drawBuffersExtension=this._gl.getExtension("WEBGL_draw_buffers"),this._caps.textureFloatLinearFiltering=this._gl.getExtension("OES_texture_float_linear"),this._caps.textureLOD=this._gl.getExtension("EXT_shader_texture_lod"),this._gl.getShaderPrecisionFormat){var u=this._gl.getShaderPrecisionFormat(this._gl.FRAGMENT_SHADER,this._gl.HIGH_FLOAT);this._caps.highPrecisionShaderSupported=0!==u.precision}this.setDepthBuffer(!0),this.setDepthFunctionToLessOrEqual(),this.setDepthWrite(!0),this._onFullscreenChange=function(){void 0!==document.fullscreen?s.isFullscreen=document.fullscreen:void 0!==document.mozFullScreen?s.isFullscreen=document.mozFullScreen:void 0!==document.webkitIsFullScreen?s.isFullscreen=document.webkitIsFullScreen:void 0!==document.msIsFullScreen&&(s.isFullscreen=document.msIsFullScreen),s.isFullscreen&&s._pointerLockRequested&&(t.requestPointerLock=t.requestPointerLock||t.msRequestPointerLock||t.mozRequestPointerLock||t.webkitRequestPointerLock,t.requestPointerLock&&t.requestPointerLock())},document.addEventListener("fullscreenchange",this._onFullscreenChange,!1),document.addEventListener("mozfullscreenchange",this._onFullscreenChange,!1),document.addEventListener("webkitfullscreenchange",this._onFullscreenChange,!1),document.addEventListener("msfullscreenchange",this._onFullscreenChange,!1),this._onPointerLockChange=function(){s.isPointerLock=document.mozPointerLockElement===t||document.webkitPointerLockElement===t||document.msPointerLockElement===t||document.pointerLockElement===t},document.addEventListener("pointerlockchange",this._onPointerLockChange,!1),document.addEventListener("mspointerlockchange",this._onPointerLockChange,!1),document.addEventListener("mozpointerlockchange",this._onPointerLockChange,!1),document.addEventListener("webkitpointerlockchange",this._onPointerLockChange,!1),e.AudioEngine&&!o.audioEngine&&(o.audioEngine=new e.AudioEngine),this._loadingScreen=new e.DefaultLoadingScreen(this._renderingCanvas),e.Tools.Log("Babylon.js engine (v"+o.Version+") launched")}return Object.defineProperty(o,"ALPHA_DISABLE",{get:function(){return o._ALPHA_DISABLE},enumerable:!0,configurable:!0}),Object.defineProperty(o,"ALPHA_ONEONE",{get:function(){return o._ALPHA_ONEONE},enumerable:!0,configurable:!0}),Object.defineProperty(o,"ALPHA_ADD",{get:function(){return o._ALPHA_ADD},enumerable:!0,configurable:!0}),Object.defineProperty(o,"ALPHA_COMBINE",{get:function(){return o._ALPHA_COMBINE},enumerable:!0,configurable:!0}),Object.defineProperty(o,"ALPHA_SUBTRACT",{get:function(){return o._ALPHA_SUBTRACT},enumerable:!0,configurable:!0}),Object.defineProperty(o,"ALPHA_MULTIPLY",{get:function(){return o._ALPHA_MULTIPLY},enumerable:!0,configurable:!0}),Object.defineProperty(o,"ALPHA_MAXIMIZED",{get:function(){return o._ALPHA_MAXIMIZED},enumerable:!0,configurable:!0}),Object.defineProperty(o,"DELAYLOADSTATE_NONE",{get:function(){return o._DELAYLOADSTATE_NONE},enumerable:!0,configurable:!0}),Object.defineProperty(o,"DELAYLOADSTATE_LOADED",{get:function(){return o._DELAYLOADSTATE_LOADED},enumerable:!0,configurable:!0}),Object.defineProperty(o,"DELAYLOADSTATE_LOADING",{get:function(){return o._DELAYLOADSTATE_LOADING},enumerable:!0,configurable:!0}),Object.defineProperty(o,"DELAYLOADSTATE_NOTLOADED",{get:function(){return o._DELAYLOADSTATE_NOTLOADED},enumerable:!0,configurable:!0}),Object.defineProperty(o,"TEXTUREFORMAT_ALPHA",{get:function(){return o._TEXTUREFORMAT_ALPHA},enumerable:!0,configurable:!0}),Object.defineProperty(o,"TEXTUREFORMAT_LUMINANCE",{get:function(){return o._TEXTUREFORMAT_LUMINANCE},enumerable:!0,configurable:!0}),Object.defineProperty(o,"TEXTUREFORMAT_LUMINANCE_ALPHA",{get:function(){return o._TEXTUREFORMAT_LUMINANCE_ALPHA},enumerable:!0,configurable:!0}),Object.defineProperty(o,"TEXTUREFORMAT_RGB",{get:function(){return o._TEXTUREFORMAT_RGB},enumerable:!0,configurable:!0}),Object.defineProperty(o,"TEXTUREFORMAT_RGBA",{get:function(){return o._TEXTUREFORMAT_RGBA},enumerable:!0,configurable:!0}),Object.defineProperty(o,"TEXTURETYPE_UNSIGNED_INT",{get:function(){return o._TEXTURETYPE_UNSIGNED_INT},enumerable:!0,configurable:!0}),Object.defineProperty(o,"TEXTURETYPE_FLOAT",{get:function(){return o._TEXTURETYPE_FLOAT},enumerable:!0,configurable:!0}),Object.defineProperty(o,"Version",{get:function(){return"2.4.0"},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"webGLVersion",{get:function(){return this._webGLVersion},enumerable:!0,configurable:!0}),o.prototype._prepareWorkingCanvas=function(){this._workingCanvas||(this._workingCanvas=document.createElement("canvas"),this._workingContext=this._workingCanvas.getContext("2d"))},o.prototype.resetTextureCache=function(){for(var e=0;e<this._maxTextureChannels;e++)this._activeTexturesCache[e]=null},o.prototype.getGlInfo=function(){return{vendor:this._glVendor,renderer:this._glRenderer,version:this._glVersion}},o.prototype.getAspectRatio=function(e,t){void 0===t&&(t=!1);var i=e.viewport;return this.getRenderWidth(t)*i.width/(this.getRenderHeight(t)*i.height)},o.prototype.getRenderWidth=function(e){return void 0===e&&(e=!1),!e&&this._currentRenderTarget?this._currentRenderTarget._width:this._renderingCanvas.width},o.prototype.getRenderHeight=function(e){return void 0===e&&(e=!1),!e&&this._currentRenderTarget?this._currentRenderTarget._height:this._renderingCanvas.height},o.prototype.getRenderingCanvas=function(){return this._renderingCanvas},o.prototype.getRenderingCanvasClientRect=function(){return this._renderingCanvas.getBoundingClientRect()},o.prototype.setHardwareScalingLevel=function(e){this._hardwareScalingLevel=e,this.resize()},o.prototype.getHardwareScalingLevel=function(){return this._hardwareScalingLevel},o.prototype.getLoadedTexturesCache=function(){return this._loadedTexturesCache},o.prototype.getCaps=function(){return this._caps},Object.defineProperty(o.prototype,"drawCalls",{get:function(){return this._drawCalls},enumerable:!0,configurable:!0}),o.prototype.resetDrawCalls=function(){this._drawCalls=0},o.prototype.getDepthFunction=function(){return this._depthCullingState.depthFunc},o.prototype.setDepthFunction=function(e){this._depthCullingState.depthFunc=e},o.prototype.setDepthFunctionToGreater=function(){this._depthCullingState.depthFunc=this._gl.GREATER},o.prototype.setDepthFunctionToGreaterOrEqual=function(){this._depthCullingState.depthFunc=this._gl.GEQUAL},o.prototype.setDepthFunctionToLess=function(){this._depthCullingState.depthFunc=this._gl.LESS},o.prototype.setDepthFunctionToLessOrEqual=function(){this._depthCullingState.depthFunc=this._gl.LEQUAL},o.prototype.stopRenderLoop=function(e){if(!e)return void(this._activeRenderLoops=[]);var t=this._activeRenderLoops.indexOf(e);t>=0&&this._activeRenderLoops.splice(t,1)},o.prototype._renderLoop=function(){var t=!0;if(!this.renderEvenInBackground&&this._windowIsBackground&&(t=!1),t){this.beginFrame();for(var i=0;i<this._activeRenderLoops.length;i++){var r=this._activeRenderLoops[i];r()}this.endFrame()}this._activeRenderLoops.length>0?e.Tools.QueueNewFrame(this._bindedRenderFunction):this._renderingQueueLaunched=!1},o.prototype.runRenderLoop=function(t){-1===this._activeRenderLoops.indexOf(t)&&(this._activeRenderLoops.push(t),this._renderingQueueLaunched||(this._renderingQueueLaunched=!0,this._bindedRenderFunction=this._renderLoop.bind(this),e.Tools.QueueNewFrame(this._bindedRenderFunction)))},o.prototype.switchFullscreen=function(t,i){this.isFullscreen?e.Tools.ExitFullscreen():(this._pointerLockRequested=t,e.Tools.RequestFullscreen(this._renderingCanvas,i))},o.prototype.clear=function(e,t,i){this.applyStates(),t&&this._gl.clearColor(e.r,e.g,e.b,void 0!==e.a?e.a:1),i&&this._depthCullingState.depthMask&&this._gl.clearDepth(1);var r=0;t&&(r|=this._gl.COLOR_BUFFER_BIT),i&&this._depthCullingState.depthMask&&(r|=this._gl.DEPTH_BUFFER_BIT),this._gl.clear(r)},o.prototype.scissorClear=function(e,t,i,r,n){var o=this._gl,s=o.getParameter(o.SCISSOR_TEST),a=o.getParameter(o.SCISSOR_BOX);o.enable(o.SCISSOR_TEST),o.scissor(e,t,i,r),this.clear(n,!0,!0),o.scissor(a[0],a[1],a[2],a[3]),s===!0?o.enable(o.SCISSOR_TEST):o.disable(o.SCISSOR_TEST)},o.prototype.setViewport=function(e,t,i){var r=t||(navigator.isCocoonJS?window.innerWidth:this._renderingCanvas.width),n=i||(navigator.isCocoonJS?window.innerHeight:this._renderingCanvas.height),o=e.x||0,s=e.y||0;this._cachedViewport=e,this._gl.viewport(o*r,s*n,r*e.width,n*e.height)},o.prototype.setDirectViewport=function(e,t,i,r){var n=this._cachedViewport;return this._cachedViewport=null,this._gl.viewport(e,t,i,r),n},o.prototype.beginFrame=function(){this._measureFps()},o.prototype.endFrame=function(){},o.prototype.resize=function(){var e=navigator.isCocoonJS?window.innerWidth:this._renderingCanvas.clientWidth,t=navigator.isCocoonJS?window.innerHeight:this._renderingCanvas.clientHeight;this.setSize(e/this._hardwareScalingLevel,t/this._hardwareScalingLevel);for(var i=0;i<this.scenes.length;i++){var r=this.scenes[i];r.debugLayer.isVisible()&&r.debugLayer._syncPositions()}},o.prototype.setSize=function(e,t){this._renderingCanvas.width=e,this._renderingCanvas.height=t;for(var i=0;i<this.scenes.length;i++)for(var r=this.scenes[i],n=0;n<r.cameras.length;n++){var o=r.cameras[n];o._currentRenderId=0}},o.prototype.bindFramebuffer=function(e,t,i,r){this._currentRenderTarget=e;var n=this._gl;n.bindFramebuffer(n.FRAMEBUFFER,e._framebuffer),e.isCube?n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+t,e,0):n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0),this._gl.viewport(0,0,i||e._width,r||e._height),this.wipeCaches()},o.prototype.unBindFramebuffer=function(e,t){if(void 0===t&&(t=!1),this._currentRenderTarget=null,e.generateMipMaps&&!t){var i=this._gl;i.bindTexture(i.TEXTURE_2D,e),i.generateMipmap(i.TEXTURE_2D),i.bindTexture(i.TEXTURE_2D,null)}this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null)},o.prototype.generateMipMapsForCubemap=function(e){if(e.generateMipMaps){var t=this._gl;t.bindTexture(t.TEXTURE_CUBE_MAP,e),t.generateMipmap(t.TEXTURE_CUBE_MAP),t.bindTexture(t.TEXTURE_CUBE_MAP,null)}},o.prototype.flushFramebuffer=function(){this._gl.flush()},o.prototype.restoreDefaultFramebuffer=function(){this._currentRenderTarget=null,this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null),this.setViewport(this._cachedViewport),this.wipeCaches()},o.prototype._resetVertexBufferBinding=function(){this.bindBuffer(null,this._gl.ARRAY_BUFFER),this._cachedVertexBuffers=null},o.prototype.createVertexBuffer=function(e){var t=this._gl.createBuffer();return this.bindBuffer(t,this._gl.ARRAY_BUFFER),e instanceof Float32Array?this._gl.bufferData(this._gl.ARRAY_BUFFER,e,this._gl.STATIC_DRAW):this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array(e),this._gl.STATIC_DRAW),this._resetVertexBufferBinding(),t.references=1,t},o.prototype.createDynamicVertexBuffer=function(e){var t=this._gl.createBuffer();return this.bindBuffer(t,this._gl.ARRAY_BUFFER),e instanceof Float32Array?this._gl.bufferData(this._gl.ARRAY_BUFFER,e,this._gl.DYNAMIC_DRAW):this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array(e),this._gl.DYNAMIC_DRAW),this._resetVertexBufferBinding(),t.references=1,t},o.prototype.updateDynamicVertexBuffer=function(e,t,i,r){this.bindBuffer(e,this._gl.ARRAY_BUFFER),void 0===i&&(i=0),void 0===r?t instanceof Float32Array?this._gl.bufferSubData(this._gl.ARRAY_BUFFER,i,t):this._gl.bufferSubData(this._gl.ARRAY_BUFFER,i,new Float32Array(t)):t instanceof Float32Array?this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,t.subarray(i,i+r)):this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,new Float32Array(t).subarray(i,i+r)),this._resetVertexBufferBinding()},o.prototype._resetIndexBufferBinding=function(){this.bindBuffer(null,this._gl.ELEMENT_ARRAY_BUFFER),this._cachedIndexBuffer=null},o.prototype.createIndexBuffer=function(e){var t=this._gl.createBuffer();this.bindBuffer(t,this._gl.ELEMENT_ARRAY_BUFFER);var i,r=!1;if(this._caps.uintIndices){for(var n=0;n<e.length;n++)if(e[n]>65535){r=!0;break}i=r?new Uint32Array(e):new Uint16Array(e)}else i=new Uint16Array(e);return this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,i,this._gl.STATIC_DRAW),this._resetIndexBufferBinding(),t.references=1,t.is32Bits=r,t},o.prototype.bindArrayBuffer=function(e){this.bindBuffer(e,this._gl.ARRAY_BUFFER)},o.prototype.updateArrayBuffer=function(e){this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,e)},o.prototype.bindBuffer=function(e,t){this._currentBoundBuffer[t]!==e&&(this._gl.bindBuffer(t,e),this._currentBoundBuffer[t]=e)},o.prototype.bindBuffersDirectly=function(e,t,i,r,n){if(this._cachedVertexBuffers!==e||this._cachedEffectForVertexBuffers!==n){this._cachedVertexBuffers=e,this._cachedEffectForVertexBuffers=n,this.bindBuffer(e,this._gl.ARRAY_BUFFER);for(var o=0,s=0;s<i.length;s++){var a=n.getAttributeLocation(s);a>=0&&this._gl.vertexAttribPointer(a,i[s],this._gl.FLOAT,!1,r,o),o+=4*i[s]}}this._cachedIndexBuffer!==t&&(this._cachedIndexBuffer=t,this.bindBuffer(t,this._gl.ELEMENT_ARRAY_BUFFER),this._uintIndicesCurrentlySet=t.is32Bits)},o.prototype.bindBuffers=function(e,t,i){if(this._cachedVertexBuffers!==e||this._cachedEffectForVertexBuffers!==i){this._cachedVertexBuffers=e,this._cachedEffectForVertexBuffers=i;for(var r=i.getAttributesNames(),n=0;n<r.length;n++){var o=i.getAttributeLocation(n);if(o>=0){var s=e[r[n]];if(!s)continue;var a=s.getBuffer();this.bindBuffer(a,this._gl.ARRAY_BUFFER),this._gl.vertexAttribPointer(o,s.getSize(),this._gl.FLOAT,!1,4*s.getStrideSize(),4*s.getOffset()),s.getIsInstanced()&&(this._caps.instancedArrays.vertexAttribDivisorANGLE(o,1),this._currentInstanceLocations.push(o),this._currentInstanceBuffers.push(a))}}}null!=t&&this._cachedIndexBuffer!==t&&(this._cachedIndexBuffer=t,this.bindBuffer(t,this._gl.ELEMENT_ARRAY_BUFFER),this._uintIndicesCurrentlySet=t.is32Bits)},o.prototype.unbindInstanceAttributes=function(){for(var e,t=0,i=this._currentInstanceLocations.length;i>t;t++){var r=this._currentInstanceBuffers[t];e!=r&&(e=r,this.bindBuffer(r,this._gl.ARRAY_BUFFER));var n=this._currentInstanceLocations[t];this._caps.instancedArrays.vertexAttribDivisorANGLE(n,0)}this._currentInstanceBuffers.length=0,this._currentInstanceLocations.length=0},o.prototype._releaseBuffer=function(e){return e.references--,0===e.references?(this._gl.deleteBuffer(e),!0):!1},o.prototype.createInstancesBuffer=function(e){var t=this._gl.createBuffer();return t.capacity=e,this.bindBuffer(t,this._gl.ARRAY_BUFFER),this._gl.bufferData(this._gl.ARRAY_BUFFER,e,this._gl.DYNAMIC_DRAW),t},o.prototype.deleteInstancesBuffer=function(e){this._gl.deleteBuffer(e)},o.prototype.updateAndBindInstancesBuffer=function(e,t,i){if(this.bindBuffer(e,this._gl.ARRAY_BUFFER),t&&this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,t),void 0!==i[0].index){for(var r=0,n=0;n<i.length;n++){var o=i[n];r+=4*o.attributeSize}for(var n=0;n<i.length;n++){var o=i[n];this._gl.enableVertexAttribArray(o.index),this._gl.vertexAttribPointer(o.index,o.attributeSize,o.attribyteType||this._gl.FLOAT,o.normalized||!1,r,o.offset),this._caps.instancedArrays.vertexAttribDivisorANGLE(o.index,1),this._currentInstanceLocations.push(o.index),this._currentInstanceBuffers.push(e)}}else for(var s=0;4>s;s++){var a=i[s];this._gl.enableVertexAttribArray(a),this._gl.vertexAttribPointer(a,4,this._gl.FLOAT,!1,64,16*s),this._caps.instancedArrays.vertexAttribDivisorANGLE(a,1),this._currentInstanceLocations.push(a),this._currentInstanceBuffers.push(e)}},o.prototype.applyStates=function(){this._depthCullingState.apply(this._gl),this._alphaState.apply(this._gl)},o.prototype.draw=function(e,t,i,r){this.applyStates(),this._drawCalls++;var n=this._uintIndicesCurrentlySet?this._gl.UNSIGNED_INT:this._gl.UNSIGNED_SHORT,o=this._uintIndicesCurrentlySet?4:2;return r?void this._caps.instancedArrays.drawElementsInstancedANGLE(e?this._gl.TRIANGLES:this._gl.LINES,i,n,t*o,r):void this._gl.drawElements(e?this._gl.TRIANGLES:this._gl.LINES,i,n,t*o)},o.prototype.drawPointClouds=function(e,t,i){return this.applyStates(),this._drawCalls++,i?void this._caps.instancedArrays.drawArraysInstancedANGLE(this._gl.POINTS,e,t,i):void this._gl.drawArrays(this._gl.POINTS,e,t)},o.prototype.drawUnIndexed=function(e,t,i,r){return this.applyStates(),this._drawCalls++,r?void this._caps.instancedArrays.drawArraysInstancedANGLE(e?this._gl.TRIANGLES:this._gl.LINES,t,i,r):void this._gl.drawArrays(e?this._gl.TRIANGLES:this._gl.LINES,t,i)},o.prototype._releaseEffect=function(e){this._compiledEffects[e._key]&&(delete this._compiledEffects[e._key],e.getProgram()&&this._gl.deleteProgram(e.getProgram()))},o.prototype.createEffect=function(t,i,r,n,o,s,a,h,c){var l=t.vertexElement||t.vertex||t,u=t.fragmentElement||t.fragment||t,f=l+"+"+u+"@"+o;if(this._compiledEffects[f])return this._compiledEffects[f];var d=new e.Effect(t,i,r,n,this,o,s,a,h,c);return d._key=f,this._compiledEffects[f]=d,d},o.prototype.createEffectForParticles=function(e,t,i,r,n,o,s){return void 0===t&&(t=[]),void 0===i&&(i=[]),void 0===r&&(r=""),this.createEffect({vertex:"particles",fragmentElement:e},["position","color","options"],["view","projection"].concat(t),["diffuseSampler"].concat(i),r,n,o,s)},o.prototype.createShaderProgram=function(e,i,r){var n=t(this._gl,e,"vertex",r),o=t(this._gl,i,"fragment",r),s=this._gl.createProgram();this._gl.attachShader(s,n),this._gl.attachShader(s,o),this._gl.linkProgram(s);var a=this._gl.getProgramParameter(s,this._gl.LINK_STATUS);if(!a){var h=this._gl.getProgramInfoLog(s);if(h)throw new Error(h)}return this._gl.deleteShader(n),this._gl.deleteShader(o),s},o.prototype.getUniforms=function(e,t){for(var i=[],r=0;r<t.length;r++)i.push(this._gl.getUniformLocation(e,t[r]));return i},o.prototype.getAttributes=function(e,t){for(var i=[],r=0;r<t.length;r++)try{i.push(this._gl.getAttribLocation(e,t[r]))}catch(n){i.push(-1)}return i},o.prototype.enableEffect=function(e){if(!e||!e.getAttributesCount()||this._currentEffect===e)return void(e&&e.onBind&&e.onBind(e));this._vertexAttribArraysToUse=this._vertexAttribArraysToUse||[],this._vertexAttribArraysEnabled=this._vertexAttribArraysEnabled||[],this._gl.useProgram(e.getProgram());var t,i;for(t=0,i=this._vertexAttribArraysToUse.length;i>t;t++)this._vertexAttribArraysToUse[t]=!1;var r=e.getAttributesCount();for(t=0;r>t;t++){var n=e.getAttributeLocation(t);n>=0&&(this._vertexAttribArraysToUse[n]=!0)}for(t=0,i=this._vertexAttribArraysEnabled.length;i>t;t++)t>this._gl.VERTEX_ATTRIB_ARRAY_ENABLED||!this._vertexAttribArraysEnabled[t]||this._vertexAttribArraysToUse[t]||(this._vertexAttribArraysEnabled[t]=!1,this._gl.disableVertexAttribArray(t));for(t=0,i=this._vertexAttribArraysToUse.length;i>t;t++)this._vertexAttribArraysToUse[t]&&!this._vertexAttribArraysEnabled[t]&&(this._vertexAttribArraysEnabled[t]=!0,this._gl.enableVertexAttribArray(t));this._currentEffect=e,e.onBind&&e.onBind(e)},o.prototype.setArray=function(e,t){e&&this._gl.uniform1fv(e,t)},o.prototype.setArray2=function(e,t){e&&t.length%2===0&&this._gl.uniform2fv(e,t)},o.prototype.setArray3=function(e,t){e&&t.length%3===0&&this._gl.uniform3fv(e,t)},o.prototype.setArray4=function(e,t){e&&t.length%4===0&&this._gl.uniform4fv(e,t)},o.prototype.setMatrices=function(e,t){e&&this._gl.uniformMatrix4fv(e,!1,t)},o.prototype.setMatrix=function(e,t){e&&this._gl.uniformMatrix4fv(e,!1,t.toArray())},o.prototype.setMatrix3x3=function(e,t){e&&this._gl.uniformMatrix3fv(e,!1,t)},o.prototype.setMatrix2x2=function(e,t){e&&this._gl.uniformMatrix2fv(e,!1,t)},o.prototype.setFloat=function(e,t){e&&this._gl.uniform1f(e,t)},o.prototype.setFloat2=function(e,t,i){e&&this._gl.uniform2f(e,t,i)},o.prototype.setFloat3=function(e,t,i,r){e&&this._gl.uniform3f(e,t,i,r)},o.prototype.setBool=function(e,t){e&&this._gl.uniform1i(e,t)},o.prototype.setFloat4=function(e,t,i,r,n){e&&this._gl.uniform4f(e,t,i,r,n)},o.prototype.setColor3=function(e,t){e&&this._gl.uniform3f(e,t.r,t.g,t.b)},o.prototype.setColor4=function(e,t,i){e&&this._gl.uniform4f(e,t.r,t.g,t.b,i)},o.prototype.setState=function(e,t,i,r){void 0===t&&(t=0),void 0===r&&(r=!1);var n=r?this._gl.FRONT:this._gl.BACK,o=r?this._gl.BACK:this._gl.FRONT,s=this.cullBackFaces?n:o;(this._depthCullingState.cull!==e||i||this._depthCullingState.cullFace!==s)&&(e?(this._depthCullingState.cullFace=s,this._depthCullingState.cull=!0):this._depthCullingState.cull=!1),this._depthCullingState.zOffset=t},o.prototype.setDepthBuffer=function(e){this._depthCullingState.depthTest=e},o.prototype.getDepthWrite=function(){return this._depthCullingState.depthMask},o.prototype.setDepthWrite=function(e){this._depthCullingState.depthMask=e},o.prototype.setColorWrite=function(e){this._gl.colorMask(e,e,e,e)},o.prototype.setAlphaMode=function(e,t){if(void 0===t&&(t=!1),this._alphaMode!==e){switch(e){case o.ALPHA_DISABLE:this._alphaState.alphaBlend=!1;break;case o.ALPHA_COMBINE:this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case o.ALPHA_ONEONE:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE,this._gl.ZERO,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case o.ALPHA_ADD:this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE,this._gl.ZERO,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case o.ALPHA_SUBTRACT:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ZERO,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case o.ALPHA_MULTIPLY:this._alphaState.setAlphaBlendFunctionParameters(this._gl.DST_COLOR,this._gl.ZERO,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case o.ALPHA_MAXIMIZED:this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0}t||this.setDepthWrite(e===o.ALPHA_DISABLE),this._alphaMode=e}},o.prototype.getAlphaMode=function(){return this._alphaMode},o.prototype.setAlphaTesting=function(e){this._alphaTest=e},o.prototype.getAlphaTesting=function(){return this._alphaTest},o.prototype.wipeCaches=function(){this.resetTextureCache(),this._currentEffect=null,this._depthCullingState.reset(),this.setDepthFunctionToLessOrEqual(),this._alphaState.reset(),this._cachedVertexBuffers=null,this._cachedIndexBuffer=null,this._cachedEffectForVertexBuffers=null},o.prototype.setSamplingMode=function(t,i){var r=this._gl;r.bindTexture(r.TEXTURE_2D,t);var n=r.NEAREST,o=r.NEAREST;i===e.Texture.BILINEAR_SAMPLINGMODE?(n=r.LINEAR,o=r.LINEAR):i===e.Texture.TRILINEAR_SAMPLINGMODE&&(n=r.LINEAR,o=r.LINEAR_MIPMAP_LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,n),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,o),r.bindTexture(r.TEXTURE_2D,null),t.samplingMode=i},o.prototype.createTexture=function(t,i,r,o,s,a,h,c){var l=this;void 0===s&&(s=e.Texture.TRILINEAR_SAMPLINGMODE),void 0===a&&(a=null),void 0===h&&(h=null),void 0===c&&(c=null);var u,f=this._gl.createTexture(),d=!1;if("data:"===t.substr(0,5)&&(d=!0),d){var p=t;d=p.split(":"),t=p,u=d[1].substr(d[1].length-4,4).toLowerCase()}else u=t.substr(t.length-4,4).toLowerCase();var _=this.getCaps().s3tc&&".dds"===u,m=".tga"===u;o._addPendingData(f),f.url=t,f.noMipmap=i,f.references=1,f.samplingMode=s,this._loadedTexturesCache.push(f);var g,v=function(){o._removePendingData(f),h&&h()};if(m)g=function(t){var h=new Uint8Array(t),c=e.Internals.TGATools.GetTGAHeader(h);n(f,l._gl,o,c.width,c.height,r,i,!1,function(){e.Internals.TGATools.UploadContent(l._gl,h)},a,s)},d instanceof Array?g(c):e.Tools.LoadFile(t,function(e){g(e)},v,o.database,!0);else if(_)g=function(t){var h=e.Internals.DDSTools.GetDDSInfo(t),c=(h.isRGB||h.isLuminance||h.mipmapCount>1)&&!i&&h.width>>h.mipmapCount-1===1;n(f,l._gl,o,h.width,h.height,r,!c,h.isFourCC,function(){e.Internals.DDSTools.UploadDDSLevels(l._gl,l.getCaps().s3tc,t,h,c,1)},a,s)},d instanceof Array?g(c):e.Tools.LoadFile(t,function(e){g(e)},v,o.database,!0);else{var y=function(t){n(f,l._gl,o,t.width,t.height,r,i,!1,function(i,r){var n=t.width===i&&t.height===r;n||(l._prepareWorkingCanvas(),l._workingCanvas.width=i,l._workingCanvas.height=r,s===e.Texture.NEAREST_SAMPLINGMODE&&(l._workingContext.imageSmoothingEnabled=!1,l._workingContext.mozImageSmoothingEnabled=!1,l._workingContext.oImageSmoothingEnabled=!1,l._workingContext.webkitImageSmoothingEnabled=!1,l._workingContext.msImageSmoothingEnabled=!1),l._workingContext.drawImage(t,0,0,t.width,t.height,0,0,i,r),s===e.Texture.NEAREST_SAMPLINGMODE&&(l._workingContext.imageSmoothingEnabled=!0,l._workingContext.mozImageSmoothingEnabled=!0,l._workingContext.oImageSmoothingEnabled=!0,l._workingContext.webkitImageSmoothingEnabled=!0,l._workingContext.msImageSmoothingEnabled=!0)),l._gl.texImage2D(l._gl.TEXTURE_2D,0,l._gl.RGBA,l._gl.RGBA,l._gl.UNSIGNED_BYTE,n?t:l._workingCanvas)},a,s)};d instanceof Array?e.Tools.LoadImage(c,y,v,o.database):e.Tools.LoadImage(t,y,v,o.database)}return f},o.prototype._getInternalFormat=function(e){var t=this._gl.RGBA;switch(e){case o.TEXTUREFORMAT_ALPHA:t=this._gl.ALPHA;break;case o.TEXTUREFORMAT_LUMINANCE:t=this._gl.LUMINANCE;break;case o.TEXTUREFORMAT_LUMINANCE_ALPHA:t=this._gl.LUMINANCE_ALPHA;break;case o.TEXTUREFORMAT_RGB:t=this._gl.RGB;break;case o.TEXTUREFORMAT_RGBA:t=this._gl.RGBA}return t},o.prototype.updateRawTexture=function(e,t,i,r,n){void 0===n&&(n=null);var o=this._getInternalFormat(i);this._gl.bindTexture(this._gl.TEXTURE_2D,e),this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,void 0===r?1:r?1:0),e._width%4!==0&&this._gl.pixelStorei(this._gl.UNPACK_ALIGNMENT,1),n?this._gl.compressedTexImage2D(this._gl.TEXTURE_2D,0,this.getCaps().s3tc[n],e._width,e._height,0,t):this._gl.texImage2D(this._gl.TEXTURE_2D,0,o,e._width,e._height,0,o,this._gl.UNSIGNED_BYTE,t),e.generateMipMaps&&this._gl.generateMipmap(this._gl.TEXTURE_2D),this._gl.bindTexture(this._gl.TEXTURE_2D,null),this.resetTextureCache(),e.isReady=!0},o.prototype.createRawTexture=function(e,t,i,n,o,s,a,h){void 0===h&&(h=null);var c=this._gl.createTexture();c._baseWidth=t,c._baseHeight=i,c._width=t,c._height=i,c.references=1,this.updateRawTexture(c,e,n,s,h),this._gl.bindTexture(this._gl.TEXTURE_2D,c);var l=r(a,o,this._gl);return this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,l.mag),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,l.min),this._gl.bindTexture(this._gl.TEXTURE_2D,null),c.samplingMode=a,this._loadedTexturesCache.push(c),c},o.prototype.createDynamicTexture=function(t,i,r,n){var o=this._gl.createTexture();return o._baseWidth=t,o._baseHeight=i,r&&(t=e.Tools.GetExponentOfTwo(t,this._caps.maxTextureSize),i=e.Tools.GetExponentOfTwo(i,this._caps.maxTextureSize)),this.resetTextureCache(),o._width=t,o._height=i,o.isReady=!1,o.generateMipMaps=r,o.references=1,o.samplingMode=n,this.updateTextureSamplingMode(n,o),this._loadedTexturesCache.push(o),o},o.prototype.updateTextureSamplingMode=function(e,t){var i=r(e,t.generateMipMaps,this._gl);t.isCube?(this._gl.bindTexture(this._gl.TEXTURE_CUBE_MAP,t),this._gl.texParameteri(this._gl.TEXTURE_CUBE_MAP,this._gl.TEXTURE_MAG_FILTER,i.mag),this._gl.texParameteri(this._gl.TEXTURE_CUBE_MAP,this._gl.TEXTURE_MIN_FILTER,i.min),this._gl.bindTexture(this._gl.TEXTURE_CUBE_MAP,null)):(this._gl.bindTexture(this._gl.TEXTURE_2D,t),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,i.mag),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,i.min),this._gl.bindTexture(this._gl.TEXTURE_2D,null))},o.prototype.updateDynamicTexture=function(e,t,i,r){void 0===r&&(r=!1),this._gl.bindTexture(this._gl.TEXTURE_2D,e),this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,i?1:0),r&&this._gl.pixelStorei(this._gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.RGBA,this._gl.RGBA,this._gl.UNSIGNED_BYTE,t),e.generateMipMaps&&this._gl.generateMipmap(this._gl.TEXTURE_2D),this._gl.bindTexture(this._gl.TEXTURE_2D,null),this.resetTextureCache(),e.isReady=!0},o.prototype.updateVideoTexture=function(e,t,i){if(!e._isDisabled){this._gl.bindTexture(this._gl.TEXTURE_2D,e),this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,i?0:1);try{void 0===this._videoTextureSupported&&(this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.RGBA,this._gl.RGBA,this._gl.UNSIGNED_BYTE,t),0!==this._gl.getError()?this._videoTextureSupported=!1:this._videoTextureSupported=!0),this._videoTextureSupported?this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.RGBA,this._gl.RGBA,this._gl.UNSIGNED_BYTE,t):(e._workingCanvas||(e._workingCanvas=document.createElement("canvas"),e._workingContext=e._workingCanvas.getContext("2d"),e._workingCanvas.width=e._width,e._workingCanvas.height=e._height),e._workingContext.drawImage(t,0,0,t.videoWidth,t.videoHeight,0,0,e._width,e._height),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.RGBA,this._gl.RGBA,this._gl.UNSIGNED_BYTE,e._workingCanvas)),e.generateMipMaps&&this._gl.generateMipmap(this._gl.TEXTURE_2D),this._gl.bindTexture(this._gl.TEXTURE_2D,null),this.resetTextureCache(),e.isReady=!0}catch(r){e._isDisabled=!0}}},o.prototype.createRenderTargetTexture=function(t,n){var s=!1,a=!0,h=o.TEXTURETYPE_UNSIGNED_INT,c=e.Texture.TRILINEAR_SAMPLINGMODE;void 0!==n&&(s=void 0===n.generateMipMaps?n:n.generateMipMaps,a=void 0===n.generateDepthBuffer?!0:n.generateDepthBuffer,h=void 0===n.type?h:n.type,void 0!==n.samplingMode&&(c=n.samplingMode),h===o.TEXTURETYPE_FLOAT&&(c=e.Texture.NEAREST_SAMPLINGMODE));var l=this._gl,u=l.createTexture();l.bindTexture(l.TEXTURE_2D,u);var f=t.width||t,d=t.height||t,p=r(c,s,l);h!==o.TEXTURETYPE_FLOAT||this._caps.textureFloat||(h=o.TEXTURETYPE_UNSIGNED_INT,e.Tools.Warn("Float textures are not supported. Render target forced to TEXTURETYPE_UNSIGNED_BYTE type")),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,p.mag),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,p.min),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE),l.texImage2D(l.TEXTURE_2D,0,l.RGBA,f,d,0,l.RGBA,i(l,h),null);var _;a&&(_=l.createRenderbuffer(),l.bindRenderbuffer(l.RENDERBUFFER,_),l.renderbufferStorage(l.RENDERBUFFER,l.DEPTH_COMPONENT16,f,d));var m=l.createFramebuffer();return l.bindFramebuffer(l.FRAMEBUFFER,m),a&&l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.RENDERBUFFER,_),s&&this._gl.generateMipmap(this._gl.TEXTURE_2D),l.bindTexture(l.TEXTURE_2D,null),l.bindRenderbuffer(l.RENDERBUFFER,null),l.bindFramebuffer(l.FRAMEBUFFER,null),u._framebuffer=m,a&&(u._depthBuffer=_),u._baseWidth=f,u._baseHeight=d,u._width=f,u._height=d,u.isReady=!0,u.generateMipMaps=s,u.references=1,u.samplingMode=c,this.resetTextureCache(),this._loadedTexturesCache.push(u),
u},o.prototype.createRenderTargetCubeTexture=function(t,i){var n=this._gl,o=n.createTexture(),s=!0,a=e.Texture.TRILINEAR_SAMPLINGMODE;void 0!==i&&(s=void 0===i.generateMipMaps?i:i.generateMipMaps,void 0!==i.samplingMode&&(a=i.samplingMode)),o.isCube=!0,o.references=1,o.generateMipMaps=s,o.references=1,o.samplingMode=a;var h=r(a,s,n);n.bindTexture(n.TEXTURE_CUBE_MAP,o);for(var c=0;6>c;c++)n.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+c,0,n.RGBA,t,t,0,n.RGBA,n.UNSIGNED_BYTE,null);n.texParameteri(n.TEXTURE_CUBE_MAP,n.TEXTURE_MAG_FILTER,h.mag),n.texParameteri(n.TEXTURE_CUBE_MAP,n.TEXTURE_MIN_FILTER,h.min),n.texParameteri(n.TEXTURE_CUBE_MAP,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_CUBE_MAP,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE);var l=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,l),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_COMPONENT16,t,t);var u=n.createFramebuffer();return n.bindFramebuffer(n.FRAMEBUFFER,u),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,l),o.generateMipMaps&&(n.bindTexture(n.TEXTURE_CUBE_MAP,o),n.generateMipmap(n.TEXTURE_CUBE_MAP)),n.bindTexture(n.TEXTURE_CUBE_MAP,null),n.bindRenderbuffer(n.RENDERBUFFER,null),n.bindFramebuffer(n.FRAMEBUFFER,null),o._framebuffer=u,o._depthBuffer=l,this.resetTextureCache(),o._width=t,o._height=t,o.isReady=!0,o},o.prototype.createCubeTexture=function(t,i,r,n){var o=this,a=this._gl,h=a.createTexture();h.isCube=!0,h.url=t,h.references=1;var c=t.substr(t.length-4,4).toLowerCase(),l=this.getCaps().s3tc&&".dds"===c;return l?e.Tools.LoadFile(t,function(t){var i=e.Internals.DDSTools.GetDDSInfo(t),r=(i.isRGB||i.isLuminance||i.mipmapCount>1)&&!n;a.bindTexture(a.TEXTURE_CUBE_MAP,h),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,1),e.Internals.DDSTools.UploadDDSLevels(o._gl,o.getCaps().s3tc,t,i,r,6),n||i.isFourCC||1!==i.mipmapCount||a.generateMipmap(a.TEXTURE_CUBE_MAP),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MIN_FILTER,r?a.LINEAR_MIPMAP_LINEAR:a.LINEAR),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.bindTexture(a.TEXTURE_CUBE_MAP,null),o.resetTextureCache(),h._width=i.width,h._height=i.height,h.isReady=!0},null,null,!0):s(t,i,function(t){var i=e.Tools.GetExponentOfTwo(t[0].width,o._caps.maxCubemapTextureSize),r=i;o._prepareWorkingCanvas(),o._workingCanvas.width=i,o._workingCanvas.height=r;var s=[a.TEXTURE_CUBE_MAP_POSITIVE_X,a.TEXTURE_CUBE_MAP_POSITIVE_Y,a.TEXTURE_CUBE_MAP_POSITIVE_Z,a.TEXTURE_CUBE_MAP_NEGATIVE_X,a.TEXTURE_CUBE_MAP_NEGATIVE_Y,a.TEXTURE_CUBE_MAP_NEGATIVE_Z];a.bindTexture(a.TEXTURE_CUBE_MAP,h),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,0);for(var c=0;c<s.length;c++)o._workingContext.drawImage(t[c],0,0,t[c].width,t[c].height,0,0,i,r),a.texImage2D(s[c],0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,o._workingCanvas);n||a.generateMipmap(a.TEXTURE_CUBE_MAP),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MIN_FILTER,n?a.LINEAR:a.LINEAR_MIPMAP_LINEAR),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.bindTexture(a.TEXTURE_CUBE_MAP,null),o.resetTextureCache(),h._width=i,h._height=r,h.isReady=!0},r),h},o.prototype.updateTextureSize=function(e,t,i){e._width=t,e._height=i,e._size=t*i,e._baseWidth=t,e._baseHeight=i},o.prototype.createRawCubeTexture=function(t,i,r,n,s,a,h,c){var l=this,u=this._gl,f=u.createTexture();i._addPendingData(f),f.isCube=!0,f.references=1,f.url=t;var d=this._getInternalFormat(n),p=u.UNSIGNED_BYTE;s===o.TEXTURETYPE_FLOAT&&(p=u.FLOAT);var _=r,m=_,g=e.Tools.IsExponentOfTwo(_)&&e.Tools.IsExponentOfTwo(m);f._width=_,f._height=m;var v=function(){i._removePendingData(f)},y=function(t){var r=h(t),n=[u.TEXTURE_CUBE_MAP_POSITIVE_X,u.TEXTURE_CUBE_MAP_POSITIVE_Y,u.TEXTURE_CUBE_MAP_POSITIVE_Z,u.TEXTURE_CUBE_MAP_NEGATIVE_X,u.TEXTURE_CUBE_MAP_NEGATIVE_Y,u.TEXTURE_CUBE_MAP_NEGATIVE_Z];if(_=f._width,m=f._height,g=e.Tools.IsExponentOfTwo(_)&&e.Tools.IsExponentOfTwo(m),u.bindTexture(u.TEXTURE_CUBE_MAP,f),u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,0),!a&&g)if(c){var o=[];o.push(r[0]),o.push(r[3]),o.push(r[1]),o.push(r[4]),o.push(r[2]),o.push(r[5]);for(var s=c(o),v=0;v<s.length;v++){var y=_>>v;u.texImage2D(n[0],v,d,y,y,0,d,p,s[v][0]),u.texImage2D(n[1],v,d,y,y,0,d,p,s[v][2]),u.texImage2D(n[2],v,d,y,y,0,d,p,s[v][4]),u.texImage2D(n[3],v,d,y,y,0,d,p,s[v][1]),u.texImage2D(n[4],v,d,y,y,0,d,p,s[v][3]),u.texImage2D(n[5],v,d,y,y,0,d,p,s[v][5])}}else{for(var x=0;x<n.length;x++){var b=r[x];u.texImage2D(n[x],0,d,_,m,0,d,p,b)}if(u.generateMipmap(u.TEXTURE_CUBE_MAP),p===u.FLOAT&&d===u.RGB&&1282===u.getError()){e.Tools.Log("RGB32F not renderable on Firefox, trying fallback to RGBA32F.");for(var x=0;x<n.length;x++){for(var b=r[x],P=new Float32Array(_*m*4),A=0;_>A;A++)for(var T=0;m>T;T++){var E=3*(T*_+A),C=4*(T*_+A);P[C+0]=b[E+0],P[C+1]=b[E+1],P[C+2]=b[E+2],P[C+3]=1}u.texImage2D(n[x],0,u.RGBA,_,m,0,u.RGBA,p,P)}u.generateMipmap(u.TEXTURE_CUBE_MAP)}}else a=!0;p!==u.FLOAT||l._caps.textureFloatLinearFiltering?(u.texParameteri(u.TEXTURE_CUBE_MAP,u.TEXTURE_MAG_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_CUBE_MAP,u.TEXTURE_MIN_FILTER,a?u.LINEAR:u.LINEAR_MIPMAP_LINEAR)):(u.texParameteri(u.TEXTURE_CUBE_MAP,u.TEXTURE_MAG_FILTER,u.NEAREST),u.texParameteri(u.TEXTURE_CUBE_MAP,u.TEXTURE_MIN_FILTER,u.NEAREST)),u.texParameteri(u.TEXTURE_CUBE_MAP,u.TEXTURE_WRAP_S,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_CUBE_MAP,u.TEXTURE_WRAP_T,u.CLAMP_TO_EDGE),u.bindTexture(u.TEXTURE_CUBE_MAP,null),f.isReady=!0,l.resetTextureCache(),i._removePendingData(f)};return e.Tools.LoadFile(t,function(e){y(e)},v,i.database,!0),f},o.prototype._releaseTexture=function(e){var t=this._gl;e._framebuffer&&t.deleteFramebuffer(e._framebuffer),e._depthBuffer&&t.deleteRenderbuffer(e._depthBuffer),t.deleteTexture(e),this.unbindAllTextures();var i=this._loadedTexturesCache.indexOf(e);-1!==i&&this._loadedTexturesCache.splice(i,1)},o.prototype.bindSamplers=function(e){this._gl.useProgram(e.getProgram());for(var t=e.getSamplers(),i=0;i<t.length;i++){var r=e.getUniform(t[i]);this._gl.uniform1i(r,i)}this._currentEffect=null},o.prototype._bindTexture=function(e,t){0>e||(this._gl.activeTexture(this._gl["TEXTURE"+e]),this._gl.bindTexture(this._gl.TEXTURE_2D,t),this._activeTexturesCache[e]=null)},o.prototype.setTextureFromPostProcess=function(e,t){this._bindTexture(e,t._textures.data[t._currentRenderTextureInd])},o.prototype.unbindAllTextures=function(){for(var e=0;e<this._caps.maxTexturesImageUnits;e++)this._gl.activeTexture(this._gl["TEXTURE"+e]),this._gl.bindTexture(this._gl.TEXTURE_2D,null),this._gl.bindTexture(this._gl.TEXTURE_CUBE_MAP,null),this._activeTexturesCache[e]=null},o.prototype.setTexture=function(t,i){if(!(0>t)){if(!i||!i.isReady())return void(null!=this._activeTexturesCache[t]&&(this._gl.activeTexture(this._gl["TEXTURE"+t]),this._gl.bindTexture(this._gl.TEXTURE_2D,null),this._gl.bindTexture(this._gl.TEXTURE_CUBE_MAP,null),this._activeTexturesCache[t]=null));var r=!1;if(i instanceof e.VideoTexture)this._gl.activeTexture(this._gl["TEXTURE"+t]),r=!0,i.update();else if(i.delayLoadState===o.DELAYLOADSTATE_NOTLOADED)return void i.delayLoad();if(this._activeTexturesCache[t]!==i){this._activeTexturesCache[t]=i;var n=i.getInternalTexture();if(r||this._gl.activeTexture(this._gl["TEXTURE"+t]),n.isCube){if(this._gl.bindTexture(this._gl.TEXTURE_CUBE_MAP,n),n._cachedCoordinatesMode!==i.coordinatesMode){n._cachedCoordinatesMode=i.coordinatesMode;var s=i.coordinatesMode!==e.Texture.CUBIC_MODE&&i.coordinatesMode!==e.Texture.SKYBOX_MODE?this._gl.REPEAT:this._gl.CLAMP_TO_EDGE;this._gl.texParameteri(this._gl.TEXTURE_CUBE_MAP,this._gl.TEXTURE_WRAP_S,s),this._gl.texParameteri(this._gl.TEXTURE_CUBE_MAP,this._gl.TEXTURE_WRAP_T,s)}this._setAnisotropicLevel(this._gl.TEXTURE_CUBE_MAP,i)}else{if(this._gl.bindTexture(this._gl.TEXTURE_2D,n),n._cachedWrapU!==i.wrapU)switch(n._cachedWrapU=i.wrapU,i.wrapU){case e.Texture.WRAP_ADDRESSMODE:this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.REPEAT);break;case e.Texture.CLAMP_ADDRESSMODE:this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE);break;case e.Texture.MIRROR_ADDRESSMODE:this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.MIRRORED_REPEAT)}if(n._cachedWrapV!==i.wrapV)switch(n._cachedWrapV=i.wrapV,i.wrapV){case e.Texture.WRAP_ADDRESSMODE:this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.REPEAT);break;case e.Texture.CLAMP_ADDRESSMODE:this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE);break;case e.Texture.MIRROR_ADDRESSMODE:this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.MIRRORED_REPEAT)}this._setAnisotropicLevel(this._gl.TEXTURE_2D,i)}}}},o.prototype._setAnisotropicLevel=function(t,i){var r=this._caps.textureAnisotropicFilterExtension,n=i.anisotropicFilteringLevel;i.getInternalTexture().samplingMode===e.Texture.NEAREST_SAMPLINGMODE&&(n=1),r&&i._cachedAnisotropicFilteringLevel!==n&&(this._gl.texParameterf(t,r.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(n,this._caps.maxAnisotropy)),i._cachedAnisotropicFilteringLevel=n)},o.prototype.readPixels=function(e,t,i,r){var n=new Uint8Array(r*i*4);return this._gl.readPixels(e,t,i,r,this._gl.RGBA,this._gl.UNSIGNED_BYTE,n),n},o.prototype.addExternalData=function(e,t){return this._externalData.add(e,t)},o.prototype.getExternalData=function(e){return this._externalData.get(e)},o.prototype.getOrAddExternalDataWithFactory=function(e,t){return this._externalData.getOrAddWithFactory(e,t)},o.prototype.removeExternalData=function(e){return this._externalData.remove(e)},o.prototype.releaseInternalTexture=function(e){if(e&&(e.references--,0===e.references)){var t=this.getLoadedTexturesCache(),i=t.indexOf(e);i>-1&&t.splice(i,1),this._releaseTexture(e)}},o.prototype.dispose=function(){for(this.hideLoadingUI(),this.stopRenderLoop();this.scenes.length;)this.scenes[0].dispose();o.audioEngine.dispose();for(var e in this._compiledEffects)this._gl.deleteProgram(this._compiledEffects[e]._program);if(this._vertexAttribArraysEnabled)for(var t=0,i=this._vertexAttribArraysEnabled.length;i>t;t++)t>this._gl.VERTEX_ATTRIB_ARRAY_ENABLED||!this._vertexAttribArraysEnabled[t]||this._gl.disableVertexAttribArray(t);this._gl=null,window.removeEventListener("blur",this._onBlur),window.removeEventListener("focus",this._onFocus),document.removeEventListener("fullscreenchange",this._onFullscreenChange),document.removeEventListener("mozfullscreenchange",this._onFullscreenChange),document.removeEventListener("webkitfullscreenchange",this._onFullscreenChange),document.removeEventListener("msfullscreenchange",this._onFullscreenChange),document.removeEventListener("pointerlockchange",this._onPointerLockChange),document.removeEventListener("mspointerlockchange",this._onPointerLockChange),document.removeEventListener("mozpointerlockchange",this._onPointerLockChange),document.removeEventListener("webkitpointerlockchange",this._onPointerLockChange)},o.prototype.displayLoadingUI=function(){this._loadingScreen.displayLoadingUI()},o.prototype.hideLoadingUI=function(){this._loadingScreen.hideLoadingUI()},Object.defineProperty(o.prototype,"loadingScreen",{get:function(){return this._loadingScreen},set:function(e){this._loadingScreen=e},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"loadingUIText",{set:function(e){this._loadingScreen.loadingUIText=e},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"loadingUIBackgroundColor",{set:function(e){this._loadingScreen.loadingUIBackgroundColor=e},enumerable:!0,configurable:!0}),o.prototype.getFps=function(){return this.fps},o.prototype.getDeltaTime=function(){return this.deltaTime},o.prototype._measureFps=function(){this.previousFramesDuration.push(e.Tools.Now);var t=this.previousFramesDuration.length;if(t>=2&&(this.deltaTime=this.previousFramesDuration[t-1]-this.previousFramesDuration[t-2]),t>=this.fpsRange){t>this.fpsRange&&(this.previousFramesDuration.splice(0,1),t=this.previousFramesDuration.length);for(var i=0,r=0;t-1>r;r++)i+=this.previousFramesDuration[r+1]-this.previousFramesDuration[r];this.fps=1e3/(i/(t-1))}},o.isSupported=function(){try{if(navigator.isCocoonJS)return!0;var e=document.createElement("canvas"),t=e.getContext("webgl")||e.getContext("experimental-webgl");return null!=t&&!!window.WebGLRenderingContext}catch(i){return!1}},o._ALPHA_DISABLE=0,o._ALPHA_ADD=1,o._ALPHA_COMBINE=2,o._ALPHA_SUBTRACT=3,o._ALPHA_MULTIPLY=4,o._ALPHA_MAXIMIZED=5,o._ALPHA_ONEONE=6,o._DELAYLOADSTATE_NONE=0,o._DELAYLOADSTATE_LOADED=1,o._DELAYLOADSTATE_LOADING=2,o._DELAYLOADSTATE_NOTLOADED=4,o._TEXTUREFORMAT_ALPHA=0,o._TEXTUREFORMAT_LUMINANCE=1,o._TEXTUREFORMAT_LUMINANCE_ALPHA=2,o._TEXTUREFORMAT_RGB=4,o._TEXTUREFORMAT_RGBA=5,o._TEXTURETYPE_UNSIGNED_INT=0,o._TEXTURETYPE_FLOAT=1,o.CollisionsEpsilon=.001,o.CodeRepository="src/",o.ShadersRepository="src/Shaders/",o}();e.Engine=c}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(e,t){this.state="",this.animations=new Array,this._ranges={},this._childrenFlag=-1,this._isEnabled=!0,this._isReady=!0,this._currentRenderId=-1,this._parentRenderId=-1,this.name=e,this.id=e,this._scene=t,this._initCache()}return Object.defineProperty(t.prototype,"parent",{get:function(){return this._parentNode},set:function(e){if(this._parentNode!==e){if(this._parentNode){var t=this._parentNode._children.indexOf(this);-1!==t&&this._parentNode._children.splice(t,1)}this._parentNode=e,this._parentNode&&(this._parentNode._children||(this._parentNode._children=new Array),this._parentNode._children.push(this))}},enumerable:!0,configurable:!0}),t.prototype.getScene=function(){return this._scene},t.prototype.getEngine=function(){return this._scene.getEngine()},t.prototype.getWorldMatrix=function(){return e.Matrix.Identity()},t.prototype._initCache=function(){this._cache={},this._cache.parent=void 0},t.prototype.updateCache=function(e){!e&&this.isSynchronized()||(this._cache.parent=this.parent,this._updateCache())},t.prototype._updateCache=function(e){},t.prototype._isSynchronized=function(){return!0},t.prototype._markSyncedWithParent=function(){this._parentRenderId=this.parent._currentRenderId},t.prototype.isSynchronizedWithParent=function(){return this.parent?this._parentRenderId!==this.parent._currentRenderId?!1:this.parent.isSynchronized():!0},t.prototype.isSynchronized=function(e){var t=this.hasNewParent();return t=t||!this.isSynchronizedWithParent(),t=t||!this._isSynchronized(),e&&this.updateCache(!0),!t},t.prototype.hasNewParent=function(e){return this._cache.parent===this.parent?!1:(e&&(this._cache.parent=this.parent),!0)},t.prototype.isReady=function(){return this._isReady},t.prototype.isEnabled=function(){return this._isEnabled?this.parent?this.parent.isEnabled():!0:!1},t.prototype.setEnabled=function(e){this._isEnabled=e},t.prototype.isDescendantOf=function(e){return this.parent?this.parent===e?!0:this.parent.isDescendantOf(e):!1},t.prototype._getDescendants=function(e,t,i){if(void 0===t&&(t=!1),this._children)for(var r=0;r<this._children.length;r++){var n=this._children[r];i&&!i(n)||e.push(n),t||n._getDescendants(e,!1,i)}},t.prototype.getDescendants=function(e,t){var i=[];return this._getDescendants(i,e,t),i},t.prototype.getChildren=function(e){return this.getDescendants(!0,e)},t.prototype.getChildMeshes=function(t,i){var r=[];return this._getDescendants(r,t,function(t){return(!i||i(t))&&t instanceof e.AbstractMesh}),r},t.prototype._setReady=function(e){if(e!==this._isReady){if(!e)return void(this._isReady=!1);this._isReady=!0,this.onReady&&this.onReady(this)}},t.prototype.getAnimationByName=function(e){for(var t=0;t<this.animations.length;t++){var i=this.animations[t];if(i.name===e)return i}return null},t.prototype.createAnimationRange=function(t,i,r){if(!this._ranges[t]){this._ranges[t]=new e.AnimationRange(t,i,r);for(var n=0,o=this.animations.length;o>n;n++)this.animations[n]&&this.animations[n].createRange(t,i,r)}},t.prototype.deleteAnimationRange=function(e,t){void 0===t&&(t=!0);for(var i=0,r=this.animations.length;r>i;i++)this.animations[i]&&this.animations[i].deleteRange(e,t);this._ranges[e]=void 0},t.prototype.getAnimationRange=function(e){return this._ranges[e]},t.prototype.beginAnimation=function(e,t,i,r){var n=this.getAnimationRange(e);return n?void this._scene.beginAnimation(this,n.from,n.to,t,i,r):null},t.prototype.serializeAnimationRanges=function(){var e=[];for(var t in this._ranges){var i={};i.name=t,i.from=this._ranges[t].from,i.to=this._ranges[t].to,e.push(i)}return e},t.prototype.dispose=function(){this.parent=null},t.ParseAnimationRanges=function(e,t,i){if(t.ranges)for(var r=0;r<t.ranges.length;r++){var n=t.ranges[r];e.createAnimationRange(n.name,n.from,n.to)}},__decorate([e.serialize()],t.prototype,"name",void 0),__decorate([e.serialize()],t.prototype,"id",void 0),__decorate([e.serialize()],t.prototype,"uniqueId",void 0),__decorate([e.serialize()],t.prototype,"state",void 0),t}();e.Node=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(e,t,i,r,n,o,s,a){this._engine=e,this._canvas=i,this._currentScene=t,this._sceneLoadedCallback=r,this._progressCallback=n,this._additionnalRenderLoopLogicCallback=o,this._textureLoadingCallback=s,this._startingProcessingFilesCallback=a}return t.prototype.monitorElementForDragNDrop=function(e){var t=this;e&&(this._elementToMonitor=e,this._elementToMonitor.addEventListener("dragenter",function(e){t.drag(e)},!1),this._elementToMonitor.addEventListener("dragover",function(e){t.drag(e)},!1),this._elementToMonitor.addEventListener("drop",function(e){t.drop(e)},!1))},t.prototype.renderFunction=function(){if(this._additionnalRenderLoopLogicCallback&&this._additionnalRenderLoopLogicCallback(),this._currentScene){if(this._textureLoadingCallback){var e=this._currentScene.getWaitingItemsCount();e>0&&this._textureLoadingCallback(e)}this._currentScene.render()}},t.prototype.drag=function(e){e.stopPropagation(),e.preventDefault()},t.prototype.drop=function(e){e.stopPropagation(),e.preventDefault(),this.loadFiles(e)},t.prototype.loadFiles=function(e){if(this._startingProcessingFilesCallback&&this._startingProcessingFilesCallback(),e&&e.dataTransfer&&e.dataTransfer.files&&(this._filesToLoad=e.dataTransfer.files),e&&e.target&&e.target.files&&(this._filesToLoad=e.target.files),this._filesToLoad&&this._filesToLoad.length>0){for(var i=0;i<this._filesToLoad.length;i++)switch(this._filesToLoad[i].type){case"image/jpeg":case"image/png":case"image/bmp":t.FilesTextures[this._filesToLoad[i].name.toLowerCase()]=this._filesToLoad[i];break;case"image/targa":case"image/vnd.ms-dds":case"audio/wav":case"audio/x-wav":case"audio/mp3":case"audio/mpeg":case"audio/mpeg3":case"audio/x-mpeg-3":case"audio/ogg":t.FilesToLoad[this._filesToLoad[i].name.toLowerCase()]=this._filesToLoad[i];break;default:-1!==this._filesToLoad[i].name.indexOf(".mtl")?t.FilesToLoad[this._filesToLoad[i].name.toLowerCase()]=this._filesToLoad[i]:-1===this._filesToLoad[i].name.indexOf(".babylon")&&-1===this._filesToLoad[i].name.indexOf(".stl")&&-1===this._filesToLoad[i].name.indexOf(".obj")||-1!==this._filesToLoad[i].name.indexOf(".manifest")||-1!==this._filesToLoad[i].name.indexOf(".incremental")||-1!==this._filesToLoad[i].name.indexOf(".babylonmeshdata")||-1!==this._filesToLoad[i].name.indexOf(".babylongeometrydata")||-1!==this._filesToLoad[i].name.indexOf(".babylonbinarymeshdata")||-1!==this._filesToLoad[i].name.indexOf(".binary.babylon")||(this._sceneFileToLoad=this._filesToLoad[i])}this.reload()}},t.prototype.reload=function(){var t=this,i=this;this._sceneFileToLoad?(this._currentScene&&(e.Tools.errorsCount>0&&(e.Tools.ClearLogCache(),e.Tools.Log("Babylon.js engine (v"+e.Engine.Version+") launched")),this._engine.stopRenderLoop(),this._currentScene.dispose()),e.SceneLoader.Load("file:",this._sceneFileToLoad,this._engine,function(e){i._currentScene=e,i._currentScene.executeWhenReady(function(){i._currentScene.activeCamera&&0!==i._currentScene.lights.length||i._currentScene.createDefaultCameraOrLight(),i._currentScene.activeCamera.attachControl(i._canvas),i._sceneLoadedCallback&&i._sceneLoadedCallback(t._sceneFileToLoad,i._currentScene),i._engine.runRenderLoop(function(){i.renderFunction()})})},function(e){t._progressCallback&&t._progressCallback(e)})):e.Tools.Error("Please provide a valid .babylon file.")},t.FilesTextures=new Array,t.FilesToLoad=new Array,t}();e.FilesInput=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function e(e,t,i){this.bu=e,this.bv=t,this.distance=i,this.faceId=0,this.subMeshId=0}return e}();e.IntersectionInfo=t;var i=function(){function t(){this.hit=!1,this.distance=0,this.pickedPoint=null,this.pickedMesh=null,this.bu=0,this.bv=0,this.faceId=-1,this.subMeshId=0,this.pickedSprite=null}return t.prototype.getNormal=function(t,i){if(void 0===t&&(t=!1),void 0===i&&(i=!0),!this.pickedMesh||!this.pickedMesh.isVerticesDataPresent(e.VertexBuffer.NormalKind))return null;var r,n=this.pickedMesh.getIndices();if(i){var o=this.pickedMesh.getVerticesData(e.VertexBuffer.NormalKind),s=e.Vector3.FromArray(o,3*n[3*this.faceId]),a=e.Vector3.FromArray(o,3*n[3*this.faceId+1]),h=e.Vector3.FromArray(o,3*n[3*this.faceId+2]);s=s.scale(this.bu),a=a.scale(this.bv),h=h.scale(1-this.bu-this.bv),r=new e.Vector3(s.x+a.x+h.x,s.y+a.y+h.y,s.z+a.z+h.z)}else{var c=this.pickedMesh.getVerticesData(e.VertexBuffer.PositionKind),l=e.Vector3.FromArray(c,3*n[3*this.faceId]),u=e.Vector3.FromArray(c,3*n[3*this.faceId+1]),f=e.Vector3.FromArray(c,3*n[3*this.faceId+2]),d=l.subtract(u),p=f.subtract(u);r=e.Vector3.Cross(d,p)}return t&&(r=e.Vector3.TransformNormal(r,this.pickedMesh.getWorldMatrix())),e.Vector3.Normalize(r)},t.prototype.getTextureCoordinates=function(){if(!this.pickedMesh||!this.pickedMesh.isVerticesDataPresent(e.VertexBuffer.UVKind))return null;var t=this.pickedMesh.getIndices(),i=this.pickedMesh.getVerticesData(e.VertexBuffer.UVKind),r=e.Vector2.FromArray(i,2*t[3*this.faceId]),n=e.Vector2.FromArray(i,2*t[3*this.faceId+1]),o=e.Vector2.FromArray(i,2*t[3*this.faceId+2]);return r=r.scale(1-this.bu-this.bv),n=n.scale(this.bu),o=o.scale(this.bv),new e.Vector2(r.x+n.x+o.x,r.y+n.y+o.y)},t}();e.PickingInfo=i}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(t,i){this.minimum=t,this.maximum=i,this._tempRadiusVector=e.Vector3.Zero();var r=e.Vector3.Distance(t,i);this.center=e.Vector3.Lerp(t,i,.5),this.radius=.5*r,this.centerWorld=e.Vector3.Zero(),this._update(e.Matrix.Identity())}return t.prototype._update=function(t){e.Vector3.TransformCoordinatesToRef(this.center,t,this.centerWorld),e.Vector3.TransformNormalFromFloatsToRef(1,1,1,t,this._tempRadiusVector),this.radiusWorld=Math.max(Math.abs(this._tempRadiusVector.x),Math.abs(this._tempRadiusVector.y),Math.abs(this._tempRadiusVector.z))*this.radius},t.prototype.isInFrustum=function(e){for(var t=0;6>t;t++)if(e[t].dotCoordinate(this.centerWorld)<=-this.radiusWorld)return!1;return!0},t.prototype.intersectsPoint=function(t){var i=this.centerWorld.x-t.x,r=this.centerWorld.y-t.y,n=this.centerWorld.z-t.z,o=Math.sqrt(i*i+r*r+n*n);return!(Math.abs(this.radiusWorld-o)<e.Epsilon)},t.Intersects=function(e,t){var i=e.centerWorld.x-t.centerWorld.x,r=e.centerWorld.y-t.centerWorld.y,n=e.centerWorld.z-t.centerWorld.z,o=Math.sqrt(i*i+r*r+n*n);return!(e.radiusWorld+t.radiusWorld<o)},t}();e.BoundingSphere=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(t,i){this.minimum=t,this.maximum=i,this.vectors=new Array,this.vectorsWorld=new Array,this.vectors.push(this.minimum.clone()),this.vectors.push(this.maximum.clone()),this.vectors.push(this.minimum.clone()),this.vectors[2].x=this.maximum.x,this.vectors.push(this.minimum.clone()),this.vectors[3].y=this.maximum.y,this.vectors.push(this.minimum.clone()),this.vectors[4].z=this.maximum.z,this.vectors.push(this.maximum.clone()),this.vectors[5].z=this.minimum.z,this.vectors.push(this.maximum.clone()),this.vectors[6].x=this.minimum.x,this.vectors.push(this.maximum.clone()),this.vectors[7].y=this.minimum.y,this.center=this.maximum.add(this.minimum).scale(.5),this.extendSize=this.maximum.subtract(this.minimum).scale(.5),this.directions=[e.Vector3.Zero(),e.Vector3.Zero(),e.Vector3.Zero()];for(var r=0;r<this.vectors.length;r++)this.vectorsWorld[r]=e.Vector3.Zero();this.minimumWorld=e.Vector3.Zero(),this.maximumWorld=e.Vector3.Zero(),this._update(e.Matrix.Identity())}return t.prototype.getWorldMatrix=function(){return this._worldMatrix},t.prototype.setWorldMatrix=function(e){return this._worldMatrix.copyFrom(e),this},t.prototype._update=function(t){e.Vector3.FromFloatsToRef(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,this.minimumWorld),e.Vector3.FromFloatsToRef(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,this.maximumWorld);for(var i=0;i<this.vectors.length;i++){var r=this.vectorsWorld[i];e.Vector3.TransformCoordinatesToRef(this.vectors[i],t,r),r.x<this.minimumWorld.x&&(this.minimumWorld.x=r.x),r.y<this.minimumWorld.y&&(this.minimumWorld.y=r.y),r.z<this.minimumWorld.z&&(this.minimumWorld.z=r.z),r.x>this.maximumWorld.x&&(this.maximumWorld.x=r.x),r.y>this.maximumWorld.y&&(this.maximumWorld.y=r.y),r.z>this.maximumWorld.z&&(this.maximumWorld.z=r.z)}this.maximumWorld.addToRef(this.minimumWorld,this.center),this.center.scaleInPlace(.5),e.Vector3.FromFloatArrayToRef(t.m,0,this.directions[0]),e.Vector3.FromFloatArrayToRef(t.m,4,this.directions[1]),e.Vector3.FromFloatArrayToRef(t.m,8,this.directions[2]),this._worldMatrix=t},t.prototype.isInFrustum=function(e){return t.IsInFrustum(this.vectorsWorld,e)},t.prototype.isCompletelyInFrustum=function(e){return t.IsCompletelyInFrustum(this.vectorsWorld,e)},t.prototype.intersectsPoint=function(t){var i=-e.Epsilon;return this.maximumWorld.x-t.x<i||i>t.x-this.minimumWorld.x?!1:this.maximumWorld.y-t.y<i||i>t.y-this.minimumWorld.y?!1:!(this.maximumWorld.z-t.z<i||i>t.z-this.minimumWorld.z)},t.prototype.intersectsSphere=function(e){return t.IntersectsSphere(this.minimumWorld,this.maximumWorld,e.centerWorld,e.radiusWorld)},t.prototype.intersectsMinMax=function(e,t){return this.maximumWorld.x<e.x||this.minimumWorld.x>t.x?!1:this.maximumWorld.y<e.y||this.minimumWorld.y>t.y?!1:!(this.maximumWorld.z<e.z||this.minimumWorld.z>t.z)},t.Intersects=function(e,t){return e.maximumWorld.x<t.minimumWorld.x||e.minimumWorld.x>t.maximumWorld.x?!1:e.maximumWorld.y<t.minimumWorld.y||e.minimumWorld.y>t.maximumWorld.y?!1:!(e.maximumWorld.z<t.minimumWorld.z||e.minimumWorld.z>t.maximumWorld.z)},t.IntersectsSphere=function(t,i,r,n){var o=e.Vector3.Clamp(r,t,i),s=e.Vector3.DistanceSquared(r,o);return n*n>=s},t.IsCompletelyInFrustum=function(e,t){for(var i=0;6>i;i++)for(var r=0;8>r;r++)if(t[i].dotCoordinate(e[r])<0)return!1;return!0},t.IsInFrustum=function(e,t){for(var i=0;6>i;i++){for(var r=8,n=0;8>n&&t[i].dotCoordinate(e[n])<0;n++)--r;if(0===r)return!1}return!0},t}();e.BoundingBox=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t,i){var r=e.Vector3.Dot(i.center,t),n=Math.abs(e.Vector3.Dot(i.directions[0],t))*i.extendSize.x,o=Math.abs(e.Vector3.Dot(i.directions[1],t))*i.extendSize.y,s=Math.abs(e.Vector3.Dot(i.directions[2],t))*i.extendSize.z,a=n+o+s;return{min:r-a,max:r+a}},i=function(e,t,i,r){return!(e>r||i>t)},r=function(e,r,n){var o=t(e,r),s=t(e,n);return i(o.min,o.max,s.min,s.max)},n=function(){function t(t,i){this.minimum=t,this.maximum=i,this._isLocked=!1,this.boundingBox=new e.BoundingBox(t,i),this.boundingSphere=new e.BoundingSphere(t,i)}return Object.defineProperty(t.prototype,"isLocked",{get:function(){return this._isLocked},set:function(e){this._isLocked=e},enumerable:!0,configurable:!0}),t.prototype.update=function(e){this._isLocked||(this.boundingBox._update(e),this.boundingSphere._update(e))},t.prototype.isInFrustum=function(e){return this.boundingSphere.isInFrustum(e)?this.boundingBox.isInFrustum(e):!1},t.prototype.isCompletelyInFrustum=function(e){return this.boundingBox.isCompletelyInFrustum(e)},t.prototype._checkCollision=function(e){return e._canDoCollision(this.boundingSphere.centerWorld,this.boundingSphere.radiusWorld,this.boundingBox.minimumWorld,this.boundingBox.maximumWorld)},t.prototype.intersectsPoint=function(e){return this.boundingSphere.centerWorld&&this.boundingSphere.intersectsPoint(e)?!!this.boundingBox.intersectsPoint(e):!1},t.prototype.intersects=function(t,i){if(!this.boundingSphere.centerWorld||!t.boundingSphere.centerWorld)return!1;if(!e.BoundingSphere.Intersects(this.boundingSphere,t.boundingSphere))return!1;if(!e.BoundingBox.Intersects(this.boundingBox,t.boundingBox))return!1;if(!i)return!0;var n=this.boundingBox,o=t.boundingBox;return r(n.directions[0],n,o)&&r(n.directions[1],n,o)&&r(n.directions[2],n,o)&&r(o.directions[0],n,o)&&r(o.directions[1],n,o)&&r(o.directions[2],n,o)&&r(e.Vector3.Cross(n.directions[0],o.directions[0]),n,o)&&r(e.Vector3.Cross(n.directions[0],o.directions[1]),n,o)&&r(e.Vector3.Cross(n.directions[0],o.directions[2]),n,o)&&r(e.Vector3.Cross(n.directions[1],o.directions[0]),n,o)&&r(e.Vector3.Cross(n.directions[1],o.directions[1]),n,o)&&r(e.Vector3.Cross(n.directions[1],o.directions[2]),n,o)&&r(e.Vector3.Cross(n.directions[2],o.directions[0]),n,o)&&r(e.Vector3.Cross(n.directions[2],o.directions[1]),n,o)?!!r(e.Vector3.Cross(n.directions[2],o.directions[2]),n,o):!1},t}();e.BoundingInfo=n}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(e,t,i){void 0===i&&(i=Number.MAX_VALUE),this.origin=e,this.direction=t,this.length=i}return t.prototype.intersectsBoxMinMax=function(e,t){var i,r,n,o,s=0,a=Number.MAX_VALUE;if(Math.abs(this.direction.x)<1e-7){if(this.origin.x<e.x||this.origin.x>t.x)return!1}else if(i=1/this.direction.x,r=(e.x-this.origin.x)*i,n=(t.x-this.origin.x)*i,n===-(1/0)&&(n=1/0),r>n&&(o=r,r=n,n=o),s=Math.max(r,s),a=Math.min(n,a),s>a)return!1;if(Math.abs(this.direction.y)<1e-7){if(this.origin.y<e.y||this.origin.y>t.y)return!1}else if(i=1/this.direction.y,r=(e.y-this.origin.y)*i,n=(t.y-this.origin.y)*i,n===-(1/0)&&(n=1/0),r>n&&(o=r,r=n,n=o),s=Math.max(r,s),a=Math.min(n,a),s>a)return!1;if(Math.abs(this.direction.z)<1e-7){if(this.origin.z<e.z||this.origin.z>t.z)return!1}else if(i=1/this.direction.z,r=(e.z-this.origin.z)*i,n=(t.z-this.origin.z)*i,n===-(1/0)&&(n=1/0),r>n&&(o=r,r=n,n=o),s=Math.max(r,s),a=Math.min(n,a),s>a)return!1;return!0},t.prototype.intersectsBox=function(e){return this.intersectsBoxMinMax(e.minimum,e.maximum)},t.prototype.intersectsSphere=function(e){var t=e.center.x-this.origin.x,i=e.center.y-this.origin.y,r=e.center.z-this.origin.z,n=t*t+i*i+r*r,o=e.radius*e.radius;if(o>=n)return!0;var s=t*this.direction.x+i*this.direction.y+r*this.direction.z;if(0>s)return!1;var a=n-s*s;return o>=a},t.prototype.intersectsTriangle=function(t,i,r){this._edge1||(this._edge1=e.Vector3.Zero(),this._edge2=e.Vector3.Zero(),this._pvec=e.Vector3.Zero(),this._tvec=e.Vector3.Zero(),this._qvec=e.Vector3.Zero()),i.subtractToRef(t,this._edge1),r.subtractToRef(t,this._edge2),e.Vector3.CrossToRef(this.direction,this._edge2,this._pvec);var n=e.Vector3.Dot(this._edge1,this._pvec);if(0===n)return null;var o=1/n;this.origin.subtractToRef(t,this._tvec);var s=e.Vector3.Dot(this._tvec,this._pvec)*o;if(0>s||s>1)return null;e.Vector3.CrossToRef(this._tvec,this._edge1,this._qvec);var a=e.Vector3.Dot(this.direction,this._qvec)*o;if(0>a||s+a>1)return null;var h=e.Vector3.Dot(this._edge2,this._qvec)*o;return h>this.length?null:new e.IntersectionInfo(s,a,h)},t.prototype.intersectsPlane=function(t){var i,r=e.Vector3.Dot(t.normal,this.direction);if(Math.abs(r)<9.99999997475243e-7)return null;var n=e.Vector3.Dot(t.normal,this.origin);return i=(-t.d-n)/r,0>i?-9.99999997475243e-7>i?null:0:i},t.prototype.intersectionSegment=function(i,r,n){var o,s,a,h,c=this.origin.add(this.direction.multiplyByFloats(t.rayl,t.rayl,t.rayl)),l=r.subtract(i),u=c.subtract(this.origin),f=i.subtract(this.origin),d=e.Vector3.Dot(l,l),p=e.Vector3.Dot(l,u),_=e.Vector3.Dot(u,u),m=e.Vector3.Dot(l,f),g=e.Vector3.Dot(u,f),v=d*_-p*p,y=v,x=v;
v<t.smallnum?(s=0,y=1,h=g,x=_):(s=p*g-_*m,h=d*g-p*m,0>s?(s=0,h=g,x=_):s>y&&(s=y,h=g+p,x=_)),0>h?(h=0,0>-m?s=0:-m>d?s=y:(s=-m,y=d)):h>x&&(h=x,0>-m+p?s=0:-m+p>d?s=y:(s=-m+p,y=d)),o=Math.abs(s)<t.smallnum?0:s/y,a=Math.abs(h)<t.smallnum?0:h/x;var b=u.multiplyByFloats(a,a,a),P=f.add(l.multiplyByFloats(o,o,o)).subtract(b),A=a>0&&a<=this.length&&P.lengthSquared()<n*n;return A?b.length():-1},t.CreateNew=function(i,r,n,o,s,a,h){var c=e.Vector3.Unproject(new e.Vector3(i,r,0),n,o,s,a,h),l=e.Vector3.Unproject(new e.Vector3(i,r,1),n,o,s,a,h),u=l.subtract(c);return u.normalize(),new t(c,u)},t.CreateNewFromTo=function(i,r,n){void 0===n&&(n=e.Matrix.Identity());var o=r.subtract(i),s=Math.sqrt(o.x*o.x+o.y*o.y+o.z*o.z);return o.normalize(),t.Transform(new t(i,o,s),n)},t.Transform=function(i,r){var n=e.Vector3.TransformCoordinates(i.origin,r),o=e.Vector3.TransformNormal(i.direction,r);return o.normalize(),new t(n,o,i.length)},t.smallnum=1e-8,t.rayl=1e9,t}();e.Ray=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(r,n){var o=this;t.call(this,r,n),this.onDisposeObservable=new e.Observable,this.onCollideObservable=new e.Observable,this.onCollisionPositionChangeObservable=new e.Observable,this.onAfterWorldMatrixUpdateObservable=new e.Observable,this.definedFacingForward=!0,this.position=new e.Vector3(0,0,0),this._rotation=new e.Vector3(0,0,0),this._scaling=new e.Vector3(1,1,1),this.billboardMode=i.BILLBOARDMODE_NONE,this.visibility=1,this.alphaIndex=Number.MAX_VALUE,this.infiniteDistance=!1,this.isVisible=!0,this.isPickable=!0,this.showBoundingBox=!1,this.showSubMeshesBoundingBox=!1,this.isBlocker=!1,this.renderingGroupId=0,this.receiveShadows=!1,this.renderOutline=!1,this.outlineColor=e.Color3.Red(),this.outlineWidth=.02,this.renderOverlay=!1,this.overlayColor=e.Color3.Red(),this.overlayAlpha=.5,this.hasVertexAlpha=!1,this.useVertexColors=!0,this.applyFog=!0,this.computeBonesUsingShaders=!0,this.scalingDeterminant=1,this.numBoneInfluencers=4,this.useOctreeForRenderingSelection=!0,this.useOctreeForPicking=!0,this.useOctreeForCollisions=!0,this.layerMask=268435455,this.alwaysSelectAsActiveMesh=!1,this._checkCollisions=!1,this.ellipsoid=new e.Vector3(.5,1,.5),this.ellipsoidOffset=new e.Vector3(0,0,0),this._collider=new e.Collider,this._oldPositionForCollisions=new e.Vector3(0,0,0),this._diffPositionForCollisions=new e.Vector3(0,0,0),this._newPositionForCollisions=new e.Vector3(0,0,0),this.edgesWidth=1,this.edgesColor=new e.Color4(1,0,0,1),this._localWorld=e.Matrix.Zero(),this._worldMatrix=e.Matrix.Zero(),this._rotateYByPI=e.Matrix.RotationY(Math.PI),this._absolutePosition=e.Vector3.Zero(),this._collisionsTransformMatrix=e.Matrix.Zero(),this._collisionsScalingMatrix=e.Matrix.Zero(),this._isDirty=!1,this._pivotMatrix=e.Matrix.Identity(),this._isDisposed=!1,this._renderId=0,this._intersectionsInProgress=new Array,this._isWorldMatrixFrozen=!1,this._unIndexed=!1,this._onCollisionPositionChange=function(t,i,r){void 0===r&&(r=null),o.getScene().workerCollisions&&i.multiplyInPlace(o._collider.radius),i.subtractToRef(o._oldPositionForCollisions,o._diffPositionForCollisions),o._diffPositionForCollisions.length()>e.Engine.CollisionsEpsilon&&o.position.addInPlace(o._diffPositionForCollisions),r&&o.onCollideObservable.notifyObservers(r),o.onCollisionPositionChangeObservable.notifyObservers(o.position)},n.addMesh(this)}return __extends(i,t),Object.defineProperty(i,"BILLBOARDMODE_NONE",{get:function(){return i._BILLBOARDMODE_NONE},enumerable:!0,configurable:!0}),Object.defineProperty(i,"BILLBOARDMODE_X",{get:function(){return i._BILLBOARDMODE_X},enumerable:!0,configurable:!0}),Object.defineProperty(i,"BILLBOARDMODE_Y",{get:function(){return i._BILLBOARDMODE_Y},enumerable:!0,configurable:!0}),Object.defineProperty(i,"BILLBOARDMODE_Z",{get:function(){return i._BILLBOARDMODE_Z},enumerable:!0,configurable:!0}),Object.defineProperty(i,"BILLBOARDMODE_ALL",{get:function(){return i._BILLBOARDMODE_ALL},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"onDispose",{set:function(e){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"onCollide",{set:function(e){this._onCollideObserver&&this.onCollideObservable.remove(this._onCollideObserver),this._onCollideObserver=this.onCollideObservable.add(e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"onCollisionPositionChange",{set:function(e){this._onCollisionPositionChangeObserver&&this.onCollisionPositionChangeObservable.remove(this._onCollisionPositionChangeObserver),this._onCollisionPositionChangeObserver=this.onCollisionPositionChangeObservable.add(e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"skeleton",{get:function(){return this._skeleton},set:function(e){this._skeleton&&this._skeleton.needInitialSkinMatrix&&this._skeleton._unregisterMeshWithPoseMatrix(this),e&&e.needInitialSkinMatrix&&e._registerMeshWithPoseMatrix(this),this._skeleton=e,this._skeleton||(this._bonesTransformMatrices=null)},enumerable:!0,configurable:!0}),i.prototype.toString=function(t){var i="Name: "+this.name+", isInstance: "+(this instanceof e.InstancedMesh?"YES":"NO");return i+=", # of submeshes: "+(this.subMeshes?this.subMeshes.length:0),this._skeleton&&(i+=", skeleton: "+this._skeleton.name),t&&(i+=", billboard mode: "+["NONE","X","Y",null,"Z",null,null,"ALL"][this.billboardMode],i+=", freeze wrld mat: "+(this._isWorldMatrixFrozen||this._waitingFreezeWorldMatrix?"YES":"NO")),i},Object.defineProperty(i.prototype,"rotation",{get:function(){return this._rotation},set:function(e){this._rotation=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"scaling",{get:function(){return this._scaling},set:function(e){this._scaling=e,this.physicsImpostor&&this.physicsImpostor.forceUpdate()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"rotationQuaternion",{get:function(){return this._rotationQuaternion},set:function(e){this._rotationQuaternion=e,e&&this.rotation.length()&&this.rotation.copyFromFloats(0,0,0)},enumerable:!0,configurable:!0}),i.prototype.updatePoseMatrix=function(e){this._poseMatrix.copyFrom(e)},i.prototype.getPoseMatrix=function(){return this._poseMatrix},i.prototype.disableEdgesRendering=function(){void 0!==this._edgesRenderer&&(this._edgesRenderer.dispose(),this._edgesRenderer=void 0)},i.prototype.enableEdgesRendering=function(t,i){void 0===t&&(t=.95),void 0===i&&(i=!1),this.disableEdgesRendering(),this._edgesRenderer=new e.EdgesRenderer(this,t,i)},Object.defineProperty(i.prototype,"isBlocked",{get:function(){return!1},enumerable:!0,configurable:!0}),i.prototype.getLOD=function(e){return this},i.prototype.getTotalVertices=function(){return 0},i.prototype.getIndices=function(){return null},i.prototype.getVerticesData=function(e){return null},i.prototype.isVerticesDataPresent=function(e){return!1},i.prototype.getBoundingInfo=function(){return this._masterMesh?this._masterMesh.getBoundingInfo():(this._boundingInfo||this._updateBoundingInfo(),this._boundingInfo)},Object.defineProperty(i.prototype,"useBones",{get:function(){return this.skeleton&&this.getScene().skeletonsEnabled&&this.isVerticesDataPresent(e.VertexBuffer.MatricesIndicesKind)&&this.isVerticesDataPresent(e.VertexBuffer.MatricesWeightsKind)},enumerable:!0,configurable:!0}),i.prototype._preActivate=function(){},i.prototype._preActivateForIntermediateRendering=function(e){},i.prototype._activate=function(e){this._renderId=e},i.prototype.getWorldMatrix=function(){return this._masterMesh?this._masterMesh.getWorldMatrix():(this._currentRenderId!==this.getScene().getRenderId()&&this.computeWorldMatrix(),this._worldMatrix)},Object.defineProperty(i.prototype,"worldMatrixFromCache",{get:function(){return this._worldMatrix},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"absolutePosition",{get:function(){return this._absolutePosition},enumerable:!0,configurable:!0}),i.prototype.freezeWorldMatrix=function(){this._isWorldMatrixFrozen=!1,this.computeWorldMatrix(!0),this._isWorldMatrixFrozen=!0},i.prototype.unfreezeWorldMatrix=function(){this._isWorldMatrixFrozen=!1,this.computeWorldMatrix(!0)},Object.defineProperty(i.prototype,"isWorldMatrixFrozen",{get:function(){return this._isWorldMatrixFrozen},enumerable:!0,configurable:!0}),i.prototype.rotate=function(t,i,r){t.normalize(),this.rotationQuaternion||(this.rotationQuaternion=e.Quaternion.RotationYawPitchRoll(this.rotation.y,this.rotation.x,this.rotation.z),this.rotation=e.Vector3.Zero());var n;if(r&&r!==e.Space.LOCAL){if(this.parent){var o=this.parent.getWorldMatrix().clone();o.invert(),t=e.Vector3.TransformNormal(t,o)}n=e.Quaternion.RotationAxis(t,i),this.rotationQuaternion=n.multiply(this.rotationQuaternion)}else n=e.Quaternion.RotationAxis(t,i),this.rotationQuaternion=this.rotationQuaternion.multiply(n)},i.prototype.translate=function(t,i,r){var n=t.scale(i);if(r&&r!==e.Space.LOCAL)this.setAbsolutePosition(this.getAbsolutePosition().add(n));else{var o=this.getPositionExpressedInLocalSpace().add(n);this.setPositionWithLocalVector(o)}},i.prototype.getAbsolutePosition=function(){return this.computeWorldMatrix(),this._absolutePosition},i.prototype.setAbsolutePosition=function(t){if(t){var i,r,n;if(void 0===t.x){if(arguments.length<3)return;i=arguments[0],r=arguments[1],n=arguments[2]}else i=t.x,r=t.y,n=t.z;if(this.parent){var o=this.parent.getWorldMatrix().clone();o.invert();var s=new e.Vector3(i,r,n);this.position=e.Vector3.TransformCoordinates(s,o)}else this.position.x=i,this.position.y=r,this.position.z=n}},i.prototype.movePOV=function(e,t,i){this.position.addInPlace(this.calcMovePOV(e,t,i))},i.prototype.calcMovePOV=function(t,i,r){var n=new e.Matrix,o=this.rotationQuaternion?this.rotationQuaternion:e.Quaternion.RotationYawPitchRoll(this.rotation.y,this.rotation.x,this.rotation.z);o.toRotationMatrix(n);var s=e.Vector3.Zero(),a=this.definedFacingForward?-1:1;return e.Vector3.TransformCoordinatesFromFloatsToRef(t*a,i,r*a,n,s),s},i.prototype.rotatePOV=function(e,t,i){this.rotation.addInPlace(this.calcRotatePOV(e,t,i))},i.prototype.calcRotatePOV=function(t,i,r){var n=this.definedFacingForward?1:-1;return new e.Vector3(t*n,i,r*n)},i.prototype.setPivotMatrix=function(e){this._pivotMatrix=e,this._cache.pivotMatrixUpdated=!0},i.prototype.getPivotMatrix=function(){return this._pivotMatrix},i.prototype._isSynchronized=function(){if(this._isDirty)return!1;if(this.billboardMode!==this._cache.billboardMode||this.billboardMode!==i.BILLBOARDMODE_NONE)return!1;if(this._cache.pivotMatrixUpdated)return!1;if(this.infiniteDistance)return!1;if(!this._cache.position.equals(this.position))return!1;if(this.rotationQuaternion){if(!this._cache.rotationQuaternion.equals(this.rotationQuaternion))return!1}else if(!this._cache.rotation.equals(this.rotation))return!1;return!!this._cache.scaling.equals(this.scaling)},i.prototype._initCache=function(){t.prototype._initCache.call(this),this._cache.localMatrixUpdated=!1,this._cache.position=e.Vector3.Zero(),this._cache.scaling=e.Vector3.Zero(),this._cache.rotation=e.Vector3.Zero(),this._cache.rotationQuaternion=new e.Quaternion(0,0,0,0),this._cache.billboardMode=-1},i.prototype.markAsDirty=function(e){"rotation"===e&&(this.rotationQuaternion=null),this._currentRenderId=Number.MAX_VALUE,this._isDirty=!0},i.prototype._updateBoundingInfo=function(){this._boundingInfo=this._boundingInfo||new e.BoundingInfo(this.absolutePosition,this.absolutePosition),this._boundingInfo.update(this.worldMatrixFromCache),this._updateSubMeshesBoundingInfo(this.worldMatrixFromCache)},i.prototype._updateSubMeshesBoundingInfo=function(e){if(this.subMeshes)for(var t=0;t<this.subMeshes.length;t++){var i=this.subMeshes[t];i.IsGlobal||i.updateBoundingInfo(e)}},i.prototype.computeWorldMatrix=function(t){if(this._isWorldMatrixFrozen)return this._worldMatrix;if(!t&&(this._currentRenderId===this.getScene().getRenderId()||this.isSynchronized(!0)))return this._currentRenderId=this.getScene().getRenderId(),this._worldMatrix;if(this._cache.position.copyFrom(this.position),this._cache.scaling.copyFrom(this.scaling),this._cache.pivotMatrixUpdated=!1,this._cache.billboardMode=this.billboardMode,this._currentRenderId=this.getScene().getRenderId(),this._isDirty=!1,e.Matrix.ScalingToRef(this.scaling.x*this.scalingDeterminant,this.scaling.y*this.scalingDeterminant,this.scaling.z*this.scalingDeterminant,e.Tmp.Matrix[1]),this.rotationQuaternion){var r=this.rotation.length();r&&(this.rotationQuaternion.multiplyInPlace(e.Quaternion.RotationYawPitchRoll(this.rotation.y,this.rotation.x,this.rotation.z)),this.rotation.copyFromFloats(0,0,0))}if(this.rotationQuaternion?(this.rotationQuaternion.toRotationMatrix(e.Tmp.Matrix[0]),this._cache.rotationQuaternion.copyFrom(this.rotationQuaternion)):(e.Matrix.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,this.rotation.z,e.Tmp.Matrix[0]),this._cache.rotation.copyFrom(this.rotation)),this.infiniteDistance&&!this.parent){var n=this.getScene().activeCamera;if(n){var o=n.getWorldMatrix(),s=new e.Vector3(o.m[12],o.m[13],o.m[14]);e.Matrix.TranslationToRef(this.position.x+s.x,this.position.y+s.y,this.position.z+s.z,e.Tmp.Matrix[2])}}else e.Matrix.TranslationToRef(this.position.x,this.position.y,this.position.z,e.Tmp.Matrix[2]);if(this._pivotMatrix.multiplyToRef(e.Tmp.Matrix[1],e.Tmp.Matrix[4]),e.Tmp.Matrix[4].multiplyToRef(e.Tmp.Matrix[0],e.Tmp.Matrix[5]),this.billboardMode!==i.BILLBOARDMODE_NONE&&this.getScene().activeCamera){e.Tmp.Vector3[0].copyFrom(this.position);var a=e.Tmp.Vector3[0];if(this.parent&&this.parent.getWorldMatrix){this._markSyncedWithParent();var h;this._meshToBoneReferal?(this.parent.getWorldMatrix().multiplyToRef(this._meshToBoneReferal.getWorldMatrix(),e.Tmp.Matrix[6]),h=e.Tmp.Matrix[6]):h=this.parent.getWorldMatrix(),e.Vector3.TransformNormalToRef(a,h,e.Tmp.Vector3[1]),a=e.Tmp.Vector3[1]}var c=this.getScene().activeCamera.globalPosition.clone();this.parent&&this.parent.position&&(a.addInPlace(this.parent.position),e.Matrix.TranslationToRef(a.x,a.y,a.z,e.Tmp.Matrix[2])),(this.billboardMode&i.BILLBOARDMODE_ALL)!==i.BILLBOARDMODE_ALL&&(this.billboardMode&i.BILLBOARDMODE_X&&(c.x=a.x+e.Epsilon),this.billboardMode&i.BILLBOARDMODE_Y&&(c.y=a.y+e.Epsilon),this.billboardMode&i.BILLBOARDMODE_Z&&(c.z=a.z+e.Epsilon)),e.Matrix.LookAtLHToRef(a,c,e.Vector3.Up(),e.Tmp.Matrix[3]),e.Tmp.Matrix[3].m[12]=e.Tmp.Matrix[3].m[13]=e.Tmp.Matrix[3].m[14]=0,e.Tmp.Matrix[3].invert(),e.Tmp.Matrix[5].multiplyToRef(e.Tmp.Matrix[3],this._localWorld),this._rotateYByPI.multiplyToRef(this._localWorld,e.Tmp.Matrix[5])}return e.Tmp.Matrix[5].multiplyToRef(e.Tmp.Matrix[2],this._localWorld),this.parent&&this.parent.getWorldMatrix&&this.billboardMode===i.BILLBOARDMODE_NONE?(this._markSyncedWithParent(),this._meshToBoneReferal?(this._localWorld.multiplyToRef(this.parent.getWorldMatrix(),e.Tmp.Matrix[6]),e.Tmp.Matrix[6].multiplyToRef(this._meshToBoneReferal.getWorldMatrix(),this._worldMatrix)):this._localWorld.multiplyToRef(this.parent.getWorldMatrix(),this._worldMatrix)):this._worldMatrix.copyFrom(this._localWorld),this._updateBoundingInfo(),this._absolutePosition.copyFromFloats(this._worldMatrix.m[12],this._worldMatrix.m[13],this._worldMatrix.m[14]),this.onAfterWorldMatrixUpdateObservable.notifyObservers(this),this._poseMatrix||(this._poseMatrix=e.Matrix.Invert(this._worldMatrix)),this._worldMatrix},i.prototype.registerAfterWorldMatrixUpdate=function(e){this.onAfterWorldMatrixUpdateObservable.add(e)},i.prototype.unregisterAfterWorldMatrixUpdate=function(e){this.onAfterWorldMatrixUpdateObservable.removeCallback(e)},i.prototype.setPositionWithLocalVector=function(t){this.computeWorldMatrix(),this.position=e.Vector3.TransformNormal(t,this._localWorld)},i.prototype.getPositionExpressedInLocalSpace=function(){this.computeWorldMatrix();var t=this._localWorld.clone();return t.invert(),e.Vector3.TransformNormal(this.position,t)},i.prototype.locallyTranslate=function(t){this.computeWorldMatrix(!0),this.position=e.Vector3.TransformCoordinates(t,this._localWorld)},i.prototype.lookAt=function(t,i,r,n){i=i||0,r=r||0,n=n||0;var o=t.subtract(this.position),s=-Math.atan2(o.z,o.x)-Math.PI/2,a=Math.sqrt(o.x*o.x+o.z*o.z),h=Math.atan2(o.y,a);this.rotationQuaternion=e.Quaternion.RotationYawPitchRoll(s+i,h+r,n)},i.prototype.attachToBone=function(e,t){this._meshToBoneReferal=t,this.parent=e,e.getWorldMatrix().determinant()<0&&(this.scalingDeterminant*=-1)},i.prototype.detachFromBone=function(){this.parent.getWorldMatrix().determinant()<0&&(this.scalingDeterminant*=-1),this._meshToBoneReferal=null,this.parent=null},i.prototype.isInFrustum=function(e){return this._boundingInfo.isInFrustum(e)},i.prototype.isCompletelyInFrustum=function(t){t||(t=this.getScene().activeCamera);var i=t.getViewMatrix().multiply(t.getProjectionMatrix());return!!this._boundingInfo.isCompletelyInFrustum(e.Frustum.GetPlanes(i))},i.prototype.intersectsMesh=function(e,t){return this._boundingInfo&&e._boundingInfo?this._boundingInfo.intersects(e._boundingInfo,t):!1},i.prototype.intersectsPoint=function(e){return this._boundingInfo?this._boundingInfo.intersectsPoint(e):!1},i.prototype.setPhysicsState=function(t,i){return t.impostor&&(i=t,t=t.impostor),this.physicsImpostor=new e.PhysicsImpostor(this,t,i,this.getScene()),this.physicsImpostor.physicsBody},i.prototype.getPhysicsImpostor=function(){return this.physicsImpostor},i.prototype.getPhysicsMass=function(){return this.physicsImpostor.getParam("mass")},i.prototype.getPhysicsFriction=function(){return this.physicsImpostor.getParam("friction")},i.prototype.getPhysicsRestitution=function(){return this.physicsImpostor.getParam("resitution")},i.prototype.getPositionInCameraSpace=function(t){return t||(t=this.getScene().activeCamera),e.Vector3.TransformCoordinates(this.absolutePosition,t.getViewMatrix())},i.prototype.getDistanceToCamera=function(e){return e||(e=this.getScene().activeCamera),this.absolutePosition.subtract(e.position).length()},i.prototype.applyImpulse=function(e,t){this.physicsImpostor&&this.physicsImpostor.applyImpulse(e,t)},i.prototype.setPhysicsLinkWith=function(t,i,r,n){this.physicsImpostor&&t.physicsImpostor&&this.physicsImpostor.createJoint(t.physicsImpostor,e.PhysicsJoint.HingeJoint,{mainPivot:i,connectedPivot:r,nativeParams:n})},i.prototype.updatePhysicsBodyPosition=function(){e.Tools.Warn("updatePhysicsBodyPosition() is deprecated, please use updatePhysicsBody()"),this.updatePhysicsBody()},i.prototype.updatePhysicsBody=function(){},Object.defineProperty(i.prototype,"checkCollisions",{get:function(){return this._checkCollisions},set:function(e){this._checkCollisions=e,this.getScene().workerCollisions&&this.getScene().collisionCoordinator.onMeshUpdated(this)},enumerable:!0,configurable:!0}),i.prototype.moveWithCollisions=function(e){var t=this.getAbsolutePosition();t.subtractFromFloatsToRef(0,this.ellipsoid.y,0,this._oldPositionForCollisions),this._oldPositionForCollisions.addInPlace(this.ellipsoidOffset),this._collider.radius=this.ellipsoid,this.getScene().collisionCoordinator.getNewPosition(this._oldPositionForCollisions,e,this._collider,3,this,this._onCollisionPositionChange,this.uniqueId)},i.prototype.createOrUpdateSubmeshesOctree=function(t,i){void 0===t&&(t=64),void 0===i&&(i=2),this._submeshesOctree||(this._submeshesOctree=new e.Octree(e.Octree.CreationFuncForSubMeshes,t,i)),this.computeWorldMatrix(!0);var r=this.getBoundingInfo().boundingBox;return this._submeshesOctree.update(r.minimumWorld,r.maximumWorld,this.subMeshes),this._submeshesOctree},i.prototype._collideForSubMesh=function(t,i,r){if(this._generatePointsArray(),!t._lastColliderWorldVertices||!t._lastColliderTransformMatrix.equals(i)){t._lastColliderTransformMatrix=i.clone(),t._lastColliderWorldVertices=[],t._trianglePlanes=[];for(var n=t.verticesStart,o=t.verticesStart+t.verticesCount,s=n;o>s;s++)t._lastColliderWorldVertices.push(e.Vector3.TransformCoordinates(this._positions[s],i))}r._collide(t._trianglePlanes,t._lastColliderWorldVertices,this.getIndices(),t.indexStart,t.indexStart+t.indexCount,t.verticesStart,!!t.getMaterial()),r.collisionFound&&(r.collidedMesh=this)},i.prototype._processCollisionsForSubMeshes=function(e,t){var i,r;if(this._submeshesOctree&&this.useOctreeForCollisions){var n=e.velocityWorldLength+Math.max(e.radius.x,e.radius.y,e.radius.z),o=this._submeshesOctree.intersects(e.basePointWorld,n);r=o.length,i=o.data}else i=this.subMeshes,r=i.length;for(var s=0;r>s;s++){var a=i[s];r>1&&!a._checkCollision(e)||this._collideForSubMesh(a,t,e)}},i.prototype._checkCollision=function(t){this._boundingInfo._checkCollision(t)&&(e.Matrix.ScalingToRef(1/t.radius.x,1/t.radius.y,1/t.radius.z,this._collisionsScalingMatrix),this.worldMatrixFromCache.multiplyToRef(this._collisionsScalingMatrix,this._collisionsTransformMatrix),this._processCollisionsForSubMeshes(t,this._collisionsTransformMatrix))},i.prototype._generatePointsArray=function(){return!1},i.prototype.intersects=function(t,i){var r=new e.PickingInfo;if(!(this.subMeshes&&this._boundingInfo&&t.intersectsSphere(this._boundingInfo.boundingSphere)&&t.intersectsBox(this._boundingInfo.boundingBox)))return r;if(!this._generatePointsArray())return r;var n,o,s=null;if(this._submeshesOctree&&this.useOctreeForPicking){var a=e.Ray.Transform(t,this.getWorldMatrix()),h=this._submeshesOctree.intersectsRay(a);o=h.length,n=h.data}else n=this.subMeshes,o=n.length;for(var c=0;o>c;c++){var l=n[c];if(!(o>1)||l.canIntersects(t)){var u=l.intersects(t,this._positions,this.getIndices(),i);if(u&&(i||!s||u.distance<s.distance)&&(s=u,s.subMeshId=c,i))break}}if(s){var f=this.getWorldMatrix(),d=e.Vector3.TransformCoordinates(t.origin,f),p=t.direction.clone();p=p.scale(s.distance);var _=e.Vector3.TransformNormal(p,f),m=d.add(_);return r.hit=!0,r.distance=e.Vector3.Distance(d,m),r.pickedPoint=m,r.pickedMesh=this,r.bu=s.bu,r.bv=s.bv,r.faceId=s.faceId,r.subMeshId=s.subMeshId,r}return r},i.prototype.clone=function(e,t,i){return null},i.prototype.releaseSubMeshes=function(){if(this.subMeshes)for(;this.subMeshes.length;)this.subMeshes[0].dispose();else this.subMeshes=new Array},i.prototype.dispose=function(e){var i,r=this;for(this.actionManager&&(this.actionManager.dispose(),this.actionManager=null),this.skeleton=null,this.getScene().stopAnimation(this),this.physicsImpostor&&this.physicsImpostor.dispose(),i=0;i<this._intersectionsInProgress.length;i++){var n=this._intersectionsInProgress[i],o=n._intersectionsInProgress.indexOf(this);n._intersectionsInProgress.splice(o,1)}this._intersectionsInProgress=[];var s=this.getScene().lights;if(s.forEach(function(e){var t=e.includedOnlyMeshes.indexOf(r);-1!==t&&e.includedOnlyMeshes.splice(t,1),t=e.excludedMeshes.indexOf(r),-1!==t&&e.excludedMeshes.splice(t,1)}),this._edgesRenderer&&(this._edgesRenderer.dispose(),this._edgesRenderer=null),this.releaseSubMeshes(),this.getScene().removeMesh(this),e){var a=this.getChildMeshes(!0);for(i=0;i<a.length;i++){var h=a[i];h.parent=null,h.computeWorldMatrix(!0)}}else{for(i=0;i<this.getScene().particleSystems.length;i++)this.getScene().particleSystems[i].emitter===this&&(this.getScene().particleSystems[i].dispose(),i--);var c=this.getDescendants(!0);for(i=0;i<c.length;i++)c[i].dispose()}t.prototype.dispose.call(this),this.onAfterWorldMatrixUpdateObservable.clear(),this.onCollideObservable.clear(),this.onCollisionPositionChangeObservable.clear(),this._isDisposed=!0,this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear()},i._BILLBOARDMODE_NONE=0,i._BILLBOARDMODE_X=1,i._BILLBOARDMODE_Y=2,i._BILLBOARDMODE_Z=4,i._BILLBOARDMODE_ALL=7,i}(e.Node);e.AbstractMesh=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(i,r){t.call(this,i,r),this.diffuse=new e.Color3(1,1,1),this.specular=new e.Color3(1,1,1),this.intensity=1,this.range=Number.MAX_VALUE,this.includeOnlyWithLayerMask=0,this.includedOnlyMeshes=new Array,this.excludedMeshes=new Array,this.excludeWithLayerMask=0,this.radius=1e-5,this._excludedMeshesIds=new Array,this._includedOnlyMeshesIds=new Array,r.addLight(this)}return __extends(i,t),i.prototype.toString=function(e){var t="Name: "+this.name;if(t+=", type: "+["Point","Directional","Spot","Hemispheric"][this.getTypeID()],this.animations)for(var i=0;i<this.animations.length;i++)t+=", animation[0]: "+this.animations[i].toString(e);return t},i.prototype.getShadowGenerator=function(){return this._shadowGenerator},i.prototype.getAbsolutePosition=function(){return e.Vector3.Zero()},i.prototype.transferToEffect=function(e,t,i){},i.prototype._getWorldMatrix=function(){return e.Matrix.Identity()},i.prototype.canAffectMesh=function(e){return e?this.includedOnlyMeshes.length>0&&-1===this.includedOnlyMeshes.indexOf(e)?!1:this.excludedMeshes.length>0&&-1!==this.excludedMeshes.indexOf(e)?!1:0!==this.includeOnlyWithLayerMask&&0===(this.includeOnlyWithLayerMask&e.layerMask)?!1:!(0!==this.excludeWithLayerMask&&this.excludeWithLayerMask&e.layerMask):!0},i.prototype.getWorldMatrix=function(){this._currentRenderId=this.getScene().getRenderId();var t=this._getWorldMatrix();return this.parent&&this.parent.getWorldMatrix?(this._parentedWorldMatrix||(this._parentedWorldMatrix=e.Matrix.Identity()),t.multiplyToRef(this.parent.getWorldMatrix(),this._parentedWorldMatrix),this._markSyncedWithParent(),this._parentedWorldMatrix):t},i.prototype.dispose=function(){this._shadowGenerator&&(this._shadowGenerator.dispose(),this._shadowGenerator=null),this.getScene().stopAnimation(this),this.getScene().removeLight(this),t.prototype.dispose.call(this)},i.prototype.getTypeID=function(){return 0},i.prototype.clone=function(t){return e.SerializationHelper.Clone(i.GetConstructorFromName(this.getTypeID(),t,this.getScene()),this)},i.prototype.serialize=function(){var t=e.SerializationHelper.Serialize(this);return t.type=this.getTypeID(),this.parent&&(t.parentId=this.parent.id),this.excludedMeshes.length>0&&(t.excludedMeshesIds=[],this.excludedMeshes.forEach(function(e){t.excludedMeshesIds.push(e.id)})),this.includedOnlyMeshes.length>0&&(t.includedOnlyMeshesIds=[],this.includedOnlyMeshes.forEach(function(e){t.includedOnlyMeshesIds.push(e.id)})),e.Animation.AppendSerializedAnimations(this,t),t.ranges=this.serializeAnimationRanges(),t},i.GetConstructorFromName=function(t,i,r){switch(t){case 0:return function(){return new e.PointLight(i,e.Vector3.Zero(),r)};case 1:return function(){return new e.DirectionalLight(i,e.Vector3.Zero(),r)};case 2:return function(){return new e.SpotLight(i,e.Vector3.Zero(),e.Vector3.Zero(),0,0,r)};case 3:return function(){return new e.HemisphericLight(i,e.Vector3.Zero(),r)}}},i.Parse=function(t,r){var n=e.SerializationHelper.Parse(i.GetConstructorFromName(t.type,t.name,r),t,r);if(t.excludedMeshesIds&&(n._excludedMeshesIds=t.excludedMeshesIds),t.includedOnlyMeshesIds&&(n._includedOnlyMeshesIds=t.includedOnlyMeshesIds),t.parentId&&(n._waitingParentId=t.parentId),t.animations){for(var o=0;o<t.animations.length;o++){var s=t.animations[o];n.animations.push(e.Animation.Parse(s))}e.Node.ParseAnimationRanges(n,t,r)}return t.autoAnimate&&r.beginAnimation(n,t.autoAnimateFrom,t.autoAnimateTo,t.autoAnimateLoop,t.autoAnimateSpeed||1),n},__decorate([e.serializeAsColor3()],i.prototype,"diffuse",void 0),__decorate([e.serializeAsColor3()],i.prototype,"specular",void 0),__decorate([e.serialize()],i.prototype,"intensity",void 0),__decorate([e.serialize()],i.prototype,"range",void 0),__decorate([e.serialize()],i.prototype,"includeOnlyWithLayerMask",void 0),__decorate([e.serialize()],i.prototype,"excludeWithLayerMask",void 0),__decorate([e.serialize()],i.prototype,"radius",void 0),i}(e.Node);e.Light=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(e,i,r){t.call(this,e,r),this.position=i}return __extends(i,t),i.prototype.getAbsolutePosition=function(){return this.transformedPosition?this.transformedPosition:this.position},i.prototype.computeTransformedPosition=function(){return this.parent&&this.parent.getWorldMatrix?(this.transformedPosition||(this.transformedPosition=e.Vector3.Zero()),e.Vector3.TransformCoordinatesToRef(this.position,this.parent.getWorldMatrix(),this.transformedPosition),!0):!1},i.prototype.transferToEffect=function(e,t){return this.parent&&this.parent.getWorldMatrix?(this.computeTransformedPosition(),void e.setFloat4(t,this.transformedPosition.x,this.transformedPosition.y,this.transformedPosition.z,0)):void e.setFloat4(t,this.position.x,this.position.y,this.position.z,0)},i.prototype.needCube=function(){return!0},i.prototype.supportsVSM=function(){return!1},i.prototype.needRefreshPerFrame=function(){return!1},i.prototype.getShadowDirection=function(t){switch(t){case 0:return new e.Vector3(1,0,0);case 1:return new e.Vector3(-1,0,0);case 2:return new e.Vector3(0,-1,0);case 3:return new e.Vector3(0,1,0);case 4:return new e.Vector3(0,0,1);case 5:return new e.Vector3(0,0,-1)}return e.Vector3.Zero()},i.prototype.setShadowProjectionMatrix=function(t,i,r){var n=this.getScene().activeCamera;e.Matrix.PerspectiveFovLHToRef(Math.PI/2,1,n.minZ,n.maxZ,t)},i.prototype._getWorldMatrix=function(){return this._worldMatrix||(this._worldMatrix=e.Matrix.Identity()),e.Matrix.TranslationToRef(this.position.x,this.position.y,this.position.z,this._worldMatrix),this._worldMatrix},i.prototype.getTypeID=function(){return 0},__decorate([e.serializeAsVector3()],i.prototype,"position",void 0),i}(e.Light);e.PointLight=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(e,i,r,n,o,s){t.call(this,e,s),this.position=i,this.direction=r,this.angle=n,this.exponent=o}return __extends(i,t),i.prototype.getAbsolutePosition=function(){return this.transformedPosition?this.transformedPosition:this.position},i.prototype.setShadowProjectionMatrix=function(t,i,r){var n=this.getScene().activeCamera;e.Matrix.PerspectiveFovLHToRef(this.angle,1,n.minZ,n.maxZ,t)},i.prototype.needCube=function(){return!1},i.prototype.supportsVSM=function(){return!0},i.prototype.needRefreshPerFrame=function(){return!1},i.prototype.getShadowDirection=function(e){return this.direction},i.prototype.setDirectionToTarget=function(t){return this.direction=e.Vector3.Normalize(t.subtract(this.position)),this.direction},i.prototype.computeTransformedPosition=function(){return this.parent&&this.parent.getWorldMatrix?(this.transformedPosition||(this.transformedPosition=e.Vector3.Zero()),e.Vector3.TransformCoordinatesToRef(this.position,this.parent.getWorldMatrix(),this.transformedPosition),!0):!1},i.prototype.transferToEffect=function(t,i,r){var n;this.parent&&this.parent.getWorldMatrix?(this._transformedDirection||(this._transformedDirection=e.Vector3.Zero()),this.computeTransformedPosition(),e.Vector3.TransformNormalToRef(this.direction,this.parent.getWorldMatrix(),this._transformedDirection),t.setFloat4(i,this.transformedPosition.x,this.transformedPosition.y,this.transformedPosition.z,this.exponent),n=e.Vector3.Normalize(this._transformedDirection)):(t.setFloat4(i,this.position.x,this.position.y,this.position.z,this.exponent),n=e.Vector3.Normalize(this.direction)),t.setFloat4(r,n.x,n.y,n.z,Math.cos(.5*this.angle))},i.prototype._getWorldMatrix=function(){return this._worldMatrix||(this._worldMatrix=e.Matrix.Identity()),e.Matrix.TranslationToRef(this.position.x,this.position.y,this.position.z,this._worldMatrix),this._worldMatrix},i.prototype.getTypeID=function(){return 2},__decorate([e.serializeAsVector3()],i.prototype,"position",void 0),__decorate([e.serializeAsVector3()],i.prototype,"direction",void 0),__decorate([e.serialize()],i.prototype,"angle",void 0),__decorate([e.serialize()],i.prototype,"exponent",void 0),i}(e.Light);e.SpotLight=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(i,r,n){t.call(this,i,n),this.groundColor=new e.Color3(0,0,0),this.direction=r}return __extends(i,t),i.prototype.setDirectionToTarget=function(t){return this.direction=e.Vector3.Normalize(t.subtract(e.Vector3.Zero())),this.direction;
},i.prototype.getShadowGenerator=function(){return null},i.prototype.transferToEffect=function(t,i,r){var n=e.Vector3.Normalize(this.direction);t.setFloat4(i,n.x,n.y,n.z,0),t.setColor3(r,this.groundColor.scale(this.intensity))},i.prototype._getWorldMatrix=function(){return this._worldMatrix||(this._worldMatrix=e.Matrix.Identity()),this._worldMatrix},i.prototype.getTypeID=function(){return 3},__decorate([e.serializeAsColor3()],i.prototype,"groundColor",void 0),__decorate([e.serializeAsVector3()],i.prototype,"direction",void 0),i}(e.Light);e.HemisphericLight=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(e,i,r){t.call(this,e,r),this.shadowOrthoScale=.5,this.autoUpdateExtends=!0,this._orthoLeft=Number.MAX_VALUE,this._orthoRight=Number.MIN_VALUE,this._orthoTop=Number.MIN_VALUE,this._orthoBottom=Number.MAX_VALUE,this.position=i.scale(-1),this.direction=i}return __extends(i,t),i.prototype.getAbsolutePosition=function(){return this.transformedPosition?this.transformedPosition:this.position},i.prototype.setDirectionToTarget=function(t){return this.direction=e.Vector3.Normalize(t.subtract(this.position)),this.direction},i.prototype.setShadowProjectionMatrix=function(t,i,r){var n=this.getScene().activeCamera;if(this.autoUpdateExtends||this._orthoLeft===Number.MAX_VALUE){var o=e.Vector3.Zero();this._orthoLeft=Number.MAX_VALUE,this._orthoRight=Number.MIN_VALUE,this._orthoTop=Number.MIN_VALUE,this._orthoBottom=Number.MAX_VALUE;for(var s=0;s<r.length;s++){var a=r[s];if(a){var h=a.getBoundingInfo();if(h)for(var c=h.boundingBox,l=0;l<c.vectorsWorld.length;l++)e.Vector3.TransformCoordinatesToRef(c.vectorsWorld[l],i,o),o.x<this._orthoLeft&&(this._orthoLeft=o.x),o.y<this._orthoBottom&&(this._orthoBottom=o.y),o.x>this._orthoRight&&(this._orthoRight=o.x),o.y>this._orthoTop&&(this._orthoTop=o.y)}}}var u=this._orthoRight-this._orthoLeft,f=this._orthoTop-this._orthoBottom;e.Matrix.OrthoOffCenterLHToRef(this._orthoLeft-u*this.shadowOrthoScale,this._orthoRight+u*this.shadowOrthoScale,this._orthoBottom-f*this.shadowOrthoScale,this._orthoTop+f*this.shadowOrthoScale,-n.maxZ,n.maxZ,t)},i.prototype.supportsVSM=function(){return!0},i.prototype.needRefreshPerFrame=function(){return!0},i.prototype.needCube=function(){return!1},i.prototype.getShadowDirection=function(e){return this.direction},i.prototype.computeTransformedPosition=function(){return this.parent&&this.parent.getWorldMatrix?(this.transformedPosition||(this.transformedPosition=e.Vector3.Zero()),e.Vector3.TransformCoordinatesToRef(this.position,this.parent.getWorldMatrix(),this.transformedPosition),!0):!1},i.prototype.transferToEffect=function(t,i){return this.parent&&this.parent.getWorldMatrix?(this._transformedDirection||(this._transformedDirection=e.Vector3.Zero()),e.Vector3.TransformNormalToRef(this.direction,this.parent.getWorldMatrix(),this._transformedDirection),void t.setFloat4(i,this._transformedDirection.x,this._transformedDirection.y,this._transformedDirection.z,1)):void t.setFloat4(i,this.direction.x,this.direction.y,this.direction.z,1)},i.prototype._getWorldMatrix=function(){return this._worldMatrix||(this._worldMatrix=e.Matrix.Identity()),e.Matrix.TranslationToRef(this.position.x,this.position.y,this.position.z,this._worldMatrix),this._worldMatrix},i.prototype.getTypeID=function(){return 1},__decorate([e.serializeAsVector3()],i.prototype,"position",void 0),__decorate([e.serializeAsVector3()],i.prototype,"direction",void 0),__decorate([e.serialize()],i.prototype,"shadowOrthoScale",void 0),__decorate([e.serialize()],i.prototype,"autoUpdateExtends",void 0),i}(e.Light);e.DirectionalLight=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(i,r){var n=this;this._filter=t.FILTER_NONE,this.blurScale=2,this._blurBoxOffset=0,this._bias=5e-5,this._lightDirection=e.Vector3.Zero(),this.forceBackFacesOnly=!1,this._darkness=0,this._transparencyShadow=!1,this._viewMatrix=e.Matrix.Zero(),this._projectionMatrix=e.Matrix.Zero(),this._transformMatrix=e.Matrix.Zero(),this._worldViewProjection=e.Matrix.Zero(),this._currentFaceIndex=0,this._currentFaceIndexCache=0,this._light=r,this._scene=r.getScene(),this._mapSize=i,r._shadowGenerator=this,this._shadowMap=new e.RenderTargetTexture(r.name+"_shadowMap",i,this._scene,!1,!0,e.Engine.TEXTURETYPE_UNSIGNED_INT,r.needCube()),this._shadowMap.wrapU=e.Texture.CLAMP_ADDRESSMODE,this._shadowMap.wrapV=e.Texture.CLAMP_ADDRESSMODE,this._shadowMap.anisotropicFilteringLevel=1,this._shadowMap.updateSamplingMode(e.Texture.NEAREST_SAMPLINGMODE),this._shadowMap.renderParticles=!1,this._shadowMap.onBeforeRenderObservable.add(function(e){n._currentFaceIndex=e}),this._shadowMap.onAfterUnbindObservable.add(function(){n.useBlurVarianceShadowMap&&(n._shadowMap2||(n._shadowMap2=new e.RenderTargetTexture(r.name+"_shadowMap",i,n._scene,!1),n._shadowMap2.wrapU=e.Texture.CLAMP_ADDRESSMODE,n._shadowMap2.wrapV=e.Texture.CLAMP_ADDRESSMODE,n._shadowMap2.updateSamplingMode(e.Texture.TRILINEAR_SAMPLINGMODE),n._downSamplePostprocess=new e.PassPostProcess("downScale",1/n.blurScale,null,e.Texture.BILINEAR_SAMPLINGMODE,n._scene.getEngine()),n._downSamplePostprocess.onApplyObservable.add(function(e){e.setTexture("textureSampler",n._shadowMap)}),n.blurBoxOffset=1),n._scene.postProcessManager.directRender([n._downSamplePostprocess,n._boxBlurPostprocess],n._shadowMap2.getInternalTexture()))});var o=function(t){var i=t.getRenderingMesh(),r=n._scene,o=r.getEngine();o.setState(t.getMaterial().backFaceCulling);var s=i._getInstancesRenderList(t._id);if(!s.mustReturn){var a=null!==o.getCaps().instancedArrays&&null!==s.visibleInstances[t._id]&&void 0!==s.visibleInstances[t._id];if(n.isReady(t,a)){o.enableEffect(n._effect),i._bind(t,n._effect,e.Material.TriangleFillMode);var h=t.getMaterial();if(n._effect.setMatrix("viewProjection",n.getTransformMatrix()),n._effect.setVector3("lightPosition",n.getLight().position),n.getLight().needCube()&&n._effect.setFloat2("depthValues",r.activeCamera.minZ,r.activeCamera.maxZ),h&&h.needAlphaTesting()){var c=h.getAlphaTestTexture();n._effect.setTexture("diffuseSampler",c),n._effect.setMatrix("diffuseMatrix",c.getTextureMatrix())}i.useBones&&i.computeBonesUsingShaders&&n._effect.setMatrices("mBones",i.skeleton.getTransformMatrices(i)),n.forceBackFacesOnly&&o.setState(!0,0,!1,!0),i._processRendering(t,n._effect,e.Material.TriangleFillMode,s,a,function(e,t){return n._effect.setMatrix("world",t)}),n.forceBackFacesOnly&&o.setState(!0,0,!1,!1)}else n._shadowMap.resetRefreshCounter()}};this._shadowMap.customRenderFunction=function(e,t,i){var r;for(r=0;r<e.length;r++)o(e.data[r]);for(r=0;r<t.length;r++)o(t.data[r]);if(n._transparencyShadow)for(r=0;r<i.length;r++)o(i.data[r])},this._shadowMap.onClearObservable.add(function(t){n.useBlurVarianceShadowMap||n.useVarianceShadowMap?t.clear(new e.Color4(0,0,0,0),!0,!0):t.clear(new e.Color4(1,1,1,1),!0,!0)})}return Object.defineProperty(t,"FILTER_NONE",{get:function(){return t._FILTER_NONE},enumerable:!0,configurable:!0}),Object.defineProperty(t,"FILTER_VARIANCESHADOWMAP",{get:function(){return t._FILTER_VARIANCESHADOWMAP},enumerable:!0,configurable:!0}),Object.defineProperty(t,"FILTER_POISSONSAMPLING",{get:function(){return t._FILTER_POISSONSAMPLING},enumerable:!0,configurable:!0}),Object.defineProperty(t,"FILTER_BLURVARIANCESHADOWMAP",{get:function(){return t._FILTER_BLURVARIANCESHADOWMAP},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bias",{get:function(){return this._bias},set:function(e){this._bias=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"blurBoxOffset",{get:function(){return this._blurBoxOffset},set:function(t){var i=this;this._blurBoxOffset!==t&&(this._blurBoxOffset=t,this._boxBlurPostprocess&&this._boxBlurPostprocess.dispose(),this._boxBlurPostprocess=new e.PostProcess("DepthBoxBlur","depthBoxBlur",["screenSize","boxOffset"],[],1/this.blurScale,null,e.Texture.BILINEAR_SAMPLINGMODE,this._scene.getEngine(),!1,"#define OFFSET "+t),this._boxBlurPostprocess.onApplyObservable.add(function(e){e.setFloat2("screenSize",i._mapSize/i.blurScale,i._mapSize/i.blurScale)}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filter",{get:function(){return this._filter},set:function(t){this._filter!==t&&(this._filter=t,this.useVarianceShadowMap||this.useBlurVarianceShadowMap||this.usePoissonSampling?(this._shadowMap.anisotropicFilteringLevel=16,this._shadowMap.updateSamplingMode(e.Texture.BILINEAR_SAMPLINGMODE)):(this._shadowMap.anisotropicFilteringLevel=1,this._shadowMap.updateSamplingMode(e.Texture.NEAREST_SAMPLINGMODE)))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useVarianceShadowMap",{get:function(){return this.filter===t.FILTER_VARIANCESHADOWMAP&&this._light.supportsVSM()},set:function(e){this.filter=e?t.FILTER_VARIANCESHADOWMAP:t.FILTER_NONE},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"usePoissonSampling",{get:function(){return this.filter===t.FILTER_POISSONSAMPLING||!this._light.supportsVSM()&&(this.filter===t.FILTER_VARIANCESHADOWMAP||this.filter===t.FILTER_BLURVARIANCESHADOWMAP)},set:function(e){this.filter=e?t.FILTER_POISSONSAMPLING:t.FILTER_NONE},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useBlurVarianceShadowMap",{get:function(){return this.filter===t.FILTER_BLURVARIANCESHADOWMAP&&this._light.supportsVSM()},set:function(e){this.filter=e?t.FILTER_BLURVARIANCESHADOWMAP:t.FILTER_NONE},enumerable:!0,configurable:!0}),t.prototype.isReady=function(t,i){var r=[];(this.useVarianceShadowMap||this.useBlurVarianceShadowMap)&&r.push("#define VSM"),this.getLight().needCube()&&r.push("#define CUBEMAP");var n=[e.VertexBuffer.PositionKind],o=t.getMesh(),s=t.getMaterial();s&&s.needAlphaTesting()&&(r.push("#define ALPHATEST"),o.isVerticesDataPresent(e.VertexBuffer.UVKind)&&(n.push(e.VertexBuffer.UVKind),r.push("#define UV1")),o.isVerticesDataPresent(e.VertexBuffer.UV2Kind)&&(n.push(e.VertexBuffer.UV2Kind),r.push("#define UV2"))),o.useBones&&o.computeBonesUsingShaders?(n.push(e.VertexBuffer.MatricesIndicesKind),n.push(e.VertexBuffer.MatricesWeightsKind),o.numBoneInfluencers>4&&(n.push(e.VertexBuffer.MatricesIndicesExtraKind),n.push(e.VertexBuffer.MatricesWeightsExtraKind)),r.push("#define NUM_BONE_INFLUENCERS "+o.numBoneInfluencers),r.push("#define BonesPerMesh "+(o.skeleton.bones.length+1))):r.push("#define NUM_BONE_INFLUENCERS 0"),i&&(r.push("#define INSTANCES"),n.push("world0"),n.push("world1"),n.push("world2"),n.push("world3"));var a=r.join("\n");return this._cachedDefines!==a&&(this._cachedDefines=a,this._effect=this._scene.getEngine().createEffect("shadowMap",n,["world","mBones","viewProjection","diffuseMatrix","lightPosition","depthValues"],["diffuseSampler"],a)),this._effect.isReady()},t.prototype.getShadowMap=function(){return this._shadowMap},t.prototype.getShadowMapForRendering=function(){return this._shadowMap2?this._shadowMap2:this._shadowMap},t.prototype.getLight=function(){return this._light},t.prototype.getTransformMatrix=function(){var t=this._scene;if(this._currentRenderID===t.getRenderId()&&this._currentFaceIndexCache===this._currentFaceIndex)return this._transformMatrix;this._currentRenderID=t.getRenderId(),this._currentFaceIndexCache=this._currentFaceIndex;var i=this._light.position;return e.Vector3.NormalizeToRef(this._light.getShadowDirection(this._currentFaceIndex),this._lightDirection),1===Math.abs(e.Vector3.Dot(this._lightDirection,e.Vector3.Up()))&&(this._lightDirection.z=1e-13),this._light.computeTransformedPosition()&&(i=this._light.transformedPosition),!this._light.needRefreshPerFrame()&&this._cachedPosition&&this._cachedDirection&&i.equals(this._cachedPosition)&&this._lightDirection.equals(this._cachedDirection)||(this._cachedPosition=i.clone(),this._cachedDirection=this._lightDirection.clone(),e.Matrix.LookAtLHToRef(i,i.add(this._lightDirection),e.Vector3.Up(),this._viewMatrix),this._light.setShadowProjectionMatrix(this._projectionMatrix,this._viewMatrix,this.getShadowMap().renderList),this._viewMatrix.multiplyToRef(this._projectionMatrix,this._transformMatrix)),this._transformMatrix},t.prototype.getDarkness=function(){return this._darkness},t.prototype.setDarkness=function(e){e>=1?this._darkness=1:0>=e?this._darkness=0:this._darkness=e},t.prototype.setTransparencyShadow=function(e){this._transparencyShadow=e},t.prototype._packHalf=function(t){var i=255*t,r=i-Math.floor(i);return new e.Vector2(t-r/255,r)},t.prototype.dispose=function(){this._shadowMap.dispose(),this._shadowMap2&&this._shadowMap2.dispose(),this._downSamplePostprocess&&this._downSamplePostprocess.dispose(),this._boxBlurPostprocess&&this._boxBlurPostprocess.dispose()},t.prototype.serialize=function(){var e={};e.lightId=this._light.id,e.mapSize=this.getShadowMap().getRenderSize(),e.useVarianceShadowMap=this.useVarianceShadowMap,e.usePoissonSampling=this.usePoissonSampling,e.forceBackFacesOnly=this.forceBackFacesOnly,e.renderList=[];for(var t=0;t<this.getShadowMap().renderList.length;t++){var i=this.getShadowMap().renderList[t];e.renderList.push(i.id)}return e},t.Parse=function(e,i){for(var r=i.getLightByID(e.lightId),n=new t(e.mapSize,r),o=0;o<e.renderList.length;o++){var s=i.getMeshesByID(e.renderList[o]);s.forEach(function(e){n.getShadowMap().renderList.push(e)})}return e.usePoissonSampling?n.usePoissonSampling=!0:e.useVarianceShadowMap?n.useVarianceShadowMap=!0:e.useBlurVarianceShadowMap&&(n.useBlurVarianceShadowMap=!0,e.blurScale&&(n.blurScale=e.blurScale),e.blurBoxOffset&&(n.blurBoxOffset=e.blurBoxOffset)),void 0!==e.bias&&(n.bias=e.bias),n.forceBackFacesOnly=e.forceBackFacesOnly,n},t._FILTER_NONE=0,t._FILTER_VARIANCESHADOWMAP=1,t._FILTER_POISSONSAMPLING=2,t._FILTER_BLURVARIANCESHADOWMAP=3,t}();e.ShadowGenerator=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(e,t,i,r){return e.x>i.x+r?!1:i.x-r>t.x?!1:e.y>i.y+r?!1:i.y-r>t.y?!1:e.z>i.z+r?!1:!(i.z-r>t.z)},i=function(e,t,i,r){var n=t*t-4*e*i,o={root:0,found:!1};if(0>n)return o;var s=Math.sqrt(n),a=(-t-s)/(2*e),h=(-t+s)/(2*e);if(a>h){var c=h;h=a,a=c}return a>0&&r>a?(o.root=a,o.found=!0,o):h>0&&r>h?(o.root=h,o.found=!0,o):o},r=function(){function r(){this.radius=new e.Vector3(1,1,1),this.retry=0,this.basePointWorld=e.Vector3.Zero(),this.velocityWorld=e.Vector3.Zero(),this.normalizedVelocity=e.Vector3.Zero(),this._collisionPoint=e.Vector3.Zero(),this._planeIntersectionPoint=e.Vector3.Zero(),this._tempVector=e.Vector3.Zero(),this._tempVector2=e.Vector3.Zero(),this._tempVector3=e.Vector3.Zero(),this._tempVector4=e.Vector3.Zero(),this._edge=e.Vector3.Zero(),this._baseToVertex=e.Vector3.Zero(),this._destinationPoint=e.Vector3.Zero(),this._slidePlaneNormal=e.Vector3.Zero(),this._displacementVector=e.Vector3.Zero()}return r.prototype._initialize=function(t,i,r){this.velocity=i,e.Vector3.NormalizeToRef(i,this.normalizedVelocity),this.basePoint=t,t.multiplyToRef(this.radius,this.basePointWorld),i.multiplyToRef(this.radius,this.velocityWorld),this.velocityWorldLength=this.velocityWorld.length(),this.epsilon=r,this.collisionFound=!1},r.prototype._checkPointInTriangle=function(t,i,r,n,o){i.subtractToRef(t,this._tempVector),r.subtractToRef(t,this._tempVector2),e.Vector3.CrossToRef(this._tempVector,this._tempVector2,this._tempVector4);var s=e.Vector3.Dot(this._tempVector4,o);return 0>s?!1:(n.subtractToRef(t,this._tempVector3),e.Vector3.CrossToRef(this._tempVector2,this._tempVector3,this._tempVector4),s=e.Vector3.Dot(this._tempVector4,o),0>s?!1:(e.Vector3.CrossToRef(this._tempVector3,this._tempVector,this._tempVector4),s=e.Vector3.Dot(this._tempVector4,o),s>=0))},r.prototype._canDoCollision=function(i,r,n,o){var s=e.Vector3.Distance(this.basePointWorld,i),a=Math.max(this.radius.x,this.radius.y,this.radius.z);return s>this.velocityWorldLength+a+r?!1:!!t(n,o,this.basePointWorld,this.velocityWorldLength+a)},r.prototype._testTriangle=function(t,r,n,o,s,a){var h,c=!1;r||(r=[]),r[t]||(r[t]=new e.Plane(0,0,0,0),r[t].copyFromPoints(n,o,s));var l=r[t];if(a||l.isFrontFacingTo(this.normalizedVelocity,0)){var u=l.signedDistanceTo(this.basePoint),f=e.Vector3.Dot(l.normal,this.velocity);if(0==f){if(Math.abs(u)>=1)return;c=!0,h=0}else{h=(-1-u)/f;var d=(1-u)/f;if(h>d){var p=d;d=h,h=p}if(h>1||0>d)return;0>h&&(h=0),h>1&&(h=1)}this._collisionPoint.copyFromFloats(0,0,0);var _=!1,m=1;if(c||(this.basePoint.subtractToRef(l.normal,this._planeIntersectionPoint),this.velocity.scaleToRef(h,this._tempVector),this._planeIntersectionPoint.addInPlace(this._tempVector),this._checkPointInTriangle(this._planeIntersectionPoint,n,o,s,l.normal)&&(_=!0,m=h,this._collisionPoint.copyFrom(this._planeIntersectionPoint))),!_){var g=this.velocity.lengthSquared(),v=g;this.basePoint.subtractToRef(n,this._tempVector);var y=2*e.Vector3.Dot(this.velocity,this._tempVector),x=this._tempVector.lengthSquared()-1,b=i(v,y,x,m);b.found&&(m=b.root,_=!0,this._collisionPoint.copyFrom(n)),this.basePoint.subtractToRef(o,this._tempVector),y=2*e.Vector3.Dot(this.velocity,this._tempVector),x=this._tempVector.lengthSquared()-1,b=i(v,y,x,m),b.found&&(m=b.root,_=!0,this._collisionPoint.copyFrom(o)),this.basePoint.subtractToRef(s,this._tempVector),y=2*e.Vector3.Dot(this.velocity,this._tempVector),x=this._tempVector.lengthSquared()-1,b=i(v,y,x,m),b.found&&(m=b.root,_=!0,this._collisionPoint.copyFrom(s)),o.subtractToRef(n,this._edge),n.subtractToRef(this.basePoint,this._baseToVertex);var P=this._edge.lengthSquared(),A=e.Vector3.Dot(this._edge,this.velocity),T=e.Vector3.Dot(this._edge,this._baseToVertex);if(v=P*-g+A*A,y=P*(2*e.Vector3.Dot(this.velocity,this._baseToVertex))-2*A*T,x=P*(1-this._baseToVertex.lengthSquared())+T*T,b=i(v,y,x,m),b.found){var E=(A*b.root-T)/P;E>=0&&1>=E&&(m=b.root,_=!0,this._edge.scaleInPlace(E),n.addToRef(this._edge,this._collisionPoint))}s.subtractToRef(o,this._edge),o.subtractToRef(this.basePoint,this._baseToVertex),P=this._edge.lengthSquared(),A=e.Vector3.Dot(this._edge,this.velocity),T=e.Vector3.Dot(this._edge,this._baseToVertex),v=P*-g+A*A,y=P*(2*e.Vector3.Dot(this.velocity,this._baseToVertex))-2*A*T,x=P*(1-this._baseToVertex.lengthSquared())+T*T,b=i(v,y,x,m),b.found&&(E=(A*b.root-T)/P,E>=0&&1>=E&&(m=b.root,_=!0,this._edge.scaleInPlace(E),o.addToRef(this._edge,this._collisionPoint))),n.subtractToRef(s,this._edge),s.subtractToRef(this.basePoint,this._baseToVertex),P=this._edge.lengthSquared(),A=e.Vector3.Dot(this._edge,this.velocity),T=e.Vector3.Dot(this._edge,this._baseToVertex),v=P*-g+A*A,y=P*(2*e.Vector3.Dot(this.velocity,this._baseToVertex))-2*A*T,x=P*(1-this._baseToVertex.lengthSquared())+T*T,b=i(v,y,x,m),b.found&&(E=(A*b.root-T)/P,E>=0&&1>=E&&(m=b.root,_=!0,this._edge.scaleInPlace(E),s.addToRef(this._edge,this._collisionPoint)))}if(_){var C=m*this.velocity.length();(!this.collisionFound||C<this.nearestDistance)&&(this.intersectionPoint?this.intersectionPoint.copyFrom(this._collisionPoint):this.intersectionPoint=this._collisionPoint.clone(),this.nearestDistance=C,this.collisionFound=!0)}}},r.prototype._collide=function(e,t,i,r,n,o,s){for(var a=r;n>a;a+=3){var h=t[i[a]-o],c=t[i[a+1]-o],l=t[i[a+2]-o];this._testTriangle(a,e,l,c,h,s)}},r.prototype._getResponse=function(t,i){t.addToRef(i,this._destinationPoint),i.scaleInPlace(this.nearestDistance/i.length()),this.basePoint.addToRef(i,t),t.subtractToRef(this.intersectionPoint,this._slidePlaneNormal),this._slidePlaneNormal.normalize(),this._slidePlaneNormal.scaleToRef(this.epsilon,this._displacementVector),t.addInPlace(this._displacementVector),this.intersectionPoint.addInPlace(this._displacementVector),this._slidePlaneNormal.scaleInPlace(e.Plane.SignedDistanceToPlaneFromPositionAndNormal(this.intersectionPoint,this._slidePlaneNormal,this._destinationPoint)),this._destinationPoint.subtractInPlace(this._slidePlaneNormal),this._destinationPoint.subtractToRef(this.intersectionPoint,i)},r}();e.Collider=r}(BABYLON||(BABYLON={}));var BABYLON;!function(e){e.CollisionWorker="",function(e){e[e.INIT=0]="INIT",e[e.UPDATE=1]="UPDATE",e[e.COLLIDE=2]="COLLIDE"}(e.WorkerTaskType||(e.WorkerTaskType={}));var t=e.WorkerTaskType;!function(e){e[e.SUCCESS=0]="SUCCESS",e[e.UNKNOWN_ERROR=1]="UNKNOWN_ERROR"}(e.WorkerReplyType||(e.WorkerReplyType={}));var i=e.WorkerReplyType,r=function(){function r(){var n=this;this._scaledPosition=e.Vector3.Zero(),this._scaledVelocity=e.Vector3.Zero(),this.onMeshUpdated=function(e){n._addUpdateMeshesList[e.uniqueId]=r.SerializeMesh(e)},this.onGeometryUpdated=function(e){n._addUpdateGeometriesList[e.id]=r.SerializeGeometry(e)},this._afterRender=function(){if(n._init&&!(0==n._toRemoveGeometryArray.length&&0==n._toRemoveMeshesArray.length&&0==Object.keys(n._addUpdateGeometriesList).length&&0==Object.keys(n._addUpdateMeshesList).length||n._runningUpdated>4)){++n._runningUpdated;var e={updatedMeshes:n._addUpdateMeshesList,updatedGeometries:n._addUpdateGeometriesList,removedGeometries:n._toRemoveGeometryArray,removedMeshes:n._toRemoveMeshesArray},i={payload:e,taskType:t.UPDATE},r=[];for(var o in e.updatedGeometries)e.updatedGeometries.hasOwnProperty(o)&&(r.push(i.payload.updatedGeometries[o].indices.buffer),r.push(i.payload.updatedGeometries[o].normals.buffer),r.push(i.payload.updatedGeometries[o].positions.buffer));n._worker.postMessage(i,r),n._addUpdateMeshesList={},n._addUpdateGeometriesList={},n._toRemoveGeometryArray=[],n._toRemoveMeshesArray=[]}},this._onMessageFromWorker=function(r){var o=r.data;if(o.error!=i.SUCCESS)return void e.Tools.Warn("error returned from worker!");switch(o.taskType){case t.INIT:n._init=!0,n._scene.meshes.forEach(function(e){n.onMeshAdded(e)}),n._scene.getGeometries().forEach(function(e){n.onGeometryAdded(e)});break;case t.UPDATE:n._runningUpdated--;break;case t.COLLIDE:n._runningCollisionTask=!1;var s=o.payload;if(!n._collisionsCallbackArray[s.collisionId])return;n._collisionsCallbackArray[s.collisionId](s.collisionId,e.Vector3.FromArray(s.newPosition),n._scene.getMeshByUniqueID(s.collidedMeshUniqueId)),n._collisionsCallbackArray[s.collisionId]=void 0}},this._collisionsCallbackArray=[],this._init=!1,this._runningUpdated=0,this._runningCollisionTask=!1,this._addUpdateMeshesList={},this._addUpdateGeometriesList={},this._toRemoveGeometryArray=[],this._toRemoveMeshesArray=[]}return r.prototype.getNewPosition=function(e,i,r,n,o,s,a){if(this._init&&!this._collisionsCallbackArray[a]&&!this._collisionsCallbackArray[a+1e5]){e.divideToRef(r.radius,this._scaledPosition),i.divideToRef(r.radius,this._scaledVelocity),this._collisionsCallbackArray[a]=s;var h={collider:{position:this._scaledPosition.asArray(),velocity:this._scaledVelocity.asArray(),radius:r.radius.asArray()},collisionId:a,excludedMeshUniqueId:o?o.uniqueId:null,maximumRetry:n},c={payload:h,taskType:t.COLLIDE};this._worker.postMessage(c)}},r.prototype.init=function(i){this._scene=i,this._scene.registerAfterRender(this._afterRender);var r=e.WorkerIncluded?e.Engine.CodeRepository+"Collisions/babylon.collisionWorker.js":URL.createObjectURL(new Blob([e.CollisionWorker],{type:"application/javascript"}));this._worker=new Worker(r),this._worker.onmessage=this._onMessageFromWorker;var n={payload:{},taskType:t.INIT};this._worker.postMessage(n)},r.prototype.destroy=function(){this._scene.unregisterAfterRender(this._afterRender),this._worker.terminate()},r.prototype.onMeshAdded=function(e){e.registerAfterWorldMatrixUpdate(this.onMeshUpdated),this.onMeshUpdated(e)},r.prototype.onMeshRemoved=function(e){this._toRemoveMeshesArray.push(e.uniqueId)},r.prototype.onGeometryAdded=function(e){e.onGeometryUpdated=this.onGeometryUpdated,this.onGeometryUpdated(e)},r.prototype.onGeometryDeleted=function(e){this._toRemoveGeometryArray.push(e.id)},r.SerializeMesh=function(t){var i=[];t.subMeshes&&(i=t.subMeshes.map(function(e,t){return{position:t,verticesStart:e.verticesStart,verticesCount:e.verticesCount,indexStart:e.indexStart,indexCount:e.indexCount,hasMaterial:!!e.getMaterial(),sphereCenter:e.getBoundingInfo().boundingSphere.centerWorld.asArray(),sphereRadius:e.getBoundingInfo().boundingSphere.radiusWorld,boxMinimum:e.getBoundingInfo().boundingBox.minimumWorld.asArray(),boxMaximum:e.getBoundingInfo().boundingBox.maximumWorld.asArray()}}));var r=null;return t instanceof e.Mesh?r=t.geometry?t.geometry.id:null:t instanceof e.InstancedMesh&&(r=t.sourceMesh&&t.sourceMesh.geometry?t.sourceMesh.geometry.id:null),{uniqueId:t.uniqueId,id:t.id,name:t.name,geometryId:r,sphereCenter:t.getBoundingInfo().boundingSphere.centerWorld.asArray(),sphereRadius:t.getBoundingInfo().boundingSphere.radiusWorld,boxMinimum:t.getBoundingInfo().boundingBox.minimumWorld.asArray(),boxMaximum:t.getBoundingInfo().boundingBox.maximumWorld.asArray(),worldMatrixFromCache:t.worldMatrixFromCache.asArray(),subMeshes:i,checkCollisions:t.checkCollisions}},r.SerializeGeometry=function(t){return{id:t.id,positions:new Float32Array(t.getVerticesData(e.VertexBuffer.PositionKind)||[]),normals:new Float32Array(t.getVerticesData(e.VertexBuffer.NormalKind)||[]),indices:new Int32Array(t.getIndices()||[])}},r}();e.CollisionCoordinatorWorker=r;var n=function(){function t(){this._scaledPosition=e.Vector3.Zero(),this._scaledVelocity=e.Vector3.Zero(),this._finalPosition=e.Vector3.Zero()}return t.prototype.getNewPosition=function(e,t,i,r,n,o,s){e.divideToRef(i.radius,this._scaledPosition),t.divideToRef(i.radius,this._scaledVelocity),i.collidedMesh=null,i.retry=0,i.initialVelocity=this._scaledVelocity,i.initialPosition=this._scaledPosition,this._collideWithWorld(this._scaledPosition,this._scaledVelocity,i,r,this._finalPosition,n),this._finalPosition.multiplyInPlace(i.radius),o(s,this._finalPosition,i.collidedMesh)},t.prototype.init=function(e){this._scene=e},t.prototype.destroy=function(){},t.prototype.onMeshAdded=function(e){},t.prototype.onMeshUpdated=function(e){},t.prototype.onMeshRemoved=function(e){},t.prototype.onGeometryAdded=function(e){},t.prototype.onGeometryUpdated=function(e){},t.prototype.onGeometryDeleted=function(e){},t.prototype._collideWithWorld=function(t,i,r,n,o,s){void 0===s&&(s=null);var a=10*e.Engine.CollisionsEpsilon;if(r.retry>=n)return void o.copyFrom(t);r._initialize(t,i,a);for(var h=0;h<this._scene.meshes.length;h++){var c=this._scene.meshes[h];c.isEnabled()&&c.checkCollisions&&c.subMeshes&&c!==s&&c._checkCollision(r)}return r.collisionFound?(0===i.x&&0===i.y&&0===i.z||r._getResponse(t,i),i.length()<=a?void o.copyFrom(t):(r.retry++,void this._collideWithWorld(t,i,r,n,o,s))):void t.addToRef(i,o)},t}();e.CollisionCoordinatorLegacy=n}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(r,n,o){t.call(this,r,o),this.upVector=e.Vector3.Up(),this.orthoLeft=null,this.orthoRight=null,this.orthoBottom=null,this.orthoTop=null,this.fov=.8,this.minZ=1,this.maxZ=1e4,this.inertia=.9,this.mode=i.PERSPECTIVE_CAMERA,this.isIntermediate=!1,this.viewport=new e.Viewport(0,0,1,1),this.layerMask=268435455,this.fovMode=i.FOVMODE_VERTICAL_FIXED,this.cameraRigMode=i.RIG_MODE_NONE,this._rigCameras=new Array,this._computedViewMatrix=e.Matrix.Identity(),this._projectionMatrix=new e.Matrix,this._postProcesses=new Array,this._activeMeshes=new e.SmartArray(256),this._globalPosition=e.Vector3.Zero(),o.addCamera(this),o.activeCamera||(o.activeCamera=this),this.position=n}return __extends(i,t),Object.defineProperty(i,"PERSPECTIVE_CAMERA",{get:function(){return i._PERSPECTIVE_CAMERA},enumerable:!0,configurable:!0}),Object.defineProperty(i,"ORTHOGRAPHIC_CAMERA",{get:function(){return i._ORTHOGRAPHIC_CAMERA},enumerable:!0,configurable:!0}),Object.defineProperty(i,"FOVMODE_VERTICAL_FIXED",{get:function(){return i._FOVMODE_VERTICAL_FIXED},enumerable:!0,configurable:!0}),Object.defineProperty(i,"FOVMODE_HORIZONTAL_FIXED",{get:function(){return i._FOVMODE_HORIZONTAL_FIXED},enumerable:!0,configurable:!0}),Object.defineProperty(i,"RIG_MODE_NONE",{get:function(){return i._RIG_MODE_NONE},enumerable:!0,configurable:!0}),Object.defineProperty(i,"RIG_MODE_STEREOSCOPIC_ANAGLYPH",{get:function(){return i._RIG_MODE_STEREOSCOPIC_ANAGLYPH},enumerable:!0,configurable:!0}),Object.defineProperty(i,"RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL",{get:function(){return i._RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL},enumerable:!0,configurable:!0}),Object.defineProperty(i,"RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED",{get:function(){return i._RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED},enumerable:!0,configurable:!0}),Object.defineProperty(i,"RIG_MODE_STEREOSCOPIC_OVERUNDER",{get:function(){return i._RIG_MODE_STEREOSCOPIC_OVERUNDER},enumerable:!0,configurable:!0}),Object.defineProperty(i,"RIG_MODE_VR",{get:function(){return i._RIG_MODE_VR},enumerable:!0,configurable:!0}),i.prototype.toString=function(e){var t="Name: "+this.name;if(t+=", type: "+this.getTypeName(),this.animations)for(var i=0;i<this.animations.length;i++)t+=", animation[0]: "+this.animations[i].toString(e);return t},Object.defineProperty(i.prototype,"globalPosition",{get:function(){return this._globalPosition},enumerable:!0,configurable:!0}),i.prototype.getActiveMeshes=function(){return this._activeMeshes},i.prototype.isActiveMesh=function(e){return-1!==this._activeMeshes.indexOf(e)},i.prototype._initCache=function(){t.prototype._initCache.call(this),this._cache.position=new e.Vector3(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.upVector=new e.Vector3(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.mode=void 0,this._cache.minZ=void 0,this._cache.maxZ=void 0,this._cache.fov=void 0,this._cache.aspectRatio=void 0,this._cache.orthoLeft=void 0,this._cache.orthoRight=void 0,this._cache.orthoBottom=void 0,this._cache.orthoTop=void 0,this._cache.renderWidth=void 0,this._cache.renderHeight=void 0},i.prototype._updateCache=function(e){e||t.prototype._updateCache.call(this);var i=this.getEngine();this._cache.position.copyFrom(this.position),this._cache.upVector.copyFrom(this.upVector),this._cache.mode=this.mode,this._cache.minZ=this.minZ,this._cache.maxZ=this.maxZ,this._cache.fov=this.fov,this._cache.aspectRatio=i.getAspectRatio(this),this._cache.orthoLeft=this.orthoLeft,this._cache.orthoRight=this.orthoRight,this._cache.orthoBottom=this.orthoBottom,this._cache.orthoTop=this.orthoTop,this._cache.renderWidth=i.getRenderWidth(),this._cache.renderHeight=i.getRenderHeight()},i.prototype._updateFromScene=function(){this.updateCache(),this._update()},i.prototype._isSynchronized=function(){return this._isSynchronizedViewMatrix()&&this._isSynchronizedProjectionMatrix()},i.prototype._isSynchronizedViewMatrix=function(){return t.prototype._isSynchronized.call(this)?this._cache.position.equals(this.position)&&this._cache.upVector.equals(this.upVector)&&this.isSynchronizedWithParent():!1},i.prototype._isSynchronizedProjectionMatrix=function(){var e=this._cache.mode===this.mode&&this._cache.minZ===this.minZ&&this._cache.maxZ===this.maxZ;if(!e)return!1;var t=this.getEngine();return e=this.mode===i.PERSPECTIVE_CAMERA?this._cache.fov===this.fov&&this._cache.aspectRatio===t.getAspectRatio(this):this._cache.orthoLeft===this.orthoLeft&&this._cache.orthoRight===this.orthoRight&&this._cache.orthoBottom===this.orthoBottom&&this._cache.orthoTop===this.orthoTop&&this._cache.renderWidth===t.getRenderWidth()&&this._cache.renderHeight===t.getRenderHeight()},i.prototype.attachControl=function(e,t){},i.prototype.detachControl=function(e){},i.prototype._update=function(){this.cameraRigMode!==i.RIG_MODE_NONE&&this._updateRigCameras(),this._checkInputs()},i.prototype._checkInputs=function(){},i.prototype._cascadePostProcessesToRigCams=function(){this._postProcesses.length>0&&this._postProcesses[0].markTextureDirty();for(var t=0,i=this._rigCameras.length;i>t;t++){var r=this._rigCameras[t],n=r._rigPostProcess;if(n){var o=n instanceof e.PassPostProcess;o&&(r.isIntermediate=0===this._postProcesses.length),r._postProcesses=this._postProcesses.slice(0).concat(n),n.markTextureDirty()}else r._postProcesses=this._postProcesses.slice(0)}},i.prototype.attachPostProcess=function(t,i){return void 0===i&&(i=null),!t.isReusable()&&this._postProcesses.indexOf(t)>-1?(e.Tools.Error("You're trying to reuse a post process not defined as reusable."),
0):(null==i||0>i?this._postProcesses.push(t):this._postProcesses.splice(i,0,t),this._cascadePostProcessesToRigCams(),this._postProcesses.indexOf(t))},i.prototype.detachPostProcess=function(e,t){void 0===t&&(t=null);var i,r,n=[];if(t)for(t=t instanceof Array?t:[t],i=t.length-1;i>=0;i--)this._postProcesses[t[i]]===e?this._postProcesses.splice(r,1):n.push(i);else{var o=this._postProcesses.indexOf(e);-1!==o&&this._postProcesses.splice(o,1)}return this._cascadePostProcessesToRigCams(),n},i.prototype.getWorldMatrix=function(){this._worldMatrix||(this._worldMatrix=e.Matrix.Identity());var t=this.getViewMatrix();return t.invertToRef(this._worldMatrix),this._worldMatrix},i.prototype._getViewMatrix=function(){return e.Matrix.Identity()},i.prototype.getViewMatrix=function(t){return this._computedViewMatrix=this._computeViewMatrix(t),!t&&this._isSynchronizedViewMatrix()?this._computedViewMatrix:(this.parent&&this.parent.getWorldMatrix?(this._worldMatrix||(this._worldMatrix=e.Matrix.Identity()),this._computedViewMatrix.invertToRef(this._worldMatrix),this._worldMatrix.multiplyToRef(this.parent.getWorldMatrix(),this._computedViewMatrix),this._globalPosition.copyFromFloats(this._computedViewMatrix.m[12],this._computedViewMatrix.m[13],this._computedViewMatrix.m[14]),this._computedViewMatrix.invert(),this._markSyncedWithParent()):this._globalPosition.copyFrom(this.position),this._currentRenderId=this.getScene().getRenderId(),this._computedViewMatrix)},i.prototype._computeViewMatrix=function(e){return!e&&this._isSynchronizedViewMatrix()?this._computedViewMatrix:(this._computedViewMatrix=this._getViewMatrix(),this._currentRenderId=this.getScene().getRenderId(),this._computedViewMatrix)},i.prototype.getProjectionMatrix=function(t){if(!t&&this._isSynchronizedProjectionMatrix())return this._projectionMatrix;var r=this.getEngine();if(this.mode===i.PERSPECTIVE_CAMERA)return this.minZ<=0&&(this.minZ=.1),e.Matrix.PerspectiveFovLHToRef(this.fov,r.getAspectRatio(this),this.minZ,this.maxZ,this._projectionMatrix,this.fovMode===i.FOVMODE_VERTICAL_FIXED),this._projectionMatrix;var n=r.getRenderWidth()/2,o=r.getRenderHeight()/2;return e.Matrix.OrthoOffCenterLHToRef(this.orthoLeft||-n,this.orthoRight||n,this.orthoBottom||-o,this.orthoTop||o,this.minZ,this.maxZ,this._projectionMatrix),this._projectionMatrix},i.prototype.dispose=function(){for(this.getScene().stopAnimation(this),this.getScene().removeCamera(this);this._rigCameras.length>0;)this._rigCameras.pop().dispose();for(var e=0;e<this._postProcesses.length;++e)this._postProcesses[e].dispose(this);t.prototype.dispose.call(this)},i.prototype.setCameraRigMode=function(t,r){for(;this._rigCameras.length>0;)this._rigCameras.pop().dispose();switch(this.cameraRigMode=t,this._cameraRigParams={},this._cameraRigParams.interaxialDistance=r.interaxialDistance||.0637,this._cameraRigParams.stereoHalfAngle=e.Tools.ToRadians(this._cameraRigParams.interaxialDistance/.0637),this.cameraRigMode!==i.RIG_MODE_NONE&&(this._rigCameras.push(this.createRigCamera(this.name+"_L",0)),this._rigCameras.push(this.createRigCamera(this.name+"_R",1))),this.cameraRigMode){case i.RIG_MODE_STEREOSCOPIC_ANAGLYPH:this._rigCameras[0]._rigPostProcess=new e.PassPostProcess(this.name+"_passthru",1,this._rigCameras[0]),this._rigCameras[1]._rigPostProcess=new e.AnaglyphPostProcess(this.name+"_anaglyph",1,this._rigCameras);break;case i.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:case i.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED:case i.RIG_MODE_STEREOSCOPIC_OVERUNDER:var n=this.cameraRigMode===i.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL||this.cameraRigMode===i.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED;this._rigCameras[0]._rigPostProcess=new e.PassPostProcess(this.name+"_passthru",1,this._rigCameras[0]),this._rigCameras[1]._rigPostProcess=new e.StereoscopicInterlacePostProcess(this.name+"_stereoInterlace",this._rigCameras,n);break;case i.RIG_MODE_VR:var o=r.vrCameraMetrics||e.VRCameraMetrics.GetDefault();this._rigCameras[0]._cameraRigParams.vrMetrics=o,this._rigCameras[0].viewport=new e.Viewport(0,0,.5,1),this._rigCameras[0]._cameraRigParams.vrWorkMatrix=new e.Matrix,this._rigCameras[0]._cameraRigParams.vrHMatrix=o.leftHMatrix,this._rigCameras[0]._cameraRigParams.vrPreViewMatrix=o.leftPreViewMatrix,this._rigCameras[0].getProjectionMatrix=this._rigCameras[0]._getVRProjectionMatrix,this._rigCameras[1]._cameraRigParams.vrMetrics=o,this._rigCameras[1].viewport=new e.Viewport(.5,0,.5,1),this._rigCameras[1]._cameraRigParams.vrWorkMatrix=new e.Matrix,this._rigCameras[1]._cameraRigParams.vrHMatrix=o.rightHMatrix,this._rigCameras[1]._cameraRigParams.vrPreViewMatrix=o.rightPreViewMatrix,this._rigCameras[1].getProjectionMatrix=this._rigCameras[1]._getVRProjectionMatrix,o.compensateDistortion&&(this._rigCameras[0]._rigPostProcess=new e.VRDistortionCorrectionPostProcess("VR_Distort_Compensation_Left",this._rigCameras[0],!1,o),this._rigCameras[1]._rigPostProcess=new e.VRDistortionCorrectionPostProcess("VR_Distort_Compensation_Right",this._rigCameras[1],!0,o))}this._cascadePostProcessesToRigCams(),this._update()},i.prototype._getVRProjectionMatrix=function(){return e.Matrix.PerspectiveFovLHToRef(this._cameraRigParams.vrMetrics.aspectRatioFov,this._cameraRigParams.vrMetrics.aspectRatio,this.minZ,this.maxZ,this._cameraRigParams.vrWorkMatrix),this._cameraRigParams.vrWorkMatrix.multiplyToRef(this._cameraRigParams.vrHMatrix,this._projectionMatrix),this._projectionMatrix},i.prototype.setCameraRigParameter=function(t,i){this._cameraRigParams||(this._cameraRigParams={}),this._cameraRigParams[t]=i,"interaxialDistance"===t&&(this._cameraRigParams.stereoHalfAngle=e.Tools.ToRadians(i/.0637))},i.prototype.createRigCamera=function(e,t){return null},i.prototype._updateRigCameras=function(){for(var e=0;e<this._rigCameras.length;e++)this._rigCameras[e].minZ=this.minZ,this._rigCameras[e].maxZ=this.maxZ,this._rigCameras[e].fov=this.fov;this.cameraRigMode===i.RIG_MODE_STEREOSCOPIC_ANAGLYPH&&(this._rigCameras[0].viewport=this._rigCameras[1].viewport=this.viewport)},i.prototype._setupInputs=function(){},i.prototype.serialize=function(){var t=e.SerializationHelper.Serialize(this);return t.type=this.getTypeName(),this.parent&&(t.parentId=this.parent.id),this.inputs&&this.inputs.serialize(t),e.Animation.AppendSerializedAnimations(this,t),t.ranges=this.serializeAnimationRanges(),t},i.prototype.getTypeName=function(){return"Camera"},i.prototype.clone=function(t){return e.SerializationHelper.Clone(i.GetConstructorFromName(this.getTypeName(),t,this.getScene(),this.interaxialDistance,this.isStereoscopicSideBySide),this)},i.GetConstructorFromName=function(t,i,r,n,o){switch(void 0===n&&(n=0),void 0===o&&(o=!0),t){case"ArcRotateCamera":return function(){return new e.ArcRotateCamera(i,0,0,1,e.Vector3.Zero(),r)};case"DeviceOrientationCamera":return function(){return new e.DeviceOrientationCamera(i,e.Vector3.Zero(),r)};case"FollowCamera":return function(){return new e.FollowCamera(i,e.Vector3.Zero(),r)};case"ArcFollowCamera":return function(){return new e.ArcFollowCamera(i,0,0,1,null,r)};case"GamepadCamera":return function(){return new e.GamepadCamera(i,e.Vector3.Zero(),r)};case"TouchCamera":return function(){return new e.TouchCamera(i,e.Vector3.Zero(),r)};case"VirtualJoysticksCamera":return function(){return new e.VirtualJoysticksCamera(i,e.Vector3.Zero(),r)};case"WebVRFreeCamera":return function(){return new e.WebVRFreeCamera(i,e.Vector3.Zero(),r)};case"VRDeviceOrientationFreeCamera":return function(){return new e.VRDeviceOrientationFreeCamera(i,e.Vector3.Zero(),r)};case"AnaglyphArcRotateCamera":return function(){return new e.AnaglyphArcRotateCamera(i,0,0,1,e.Vector3.Zero(),n,r)};case"AnaglyphFreeCamera":return function(){return new e.AnaglyphFreeCamera(i,e.Vector3.Zero(),n,r)};case"AnaglyphGamepadCamera":return function(){return new e.AnaglyphGamepadCamera(i,e.Vector3.Zero(),n,r)};case"AnaglyphUniversalCamera":return function(){return new e.AnaglyphUniversalCamera(i,e.Vector3.Zero(),n,r)};case"StereoscopicArcRotateCamera":return function(){return new e.StereoscopicArcRotateCamera(i,0,0,1,e.Vector3.Zero(),n,o,r)};case"StereoscopicFreeCamera":return function(){return new e.StereoscopicFreeCamera(i,e.Vector3.Zero(),n,o,r)};case"StereoscopicGamepadCamera":return function(){return new e.StereoscopicGamepadCamera(i,e.Vector3.Zero(),n,o,r)};case"StereoscopicUniversalCamera":return function(){return new e.StereoscopicUniversalCamera(i,e.Vector3.Zero(),n,o,r)};case"FreeCamera":return function(){return new e.UniversalCamera(i,e.Vector3.Zero(),r)};default:return function(){return new e.UniversalCamera(i,e.Vector3.Zero(),r)}}},i.Parse=function(t,r){var n=t.type,o=i.GetConstructorFromName(n,t.name,r,t.interaxial_distance,t.isStereoscopicSideBySide),s=e.SerializationHelper.Parse(o,t,r);if(t.parentId&&(s._waitingParentId=t.parentId),s.inputs&&(s.inputs.parse(t),s._setupInputs()),t.target&&s.setTarget&&s.setTarget(e.Vector3.FromArray(t.target)),t.cameraRigMode){var a=t.interaxial_distance?{interaxialDistance:t.interaxial_distance}:{};s.setCameraRigMode(t.cameraRigMode,a)}if(t.animations){for(var h=0;h<t.animations.length;h++){var c=t.animations[h];s.animations.push(e.Animation.Parse(c))}e.Node.ParseAnimationRanges(s,t,r)}return t.autoAnimate&&r.beginAnimation(s,t.autoAnimateFrom,t.autoAnimateTo,t.autoAnimateLoop,t.autoAnimateSpeed||1),s},i._PERSPECTIVE_CAMERA=0,i._ORTHOGRAPHIC_CAMERA=1,i._FOVMODE_VERTICAL_FIXED=0,i._FOVMODE_HORIZONTAL_FIXED=1,i._RIG_MODE_NONE=0,i._RIG_MODE_STEREOSCOPIC_ANAGLYPH=10,i._RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL=11,i._RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED=12,i._RIG_MODE_STEREOSCOPIC_OVERUNDER=13,i._RIG_MODE_VR=20,i.ForceAttachControlToAlwaysPreventDefault=!1,__decorate([e.serializeAsVector3()],i.prototype,"position",void 0),__decorate([e.serializeAsVector3()],i.prototype,"upVector",void 0),__decorate([e.serialize()],i.prototype,"orthoLeft",void 0),__decorate([e.serialize()],i.prototype,"orthoRight",void 0),__decorate([e.serialize()],i.prototype,"orthoBottom",void 0),__decorate([e.serialize()],i.prototype,"orthoTop",void 0),__decorate([e.serialize()],i.prototype,"fov",void 0),__decorate([e.serialize()],i.prototype,"minZ",void 0),__decorate([e.serialize()],i.prototype,"maxZ",void 0),__decorate([e.serialize()],i.prototype,"inertia",void 0),__decorate([e.serialize()],i.prototype,"mode",void 0),__decorate([e.serialize()],i.prototype,"layerMask",void 0),__decorate([e.serialize()],i.prototype,"fovMode",void 0),__decorate([e.serialize()],i.prototype,"cameraRigMode",void 0),__decorate([e.serialize()],i.prototype,"interaxialDistance",void 0),__decorate([e.serialize()],i.prototype,"isStereoscopicSideBySide",void 0),i}(e.Node);e.Camera=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){e.CameraInputTypes={};var t=function(){function t(e){this.attached={},this.camera=e,this.checkInputs=function(){}}return t.prototype.add=function(t){var i=t.getSimpleName();return this.attached[i]?void e.Tools.Warn("camera input of type "+i+" already exists on camera"):(this.attached[i]=t,t.camera=this.camera,t.checkInputs&&(this.checkInputs=this._addCheckInputs(t.checkInputs.bind(t))),void(this.attachedElement&&t.attachControl(this.attachedElement)))},t.prototype.remove=function(e){for(var t in this.attached){var i=this.attached[t];i===e&&(i.detachControl(this.attachedElement),delete this.attached[t],this.rebuildInputCheck())}},t.prototype.removeByType=function(e){for(var t in this.attached){var i=this.attached[t];i.getTypeName()===e&&(i.detachControl(this.attachedElement),delete this.attached[t],this.rebuildInputCheck())}},t.prototype._addCheckInputs=function(e){var t=this.checkInputs;return function(){t(),e()}},t.prototype.attachInput=function(e){e.attachControl(this.attachedElement,this.noPreventDefault)},t.prototype.attachElement=function(t,i){if(!this.attachedElement){i=e.Camera.ForceAttachControlToAlwaysPreventDefault?!1:i,this.attachedElement=t,this.noPreventDefault=i;for(var r in this.attached){this.attached[r];this.attached[r].attachControl(t,i)}}},t.prototype.detachElement=function(e){if(this.attachedElement===e){for(var t in this.attached){this.attached[t];this.attached[t].detachControl(e)}this.attachedElement=null}},t.prototype.rebuildInputCheck=function(){this.checkInputs=function(){};for(var e in this.attached){var t=this.attached[e];t.checkInputs&&(this.checkInputs=this._addCheckInputs(t.checkInputs.bind(t)))}},t.prototype.clear=function(){this.attachedElement&&this.detachElement(this.attachedElement),this.attached={},this.attachedElement=null,this.checkInputs=function(){}},t.prototype.serialize=function(t){var i={};for(var r in this.attached){var n=this.attached[r],o=e.SerializationHelper.Serialize(n);i[n.getTypeName()]=o}t.inputsmgr=i},t.prototype.parse=function(t){var i=t.inputsmgr;if(i){this.clear();for(var r in i){var n=e.CameraInputTypes[r];if(n){var o=i[r],s=e.SerializationHelper.Parse(function(){return new n},o,null);this.add(s)}}}else for(var r in this.attached){var n=e.CameraInputTypes[this.attached[r].getTypeName()];if(n){var s=e.SerializationHelper.Parse(function(){return new n},t,null);this.remove(this.attached[r]),this.add(s)}}},t}();e.CameraInputsManager=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(e){void 0===e&&(e=!0),this.touchEnabled=e,this.angularSensibility=2e3}return t.prototype.attachControl=function(t,i){var r=this;if(!this._pointerInput){var n=this.camera,o=this.camera.getEngine();this._pointerInput=function(t,s){var a=t.event;if(r.touchEnabled||"touch"!==a.pointerType)if(t.type===e.PointerEventTypes.POINTERDOWN){try{a.srcElement.setPointerCapture(a.pointerId)}catch(h){}r.previousPosition={x:a.clientX,y:a.clientY},i||a.preventDefault()}else if(t.type===e.PointerEventTypes.POINTERUP){try{a.srcElement.releasePointerCapture(a.pointerId)}catch(h){}r.previousPosition=null,i||a.preventDefault()}else if(t.type===e.PointerEventTypes.POINTERMOVE){if(!r.previousPosition&&!o.isPointerLock)return;var c,l;o.isPointerLock?(c=a.movementX||a.mozMovementX||a.webkitMovementX||a.msMovementX||0,l=a.movementY||a.mozMovementY||a.webkitMovementY||a.msMovementY||0):(c=a.clientX-r.previousPosition.x,l=a.clientY-r.previousPosition.y),n.cameraRotation.y+=c/r.angularSensibility,n.cameraRotation.x+=l/r.angularSensibility,r.previousPosition={x:a.clientX,y:a.clientY},i||a.preventDefault()}}}this._observer=this.camera.getScene().onPointerObservable.add(this._pointerInput,e.PointerEventTypes.POINTERDOWN|e.PointerEventTypes.POINTERUP|e.PointerEventTypes.POINTERMOVE)},t.prototype.detachControl=function(e){this._observer&&e&&(this.camera.getScene().onPointerObservable.remove(this._observer),this._observer=null,this.previousPosition=null)},t.prototype.getTypeName=function(){return"FreeCameraMouseInput"},t.prototype.getSimpleName=function(){return"mouse"},__decorate([e.serialize()],t.prototype,"angularSensibility",void 0),t}();e.FreeCameraMouseInput=t,e.CameraInputTypes.FreeCameraMouseInput=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(){this._keys=[],this.keysUp=[38],this.keysDown=[40],this.keysLeft=[37],this.keysRight=[39]}return t.prototype.attachControl=function(t,i){var r=this;this._onKeyDown||(this._onKeyDown=function(e){if(-1!==r.keysUp.indexOf(e.keyCode)||-1!==r.keysDown.indexOf(e.keyCode)||-1!==r.keysLeft.indexOf(e.keyCode)||-1!==r.keysRight.indexOf(e.keyCode)){var t=r._keys.indexOf(e.keyCode);-1===t&&r._keys.push(e.keyCode),i||e.preventDefault()}},this._onKeyUp=function(e){if(-1!==r.keysUp.indexOf(e.keyCode)||-1!==r.keysDown.indexOf(e.keyCode)||-1!==r.keysLeft.indexOf(e.keyCode)||-1!==r.keysRight.indexOf(e.keyCode)){var t=r._keys.indexOf(e.keyCode);t>=0&&r._keys.splice(t,1),i||e.preventDefault()}},e.Tools.RegisterTopRootEvents([{name:"keydown",handler:this._onKeyDown},{name:"keyup",handler:this._onKeyUp},{name:"blur",handler:this._onLostFocus}]))},t.prototype.detachControl=function(t){this._onKeyDown&&(e.Tools.UnregisterTopRootEvents([{name:"keydown",handler:this._onKeyDown},{name:"keyup",handler:this._onKeyUp},{name:"blur",handler:this._onLostFocus}]),this._keys=[],this._onKeyDown=null,this._onKeyUp=null)},t.prototype.checkInputs=function(){if(this._onKeyDown)for(var t=this.camera,i=0;i<this._keys.length;i++){var r=this._keys[i],n=t._computeLocalCameraSpeed();-1!==this.keysLeft.indexOf(r)?t._localDirection.copyFromFloats(-n,0,0):-1!==this.keysUp.indexOf(r)?t._localDirection.copyFromFloats(0,0,n):-1!==this.keysRight.indexOf(r)?t._localDirection.copyFromFloats(n,0,0):-1!==this.keysDown.indexOf(r)&&t._localDirection.copyFromFloats(0,0,-n),t.getViewMatrix().invertToRef(t._cameraTransformMatrix),e.Vector3.TransformNormalToRef(t._localDirection,t._cameraTransformMatrix,t._transformedDirection),t.cameraDirection.addInPlace(t._transformedDirection)}},t.prototype.getTypeName=function(){return"FreeCameraKeyboardMoveInput"},t.prototype._onLostFocus=function(e){this._keys=[]},t.prototype.getSimpleName=function(){return"keyboard"},__decorate([e.serialize()],t.prototype,"keysUp",void 0),__decorate([e.serialize()],t.prototype,"keysDown",void 0),__decorate([e.serialize()],t.prototype,"keysLeft",void 0),__decorate([e.serialize()],t.prototype,"keysRight",void 0),t}();e.FreeCameraKeyboardMoveInput=t,e.CameraInputTypes.FreeCameraKeyboardMoveInput=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(){this._offsetX=null,this._offsetY=null,this._pointerCount=0,this._pointerPressed=[],this.touchAngularSensibility=2e5,this.touchMoveSensibility=250}return t.prototype.attachControl=function(t,i){var r,n=this;void 0===this._pointerInput&&(this._onLostFocus=function(e){n._offsetX=null,n._offsetY=null},this._pointerInput=function(t,o){var s=t.event;if("mouse"!==s.pointerType)if(t.type===e.PointerEventTypes.POINTERDOWN){if(i||s.preventDefault(),n._pointerPressed.push(s.pointerId),1!==n._pointerPressed.length)return;r={x:s.clientX,y:s.clientY}}else if(t.type===e.PointerEventTypes.POINTERUP){i||s.preventDefault();var a=n._pointerPressed.indexOf(s.pointerId);if(-1===a)return;if(n._pointerPressed.splice(a,1),0!=a)return;r=null,n._offsetX=null,n._offsetY=null}else if(t.type===e.PointerEventTypes.POINTERMOVE){if(i||s.preventDefault(),!r)return;var a=n._pointerPressed.indexOf(s.pointerId);if(0!=a)return;n._offsetX=s.clientX-r.x,n._offsetY=-(s.clientY-r.y)}}),this._observer=this.camera.getScene().onPointerObservable.add(this._pointerInput,e.PointerEventTypes.POINTERDOWN|e.PointerEventTypes.POINTERUP|e.PointerEventTypes.POINTERMOVE),t.addEventListener("blur",this._onLostFocus)},t.prototype.detachControl=function(e){this._pointerInput&&e&&(this.camera.getScene().onPointerObservable.remove(this._observer),this._observer=null,e.removeEventListener("blur",this._onLostFocus),this._onLostFocus=null,this._pointerPressed=[],this._offsetX=null,this._offsetY=null,this._pointerCount=0)},t.prototype.checkInputs=function(){if(this._offsetX){var t=this.camera;if(t.cameraRotation.y+=this._offsetX/this.touchAngularSensibility,this._pointerPressed.length>1)t.cameraRotation.x+=-this._offsetY/this.touchAngularSensibility;else{var i=t._computeLocalCameraSpeed(),r=new e.Vector3(0,0,i*this._offsetY/this.touchMoveSensibility);e.Matrix.RotationYawPitchRollToRef(t.rotation.y,t.rotation.x,0,t._cameraRotationMatrix),t.cameraDirection.addInPlace(e.Vector3.TransformCoordinates(r,t._cameraRotationMatrix))}}},t.prototype.getTypeName=function(){return"FreeCameraTouchInput"},t.prototype.getSimpleName=function(){return"touch"},__decorate([e.serialize()],t.prototype,"touchAngularSensibility",void 0),__decorate([e.serialize()],t.prototype,"touchMoveSensibility",void 0),t}();e.FreeCameraTouchInput=t,e.CameraInputTypes.FreeCameraTouchInput=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(){var t=this;this._screenOrientationAngle=0,this._screenQuaternion=new e.Quaternion,this._alpha=0,this._beta=0,this._gamma=0,this._orientationChanged=function(){t._screenOrientationAngle=void 0!==window.orientation?+window.orientation:window.screen.orientation&&window.screen.orientation.angle?window.screen.orientation.angle:0,t._screenOrientationAngle=-e.Tools.ToRadians(t._screenOrientationAngle/2),t._screenQuaternion.copyFromFloats(0,Math.sin(t._screenOrientationAngle),0,Math.cos(t._screenOrientationAngle))},this._deviceOrientation=function(e){t._alpha=e.alpha,t._beta=e.beta,t._gamma=e.gamma},this._constantTranform=new e.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5)),this._orientationChanged()}return Object.defineProperty(t.prototype,"camera",{get:function(){return this._camera},set:function(t){this._camera=t,this._camera.rotationQuaternion||(this._camera.rotationQuaternion=new e.Quaternion)},enumerable:!0,configurable:!0}),t.prototype.attachControl=function(e,t){window.addEventListener("orientationchange",this._orientationChanged),window.addEventListener("deviceorientation",this._deviceOrientation)},t.prototype.detachControl=function(e){window.removeEventListener("orientationchange",this._orientationChanged),window.removeEventListener("deviceorientation",this._deviceOrientation)},t.prototype.checkInputs=function(){e.Quaternion.RotationYawPitchRollToRef(e.Tools.ToRadians(this._alpha),e.Tools.ToRadians(this._beta),-e.Tools.ToRadians(this._gamma),this.camera.rotationQuaternion),this._camera.rotationQuaternion.multiplyInPlace(this._screenQuaternion),this._camera.rotationQuaternion.multiplyInPlace(this._constantTranform),this._camera.rotationQuaternion.z*=-1,this._camera.rotationQuaternion.w*=-1},t.prototype.getTypeName=function(){return"FreeCameraDeviceOrientationInput"},t.prototype.getSimpleName=function(){return"deviceOrientation"},t}();e.FreeCameraDeviceOrientationInput=t,e.CameraInputTypes.FreeCameraDeviceOrientationInput=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function e(){this.alphaCorrection=1,this.betaCorrection=1,this.gammaCorrection=1,this._alpha=0,this._beta=0,this._gamma=0,this._dirty=!1,this._deviceOrientationHandler=this._onOrientationEvent.bind(this)}return e.prototype.attachControl=function(e,t){window.addEventListener("deviceorientation",this._deviceOrientationHandler)},e.prototype._onOrientationEvent=function(e){this.camera;this._alpha=e.alpha,this._beta=e.beta,this._gamma=e.gamma,this._dirty=!0},e.prototype.checkInputs=function(){if(this._dirty){this._dirty=!1;var e=this._gamma;e=0>e?90+e:270-e,this.camera.rotation.x=this.gammaCorrection*e/180*Math.PI,this.camera.rotation.y=this.alphaCorrection*-this._alpha/180*Math.PI,this.camera.rotation.z=this.betaCorrection*this._beta/180*Math.PI}},e.prototype.detachControl=function(e){window.removeEventListener("deviceorientation",this._deviceOrientationHandler)},e.prototype.getTypeName=function(){return"FreeCameraVRDeviceOrientationInput"},e.prototype.getSimpleName=function(){return"VRDeviceOrientation"},e}();e.FreeCameraVRDeviceOrientationInput=t,e.CameraInputTypes.FreeCameraVRDeviceOrientationInput=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(){this.gamepadAngularSensibility=200,this.gamepadMoveSensibility=40}return t.prototype.attachControl=function(t,i){var r=this;this._gamepads=new e.Gamepads(function(e){r._onNewGameConnected(e)})},t.prototype.detachControl=function(e){this._gamepads&&this._gamepads.dispose(),this.gamepad=null},t.prototype.checkInputs=function(){if(this.gamepad){var t=this.camera,i=this.gamepad.leftStick,r=i.x/this.gamepadMoveSensibility,n=i.y/this.gamepadMoveSensibility;i.x=Math.abs(r)>.005?0+r:0,i.y=Math.abs(n)>.005?0+n:0;var o=this.gamepad.rightStick,s=o.x/this.gamepadAngularSensibility,a=o.y/this.gamepadAngularSensibility;o.x=Math.abs(s)>.001?0+s:0,o.y=Math.abs(a)>.001?0+a:0;var h=e.Matrix.RotationYawPitchRoll(t.rotation.y,t.rotation.x,0),c=50*t._computeLocalCameraSpeed(),l=e.Vector3.TransformCoordinates(new e.Vector3(i.x*c,0,-i.y*c),h);t.cameraDirection=t.cameraDirection.add(l),t.cameraRotation=t.cameraRotation.add(new e.Vector2(o.y,o.x))}},t.prototype._onNewGameConnected=function(e){0===e.index&&(this.gamepad=e)},t.prototype.getTypeName=function(){return"FreeCameraGamepadInput"},t.prototype.getSimpleName=function(){return"gamepad"},__decorate([e.serialize()],t.prototype,"gamepadAngularSensibility",void 0),__decorate([e.serialize()],t.prototype,"gamepadMoveSensibility",void 0),t}();e.FreeCameraGamepadInput=t,e.CameraInputTypes.FreeCameraGamepadInput=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(){this._keys=[],this.keysUp=[38],this.keysDown=[40],this.keysLeft=[37],this.keysRight=[39]}return t.prototype.attachControl=function(t,i){var r=this;this._onKeyDown=function(e){if(-1!==r.keysUp.indexOf(e.keyCode)||-1!==r.keysDown.indexOf(e.keyCode)||-1!==r.keysLeft.indexOf(e.keyCode)||-1!==r.keysRight.indexOf(e.keyCode)){var t=r._keys.indexOf(e.keyCode);-1===t&&r._keys.push(e.keyCode),e.preventDefault&&(i||e.preventDefault())}},this._onKeyUp=function(e){if(-1!==r.keysUp.indexOf(e.keyCode)||-1!==r.keysDown.indexOf(e.keyCode)||-1!==r.keysLeft.indexOf(e.keyCode)||-1!==r.keysRight.indexOf(e.keyCode)){var t=r._keys.indexOf(e.keyCode);t>=0&&r._keys.splice(t,1),e.preventDefault&&(i||e.preventDefault())}},this._onLostFocus=function(){r._keys=[]},e.Tools.RegisterTopRootEvents([{name:"keydown",handler:this._onKeyDown},{name:"keyup",handler:this._onKeyUp},{name:"blur",handler:this._onLostFocus}])},t.prototype.detachControl=function(t){e.Tools.UnregisterTopRootEvents([{name:"keydown",handler:this._onKeyDown},{name:"keyup",handler:this._onKeyUp},{name:"blur",handler:this._onLostFocus}]),this._keys=[],this._onKeyDown=null,this._onKeyUp=null,this._onLostFocus=null},t.prototype.checkInputs=function(){if(this._onKeyDown)for(var e=this.camera,t=0;t<this._keys.length;t++){var i=this._keys[t];-1!==this.keysLeft.indexOf(i)?e.inertialAlphaOffset-=.01:-1!==this.keysUp.indexOf(i)?e.inertialBetaOffset-=.01:-1!==this.keysRight.indexOf(i)?e.inertialAlphaOffset+=.01:-1!==this.keysDown.indexOf(i)&&(e.inertialBetaOffset+=.01)}},t.prototype.getTypeName=function(){return"ArcRotateCameraKeyboardMoveInput"},t.prototype.getSimpleName=function(){return"keyboard"},__decorate([e.serialize()],t.prototype,"keysUp",void 0),__decorate([e.serialize()],t.prototype,"keysDown",void 0),__decorate([e.serialize()],t.prototype,"keysLeft",void 0),__decorate([e.serialize()],t.prototype,"keysRight",void 0),t}();e.ArcRotateCameraKeyboardMoveInput=t,e.CameraInputTypes.ArcRotateCameraKeyboardMoveInput=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(){this.wheelPrecision=3}return t.prototype.attachControl=function(t,i){var r=this;this._wheel=function(t,n){if(t.type===e.PointerEventTypes.POINTERWHEEL){var o=t.event,s=0;o.wheelDelta?s=o.wheelDelta/(40*r.wheelPrecision):o.detail&&(s=-o.detail/r.wheelPrecision),s&&(r.camera.inertialRadiusOffset+=s),o.preventDefault&&(i||o.preventDefault())}},this._observer=this.camera.getScene().onPointerObservable.add(this._wheel,e.PointerEventTypes.POINTERWHEEL)},t.prototype.detachControl=function(e){this._observer&&e&&(this.camera.getScene().onPointerObservable.remove(this._observer),this._observer=null,this._wheel=null)},t.prototype.getTypeName=function(){return"ArcRotateCameraMouseWheelInput"},t.prototype.getSimpleName=function(){return"mousewheel"},__decorate([e.serialize()],t.prototype,"wheelPrecision",void 0),t}();e.ArcRotateCameraMouseWheelInput=t,e.CameraInputTypes.ArcRotateCameraMouseWheelInput=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=(e.Tools.GetPointerPrefix(),function(){function t(){this.angularSensibilityX=1e3,this.angularSensibilityY=1e3,this.pinchPrecision=6,this.panningSensibility=50,this._isRightClick=!1,this._isCtrlPushed=!1,this.pinchInwards=!0}return t.prototype.attachControl=function(t,i){var r,n,o,s=this,a=this.camera.getEngine(),h=0;this._pointerInput=function(t,a){var c=t.event;if(t.type===e.PointerEventTypes.POINTERDOWN){try{c.srcElement.setPointerCapture(c.pointerId)}catch(l){}s._isRightClick=2===c.button,r={x:c.clientX,y:c.clientY,pointerId:c.pointerId,type:c.pointerType},void 0===n?n=r:void 0===o&&(o=r),i||c.preventDefault()}else if(t.type===e.PointerEventTypes.POINTERUP){try{c.srcElement.releasePointerCapture(c.pointerId)}catch(l){}r=null,h=0,n=o=void 0,i||c.preventDefault()}else if(t.type===e.PointerEventTypes.POINTERMOVE)if(i||c.preventDefault(),n&&void 0===o){if(0!==s.panningSensibility&&(s._isCtrlPushed&&s.camera._useCtrlForPanning||!s.camera._useCtrlForPanning&&s._isRightClick))s.camera.inertialPanningX+=-(c.clientX-r.x)/s.panningSensibility,s.camera.inertialPanningY+=(c.clientY-r.y)/s.panningSensibility;else{var u=c.clientX-r.x,f=c.clientY-r.y;s.camera.inertialAlphaOffset-=u/s.angularSensibilityX,s.camera.inertialBetaOffset-=f/s.angularSensibilityY}r.x=c.clientX,r.y=c.clientY}else if(n&&o){var d=n.pointerId===c.pointerId?n:o;d.x=c.clientX,d.y=c.clientY;var p=s.pinchInwards?1:-1,_=n.x-o.x,m=n.y-o.y,g=_*_+m*m;if(0===h)return void(h=g);g!==h&&(s.camera.inertialRadiusOffset+=(g-h)/(s.pinchPrecision*((s.angularSensibilityX+s.angularSensibilityY)/2)*p),h=g)}},this._observer=this.camera.getScene().onPointerObservable.add(this._pointerInput,e.PointerEventTypes.POINTERDOWN|e.PointerEventTypes.POINTERUP|e.PointerEventTypes.POINTERMOVE),this._onContextMenu=function(e){e.preventDefault()},this.camera._useCtrlForPanning||t.addEventListener("contextmenu",this._onContextMenu,!1),this._onLostFocus=function(){n=o=void 0,h=0,r=null},this._onKeyDown=function(e){s._isCtrlPushed=e.ctrlKey},this._onKeyUp=function(e){s._isCtrlPushed=e.ctrlKey},this._onMouseMove=function(e){if(a.isPointerLock){var t=e.movementX||e.mozMovementX||e.webkitMovementX||e.msMovementX||0,r=e.movementY||e.mozMovementY||e.webkitMovementY||e.msMovementY||0;s.camera.inertialAlphaOffset-=t/s.angularSensibilityX,s.camera.inertialBetaOffset-=r/s.angularSensibilityY,i||e.preventDefault()}},this._onGestureStart=function(e){void 0!==window.MSGesture&&(s._MSGestureHandler||(s._MSGestureHandler=new MSGesture,s._MSGestureHandler.target=t),s._MSGestureHandler.addPointer(e.pointerId))},this._onGesture=function(e){s.camera.radius*=e.scale,e.preventDefault&&(i||(e.stopPropagation(),e.preventDefault()))},t.addEventListener("mousemove",this._onMouseMove,!1),t.addEventListener("MSPointerDown",this._onGestureStart,!1),t.addEventListener("MSGestureChange",this._onGesture,!1),e.Tools.RegisterTopRootEvents([{name:"keydown",handler:this._onKeyDown},{name:"keyup",handler:this._onKeyUp},{name:"blur",handler:this._onLostFocus}])},t.prototype.detachControl=function(t){t&&this._observer&&(this.camera.getScene().onPointerObservable.remove(this._observer),this._observer=null,t.removeEventListener("contextmenu",this._onContextMenu),t.removeEventListener("mousemove",this._onMouseMove),t.removeEventListener("MSPointerDown",this._onGestureStart),t.removeEventListener("MSGestureChange",this._onGesture),this._isRightClick=!1,this._isCtrlPushed=!1,this.pinchInwards=!0,this._onKeyDown=null,this._onKeyUp=null,this._onMouseMove=null,this._onGestureStart=null,this._onGesture=null,this._MSGestureHandler=null,this._onLostFocus=null,this._onContextMenu=null),e.Tools.UnregisterTopRootEvents([{name:"keydown",handler:this._onKeyDown},{name:"keyup",handler:this._onKeyUp},{name:"blur",handler:this._onLostFocus}])},t.prototype.getTypeName=function(){return"ArcRotateCameraPointersInput"},t.prototype.getSimpleName=function(){return"pointers"},__decorate([e.serialize()],t.prototype,"angularSensibilityX",void 0),__decorate([e.serialize()],t.prototype,"angularSensibilityY",void 0),__decorate([e.serialize()],t.prototype,"pinchPrecision",void 0),__decorate([e.serialize()],t.prototype,"panningSensibility",void 0),t}());e.ArcRotateCameraPointersInput=t,e.CameraInputTypes.ArcRotateCameraPointersInput=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(){this.gamepadRotationSensibility=80,this.gamepadMoveSensibility=40}return t.prototype.attachControl=function(t,i){var r=this;this._gamepads=new e.Gamepads(function(e){r._onNewGameConnected(e)})},t.prototype.detachControl=function(e){this._gamepads&&this._gamepads.dispose(),
this.gamepad=null},t.prototype.checkInputs=function(){if(this.gamepad){var e=this.camera,t=this.gamepad.rightStick;if(0!=t.x){var i=t.x/this.gamepadRotationSensibility;0!=i&&Math.abs(i)>.005&&(e.inertialAlphaOffset+=i)}if(0!=t.y){var r=t.y/this.gamepadRotationSensibility;0!=r&&Math.abs(r)>.005&&(e.inertialBetaOffset+=r)}var n=this.gamepad.leftStick;if(0!=n.y){var o=n.y/this.gamepadMoveSensibility;0!=o&&Math.abs(o)>.005&&(this.camera.inertialRadiusOffset-=o)}}},t.prototype._onNewGameConnected=function(e){0===e.index&&(this.gamepad=e)},t.prototype.getTypeName=function(){return"ArcRotateCameraGamepadInput"},t.prototype.getSimpleName=function(){return"gamepad"},__decorate([e.serialize()],t.prototype,"gamepadRotationSensibility",void 0),__decorate([e.serialize()],t.prototype,"gamepadMoveSensibility",void 0),t}();e.ArcRotateCameraGamepadInput=t,e.CameraInputTypes.ArcRotateCameraGamepadInput=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function e(){this.alphaCorrection=1,this.betaCorrection=1,this.gammaCorrection=1,this._alpha=0,this._beta=0,this._gamma=0,this._dirty=!1,this._deviceOrientationHandler=this._onOrientationEvent.bind(this)}return e.prototype.attachControl=function(e,t){this.camera.attachControl(e,t),window.addEventListener("deviceorientation",this._deviceOrientationHandler)},e.prototype._onOrientationEvent=function(e){this.camera;this._alpha=0|+e.alpha,this._beta=0|+e.beta,this._gamma=0|+e.gamma,this._dirty=!0},e.prototype.checkInputs=function(){this._dirty&&(this._dirty=!1,this._gamma<0&&(this._gamma=180+this._gamma),this.camera.alpha=-this._alpha/180*Math.PI%Math.PI*2,this.camera.beta=this._gamma/180*Math.PI)},e.prototype.detachControl=function(e){window.removeEventListener("deviceorientation",this._deviceOrientationHandler)},e.prototype.getTypeName=function(){return"ArcRotateCameraVRDeviceOrientationInput"},e.prototype.getSimpleName=function(){return"VRDeviceOrientation"},e}();e.ArcRotateCameraVRDeviceOrientationInput=t,e.CameraInputTypes.ArcRotateCameraVRDeviceOrientationInput=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(i,r,n){t.call(this,i,r,n),this.cameraDirection=new e.Vector3(0,0,0),this.cameraRotation=new e.Vector2(0,0),this.rotation=new e.Vector3(0,0,0),this.speed=2,this.noRotationConstraint=!1,this.lockedTarget=null,this._currentTarget=e.Vector3.Zero(),this._viewMatrix=e.Matrix.Zero(),this._camMatrix=e.Matrix.Zero(),this._cameraTransformMatrix=e.Matrix.Zero(),this._cameraRotationMatrix=e.Matrix.Zero(),this._referencePoint=new e.Vector3(0,0,1),this._defaultUpVector=new e.Vector3(0,1,0),this._transformedReferencePoint=e.Vector3.Zero(),this._lookAtTemp=e.Matrix.Zero(),this._tempMatrix=e.Matrix.Zero()}return __extends(i,t),i.prototype.getFrontPosition=function(e){var t=this.getTarget().subtract(this.position);return t.normalize(),t.scaleInPlace(e),this.globalPosition.add(t)},i.prototype._getLockedTargetPosition=function(){return this.lockedTarget?this.lockedTarget.position||this.lockedTarget:null},i.prototype._initCache=function(){t.prototype._initCache.call(this),this._cache.lockedTarget=new e.Vector3(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.rotation=new e.Vector3(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.rotationQuaternion=new e.Quaternion(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)},i.prototype._updateCache=function(e){e||t.prototype._updateCache.call(this);var i=this._getLockedTargetPosition();i?this._cache.lockedTarget?this._cache.lockedTarget.copyFrom(i):this._cache.lockedTarget=i.clone():this._cache.lockedTarget=null,this._cache.rotation.copyFrom(this.rotation),this.rotationQuaternion&&this._cache.rotationQuaternion.copyFrom(this.rotationQuaternion)},i.prototype._isSynchronizedViewMatrix=function(){if(!t.prototype._isSynchronizedViewMatrix.call(this))return!1;var e=this._getLockedTargetPosition();return(this._cache.lockedTarget?this._cache.lockedTarget.equals(e):!e)&&(this.rotationQuaternion?this.rotationQuaternion.equals(this._cache.rotationQuaternion):this._cache.rotation.equals(this.rotation))},i.prototype._computeLocalCameraSpeed=function(){var e=this.getEngine();return this.speed*(e.getDeltaTime()/(10*e.getFps()))},i.prototype.setTarget=function(t){this.upVector.normalize(),e.Matrix.LookAtLHToRef(this.position,t,this._defaultUpVector,this._camMatrix),this._camMatrix.invert(),this.rotation.x=Math.atan(this._camMatrix.m[6]/this._camMatrix.m[10]);var i=t.subtract(this.position);i.x>=0?this.rotation.y=-Math.atan(i.z/i.x)+Math.PI/2:this.rotation.y=-Math.atan(i.z/i.x)-Math.PI/2,this.rotation.z=0,isNaN(this.rotation.x)&&(this.rotation.x=0),isNaN(this.rotation.y)&&(this.rotation.y=0),isNaN(this.rotation.z)&&(this.rotation.z=0),this.rotationQuaternion&&e.Quaternion.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,this.rotation.z,this.rotationQuaternion)},i.prototype.getTarget=function(){return this._currentTarget},i.prototype._decideIfNeedsToMove=function(){return Math.abs(this.cameraDirection.x)>0||Math.abs(this.cameraDirection.y)>0||Math.abs(this.cameraDirection.z)>0},i.prototype._updatePosition=function(){this.position.addInPlace(this.cameraDirection)},i.prototype._checkInputs=function(){var i=this._decideIfNeedsToMove(),r=Math.abs(this.cameraRotation.x)>0||Math.abs(this.cameraRotation.y)>0;if(i&&this._updatePosition(),r&&(this.rotation.x+=this.cameraRotation.x,this.rotation.y+=this.cameraRotation.y,!this.noRotationConstraint)){var n=Math.PI/2*.95;this.rotation.x>n&&(this.rotation.x=n),this.rotation.x<-n&&(this.rotation.x=-n)}i&&(Math.abs(this.cameraDirection.x)<e.Epsilon&&(this.cameraDirection.x=0),Math.abs(this.cameraDirection.y)<e.Epsilon&&(this.cameraDirection.y=0),Math.abs(this.cameraDirection.z)<e.Epsilon&&(this.cameraDirection.z=0),this.cameraDirection.scaleInPlace(this.inertia)),r&&(Math.abs(this.cameraRotation.x)<e.Epsilon&&(this.cameraRotation.x=0),Math.abs(this.cameraRotation.y)<e.Epsilon&&(this.cameraRotation.y=0),this.cameraRotation.scaleInPlace(this.inertia)),t.prototype._checkInputs.call(this)},i.prototype._updateCameraRotationMatrix=function(){this.rotationQuaternion?(this.rotationQuaternion.toRotationMatrix(this._cameraRotationMatrix),e.Vector3.TransformNormalToRef(this._defaultUpVector,this._cameraRotationMatrix,this.upVector)):e.Matrix.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,this.rotation.z,this._cameraRotationMatrix)},i.prototype._getViewMatrix=function(){return this.lockedTarget?this._currentTarget.copyFrom(this._getLockedTargetPosition()):(this._updateCameraRotationMatrix(),e.Vector3.TransformCoordinatesToRef(this._referencePoint,this._cameraRotationMatrix,this._transformedReferencePoint),this.position.addToRef(this._transformedReferencePoint,this._currentTarget)),e.Matrix.LookAtLHToRef(this.position,this._currentTarget,this.upVector,this._viewMatrix),this._viewMatrix},i.prototype.createRigCamera=function(t,r){if(this.cameraRigMode!==e.Camera.RIG_MODE_NONE){var n=new i(t,this.position.clone(),this.getScene());return this.cameraRigMode===e.Camera.RIG_MODE_VR&&(this.rotationQuaternion||(this.rotationQuaternion=new e.Quaternion),n._cameraRigParams={},n.rotationQuaternion=new e.Quaternion),n}return null},i.prototype._updateRigCameras=function(){var i=this._rigCameras[0],r=this._rigCameras[1];switch(this.cameraRigMode){case e.Camera.RIG_MODE_STEREOSCOPIC_ANAGLYPH:case e.Camera.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:case e.Camera.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED:case e.Camera.RIG_MODE_STEREOSCOPIC_OVERUNDER:var n=this.cameraRigMode===e.Camera.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED?1:-1,o=this.cameraRigMode===e.Camera.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED?-1:1;this._getRigCamPosition(this._cameraRigParams.stereoHalfAngle*n,i.position),this._getRigCamPosition(this._cameraRigParams.stereoHalfAngle*o,r.position),i.setTarget(this.getTarget()),r.setTarget(this.getTarget());break;case e.Camera.RIG_MODE_VR:i.rotationQuaternion.copyFrom(this.rotationQuaternion),r.rotationQuaternion.copyFrom(this.rotationQuaternion),i.position.copyFrom(this.position),r.position.copyFrom(this.position)}t.prototype._updateRigCameras.call(this)},i.prototype._getRigCamPosition=function(t,i){this._rigCamTransformMatrix||(this._rigCamTransformMatrix=new e.Matrix);var r=this.getTarget();e.Matrix.Translation(-r.x,-r.y,-r.z).multiplyToRef(e.Matrix.RotationY(t),this._rigCamTransformMatrix),this._rigCamTransformMatrix=this._rigCamTransformMatrix.multiply(e.Matrix.Translation(r.x,r.y,r.z)),e.Vector3.TransformCoordinatesToRef(this.position,this._rigCamTransformMatrix,i)},i.prototype.getTypeName=function(){return"TargetCamera"},__decorate([e.serializeAsVector3()],i.prototype,"rotation",void 0),__decorate([e.serialize()],i.prototype,"speed",void 0),__decorate([e.serializeAsMeshReference("lockedTargetId")],i.prototype,"lockedTarget",void 0),i}(e.Camera);e.TargetCamera=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(i,r,n){var o=this;t.call(this,i,r,n),this.ellipsoid=new e.Vector3(.5,1,.5),this.checkCollisions=!1,this.applyGravity=!1,this._collider=new e.Collider,this._needMoveForGravity=!1,this._oldPosition=e.Vector3.Zero(),this._diffPosition=e.Vector3.Zero(),this._newPosition=e.Vector3.Zero(),this._onCollisionPositionChange=function(t,i,r){void 0===r&&(r=null),o.getScene().workerCollisions&&i.multiplyInPlace(o._collider.radius);var n=function(t){o._newPosition.copyFrom(t),o._newPosition.subtractToRef(o._oldPosition,o._diffPosition);o.position.clone();o._diffPosition.length()>e.Engine.CollisionsEpsilon&&(o.position.addInPlace(o._diffPosition),o.onCollide&&r&&o.onCollide(r))};n(i)},this.inputs=new e.FreeCameraInputsManager(this),this.inputs.addKeyboard().addMouse()}return __extends(i,t),Object.defineProperty(i.prototype,"angularSensibility",{get:function(){var e=this.inputs.attached.mouse;return e?e.angularSensibility:void 0},set:function(e){var t=this.inputs.attached.mouse;t&&(t.angularSensibility=e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"keysUp",{get:function(){var e=this.inputs.attached.keyboard;return e?e.keysUp:void 0},set:function(e){var t=this.inputs.attached.keyboard;t&&(t.keysUp=e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"keysDown",{get:function(){var e=this.inputs.attached.keyboard;return e?e.keysDown:void 0},set:function(e){var t=this.inputs.attached.keyboard;t&&(t.keysDown=e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"keysLeft",{get:function(){var e=this.inputs.attached.keyboard;return e?e.keysLeft:void 0},set:function(e){var t=this.inputs.attached.keyboard;t&&(t.keysLeft=e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"keysRight",{get:function(){var e=this.inputs.attached.keyboard;return e?e.keysRight:void 0},set:function(e){var t=this.inputs.attached.keyboard;t&&(t.keysRight=e)},enumerable:!0,configurable:!0}),i.prototype.attachControl=function(e,t){this.inputs.attachElement(e,t)},i.prototype.detachControl=function(t){this.inputs.detachElement(t),this.cameraDirection=new e.Vector3(0,0,0),this.cameraRotation=new e.Vector2(0,0)},i.prototype._collideWithWorld=function(t){var i;i=this.parent?e.Vector3.TransformCoordinates(this.position,this.parent.getWorldMatrix()):this.position,i.subtractFromFloatsToRef(0,this.ellipsoid.y,0,this._oldPosition),this._collider.radius=this.ellipsoid;var r=t;this.applyGravity&&(r=t.add(this.getScene().gravity)),this.getScene().collisionCoordinator.getNewPosition(this._oldPosition,r,this._collider,3,null,this._onCollisionPositionChange,this.uniqueId)},i.prototype._checkInputs=function(){this._localDirection||(this._localDirection=e.Vector3.Zero(),this._transformedDirection=e.Vector3.Zero()),this.inputs.checkInputs(),t.prototype._checkInputs.call(this)},i.prototype._decideIfNeedsToMove=function(){return this._needMoveForGravity||Math.abs(this.cameraDirection.x)>0||Math.abs(this.cameraDirection.y)>0||Math.abs(this.cameraDirection.z)>0},i.prototype._updatePosition=function(){this.checkCollisions&&this.getScene().collisionsEnabled?this._collideWithWorld(this.cameraDirection):this.position.addInPlace(this.cameraDirection)},i.prototype.dispose=function(){this.inputs.clear(),t.prototype.dispose.call(this)},i.prototype.getTypeName=function(){return"FreeCamera"},__decorate([e.serializeAsVector3()],i.prototype,"ellipsoid",void 0),__decorate([e.serialize()],i.prototype,"checkCollisions",void 0),__decorate([e.serialize()],i.prototype,"applyGravity",void 0),i}(e.TargetCamera);e.FreeCamera=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(e){t.call(this,e)}return __extends(i,t),i.prototype.addKeyboard=function(){return this.add(new e.FreeCameraKeyboardMoveInput),this},i.prototype.addMouse=function(t){return void 0===t&&(t=!0),this.add(new e.FreeCameraMouseInput(t)),this},i.prototype.addGamepad=function(){return this.add(new e.FreeCameraGamepadInput),this},i.prototype.addDeviceOrientation=function(){return this.add(new e.FreeCameraDeviceOrientationInput),this},i.prototype.addVRDeviceOrientation=function(){return this.add(new e.FreeCameraVRDeviceOrientationInput),this},i.prototype.addTouch=function(){return this.add(new e.FreeCameraTouchInput),this},i.prototype.addVirtualJoystick=function(){return this.add(new e.FreeCameraVirtualJoystickInput),this},i}(e.CameraInputsManager);e.FreeCameraInputsManager=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(e,i,r,n){t.call(this,e,i,r),this.radius=12,this.rotationOffset=0,this.heightOffset=4,this.cameraAcceleration=.05,this.maxCameraSpeed=20,this.target=n}return __extends(i,t),i.prototype.getRadians=function(e){return e*Math.PI/180},i.prototype.follow=function(t){if(t){var i;if(t.rotationQuaternion){var r=new e.Matrix;t.rotationQuaternion.toRotationMatrix(r),i=Math.atan2(r.m[8],r.m[10])}else i=t.rotation.y;var n=this.getRadians(this.rotationOffset)+i,o=t.position.x+Math.sin(n)*this.radius,s=t.position.z+Math.cos(n)*this.radius,a=o-this.position.x,h=t.position.y+this.heightOffset-this.position.y,c=s-this.position.z,l=a*this.cameraAcceleration*2,u=h*this.cameraAcceleration,f=c*this.cameraAcceleration*2;(l>this.maxCameraSpeed||l<-this.maxCameraSpeed)&&(l=1>l?-this.maxCameraSpeed:this.maxCameraSpeed),(u>this.maxCameraSpeed||u<-this.maxCameraSpeed)&&(u=1>u?-this.maxCameraSpeed:this.maxCameraSpeed),(f>this.maxCameraSpeed||f<-this.maxCameraSpeed)&&(f=1>f?-this.maxCameraSpeed:this.maxCameraSpeed),this.position=new e.Vector3(this.position.x+l,this.position.y+u,this.position.z+f),this.setTarget(t.position)}},i.prototype._checkInputs=function(){t.prototype._checkInputs.call(this),this.follow(this.target)},i.prototype.getTypeName=function(){return"FollowCamera"},__decorate([e.serialize()],i.prototype,"radius",void 0),__decorate([e.serialize()],i.prototype,"rotationOffset",void 0),__decorate([e.serialize()],i.prototype,"heightOffset",void 0),__decorate([e.serialize()],i.prototype,"cameraAcceleration",void 0),__decorate([e.serialize()],i.prototype,"maxCameraSpeed",void 0),__decorate([e.serializeAsMeshReference("lockedTargetId")],i.prototype,"target",void 0),i}(e.TargetCamera);e.FollowCamera=t;var i=function(t){function i(i,r,n,o,s,a){t.call(this,i,e.Vector3.Zero(),a),this.alpha=r,this.beta=n,this.radius=o,this.target=s,this._cartesianCoordinates=e.Vector3.Zero(),this.follow()}return __extends(i,t),i.prototype.follow=function(){this._cartesianCoordinates.x=this.radius*Math.cos(this.alpha)*Math.cos(this.beta),this._cartesianCoordinates.y=this.radius*Math.sin(this.beta),this._cartesianCoordinates.z=this.radius*Math.sin(this.alpha)*Math.cos(this.beta),this.position=this.target.position.add(this._cartesianCoordinates),this.setTarget(this.target.position)},i.prototype._checkInputs=function(){t.prototype._checkInputs.call(this),this.follow()},i.prototype.getTypeName=function(){return"ArcFollowCamera"},i}(e.TargetCamera);e.ArcFollowCamera=i}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(e){function t(t,i,r){e.call(this,t,i,r),this.inputs.addTouch(),this._setupInputs()}return __extends(t,e),Object.defineProperty(t.prototype,"touchAngularSensibility",{get:function(){var e=this.inputs.attached.touch;return e?e.touchAngularSensibility:void 0},set:function(e){var t=this.inputs.attached.touch;t&&(t.touchAngularSensibility=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"touchMoveSensibility",{get:function(){var e=this.inputs.attached.touch;return e?e.touchMoveSensibility:void 0},set:function(e){var t=this.inputs.attached.touch;t&&(t.touchMoveSensibility=e)},enumerable:!0,configurable:!0}),t.prototype.getTypeName=function(){return"TouchCamera"},t.prototype._setupInputs=function(){var e=this.inputs.attached.mouse;e&&(e.touchEnabled=!1)},t}(e.FreeCamera);e.TouchCamera=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(i,r,n,o,s,a){var h=this;t.call(this,i,e.Vector3.Zero(),a),this.inertialAlphaOffset=0,this.inertialBetaOffset=0,this.inertialRadiusOffset=0,this.lowerAlphaLimit=null,this.upperAlphaLimit=null,this.lowerBetaLimit=.01,this.upperBetaLimit=Math.PI,this.lowerRadiusLimit=null,this.upperRadiusLimit=null,this.inertialPanningX=0,this.inertialPanningY=0,this.zoomOnFactor=1,this.targetScreenOffset=e.Vector2.Zero(),this.allowUpsideDown=!0,this._viewMatrix=new e.Matrix,this.panningAxis=new e.Vector3(1,1,0),this.checkCollisions=!1,this.collisionRadius=new e.Vector3(.5,.5,.5),this._collider=new e.Collider,this._previousPosition=e.Vector3.Zero(),this._collisionVelocity=e.Vector3.Zero(),this._newPosition=e.Vector3.Zero(),this._onCollisionPositionChange=function(t,i,r){void 0===r&&(r=null),h.getScene().workerCollisions&&h.checkCollisions&&i.multiplyInPlace(h._collider.radius),r?(h.setPosition(i),h.onCollide&&h.onCollide(r)):h._previousPosition.copyFrom(h.position);var n=Math.cos(h.alpha),o=Math.sin(h.alpha),s=Math.cos(h.beta),a=Math.sin(h.beta);0===a&&(a=1e-4);var c=h._getTargetPosition();c.addToRef(new e.Vector3(h.radius*n*a,h.radius*s,h.radius*o*a),h._newPosition),h.position.copyFrom(h._newPosition);var l=h.upVector;h.allowUpsideDown&&h.beta<0&&(l=l.clone(),l=l.negate()),e.Matrix.LookAtLHToRef(h.position,c,l,h._viewMatrix),h._viewMatrix.m[12]+=h.targetScreenOffset.x,h._viewMatrix.m[13]+=h.targetScreenOffset.y,h._collisionTriggered=!1},s?this.target=s:this.target=e.Vector3.Zero(),this.alpha=r,this.beta=n,this.radius=o,this.getViewMatrix(),this.inputs=new e.ArcRotateCameraInputsManager(this),this.inputs.addKeyboard().addMouseWheel().addPointers().addGamepad()}return __extends(i,t),Object.defineProperty(i.prototype,"angularSensibilityX",{get:function(){var e=this.inputs.attached.pointers;return e?e.angularSensibilityX:void 0},set:function(e){var t=this.inputs.attached.pointers;t&&(t.angularSensibilityX=e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"angularSensibilityY",{get:function(){var e=this.inputs.attached.pointers;return e?e.angularSensibilityY:void 0},set:function(e){var t=this.inputs.attached.pointers;t&&(t.angularSensibilityY=e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"pinchPrecision",{get:function(){var e=this.inputs.attached.pointers;return e?e.pinchPrecision:void 0},set:function(e){var t=this.inputs.attached.pointers;t&&(t.pinchPrecision=e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"panningSensibility",{get:function(){var e=this.inputs.attached.pointers;return e?e.panningSensibility:void 0},set:function(e){var t=this.inputs.attached.pointers;t&&(t.panningSensibility=e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"keysUp",{get:function(){var e=this.inputs.attached.keyboard;return e?e.keysUp:void 0},set:function(e){var t=this.inputs.attached.keyboard;t&&(t.keysUp=e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"keysDown",{get:function(){var e=this.inputs.attached.keyboard;return e?e.keysDown:void 0},set:function(e){var t=this.inputs.attached.keyboard;t&&(t.keysDown=e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"keysLeft",{get:function(){var e=this.inputs.attached.keyboard;return e?e.keysLeft:void 0},set:function(e){var t=this.inputs.attached.keyboard;t&&(t.keysLeft=e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"keysRight",{get:function(){var e=this.inputs.attached.keyboard;return e?e.keysRight:void 0},set:function(e){var t=this.inputs.attached.keyboard;t&&(t.keysRight=e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"wheelPrecision",{get:function(){var e=this.inputs.attached.mousewheel;return e?e.wheelPrecision:void 0},set:function(e){var t=this.inputs.attached.mousewheel;t&&(t.wheelPrecision=e)},enumerable:!0,configurable:!0}),i.prototype._initCache=function(){t.prototype._initCache.call(this),this._cache.target=new e.Vector3(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.alpha=void 0,this._cache.beta=void 0,this._cache.radius=void 0,this._cache.targetScreenOffset=e.Vector2.Zero()},i.prototype._updateCache=function(e){e||t.prototype._updateCache.call(this),this._cache.target.copyFrom(this._getTargetPosition()),this._cache.alpha=this.alpha,this._cache.beta=this.beta,this._cache.radius=this.radius,this._cache.targetScreenOffset.copyFrom(this.targetScreenOffset)},i.prototype._getTargetPosition=function(){return this.target.getAbsolutePosition?this.target.getAbsolutePosition():this.target},i.prototype._isSynchronizedViewMatrix=function(){return t.prototype._isSynchronizedViewMatrix.call(this)?this._cache.target.equals(this.target)&&this._cache.alpha===this.alpha&&this._cache.beta===this.beta&&this._cache.radius===this.radius&&this._cache.targetScreenOffset.equals(this.targetScreenOffset):!1},i.prototype.attachControl=function(e,t,i){var r=this;void 0===i&&(i=!0),this._useCtrlForPanning=i,this.inputs.attachElement(e,t),this._reset=function(){r.inertialAlphaOffset=0,r.inertialBetaOffset=0,r.inertialRadiusOffset=0}},i.prototype.detachControl=function(e){this.inputs.detachElement(e),this._reset&&this._reset()},i.prototype._checkInputs=function(){this._collisionTriggered||(this.inputs.checkInputs(),0===this.inertialAlphaOffset&&0===this.inertialBetaOffset&&0===this.inertialRadiusOffset||(this.alpha+=this.beta<=0?-this.inertialAlphaOffset:this.inertialAlphaOffset,this.beta+=this.inertialBetaOffset,this.radius-=this.inertialRadiusOffset,this.inertialAlphaOffset*=this.inertia,this.inertialBetaOffset*=this.inertia,this.inertialRadiusOffset*=this.inertia,Math.abs(this.inertialAlphaOffset)<e.Epsilon&&(this.inertialAlphaOffset=0),Math.abs(this.inertialBetaOffset)<e.Epsilon&&(this.inertialBetaOffset=0),Math.abs(this.inertialRadiusOffset)<e.Epsilon&&(this.inertialRadiusOffset=0)),0===this.inertialPanningX&&0===this.inertialPanningY||(this._localDirection||(this._localDirection=e.Vector3.Zero(),this._transformedDirection=e.Vector3.Zero()),this.inertialPanningX*=this.inertia,this.inertialPanningY*=this.inertia,Math.abs(this.inertialPanningX)<e.Epsilon&&(this.inertialPanningX=0),Math.abs(this.inertialPanningY)<e.Epsilon&&(this.inertialPanningY=0),this._localDirection.copyFromFloats(this.inertialPanningX,this.inertialPanningY,this.inertialPanningY),this._localDirection.multiplyInPlace(this.panningAxis),this._viewMatrix.invertToRef(this._cameraTransformMatrix),e.Vector3.TransformNormalToRef(this._localDirection,this._cameraTransformMatrix,this._transformedDirection),this.panningAxis.y||(this._transformedDirection.y=0),this.target.getAbsolutePosition||this.target.addInPlace(this._transformedDirection)),this._checkLimits(),t.prototype._checkInputs.call(this))},i.prototype._checkLimits=function(){null===this.lowerBetaLimit||void 0===this.lowerBetaLimit?this.allowUpsideDown&&this.beta>Math.PI&&(this.beta=this.beta-2*Math.PI):this.beta<this.lowerBetaLimit&&(this.beta=this.lowerBetaLimit),null===this.upperBetaLimit||void 0===this.upperBetaLimit?this.allowUpsideDown&&this.beta<-Math.PI&&(this.beta=this.beta+2*Math.PI):this.beta>this.upperBetaLimit&&(this.beta=this.upperBetaLimit),this.lowerAlphaLimit&&this.alpha<this.lowerAlphaLimit&&(this.alpha=this.lowerAlphaLimit),this.upperAlphaLimit&&this.alpha>this.upperAlphaLimit&&(this.alpha=this.upperAlphaLimit),this.lowerRadiusLimit&&this.radius<this.lowerRadiusLimit&&(this.radius=this.lowerRadiusLimit),this.upperRadiusLimit&&this.radius>this.upperRadiusLimit&&(this.radius=this.upperRadiusLimit)},i.prototype.rebuildAnglesAndRadius=function(){var e=this.position.subtract(this._getTargetPosition());this.radius=e.length(),this.alpha=Math.acos(e.x/Math.sqrt(Math.pow(e.x,2)+Math.pow(e.z,2))),e.z<0&&(this.alpha=2*Math.PI-this.alpha),this.beta=Math.acos(e.y/this.radius),this._checkLimits()},i.prototype.setPosition=function(e){this.position.equals(e)||(this.position=e,this.rebuildAnglesAndRadius())},i.prototype.setTarget=function(e){this._getTargetPosition().equals(e)||(this.target=e,this.rebuildAnglesAndRadius())},i.prototype._getViewMatrix=function(){var t=Math.cos(this.alpha),i=Math.sin(this.alpha),r=Math.cos(this.beta),n=Math.sin(this.beta);0===n&&(n=1e-4);var o=this._getTargetPosition();if(o.addToRef(new e.Vector3(this.radius*t*n,this.radius*r,this.radius*i*n),this._newPosition),this.getScene().collisionsEnabled&&this.checkCollisions)this._collider.radius=this.collisionRadius,this._newPosition.subtractToRef(this.position,this._collisionVelocity),this._collisionTriggered=!0,this.getScene().collisionCoordinator.getNewPosition(this.position,this._collisionVelocity,this._collider,3,null,this._onCollisionPositionChange,this.uniqueId);else{this.position.copyFrom(this._newPosition);var s=this.upVector;this.allowUpsideDown&&this.beta<0&&(s=s.clone(),s=s.negate()),e.Matrix.LookAtLHToRef(this.position,o,s,this._viewMatrix),this._viewMatrix.m[12]+=this.targetScreenOffset.x,this._viewMatrix.m[13]+=this.targetScreenOffset.y}return this._viewMatrix},i.prototype.zoomOn=function(t,i){void 0===i&&(i=!1),t=t||this.getScene().meshes;var r=e.Mesh.MinMax(t),n=e.Vector3.Distance(r.min,r.max);this.radius=n*this.zoomOnFactor,this.focusOn({min:r.min,max:r.max,distance:n},i)},i.prototype.focusOn=function(t,i){void 0===i&&(i=!1);var r,n;void 0===t.min?(r=t||this.getScene().meshes,r=e.Mesh.MinMax(r),n=e.Vector3.Distance(r.min,r.max)):(r=t,n=t.distance),this.target=e.Mesh.Center(r),i||(this.maxZ=2*n)},i.prototype.createRigCamera=function(t,r){var n;switch(this.cameraRigMode){case e.Camera.RIG_MODE_STEREOSCOPIC_ANAGLYPH:case e.Camera.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:case e.Camera.RIG_MODE_STEREOSCOPIC_OVERUNDER:case e.Camera.RIG_MODE_VR:n=this._cameraRigParams.stereoHalfAngle*(0===r?1:-1);break;case e.Camera.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED:n=this._cameraRigParams.stereoHalfAngle*(0===r?-1:1)}var o=new i(t,this.alpha+n,this.beta,this.radius,this.target,this.getScene());return o._cameraRigParams={},o},i.prototype._updateRigCameras=function(){var i=this._rigCameras[0],r=this._rigCameras[1];switch(i.beta=r.beta=this.beta,i.radius=r.radius=this.radius,this.cameraRigMode){case e.Camera.RIG_MODE_STEREOSCOPIC_ANAGLYPH:case e.Camera.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:case e.Camera.RIG_MODE_STEREOSCOPIC_OVERUNDER:case e.Camera.RIG_MODE_VR:i.alpha=this.alpha-this._cameraRigParams.stereoHalfAngle,r.alpha=this.alpha+this._cameraRigParams.stereoHalfAngle;break;case e.Camera.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED:i.alpha=this.alpha+this._cameraRigParams.stereoHalfAngle,r.alpha=this.alpha-this._cameraRigParams.stereoHalfAngle}t.prototype._updateRigCameras.call(this)},i.prototype.dispose=function(){this.inputs.clear(),t.prototype.dispose.call(this)},i.prototype.getTypeName=function(){return"ArcRotateCamera"},__decorate([e.serialize()],i.prototype,"alpha",void 0),__decorate([e.serialize()],i.prototype,"beta",void 0),__decorate([e.serialize()],i.prototype,"radius",void 0),__decorate([e.serializeAsVector3()],i.prototype,"target",void 0),__decorate([e.serialize()],i.prototype,"inertialAlphaOffset",void 0),__decorate([e.serialize()],i.prototype,"inertialBetaOffset",void 0),__decorate([e.serialize()],i.prototype,"inertialRadiusOffset",void 0),__decorate([e.serialize()],i.prototype,"lowerAlphaLimit",void 0),__decorate([e.serialize()],i.prototype,"upperAlphaLimit",void 0),__decorate([e.serialize()],i.prototype,"lowerBetaLimit",void 0),__decorate([e.serialize()],i.prototype,"upperBetaLimit",void 0),__decorate([e.serialize()],i.prototype,"lowerRadiusLimit",void 0),__decorate([e.serialize()],i.prototype,"upperRadiusLimit",void 0),__decorate([e.serialize()],i.prototype,"inertialPanningX",void 0),__decorate([e.serialize()],i.prototype,"inertialPanningY",void 0),__decorate([e.serialize()],i.prototype,"zoomOnFactor",void 0),__decorate([e.serialize()],i.prototype,"allowUpsideDown",void 0),i}(e.TargetCamera);e.ArcRotateCamera=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(e){t.call(this,e)}return __extends(i,t),i.prototype.addMouseWheel=function(){return this.add(new e.ArcRotateCameraMouseWheelInput),this},i.prototype.addPointers=function(){return this.add(new e.ArcRotateCameraPointersInput),this},i.prototype.addKeyboard=function(){return this.add(new e.ArcRotateCameraKeyboardMoveInput),this},i.prototype.addGamepad=function(){return this.add(new e.ArcRotateCameraGamepadInput),this},i.prototype.addVRDeviceOrientation=function(){return this.add(new e.ArcRotateCameraVRDeviceOrientationInput),this},i}(e.CameraInputsManager);e.ArcRotateCameraInputsManager=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(e){this._renderingGroups=new Array,this._scene=e}return t.prototype._renderParticles=function(t,i){if(0!==this._scene._activeParticleSystems.length){for(var r=this._scene.activeCamera,n=e.Tools.Now,o=0;o<this._scene._activeParticleSystems.length;o++){var s=this._scene._activeParticleSystems.data[o];s.renderingGroupId===t&&0!==(r.layerMask&s.layerMask)&&(this._clearDepthBuffer(),s.emitter.position&&i&&-1===i.indexOf(s.emitter)||(this._scene._activeParticles+=s.render()))}this._scene._particlesDuration+=e.Tools.Now-n}},t.prototype._renderSprites=function(t){if(this._scene.spritesEnabled&&0!==this._scene.spriteManagers.length){for(var i=this._scene.activeCamera,r=e.Tools.Now,n=0;n<this._scene.spriteManagers.length;n++){var o=this._scene.spriteManagers[n];o.renderingGroupId===t&&0!==(i.layerMask&o.layerMask)&&(this._clearDepthBuffer(),o.render())}this._scene._spritesDuration+=e.Tools.Now-r}},t.prototype._clearDepthBuffer=function(){this._depthBufferAlreadyCleaned||(this._scene.getEngine().clear(0,!1,!0),this._depthBufferAlreadyCleaned=!0)},t.prototype._renderSpritesAndParticles=function(){this._currentRenderSprites&&this._renderSprites(this._currentIndex),this._currentRenderParticles&&this._renderParticles(this._currentIndex,this._currentActiveMeshes)},t.prototype.render=function(e,i,r,n){this._currentActiveMeshes=i,this._currentRenderParticles=r,this._currentRenderSprites=n;for(var o=0;o<t.MAX_RENDERINGGROUPS;o++){this._depthBufferAlreadyCleaned=0==o;var s=this._renderingGroups[o],a=!1;this._currentIndex=o,s?(this._clearDepthBuffer(),s.onBeforeTransparentRendering||(s.onBeforeTransparentRendering=this._renderSpritesAndParticles.bind(this)),s.render(e)||(this._renderingGroups.splice(o,1),a=!0,this._renderSpritesAndParticles())):this._renderSpritesAndParticles(),a&&o--}},t.prototype.reset=function(){this._renderingGroups.forEach(function(e,t,i){e&&e.prepare()})},t.prototype.dispatch=function(t){var i=t.getMesh(),r=i.renderingGroupId||0;this._renderingGroups[r]||(this._renderingGroups[r]=new e.RenderingGroup(r,this._scene)),this._renderingGroups[r].dispatch(t)},t.MAX_RENDERINGGROUPS=4,t}();e.RenderingManager=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(t,i){this.index=t,this._opaqueSubMeshes=new e.SmartArray(256),this._transparentSubMeshes=new e.SmartArray(256),this._alphaTestSubMeshes=new e.SmartArray(256),this._scene=i}return t.prototype.render=function(t){
if(t)return t(this._opaqueSubMeshes,this._alphaTestSubMeshes,this._transparentSubMeshes),!0;if(0===this._opaqueSubMeshes.length&&0===this._alphaTestSubMeshes.length&&0===this._transparentSubMeshes.length)return this.onBeforeTransparentRendering&&this.onBeforeTransparentRendering(),!1;var i,r,n=this._scene.getEngine();for(i=0;i<this._opaqueSubMeshes.length;i++)r=this._opaqueSubMeshes.data[i],r.render(!1);for(n.setAlphaTesting(!0),i=0;i<this._alphaTestSubMeshes.length;i++)r=this._alphaTestSubMeshes.data[i],r.render(!1);if(n.setAlphaTesting(!1),this.onBeforeTransparentRendering&&this.onBeforeTransparentRendering(),this._transparentSubMeshes.length){for(i=0;i<this._transparentSubMeshes.length;i++)r=this._transparentSubMeshes.data[i],r._alphaIndex=r.getMesh().alphaIndex,r._distanceToCamera=r.getBoundingInfo().boundingSphere.centerWorld.subtract(this._scene.activeCamera.globalPosition).length();var o=this._transparentSubMeshes.data.slice(0,this._transparentSubMeshes.length);for(o.sort(function(e,t){return e._alphaIndex>t._alphaIndex?1:e._alphaIndex<t._alphaIndex?-1:e._distanceToCamera<t._distanceToCamera?1:e._distanceToCamera>t._distanceToCamera?-1:0}),i=0;i<o.length;i++)r=o[i],r.render(!0);n.setAlphaMode(e.Engine.ALPHA_DISABLE)}return!0},t.prototype.prepare=function(){this._opaqueSubMeshes.reset(),this._transparentSubMeshes.reset(),this._alphaTestSubMeshes.reset()},t.prototype.dispatch=function(e){var t=e.getMaterial(),i=e.getMesh();t.needAlphaBlending()||i.visibility<1||i.hasVertexAlpha?this._transparentSubMeshes.push(e):t.needAlphaTesting()?this._alphaTestSubMeshes.push(e):this._opaqueSubMeshes.push(e)},t}();e.RenderingGroup=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function e(){}return Object.defineProperty(e,"POINTERDOWN",{get:function(){return e._POINTERDOWN},enumerable:!0,configurable:!0}),Object.defineProperty(e,"POINTERUP",{get:function(){return e._POINTERUP},enumerable:!0,configurable:!0}),Object.defineProperty(e,"POINTERMOVE",{get:function(){return e._POINTERMOVE},enumerable:!0,configurable:!0}),Object.defineProperty(e,"POINTERWHEEL",{get:function(){return e._POINTERWHEEL},enumerable:!0,configurable:!0}),Object.defineProperty(e,"POINTERPICK",{get:function(){return e._POINTERPICK},enumerable:!0,configurable:!0}),e._POINTERDOWN=1,e._POINTERUP=2,e._POINTERMOVE=4,e._POINTERWHEEL=8,e._POINTERPICK=16,e}();e.PointerEventTypes=t;var i=function(){function e(e,t){this.type=e,this.event=t}return e}();e.PointerInfoBase=i;var r=function(t){function i(i,r,n,o){t.call(this,i,r),this.skipOnPointerObservable=!1,this.localPosition=new e.Vector2(n,o)}return __extends(i,t),i}(i);e.PointerInfoPre=r;var n=function(e){function t(t,i,r){e.call(this,t,i),this.pickInfo=r}return __extends(t,e),t}(i);e.PointerInfo=n;var o=function(){function i(t){this.autoClear=!0,this.clearColor=new e.Color3(.2,.2,.3),this.ambientColor=new e.Color3(0,0,0),this.forceWireframe=!1,this.forcePointsCloud=!1,this.forceShowBoundingBoxes=!1,this.animationsEnabled=!0,this.constantlyUpdateMeshUnderPointer=!1,this.onDisposeObservable=new e.Observable,this.onBeforeRenderObservable=new e.Observable,this.onAfterRenderObservable=new e.Observable,this.onReadyObservable=new e.Observable,this.onBeforeCameraRenderObservable=new e.Observable,this.onAfterCameraRenderObservable=new e.Observable,this.onNewCameraAddedObservable=new e.Observable,this.onCameraRemovedObservable=new e.Observable,this.onNewLightAddedObservable=new e.Observable,this.onLightRemovedObservable=new e.Observable,this.onNewGeometryAddedObservable=new e.Observable,this.onGeometryRemovedObservable=new e.Observable,this.onNewMeshAddedObservable=new e.Observable,this.onMeshRemovedObservable=new e.Observable,this.animations=[],this.onPrePointerObservable=new e.Observable,this.onPointerObservable=new e.Observable,this.cameraToUseForPointers=null,this._startingPointerPosition=new e.Vector2(0,0),this._startingPointerTime=0,this.fogEnabled=!0,this.fogMode=i.FOGMODE_NONE,this.fogColor=new e.Color3(.2,.2,.3),this.fogDensity=.1,this.fogStart=0,this.fogEnd=1e3,this.shadowsEnabled=!0,this.lightsEnabled=!0,this.lights=new Array,this.cameras=new Array,this.activeCameras=new Array,this.meshes=new Array,this._geometries=new Array,this.materials=new Array,this.multiMaterials=new Array,this.defaultMaterial=new e.StandardMaterial("default material",this),this.texturesEnabled=!0,this.textures=new Array,this.particlesEnabled=!0,this.particleSystems=new Array,this.spritesEnabled=!0,this.spriteManagers=new Array,this.layers=new Array,this.skeletonsEnabled=!0,this.skeletons=new Array,this.lensFlaresEnabled=!0,this.lensFlareSystems=new Array,this.collisionsEnabled=!0,this.gravity=new e.Vector3(0,-9.807,0),this.postProcessesEnabled=!0,this.renderTargetsEnabled=!0,this.dumpNextRenderTargets=!1,this.customRenderTargets=new Array,this.importedMeshesFiles=new Array,this.probesEnabled=!0,this.reflectionProbes=new Array,this._actionManagers=new Array,this._meshesForIntersections=new e.SmartArray(256),this.proceduralTexturesEnabled=!0,this._proceduralTextures=new Array,this.soundTracks=new Array,this._audioEnabled=!0,this._headphone=!1,this._totalVertices=0,this._activeIndices=0,this._activeParticles=0,this._lastFrameDuration=0,this._evaluateActiveMeshesDuration=0,this._renderTargetsDuration=0,this._particlesDuration=0,this._renderDuration=0,this._spritesDuration=0,this._animationRatio=0,this._renderId=0,this._executeWhenReadyTimeoutId=-1,this._intermediateRendering=!1,this._toBeDisposed=new e.SmartArray(256),this._pendingData=[],this._activeMeshes=new e.SmartArray(256),this._processedMaterials=new e.SmartArray(256),this._renderTargets=new e.SmartArray(256),this._activeParticleSystems=new e.SmartArray(256),this._activeSkeletons=new e.SmartArray(32),this._softwareSkinnedMeshes=new e.SmartArray(32),this._activeBones=0,this._activeAnimatables=new Array,this._transformMatrix=e.Matrix.Zero(),this._edgesRenderers=new e.SmartArray(16),this._uniqueIdCounter=0,this._engine=t,t.scenes.push(this),this._renderingManager=new e.RenderingManager(this),this.postProcessManager=new e.PostProcessManager(this),this.postProcessRenderPipelineManager=new e.PostProcessRenderPipelineManager,this._boundingBoxRenderer=new e.BoundingBoxRenderer(this),e.OutlineRenderer&&(this._outlineRenderer=new e.OutlineRenderer(this)),this.attachControl(),e.SoundTrack&&(this.mainSoundTrack=new e.SoundTrack(this,{mainTrack:!0})),e.SimplificationQueue&&(this.simplificationQueue=new e.SimplificationQueue),this.workerCollisions=!1}return Object.defineProperty(i,"FOGMODE_NONE",{get:function(){return i._FOGMODE_NONE},enumerable:!0,configurable:!0}),Object.defineProperty(i,"FOGMODE_EXP",{get:function(){return i._FOGMODE_EXP},enumerable:!0,configurable:!0}),Object.defineProperty(i,"FOGMODE_EXP2",{get:function(){return i._FOGMODE_EXP2},enumerable:!0,configurable:!0}),Object.defineProperty(i,"FOGMODE_LINEAR",{get:function(){return i._FOGMODE_LINEAR},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"onDispose",{set:function(e){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"beforeRender",{set:function(e){this._onBeforeRenderObserver&&this.onBeforeRenderObservable.remove(this._onBeforeRenderObserver),this._onBeforeRenderObserver=this.onBeforeRenderObservable.add(e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"afterRender",{set:function(e){this._onAfterRenderObserver&&this.onAfterRenderObservable.remove(this._onAfterRenderObserver),this._onAfterRenderObserver=this.onAfterRenderObservable.add(e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"beforeCameraRender",{set:function(e){this._onBeforeCameraRenderObserver&&this.onBeforeCameraRenderObservable.remove(this._onBeforeCameraRenderObserver),this._onBeforeCameraRenderObserver=this.onBeforeCameraRenderObservable.add(e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"afterCameraRender",{set:function(e){this._onAfterCameraRenderObserver&&this.onAfterCameraRenderObservable.remove(this._onAfterCameraRenderObserver),this._onAfterCameraRenderObserver=this.onAfterCameraRenderObservable.add(e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"unTranslatedPointer",{get:function(){return new e.Vector2(this._unTranslatedPointerX,this._unTranslatedPointerY)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"debugLayer",{get:function(){return this._debugLayer||(this._debugLayer=new e.DebugLayer(this)),this._debugLayer},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"workerCollisions",{get:function(){return this._workerCollisions},set:function(t){t=t&&!!Worker,this._workerCollisions=t,this.collisionCoordinator&&this.collisionCoordinator.destroy(),this.collisionCoordinator=t?new e.CollisionCoordinatorWorker:new e.CollisionCoordinatorLegacy,this.collisionCoordinator.init(this)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"SelectionOctree",{get:function(){return this._selectionOctree},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"meshUnderPointer",{get:function(){return this._pointerOverMesh},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"pointerX",{get:function(){return this._pointerX},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"pointerY",{get:function(){return this._pointerY},enumerable:!0,configurable:!0}),i.prototype.getCachedMaterial=function(){return this._cachedMaterial},i.prototype.getBoundingBoxRenderer=function(){return this._boundingBoxRenderer},i.prototype.getOutlineRenderer=function(){return this._outlineRenderer},i.prototype.getEngine=function(){return this._engine},i.prototype.getTotalVertices=function(){return this._totalVertices},i.prototype.getActiveIndices=function(){return this._activeIndices},i.prototype.getActiveParticles=function(){return this._activeParticles},i.prototype.getActiveBones=function(){return this._activeBones},i.prototype.getLastFrameDuration=function(){return this._lastFrameDuration},i.prototype.getEvaluateActiveMeshesDuration=function(){return this._evaluateActiveMeshesDuration},i.prototype.getActiveMeshes=function(){return this._activeMeshes},i.prototype.getRenderTargetsDuration=function(){return this._renderTargetsDuration},i.prototype.getRenderDuration=function(){return this._renderDuration},i.prototype.getParticlesDuration=function(){return this._particlesDuration},i.prototype.getSpritesDuration=function(){return this._spritesDuration},i.prototype.getAnimationRatio=function(){return this._animationRatio},i.prototype.getRenderId=function(){return this._renderId},i.prototype.incrementRenderId=function(){this._renderId++},i.prototype._updatePointerPosition=function(e){var t=this._engine.getRenderingCanvasClientRect();this._pointerX=e.clientX-t.left,this._pointerY=e.clientY-t.top,this._unTranslatedPointerX=this._pointerX,this._unTranslatedPointerY=this._pointerY,this.cameraToUseForPointers&&(this._pointerX=this._pointerX-this.cameraToUseForPointers.viewport.x*this._engine.getRenderWidth(),this._pointerY=this._pointerY-this.cameraToUseForPointers.viewport.y*this._engine.getRenderHeight())},i.prototype.attachControl=function(i,o,s){var a=this;void 0===i&&(i=!0),void 0===o&&(o=!0),void 0===s&&(s=!0);var h=function(e){return e.isPickable&&e.actionManager&&e.actionManager.hasPointerTriggers};this._onPointerMove=function(e){if(a._updatePointerPosition(e),a.onPrePointerObservable.hasObservers()){var i="mousewheel"===e.type||"DOMMouseScroll"===e.type?t.POINTERWHEEL:t.POINTERMOVE,o=new r(i,e,a._unTranslatedPointerX,a._unTranslatedPointerY);if(a.onPrePointerObservable.notifyObservers(o,i),o.skipOnPointerObservable)return}if(a.cameraToUseForPointers||a.activeCamera){var s=a._engine.getRenderingCanvas();a.pointerMovePredicate||(a.pointerMovePredicate=function(e){return e.isPickable&&e.isVisible&&e.isReady()&&(a.constantlyUpdateMeshUnderPointer||null!==e.actionManager&&void 0!==e.actionManager)});var c=a.pick(a._unTranslatedPointerX,a._unTranslatedPointerY,a.pointerMovePredicate,!1,a.cameraToUseForPointers);if(c.hit&&c.pickedMesh?(a.setPointerOverSprite(null),a.setPointerOverMesh(c.pickedMesh),a._pointerOverMesh.actionManager&&a._pointerOverMesh.actionManager.hasPointerTriggers?s.style.cursor="pointer":s.style.cursor=""):(a.setPointerOverMesh(null),c=a.pickSprite(a._unTranslatedPointerX,a._unTranslatedPointerY,h,!1,a.cameraToUseForPointers),c.hit&&c.pickedSprite?(s.style.cursor="pointer",a.setPointerOverSprite(c.pickedSprite)):(a.setPointerOverSprite(null),s.style.cursor="")),a.onPointerMove&&a.onPointerMove(e,c),a.onPointerObservable.hasObservers()){var i="mousewheel"===e.type||"DOMMouseScroll"===e.type?t.POINTERWHEEL:t.POINTERMOVE,o=new n(i,e,c);a.onPointerObservable.notifyObservers(o,i)}}},this._onPointerDown=function(i){if(a._updatePointerPosition(i),a.onPrePointerObservable.hasObservers()){var o=t.POINTERDOWN,s=new r(o,i,a._unTranslatedPointerX,a._unTranslatedPointerY);if(a.onPrePointerObservable.notifyObservers(s,o),s.skipOnPointerObservable)return}if(a.cameraToUseForPointers||a.activeCamera){a._startingPointerPosition.x=a._pointerX,a._startingPointerPosition.y=a._pointerY,a._startingPointerTime=(new Date).getTime(),a.pointerDownPredicate||(a.pointerDownPredicate=function(e){return e.isPickable&&e.isVisible&&e.isReady()&&(!e.actionManager||e.actionManager.hasPointerTriggers)}),a._pickedDownMesh=null;var c=a.pick(a._unTranslatedPointerX,a._unTranslatedPointerY,a.pointerDownPredicate,!1,a.cameraToUseForPointers);if(c.hit&&c.pickedMesh&&c.pickedMesh.actionManager){if(a._pickedDownMesh=c.pickedMesh,c.pickedMesh.actionManager.hasPickTriggers){switch(i.button){case 0:c.pickedMesh.actionManager.processTrigger(e.ActionManager.OnLeftPickTrigger,e.ActionEvent.CreateNew(c.pickedMesh,i));break;case 1:c.pickedMesh.actionManager.processTrigger(e.ActionManager.OnCenterPickTrigger,e.ActionEvent.CreateNew(c.pickedMesh,i));break;case 2:c.pickedMesh.actionManager.processTrigger(e.ActionManager.OnRightPickTrigger,e.ActionEvent.CreateNew(c.pickedMesh,i))}c.pickedMesh.actionManager.processTrigger(e.ActionManager.OnPickDownTrigger,e.ActionEvent.CreateNew(c.pickedMesh,i))}if(c.pickedMesh.actionManager.hasSpecificTrigger(e.ActionManager.OnLongPressTrigger)){var l=a;window.setTimeout(function(){var t=l.pick(l._unTranslatedPointerX,l._unTranslatedPointerY,function(t){return t.isPickable&&t.isVisible&&t.isReady()&&t.actionManager&&t.actionManager.hasSpecificTrigger(e.ActionManager.OnLongPressTrigger)},!1,l.cameraToUseForPointers);t.hit&&t.pickedMesh&&t.pickedMesh.actionManager&&0!==l._startingPointerTime&&(new Date).getTime()-l._startingPointerTime>e.ActionManager.LongPressDelay&&Math.abs(l._startingPointerPosition.x-l._pointerX)<e.ActionManager.DragMovementThreshold&&Math.abs(l._startingPointerPosition.y-l._pointerY)<e.ActionManager.DragMovementThreshold&&(l._startingPointerTime=0,t.pickedMesh.actionManager.processTrigger(e.ActionManager.OnLongPressTrigger,e.ActionEvent.CreateNew(t.pickedMesh,i)))},e.ActionManager.LongPressDelay)}}if(a.onPointerDown&&a.onPointerDown(i,c),a.onPointerObservable.hasObservers()){var o=t.POINTERDOWN,s=new n(o,i,c);a.onPointerObservable.notifyObservers(s,o)}if(a._pickedDownSprite=null,a.spriteManagers.length>0&&(c=a.pickSprite(a._unTranslatedPointerX,a._unTranslatedPointerY,h,!1,a.cameraToUseForPointers),c.hit&&c.pickedSprite&&c.pickedSprite.actionManager)){switch(a._pickedDownSprite=c.pickedSprite,i.button){case 0:c.pickedSprite.actionManager.processTrigger(e.ActionManager.OnLeftPickTrigger,e.ActionEvent.CreateNewFromSprite(c.pickedSprite,a,i));break;case 1:c.pickedSprite.actionManager.processTrigger(e.ActionManager.OnCenterPickTrigger,e.ActionEvent.CreateNewFromSprite(c.pickedSprite,a,i));break;case 2:c.pickedSprite.actionManager.processTrigger(e.ActionManager.OnRightPickTrigger,e.ActionEvent.CreateNewFromSprite(c.pickedSprite,a,i))}c.pickedSprite.actionManager.processTrigger(e.ActionManager.OnPickDownTrigger,e.ActionEvent.CreateNewFromSprite(c.pickedSprite,a,i))}}},this._onPointerUp=function(i){if(a._updatePointerPosition(i),a.onPrePointerObservable.hasObservers()){var o=t.POINTERUP,s=new r(o,i,a._unTranslatedPointerX,a._unTranslatedPointerY);if(a.onPrePointerObservable.notifyObservers(s,o),s.skipOnPointerObservable)return}if(a.cameraToUseForPointers||a.activeCamera){a.pointerUpPredicate||(a.pointerUpPredicate=function(t){return t.isPickable&&t.isVisible&&t.isReady()&&(!t.actionManager||t.actionManager.hasPickTriggers||t.actionManager.hasSpecificTrigger(e.ActionManager.OnLongPressTrigger))});var c=a.pick(a._unTranslatedPointerX,a._unTranslatedPointerY,a.pointerUpPredicate,!1,a.cameraToUseForPointers);if(c.hit&&c.pickedMesh){if(null!=a._pickedDownMesh&&c.pickedMesh==a._pickedDownMesh&&(a.onPointerPick&&a.onPointerPick(i,c),a.onPointerObservable.hasObservers())){var o=t.POINTERPICK,s=new n(o,i,c);a.onPointerObservable.notifyObservers(s,o)}c.pickedMesh.actionManager&&(c.pickedMesh.actionManager.processTrigger(e.ActionManager.OnPickUpTrigger,e.ActionEvent.CreateNew(c.pickedMesh,i)),Math.abs(a._startingPointerPosition.x-a._pointerX)<e.ActionManager.DragMovementThreshold&&Math.abs(a._startingPointerPosition.y-a._pointerY)<e.ActionManager.DragMovementThreshold&&c.pickedMesh.actionManager.processTrigger(e.ActionManager.OnPickTrigger,e.ActionEvent.CreateNew(c.pickedMesh,i)))}if(a._pickedDownMesh&&a._pickedDownMesh!==c.pickedMesh&&a._pickedDownMesh.actionManager.processTrigger(e.ActionManager.OnPickOutTrigger,e.ActionEvent.CreateNew(a._pickedDownMesh,i)),a.onPointerUp&&a.onPointerUp(i,c),a.onPointerObservable.hasObservers()){var o=t.POINTERUP,s=new n(o,i,c);a.onPointerObservable.notifyObservers(s,o)}a._startingPointerTime=0,a.spriteManagers.length>0&&(c=a.pickSprite(a._unTranslatedPointerX,a._unTranslatedPointerY,h,!1,a.cameraToUseForPointers),c.hit&&c.pickedSprite&&c.pickedSprite.actionManager&&(c.pickedSprite.actionManager.processTrigger(e.ActionManager.OnPickUpTrigger,e.ActionEvent.CreateNewFromSprite(c.pickedSprite,a,i)),Math.abs(a._startingPointerPosition.x-a._pointerX)<e.ActionManager.DragMovementThreshold&&Math.abs(a._startingPointerPosition.y-a._pointerY)<e.ActionManager.DragMovementThreshold&&c.pickedSprite.actionManager.processTrigger(e.ActionManager.OnPickTrigger,e.ActionEvent.CreateNewFromSprite(c.pickedSprite,a,i))),a._pickedDownSprite&&a._pickedDownSprite!==c.pickedSprite&&a._pickedDownSprite.actionManager.processTrigger(e.ActionManager.OnPickOutTrigger,e.ActionEvent.CreateNewFromSprite(a._pickedDownSprite,a,i)))}},this._onKeyDown=function(t){a.actionManager&&a.actionManager.processTrigger(e.ActionManager.OnKeyDownTrigger,e.ActionEvent.CreateNewFromScene(a,t))},this._onKeyUp=function(t){a.actionManager&&a.actionManager.processTrigger(e.ActionManager.OnKeyUpTrigger,e.ActionEvent.CreateNewFromScene(a,t))};var c=e.Tools.GetPointerPrefix();s&&(this._engine.getRenderingCanvas().addEventListener(c+"move",this._onPointerMove,!1),this._engine.getRenderingCanvas().addEventListener("mousewheel",this._onPointerMove,!1),this._engine.getRenderingCanvas().addEventListener("DOMMouseScroll",this._onPointerMove,!1)),o&&this._engine.getRenderingCanvas().addEventListener(c+"down",this._onPointerDown,!1),i&&this._engine.getRenderingCanvas().addEventListener(c+"up",this._onPointerUp,!1),e.Tools.RegisterTopRootEvents([{name:"keydown",handler:this._onKeyDown},{name:"keyup",handler:this._onKeyUp}])},i.prototype.detachControl=function(){var t=e.Tools.GetPointerPrefix();this._engine.getRenderingCanvas().removeEventListener(t+"move",this._onPointerMove),this._engine.getRenderingCanvas().removeEventListener(t+"down",this._onPointerDown),this._engine.getRenderingCanvas().removeEventListener(t+"up",this._onPointerUp),this._engine.getRenderingCanvas().removeEventListener("mousewheel",this._onPointerMove),this._engine.getRenderingCanvas().removeEventListener("DOMMouseScroll",this._onPointerMove),e.Tools.UnregisterTopRootEvents([{name:"keydown",handler:this._onKeyDown},{name:"keyup",handler:this._onKeyUp}])},i.prototype.isReady=function(){if(this._pendingData.length>0)return!1;var t;for(t=0;t<this._geometries.length;t++){var i=this._geometries[t];if(i.delayLoadState===e.Engine.DELAYLOADSTATE_LOADING)return!1}for(t=0;t<this.meshes.length;t++){var r=this.meshes[t];if(!r.isReady())return!1;var n=r.material;if(n&&!n.isReady(r))return!1}return!0},i.prototype.resetCachedMaterial=function(){this._cachedMaterial=null},i.prototype.registerBeforeRender=function(e){this.onBeforeRenderObservable.add(e)},i.prototype.unregisterBeforeRender=function(e){this.onBeforeRenderObservable.removeCallback(e)},i.prototype.registerAfterRender=function(e){this.onAfterRenderObservable.add(e)},i.prototype.unregisterAfterRender=function(e){this.onAfterRenderObservable.removeCallback(e)},i.prototype._addPendingData=function(e){this._pendingData.push(e)},i.prototype._removePendingData=function(e){var t=this._pendingData.indexOf(e);-1!==t&&this._pendingData.splice(t,1)},i.prototype.getWaitingItemsCount=function(){return this._pendingData.length},i.prototype.executeWhenReady=function(e){var t=this;this.onReadyObservable.add(e),-1===this._executeWhenReadyTimeoutId&&(this._executeWhenReadyTimeoutId=setTimeout(function(){t._checkIsReady()},150))},i.prototype._checkIsReady=function(){var e=this;return this.isReady()?(this.onReadyObservable.notifyObservers(this),this.onReadyObservable.clear(),void(this._executeWhenReadyTimeoutId=-1)):void(this._executeWhenReadyTimeoutId=setTimeout(function(){e._checkIsReady()},150))},i.prototype.beginAnimation=function(t,i,r,n,o,s,a){if(void 0===o&&(o=1),this.stopAnimation(t),a||(a=new e.Animatable(this,t,i,r,n,o,s)),t.animations&&a.appendAnimations(t,t.animations),t.getAnimatables)for(var h=t.getAnimatables(),c=0;c<h.length;c++)this.beginAnimation(h[c],i,r,n,o,s,a);return a.reset(),a},i.prototype.beginDirectAnimation=function(t,i,r,n,o,s,a){void 0===s&&(s=1);var h=new e.Animatable(this,t,r,n,o,s,a,i);return h},i.prototype.getAnimatableByTarget=function(e){for(var t=0;t<this._activeAnimatables.length;t++)if(this._activeAnimatables[t].target===e)return this._activeAnimatables[t];return null},Object.defineProperty(i.prototype,"Animatables",{get:function(){return this._activeAnimatables},enumerable:!0,configurable:!0}),i.prototype.stopAnimation=function(e){var t=this.getAnimatableByTarget(e);t&&t.stop()},i.prototype._animate=function(){if(this.animationsEnabled&&0!==this._activeAnimatables.length){if(!this._animationStartDate){if(this._pendingData.length>0)return;this._animationStartDate=e.Tools.Now}for(var t=e.Tools.Now,i=t-this._animationStartDate,r=0;r<this._activeAnimatables.length;r++)this._activeAnimatables[r]._animate(i)}},i.prototype.getViewMatrix=function(){return this._viewMatrix},i.prototype.getProjectionMatrix=function(){return this._projectionMatrix},i.prototype.getTransformMatrix=function(){return this._transformMatrix},i.prototype.setTransformMatrix=function(e,t){this._viewMatrix=e,this._projectionMatrix=t,this._viewMatrix.multiplyToRef(this._projectionMatrix,this._transformMatrix)},i.prototype.addMesh=function(e){e.uniqueId=this._uniqueIdCounter++;this.meshes.push(e);this.collisionCoordinator.onMeshAdded(e),this.onNewMeshAddedObservable.notifyObservers(e)},i.prototype.removeMesh=function(e){var t=this.meshes.indexOf(e);return-1!==t&&this.meshes.splice(t,1),this.collisionCoordinator.onMeshRemoved(e),this.onMeshRemovedObservable.notifyObservers(e),t},i.prototype.removeSkeleton=function(e){var t=this.skeletons.indexOf(e);return-1!==t&&this.skeletons.splice(t,1),t},i.prototype.removeLight=function(e){var t=this.lights.indexOf(e);return-1!==t&&this.lights.splice(t,1),this.onLightRemovedObservable.notifyObservers(e),t},i.prototype.removeCamera=function(e){var t=this.cameras.indexOf(e);-1!==t&&this.cameras.splice(t,1);var i=this.activeCameras.indexOf(e);return-1!==i&&this.activeCameras.splice(i,1),this.activeCamera===e&&(this.cameras.length>0?this.activeCamera=this.cameras[0]:this.activeCamera=null),this.onCameraRemovedObservable.notifyObservers(e),t},i.prototype.addLight=function(e){e.uniqueId=this._uniqueIdCounter++;this.lights.push(e);this.onNewLightAddedObservable.notifyObservers(e)},i.prototype.addCamera=function(e){e.uniqueId=this._uniqueIdCounter++;this.cameras.push(e);this.onNewCameraAddedObservable.notifyObservers(e)},i.prototype.swithActiveCamera=function(e,t){void 0===t&&(t=!0);var i=this._engine.getRenderingCanvas();this.activeCamera.detachControl(i),this.activeCamera=e,t&&e.attachControl(i)},i.prototype.setActiveCameraByID=function(e){var t=this.getCameraByID(e);return t?(this.activeCamera=t,t):null},i.prototype.setActiveCameraByName=function(e){var t=this.getCameraByName(e);return t?(this.activeCamera=t,t):null},i.prototype.getMaterialByID=function(e){for(var t=0;t<this.materials.length;t++)if(this.materials[t].id===e)return this.materials[t];return null},i.prototype.getMaterialByName=function(e){for(var t=0;t<this.materials.length;t++)if(this.materials[t].name===e)return this.materials[t];return null},i.prototype.getLensFlareSystemByName=function(e){for(var t=0;t<this.lensFlareSystems.length;t++)if(this.lensFlareSystems[t].name===e)return this.lensFlareSystems[t];return null},i.prototype.getLensFlareSystemByID=function(e){for(var t=0;t<this.lensFlareSystems.length;t++)if(this.lensFlareSystems[t].id===e)return this.lensFlareSystems[t];return null},i.prototype.getCameraByID=function(e){for(var t=0;t<this.cameras.length;t++)if(this.cameras[t].id===e)return this.cameras[t];return null},i.prototype.getCameraByUniqueID=function(e){for(var t=0;t<this.cameras.length;t++)if(this.cameras[t].uniqueId===e)return this.cameras[t];return null},i.prototype.getCameraByName=function(e){for(var t=0;t<this.cameras.length;t++)if(this.cameras[t].name===e)return this.cameras[t];return null},i.prototype.getBoneByID=function(e){for(var t=0;t<this.skeletons.length;t++)for(var i=this.skeletons[t],r=0;r<i.bones.length;r++)if(i.bones[r].id===e)return i.bones[r];return null},i.prototype.getBoneByName=function(e){for(var t=0;t<this.skeletons.length;t++)for(var i=this.skeletons[t],r=0;r<i.bones.length;r++)if(i.bones[r].name===e)return i.bones[r];return null},i.prototype.getLightByName=function(e){for(var t=0;t<this.lights.length;t++)if(this.lights[t].name===e)return this.lights[t];return null},i.prototype.getLightByID=function(e){for(var t=0;t<this.lights.length;t++)if(this.lights[t].id===e)return this.lights[t];return null},i.prototype.getLightByUniqueID=function(e){for(var t=0;t<this.lights.length;t++)if(this.lights[t].uniqueId===e)return this.lights[t];return null},i.prototype.getParticleSystemByID=function(e){for(var t=0;t<this.particleSystems.length;t++)if(this.particleSystems[t].id===e)return this.particleSystems[t];return null},i.prototype.getGeometryByID=function(e){for(var t=0;t<this._geometries.length;t++)if(this._geometries[t].id===e)return this._geometries[t];return null},i.prototype.pushGeometry=function(e,t){return!t&&this.getGeometryByID(e.id)?!1:(this._geometries.push(e),this.collisionCoordinator.onGeometryAdded(e),this.onNewGeometryAddedObservable.notifyObservers(e),!0)},i.prototype.removeGeometry=function(e){var t=this._geometries.indexOf(e);return t>-1?(this._geometries.splice(t,1),this.collisionCoordinator.onGeometryDeleted(e),this.onGeometryRemovedObservable.notifyObservers(e),!0):!1},i.prototype.getGeometries=function(){return this._geometries},i.prototype.getMeshByID=function(e){for(var t=0;t<this.meshes.length;t++)if(this.meshes[t].id===e)return this.meshes[t];return null},i.prototype.getMeshesByID=function(e){return this.meshes.filter(function(t){return t.id===e})},i.prototype.getMeshByUniqueID=function(e){for(var t=0;t<this.meshes.length;t++)if(this.meshes[t].uniqueId===e)return this.meshes[t];return null},i.prototype.getLastMeshByID=function(e){for(var t=this.meshes.length-1;t>=0;t--)if(this.meshes[t].id===e)return this.meshes[t];return null},i.prototype.getLastEntryByID=function(e){var t;for(t=this.meshes.length-1;t>=0;t--)if(this.meshes[t].id===e)return this.meshes[t];for(t=this.cameras.length-1;t>=0;t--)if(this.cameras[t].id===e)return this.cameras[t];for(t=this.lights.length-1;t>=0;t--)if(this.lights[t].id===e)return this.lights[t];return null},i.prototype.getNodeByID=function(e){var t=this.getMeshByID(e);if(t)return t;var i=this.getLightByID(e);if(i)return i;var r=this.getCameraByID(e);if(r)return r;var n=this.getBoneByID(e);return n},i.prototype.getNodeByName=function(e){var t=this.getMeshByName(e);if(t)return t;var i=this.getLightByName(e);if(i)return i;var r=this.getCameraByName(e);if(r)return r;var n=this.getBoneByName(e);return n},i.prototype.getMeshByName=function(e){for(var t=0;t<this.meshes.length;t++)if(this.meshes[t].name===e)return this.meshes[t];return null},i.prototype.getSoundByName=function(t){var i;if(e.AudioEngine){for(i=0;i<this.mainSoundTrack.soundCollection.length;i++)if(this.mainSoundTrack.soundCollection[i].name===t)return this.mainSoundTrack.soundCollection[i];for(var r=0;r<this.soundTracks.length;r++)for(i=0;i<this.soundTracks[r].soundCollection.length;i++)if(this.soundTracks[r].soundCollection[i].name===t)return this.soundTracks[r].soundCollection[i]}return null},i.prototype.getLastSkeletonByID=function(e){for(var t=this.skeletons.length-1;t>=0;t--)if(this.skeletons[t].id===e)return this.skeletons[t];return null},i.prototype.getSkeletonById=function(e){for(var t=0;t<this.skeletons.length;t++)if(this.skeletons[t].id===e)return this.skeletons[t];return null},i.prototype.getSkeletonByName=function(e){for(var t=0;t<this.skeletons.length;t++)if(this.skeletons[t].name===e)return this.skeletons[t];return null},i.prototype.isActiveMesh=function(e){return-1!==this._activeMeshes.indexOf(e)},i.prototype._evaluateSubMesh=function(e,t){if(t.alwaysSelectAsActiveMesh||1===t.subMeshes.length||e.isInFrustum(this._frustumPlanes)){var i=e.getMaterial();t.showSubMeshesBoundingBox&&this._boundingBoxRenderer.renderList.push(e.getBoundingInfo().boundingBox),i&&(i.getRenderTargetTextures&&-1===this._processedMaterials.indexOf(i)&&(this._processedMaterials.push(i),this._renderTargets.concatWithNoDuplicate(i.getRenderTargetTextures())),this._activeIndices+=e.indexCount,this._renderingManager.dispatch(e))}},i.prototype._isInIntermediateRendering=function(){return this._intermediateRendering},i.prototype._evaluateActiveMeshes=function(){this.activeCamera._activeMeshes.reset(),this._activeMeshes.reset(),this._renderingManager.reset(),this._processedMaterials.reset(),this._activeParticleSystems.reset(),this._activeSkeletons.reset(),this._softwareSkinnedMeshes.reset(),this._boundingBoxRenderer.reset(),this._edgesRenderers.reset(),this._frustumPlanes?e.Frustum.GetPlanesToRef(this._transformMatrix,this._frustumPlanes):this._frustumPlanes=e.Frustum.GetPlanes(this._transformMatrix);var t,i;if(this._selectionOctree){var r=this._selectionOctree.select(this._frustumPlanes);t=r.data,i=r.length}else i=this.meshes.length,t=this.meshes;for(var n=0;i>n;n++){var o=t[n];if(!o.isBlocked&&(this._totalVertices+=o.getTotalVertices(),o.isReady()&&o.isEnabled())){o.computeWorldMatrix(),o.actionManager&&o.actionManager.hasSpecificTriggers([e.ActionManager.OnIntersectionEnterTrigger,e.ActionManager.OnIntersectionExitTrigger])&&this._meshesForIntersections.pushNoDuplicate(o);var s=o.getLOD(this.activeCamera);s&&(o._preActivate(),(o.alwaysSelectAsActiveMesh||o.isVisible&&o.visibility>0&&0!==(o.layerMask&this.activeCamera.layerMask)&&o.isInFrustum(this._frustumPlanes))&&(this._activeMeshes.push(o),this.activeCamera._activeMeshes.push(o),o._activate(this._renderId),this._activeMesh(s)))}}var a=e.Tools.Now;if(this.particlesEnabled){e.Tools.StartPerformanceCounter("Particles",this.particleSystems.length>0);for(var h=0;h<this.particleSystems.length;h++){var c=this.particleSystems[h];c.isStarted()&&(!c.emitter.position||c.emitter&&c.emitter.isEnabled())&&(this._activeParticleSystems.push(c),
c.animate())}e.Tools.EndPerformanceCounter("Particles",this.particleSystems.length>0)}this._particlesDuration+=e.Tools.Now-a},i.prototype._activeMesh=function(e){if(e.skeleton&&this.skeletonsEnabled&&(this._activeSkeletons.pushNoDuplicate(e.skeleton)&&e.skeleton.prepare(),e.computeBonesUsingShaders||this._softwareSkinnedMeshes.pushNoDuplicate(e)),(e.showBoundingBox||this.forceShowBoundingBoxes)&&this._boundingBoxRenderer.renderList.push(e.getBoundingInfo().boundingBox),e._edgesRenderer&&this._edgesRenderers.push(e._edgesRenderer),e&&e.subMeshes){var t,i;if(e._submeshesOctree&&e.useOctreeForRenderingSelection){var r=e._submeshesOctree.select(this._frustumPlanes);t=r.length,i=r.data}else i=e.subMeshes,t=i.length;for(var n=0;t>n;n++){var o=i[n];this._evaluateSubMesh(o,e)}}},i.prototype.updateTransformMatrix=function(e){this.setTransformMatrix(this.activeCamera.getViewMatrix(),this.activeCamera.getProjectionMatrix(e))},i.prototype._renderForCamera=function(t){var i=this._engine;if(this.activeCamera=t,!this.activeCamera)throw new Error("Active camera not set");e.Tools.StartPerformanceCounter("Rendering camera "+this.activeCamera.name),i.setViewport(this.activeCamera.viewport),this.resetCachedMaterial(),this._renderId++,this.updateTransformMatrix(),this.onBeforeCameraRenderObservable.notifyObservers(this.activeCamera);var r=e.Tools.Now;e.Tools.StartPerformanceCounter("Active meshes evaluation"),this._evaluateActiveMeshes(),this._evaluateActiveMeshesDuration+=e.Tools.Now-r,e.Tools.EndPerformanceCounter("Active meshes evaluation");for(var n=0;n<this._softwareSkinnedMeshes.length;n++){var o=this._softwareSkinnedMeshes.data[n];o.applySkeleton(o.skeleton)}var s=e.Tools.Now;if(this.renderTargetsEnabled&&this._renderTargets.length>0){this._intermediateRendering=!0,e.Tools.StartPerformanceCounter("Render targets",this._renderTargets.length>0);for(var a=0;a<this._renderTargets.length;a++){var h=this._renderTargets.data[a];if(h._shouldRender()){this._renderId++;var c=h.activeCamera&&h.activeCamera!==this.activeCamera;h.render(c,this.dumpNextRenderTargets)}}e.Tools.EndPerformanceCounter("Render targets",this._renderTargets.length>0),this._intermediateRendering=!1,this._renderId++,i.restoreDefaultFramebuffer()}this._renderTargetsDuration+=e.Tools.Now-s,this.postProcessManager._prepareFrame();var l,u,f=e.Tools.Now;if(this.layers.length){for(i.setDepthBuffer(!1),l=0;l<this.layers.length;l++)u=this.layers[l],u.isBackground&&u.render();i.setDepthBuffer(!0)}e.Tools.StartPerformanceCounter("Main render"),this._renderingManager.render(null,null,!0,!0),e.Tools.EndPerformanceCounter("Main render"),this._boundingBoxRenderer.render();for(var d=0;d<this._edgesRenderers.length;d++)this._edgesRenderers.data[d].render();if(this.lensFlaresEnabled){e.Tools.StartPerformanceCounter("Lens flares",this.lensFlareSystems.length>0);for(var p=0;p<this.lensFlareSystems.length;p++){var _=this.lensFlareSystems[p];0!==(t.layerMask&_.layerMask)&&_.render()}e.Tools.EndPerformanceCounter("Lens flares",this.lensFlareSystems.length>0)}if(this.layers.length){for(i.setDepthBuffer(!1),l=0;l<this.layers.length;l++)u=this.layers[l],u.isBackground||u.render();i.setDepthBuffer(!0)}this._renderDuration+=e.Tools.Now-f,this.postProcessManager._finalizeFrame(t.isIntermediate),this.activeCamera._updateFromScene(),this._renderTargets.reset(),this.onAfterCameraRenderObservable.notifyObservers(this.activeCamera),e.Tools.EndPerformanceCounter("Rendering camera "+this.activeCamera.name)},i.prototype._processSubCameras=function(t){if(t.cameraRigMode===e.Camera.RIG_MODE_NONE)return void this._renderForCamera(t);for(var i=0;i<t._rigCameras.length;i++)this._renderForCamera(t._rigCameras[i]);this.activeCamera=t,this.setTransformMatrix(this.activeCamera.getViewMatrix(),this.activeCamera.getProjectionMatrix()),this.activeCamera._updateFromScene()},i.prototype._checkIntersections=function(){for(var t=0;t<this._meshesForIntersections.length;t++)for(var i=this._meshesForIntersections.data[t],r=0;r<i.actionManager.actions.length;r++){var n=i.actionManager.actions[r];if(n.trigger===e.ActionManager.OnIntersectionEnterTrigger||n.trigger===e.ActionManager.OnIntersectionExitTrigger){var o=n.getTriggerParameter(),s=o instanceof e.AbstractMesh?o:o.mesh,a=s.intersectsMesh(i,o.usePreciseIntersection),h=i._intersectionsInProgress.indexOf(s);a&&-1===h?n.trigger===e.ActionManager.OnIntersectionEnterTrigger?(n._executeCurrent(e.ActionEvent.CreateNew(i,null,s)),i._intersectionsInProgress.push(s)):n.trigger===e.ActionManager.OnIntersectionExitTrigger&&i._intersectionsInProgress.push(s):!a&&h>-1&&(n.trigger===e.ActionManager.OnIntersectionExitTrigger&&n._executeCurrent(e.ActionEvent.CreateNew(i,null,s)),i.actionManager.hasSpecificTrigger(e.ActionManager.OnIntersectionExitTrigger)&&n.trigger!==e.ActionManager.OnIntersectionExitTrigger||i._intersectionsInProgress.splice(h,1))}}},i.prototype.render=function(){var t=e.Tools.Now;this._particlesDuration=0,this._spritesDuration=0,this._activeParticles=0,this._renderDuration=0,this._renderTargetsDuration=0,this._evaluateActiveMeshesDuration=0,this._totalVertices=0,this._activeIndices=0,this._activeBones=0,this.getEngine().resetDrawCalls(),this._meshesForIntersections.reset(),this.resetCachedMaterial(),e.Tools.StartPerformanceCounter("Scene rendering"),this.actionManager&&this.actionManager.processTrigger(e.ActionManager.OnEveryFrameTrigger,null),this.simplificationQueue&&!this.simplificationQueue.running&&this.simplificationQueue.executeNext();var r=Math.max(i.MinDeltaTime,Math.min(this._engine.getDeltaTime(),i.MaxDeltaTime));this._animationRatio=.06*r,this._animate(),this._physicsEngine&&(e.Tools.StartPerformanceCounter("Physics"),this._physicsEngine._step(r/1e3),e.Tools.EndPerformanceCounter("Physics")),this.onBeforeRenderObservable.notifyObservers(this);var n=e.Tools.Now,o=this.getEngine(),s=this.activeCamera;if(this.renderTargetsEnabled){e.Tools.StartPerformanceCounter("Custom render targets",this.customRenderTargets.length>0);for(var a=0;a<this.customRenderTargets.length;a++){var h=this.customRenderTargets[a];if(h._shouldRender()){if(this._renderId++,this.activeCamera=h.activeCamera||this.activeCamera,!this.activeCamera)throw new Error("Active camera not set");o.setViewport(this.activeCamera.viewport),this.updateTransformMatrix(),h.render(s!==this.activeCamera,this.dumpNextRenderTargets)}}e.Tools.EndPerformanceCounter("Custom render targets",this.customRenderTargets.length>0),this._renderId++}if(this.customRenderTargets.length>0&&o.restoreDefaultFramebuffer(),this._renderTargetsDuration+=e.Tools.Now-n,this.activeCamera=s,this.proceduralTexturesEnabled){e.Tools.StartPerformanceCounter("Procedural textures",this._proceduralTextures.length>0);for(var c=0;c<this._proceduralTextures.length;c++){var l=this._proceduralTextures[c];l._shouldRender()&&l.render()}e.Tools.EndPerformanceCounter("Procedural textures",this._proceduralTextures.length>0)}if(this._engine.clear(this.clearColor,this.autoClear||this.forceWireframe||this.forcePointsCloud,!0),this.shadowsEnabled)for(var u=0;u<this.lights.length;u++){var f=this.lights[u],d=f.getShadowGenerator();f.isEnabled()&&d&&-1!==d.getShadowMap().getScene().textures.indexOf(d.getShadowMap())&&this._renderTargets.push(d.getShadowMap())}if(this._depthRenderer&&this._renderTargets.push(this._depthRenderer.getDepthMap()),this.postProcessRenderPipelineManager.update(),this.activeCameras.length>0)for(var p=this._renderId,_=0;_<this.activeCameras.length;_++)this._renderId=p,_>0&&this._engine.clear(0,!1,!0),this._processSubCameras(this.activeCameras[_]);else{if(!this.activeCamera)throw new Error("No camera defined");this._processSubCameras(this.activeCamera)}this._checkIntersections(),e.AudioEngine&&this._updateAudioParameters(),this.afterRender&&this.afterRender(),this.onAfterRenderObservable.notifyObservers(this);for(var m=0;m<this._toBeDisposed.length;m++)this._toBeDisposed.data[m].dispose(),this._toBeDisposed[m]=null;this._toBeDisposed.reset(),this.dumpNextRenderTargets&&(this.dumpNextRenderTargets=!1),e.Tools.EndPerformanceCounter("Scene rendering"),this._lastFrameDuration=e.Tools.Now-t},i.prototype._updateAudioParameters=function(){if(this.audioEnabled&&(0!==this.mainSoundTrack.soundCollection.length||1!==this.soundTracks.length)){var t,i=e.Engine.audioEngine;if(t=this.activeCameras.length>0?this.activeCameras[0]:this.activeCamera,t&&i.canUseWebAudio){i.audioContext.listener.setPosition(t.position.x,t.position.y,t.position.z);var r=e.Matrix.Invert(t.getViewMatrix()),n=e.Vector3.TransformNormal(new e.Vector3(0,0,-1),r);n.normalize(),i.audioContext.listener.setOrientation(n.x,n.y,n.z,0,1,0);var o;for(o=0;o<this.mainSoundTrack.soundCollection.length;o++){var s=this.mainSoundTrack.soundCollection[o];s.useCustomAttenuation&&s.updateDistanceFromListener()}for(o=0;o<this.soundTracks.length;o++)for(var a=0;a<this.soundTracks[o].soundCollection.length;a++)s=this.soundTracks[o].soundCollection[a],s.useCustomAttenuation&&s.updateDistanceFromListener()}}},Object.defineProperty(i.prototype,"audioEnabled",{get:function(){return this._audioEnabled},set:function(t){this._audioEnabled=t,e.AudioEngine&&(this._audioEnabled?this._enableAudio():this._disableAudio())},enumerable:!0,configurable:!0}),i.prototype._disableAudio=function(){var e;for(e=0;e<this.mainSoundTrack.soundCollection.length;e++)this.mainSoundTrack.soundCollection[e].pause();for(e=0;e<this.soundTracks.length;e++)for(var t=0;t<this.soundTracks[e].soundCollection.length;t++)this.soundTracks[e].soundCollection[t].pause()},i.prototype._enableAudio=function(){var e;for(e=0;e<this.mainSoundTrack.soundCollection.length;e++)this.mainSoundTrack.soundCollection[e].isPaused&&this.mainSoundTrack.soundCollection[e].play();for(e=0;e<this.soundTracks.length;e++)for(var t=0;t<this.soundTracks[e].soundCollection.length;t++)this.soundTracks[e].soundCollection[t].isPaused&&this.soundTracks[e].soundCollection[t].play()},Object.defineProperty(i.prototype,"headphone",{get:function(){return this._headphone},set:function(t){this._headphone=t,e.AudioEngine&&(this._headphone?this._switchAudioModeForHeadphones():this._switchAudioModeForNormalSpeakers())},enumerable:!0,configurable:!0}),i.prototype._switchAudioModeForHeadphones=function(){this.mainSoundTrack.switchPanningModelToHRTF();for(var e=0;e<this.soundTracks.length;e++)this.soundTracks[e].switchPanningModelToHRTF()},i.prototype._switchAudioModeForNormalSpeakers=function(){this.mainSoundTrack.switchPanningModelToEqualPower();for(var e=0;e<this.soundTracks.length;e++)this.soundTracks[e].switchPanningModelToEqualPower()},i.prototype.enableDepthRenderer=function(){return this._depthRenderer?this._depthRenderer:(this._depthRenderer=new e.DepthRenderer(this),this._depthRenderer)},i.prototype.disableDepthRenderer=function(){this._depthRenderer&&(this._depthRenderer.dispose(),this._depthRenderer=null)},i.prototype.freezeMaterials=function(){for(var e=0;e<this.materials.length;e++)this.materials[e].freeze()},i.prototype.unfreezeMaterials=function(){for(var e=0;e<this.materials.length;e++)this.materials[e].unfreeze()},i.prototype.dispose=function(){this.beforeRender=null,this.afterRender=null,this.skeletons=[],this._boundingBoxRenderer.dispose(),this._depthRenderer&&this._depthRenderer.dispose(),this._debugLayer&&this._debugLayer.hide(),this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear(),this.onBeforeRenderObservable.clear(),this.onAfterRenderObservable.clear(),this.detachControl(),e.AudioEngine&&this.disposeSounds();var t,i=this._engine.getRenderingCanvas();for(t=0;t<this.cameras.length;t++)this.cameras[t].detachControl(i);for(;this.lights.length;)this.lights[0].dispose();for(;this.meshes.length;)this.meshes[0].dispose(!0);for(;this.cameras.length;)this.cameras[0].dispose();for(;this.materials.length;)this.materials[0].dispose();for(;this.particleSystems.length;)this.particleSystems[0].dispose();for(;this.spriteManagers.length;)this.spriteManagers[0].dispose();for(;this.layers.length;)this.layers[0].dispose();for(;this.textures.length;)this.textures[0].dispose();this.postProcessManager.dispose(),this._physicsEngine&&this.disablePhysicsEngine(),t=this._engine.scenes.indexOf(this),t>-1&&this._engine.scenes.splice(t,1),this._engine.wipeCaches()},i.prototype.disposeSounds=function(){this.mainSoundTrack.dispose();for(var e=0;e<this.soundTracks.length;e++)this.soundTracks[e].dispose()},i.prototype.getWorldExtends=function(){for(var t=new e.Vector3(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),i=new e.Vector3(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),r=0;r<this.meshes.length;r++){var n=this.meshes[r];n.computeWorldMatrix(!0);var o=n.getBoundingInfo().boundingBox.minimumWorld,s=n.getBoundingInfo().boundingBox.maximumWorld;e.Tools.CheckExtends(o,t,i),e.Tools.CheckExtends(s,t,i)}return{min:t,max:i}},i.prototype.createOrUpdateSelectionOctree=function(t,i){void 0===t&&(t=64),void 0===i&&(i=2),this._selectionOctree||(this._selectionOctree=new e.Octree(e.Octree.CreationFuncForMeshes,t,i));var r=this.getWorldExtends();return this._selectionOctree.update(r.min,r.max,this.meshes),this._selectionOctree},i.prototype.createPickingRay=function(t,i,r,n,o){void 0===o&&(o=!1);var s=this._engine;if(!n){if(!this.activeCamera)throw new Error("Active camera not set");n=this.activeCamera}var a=n.viewport,h=a.toGlobal(s.getRenderWidth(),s.getRenderHeight());return t=t/this._engine.getHardwareScalingLevel()-h.x,i=i/this._engine.getHardwareScalingLevel()-(this._engine.getRenderHeight()-h.y-h.height),e.Ray.CreateNew(t,i,h.width,h.height,r?r:e.Matrix.Identity(),o?e.Matrix.Identity():n.getViewMatrix(),n.getProjectionMatrix())},i.prototype.createPickingRayInCameraSpace=function(t,i,r){var n=this._engine;if(!r){if(!this.activeCamera)throw new Error("Active camera not set");r=this.activeCamera}var o=r.viewport,s=o.toGlobal(n.getRenderWidth(),n.getRenderHeight()),a=e.Matrix.Identity();return t=t/this._engine.getHardwareScalingLevel()-s.x,i=i/this._engine.getHardwareScalingLevel()-(this._engine.getRenderHeight()-s.y-s.height),e.Ray.CreateNew(t,i,s.width,s.height,a,a,r.getProjectionMatrix())},i.prototype._internalPick=function(t,i,r){for(var n=null,o=0;o<this.meshes.length;o++){var s=this.meshes[o];if(i){if(!i(s))continue}else if(!s.isEnabled()||!s.isVisible||!s.isPickable)continue;var a=s.getWorldMatrix(),h=t(a),c=s.intersects(h,r);if(c&&c.hit&&(r||null==n||!(c.distance>=n.distance))&&(n=c,r))break}return n||new e.PickingInfo},i.prototype._internalPickSprites=function(t,i,r,n){var o=null;if(n=n||this.activeCamera,this.spriteManagers.length>0)for(var s=0;s<this.spriteManagers.length;s++){var a=this.spriteManagers[s];if(a.isPickable){var h=a.intersects(t,n,i,r);if(h&&h.hit&&(r||null==o||!(h.distance>=o.distance))&&(o=h,r))break}}return o||new e.PickingInfo},i.prototype.pick=function(e,t,i,r,n){var o=this;return this._internalPick(function(i){return o.createPickingRay(e,t,i,n)},i,r)},i.prototype.pickSprite=function(e,t,i,r,n){return this._internalPickSprites(this.createPickingRayInCameraSpace(e,t,n),i,r,n)},i.prototype.pickWithRay=function(t,i,r){var n=this;return this._internalPick(function(i){return n._pickWithRayInverseMatrix||(n._pickWithRayInverseMatrix=e.Matrix.Identity()),i.invertToRef(n._pickWithRayInverseMatrix),e.Ray.Transform(t,n._pickWithRayInverseMatrix)},i,r)},i.prototype.setPointerOverMesh=function(t){this._pointerOverMesh!==t&&(this._pointerOverMesh&&this._pointerOverMesh.actionManager&&this._pointerOverMesh.actionManager.processTrigger(e.ActionManager.OnPointerOutTrigger,e.ActionEvent.CreateNew(this._pointerOverMesh)),this._pointerOverMesh=t,this._pointerOverMesh&&this._pointerOverMesh.actionManager&&this._pointerOverMesh.actionManager.processTrigger(e.ActionManager.OnPointerOverTrigger,e.ActionEvent.CreateNew(this._pointerOverMesh)))},i.prototype.getPointerOverMesh=function(){return this._pointerOverMesh},i.prototype.setPointerOverSprite=function(t){this._pointerOverSprite!==t&&(this._pointerOverSprite&&this._pointerOverSprite.actionManager&&this._pointerOverSprite.actionManager.processTrigger(e.ActionManager.OnPointerOutTrigger,e.ActionEvent.CreateNewFromSprite(this._pointerOverSprite,this)),this._pointerOverSprite=t,this._pointerOverSprite&&this._pointerOverSprite.actionManager&&this._pointerOverSprite.actionManager.processTrigger(e.ActionManager.OnPointerOverTrigger,e.ActionEvent.CreateNewFromSprite(this._pointerOverSprite,this)))},i.prototype.getPointerOverSprite=function(){return this._pointerOverSprite},i.prototype.getPhysicsEngine=function(){return this._physicsEngine},i.prototype.enablePhysics=function(t,i){if(this._physicsEngine)return!0;try{return this._physicsEngine=new e.PhysicsEngine(t,i),!0}catch(r){return e.Tools.Error(r.message),!1}},i.prototype.disablePhysicsEngine=function(){this._physicsEngine&&(this._physicsEngine.dispose(),this._physicsEngine=void 0)},i.prototype.isPhysicsEnabled=function(){return void 0!==this._physicsEngine},i.prototype.setGravity=function(t){e.Tools.Warn("Deprecated, please use 'scene.getPhysicsEngine().setGravity()'"),this._physicsEngine&&this._physicsEngine.setGravity(t)},i.prototype.createCompoundImpostor=function(t,i){e.Tools.Warn("Scene.createCompoundImpostor is deprecated. Please use PhysicsImpostor parent/child"),t.parts&&(i=t,t=t.parts);var r=t[0].mesh;r.physicsImpostor=new e.PhysicsImpostor(r,t[0].impostor,i,this);for(var n=1;n<t.length;n++){var o=t[n].mesh;o.parent!==r&&(o.position=o.position.subtract(r.position),o.parent=r),o.physicsImpostor=new e.PhysicsImpostor(o,t[n].impostor,i,this)}r.physicsImpostor.forceUpdate()},i.prototype.deleteCompoundImpostor=function(e){var t=e.parts[0].mesh;t.physicsImpostor.dispose(),t.physicsImpostor=null},i.prototype.createDefaultCameraOrLight=function(){if(0===this.lights.length&&new e.HemisphericLight("default light",e.Vector3.Up(),this),!this.activeCamera){var t=new e.FreeCamera("default camera",e.Vector3.Zero(),this),i=this.getWorldExtends(),r=i.min.add(i.max.subtract(i.min).scale(.5));t.position=new e.Vector3(r.x,r.y,i.min.z-(i.max.z-i.min.z)),t.setTarget(r),this.activeCamera=t}},i.prototype._getByTags=function(t,i,r){if(void 0===i)return t;var n=[];r=r||function(e){};for(var o in t){var s=t[o];e.Tags.MatchesQuery(s,i)&&(n.push(s),r(s))}return n},i.prototype.getMeshesByTags=function(e,t){return this._getByTags(this.meshes,e,t)},i.prototype.getCamerasByTags=function(e,t){return this._getByTags(this.cameras,e,t)},i.prototype.getLightsByTags=function(e,t){return this._getByTags(this.lights,e,t)},i.prototype.getMaterialByTags=function(e,t){return this._getByTags(this.materials,e,t).concat(this._getByTags(this.multiMaterials,e,t))},i._FOGMODE_NONE=0,i._FOGMODE_EXP=1,i._FOGMODE_EXP2=2,i._FOGMODE_LINEAR=3,i.MinDeltaTime=1,i.MaxDeltaTime=1e3,i}();e.Scene=o}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(t,i,r,n,o,s){t instanceof e.Mesh?this._engine=t.getScene().getEngine():this._engine=t,this._updatable=r,this._data=i,this._strideSize=n,o||this.create(),this._instanced=s}return t.prototype.createVertexBuffer=function(t,i,r,n){return new e.VertexBuffer(this._engine,this,t,this._updatable,!0,n?n:this._strideSize,this._instanced,i,r)},t.prototype.isUpdatable=function(){return this._updatable},t.prototype.getData=function(){return this._data},t.prototype.getBuffer=function(){return this._buffer},t.prototype.getStrideSize=function(){return this._strideSize},t.prototype.getIsInstanced=function(){return this._instanced},t.prototype.create=function(e){!e&&this._buffer||(e=e||this._data,this._buffer?this._updatable&&(this._engine.updateDynamicVertexBuffer(this._buffer,e),this._data=e):this._updatable?(this._buffer=this._engine.createDynamicVertexBuffer(e),this._data=e):this._buffer=this._engine.createVertexBuffer(e))},t.prototype.update=function(e){this.create(e)},t.prototype.updateDirectly=function(e,t,i){this._buffer&&this._updatable&&(this._engine.updateDynamicVertexBuffer(this._buffer,e,t,i?i*this.getStrideSize():void 0),this._data=null)},t.prototype.dispose=function(){this._buffer&&this._engine._releaseBuffer(this._buffer)&&(this._buffer=null)},t}();e.Buffer=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(i,r,n,o,s,a,h,c,l){if(!a)switch(n){case t.PositionKind:a=3;break;case t.NormalKind:a=3;break;case t.UVKind:case t.UV2Kind:case t.UV3Kind:case t.UV4Kind:case t.UV5Kind:case t.UV6Kind:a=2;break;case t.ColorKind:a=4;break;case t.MatricesIndicesKind:case t.MatricesIndicesExtraKind:a=4;break;case t.MatricesWeightsKind:case t.MatricesWeightsExtraKind:a=4}r instanceof e.Buffer?(a||(a=r.getStrideSize()),this._buffer=r,this._ownsBuffer=!1):(this._buffer=new e.Buffer(i,r,o,a,s,h),this._ownsBuffer=!0),this._stride=a,this._offset=c?c:0,this._size=l?l:a,this._kind=n}return t.prototype.getKind=function(){return this._kind},t.prototype.isUpdatable=function(){return this._buffer.isUpdatable()},t.prototype.getData=function(){return this._buffer.getData()},t.prototype.getBuffer=function(){return this._buffer.getBuffer()},t.prototype.getStrideSize=function(){return this._stride},t.prototype.getOffset=function(){return this._offset},t.prototype.getSize=function(){return this._size},t.prototype.getIsInstanced=function(){return this._buffer.getIsInstanced()},t.prototype.create=function(e){return this._buffer.create(e)},t.prototype.update=function(e){return this._buffer.update(e)},t.prototype.updateDirectly=function(e,t){return this._buffer.updateDirectly(e,t)},t.prototype.dispose=function(){this._ownsBuffer&&this._buffer.dispose()},Object.defineProperty(t,"PositionKind",{get:function(){return t._PositionKind},enumerable:!0,configurable:!0}),Object.defineProperty(t,"NormalKind",{get:function(){return t._NormalKind},enumerable:!0,configurable:!0}),Object.defineProperty(t,"UVKind",{get:function(){return t._UVKind},enumerable:!0,configurable:!0}),Object.defineProperty(t,"UV2Kind",{get:function(){return t._UV2Kind},enumerable:!0,configurable:!0}),Object.defineProperty(t,"UV3Kind",{get:function(){return t._UV3Kind},enumerable:!0,configurable:!0}),Object.defineProperty(t,"UV4Kind",{get:function(){return t._UV4Kind},enumerable:!0,configurable:!0}),Object.defineProperty(t,"UV5Kind",{get:function(){return t._UV5Kind},enumerable:!0,configurable:!0}),Object.defineProperty(t,"UV6Kind",{get:function(){return t._UV6Kind},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ColorKind",{get:function(){return t._ColorKind},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MatricesIndicesKind",{get:function(){return t._MatricesIndicesKind},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MatricesWeightsKind",{get:function(){return t._MatricesWeightsKind},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MatricesIndicesExtraKind",{get:function(){return t._MatricesIndicesExtraKind},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MatricesWeightsExtraKind",{get:function(){return t._MatricesWeightsExtraKind},enumerable:!0,configurable:!0}),t._PositionKind="position",t._NormalKind="normal",t._UVKind="uv",t._UV2Kind="uv2",t._UV3Kind="uv3",t._UV4Kind="uv4",t._UV5Kind="uv5",t._UV6Kind="uv6",t._ColorKind="color",t._MatricesIndicesKind="matricesIndices",t._MatricesWeightsKind="matricesWeights",t._MatricesIndicesExtraKind="matricesIndicesExtra",t._MatricesWeightsExtraKind="matricesWeightsExtra",t}();e.VertexBuffer=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(e,i){t.call(this,e,i.getScene()),i.instances.push(this),this._sourceMesh=i,this.position.copyFrom(i.position),this.rotation.copyFrom(i.rotation),this.scaling.copyFrom(i.scaling),i.rotationQuaternion&&(this.rotationQuaternion=i.rotationQuaternion.clone()),this.infiniteDistance=i.infiniteDistance,this.setPivotMatrix(i.getPivotMatrix()),this.refreshBoundingInfo(),this._syncSubMeshes()}return __extends(i,t),Object.defineProperty(i.prototype,"receiveShadows",{get:function(){return this._sourceMesh.receiveShadows},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"material",{get:function(){return this._sourceMesh.material},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"visibility",{get:function(){return this._sourceMesh.visibility},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"skeleton",{get:function(){return this._sourceMesh.skeleton},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"renderingGroupId",{get:function(){return this._sourceMesh.renderingGroupId},enumerable:!0,configurable:!0}),i.prototype.getTotalVertices=function(){return this._sourceMesh.getTotalVertices()},Object.defineProperty(i.prototype,"sourceMesh",{get:function(){return this._sourceMesh},enumerable:!0,configurable:!0}),i.prototype.getVerticesData=function(e,t){return this._sourceMesh.getVerticesData(e,t)},i.prototype.isVerticesDataPresent=function(e){return this._sourceMesh.isVerticesDataPresent(e)},i.prototype.getIndices=function(){return this._sourceMesh.getIndices()},Object.defineProperty(i.prototype,"_positions",{get:function(){return this._sourceMesh._positions},enumerable:!0,configurable:!0}),i.prototype.refreshBoundingInfo=function(){var t=this._sourceMesh.getBoundingInfo();this._boundingInfo=new e.BoundingInfo(t.minimum.clone(),t.maximum.clone()),this._updateBoundingInfo()},i.prototype._preActivate=function(){this._currentLOD&&this._currentLOD._preActivate()},i.prototype._activate=function(e){this._currentLOD&&this._currentLOD._registerInstanceForRenderId(this,e)},i.prototype.getLOD=function(e){return this._currentLOD=this.sourceMesh.getLOD(this.getScene().activeCamera,this.getBoundingInfo().boundingSphere),this._currentLOD===this.sourceMesh?this:this._currentLOD},i.prototype._syncSubMeshes=function(){if(this.releaseSubMeshes(),this._sourceMesh.subMeshes)for(var e=0;e<this._sourceMesh.subMeshes.length;e++)this._sourceMesh.subMeshes[e].clone(this,this._sourceMesh)},i.prototype._generatePointsArray=function(){return this._sourceMesh._generatePointsArray()},i.prototype.clone=function(t,i,r){var n=this._sourceMesh.createInstance(t);if(e.Tools.DeepCopy(this,n,["name","subMeshes"],[]),this.refreshBoundingInfo(),i&&(n.parent=i),!r)for(var o=0;o<this.getScene().meshes.length;o++){var s=this.getScene().meshes[o];s.parent===this&&s.clone(s.name,n)}return n.computeWorldMatrix(!0),n},i.prototype.dispose=function(e){var i=this._sourceMesh.instances.indexOf(this);this._sourceMesh.instances.splice(i,1),t.prototype.dispose.call(this,e)},i}(e.AbstractMesh);e.InstancedMesh=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function e(){this.mustReturn=!1,this.visibleInstances=new Array,this.renderSelf=new Array}return e}();e._InstancesBatch=t;var i=function(i){function r(n,o,s,a,h,c){if(void 0===s&&(s=null),void 0===c&&(c=!0),i.call(this,n,o),this.onBeforeRenderObservable=new e.Observable,this.onAfterRenderObservable=new e.Observable,this.onBeforeDrawObservable=new e.Observable,this.delayLoadState=e.Engine.DELAYLOADSTATE_NONE,this.instances=new Array,this._LODLevels=new Array,this._visibleInstances={},this._renderIdForInstances=new Array,this._batchCache=new t,this._instancesBufferSize=2048,this._sideOrientation=r._DEFAULTSIDE,this._areNormalsFrozen=!1,a){a._geometry&&a._geometry.applyToMesh(this),e.Tools.DeepCopy(a,this,["name","material","skeleton","instances"],["_poseMatrix"]),this.setPivotMatrix(a.getPivotMatrix()),this.id=n+"."+a.id,this.material=a.material;var l;if(!h)for(l=0;l<o.meshes.length;l++){var u=o.meshes[l];if(u.parent===a){u.clone(n+"."+u.name,this,h)}}var f=this.getScene().getPhysicsEngine();if(c&&f){var d=f.getImpostorForPhysicsObject(a);d&&(this.physicsImpostor=d.clone(this))}for(l=0;l<o.particleSystems.length;l++){var p=o.particleSystems[l];p.emitter===a&&p.clone(p.name,this)}this.computeWorldMatrix(!0)}null!==s&&(this.parent=s)}return __extends(r,i),Object.defineProperty(r,"FRONTSIDE",{get:function(){return r._FRONTSIDE},enumerable:!0,configurable:!0}),Object.defineProperty(r,"BACKSIDE",{get:function(){return r._BACKSIDE},enumerable:!0,configurable:!0}),Object.defineProperty(r,"DOUBLESIDE",{get:function(){return r._DOUBLESIDE},enumerable:!0,configurable:!0}),Object.defineProperty(r,"DEFAULTSIDE",{get:function(){return r._DEFAULTSIDE},enumerable:!0,configurable:!0}),Object.defineProperty(r,"NO_CAP",{get:function(){return r._NO_CAP},enumerable:!0,configurable:!0}),Object.defineProperty(r,"CAP_START",{get:function(){return r._CAP_START},enumerable:!0,configurable:!0}),Object.defineProperty(r,"CAP_END",{get:function(){return r._CAP_END},enumerable:!0,configurable:!0}),Object.defineProperty(r,"CAP_ALL",{get:function(){return r._CAP_ALL},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"onBeforeDraw",{set:function(e){this._onBeforeDrawObserver&&this.onBeforeDrawObservable.remove(this._onBeforeDrawObserver),this._onBeforeDrawObserver=this.onBeforeDrawObservable.add(e)},enumerable:!0,configurable:!0}),r.prototype.toString=function(t){var r=i.prototype.toString.call(this,t);if(r+=", n vertices: "+this.getTotalVertices(),r+=", parent: "+(this._waitingParentId?this._waitingParentId:this.parent?this.parent.name:"NONE"),this.animations)for(var n=0;n<this.animations.length;n++)r+=", animation[0]: "+this.animations[n].toString(t);return t&&(r+=", flat shading: "+(this._geometry?this.getVerticesData(e.VertexBuffer.PositionKind).length/3===this.getIndices().length?"YES":"NO":"UNKNOWN")),r},Object.defineProperty(r.prototype,"hasLODLevels",{get:function(){return this._LODLevels.length>0},enumerable:!0,configurable:!0}),r.prototype._sortLODLevels=function(){this._LODLevels.sort(function(e,t){return e.distance<t.distance?1:e.distance>t.distance?-1:0})},r.prototype.addLODLevel=function(t,i){if(i&&i._masterMesh)return e.Tools.Warn("You cannot use a mesh as LOD level twice"),this;var r=new e.Internals.MeshLODLevel(t,i);return this._LODLevels.push(r),i&&(i._masterMesh=this),this._sortLODLevels(),this},r.prototype.getLODLevelAtDistance=function(e){for(var t=0;t<this._LODLevels.length;t++){var i=this._LODLevels[t];if(i.distance===e)return i.mesh}return null},r.prototype.removeLODLevel=function(e){for(var t=0;t<this._LODLevels.length;t++)this._LODLevels[t].mesh===e&&(this._LODLevels.splice(t,1),e&&(e._masterMesh=null));return this._sortLODLevels(),this},r.prototype.getLOD=function(e,t){if(!this._LODLevels||0===this._LODLevels.length)return this;var i=(t?t:this.getBoundingInfo().boundingSphere).centerWorld.subtract(e.globalPosition).length();if(this._LODLevels[this._LODLevels.length-1].distance>i)return this.onLODLevelSelection&&this.onLODLevelSelection(i,this,this._LODLevels[this._LODLevels.length-1].mesh),this;for(var r=0;r<this._LODLevels.length;r++){var n=this._LODLevels[r];if(n.distance<i)return n.mesh&&(n.mesh._preActivate(),n.mesh._updateSubMeshesBoundingInfo(this.worldMatrixFromCache)),this.onLODLevelSelection&&this.onLODLevelSelection(i,this,n.mesh),n.mesh}return this.onLODLevelSelection&&this.onLODLevelSelection(i,this,this),this},Object.defineProperty(r.prototype,"geometry",{get:function(){return this._geometry},enumerable:!0,configurable:!0}),r.prototype.getTotalVertices=function(){return this._geometry?this._geometry.getTotalVertices():0},r.prototype.getVerticesData=function(e,t){return this._geometry?this._geometry.getVerticesData(e,t):null},r.prototype.getVertexBuffer=function(e){return this._geometry?this._geometry.getVertexBuffer(e):void 0},r.prototype.isVerticesDataPresent=function(e){return this._geometry?this._geometry.isVerticesDataPresent(e):this._delayInfo?-1!==this._delayInfo.indexOf(e):!1},r.prototype.getVerticesDataKinds=function(){if(!this._geometry){var e=[];if(this._delayInfo)for(var t in this._delayInfo)e.push(t);return e}return this._geometry.getVerticesDataKinds()},r.prototype.getTotalIndices=function(){return this._geometry?this._geometry.getTotalIndices():0},r.prototype.getIndices=function(e){return this._geometry?this._geometry.getIndices(e):[]},Object.defineProperty(r.prototype,"isBlocked",{get:function(){return null!==this._masterMesh&&void 0!==this._masterMesh;
},enumerable:!0,configurable:!0}),r.prototype.isReady=function(){return this.delayLoadState===e.Engine.DELAYLOADSTATE_LOADING?!1:i.prototype.isReady.call(this)},r.prototype.isDisposed=function(){return this._isDisposed},Object.defineProperty(r.prototype,"sideOrientation",{get:function(){return this._sideOrientation},set:function(e){this._sideOrientation=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"areNormalsFrozen",{get:function(){return this._areNormalsFrozen},enumerable:!0,configurable:!0}),r.prototype.freezeNormals=function(){this._areNormalsFrozen=!0},r.prototype.unfreezeNormals=function(){this._areNormalsFrozen=!1},Object.defineProperty(r.prototype,"overridenInstanceCount",{set:function(e){this._overridenInstanceCount=e},enumerable:!0,configurable:!0}),r.prototype._preActivate=function(){var e=this.getScene().getRenderId();this._preActivateId!==e&&(this._preActivateId=e,this._visibleInstances=null)},r.prototype._preActivateForIntermediateRendering=function(e){this._visibleInstances&&(this._visibleInstances.intermediateDefaultRenderId=e)},r.prototype._registerInstanceForRenderId=function(e,t){this._visibleInstances||(this._visibleInstances={},this._visibleInstances.defaultRenderId=t,this._visibleInstances.selfDefaultRenderId=this._renderId),this._visibleInstances[t]||(this._visibleInstances[t]=new Array),this._visibleInstances[t].push(e)},r.prototype.refreshBoundingInfo=function(){if(!this._boundingInfo.isLocked){var t=this.getVerticesData(e.VertexBuffer.PositionKind);if(t){var i=e.Tools.ExtractMinAndMax(t,0,this.getTotalVertices());this._boundingInfo=new e.BoundingInfo(i.minimum,i.maximum)}if(this.subMeshes)for(var r=0;r<this.subMeshes.length;r++)this.subMeshes[r].refreshBoundingInfo();this._updateBoundingInfo()}},r.prototype._createGlobalSubMesh=function(){var t=this.getTotalVertices();return t&&this.getIndices()?(this.releaseSubMeshes(),new e.SubMesh(0,0,t,0,this.getTotalIndices(),this)):null},r.prototype.subdivide=function(t){if(!(1>t)){for(var i=this.getTotalIndices(),r=i/t|0,n=0;r%3!==0;)r++;this.releaseSubMeshes();for(var o=0;t>o&&!(n>=i);o++)e.SubMesh.CreateFromIndices(0,n,Math.min(r,i-n),this),n+=r;this.synchronizeInstances()}},r.prototype.setVerticesData=function(t,i,r,n){if(this._geometry)this._geometry.setVerticesData(t,i,r,n);else{var o=new e.VertexData;o.set(i,t);var s=this.getScene();new e.Geometry(e.Geometry.RandomId(),s,o,r,this)}},r.prototype.setVerticesBuffer=function(t){if(!this._geometry){var i=this.getScene();new e.Geometry(e.Geometry.RandomId(),i).applyToMesh(this)}this._geometry.setVerticesBuffer(t)},r.prototype.updateVerticesData=function(e,t,i,r){this._geometry&&(r?(this.makeGeometryUnique(),this.updateVerticesData(e,t,i,!1)):this._geometry.updateVerticesData(e,t,i))},r.prototype.updateVerticesDataDirectly=function(t,i,r,n){e.Tools.Warn("Mesh.updateVerticesDataDirectly deprecated since 2.3."),this._geometry&&(n?(this.makeGeometryUnique(),this.updateVerticesDataDirectly(t,i,r,!1)):this._geometry.updateVerticesDataDirectly(t,i,r))},r.prototype.updateMeshPositions=function(t,i){void 0===i&&(i=!0);var r=this.getVerticesData(e.VertexBuffer.PositionKind);if(t(r),this.updateVerticesData(e.VertexBuffer.PositionKind,r,!1,!1),i){var n=this.getIndices(),o=this.getVerticesData(e.VertexBuffer.NormalKind);e.VertexData.ComputeNormals(r,n,o),this.updateVerticesData(e.VertexBuffer.NormalKind,o,!1,!1)}},r.prototype.makeGeometryUnique=function(){if(this._geometry){var t=this._geometry.copy(e.Geometry.RandomId());t.applyToMesh(this)}},r.prototype.setIndices=function(t,i){if(this._geometry)this._geometry.setIndices(t,i);else{var r=new e.VertexData;r.indices=t;var n=this.getScene();new e.Geometry(e.Geometry.RandomId(),n,r,!1,this)}},r.prototype.toLeftHanded=function(){this._geometry&&this._geometry.toLeftHanded()},r.prototype._bind=function(t,i,r){var n,o=this.getScene().getEngine();if(this._unIndexed)n=null;else switch(r){case e.Material.PointFillMode:n=null;break;case e.Material.WireFrameFillMode:n=t.getLinesIndexBuffer(this.getIndices(),o);break;default:case e.Material.TriangleFillMode:n=this._unIndexed?null:this._geometry.getIndexBuffer()}o.bindBuffers(this._geometry.getVertexBuffers(),n,i)},r.prototype._draw=function(t,i,r){if(this._geometry&&this._geometry.getVertexBuffers()&&this._geometry.getIndexBuffer()){this.onBeforeDrawObservable.notifyObservers(this);var n=this.getScene().getEngine();switch(i){case e.Material.PointFillMode:n.drawPointClouds(t.verticesStart,t.verticesCount,r);break;case e.Material.WireFrameFillMode:this._unIndexed?n.drawUnIndexed(!1,t.verticesStart,t.verticesCount,r):n.draw(!1,0,r>0?t.linesIndexCount/2:t.linesIndexCount,r);break;default:this._unIndexed?n.drawUnIndexed(!0,t.verticesStart,t.verticesCount,r):n.draw(!0,t.indexStart,t.indexCount,r)}}},r.prototype.registerBeforeRender=function(e){this.onBeforeRenderObservable.add(e)},r.prototype.unregisterBeforeRender=function(e){this.onBeforeRenderObservable.removeCallback(e)},r.prototype.registerAfterRender=function(e){this.onAfterRenderObservable.add(e)},r.prototype.unregisterAfterRender=function(e){this.onAfterRenderObservable.removeCallback(e)},r.prototype._getInstancesRenderList=function(e){var t=this.getScene();if(this._batchCache.mustReturn=!1,this._batchCache.renderSelf[e]=this.isEnabled()&&this.isVisible,this._batchCache.visibleInstances[e]=null,this._visibleInstances){var i=t.getRenderId(),r=t._isInIntermediateRendering()?this._visibleInstances.intermediateDefaultRenderId:this._visibleInstances.defaultRenderId;this._batchCache.visibleInstances[e]=this._visibleInstances[i];var n=this._renderId;if(!this._batchCache.visibleInstances[e]&&r&&(this._batchCache.visibleInstances[e]=this._visibleInstances[r],i=Math.max(r,i),n=Math.max(this._visibleInstances.selfDefaultRenderId,i)),this._batchCache.visibleInstances[e]&&this._batchCache.visibleInstances[e].length){if(this._renderIdForInstances[e]===i)return this._batchCache.mustReturn=!0,this._batchCache;i!==n&&(this._batchCache.renderSelf[e]=!1)}this._renderIdForInstances[e]=i}return this._batchCache},r.prototype._renderWithInstances=function(t,i,r,n,o){for(var s=r.visibleInstances[t._id],a=s.length+1,h=16*a*4,c=this._instancesBufferSize,l=this._instancesBuffer;this._instancesBufferSize<h;)this._instancesBufferSize*=2;this._instancesData&&c==this._instancesBufferSize||(this._instancesData=new Float32Array(this._instancesBufferSize/4));var u=0,f=0,d=this.getWorldMatrix();if(r.renderSelf[t._id]&&(d.copyToArray(this._instancesData,u),u+=16,f++),s)for(var p=0;p<s.length;p++){var _=s[p];_.getWorldMatrix().copyToArray(this._instancesData,u),u+=16,f++}l&&c==this._instancesBufferSize?l.updateDirectly(this._instancesData,0,f):(l&&l.dispose(),l=new e.Buffer(o,this._instancesData,!0,16,!1,!0),this._instancesBuffer=l,this.setVerticesBuffer(l.createVertexBuffer("world0",0,4)),this.setVerticesBuffer(l.createVertexBuffer("world1",4,4)),this.setVerticesBuffer(l.createVertexBuffer("world2",8,4)),this.setVerticesBuffer(l.createVertexBuffer("world3",12,4))),o.bindBuffers(this.geometry.getVertexBuffers(),this.geometry.getIndexBuffer(),n),this._draw(t,i,f),o.unbindInstanceAttributes()},r.prototype._processRendering=function(e,t,i,r,n,o){var s=this.getScene(),a=s.getEngine();if(n)this._renderWithInstances(e,i,r,t,a);else if(r.renderSelf[e._id]&&(o&&o(!1,this.getWorldMatrix()),this._draw(e,i,this._overridenInstanceCount)),r.visibleInstances[e._id])for(var h=0;h<r.visibleInstances[e._id].length;h++){var c=r.visibleInstances[e._id][h],l=c.getWorldMatrix();o&&o(!0,l),this._draw(e,i)}},r.prototype.render=function(t,i){var r=this.getScene(),n=this._getInstancesRenderList(t._id);if(!n.mustReturn&&this._geometry&&this._geometry.getVertexBuffers()&&this._geometry.getIndexBuffer()){this.onBeforeRenderObservable.notifyObservers(this);var o=r.getEngine(),s=null!==o.getCaps().instancedArrays&&null!==n.visibleInstances[t._id]&&void 0!==n.visibleInstances[t._id],a=t.getMaterial();if(a&&a.isReady(this,s)){var h=o.getDepthWrite();this.renderOutline&&(o.setDepthWrite(!1),r.getOutlineRenderer().render(t,n),o.setDepthWrite(h)),a._preBind();var c=a.getEffect(),l=r.forcePointsCloud?e.Material.PointFillMode:r.forceWireframe?e.Material.WireFrameFillMode:a.fillMode;this._bind(t,c,l);var u=this.getWorldMatrix();if(a.bind(u,this),i&&o.setAlphaMode(a.alphaMode),this._processRendering(t,c,l,n,s,function(e,t){e&&a.bindOnlyWorldMatrix(t)}),a.unbind(),this.renderOutline&&h&&(o.setDepthWrite(!0),o.setColorWrite(!1),r.getOutlineRenderer().render(t,n),o.setColorWrite(!0)),this.renderOverlay){var f=o.getAlphaMode();o.setAlphaMode(e.Engine.ALPHA_COMBINE),r.getOutlineRenderer().render(t,n,!0),o.setAlphaMode(f)}this.onAfterRenderObservable.notifyObservers(this)}}},r.prototype.getEmittedParticleSystems=function(){for(var e=new Array,t=0;t<this.getScene().particleSystems.length;t++){var i=this.getScene().particleSystems[t];i.emitter===this&&e.push(i)}return e},r.prototype.getHierarchyEmittedParticleSystems=function(){var e=new Array,t=this.getDescendants();t.push(this);for(var i=0;i<this.getScene().particleSystems.length;i++){var r=this.getScene().particleSystems[i];-1!==t.indexOf(r.emitter)&&e.push(r)}return e},r.prototype._checkDelayState=function(){var t=this,i=this,r=this.getScene();if(this._geometry)this._geometry.load(r);else if(i.delayLoadState===e.Engine.DELAYLOADSTATE_NOTLOADED){i.delayLoadState=e.Engine.DELAYLOADSTATE_LOADING,r._addPendingData(i);var n=-1!==this.delayLoadingFile.indexOf(".babylonbinarymeshdata");e.Tools.LoadFile(this.delayLoadingFile,function(i){i instanceof ArrayBuffer?t._delayLoadingFunction(i,t):t._delayLoadingFunction(JSON.parse(i),t),t.delayLoadState=e.Engine.DELAYLOADSTATE_LOADED,r._removePendingData(t)},function(){},r.database,n)}},r.prototype.isInFrustum=function(t){return this.delayLoadState===e.Engine.DELAYLOADSTATE_LOADING?!1:i.prototype.isInFrustum.call(this,t)?(this._checkDelayState(),!0):!1},r.prototype.setMaterialByID=function(e){var t,i=this.getScene().materials;for(t=0;t<i.length;t++)if(i[t].id===e)return void(this.material=i[t]);var r=this.getScene().multiMaterials;for(t=0;t<r.length;t++)if(r[t].id===e)return void(this.material=r[t])},r.prototype.getAnimatables=function(){var e=[];return this.material&&e.push(this.material),this.skeleton&&e.push(this.skeleton),e},r.prototype.bakeTransformIntoVertices=function(t){if(this.isVerticesDataPresent(e.VertexBuffer.PositionKind)){var i=this.subMeshes.splice(0);this._resetPointsArrayCache();var r,n=this.getVerticesData(e.VertexBuffer.PositionKind),o=[];for(r=0;r<n.length;r+=3)e.Vector3.TransformCoordinates(e.Vector3.FromArray(n,r),t).toArray(o,r);if(this.setVerticesData(e.VertexBuffer.PositionKind,o,this.getVertexBuffer(e.VertexBuffer.PositionKind).isUpdatable()),this.isVerticesDataPresent(e.VertexBuffer.NormalKind)){for(n=this.getVerticesData(e.VertexBuffer.NormalKind),o=[],r=0;r<n.length;r+=3)e.Vector3.TransformNormal(e.Vector3.FromArray(n,r),t).normalize().toArray(o,r);this.setVerticesData(e.VertexBuffer.NormalKind,o,this.getVertexBuffer(e.VertexBuffer.NormalKind).isUpdatable()),t.m[0]*t.m[5]*t.m[10]<0&&this.flipFaces(),this.releaseSubMeshes(),this.subMeshes=i}}},r.prototype.bakeCurrentTransformIntoVertices=function(){this.bakeTransformIntoVertices(this.computeWorldMatrix(!0)),this.scaling.copyFromFloats(1,1,1),this.position.copyFromFloats(0,0,0),this.rotation.copyFromFloats(0,0,0),this.rotationQuaternion&&(this.rotationQuaternion=e.Quaternion.Identity()),this._worldMatrix=e.Matrix.Identity()},r.prototype._resetPointsArrayCache=function(){this._positions=null},r.prototype._generatePointsArray=function(){if(this._positions)return!0;this._positions=[];var t=this.getVerticesData(e.VertexBuffer.PositionKind);if(!t)return!1;for(var i=0;i<t.length;i+=3)this._positions.push(e.Vector3.FromArray(t,i));return!0},r.prototype.clone=function(e,t,i,n){return void 0===n&&(n=!0),new r(e,this.getScene(),t,this,i,n)},r.prototype.dispose=function(e){for(this._geometry&&this._geometry.releaseForMesh(this,!0),this._instancesBuffer&&(this._instancesBuffer.dispose(),this._instancesBuffer=null);this.instances.length;)this.instances[0].dispose();i.prototype.dispose.call(this,e)},r.prototype.applyDisplacementMap=function(t,i,r,n){var o=this,s=this.getScene(),a=function(e){var t=document.createElement("canvas"),s=t.getContext("2d"),a=e.width,h=e.height;t.width=a,t.height=h,s.drawImage(e,0,0);var c=s.getImageData(0,0,a,h).data;o.applyDisplacementMapFromBuffer(c,a,h,i,r),n&&n(o)};e.Tools.LoadImage(t,a,function(){},s.database)},r.prototype.applyDisplacementMapFromBuffer=function(t,i,r,n,o){if(!this.isVerticesDataPresent(e.VertexBuffer.PositionKind)||!this.isVerticesDataPresent(e.VertexBuffer.NormalKind)||!this.isVerticesDataPresent(e.VertexBuffer.UVKind))return void e.Tools.Warn("Cannot call applyDisplacementMap: Given mesh is not complete. Position, Normal or UV are missing");for(var s=this.getVerticesData(e.VertexBuffer.PositionKind),a=this.getVerticesData(e.VertexBuffer.NormalKind),h=this.getVerticesData(e.VertexBuffer.UVKind),c=e.Vector3.Zero(),l=e.Vector3.Zero(),u=e.Vector2.Zero(),f=0;f<s.length;f+=3){e.Vector3.FromArrayToRef(s,f,c),e.Vector3.FromArrayToRef(a,f,l),e.Vector2.FromArrayToRef(h,f/3*2,u);var d=Math.abs(u.x)*i%i|0,p=Math.abs(u.y)*r%r|0,_=4*(d+p*i),m=t[_]/255,g=t[_+1]/255,v=t[_+2]/255,y=.3*m+.59*g+.11*v;l.normalize(),l.scaleInPlace(n+(o-n)*y),c=c.add(l),c.toArray(s,f)}e.VertexData.ComputeNormals(s,this.getIndices(),a),this.updateVerticesData(e.VertexBuffer.PositionKind,s),this.updateVerticesData(e.VertexBuffer.NormalKind,a)},r.prototype.convertToFlatShadedMesh=function(){var t,i,r=this.getVerticesDataKinds(),n=[],o=[],s=[],a=!1;for(t=0;t<r.length;t++){i=r[t];var h=this.getVertexBuffer(i);i!==e.VertexBuffer.NormalKind?(n[i]=h,o[i]=n[i].getData(),s[i]=[]):(a=h.isUpdatable(),r.splice(t,1),t--)}var c,l=this.subMeshes.slice(0),u=this.getIndices(),f=this.getTotalIndices();for(c=0;f>c;c++){var d=u[c];for(t=0;t<r.length;t++){i=r[t];for(var p=n[i].getStrideSize(),_=0;p>_;_++)s[i].push(o[i][d*p+_])}}var m=[],g=s[e.VertexBuffer.PositionKind];for(c=0;f>c;c+=3){u[c]=c,u[c+1]=c+1,u[c+2]=c+2;for(var v=e.Vector3.FromArray(g,3*c),y=e.Vector3.FromArray(g,3*(c+1)),x=e.Vector3.FromArray(g,3*(c+2)),b=v.subtract(y),P=x.subtract(y),A=e.Vector3.Normalize(e.Vector3.Cross(b,P)),T=0;3>T;T++)m.push(A.x),m.push(A.y),m.push(A.z)}for(this.setIndices(u),this.setVerticesData(e.VertexBuffer.NormalKind,m,a),t=0;t<r.length;t++)i=r[t],this.setVerticesData(i,s[i],n[i].isUpdatable());this.releaseSubMeshes();for(var E=0;E<l.length;E++){var C=l[E];new e.SubMesh(C.materialIndex,C.indexStart,C.indexCount,C.indexStart,C.indexCount,this)}this.synchronizeInstances()},r.prototype.convertToUnIndexedMesh=function(){var t,i,r=this.getVerticesDataKinds(),n=[],o=[],s=[];for(t=0;t<r.length;t++){i=r[t];var a=this.getVertexBuffer(i);n[i]=a,o[i]=n[i].getData(),s[i]=[]}var h,c=this.subMeshes.slice(0),l=this.getIndices(),u=this.getTotalIndices();for(h=0;u>h;h++){var f=l[h];for(t=0;t<r.length;t++){i=r[t];for(var d=n[i].getStrideSize(),p=0;d>p;p++)s[i].push(o[i][f*d+p])}}for(h=0;u>h;h+=3)l[h]=h,l[h+1]=h+1,l[h+2]=h+2;for(this.setIndices(l),t=0;t<r.length;t++)i=r[t],this.setVerticesData(i,s[i],n[i].isUpdatable());this.releaseSubMeshes();for(var _=0;_<c.length;_++){var m=c[_];new e.SubMesh(m.materialIndex,m.indexStart,m.indexCount,m.indexStart,m.indexCount,this)}this._unIndexed=!0,this.synchronizeInstances()},r.prototype.flipFaces=function(t){void 0===t&&(t=!1);var i,r=e.VertexData.ExtractFromMesh(this);if(t&&this.isVerticesDataPresent(e.VertexBuffer.NormalKind))for(i=0;i<r.normals.length;i++)r.normals[i]*=-1;var n;for(i=0;i<r.indices.length;i+=3)n=r.indices[i+1],r.indices[i+1]=r.indices[i+2],r.indices[i+2]=n;r.applyToMesh(this)},r.prototype.createInstance=function(t){return new e.InstancedMesh(t,this)},r.prototype.synchronizeInstances=function(){for(var e=0;e<this.instances.length;e++){var t=this.instances[e];t._syncSubMeshes()}},r.prototype.simplify=function(t,i,r,n){void 0===i&&(i=!0),void 0===r&&(r=e.SimplificationType.QUADRATIC),this.getScene().simplificationQueue.addTask({settings:t,parallelProcessing:i,mesh:this,simplificationType:r,successCallback:n})},r.prototype.optimizeIndices=function(t){for(var i=this,r=this.getIndices(),n=this.getVerticesData(e.VertexBuffer.PositionKind),o=[],s=0;s<n.length;s+=3)o.push(e.Vector3.FromArray(n,s));var a=[];e.AsyncLoop.SyncAsyncForLoop(o.length,40,function(e){for(var t=o.length-1-e,i=o[t],r=0;t>r;++r){var n=o[r];if(i.equals(n)){a[t]=r;break}}},function(){for(var e=0;e<r.length;++e)r[e]=a[r[e]]||r[e];var n=i.subMeshes.slice(0);i.setIndices(r),i.subMeshes=n,t&&t(i)})},r.Parse=function(t,i,n){var o=new r(t.name,i);if(o.id=t.id,e.Tags.AddTagsTo(o,t.tags),o.position=e.Vector3.FromArray(t.position),t.rotationQuaternion?o.rotationQuaternion=e.Quaternion.FromArray(t.rotationQuaternion):t.rotation&&(o.rotation=e.Vector3.FromArray(t.rotation)),o.scaling=e.Vector3.FromArray(t.scaling),t.localMatrix?o.setPivotMatrix(e.Matrix.FromArray(t.localMatrix)):t.pivotMatrix&&o.setPivotMatrix(e.Matrix.FromArray(t.pivotMatrix)),o.setEnabled(t.isEnabled),o.isVisible=t.isVisible,o.infiniteDistance=t.infiniteDistance,o.showBoundingBox=t.showBoundingBox,o.showSubMeshesBoundingBox=t.showSubMeshesBoundingBox,void 0!==t.applyFog&&(o.applyFog=t.applyFog),void 0!==t.pickable&&(o.isPickable=t.pickable),void 0!==t.alphaIndex&&(o.alphaIndex=t.alphaIndex),o.receiveShadows=t.receiveShadows,o.billboardMode=t.billboardMode,void 0!==t.visibility&&(o.visibility=t.visibility),o.checkCollisions=t.checkCollisions,o._shouldGenerateFlatShading=t.useFlatShading,t.freezeWorldMatrix&&(o._waitingFreezeWorldMatrix=t.freezeWorldMatrix),t.parentId&&(o._waitingParentId=t.parentId),void 0!==t.actions&&(o._waitingActions=t.actions),o.hasVertexAlpha=t.hasVertexAlpha,t.delayLoadingFile?(o.delayLoadState=e.Engine.DELAYLOADSTATE_NOTLOADED,o.delayLoadingFile=n+t.delayLoadingFile,o._boundingInfo=new e.BoundingInfo(e.Vector3.FromArray(t.boundingBoxMinimum),e.Vector3.FromArray(t.boundingBoxMaximum)),t._binaryInfo&&(o._binaryInfo=t._binaryInfo),o._delayInfo=[],t.hasUVs&&o._delayInfo.push(e.VertexBuffer.UVKind),t.hasUVs2&&o._delayInfo.push(e.VertexBuffer.UV2Kind),t.hasUVs3&&o._delayInfo.push(e.VertexBuffer.UV3Kind),t.hasUVs4&&o._delayInfo.push(e.VertexBuffer.UV4Kind),t.hasUVs5&&o._delayInfo.push(e.VertexBuffer.UV5Kind),t.hasUVs6&&o._delayInfo.push(e.VertexBuffer.UV6Kind),t.hasColors&&o._delayInfo.push(e.VertexBuffer.ColorKind),t.hasMatricesIndices&&o._delayInfo.push(e.VertexBuffer.MatricesIndicesKind),t.hasMatricesWeights&&o._delayInfo.push(e.VertexBuffer.MatricesWeightsKind),o._delayLoadingFunction=e.Geometry.ImportGeometry,e.SceneLoader.ForceFullSceneLoadingForIncremental&&o._checkDelayState()):e.Geometry.ImportGeometry(t,o),t.materialId?o.setMaterialByID(t.materialId):o.material=null,t.skeletonId>-1&&(o.skeleton=i.getLastSkeletonByID(t.skeletonId),t.numBoneInfluencers&&(o.numBoneInfluencers=t.numBoneInfluencers)),t.animations){for(var s=0;s<t.animations.length;s++){var a=t.animations[s];o.animations.push(e.Animation.Parse(a))}e.Node.ParseAnimationRanges(o,t,i)}if(t.autoAnimate&&i.beginAnimation(o,t.autoAnimateFrom,t.autoAnimateTo,t.autoAnimateLoop,t.autoAnimateSpeed||1),t.layerMask&&!isNaN(t.layerMask)?o.layerMask=Math.abs(parseInt(t.layerMask)):o.layerMask=268435455,t.physicsImpostor&&(o.physicsImpostor=new e.PhysicsImpostor(o,t.physicsImpostor,{mass:t.physicsMass,friction:t.physicsFriction,restitution:t.physicsRestitution},i)),t.instances)for(var h=0;h<t.instances.length;h++){var c=t.instances[h],l=o.createInstance(c.name);if(e.Tags.AddTagsTo(l,c.tags),l.position=e.Vector3.FromArray(c.position),c.rotationQuaternion?l.rotationQuaternion=e.Quaternion.FromArray(c.rotationQuaternion):c.rotation&&(l.rotation=e.Vector3.FromArray(c.rotation)),l.scaling=e.Vector3.FromArray(c.scaling),l.checkCollisions=o.checkCollisions,t.animations){for(s=0;s<t.animations.length;s++)a=t.animations[s],l.animations.push(e.Animation.Parse(a));e.Node.ParseAnimationRanges(l,t,i)}}return o},r.CreateRibbon=function(t,i,r,n,o,s,a,h,c){return e.MeshBuilder.CreateRibbon(t,{pathArray:i,closeArray:r,closePath:n,offset:o,updatable:a,sideOrientation:h,instance:c},s)},r.CreateDisc=function(t,i,r,n,o,s){var a={radius:i,tessellation:r,sideOrientation:s,updatable:o};return e.MeshBuilder.CreateDisc(t,a,n)},r.CreateBox=function(t,i,r,n,o){var s={size:i,sideOrientation:o,updatable:n};return e.MeshBuilder.CreateBox(t,s,r)},r.CreateSphere=function(t,i,r,n,o,s){var a={segments:i,diameterX:r,diameterY:r,diameterZ:r,sideOrientation:s,updatable:o};return e.MeshBuilder.CreateSphere(t,a,n)},r.CreateCylinder=function(t,i,n,o,s,a,h,c,l){void 0!==h&&h instanceof e.Scene||(void 0!==h&&(l=c||r.DEFAULTSIDE,c=h),h=a,a=1);var u={height:i,diameterTop:n,diameterBottom:o,tessellation:s,subdivisions:a,sideOrientation:l,updatable:c};return e.MeshBuilder.CreateCylinder(t,u,h)},r.CreateTorus=function(t,i,r,n,o,s,a){var h={diameter:i,thickness:r,tessellation:n,sideOrientation:a,updatable:s};return e.MeshBuilder.CreateTorus(t,h,o)},r.CreateTorusKnot=function(t,i,r,n,o,s,a,h,c,l){var u={radius:i,tube:r,radialSegments:n,tubularSegments:o,p:s,q:a,sideOrientation:l,updatable:c};return e.MeshBuilder.CreateTorusKnot(t,u,h)},r.CreateLines=function(t,i,r,n,o){var s={points:i,updatable:n,instance:o};return e.MeshBuilder.CreateLines(t,s,r)},r.CreateDashedLines=function(t,i,r,n,o,s,a,h){var c={points:i,dashSize:r,gapSize:n,dashNb:o,updatable:a};return e.MeshBuilder.CreateDashedLines(t,c,s)},r.ExtrudeShape=function(t,i,n,o,s,a,h,c,l,u){var f={shape:i,path:n,scale:o,rotation:s,cap:0===a?0:a||r.NO_CAP,sideOrientation:l,instance:u,updatable:c};return e.MeshBuilder.ExtrudeShape(t,f,h)},r.ExtrudeShapeCustom=function(t,i,n,o,s,a,h,c,l,u,f,d){var p={shape:i,path:n,scaleFunction:o,rotationFunction:s,ribbonCloseArray:a,ribbonClosePath:h,cap:0===c?0:c||r.NO_CAP,sideOrientation:f,instance:d,updatable:u};return e.MeshBuilder.ExtrudeShapeCustom(t,p,l)},r.CreateLathe=function(t,i,r,n,o,s,a){var h={shape:i,radius:r,tessellation:n,sideOrientation:a,updatable:s};return e.MeshBuilder.CreateLathe(t,h,o)},r.CreatePlane=function(t,i,r,n,o){var s={size:i,width:i,height:i,sideOrientation:o,updatable:n};return e.MeshBuilder.CreatePlane(t,s,r)},r.CreateGround=function(t,i,r,n,o,s){var a={width:i,height:r,subdivisions:n,updatable:s};return e.MeshBuilder.CreateGround(t,a,o)},r.CreateTiledGround=function(t,i,r,n,o,s,a,h,c){var l={xmin:i,zmin:r,xmax:n,zmax:o,subdivisions:s,precision:a,updatable:c};return e.MeshBuilder.CreateTiledGround(t,l,h)},r.CreateGroundFromHeightMap=function(t,i,r,n,o,s,a,h,c,l){var u={width:r,height:n,subdivisions:o,minHeight:s,maxHeight:a,updatable:c,onReady:l};return e.MeshBuilder.CreateGroundFromHeightMap(t,i,u,h)},r.CreateTube=function(t,i,r,n,o,s,a,h,c,l){var u={path:i,radius:r,tessellation:n,radiusFunction:o,arc:1,cap:s,updatable:h,sideOrientation:c,instance:l};return e.MeshBuilder.CreateTube(t,u,a)},r.CreatePolyhedron=function(t,i,r){return e.MeshBuilder.CreatePolyhedron(t,i,r)},r.CreateIcoSphere=function(t,i,r){return e.MeshBuilder.CreateIcoSphere(t,i,r)},r.CreateDecal=function(t,i,r,n,o,s){var a={position:r,normal:n,size:o,angle:s};return e.MeshBuilder.CreateDecal(t,i,a)},r.prototype.setPositionsForCPUSkinning=function(){var t;return this._sourcePositions||(t=this.getVerticesData(e.VertexBuffer.PositionKind),this._sourcePositions=new Float32Array(t),this.getVertexBuffer(e.VertexBuffer.PositionKind).isUpdatable()||this.setVerticesData(e.VertexBuffer.PositionKind,t,!0)),this._sourcePositions},r.prototype.setNormalsForCPUSkinning=function(){var t;return this._sourceNormals||(t=this.getVerticesData(e.VertexBuffer.NormalKind),this._sourceNormals=new Float32Array(t),this.getVertexBuffer(e.VertexBuffer.NormalKind).isUpdatable()||this.setVerticesData(e.VertexBuffer.NormalKind,t,!0)),this._sourceNormals},r.prototype.applySkeleton=function(t){if(this.geometry&&this.geometry._softwareSkinningRenderId!=this.getScene().getRenderId()){if(this.geometry._softwareSkinningRenderId=this.getScene().getRenderId(),!this.isVerticesDataPresent(e.VertexBuffer.PositionKind))return this;if(!this.isVerticesDataPresent(e.VertexBuffer.NormalKind))return this;if(!this.isVerticesDataPresent(e.VertexBuffer.MatricesIndicesKind))return this;if(!this.isVerticesDataPresent(e.VertexBuffer.MatricesWeightsKind))return this;this._sourcePositions||this.setPositionsForCPUSkinning(),this._sourceNormals||this.setNormalsForCPUSkinning();var i=this.getVerticesData(e.VertexBuffer.PositionKind);i instanceof Float32Array||(i=new Float32Array(i));var r=this.getVerticesData(e.VertexBuffer.NormalKind);r instanceof Float32Array||(r=new Float32Array(r));for(var n,o=this.getVerticesData(e.VertexBuffer.MatricesIndicesKind),s=this.getVerticesData(e.VertexBuffer.MatricesWeightsKind),a=this.numBoneInfluencers>4,h=a?this.getVerticesData(e.VertexBuffer.MatricesIndicesExtraKind):null,c=a?this.getVerticesData(e.VertexBuffer.MatricesWeightsExtraKind):null,l=t.getTransformMatrices(this),u=e.Vector3.Zero(),f=new e.Matrix,d=new e.Matrix,p=0,_=0;_<i.length;_+=3,p+=4){var m;for(n=0;4>n&&(m=s[p+n],m>0);n++)e.Matrix.FromFloat32ArrayToRefScaled(l,16*o[p+n],m,d),f.addToSelf(d);if(a)for(n=0;4>n&&(m=c[p+n],m>0);n++)e.Matrix.FromFloat32ArrayToRefScaled(l,16*h[p+n],m,d),f.addToSelf(d);e.Vector3.TransformCoordinatesFromFloatsToRef(this._sourcePositions[_],this._sourcePositions[_+1],this._sourcePositions[_+2],f,u),u.toArray(i,_),e.Vector3.TransformNormalFromFloatsToRef(this._sourceNormals[_],this._sourceNormals[_+1],this._sourceNormals[_+2],f,u),u.toArray(r,_),f.reset()}return this.updateVerticesData(e.VertexBuffer.PositionKind,i),this.updateVerticesData(e.VertexBuffer.NormalKind,r),this}},r.MinMax=function(e){var t=null,i=null;for(var r in e){var n=e[r],o=n.getBoundingInfo().boundingBox;t?(t.MinimizeInPlace(o.minimumWorld),i.MaximizeInPlace(o.maximumWorld)):(t=o.minimumWorld,i=o.maximumWorld)}return{min:t,max:i}},r.Center=function(t){var i=void 0!==t.min?t:r.MinMax(t);return e.Vector3.Center(i.min,i.max)},r.MergeMeshes=function(t,i,n,o){void 0===i&&(i=!0);var s;if(!n){var a=0;for(s=0;s<t.length;s++)if(t[s]&&(a+=t[s].getTotalVertices(),a>65536))return e.Tools.Warn("Cannot merge meshes because resulting mesh will have more than 65536 vertices. Please use allow32BitsIndices = true to use 32 bits indices"),null}var h,c,l;for(s=0;s<t.length;s++)t[s]&&(t[s].computeWorldMatrix(!0),c=e.VertexData.ExtractFromMesh(t[s],!0),c.transform(t[s].getWorldMatrix()),h?h.merge(c):(h=c,l=t[s]));if(o||(o=new r(l.name+"_merged",l.getScene())),h.applyToMesh(o),o.material=l.material,o.checkCollisions=l.checkCollisions,i)for(s=0;s<t.length;s++)t[s]&&t[s].dispose();return o},r._FRONTSIDE=0,r._BACKSIDE=1,r._DOUBLESIDE=2,r._DEFAULTSIDE=0,r._NO_CAP=0,r._CAP_START=1,r._CAP_END=2,r._CAP_ALL=3,r}(e.AbstractMesh);e.Mesh=i}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(e,t,i,r,n,o,s,a){void 0===a&&(a=!0),this.materialIndex=e,this.verticesStart=t,this.verticesCount=i,this.indexStart=r,this.indexCount=n,this._renderId=0,this._mesh=o,this._renderingMesh=s||o,o.subMeshes.push(this),this._trianglePlanes=[],this._id=o.subMeshes.length-1,a&&(this.refreshBoundingInfo(),o.computeWorldMatrix(!0))}return Object.defineProperty(t.prototype,"IsGlobal",{get:function(){return 0===this.verticesStart&&this.verticesCount==this._mesh.getTotalVertices()},enumerable:!0,configurable:!0}),t.prototype.getBoundingInfo=function(){return this.IsGlobal?this._mesh.getBoundingInfo():this._boundingInfo},t.prototype.getMesh=function(){return this._mesh},t.prototype.getRenderingMesh=function(){return this._renderingMesh},t.prototype.getMaterial=function(){var t=this._renderingMesh.material;if(t&&t instanceof e.MultiMaterial){var i=t;return i.getSubMaterial(this.materialIndex)}return t?t:this._mesh.getScene().defaultMaterial},t.prototype.refreshBoundingInfo=function(){if(this._lastColliderWorldVertices=null,!this.IsGlobal){var t=this._renderingMesh.getVerticesData(e.VertexBuffer.PositionKind);if(!t)return void(this._boundingInfo=this._mesh._boundingInfo);var i,r=this._renderingMesh.getIndices();i=0===this.indexStart&&this.indexCount===r.length?{minimum:this._renderingMesh.getBoundingInfo().minimum.clone(),maximum:this._renderingMesh.getBoundingInfo().maximum.clone()}:e.Tools.ExtractMinAndMaxIndexed(t,r,this.indexStart,this.indexCount,this._renderingMesh.geometry.boundingBias),this._boundingInfo=new e.BoundingInfo(i.minimum,i.maximum)}},t.prototype._checkCollision=function(e){return this.getBoundingInfo()._checkCollision(e)},t.prototype.updateBoundingInfo=function(e){this.getBoundingInfo()||this.refreshBoundingInfo(),this.getBoundingInfo().update(e)},t.prototype.isInFrustum=function(e){return this.getBoundingInfo().isInFrustum(e)},t.prototype.render=function(e){this._renderingMesh.render(this,e)},t.prototype.getLinesIndexBuffer=function(e,t){if(!this._linesIndexBuffer){for(var i=[],r=this.indexStart;r<this.indexStart+this.indexCount;r+=3)i.push(e[r],e[r+1],e[r+1],e[r+2],e[r+2],e[r]);this._linesIndexBuffer=t.createIndexBuffer(i),this.linesIndexCount=i.length}return this._linesIndexBuffer},t.prototype.canIntersects=function(e){return e.intersectsBox(this.getBoundingInfo().boundingBox)},t.prototype.intersects=function(t,i,r,n){var o=null;if(this._mesh instanceof e.LinesMesh)for(var s=this._mesh,a=this.indexStart;a<this.indexStart+this.indexCount;a+=2){var h=i[r[a]],c=i[r[a+1]],l=t.intersectionSegment(h,c,s.intersectionThreshold);if(!(0>l)&&(n||!o||l<o.distance)&&(o=new e.IntersectionInfo(null,null,l),n))break}else for(var a=this.indexStart;a<this.indexStart+this.indexCount;a+=3){var h=i[r[a]],c=i[r[a+1]],u=i[r[a+2]],f=t.intersectsTriangle(h,c,u);if(f){if(f.distance<0)continue;if((n||!o||f.distance<o.distance)&&(o=f,o.faceId=a/3,n))break}}return o},t.prototype.clone=function(i,r){var n=new t(this.materialIndex,this.verticesStart,this.verticesCount,this.indexStart,this.indexCount,i,r,!1);return this.IsGlobal||(n._boundingInfo=new e.BoundingInfo(this.getBoundingInfo().minimum,this.getBoundingInfo().maximum)),n},t.prototype.dispose=function(){this._linesIndexBuffer&&(this._mesh.getScene().getEngine()._releaseBuffer(this._linesIndexBuffer),this._linesIndexBuffer=null);var e=this._mesh.subMeshes.indexOf(this);this._mesh.subMeshes.splice(e,1)},t.CreateFromIndices=function(e,i,r,n,o){var s=Number.MAX_VALUE,a=-Number.MAX_VALUE;o=o||n;for(var h=o.getIndices(),c=i;i+r>c;c++){var l=h[c];s>l&&(s=l),l>a&&(a=l)}return new t(e,s,a-s+1,i,r,n,o)},t}();e.SubMesh=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(){}return t.CreateBox=function(t,i,r){var n=new e.Mesh(t,r),o=e.VertexData.CreateBox(i);return o.applyToMesh(n,i.updatable),n},t.CreateSphere=function(t,i,r){var n=new e.Mesh(t,r),o=e.VertexData.CreateSphere(i);return o.applyToMesh(n,i.updatable),n},t.CreateDisc=function(t,i,r){var n=new e.Mesh(t,r),o=e.VertexData.CreateDisc(i);return o.applyToMesh(n,i.updatable),n},t.CreateIcoSphere=function(t,i,r){var n=new e.Mesh(t,r),o=e.VertexData.CreateIcoSphere(i);return o.applyToMesh(n,i.updatable),n},t.CreateRibbon=function(t,i,r){var n=i.pathArray,o=i.closeArray,s=i.closePath,a=(i.offset,i.sideOrientation),h=i.instance,c=i.updatable;if(h){var l=function(t){for(var i=n[0].length,r=0,o=h.sideOrientation===e.Mesh.DOUBLESIDE?2:1,s=1;o>=s;s++)for(var a=0;a<n.length;a++){var c=n[a],l=c.length;i=l>i?i:l;for(var u=0;i>u;)t[r]=c[u].x,t[r+1]=c[u].y,t[r+2]=c[u].z,u++,r+=3;h._closePath&&(t[r]=c[0].x,t[r+1]=c[0].y,t[r+2]=c[0].z,r+=3)}},u=h.getVerticesData(e.VertexBuffer.PositionKind);if(l(u),h.updateVerticesData(e.VertexBuffer.PositionKind,u,!1,!1),!h.areNormalsFrozen){var f=h.getIndices(),d=h.getVerticesData(e.VertexBuffer.NormalKind);if(e.VertexData.ComputeNormals(u,f,d),h._closePath)for(var p=0,_=0,m=0;m<n.length;m++)p=3*h._idx[m],_=m+1<n.length?3*(h._idx[m+1]-1):d.length-3,d[p]=.5*(d[p]+d[_]),d[p+1]=.5*(d[p+1]+d[_+1]),d[p+2]=.5*(d[p+2]+d[_+2]),d[_]=d[p],d[_+1]=d[p+1],d[_+2]=d[p+2];h.updateVerticesData(e.VertexBuffer.NormalKind,d,!1,!1);
}return h}var g=new e.Mesh(t,r);g.sideOrientation=a;var v=e.VertexData.CreateRibbon(i);return s&&(g._idx=v._idx),g._closePath=s,g._closeArray=o,v.applyToMesh(g,c),g},t.CreateCylinder=function(t,i,r){var n=new e.Mesh(t,r),o=e.VertexData.CreateCylinder(i);return o.applyToMesh(n,i.updatable),n},t.CreateTorus=function(t,i,r){var n=new e.Mesh(t,r),o=e.VertexData.CreateTorus(i);return o.applyToMesh(n,i.updatable),n},t.CreateTorusKnot=function(t,i,r){var n=new e.Mesh(t,r),o=e.VertexData.CreateTorusKnot(i);return o.applyToMesh(n,i.updatable),n},t.CreateLineSystem=function(t,i,r){var n=i.instance,o=i.lines;if(n){var s=function(e){for(var t=0,i=0;i<o.length;i++)for(var r=o[i],n=0;n<r.length;n++)e[t]=r[n].x,e[t+1]=r[n].y,e[t+2]=r[n].z,t+=3};return n.updateMeshPositions(s,!1),n}var a=new e.LinesMesh(t,r),h=e.VertexData.CreateLineSystem(i);return h.applyToMesh(a,i.updatable),a},t.CreateLines=function(e,i,r){var n=t.CreateLineSystem(e,{lines:[i.points],updatable:i.updatable,instance:i.instance},r);return n},t.CreateDashedLines=function(t,i,r){var n=i.points,o=i.instance,s=i.gapSize,a=(i.dashNb,i.dashSize);if(o){var h=function(t){var i=e.Vector3.Zero(),r=t.length/6,s=0,a=0,h=0,c=0,l=0,u=0,f=0,d=0;for(f=0;f<n.length-1;f++)n[f+1].subtractToRef(n[f],i),s+=i.length();for(h=s/r,c=o.dashSize*h/(o.dashSize+o.gapSize),f=0;f<n.length-1;f++)for(n[f+1].subtractToRef(n[f],i),a=Math.floor(i.length()/h),i.normalize(),d=0;a>d&&u<t.length;)l=h*d,t[u]=n[f].x+l*i.x,t[u+1]=n[f].y+l*i.y,t[u+2]=n[f].z+l*i.z,t[u+3]=n[f].x+(l+c)*i.x,t[u+4]=n[f].y+(l+c)*i.y,t[u+5]=n[f].z+(l+c)*i.z,u+=6,d++;for(;u<t.length;)t[u]=n[f].x,t[u+1]=n[f].y,t[u+2]=n[f].z,u+=3};return o.updateMeshPositions(h,!1),o}var c=new e.LinesMesh(t,r),l=e.VertexData.CreateDashedLines(i);return l.applyToMesh(c,i.updatable),c.dashSize=a,c.gapSize=s,c},t.ExtrudeShape=function(i,r,n){var o=r.path,s=r.shape,a=r.scale||1,h=r.rotation||0,c=0===r.cap?0:r.cap||e.Mesh.NO_CAP,l=r.updatable,u=0===r.sideOrientation?0:r.sideOrientation||e.Mesh.DEFAULTSIDE,f=r.instance;return t._ExtrudeShapeGeneric(i,s,o,a,h,null,null,!1,!1,c,!1,n,l,u,f)},t.ExtrudeShapeCustom=function(i,r,n){var o=r.path,s=r.shape,a=r.scaleFunction||function(){return 1},h=r.rotationFunction||function(){return 0},c=r.ribbonCloseArray||!1,l=r.ribbonClosePath||!1,u=0===r.cap?0:r.cap||e.Mesh.NO_CAP,f=r.updatable,d=0===r.sideOrientation?0:r.sideOrientation||e.Mesh.DEFAULTSIDE,p=r.instance;return t._ExtrudeShapeGeneric(i,s,o,null,null,a,h,c,l,u,!0,n,f,d,p)},t.CreateLathe=function(i,r,n){var o,s=r.arc<=0||r.arc>1?1:r.arc||1,a=void 0===r.closed?!0:r.closed,h=r.shape,c=r.radius||1,l=r.tessellation||64,u=r.updatable,f=0===r.sideOrientation?0:r.sideOrientation||e.Mesh.DEFAULTSIDE,d=r.cap||e.Mesh.NO_CAP,p=2*Math.PI,_=new Array,m=0,g=0,v=p/l*s,y=new Array;for(m=0;l>=m;m++){var y=[];for(d!=e.Mesh.CAP_START&&d!=e.Mesh.CAP_ALL||(y.push(new e.Vector3(0,h[0].y,0)),y.push(new e.Vector3(Math.cos(m*v)*h[0].x*c,h[0].y,Math.sin(m*v)*h[0].x*c))),g=0;g<h.length;g++)o=new e.Vector3(Math.cos(m*v)*h[g].x*c,h[g].y,Math.sin(m*v)*h[g].x*c),y.push(o);d!=e.Mesh.CAP_END&&d!=e.Mesh.CAP_ALL||(y.push(new e.Vector3(Math.cos(m*v)*h[h.length-1].x*c,h[h.length-1].y,Math.sin(m*v)*h[h.length-1].x*c)),y.push(new e.Vector3(0,h[h.length-1].y,0))),_.push(y)}var x=t.CreateRibbon(i,{pathArray:_,closeArray:a,sideOrientation:f,updatable:u},n);return x},t.CreatePlane=function(t,i,r){var n=new e.Mesh(t,r),o=e.VertexData.CreatePlane(i);if(o.applyToMesh(n,i.updatable),i.sourcePlane){n.translate(i.sourcePlane.normal,i.sourcePlane.d);var s=Math.acos(e.Vector3.Dot(i.sourcePlane.normal,e.Axis.Z)),a=e.Vector3.Cross(e.Axis.Z,i.sourcePlane.normal);n.rotate(a,s)}return n},t.CreateGround=function(t,i,r){var n=new e.GroundMesh(t,r);n._setReady(!1),n._subdivisions=i.subdivisions||1,n._width=i.width||1,n._height=i.height||1,n._maxX=n._width/2,n._maxZ=n._height/2,n._minX=-n._maxX,n._minZ=-n._maxZ;var o=e.VertexData.CreateGround(i);return o.applyToMesh(n,i.updatable),n._setReady(!0),n},t.CreateTiledGround=function(t,i,r){var n=new e.Mesh(t,r),o=e.VertexData.CreateTiledGround(i);return o.applyToMesh(n,i.updatable),n},t.CreateGroundFromHeightMap=function(t,i,r,n){var o=r.width||10,s=r.height||10,a=r.subdivisions||1,h=r.minHeight,c=r.maxHeight||10,l=r.updatable,u=r.onReady,f=new e.GroundMesh(t,n);f._subdivisions=a,f._width=o,f._height=s,f._maxX=f._width/2,f._maxZ=f._height/2,f._minX=-f._maxX,f._minZ=-f._maxZ,f._setReady(!1);var d=function(t){var i=document.createElement("canvas"),r=i.getContext("2d"),n=t.width,d=t.height;i.width=n,i.height=d,r.drawImage(t,0,0);var p=r.getImageData(0,0,n,d).data,_=e.VertexData.CreateGroundFromHeightMap({width:o,height:s,subdivisions:a,minHeight:h,maxHeight:c,buffer:p,bufferWidth:n,bufferHeight:d});_.applyToMesh(f,l),f._setReady(!0),u&&u(f)};return e.Tools.LoadImage(i,d,function(){},n.database),f},t.CreateTube=function(i,r,n){var o=r.path,s=r.radius||1,a=r.tessellation||64,h=r.radiusFunction,c=r.cap||e.Mesh.NO_CAP,l=r.updatable,u=r.sideOrientation||e.Mesh.DEFAULTSIDE,f=r.instance;r.arc=r.arc<=0||r.arc>1?1:r.arc||1;var d,p,_=function(t,i,r,n,o,s,a,h){for(var c,l,u,f,d=i.getTangents(),p=i.getNormals(),_=i.getDistances(),m=2*Math.PI,g=m/o*h,v=function(){return n},y=s||v,x=e.Tmp.Matrix[0],b=a===e.Mesh._NO_CAP||a===e.Mesh.CAP_END?0:2,P=0;P<t.length;P++){l=y(P,_[P]),c=Array(),u=p[P];for(var A=0;o>A;A++)e.Matrix.RotationAxisToRef(d[P],g*A,x),f=c[A]?c[A]:e.Vector3.Zero(),e.Vector3.TransformCoordinatesToRef(u,x,f),f.scaleInPlace(l).addInPlace(t[P]),c[A]=f;r[b]=c,b++}var T=function(e,i){for(var r=Array(),n=0;e>n;n++)r.push(t[i]);return r};switch(a){case e.Mesh.NO_CAP:break;case e.Mesh.CAP_START:r[0]=T(o,0),r[1]=r[2].slice(0);break;case e.Mesh.CAP_END:r[b]=r[b-1].slice(0),r[b+1]=T(o,t.length-1);break;case e.Mesh.CAP_ALL:r[0]=T(o,0),r[1]=r[2].slice(0),r[b]=r[b-1].slice(0),r[b+1]=T(o,t.length-1)}return r};if(f){var m=r.arc||f.arc;return d=f.path3D.update(o),p=_(o,d,f.pathArray,s,f.tessellation,h,f.cap,m),f=t.CreateRibbon(null,{pathArray:p,instance:f}),f.path3D=d,f.pathArray=p,f.arc=m,f}d=new e.Path3D(o);var g=new Array;c=0>c||c>3?0:c,p=_(o,d,g,s,a,h,c,r.arc);var v=t.CreateRibbon(i,{pathArray:p,closePath:!0,closeArray:!1,updatable:l,sideOrientation:u},n);return v.pathArray=p,v.path3D=d,v.tessellation=a,v.cap=c,v.arc=r.arc,v},t.CreatePolyhedron=function(t,i,r){var n=new e.Mesh(t,r),o=e.VertexData.CreatePolyhedron(i);return o.applyToMesh(n,i.updatable),n},t.CreateDecal=function(t,i,r){var n=i.getIndices(),o=i.getVerticesData(e.VertexBuffer.PositionKind),s=i.getVerticesData(e.VertexBuffer.NormalKind),a=r.position||e.Vector3.Zero(),h=r.normal||e.Vector3.Up(),c=r.size||new e.Vector3(1,1,1),l=r.angle||0;if(!h){var u=new e.Vector3(0,0,1),f=i.getScene().activeCamera,d=e.Vector3.TransformCoordinates(u,f.getWorldMatrix());h=f.globalPosition.subtract(d)}var p=-Math.atan2(h.z,h.x)-Math.PI/2,_=Math.sqrt(h.x*h.x+h.z*h.z),m=Math.atan2(h.y,_),g=e.Matrix.RotationYawPitchRoll(p,m,l).multiply(e.Matrix.Translation(a.x,a.y,a.z)),v=e.Matrix.Invert(g),y=i.getWorldMatrix(),x=y.multiply(v),b=new e.VertexData;b.indices=[],b.positions=[],b.normals=[],b.uvs=[];for(var P=0,A=function(t){var i=n[t],r=new e.PositionNormalVertex;return r.position=new e.Vector3(o[3*i],o[3*i+1],o[3*i+2]),r.position=e.Vector3.TransformCoordinates(r.position,x),r.normal=new e.Vector3(s[3*i],s[3*i+1],s[3*i+2]),r},T=function(t,i){if(0===t.length)return t;for(var r=.5*Math.abs(e.Vector3.Dot(c,i)),n=function(t,n){var o=e.Vector3.GetClipFactor(t.position,n.position,i,r);return new e.PositionNormalVertex(e.Vector3.Lerp(t.position,n.position,o),e.Vector3.Lerp(t.normal,n.normal,o))},o=new Array,s=0;s<t.length;s+=3){var a,h,l,u,f,d,p,_=0,m=e.Vector3.Dot(t[s].position,i)-r,g=e.Vector3.Dot(t[s+1].position,i)-r,v=e.Vector3.Dot(t[s+2].position,i)-r;switch(a=m>0,h=g>0,l=v>0,_=(a?1:0)+(h?1:0)+(l?1:0)){case 0:o.push(t[s]),o.push(t[s+1]),o.push(t[s+2]);break;case 1:if(a&&(u=t[s+1],f=t[s+2],d=n(t[s],u),p=n(t[s],f)),h){u=t[s],f=t[s+2],d=n(t[s+1],u),p=n(t[s+1],f),o.push(d),o.push(f.clone()),o.push(u.clone()),o.push(f.clone()),o.push(d.clone()),o.push(p);break}l&&(u=t[s],f=t[s+1],d=n(t[s+2],u),p=n(t[s+2],f)),o.push(u.clone()),o.push(f.clone()),o.push(d),o.push(p),o.push(d.clone()),o.push(f.clone());break;case 2:a||(u=t[s].clone(),f=n(u,t[s+1]),d=n(u,t[s+2]),o.push(u),o.push(f),o.push(d)),h||(u=t[s+1].clone(),f=n(u,t[s+2]),d=n(u,t[s]),o.push(u),o.push(f),o.push(d)),l||(u=t[s+2].clone(),f=n(u,t[s]),d=n(u,t[s+1]),o.push(u),o.push(f),o.push(d));break;case 3:}}return o},E=0;E<n.length;E+=3){var C=new Array;if(C.push(A(E)),C.push(A(E+1)),C.push(A(E+2)),C=T(C,new e.Vector3(1,0,0)),C=T(C,new e.Vector3(-1,0,0)),C=T(C,new e.Vector3(0,1,0)),C=T(C,new e.Vector3(0,-1,0)),C=T(C,new e.Vector3(0,0,1)),C=T(C,new e.Vector3(0,0,-1)),0!==C.length)for(var S=0;S<C.length;S++){var M=C[S];b.indices.push(P),M.position.toArray(b.positions,3*P),M.normal.toArray(b.normals,3*P),b.uvs.push(.5+M.position.x/c.x),b.uvs.push(.5+M.position.y/c.y),P++}}var I=new e.Mesh(t,i.getScene());return b.applyToMesh(I),I.position=a.clone(),I.rotation=new e.Vector3(m,p,l),I},t._ExtrudeShapeGeneric=function(t,i,r,n,o,s,a,h,c,l,u,f,d,p,_){var m,g,v=function(t,i,r,n,o,s,a,h,c,l){for(var u=r.getTangents(),f=r.getNormals(),d=r.getBinormals(),p=r.getDistances(),_=0,m=function(){return o},g=function(){return s},v=l?h:g,y=l?a:m,x=c===e.Mesh.NO_CAP||c===e.Mesh.CAP_END?0:2,b=e.Tmp.Matrix[0],P=0;P<i.length;P++){for(var A=new Array,T=v(P,p[P]),E=y(P,p[P]),C=0;C<t.length;C++){e.Matrix.RotationAxisToRef(u[P],_,b);var S=u[P].scale(t[C].z).add(f[P].scale(t[C].x)).add(d[P].scale(t[C].y)),M=A[C]?A[C]:e.Vector3.Zero();e.Vector3.TransformCoordinatesToRef(S,b,M),M.scaleInPlace(E).addInPlace(i[P]),A[C]=M}n[x]=A,_+=T,x++}var I=function(t){var i,r=Array(),n=e.Vector3.Zero();for(i=0;i<t.length;i++)n.addInPlace(t[i]);for(n.scaleInPlace(1/t.length),i=0;i<t.length;i++)r.push(n);return r};switch(c){case e.Mesh.NO_CAP:break;case e.Mesh.CAP_START:n[0]=I(n[2]),n[1]=n[2].slice(0);break;case e.Mesh.CAP_END:n[x]=n[x-1],n[x+1]=I(n[x-1]);break;case e.Mesh.CAP_ALL:n[0]=I(n[2]),n[1]=n[2].slice(0),n[x]=n[x-1],n[x+1]=I(n[x-1])}return n};if(_)return m=_.path3D.update(r),g=v(i,r,_.path3D,_.pathArray,n,o,s,a,_.cap,u),_=e.Mesh.CreateRibbon(null,g,null,null,null,null,null,null,_);m=new e.Path3D(r);var y=new Array;l=0>l||l>3?0:l,g=v(i,r,m,y,n,o,s,a,l,u);var x=e.Mesh.CreateRibbon(t,g,h,c,0,f,d,p);return x.pathArray=g,x.path3D=m,x.cap=l,x},t}();e.MeshBuilder=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(t){this.hasAlpha=!1,this.getAlphaFromRGB=!1,this.level=1,this.coordinatesIndex=0,this.coordinatesMode=e.Texture.EXPLICIT_MODE,this.wrapU=e.Texture.WRAP_ADDRESSMODE,this.wrapV=e.Texture.WRAP_ADDRESSMODE,this.anisotropicFilteringLevel=4,this.isCube=!1,this.isRenderTarget=!1,this.animations=new Array,this.onDisposeObservable=new e.Observable,this.delayLoadState=e.Engine.DELAYLOADSTATE_NONE,this._scene=t,this._scene.textures.push(this)}return t.prototype.toString=function(){return this.name},Object.defineProperty(t.prototype,"onDispose",{set:function(e){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(e)},enumerable:!0,configurable:!0}),t.prototype.getScene=function(){return this._scene},t.prototype.getTextureMatrix=function(){return null},t.prototype.getReflectionTextureMatrix=function(){return null},t.prototype.getInternalTexture=function(){return this._texture},t.prototype.isReady=function(){return this.delayLoadState===e.Engine.DELAYLOADSTATE_NOTLOADED?!0:this._texture?this._texture.isReady:!1},t.prototype.getSize=function(){return this._texture._width?{width:this._texture._width,height:this._texture._height}:this._texture._size?{width:this._texture._size,height:this._texture._size}:{width:0,height:0}},t.prototype.getBaseSize=function(){return this.isReady()&&this._texture?this._texture._size?{width:this._texture._size,height:this._texture._size}:{width:this._texture._baseWidth,height:this._texture._baseHeight}:{width:0,height:0}},t.prototype.scale=function(e){},Object.defineProperty(t.prototype,"canRescale",{get:function(){return!1},enumerable:!0,configurable:!0}),t.prototype._removeFromCache=function(e,t){for(var i=this._scene.getEngine().getLoadedTexturesCache(),r=0;r<i.length;r++){var n=i[r];if(n.url===e&&n.noMipmap===t)return void i.splice(r,1)}},t.prototype._getFromCache=function(e,t,i){for(var r=this._scene.getEngine().getLoadedTexturesCache(),n=0;n<r.length;n++){var o=r[n];if(o.url===e&&o.noMipmap===t&&(!i||i===o.samplingMode))return o.references++,o}return null},t.prototype.delayLoad=function(){},t.prototype.clone=function(){return null},t.prototype.releaseInternalTexture=function(){this._texture&&(this._scene.getEngine().releaseInternalTexture(this._texture),delete this._texture)},t.prototype.dispose=function(){this.getScene().stopAnimation(this);var e=this._scene.textures.indexOf(this);e>=0&&this._scene.textures.splice(e,1),void 0!==this._texture&&(this.releaseInternalTexture(),this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear())},t.prototype.serialize=function(){if(!this.name)return null;var t=e.SerializationHelper.Serialize(this);return e.Animation.AppendSerializedAnimations(this,t),t},__decorate([e.serialize()],t.prototype,"name",void 0),__decorate([e.serialize()],t.prototype,"hasAlpha",void 0),__decorate([e.serialize()],t.prototype,"getAlphaFromRGB",void 0),__decorate([e.serialize()],t.prototype,"level",void 0),__decorate([e.serialize()],t.prototype,"coordinatesIndex",void 0),__decorate([e.serialize()],t.prototype,"coordinatesMode",void 0),__decorate([e.serialize()],t.prototype,"wrapU",void 0),__decorate([e.serialize()],t.prototype,"wrapV",void 0),__decorate([e.serialize()],t.prototype,"anisotropicFilteringLevel",void 0),__decorate([e.serialize()],t.prototype,"isCube",void 0),__decorate([e.serialize()],t.prototype,"isRenderTarget",void 0),t}();e.BaseTexture=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(r,n,o,s,a,h,c,l,u){void 0===a&&(a=i.TRILINEAR_SAMPLINGMODE),void 0===h&&(h=null),void 0===c&&(c=null),void 0===l&&(l=null),void 0===u&&(u=!1),t.call(this,n),this.uOffset=0,this.vOffset=0,this.uScale=1,this.vScale=1,this.uAng=0,this.vAng=0,this.wAng=0,this.name=r,this.url=r,this._noMipmap=o,this._invertY=s,this._samplingMode=a,this._buffer=l,this._deleteBuffer=u,r&&(this._texture=this._getFromCache(r,o,a),this._texture?e.Tools.SetImmediate(function(){h&&h()}):n.useDelayedTextureLoading?(this.delayLoadState=e.Engine.DELAYLOADSTATE_NOTLOADED,this._delayedOnLoad=h,this._delayedOnError=c):(this._texture=n.getEngine().createTexture(r,o,s,n,this._samplingMode,h,c,this._buffer),u&&delete this._buffer))}return __extends(i,t),Object.defineProperty(i.prototype,"noMipmap",{get:function(){return this._noMipmap},enumerable:!0,configurable:!0}),i.prototype.delayLoad=function(){this.delayLoadState===e.Engine.DELAYLOADSTATE_NOTLOADED&&(this.delayLoadState=e.Engine.DELAYLOADSTATE_LOADED,this._texture=this._getFromCache(this.url,this._noMipmap,this._samplingMode),this._texture||(this._texture=this.getScene().getEngine().createTexture(this.url,this._noMipmap,this._invertY,this.getScene(),this._samplingMode,this._delayedOnLoad,this._delayedOnError,this._buffer),this._deleteBuffer&&delete this._buffer))},i.prototype.updateSamplingMode=function(e){this._texture&&(this._samplingMode=e,this.getScene().getEngine().updateTextureSamplingMode(e,this._texture))},i.prototype._prepareRowForTextureGeneration=function(t,i,r,n){t*=this.uScale,i*=this.vScale,t-=.5*this.uScale,i-=.5*this.vScale,r-=.5,e.Vector3.TransformCoordinatesFromFloatsToRef(t,i,r,this._rowGenerationMatrix,n),n.x+=.5*this.uScale+this.uOffset,n.y+=.5*this.vScale+this.vOffset,n.z+=.5},i.prototype.getTextureMatrix=function(){return this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale===this._cachedUScale&&this.vScale===this._cachedVScale&&this.uAng===this._cachedUAng&&this.vAng===this._cachedVAng&&this.wAng===this._cachedWAng?this._cachedTextureMatrix:(this._cachedUOffset=this.uOffset,this._cachedVOffset=this.vOffset,this._cachedUScale=this.uScale,this._cachedVScale=this.vScale,this._cachedUAng=this.uAng,this._cachedVAng=this.vAng,this._cachedWAng=this.wAng,this._cachedTextureMatrix||(this._cachedTextureMatrix=e.Matrix.Zero(),this._rowGenerationMatrix=new e.Matrix,this._t0=e.Vector3.Zero(),this._t1=e.Vector3.Zero(),this._t2=e.Vector3.Zero()),e.Matrix.RotationYawPitchRollToRef(this.vAng,this.uAng,this.wAng,this._rowGenerationMatrix),this._prepareRowForTextureGeneration(0,0,0,this._t0),this._prepareRowForTextureGeneration(1,0,0,this._t1),this._prepareRowForTextureGeneration(0,1,0,this._t2),this._t1.subtractInPlace(this._t0),this._t2.subtractInPlace(this._t0),e.Matrix.IdentityToRef(this._cachedTextureMatrix),this._cachedTextureMatrix.m[0]=this._t1.x,this._cachedTextureMatrix.m[1]=this._t1.y,this._cachedTextureMatrix.m[2]=this._t1.z,this._cachedTextureMatrix.m[4]=this._t2.x,this._cachedTextureMatrix.m[5]=this._t2.y,this._cachedTextureMatrix.m[6]=this._t2.z,this._cachedTextureMatrix.m[8]=this._t0.x,this._cachedTextureMatrix.m[9]=this._t0.y,this._cachedTextureMatrix.m[10]=this._t0.z,this._cachedTextureMatrix)},i.prototype.getReflectionTextureMatrix=function(){if(this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale===this._cachedUScale&&this.vScale===this._cachedVScale&&this.coordinatesMode===this._cachedCoordinatesMode)return this._cachedTextureMatrix;switch(this._cachedTextureMatrix||(this._cachedTextureMatrix=e.Matrix.Zero(),this._projectionModeMatrix=e.Matrix.Zero()),this._cachedCoordinatesMode=this.coordinatesMode,this.coordinatesMode){case i.PLANAR_MODE:e.Matrix.IdentityToRef(this._cachedTextureMatrix),this._cachedTextureMatrix[0]=this.uScale,this._cachedTextureMatrix[5]=this.vScale,this._cachedTextureMatrix[12]=this.uOffset,this._cachedTextureMatrix[13]=this.vOffset;break;case i.PROJECTION_MODE:e.Matrix.IdentityToRef(this._projectionModeMatrix),this._projectionModeMatrix.m[0]=.5,this._projectionModeMatrix.m[5]=-.5,this._projectionModeMatrix.m[10]=0,this._projectionModeMatrix.m[12]=.5,this._projectionModeMatrix.m[13]=.5,this._projectionModeMatrix.m[14]=1,this._projectionModeMatrix.m[15]=1,this.getScene().getProjectionMatrix().multiplyToRef(this._projectionModeMatrix,this._cachedTextureMatrix);break;default:e.Matrix.IdentityToRef(this._cachedTextureMatrix)}return this._cachedTextureMatrix},i.prototype.clone=function(){var t=this;return e.SerializationHelper.Clone(function(){return new i(t._texture.url,t.getScene(),t._noMipmap,t._invertY,t._samplingMode)},this)},i.CreateFromBase64String=function(e,t,r,n,o,s,a,h){return void 0===s&&(s=i.TRILINEAR_SAMPLINGMODE),void 0===a&&(a=null),void 0===h&&(h=null),new i("data:"+t,r,n,o,s,a,h,e)},i.Parse=function(t,r,n){if(t.isCube)return e.CubeTexture.Parse(t,r,n);if(!t.name&&!t.isRenderTarget)return null;var o=e.SerializationHelper.Parse(function(){if(t.mirrorPlane){var o=new e.MirrorTexture(t.name,t.renderTargetSize,r);return o._waitingRenderList=t.renderList,o.mirrorPlane=e.Plane.FromArray(t.mirrorPlane),o}if(t.isRenderTarget){var s=new e.RenderTargetTexture(t.name,t.renderTargetSize,r);return s._waitingRenderList=t.renderList,s}var a;return a=t.base64String?i.CreateFromBase64String(t.base64String,t.name,r):new i(n+t.name,r)},t,r);if(t.animations)for(var s=0;s<t.animations.length;s++){var a=t.animations[s];o.animations.push(e.Animation.Parse(a))}return o},i.NEAREST_SAMPLINGMODE=1,i.BILINEAR_SAMPLINGMODE=2,i.TRILINEAR_SAMPLINGMODE=3,i.EXPLICIT_MODE=0,i.SPHERICAL_MODE=1,i.PLANAR_MODE=2,i.CUBIC_MODE=3,i.PROJECTION_MODE=4,i.SKYBOX_MODE=5,i.INVCUBIC_MODE=6,i.EQUIRECTANGULAR_MODE=7,i.FIXED_EQUIRECTANGULAR_MODE=8,i.CLAMP_ADDRESSMODE=0,i.WRAP_ADDRESSMODE=1,i.MIRROR_ADDRESSMODE=2,__decorate([e.serialize()],i.prototype,"url",void 0),__decorate([e.serialize()],i.prototype,"uOffset",void 0),__decorate([e.serialize()],i.prototype,"vOffset",void 0),__decorate([e.serialize()],i.prototype,"uScale",void 0),__decorate([e.serialize()],i.prototype,"vScale",void 0),__decorate([e.serialize()],i.prototype,"uAng",void 0),__decorate([e.serialize()],i.prototype,"vAng",void 0),__decorate([e.serialize()],i.prototype,"wAng",void 0),i}(e.BaseTexture);e.Texture=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(i,r,n,o,s){if(t.call(this,r),this.coordinatesMode=e.Texture.CUBIC_MODE,this.name=i,this.url=i,this._noMipmap=o,this.hasAlpha=!1,i||s){if(this._texture=this._getFromCache(i,o),!s){n||(n=["_px.jpg","_py.jpg","_pz.jpg","_nx.jpg","_ny.jpg","_nz.jpg"]),s=[];for(var a=0;a<n.length;a++)s.push(i+n[a]);this._extensions=n}this._files=s,this._texture||(r.useDelayedTextureLoading?this.delayLoadState=e.Engine.DELAYLOADSTATE_NOTLOADED:this._texture=r.getEngine().createCubeTexture(i,r,s,o)),this.isCube=!0,this._textureMatrix=e.Matrix.Identity()}}return __extends(i,t),i.CreateFromImages=function(e,t,r){return new i("",t,null,r,e)},i.prototype.delayLoad=function(){this.delayLoadState===e.Engine.DELAYLOADSTATE_NOTLOADED&&(this.delayLoadState=e.Engine.DELAYLOADSTATE_LOADED,this._texture=this._getFromCache(this.url,this._noMipmap),this._texture||(this._texture=this.getScene().getEngine().createCubeTexture(this.url,this.getScene(),this._extensions)))},i.prototype.getReflectionTextureMatrix=function(){return this._textureMatrix},i.Parse=function(t,i,r){var n=e.SerializationHelper.Parse(function(){return new e.CubeTexture(r+t.name,i,t.extensions)},t,i);if(t.animations)for(var o=0;o<t.animations.length;o++){var s=t.animations[o];n.animations.push(e.Animation.Parse(s))}return n},i.prototype.clone=function(){var t=this;return e.SerializationHelper.Clone(function(){return new i(t.url,t.getScene(),t._extensions,t._noMipmap,t._files)},this)},i}(e.BaseTexture);e.CubeTexture=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(i,r,n,o,s,a,h,c){void 0===s&&(s=!0),void 0===a&&(a=e.Engine.TEXTURETYPE_UNSIGNED_INT),void 0===h&&(h=!1),void 0===c&&(c=e.Texture.TRILINEAR_SAMPLINGMODE),t.call(this,null,n,!o),this.isCube=h,this.renderList=new Array,this.renderParticles=!0,this.renderSprites=!1,this.coordinatesMode=e.Texture.PROJECTION_MODE,this.onAfterUnbindObservable=new e.Observable,this.onBeforeRenderObservable=new e.Observable,this.onAfterRenderObservable=new e.Observable,this.onClearObservable=new e.Observable,this._currentRefreshId=-1,this._refreshRate=1,this.name=i,this.isRenderTarget=!0,this._size=r,this._generateMipMaps=o,this._doNotChangeAspectRatio=s,c===e.Texture.NEAREST_SAMPLINGMODE&&(this.wrapU=e.Texture.CLAMP_ADDRESSMODE,this.wrapV=e.Texture.CLAMP_ADDRESSMODE),h?(this._texture=n.getEngine().createRenderTargetCubeTexture(r,{generateMipMaps:o,samplingMode:c}),this.coordinatesMode=e.Texture.INVCUBIC_MODE,this._textureMatrix=e.Matrix.Identity()):this._texture=n.getEngine().createRenderTargetTexture(r,{generateMipMaps:o,type:a,samplingMode:c}),this._renderingManager=new e.RenderingManager(n)}return __extends(i,t),Object.defineProperty(i,"REFRESHRATE_RENDER_ONCE",{get:function(){return i._REFRESHRATE_RENDER_ONCE},enumerable:!0,configurable:!0}),Object.defineProperty(i,"REFRESHRATE_RENDER_ONEVERYFRAME",{get:function(){return i._REFRESHRATE_RENDER_ONEVERYFRAME},enumerable:!0,configurable:!0}),Object.defineProperty(i,"REFRESHRATE_RENDER_ONEVERYTWOFRAMES",{get:function(){return i._REFRESHRATE_RENDER_ONEVERYTWOFRAMES},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"onAfterUnbind",{set:function(e){this._onAfterUnbindObserver&&this.onAfterUnbindObservable.remove(this._onAfterUnbindObserver),this._onAfterUnbindObserver=this.onAfterUnbindObservable.add(e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"onBeforeRender",{set:function(e){this._onBeforeRenderObserver&&this.onBeforeRenderObservable.remove(this._onBeforeRenderObserver),this._onBeforeRenderObserver=this.onBeforeRenderObservable.add(e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"onAfterRender",{set:function(e){this._onAfterRenderObserver&&this.onAfterRenderObservable.remove(this._onAfterRenderObserver),this._onAfterRenderObserver=this.onAfterRenderObservable.add(e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"onClear",{set:function(e){this._onClearObserver&&this.onClearObservable.remove(this._onClearObserver),this._onClearObserver=this.onClearObservable.add(e)},enumerable:!0,configurable:!0}),i.prototype.resetRefreshCounter=function(){this._currentRefreshId=-1},Object.defineProperty(i.prototype,"refreshRate",{get:function(){return this._refreshRate},set:function(e){this._refreshRate=e,this.resetRefreshCounter()},enumerable:!0,configurable:!0}),i.prototype._shouldRender=function(){return-1===this._currentRefreshId?(this._currentRefreshId=1,!0):this.refreshRate===this._currentRefreshId?(this._currentRefreshId=1,!0):(this._currentRefreshId++,!1)},i.prototype.isReady=function(){return this.getScene().renderTargetsEnabled?t.prototype.isReady.call(this):!1},i.prototype.getRenderSize=function(){return this._size},Object.defineProperty(i.prototype,"canRescale",{get:function(){return!0},enumerable:!0,configurable:!0}),i.prototype.scale=function(e){var t=this._size*e;this.resize(t,this._generateMipMaps)},i.prototype.getReflectionTextureMatrix=function(){return this.isCube?this._textureMatrix:t.prototype.getReflectionTextureMatrix.call(this)},i.prototype.resize=function(e,t){this.releaseInternalTexture(),this.isCube?this._texture=this.getScene().getEngine().createRenderTargetCubeTexture(e):this._texture=this.getScene().getEngine().createRenderTargetTexture(e,t)},i.prototype.render=function(e,t){var i=this.getScene();if(void 0!==this.useCameraPostProcesses&&(e=this.useCameraPostProcesses),this.activeCamera&&this.activeCamera!==i.activeCamera&&i.setTransformMatrix(this.activeCamera.getViewMatrix(),this.activeCamera.getProjectionMatrix(!0)),this._waitingRenderList){this.renderList=[];for(var r=0;r<this._waitingRenderList.length;r++){var n=this._waitingRenderList[r];this.renderList.push(i.getMeshByID(n))}delete this._waitingRenderList}if(this.renderListPredicate){this.renderList.splice(0);for(var o=this.getScene().meshes,r=0;r<o.length;r++){var s=o[r];this.renderListPredicate(s)&&this.renderList.push(s)}}if(!this.renderList||0!==this.renderList.length){this._renderingManager.reset();for(var a=this.renderList?this.renderList:i.getActiveMeshes().data,h=i.getRenderId(),c=0;c<a.length;c++){var s=a[c];if(s){if(!s.isReady()){this.resetRefreshCounter();continue}if(s._preActivateForIntermediateRendering(h),s.isEnabled()&&s.isVisible&&s.subMeshes&&0!==(s.layerMask&i.activeCamera.layerMask)){s._activate(h);for(var l=0;l<s.subMeshes.length;l++){var u=s.subMeshes[l];i._activeIndices+=u.indexCount,this._renderingManager.dispatch(u)}}}}if(this.isCube)for(var f=0;6>f;f++)this.renderToTarget(f,a,e,t),i.incrementRenderId(),i.resetCachedMaterial();else this.renderToTarget(0,a,e,t);this.onAfterUnbindObservable.notifyObservers(this),this.activeCamera&&this.activeCamera!==i.activeCamera&&i.setTransformMatrix(i.activeCamera.getViewMatrix(),i.activeCamera.getProjectionMatrix(!0)),i.resetCachedMaterial()}},i.prototype.renderToTarget=function(t,i,r,n){var o=this.getScene(),s=o.getEngine();r&&o.postProcessManager._prepareFrame(this._texture)||(this.isCube?s.bindFramebuffer(this._texture,t):s.bindFramebuffer(this._texture)),this.onBeforeRenderObservable.notifyObservers(t),this.onClearObservable.hasObservers()?this.onClearObservable.notifyObservers(s):s.clear(o.clearColor,!0,!0),this._doNotChangeAspectRatio||o.updateTransformMatrix(!0),this._renderingManager.render(this.customRenderFunction,i,this.renderParticles,this.renderSprites),r&&o.postProcessManager._finalizeFrame(!1,this._texture,t),this._doNotChangeAspectRatio||o.updateTransformMatrix(!0),this.onAfterRenderObservable.notifyObservers(t),n&&e.Tools.DumpFramebuffer(this._size,this._size,s),this.isCube&&5!==t||(this.isCube&&5===t&&s.generateMipMapsForCubemap(this._texture),s.unBindFramebuffer(this._texture,this.isCube))},i.prototype.clone=function(){var e=this.getSize(),t=new i(this.name,e.width,this.getScene(),this._generateMipMaps);return t.hasAlpha=this.hasAlpha,t.level=this.level,t.coordinatesMode=this.coordinatesMode,t.renderList=this.renderList.slice(0),t},i.prototype.serialize=function(){if(!this.name)return null;var e=t.prototype.serialize.call(this);e.renderTargetSize=this.getRenderSize(),e.renderList=[];for(var i=0;i<this.renderList.length;i++)e.renderList.push(this.renderList[i].id);return e},i._REFRESHRATE_RENDER_ONCE=0,i._REFRESHRATE_RENDER_ONEVERYFRAME=1,i._REFRESHRATE_RENDER_ONEVERYTWOFRAMES=2,i}(e.Texture);e.RenderTargetTexture=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(i,r,n,o,s,a,h){void 0===a&&(a=!0),void 0===h&&(h=!1),t.call(this,null,o,!a),this.isCube=h,this.isEnabled=!0,this._currentRefreshId=-1,this._refreshRate=1,this._vertexBuffers={},this._uniforms=new Array,this._samplers=new Array,this._textures=new Array,this._floats=new Array,this._floatsArrays={},this._colors3=new Array,this._colors4=new Array,this._vectors2=new Array,this._vectors3=new Array,this._matrices=new Array,this._fallbackTextureUsed=!1,o._proceduralTextures.push(this),this.name=i,this.isRenderTarget=!0,this._size=r,this._generateMipMaps=a,this.setFragment(n),this._fallbackTexture=s;var c=o.getEngine();h?(this._texture=c.createRenderTargetCubeTexture(r,{generateMipMaps:a}),this.setFloat("face",0)):this._texture=c.createRenderTargetTexture(r,a);var l=[];l.push(1,1),l.push(-1,1),l.push(-1,-1),l.push(1,-1),this._vertexBuffers[e.VertexBuffer.PositionKind]=new e.VertexBuffer(c,l,e.VertexBuffer.PositionKind,!1,!1,2);var u=[];u.push(0),u.push(1),u.push(2),u.push(0),u.push(2),u.push(3),this._indexBuffer=c.createIndexBuffer(u)}return __extends(i,t),i.prototype.reset=function(){if(void 0!==this._effect){var e=this.getScene().getEngine();e._releaseEffect(this._effect)}},i.prototype.isReady=function(){var t,i=this,r=this.getScene().getEngine();return this._fragment?this._fallbackTextureUsed?!0:(t=void 0!==this._fragment.fragmentElement?{vertex:"procedural",fragmentElement:this._fragment.fragmentElement}:{vertex:"procedural",fragment:this._fragment},this._effect=r.createEffect(t,[e.VertexBuffer.PositionKind],this._uniforms,this._samplers,"",null,null,function(){i.releaseInternalTexture(),i._fallbackTexture&&(i._texture=i._fallbackTexture._texture,i._texture.references++),i._fallbackTextureUsed=!0}),this._effect.isReady()):!1},i.prototype.resetRefreshCounter=function(){this._currentRefreshId=-1},i.prototype.setFragment=function(e){this._fragment=e},Object.defineProperty(i.prototype,"refreshRate",{get:function(){return this._refreshRate},set:function(e){this._refreshRate=e,this.resetRefreshCounter()},enumerable:!0,configurable:!0}),i.prototype._shouldRender=function(){return this.isEnabled&&this.isReady()&&this._texture?this._fallbackTextureUsed?!1:-1===this._currentRefreshId?(this._currentRefreshId=1,!0):this.refreshRate===this._currentRefreshId?(this._currentRefreshId=1,!0):(this._currentRefreshId++,!1):!1},i.prototype.getRenderSize=function(){return this._size},i.prototype.resize=function(e,t){this._fallbackTextureUsed||(this.releaseInternalTexture(),this._texture=this.getScene().getEngine().createRenderTargetTexture(e,t))},i.prototype._checkUniform=function(e){-1===this._uniforms.indexOf(e)&&this._uniforms.push(e)},i.prototype.setTexture=function(e,t){return-1===this._samplers.indexOf(e)&&this._samplers.push(e),this._textures[e]=t,this},i.prototype.setFloat=function(e,t){return this._checkUniform(e),this._floats[e]=t,this},i.prototype.setFloats=function(e,t){return this._checkUniform(e),this._floatsArrays[e]=t,this},i.prototype.setColor3=function(e,t){return this._checkUniform(e),this._colors3[e]=t,this},i.prototype.setColor4=function(e,t){return this._checkUniform(e),this._colors4[e]=t,this},i.prototype.setVector2=function(e,t){return this._checkUniform(e),
this._vectors2[e]=t,this},i.prototype.setVector3=function(e,t){return this._checkUniform(e),this._vectors3[e]=t,this},i.prototype.setMatrix=function(e,t){return this._checkUniform(e),this._matrices[e]=t,this},i.prototype.render=function(e){var t=this.getScene(),i=t.getEngine();i.enableEffect(this._effect),i.setState(!1);for(var r in this._textures)this._effect.setTexture(r,this._textures[r]);for(r in this._floats)this._effect.setFloat(r,this._floats[r]);for(r in this._floatsArrays)this._effect.setArray(r,this._floatsArrays[r]);for(r in this._colors3)this._effect.setColor3(r,this._colors3[r]);for(r in this._colors4){var n=this._colors4[r];this._effect.setFloat4(r,n.r,n.g,n.b,n.a)}for(r in this._vectors2)this._effect.setVector2(r,this._vectors2[r]);for(r in this._vectors3)this._effect.setVector3(r,this._vectors3[r]);for(r in this._matrices)this._effect.setMatrix(r,this._matrices[r]);if(i.bindBuffers(this._vertexBuffers,this._indexBuffer,this._effect),this.isCube)for(var o=0;6>o;o++)i.bindFramebuffer(this._texture,o),this._effect.setFloat("face",o),i.clear(t.clearColor,!0,!0),i.draw(!0,0,6),5===o&&i.generateMipMapsForCubemap(this._texture);else i.bindFramebuffer(this._texture),i.clear(t.clearColor,!0,!0),i.draw(!0,0,6);i.unBindFramebuffer(this._texture,this.isCube),this.onGenerated&&this.onGenerated()},i.prototype.clone=function(){var e=this.getSize(),t=new i(this.name,e.width,this._fragment,this.getScene(),this._fallbackTexture,this._generateMipMaps);return t.hasAlpha=this.hasAlpha,t.level=this.level,t.coordinatesMode=this.coordinatesMode,t},i.prototype.dispose=function(){var i=this.getScene()._proceduralTextures.indexOf(this);i>=0&&this.getScene()._proceduralTextures.splice(i,1);var r=this._vertexBuffers[e.VertexBuffer.PositionKind];r&&(r.dispose(),this._vertexBuffers[e.VertexBuffer.PositionKind]=null),this._indexBuffer&&this.getScene().getEngine()._releaseBuffer(this._indexBuffer)&&(this._indexBuffer=null),t.prototype.dispose.call(this)},i}(e.Texture);e.ProceduralTexture=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(i,r,n,o){var s=this;t.call(this,i,r,n,o,!0),this.mirrorPlane=new e.Plane(0,1,0,1),this._transformMatrix=e.Matrix.Zero(),this._mirrorMatrix=e.Matrix.Zero(),this.onBeforeRenderObservable.add(function(){e.Matrix.ReflectionToRef(s.mirrorPlane,s._mirrorMatrix),s._savedViewMatrix=n.getViewMatrix(),s._mirrorMatrix.multiplyToRef(s._savedViewMatrix,s._transformMatrix),n.setTransformMatrix(s._transformMatrix,n.getProjectionMatrix()),n.clipPlane=s.mirrorPlane,n.getEngine().cullBackFaces=!1,n._mirroredCameraPosition=e.Vector3.TransformCoordinates(n.activeCamera.position,s._mirrorMatrix)}),this.onAfterRenderObservable.add(function(){n.setTransformMatrix(s._savedViewMatrix,n.getProjectionMatrix()),n.getEngine().cullBackFaces=!0,n._mirroredCameraPosition=null,delete n.clipPlane})}return __extends(i,t),i.prototype.clone=function(){var e=this.getSize(),t=new i(this.name,e.width,this.getScene(),this._generateMipMaps);return t.hasAlpha=this.hasAlpha,t.level=this.level,t.mirrorPlane=this.mirrorPlane.clone(),t.renderList=this.renderList.slice(0),t},i.prototype.serialize=function(){if(!this.name)return null;var e=t.prototype.serialize.call(this);return e.mirrorPlane=this.mirrorPlane.asArray(),e},i}(e.RenderTargetTexture);e.MirrorTexture=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(i,r,n,o){var s=this;t.call(this,i,r,n,o,!0),this.refractionPlane=new e.Plane(0,1,0,1),this.depth=2,this.onBeforeRenderObservable.add(function(){n.clipPlane=s.refractionPlane}),this.onAfterRenderObservable.add(function(){delete n.clipPlane})}return __extends(i,t),i.prototype.clone=function(){var e=this.getSize(),t=new i(this.name,e.width,this.getScene(),this._generateMipMaps);return t.hasAlpha=this.hasAlpha,t.level=this.level,t.refractionPlane=this.refractionPlane.clone(),t.renderList=this.renderList.slice(0),t.depth=this.depth,t},i.prototype.serialize=function(){if(!this.name)return null;var e=t.prototype.serialize.call(this);return e.mirrorPlane=this.refractionPlane.asArray(),e.depth=this.depth,e},i}(e.RenderTargetTexture);e.RefractionTexture=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(i,r,n,o,s){void 0===s&&(s=e.Texture.TRILINEAR_SAMPLINGMODE),t.call(this,null,n,!o),this.name=i,this.wrapU=e.Texture.CLAMP_ADDRESSMODE,this.wrapV=e.Texture.CLAMP_ADDRESSMODE,this._generateMipMaps=o,r.getContext?(this._canvas=r,this._texture=n.getEngine().createDynamicTexture(r.width,r.height,o,s)):(this._canvas=document.createElement("canvas"),r.width?this._texture=n.getEngine().createDynamicTexture(r.width,r.height,o,s):this._texture=n.getEngine().createDynamicTexture(r,r,o,s));var a=this.getSize();this._canvas.width=a.width,this._canvas.height=a.height,this._context=this._canvas.getContext("2d")}return __extends(i,t),Object.defineProperty(i.prototype,"canRescale",{get:function(){return!0},enumerable:!0,configurable:!0}),i.prototype.scale=function(e){var t=this.getSize();t.width*=e,t.height*=e,this._canvas.width=t.width,this._canvas.height=t.height,this.releaseInternalTexture(),this._texture=this.getScene().getEngine().createDynamicTexture(t.width,t.height,this._generateMipMaps,this._samplingMode)},i.prototype.getContext=function(){return this._context},i.prototype.clear=function(){var e=this.getSize();this._context.fillRect(0,0,e.width,e.height)},i.prototype.update=function(e){this.getScene().getEngine().updateDynamicTexture(this._texture,this._canvas,void 0===e?!0:e)},i.prototype.drawText=function(e,t,i,r,n,o,s,a){void 0===a&&(a=!0);var h=this.getSize();if(o&&(this._context.fillStyle=o,this._context.fillRect(0,0,h.width,h.height)),this._context.font=r,null===t){var c=this._context.measureText(e);t=(h.width-c.width)/2}this._context.fillStyle=n,this._context.fillText(e,t,i),a&&this.update(s)},i.prototype.clone=function(){var e=this.getSize(),t=new i(this.name,e,this.getScene(),this._generateMipMaps);return t.hasAlpha=this.hasAlpha,t.level=this.level,t.wrapU=this.wrapU,t.wrapV=this.wrapV,t},i}(e.Texture);e.DynamicTexture=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(i,r,n,o,s,a){var h=this;void 0===o&&(o=!1),void 0===s&&(s=!1),void 0===a&&(a=e.Texture.TRILINEAR_SAMPLINGMODE),t.call(this,null,n,!o,s),this._autoLaunch=!0;var c;this.name=i,r instanceof HTMLVideoElement?this.video=r:(c=r,this.video=document.createElement("video"),this.video.autoplay=!1,this.video.loop=!0),this._generateMipMaps=o,this._samplingMode=a,e.Tools.IsExponentOfTwo(this.video.videoWidth)&&e.Tools.IsExponentOfTwo(this.video.videoHeight)?(this.wrapU=e.Texture.WRAP_ADDRESSMODE,this.wrapV=e.Texture.WRAP_ADDRESSMODE):(this.wrapU=e.Texture.CLAMP_ADDRESSMODE,this.wrapV=e.Texture.CLAMP_ADDRESSMODE,this._generateMipMaps=!1),c?(this.video.addEventListener("canplaythrough",function(){h._createTexture()}),c.forEach(function(e){var t=document.createElement("source");t.src=e,h.video.appendChild(t)})):this._createTexture(),this._lastUpdate=e.Tools.Now}return __extends(i,t),i.prototype._createTexture=function(){this._texture=this.getScene().getEngine().createDynamicTexture(this.video.videoWidth,this.video.videoHeight,this._generateMipMaps,this._samplingMode),this._texture.isReady=!0},i.prototype.update=function(){this._autoLaunch&&(this._autoLaunch=!1,this.video.play());var t=e.Tools.Now;return t-this._lastUpdate<15||this.video.readyState!==this.video.HAVE_ENOUGH_DATA?!1:(this._lastUpdate=t,this.getScene().getEngine().updateVideoTexture(this._texture,this.video,this._invertY),!0)},i}(e.Texture);e.VideoTexture=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(e,i,r,n,o,s){t.call(this,e,r,null,n,o,s),this._animate=!0,this._time=0,this._texturePath=i,this.loadJson(i),this.refreshRate=1}return __extends(i,t),i.prototype.loadJson=function(t){function i(){e.Tools.Log("No config file found in "+t+" trying to use ShadersStore or DOM element");try{n.setFragment(n._texturePath)}catch(i){e.Tools.Error("No json or ShaderStore or DOM element found for CustomProceduralTexture")}}var r=this,n=this,o=t+"/config.json",s=new XMLHttpRequest;s.open("GET",o,!0),s.addEventListener("load",function(){if(200===s.status||e.Tools.ValidateXHRData(s,1))try{r._config=JSON.parse(s.response),r.updateShaderUniforms(),r.updateTextures(),r.setFragment(r._texturePath+"/custom"),r._animate=r._config.animate,r.refreshRate=r._config.refreshrate}catch(t){i()}else i()},!1),s.addEventListener("error",function(){i()},!1);try{s.send()}catch(a){e.Tools.Error("CustomProceduralTexture: Error on XHR send request.")}},i.prototype.isReady=function(){if(!t.prototype.isReady.call(this))return!1;for(var e in this._textures){var i=this._textures[e];if(!i.isReady())return!1}return!0},i.prototype.render=function(e){this._animate&&(this._time+=.03*this.getScene().getAnimationRatio(),this.updateShaderUniforms()),t.prototype.render.call(this,e)},i.prototype.updateTextures=function(){for(var t=0;t<this._config.sampler2Ds.length;t++)this.setTexture(this._config.sampler2Ds[t].sample2Dname,new e.Texture(this._texturePath+"/"+this._config.sampler2Ds[t].textureRelativeUrl,this.getScene()))},i.prototype.updateShaderUniforms=function(){if(this._config)for(var t=0;t<this._config.uniforms.length;t++){var i=this._config.uniforms[t];switch(i.type){case"float":this.setFloat(i.name,i.value);break;case"color3":this.setColor3(i.name,new e.Color3(i.r,i.g,i.b));break;case"color4":this.setColor4(i.name,new e.Color4(i.r,i.g,i.b,i.a));break;case"vector2":this.setVector2(i.name,new e.Vector2(i.x,i.y));break;case"vector3":this.setVector3(i.name,new e.Vector3(i.x,i.y,i.z))}}this.setFloat("time",this._time)},Object.defineProperty(i.prototype,"animate",{get:function(){return this._animate},set:function(e){this._animate=e},enumerable:!0,configurable:!0}),i}(e.ProceduralTexture);e.CustomProceduralTexture=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(){this._defines={},this._currentRank=32,this._maxRank=-1}return t.prototype.addFallback=function(e,t){this._defines[e]||(e<this._currentRank&&(this._currentRank=e),e>this._maxRank&&(this._maxRank=e),this._defines[e]=new Array),this._defines[e].push(t)},t.prototype.addCPUSkinningFallback=function(e,t){this._meshRank=e,this._mesh=t,e>this._maxRank&&(this._maxRank=e)},Object.defineProperty(t.prototype,"isMoreFallbacks",{get:function(){return this._currentRank<=this._maxRank},enumerable:!0,configurable:!0}),t.prototype.reduce=function(t){for(var i=this._defines[this._currentRank],r=0;r<i.length;r++)t=t.replace("#define "+i[r],"");return this._mesh&&this._currentRank===this._meshRank&&(this._mesh.computeBonesUsingShaders=!1,t=t.replace("#define NUM_BONE_INFLUENCERS "+this._mesh.numBoneInfluencers,"#define NUM_BONE_INFLUENCERS 0"),e.Tools.Log("Falling back to CPU skinning for "+this._mesh.name)),this._currentRank++,t},t}();e.EffectFallbacks=t;var i=function(){function t(e,t,i,r,n,o,s,a,h,c){var l=this;this._isReady=!1,this._compilationError="",this._valueCache=[],this._engine=n,this.name=e,this.defines=o,this._uniformsNames=i.concat(r),this._samplers=r,this._attributesNames=t,this.onError=h,this.onCompiled=a,this._indexParameters=c;var u,f;e.vertexElement?(u=document.getElementById(e.vertexElement),u||(u=e.vertexElement)):u=e.vertex||e,e.fragmentElement?(f=document.getElementById(e.fragmentElement),f||(f=e.fragmentElement)):f=e.fragment||e,this._loadVertexShader(u,function(e){l._processIncludes(e,function(e){l._loadFragmentShader(f,function(i){l._processIncludes(i,function(i){l._prepareEffect(e,i,t,o,s)})})})})}return t.prototype.isReady=function(){return this._isReady},t.prototype.getProgram=function(){return this._program},t.prototype.getAttributesNames=function(){return this._attributesNames},t.prototype.getAttributeLocation=function(e){return this._attributes[e]},t.prototype.getAttributeLocationByName=function(e){var t=this._attributesNames.indexOf(e);return this._attributes[t]},t.prototype.getAttributesCount=function(){return this._attributes.length},t.prototype.getUniformIndex=function(e){return this._uniformsNames.indexOf(e)},t.prototype.getUniform=function(e){return this._uniforms[this._uniformsNames.indexOf(e)]},t.prototype.getSamplers=function(){return this._samplers},t.prototype.getCompilationError=function(){return this._compilationError},t.prototype._loadVertexShader=function(i,r){if(i instanceof HTMLElement){var n=e.Tools.GetDOMTextContent(i);return void r(n)}if(t.ShadersStore[i+"VertexShader"])return void r(t.ShadersStore[i+"VertexShader"]);var o;o="."===i[0]||"/"===i[0]||i.indexOf("http")>-1?i:e.Engine.ShadersRepository+i,e.Tools.LoadFile(o+".vertex.fx",r)},t.prototype._loadFragmentShader=function(i,r){if(i instanceof HTMLElement){var n=e.Tools.GetDOMTextContent(i);return void r(n)}if(t.ShadersStore[i+"PixelShader"])return void r(t.ShadersStore[i+"PixelShader"]);if(t.ShadersStore[i+"FragmentShader"])return void r(t.ShadersStore[i+"FragmentShader"]);var o;o="."===i[0]||"/"===i[0]||i.indexOf("http")>-1?i:e.Engine.ShadersRepository+i,e.Tools.LoadFile(o+".fragment.fx",r)},t.prototype._dumpShadersName=function(){this.name.vertexElement?(e.Tools.Error("Vertex shader:"+this.name.vertexElement),e.Tools.Error("Fragment shader:"+this.name.fragmentElement)):this.name.vertex?(e.Tools.Error("Vertex shader:"+this.name.vertex),e.Tools.Error("Fragment shader:"+this.name.fragment)):(e.Tools.Error("Vertex shader:"+this.name),e.Tools.Error("Fragment shader:"+this.name))},t.prototype._processIncludes=function(i,r){for(var n=this,o=/#include<(.+)>(\((.*)\))*(\[(.*)\])*/g,s=o.exec(i),a=new String(i);null!=s;){var h=s[1];if(!t.IncludesShadersStore[h]){var c=e.Engine.ShadersRepository+"ShadersInclude/"+h+".fx";return void e.Tools.LoadFile(c,function(e){t.IncludesShadersStore[h]=e,n._processIncludes(a,r)})}var l=t.IncludesShadersStore[h];if(s[2])for(var u=s[3].split(","),f=0;f<u.length;f+=2){var d=new RegExp(u[f],"g"),p=u[f+1];l=l.replace(d,p)}if(s[4]){var _=s[5];if(-1!==_.indexOf("..")){var m=_.split(".."),g=parseInt(m[0]),v=parseInt(m[1]),y=l.slice(0);l="",isNaN(v)&&(v=this._indexParameters[m[1]]);for(var x=g;v>=x;x++)l+=y.replace(/\{X\}/g,x)+"\n"}else l=l.replace(/\{X\}/g,_)}a=a.replace(s[0],l),s=o.exec(i)}r(a)},t.prototype._processPrecision=function(e){return-1===e.indexOf("precision highp float")?e=this._engine.getCaps().highPrecisionShaderSupported?"precision highp float;\n"+e:"precision mediump float;\n"+e:this._engine.getCaps().highPrecisionShaderSupported||(e=e.replace("precision highp float","precision mediump float")),e},t.prototype._prepareEffect=function(t,i,r,n,o){try{var s=this._engine;t=this._processPrecision(t),i=this._processPrecision(i),this._program=s.createShaderProgram(t,i,n),this._uniforms=s.getUniforms(this._program,this._uniformsNames),this._attributes=s.getAttributes(this._program,r);for(var a=0;a<this._samplers.length;a++){var h=this.getUniform(this._samplers[a]);null==h&&(this._samplers.splice(a,1),a--)}s.bindSamplers(this),this._isReady=!0,this.onCompiled&&this.onCompiled(this)}catch(c){if(-1!==c.message.indexOf("highp"))return t=t.replace("precision highp float","precision mediump float"),i=i.replace("precision highp float","precision mediump float"),void this._prepareEffect(t,i,r,n,o);o&&o.isMoreFallbacks?(e.Tools.Error("Unable to compile effect with current defines. Trying next fallback."),this._dumpShadersName(),n=o.reduce(n),this._prepareEffect(t,i,r,n,o)):(e.Tools.Error("Unable to compile effect: "),this._dumpShadersName(),e.Tools.Error("Defines: "+n),e.Tools.Error("Error: "+c.message),this._compilationError=c.message,this.onError&&this.onError(this,this._compilationError))}},Object.defineProperty(t.prototype,"isSupported",{get:function(){return""===this._compilationError},enumerable:!0,configurable:!0}),t.prototype._bindTexture=function(e,t){this._engine._bindTexture(this._samplers.indexOf(e),t)},t.prototype.setTexture=function(e,t){this._engine.setTexture(this._samplers.indexOf(e),t)},t.prototype.setTextureFromPostProcess=function(e,t){this._engine.setTextureFromPostProcess(this._samplers.indexOf(e),t)},t.prototype._cacheMatrix=function(t,i){this._valueCache[t]||(this._valueCache[t]=new e.Matrix);for(var r=0;16>r;r++)this._valueCache[t].m[r]=i.m[r]},t.prototype._cacheFloat2=function(e,t,i){return this._valueCache[e]?(this._valueCache[e][0]=t,void(this._valueCache[e][1]=i)):void(this._valueCache[e]=[t,i])},t.prototype._cacheFloat3=function(e,t,i,r){return this._valueCache[e]?(this._valueCache[e][0]=t,this._valueCache[e][1]=i,void(this._valueCache[e][2]=r)):void(this._valueCache[e]=[t,i,r])},t.prototype._cacheFloat4=function(e,t,i,r,n){return this._valueCache[e]?(this._valueCache[e][0]=t,this._valueCache[e][1]=i,this._valueCache[e][2]=r,void(this._valueCache[e][3]=n)):void(this._valueCache[e]=[t,i,r,n])},t.prototype.setArray=function(e,t){return this._engine.setArray(this.getUniform(e),t),this},t.prototype.setArray2=function(e,t){return this._engine.setArray2(this.getUniform(e),t),this},t.prototype.setArray3=function(e,t){return this._engine.setArray3(this.getUniform(e),t),this},t.prototype.setArray4=function(e,t){return this._engine.setArray4(this.getUniform(e),t),this},t.prototype.setMatrices=function(e,t){return this._engine.setMatrices(this.getUniform(e),t),this},t.prototype.setMatrix=function(e,t){return this._engine.setMatrix(this.getUniform(e),t),this},t.prototype.setMatrix3x3=function(e,t){return this._engine.setMatrix3x3(this.getUniform(e),t),this},t.prototype.setMatrix2x2=function(e,t){return this._engine.setMatrix2x2(this.getUniform(e),t),this},t.prototype.setFloat=function(e,t){return this._valueCache[e]&&this._valueCache[e]===t?this:(this._valueCache[e]=t,this._engine.setFloat(this.getUniform(e),t),this)},t.prototype.setBool=function(e,t){return this._valueCache[e]&&this._valueCache[e]===t?this:(this._valueCache[e]=t,this._engine.setBool(this.getUniform(e),t?1:0),this)},t.prototype.setVector2=function(e,t){return this._valueCache[e]&&this._valueCache[e][0]===t.x&&this._valueCache[e][1]===t.y?this:(this._cacheFloat2(e,t.x,t.y),this._engine.setFloat2(this.getUniform(e),t.x,t.y),this)},t.prototype.setFloat2=function(e,t,i){return this._valueCache[e]&&this._valueCache[e][0]===t&&this._valueCache[e][1]===i?this:(this._cacheFloat2(e,t,i),this._engine.setFloat2(this.getUniform(e),t,i),this)},t.prototype.setVector3=function(e,t){return this._valueCache[e]&&this._valueCache[e][0]===t.x&&this._valueCache[e][1]===t.y&&this._valueCache[e][2]===t.z?this:(this._cacheFloat3(e,t.x,t.y,t.z),this._engine.setFloat3(this.getUniform(e),t.x,t.y,t.z),this)},t.prototype.setFloat3=function(e,t,i,r){return this._valueCache[e]&&this._valueCache[e][0]===t&&this._valueCache[e][1]===i&&this._valueCache[e][2]===r?this:(this._cacheFloat3(e,t,i,r),this._engine.setFloat3(this.getUniform(e),t,i,r),this)},t.prototype.setVector4=function(e,t){return this._valueCache[e]&&this._valueCache[e][0]===t.x&&this._valueCache[e][1]===t.y&&this._valueCache[e][2]===t.z&&this._valueCache[e][3]===t.w?this:(this._cacheFloat4(e,t.x,t.y,t.z,t.w),this._engine.setFloat4(this.getUniform(e),t.x,t.y,t.z,t.w),this)},t.prototype.setFloat4=function(e,t,i,r,n){return this._valueCache[e]&&this._valueCache[e][0]===t&&this._valueCache[e][1]===i&&this._valueCache[e][2]===r&&this._valueCache[e][3]===n?this:(this._cacheFloat4(e,t,i,r,n),this._engine.setFloat4(this.getUniform(e),t,i,r,n),this)},t.prototype.setColor3=function(e,t){return this._valueCache[e]&&this._valueCache[e][0]===t.r&&this._valueCache[e][1]===t.g&&this._valueCache[e][2]===t.b?this:(this._cacheFloat3(e,t.r,t.g,t.b),this._engine.setColor3(this.getUniform(e),t),this)},t.prototype.setColor4=function(e,t,i){return this._valueCache[e]&&this._valueCache[e][0]===t.r&&this._valueCache[e][1]===t.g&&this._valueCache[e][2]===t.b&&this._valueCache[e][3]===i?this:(this._cacheFloat4(e,t.r,t.g,t.b,i),this._engine.setColor4(this.getUniform(e),t,i),this)},t.ShadersStore={},t.IncludesShadersStore={},t}();e.Effect=i}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(){}return t.PrepareDefinesForLights=function(t,i,r,n){void 0===n&&(n=4);for(var o=0,s=!1,a=!1,h=0;h<t.lights.length;h++){var c=t.lights[h];if(c.isEnabled()){if(c._excludedMeshesIds.length>0){for(var l=0;l<c._excludedMeshesIds.length;l++){var u=t.getMeshByID(c._excludedMeshesIds[l]);u&&c.excludedMeshes.push(u)}c._excludedMeshesIds=[]}if(c._includedOnlyMeshesIds.length>0){for(var f=0;f<c._includedOnlyMeshesIds.length;f++){var d=t.getMeshByID(c._includedOnlyMeshesIds[f]);d&&c.includedOnlyMeshes.push(d)}c._includedOnlyMeshesIds=[]}if(c.canAffectMesh(i)){s=!0,void 0===r["LIGHT"+o]&&(a=!0),r["LIGHT"+o]=!0;var p;if(p=c instanceof e.SpotLight?"SPOTLIGHT"+o:c instanceof e.HemisphericLight?"HEMILIGHT"+o:c instanceof e.PointLight?"POINTLIGHT"+o:"DIRLIGHT"+o,void 0===r[p]&&(a=!0),r[p]=!0,c.specular.equalsFloats(0,0,0)||void 0===r.SPECULARTERM||(r.SPECULARTERM=!0),t.shadowsEnabled){var _=c.getShadowGenerator();i&&i.receiveShadows&&_&&(void 0===r["SHADOW"+o]&&(a=!0),r["SHADOW"+o]=!0,r.SHADOWS=!0,(_.useVarianceShadowMap||_.useBlurVarianceShadowMap)&&(void 0===r["SHADOWVSM"+o]&&(a=!0),r["SHADOWVSM"+o]=!0),_.usePoissonSampling&&(void 0===r["SHADOWPCF"+o]&&(a=!0),r["SHADOWPCF"+o]=!0))}if(o++,o===n)break}}}return a&&r.rebuild(),s},t.PrepareUniformsAndSamplersList=function(e,t,i,r){void 0===r&&(r=4);for(var n=0;r>n&&i["LIGHT"+n];n++)e.push("vLightData"+n,"vLightDiffuse"+n,"vLightSpecular"+n,"vLightDirection"+n,"vLightGround"+n,"lightMatrix"+n,"shadowsInfo"+n),t.push("shadowSampler"+n)},t.HandleFallbacksForShadows=function(e,t,i){void 0===i&&(i=4);for(var r=0;i>r&&e["LIGHT"+r];r++)r>0&&t.addFallback(r,"LIGHT"+r),e["SHADOW"+r]&&t.addFallback(0,"SHADOW"+r),e["SHADOWPCF"+r]&&t.addFallback(0,"SHADOWPCF"+r),e["SHADOWVSM"+r]&&t.addFallback(0,"SHADOWVSM"+r)},t.PrepareAttributesForBones=function(t,i,r,n){r.NUM_BONE_INFLUENCERS>0&&(n.addCPUSkinningFallback(0,i),t.push(e.VertexBuffer.MatricesIndicesKind),t.push(e.VertexBuffer.MatricesWeightsKind),r.NUM_BONE_INFLUENCERS>4&&(t.push(e.VertexBuffer.MatricesIndicesExtraKind),t.push(e.VertexBuffer.MatricesWeightsExtraKind)))},t.PrepareAttributesForInstances=function(e,t){t.INSTANCES&&(e.push("world0"),e.push("world1"),e.push("world2"),e.push("world3"))},t.BindLightShadow=function(e,t,i,r,n,o){var s=e.getShadowGenerator();return i.receiveShadows&&s&&(e.needCube()?o||(o=!0,n.setFloat2("depthValues",t.activeCamera.minZ,t.activeCamera.maxZ)):n.setMatrix("lightMatrix"+r,s.getTransformMatrix()),n.setTexture("shadowSampler"+r,s.getShadowMapForRendering()),n.setFloat3("shadowsInfo"+r,s.getDarkness(),s.blurScale/s.getShadowMap().getSize().width,s.bias)),o},t.BindLightProperties=function(t,i,r){t instanceof e.PointLight?t.transferToEffect(i,"vLightData"+r):t instanceof e.DirectionalLight?t.transferToEffect(i,"vLightData"+r):t instanceof e.SpotLight?t.transferToEffect(i,"vLightData"+r,"vLightDirection"+r):t instanceof e.HemisphericLight&&t.transferToEffect(i,"vLightData"+r,"vLightGround"+r)},t.BindLights=function(i,r,n,o,s){void 0===s&&(s=4);for(var a=0,h=!1,c=0;c<i.lights.length;c++){var l=i.lights[c];if(l.isEnabled()&&l.canAffectMesh(r)&&(t.BindLightProperties(l,n,a),l.diffuse.scaleToRef(l.intensity,e.Tmp.Color3[0]),n.setColor4("vLightDiffuse"+a,e.Tmp.Color3[0],l.range),o.SPECULARTERM&&(l.specular.scaleToRef(l.intensity,e.Tmp.Color3[1]),n.setColor3("vLightSpecular"+a,e.Tmp.Color3[1])),i.shadowsEnabled&&(h=this.BindLightShadow(l,i,r,a,n,h)),a++,a===s))break}},t.BindFogParameters=function(t,i,r){t.fogEnabled&&i.applyFog&&t.fogMode!==e.Scene.FOGMODE_NONE&&(r.setFloat4("vFogInfos",t.fogMode,t.fogStart,t.fogEnd,t.fogDensity),r.setColor3("vFogColor",t.fogColor))},t.BindBonesParameters=function(e,t){e&&e.useBones&&e.computeBonesUsingShaders&&t.setMatrices("mBones",e.skeleton.getTransformMatrices(e))},t.BindLogDepth=function(e,t,i){e.LOGARITHMICDEPTH&&t.setFloat("logarithmicDepthConstant",2/(Math.log(i.activeCamera.maxZ+1)/Math.LN2))},t.BindClipPlane=function(e,t){if(t.clipPlane){var i=t.clipPlane;e.setFloat4("vClipPlane",i.normal.x,i.normal.y,i.normal.z,i.d)}},t}();e.MaterialHelper=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(){this.isEnabled=!0,this.leftColor=e.Color3.White(),this.rightColor=e.Color3.Black(),this.bias=0,this.power=1}return t.prototype.clone=function(){var i=new t;return e.Tools.DeepCopy(this,i),new t},t.prototype.serialize=function(){var e={};return e.isEnabled=this.isEnabled,e.leftColor=this.leftColor,e.rightColor=this.rightColor,e.bias=this.bias,e.power=this.power,e},t.Parse=function(i){var r=new t;return r.isEnabled=i.isEnabled,r.leftColor=e.Color3.FromArray(i.leftColor),r.rightColor=e.Color3.FromArray(i.rightColor),r.bias=i.bias,r.power=i.power||1,r},t}();e.FresnelParameters=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function e(){}return e.prototype.rebuild=function(){this._keys&&delete this._keys,this._keys=Object.keys(this)},e.prototype.isEqual=function(e){if(this._keys.length!==e._keys.length)return!1;for(var t=0;t<this._keys.length;t++){var i=this._keys[t];if(this[i]!==e[i])return!1}return!0},e.prototype.cloneTo=function(e){this._keys.length!==e._keys.length&&(e._keys=this._keys.slice(0));for(var t=0;t<this._keys.length;t++){var i=this._keys[t];e[i]=this[i]}},e.prototype.reset=function(){for(var e=0;e<this._keys.length;e++){var t=this._keys[e];"number"==typeof this[t]?this[t]=0:this[t]=!1}},e.prototype.toString=function(){for(var e="",t=0;t<this._keys.length;t++){var i=this._keys[t];"number"==typeof this[i]?e+="#define "+i+" "+this[i]+"\n":this[i]&&(e+="#define "+i+"\n")}return e},e}();e.MaterialDefines=t;var i=function(){function t(i,r,n){this.name=i,this.checkReadyOnEveryCall=!1,this.checkReadyOnlyOnce=!1,this.state="",this.alpha=1,this.backFaceCulling=!0,this.sideOrientation=t.CounterClockWiseSideOrientation,this.onDisposeObservable=new e.Observable,this.onBindObservable=new e.Observable,this.alphaMode=e.Engine.ALPHA_COMBINE,this.disableDepthWrite=!1,this.fogEnabled=!0,this.pointSize=1,this.zOffset=0,this._wasPreviouslyReady=!1,this._fillMode=t.TriangleFillMode,this.id=i,this._scene=r,n||r.materials.push(this)}return Object.defineProperty(t,"TriangleFillMode",{get:function(){return t._TriangleFillMode},enumerable:!0,configurable:!0}),Object.defineProperty(t,"WireFrameFillMode",{get:function(){return t._WireFrameFillMode},enumerable:!0,configurable:!0}),Object.defineProperty(t,"PointFillMode",{get:function(){return t._PointFillMode},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ClockWiseSideOrientation",{get:function(){return t._ClockWiseSideOrientation},enumerable:!0,configurable:!0}),Object.defineProperty(t,"CounterClockWiseSideOrientation",{get:function(){return t._CounterClockWiseSideOrientation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onDispose",{set:function(e){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onBind",{set:function(e){this._onBindObserver&&this.onBindObservable.remove(this._onBindObserver),this._onBindObserver=this.onBindObservable.add(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wireframe",{get:function(){return this._fillMode===t.WireFrameFillMode},set:function(e){this._fillMode=e?t.WireFrameFillMode:t.TriangleFillMode},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pointsCloud",{get:function(){return this._fillMode===t.PointFillMode},set:function(e){this._fillMode=e?t.PointFillMode:t.TriangleFillMode},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fillMode",{get:function(){return this._fillMode},set:function(e){this._fillMode=e},enumerable:!0,configurable:!0}),t.prototype.toString=function(e){var t="Name: "+this.name;return t},Object.defineProperty(t.prototype,"isFrozen",{get:function(){return this.checkReadyOnlyOnce},enumerable:!0,configurable:!0}),t.prototype.freeze=function(){this.checkReadyOnlyOnce=!0},t.prototype.unfreeze=function(){this.checkReadyOnlyOnce=!1},t.prototype.isReady=function(e,t){return!0},t.prototype.getEffect=function(){return this._effect},t.prototype.getScene=function(){return this._scene},t.prototype.needAlphaBlending=function(){return this.alpha<1},t.prototype.needAlphaTesting=function(){return!1},t.prototype.getAlphaTestTexture=function(){return null},t.prototype.markDirty=function(){this._wasPreviouslyReady=!1},t.prototype._preBind=function(){var e=this._scene.getEngine();e.enableEffect(this._effect),e.setState(this.backFaceCulling,this.zOffset,!1,this.sideOrientation===t.ClockWiseSideOrientation)},t.prototype.bind=function(e,t){if(this._scene._cachedMaterial=this,this.onBindObservable.notifyObservers(t),this.disableDepthWrite){var i=this._scene.getEngine();this._cachedDepthWriteState=i.getDepthWrite(),i.setDepthWrite(!1)}},t.prototype.bindOnlyWorldMatrix=function(e){},t.prototype.unbind=function(){if(this.disableDepthWrite){var e=this._scene.getEngine();e.setDepthWrite(this._cachedDepthWriteState)}},t.prototype.clone=function(e){return null},t.prototype.getBindedMeshes=function(){for(var e=new Array,t=0;t<this._scene.meshes.length;t++){var i=this._scene.meshes[t];i.material===this&&e.push(i)}return e},t.prototype.dispose=function(e,t){this.getScene().stopAnimation(this);var i=this._scene.materials.indexOf(this);for(i>=0&&this._scene.materials.splice(i,1),e&&this._effect&&(this._scene.getEngine()._releaseEffect(this._effect),this._effect=null),i=0;i<this._scene.meshes.length;i++){var r=this._scene.meshes[i];r.material===this&&(r.material=null)}this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear(),this.onBindObservable.clear()},t.prototype.serialize=function(){return e.SerializationHelper.Serialize(this)},t.ParseMultiMaterial=function(t,i){var r=new e.MultiMaterial(t.name,i);r.id=t.id,e.Tags.AddTagsTo(r,t.tags);for(var n=0;n<t.materials.length;n++){var o=t.materials[n];o?r.subMaterials.push(i.getMaterialByID(o)):r.subMaterials.push(null)}return r},t.Parse=function(t,i,r){if(!t.customType)return e.StandardMaterial.Parse(t,i,r);var n=e.Tools.Instantiate(t.customType);return n.Parse(t,i,r)},t._TriangleFillMode=0,t._WireFrameFillMode=1,t._PointFillMode=2,t._ClockWiseSideOrientation=0,t._CounterClockWiseSideOrientation=1,__decorate([e.serialize()],t.prototype,"id",void 0),__decorate([e.serialize()],t.prototype,"checkReadyOnEveryCall",void 0),__decorate([e.serialize()],t.prototype,"checkReadyOnlyOnce",void 0),__decorate([e.serialize()],t.prototype,"state",void 0),__decorate([e.serialize()],t.prototype,"alpha",void 0),__decorate([e.serialize()],t.prototype,"backFaceCulling",void 0),__decorate([e.serialize()],t.prototype,"sideOrientation",void 0),__decorate([e.serialize()],t.prototype,"alphaMode",void 0),__decorate([e.serialize()],t.prototype,"disableDepthWrite",void 0),__decorate([e.serialize()],t.prototype,"fogEnabled",void 0),__decorate([e.serialize()],t.prototype,"pointSize",void 0),__decorate([e.serialize()],t.prototype,"zOffset",void 0),__decorate([e.serialize()],t.prototype,"wireframe",null),__decorate([e.serialize()],t.prototype,"pointsCloud",null),__decorate([e.serialize()],t.prototype,"fillMode",null),t}();e.Material=i}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(e){function t(){e.call(this),this.DIFFUSE=!1,this.AMBIENT=!1,this.OPACITY=!1,this.OPACITYRGB=!1,this.REFLECTION=!1,this.EMISSIVE=!1,this.SPECULAR=!1,this.BUMP=!1,this.PARALLAX=!1,this.PARALLAXOCCLUSION=!1,this.SPECULAROVERALPHA=!1,this.CLIPPLANE=!1,this.ALPHATEST=!1,this.ALPHAFROMDIFFUSE=!1,this.POINTSIZE=!1,this.FOG=!1,this.SPECULARTERM=!1,this.DIFFUSEFRESNEL=!1,this.OPACITYFRESNEL=!1,this.REFLECTIONFRESNEL=!1,this.REFRACTIONFRESNEL=!1,this.EMISSIVEFRESNEL=!1,this.FRESNEL=!1,this.NORMAL=!1,this.UV1=!1,this.UV2=!1,this.VERTEXCOLOR=!1,this.VERTEXALPHA=!1,this.NUM_BONE_INFLUENCERS=0,this.BonesPerMesh=0,this.INSTANCES=!1,this.GLOSSINESS=!1,
this.ROUGHNESS=!1,this.EMISSIVEASILLUMINATION=!1,this.LINKEMISSIVEWITHDIFFUSE=!1,this.REFLECTIONFRESNELFROMSPECULAR=!1,this.LIGHTMAP=!1,this.USELIGHTMAPASSHADOWMAP=!1,this.REFLECTIONMAP_3D=!1,this.REFLECTIONMAP_SPHERICAL=!1,this.REFLECTIONMAP_PLANAR=!1,this.REFLECTIONMAP_CUBIC=!1,this.REFLECTIONMAP_PROJECTION=!1,this.REFLECTIONMAP_SKYBOX=!1,this.REFLECTIONMAP_EXPLICIT=!1,this.REFLECTIONMAP_EQUIRECTANGULAR=!1,this.REFLECTIONMAP_EQUIRECTANGULAR_FIXED=!1,this.INVERTCUBICMAP=!1,this.LOGARITHMICDEPTH=!1,this.REFRACTION=!1,this.REFRACTIONMAP_3D=!1,this.REFLECTIONOVERALPHA=!1,this.INVERTNORMALMAPX=!1,this.INVERTNORMALMAPY=!1,this.rebuild()}return __extends(t,e),t}(e.MaterialDefines),i=function(i){function r(r,n){var o=this;i.call(this,r,n),this.ambientColor=new e.Color3(0,0,0),this.diffuseColor=new e.Color3(1,1,1),this.specularColor=new e.Color3(1,1,1),this.emissiveColor=new e.Color3(0,0,0),this.specularPower=64,this.useAlphaFromDiffuseTexture=!1,this.useEmissiveAsIllumination=!1,this.linkEmissiveWithDiffuse=!1,this.useReflectionFresnelFromSpecular=!1,this.useSpecularOverAlpha=!1,this.useReflectionOverAlpha=!1,this.disableLighting=!1,this.useParallax=!1,this.useParallaxOcclusion=!1,this.parallaxScaleBias=.05,this.roughness=0,this.indexOfRefraction=.98,this.invertRefractionY=!0,this.useLightmapAsShadowmap=!1,this.useGlossinessFromSpecularMapAlpha=!1,this.maxSimultaneousLights=4,this.invertNormalMapX=!1,this.invertNormalMapY=!1,this._renderTargets=new e.SmartArray(16),this._worldViewProjectionMatrix=e.Matrix.Zero(),this._globalAmbientColor=new e.Color3(0,0,0),this._defines=new t,this._cachedDefines=new t,this._cachedDefines.BonesPerMesh=-1,this.getRenderTargetTextures=function(){return o._renderTargets.reset(),o.reflectionTexture&&o.reflectionTexture.isRenderTarget&&o._renderTargets.push(o.reflectionTexture),o.refractionTexture&&o.refractionTexture.isRenderTarget&&o._renderTargets.push(o.refractionTexture),o._renderTargets}}return __extends(r,i),Object.defineProperty(r.prototype,"useLogarithmicDepth",{get:function(){return this._useLogarithmicDepth},set:function(e){this._useLogarithmicDepth=e&&this.getScene().getEngine().getCaps().fragmentDepthSupported},enumerable:!0,configurable:!0}),r.prototype.needAlphaBlending=function(){return this.alpha<1||null!=this.opacityTexture||this._shouldUseAlphaFromDiffuseTexture()||this.opacityFresnelParameters&&this.opacityFresnelParameters.isEnabled},r.prototype.needAlphaTesting=function(){return null!=this.diffuseTexture&&this.diffuseTexture.hasAlpha},r.prototype._shouldUseAlphaFromDiffuseTexture=function(){return null!=this.diffuseTexture&&this.diffuseTexture.hasAlpha&&this.useAlphaFromDiffuseTexture},r.prototype.getAlphaTestTexture=function(){return this.diffuseTexture},r.prototype._checkCache=function(e,t,i){return t?this._defines.INSTANCES!==i?!1:!(!t._materialDefines||!t._materialDefines.isEqual(this._defines)):!0},r.prototype.isReady=function(i,n){if(this.isFrozen&&this._wasPreviouslyReady)return!0;var o=this.getScene();if(!this.checkReadyOnEveryCall&&this._renderId===o.getRenderId()&&this._checkCache(o,i,n))return!0;var s=o.getEngine(),a=!1,h=!1;if(this._defines.reset(),o.texturesEnabled){if(this.diffuseTexture&&r.DiffuseTextureEnabled){if(!this.diffuseTexture.isReady())return!1;h=!0,this._defines.DIFFUSE=!0}if(this.ambientTexture&&r.AmbientTextureEnabled){if(!this.ambientTexture.isReady())return!1;h=!0,this._defines.AMBIENT=!0}if(this.opacityTexture&&r.OpacityTextureEnabled){if(!this.opacityTexture.isReady())return!1;h=!0,this._defines.OPACITY=!0,this.opacityTexture.getAlphaFromRGB&&(this._defines.OPACITYRGB=!0)}if(this.reflectionTexture&&r.ReflectionTextureEnabled){if(!this.reflectionTexture.isReady())return!1;switch(a=!0,this._defines.REFLECTION=!0,this.roughness>0&&(this._defines.ROUGHNESS=!0),this.useReflectionOverAlpha&&(this._defines.REFLECTIONOVERALPHA=!0),this.reflectionTexture.coordinatesMode===e.Texture.INVCUBIC_MODE&&(this._defines.INVERTCUBICMAP=!0),this._defines.REFLECTIONMAP_3D=this.reflectionTexture.isCube,this.reflectionTexture.coordinatesMode){case e.Texture.CUBIC_MODE:case e.Texture.INVCUBIC_MODE:this._defines.REFLECTIONMAP_CUBIC=!0;break;case e.Texture.EXPLICIT_MODE:this._defines.REFLECTIONMAP_EXPLICIT=!0;break;case e.Texture.PLANAR_MODE:this._defines.REFLECTIONMAP_PLANAR=!0;break;case e.Texture.PROJECTION_MODE:this._defines.REFLECTIONMAP_PROJECTION=!0;break;case e.Texture.SKYBOX_MODE:this._defines.REFLECTIONMAP_SKYBOX=!0;break;case e.Texture.SPHERICAL_MODE:this._defines.REFLECTIONMAP_SPHERICAL=!0;break;case e.Texture.EQUIRECTANGULAR_MODE:this._defines.REFLECTIONMAP_EQUIRECTANGULAR=!0;break;case e.Texture.FIXED_EQUIRECTANGULAR_MODE:this._defines.REFLECTIONMAP_EQUIRECTANGULAR_FIXED=!0}}if(this.emissiveTexture&&r.EmissiveTextureEnabled){if(!this.emissiveTexture.isReady())return!1;h=!0,this._defines.EMISSIVE=!0}if(this.lightmapTexture&&r.LightmapTextureEnabled){if(!this.lightmapTexture.isReady())return!1;h=!0,this._defines.LIGHTMAP=!0,this._defines.USELIGHTMAPASSHADOWMAP=this.useLightmapAsShadowmap}if(this.specularTexture&&r.SpecularTextureEnabled){if(!this.specularTexture.isReady())return!1;h=!0,this._defines.SPECULAR=!0,this._defines.GLOSSINESS=this.useGlossinessFromSpecularMapAlpha}if(o.getEngine().getCaps().standardDerivatives&&this.bumpTexture&&r.BumpTextureEnabled){if(!this.bumpTexture.isReady())return!1;h=!0,this._defines.BUMP=!0,this.useParallax&&(this._defines.PARALLAX=!0,this.useParallaxOcclusion&&(this._defines.PARALLAXOCCLUSION=!0)),this.invertNormalMapX&&(this._defines.INVERTNORMALMAPX=!0),this.invertNormalMapY&&(this._defines.INVERTNORMALMAPY=!0)}if(this.refractionTexture&&r.RefractionTextureEnabled){if(!this.refractionTexture.isReady())return!1;h=!0,this._defines.REFRACTION=!0,this._defines.REFRACTIONMAP_3D=this.refractionTexture.isCube}}if(o.clipPlane&&(this._defines.CLIPPLANE=!0),s.getAlphaTesting()&&(this._defines.ALPHATEST=!0),this._shouldUseAlphaFromDiffuseTexture()&&(this._defines.ALPHAFROMDIFFUSE=!0),this.useEmissiveAsIllumination&&(this._defines.EMISSIVEASILLUMINATION=!0),this.linkEmissiveWithDiffuse&&(this._defines.LINKEMISSIVEWITHDIFFUSE=!0),this.useLogarithmicDepth&&(this._defines.LOGARITHMICDEPTH=!0),(this.pointsCloud||o.forcePointsCloud)&&(this._defines.POINTSIZE=!0),o.fogEnabled&&i&&i.applyFog&&o.fogMode!==e.Scene.FOGMODE_NONE&&this.fogEnabled&&(this._defines.FOG=!0),o.lightsEnabled&&!this.disableLighting&&(a=e.MaterialHelper.PrepareDefinesForLights(o,i,this._defines,this.maxSimultaneousLights)),r.FresnelEnabled&&(this.diffuseFresnelParameters&&this.diffuseFresnelParameters.isEnabled||this.opacityFresnelParameters&&this.opacityFresnelParameters.isEnabled||this.emissiveFresnelParameters&&this.emissiveFresnelParameters.isEnabled||this.refractionFresnelParameters&&this.refractionFresnelParameters.isEnabled||this.reflectionFresnelParameters&&this.reflectionFresnelParameters.isEnabled)&&(this.diffuseFresnelParameters&&this.diffuseFresnelParameters.isEnabled&&(this._defines.DIFFUSEFRESNEL=!0),this.opacityFresnelParameters&&this.opacityFresnelParameters.isEnabled&&(this._defines.OPACITYFRESNEL=!0),this.reflectionFresnelParameters&&this.reflectionFresnelParameters.isEnabled&&(this._defines.REFLECTIONFRESNEL=!0,this.useReflectionFresnelFromSpecular&&(this._defines.REFLECTIONFRESNELFROMSPECULAR=!0)),this.refractionFresnelParameters&&this.refractionFresnelParameters.isEnabled&&(this._defines.REFRACTIONFRESNEL=!0),this.emissiveFresnelParameters&&this.emissiveFresnelParameters.isEnabled&&(this._defines.EMISSIVEFRESNEL=!0),a=!0,this._defines.FRESNEL=!0),this._defines.SPECULARTERM&&this.useSpecularOverAlpha&&(this._defines.SPECULAROVERALPHA=!0),i&&(a&&i.isVerticesDataPresent(e.VertexBuffer.NormalKind)&&(this._defines.NORMAL=!0),h&&(i.isVerticesDataPresent(e.VertexBuffer.UVKind)&&(this._defines.UV1=!0),i.isVerticesDataPresent(e.VertexBuffer.UV2Kind)&&(this._defines.UV2=!0)),i.useVertexColors&&i.isVerticesDataPresent(e.VertexBuffer.ColorKind)&&(this._defines.VERTEXCOLOR=!0,i.hasVertexAlpha&&(this._defines.VERTEXALPHA=!0)),i.useBones&&i.computeBonesUsingShaders&&(this._defines.NUM_BONE_INFLUENCERS=i.numBoneInfluencers,this._defines.BonesPerMesh=i.skeleton.bones.length+1),n&&(this._defines.INSTANCES=!0)),!this._defines.isEqual(this._cachedDefines)){this._defines.cloneTo(this._cachedDefines),o.resetCachedMaterial();var c=new e.EffectFallbacks;this._defines.REFLECTION&&c.addFallback(0,"REFLECTION"),this._defines.SPECULAR&&c.addFallback(0,"SPECULAR"),this._defines.BUMP&&c.addFallback(0,"BUMP"),this._defines.PARALLAX&&c.addFallback(1,"PARALLAX"),this._defines.PARALLAXOCCLUSION&&c.addFallback(0,"PARALLAXOCCLUSION"),this._defines.SPECULAROVERALPHA&&c.addFallback(0,"SPECULAROVERALPHA"),this._defines.FOG&&c.addFallback(1,"FOG"),this._defines.POINTSIZE&&c.addFallback(0,"POINTSIZE"),this._defines.LOGARITHMICDEPTH&&c.addFallback(0,"LOGARITHMICDEPTH"),e.MaterialHelper.HandleFallbacksForShadows(this._defines,c,this.maxSimultaneousLights),this._defines.SPECULARTERM&&c.addFallback(0,"SPECULARTERM"),this._defines.DIFFUSEFRESNEL&&c.addFallback(1,"DIFFUSEFRESNEL"),this._defines.OPACITYFRESNEL&&c.addFallback(2,"OPACITYFRESNEL"),this._defines.REFLECTIONFRESNEL&&c.addFallback(3,"REFLECTIONFRESNEL"),this._defines.EMISSIVEFRESNEL&&c.addFallback(4,"EMISSIVEFRESNEL"),this._defines.FRESNEL&&c.addFallback(4,"FRESNEL");var l=[e.VertexBuffer.PositionKind];this._defines.NORMAL&&l.push(e.VertexBuffer.NormalKind),this._defines.UV1&&l.push(e.VertexBuffer.UVKind),this._defines.UV2&&l.push(e.VertexBuffer.UV2Kind),this._defines.VERTEXCOLOR&&l.push(e.VertexBuffer.ColorKind),e.MaterialHelper.PrepareAttributesForBones(l,i,this._defines,c),e.MaterialHelper.PrepareAttributesForInstances(l,this._defines);var u="default";o.getEngine().getCaps().standardDerivatives||(u="legacydefault");var f=this._defines.toString(),d=["world","view","viewProjection","vEyePosition","vLightsType","vAmbientColor","vDiffuseColor","vSpecularColor","vEmissiveColor","vFogInfos","vFogColor","pointSize","vDiffuseInfos","vAmbientInfos","vOpacityInfos","vReflectionInfos","vEmissiveInfos","vSpecularInfos","vBumpInfos","vLightmapInfos","vRefractionInfos","mBones","vClipPlane","diffuseMatrix","ambientMatrix","opacityMatrix","reflectionMatrix","emissiveMatrix","specularMatrix","bumpMatrix","lightmapMatrix","refractionMatrix","depthValues","diffuseLeftColor","diffuseRightColor","opacityParts","reflectionLeftColor","reflectionRightColor","emissiveLeftColor","emissiveRightColor","refractionLeftColor","refractionRightColor","logarithmicDepthConstant"],p=["diffuseSampler","ambientSampler","opacitySampler","reflectionCubeSampler","reflection2DSampler","emissiveSampler","specularSampler","bumpSampler","lightmapSampler","refractionCubeSampler","refraction2DSampler"];e.MaterialHelper.PrepareUniformsAndSamplersList(d,p,this._defines,this.maxSimultaneousLights),this._effect=o.getEngine().createEffect(u,l,d,p,f,c,this.onCompiled,this.onError,{maxSimultaneousLights:this.maxSimultaneousLights-1})}return this._effect.isReady()?(this._renderId=o.getRenderId(),this._wasPreviouslyReady=!0,i&&(i._materialDefines||(i._materialDefines=new t),this._defines.cloneTo(i._materialDefines)),!0):!1},r.prototype.unbind=function(){this.reflectionTexture&&this.reflectionTexture.isRenderTarget&&this._effect.setTexture("reflection2DSampler",null),this.refractionTexture&&this.refractionTexture.isRenderTarget&&this._effect.setTexture("refraction2DSampler",null),i.prototype.unbind.call(this)},r.prototype.bindOnlyWorldMatrix=function(e){this._effect.setMatrix("world",e)},r.prototype.bind=function(t,n){var o=this.getScene();if(this.bindOnlyWorldMatrix(t),e.MaterialHelper.BindBonesParameters(n,this._effect),o.getCachedMaterial()!==this){if(this._effect.setMatrix("viewProjection",o.getTransformMatrix()),r.FresnelEnabled&&(this.diffuseFresnelParameters&&this.diffuseFresnelParameters.isEnabled&&(this._effect.setColor4("diffuseLeftColor",this.diffuseFresnelParameters.leftColor,this.diffuseFresnelParameters.power),this._effect.setColor4("diffuseRightColor",this.diffuseFresnelParameters.rightColor,this.diffuseFresnelParameters.bias)),this.opacityFresnelParameters&&this.opacityFresnelParameters.isEnabled&&this._effect.setColor4("opacityParts",new e.Color3(this.opacityFresnelParameters.leftColor.toLuminance(),this.opacityFresnelParameters.rightColor.toLuminance(),this.opacityFresnelParameters.bias),this.opacityFresnelParameters.power),this.reflectionFresnelParameters&&this.reflectionFresnelParameters.isEnabled&&(this._effect.setColor4("reflectionLeftColor",this.reflectionFresnelParameters.leftColor,this.reflectionFresnelParameters.power),this._effect.setColor4("reflectionRightColor",this.reflectionFresnelParameters.rightColor,this.reflectionFresnelParameters.bias)),this.refractionFresnelParameters&&this.refractionFresnelParameters.isEnabled&&(this._effect.setColor4("refractionLeftColor",this.refractionFresnelParameters.leftColor,this.refractionFresnelParameters.power),this._effect.setColor4("refractionRightColor",this.refractionFresnelParameters.rightColor,this.refractionFresnelParameters.bias)),this.emissiveFresnelParameters&&this.emissiveFresnelParameters.isEnabled&&(this._effect.setColor4("emissiveLeftColor",this.emissiveFresnelParameters.leftColor,this.emissiveFresnelParameters.power),this._effect.setColor4("emissiveRightColor",this.emissiveFresnelParameters.rightColor,this.emissiveFresnelParameters.bias))),o.texturesEnabled&&(this.diffuseTexture&&r.DiffuseTextureEnabled&&(this._effect.setTexture("diffuseSampler",this.diffuseTexture),this._effect.setFloat2("vDiffuseInfos",this.diffuseTexture.coordinatesIndex,this.diffuseTexture.level),this._effect.setMatrix("diffuseMatrix",this.diffuseTexture.getTextureMatrix())),this.ambientTexture&&r.AmbientTextureEnabled&&(this._effect.setTexture("ambientSampler",this.ambientTexture),this._effect.setFloat2("vAmbientInfos",this.ambientTexture.coordinatesIndex,this.ambientTexture.level),this._effect.setMatrix("ambientMatrix",this.ambientTexture.getTextureMatrix())),this.opacityTexture&&r.OpacityTextureEnabled&&(this._effect.setTexture("opacitySampler",this.opacityTexture),this._effect.setFloat2("vOpacityInfos",this.opacityTexture.coordinatesIndex,this.opacityTexture.level),this._effect.setMatrix("opacityMatrix",this.opacityTexture.getTextureMatrix())),this.reflectionTexture&&r.ReflectionTextureEnabled&&(this.reflectionTexture.isCube?this._effect.setTexture("reflectionCubeSampler",this.reflectionTexture):this._effect.setTexture("reflection2DSampler",this.reflectionTexture),this._effect.setMatrix("reflectionMatrix",this.reflectionTexture.getReflectionTextureMatrix()),this._effect.setFloat2("vReflectionInfos",this.reflectionTexture.level,this.roughness)),this.emissiveTexture&&r.EmissiveTextureEnabled&&(this._effect.setTexture("emissiveSampler",this.emissiveTexture),this._effect.setFloat2("vEmissiveInfos",this.emissiveTexture.coordinatesIndex,this.emissiveTexture.level),this._effect.setMatrix("emissiveMatrix",this.emissiveTexture.getTextureMatrix())),this.lightmapTexture&&r.LightmapTextureEnabled&&(this._effect.setTexture("lightmapSampler",this.lightmapTexture),this._effect.setFloat2("vLightmapInfos",this.lightmapTexture.coordinatesIndex,this.lightmapTexture.level),this._effect.setMatrix("lightmapMatrix",this.lightmapTexture.getTextureMatrix())),this.specularTexture&&r.SpecularTextureEnabled&&(this._effect.setTexture("specularSampler",this.specularTexture),this._effect.setFloat2("vSpecularInfos",this.specularTexture.coordinatesIndex,this.specularTexture.level),this._effect.setMatrix("specularMatrix",this.specularTexture.getTextureMatrix())),this.bumpTexture&&o.getEngine().getCaps().standardDerivatives&&r.BumpTextureEnabled&&(this._effect.setTexture("bumpSampler",this.bumpTexture),this._effect.setFloat3("vBumpInfos",this.bumpTexture.coordinatesIndex,1/this.bumpTexture.level,this.parallaxScaleBias),this._effect.setMatrix("bumpMatrix",this.bumpTexture.getTextureMatrix())),this.refractionTexture&&r.RefractionTextureEnabled)){var s=1;this.refractionTexture.isCube?this._effect.setTexture("refractionCubeSampler",this.refractionTexture):(this._effect.setTexture("refraction2DSampler",this.refractionTexture),this._effect.setMatrix("refractionMatrix",this.refractionTexture.getReflectionTextureMatrix()),this.refractionTexture.depth&&(s=this.refractionTexture.depth)),this._effect.setFloat4("vRefractionInfos",this.refractionTexture.level,this.indexOfRefraction,s,this.invertRefractionY?-1:1)}e.MaterialHelper.BindClipPlane(this._effect,o),this.pointsCloud&&this._effect.setFloat("pointSize",this.pointSize),o.ambientColor.multiplyToRef(this.ambientColor,this._globalAmbientColor),this._effect.setVector3("vEyePosition",o._mirroredCameraPosition?o._mirroredCameraPosition:o.activeCamera.position),this._effect.setColor3("vAmbientColor",this._globalAmbientColor),this._defines.SPECULARTERM&&this._effect.setColor4("vSpecularColor",this.specularColor,this.specularPower),this._effect.setColor3("vEmissiveColor",this.emissiveColor)}o.getCachedMaterial()===this&&this.isFrozen||(this._effect.setColor4("vDiffuseColor",this.diffuseColor,this.alpha*n.visibility),o.lightsEnabled&&!this.disableLighting&&e.MaterialHelper.BindLights(o,n,this._effect,this._defines,this.maxSimultaneousLights),(o.fogEnabled&&n.applyFog&&o.fogMode!==e.Scene.FOGMODE_NONE||this.reflectionTexture||this.refractionTexture)&&this._effect.setMatrix("view",o.getViewMatrix()),e.MaterialHelper.BindFogParameters(o,n,this._effect),e.MaterialHelper.BindLogDepth(this._defines,this._effect,o)),i.prototype.bind.call(this,t,n)},r.prototype.getAnimatables=function(){var e=[];return this.diffuseTexture&&this.diffuseTexture.animations&&this.diffuseTexture.animations.length>0&&e.push(this.diffuseTexture),this.ambientTexture&&this.ambientTexture.animations&&this.ambientTexture.animations.length>0&&e.push(this.ambientTexture),this.opacityTexture&&this.opacityTexture.animations&&this.opacityTexture.animations.length>0&&e.push(this.opacityTexture),this.reflectionTexture&&this.reflectionTexture.animations&&this.reflectionTexture.animations.length>0&&e.push(this.reflectionTexture),this.emissiveTexture&&this.emissiveTexture.animations&&this.emissiveTexture.animations.length>0&&e.push(this.emissiveTexture),this.specularTexture&&this.specularTexture.animations&&this.specularTexture.animations.length>0&&e.push(this.specularTexture),this.bumpTexture&&this.bumpTexture.animations&&this.bumpTexture.animations.length>0&&e.push(this.bumpTexture),this.lightmapTexture&&this.lightmapTexture.animations&&this.lightmapTexture.animations.length>0&&e.push(this.lightmapTexture),this.refractionTexture&&this.refractionTexture.animations&&this.refractionTexture.animations.length>0&&e.push(this.refractionTexture),e},r.prototype.dispose=function(e,t){t&&(this.diffuseTexture&&this.diffuseTexture.dispose(),this.ambientTexture&&this.ambientTexture.dispose(),this.opacityTexture&&this.opacityTexture.dispose(),this.reflectionTexture&&this.reflectionTexture.dispose(),this.emissiveTexture&&this.emissiveTexture.dispose(),this.specularTexture&&this.specularTexture.dispose(),this.bumpTexture&&this.bumpTexture.dispose(),this.lightmapTexture&&this.lightmapTexture.dispose(),this.refractionTexture&&this.refractionTexture.dispose()),i.prototype.dispose.call(this,e,t)},r.prototype.clone=function(t){var i=this;return e.SerializationHelper.Clone(function(){return new r(t,i.getScene())},this)},r.prototype.serialize=function(){return e.SerializationHelper.Serialize(this)},r.Parse=function(t,i,n){return e.SerializationHelper.Parse(function(){return new r(t.name,i)},t,i,n)},r.DiffuseTextureEnabled=!0,r.AmbientTextureEnabled=!0,r.OpacityTextureEnabled=!0,r.ReflectionTextureEnabled=!0,r.EmissiveTextureEnabled=!0,r.SpecularTextureEnabled=!0,r.BumpTextureEnabled=!0,r.FresnelEnabled=!0,r.LightmapTextureEnabled=!0,r.RefractionTextureEnabled=!0,__decorate([e.serializeAsTexture()],r.prototype,"diffuseTexture",void 0),__decorate([e.serializeAsTexture()],r.prototype,"ambientTexture",void 0),__decorate([e.serializeAsTexture()],r.prototype,"opacityTexture",void 0),__decorate([e.serializeAsTexture()],r.prototype,"reflectionTexture",void 0),__decorate([e.serializeAsTexture()],r.prototype,"emissiveTexture",void 0),__decorate([e.serializeAsTexture()],r.prototype,"specularTexture",void 0),__decorate([e.serializeAsTexture()],r.prototype,"bumpTexture",void 0),__decorate([e.serializeAsTexture()],r.prototype,"lightmapTexture",void 0),__decorate([e.serializeAsTexture()],r.prototype,"refractionTexture",void 0),__decorate([e.serializeAsColor3("ambient")],r.prototype,"ambientColor",void 0),__decorate([e.serializeAsColor3("diffuse")],r.prototype,"diffuseColor",void 0),__decorate([e.serializeAsColor3("specular")],r.prototype,"specularColor",void 0),__decorate([e.serializeAsColor3("emissive")],r.prototype,"emissiveColor",void 0),__decorate([e.serialize()],r.prototype,"specularPower",void 0),__decorate([e.serialize()],r.prototype,"useAlphaFromDiffuseTexture",void 0),__decorate([e.serialize()],r.prototype,"useEmissiveAsIllumination",void 0),__decorate([e.serialize()],r.prototype,"linkEmissiveWithDiffuse",void 0),__decorate([e.serialize()],r.prototype,"useReflectionFresnelFromSpecular",void 0),__decorate([e.serialize()],r.prototype,"useSpecularOverAlpha",void 0),__decorate([e.serialize()],r.prototype,"useReflectionOverAlpha",void 0),__decorate([e.serialize()],r.prototype,"disableLighting",void 0),__decorate([e.serialize()],r.prototype,"useParallax",void 0),__decorate([e.serialize()],r.prototype,"useParallaxOcclusion",void 0),__decorate([e.serialize()],r.prototype,"parallaxScaleBias",void 0),__decorate([e.serialize()],r.prototype,"roughness",void 0),__decorate([e.serialize()],r.prototype,"indexOfRefraction",void 0),__decorate([e.serialize()],r.prototype,"invertRefractionY",void 0),__decorate([e.serialize()],r.prototype,"useLightmapAsShadowmap",void 0),__decorate([e.serializeAsFresnelParameters()],r.prototype,"diffuseFresnelParameters",void 0),__decorate([e.serializeAsFresnelParameters()],r.prototype,"opacityFresnelParameters",void 0),__decorate([e.serializeAsFresnelParameters()],r.prototype,"reflectionFresnelParameters",void 0),__decorate([e.serializeAsFresnelParameters()],r.prototype,"refractionFresnelParameters",void 0),__decorate([e.serializeAsFresnelParameters()],r.prototype,"emissiveFresnelParameters",void 0),__decorate([e.serialize()],r.prototype,"useGlossinessFromSpecularMapAlpha",void 0),__decorate([e.serialize()],r.prototype,"maxSimultaneousLights",void 0),__decorate([e.serialize()],r.prototype,"invertNormalMapX",void 0),__decorate([e.serialize()],r.prototype,"invertNormalMapY",void 0),__decorate([e.serialize()],r.prototype,"useLogarithmicDepth",null),r}(e.Material);e.StandardMaterial=i}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(e,i){t.call(this,e,i,!0),this.subMaterials=new Array,i.multiMaterials.push(this)}return __extends(i,t),i.prototype.getSubMaterial=function(e){return 0>e||e>=this.subMaterials.length?this.getScene().defaultMaterial:this.subMaterials[e]},i.prototype.isReady=function(e){for(var t=0;t<this.subMaterials.length;t++){var i=this.subMaterials[t];if(i&&!this.subMaterials[t].isReady(e))return!1}return!0},i.prototype.clone=function(e,t){for(var r=new i(e,this.getScene()),n=0;n<this.subMaterials.length;n++){var o=null;o=t?this.subMaterials[n].clone(e+"-"+this.subMaterials[n].name):this.subMaterials[n],r.subMaterials.push(o)}return r},i.prototype.serialize=function(){var t={};t.name=this.name,t.id=this.id,t.tags=e.Tags.GetTags(this),t.materials=[];for(var i=0;i<this.subMaterials.length;i++){var r=this.subMaterials[i];r?t.materials.push(r.id):t.materials.push(null)}return t},i}(e.Material);e.MultiMaterial=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(){}return Object.defineProperty(t,"NO_LOGGING",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MINIMAL_LOGGING",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(t,"SUMMARY_LOGGING",{get:function(){return 2},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DETAILED_LOGGING",{get:function(){return 3},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ForceFullSceneLoadingForIncremental",{get:function(){return t._ForceFullSceneLoadingForIncremental},set:function(e){t._ForceFullSceneLoadingForIncremental=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ShowLoadingScreen",{get:function(){return t._ShowLoadingScreen},set:function(e){t._ShowLoadingScreen=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"loggingLevel",{get:function(){return t._loggingLevel},set:function(e){t._loggingLevel=e},enumerable:!0,configurable:!0}),t._getPluginForFilename=function(e){var t=e.lastIndexOf("."),i=e.indexOf("?");-1===i&&(i=e.length);for(var r=e.substring(t,i).toLowerCase(),n=0;n<this._registeredPlugins.length;n++){var o=this._registeredPlugins[n];if(-1!==o.extensions.indexOf(r))return o}return this._registeredPlugins[0]},t.GetPluginForExtension=function(e){for(var t=0;t<this._registeredPlugins.length;t++){var i=this._registeredPlugins[t];if(-1!==i.extensions.indexOf(e))return i}return null},t.RegisterPlugin=function(e){e.extensions=e.extensions.toLowerCase(),t._registeredPlugins.push(e)},t.ImportMesh=function(i,r,n,o,s,a,h){if(n.substr&&"/"===n.substr(0,1))return void e.Tools.Error("Wrong sceneFilename parameter");if(n.substr&&"/"===n.substr(0,1))return void e.Tools.Error("Wrong sceneFilename parameter");var c={};o._addPendingData(c);var l=function(l){o.database=u;var f=t._getPluginForFilename(n),d=function(e){var t=[],a=[],l=[];try{if(f.importMesh){var u=f;if(!u.importMesh(i,o,e,r,t,a,l))return h&&h(o,"Unable to import meshes from "+r+n),void o._removePendingData(c);s&&(o.importedMeshesFiles.push(r+n),s(t,a,l),o._removePendingData(c))}else{var d=f;d.importMeshAsync(i,o,e,r,function(e,t,i){s&&(o.importedMeshesFiles.push(r+n),s(e,t,i),o._removePendingData(c))},function(){h&&h(o,"Unable to import meshes from "+r+n),o._removePendingData(c)})}}catch(p){h&&h(o,"Unable to import meshes from "+r+n,p),o._removePendingData(c)}};return n.substr&&"data:"===n.substr(0,5)?void d(n.substr(5)):void e.Tools.LoadFile(r+n,function(e){d(e)},a,u)};if(!o.getEngine().enableOfflineSupport||n.substr&&"data:"===n.substr(0,5))l(!0);else var u=new e.Database(r+n,l)},t.Load=function(i,r,n,o,s,a){t.Append(i,r,new e.Scene(n),o,s,a)},t.Append=function(i,r,n,o,s,a){if(r.substr&&"/"===r.substr(0,1))return void e.Tools.Error("Wrong sceneFilename parameter");var h,c=this._getPluginForFilename(r.name||r),l={};n._addPendingData(l),t.ShowLoadingScreen&&n.getEngine().displayLoadingUI();var u=function(e){if(n.database=h,c.load){var r=c;if(!r.load(n,e,i))return a&&a(n),n._removePendingData(l),void n.getEngine().hideLoadingUI();o&&o(n),n._removePendingData(l)}else{var s=c;s.loadAsync(n,e,i,function(){o&&o(n)},function(){a&&a(n),n._removePendingData(l),n.getEngine().hideLoadingUI()})}t.ShowLoadingScreen&&n.executeWhenReady(function(){n.getEngine().hideLoadingUI()})},f=function(t){e.Tools.LoadFile(i+r,u,s,h)};return r.substr&&"data:"===r.substr(0,5)?void u(r.substr(5)):void(-1===i.indexOf("file:")?n.getEngine().enableOfflineSupport?h=new e.Database(i+r,f):f(!0):e.Tools.ReadFile(r,u,s))},t._ForceFullSceneLoadingForIncremental=!1,t._ShowLoadingScreen=!0,t._loggingLevel=t.NO_LOGGING,t._registeredPlugins=new Array,t}();e.SceneLoader=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t;!function(t){var i=function(t,i,r,n){for(var o=0,s=i.materials.length;s>o;o++){var a=i.materials[o];if(a.id===t)return e.Material.Parse(a,r,n)}return null},r=function(e,t,i){t=t instanceof Array?t:[t];for(var r in t)if(e.name===t[r])return i.push(e.id),!0;return e.parentId&&-1!==i.indexOf(e.parentId)?(i.push(e.id),!0):!1},n=function(e,t){return e+" of "+(t?t.file+" from "+t.name+" version: "+t.version+", exporter version: "+t.exporter_version:"unknown")};e.SceneLoader.RegisterPlugin({extensions:".babylon",importMesh:function(t,o,s,a,h,c,l){var u="importMesh has failed JSON parse";try{var f=JSON.parse(s);u="";var d,p,_=e.SceneLoader.loggingLevel===e.SceneLoader.DETAILED_LOGGING,m=[],g=[],v=[];for(d=0,p=f.meshes.length;p>d;d++){var y=f.meshes[d];if(!t||r(y,t,v)){if(t instanceof Array&&delete t[t.indexOf(y.name)],y.geometryId&&f.geometries){var x=!1;["boxes","spheres","cylinders","toruses","grounds","planes","torusKnots","vertexData"].forEach(function(t){!x&&f.geometries[t]&&f.geometries[t]instanceof Array&&f.geometries[t].forEach(function(i){if(i.id===y.geometryId){switch(t){case"boxes":e.Geometry.Primitives.Box.Parse(i,o);break;case"spheres":e.Geometry.Primitives.Sphere.Parse(i,o);break;case"cylinders":e.Geometry.Primitives.Cylinder.Parse(i,o);break;case"toruses":e.Geometry.Primitives.Torus.Parse(i,o);break;case"grounds":e.Geometry.Primitives.Ground.Parse(i,o);break;case"planes":e.Geometry.Primitives.Plane.Parse(i,o);break;case"torusKnots":e.Geometry.Primitives.TorusKnot.Parse(i,o);break;case"vertexData":e.Geometry.Parse(i,o,a)}x=!0}})}),x||e.Tools.Warn("Geometry not found for mesh "+y.id)}if(y.materialId){var b=-1!==g.indexOf(y.materialId);if(!b&&f.multiMaterials)for(var P=0,A=f.multiMaterials.length;A>P;P++){var T=f.multiMaterials[P];if(T.id===y.materialId){for(var E=0,C=T.materials.length;C>E;E++){var S=T.materials[E];g.push(S);var M=i(S,f,o,a);u+="\n	Material "+M.toString(_)}g.push(T.id);var I=e.Material.ParseMultiMaterial(T,o);b=!0,u+="\n	Multi-Material "+I.toString(_);break}}if(!b){g.push(y.materialId);var M=i(y.materialId,f,o,a);M?u+="\n	Material "+M.toString(_):e.Tools.Warn("Material not found for mesh "+y.id)}}if(y.skeletonId>-1&&o.skeletons){var D=m.indexOf(y.skeletonId)>-1;if(!D)for(var R=0,O=f.skeletons.length;O>R;R++){var w=f.skeletons[R];if(w.id===y.skeletonId){var L=e.Skeleton.Parse(w,o);l.push(L),m.push(w.id),u+="\n	Skeleton "+L.toString(_)}}}var B=e.Mesh.Parse(y,o,a);h.push(B),u+="\n	Mesh "+B.toString(_)}}var V;for(d=0,p=o.meshes.length;p>d;d++)V=o.meshes[d],V._waitingParentId&&(V.parent=o.getLastEntryByID(V._waitingParentId),V._waitingParentId=void 0);for(d=0,p=o.meshes.length;p>d;d++)V=o.meshes[d],V._waitingFreezeWorldMatrix?(V.freezeWorldMatrix(),V._waitingFreezeWorldMatrix=void 0):V.computeWorldMatrix(!0);if(f.particleSystems)for(d=0,p=f.particleSystems.length;p>d;d++){var F=f.particleSystems[d];-1!==v.indexOf(F.emitterId)&&c.push(e.ParticleSystem.Parse(F,o,a))}return!0}catch(N){throw e.Tools.Log(n("importMesh",f.producer)+u),u=null,N}finally{null!==u&&e.SceneLoader.loggingLevel!==e.SceneLoader.NO_LOGGING&&e.Tools.Log(n("importMesh",f.producer)+(e.SceneLoader.loggingLevel!==e.SceneLoader.MINIMAL_LOGGING?u:""))}},load:function(t,i,r){var o="importScene has failed JSON parse";try{var s=JSON.parse(i);o="";var a=e.SceneLoader.loggingLevel===e.SceneLoader.DETAILED_LOGGING;if(t.useDelayedTextureLoading=s.useDelayedTextureLoading&&!e.SceneLoader.ForceFullSceneLoadingForIncremental,t.autoClear=s.autoClear,t.clearColor=e.Color4.FromArray(s.clearColor),t.ambientColor=e.Color3.FromArray(s.ambientColor),s.gravity&&(t.gravity=e.Vector3.FromArray(s.gravity)),s.fogMode&&0!==s.fogMode)switch(t.fogMode=s.fogMode,t.fogColor=e.Color3.FromArray(s.fogColor),t.fogStart=s.fogStart,t.fogEnd=s.fogEnd,t.fogDensity=s.fogDensity,o+="	Fog mode for scene:  ",t.fogMode){case 1:o+="exp\n";break;case 2:o+="exp2\n";break;case 3:o+="linear\n"}if(s.physicsEnabled){var h;"cannon"===s.physicsEngine?h=new e.CannonJSPlugin:"oimo"===s.physicsEngine&&(h=new e.OimoJSPlugin),o="	Physics engine "+(s.physicsEngine?s.physicsEngine:"oimo")+" enabled\n";var c=s.physicsGravity?e.Vector3.FromArray(s.physicsGravity):null;t.enablePhysics(c,h)}void 0!=s.collisionsEnabled&&(t.collisionsEnabled=s.collisionsEnabled),t.workerCollisions=!!s.workerCollisions;var l,u;for(l=0,u=s.lights.length;u>l;l++){var f=s.lights[l],d=e.Light.Parse(f,t);o+=0===l?"\n	Lights:":"",o+="\n		"+d.toString(a)}if(s.animations)for(l=0,u=s.animations.length;u>l;l++){var p=s.animations[l],_=e.Animation.Parse(p);
t.animations.push(_),o+=0===l?"\n	Animations:":"",o+="\n		"+_.toString(a)}if(s.autoAnimate&&t.beginAnimation(t,s.autoAnimateFrom,s.autoAnimateTo,s.autoAnimateLoop,s.autoAnimateSpeed||1),s.materials)for(l=0,u=s.materials.length;u>l;l++){var m=s.materials[l],g=e.Material.Parse(m,t,r);o+=0===l?"\n	Materials:":"",o+="\n		"+g.toString(a)}if(s.multiMaterials)for(l=0,u=s.multiMaterials.length;u>l;l++){var v=s.multiMaterials[l],y=e.Material.ParseMultiMaterial(v,t);o+=0===l?"\n	MultiMaterials:":"",o+="\n		"+y.toString(a)}if(s.skeletons)for(l=0,u=s.skeletons.length;u>l;l++){var x=s.skeletons[l],b=e.Skeleton.Parse(x,t);o+=0===l?"\n	Skeletons:":"",o+="\n		"+b.toString(a)}var P=s.geometries;if(P){var A=P.boxes;if(A)for(l=0,u=A.length;u>l;l++){var T=A[l];e.Geometry.Primitives.Box.Parse(T,t)}var E=P.spheres;if(E)for(l=0,u=E.length;u>l;l++){var C=E[l];e.Geometry.Primitives.Sphere.Parse(C,t)}var S=P.cylinders;if(S)for(l=0,u=S.length;u>l;l++){var M=S[l];e.Geometry.Primitives.Cylinder.Parse(M,t)}var I=P.toruses;if(I)for(l=0,u=I.length;u>l;l++){var D=I[l];e.Geometry.Primitives.Torus.Parse(D,t)}var R=P.grounds;if(R)for(l=0,u=R.length;u>l;l++){var O=R[l];e.Geometry.Primitives.Ground.Parse(O,t)}var w=P.planes;if(w)for(l=0,u=w.length;u>l;l++){var L=w[l];e.Geometry.Primitives.Plane.Parse(L,t)}var B=P.torusKnots;if(B)for(l=0,u=B.length;u>l;l++){var V=B[l];e.Geometry.Primitives.TorusKnot.Parse(V,t)}var F=P.vertexData;if(F)for(l=0,u=F.length;u>l;l++){var N=F[l];e.Geometry.Parse(N,t,r)}}for(l=0,u=s.meshes.length;u>l;l++){var z=s.meshes[l],k=e.Mesh.Parse(z,t,r);o+=0===l?"\n	Meshes:":"",o+="\n		"+k.toString(a)}for(l=0,u=s.cameras.length;u>l;l++){var U=s.cameras[l],G=e.Camera.Parse(U,t);o+=0===l?"\n	Cameras:":"",o+="\n		"+G.toString(a)}for(s.activeCameraID&&t.setActiveCameraByID(s.activeCameraID),l=0,u=t.cameras.length;u>l;l++){var G=t.cameras[l];G._waitingParentId&&(G.parent=t.getLastEntryByID(G._waitingParentId),G._waitingParentId=void 0)}for(l=0,u=t.lights.length;u>l;l++){var d=t.lights[l];d._waitingParentId&&(d.parent=t.getLastEntryByID(d._waitingParentId),d._waitingParentId=void 0)}var W,Y=[];if(e.AudioEngine&&s.sounds)for(l=0,u=s.sounds.length;u>l;l++){var H=s.sounds[l];if(e.Engine.audioEngine.canUseWebAudio)H.url||(H.url=H.name),Y[H.url]?e.Sound.Parse(H,t,r,Y[H.url]):(W=e.Sound.Parse(H,t,r),Y[H.url]=W);else{new e.Sound(H.name,null,t)}}for(Y=[],l=0,u=t.meshes.length;u>l;l++){var k=t.meshes[l];k._waitingParentId&&(k.parent=t.getLastEntryByID(k._waitingParentId),k._waitingParentId=void 0),k._waitingActions&&(e.ActionManager.Parse(k._waitingActions,k,t),k._waitingActions=void 0)}for(l=0,u=t.meshes.length;u>l;l++){var j=t.meshes[l];j._waitingFreezeWorldMatrix?(j.freezeWorldMatrix(),j._waitingFreezeWorldMatrix=void 0):j.computeWorldMatrix(!0)}if(s.particleSystems)for(l=0,u=s.particleSystems.length;u>l;l++){var X=s.particleSystems[l];e.ParticleSystem.Parse(X,t,r)}if(s.lensFlareSystems)for(l=0,u=s.lensFlareSystems.length;u>l;l++){var K=s.lensFlareSystems[l];e.LensFlareSystem.Parse(K,t,r)}if(s.shadowGenerators)for(l=0,u=s.shadowGenerators.length;u>l;l++){var Z=s.shadowGenerators[l];e.ShadowGenerator.Parse(Z,t)}return s.actions&&e.ActionManager.Parse(s.actions,null,t),!0}catch(q){throw e.Tools.Log(n("importScene",s.producer)+o),o=null,q}finally{null!==o&&e.SceneLoader.loggingLevel!==e.SceneLoader.NO_LOGGING&&e.Tools.Log(n("importScene",s.producer)+(e.SceneLoader.loggingLevel!==e.SceneLoader.MINIMAL_LOGGING?o:""))}}})}(t=e.Internals||(e.Internals={}))}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(t,i,r,n,o,s,a){void 0===a&&(a=e.Texture.TRILINEAR_SAMPLINGMODE),this.name=t,this.cellSize=n,this.sprites=new Array,this.renderingGroupId=0,this.layerMask=268435455,this.fogEnabled=!0,this.isPickable=!1,this.onDisposeObservable=new e.Observable,this._vertexBuffers={},this._capacity=r,this._spriteTexture=new e.Texture(i,o,!0,!1,a),this._spriteTexture.wrapU=e.Texture.CLAMP_ADDRESSMODE,this._spriteTexture.wrapV=e.Texture.CLAMP_ADDRESSMODE,this._epsilon=void 0===s?.01:s,this._scene=o,this._scene.spriteManagers.push(this);for(var h=[],c=0,l=0;r>l;l++)h.push(c),h.push(c+1),h.push(c+2),h.push(c),h.push(c+2),h.push(c+3),c+=4;this._indexBuffer=o.getEngine().createIndexBuffer(h),this._vertexData=new Float32Array(16*r*4),this._buffer=new e.Buffer(o.getEngine(),this._vertexData,!0,16);var u=this._buffer.createVertexBuffer(e.VertexBuffer.PositionKind,0,4),f=this._buffer.createVertexBuffer("options",4,4),d=this._buffer.createVertexBuffer("cellInfo",8,4),p=this._buffer.createVertexBuffer(e.VertexBuffer.ColorKind,12,4);this._vertexBuffers[e.VertexBuffer.PositionKind]=u,this._vertexBuffers.options=f,this._vertexBuffers.cellInfo=d,this._vertexBuffers[e.VertexBuffer.ColorKind]=p,this._effectBase=this._scene.getEngine().createEffect("sprites",[e.VertexBuffer.PositionKind,"options","cellInfo",e.VertexBuffer.ColorKind],["view","projection","textureInfos","alphaTest"],["diffuseSampler"],""),this._effectFog=this._scene.getEngine().createEffect("sprites",[e.VertexBuffer.PositionKind,"options","cellInfo",e.VertexBuffer.ColorKind],["view","projection","textureInfos","alphaTest","vFogInfos","vFogColor"],["diffuseSampler"],"#define FOG")}return Object.defineProperty(t.prototype,"onDispose",{set:function(e){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"texture",{get:function(){return this._spriteTexture},set:function(e){this._spriteTexture=e},enumerable:!0,configurable:!0}),t.prototype._appendSpriteVertex=function(e,t,i,r,n){var o=16*e;0===i?i=this._epsilon:1===i&&(i=1-this._epsilon),0===r?r=this._epsilon:1===r&&(r=1-this._epsilon),this._vertexData[o]=t.position.x,this._vertexData[o+1]=t.position.y,this._vertexData[o+2]=t.position.z,this._vertexData[o+3]=t.angle,this._vertexData[o+4]=t.width,this._vertexData[o+5]=t.height,this._vertexData[o+6]=i,this._vertexData[o+7]=r,this._vertexData[o+8]=t.invertU?1:0,this._vertexData[o+9]=t.invertV?1:0;var s=t.cellIndex/n>>0;this._vertexData[o+10]=t.cellIndex-s*n,this._vertexData[o+11]=s,this._vertexData[o+12]=t.color.r,this._vertexData[o+13]=t.color.g,this._vertexData[o+14]=t.color.b,this._vertexData[o+15]=t.color.a},t.prototype.intersects=function(t,i,r,n){for(var o,s=Math.min(this._capacity,this.sprites.length),a=e.Vector3.Zero(),h=e.Vector3.Zero(),c=Number.MAX_VALUE,l=e.Vector3.Zero(),u=i.getViewMatrix(),f=0;s>f;f++){var d=this.sprites[f];if(d){if(r){if(!r(d))continue}else if(!d.isPickable)continue;if(e.Vector3.TransformCoordinatesToRef(d.position,u,l),a.copyFromFloats(l.x-d.width/2,l.y-d.height/2,l.z),h.copyFromFloats(l.x+d.width/2,l.y+d.height/2,l.z),t.intersectsBoxMinMax(a,h)){var p=e.Vector3.Distance(l,t.origin);if(c>p&&(c=p,o=d,n))break}}}if(o){var _=new e.PickingInfo;return _.hit=!0,_.pickedSprite=o,_.distance=c,_}return null},t.prototype.render=function(){if(this._effectBase.isReady()&&this._effectFog.isReady()&&this._spriteTexture&&this._spriteTexture.isReady()){for(var t=this._scene.getEngine(),i=this._spriteTexture.getBaseSize(),r=t.getDeltaTime(),n=Math.min(this._capacity,this.sprites.length),o=i.width/this.cellSize,s=0,a=0;n>a;a++){var h=this.sprites[a];h&&(h._animate(r),this._appendSpriteVertex(s++,h,0,0,o),this._appendSpriteVertex(s++,h,1,0,o),this._appendSpriteVertex(s++,h,1,1,o),this._appendSpriteVertex(s++,h,0,1,o))}this._buffer.update(this._vertexData);var c=this._effectBase;this._scene.fogEnabled&&this._scene.fogMode!==e.Scene.FOGMODE_NONE&&this.fogEnabled&&(c=this._effectFog),t.enableEffect(c);var l=this._scene.getViewMatrix();c.setTexture("diffuseSampler",this._spriteTexture),c.setMatrix("view",l),c.setMatrix("projection",this._scene.getProjectionMatrix()),c.setFloat2("textureInfos",this.cellSize/i.width,this.cellSize/i.height),this._scene.fogEnabled&&this._scene.fogMode!==e.Scene.FOGMODE_NONE&&this.fogEnabled&&(c.setFloat4("vFogInfos",this._scene.fogMode,this._scene.fogStart,this._scene.fogEnd,this._scene.fogDensity),c.setColor3("vFogColor",this._scene.fogColor)),t.bindBuffers(this._vertexBuffers,this._indexBuffer,c),t.setDepthFunctionToLessOrEqual(),c.setBool("alphaTest",!0),t.setColorWrite(!1),t.draw(!0,0,6*n),t.setColorWrite(!0),c.setBool("alphaTest",!1),t.setAlphaMode(e.Engine.ALPHA_COMBINE),t.draw(!0,0,6*n),t.setAlphaMode(e.Engine.ALPHA_DISABLE)}},t.prototype.dispose=function(){this._buffer&&(this._buffer.dispose(),this._buffer=null),this._indexBuffer&&(this._scene.getEngine()._releaseBuffer(this._indexBuffer),this._indexBuffer=null),this._spriteTexture&&(this._spriteTexture.dispose(),this._spriteTexture=null);var e=this._scene.spriteManagers.indexOf(this);this._scene.spriteManagers.splice(e,1),this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear()},t}();e.SpriteManager=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(t,i){this.name=t,this.color=new e.Color4(1,1,1,1),this.width=1,this.height=1,this.angle=0,this.cellIndex=0,this.invertU=0,this.invertV=0,this.animations=new Array,this.isPickable=!1,this._animationStarted=!1,this._loopAnimation=!1,this._fromIndex=0,this._toIndex=0,this._delay=0,this._direction=1,this._frameCount=0,this._time=0,this._manager=i,this._manager.sprites.push(this),this.position=e.Vector3.Zero()}return Object.defineProperty(t.prototype,"size",{get:function(){return this.width},set:function(e){this.width=e,this.height=e},enumerable:!0,configurable:!0}),t.prototype.playAnimation=function(e,t,i,r){this._fromIndex=e,this._toIndex=t,this._loopAnimation=i,this._delay=r,this._animationStarted=!0,this._direction=t>e?1:-1,this.cellIndex=e,this._time=0},t.prototype.stopAnimation=function(){this._animationStarted=!1},t.prototype._animate=function(e){this._animationStarted&&(this._time+=e,this._time>this._delay&&(this._time=this._time%this._delay,this.cellIndex+=this._direction,this.cellIndex==this._toIndex&&(this._loopAnimation?this.cellIndex=this._fromIndex:(this._animationStarted=!1,this.disposeWhenFinishedAnimating&&this.dispose()))))},t.prototype.dispose=function(){for(var e=0;e<this._manager.sprites.length;e++)this._manager.sprites[e]==this&&this._manager.sprites.splice(e,1)},t}();e.Sprite=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(t,i,r,n,o){this.name=t,this.scale=new e.Vector2(1,1),this.offset=new e.Vector2(0,0),this.alphaBlendingMode=e.Engine.ALPHA_COMBINE,this._vertexBuffers={},this.onDisposeObservable=new e.Observable,this.onBeforeRenderObservable=new e.Observable,this.onAfterRenderObservable=new e.Observable,this.texture=i?new e.Texture(i,r,!0):null,this.isBackground=void 0===n?!0:n,this.color=void 0===o?new e.Color4(1,1,1,1):o,this._scene=r,this._scene.layers.push(this);var s=r.getEngine(),a=[];a.push(1,1),a.push(-1,1),a.push(-1,-1),a.push(1,-1);var h=new e.VertexBuffer(s,a,e.VertexBuffer.PositionKind,!1,!1,2);this._vertexBuffers[e.VertexBuffer.PositionKind]=h;var c=[];c.push(0),c.push(1),c.push(2),c.push(0),c.push(2),c.push(3),this._indexBuffer=s.createIndexBuffer(c),this._effect=s.createEffect("layer",[e.VertexBuffer.PositionKind],["textureMatrix","color","scale","offset"],["textureSampler"],""),this._alphaTestEffect=s.createEffect("layer",[e.VertexBuffer.PositionKind],["textureMatrix","color","scale","offset"],["textureSampler"],"#define ALPHATEST")}return Object.defineProperty(t.prototype,"onDispose",{set:function(e){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onBeforeRender",{set:function(e){this._onBeforeRenderObserver&&this.onBeforeRenderObservable.remove(this._onBeforeRenderObserver),this._onBeforeRenderObserver=this.onBeforeRenderObservable.add(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onAfterRender",{set:function(e){this._onAfterRenderObserver&&this.onAfterRenderObservable.remove(this._onAfterRenderObserver),this._onAfterRenderObserver=this.onAfterRenderObservable.add(e)},enumerable:!0,configurable:!0}),t.prototype.render=function(){var t=this.alphaTest?this._alphaTestEffect:this._effect;if(t.isReady()&&this.texture&&this.texture.isReady()){var i=this._scene.getEngine();this.onBeforeRenderObservable.notifyObservers(this),i.enableEffect(t),i.setState(!1),t.setTexture("textureSampler",this.texture),t.setMatrix("textureMatrix",this.texture.getTextureMatrix()),t.setFloat4("color",this.color.r,this.color.g,this.color.b,this.color.a),t.setVector2("offset",this.offset),t.setVector2("scale",this.scale),i.bindBuffers(this._vertexBuffers,this._indexBuffer,t),this._alphaTestEffect?i.draw(!0,0,6):(i.setAlphaMode(this.alphaBlendingMode),i.draw(!0,0,6),i.setAlphaMode(e.Engine.ALPHA_DISABLE)),this.onAfterRenderObservable.notifyObservers(this)}},t.prototype.dispose=function(){var t=this._vertexBuffers[e.VertexBuffer.PositionKind];t&&(t.dispose(),this._vertexBuffers[e.VertexBuffer.PositionKind]=null),this._indexBuffer&&(this._scene.getEngine()._releaseBuffer(this._indexBuffer),this._indexBuffer=null),this.texture&&(this.texture.dispose(),this.texture=null);var i=this._scene.layers.indexOf(this);this._scene.layers.splice(i,1),this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear(),this.onAfterRenderObservable.clear(),this.onBeforeRenderObservable.clear()},t}();e.Layer=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(){this.position=e.Vector3.Zero(),this.direction=e.Vector3.Zero(),this.color=new e.Color4(0,0,0,0),this.colorStep=new e.Color4(0,0,0,0),this.lifeTime=1,this.age=0,this.size=0,this.angle=0,this.angularSpeed=0}return t.prototype.copyTo=function(e){e.position.copyFrom(this.position),e.direction.copyFrom(this.direction),e.color.copyFrom(this.color),e.colorStep.copyFrom(this.colorStep),e.lifeTime=this.lifeTime,e.age=this.age,e.size=this.size,e.angle=this.angle,e.angularSpeed=this.angularSpeed},t}();e.Particle=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(e,t){if(e===t)return e;var i=Math.random();return i*(t-e)+e},i=function(){function i(r,n,o,s){var a=this;this.name=r,this.animations=[],this.renderingGroupId=0,this.emitter=null,this.emitRate=10,this.manualEmitCount=-1,this.updateSpeed=.01,this.targetStopDuration=0,this.disposeOnStop=!1,this.minEmitPower=1,this.maxEmitPower=1,this.minLifeTime=1,this.maxLifeTime=1,this.minSize=1,this.maxSize=1,this.minAngularSpeed=0,this.maxAngularSpeed=0,this.layerMask=268435455,this.onDisposeObservable=new e.Observable,this.blendMode=i.BLENDMODE_ONEONE,this.forceDepthWrite=!1,this.gravity=e.Vector3.Zero(),this.direction1=new e.Vector3(0,1,0),this.direction2=new e.Vector3(0,1,0),this.minEmitBox=new e.Vector3(-.5,-.5,-.5),this.maxEmitBox=new e.Vector3(.5,.5,.5),this.color1=new e.Color4(1,1,1,1),this.color2=new e.Color4(1,1,1,1),this.colorDead=new e.Color4(0,0,0,1),this.textureMask=new e.Color4(1,1,1,1),this.particles=new Array,this._stockParticles=new Array,this._newPartsExcess=0,this._vertexBuffers={},this._scaledColorStep=new e.Color4(0,0,0,0),this._colorDiff=new e.Color4(0,0,0,0),this._scaledDirection=e.Vector3.Zero(),this._scaledGravity=e.Vector3.Zero(),this._currentRenderId=-1,this._started=!1,this._stopped=!1,this._actualFrame=0,this.id=r,this._capacity=n,this._scene=o,this._customEffect=s,o.particleSystems.push(this);for(var h=[],c=0,l=0;n>l;l++)h.push(c),h.push(c+1),h.push(c+2),h.push(c),h.push(c+2),h.push(c+3),c+=4;this._indexBuffer=o.getEngine().createIndexBuffer(h),this._vertexData=new Float32Array(11*n*4),this._vertexBuffer=new e.Buffer(o.getEngine(),this._vertexData,!0,11);var u=this._vertexBuffer.createVertexBuffer(e.VertexBuffer.PositionKind,0,3),f=this._vertexBuffer.createVertexBuffer(e.VertexBuffer.ColorKind,3,4),d=this._vertexBuffer.createVertexBuffer("options",7,4);this._vertexBuffers[e.VertexBuffer.PositionKind]=u,this._vertexBuffers[e.VertexBuffer.ColorKind]=f,this._vertexBuffers.options=d,this.startDirectionFunction=function(i,r,n,o){var s=t(a.direction1.x,a.direction2.x),h=t(a.direction1.y,a.direction2.y),c=t(a.direction1.z,a.direction2.z);e.Vector3.TransformNormalFromFloatsToRef(s*i,h*i,c*i,r,n)},this.startPositionFunction=function(i,r,n){var o=t(a.minEmitBox.x,a.maxEmitBox.x),s=t(a.minEmitBox.y,a.maxEmitBox.y),h=t(a.minEmitBox.z,a.maxEmitBox.z);e.Vector3.TransformCoordinatesFromFloatsToRef(o,s,h,i,r)},this.updateFunction=function(e){for(var t=0;t<e.length;t++){var i=e[t];i.age+=a._scaledUpdateSpeed,i.age>=i.lifeTime?(a.recycleParticle(i),t--):(i.colorStep.scaleToRef(a._scaledUpdateSpeed,a._scaledColorStep),i.color.addInPlace(a._scaledColorStep),i.color.a<0&&(i.color.a=0),i.angle+=i.angularSpeed*a._scaledUpdateSpeed,i.direction.scaleToRef(a._scaledUpdateSpeed,a._scaledDirection),i.position.addInPlace(a._scaledDirection),a.gravity.scaleToRef(a._scaledUpdateSpeed,a._scaledGravity),i.direction.addInPlace(a._scaledGravity))}}}return Object.defineProperty(i.prototype,"onDispose",{set:function(e){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(e)},enumerable:!0,configurable:!0}),i.prototype.recycleParticle=function(e){var t=this.particles.pop();t!==e&&(t.copyTo(e),this._stockParticles.push(t))},i.prototype.getCapacity=function(){return this._capacity},i.prototype.isAlive=function(){return this._alive},i.prototype.isStarted=function(){return this._started},i.prototype.start=function(){this._started=!0,this._stopped=!1,this._actualFrame=0},i.prototype.stop=function(){this._stopped=!0},i.prototype._appendParticleVertex=function(e,t,i,r){var n=11*e;this._vertexData[n]=t.position.x,this._vertexData[n+1]=t.position.y,this._vertexData[n+2]=t.position.z,this._vertexData[n+3]=t.color.r,this._vertexData[n+4]=t.color.g,this._vertexData[n+5]=t.color.b,this._vertexData[n+6]=t.color.a,this._vertexData[n+7]=t.angle,this._vertexData[n+8]=t.size,this._vertexData[n+9]=i,this._vertexData[n+10]=r},i.prototype._update=function(i){this._alive=this.particles.length>0,this.updateFunction(this.particles);var r;r=this.emitter.position?this.emitter.getWorldMatrix():e.Matrix.Translation(this.emitter.x,this.emitter.y,this.emitter.z);for(var n,o=0;i>o&&this.particles.length!==this._capacity;o++){0!==this._stockParticles.length?(n=this._stockParticles.pop(),n.age=0):n=new e.Particle,this.particles.push(n);var s=t(this.minEmitPower,this.maxEmitPower);this.startDirectionFunction(s,r,n.direction,n),n.lifeTime=t(this.minLifeTime,this.maxLifeTime),n.size=t(this.minSize,this.maxSize),n.angularSpeed=t(this.minAngularSpeed,this.maxAngularSpeed),this.startPositionFunction(r,n.position,n);var a=t(0,1);e.Color4.LerpToRef(this.color1,this.color2,a,n.color),this.colorDead.subtractToRef(n.color,this._colorDiff),this._colorDiff.scaleToRef(1/n.lifeTime,n.colorStep)}},i.prototype._getEffect=function(){if(this._customEffect)return this._customEffect;var t=[];this._scene.clipPlane&&t.push("#define CLIPPLANE");var i=t.join("\n");return this._cachedDefines!==i&&(this._cachedDefines=i,this._effect=this._scene.getEngine().createEffect("particles",[e.VertexBuffer.PositionKind,e.VertexBuffer.ColorKind,"options"],["invView","view","projection","vClipPlane","textureMask"],["diffuseSampler"],i)),this._effect},i.prototype.animate=function(){if(this._started){var e=this._getEffect();if(this.emitter&&e.isReady()&&this.particleTexture&&this.particleTexture.isReady()&&this._currentRenderId!==this._scene.getRenderId()){this._currentRenderId=this._scene.getRenderId(),this._scaledUpdateSpeed=this.updateSpeed*this._scene.getAnimationRatio();var t;this.manualEmitCount>-1?(t=this.manualEmitCount,this._newPartsExcess=0,this.manualEmitCount=0):(t=this.emitRate*this._scaledUpdateSpeed>>0,this._newPartsExcess+=this.emitRate*this._scaledUpdateSpeed-t),this._newPartsExcess>1&&(t+=this._newPartsExcess>>0,this._newPartsExcess-=this._newPartsExcess>>0),this._alive=!1,this._stopped?t=0:(this._actualFrame+=this._scaledUpdateSpeed,this.targetStopDuration&&this._actualFrame>=this.targetStopDuration&&this.stop()),this._update(t),this._stopped&&(this._alive||(this._started=!1,this.disposeOnStop&&this._scene._toBeDisposed.push(this)));for(var i=0,r=0;r<this.particles.length;r++){var n=this.particles[r];this._appendParticleVertex(i++,n,0,0),this._appendParticleVertex(i++,n,1,0),this._appendParticleVertex(i++,n,1,1),this._appendParticleVertex(i++,n,0,1)}this._vertexBuffer.update(this._vertexData)}}},i.prototype.render=function(){var t=this._getEffect();if(!(this.emitter&&t.isReady()&&this.particleTexture&&this.particleTexture.isReady()&&this.particles.length))return 0;var r=this._scene.getEngine();r.enableEffect(t),r.setState(!1);var n=this._scene.getViewMatrix();if(t.setTexture("diffuseSampler",this.particleTexture),t.setMatrix("view",n),t.setMatrix("projection",this._scene.getProjectionMatrix()),t.setFloat4("textureMask",this.textureMask.r,this.textureMask.g,this.textureMask.b,this.textureMask.a),this._scene.clipPlane){var o=this._scene.clipPlane,s=n.clone();s.invert(),t.setMatrix("invView",s),t.setFloat4("vClipPlane",o.normal.x,o.normal.y,o.normal.z,o.d)}return r.bindBuffers(this._vertexBuffers,this._indexBuffer,t),this.blendMode===i.BLENDMODE_ONEONE?r.setAlphaMode(e.Engine.ALPHA_ONEONE):r.setAlphaMode(e.Engine.ALPHA_COMBINE),this.forceDepthWrite&&r.setDepthWrite(!0),r.draw(!0,0,6*this.particles.length),r.setAlphaMode(e.Engine.ALPHA_DISABLE),this.particles.length},i.prototype.dispose=function(){this._vertexBuffer&&(this._vertexBuffer.dispose(),this._vertexBuffer=null),this._indexBuffer&&(this._scene.getEngine()._releaseBuffer(this._indexBuffer),this._indexBuffer=null),this.particleTexture&&(this.particleTexture.dispose(),this.particleTexture=null);var e=this._scene.particleSystems.indexOf(this);this._scene.particleSystems.splice(e,1),this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear()},i.prototype.clone=function(t,r){var n=new i(t,this._capacity,this._scene);return e.Tools.DeepCopy(this,n,["particles"]),void 0===r&&(r=this.emitter),n.emitter=r,this.particleTexture&&(n.particleTexture=new e.Texture(this.particleTexture.url,this._scene)),n.start(),n},i.prototype.serialize=function(){var t={};return t.name=this.name,t.id=this.id,this.emitter.position?t.emitterId=this.emitter.id:t.emitter=this.emitter.asArray(),t.capacity=this.getCapacity(),this.particleTexture&&(t.textureName=this.particleTexture.name),e.Animation.AppendSerializedAnimations(this,t),t.minAngularSpeed=this.minAngularSpeed,t.maxAngularSpeed=this.maxAngularSpeed,t.minSize=this.minSize,t.maxSize=this.maxSize,t.minEmitPower=this.minEmitPower,t.maxEmitPower=this.maxEmitPower,t.minLifeTime=this.minLifeTime,t.maxLifeTime=this.maxLifeTime,t.emitRate=this.emitRate,t.minEmitBox=this.minEmitBox.asArray(),t.maxEmitBox=this.maxEmitBox.asArray(),t.gravity=this.gravity.asArray(),t.direction1=this.direction1.asArray(),t.direction2=this.direction2.asArray(),t.color1=this.color1.asArray(),t.color2=this.color2.asArray(),t.colorDead=this.colorDead.asArray(),t.updateSpeed=this.updateSpeed,t.targetStopDuration=this.targetStopDuration,t.textureMask=this.textureMask.asArray(),t.blendMode=this.blendMode,t},i.Parse=function(t,r,n){var o=t.name,s=new i(o,t.capacity,r);if(t.id&&(s.id=t.id),t.textureName&&(s.particleTexture=new e.Texture(n+t.textureName,r),s.particleTexture.name=t.textureName),t.emitterId?s.emitter=r.getLastMeshByID(t.emitterId):s.emitter=e.Vector3.FromArray(t.emitter),t.animations)for(var a=0;a<t.animations.length;a++){var h=t.animations[a];s.animations.push(e.Animation.Parse(h))}return t.autoAnimate&&r.beginAnimation(s,t.autoAnimateFrom,t.autoAnimateTo,t.autoAnimateLoop,t.autoAnimateSpeed||1),s.minAngularSpeed=t.minAngularSpeed,s.maxAngularSpeed=t.maxAngularSpeed,s.minSize=t.minSize,s.maxSize=t.maxSize,s.minLifeTime=t.minLifeTime,s.maxLifeTime=t.maxLifeTime,s.minEmitPower=t.minEmitPower,s.maxEmitPower=t.maxEmitPower,s.emitRate=t.emitRate,s.minEmitBox=e.Vector3.FromArray(t.minEmitBox),s.maxEmitBox=e.Vector3.FromArray(t.maxEmitBox),s.gravity=e.Vector3.FromArray(t.gravity),s.direction1=e.Vector3.FromArray(t.direction1),s.direction2=e.Vector3.FromArray(t.direction2),s.color1=e.Color4.FromArray(t.color1),s.color2=e.Color4.FromArray(t.color2),s.colorDead=e.Color4.FromArray(t.colorDead),s.updateSpeed=t.updateSpeed,s.targetStopDuration=t.targetStopDuration,s.textureMask=e.Color4.FromArray(t.textureMask),s.blendMode=t.blendMode,t.preventAutoStart||s.start(),s},i.BLENDMODE_ONEONE=0,i.BLENDMODE_STANDARD=1,i}();e.ParticleSystem=i}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function e(e,t,i){this.name=e,this.from=t,this.to=i}return e.prototype.clone=function(){return new e(this.name,this.from,this.to)},e}();e.AnimationRange=t;var i=function(){function e(e,t,i){this.frame=e,this.action=t,this.onlyOnce=i,this.isDone=!1}return e}();e.AnimationEvent=i;var r=function(){function t(e){this.path=e,this._onchange=new Array,this.value=0,this.animations=new Array}return t.prototype.getPoint=function(){var t=this.path.getPointAtLengthPosition(this.value);return new e.Vector3(t.x,0,t.y)},t.prototype.moveAhead=function(e){return void 0===e&&(e=.002),this.move(e),this},t.prototype.moveBack=function(e){return void 0===e&&(e=.002),this.move(-e),this},t.prototype.move=function(e){if(Math.abs(e)>1)throw"step size should be less than 1.";return this.value+=e,this.ensureLimits(),this.raiseOnChange(),this},t.prototype.ensureLimits=function(){for(;this.value>1;)this.value-=1;for(;this.value<0;)this.value+=1;return this},t.prototype.markAsDirty=function(e){return this.ensureLimits(),this.raiseOnChange(),this},t.prototype.raiseOnChange=function(){var e=this;return this._onchange.forEach(function(t){return t(e)}),this},t.prototype.onchange=function(e){return this._onchange.push(e),this},t}();e.PathCursor=r;var n=function(){function i(e,t,r,n,o,s){this.name=e,this.targetProperty=t,this.framePerSecond=r,this.dataType=n,this.loopMode=o,this.enableBlending=s,this._offsetsCache={},this._highLimitsCache={},this._stopped=!1,this._blendingFactor=0,this._events=new Array,this.allowMatricesInterpolation=!1,this.blendingSpeed=.01,this._ranges={},this.targetPropertyPath=t.split("."),this.dataType=n,this.loopMode=void 0===o?i.ANIMATIONLOOPMODE_CYCLE:o}return i._PrepareAnimation=function(t,r,n,o,s,a,h,c){var l=void 0;if(!isNaN(parseFloat(s))&&isFinite(s)?l=i.ANIMATIONTYPE_FLOAT:s instanceof e.Quaternion?l=i.ANIMATIONTYPE_QUATERNION:s instanceof e.Vector3?l=i.ANIMATIONTYPE_VECTOR3:s instanceof e.Vector2?l=i.ANIMATIONTYPE_VECTOR2:s instanceof e.Color3?l=i.ANIMATIONTYPE_COLOR3:s instanceof e.Size&&(l=i.ANIMATIONTYPE_SIZE),void 0==l)return null;var u=new i(t,r,n,l,h),f=[];return f.push({frame:0,value:s}),f.push({frame:o,value:a}),u.setKeys(f),void 0!==c&&u.setEasingFunction(c),u},i.CreateAndStartAnimation=function(e,t,r,n,o,s,a,h,c,l){var u=i._PrepareAnimation(e,r,n,o,s,a,h,c);return t.getScene().beginDirectAnimation(t,[u],0,o,1===u.loopMode,1,l)},i.CreateMergeAndStartAnimation=function(e,t,r,n,o,s,a,h,c,l){var u=i._PrepareAnimation(e,r,n,o,s,a,h,c);return t.animations.push(u),t.getScene().beginAnimation(t,0,o,1===u.loopMode,1,l)},i.prototype.toString=function(e){var t="Name: "+this.name+", property: "+this.targetProperty;if(t+=", datatype: "+["Float","Vector3","Quaternion","Matrix","Color3","Vector2"][this.dataType],t+=", nKeys: "+(this._keys?this._keys.length:"none"),t+=", nRanges: "+(this._ranges?Object.keys(this._ranges).length:"none"),e){t+=", Ranges: {";var i=!0;for(var r in this._ranges)i&&(t+=", ",i=!1),t+=r;t+="}"}return t},i.prototype.addEvent=function(e){this._events.push(e)},i.prototype.removeEvents=function(e){for(var t=0;t<this._events.length;t++)this._events[t].frame===e&&(this._events.splice(t,1),t--)},i.prototype.createRange=function(e,i,r){this._ranges[e]||(this._ranges[e]=new t(e,i,r))},i.prototype.deleteRange=function(e,t){if(void 0===t&&(t=!0),this._ranges[e]){if(t)for(var i=this._ranges[e].from,r=this._ranges[e].to,n=this._keys.length-1;n>=0;n--)this._keys[n].frame>=i&&this._keys[n].frame<=r&&this._keys.splice(n,1);this._ranges[e]=void 0}},i.prototype.getRange=function(e){return this._ranges[e]},i.prototype.reset=function(){this._offsetsCache={},this._highLimitsCache={},this.currentFrame=0,this._blendingFactor=0,this._originalBlendValue=null},i.prototype.isStopped=function(){return this._stopped},i.prototype.getKeys=function(){return this._keys},i.prototype.getHighestFrame=function(){for(var e=0,t=0,i=this._keys.length;i>t;t++)e<this._keys[t].frame&&(e=this._keys[t].frame);return e},i.prototype.getEasingFunction=function(){return this._easingFunction},i.prototype.setEasingFunction=function(e){this._easingFunction=e},i.prototype.floatInterpolateFunction=function(e,t,i){return e+(t-e)*i},i.prototype.quaternionInterpolateFunction=function(t,i,r){return e.Quaternion.Slerp(t,i,r)},i.prototype.vector3InterpolateFunction=function(t,i,r){return e.Vector3.Lerp(t,i,r)},i.prototype.vector2InterpolateFunction=function(t,i,r){return e.Vector2.Lerp(t,i,r)},i.prototype.sizeInterpolateFunction=function(t,i,r){return e.Size.Lerp(t,i,r)},i.prototype.color3InterpolateFunction=function(t,i,r){return e.Color3.Lerp(t,i,r)},i.prototype.matrixInterpolateFunction=function(t,i,r){return e.Matrix.Lerp(t,i,r)},i.prototype.clone=function(){var e=new i(this.name,this.targetPropertyPath.join("."),this.framePerSecond,this.dataType,this.loopMode);if(this._keys&&e.setKeys(this._keys),this._ranges){e._ranges={};for(var t in this._ranges)e._ranges[t]=this._ranges[t].clone()}return e},i.prototype.setKeys=function(e){this._keys=e.slice(0),this._offsetsCache={},this._highLimitsCache={}},i.prototype._getKeyValue=function(e){return"function"==typeof e?e():e},i.prototype._interpolate=function(e,t,r,n,o){if(r===i.ANIMATIONLOOPMODE_CONSTANT&&t>0)return o.clone?o.clone():o;this.currentFrame=e;var s=Math.max(0,Math.min(this._keys.length-1,Math.floor(this._keys.length*(e-this._keys[0].frame)/(this._keys[this._keys.length-1].frame-this._keys[0].frame))-1));if(this._keys[s].frame>=e)for(;s-1>=0&&this._keys[s].frame>=e;)s--;for(var a=s;a<this._keys.length;a++)if(this._keys[a+1].frame>=e){var h=this._getKeyValue(this._keys[a].value),c=this._getKeyValue(this._keys[a+1].value),l=(e-this._keys[a].frame)/(this._keys[a+1].frame-this._keys[a].frame);switch(null!=this._easingFunction&&(l=this._easingFunction.ease(l)),this.dataType){case i.ANIMATIONTYPE_FLOAT:switch(r){case i.ANIMATIONLOOPMODE_CYCLE:case i.ANIMATIONLOOPMODE_CONSTANT:return this.floatInterpolateFunction(h,c,l);case i.ANIMATIONLOOPMODE_RELATIVE:return n*t+this.floatInterpolateFunction(h,c,l)}break;case i.ANIMATIONTYPE_QUATERNION:var u=null;switch(r){case i.ANIMATIONLOOPMODE_CYCLE:case i.ANIMATIONLOOPMODE_CONSTANT:u=this.quaternionInterpolateFunction(h,c,l);break;case i.ANIMATIONLOOPMODE_RELATIVE:u=this.quaternionInterpolateFunction(h,c,l).add(n.scale(t))}return u;case i.ANIMATIONTYPE_VECTOR3:switch(r){case i.ANIMATIONLOOPMODE_CYCLE:case i.ANIMATIONLOOPMODE_CONSTANT:return this.vector3InterpolateFunction(h,c,l);case i.ANIMATIONLOOPMODE_RELATIVE:return this.vector3InterpolateFunction(h,c,l).add(n.scale(t))}case i.ANIMATIONTYPE_VECTOR2:switch(r){case i.ANIMATIONLOOPMODE_CYCLE:case i.ANIMATIONLOOPMODE_CONSTANT:return this.vector2InterpolateFunction(h,c,l);case i.ANIMATIONLOOPMODE_RELATIVE:return this.vector2InterpolateFunction(h,c,l).add(n.scale(t))}case i.ANIMATIONTYPE_SIZE:switch(r){case i.ANIMATIONLOOPMODE_CYCLE:case i.ANIMATIONLOOPMODE_CONSTANT:return this.sizeInterpolateFunction(h,c,l);case i.ANIMATIONLOOPMODE_RELATIVE:return this.sizeInterpolateFunction(h,c,l).add(n.scale(t))}case i.ANIMATIONTYPE_COLOR3:switch(r){case i.ANIMATIONLOOPMODE_CYCLE:case i.ANIMATIONLOOPMODE_CONSTANT:return this.color3InterpolateFunction(h,c,l);case i.ANIMATIONLOOPMODE_RELATIVE:return this.color3InterpolateFunction(h,c,l).add(n.scale(t))}case i.ANIMATIONTYPE_MATRIX:switch(r){case i.ANIMATIONLOOPMODE_CYCLE:case i.ANIMATIONLOOPMODE_CONSTANT:
if(this.allowMatricesInterpolation)return this.matrixInterpolateFunction(h,c,l);case i.ANIMATIONLOOPMODE_RELATIVE:return h}}break}return this._getKeyValue(this._keys[this._keys.length-1].value)},i.prototype.setValue=function(t,i){void 0===i&&(i=!1);var r,n;if(this.targetPropertyPath.length>1){for(var o=this._target[this.targetPropertyPath[0]],s=1;s<this.targetPropertyPath.length-1;s++)o=o[this.targetPropertyPath[s]];r=this.targetPropertyPath[this.targetPropertyPath.length-1],n=o}else r=this.targetPropertyPath[0],n=this._target;this.enableBlending&&this._blendingFactor<=1?(this._originalBlendValue||(n[r].clone?this._originalBlendValue=n[r].clone():this._originalBlendValue=n[r]),this._originalBlendValue.prototype?this._originalBlendValue.prototype.Lerp?n[r]=this._originalBlendValue.construtor.prototype.Lerp(t,this._originalBlendValue,this._blendingFactor):n[r]=t:this._originalBlendValue.m?n[r]=e.Matrix.Lerp(this._originalBlendValue,t,this._blendingFactor):n[r]=this._originalBlendValue*(1-this._blendingFactor)+this._blendingFactor*t,this._blendingFactor+=this.blendingSpeed):n[r]=t,this._target.markAsDirty&&this._target.markAsDirty(this.targetProperty)},i.prototype.goToFrame=function(e){e<this._keys[0].frame?e=this._keys[0].frame:e>this._keys[this._keys.length-1].frame&&(e=this._keys[this._keys.length-1].frame);var t=this._interpolate(e,0,this.loopMode);this.setValue(t)},i.prototype.animate=function(t,r,n,o,s,a){if(void 0===a&&(a=!1),!this.targetPropertyPath||this.targetPropertyPath.length<1)return this._stopped=!0,!1;var h=!0;if(0!==this._keys[0].frame){var c={frame:0,value:this._keys[0].value};this._keys.splice(0,0,c)}(r<this._keys[0].frame||r>this._keys[this._keys.length-1].frame)&&(r=this._keys[0].frame),(n<this._keys[0].frame||n>this._keys[this._keys.length-1].frame)&&(n=this._keys[this._keys.length-1].frame);var l,u=n-r,f=t*(this.framePerSecond*s)/1e3,d=0;if(f>u&&!o)h=!1,d=this._getKeyValue(this._keys[this._keys.length-1].value);else if(this.loopMode!==i.ANIMATIONLOOPMODE_CYCLE){var p=n.toString()+r.toString();if(!this._offsetsCache[p]){var _=this._interpolate(r,0,i.ANIMATIONLOOPMODE_CYCLE),m=this._interpolate(n,0,i.ANIMATIONLOOPMODE_CYCLE);switch(this.dataType){case i.ANIMATIONTYPE_FLOAT:this._offsetsCache[p]=m-_;break;case i.ANIMATIONTYPE_QUATERNION:this._offsetsCache[p]=m.subtract(_);break;case i.ANIMATIONTYPE_VECTOR3:this._offsetsCache[p]=m.subtract(_);case i.ANIMATIONTYPE_VECTOR2:this._offsetsCache[p]=m.subtract(_);case i.ANIMATIONTYPE_SIZE:this._offsetsCache[p]=m.subtract(_);case i.ANIMATIONTYPE_COLOR3:this._offsetsCache[p]=m.subtract(_)}this._highLimitsCache[p]=m}d=this._highLimitsCache[p],l=this._offsetsCache[p]}if(void 0===l)switch(this.dataType){case i.ANIMATIONTYPE_FLOAT:l=0;break;case i.ANIMATIONTYPE_QUATERNION:l=new e.Quaternion(0,0,0,0);break;case i.ANIMATIONTYPE_VECTOR3:l=e.Vector3.Zero();break;case i.ANIMATIONTYPE_VECTOR2:l=e.Vector2.Zero();break;case i.ANIMATIONTYPE_SIZE:l=e.Size.Zero();break;case i.ANIMATIONTYPE_COLOR3:l=e.Color3.Black()}var g=f/u>>0,v=h?r+f%u:n,y=this._interpolate(v,g,this.loopMode,l,d);this.setValue(y);for(var x=0;x<this._events.length;x++)if(v>=this._events[x].frame){var b=this._events[x];b.isDone||(b.onlyOnce&&(this._events.splice(x,1),x--),b.isDone=!0,b.action())}else this._events[x].isDone&&!this._events[x].onlyOnce&&(this._events[x].isDone=!1);return h||(this._stopped=!0),h},i.prototype.serialize=function(){var e={};e.name=this.name,e.property=this.targetProperty,e.framePerSecond=this.framePerSecond,e.dataType=this.dataType,e.loopBehavior=this.loopMode;var t=this.dataType;e.keys=[];for(var r=this.getKeys(),n=0;n<r.length;n++){var o=r[n],s={};switch(s.frame=o.frame,t){case i.ANIMATIONTYPE_FLOAT:s.values=[o.value];break;case i.ANIMATIONTYPE_QUATERNION:case i.ANIMATIONTYPE_MATRIX:case i.ANIMATIONTYPE_VECTOR3:case i.ANIMATIONTYPE_COLOR3:s.values=o.value.asArray()}e.keys.push(s)}e.ranges=[];for(var a in this._ranges){var h={};h.name=a,h.from=this._ranges[a].from,h.to=this._ranges[a].to,e.ranges.push(h)}return e},Object.defineProperty(i,"ANIMATIONTYPE_FLOAT",{get:function(){return i._ANIMATIONTYPE_FLOAT},enumerable:!0,configurable:!0}),Object.defineProperty(i,"ANIMATIONTYPE_VECTOR3",{get:function(){return i._ANIMATIONTYPE_VECTOR3},enumerable:!0,configurable:!0}),Object.defineProperty(i,"ANIMATIONTYPE_VECTOR2",{get:function(){return i._ANIMATIONTYPE_VECTOR2},enumerable:!0,configurable:!0}),Object.defineProperty(i,"ANIMATIONTYPE_SIZE",{get:function(){return i._ANIMATIONTYPE_SIZE},enumerable:!0,configurable:!0}),Object.defineProperty(i,"ANIMATIONTYPE_QUATERNION",{get:function(){return i._ANIMATIONTYPE_QUATERNION},enumerable:!0,configurable:!0}),Object.defineProperty(i,"ANIMATIONTYPE_MATRIX",{get:function(){return i._ANIMATIONTYPE_MATRIX},enumerable:!0,configurable:!0}),Object.defineProperty(i,"ANIMATIONTYPE_COLOR3",{get:function(){return i._ANIMATIONTYPE_COLOR3},enumerable:!0,configurable:!0}),Object.defineProperty(i,"ANIMATIONLOOPMODE_RELATIVE",{get:function(){return i._ANIMATIONLOOPMODE_RELATIVE},enumerable:!0,configurable:!0}),Object.defineProperty(i,"ANIMATIONLOOPMODE_CYCLE",{get:function(){return i._ANIMATIONLOOPMODE_CYCLE},enumerable:!0,configurable:!0}),Object.defineProperty(i,"ANIMATIONLOOPMODE_CONSTANT",{get:function(){return i._ANIMATIONLOOPMODE_CONSTANT},enumerable:!0,configurable:!0}),i.Parse=function(t){var r,n,o=new i(t.name,t.property,t.framePerSecond,t.dataType,t.loopBehavior),s=t.dataType,a=[];for(n=0;n<t.keys.length;n++){var h=t.keys[n];switch(s){case i.ANIMATIONTYPE_FLOAT:r=h.values[0];break;case i.ANIMATIONTYPE_QUATERNION:r=e.Quaternion.FromArray(h.values);break;case i.ANIMATIONTYPE_MATRIX:r=e.Matrix.FromArray(h.values);break;case i.ANIMATIONTYPE_COLOR3:r=e.Color3.FromArray(h.values);break;case i.ANIMATIONTYPE_VECTOR3:default:r=e.Vector3.FromArray(h.values)}a.push({frame:h.frame,value:r})}if(o.setKeys(a),t.ranges)for(n=0;n<t.ranges.length;n++)r=t.ranges[n],o.createRange(r.name,r.from,r.to);return o},i.AppendSerializedAnimations=function(e,t){if(e.animations){t.animations=[];for(var i=0;i<e.animations.length;i++){var r=e.animations[i];t.animations.push(r.serialize())}}},i._ANIMATIONTYPE_FLOAT=0,i._ANIMATIONTYPE_VECTOR3=1,i._ANIMATIONTYPE_QUATERNION=2,i._ANIMATIONTYPE_MATRIX=3,i._ANIMATIONTYPE_COLOR3=4,i._ANIMATIONTYPE_VECTOR2=5,i._ANIMATIONTYPE_SIZE=6,i._ANIMATIONLOOPMODE_RELATIVE=0,i._ANIMATIONLOOPMODE_CYCLE=1,i._ANIMATIONLOOPMODE_CONSTANT=2,i}();e.Animation=n}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function e(e,t,i,r,n,o,s,a){void 0===i&&(i=0),void 0===r&&(r=100),void 0===n&&(n=!1),void 0===o&&(o=1),this.target=t,this.fromFrame=i,this.toFrame=r,this.loopAnimation=n,this.speedRatio=o,this.onAnimationEnd=s,this._animations=new Array,this._paused=!1,this.animationStarted=!1,a&&this.appendAnimations(t,a),this._scene=e,e._activeAnimatables.push(this)}return e.prototype.getAnimations=function(){return this._animations},e.prototype.appendAnimations=function(e,t){for(var i=0;i<t.length;i++){var r=t[i];r._target=e,this._animations.push(r)}},e.prototype.getAnimationByTargetProperty=function(e){for(var t=this._animations,i=0;i<t.length;i++)if(t[i].targetProperty===e)return t[i];return null},e.prototype.reset=function(){for(var e=this._animations,t=0;t<e.length;t++)e[t].reset();this._localDelayOffset=null,this._pausedDelay=null},e.prototype.enableBlending=function(e){for(var t=this._animations,i=0;i<t.length;i++)t[i].enableBlending=!0,t[i].blendingSpeed=e},e.prototype.disableBlending=function(){for(var e=this._animations,t=0;t<e.length;t++)e[t].enableBlending=!1},e.prototype.goToFrame=function(e){for(var t=this._animations,i=0;i<t.length;i++)t[i].goToFrame(e)},e.prototype.pause=function(){this._paused||(this._paused=!0)},e.prototype.restart=function(){this._paused=!1},e.prototype.stop=function(){var e=this._scene._activeAnimatables.indexOf(this);if(e>-1){this._scene._activeAnimatables.splice(e,1);for(var t=this._animations,e=0;e<t.length;e++)t[e].reset();this.onAnimationEnd&&this.onAnimationEnd()}},e.prototype._animate=function(e){if(this._paused)return this.animationStarted=!1,this._pausedDelay||(this._pausedDelay=e),!0;this._localDelayOffset?this._pausedDelay&&(this._localDelayOffset+=e-this._pausedDelay,this._pausedDelay=null):this._localDelayOffset=e;var t,i=!1,r=this._animations;for(t=0;t<r.length;t++){var n=r[t],o=n.animate(e-this._localDelayOffset,this.fromFrame,this.toFrame,this.loopAnimation,this.speedRatio);i=i||o}return this.animationStarted=i,i||(t=this._scene._activeAnimatables.indexOf(this),this._scene._activeAnimatables.splice(t,1)),!i&&this.onAnimationEnd&&(this.onAnimationEnd(),this.onAnimationEnd=null),i},e}();e.Animatable=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function e(){this._easingMode=e.EASINGMODE_EASEIN}return Object.defineProperty(e,"EASINGMODE_EASEIN",{get:function(){return e._EASINGMODE_EASEIN},enumerable:!0,configurable:!0}),Object.defineProperty(e,"EASINGMODE_EASEOUT",{get:function(){return e._EASINGMODE_EASEOUT},enumerable:!0,configurable:!0}),Object.defineProperty(e,"EASINGMODE_EASEINOUT",{get:function(){return e._EASINGMODE_EASEINOUT},enumerable:!0,configurable:!0}),e.prototype.setEasingMode=function(e){var t=Math.min(Math.max(e,0),2);this._easingMode=t},e.prototype.getEasingMode=function(){return this._easingMode},e.prototype.easeInCore=function(e){throw new Error("You must implement this method")},e.prototype.ease=function(t){switch(this._easingMode){case e.EASINGMODE_EASEIN:return this.easeInCore(t);case e.EASINGMODE_EASEOUT:return 1-this.easeInCore(1-t)}return t>=.5?.5*(1-this.easeInCore(2*(1-t)))+.5:.5*this.easeInCore(2*t)},e._EASINGMODE_EASEIN=0,e._EASINGMODE_EASEOUT=1,e._EASINGMODE_EASEINOUT=2,e}();e.EasingFunction=t;var i=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.easeInCore=function(e){return e=Math.max(0,Math.min(1,e)),1-Math.sqrt(1-e*e)},t}(t);e.CircleEase=i;var r=function(e){function t(t){void 0===t&&(t=1),e.call(this),this.amplitude=t}return __extends(t,e),t.prototype.easeInCore=function(e){var t=Math.max(0,this.amplitude);return Math.pow(e,3)-e*t*Math.sin(3.141592653589793*e)},t}(t);e.BackEase=r;var n=function(e){function t(t,i){void 0===t&&(t=3),void 0===i&&(i=2),e.call(this),this.bounces=t,this.bounciness=i}return __extends(t,e),t.prototype.easeInCore=function(e){var t=Math.max(0,this.bounces),i=this.bounciness;1>=i&&(i=1.001);var r=Math.pow(i,t),n=1-i,o=(1-r)/n+.5*r,s=e*o,a=Math.log(-s*(1-i)+1)/Math.log(i),h=Math.floor(a),c=h+1,l=(1-Math.pow(i,h))/(n*o),u=(1-Math.pow(i,c))/(n*o),f=.5*(l+u),d=e-f,p=f-l;return-Math.pow(1/i,t-h)/(p*p)*(d-p)*(d+p)},t}(t);e.BounceEase=n;var o=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.easeInCore=function(e){return e*e*e},t}(t);e.CubicEase=o;var s=function(e){function t(t,i){void 0===t&&(t=3),void 0===i&&(i=3),e.call(this),this.oscillations=t,this.springiness=i}return __extends(t,e),t.prototype.easeInCore=function(e){var t,i=Math.max(0,this.oscillations),r=Math.max(0,this.springiness);return t=0==r?e:(Math.exp(r*e)-1)/(Math.exp(r)-1),t*Math.sin((6.283185307179586*i+1.5707963267948966)*e)},t}(t);e.ElasticEase=s;var a=function(e){function t(t){void 0===t&&(t=2),e.call(this),this.exponent=t}return __extends(t,e),t.prototype.easeInCore=function(e){return this.exponent<=0?e:(Math.exp(this.exponent*e)-1)/(Math.exp(this.exponent)-1)},t}(t);e.ExponentialEase=a;var h=function(e){function t(t){void 0===t&&(t=2),e.call(this),this.power=t}return __extends(t,e),t.prototype.easeInCore=function(e){var t=Math.max(0,this.power);return Math.pow(e,t)},t}(t);e.PowerEase=h;var c=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.easeInCore=function(e){return e*e},t}(t);e.QuadraticEase=c;var l=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.easeInCore=function(e){return e*e*e*e},t}(t);e.QuarticEase=l;var u=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.easeInCore=function(e){return e*e*e*e*e},t}(t);e.QuinticEase=u;var f=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.easeInCore=function(e){return 1-Math.sin(1.5707963267948966*(1-e))},t}(t);e.SineEase=f;var d=function(t){function i(e,i,r,n){void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=1),t.call(this),this.x1=e,this.y1=i,this.x2=r,this.y2=n}return __extends(i,t),i.prototype.easeInCore=function(t){return e.BezierCurve.interpolate(t,this.x1,this.y1,this.x2,this.y2)},i}(t);e.BezierCurveEase=d}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(i,r,n,o,s){t.call(this,i,r.getScene()),this.name=i,this.children=new Array,this.animations=new Array,this._worldTransform=new e.Matrix,this._absoluteTransform=new e.Matrix,this._invertedAbsoluteTransform=new e.Matrix,this._skeleton=r,this._matrix=o,this._baseMatrix=o,this._restPose=s?s:o.clone(),r.bones.push(this),n?(this._parent=n,n.children.push(this)):this._parent=null,this._updateDifferenceMatrix()}return __extends(i,t),i.prototype.getParent=function(){return this._parent},i.prototype.getLocalMatrix=function(){return this._matrix},i.prototype.getBaseMatrix=function(){return this._baseMatrix},i.prototype.getRestPose=function(){return this._restPose},i.prototype.returnToRest=function(){this.updateMatrix(this._restPose.clone())},i.prototype.getWorldMatrix=function(){return this._worldTransform},i.prototype.getInvertedAbsoluteTransform=function(){return this._invertedAbsoluteTransform},i.prototype.getAbsoluteTransform=function(){return this._absoluteTransform},i.prototype.updateMatrix=function(e){this._baseMatrix=e.clone(),this._matrix=e.clone(),this._skeleton._markAsDirty(),this._updateDifferenceMatrix()},i.prototype._updateDifferenceMatrix=function(e){e||(e=this._baseMatrix),this._parent?e.multiplyToRef(this._parent._absoluteTransform,this._absoluteTransform):this._absoluteTransform.copyFrom(e),this._absoluteTransform.invertToRef(this._invertedAbsoluteTransform);for(var t=0;t<this.children.length;t++)this.children[t]._updateDifferenceMatrix()},i.prototype.markAsDirty=function(){this._currentRenderId++,this._skeleton._markAsDirty()},i.prototype.copyAnimationRange=function(t,i,r,n,o){void 0===n&&(n=!1),void 0===o&&(o=null),0===this.animations.length&&(this.animations.push(new e.Animation(this.name,"_matrix",t.animations[0].framePerSecond,e.Animation.ANIMATIONTYPE_MATRIX,0)),this.animations[0].setKeys([]));var s=t.animations[0].getRange(i);if(!s)return!1;for(var a,h,c,l=s.from,u=s.to,f=t.animations[0].getKeys(),d=t.length,p=t.getParent(),_=this.getParent(),m=n&&p&&d&&this.length&&d!==this.length,g=m?_.length/p.length:null,v=n&&!_&&o&&(1!==o.x||1!==o.y||1!==o.z),y=this.animations[0].getKeys(),x=0,b=f.length;b>x;x++)a=f[x],a.frame>=l&&a.frame<=u&&(n?(c=a.value.clone(),m?(h=c.getTranslation(),c.setTranslation(h.scaleInPlace(g))):v?(h=c.getTranslation(),c.setTranslation(h.multiplyInPlace(o))):c=a.value):c=a.value,y.push({frame:a.frame+r,value:c}));return this.animations[0].createRange(i,l+r,u+r),!0},i}(e.Node);e.Bone=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(t,i,r){this.name=t,this.id=i,this.bones=new Array,this.needInitialSkinMatrix=!1,this._isDirty=!0,this._meshesWithPoseMatrix=new Array,this._identity=e.Matrix.Identity(),this._ranges={},this.bones=[],this._scene=r,r.skeletons.push(this),this._isDirty=!0}return t.prototype.getTransformMatrices=function(e){return this.needInitialSkinMatrix&&e._bonesTransformMatrices?e._bonesTransformMatrices:this._transformMatrices},t.prototype.getScene=function(){return this._scene},t.prototype.toString=function(e){var t="Name: "+this.name+", nBones: "+this.bones.length;if(t+=", nAnimationRanges: "+(this._ranges?Object.keys(this._ranges).length:"none"),e){t+=", Ranges: {";var i=!0;for(var r in this._ranges)i&&(t+=", ",i=!1),t+=r;t+="}"}return t},t.prototype.getBoneIndexByName=function(e){for(var t=0,i=this.bones.length;i>t;t++)if(this.bones[t].name===e)return t;return-1},t.prototype.createAnimationRange=function(t,i,r){if(!this._ranges[t]){this._ranges[t]=new e.AnimationRange(t,i,r);for(var n=0,o=this.bones.length;o>n;n++)this.bones[n].animations[0]&&this.bones[n].animations[0].createRange(t,i,r)}},t.prototype.deleteAnimationRange=function(e,t){void 0===t&&(t=!0);for(var i=0,r=this.bones.length;r>i;i++)this.bones[i].animations[0]&&this.bones[i].animations[0].deleteRange(e,t);this._ranges[e]=void 0},t.prototype.getAnimationRange=function(e){return this._ranges[e]},t.prototype.getAnimationRanges=function(){var e,t=[],i=0;for(e in this._ranges)t[i]=this._ranges[e],i++;return t},t.prototype.copyAnimationRange=function(t,i,r){if(void 0===r&&(r=!1),this._ranges[i]||!t.getAnimationRange(i))return!1;var n,o,s=!0,a=this._getHighestAnimationFrame()+1,h={},c=t.bones;for(o=0,n=c.length;n>o;o++)h[c[o].name]=c[o];this.bones.length!==c.length&&(e.Tools.Warn("copyAnimationRange: this rig has "+this.bones.length+" bones, while source as "+c.length),s=!1);var l=r&&this.dimensionsAtRest&&t.dimensionsAtRest?this.dimensionsAtRest.divide(t.dimensionsAtRest):null;for(o=0,n=this.bones.length;n>o;o++){var u=this.bones[o].name,f=h[u];f?s=s&&this.bones[o].copyAnimationRange(f,i,a,r,l):(e.Tools.Warn("copyAnimationRange: not same rig, missing source bone "+u),s=!1)}var d=t.getAnimationRange(i);return this._ranges[i]=new e.AnimationRange(i,d.from+a,d.to+a),s},t.prototype.returnToRest=function(){for(var e=0;e<this.bones.length;e++)this.bones[e].returnToRest()},t.prototype._getHighestAnimationFrame=function(){for(var e=0,t=0,i=this.bones.length;i>t;t++)if(this.bones[t].animations[0]){var r=this.bones[t].animations[0].getHighestFrame();r>e&&(e=r)}return e},t.prototype.beginAnimation=function(e,t,i,r){var n=this.getAnimationRange(e);return n?this._scene.beginAnimation(this,n.from,n.to,t,i,r):null},t.prototype._markAsDirty=function(){this._isDirty=!0},t.prototype._registerMeshWithPoseMatrix=function(e){this._meshesWithPoseMatrix.push(e)},t.prototype._unregisterMeshWithPoseMatrix=function(e){var t=this._meshesWithPoseMatrix.indexOf(e);t>-1&&this._meshesWithPoseMatrix.splice(t,1)},t.prototype._computeTransformMatrices=function(e,t){for(var i=0;i<this.bones.length;i++){var r=this.bones[i],n=r.getParent();n?r.getLocalMatrix().multiplyToRef(n.getWorldMatrix(),r.getWorldMatrix()):t?r.getLocalMatrix().multiplyToRef(t,r.getWorldMatrix()):r.getWorldMatrix().copyFrom(r.getLocalMatrix()),r.getInvertedAbsoluteTransform().multiplyToArray(r.getWorldMatrix(),e,16*i)}this._identity.copyToArray(e,16*this.bones.length)},t.prototype.prepare=function(){if(this._isDirty){if(this.needInitialSkinMatrix)for(var t=0;t<this._meshesWithPoseMatrix.length;t++){var i=this._meshesWithPoseMatrix[t];i._bonesTransformMatrices&&i._bonesTransformMatrices.length===16*(this.bones.length+1)||(i._bonesTransformMatrices=new Float32Array(16*(this.bones.length+1)));for(var r=i.getPoseMatrix(),n=0;n<this.bones.length;n++){var o=this.bones[n];if(!o.getParent()){var s=o.getBaseMatrix();s.multiplyToRef(r,e.Tmp.Matrix[0]),o._updateDifferenceMatrix(e.Tmp.Matrix[0])}}this._computeTransformMatrices(i._bonesTransformMatrices,r)}else this._transformMatrices&&this._transformMatrices.length===16*(this.bones.length+1)||(this._transformMatrices=new Float32Array(16*(this.bones.length+1))),this._computeTransformMatrices(this._transformMatrices,null);this._isDirty=!1,this._scene._activeBones+=this.bones.length}},t.prototype.getAnimatables=function(){if(!this._animatables||this._animatables.length!==this.bones.length){this._animatables=[];for(var e=0;e<this.bones.length;e++)this._animatables.push(this.bones[e])}return this._animatables},t.prototype.clone=function(i,r){var n=new t(i,r||i,this._scene);n.needInitialSkinMatrix=this.needInitialSkinMatrix;for(var o=0;o<this.bones.length;o++){var s=this.bones[o],a=null;if(s.getParent()){var h=this.bones.indexOf(s.getParent());a=n.bones[h]}var c=new e.Bone(s.name,n,a,s.getBaseMatrix().clone(),s.getRestPose().clone());e.Tools.DeepCopy(s.animations,c.animations)}if(this._ranges){n._ranges={};for(var l in this._ranges)n._ranges[l]=this._ranges[l].clone()}return this._isDirty=!0,n},t.prototype.enableBlending=function(e){void 0===e&&(e=.01),this.bones.forEach(function(t){t.animations.forEach(function(t){t.enableBlending=!0,t.blendingSpeed=e})})},t.prototype.dispose=function(){this._meshesWithPoseMatrix=[],this.getScene().stopAnimation(this),this.getScene().removeSkeleton(this)},t.prototype.serialize=function(){var e={};e.name=this.name,e.id=this.id,e.dimensionsAtRest=this.dimensionsAtRest,e.bones=[],e.needInitialSkinMatrix=this.needInitialSkinMatrix;for(var t=0;t<this.bones.length;t++){var i=this.bones[t],r={parentBoneIndex:i.getParent()?this.bones.indexOf(i.getParent()):-1,name:i.name,matrix:i.getLocalMatrix().toArray(),rest:i.getRestPose().toArray()};e.bones.push(r),i.length&&(r.length=i.length),i.animations&&i.animations.length>0&&(r.animation=i.animations[0].serialize()),e.ranges=[];for(var n in this._ranges){var o={};o.name=n,o.from=this._ranges[n].from,o.to=this._ranges[n].to,e.ranges.push(o)}}return e},t.Parse=function(i,r){var n=new t(i.name,i.id,r);i.dimensionsAtRest&&(n.dimensionsAtRest=e.Vector3.FromArray(i.dimensionsAtRest)),n.needInitialSkinMatrix=i.needInitialSkinMatrix;var o;for(o=0;o<i.bones.length;o++){var s=i.bones[o],a=null;s.parentBoneIndex>-1&&(a=n.bones[s.parentBoneIndex]);var h=s.rest?e.Matrix.FromArray(s.rest):null,c=new e.Bone(s.name,n,a,e.Matrix.FromArray(s.matrix),h);s.length&&(c.length=s.length),s.animation&&c.animations.push(e.Animation.Parse(s.animation))}if(i.ranges)for(o=0;o<i.ranges.length;o++){var l=i.ranges[o];n.createAnimationRange(l.name,l.from,l.to)}return n},t}();e.Skeleton=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(t,i,r,n,o,s,a,h,c,l,u){void 0===a&&(a=e.Texture.NEAREST_SAMPLINGMODE),void 0===u&&(u=e.Engine.TEXTURETYPE_UNSIGNED_INT),this.name=t,this.width=-1,this.height=-1,this.enablePixelPerfectMode=!1,this._reusable=!1,this._textures=new e.SmartArray(2),this._currentRenderTextureInd=0,this._scaleRatio=new e.Vector2(1,1),this.onActivateObservable=new e.Observable,this.onSizeChangedObservable=new e.Observable,this.onApplyObservable=new e.Observable,this.onBeforeRenderObservable=new e.Observable,this.onAfterRenderObservable=new e.Observable,null!=s?(this._camera=s,this._scene=s.getScene(),s.attachPostProcess(this),this._engine=this._scene.getEngine()):this._engine=h,this._options=o,this.renderTargetSamplingMode=a?a:e.Texture.NEAREST_SAMPLINGMODE,this._reusable=c||!1,this._textureType=u,this._samplers=n||[],this._samplers.push("textureSampler"),this._fragmentUrl=i,this._parameters=r||[],this._parameters.push("scale"),this.updateEffect(l)}return Object.defineProperty(t.prototype,"onActivate",{set:function(e){this._onActivateObserver&&this.onActivateObservable.remove(this._onActivateObserver),this._onActivateObserver=this.onActivateObservable.add(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onSizeChanged",{set:function(e){this._onSizeChangedObserver&&this.onSizeChangedObservable.remove(this._onSizeChangedObserver),this._onSizeChangedObserver=this.onSizeChangedObservable.add(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onApply",{set:function(e){this._onApplyObserver&&this.onApplyObservable.remove(this._onApplyObserver),this._onApplyObserver=this.onApplyObservable.add(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onBeforeRender",{set:function(e){this._onBeforeRenderObserver&&this.onBeforeRenderObservable.remove(this._onBeforeRenderObserver),this._onBeforeRenderObserver=this.onBeforeRenderObservable.add(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onAfterRender",{set:function(e){this._onAfterRenderObserver&&this.onAfterRenderObservable.remove(this._onAfterRenderObserver),this._onAfterRenderObserver=this.onAfterRenderObservable.add(e)},enumerable:!0,configurable:!0}),t.prototype.updateEffect=function(e){this._effect=this._engine.createEffect({vertex:"postprocess",fragment:this._fragmentUrl},["position"],this._parameters,this._samplers,void 0!==e?e:"")},t.prototype.isReusable=function(){return this._reusable},t.prototype.markTextureDirty=function(){this.width=-1},t.prototype.activate=function(t,i){t=t||this._camera;var r=t.getScene(),n=t.getEngine().getCaps().maxTextureSize,o=(i?i._width:this._engine.getRenderingCanvas().width)*this._options|0,s=(i?i._height:this._engine.getRenderingCanvas().height)*this._options|0,a=this._options.width||o,h=this._options.height||s;if(this.renderTargetSamplingMode!==e.Texture.NEAREST_SAMPLINGMODE&&(this._options.width||(a=e.Tools.GetExponentOfTwo(a,n)),this._options.height||(h=e.Tools.GetExponentOfTwo(h,n))),this.width!==a||this.height!==h){if(this._textures.length>0){for(var c=0;c<this._textures.length;c++)this._engine._releaseTexture(this._textures.data[c]);this._textures.reset()}this.width=a,this.height=h,this._textures.push(this._engine.createRenderTargetTexture({width:this.width,height:this.height},{generateMipMaps:!1,generateDepthBuffer:0===t._postProcesses.indexOf(this),samplingMode:this.renderTargetSamplingMode,type:this._textureType})),this._reusable&&this._textures.push(this._engine.createRenderTargetTexture({width:this.width,height:this.height},{generateMipMaps:!1,generateDepthBuffer:0===t._postProcesses.indexOf(this),samplingMode:this.renderTargetSamplingMode,type:this._textureType})),this.onSizeChangedObservable.notifyObservers(this)}this.enablePixelPerfectMode?(this._scaleRatio.copyFromFloats(o/a,s/h),this._engine.bindFramebuffer(this._textures.data[this._currentRenderTextureInd],0,o,s)):(this._scaleRatio.copyFromFloats(1,1),this._engine.bindFramebuffer(this._textures.data[this._currentRenderTextureInd])),this.onActivateObservable.notifyObservers(t),this.clearColor?this._engine.clear(this.clearColor,!0,!0):this._engine.clear(r.clearColor,r.autoClear||r.forceWireframe,!0),this._reusable&&(this._currentRenderTextureInd=(this._currentRenderTextureInd+1)%2)},Object.defineProperty(t.prototype,"isSupported",{get:function(){return this._effect.isSupported},enumerable:!0,configurable:!0}),t.prototype.apply=function(){return this._effect.isReady()?(this._engine.enableEffect(this._effect),this._engine.setState(!1),this._engine.setAlphaMode(e.Engine.ALPHA_DISABLE),this._engine.setDepthBuffer(!1),this._engine.setDepthWrite(!1),this._effect._bindTexture("textureSampler",this._textures.data[this._currentRenderTextureInd]),this._effect.setVector2("scale",this._scaleRatio),this.onApplyObservable.notifyObservers(this._effect),this._effect):null},t.prototype.dispose=function(e){if(e=e||this._camera,this._textures.length>0){for(var t=0;t<this._textures.length;t++)this._engine._releaseTexture(this._textures.data[t]);this._textures.reset()}if(e){e.detachPostProcess(this);var i=e._postProcesses.indexOf(this);0===i&&e._postProcesses.length>0&&this._camera._postProcesses[0].markTextureDirty(),this.onActivateObservable.clear(),this.onAfterRenderObservable.clear(),this.onApplyObservable.clear(),this.onBeforeRenderObservable.clear(),this.onSizeChangedObservable.clear()}},t}();e.PostProcess=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(e){this._vertexBuffers={},this._scene=e}return t.prototype._prepareBuffers=function(){if(!this._vertexBuffers[e.VertexBuffer.PositionKind]){var t=[];t.push(1,1),t.push(-1,1),t.push(-1,-1),t.push(1,-1),this._vertexBuffers[e.VertexBuffer.PositionKind]=new e.VertexBuffer(this._scene.getEngine(),t,e.VertexBuffer.PositionKind,!1,!1,2);var i=[];i.push(0),i.push(1),i.push(2),i.push(0),i.push(2),i.push(3),this._indexBuffer=this._scene.getEngine().createIndexBuffer(i)}},t.prototype._prepareFrame=function(e){var t=this._scene.activeCamera._postProcesses;return 0!==t.length&&this._scene.postProcessesEnabled?(t[0].activate(this._scene.activeCamera,e),!0):!1},t.prototype.directRender=function(e,t){for(var i=this._scene.getEngine(),r=0;r<e.length;r++){r<e.length-1?e[r+1].activate(this._scene.activeCamera,t):t?i.bindFramebuffer(t):i.restoreDefaultFramebuffer();var n=e[r],o=n.apply();o&&(n.onBeforeRenderObservable.notifyObservers(o),this._prepareBuffers(),i.bindBuffers(this._vertexBuffers,this._indexBuffer,o),i.draw(!0,0,6),n.onAfterRenderObservable.notifyObservers(o))}i.setDepthBuffer(!0),i.setDepthWrite(!0)},t.prototype._finalizeFrame=function(e,t,i,r){if(r=r||this._scene.activeCamera._postProcesses,0!==r.length&&this._scene.postProcessesEnabled){for(var n=this._scene.getEngine(),o=0,s=r.length;s>o&&(s-1>o?r[o+1].activate(this._scene.activeCamera,t):t?n.bindFramebuffer(t,i):n.restoreDefaultFramebuffer(),!e);o++){var a=r[o],h=a.apply();h&&(a.onBeforeRenderObservable.notifyObservers(h),this._prepareBuffers(),n.bindBuffers(this._vertexBuffers,this._indexBuffer,h),n.draw(!0,0,6),a.onAfterRenderObservable.notifyObservers(h))}n.setDepthBuffer(!0),n.setDepthWrite(!0)}},t.prototype.dispose=function(){var t=this._vertexBuffers[e.VertexBuffer.PositionKind];t&&(t.dispose(),this._vertexBuffers[e.VertexBuffer.PositionKind]=null),this._indexBuffer&&(this._scene.getEngine()._releaseBuffer(this._indexBuffer),this._indexBuffer=null)},t}();e.PostProcessManager=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(e){function t(t,i,r,n,o,s){e.call(this,t,"pass",null,null,i,r,n,o,s)}return __extends(t,e),t}(e.PostProcess);e.PassPostProcess=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function e(e,t){this.type=e,this.jointData=t,t.nativeParams=t.nativeParams||{}}return Object.defineProperty(e.prototype,"physicsJoint",{get:function(){return this._physicsJoint},set:function(e){this._physicsJoint,this._physicsJoint=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"physicsPlugin",{set:function(e){this._physicsPlugin=e},enumerable:!0,configurable:!0}),e.prototype.executeNativeFunction=function(e){e(this._physicsPlugin.world,this._physicsJoint)},e.DistanceJoint=0,e.HingeJoint=1,e.BallAndSocketJoint=2,e.WheelJoint=3,e.SliderJoint=4,e.PrismaticJoint=5,e.UniversalJoint=6,e.Hinge2Joint=e.WheelJoint,e.PointToPointJoint=8,e.SpringJoint=9,e.LockJoint=10,e}();e.PhysicsJoint=t;var i=function(e){function i(i){e.call(this,t.DistanceJoint,i)}return __extends(i,e),i.prototype.updateDistance=function(e,t){this._physicsPlugin.updateDistanceJoint(this,e,t)},i}(t);e.DistanceJoint=i;var r=function(e){function t(t,i){e.call(this,t,i)}return __extends(t,e),t.prototype.setMotor=function(e,t){this._physicsPlugin.setMotor(this,e,t)},t.prototype.setLimit=function(e,t){this._physicsPlugin.setLimit(this,e,t)},t}(t);e.MotorEnabledJoint=r;var n=function(e){function i(i){e.call(this,t.HingeJoint,i)}return __extends(i,e),i.prototype.setMotor=function(e,t){this._physicsPlugin.setMotor(this,e,t)},i.prototype.setLimit=function(e,t){this._physicsPlugin.setLimit(this,e,t)},i}(r);e.HingeJoint=n;var o=function(e){function i(i){e.call(this,t.Hinge2Joint,i)}return __extends(i,e),i.prototype.setMotor=function(e,t,i){void 0===i&&(i=0),this._physicsPlugin.setMotor(this,e,t,i)},i.prototype.setLimit=function(e,t,i){void 0===i&&(i=0),this._physicsPlugin.setLimit(this,e,t,i)},i}(r);e.Hinge2Joint=o}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(t,i,r,n){var o=this;return void 0===r&&(r={mass:0}),this.object=t,this.type=i,this._options=r,this._scene=n,this._bodyUpdateRequired=!1,this._onBeforePhysicsStepCallbacks=new Array,this._onAfterPhysicsStepCallbacks=new Array,this._onPhysicsCollideCallbacks=[],this._deltaPosition=e.Vector3.Zero(),this._tmpPositionWithDelta=e.Vector3.Zero(),this._tmpRotationWithDelta=new e.Quaternion,this.beforeStep=function(){o.object.position.subtractToRef(o._deltaPosition,o._tmpPositionWithDelta),o._deltaRotationConjugated?o.object.rotationQuaternion.multiplyToRef(o._deltaRotationConjugated,o._tmpRotationWithDelta):o._tmpRotationWithDelta.copyFrom(o.object.rotationQuaternion),o._physicsEngine.getPhysicsPlugin().setPhysicsBodyTransformation(o,o._tmpPositionWithDelta,o._tmpRotationWithDelta),
o._onBeforePhysicsStepCallbacks.forEach(function(e){e(o)})},this.afterStep=function(){o._onAfterPhysicsStepCallbacks.forEach(function(e){e(o)}),o._physicsEngine.getPhysicsPlugin().setTransformationFromPhysicsBody(o),o.object.position.addInPlace(o._deltaPosition),o._deltaRotation&&o.object.rotationQuaternion.multiplyInPlace(o._deltaRotation)},this.onCollide=function(e){if(o._onPhysicsCollideCallbacks.length){var t=o._physicsEngine.getImpostorWithPhysicsBody(e.body);t&&o._onPhysicsCollideCallbacks.filter(function(e){return-1!==e.otherImpostors.indexOf(t)}).forEach(function(e){e.callback(o,t)})}},this.object?(!this._scene&&t.getScene&&(this._scene=t.getScene()),this._physicsEngine=this._scene.getPhysicsEngine(),void(this._physicsEngine?(this.object.rotationQuaternion||(this.object.rotation?this.object.rotationQuaternion=e.Quaternion.RotationYawPitchRoll(this.object.rotation.y,this.object.rotation.x,this.object.rotation.z):this.object.rotationQuaternion=new e.Quaternion),this._options.mass=void 0===r.mass?0:r.mass,this._options.friction=void 0===r.friction?.2:r.friction,this._options.restitution=void 0===r.restitution?.2:r.restitution,this._joints=[],this.object.parent||this._init()):e.Tools.Error("Physics not enabled. Please use scene.enablePhysics(...) before creating impostors."))):void e.Tools.Error("No object was provided. A physics object is obligatory")}return t.prototype._init=function(){this._physicsEngine.removeImpostor(this),this.physicsBody=null,this._parent=this._parent||this._getPhysicsParent(),this.parent||this._physicsEngine.addImpostor(this)},t.prototype._getPhysicsParent=function(){if(this.object.parent instanceof e.AbstractMesh){var t=this.object.parent;return t.physicsImpostor}},t.prototype.isBodyInitRequired=function(){return this._bodyUpdateRequired||!this._physicsBody&&!this._parent},t.prototype.setScalingUpdated=function(e){this.forceUpdate()},t.prototype.forceUpdate=function(){this._init(),this.parent&&this.parent.forceUpdate()},Object.defineProperty(t.prototype,"physicsBody",{get:function(){return this._parent?this._parent.physicsBody:this._physicsBody},set:function(e){this._physicsBody&&this._physicsEngine.getPhysicsPlugin().removePhysicsBody(this),this._physicsBody=e,this.resetUpdateFlags()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),t.prototype.resetUpdateFlags=function(){this._bodyUpdateRequired=!1},t.prototype.getObjectExtendSize=function(){return this.object.getBoundingInfo?(this.object.computeWorldMatrix&&this.object.computeWorldMatrix(!0),this.object.getBoundingInfo().boundingBox.extendSize.scale(2).multiply(this.object.scaling)):t.DEFAULT_OBJECT_SIZE},t.prototype.getObjectCenter=function(){return this.object.getBoundingInfo?this.object.getBoundingInfo().boundingBox.center:this.object.position},t.prototype.getParam=function(e){return this._options[e]},t.prototype.setParam=function(e,t){this._options[e]=t,this._bodyUpdateRequired=!0},t.prototype.setMass=function(e){this.getParam("mass")!==e&&this.setParam("mass",e),this._physicsEngine.getPhysicsPlugin().setBodyMass(this,e)},t.prototype.getLinearVelocity=function(){return this._physicsEngine.getPhysicsPlugin().getLinearVelocity(this)},t.prototype.setLinearVelocity=function(e){this._physicsEngine.getPhysicsPlugin().setLinearVelocity(this,e)},t.prototype.getAngularVelocity=function(){return this._physicsEngine.getPhysicsPlugin().getAngularVelocity(this)},t.prototype.setAngularVelocity=function(e){this._physicsEngine.getPhysicsPlugin().setAngularVelocity(this,e)},t.prototype.executeNativeFunction=function(e){e(this._physicsEngine.getPhysicsPlugin().world,this.physicsBody)},t.prototype.registerBeforePhysicsStep=function(e){this._onBeforePhysicsStepCallbacks.push(e)},t.prototype.unregisterBeforePhysicsStep=function(t){var i=this._onBeforePhysicsStepCallbacks.indexOf(t);i>-1?this._onBeforePhysicsStepCallbacks.splice(i,1):e.Tools.Warn("Function to remove was not found")},t.prototype.registerAfterPhysicsStep=function(e){this._onAfterPhysicsStepCallbacks.push(e)},t.prototype.unregisterAfterPhysicsStep=function(t){var i=this._onAfterPhysicsStepCallbacks.indexOf(t);i>-1?this._onAfterPhysicsStepCallbacks.splice(i,1):e.Tools.Warn("Function to remove was not found")},t.prototype.registerOnPhysicsCollide=function(e,t){var i=e instanceof Array?e:[e];this._onPhysicsCollideCallbacks.push({callback:t,otherImpostors:i})},t.prototype.unregisterOnPhysicsCollide=function(t,i){var r=t instanceof Array?t:[t],n=this._onPhysicsCollideCallbacks.indexOf({callback:i,otherImpostors:r});n>-1?this._onPhysicsCollideCallbacks.splice(n,1):e.Tools.Warn("Function to remove was not found")},t.prototype.applyForce=function(e,t){this._physicsEngine.getPhysicsPlugin().applyForce(this,e,t)},t.prototype.applyImpulse=function(e,t){this._physicsEngine.getPhysicsPlugin().applyImpulse(this,e,t)},t.prototype.createJoint=function(t,i,r){var n=new e.PhysicsJoint(i,r);this.addJoint(t,n)},t.prototype.addJoint=function(e,t){this._joints.push({otherImpostor:e,joint:t}),this._physicsEngine.addJoint(this,e,t)},t.prototype.sleep=function(){this._physicsEngine.getPhysicsPlugin().sleepBody(this)},t.prototype.wakeUp=function(){this._physicsEngine.getPhysicsPlugin().wakeUpBody(this)},t.prototype.clone=function(e){return e?new t(e,this.type,this._options,this._scene):null},t.prototype.dispose=function(){var e=this;this._physicsEngine&&(this._joints.forEach(function(t){e._physicsEngine.removeJoint(e,t.otherImpostor,t.joint)}),this._physicsEngine.removeImpostor(this),this.parent&&this.parent.forceUpdate())},t.prototype.setDeltaPosition=function(e){this._deltaPosition.copyFrom(e)},t.prototype.setDeltaRotation=function(t){this._deltaRotation||(this._deltaRotation=new e.Quaternion),this._deltaRotation.copyFrom(t),this._deltaRotationConjugated=this._deltaRotation.conjugate()},t.DEFAULT_OBJECT_SIZE=new e.Vector3(1,1,1),t.NoImpostor=0,t.SphereImpostor=1,t.BoxImpostor=2,t.PlaneImpostor=3,t.MeshImpostor=4,t.CylinderImpostor=7,t.ParticleImpostor=8,t.HeightmapImpostor=9,t}();e.PhysicsImpostor=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(t,i){if(void 0===i&&(i=new e.CannonJSPlugin),this._physicsPlugin=i,this._impostors=[],this._joints=[],!this._physicsPlugin.isSupported())throw new Error("Physics Engine "+this._physicsPlugin.name+" cannot be found. Please make sure it is included.");t=t||new e.Vector3(0,-9.807,0),this.setGravity(t),this.setTimeStep()}return t.prototype.setGravity=function(e){this.gravity=e,this._physicsPlugin.setGravity(this.gravity)},t.prototype.setTimeStep=function(e){void 0===e&&(e=1/60),this._physicsPlugin.setTimeStep(e)},t.prototype.dispose=function(){this._impostors.forEach(function(e){e.dispose()}),this._physicsPlugin.dispose()},t.prototype.getPhysicsPluginName=function(){return this._physicsPlugin.name},t.prototype.addImpostor=function(e){e.uniqueId=this._impostors.push(e),e.parent||this._physicsPlugin.generatePhysicsBody(e)},t.prototype.removeImpostor=function(e){var t=this._impostors.indexOf(e);if(t>-1){var i=this._impostors.splice(t,1);i.length&&(i[0].physicsBody=null)}},t.prototype.addJoint=function(e,t,i){var r={mainImpostor:e,connectedImpostor:t,joint:i};i.physicsPlugin=this._physicsPlugin,this._joints.push(r),this._physicsPlugin.generateJoint(r)},t.prototype.removeJoint=function(e,t,i){var r=this._joints.filter(function(r){return r.connectedImpostor===t&&r.joint===i&&r.mainImpostor===e});r.length&&this._physicsPlugin.removeJoint(r[0])},t.prototype._step=function(e){var t=this;this._impostors.forEach(function(e){e.isBodyInitRequired()&&t._physicsPlugin.generatePhysicsBody(e)}),e>.1?e=.1:0>=e&&(e=1/60),this._physicsPlugin.executeStep(e,this._impostors)},t.prototype.getPhysicsPlugin=function(){return this._physicsPlugin},t.prototype.getImpostorForPhysicsObject=function(e){for(var t=0;t<this._impostors.length;++t)if(this._impostors[t].object===e)return this._impostors[t]},t.prototype.getImpostorWithPhysicsBody=function(e){for(var t=0;t<this._impostors.length;++t)if(this._impostors[t].physicsBody===e)return this._impostors[t]},t.NoImpostor=e.PhysicsImpostor.NoImpostor,t.SphereImpostor=e.PhysicsImpostor.SphereImpostor,t.BoxImpostor=e.PhysicsImpostor.BoxImpostor,t.PlaneImpostor=e.PhysicsImpostor.PlaneImpostor,t.MeshImpostor=e.PhysicsImpostor.MeshImpostor,t.CylinderImpostor=e.PhysicsImpostor.CylinderImpostor,t.HeightmapImpostor=e.PhysicsImpostor.HeightmapImpostor,t.CapsuleImpostor=-1,t.ConeImpostor=-1,t.ConvexHullImpostor=-1,t.Epsilon=.001,t}();e.PhysicsEngine=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(){}return t.prototype.set=function(t,i){switch(i){case e.VertexBuffer.PositionKind:this.positions=t;break;case e.VertexBuffer.NormalKind:this.normals=t;break;case e.VertexBuffer.UVKind:this.uvs=t;break;case e.VertexBuffer.UV2Kind:this.uvs2=t;break;case e.VertexBuffer.UV3Kind:this.uvs3=t;break;case e.VertexBuffer.UV4Kind:this.uvs4=t;break;case e.VertexBuffer.UV5Kind:this.uvs5=t;break;case e.VertexBuffer.UV6Kind:this.uvs6=t;break;case e.VertexBuffer.ColorKind:this.colors=t;break;case e.VertexBuffer.MatricesIndicesKind:this.matricesIndices=t;break;case e.VertexBuffer.MatricesWeightsKind:this.matricesWeights=t;break;case e.VertexBuffer.MatricesIndicesExtraKind:this.matricesIndicesExtra=t;break;case e.VertexBuffer.MatricesWeightsExtraKind:this.matricesWeightsExtra=t}},t.prototype.applyToMesh=function(e,t){this._applyTo(e,t)},t.prototype.applyToGeometry=function(e,t){this._applyTo(e,t)},t.prototype.updateMesh=function(e,t,i){this._update(e)},t.prototype.updateGeometry=function(e,t,i){this._update(e)},t.prototype._applyTo=function(t,i){this.positions&&t.setVerticesData(e.VertexBuffer.PositionKind,this.positions,i),this.normals&&t.setVerticesData(e.VertexBuffer.NormalKind,this.normals,i),this.uvs&&t.setVerticesData(e.VertexBuffer.UVKind,this.uvs,i),this.uvs2&&t.setVerticesData(e.VertexBuffer.UV2Kind,this.uvs2,i),this.uvs3&&t.setVerticesData(e.VertexBuffer.UV3Kind,this.uvs3,i),this.uvs4&&t.setVerticesData(e.VertexBuffer.UV4Kind,this.uvs4,i),this.uvs5&&t.setVerticesData(e.VertexBuffer.UV5Kind,this.uvs5,i),this.uvs6&&t.setVerticesData(e.VertexBuffer.UV6Kind,this.uvs6,i),this.colors&&t.setVerticesData(e.VertexBuffer.ColorKind,this.colors,i),this.matricesIndices&&t.setVerticesData(e.VertexBuffer.MatricesIndicesKind,this.matricesIndices,i),this.matricesWeights&&t.setVerticesData(e.VertexBuffer.MatricesWeightsKind,this.matricesWeights,i),this.matricesIndicesExtra&&t.setVerticesData(e.VertexBuffer.MatricesIndicesExtraKind,this.matricesIndicesExtra,i),this.matricesWeightsExtra&&t.setVerticesData(e.VertexBuffer.MatricesWeightsExtraKind,this.matricesWeightsExtra,i),this.indices&&t.setIndices(this.indices)},t.prototype._update=function(t,i,r){this.positions&&t.updateVerticesData(e.VertexBuffer.PositionKind,this.positions,i,r),this.normals&&t.updateVerticesData(e.VertexBuffer.NormalKind,this.normals,i,r),this.uvs&&t.updateVerticesData(e.VertexBuffer.UVKind,this.uvs,i,r),this.uvs2&&t.updateVerticesData(e.VertexBuffer.UV2Kind,this.uvs2,i,r),this.uvs3&&t.updateVerticesData(e.VertexBuffer.UV3Kind,this.uvs3,i,r),this.uvs4&&t.updateVerticesData(e.VertexBuffer.UV4Kind,this.uvs4,i,r),this.uvs5&&t.updateVerticesData(e.VertexBuffer.UV5Kind,this.uvs5,i,r),this.uvs6&&t.updateVerticesData(e.VertexBuffer.UV6Kind,this.uvs6,i,r),this.colors&&t.updateVerticesData(e.VertexBuffer.ColorKind,this.colors,i,r),this.matricesIndices&&t.updateVerticesData(e.VertexBuffer.MatricesIndicesKind,this.matricesIndices,i,r),this.matricesWeights&&t.updateVerticesData(e.VertexBuffer.MatricesWeightsKind,this.matricesWeights,i,r),this.matricesIndicesExtra&&t.updateVerticesData(e.VertexBuffer.MatricesIndicesExtraKind,this.matricesIndicesExtra,i,r),this.matricesWeightsExtra&&t.updateVerticesData(e.VertexBuffer.MatricesWeightsExtraKind,this.matricesWeightsExtra,i,r),this.indices&&t.setIndices(this.indices)},t.prototype.transform=function(t){var i,r=e.Vector3.Zero();if(this.positions){var n=e.Vector3.Zero();for(i=0;i<this.positions.length;i+=3)e.Vector3.FromArrayToRef(this.positions,i,n),e.Vector3.TransformCoordinatesToRef(n,t,r),this.positions[i]=r.x,this.positions[i+1]=r.y,this.positions[i+2]=r.z}if(this.normals){var o=e.Vector3.Zero();for(i=0;i<this.normals.length;i+=3)e.Vector3.FromArrayToRef(this.normals,i,o),e.Vector3.TransformNormalToRef(o,t,r),this.normals[i]=r.x,this.normals[i+1]=r.y,this.normals[i+2]=r.z}},t.prototype.merge=function(e){if(e.indices){this.indices||(this.indices=[]);for(var t=this.positions?this.positions.length/3:0,i=0;i<e.indices.length;i++)this.indices.push(e.indices[i]+t)}this.positions=this._mergeElement(this.positions,e.positions),this.normals=this._mergeElement(this.normals,e.normals),this.uvs=this._mergeElement(this.uvs,e.uvs),this.uvs2=this._mergeElement(this.uvs2,e.uvs2),this.uvs3=this._mergeElement(this.uvs3,e.uvs3),this.uvs4=this._mergeElement(this.uvs4,e.uvs4),this.uvs5=this._mergeElement(this.uvs5,e.uvs5),this.uvs6=this._mergeElement(this.uvs6,e.uvs6),this.colors=this._mergeElement(this.colors,e.colors),this.matricesIndices=this._mergeElement(this.matricesIndices,e.matricesIndices),this.matricesWeights=this._mergeElement(this.matricesWeights,e.matricesWeights),this.matricesIndicesExtra=this._mergeElement(this.matricesIndicesExtra,e.matricesIndicesExtra),this.matricesWeightsExtra=this._mergeElement(this.matricesWeightsExtra,e.matricesWeightsExtra)},t.prototype._mergeElement=function(e,t){if(!t)return e;if(!e)return t;var i=t.length+e.length,r=e instanceof Float32Array,n=t instanceof Float32Array;if(r){var o=new Float32Array(i);return o.set(e),o.set(t,e.length),o}if(n){for(var s=e.slice(0),a=0,i=t.length;i>a;a++)s.push(t[a]);return s}return e.concat(t)},t.prototype.serialize=function(){var e=this.serialize();return this.positions&&(e.positions=this.positions),this.normals&&(e.normals=this.normals),this.uvs&&(e.uvs=this.uvs),this.uvs2&&(e.uvs2=this.uvs2),this.uvs3&&(e.uvs3=this.uvs3),this.uvs4&&(e.uvs4=this.uvs4),this.uvs5&&(e.uvs5=this.uvs5),this.uvs6&&(e.uvs6=this.uvs6),this.colors&&(e.colors=this.colors),this.matricesIndices&&(e.matricesIndices=this.matricesIndices,e.matricesIndices._isExpanded=!0),this.matricesWeights&&(e.matricesWeights=this.matricesWeights),this.matricesIndicesExtra&&(e.matricesIndicesExtra=this.matricesIndicesExtra,e.matricesIndicesExtra._isExpanded=!0),this.matricesWeightsExtra&&(e.matricesWeightsExtra=this.matricesWeightsExtra),e.indices=this.indices,e},t.ExtractFromMesh=function(e,i){return t._ExtractFrom(e,i)},t.ExtractFromGeometry=function(e,i){return t._ExtractFrom(e,i)},t._ExtractFrom=function(i,r){var n=new t;return i.isVerticesDataPresent(e.VertexBuffer.PositionKind)&&(n.positions=i.getVerticesData(e.VertexBuffer.PositionKind,r)),i.isVerticesDataPresent(e.VertexBuffer.NormalKind)&&(n.normals=i.getVerticesData(e.VertexBuffer.NormalKind,r)),i.isVerticesDataPresent(e.VertexBuffer.UVKind)&&(n.uvs=i.getVerticesData(e.VertexBuffer.UVKind,r)),i.isVerticesDataPresent(e.VertexBuffer.UV2Kind)&&(n.uvs2=i.getVerticesData(e.VertexBuffer.UV2Kind,r)),i.isVerticesDataPresent(e.VertexBuffer.UV3Kind)&&(n.uvs3=i.getVerticesData(e.VertexBuffer.UV3Kind,r)),i.isVerticesDataPresent(e.VertexBuffer.UV4Kind)&&(n.uvs4=i.getVerticesData(e.VertexBuffer.UV4Kind,r)),i.isVerticesDataPresent(e.VertexBuffer.UV5Kind)&&(n.uvs5=i.getVerticesData(e.VertexBuffer.UV5Kind,r)),i.isVerticesDataPresent(e.VertexBuffer.UV6Kind)&&(n.uvs6=i.getVerticesData(e.VertexBuffer.UV6Kind,r)),i.isVerticesDataPresent(e.VertexBuffer.ColorKind)&&(n.colors=i.getVerticesData(e.VertexBuffer.ColorKind,r)),i.isVerticesDataPresent(e.VertexBuffer.MatricesIndicesKind)&&(n.matricesIndices=i.getVerticesData(e.VertexBuffer.MatricesIndicesKind,r)),i.isVerticesDataPresent(e.VertexBuffer.MatricesWeightsKind)&&(n.matricesWeights=i.getVerticesData(e.VertexBuffer.MatricesWeightsKind,r)),i.isVerticesDataPresent(e.VertexBuffer.MatricesIndicesExtraKind)&&(n.matricesIndicesExtra=i.getVerticesData(e.VertexBuffer.MatricesIndicesExtraKind,r)),i.isVerticesDataPresent(e.VertexBuffer.MatricesWeightsExtraKind)&&(n.matricesWeightsExtra=i.getVerticesData(e.VertexBuffer.MatricesWeightsExtraKind,r)),n.indices=i.getIndices(r),n},t.CreateRibbon=function(i){var r=i.pathArray,n=i.closeArray||!1,o=i.closePath||!1,s=Math.floor(r[0].length/2),a=i.offset||s;a=a>s?s:Math.floor(a);var h,c,l,u,f=0===i.sideOrientation?0:i.sideOrientation||e.Mesh.DEFAULTSIDE,d=[],p=[],_=[],m=[],g=[],v=[],y=[],x=[],b=[],P=[];if(r.length<2){var A=[],T=[];for(l=0;l<r[0].length-a;l++)A.push(r[0][l]),T.push(r[0][l+a]);r=[A,T]}var E,C,S=0,M=o?1:0;h=r[0].length;var I,D;for(c=0;c<r.length;c++){for(y[c]=0,g[c]=[0],E=r[c],C=E.length,h=C>h?h:C,u=0;C>u;)d.push(E[u].x,E[u].y,E[u].z),u>0&&(I=E[u].subtract(E[u-1]).length(),D=I+y[c],g[c].push(D),y[c]=D),u++;o&&(u--,d.push(E[0].x,E[0].y,E[0].z),I=E[u].subtract(E[0]).length(),D=I+y[c],g[c].push(D),y[c]=D),b[c]=C+M,P[c]=S,S+=C+M}var R,O,w,L;for(l=0;h+M>l;l++){for(x[l]=0,v[l]=[0],c=0;c<r.length-1;c++)R=r[c],O=r[c+1],l===h?(w=R[0],L=O[0]):(w=R[l],L=O[l]),I=L.subtract(w).length(),D=I+x[l],v[l].push(D),x[l]=D;n&&(R=r[c],O=r[0],l===h&&(L=O[0]),I=L.subtract(w).length(),D=I+x[l],x[l]=D)}var B,V;for(c=0;c<r.length;c++)for(l=0;h+M>l;l++)B=g[c][l]/y[c],V=v[l][c]/x[l],m.push(B,V);c=0;for(var F=0,N=b[c]-1,z=b[c+1]-1,k=z>N?N:z,U=P[1]-P[0],G=n?b.length:b.length-1;k>=F&&G>c;)p.push(F,F+U,F+1),p.push(F+U+1,F+1,F+U),F+=1,F===k&&(c++,c===b.length-1?(U=P[0]-P[c],N=b[c]-1,z=b[0]-1):(U=P[c+1]-P[c],N=b[c]-1,z=b[c+1]-1),F=P[c],k=z>N?N+F:z+F);if(t.ComputeNormals(d,p,_),o){var W=0,Y=0;for(c=0;c<r.length;c++)W=3*P[c],Y=c+1<r.length?3*(P[c+1]-1):_.length-3,_[W]=.5*(_[W]+_[Y]),_[W+1]=.5*(_[W+1]+_[Y+1]),_[W+2]=.5*(_[W+2]+_[Y+2]),_[Y]=_[W],_[Y+1]=_[W+1],_[Y+2]=_[W+2]}t._ComputeSides(f,d,p,_,m);var H=new t;return H.indices=p,H.positions=d,H.normals=_,H.uvs=m,o&&(H._idx=P),H},t.CreateBox=function(i){for(var r=[new e.Vector3(0,0,1),new e.Vector3(0,0,-1),new e.Vector3(1,0,0),new e.Vector3(-1,0,0),new e.Vector3(0,1,0),new e.Vector3(0,-1,0)],n=[],o=[],s=[],a=[],h=i.width||i.size||1,c=i.height||i.size||1,l=i.depth||i.size||1,u=0===i.sideOrientation?0:i.sideOrientation||e.Mesh.DEFAULTSIDE,f=i.faceUV||new Array(6),d=i.faceColors,p=[],_=0;6>_;_++)void 0===f[_]&&(f[_]=new e.Vector4(0,0,1,1)),d&&void 0===d[_]&&(d[_]=new e.Color4(1,1,1,1));for(var m=new e.Vector3(h/2,c/2,l/2),g=0;g<r.length;g++){var v=r[g],y=new e.Vector3(v.y,v.z,v.x),x=e.Vector3.Cross(v,y),b=o.length/3;n.push(b),n.push(b+1),n.push(b+2),n.push(b),n.push(b+2),n.push(b+3);var P=v.subtract(y).subtract(x).multiply(m);o.push(P.x,P.y,P.z),s.push(v.x,v.y,v.z),a.push(f[g].z,f[g].w),d&&p.push(d[g].r,d[g].g,d[g].b,d[g].a),P=v.subtract(y).add(x).multiply(m),o.push(P.x,P.y,P.z),s.push(v.x,v.y,v.z),a.push(f[g].x,f[g].w),d&&p.push(d[g].r,d[g].g,d[g].b,d[g].a),P=v.add(y).add(x).multiply(m),o.push(P.x,P.y,P.z),s.push(v.x,v.y,v.z),a.push(f[g].x,f[g].y),d&&p.push(d[g].r,d[g].g,d[g].b,d[g].a),P=v.add(y).subtract(x).multiply(m),o.push(P.x,P.y,P.z),s.push(v.x,v.y,v.z),a.push(f[g].z,f[g].y),d&&p.push(d[g].r,d[g].g,d[g].b,d[g].a)}t._ComputeSides(u,o,n,s,a);var A=new t;if(A.indices=n,A.positions=o,A.normals=s,A.uvs=a,d){var T=u===e.Mesh.DOUBLESIDE?p.concat(p):p;A.colors=T}return A},t.CreateSphere=function(i){for(var r=i.segments||32,n=i.diameterX||i.diameter||1,o=i.diameterY||i.diameter||1,s=i.diameterZ||i.diameter||1,a=i.arc<=0||i.arc>1?1:i.arc||1,h=i.slice<=0?1:i.slice||1,c=0===i.sideOrientation?0:i.sideOrientation||e.Mesh.DEFAULTSIDE,l=new e.Vector3(n/2,o/2,s/2),u=2+r,f=2*u,d=[],p=[],_=[],m=[],g=0;u>=g;g++){for(var v=g/u,y=v*Math.PI*h,x=0;f>=x;x++){var b=x/f,P=b*Math.PI*2*a,A=e.Matrix.RotationZ(-y),T=e.Matrix.RotationY(P),E=e.Vector3.TransformCoordinates(e.Vector3.Up(),A),C=e.Vector3.TransformCoordinates(E,T),S=C.multiply(l),M=C.divide(l).normalize();p.push(S.x,S.y,S.z),_.push(M.x,M.y,M.z),m.push(b,v)}if(g>0)for(var I=p.length/3,D=I-2*(f+1);I>D+f+2;D++)d.push(D),d.push(D+1),d.push(D+f+1),d.push(D+f+1),d.push(D+1),d.push(D+f+2)}t._ComputeSides(c,p,d,_,m);var R=new t;return R.indices=d,R.positions=p,R.normals=_,R.uvs=m,R},t.CreateCylinder=function(i){var r,n=i.height||2,o=0===i.diameterTop?0:i.diameterTop||i.diameter||1,s=i.diameterBottom||i.diameter||1,a=i.tessellation||24,h=i.subdivisions||1,c=i.hasRings,l=i.enclose,u=i.arc<=0||i.arc>1?1:i.arc||1,f=0===i.sideOrientation?0:i.sideOrientation||e.Mesh.DEFAULTSIDE,d=i.faceUV||new Array(3),p=i.faceColors,_=1!==u&&l?2:0,m=c?h:1,g=2+(1+_)*m;for(r=0;g>r;r++)p&&void 0===p[r]&&(p[r]=new e.Color4(1,1,1,1));for(r=0;g>r;r++)d&&void 0===d[r]&&(d[r]=new e.Vector4(0,0,1,1));var v,y,x,b,P,A,T=[],E=[],C=[],S=[],M=[],I=2*Math.PI*u/a,D=(s-o)/2/n,R=e.Vector3.Zero(),O=e.Vector3.Zero(),w=e.Vector3.Zero(),L=e.Vector3.Zero(),B=e.Vector3.Zero(),V=e.Axis.Y,F=1,N=1,z=0,k=0;for(b=0;h>=b;b++)for(y=b/h,x=(y*(o-s)+s)/2,F=c&&0!==b&&b!==h?2:1,A=0;F>A;A++){for(c&&(N+=A),l&&(N+=2*A),P=0;a>=P;P++)v=P*I,R.x=Math.cos(-v)*x,R.y=-n/2+y*n,R.z=Math.sin(-v)*x,0===o&&b===h?(O.x=C[C.length-3*(a+1)],O.y=C[C.length-3*(a+1)+1],O.z=C[C.length-3*(a+1)+2]):(O.x=R.x,O.z=R.z,O.y=Math.sqrt(O.x*O.x+O.z*O.z)*D,O.normalize()),0===P&&(w.copyFrom(R),L.copyFrom(O)),E.push(R.x,R.y,R.z),C.push(O.x,O.y,O.z),k=c?z!==N?d[N].y:d[N].w:d[N].y+(d[N].w-d[N].y)*y,S.push(d[N].x+(d[N].z-d[N].x)*P/a,k),p&&M.push(p[N].r,p[N].g,p[N].b,p[N].a);1!==u&&l&&(E.push(R.x,R.y,R.z),E.push(0,R.y,0),E.push(0,R.y,0),E.push(w.x,w.y,w.z),e.Vector3.CrossToRef(V,O,B),B.normalize(),C.push(B.x,B.y,B.z,B.x,B.y,B.z),e.Vector3.CrossToRef(L,V,B),B.normalize(),C.push(B.x,B.y,B.z,B.x,B.y,B.z),k=c?z!==N?d[N+1].y:d[N+1].w:d[N+1].y+(d[N+1].w-d[N+1].y)*y,S.push(d[N+1].x,k),S.push(d[N+1].z,k),k=c?z!==N?d[N+2].y:d[N+2].w:d[N+2].y+(d[N+2].w-d[N+2].y)*y,S.push(d[N+2].x,k),S.push(d[N+2].z,k),p&&(M.push(p[N+1].r,p[N+1].g,p[N+1].b,p[N+1].a),M.push(p[N+1].r,p[N+1].g,p[N+1].b,p[N+1].a),M.push(p[N+2].r,p[N+2].g,p[N+2].b,p[N+2].a),M.push(p[N+2].r,p[N+2].g,p[N+2].b,p[N+2].a))),z!==N&&(z=N)}var N,U=1!==u&&l?a+4:a;for(b=0,N=0;h>N;N++){for(P=0;a>P;P++){var G=b*(U+1)+P,W=(b+1)*(U+1)+P,Y=b*(U+1)+(P+1),H=(b+1)*(U+1)+(P+1);T.push(G,W,Y),T.push(H,Y,W)}1!==u&&l&&(T.push(G+2,W+2,Y+2),T.push(H+2,Y+2,W+2),T.push(G+4,W+4,Y+4),T.push(H+4,Y+4,W+4)),b=c?b+2:b+1}var j=function(t){var i=t?o/2:s/2;if(0!==i){var r,h,c,l,f=t?d[g-1]:d[0];p&&(l=t?p[g-1]:p[0]);var _=E.length/3,m=t?n/2:-n/2,v=new e.Vector3(0,m,0);E.push(v.x,v.y,v.z),C.push(0,t?1:-1,0),S.push(f.x+.5*(f.z-f.x),f.y+.5*(f.w-f.y)),p&&M.push(l.r,l.g,l.b,l.a);var y=new e.Vector2(.5,.5);for(c=0;a>=c;c++){r=2*Math.PI*c*u/a;var x=Math.cos(-r),b=Math.sin(-r);h=new e.Vector3(x*i,m,b*i);var P=new e.Vector2(x*y.x+.5,b*y.y+.5);E.push(h.x,h.y,h.z),C.push(0,t?1:-1,0),S.push(f.x+(f.z-f.x)*P.x,f.y+(f.w-f.y)*P.y),p&&M.push(l.r,l.g,l.b,l.a)}for(c=0;a>c;c++)t?(T.push(_),T.push(_+(c+2)),T.push(_+(c+1))):(T.push(_),T.push(_+(c+1)),T.push(_+(c+2)))}};j(!1),j(!0),t._ComputeSides(f,E,T,C,S);var X=new t;return X.indices=T,X.positions=E,X.normals=C,X.uvs=S,p&&(X.colors=M),X},t.CreateTorus=function(i){for(var r=[],n=[],o=[],s=[],a=i.diameter||1,h=i.thickness||.5,c=i.tessellation||16,l=0===i.sideOrientation?0:i.sideOrientation||e.Mesh.DEFAULTSIDE,u=c+1,f=0;c>=f;f++)for(var d=f/c,p=f*Math.PI*2/c-Math.PI/2,_=e.Matrix.Translation(a/2,0,0).multiply(e.Matrix.RotationY(p)),m=0;c>=m;m++){var g=1-m/c,v=m*Math.PI*2/c+Math.PI,y=Math.cos(v),x=Math.sin(v),b=new e.Vector3(y,x,0),P=b.scale(h/2),A=new e.Vector2(d,g);P=e.Vector3.TransformCoordinates(P,_),b=e.Vector3.TransformNormal(b,_),n.push(P.x,P.y,P.z),o.push(b.x,b.y,b.z),s.push(A.x,A.y);var T=(f+1)%u,E=(m+1)%u;r.push(f*u+m),r.push(f*u+E),r.push(T*u+m),r.push(f*u+E),r.push(T*u+E),r.push(T*u+m)}t._ComputeSides(l,n,r,o,s);var C=new t;return C.indices=r,C.positions=n,C.normals=o,C.uvs=s,C},t.CreateLineSystem=function(e){for(var i=[],r=[],n=e.lines,o=0,s=0;s<n.length;s++)for(var a=n[s],h=0;h<a.length;h++)r.push(a[h].x,a[h].y,a[h].z),h>0&&(i.push(o-1),i.push(o)),o++;var c=new t;return c.indices=i,c.positions=r,c},t.CreateDashedLines=function(i){var r=i.dashSize||3,n=i.gapSize||1,o=i.dashNb||200,s=i.points,a=new Array,h=new Array,c=e.Vector3.Zero(),l=0,u=0,f=0,d=0,p=0,_=0,m=0;for(m=0;m<s.length-1;m++)s[m+1].subtractToRef(s[m],c),l+=c.length();for(f=l/o,d=r*f/(r+n),m=0;m<s.length-1;m++){s[m+1].subtractToRef(s[m],c),u=Math.floor(c.length()/f),c.normalize();for(var g=0;u>g;g++)p=f*g,a.push(s[m].x+p*c.x,s[m].y+p*c.y,s[m].z+p*c.z),a.push(s[m].x+(p+d)*c.x,s[m].y+(p+d)*c.y,s[m].z+(p+d)*c.z),h.push(_,_+1),_+=2}var v=new t;return v.positions=a,v.indices=h,v},t.CreateGround=function(i){var r,n,o=[],s=[],a=[],h=[],c=i.width||1,l=i.height||1,u=i.subdivisions||1;for(r=0;u>=r;r++)for(n=0;u>=n;n++){var f=new e.Vector3(n*c/u-c/2,0,(u-r)*l/u-l/2),d=new e.Vector3(0,1,0);s.push(f.x,f.y,f.z),a.push(d.x,d.y,d.z),h.push(n/u,1-r/u)}for(r=0;u>r;r++)for(n=0;u>n;n++)o.push(n+1+(r+1)*(u+1)),o.push(n+1+r*(u+1)),o.push(n+r*(u+1)),o.push(n+(r+1)*(u+1)),o.push(n+1+(r+1)*(u+1)),o.push(n+r*(u+1));var p=new t;return p.indices=o,p.positions=s,p.normals=a,p.uvs=h,p},t.CreateTiledGround=function(i){function r(t,i,r,s){var a=_.length/3,h=d.w+1;for(n=0;n<d.h;n++)for(o=0;o<d.w;o++){var c=[a+o+n*h,a+(o+1)+n*h,a+(o+1)+(n+1)*h,a+o+(n+1)*h];p.push(c[1]),p.push(c[2]),p.push(c[3]),p.push(c[0]),p.push(c[1]),p.push(c[3])}var l=e.Vector3.Zero(),u=new e.Vector3(0,1,0);for(n=0;n<=d.h;n++)for(l.z=n*(s-i)/d.h+i,o=0;o<=d.w;o++)l.x=o*(r-t)/d.w+t,l.y=0,_.push(l.x,l.y,l.z),m.push(u.x,u.y,u.z),g.push(o/d.w,n/d.h)}var n,o,s,a,h=i.xmin,c=i.zmin,l=i.xmax,u=i.zmax,f=i.subdivisions||{w:1,h:1},d=i.precision||{w:1,h:1},p=[],_=[],m=[],g=[];f.h=f.w<1?1:f.h,f.w=f.w<1?1:f.w,d.w=d.w<1?1:d.w,d.h=d.h<1?1:d.h;var v={w:(l-h)/f.w,h:(u-c)/f.h};for(s=0;s<f.h;s++)for(a=0;a<f.w;a++)r(h+a*v.w,c+s*v.h,h+(a+1)*v.w,c+(s+1)*v.h);var y=new t;return y.indices=p,y.positions=_,y.normals=m,y.uvs=g,y},t.CreateGroundFromHeightMap=function(i){var r,n,o=[],s=[],a=[],h=[];for(r=0;r<=i.subdivisions;r++)for(n=0;n<=i.subdivisions;n++){var c=new e.Vector3(n*i.width/i.subdivisions-i.width/2,0,(i.subdivisions-r)*i.height/i.subdivisions-i.height/2),l=(c.x+i.width/2)/i.width*(i.bufferWidth-1)|0,u=(1-(c.z+i.height/2)/i.height)*(i.bufferHeight-1)|0,f=4*(l+u*i.bufferWidth),d=i.buffer[f]/255,p=i.buffer[f+1]/255,_=i.buffer[f+2]/255,m=.3*d+.59*p+.11*_;c.y=i.minHeight+(i.maxHeight-i.minHeight)*m,s.push(c.x,c.y,c.z),a.push(0,0,0),h.push(n/i.subdivisions,1-r/i.subdivisions)}for(r=0;r<i.subdivisions;r++)for(n=0;n<i.subdivisions;n++)o.push(n+1+(r+1)*(i.subdivisions+1)),o.push(n+1+r*(i.subdivisions+1)),o.push(n+r*(i.subdivisions+1)),o.push(n+(r+1)*(i.subdivisions+1)),o.push(n+1+(r+1)*(i.subdivisions+1)),o.push(n+r*(i.subdivisions+1));t.ComputeNormals(s,o,a);var g=new t;return g.indices=o,g.positions=s,g.normals=a,g.uvs=h,g},t.CreatePlane=function(i){var r=[],n=[],o=[],s=[],a=i.width||i.size||1,h=i.height||i.size||1,c=0===i.sideOrientation?0:i.sideOrientation||e.Mesh.DEFAULTSIDE,l=a/2,u=h/2;n.push(-l,-u,0),o.push(0,0,-1),s.push(0,0),n.push(l,-u,0),o.push(0,0,-1),s.push(1,0),n.push(l,u,0),o.push(0,0,-1),s.push(1,1),n.push(-l,u,0),o.push(0,0,-1),s.push(0,1),r.push(0),r.push(1),r.push(2),r.push(0),r.push(2),r.push(3),t._ComputeSides(c,n,r,o,s);var f=new t;return f.indices=r,f.positions=n,f.normals=o,f.uvs=s,f},t.CreateDisc=function(i){var r=[],n=[],o=[],s=[],a=i.radius||.5,h=i.tessellation||64,c=i.arc<=0||i.arc>1?1:i.arc||1,l=0===i.sideOrientation?0:i.sideOrientation||e.Mesh.DEFAULTSIDE;r.push(0,0,0),s.push(.5,.5);for(var u=2*Math.PI*c,f=u/h,d=0;u>d;d+=f){var p=Math.cos(d),_=Math.sin(d),m=(p+1)/2,g=(1-_)/2;r.push(a*p,a*_,0),s.push(m,g)}1===c&&(r.push(r[3],r[4],r[5]),s.push(s[2],s[3]));for(var v=r.length/3,y=1;v-1>y;y++)n.push(y+1,0,y);t.ComputeNormals(r,n,o),t._ComputeSides(l,r,n,o,s);var x=new t;return x.indices=n,x.positions=r,x.normals=o,x.uvs=s,x},t.CreateIcoSphere=function(i){var r,n=i.sideOrientation||e.Mesh.DEFAULTSIDE,o=i.radius||1,s=void 0===i.flat?!0:i.flat,a=i.subdivisions||4,h=i.radiusX||o,c=i.radiusY||o,l=i.radiusZ||o,u=(1+Math.sqrt(5))/2,f=[-1,u,-0,1,u,0,-1,-u,0,1,-u,0,0,-1,-u,0,1,-u,0,-1,u,0,1,u,u,0,1,u,0,-1,-u,0,1,-u,0,-1],d=[0,11,5,0,5,1,0,1,7,0,7,10,12,22,23,1,5,20,5,11,4,23,22,13,22,18,6,7,1,8,14,21,4,14,4,2,16,13,6,15,6,19,3,8,9,4,21,5,13,17,23,6,13,22,19,6,18,9,8,1],p=[0,1,2,3,4,5,6,7,8,9,10,11,0,2,3,3,3,4,7,8,9,9,10,11],_=[5,1,3,1,6,4,0,0,5,3,4,2,2,2,4,0,2,0,1,1,6,0,6,2,0,4,3,3,4,4,3,1,4,2,4,4,0,2,1,1,2,2,3,3,1,3,2,4],m=138/1024,g=239/1024,v=60/1024,y=26/1024,x=-40/1024,b=20/1024,P=[0,0,0,0,1,0,0,1,1,0,0,0,1,1,0,0,1,1,1,0],A=[],T=[],E=[],C=[],S=0,M=new Array(3),I=new Array(3);for(r=0;3>r;r++)M[r]=e.Vector3.Zero(),I[r]=e.Vector2.Zero();for(var D=0;20>D;D++){for(r=0;3>r;r++){var R=d[3*D+r];M[r].copyFromFloats(f[3*p[R]],f[3*p[R]+1],f[3*p[R]+2]),M[r].normalize().scaleInPlace(o),I[r].copyFromFloats(_[2*R]*m+v+P[D]*x,_[2*R+1]*g+y+P[D]*b)}for(var O=function(t,i,r,n){var o=e.Vector3.Lerp(M[0],M[2],i/a),u=e.Vector3.Lerp(M[1],M[2],i/a),f=a===i?M[2]:e.Vector3.Lerp(o,u,t/(a-i));f.normalize();var d;if(s){var p=e.Vector3.Lerp(M[0],M[2],n/a),_=e.Vector3.Lerp(M[1],M[2],n/a);d=e.Vector3.Lerp(p,_,r/(a-n))}else d=new e.Vector3(f.x,f.y,f.z);d.x/=h,d.y/=c,d.z/=l,d.normalize();var m=e.Vector2.Lerp(I[0],I[2],i/a),g=e.Vector2.Lerp(I[1],I[2],i/a),v=a===i?I[2]:e.Vector2.Lerp(m,g,t/(a-i));T.push(f.x*h,f.y*c,f.z*l),E.push(d.x,d.y,d.z),C.push(v.x,v.y),A.push(S),S++},w=0;a>w;w++)for(var L=0;a>L+w;L++)O(L,w,L+1/3,w+1/3),O(L+1,w,L+1/3,w+1/3),O(L,w+1,L+1/3,w+1/3),a>L+w+1&&(O(L+1,w,L+2/3,w+2/3),O(L+1,w+1,L+2/3,w+2/3),O(L,w+1,L+2/3,w+2/3))}t._ComputeSides(n,T,A,E,C);var B=new t;return B.indices=A,B.positions=T,B.normals=E,B.uvs=C,B},t.CreatePolyhedron=function(i){var r=[];r[0]={vertex:[[0,0,1.732051],[1.632993,0,-.5773503],[-.8164966,1.414214,-.5773503],[-.8164966,-1.414214,-.5773503]],face:[[0,1,2],[0,2,3],[0,3,1],[1,3,2]]},r[1]={vertex:[[0,0,1.414214],[1.414214,0,0],[0,1.414214,0],[-1.414214,0,0],[0,-1.414214,0],[0,0,-1.414214]],face:[[0,1,2],[0,2,3],[0,3,4],[0,4,1],[1,4,5],[1,5,2],[2,5,3],[3,5,4]]},r[2]={vertex:[[0,0,1.070466],[.7136442,0,.7978784],[-.3568221,.618034,.7978784],[-.3568221,-.618034,.7978784],[.7978784,.618034,.3568221],[.7978784,-.618034,.3568221],[-.9341724,.381966,.3568221],[.1362939,1,.3568221],[.1362939,-1,.3568221],[-.9341724,-.381966,.3568221],[.9341724,.381966,-.3568221],[.9341724,-.381966,-.3568221],[-.7978784,.618034,-.3568221],[-.1362939,1,-.3568221],[-.1362939,-1,-.3568221],[-.7978784,-.618034,-.3568221],[.3568221,.618034,-.7978784],[.3568221,-.618034,-.7978784],[-.7136442,0,-.7978784],[0,0,-1.070466]],face:[[0,1,4,7,2],[0,2,6,9,3],[0,3,8,5,1],[1,5,11,10,4],[2,7,13,12,6],[3,9,15,14,8],[4,10,16,13,7],[5,8,14,17,11],[6,12,18,15,9],[10,11,17,19,16],[12,13,16,19,18],[14,15,18,19,17]]},r[3]={vertex:[[0,0,1.175571],[1.051462,0,.5257311],[.3249197,1,.5257311],[-.8506508,.618034,.5257311],[-.8506508,-.618034,.5257311],[.3249197,-1,.5257311],[.8506508,.618034,-.5257311],[.8506508,-.618034,-.5257311],[-.3249197,1,-.5257311],[-1.051462,0,-.5257311],[-.3249197,-1,-.5257311],[0,0,-1.175571]],face:[[0,1,2],[0,2,3],[0,3,4],[0,4,5],[0,5,1],[1,5,7],[1,7,6],[1,6,2],[2,6,8],[2,8,3],[3,8,9],[3,9,4],[4,9,10],[4,10,5],[5,10,7],[6,7,11],[6,11,8],[7,10,11],[8,11,9],[9,11,10]]},r[4]={vertex:[[0,0,1.070722],[.7148135,0,.7971752],[-.104682,.7071068,.7971752],[-.6841528,.2071068,.7971752],[-.104682,-.7071068,.7971752],[.6101315,.7071068,.5236279],[1.04156,.2071068,.1367736],[.6101315,-.7071068,.5236279],[-.3574067,1,.1367736],[-.7888348,-.5,.5236279],[-.9368776,.5,.1367736],[-.3574067,-1,.1367736],[.3574067,1,-.1367736],[.9368776,-.5,-.1367736],[.7888348,.5,-.5236279],[.3574067,-1,-.1367736],[-.6101315,.7071068,-.5236279],[-1.04156,-.2071068,-.1367736],[-.6101315,-.7071068,-.5236279],[.104682,.7071068,-.7971752],[.6841528,-.2071068,-.7971752],[.104682,-.7071068,-.7971752],[-.7148135,0,-.7971752],[0,0,-1.070722]],face:[[0,2,3],[1,6,5],[4,9,11],[7,15,13],[8,16,10],[12,14,19],[17,22,18],[20,21,23],[0,1,5,2],[0,3,9,4],[0,4,7,1],[1,7,13,6],[2,5,12,8],[2,8,10,3],[3,10,17,9],[4,11,15,7],[5,6,14,12],[6,13,20,14],[8,12,19,16],[9,17,18,11],[10,16,22,17],[11,18,21,15],[13,15,21,20],[14,20,23,19],[16,19,23,22],[18,22,23,21]]
},r[5]={vertex:[[0,0,1.322876],[1.309307,0,.1889822],[-.9819805,.8660254,.1889822],[.1636634,-1.299038,.1889822],[.3273268,.8660254,-.9449112],[-.8183171,-.4330127,-.9449112]],face:[[0,3,1],[2,4,5],[0,1,4,2],[0,2,5,3],[1,3,5,4]]},r[6]={vertex:[[0,0,1.159953],[1.013464,0,.5642542],[-.3501431,.9510565,.5642542],[-.7715208,-.6571639,.5642542],[.6633206,.9510565,-.03144481],[.8682979,-.6571639,-.3996071],[-1.121664,.2938926,-.03144481],[-.2348831,-1.063314,-.3996071],[.5181548,.2938926,-.9953061],[-.5850262,-.112257,-.9953061]],face:[[0,1,4,2],[0,2,6,3],[1,5,8,4],[3,6,9,7],[5,7,9,8],[0,3,7,5,1],[2,4,8,9,6]]},r[7]={vertex:[[0,0,1.118034],[.8944272,0,.6708204],[-.2236068,.8660254,.6708204],[-.7826238,-.4330127,.6708204],[.6708204,.8660254,.2236068],[1.006231,-.4330127,-.2236068],[-1.006231,.4330127,.2236068],[-.6708204,-.8660254,-.2236068],[.7826238,.4330127,-.6708204],[.2236068,-.8660254,-.6708204],[-.8944272,0,-.6708204],[0,0,-1.118034]],face:[[0,1,4,2],[0,2,6,3],[1,5,8,4],[3,6,10,7],[5,9,11,8],[7,10,11,9],[0,3,7,9,5,1],[2,4,8,11,10,6]]},r[8]={vertex:[[-.729665,.670121,.319155],[-.655235,-.29213,-.754096],[-.093922,-.607123,.537818],[.702196,.595691,.485187],[.776626,-.36656,-.588064]],face:[[1,4,2],[0,1,2],[3,0,2],[4,3,2],[4,1,0,3]]},r[9]={vertex:[[-.868849,-.100041,.61257],[-.329458,.976099,.28078],[-.26629,-.013796,-.477654],[-.13392,-1.034115,.229829],[.738834,.707117,-.307018],[.859683,-.535264,-.338508]],face:[[3,0,2],[5,3,2],[4,5,2],[1,4,2],[0,1,2],[0,3,5,4,1]]},r[10]={vertex:[[-.610389,.243975,.531213],[-.187812,-.48795,-.664016],[-.187812,.9759,-.664016],[.187812,-.9759,.664016],[.798201,.243975,.132803]],face:[[1,3,0],[3,4,0],[3,1,4],[0,2,1],[0,4,2],[2,4,1]]},r[11]={vertex:[[-1.028778,.392027,-.048786],[-.640503,-.646161,.621837],[-.125162,-.395663,-.540059],[.004683,.888447,-.651988],[.125161,.395663,.540059],[.632925,-.791376,.433102],[1.031672,.157063,-.354165]],face:[[3,2,0],[2,1,0],[2,5,1],[0,4,3],[0,1,4],[4,1,5],[2,3,6],[3,4,6],[5,2,6],[4,5,6]]},r[12]={vertex:[[-.669867,.334933,-.529576],[-.669867,.334933,.529577],[-.4043,1.212901,0],[-.334933,-.669867,-.529576],[-.334933,-.669867,.529577],[.334933,.669867,-.529576],[.334933,.669867,.529577],[.4043,-1.212901,0],[.669867,-.334933,-.529576],[.669867,-.334933,.529577]],face:[[8,9,7],[6,5,2],[3,8,7],[5,0,2],[4,3,7],[0,1,2],[9,4,7],[1,6,2],[9,8,5,6],[8,3,0,5],[3,4,1,0],[4,9,6,1]]},r[13]={vertex:[[-.931836,.219976,-.264632],[-.636706,.318353,.692816],[-.613483,-.735083,-.264632],[-.326545,.979634,0],[-.318353,-.636706,.692816],[-.159176,.477529,-.856368],[.159176,-.477529,-.856368],[.318353,.636706,.692816],[.326545,-.979634,0],[.613482,.735082,-.264632],[.636706,-.318353,.692816],[.931835,-.219977,-.264632]],face:[[11,10,8],[7,9,3],[6,11,8],[9,5,3],[2,6,8],[5,0,3],[4,2,8],[0,1,3],[10,4,8],[1,7,3],[10,11,9,7],[11,6,5,9],[6,2,0,5],[2,4,1,0],[4,10,7,1]]},r[14]={vertex:[[-.93465,.300459,-.271185],[-.838689,-.260219,-.516017],[-.711319,.717591,.128359],[-.710334,-.156922,.080946],[-.599799,.556003,-.725148],[-.503838,-.004675,-.969981],[-.487004,.26021,.48049],[-.460089,-.750282,-.512622],[-.376468,.973135,-.325605],[-.331735,-.646985,.084342],[-.254001,.831847,.530001],[-.125239,-.494738,-.966586],[.029622,.027949,.730817],[.056536,-.982543,-.262295],[.08085,1.087391,.076037],[.125583,-.532729,.485984],[.262625,.599586,.780328],[.391387,-.726999,-.716259],[.513854,-.868287,.139347],[.597475,.85513,.326364],[.641224,.109523,.783723],[.737185,-.451155,.538891],[.848705,-.612742,-.314616],[.976075,.365067,.32976],[1.072036,-.19561,.084927]],face:[[15,18,21],[12,20,16],[6,10,2],[3,0,1],[9,7,13],[2,8,4,0],[0,4,5,1],[1,5,11,7],[7,11,17,13],[13,17,22,18],[18,22,24,21],[21,24,23,20],[20,23,19,16],[16,19,14,10],[10,14,8,2],[15,9,13,18],[12,15,21,20],[6,12,16,10],[3,6,2,0],[9,3,1,7],[9,15,12,6,3],[22,17,11,5,4,8,14,19,23,24]]};var n,o,s,a,h,c,l=i.type<0||i.type>=r.length?0:i.type||0,u=i.size,f=i.sizeX||u||1,d=i.sizeY||u||1,p=i.sizeZ||u||1,_=i.custom||r[l],m=_.face.length,g=i.faceUV||new Array(m),v=i.faceColors,y=void 0===i.flat?!0:i.flat,x=0===i.sideOrientation?0:i.sideOrientation||e.Mesh.DEFAULTSIDE,b=[],P=[],A=[],T=[],E=[],C=0,S=0,M=[],I=0,D=0;if(y)for(D=0;m>D;D++)v&&void 0===v[D]&&(v[D]=new e.Color4(1,1,1,1)),g&&void 0===g[D]&&(g[D]=new e.Vector4(0,0,1,1));if(y)for(D=0;m>D;D++){var R=_.face[D].length;for(s=2*Math.PI/R,a=.5*Math.tan(s/2),h=.5,I=0;R>I;I++)b.push(_.vertex[_.face[D][I]][0]*f,_.vertex[_.face[D][I]][1]*d,_.vertex[_.face[D][I]][2]*p),M.push(C),C++,n=g[D].x+(g[D].z-g[D].x)*(.5+a),o=g[D].y+(g[D].w-g[D].y)*(h-.5),T.push(n,o),c=a*Math.cos(s)-h*Math.sin(s),h=a*Math.sin(s)+h*Math.cos(s),a=c,v&&E.push(v[D].r,v[D].g,v[D].b,v[D].a);for(I=0;R-2>I;I++)P.push(M[0+S],M[I+2+S],M[I+1+S]);S+=R}else{for(I=0;I<_.vertex.length;I++)b.push(_.vertex[I][0]*f,_.vertex[I][1]*d,_.vertex[I][2]*p),T.push(0,0);for(D=0;m>D;D++)for(I=0;I<_.face[D].length-2;I++)P.push(_.face[D][0],_.face[D][I+2],_.face[D][I+1])}t.ComputeNormals(b,P,A),t._ComputeSides(x,b,P,A,T);var O=new t;return O.positions=b,O.indices=P,O.normals=A,O.uvs=T,v&&y&&(O.colors=E),O},t.CreateTorusKnot=function(i){var r,n,o=[],s=[],a=[],h=[],c=i.radius||2,l=i.tube||.5,u=i.radialSegments||32,f=i.tubularSegments||32,d=i.p||2,p=i.q||3,_=0===i.sideOrientation?0:i.sideOrientation||e.Mesh.DEFAULTSIDE,m=function(t){var i=Math.cos(t),r=Math.sin(t),n=p/d*t,o=Math.cos(n),s=c*(2+o)*.5*i,a=c*(2+o)*r*.5,h=c*Math.sin(n)*.5;return new e.Vector3(s,a,h)};for(r=0;u>=r;r++){var g=r%u,v=g/u*2*d*Math.PI,y=m(v),x=m(v+.01),b=x.subtract(y),P=x.add(y),A=e.Vector3.Cross(b,P);for(P=e.Vector3.Cross(A,b),A.normalize(),P.normalize(),n=0;f>n;n++){var T=n%f,E=T/f*2*Math.PI,C=-l*Math.cos(E),S=l*Math.sin(E);s.push(y.x+C*P.x+S*A.x),s.push(y.y+C*P.y+S*A.y),s.push(y.z+C*P.z+S*A.z),h.push(r/u),h.push(n/f)}}for(r=0;u>r;r++)for(n=0;f>n;n++){var M=(n+1)%f,I=r*f+n,D=(r+1)*f+n,R=(r+1)*f+M,O=r*f+M;o.push(O),o.push(D),o.push(I),o.push(O),o.push(R),o.push(D)}t.ComputeNormals(s,o,a),t._ComputeSides(_,s,o,a,h);var w=new t;return w.indices=o,w.positions=s,w.normals=a,w.uvs=h,w},t.ComputeNormals=function(e,t,i){var r=0,n=0,o=0,s=0,a=0,h=0,c=0,l=0,u=0,f=0,d=0,p=0,_=0,m=0;for(r=0;r<e.length;r++)i[r]=0;var g=t.length/3;for(r=0;g>r;r++)p=t[3*r],_=t[3*r+1],m=t[3*r+2],n=e[3*p]-e[3*_],o=e[3*p+1]-e[3*_+1],s=e[3*p+2]-e[3*_+2],a=e[3*m]-e[3*_],h=e[3*m+1]-e[3*_+1],c=e[3*m+2]-e[3*_+2],l=o*c-s*h,u=s*a-n*c,f=n*h-o*a,d=Math.sqrt(l*l+u*u+f*f),d=0===d?1:d,l/=d,u/=d,f/=d,i[3*p]+=l,i[3*p+1]+=u,i[3*p+2]+=f,i[3*_]+=l,i[3*_+1]+=u,i[3*_+2]+=f,i[3*m]+=l,i[3*m+1]+=u,i[3*m+2]+=f;for(r=0;r<i.length/3;r++)l=i[3*r],u=i[3*r+1],f=i[3*r+2],d=Math.sqrt(l*l+u*u+f*f),d=0===d?1:d,l/=d,u/=d,f/=d,i[3*r]=l,i[3*r+1]=u,i[3*r+2]=f},t._ComputeSides=function(t,i,r,n,o){var s,a,h=r.length,c=n.length;switch(t=t||e.Mesh.DEFAULTSIDE){case e.Mesh.FRONTSIDE:break;case e.Mesh.BACKSIDE:var l;for(s=0;h>s;s+=3)l=r[s],r[s]=r[s+2],r[s+2]=l;for(a=0;c>a;a++)n[a]=-n[a];break;case e.Mesh.DOUBLESIDE:for(var u=i.length,f=u/3,d=0;u>d;d++)i[u+d]=i[d];for(s=0;h>s;s+=3)r[s+h]=r[s+2]+f,r[s+1+h]=r[s+1]+f,r[s+2+h]=r[s]+f;for(a=0;c>a;a++)n[c+a]=-n[a];for(var p=o.length,_=0;p>_;_++)o[_+p]=o[_]}},t.ImportVertexData=function(i,r){var n=new t,o=i.positions;o&&n.set(o,e.VertexBuffer.PositionKind);var s=i.normals;s&&n.set(s,e.VertexBuffer.NormalKind);var a=i.uvs;a&&n.set(a,e.VertexBuffer.UVKind);var h=i.uv2s;h&&n.set(h,e.VertexBuffer.UV2Kind);var c=i.uv3s;c&&n.set(c,e.VertexBuffer.UV3Kind);var l=i.uv4s;l&&n.set(l,e.VertexBuffer.UV4Kind);var u=i.uv5s;u&&n.set(u,e.VertexBuffer.UV5Kind);var f=i.uv6s;f&&n.set(f,e.VertexBuffer.UV6Kind);var d=i.colors;d&&n.set(e.Color4.CheckColors4(d,o.length/3),e.VertexBuffer.ColorKind);var p=i.matricesIndices;p&&n.set(p,e.VertexBuffer.MatricesIndicesKind);var _=i.matricesWeights;_&&n.set(_,e.VertexBuffer.MatricesWeightsKind);var m=i.indices;m&&(n.indices=m),r.setAllVerticesData(n,i.updatable)},t}();e.VertexData=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(){}return t.EnableFor=function(e){e._tags=e._tags||{},e.hasTags=function(){return t.HasTags(e)},e.addTags=function(i){return t.AddTagsTo(e,i)},e.removeTags=function(i){return t.RemoveTagsFrom(e,i)},e.matchesTagsQuery=function(i){return t.MatchesQuery(e,i)}},t.DisableFor=function(e){delete e._tags,delete e.hasTags,delete e.addTags,delete e.removeTags,delete e.matchesTagsQuery},t.HasTags=function(t){return t._tags?!e.Tools.IsEmpty(t._tags):!1},t.GetTags=function(e,t){if(void 0===t&&(t=!0),!e._tags)return null;if(t){var i=[];for(var r in e._tags)e._tags.hasOwnProperty(r)&&e._tags[r]===!0&&i.push(r);return i.join(" ")}return e._tags},t.AddTagsTo=function(e,i){if(i&&"string"==typeof i){var r=i.split(" ");for(var n in r)t._AddTagTo(e,r[n])}},t._AddTagTo=function(e,i){i=i.trim(),""!==i&&"true"!==i&&"false"!==i&&(i.match(/[\s]/)||i.match(/^([!]|([|]|[&]){2})/)||(t.EnableFor(e),e._tags[i]=!0))},t.RemoveTagsFrom=function(e,i){if(t.HasTags(e)){var r=i.split(" ");for(var n in r)t._RemoveTagFrom(e,r[n])}},t._RemoveTagFrom=function(e,t){delete e._tags[t]},t.MatchesQuery=function(i,r){return void 0===r?!0:""===r?t.HasTags(i):e.Internals.AndOrNotEvaluator.Eval(r,function(e){return t.HasTags(i)&&i._tags[e]})},t}();e.Tags=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t;!function(e){var t=function(){function e(){}return e.Eval=function(t,i){return t=t.match(/\([^\(\)]*\)/g)?t.replace(/\([^\(\)]*\)/g,function(t){return t=t.slice(1,t.length-1),e._HandleParenthesisContent(t,i)}):e._HandleParenthesisContent(t,i),"true"===t?!0:"false"===t?!1:e.Eval(t,i)},e._HandleParenthesisContent=function(t,i){i=i||function(e){return"true"===e};var r,n=t.split("||");for(var o in n){var s=e._SimplifyNegation(n[o].trim()),a=s.split("&&");if(a.length>1)for(var h=0;h<a.length;++h){var c=e._SimplifyNegation(a[h].trim());if(r="true"!==c&&"false"!==c?"!"===c[0]?!i(c.substring(1)):i(c):"true"===c,!r){s="false";break}}if(r||"true"===s){r=!0;break}r="true"!==s&&"false"!==s?"!"===s[0]?!i(s.substring(1)):i(s):"true"===s}return r?"true":"false"},e._SimplifyNegation=function(e){return e=e.replace(/^[\s!]+/,function(e){return e=e.replace(/[\s]/g,function(){return""}),e.length%2?"!":""}),e=e.trim(),"!true"===e?e="false":"!false"===e&&(e="true"),e},e}();e.AndOrNotEvaluator=t}(t=e.Internals||(e.Internals={}))}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(t,i,r,n,o,s){this._enabled=!0,this._refCount=0,this._name=i,this._renderTexture=new e.RenderTargetTexture(i,r,t),this.setRenderList(n),this._renderTexture.onBeforeRenderObservable.add(o),this._renderTexture.onAfterRenderObservable.add(s),this._scene=t,this._renderList=n}return t.prototype._incRefCount=function(){return 0===this._refCount&&this._scene.customRenderTargets.push(this._renderTexture),++this._refCount},t.prototype._decRefCount=function(){return this._refCount--,this._refCount<=0&&this._scene.customRenderTargets.splice(this._scene.customRenderTargets.indexOf(this._renderTexture),1),this._refCount},t.prototype._update=function(){this.setRenderList(this._renderList)},t.prototype.setRenderList=function(e){this._renderTexture.renderList=e},t.prototype.getRenderTexture=function(){return this._renderTexture},t}();e.PostProcessRenderPass=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(e,t,i,r){this._engine=e,this._name=t,this._singleInstance=r||!0,this._getPostProcess=i,this._cameras=[],this._indicesForCamera=[],this._postProcesses={},this._renderPasses={},this._renderEffectAsPasses={}}return Object.defineProperty(t.prototype,"isSupported",{get:function(){for(var e in this._postProcesses)if(!this._postProcesses[e].isSupported)return!1;return!0},enumerable:!0,configurable:!0}),t.prototype._update=function(){for(var e in this._renderPasses)this._renderPasses[e]._update()},t.prototype.addPass=function(e){this._renderPasses[e._name]=e,this._linkParameters()},t.prototype.removePass=function(e){delete this._renderPasses[e._name],this._linkParameters()},t.prototype.addRenderEffectAsPass=function(e){this._renderEffectAsPasses[e._name]=e,this._linkParameters()},t.prototype.getPass=function(e){for(var t in this._renderPasses)if(t===e)return this._renderPasses[e]},t.prototype.emptyPasses=function(){this._renderPasses={},this._linkParameters()},t.prototype._attachCameras=function(t){for(var i,r=e.Tools.MakeArray(t||this._cameras),n=0;n<r.length;n++){var o=r[n],s=o.name;i=this._singleInstance?0:s,this._postProcesses[i]=this._postProcesses[i]||this._getPostProcess();var a=o.attachPostProcess(this._postProcesses[i]);this._indicesForCamera[s]||(this._indicesForCamera[s]=[]),this._indicesForCamera[s].push(a),-1===this._cameras.indexOf(o)&&(this._cameras[s]=o);for(var h in this._renderPasses)this._renderPasses[h]._incRefCount()}this._linkParameters()},t.prototype._detachCameras=function(t){for(var i=e.Tools.MakeArray(t||this._cameras),r=0;r<i.length;r++){var n=i[r],o=n.name;n.detachPostProcess(this._postProcesses[this._singleInstance?0:o],this._indicesForCamera[o]);var s=this._cameras.indexOf(o);this._indicesForCamera.splice(s,1),this._cameras.splice(s,1);for(var a in this._renderPasses)this._renderPasses[a]._decRefCount()}},t.prototype._enable=function(t){for(var i=e.Tools.MakeArray(t||this._cameras),r=0;r<i.length;r++){for(var n=i[r],o=n.name,s=0;s<this._indicesForCamera[o].length;s++)void 0===n._postProcesses[this._indicesForCamera[o][s]]&&t[r].attachPostProcess(this._postProcesses[this._singleInstance?0:o],this._indicesForCamera[o][s]);for(var a in this._renderPasses)this._renderPasses[a]._incRefCount()}},t.prototype._disable=function(t){for(var i=e.Tools.MakeArray(t||this._cameras),r=0;r<i.length;r++){var n=i[r],o=n.Name;n.detachPostProcess(this._postProcesses[this._singleInstance?0:o],this._indicesForCamera[o]);for(var s in this._renderPasses)this._renderPasses[s]._decRefCount()}},t.prototype.getPostProcess=function(e){return this._singleInstance?this._postProcesses[0]:this._postProcesses[e.name]},t.prototype._linkParameters=function(){var e=this;for(var t in this._postProcesses)this.applyParameters&&this.applyParameters(this._postProcesses[t]),this._postProcesses[t].onBeforeRenderObservable.add(function(t){e._linkTextures(t)})},t.prototype._linkTextures=function(e){for(var t in this._renderPasses)e.setTexture(t,this._renderPasses[t].getRenderTexture());for(var i in this._renderEffectAsPasses)e.setTextureFromPostProcess(i+"Sampler",this._renderEffectAsPasses[i].getPostProcess())},t}();e.PostProcessRenderEffect=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(e,t){this._engine=e,this._name=t,this._renderEffects={},this._renderEffectsForIsolatedPass={},this._cameras=[]}return Object.defineProperty(t.prototype,"isSupported",{get:function(){for(var e in this._renderEffects)if(!this._renderEffects[e].isSupported)return!1;return!0},enumerable:!0,configurable:!0}),t.prototype.addEffect=function(e){this._renderEffects[e._name]=e},t.prototype._enableEffect=function(t,i){var r=this._renderEffects[t];r&&r._enable(e.Tools.MakeArray(i||this._cameras))},t.prototype._disableEffect=function(t,i){var r=this._renderEffects[t];r&&r._disable(e.Tools.MakeArray(i||this._cameras))},t.prototype._attachCameras=function(t,i){var r,n=e.Tools.MakeArray(t||this._cameras),o=[];for(r=0;r<n.length;r++){var s=n[r],a=s.name;-1===this._cameras.indexOf(s)?this._cameras[a]=s:i&&o.push(r)}for(r=0;r<o.length;r++)t.splice(o[r],1);for(var h in this._renderEffects)this._renderEffects[h]._attachCameras(n)},t.prototype._detachCameras=function(t){var i=e.Tools.MakeArray(t||this._cameras);for(var r in this._renderEffects)this._renderEffects[r]._detachCameras(i);for(var n=0;n<i.length;n++)this._cameras.splice(this._cameras.indexOf(i[n]),1)},t.prototype._enableDisplayOnlyPass=function(i,r){var n,o=this,s=e.Tools.MakeArray(r||this._cameras),a=null;for(n in this._renderEffects)if(a=this._renderEffects[n].getPass(i),null!=a)break;if(null!==a){for(n in this._renderEffects)this._renderEffects[n]._disable(s);a._name=t.PASS_SAMPLER_NAME;for(var h=0;h<s.length;h++){var c=s[h],l=c.name;this._renderEffectsForIsolatedPass[l]=this._renderEffectsForIsolatedPass[l]||new e.PostProcessRenderEffect(this._engine,t.PASS_EFFECT_NAME,function(){return new e.DisplayPassPostProcess(t.PASS_EFFECT_NAME,1,null,null,o._engine,!0)}),this._renderEffectsForIsolatedPass[l].emptyPasses(),this._renderEffectsForIsolatedPass[l].addPass(a),this._renderEffectsForIsolatedPass[l]._attachCameras(c)}}},t.prototype._disableDisplayOnlyPass=function(i){for(var r=this,n=e.Tools.MakeArray(i||this._cameras),o=0;o<n.length;o++){var s=n[o],a=s.name;this._renderEffectsForIsolatedPass[a]=this._renderEffectsForIsolatedPass[a]||new e.PostProcessRenderEffect(this._engine,t.PASS_EFFECT_NAME,function(){return new e.DisplayPassPostProcess(t.PASS_EFFECT_NAME,1,null,null,r._engine,!0)}),this._renderEffectsForIsolatedPass[a]._disable(s)}for(var h in this._renderEffects)this._renderEffects[h]._enable(n)},t.prototype._update=function(){for(var e in this._renderEffects)this._renderEffects[e]._update();for(var t=0;t<this._cameras.length;t++){var i=this._cameras[t].name;this._renderEffectsForIsolatedPass[i]&&this._renderEffectsForIsolatedPass[i]._update()}},t.prototype.dispose=function(){},t.PASS_EFFECT_NAME="passEffect",t.PASS_SAMPLER_NAME="passSampler",t}();e.PostProcessRenderPipeline=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function e(){this._renderPipelines={}}return e.prototype.addPipeline=function(e){this._renderPipelines[e._name]=e},e.prototype.attachCamerasToRenderPipeline=function(e,t,i){var r=this._renderPipelines[e];r&&r._attachCameras(t,i)},e.prototype.detachCamerasFromRenderPipeline=function(e,t){var i=this._renderPipelines[e];i&&i._detachCameras(t)},e.prototype.enableEffectInPipeline=function(e,t,i){var r=this._renderPipelines[e];r&&r._enableEffect(t,i)},e.prototype.disableEffectInPipeline=function(e,t,i){var r=this._renderPipelines[e];r&&r._disableEffect(t,i)},e.prototype.enableDisplayOnlyPassInPipeline=function(e,t,i){var r=this._renderPipelines[e];r&&r._enableDisplayOnlyPass(t,i)},e.prototype.disableDisplayOnlyPassInPipeline=function(e,t){var i=this._renderPipelines[e];i&&i._disableDisplayOnlyPass(t)},e.prototype.update=function(){for(var e in this._renderPipelines){var t=this._renderPipelines[e];t.isSupported?t._update():(t.dispose(),delete this._renderPipelines[e])}},e}();e.PostProcessRenderPipelineManager=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(t){this.frontColor=new e.Color3(1,1,1),this.backColor=new e.Color3(.1,.1,.1),this.showBackLines=!0,this.renderList=new e.SmartArray(32),this._vertexBuffers={},this._scene=t}return t.prototype._prepareRessources=function(){if(!this._colorShader){this._colorShader=new e.ShaderMaterial("colorShader",this._scene,"color",{attributes:[e.VertexBuffer.PositionKind],uniforms:["worldViewProjection","color"]});var t=this._scene.getEngine(),i=e.VertexData.CreateBox(1);this._vertexBuffers[e.VertexBuffer.PositionKind]=new e.VertexBuffer(t,i.positions,e.VertexBuffer.PositionKind,!1),this._indexBuffer=t.createIndexBuffer([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,7,1,6,2,5,3,4])}},t.prototype.reset=function(){this.renderList.reset()},t.prototype.render=function(){if(0!==this.renderList.length&&(this._prepareRessources(),this._colorShader.isReady())){var t=this._scene.getEngine();t.setDepthWrite(!1),this._colorShader._preBind();for(var i=0;i<this.renderList.length;i++){var r=this.renderList.data[i],n=r.minimum,o=r.maximum,s=o.subtract(n),a=n.add(s.scale(.5)),h=e.Matrix.Scaling(s.x,s.y,s.z).multiply(e.Matrix.Translation(a.x,a.y,a.z)).multiply(r.getWorldMatrix());t.bindBuffers(this._vertexBuffers,this._indexBuffer,this._colorShader.getEffect()),this.showBackLines&&(t.setDepthFunctionToGreaterOrEqual(),this._scene.resetCachedMaterial(),this._colorShader.setColor4("color",this.backColor.toColor4()),this._colorShader.bind(h),t.draw(!1,0,24)),t.setDepthFunctionToLess(),this._scene.resetCachedMaterial(),this._colorShader.setColor4("color",this.frontColor.toColor4()),this._colorShader.bind(h),t.draw(!1,0,24)}this._colorShader.unbind(),t.setDepthFunctionToLessOrEqual(),t.setDepthWrite(!0)}},t.prototype.dispose=function(){if(this._colorShader){this._colorShader.dispose();var t=this._vertexBuffers[e.VertexBuffer.PositionKind];t&&(t.dispose(),this._vertexBuffers[e.VertexBuffer.PositionKind]=null),this._scene.getEngine()._releaseBuffer(this._indexBuffer)}},t}();e.BoundingBoxRenderer=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function e(e){this._actionManager=e}return e.prototype.isValid=function(){return!0},e.prototype._getProperty=function(e){return this._actionManager._getProperty(e)},e.prototype._getEffectiveTarget=function(e,t){return this._actionManager._getEffectiveTarget(e,t)},e.prototype.serialize=function(){},e.prototype._serialize=function(e){return{type:2,children:[],name:e.name,properties:e.properties}},e}();e.Condition=t;var i=function(t){function i(e,r,n,o,s){void 0===s&&(s=i.IsEqual),t.call(this,e),this.propertyPath=n,this.value=o,this.operator=s,this._target=r,this._effectiveTarget=this._getEffectiveTarget(r,this.propertyPath),this._property=this._getProperty(this.propertyPath)}return __extends(i,t),Object.defineProperty(i,"IsEqual",{get:function(){return i._IsEqual},enumerable:!0,configurable:!0}),Object.defineProperty(i,"IsDifferent",{get:function(){return i._IsDifferent},enumerable:!0,configurable:!0}),Object.defineProperty(i,"IsGreater",{get:function(){return i._IsGreater},enumerable:!0,configurable:!0}),Object.defineProperty(i,"IsLesser",{get:function(){return i._IsLesser},enumerable:!0,configurable:!0}),i.prototype.isValid=function(){switch(this.operator){case i.IsGreater:return this._effectiveTarget[this._property]>this.value;case i.IsLesser:return this._effectiveTarget[this._property]<this.value;case i.IsEqual:case i.IsDifferent:var e;return e=this.value.equals?this.value.equals(this._effectiveTarget[this._property]):this.value===this._effectiveTarget[this._property],this.operator===i.IsEqual?e:!e}return!1},i.prototype.serialize=function(){return this._serialize({name:"ValueCondition",properties:[e.Action._GetTargetProperty(this._target),{name:"propertyPath",value:this.propertyPath},{name:"value",value:e.Action._SerializeValueAsString(this.value)},{name:"operator",value:i.GetOperatorName(this.operator)}]})},i.GetOperatorName=function(e){switch(e){case i._IsEqual:return"IsEqual";case i._IsDifferent:return"IsDifferent";case i._IsGreater:return"IsGreater";case i._IsLesser:return"IsLesser";default:return""}},i._IsEqual=0,i._IsDifferent=1,i._IsGreater=2,i._IsLesser=3,i}(t);e.ValueCondition=i;var r=function(e){function t(t,i){e.call(this,t),this.predicate=i}return __extends(t,e),t.prototype.isValid=function(){return this.predicate()},t}(t);e.PredicateCondition=r;var n=function(t){function i(e,i,r){t.call(this,e),this.value=r,this._target=i}return __extends(i,t),i.prototype.isValid=function(){return this._target.state===this.value},i.prototype.serialize=function(){return this._serialize({name:"StateCondition",properties:[e.Action._GetTargetProperty(this._target),{name:"value",value:this.value}]})},i}(t);e.StateCondition=n}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(e,t){this.triggerOptions=e,e.parameter?(this.trigger=e.trigger,this._triggerParameter=e.parameter):this.trigger=e,this._nextActiveAction=this,this._condition=t}return t.prototype._prepare=function(){},t.prototype.getTriggerParameter=function(){return this._triggerParameter},t.prototype._executeCurrent=function(e){if(this._nextActiveAction._condition){var t=this._nextActiveAction._condition,i=this._actionManager.getScene().getRenderId();if(t._evaluationId===i){if(!t._currentResult)return}else{if(t._evaluationId=i,!t.isValid())return void(t._currentResult=!1);t._currentResult=!0}}this._nextActiveAction.execute(e),this.skipToNextActiveAction()},t.prototype.execute=function(e){},t.prototype.skipToNextActiveAction=function(){this._nextActiveAction._child?(this._nextActiveAction._child._actionManager||(this._nextActiveAction._child._actionManager=this._actionManager),this._nextActiveAction=this._nextActiveAction._child):this._nextActiveAction=this},t.prototype.then=function(e){return this._child=e,e._actionManager=this._actionManager,e._prepare(),e},t.prototype._getProperty=function(e){return this._actionManager._getProperty(e)},t.prototype._getEffectiveTarget=function(e,t){return this._actionManager._getEffectiveTarget(e,t)},t.prototype.serialize=function(e){},t.prototype._serialize=function(e,t){var i={type:1,children:[],name:e.name,properties:e.properties||[]};if(this._child&&this._child.serialize(i),this._condition){var r=this._condition.serialize();return r.children.push(i),t&&t.children.push(r),r}return t&&t.children.push(i),i},t._SerializeValueAsString=function(t){return"number"==typeof t?t.toString():"boolean"==typeof t?t?"true":"false":t instanceof e.Vector2?t.x+", "+t.y:t instanceof e.Vector3?t.x+", "+t.y+", "+t.z:t instanceof e.Color3?t.r+", "+t.g+", "+t.b:t instanceof e.Color4?t.r+", "+t.g+", "+t.b+", "+t.a:t},t._GetTargetProperty=function(t){return{name:"target",targetType:t instanceof e.Mesh?"MeshProperties":t instanceof e.Light?"LightProperties":t instanceof e.Camera?"CameraProperties":"SceneProperties",value:t instanceof e.Scene?"Scene":t.name}},t}();e.Action=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function e(e,t,i,r,n,o){this.source=e,this.pointerX=t,this.pointerY=i,this.meshUnderPointer=r,this.sourceEvent=n,this.additionalData=o}return e.CreateNew=function(t,i,r){var n=t.getScene();return new e(t,n.pointerX,n.pointerY,n.meshUnderPointer,i,r)},e.CreateNewFromSprite=function(t,i,r,n){return new e(t,i.pointerX,i.pointerY,i.meshUnderPointer,r,n)},e.CreateNewFromScene=function(t,i){return new e(null,t.pointerX,t.pointerY,t.meshUnderPointer,i)},e.CreateNewFromPrimitive=function(t,i,r,n){return new e(t,i.x,i.y,null,r,n)},e}();e.ActionEvent=t;var i=function(){function t(e){this.actions=new Array,this._scene=e,e._actionManagers.push(this)}return Object.defineProperty(t,"NothingTrigger",{get:function(){return t._NothingTrigger},enumerable:!0,configurable:!0}),Object.defineProperty(t,"OnPickTrigger",{get:function(){return t._OnPickTrigger},enumerable:!0,configurable:!0}),Object.defineProperty(t,"OnLeftPickTrigger",{get:function(){return t._OnLeftPickTrigger},enumerable:!0,configurable:!0}),Object.defineProperty(t,"OnRightPickTrigger",{get:function(){return t._OnRightPickTrigger},enumerable:!0,configurable:!0}),Object.defineProperty(t,"OnCenterPickTrigger",{get:function(){return t._OnCenterPickTrigger},enumerable:!0,configurable:!0}),Object.defineProperty(t,"OnPickDownTrigger",{get:function(){return t._OnPickDownTrigger},enumerable:!0,configurable:!0}),Object.defineProperty(t,"OnPickUpTrigger",{get:function(){return t._OnPickUpTrigger},enumerable:!0,configurable:!0}),Object.defineProperty(t,"OnPickOutTrigger",{get:function(){return t._OnPickOutTrigger},enumerable:!0,configurable:!0}),Object.defineProperty(t,"OnLongPressTrigger",{get:function(){return t._OnLongPressTrigger},enumerable:!0,configurable:!0}),Object.defineProperty(t,"OnPointerOverTrigger",{get:function(){return t._OnPointerOverTrigger},enumerable:!0,configurable:!0}),Object.defineProperty(t,"OnPointerOutTrigger",{get:function(){return t._OnPointerOutTrigger},enumerable:!0,configurable:!0}),Object.defineProperty(t,"OnEveryFrameTrigger",{get:function(){return t._OnEveryFrameTrigger},enumerable:!0,configurable:!0}),Object.defineProperty(t,"OnIntersectionEnterTrigger",{get:function(){return t._OnIntersectionEnterTrigger},enumerable:!0,configurable:!0}),Object.defineProperty(t,"OnIntersectionExitTrigger",{get:function(){return t._OnIntersectionExitTrigger},enumerable:!0,configurable:!0}),Object.defineProperty(t,"OnKeyDownTrigger",{get:function(){return t._OnKeyDownTrigger},enumerable:!0,configurable:!0}),Object.defineProperty(t,"OnKeyUpTrigger",{get:function(){return t._OnKeyUpTrigger},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){var e=this._scene._actionManagers.indexOf(this);e>-1&&this._scene._actionManagers.splice(e,1)},t.prototype.getScene=function(){return this._scene},t.prototype.hasSpecificTriggers=function(e){for(var t=0;t<this.actions.length;t++){var i=this.actions[t];if(e.indexOf(i.trigger)>-1)return!0}return!1},t.prototype.hasSpecificTrigger=function(e){for(var t=0;t<this.actions.length;t++){var i=this.actions[t];if(i.trigger===e)return!0}return!1},Object.defineProperty(t.prototype,"hasPointerTriggers",{get:function(){for(var e=0;e<this.actions.length;e++){var i=this.actions[e];if(i.trigger>=t._OnPickTrigger&&i.trigger<=t._OnPointerOutTrigger)return!0}return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasPickTriggers",{get:function(){for(var e=0;e<this.actions.length;e++){var i=this.actions[e];if(i.trigger>=t._OnPickTrigger&&i.trigger<=t._OnPickUpTrigger)return!0}return!1},enumerable:!0,configurable:!0}),t.prototype.registerAction=function(i){return i.trigger===t.OnEveryFrameTrigger&&this.getScene().actionManager!==this?(e.Tools.Warn("OnEveryFrameTrigger can only be used with scene.actionManager"),null):(this.actions.push(i),i._actionManager=this,i._prepare(),i)},t.prototype.processTrigger=function(e,i){for(var r=0;r<this.actions.length;r++){var n=this.actions[r];if(n.trigger===e){if(e===t.OnKeyUpTrigger||e===t.OnKeyDownTrigger){var o=n.getTriggerParameter();if(o){var s=i.sourceEvent.charCode?i.sourceEvent.charCode:i.sourceEvent.keyCode,a=String.fromCharCode(s).toLowerCase();if(a!==o.toLowerCase())continue}}n._executeCurrent(i)}}},t.prototype._getEffectiveTarget=function(e,t){for(var i=t.split("."),r=0;r<i.length-1;r++)e=e[i[r]];return e},t.prototype._getProperty=function(e){var t=e.split(".");return t[t.length-1]},t.prototype.serialize=function(i){for(var r={children:[],name:i,type:3,properties:[]},n=0;n<this.actions.length;n++){var o={type:0,children:[],name:t.GetTriggerName(this.actions[n].trigger),properties:[]},s=this.actions[n].triggerOptions;s&&"number"!=typeof s&&(s.parameter instanceof e.Node?o.properties.push(e.Action._GetTargetProperty(s.parameter)):o.properties.push({name:"parameter",targetType:null,value:s.parameter})),this.actions[n].serialize(o),r.children.push(o)}return r},t.Parse=function(i,r,n){var o=new e.ActionManager(n);null===r?n.actionManager=o:r.actionManager=o;for(var s=function(t,i){var r=Object.create(e[t].prototype);return r.constructor.apply(r,i),r},a=function(t,i,r,n){if(null===n){var o=parseFloat(i);return"true"===i||"false"===i?"true"===i:isNaN(o)?i:o}for(var s=n.split("."),a=i.split(","),h=0;h<s.length;h++)r=r[s[h]];if("boolean"==typeof r)return"true"===a[0];if("string"==typeof r)return a[0];for(var c=new Array,h=0;h<a.length;h++)c.push(parseFloat(a[h]));return r instanceof e.Vector3?e.Vector3.FromArray(c):r instanceof e.Vector4?e.Vector4.FromArray(c):r instanceof e.Color3?e.Color3.FromArray(c):r instanceof e.Color4?e.Color4.FromArray(c):parseFloat(a[0])},h=function(i,r,c,l,u){if(void 0===u&&(u=null),!i.detached){var f=new Array,d=null,p=null,_=i.combine&&i.combine.length>0;if(2===i.type?f.push(o):f.push(r),_){for(var m=new Array,g=0;g<i.combine.length;g++)h(i.combine[g],t.NothingTrigger,c,l,m);f.push(m)}else for(var v=0;v<i.properties.length;v++){var y=i.properties[v].value,x=i.properties[v].name,b=i.properties[v].targetType;"target"===x?y=d=null!==b&&"SceneProperties"===b?n:n.getNodeByName(y):"parent"===x?y=n.getNodeByName(y):"sound"===x?y=n.getSoundByName(y):"propertyPath"!==x?y=2===i.type&&"operator"===x?e.ValueCondition[y]:a(x,y,d,"value"===x?p:null):p=y,f.push(y)}if(null===u?f.push(c):f.push(null),"InterpolateValueAction"===i.name){var P=f[f.length-2];f[f.length-1]=P,f[f.length-2]=c}var A=s(i.name,f);if(A instanceof e.Condition&&null!==c){var T=new e.DoNothingAction(r,c);l?l.then(T):o.registerAction(T),l=T}null===u?A instanceof e.Condition?(c=A,A=l):(c=null,l?l.then(A):o.registerAction(A)):u.push(A);for(var v=0;v<i.children.length;v++)h(i.children[v],r,c,A,null);
}},c=0;c<i.children.length;c++){var l,u=i.children[c];if(u.properties.length>0){var f=u.properties[0].value,d=null===u.properties[0].targetType?f:n.getMeshByName(f);l={trigger:e.ActionManager[u.name],parameter:d}}else l=e.ActionManager[u.name];for(var p=0;p<u.children.length;p++)u.detached||h(u.children[p],l,null,null)}},t.GetTriggerName=function(e){switch(e){case 0:return"NothingTrigger";case 1:return"OnPickTrigger";case 2:return"OnLeftPickTrigger";case 3:return"OnRightPickTrigger";case 4:return"OnCenterPickTrigger";case 5:return"OnPickDownTrigger";case 6:return"OnPickUpTrigger";case 7:return"OnLongPressTrigger";case 8:return"OnPointerOverTrigger";case 9:return"OnPointerOutTrigger";case 10:return"OnEveryFrameTrigger";case 11:return"OnIntersectionEnterTrigger";case 12:return"OnIntersectionExitTrigger";case 13:return"OnKeyDownTrigger";case 14:return"OnKeyUpTrigger";case 15:return"OnPickOutTrigger";default:return""}},t._NothingTrigger=0,t._OnPickTrigger=1,t._OnLeftPickTrigger=2,t._OnRightPickTrigger=3,t._OnCenterPickTrigger=4,t._OnPickDownTrigger=5,t._OnPickUpTrigger=6,t._OnLongPressTrigger=7,t._OnPointerOverTrigger=8,t._OnPointerOutTrigger=9,t._OnEveryFrameTrigger=10,t._OnIntersectionEnterTrigger=11,t._OnIntersectionExitTrigger=12,t._OnKeyDownTrigger=13,t._OnKeyUpTrigger=14,t._OnPickOutTrigger=15,t.DragMovementThreshold=10,t.LongPressDelay=500,t}();e.ActionManager=i}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(e,i,r,n,o,s,a,h){void 0===o&&(o=1e3),t.call(this,e,s),this.propertyPath=r,this.value=n,this.duration=o,this.stopOtherAnimations=a,this.onInterpolationDone=h,this._target=this._effectiveTarget=i}return __extends(i,t),i.prototype._prepare=function(){this._effectiveTarget=this._getEffectiveTarget(this._effectiveTarget,this.propertyPath),this._property=this._getProperty(this.propertyPath)},i.prototype.execute=function(){var t,i=this._actionManager.getScene(),r=[{frame:0,value:this._effectiveTarget[this._property]},{frame:100,value:this.value}];if("number"==typeof this.value)t=e.Animation.ANIMATIONTYPE_FLOAT;else if(this.value instanceof e.Color3)t=e.Animation.ANIMATIONTYPE_COLOR3;else if(this.value instanceof e.Vector3)t=e.Animation.ANIMATIONTYPE_VECTOR3;else if(this.value instanceof e.Matrix)t=e.Animation.ANIMATIONTYPE_MATRIX;else{if(!(this.value instanceof e.Quaternion))return void e.Tools.Warn("InterpolateValueAction: Unsupported type ("+typeof this.value+")");t=e.Animation.ANIMATIONTYPE_QUATERNION}var n=new e.Animation("InterpolateValueAction",this._property,100*(1e3/this.duration),t,e.Animation.ANIMATIONLOOPMODE_CONSTANT);n.setKeys(r),this.stopOtherAnimations&&i.stopAnimation(this._effectiveTarget),i.beginDirectAnimation(this._effectiveTarget,[n],0,100,!1,1,this.onInterpolationDone)},i.prototype.serialize=function(i){return t.prototype._serialize.call(this,{name:"InterpolateValueAction",properties:[e.Action._GetTargetProperty(this._target),{name:"propertyPath",value:this.propertyPath},{name:"value",value:e.Action._SerializeValueAsString(this.value)},{name:"duration",value:e.Action._SerializeValueAsString(this.duration)},{name:"stopOtherAnimations",value:e.Action._SerializeValueAsString(this.stopOtherAnimations)||!1}]},i)},i}(e.Action);e.InterpolateValueAction=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(e,i,r,n){t.call(this,e,n),this.propertyPath=r,this._target=this._effectiveTarget=i}return __extends(i,t),i.prototype._prepare=function(){this._effectiveTarget=this._getEffectiveTarget(this._effectiveTarget,this.propertyPath),this._property=this._getProperty(this.propertyPath)},i.prototype.execute=function(){this._effectiveTarget[this._property]=!this._effectiveTarget[this._property]},i.prototype.serialize=function(i){return t.prototype._serialize.call(this,{name:"SwitchBooleanAction",properties:[e.Action._GetTargetProperty(this._target),{name:"propertyPath",value:this.propertyPath}]},i)},i}(e.Action);e.SwitchBooleanAction=t;var i=function(t){function i(e,i,r,n){t.call(this,e,n),this.value=r,this._target=i}return __extends(i,t),i.prototype.execute=function(){this._target.state=this.value},i.prototype.serialize=function(i){return t.prototype._serialize.call(this,{name:"SetStateAction",properties:[e.Action._GetTargetProperty(this._target),{name:"value",value:this.value}]},i)},i}(e.Action);e.SetStateAction=i;var r=function(t){function i(e,i,r,n,o){t.call(this,e,o),this.propertyPath=r,this.value=n,this._target=this._effectiveTarget=i}return __extends(i,t),i.prototype._prepare=function(){this._effectiveTarget=this._getEffectiveTarget(this._effectiveTarget,this.propertyPath),this._property=this._getProperty(this.propertyPath)},i.prototype.execute=function(){this._effectiveTarget[this._property]=this.value,this._target.markAsDirty&&this._target.markAsDirty(this._property)},i.prototype.serialize=function(i){return t.prototype._serialize.call(this,{name:"SetValueAction",properties:[e.Action._GetTargetProperty(this._target),{name:"propertyPath",value:this.propertyPath},{name:"value",value:e.Action._SerializeValueAsString(this.value)}]},i)},i}(e.Action);e.SetValueAction=r;var n=function(t){function i(e,i,r,n,o){t.call(this,e,o),this.propertyPath=r,this.value=n,this._target=this._effectiveTarget=i}return __extends(i,t),i.prototype._prepare=function(){this._effectiveTarget=this._getEffectiveTarget(this._effectiveTarget,this.propertyPath),this._property=this._getProperty(this.propertyPath),"number"!=typeof this._effectiveTarget[this._property]&&e.Tools.Warn("Warning: IncrementValueAction can only be used with number values")},i.prototype.execute=function(){this._effectiveTarget[this._property]+=this.value,this._target.markAsDirty&&this._target.markAsDirty(this._property)},i.prototype.serialize=function(i){return t.prototype._serialize.call(this,{name:"IncrementValueAction",properties:[e.Action._GetTargetProperty(this._target),{name:"propertyPath",value:this.propertyPath},{name:"value",value:e.Action._SerializeValueAsString(this.value)}]},i)},i}(e.Action);e.IncrementValueAction=n;var o=function(t){function i(e,i,r,n,o,s){t.call(this,e,s),this.from=r,this.to=n,this.loop=o,this._target=i}return __extends(i,t),i.prototype._prepare=function(){},i.prototype.execute=function(){var e=this._actionManager.getScene();e.beginAnimation(this._target,this.from,this.to,this.loop)},i.prototype.serialize=function(i){return t.prototype._serialize.call(this,{name:"PlayAnimationAction",properties:[e.Action._GetTargetProperty(this._target),{name:"from",value:String(this.from)},{name:"to",value:String(this.to)},{name:"loop",value:e.Action._SerializeValueAsString(this.loop)||!1}]},i)},i}(e.Action);e.PlayAnimationAction=o;var s=function(t){function i(e,i,r){t.call(this,e,r),this._target=i}return __extends(i,t),i.prototype._prepare=function(){},i.prototype.execute=function(){var e=this._actionManager.getScene();e.stopAnimation(this._target)},i.prototype.serialize=function(i){return t.prototype._serialize.call(this,{name:"StopAnimationAction",properties:[e.Action._GetTargetProperty(this._target)]},i)},i}(e.Action);e.StopAnimationAction=s;var a=function(t){function i(i,r){void 0===i&&(i=e.ActionManager.NothingTrigger),t.call(this,i,r)}return __extends(i,t),i.prototype.execute=function(){},i.prototype.serialize=function(e){return t.prototype._serialize.call(this,{name:"DoNothingAction",properties:[]},e)},i}(e.Action);e.DoNothingAction=a;var h=function(e){function t(t,i,r){e.call(this,t,r),this.children=i}return __extends(t,e),t.prototype._prepare=function(){for(var e=0;e<this.children.length;e++)this.children[e]._actionManager=this._actionManager,this.children[e]._prepare()},t.prototype.execute=function(e){for(var t=0;t<this.children.length;t++)this.children[t].execute(e)},t.prototype.serialize=function(t){for(var i=e.prototype._serialize.call(this,{name:"CombineAction",properties:[],combine:[]},t),r=0;r<this.children.length;r++)i.combine.push(this.children[r].serialize(null));return i},t}(e.Action);e.CombineAction=h;var c=function(e){function t(t,i,r){e.call(this,t,r),this.func=i}return __extends(t,e),t.prototype.execute=function(e){this.func(e)},t}(e.Action);e.ExecuteCodeAction=c;var l=function(t){function i(e,i,r,n){t.call(this,e,n),this._target=i,this._parent=r}return __extends(i,t),i.prototype._prepare=function(){},i.prototype.execute=function(){if(this._target.parent!==this._parent){var t=this._parent.getWorldMatrix().clone();t.invert(),this._target.position=e.Vector3.TransformCoordinates(this._target.position,t),this._target.parent=this._parent}},i.prototype.serialize=function(i){return t.prototype._serialize.call(this,{name:"SetParentAction",properties:[e.Action._GetTargetProperty(this._target),e.Action._GetTargetProperty(this._parent)]},i)},i}(e.Action);e.SetParentAction=l;var u=function(e){function t(t,i,r){e.call(this,t,r),this._sound=i}return __extends(t,e),t.prototype._prepare=function(){},t.prototype.execute=function(){void 0!==this._sound&&this._sound.play()},t.prototype.serialize=function(t){return e.prototype._serialize.call(this,{name:"PlaySoundAction",properties:[{name:"sound",value:this._sound.name}]},t)},t}(e.Action);e.PlaySoundAction=u;var f=function(e){function t(t,i,r){e.call(this,t,r),this._sound=i}return __extends(t,e),t.prototype._prepare=function(){},t.prototype.execute=function(){void 0!==this._sound&&this._sound.stop()},t.prototype.serialize=function(t){return e.prototype._serialize.call(this,{name:"StopSoundAction",properties:[{name:"sound",value:this._sound.name}]},t)},t}(e.Action);e.StopSoundAction=f}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(t,i,r,n,o){this.delayLoadState=e.Engine.DELAYLOADSTATE_NONE,this._totalVertices=0,this._isDisposed=!1,this.id=t,this._engine=i.getEngine(),this._meshes=[],this._scene=i,this._vertexBuffers={},this._indices=[],r?this.setAllVerticesData(r,n):(this._totalVertices=0,this._indices=[]),o&&(o instanceof e.LinesMesh&&(this.boundingBias=new e.Vector2(0,o.intersectionThreshold),this.updateExtend()),this.applyToMesh(o),o.computeWorldMatrix(!0))}return Object.defineProperty(t.prototype,"boundingBias",{get:function(){return this._boundingBias},set:function(e){this._boundingBias&&this._boundingBias.equals(e)||(this._boundingBias=e.clone(),this.updateBoundingInfo(!0,null))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"extend",{get:function(){return this._extend},enumerable:!0,configurable:!0}),t.prototype.getScene=function(){return this._scene},t.prototype.getEngine=function(){return this._engine},t.prototype.isReady=function(){return this.delayLoadState===e.Engine.DELAYLOADSTATE_LOADED||this.delayLoadState===e.Engine.DELAYLOADSTATE_NONE},t.prototype.setAllVerticesData=function(e,t){e.applyToGeometry(this,t),this.notifyUpdate()},t.prototype.setVerticesData=function(t,i,r,n){var o=new e.VertexBuffer(this._engine,i,t,r,0===this._meshes.length,n);this.setVerticesBuffer(o)},t.prototype.setVerticesBuffer=function(t){var i=t.getKind();if(this._vertexBuffers[i]&&this._vertexBuffers[i].dispose(),this._vertexBuffers[i]=t,i===e.VertexBuffer.PositionKind){var r=t.getData(),n=t.getStrideSize();this._totalVertices=r.length/n,this.updateExtend(r,n);for(var o=this._meshes,s=o.length,a=0;s>a;a++){var h=o[a];h._resetPointsArrayCache(),h._boundingInfo=new e.BoundingInfo(this._extend.minimum,this._extend.maximum),h._createGlobalSubMesh(),h.computeWorldMatrix(!0)}}this.notifyUpdate(i)},t.prototype.updateVerticesDataDirectly=function(e,t,i){var r=this.getVertexBuffer(e);r&&(r.updateDirectly(t,i),this.notifyUpdate(e))},t.prototype.updateVerticesData=function(t,i,r){var n=this.getVertexBuffer(t);if(n){if(n.update(i),t===e.VertexBuffer.PositionKind){var o=n.getStrideSize();this._totalVertices=i.length/o,this.updateBoundingInfo(r,i)}this.notifyUpdate(t)}},t.prototype.updateBoundingInfo=function(t,i){t&&this.updateExtend(i);for(var r=this._meshes,n=r.length,o=0;n>o;o++){var s=r[o];if(s._resetPointsArrayCache(),t){s._boundingInfo=new e.BoundingInfo(this._extend.minimum,this._extend.maximum);for(var a=0;a<s.subMeshes.length;a++){var h=s.subMeshes[a];h.refreshBoundingInfo()}}}},t.prototype.getTotalVertices=function(){return this.isReady()?this._totalVertices:0},t.prototype.getVerticesData=function(e,t){var i=this.getVertexBuffer(e);if(!i)return null;var r=i.getData();if(t&&1!==this._meshes.length){for(var n=r.length,o=[],s=0;n>s;s++)o.push(r[s]);return o}return r},t.prototype.getVertexBuffer=function(e){return this.isReady()?this._vertexBuffers[e]:null},t.prototype.getVertexBuffers=function(){return this.isReady()?this._vertexBuffers:null},t.prototype.isVerticesDataPresent=function(e){return this._vertexBuffers?void 0!==this._vertexBuffers[e]:this._delayInfo?-1!==this._delayInfo.indexOf(e):!1},t.prototype.getVerticesDataKinds=function(){var e,t=[];if(!this._vertexBuffers&&this._delayInfo)for(e in this._delayInfo)t.push(e);else for(e in this._vertexBuffers)t.push(e);return t},t.prototype.setIndices=function(e,t){this._indexBuffer&&this._engine._releaseBuffer(this._indexBuffer),this._indices=e,0!==this._meshes.length&&this._indices&&(this._indexBuffer=this._engine.createIndexBuffer(this._indices)),void 0!==t&&(this._totalVertices=t);for(var i=this._meshes,r=i.length,n=0;r>n;n++)i[n]._createGlobalSubMesh();this.notifyUpdate()},t.prototype.getTotalIndices=function(){return this.isReady()?this._indices.length:0},t.prototype.getIndices=function(e){if(!this.isReady())return null;var t=this._indices;if(e&&1!==this._meshes.length){for(var i=t.length,r=[],n=0;i>n;n++)r.push(t[n]);return r}return t},t.prototype.getIndexBuffer=function(){return this.isReady()?this._indexBuffer:null},t.prototype.releaseForMesh=function(e,t){var i=this._meshes,r=i.indexOf(e);if(-1!==r){for(var n in this._vertexBuffers)this._vertexBuffers[n].dispose();this._indexBuffer&&this._engine._releaseBuffer(this._indexBuffer)&&(this._indexBuffer=null),i.splice(r,1),e._geometry=null,0===i.length&&t&&this.dispose()}},t.prototype.applyToMesh=function(e){if(e._geometry!==this){var t=e._geometry;t&&t.releaseForMesh(e);var i=this._meshes;e._geometry=this,this._scene.pushGeometry(this),i.push(e),this.isReady()?this._applyToMesh(e):e._boundingInfo=this._boundingInfo}},t.prototype.updateExtend=function(t,i){void 0===t&&(t=null),t||(t=this._vertexBuffers[e.VertexBuffer.PositionKind].getData()),this._extend=e.Tools.ExtractMinAndMax(t,0,this._totalVertices,this.boundingBias,i)},t.prototype._applyToMesh=function(t){var i=this._meshes.length;for(var r in this._vertexBuffers)1===i&&this._vertexBuffers[r].create(),this._vertexBuffers[r].getBuffer().references=i,r===e.VertexBuffer.PositionKind&&(t._resetPointsArrayCache(),this._extend||this.updateExtend(this._vertexBuffers[r].getData()),t._boundingInfo=new e.BoundingInfo(this._extend.minimum,this._extend.maximum),t._createGlobalSubMesh(),t._updateBoundingInfo());1===i&&this._indices&&this._indices.length>0&&(this._indexBuffer=this._engine.createIndexBuffer(this._indices)),this._indexBuffer&&(this._indexBuffer.references=i)},t.prototype.notifyUpdate=function(e){this.onGeometryUpdated&&this.onGeometryUpdated(this,e)},t.prototype.load=function(t,i){var r=this;if(this.delayLoadState!==e.Engine.DELAYLOADSTATE_LOADING){if(this.isReady())return void(i&&i());this.delayLoadState=e.Engine.DELAYLOADSTATE_LOADING,t._addPendingData(this),e.Tools.LoadFile(this.delayLoadingFile,function(n){r._delayLoadingFunction(JSON.parse(n),r),r.delayLoadState=e.Engine.DELAYLOADSTATE_LOADED,r._delayInfo=[],t._removePendingData(r);for(var o=r._meshes,s=o.length,a=0;s>a;a++)r._applyToMesh(o[a]);i&&i()},function(){},t.database)}},t.prototype.toLeftHanded=function(){var t=this.getIndices(!1);if(null!=t&&t.length>0){for(var i=0;i<t.length;i+=3){var r=t[i+0];t[i+0]=t[i+2],t[i+2]=r}this.setIndices(t)}var n=this.getVerticesData(e.VertexBuffer.PositionKind,!1);if(null!=n&&n.length>0){for(var i=0;i<n.length;i+=3)n[i+2]=-n[i+2];this.setVerticesData(e.VertexBuffer.PositionKind,n,!1)}var o=this.getVerticesData(e.VertexBuffer.NormalKind,!1);if(null!=o&&o.length>0){for(var i=0;i<o.length;i+=3)o[i+2]=-o[i+2];this.setVerticesData(e.VertexBuffer.NormalKind,o,!1)}},t.prototype.isDisposed=function(){return this._isDisposed},t.prototype.dispose=function(){var t,i=this._meshes,r=i.length;for(t=0;r>t;t++)this.releaseForMesh(i[t]);this._meshes=[];for(var n in this._vertexBuffers)this._vertexBuffers[n].dispose();this._vertexBuffers={},this._totalVertices=0,this._indexBuffer&&this._engine._releaseBuffer(this._indexBuffer),this._indexBuffer=null,this._indices=[],this.delayLoadState=e.Engine.DELAYLOADSTATE_NONE,this.delayLoadingFile=null,this._delayLoadingFunction=null,this._delayInfo=[],this._boundingInfo=null,this._scene.removeGeometry(this),this._isDisposed=!0},t.prototype.copy=function(i){var r=new e.VertexData;r.indices=[];for(var n=this.getIndices(),o=0;o<n.length;o++)r.indices.push(n[o]);var s,a=!1,h=!1;for(s in this._vertexBuffers){var c=this.getVerticesData(s);c instanceof Float32Array?r.set(new Float32Array(c),s):r.set(c.slice(0),s),h||(a=this.getVertexBuffer(s).isUpdatable(),h=!a)}var l=new t(i,this._scene,r,a,null);l.delayLoadState=this.delayLoadState,l.delayLoadingFile=this.delayLoadingFile,l._delayLoadingFunction=this._delayLoadingFunction;for(s in this._delayInfo)l._delayInfo=l._delayInfo||[],l._delayInfo.push(s);return l._boundingInfo=new e.BoundingInfo(this._extend.minimum,this._extend.maximum),l},t.prototype.serialize=function(){var t={};return t.id=this.id,e.Tags.HasTags(this)&&(t.tags=e.Tags.GetTags(this)),t},t.prototype.serializeVerticeData=function(){var t=this.serialize();return this.isVerticesDataPresent(e.VertexBuffer.PositionKind)&&(t.positions=this.getVerticesData(e.VertexBuffer.PositionKind)),this.isVerticesDataPresent(e.VertexBuffer.NormalKind)&&(t.normals=this.getVerticesData(e.VertexBuffer.NormalKind)),this.isVerticesDataPresent(e.VertexBuffer.UVKind)&&(t.uvs=this.getVerticesData(e.VertexBuffer.UVKind)),this.isVerticesDataPresent(e.VertexBuffer.UV2Kind)&&(t.uvs2=this.getVerticesData(e.VertexBuffer.UV2Kind)),this.isVerticesDataPresent(e.VertexBuffer.UV3Kind)&&(t.uvs3=this.getVerticesData(e.VertexBuffer.UV3Kind)),this.isVerticesDataPresent(e.VertexBuffer.UV4Kind)&&(t.uvs4=this.getVerticesData(e.VertexBuffer.UV4Kind)),this.isVerticesDataPresent(e.VertexBuffer.UV5Kind)&&(t.uvs5=this.getVerticesData(e.VertexBuffer.UV5Kind)),this.isVerticesDataPresent(e.VertexBuffer.UV6Kind)&&(t.uvs6=this.getVerticesData(e.VertexBuffer.UV6Kind)),this.isVerticesDataPresent(e.VertexBuffer.ColorKind)&&(t.colors=this.getVerticesData(e.VertexBuffer.ColorKind)),this.isVerticesDataPresent(e.VertexBuffer.MatricesIndicesKind)&&(t.matricesIndices=this.getVerticesData(e.VertexBuffer.MatricesIndicesKind),t.matricesIndices._isExpanded=!0),this.isVerticesDataPresent(e.VertexBuffer.MatricesWeightsKind)&&(t.matricesWeights=this.getVerticesData(e.VertexBuffer.MatricesWeightsKind)),t.indices=this.getIndices(),t},t.ExtractFromMesh=function(e,t){var i=e._geometry;return i?i.copy(t):null},t.RandomId=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,i="x"===e?t:3&t|8;return i.toString(16)})},t.ImportGeometry=function(t,i){var r=i.getScene(),n=t.geometryId;if(n){var o=r.getGeometryByID(n);o&&o.applyToMesh(i)}else if(t instanceof ArrayBuffer){var s=i._binaryInfo;if(s.positionsAttrDesc&&s.positionsAttrDesc.count>0){var a=new Float32Array(t,s.positionsAttrDesc.offset,s.positionsAttrDesc.count);i.setVerticesData(e.VertexBuffer.PositionKind,a,!1)}if(s.normalsAttrDesc&&s.normalsAttrDesc.count>0){var h=new Float32Array(t,s.normalsAttrDesc.offset,s.normalsAttrDesc.count);i.setVerticesData(e.VertexBuffer.NormalKind,h,!1)}if(s.uvsAttrDesc&&s.uvsAttrDesc.count>0){var c=new Float32Array(t,s.uvsAttrDesc.offset,s.uvsAttrDesc.count);i.setVerticesData(e.VertexBuffer.UVKind,c,!1)}if(s.uvs2AttrDesc&&s.uvs2AttrDesc.count>0){var l=new Float32Array(t,s.uvs2AttrDesc.offset,s.uvs2AttrDesc.count);i.setVerticesData(e.VertexBuffer.UV2Kind,l,!1)}if(s.uvs3AttrDesc&&s.uvs3AttrDesc.count>0){var u=new Float32Array(t,s.uvs3AttrDesc.offset,s.uvs3AttrDesc.count);i.setVerticesData(e.VertexBuffer.UV3Kind,u,!1)}if(s.uvs4AttrDesc&&s.uvs4AttrDesc.count>0){var f=new Float32Array(t,s.uvs4AttrDesc.offset,s.uvs4AttrDesc.count);i.setVerticesData(e.VertexBuffer.UV4Kind,f,!1)}if(s.uvs5AttrDesc&&s.uvs5AttrDesc.count>0){var d=new Float32Array(t,s.uvs5AttrDesc.offset,s.uvs5AttrDesc.count);i.setVerticesData(e.VertexBuffer.UV5Kind,d,!1)}if(s.uvs6AttrDesc&&s.uvs6AttrDesc.count>0){var p=new Float32Array(t,s.uvs6AttrDesc.offset,s.uvs6AttrDesc.count);i.setVerticesData(e.VertexBuffer.UV6Kind,p,!1)}if(s.colorsAttrDesc&&s.colorsAttrDesc.count>0){var _=new Float32Array(t,s.colorsAttrDesc.offset,s.colorsAttrDesc.count);i.setVerticesData(e.VertexBuffer.ColorKind,_,!1,s.colorsAttrDesc.stride)}if(s.matricesIndicesAttrDesc&&s.matricesIndicesAttrDesc.count>0){var m=new Int32Array(t,s.matricesIndicesAttrDesc.offset,s.matricesIndicesAttrDesc.count);i.setVerticesData(e.VertexBuffer.MatricesIndicesKind,m,!1)}if(s.matricesWeightsAttrDesc&&s.matricesWeightsAttrDesc.count>0){var g=new Float32Array(t,s.matricesWeightsAttrDesc.offset,s.matricesWeightsAttrDesc.count);i.setVerticesData(e.VertexBuffer.MatricesWeightsKind,g,!1)}if(s.indicesAttrDesc&&s.indicesAttrDesc.count>0){var v=new Int32Array(t,s.indicesAttrDesc.offset,s.indicesAttrDesc.count);i.setIndices(v)}if(s.subMeshesAttrDesc&&s.subMeshesAttrDesc.count>0){var y=new Int32Array(t,s.subMeshesAttrDesc.offset,5*s.subMeshesAttrDesc.count);i.subMeshes=[];for(var x=0;x<s.subMeshesAttrDesc.count;x++){var b=y[5*x+0],P=y[5*x+1],A=y[5*x+2],T=y[5*x+3],E=y[5*x+4];new e.SubMesh(b,P,A,T,E,i)}}}else if(t.positions&&t.normals&&t.indices){if(i.setVerticesData(e.VertexBuffer.PositionKind,t.positions,!1),i.setVerticesData(e.VertexBuffer.NormalKind,t.normals,!1),t.uvs&&i.setVerticesData(e.VertexBuffer.UVKind,t.uvs,!1),t.uvs2&&i.setVerticesData(e.VertexBuffer.UV2Kind,t.uvs2,!1),t.uvs3&&i.setVerticesData(e.VertexBuffer.UV3Kind,t.uvs3,!1),t.uvs4&&i.setVerticesData(e.VertexBuffer.UV4Kind,t.uvs4,!1),t.uvs5&&i.setVerticesData(e.VertexBuffer.UV5Kind,t.uvs5,!1),t.uvs6&&i.setVerticesData(e.VertexBuffer.UV6Kind,t.uvs6,!1),t.colors&&i.setVerticesData(e.VertexBuffer.ColorKind,e.Color4.CheckColors4(t.colors,t.positions.length/3),!1),t.matricesIndices)if(t.matricesIndices._isExpanded)delete t.matricesIndices._isExpanded,i.setVerticesData(e.VertexBuffer.MatricesIndicesKind,t.matricesIndices,!1);else{for(var C=[],x=0;x<t.matricesIndices.length;x++){var S=t.matricesIndices[x];C.push(255&S),C.push((65280&S)>>8),C.push((16711680&S)>>16),C.push(S>>24)}i.setVerticesData(e.VertexBuffer.MatricesIndicesKind,C,!1)}if(t.matricesIndicesExtra)if(t.matricesIndicesExtra._isExpanded)delete t.matricesIndices._isExpanded,i.setVerticesData(e.VertexBuffer.MatricesIndicesExtraKind,t.matricesIndicesExtra,!1);else{for(var C=[],x=0;x<t.matricesIndicesExtra.length;x++){var S=t.matricesIndicesExtra[x];C.push(255&S),C.push((65280&S)>>8),C.push((16711680&S)>>16),C.push(S>>24)}i.setVerticesData(e.VertexBuffer.MatricesIndicesExtraKind,C,!1)}t.matricesWeights&&i.setVerticesData(e.VertexBuffer.MatricesWeightsKind,t.matricesWeights,!1),t.matricesWeightsExtra&&i.setVerticesData(e.VertexBuffer.MatricesWeightsExtraKind,t.matricesWeightsExtra,!1),i.setIndices(t.indices)}if(t.subMeshes){i.subMeshes=[];for(var M=0;M<t.subMeshes.length;M++){var I=t.subMeshes[M];new e.SubMesh(I.materialIndex,I.verticesStart,I.verticesCount,I.indexStart,I.indexCount,i)}}i._shouldGenerateFlatShading&&(i.convertToFlatShadedMesh(),delete i._shouldGenerateFlatShading),i.computeWorldMatrix(!0),r._selectionOctree&&r._selectionOctree.addMesh(i)},t.Parse=function(i,r,n){if(r.getGeometryByID(i.id))return null;var o=new t(i.id,r);return e.Tags.AddTagsTo(o,i.tags),i.delayLoadingFile?(o.delayLoadState=e.Engine.DELAYLOADSTATE_NOTLOADED,o.delayLoadingFile=n+i.delayLoadingFile,o._boundingInfo=new e.BoundingInfo(e.Vector3.FromArray(i.boundingBoxMinimum),e.Vector3.FromArray(i.boundingBoxMaximum)),o._delayInfo=[],i.hasUVs&&o._delayInfo.push(e.VertexBuffer.UVKind),i.hasUVs2&&o._delayInfo.push(e.VertexBuffer.UV2Kind),i.hasUVs3&&o._delayInfo.push(e.VertexBuffer.UV3Kind),i.hasUVs4&&o._delayInfo.push(e.VertexBuffer.UV4Kind),i.hasUVs5&&o._delayInfo.push(e.VertexBuffer.UV5Kind),i.hasUVs6&&o._delayInfo.push(e.VertexBuffer.UV6Kind),i.hasColors&&o._delayInfo.push(e.VertexBuffer.ColorKind),i.hasMatricesIndices&&o._delayInfo.push(e.VertexBuffer.MatricesIndicesKind),i.hasMatricesWeights&&o._delayInfo.push(e.VertexBuffer.MatricesWeightsKind),o._delayLoadingFunction=e.VertexData.ImportVertexData):e.VertexData.ImportVertexData(i,o),r.pushGeometry(o,!0),o},t}();e.Geometry=t;var t;!function(t){var i;!function(i){var r=function(e){function t(t,i,r,n){e.call(this,t,i,null,!1,n),this._canBeRegenerated=r,this._beingRegenerated=!0,this.regenerate(),this._beingRegenerated=!1}return __extends(t,e),t.prototype.canBeRegenerated=function(){return this._canBeRegenerated},t.prototype.regenerate=function(){this._canBeRegenerated&&(this._beingRegenerated=!0,this.setAllVerticesData(this._regenerateVertexData(),!1),this._beingRegenerated=!1)},t.prototype.asNewGeometry=function(t){return e.prototype.copy.call(this,t)},t.prototype.setAllVerticesData=function(t,i){this._beingRegenerated&&e.prototype.setAllVerticesData.call(this,t,!1)},t.prototype.setVerticesData=function(t,i,r){this._beingRegenerated&&e.prototype.setVerticesData.call(this,t,i,!1)},t.prototype._regenerateVertexData=function(){throw new Error("Abstract method")},t.prototype.copy=function(e){throw new Error("Must be overriden in sub-classes.")},t.prototype.serialize=function(){var t=e.prototype.serialize.call(this);return t.canBeRegenerated=this.canBeRegenerated(),t},t}(t);i._Primitive=r;var n=function(t){function i(i,r,n,o,s,a,h,c,l){void 0===l&&(l=e.Mesh.DEFAULTSIDE),t.call(this,i,r,h,c),this.pathArray=n,this.closeArray=o,this.closePath=s,this.offset=a,this.side=l}return __extends(i,t),i.prototype._regenerateVertexData=function(){return e.VertexData.CreateRibbon({pathArray:this.pathArray,closeArray:this.closeArray,closePath:this.closePath,offset:this.offset,sideOrientation:this.side})},i.prototype.copy=function(e){return new i(e,this.getScene(),this.pathArray,this.closeArray,this.closePath,this.offset,this.canBeRegenerated(),null,this.side)},i}(r);i.Ribbon=n;var o=function(i){function r(t,r,n,o,s,a){void 0===a&&(a=e.Mesh.DEFAULTSIDE),i.call(this,t,r,o,s),this.size=n,this.side=a}return __extends(r,i),r.prototype._regenerateVertexData=function(){return e.VertexData.CreateBox({size:this.size,sideOrientation:this.side})},r.prototype.copy=function(e){return new r(e,this.getScene(),this.size,this.canBeRegenerated(),null,this.side)},r.prototype.serialize=function(){var e=i.prototype.serialize.call(this);return e.size=this.size,e},r.Parse=function(i,r){if(r.getGeometryByID(i.id))return null;var n=new t.Primitives.Box(i.id,r,i.size,i.canBeRegenerated,null);return e.Tags.AddTagsTo(n,i.tags),r.pushGeometry(n,!0),n},r}(r);i.Box=o;var s=function(i){function r(t,r,n,o,s,a,h){void 0===h&&(h=e.Mesh.DEFAULTSIDE),i.call(this,t,r,s,a),this.segments=n,this.diameter=o,this.side=h}return __extends(r,i),r.prototype._regenerateVertexData=function(){return e.VertexData.CreateSphere({segments:this.segments,diameter:this.diameter,sideOrientation:this.side})},r.prototype.copy=function(e){return new r(e,this.getScene(),this.segments,this.diameter,this.canBeRegenerated(),null,this.side)},r.prototype.serialize=function(){var e=i.prototype.serialize.call(this);return e.segments=this.segments,e.diameter=this.diameter,e},r.Parse=function(i,r){if(r.getGeometryByID(i.id))return null;var n=new t.Primitives.Sphere(i.id,r,i.segments,i.diameter,i.canBeRegenerated,null);return e.Tags.AddTagsTo(n,i.tags),r.pushGeometry(n,!0),n},r}(r);i.Sphere=s;var a=function(t){function i(i,r,n,o,s,a,h){void 0===h&&(h=e.Mesh.DEFAULTSIDE),t.call(this,i,r,s,a),this.radius=n,this.tessellation=o,this.side=h}return __extends(i,t),i.prototype._regenerateVertexData=function(){return e.VertexData.CreateDisc({radius:this.radius,tessellation:this.tessellation,sideOrientation:this.side})},i.prototype.copy=function(e){return new i(e,this.getScene(),this.radius,this.tessellation,this.canBeRegenerated(),null,this.side)},i}(r);i.Disc=a;var h=function(i){function r(t,r,n,o,s,a,h,c,l,u){void 0===h&&(h=1),void 0===u&&(u=e.Mesh.DEFAULTSIDE),i.call(this,t,r,c,l),this.height=n,this.diameterTop=o,this.diameterBottom=s,this.tessellation=a,this.subdivisions=h,this.side=u}return __extends(r,i),r.prototype._regenerateVertexData=function(){return e.VertexData.CreateCylinder({height:this.height,diameterTop:this.diameterTop,diameterBottom:this.diameterBottom,tessellation:this.tessellation,subdivisions:this.subdivisions,sideOrientation:this.side})},r.prototype.copy=function(e){return new r(e,this.getScene(),this.height,this.diameterTop,this.diameterBottom,this.tessellation,this.subdivisions,this.canBeRegenerated(),null,this.side)},r.prototype.serialize=function(){var e=i.prototype.serialize.call(this);return e.height=this.height,e.diameterTop=this.diameterTop,e.diameterBottom=this.diameterBottom,e.tessellation=this.tessellation,e},r.Parse=function(i,r){if(r.getGeometryByID(i.id))return null;var n=new t.Primitives.Cylinder(i.id,r,i.height,i.diameterTop,i.diameterBottom,i.tessellation,i.subdivisions,i.canBeRegenerated,null);return e.Tags.AddTagsTo(n,i.tags),r.pushGeometry(n,!0),n},r}(r);i.Cylinder=h;var c=function(i){function r(t,r,n,o,s,a,h,c){void 0===c&&(c=e.Mesh.DEFAULTSIDE),i.call(this,t,r,a,h),this.diameter=n,this.thickness=o,this.tessellation=s,this.side=c}return __extends(r,i),r.prototype._regenerateVertexData=function(){return e.VertexData.CreateTorus({diameter:this.diameter,thickness:this.thickness,tessellation:this.tessellation,sideOrientation:this.side})},r.prototype.copy=function(e){return new r(e,this.getScene(),this.diameter,this.thickness,this.tessellation,this.canBeRegenerated(),null,this.side)},r.prototype.serialize=function(){var e=i.prototype.serialize.call(this);return e.diameter=this.diameter,e.thickness=this.thickness,e.tessellation=this.tessellation,e},r.Parse=function(i,r){if(r.getGeometryByID(i.id))return null;var n=new t.Primitives.Torus(i.id,r,i.diameter,i.thickness,i.tessellation,i.canBeRegenerated,null);return e.Tags.AddTagsTo(n,i.tags),r.pushGeometry(n,!0),n},r}(r);i.Torus=c;var l=function(i){function r(e,t,r,n,o,s,a){i.call(this,e,t,s,a),this.width=r,this.height=n,this.subdivisions=o}return __extends(r,i),r.prototype._regenerateVertexData=function(){return e.VertexData.CreateGround({width:this.width,height:this.height,subdivisions:this.subdivisions})},r.prototype.copy=function(e){return new r(e,this.getScene(),this.width,this.height,this.subdivisions,this.canBeRegenerated(),null)},r.prototype.serialize=function(){var e=i.prototype.serialize.call(this);return e.width=this.width,e.height=this.height,e.subdivisions=this.subdivisions,e},r.Parse=function(i,r){if(r.getGeometryByID(i.id))return null;var n=new t.Primitives.Ground(i.id,r,i.width,i.height,i.subdivisions,i.canBeRegenerated,null);return e.Tags.AddTagsTo(n,i.tags),r.pushGeometry(n,!0),n},r}(r);i.Ground=l;var u=function(t){function i(e,i,r,n,o,s,a,h,c,l){t.call(this,e,i,c,l),this.xmin=r,this.zmin=n,this.xmax=o,this.zmax=s,this.subdivisions=a,this.precision=h}return __extends(i,t),i.prototype._regenerateVertexData=function(){return e.VertexData.CreateTiledGround({xmin:this.xmin,zmin:this.zmin,xmax:this.xmax,zmax:this.zmax,subdivisions:this.subdivisions,precision:this.precision})},i.prototype.copy=function(e){return new i(e,this.getScene(),this.xmin,this.zmin,this.xmax,this.zmax,this.subdivisions,this.precision,this.canBeRegenerated(),null)},i}(r);i.TiledGround=u;var f=function(i){function r(t,r,n,o,s,a){void 0===a&&(a=e.Mesh.DEFAULTSIDE),i.call(this,t,r,o,s),this.size=n,this.side=a}return __extends(r,i),r.prototype._regenerateVertexData=function(){return e.VertexData.CreatePlane({size:this.size,
sideOrientation:this.side})},r.prototype.copy=function(e){return new r(e,this.getScene(),this.size,this.canBeRegenerated(),null,this.side)},r.prototype.serialize=function(){var e=i.prototype.serialize.call(this);return e.size=this.size,e},r.Parse=function(i,r){if(r.getGeometryByID(i.id))return null;var n=new t.Primitives.Plane(i.id,r,i.size,i.canBeRegenerated,null);return e.Tags.AddTagsTo(n,i.tags),r.pushGeometry(n,!0),n},r}(r);i.Plane=f;var d=function(i){function r(t,r,n,o,s,a,h,c,l,u,f){void 0===f&&(f=e.Mesh.DEFAULTSIDE),i.call(this,t,r,l,u),this.radius=n,this.tube=o,this.radialSegments=s,this.tubularSegments=a,this.p=h,this.q=c,this.side=f}return __extends(r,i),r.prototype._regenerateVertexData=function(){return e.VertexData.CreateTorusKnot({radius:this.radius,tube:this.tube,radialSegments:this.radialSegments,tubularSegments:this.tubularSegments,p:this.p,q:this.q,sideOrientation:this.side})},r.prototype.copy=function(e){return new r(e,this.getScene(),this.radius,this.tube,this.radialSegments,this.tubularSegments,this.p,this.q,this.canBeRegenerated(),null,this.side)},r.prototype.serialize=function(){var e=i.prototype.serialize.call(this);return e.radius=this.radius,e.tube=this.tube,e.radialSegments=this.radialSegments,e.tubularSegments=this.tubularSegments,e.p=this.p,e.q=this.q,e},r.Parse=function(i,r){if(r.getGeometryByID(i.id))return null;var n=new t.Primitives.TorusKnot(i.id,r,i.radius,i.tube,i.radialSegments,i.tubularSegments,i.p,i.q,i.canBeRegenerated,null);return e.Tags.AddTagsTo(n,i.tags),r.pushGeometry(n,!0),n},r}(r);i.TorusKnot=d}(i=t.Primitives||(t.Primitives={}))}(t=e.Geometry||(e.Geometry={}))}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(i,r){t.call(this,i,r),this.generateOctree=!1,this._worldInverse=new e.Matrix}return __extends(i,t),Object.defineProperty(i.prototype,"subdivisions",{get:function(){return this._subdivisions},enumerable:!0,configurable:!0}),i.prototype.optimize=function(e,t){void 0===t&&(t=32),this._subdivisions=e,this.subdivide(this._subdivisions),this.createOrUpdateSubmeshesOctree(t)},i.prototype.getHeightAtCoordinates=function(e,t){if(e-=this.position.x,t-=this.position.z,e/=this.scaling.x,t/=this.scaling.z,e<this._minX||e>this._maxX||t<this._minZ||t>this._maxZ)return this.position.y;this._heightQuads&&0!=this._heightQuads.length||(this._initHeightQuads(),this._computeHeightQuads());var i=this._getFacetAt(e,t),r=-(i.x*e+i.z*t+i.w)/i.y;return r*this.scaling.y+this.position.y},i.prototype.getNormalAtCoordinates=function(t,i){var r=new e.Vector3(0,1,0);return this.getNormalAtCoordinatesToRef(t,i,r),r},i.prototype.getNormalAtCoordinatesToRef=function(e,t,i){if(e-=this.position.x,t-=this.position.z,e/=this.scaling.x,t/=this.scaling.z,!(e<this._minX||e>this._maxX||t<this._minZ||t>this._maxZ)){this._heightQuads&&0!=this._heightQuads.length||(this._initHeightQuads(),this._computeHeightQuads());var r=this._getFacetAt(e,t);i.x=r.x,i.y=r.y,i.z=r.z}},i.prototype.updateCoordinateHeights=function(){this._heightQuads&&0!=this._heightQuads.length||this._initHeightQuads(),this._computeHeightQuads()},i.prototype._getFacetAt=function(e,t){var i,r=Math.floor((e+this._maxX)*this._subdivisions/this._width),n=Math.floor(-(t+this._maxZ)*this._subdivisions/this._height+this._subdivisions),o=this._heightQuads[n*this._subdivisions+r];return i=t<o.slope.x*e+o.slope.y?o.facet1:o.facet2},i.prototype._initHeightQuads=function(){this._heightQuads=new Array;for(var t=0;t<this._subdivisions;t++)for(var i=0;i<this._subdivisions;i++){var r={slope:e.Vector2.Zero(),facet1:new e.Vector4(0,0,0,0),facet2:new e.Vector4(0,0,0,0)};this._heightQuads[t*this._subdivisions+i]=r}},i.prototype._computeHeightQuads=function(){for(var t=this.getVerticesData(e.VertexBuffer.PositionKind),i=e.Tmp.Vector3[0],r=e.Tmp.Vector3[1],n=e.Tmp.Vector3[2],o=e.Tmp.Vector3[3],s=e.Tmp.Vector3[4],a=e.Tmp.Vector3[5],h=e.Tmp.Vector3[6],c=e.Tmp.Vector3[7],l=e.Tmp.Vector3[8],u=0,f=0,d=0,p=0,_=0,m=0,g=0,v=0;v<this._subdivisions;v++)for(var y=0;y<this._subdivisions;y++){u=3*y,f=v*(this._subdivisions+1)*3,d=(v+1)*(this._subdivisions+1)*3,i.x=t[f+u],i.y=t[f+u+1],i.z=t[f+u+2],r.x=t[f+u+3],r.y=t[f+u+4],r.z=t[f+u+5],n.x=t[d+u],n.y=t[d+u+1],n.z=t[d+u+2],o.x=t[d+u+3],o.y=t[d+u+4],o.z=t[d+u+5],p=(o.z-i.z)/(o.x-i.x),_=i.z-p*i.x,r.subtractToRef(i,s),n.subtractToRef(i,a),o.subtractToRef(i,h),e.Vector3.CrossToRef(h,a,c),e.Vector3.CrossToRef(s,h,l),c.normalize(),l.normalize(),m=-(c.x*i.x+c.y*i.y+c.z*i.z),g=-(l.x*r.x+l.y*r.y+l.z*r.z);var x=this._heightQuads[v*this._subdivisions+y];x.slope.copyFromFloats(p,_),x.facet1.copyFromFloats(c.x,c.y,c.z,m),x.facet2.copyFromFloats(l.x,l.y,l.z,g)}},i}(e.Mesh);e.GroundMesh=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(i,r,n,o,s){void 0===n&&(n=null),t.call(this,i,r,n,o,s),this.color=new e.Color3(1,1,1),this.alpha=1,this._positionBuffer={},o&&(this.color=o.color.clone(),this.alpha=o.alpha),this._intersectionThreshold=.1,this._colorShader=new e.ShaderMaterial("colorShader",r,"color",{attributes:[e.VertexBuffer.PositionKind],uniforms:["worldViewProjection","color"],needAlphaBlending:!0}),this._positionBuffer[e.VertexBuffer.PositionKind]=null}return __extends(i,t),Object.defineProperty(i.prototype,"intersectionThreshold",{get:function(){return this._intersectionThreshold},set:function(t){this._intersectionThreshold!==t&&(this._intersectionThreshold=t,this.geometry&&(this.geometry.boundingBias=new e.Vector2(0,t)))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"material",{get:function(){return this._colorShader},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"checkCollisions",{get:function(){return!1},enumerable:!0,configurable:!0}),i.prototype.createInstance=function(t){return e.Tools.Log("LinesMeshes do not support createInstance."),null},i.prototype._bind=function(t,i,r){var n=this.getScene().getEngine();this._positionBuffer[e.VertexBuffer.PositionKind]=this._geometry.getVertexBuffer(e.VertexBuffer.PositionKind),n.bindBuffers(this._positionBuffer,this._geometry.getIndexBuffer(),this._colorShader.getEffect()),this._colorShader.setColor4("color",this.color.toColor4(this.alpha))},i.prototype._draw=function(e,t,i){if(this._geometry&&this._geometry.getVertexBuffers()&&this._geometry.getIndexBuffer()){var r=this.getScene().getEngine();r.draw(!1,e.indexStart,e.indexCount)}},i.prototype.dispose=function(e){this._colorShader.dispose(),t.prototype.dispose.call(this,e)},i.prototype.clone=function(e,t,r){return new i(e,this.getScene(),t,this,r)},i}(e.Mesh);e.LinesMesh=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function e(e,t,i){var r=this;void 0===t&&(t=""),void 0===i&&(i="black"),this._renderingCanvas=e,this._loadingText=t,this._loadingDivBackgroundColor=i,this._resizeLoadingUI=function(){var e=r._renderingCanvas.getBoundingClientRect();r._loadingDiv.style.position="absolute",r._loadingDiv.style.left=e.left+"px",r._loadingDiv.style.top=e.top+"px",r._loadingDiv.style.width=e.width+"px",r._loadingDiv.style.height=e.height+"px"}}return e.prototype.displayLoadingUI=function(){var e=this;if(!this._loadingDiv){this._loadingDiv=document.createElement("div"),this._loadingDiv.id="babylonjsLoadingDiv",this._loadingDiv.style.opacity="0",this._loadingDiv.style.transition="opacity 1.5s ease",this._loadingTextDiv=document.createElement("div"),this._loadingTextDiv.style.position="absolute",this._loadingTextDiv.style.left="0",this._loadingTextDiv.style.top="50%",this._loadingTextDiv.style.marginTop="80px",this._loadingTextDiv.style.width="100%",this._loadingTextDiv.style.height="20px",this._loadingTextDiv.style.fontFamily="Arial",this._loadingTextDiv.style.fontSize="14px",this._loadingTextDiv.style.color="white",this._loadingTextDiv.style.textAlign="center",this._loadingTextDiv.innerHTML="Loading",this._loadingDiv.appendChild(this._loadingTextDiv),this._loadingTextDiv.innerHTML=this._loadingText;var t=new Image;t.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuM4zml1AAAARbSURBVHhe7Z09aFNRFMc716kuLrq4FdyLq4Wi4CAoRQcR0UJBUBdRiuLSIYMo6CA4FF2sgw6CFAdFUOpSQYcWO4hD26UQCfXrIQrx/JJzw1OSWq3NPeL/B4Fy+0jg/HO+7j3vpUcI8b/Q39+/49ihfWdPHT94Yf/e3Se3bd263f8lus218TPn6vV6Ya8Wi/MzNRNmj18iusX9W1evmP1/EKNEIVG6CMbG6E3bt+fT++pHha8NoHdT72bLE8NDg7tGU64gLLndV4Wc4m8j/pS+vr4tGB/DT16v3Fyr8dvBe/jbit8BL0AES9LX1iPAz+BR/hFiLVCynj95dPzNy6fv3IZ/k4L3948Sq7FzYGBg4vLFGxitabuOFCbWNKGrMnbiUuo18KaV6tIHv6YtvL9/nOgE31jCktmrY7k6+/zhE4yP4Vf7hiNqh/BWWEl8mzDol4p22Lf7cIdvdUMEvv0Y2S9fE5S1hLzpqTsPkiep//gFGPnR3Yl7GL5p/xYFBrTwM+iXio3GqpwDGL5p/xYNIX7XG8Q6IJRgdIzf1KBBgafII7oMidhyQtVFaMA2Bt7il4huQRhaXphbcR2g4RXqBzKAGHiCCwGFVUAj/m/RTRDj29cvn10I0PZ3LghH5f4CL1EFlQmqqXK3jDDKFxmhQ3Yt6oQseUZGKmMnTpsOqc8o1F9kBOMjQlOLeqEeIyOc6JV6jYLJD/+XyIFvnzdgl9aXRQ5I2qZDK1SpospMqaoqON/wZZGDciLnMMiXRS7IF4hhqMTNTdk7CFu+LHLhR7BQqBvPDJUUQqCGvCMATHUgBmhWNgApmdOda9YpM+VwRYfuyyIXDK8hBlilNerLIheMZCKGwlUAyru6GlwOgPUbRxADdJ9FAChxXY864viyyEXqPxhc0M2TAfAbatSdRyHtXymhByEdRnE3ky+JnHAIhSA0h74kckETmHoQbSgGwJrCIRMEPSRIBCRIMAhZaYhaggQhJXUJEoRU9mofKwh+F22dLRRfEjlJM7w6KQwCoQpBOKTyJZETjmwRxKqtGV8SOSkNOGjKPQppBEgDDkFgpxdBVGkFgaYQQXRIFQSObk0P5ZFIpAZRHXsQ0r0hCluBWKkuvVbYCkQaCdL5ehBScudJP4yY+rLISdps1NBDEJKXMMmoSfggWC4ZQRR17oFYXph7hSiquIKQ+hJGTX1J5MYSPD/GVdNzsgLBwZVCVyAQAkF0ohiI/c1fS6tNXq9UfEnkhudmIQolsS+J3Hh/UtNDzQLhj42VKJFInqLwFYiUU5ToA+HdfI0JevUpQUAIn+vSz2lHIuUV/dJOIHhOY/IWVWGBIHQtzs88s9zyWBuTgcBLzGOmeNnfF/QslSDgMeQW85i3DOQxuipxAkCyZ8SIm4Omp+7MMlCB59j6sKZcMoM4iIEoeI2J9AKxrFobZx0v4vYInuHFS4J1GQRCAGaLEYQXfyMML5XSQgghhBBCCCH+cXp6vgNhKpSKX/XdOAAAAABJRU5ErkJggg==",t.style.position="absolute",t.style.left="50%",t.style.top="50%",t.style.marginLeft="-50px",t.style.marginTop="-50px",t.style.transition="transform 1.0s ease",t.style.webkitTransition="-webkit-transform 1.0s ease";var i=360,r=function(){i+=360,t.style.transform="rotateZ("+i+"deg)",t.style.webkitTransform="rotateZ("+i+"deg)"};t.addEventListener("transitionend",r),t.addEventListener("webkitTransitionEnd",r),this._loadingDiv.appendChild(t);var n=new Image;n.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuM4zml1AAAAYJSURBVHhe7Zy/qx1FFMff/2Av2Nvbi4WFiiAEY/OQ2IgQsbCJQoqkCAgpFLXyoZURLfwBIiIpgqZJoYQYlWelNsIrNOxDJcrzfHe+G97dnTl75u7euzv7zgcWHrlnZmfOmXPmzI/NjuM4juM4juM4juM4juM4juM4juM4juM45fPic08/uHf5/CvffH7lnT8PfrtxdHS0n3p+/fHGl5+89/prr5599iEWd8bg0rkXHoFyqehKnlxQpjYSDHTm9JMPsGrHylOPPXofvICKXMcIGtXdf/76AYbm6xyNW9e/eAtKC7rbKLXnvHHx5Sf4auc4Ek7OQkFU1Dap/vv37k/wSjblZANFiFIGzw98hhizwqBgs04mCBdQRNCHidoAEtY+lLIvtSdoGFeyql2ZH57HBH4sE7O+o/r9l+8/ZXUni68+2jsHBQQ9qNRGeP/tSxdSYQX/roUcpL4/f3vtM9TD+jTq92n1LQ7jxF1hhGPtwWL3gGccy8JuS1r8sVWBGXNVdSKMYjBGPUJjCzooiGuSpnwlnnOGP2dhHRSLNgpHp2oMKIriK8TmG4Qh/rwW8D6pps9b9im+LDDipXOqMVJrAngBfg9i98gevWKA+/nnCod3Dr5GfaHaDgidVym6HKRjGIkpqthcAVKGxNqBImbEo66kjCih8AOpNmkUmbMuUrR8kEqiU6FvHZLGAPJ71JCYSyhiBqmwFE2GoD6jLGIfDHtG6EzoU4dK21PCqIRMEF0FGRjFzGDtIkXVAdATvsqfT9CJ0JcOFdYiFIsiMlqYy1YOFpQo2OddqBtyEaq9y+efoVh5oPHoROjLKn0j3JIE5Ka8UqZRtGrMnneX6yVofOhDh94MSbznTcpqmDOt1vyQzOgaJAF4F3JBfIXesrNEGWWmjIX7UBZ6jRJbBMLg/DmJiKUGVHleIpnVNTa+jakzkAviJqLhi4MC9XQGBrZeKJZESSrKy7ik0VGFWhQBRDTHIACKQ5l9nAjy75gya4a2w+Jhs0FJdc0xX/GwUbAqFBkZi7QpJ2w16WUbjFyK9MJF3KaoEM74KhVtLrQOrsmRxkbdHEqmSC/c+EuGnIFkjW7Ih2Kr4CCMIvNG2hrrgLpCjiFloooYCjyYrzCRyvhyBthkIPuQtsZGdnbMTezyDiU71KTC5zr7aVsHbsz2tllrEkS5UHwU1tq1HbtPW4UbeB0O7xx8R5EsMJql+BheUmHjkNVmIRP7LutoM3+D4O4tG7vCkNO9ESZ4lL3J6rKRMPx4qKbD/A0icf8CG7tC7kTahnMTwleuYSrsS7GatRAvfZh1tTm5BmmQCdZ8a0Sefe28xUrRBkmFLKy8KTIKUDRX0Y1xagPgwbaIdeFnQULmKak3xvwNMkVGgok/N5XNoehJvejRlCDl9escI28dJU0tZ++nBTJE9mEF647x5Ehbo4s5hDOKFIU0PdofeA5F5k1q63zIWmQqNI/P3ZubjFTqKxQ3jyjHAOX0RdlgVO9hzRFpczRcjZ3Gbxxpc7Qj6+5pTYF2OFXawNI+yDGf1k2NcvOlzBQeDQ/t7zD7DsEDpJ2xATXaNtDWUS4IzP4DS2ljajAVu57SUkYw245ptxZxA5JiZaJ0DswudGn3kYUy54426EjoT4dZfYbccxC2nI92cDkZHQr96jD4AGkMDKeSy/COBsRe6VTSKFN6irLeaCh3IteQjt1E5+oudsG/b/2DfZ5AqsYo8vMDK9LB1HzSsLWvlGThdxXvC6+NsqyPPWP0pMINtbdsajfVeC6f/GZ+cdAofQoB1d+Hf9waY98I7+RXWab3Lt4zYkjHtTnlOLXHYMsCh1zWeQYehu1zfNPOOiys/d91LAKEBSgh6MJMbSA82AaHofDgAIwbgvVvlLNS11nModMm4UZergLHZBZrodmBuA3lBB1thdorSjkOmATMDwg/UBQVtglqQyx6fbEJ+H3IWIapjYAjAfeIgeCMHldueJvFaqDaAHhwf8qNsEEQ1iQbOoUUGIbCLRc8+Bvfp4jyd2FEijuO4ziO4ziO4ziO4ziO4ziO4ziO4ziOUzw7O/8D0P7rcZ/GEboAAAAASUVORK5CYII=",n.style.position="absolute",n.style.left="50%",n.style.top="50%",n.style.marginLeft="-50px",n.style.marginTop="-50px",this._loadingDiv.appendChild(n),this._resizeLoadingUI(),window.addEventListener("resize",this._resizeLoadingUI),this._loadingDiv.style.backgroundColor=this._loadingDivBackgroundColor,document.body.appendChild(this._loadingDiv),setTimeout(function(){e._loadingDiv.style.opacity="1",t.style.transform="rotateZ(360deg)",t.style.webkitTransform="rotateZ(360deg)"},0)}},e.prototype.hideLoadingUI=function(){var e=this;if(this._loadingDiv){var t=function(){e._loadingDiv&&(document.body.removeChild(e._loadingDiv),window.removeEventListener("resize",e._resizeLoadingUI),e._loadingDiv=null)};this._loadingDiv.style.opacity="0",this._loadingDiv.addEventListener("transitionend",t)}},Object.defineProperty(e.prototype,"loadingUIText",{set:function(e){this._loadingText=e,this._loadingTextDiv&&(this._loadingTextDiv.innerHTML=this._loadingText)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loadingUIBackgroundColor",{get:function(){return this._loadingDivBackgroundColor},set:function(e){this._loadingDivBackgroundColor=e,this._loadingDiv&&(this._loadingDiv.style.backgroundColor=this._loadingDivBackgroundColor)},enumerable:!0,configurable:!0}),e}();e.DefaultLoadingScreen=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(){this._audioContext=null,this._audioContextInitialized=!1,this.canUseWebAudio=!1,this.WarnedWebAudioUnsupported=!1,this.unlocked=!1,"undefined"==typeof window.AudioContext&&"undefined"==typeof window.webkitAudioContext||(window.AudioContext=window.AudioContext||window.webkitAudioContext,this.canUseWebAudio=!0),/iPad|iPhone|iPod/.test(navigator.platform)?this._unlockiOSaudio():this.unlocked=!0}return Object.defineProperty(t.prototype,"audioContext",{get:function(){return this._audioContextInitialized||this._initializeAudioContext(),this._audioContext},enumerable:!0,configurable:!0}),t.prototype._unlockiOSaudio=function(){var e=this,t=function(){var i=e.audioContext.createBuffer(1,1,22050),r=e.audioContext.createBufferSource();r.buffer=i,r.connect(e.audioContext.destination),r.start(0),setTimeout(function(){r.playbackState!==r.PLAYING_STATE&&r.playbackState!==r.FINISHED_STATE||(e.unlocked=!0,window.removeEventListener("touchend",t,!1),e.onAudioUnlocked&&e.onAudioUnlocked())},0)};window.addEventListener("touchend",t,!1)},t.prototype._initializeAudioContext=function(){try{this.canUseWebAudio&&(this._audioContext=new AudioContext,this.masterGain=this._audioContext.createGain(),this.masterGain.gain.value=1,this.masterGain.connect(this._audioContext.destination),this._audioContextInitialized=!0)}catch(t){this.canUseWebAudio=!1,e.Tools.Error("Web Audio: "+t.message)}},t.prototype.dispose=function(){this.canUseWebAudio&&this._audioContextInitialized&&(this._connectedAnalyser&&(this._connectedAnalyser.stopDebugCanvas(),this._connectedAnalyser.dispose(),this.masterGain.disconnect(),this.masterGain.connect(this._audioContext.destination),this._connectedAnalyser=null),this.masterGain.gain.value=1),this.WarnedWebAudioUnsupported=!1},t.prototype.getGlobalVolume=function(){return this.canUseWebAudio&&this._audioContextInitialized?this.masterGain.gain.value:-1},t.prototype.setGlobalVolume=function(e){this.canUseWebAudio&&this._audioContextInitialized&&(this.masterGain.gain.value=e)},t.prototype.connectToAnalyser=function(e){this._connectedAnalyser&&this._connectedAnalyser.stopDebugCanvas(),this.canUseWebAudio&&this._audioContextInitialized&&(this._connectedAnalyser=e,this.masterGain.disconnect(),this._connectedAnalyser.connectAudioNodes(this.masterGain,this._audioContext.destination))},t}();e.AudioEngine=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(t,i,r,n,o){var s=this;this.autoplay=!1,this.loop=!1,this.useCustomAttenuation=!1,this.spatialSound=!1,this.refDistance=1,this.rolloffFactor=1,this.maxDistance=100,this.distanceModel="linear",this._panningModel="equalpower",this._playbackRate=1,this._streaming=!1,this._startTime=0,this._startOffset=0,this._position=e.Vector3.Zero(),this._localDirection=new e.Vector3(1,0,0),this._volume=1,this._isLoaded=!1,this._isReadyToPlay=!1,this.isPlaying=!1,this.isPaused=!1,this._isDirectional=!1,this._coneInnerAngle=360,this._coneOuterAngle=360,this._coneOuterGain=0,this._isOutputConnected=!1,this.name=t,this._scene=r,this._readyToPlayCallback=n,this._customAttenuationFunction=function(e,t,i,r,n){return i>t?e*(1-t/i):0},o&&(this.autoplay=o.autoplay||!1,this.loop=o.loop||!1,void 0!==o.volume&&(this._volume=o.volume),this.spatialSound=o.spatialSound||!1,this.maxDistance=o.maxDistance||100,this.useCustomAttenuation=o.useCustomAttenuation||!1,this.rolloffFactor=o.rolloffFactor||1,this.refDistance=o.refDistance||1,this.distanceModel=o.distanceModel||"linear",this._playbackRate=o.playbackRate||1,this._streaming=o.streaming||!1),e.Engine.audioEngine.canUseWebAudio?(this._soundGain=e.Engine.audioEngine.audioContext.createGain(),this._soundGain.gain.value=this._volume,this._inputAudioNode=this._soundGain,this._ouputAudioNode=this._soundGain,this.spatialSound&&this._createSpatialParameters(),this._scene.mainSoundTrack.AddSound(this),i&&("string"==typeof i?this._streaming?(this._htmlAudioElement=new Audio(i),this._htmlAudioElement.controls=!1,this._htmlAudioElement.loop=this.loop,this._htmlAudioElement.crossOrigin="anonymous",this._htmlAudioElement.preload="auto",this._htmlAudioElement.addEventListener("canplaythrough",function(){s._isReadyToPlay=!0,s.autoplay&&s.play(),s._readyToPlayCallback&&s._readyToPlayCallback()}),document.body.appendChild(this._htmlAudioElement)):e.Tools.LoadFile(i,function(e){s._soundLoaded(e)},null,this._scene.database,!0):i instanceof ArrayBuffer?i.byteLength>0&&this._soundLoaded(i):e.Tools.Error("Parameter must be a URL to the sound or an ArrayBuffer of the sound."))):(this._scene.mainSoundTrack.AddSound(this),e.Engine.audioEngine.WarnedWebAudioUnsupported||(e.Tools.Error("Web Audio is not supported by your browser."),e.Engine.audioEngine.WarnedWebAudioUnsupported=!0),this._readyToPlayCallback&&window.setTimeout(function(){s._readyToPlayCallback()},1e3))}return t.prototype.dispose=function(){e.Engine.audioEngine.canUseWebAudio&&this._isReadyToPlay&&(this.isPlaying&&this.stop(),this._isReadyToPlay=!1,-1===this.soundTrackId?this._scene.mainSoundTrack.RemoveSound(this):this._scene.soundTracks[this.soundTrackId].RemoveSound(this),this._soundGain&&(this._soundGain.disconnect(),this._soundGain=null),this._soundPanner&&(this._soundPanner.disconnect(),this._soundPanner=null),this._soundSource&&(this._soundSource.disconnect(),this._soundSource=null),this._audioBuffer=null,this._htmlAudioElement&&(this._htmlAudioElement.pause(),this._htmlAudioElement.src="",document.body.removeChild(this._htmlAudioElement)),this._connectedMesh&&(this._connectedMesh.unregisterAfterWorldMatrixUpdate(this._registerFunc),this._connectedMesh=null))},t.prototype._soundLoaded=function(t){var i=this;this._isLoaded=!0,e.Engine.audioEngine.audioContext.decodeAudioData(t,function(e){i._audioBuffer=e,i._isReadyToPlay=!0,i.autoplay&&i.play(),i._readyToPlayCallback&&i._readyToPlayCallback()},function(){e.Tools.Error("Error while decoding audio data for: "+i.name)})},t.prototype.setAudioBuffer=function(t){e.Engine.audioEngine.canUseWebAudio&&(this._audioBuffer=t,this._isReadyToPlay=!0)},t.prototype.updateOptions=function(e){e&&(this.loop=e.loop||this.loop,this.maxDistance=e.maxDistance||this.maxDistance,this.useCustomAttenuation=e.useCustomAttenuation||this.useCustomAttenuation,this.rolloffFactor=e.rolloffFactor||this.rolloffFactor,this.refDistance=e.refDistance||this.refDistance,this.distanceModel=e.distanceModel||this.distanceModel,this._playbackRate=e.playbackRate||this._playbackRate,this._updateSpatialParameters(),this.isPlaying&&(this._streaming?this._htmlAudioElement.playbackRate=this._playbackRate:this._soundSource.playbackRate.value=this._playbackRate))},t.prototype._createSpatialParameters=function(){e.Engine.audioEngine.canUseWebAudio&&(this._scene.headphone&&(this._panningModel="HRTF"),this._soundPanner=e.Engine.audioEngine.audioContext.createPanner(),this._updateSpatialParameters(),this._soundPanner.connect(this._ouputAudioNode),this._inputAudioNode=this._soundPanner)},t.prototype._updateSpatialParameters=function(){this.spatialSound&&(this.useCustomAttenuation?(this._soundPanner.distanceModel="linear",this._soundPanner.maxDistance=Number.MAX_VALUE,this._soundPanner.refDistance=1,this._soundPanner.rolloffFactor=1,this._soundPanner.panningModel=this._panningModel):(this._soundPanner.distanceModel=this.distanceModel,this._soundPanner.maxDistance=this.maxDistance,this._soundPanner.refDistance=this.refDistance,this._soundPanner.rolloffFactor=this.rolloffFactor,this._soundPanner.panningModel=this._panningModel))},t.prototype.switchPanningModelToHRTF=function(){this._panningModel="HRTF",this._switchPanningModel()},t.prototype.switchPanningModelToEqualPower=function(){this._panningModel="equalpower",this._switchPanningModel()},t.prototype._switchPanningModel=function(){e.Engine.audioEngine.canUseWebAudio&&this.spatialSound&&(this._soundPanner.panningModel=this._panningModel)},t.prototype.connectToSoundTrackAudioNode=function(t){e.Engine.audioEngine.canUseWebAudio&&(this._isOutputConnected&&this._ouputAudioNode.disconnect(),this._ouputAudioNode.connect(t),this._isOutputConnected=!0)},t.prototype.setDirectionalCone=function(t,i,r){return t>i?void e.Tools.Error("setDirectionalCone(): outer angle of the cone must be superior or equal to the inner angle."):(this._coneInnerAngle=t,this._coneOuterAngle=i,this._coneOuterGain=r,this._isDirectional=!0,void(this.isPlaying&&this.loop&&(this.stop(),this.play())))},t.prototype.setPosition=function(t){this._position=t,e.Engine.audioEngine.canUseWebAudio&&this.spatialSound&&this._soundPanner.setPosition(this._position.x,this._position.y,this._position.z)},t.prototype.setLocalDirectionToMesh=function(t){this._localDirection=t,e.Engine.audioEngine.canUseWebAudio&&this._connectedMesh&&this.isPlaying&&this._updateDirection()},t.prototype._updateDirection=function(){var t=this._connectedMesh.getWorldMatrix(),i=e.Vector3.TransformNormal(this._localDirection,t);i.normalize(),this._soundPanner.setOrientation(i.x,i.y,i.z)},t.prototype.updateDistanceFromListener=function(){if(e.Engine.audioEngine.canUseWebAudio&&this._connectedMesh&&this.useCustomAttenuation){var t=this._connectedMesh.getDistanceToCamera(this._scene.activeCamera);this._soundGain.gain.value=this._customAttenuationFunction(this._volume,t,this.maxDistance,this.refDistance,this.rolloffFactor)}},t.prototype.setAttenuationFunction=function(e){this._customAttenuationFunction=e},t.prototype.play=function(t){var i=this;if(this._isReadyToPlay&&this._scene.audioEnabled)try{this._startOffset<0&&(t=-this._startOffset,this._startOffset=0);var r=t?e.Engine.audioEngine.audioContext.currentTime+t:e.Engine.audioEngine.audioContext.currentTime;this._soundSource&&this._streamingSource||this.spatialSound&&(this._soundPanner.setPosition(this._position.x,this._position.y,this._position.z),this._isDirectional&&(this._soundPanner.coneInnerAngle=this._coneInnerAngle,this._soundPanner.coneOuterAngle=this._coneOuterAngle,this._soundPanner.coneOuterGain=this._coneOuterGain,this._connectedMesh?this._updateDirection():this._soundPanner.setOrientation(this._localDirection.x,this._localDirection.y,this._localDirection.z))),this._streaming?(this._streamingSource||(this._streamingSource=e.Engine.audioEngine.audioContext.createMediaElementSource(this._htmlAudioElement),this._htmlAudioElement.onended=function(){i._onended()},this._htmlAudioElement.playbackRate=this._playbackRate),this._streamingSource.disconnect(),this._streamingSource.connect(this._inputAudioNode),this._htmlAudioElement.play()):(this._soundSource=e.Engine.audioEngine.audioContext.createBufferSource(),this._soundSource.buffer=this._audioBuffer,this._soundSource.connect(this._inputAudioNode),this._soundSource.loop=this.loop,this._soundSource.playbackRate.value=this._playbackRate,this._soundSource.onended=function(){i._onended()},this._soundSource.start(r,this.isPaused?this._startOffset%this._soundSource.buffer.duration:0)),this._startTime=r,this.isPlaying=!0,this.isPaused=!1}catch(n){e.Tools.Error("Error while trying to play audio: "+this.name+", "+n.message)}},t.prototype._onended=function(){this.isPlaying=!1,this.onended&&this.onended()},t.prototype.stop=function(t){if(this.isPlaying){if(this._streaming)this._htmlAudioElement.pause(),this._htmlAudioElement.currentTime>0&&(this._htmlAudioElement.currentTime=0);else{var i=t?e.Engine.audioEngine.audioContext.currentTime+t:e.Engine.audioEngine.audioContext.currentTime;this._soundSource.stop(i),this._soundSource.onended=null,this.isPaused||(this._startOffset=0)}this.isPlaying=!1}},t.prototype.pause=function(){this.isPlaying&&(this.isPaused=!0,this._streaming?this._htmlAudioElement.pause():(this.stop(0),this._startOffset+=e.Engine.audioEngine.audioContext.currentTime-this._startTime))},t.prototype.setVolume=function(t,i){e.Engine.audioEngine.canUseWebAudio&&(i?(this._soundGain.gain.cancelScheduledValues(e.Engine.audioEngine.audioContext.currentTime),this._soundGain.gain.setValueAtTime(this._soundGain.gain.value,e.Engine.audioEngine.audioContext.currentTime),this._soundGain.gain.linearRampToValueAtTime(t,e.Engine.audioEngine.audioContext.currentTime+i)):this._soundGain.gain.value=t),this._volume=t},t.prototype.setPlaybackRate=function(e){this._playbackRate=e,this.isPlaying&&(this._streaming?this._htmlAudioElement.playbackRate=this._playbackRate:this._soundSource.playbackRate.value=this._playbackRate)},t.prototype.getVolume=function(){return this._volume},t.prototype.attachToMesh=function(e){var t=this;this._connectedMesh&&(this._connectedMesh.unregisterAfterWorldMatrixUpdate(this._registerFunc),this._registerFunc=null),this._connectedMesh=e,this.spatialSound||(this.spatialSound=!0,this._createSpatialParameters(),this.isPlaying&&this.loop&&(this.stop(),this.play())),this._onRegisterAfterWorldMatrixUpdate(this._connectedMesh),this._registerFunc=function(e){return t._onRegisterAfterWorldMatrixUpdate(e)},e.registerAfterWorldMatrixUpdate(this._registerFunc)},t.prototype.detachFromMesh=function(){this._connectedMesh&&(this._connectedMesh.unregisterAfterWorldMatrixUpdate(this._registerFunc),this._registerFunc=null,this._connectedMesh=null)},t.prototype._onRegisterAfterWorldMatrixUpdate=function(t){this.setPosition(t.getBoundingInfo().boundingSphere.centerWorld),e.Engine.audioEngine.canUseWebAudio&&this._isDirectional&&this.isPlaying&&this._updateDirection()},t.prototype.clone=function(){var e=this;if(this._streaming)return null;var i=function(){e._isReadyToPlay?(n._audioBuffer=e.getAudioBuffer(),n._isReadyToPlay=!0,n.autoplay&&n.play()):window.setTimeout(i,300)},r={autoplay:this.autoplay,loop:this.loop,volume:this._volume,spatialSound:this.spatialSound,maxDistance:this.maxDistance,useCustomAttenuation:this.useCustomAttenuation,rolloffFactor:this.rolloffFactor,refDistance:this.refDistance,distanceModel:this.distanceModel},n=new t(this.name+"_cloned",new ArrayBuffer(0),this._scene,null,r);return this.useCustomAttenuation&&n.setAttenuationFunction(this._customAttenuationFunction),n.setPosition(this._position),n.setPlaybackRate(this._playbackRate),i(),n},t.prototype.getAudioBuffer=function(){return this._audioBuffer},t.Parse=function(i,r,n,o){var s,a=i.name;s=i.url?n+i.url:n+a;var h,c={autoplay:i.autoplay,loop:i.loop,volume:i.volume,spatialSound:i.spatialSound,maxDistance:i.maxDistance,rolloffFactor:i.rolloffFactor,refDistance:i.refDistance,distanceModel:i.distanceModel,playbackRate:i.playbackRate};if(o){var l=function(){o._isReadyToPlay?(h._audioBuffer=o.getAudioBuffer(),h._isReadyToPlay=!0,h.autoplay&&h.play()):window.setTimeout(l,300)};h=new t(a,new ArrayBuffer(0),r,null,c),l()}else h=new t(a,s,r,function(){r._removePendingData(h)},c),r._addPendingData(h);if(i.position){var u=e.Vector3.FromArray(i.position);h.setPosition(u)}if(i.isDirectional&&(h.setDirectionalCone(i.coneInnerAngle||360,i.coneOuterAngle||360,i.coneOuterGain||0),i.localDirectionToMesh)){var f=e.Vector3.FromArray(i.localDirectionToMesh);h.setLocalDirectionToMesh(f)}if(i.connectedMeshId){var d=r.getMeshByID(i.connectedMeshId);d&&h.attachToMesh(d)}return h},t}();e.Sound=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(e,t){this.id=-1,this._isMainTrack=!1,this._isInitialized=!1,this._scene=e,this.soundCollection=new Array,this._options=t,this._isMainTrack||(this._scene.soundTracks.push(this),this.id=this._scene.soundTracks.length-1)}return t.prototype._initializeSoundTrackAudioGraph=function(){e.Engine.audioEngine.canUseWebAudio&&(this._outputAudioNode=e.Engine.audioEngine.audioContext.createGain(),this._outputAudioNode.connect(e.Engine.audioEngine.masterGain),this._options&&(this._options.volume&&(this._outputAudioNode.gain.value=this._options.volume),this._options.mainTrack&&(this._isMainTrack=this._options.mainTrack)),this._isInitialized=!0)},t.prototype.dispose=function(){if(e.Engine.audioEngine.canUseWebAudio){for(this._connectedAnalyser&&this._connectedAnalyser.stopDebugCanvas();this.soundCollection.length;)this.soundCollection[0].dispose();this._outputAudioNode&&this._outputAudioNode.disconnect(),this._outputAudioNode=null}},t.prototype.AddSound=function(t){this._isInitialized||this._initializeSoundTrackAudioGraph(),e.Engine.audioEngine.canUseWebAudio&&t.connectToSoundTrackAudioNode(this._outputAudioNode),t.soundTrackId&&(-1===t.soundTrackId?this._scene.mainSoundTrack.RemoveSound(t):this._scene.soundTracks[t.soundTrackId].RemoveSound(t)),this.soundCollection.push(t),t.soundTrackId=this.id},t.prototype.RemoveSound=function(e){var t=this.soundCollection.indexOf(e);-1!==t&&this.soundCollection.splice(t,1)},t.prototype.setVolume=function(t){e.Engine.audioEngine.canUseWebAudio&&(this._outputAudioNode.gain.value=t)},t.prototype.switchPanningModelToHRTF=function(){if(e.Engine.audioEngine.canUseWebAudio)for(var t=0;t<this.soundCollection.length;t++)this.soundCollection[t].switchPanningModelToHRTF()},t.prototype.switchPanningModelToEqualPower=function(){if(e.Engine.audioEngine.canUseWebAudio)for(var t=0;t<this.soundCollection.length;t++)this.soundCollection[t].switchPanningModelToEqualPower()},t.prototype.connectToAnalyser=function(t){this._connectedAnalyser&&this._connectedAnalyser.stopDebugCanvas(),this._connectedAnalyser=t,e.Engine.audioEngine.canUseWebAudio&&(this._outputAudioNode.disconnect(),this._connectedAnalyser.connectAudioNodes(this._outputAudioNode,e.Engine.audioEngine.masterGain))},t}();e.SoundTrack=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function e(){}return e.TransformCoordinatesToRefSIMD=function(e,t,i){var r=SIMD.float32x4.loadXYZ(e._data,0),n=SIMD.float32x4.load(t.m,0),o=SIMD.float32x4.load(t.m,4),s=SIMD.float32x4.load(t.m,8),a=SIMD.float32x4.load(t.m,12),h=SIMD.float32x4.add(SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(r,0,0,0,0),n),SIMD.float32x4.mul(SIMD.float32x4.swizzle(r,1,1,1,1),o)),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(r,2,2,2,2),s),a));h=SIMD.float32x4.div(h,SIMD.float32x4.swizzle(h,3,3,3,3)),SIMD.float32x4.storeXYZ(i._data,0,h)},e.TransformCoordinatesFromFloatsToRefSIMD=function(e,t,i,r,n){var o=SIMD.float32x4.splat(e),s=SIMD.float32x4.splat(t),a=SIMD.float32x4.splat(i),h=SIMD.float32x4.load(r.m,0),c=SIMD.float32x4.load(r.m,4),l=SIMD.float32x4.load(r.m,8),u=SIMD.float32x4.load(r.m,12),f=SIMD.float32x4.add(SIMD.float32x4.add(SIMD.float32x4.mul(o,h),SIMD.float32x4.mul(s,c)),SIMD.float32x4.add(SIMD.float32x4.mul(a,l),u));
f=SIMD.float32x4.div(f,SIMD.float32x4.swizzle(f,3,3,3,3)),SIMD.float32x4.storeXYZ(n._data,0,f)},e}();e.SIMDVector3=t;var i=function(){function e(){}return e.prototype.multiplyToArraySIMD=function(e,t,i){void 0===i&&(i=0);var r=this.m,n=e.m,o=SIMD.float32x4.load(n,0),s=SIMD.float32x4.load(n,4),a=SIMD.float32x4.load(n,8),h=SIMD.float32x4.load(n,12),c=SIMD.float32x4.load(r,0);SIMD.float32x4.store(t,i+0,SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(c,0,0,0,0),o),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(c,1,1,1,1),s),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(c,2,2,2,2),a),SIMD.float32x4.mul(SIMD.float32x4.swizzle(c,3,3,3,3),h)))));var l=SIMD.float32x4.load(r,4);SIMD.float32x4.store(t,i+4,SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(l,0,0,0,0),o),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(l,1,1,1,1),s),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(l,2,2,2,2),a),SIMD.float32x4.mul(SIMD.float32x4.swizzle(l,3,3,3,3),h)))));var u=SIMD.float32x4.load(r,8);SIMD.float32x4.store(t,i+8,SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(u,0,0,0,0),o),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(u,1,1,1,1),s),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(u,2,2,2,2),a),SIMD.float32x4.mul(SIMD.float32x4.swizzle(u,3,3,3,3),h)))));var f=SIMD.float32x4.load(r,12);SIMD.float32x4.store(t,i+12,SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(f,0,0,0,0),o),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(f,1,1,1,1),s),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(f,2,2,2,2),a),SIMD.float32x4.mul(SIMD.float32x4.swizzle(f,3,3,3,3),h)))))},e.prototype.invertToRefSIMD=function(e){var t,i,r,n,o,s,a,h,c,l,u=this.m,f=e.m,d=SIMD.float32x4.load(u,0),p=SIMD.float32x4.load(u,4),_=SIMD.float32x4.load(u,8),m=SIMD.float32x4.load(u,12);return o=SIMD.float32x4.shuffle(d,p,0,1,4,5),i=SIMD.float32x4.shuffle(_,m,0,1,4,5),t=SIMD.float32x4.shuffle(o,i,0,2,4,6),i=SIMD.float32x4.shuffle(i,o,1,3,5,7),o=SIMD.float32x4.shuffle(d,p,2,3,6,7),n=SIMD.float32x4.shuffle(_,m,2,3,6,7),r=SIMD.float32x4.shuffle(o,n,0,2,4,6),n=SIMD.float32x4.shuffle(n,o,1,3,5,7),o=SIMD.float32x4.mul(r,n),o=SIMD.float32x4.swizzle(o,1,0,3,2),s=SIMD.float32x4.mul(i,o),a=SIMD.float32x4.mul(t,o),o=SIMD.float32x4.swizzle(o,2,3,0,1),s=SIMD.float32x4.sub(SIMD.float32x4.mul(i,o),s),a=SIMD.float32x4.sub(SIMD.float32x4.mul(t,o),a),a=SIMD.float32x4.swizzle(a,2,3,0,1),o=SIMD.float32x4.mul(i,r),o=SIMD.float32x4.swizzle(o,1,0,3,2),s=SIMD.float32x4.add(SIMD.float32x4.mul(n,o),s),c=SIMD.float32x4.mul(t,o),o=SIMD.float32x4.swizzle(o,2,3,0,1),s=SIMD.float32x4.sub(s,SIMD.float32x4.mul(n,o)),c=SIMD.float32x4.sub(SIMD.float32x4.mul(t,o),c),c=SIMD.float32x4.swizzle(c,2,3,0,1),o=SIMD.float32x4.mul(SIMD.float32x4.swizzle(i,2,3,0,1),n),o=SIMD.float32x4.swizzle(o,1,0,3,2),r=SIMD.float32x4.swizzle(r,2,3,0,1),s=SIMD.float32x4.add(SIMD.float32x4.mul(r,o),s),h=SIMD.float32x4.mul(t,o),o=SIMD.float32x4.swizzle(o,2,3,0,1),s=SIMD.float32x4.sub(s,SIMD.float32x4.mul(r,o)),h=SIMD.float32x4.sub(SIMD.float32x4.mul(t,o),h),h=SIMD.float32x4.swizzle(h,2,3,0,1),o=SIMD.float32x4.mul(t,i),o=SIMD.float32x4.swizzle(o,1,0,3,2),h=SIMD.float32x4.add(SIMD.float32x4.mul(n,o),h),c=SIMD.float32x4.sub(SIMD.float32x4.mul(r,o),c),o=SIMD.float32x4.swizzle(o,2,3,0,1),h=SIMD.float32x4.sub(SIMD.float32x4.mul(n,o),h),c=SIMD.float32x4.sub(c,SIMD.float32x4.mul(r,o)),o=SIMD.float32x4.mul(t,n),o=SIMD.float32x4.swizzle(o,1,0,3,2),a=SIMD.float32x4.sub(a,SIMD.float32x4.mul(r,o)),h=SIMD.float32x4.add(SIMD.float32x4.mul(i,o),h),o=SIMD.float32x4.swizzle(o,2,3,0,1),a=SIMD.float32x4.add(SIMD.float32x4.mul(r,o),a),h=SIMD.float32x4.sub(h,SIMD.float32x4.mul(i,o)),o=SIMD.float32x4.mul(t,r),o=SIMD.float32x4.swizzle(o,1,0,3,2),a=SIMD.float32x4.add(SIMD.float32x4.mul(n,o),a),c=SIMD.float32x4.sub(c,SIMD.float32x4.mul(i,o)),o=SIMD.float32x4.swizzle(o,2,3,0,1),a=SIMD.float32x4.sub(a,SIMD.float32x4.mul(n,o)),c=SIMD.float32x4.add(SIMD.float32x4.mul(i,o),c),l=SIMD.float32x4.mul(t,s),l=SIMD.float32x4.add(SIMD.float32x4.swizzle(l,2,3,0,1),l),l=SIMD.float32x4.add(SIMD.float32x4.swizzle(l,1,0,3,2),l),o=SIMD.float32x4.reciprocalApproximation(l),l=SIMD.float32x4.sub(SIMD.float32x4.add(o,o),SIMD.float32x4.mul(l,SIMD.float32x4.mul(o,o))),l=SIMD.float32x4.swizzle(l,0,0,0,0),s=SIMD.float32x4.mul(l,s),a=SIMD.float32x4.mul(l,a),h=SIMD.float32x4.mul(l,h),c=SIMD.float32x4.mul(l,c),SIMD.float32x4.store(f,0,s),SIMD.float32x4.store(f,4,a),SIMD.float32x4.store(f,8,h),SIMD.float32x4.store(f,12,c),this},e.LookAtLHToRefSIMD=function(e,t,i,r){var n=r.m,o=SIMD.float32x4(t.x,t.y,t.z,0),s=SIMD.float32x4(e.x,e.y,e.z,0),a=SIMD.float32x4(i.x,i.y,i.z,0),h=SIMD.float32x4.sub(o,s),c=SIMD.float32x4.mul(h,h);c=SIMD.float32x4.add(c,SIMD.float32x4.add(SIMD.float32x4.swizzle(c,1,2,0,3),SIMD.float32x4.swizzle(c,2,0,1,3))),h=SIMD.float32x4.mul(h,SIMD.float32x4.reciprocalSqrtApproximation(c)),c=SIMD.float32x4.mul(a,a),c=SIMD.float32x4.add(c,SIMD.float32x4.add(SIMD.float32x4.swizzle(c,1,2,0,3),SIMD.float32x4.swizzle(c,2,0,1,3))),a=SIMD.float32x4.mul(a,SIMD.float32x4.reciprocalSqrtApproximation(c));var l=SIMD.float32x4.sub(SIMD.float32x4.mul(SIMD.float32x4.swizzle(h,1,2,0,3),SIMD.float32x4.swizzle(a,2,0,1,3)),SIMD.float32x4.mul(SIMD.float32x4.swizzle(h,2,0,1,3),SIMD.float32x4.swizzle(a,1,2,0,3)));c=SIMD.float32x4.mul(l,l),c=SIMD.float32x4.add(c,SIMD.float32x4.add(SIMD.float32x4.swizzle(c,1,2,0,3),SIMD.float32x4.swizzle(c,2,0,1,3))),l=SIMD.float32x4.mul(l,SIMD.float32x4.reciprocalSqrtApproximation(c));var u=SIMD.float32x4.sub(SIMD.float32x4.mul(SIMD.float32x4.swizzle(l,1,2,0,3),SIMD.float32x4.swizzle(h,2,0,1,3)),SIMD.float32x4.mul(SIMD.float32x4.swizzle(l,2,0,1,3),SIMD.float32x4.swizzle(h,1,2,0,3)));c=SIMD.float32x4.mul(l,l),c=SIMD.float32x4.add(c,SIMD.float32x4.add(SIMD.float32x4.swizzle(c,1,2,0,3),SIMD.float32x4.swizzle(c,2,0,1,3))),l=SIMD.float32x4.mul(l,SIMD.float32x4.reciprocalSqrtApproximation(c));var f=SIMD.float32x4.splat(0);l=SIMD.float32x4.neg(l);var d=SIMD.float32x4.shuffle(l,u,0,1,4,5),p=SIMD.float32x4.shuffle(h,f,0,1,4,5),_=SIMD.float32x4.shuffle(d,p,0,2,4,6),m=SIMD.float32x4.shuffle(d,p,1,3,5,7);d=SIMD.float32x4.shuffle(l,u,2,3,6,7),p=SIMD.float32x4.shuffle(h,f,2,3,6,7);var g=SIMD.float32x4.shuffle(d,p,0,2,4,6),v=SIMD.float32x4(0,0,0,1),y=SIMD.float32x4(1,0,0,0),x=SIMD.float32x4(0,1,0,0),b=SIMD.float32x4(0,0,1,0),P=SIMD.float32x4.neg(s);P=SIMD.float32x4.withW(P,1),SIMD.float32x4.store(n,0,SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(y,0,0,0,0),_),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(y,1,1,1,1),m),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(y,2,2,2,2),g),SIMD.float32x4.mul(SIMD.float32x4.swizzle(y,3,3,3,3),v))))),SIMD.float32x4.store(n,4,SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(x,0,0,0,0),_),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(x,1,1,1,1),m),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(x,2,2,2,2),g),SIMD.float32x4.mul(SIMD.float32x4.swizzle(x,3,3,3,3),v))))),SIMD.float32x4.store(n,8,SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(b,0,0,0,0),_),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(b,1,1,1,1),m),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(b,2,2,2,2),g),SIMD.float32x4.mul(SIMD.float32x4.swizzle(b,3,3,3,3),v))))),SIMD.float32x4.store(n,12,SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(P,0,0,0,0),_),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(P,1,1,1,1),m),SIMD.float32x4.add(SIMD.float32x4.mul(SIMD.float32x4.swizzle(P,2,2,2,2),g),SIMD.float32x4.mul(SIMD.float32x4.swizzle(P,3,3,3,3),v)))))},e}();e.SIMDMatrix=i;var r=e.Matrix.prototype.multiplyToArray,n=e.Matrix.prototype.invertToRef,o=e.Matrix.LookAtLHToRef,s=e.Vector3.TransformCoordinatesToRef,a=e.Vector3.TransformCoordinatesFromFloatsToRef,h=function(){function h(){}return Object.defineProperty(h,"IsEnabled",{get:function(){return h._isEnabled},enumerable:!0,configurable:!0}),h.DisableSIMD=function(){e.Matrix.prototype.multiplyToArray=r,e.Matrix.prototype.invertToRef=n,e.Matrix.LookAtLHToRef=o,e.Vector3.TransformCoordinatesToRef=s,e.Vector3.TransformCoordinatesFromFloatsToRef=a,h._isEnabled=!1},h.EnableSIMD=function(){void 0!==window.SIMD&&(e.Matrix.prototype.multiplyToArray=i.prototype.multiplyToArraySIMD,e.Matrix.prototype.invertToRef=i.prototype.invertToRefSIMD,e.Matrix.LookAtLHToRef=i.LookAtLHToRefSIMD,e.Vector3.TransformCoordinatesToRef=t.TransformCoordinatesToRefSIMD,e.Vector3.TransformCoordinatesFromFloatsToRef=t.TransformCoordinatesFromFloatsToRefSIMD,Object.defineProperty(e.Vector3.prototype,"x",{get:function(){return this._data[0]},set:function(e){this._data||(this._data=new Float32Array(3)),this._data[0]=e}}),Object.defineProperty(e.Vector3.prototype,"y",{get:function(){return this._data[1]},set:function(e){this._data[1]=e}}),Object.defineProperty(e.Vector3.prototype,"z",{get:function(){return this._data[2]},set:function(e){this._data[2]=e}}),h._isEnabled=!0)},h._isEnabled=!1,h}();e.SIMDHelper=h}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(e,t,i,r){this._pos=i,this._size=r,this._root=e,this._parent=t}return Object.defineProperty(t.prototype,"pos",{get:function(){return this._pos},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contentSize",{get:function(){return this._contentSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"UVs",{get:function(){var t=this._root._size.width,i=this._root._size.height,r=new e.Vector2(this._pos.x/t,this._pos.y/i),n=new e.Vector2((this._pos.x+this._contentSize.width-1)/t,(this._pos.y+this._contentSize.height-1)/i),o=new Array;return o.push(r),o.push(new e.Vector2(n.x,r.y)),o.push(n),o.push(new e.Vector2(r.x,n.y)),o},enumerable:!0,configurable:!0}),t.prototype.freeContent=function(){this.contentSize&&(this._contentSize=null,this.attemptDefrag())},Object.defineProperty(t.prototype,"isUsed",{get:function(){return null!=this._contentSize||null!=this._leftNode},enumerable:!0,configurable:!0}),t.prototype.findAndSplitNode=function(e){var t=this.findNode(e);return t?(t.splitNode(e),t):null},t.prototype.findNode=function(e){var t=null;return this.isUsed?(this._leftNode&&(t=this._leftNode.findNode(e)),!t&&this._rightNode&&(t=this._rightNode.findNode(e)),!t&&this._bottomNode&&(t=this._bottomNode.findNode(e))):this._initialSize&&e.width<=this._initialSize.width&&e.height<=this._initialSize.height?t=this:e.width<=this._size.width&&e.height<=this._size.height&&(t=this),t},t.prototype.splitNode=function(i){return!this._contentSize&&this._initialSize?(this._leftNode=new t(this._root,this,new e.Vector2(this._pos.x,this._pos.y),new e.Size(this._initialSize.width,this._initialSize.height)),this._leftNode.splitNode(i)):(this._contentSize=i.clone(),this._initialSize=i.clone(),i.width!==this._size.width&&(this._rightNode=new t(this._root,this,new e.Vector2(this._pos.x+i.width,this._pos.y),new e.Size(this._size.width-i.width,i.height))),i.height!==this._size.height&&(this._bottomNode=new t(this._root,this,new e.Vector2(this._pos.x,this._pos.y+i.height),new e.Size(this._size.width,this._size.height-i.height))),this)},t.prototype.attemptDefrag=function(){!this.isUsed&&this.isRecursiveFree&&(this.clearNode(),this._parent&&this._parent.attemptDefrag())},t.prototype.clearNode=function(){this._initialSize=null,this._rightNode=null,this._bottomNode=null},Object.defineProperty(t.prototype,"isRecursiveFree",{get:function(){return!this.contentSize&&(!this._leftNode||this._leftNode.isRecursiveFree)&&(!this._rightNode||this._rightNode.isRecursiveFree)&&(!this._bottomNode||this._bottomNode.isRecursiveFree)},enumerable:!0,configurable:!0}),t.prototype.evalFreeSize=function(e){var t=0;return this.isUsed||(t=this._initialSize?this._initialSize.surface:this._size.surface),this._rightNode&&(t+=this._rightNode.evalFreeSize(0)),this._bottomNode&&(t+=this._bottomNode.evalFreeSize(0)),t+e},t}();e.PackedRect=t;var i=function(t){function i(i){t.call(this,null,null,e.Vector2.Zero(),i),this._root=this}return __extends(i,t),i.prototype.addRect=function(e){var t=this.findAndSplitNode(e);return t},Object.defineProperty(i.prototype,"freeSpace",{get:function(){var e=0;return e=this.evalFreeSize(e),e/(this._size.width*this._size.height)},enumerable:!0,configurable:!0}),i}(t);e.RectPackingMap=i}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function e(){}return e}();e.DynamicFloatArrayElementInfo=t;var i=function(){function e(e,i){this.compareValueOffset=null,this.sortingAscending=!0,this._stride=e,this.buffer=new Float32Array(e*i),this._lastUsed=0,this._firstFree=0,this._allEntries=new Array(i),this._freeEntries=new Array(i);for(var r=0;i>r;r++){var n=new t;n.offset=r*e,this._allEntries[r]=n,this._freeEntries[i-r-1]=n}}return e.prototype.allocElement=function(){0===this._freeEntries.length&&this._growBuffer();var e=this._freeEntries.pop();return this._lastUsed=Math.max(e.offset,this._lastUsed),e.offset===this._firstFree&&(this._freeEntries.length>0?this._firstFree=this._freeEntries[this._freeEntries.length-1].offset:this._firstFree+=this._stride),e},e.prototype.freeElement=function(e){this._firstFree=Math.min(e.offset,this._firstFree),this._freeEntries.push(e)},e.prototype.pack=function(){if(0===this._freeEntries.length)return this.buffer;if(this._lastUsed<this._firstFree){var e=this.buffer.subarray(0,this._lastUsed+this._stride);return e}var i=this._stride,r=new t;r.offset=this.totalElementCount*i,this._freeEntries.push(r);for(var n=this._freeEntries.sort(function(e,t){return e.offset-t.offset}),o=this._allEntries.sort(function(e,t){return e.offset-t.offset}),s=n[0].offset,a=1,h=(this.usedElementCount+1)*i,c=n[0].offset,l=1;l<n.length&&!(s>=h);l++){var u=n[l],f=u.offset,d=f-c;if(d!==i){for(var p=d/i-1,_=f-i,m=Math.min(a,p),g=0;m>g;g++){var v=s/i,y=_/i,x=o[y];this._moveElement(x,s);var b=o[v];b.offset=_,o[v]=x,o[y]=b,_-=i,s+=i}p>=a?(s=_+i,a=1+m):a=(f-s)/i+1,c=f}else++a,c=f}var P=this.buffer.subarray(0,s);return this._lastUsed=s-i,this._firstFree=s,n.pop(),this._freeEntries=n.sort(function(e,t){return t.offset-e.offset}),this._allEntries=o,P},e.prototype._moveElement=function(e,t){for(var i=0;i<this._stride;i++)this.buffer[t+i]=this.buffer[e.offset+i];e.offset=t},e.prototype._growBuffer=function(){var e=Math.floor(1.5*this.totalElementCount),i=new Float32Array(e*this._stride);i.set(this.buffer);for(var r=this.totalElementCount,n=e-this.totalElementCount,o=0;n>o;o++){var s=new t;s.offset=(r+o)*this.stride,this._allEntries.push(s),this._freeEntries[n-o-1]=s}this._firstFree=r*this.stride,this.buffer=i},Object.defineProperty(e.prototype,"totalElementCount",{get:function(){return this._allEntries.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"freeElementCount",{get:function(){return this._freeEntries.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"usedElementCount",{get:function(){return this._allEntries.length-this._freeEntries.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stride",{get:function(){return this._stride},enumerable:!0,configurable:!0}),e.prototype.sort=function(){var e=this;if(!this.compareValueOffset)throw new Error("The DynamicFloatArray.sort() method needs a valid 'compareValueOffset' property");var t=this.usedElementCount;if(!this._sortTable||this._sortTable.length<t){var i=Math.min(this.totalElementCount,2*t);this._sortTable=new Array(i),this._sortedTable=new Array(i)}this.pack();for(var n=0,o=this.stride,s=0;t>s;s++,n+=o){var a=this._sortTable[s];a||(a=new r,this._sortTable[s]=a),a.compareData=this.buffer[n+this.compareValueOffset],a.offset=n,a.swapedOffset=null,this._sortedTable[s]=a}this.sortingAscending?this._sortedTable.sort(function(e,t){return e.compareData-t.compareData}):this._sortedTable.sort(function(e,t){return t.compareData-e.compareData});for(var h=function(t,i){for(var r=0;o>r;r++){var n=e.buffer[i+r];e.buffer[i+r]=e.buffer[t+r],e.buffer[t+r]=n}},s=0;t>s;s++){var c=this._sortedTable[s],l=this._sortTable[s],u=c.offset;if(c.swapedOffset){for(var f=c;f.swapedOffset;)f=this._sortTable[f.swapedOffset/o];u=f.offset}l.swapedOffset=u,u!==l.offset&&h(u,l.offset),this._allEntries[c.offset/o].offset=l.offset}return this._allEntries.sort(function(e,t){return e.offset-t.offset}),!0},e}();e.DynamicFloatArray=i;var r=function(){function e(){this.compareData=this.offset=this.swapedOffset=null}return e}()}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function e(){}return e}();e.CharInfo=t;var i=function(i){function r(t,r,n,o,s){void 0===o&&(o=200),void 0===s&&(s=e.Texture.TRILINEAR_SAMPLINGMODE),i.call(this,null,n,!0,!1,s),this._charInfos={},this._curCharCount=0,this._lastUpdateCharCount=-1,this._usedCounter=1,this.name=t,this.wrapU=e.Texture.CLAMP_ADDRESSMODE,this.wrapV=e.Texture.CLAMP_ADDRESSMODE,this._canvas=document.createElement("canvas"),this._context=this._canvas.getContext("2d"),this._context.font=r,this._context.fillStyle="white";var a=this.getFontHeight(r);this._lineHeight=a.height,this._offset=a.offset-1;var h=this._context.measureText("W").width;this._spaceWidth=this._context.measureText(" ").width;var c=this._lineHeight*h*o,l=Math.sqrt(c),u=Math.pow(2,Math.ceil(Math.log(l)/Math.log(2)));this._texture=n.getEngine().createDynamicTexture(u,u,!1,s);var f=this.getSize();this._canvas=document.createElement("canvas"),this._canvas.width=f.width,this._canvas.height=f.height,this._context=this._canvas.getContext("2d"),this._context.textBaseline="top",this._context.font=r,this._context.fillStyle="white",this._context.imageSmoothingEnabled=!1,this._currentFreePosition=e.Vector2.Zero();for(var d=32;127>d;d++){var p=String.fromCharCode(d);this.getChar(p)}this.update()}return __extends(r,i),Object.defineProperty(r.prototype,"spaceWidth",{get:function(){return this._spaceWidth},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"lineHeight",{get:function(){return this._lineHeight},enumerable:!0,configurable:!0}),r.GetCachedFontTexture=function(t,i){var n=t;n.__fontTextureCache__||(n.__fontTextureCache__=new e.StringDictionary);var o=n.__fontTextureCache__,s=i.toLocaleLowerCase(),a=o.get(s);return a?(++a._usedCounter,a):(a=new r(null,s,t,200,e.Texture.NEAREST_SAMPLINGMODE),o.add(s,a),a)},r.ReleaseCachedFontTexture=function(e,t){var i=e,r=i.__fontTextureCache__;if(r){var n=t.toLocaleLowerCase(),o=r.get(n);0===--o._usedCounter&&(r.remove(n),o.dispose())}},r.prototype.getChar=function(i){if(1!==i.length)return null;var r=this._charInfos[i];if(r)return r;r=new t;var n=this._context.measureText(i),o=this.getSize(),s=2,a=2,h=n.width;return this._currentFreePosition.x+h+s>o.width&&(this._currentFreePosition.x=0,this._currentFreePosition.y+=this._lineHeight+a,this._currentFreePosition.y>o.height)?this.getChar("!"):(this._context.fillText(i,this._currentFreePosition.x-.5,this._currentFreePosition.y-this._offset-.5),r.topLeftUV=new e.Vector2(this._currentFreePosition.x/o.width,this._currentFreePosition.y/o.height),r.bottomRightUV=new e.Vector2(r.topLeftUV.x+h/o.width,r.topLeftUV.y+(this._lineHeight+2)/o.height),r.charWidth=h,this._charInfos[i]=r,this._curCharCount++,this._currentFreePosition.x+=h+s,r)},r.prototype.measureText=function(t,i){void 0===i&&(i=4);for(var r=0,n=0,o=1,s=0,a=0;a<t.length;a++){var h=t[a];if("\n"!==h)if("	"!==h)" ">h||(n+=this.getChar(h).charWidth,++s);else{var c=s+i;c-=c%i,n+=(c-s)*this.spaceWidth,s=c}else r=Math.max(r,n),s=0,n=0,++o}return r=Math.max(r,n),new e.Size(r,o*this._lineHeight)},r.prototype.getFontHeight=function(e){var t=document.createElement("canvas"),i=t.getContext("2d");i.fillRect(0,0,t.width,t.height),i.textBaseline="top",i.fillStyle="white",i.font=e,i.fillText("jH|",0,0);for(var r=i.getImageData(0,0,t.width,t.height).data,n=-1,o=-1,s=0;s<t.height;s++)for(var a=0;a<t.width;a++){var h=4*(s*t.width+a);{if(0!==r[h]){-1===n&&(n=s);break}if(a===t.width-1&&-1!==n){o=s,s=t.height;break}}}return{height:o-n,offset:n-1}},Object.defineProperty(r.prototype,"canRescale",{get:function(){return!1},enumerable:!0,configurable:!0}),r.prototype.getContext=function(){return this._context},r.prototype.update=function(){this._lastUpdateCharCount<this._curCharCount&&(this.getScene().getEngine().updateDynamicTexture(this._texture,this._canvas,!1,!0),this._lastUpdateCharCount=this._curCharCount)},r.prototype.clone=function(){return null},r}(e.Texture);e.FontTexture=i}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(i,r,n,o){void 0===o&&(o=e.Texture.TRILINEAR_SAMPLINGMODE),t.call(this,null,r,!0,!1,o),this.name=i,this._size=n,this.wrapU=e.Texture.CLAMP_ADDRESSMODE,this.wrapV=e.Texture.CLAMP_ADDRESSMODE,this._rectPackingMap=new e.RectPackingMap(new e.Size(n.width,n.height)),this._texture=r.getEngine().createRenderTargetTexture(n,{generateMipMaps:!this.noMipmap,type:e.Engine.TEXTURETYPE_UNSIGNED_INT})}return __extends(i,t),i.prototype.allocateRect=function(e){return this._rectPackingMap.addRect(e)},i.prototype.freeRect=function(e){e&&e.freeContent()},Object.defineProperty(i.prototype,"freeSpace",{get:function(){return this._rectPackingMap.freeSpace},enumerable:!0,configurable:!0}),i.prototype.bindTextureForRect=function(e,t){return this.bindTextureForPosSize(e.pos,e.contentSize,t)},i.prototype.bindTextureForPosSize=function(t,i,r){var n=this.getScene().getEngine();n.bindFramebuffer(this._texture),this._replacedViewport=n.setDirectViewport(t.x,t.y,i.width,i.height),r&&n.scissorClear(t.x,t.y,i.width,i.height,new e.Color4(0,0,0,0))},i.prototype.unbindTexture=function(t){t&&e.Tools.DumpFramebuffer(this._size.width,this._size.height,this.getScene().getEngine());var i=this.getScene().getEngine();this._replacedViewport&&(i.setViewport(this._replacedViewport),this._replacedViewport=null),i.unBindFramebuffer(this._texture)},Object.defineProperty(i.prototype,"canRescale",{get:function(){return!1},enumerable:!0,configurable:!0}),i.prototype.clone=function(){return null},i}(e.Texture);e.MapTexture=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(){this.radius=0,this.center=e.Vector2.Zero(),this.extent=e.Vector2.Zero()}return t.CreateFromSize=function(e){var i=new t;return t.CreateFromSizeToRef(e,i),i},t.CreateFromRadius=function(e){var i=new t;return t.CreateFromRadiusToRef(e,i),i},t.CreateFromPoints=function(e){var i=new t;return t.CreateFromPointsToRef(e,i),i},t.CreateFromSizeToRef=function(t,i){t||(t=e.Size.Zero()),i.center.x=+t.width/2,i.center.y=+t.height/2,i.extent.x=i.center.x,i.extent.y=i.center.y,i.radius=i.extent.length()},t.CreateFromRadiusToRef=function(e,t){t.center.x=t.center.y=0;var i=+e;t.extent.x=i,t.extent.y=i,t.radius=i},t.CreateFromPointsToRef=function(e,i){for(var r=Number.MAX_VALUE,n=Number.MAX_VALUE,o=Number.MIN_VALUE,s=Number.MIN_VALUE,a=0;a<e.length;a++){var h=e[a];r=Math.min(h.x,r),o=Math.max(h.x,o),n=Math.min(h.y,n),s=Math.max(h.y,s)}t.CreateFromMinMaxToRef(r,o,n,s,i)},t.CreateFromMinMaxToRef=function(t,i,r,n,o){var s=i-t,a=n-r;o.center=new e.Vector2(t+s/2,r+a/2),o.extent=new e.Vector2(i-o.center.x,n-o.center.y),o.radius=o.extent.length()},t.prototype.clone=function(){var e=new t;return e.center=this.center.clone(),e.radius=this.radius,e.extent=this.extent.clone(),e},t.prototype.max=function(){var t=e.Vector2.Zero();return this.maxToRef(t),t},t.prototype.maxToRef=function(e){e.x=this.center.x+this.extent.x,e.y=this.center.y+this.extent.y},t.prototype.transform=function(e){var i=new t;return this.transformToRef(e,i),i},t.prototype.union=function(e){var i=new t;return this.unionToRef(e,i),i},t.prototype.transformToRef=function(i,r){var n=t._transform;n[0].x=this.center.x+this.extent.x,n[0].y=this.center.y+this.extent.y,n[1].x=this.center.x+this.extent.x,n[1].y=this.center.y-this.extent.y,n[2].x=this.center.x-this.extent.x,n[2].y=this.center.y-this.extent.y,n[3].x=this.center.x-this.extent.x,n[3].y=this.center.y+this.extent.y;for(var o=0;4>o;o++)e.Vector2.TransformToRef(n[o],i,n[o]);t.CreateFromPointsToRef(n,r)},t.prototype.unionToRef=function(e,i){var r=Math.max(this.center.x+this.extent.x,e.center.x+e.extent.x),n=Math.max(this.center.y+this.extent.y,e.center.y+e.extent.y),o=Math.min(this.center.x-this.extent.x,e.center.x-e.extent.x),s=Math.min(this.center.y-this.extent.y,e.center.y-e.extent.y);t.CreateFromMinMaxToRef(o,r,s,n,i)},t.prototype.doesIntersect=function(e){var t=e.subtract(this.center);return t.lengthSquared()<=this.radius*this.radius?Math.abs(t.x)<=this.extent.x&&Math.abs(t.y)<=this.extent.y:!1},t._transform=new Array(e.Vector2.Zero(),e.Vector2.Zero(),e.Vector2.Zero(),e.Vector2.Zero()),t}();e.BoundingInfo2D=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function e(){}return e.prototype.isLocked=function(){return this._isLocked},e.prototype.lock=function(){return this._isLocked?!0:(this.onLock(),this._isLocked=!0,!1)},e.prototype.onLock=function(){},e}();e.LockableBase=t;var i=function(t){function i(e,i){void 0===i&&(i=!1),t.call(this),this._color=e,i&&this.lock()}return __extends(i,t),i.prototype.isTransparent=function(){return this._color&&this._color.a<1},Object.defineProperty(i.prototype,"color",{get:function(){return this._color},set:function(e){this.isLocked()||(this._color=e)},enumerable:!0,configurable:!0}),i.prototype.toString=function(){return this._color.toHexString()},i=__decorate([e.className("SolidColorBrush2D")],i)}(t);e.SolidColorBrush2D=i;var r=function(t){function i(i,r,n,o,s,a){void 0===n&&(n=e.Vector2.Zero()),void 0===o&&(o=0),void 0===s&&(s=1),void 0===a&&(a=!1),t.call(this),this._color1=i,this._color2=r,this._translation=n,this._rotation=o,this._scale=s,a&&this.lock()}return __extends(i,t),i.prototype.isTransparent=function(){return this._color1&&this._color1.a<1||this._color2&&this._color2.a<1},Object.defineProperty(i.prototype,"color1",{get:function(){return this._color1},set:function(e){this.isLocked()||(this._color1=e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"color2",{get:function(){return this._color2},set:function(e){this.isLocked()||(this._color2=e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"translation",{get:function(){return this._translation},set:function(e){this.isLocked()||(this._translation=e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"rotation",{get:function(){return this._rotation},set:function(e){this.isLocked()||(this._rotation=e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"scale",{get:function(){return this._scale},set:function(e){this.isLocked()||(this._scale=e)},enumerable:!0,configurable:!0}),i.prototype.toString=function(){return"C1:"+this._color1+";C2:"+this._color2+";T:"+this._translation.toString()+";R:"+this._rotation+";S:"+this._scale+";"},i.BuildKey=function(e,t,i,r,n){return"C1:"+e+";C2:"+t+";T:"+i.toString()+";R:"+r+";S:"+n+";"},i=__decorate([e.className("GradientColorBrush2D")],i)}(t);e.GradientColorBrush2D=r}(BABYLON||(BABYLON={}));var BABYLON;!function(e){function t(e,t,i,r){return void 0===i&&(i=!1),void 0===r&&(r=!1),h._hookProperty(e,t,i,r,o.PROPKIND_MODEL)}function i(e,t,i,r){return void 0===i&&(i=!1),void 0===r&&(r=!1),h._hookProperty(e,t,i,r,o.PROPKIND_INSTANCE)}function r(e,t,i,r){return void 0===i&&(i=!1),void 0===r&&(r=!1),h._hookProperty(e,t,i,r,o.PROPKIND_DYNAMIC)}var n=function(){function e(){}return e}();e.Prim2DClassInfo=n;var o=function(){function e(){}return e.PROPKIND_MODEL=1,e.PROPKIND_INSTANCE=2,e.PROPKIND_DYNAMIC=3,e}();e.Prim2DPropInfo=o;var s=function(){function e(){}return e}();e.PropertyChangedInfo=s;var a=function(){function t(t,i,r){this._baseClass=t,this._type=i,this._subClasses=new Array,this._levelContent=new e.StringDictionary,this._classContentFactory=r}return Object.defineProperty(t.prototype,"classContent",{get:function(){return this._classContent||(this._classContent=this._classContentFactory(this._baseClass?this._baseClass.classContent:null)),this._classContent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"levelContent",{get:function(){return this._levelContent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fullContent",{get:function(){if(!this._fullContent){for(var t=new e.StringDictionary,i=this;i;)i.levelContent.forEach(function(e,i){return t.add(e,i)}),i=i._baseClass;this._fullContent=t}return this._fullContent},enumerable:!0,configurable:!0}),t.prototype.getLevelOf=function(e){if(e===this._type)return this;var t=Object.getPrototypeOf(e),i=this.getOrAddType(Object.getPrototypeOf(t),t);return i||this.getLevelOf(t),this.getOrAddType(t,e)},t.prototype.getOrAddType=function(e,i){if(e===this._type){for(var r=0,n=this._subClasses;r<n.length;r++){var o=n[r];if(o.type===i)return o.node}var s=new t(this,i,this._classContentFactory),a={type:i,node:s};return this._subClasses.push(a),a.node}for(var h=0,c=this._subClasses;h<c.length;h++){var o=c[h],a=o.node.getOrAddType(e,i);if(a)return a}return null},t.get=function(e){var t=e.__classTreeInfo;return t?t.getLevelOf(e):null},t.getOrRegister=function(e,i){var r=e.__classTreeInfo;return r||(r=new t(null,e,i),e.__classTreeInfo=r),r},t}();e.ClassTreeInfo=a;var h=function(){function t(){this._flags=0,this._modelKey=null,this._instanceDirtyFlags=0,this._levelBoundingInfo=new e.BoundingInfo2D,this.animations=new Array}return Object.defineProperty(t.prototype,"isDisposed",{get:function(){return this._isFlagSet(t.flagIsDisposed)},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){return this.isDisposed?!1:(this.animations.splice(0),this._setFlags(t.flagIsDisposed),!0)},t.prototype.getAnimatables=function(){return new Array},Object.defineProperty(t.prototype,"modelKey",{get:function(){var i=this;if(!this._isFlagSet(t.flagModelDirty)&&this._modelKey)return this._modelKey;var r="Class:"+e.Tools.getClassName(this)+";",n=this.propDic;return n.forEach(function(t,n){if(n.kind===o.PROPKIND_MODEL){var s=i[n.name];if(s&&s.constructor===Array){var a=s[0];s=a?e.Tools.hashCodeFromStream(e.Tools.arrayOrStringFeeder(s)):0}r+=n.name+":"+(null!=s?n.typeLevelCompare?e.Tools.getClassName(s):s.toString():"[null]")+";"}}),this._clearFlags(t.flagModelDirty),this._modelKey=r,r},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isDirty",{get:function(){return 0!==this._instanceDirtyFlags||this._areSomeFlagsSet(t.flagModelDirty|t.flagPositioningDirty|t.flagLayoutDirty)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"propDic",{get:function(){if(!this._propInfo){var e=a.get(Object.getPrototypeOf(this));if(!e)throw new Error("Can't access the propDic member in class definition, is this class SmartPropertyPrim based?");this._propInfo=e.fullContent}return this._propInfo},enumerable:!0,configurable:!0}),t._createPropInfo=function(e,t,i,r,s,h){var c=a.getOrRegister(e,function(){return new n}),l=c.getLevelOf(e),u=l.levelContent.get(i.toString());if(u)throw new Error("The ID "+i+" is already taken by another property declaration named: "+u.name);return u=new o,u.id=i,u.flagId=Math.pow(2,i),u.kind=h,u.name=t,u.dirtyBoundingInfo=r,u.typeLevelCompare=s,l.levelContent.add(t,u),u},t._checkUnchanged=function(e,t){if(null===e&&null===t||void 0===e&&void 0===t)return!0;if(null!=e&&null!=t)if("function"==typeof e.equals){if(e.equals(t))return!0}else if(e===t)return!0;return!1},t.prototype.markAsDirty=function(e){if(!this.isDisposed){var t=e.indexOf(".");-1!==t&&(e=e.substr(0,t));var i=this.propDic.get(e);if(i){var r=this[e];this._handlePropChanged(void 0,r,e,i,i.typeLevelCompare)}}},t.prototype._boundingBoxDirty=function(){if(this._setFlags(t.flagLevelBoundingInfoDirty),this instanceof e.Prim2DBase)for(var i=this;i&&(i._boundingSize=null,i._setFlags(t.flagBoundingInfoDirty),i.isSizeAuto&&i.onPrimitivePropertyDirty(e.Prim2DBase.sizeProperty.flagId),!(i instanceof e.Group2D&&i.isRenderableGroup));)i=i.parent;
},t.prototype._handlePropChanged=function(i,r,n,s,a){s.dirtyBoundingInfo&&this._boundingBoxDirty();var h=t.propChangedInfo;h.oldValue=i,h.newValue=r,h.propertyName=n;var c=s.flagId;if(this.propertyChanged.notifyObservers(h,c),this instanceof e.Group2D&&this.handleGroupChanged(s),this instanceof e.Prim2DBase){var l=this._parent;null!=l&&l.layoutEngine&&0!==(l.layoutEngine.layoutDirtyOnPropertyChangedMask&s.flagId)&&l._setLayoutDirty()}var u=!1;if(a&&null!=i&&null!=r){var f=i.__proto__,d=r.__proto__;u=f===d}u||s.kind!==o.PROPKIND_MODEL?(u||s.kind===o.PROPKIND_INSTANCE||s.kind===o.PROPKIND_DYNAMIC)&&this.onPrimitivePropertyDirty(c):this.onPrimitivePropertyDirty(t.flagModelDirty)},t.prototype.onPrimitivePropertyDirty=function(e){this.isDirty||this.onPrimBecomesDirty(),this._instanceDirtyFlags|=e},t.prototype.handleGroupChanged=function(e){},t.prototype.checkPropertiesDirty=function(e){return 0!==(this._instanceDirtyFlags&e)},t.prototype.clearPropertiesDirty=function(e){return this._instanceDirtyFlags&=~e,this._instanceDirtyFlags},t.prototype._resetPropertiesDirty=function(){this._instanceDirtyFlags=0},Object.defineProperty(t.prototype,"levelBoundingInfo",{get:function(){return this._isFlagSet(t.flagLevelBoundingInfoDirty)&&(this.updateLevelBoundingInfo(),this._clearFlags(t.flagLevelBoundingInfoDirty)),this._levelBoundingInfo},enumerable:!0,configurable:!0}),t.prototype.updateLevelBoundingInfo=function(){},t.prototype.onPrimBecomesDirty=function(){},t._hookProperty=function(e,i,r,n,o){return function(s,a,h){var c=t._createPropInfo(s,a,e,n,r,o);i&&i(c);var l=h.get,u=h.set;h.set=function(e){if(!this.isDisposed){var i=l.call(this);if(!t._checkUnchanged(i,e)){var n=this;u.call(this,e),n._handlePropChanged(i,e,a,c,r)}}}}},t.prototype.addExternalData=function(t,i){return this._externalData||(this._externalData=new e.StringDictionary),this._externalData.add(t,i)},t.prototype.getExternalData=function(e){return this._externalData?this._externalData.get(e):null},t.prototype.getOrAddExternalDataWithFactory=function(t,i){return this._externalData||(this._externalData=new e.StringDictionary),this._externalData.getOrAddWithFactory(t,i)},t.prototype.removeExternalData=function(e){return this._externalData?this._externalData.remove(e):!1},t.prototype._isFlagSet=function(e){return 0!==(this._flags&e)},t.prototype._areAllFlagsSet=function(e){return(this._flags&e)===e},t.prototype._areSomeFlagsSet=function(e){return 0!==(this._flags&e)},t.prototype._clearFlags=function(e){this._flags&=~e},t.prototype._setFlags=function(e){var t=this._flags;return this._flags|=e,t},t.prototype._changeFlags=function(e,t){t?this._flags|=e:this._flags&=~e},t.propChangedInfo=new s,t.flagIsDisposed=1,t.flagLevelBoundingInfoDirty=2,t.flagModelDirty=4,t.flagLayoutDirty=8,t.flagLevelVisible=16,t.flagBoundingInfoDirty=32,t.flagIsPickable=64,t.flagIsVisible=128,t.flagVisibilityChanged=256,t.flagPositioningDirty=512,t.flagTrackedGroup=1024,t=__decorate([e.className("SmartPropertyPrim")],t)}();e.SmartPropertyPrim=h,e.modelLevelProperty=t,e.instanceLevelProperty=i,e.dynamicLevelProperty=r}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function e(){this.forceRefreshPrimitive=!1}return e}();e.PrepareRender2DContext=t;var i=function(){function e(e){this._renderMode=e,this.useInstancing=!1,this.groupInfoPartData=null,this.partDataStartIndex=this.partDataEndIndex=null}return Object.defineProperty(e.prototype,"renderMode",{get:function(){return this._renderMode},enumerable:!0,configurable:!0}),Object.defineProperty(e,"RenderModeOpaque",{get:function(){return e._renderModeOpaque},enumerable:!0,configurable:!0}),Object.defineProperty(e,"RenderModeAlphaTest",{get:function(){return e._renderModeAlphaTest},enumerable:!0,configurable:!0}),Object.defineProperty(e,"RenderModeTransparent",{get:function(){return e._renderModeTransparent},enumerable:!0,configurable:!0}),e._renderModeOpaque=1,e._renderModeAlphaTest=2,e._renderModeTransparent=3,e}();e.Render2DContext=i;var r=function(){function t(){this.primitivePointerPos=e.Vector2.Zero(),this.tilt=e.Vector2.Zero(),this.cancelBubble=!1}return Object.defineProperty(t,"PointerOver",{get:function(){return t._pointerOver},enumerable:!0,configurable:!0}),Object.defineProperty(t,"PointerEnter",{get:function(){return t._pointerEnter},enumerable:!0,configurable:!0}),Object.defineProperty(t,"PointerDown",{get:function(){return t._pointerDown},enumerable:!0,configurable:!0}),Object.defineProperty(t,"PointerMouseWheel",{get:function(){return t._pointerMouseWheel},enumerable:!0,configurable:!0}),Object.defineProperty(t,"PointerMove",{get:function(){return t._pointerMove},enumerable:!0,configurable:!0}),Object.defineProperty(t,"PointerUp",{get:function(){return t._pointerUp},enumerable:!0,configurable:!0}),Object.defineProperty(t,"PointerOut",{get:function(){return t._pointerOut},enumerable:!0,configurable:!0}),Object.defineProperty(t,"PointerLeave",{get:function(){return t._pointerLeave},enumerable:!0,configurable:!0}),Object.defineProperty(t,"PointerGotCapture",{get:function(){return t._pointerGotCapture},enumerable:!0,configurable:!0}),Object.defineProperty(t,"PointerLostCapture",{get:function(){return t._pointerLostCapture},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MouseWheelPrecision",{get:function(){return t._mouseWheelPrecision},enumerable:!0,configurable:!0}),t.prototype.updateRelatedTarget=function(e,t){this.relatedTarget=e,this.relatedTargetPointerPos=t},t.getEventTypeName=function(e){switch(e){case t.PointerOver:return"PointerOver";case t.PointerEnter:return"PointerEnter";case t.PointerDown:return"PointerDown";case t.PointerMouseWheel:return"PointerMouseWheel";case t.PointerMove:return"PointerMove";case t.PointerUp:return"PointerUp";case t.PointerOut:return"PointerOut";case t.PointerLeave:return"PointerLeave";case t.PointerGotCapture:return"PointerGotCapture";case t.PointerLostCapture:return"PointerLostCapture"}},t._pointerOver=1,t._pointerEnter=2,t._pointerDown=4,t._pointerMouseWheel=8,t._pointerMove=16,t._pointerUp=32,t._pointerOut=64,t._pointerLeave=128,t._pointerGotCapture=256,t._pointerLostCapture=512,t._mouseWheelPrecision=3,t}();e.PrimitivePointerInfo=r;var n=function(){function e(t){this._changedCallback=t,this._horizontal=e.AlignLeft,this._vertical=e.AlignBottom}return Object.defineProperty(e,"AlignLeft",{get:function(){return e._AlignLeft},enumerable:!0,configurable:!0}),Object.defineProperty(e,"AlignTop",{get:function(){return e._AlignTop},enumerable:!0,configurable:!0}),Object.defineProperty(e,"AlignRight",{get:function(){return e._AlignRight},enumerable:!0,configurable:!0}),Object.defineProperty(e,"AlignBottom",{get:function(){return e._AlignBottom},enumerable:!0,configurable:!0}),Object.defineProperty(e,"AlignCenter",{get:function(){return e._AlignCenter},enumerable:!0,configurable:!0}),Object.defineProperty(e,"AlignStretch",{get:function(){return e._AlignStretch},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"horizontal",{get:function(){return this._horizontal},set:function(e){this._horizontal!==e&&(this._horizontal=e,this._changedCallback())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vertical",{get:function(){return this._vertical},set:function(e){this._vertical!==e&&(this._vertical=e,this._changedCallback())},enumerable:!0,configurable:!0}),e.prototype.setHorizontal=function(t){var i=t.trim().toLocaleLowerCase();switch(i){case"left":return void(this.horizontal=e.AlignLeft);case"right":return void(this.horizontal=e.AlignRight);case"center":return void(this.horizontal=e.AlignCenter);case"stretch":return void(this.horizontal=e.AlignStretch)}},e.prototype.setVertical=function(t){var i=t.trim().toLocaleLowerCase();switch(i){case"top":return void(this.vertical=e.AlignTop);case"bottom":return void(this.vertical=e.AlignBottom);case"center":return void(this.vertical=e.AlignCenter);case"stretch":return void(this.vertical=e.AlignStretch)}},e.prototype.fromString=function(e){for(var t=e.trim().split(","),i=0;i<t.length;i++){var r=t[i];r=r.toLocaleLowerCase().trim();var n=r.indexOf("h:");-1===n&&(n=r.indexOf("horizontal:")),-1===n?(n=r.indexOf("v:"),-1===n&&(n=r.indexOf("vertical:")),-1===n||(r=r.substr(r.indexOf(":")+1),this.setVertical(r))):(r=r.substr(r.indexOf(":")+1),this.setHorizontal(r))}},e._AlignLeft=1,e._AlignTop=1,e._AlignRight=2,e._AlignBottom=2,e._AlignCenter=3,e._AlignStretch=4,e}();e.PrimitiveAlignment=n;var o=function(){function e(e,t){this.prim=e,this.intersectionLocation=t}return e}();e.PrimitiveIntersectedInfo=o;var s=function(){function e(t,i){this._parentAccess=t,this._changedCallback=i,this._pixels=new Array(4),this._percentages=new Array(4),this._setType(0,e.Auto),this._setType(1,e.Auto),this._setType(2,e.Auto),this._setType(3,e.Auto),this._pixels[0]=0,this._pixels[1]=0,this._pixels[2]=0,this._pixels[3]=0}return e.prototype.fromString=function(t){this._clear();for(var i=t.trim().split(","),r=!1,n=0;n<i.length;n++){var o=i[n];r=this._extractString(o,!1)||r}if(!r)throw new Error("Can't parse the string to create a PrimitiveMargin object, format must be: 'top: <value>, left:<value>, right:<value>, bottom:<value>");0===(15&this._flags)&&(this._flags|=e.Pixel<<0),0===(240&this._flags)&&(this._flags|=e.Pixel<<4),0===(3840&this._flags)&&(this._flags|=e.Pixel<<8),0===(61440&this._flags)&&(this._flags|=e.Pixel<<12),this._changedCallback()},e.prototype.fromStrings=function(e,t,i,r){return this._clear(),this._setStringValue(e,0,!1),this._setStringValue(t,1,!1),this._setStringValue(i,2,!1),this._setStringValue(r,3,!1),this._changedCallback(),this},e.prototype.fromPixels=function(e,t,i,r){return this._clear(),this._pixels[0]=e,this._pixels[1]=t,this._pixels[2]=i,this._pixels[3]=r,this._changedCallback(),this},e.prototype.fromUniformPixels=function(e){return this._clear(),this._pixels[0]=e,this._pixels[1]=e,this._pixels[2]=e,this._pixels[3]=e,this._changedCallback(),this},e.prototype.auto=function(){return this._clear(),this._flags=e.Auto<<0|e.Auto<<4|e.Auto<<8|e.Auto<<12,this._pixels[0]=0,this._pixels[1]=0,this._pixels[2]=0,this._pixels[3]=0,this._changedCallback(),this},e.prototype._clear=function(){this._flags=0,this._pixels[0]=0,this._pixels[1]=0,this._pixels[2]=0,this._pixels[3]=0,this._percentages[0]=null,this._percentages[1]=null,this._percentages[2]=null,this._percentages[3]=null},e.prototype._extractString=function(e,t){var i=e.trim().toLocaleLowerCase();return 0===i.indexOf("top:")?(i=i.substr(4).trim(),this._setStringValue(i,0,t)):0===i.indexOf("left:")?(i=i.substr(5).trim(),this._setStringValue(i,1,t)):0===i.indexOf("right:")?(i=i.substr(6).trim(),this._setStringValue(i,2,t)):0===i.indexOf("bottom:")?(i=i.substr(7).trim(),this._setStringValue(i,3,t)):!1},e.prototype._setStringValue=function(t,i,r){var n=t.trim().toLocaleLowerCase();if("auto"===n){if(this._isType(i,e.Auto))return!0;this._setType(i,e.Auto),this._pixels[i]=0,r&&this._changedCallback()}else{if("inherit"!==n){var o=n.indexOf("%");if(-1!==o){var s=n.substr(0,o),a=Math.round(Number(s))/100;return this._isType(i,e.Percentage)&&this._percentages[i]===a?!0:(this._setType(i,e.Percentage),isNaN(a)?!1:(this._percentages[i]=a,r&&this._changedCallback(),!0))}var h;o=n.indexOf("px"),h=-1!==o?n.substr(0,o).trim():n;var c=Number(h);return this._isType(i,e.Pixel)&&this._pixels[i]===c?!0:isNaN(c)?!1:(this._pixels[i]=c,this._setType(i,e.Pixel),r&&this._changedCallback(),!0)}if(this._isType(i,e.Inherit))return!0;this._setType(i,e.Inherit),this._pixels[i]=null,r&&this._changedCallback()}},e.prototype._setPixels=function(t,i,r){t=Math.round(t),this._isType(i,e.Pixel)&&this._pixels[i]===t||(this._setType(i,e.Pixel),this._pixels[i]=t,r&&this._changedCallback())},e.prototype._setPercentage=function(t,i,r){t=Math.min(1,t),t=Math.max(0,t),t=Math.round(100*t)/100,this._isType(i,e.Percentage)&&this._percentages[i]===t||(this._setType(i,e.Percentage),this._percentages[i]=t,r&&this._changedCallback())},e.prototype._getStringValue=function(t){var i=this._flags>>4*t&15;switch(i){case e.Auto:return"auto";case e.Pixel:return this._pixels[t]+"px";case e.Percentage:return 100*this._percentages[t]+"%";case e.Inherit:return"inherit"}return""},e.prototype._isType=function(e,t){var i=this._flags>>4*e&15;return i===t},e.prototype._getType=function(t,i){var r=this._flags>>4*t&15;if(i&&r===e.Inherit){var n=this._parentAccess();return n?n._getType(t,!0):e.Auto}return r},e.prototype._setType=function(e,t){this._flags&=~(15<<4*e),this._flags|=t<<4*e},e.prototype.setTop=function(e){"string"==typeof e?this._setStringValue(e,0,!0):this.topPixels=e},e.prototype.setLeft=function(e){"string"==typeof e?this._setStringValue(e,1,!0):this.leftPixels=e},e.prototype.setRight=function(e){"string"==typeof e?this._setStringValue(e,2,!0):this.rightPixels=e},e.prototype.setBottom=function(e){"string"==typeof e?this._setStringValue(e,3,!0):this.bottomPixels=e},Object.defineProperty(e.prototype,"top",{get:function(){return this._getStringValue(0)},set:function(e){this._setStringValue(e,0,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this._getStringValue(1)},set:function(e){this._setStringValue(e,1,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this._getStringValue(2)},set:function(e){this._setStringValue(e,2,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this._getStringValue(3)},set:function(e){this._setStringValue(e,3,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topPixels",{get:function(){return this._pixels[0]},set:function(e){this._setPixels(e,0,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftPixels",{get:function(){return this._pixels[1]},set:function(e){this._setPixels(e,1,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightPixels",{get:function(){return this._pixels[2]},set:function(e){this._setPixels(e,2,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomPixels",{get:function(){return this._pixels[3]},set:function(e){this._setPixels(e,3,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topPercentage",{get:function(){return this._percentages[0]},set:function(e){this._setPercentage(e,0,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftPercentage",{get:function(){return this._percentages[1]},set:function(e){this._setPercentage(e,1,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightPercentage",{get:function(){return this._percentages[2]},set:function(e){this._setPercentage(e,2,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomPercentage",{get:function(){return this._percentages[3]},set:function(e){this._setPercentage(e,3,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topMode",{get:function(){return this._getType(0,!1)},set:function(e){this._setType(0,e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftMode",{get:function(){return this._getType(1,!1)},set:function(e){this._setType(1,e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightMode",{get:function(){return this._getType(2,!1)},set:function(e){this._setType(2,e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomMode",{get:function(){return this._getType(3,!1)},set:function(e){this._setType(3,e)},enumerable:!0,configurable:!0}),e.prototype._computePixels=function(t,i,r){var n=this._getType(t,!1);if(n===e.Inherit)return void this._parentAccess()._computePixels(t,i,r);if(n===e.Percentage){var o=(0===t||3===t?i.height:i.width)*this._percentages[t];this._pixels[t]=o,r&&this._changedCallback()}},e.prototype.computeWithAlignment=function(t,i,r,o,s){var a=this._getType(0,!0),h=this._getType(1,!0),c=this._getType(2,!0),l=this._getType(3,!0),u=i&&null!=i.width,f=i&&null!=i.height,d=u?i.width:0,p=f?i.height:0,_=a===e.Auto,m=h===e.Auto,g=c===e.Auto,v=l===e.Auto;switch(r.horizontal){case n.AlignLeft:m?o.x=0:(this._computePixels(1,t,!0),o.x=this.leftPixels),s.width=d;break;case n.AlignRight:g?o.x=Math.round(t.width-d):(this._computePixels(2,t,!0),o.x=Math.round(t.width-(d+this.rightPixels))),s.width=d;break;case n.AlignStretch:m?o.x=0:(this._computePixels(1,t,!0),o.x=this.leftPixels);var y=0;g||(this._computePixels(2,t,!0),y=this.rightPixels),s.width=t.width-(o.x+y);break;case n.AlignCenter:m||this._computePixels(1,t,!0),g||this._computePixels(2,t,!0);var x=(m?0:this.leftPixels)-(g?0:this.rightPixels);o.x=Math.round((t.width-d)/2+x),s.width=d}switch(r.vertical){case n.AlignTop:_?o.y=t.height-p:(this._computePixels(0,t,!0),o.y=Math.round(t.height-(p+this.topPixels))),s.height=p;break;case n.AlignBottom:v?o.y=0:(this._computePixels(3,t,!0),o.y=this.bottomPixels),s.height=p;break;case n.AlignStretch:v?o.y=0:(this._computePixels(3,t,!0),o.y=this.bottomPixels);var b=0;_||(this._computePixels(0,t,!0),b=this.topPixels),s.height=t.height-(o.y+b);break;case n.AlignCenter:_||this._computePixels(0,t,!0),v||this._computePixels(3,t,!0);var x=(v?0:this.bottomPixels)-(_?0:this.topPixels);o.y=Math.round((t.height-p)/2+x),s.height=p}},e.prototype.compute=function(e,t,i){this._computePixels(0,e,!0),this._computePixels(1,e,!0),this._computePixels(2,e,!0),this._computePixels(3,e,!0),t.x=this.leftPixels,i.width=e.width-(t.x+this.rightPixels),t.y=this.bottomPixels,i.height=e.height-(t.y+this.topPixels)},e.prototype.computeArea=function(e,t){this._computePixels(0,e,!0),this._computePixels(1,e,!0),this._computePixels(2,e,!0),this._computePixels(3,e,!0),t.width=this.leftPixels+e.width+this.rightPixels,t.height=this.bottomPixels+e.height+this.topPixels},e.Auto=1,e.Inherit=2,e.Percentage=4,e.Pixel=8,e}();e.PrimitiveThickness=s;var a=function(){function t(){this.findFirstOnly=!1,this.intersectHidden=!1,this.pickPosition=e.Vector2.Zero()}return Object.defineProperty(t.prototype,"isIntersected",{get:function(){return this.intersectedPrimitives&&this.intersectedPrimitives.length>0},enumerable:!0,configurable:!0}),t.prototype.isPrimIntersected=function(e){for(var t=0,i=this.intersectedPrimitives;t<i.length;t++){var r=i[t];if(r.prim===e)return r.intersectionLocation}return null},t.prototype._exit=function(e){e&&(this._globalPickPosition=null)},t}();e.IntersectInfo2D=a;var h=function(t){function i(r){null==r&&(r={}),t.call(this);var n,o;if(i._isCanvasInit)n=this,o=null,this._canvasPreInit(r);else if(null!=r.parent){if(o=r.parent,n=r.parent.owner,!n)throw new Error("Parent "+o.id+" of "+r.id+" doesn't have a valid owner!");if(!(this instanceof e.Group2D||this instanceof e.Sprite2D&&null!==r.id&&0===r.id.indexOf("__cachedSpriteOfGroup__")||n.cachingStrategy!==e.Canvas2D.CACHESTRATEGY_TOPLEVELGROUPS||o!==n))throw new Error("Can't create a primitive with the canvas as direct parent when the caching strategy is TOPLEVELGROUPS. You need to create a Group below the canvas and use it as the parent for the primitive")}if(this._layoutEngine=e.CanvasLayoutEngine.Singleton,this._size=null,this._actualSize=null,this._boundingSize=null,this._layoutArea=e.Size.Zero(),this._layoutAreaPos=e.Vector2.Zero(),this._marginOffset=e.Vector2.Zero(),this._parentMargingOffset=e.Vector2.Zero(),this._parentContentArea=e.Size.Zero(),this._contentArea=new e.Size(null,null),this._pointerEventObservable=new e.Observable,this._siblingDepthOffset=this._hierarchyDepthOffset=0,this._boundingInfo=new e.BoundingInfo2D,this._owner=n,this._parent=null,this._margin=null,this._padding=null,this._marginAlignment=null,this._id=r.id,this.propertyChanged=new e.Observable,this._children=new Array,this._localTransform=new e.Matrix,this._globalTransform=null,this._invGlobalTransform=null,this._globalTransformProcessStep=0,this._globalTransformStep=0,this._hierarchyDepth=0,this._renderGroup=null,this._setFlags(e.SmartPropertyPrim.flagIsPickable|e.SmartPropertyPrim.flagBoundingInfoDirty),null!=o&&(o.addChild(this),this._patchHierarchy(o.owner)),this.owner&&this instanceof e.Group2D){var s=this;s.detectGroupStates()}if(null!=r.children)for(var a=0,h=r.children;a<h.length;a++){var c=h[a];this.addChild(c),c._patchHierarchy(this.owner)}if(null!=r.position?this.position=r.position:null!=r.x||null!=r.y?this.position=new e.Vector2(r.x||0,r.y||0):this._position=null,this.rotation=null==r.rotation?0:r.rotation,this.scale=null==r.scale?1:r.scale,this.levelVisible=null==r.isVisible?!0:r.isVisible,this.origin=r.origin||new e.Vector2(.5,.5),null!=r.layoutEngine)if("string"==typeof r.layoutEngine){var l=r.layoutEngine.toLocaleLowerCase().trim();"canvas"===l||"canvaslayoutengine"===l?this.layoutEngine=e.CanvasLayoutEngine.Singleton:0===l.indexOf("stackpanel")||0===l.indexOf("horizontalstackpanel")?this.layoutEngine=e.StackPanelLayoutEngine.Horizontal:0===l.indexOf("verticalstackpanel")&&(this.layoutEngine=e.StackPanelLayoutEngine.Vertical)}else r.layoutEngine instanceof e.LayoutEngineBase&&(this.layoutEngine=r.layoutEngine);r.marginTop&&this.margin.setTop(r.marginTop),r.marginLeft&&this.margin.setLeft(r.marginLeft),r.marginRight&&this.margin.setRight(r.marginRight),r.marginBottom&&this.margin.setBottom(r.marginBottom),r.margin&&("string"==typeof r.margin?this.margin.fromString(r.margin):this.margin.fromUniformPixels(r.margin)),r.marginHAlignment&&(this.marginAlignment.horizontal=r.marginHAlignment),r.marginVAlignment&&(this.marginAlignment.vertical=r.marginVAlignment),r.marginAlignment&&this.marginAlignment.fromString(r.marginAlignment),r.paddingTop&&this.padding.setTop(r.paddingTop),r.paddingLeft&&this.padding.setLeft(r.paddingLeft),r.paddingRight&&this.padding.setRight(r.paddingRight),r.paddingBottom&&this.padding.setBottom(r.paddingBottom),r.padding&&this.padding.fromString(r.padding),this._parentLayoutDirty(),this._positioningDirty()}return __extends(i,t),Object.defineProperty(i.prototype,"actionManager",{get:function(){return this._actionManager||(this._actionManager=new e.ActionManager(this.owner.scene)),this._actionManager},enumerable:!0,configurable:!0}),i.prototype.traverseUp=function(e){for(var t=this;null!=t;){if(e(t))return t;t=t._parent}return null},Object.defineProperty(i.prototype,"owner",{get:function(){return this._owner},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"children",{get:function(){return this._children},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"actualPosition",{get:function(){return null!=this._actualPosition?this._actualPosition:null!=this._position?this._position:i._nullPosition},set:function(e){this._actualPosition=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"actualX",{get:function(){return this.actualPosition.x},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"actualY",{get:function(){return this.actualPosition.y},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return this._position},set:function(e){this._checkPositionChange()&&(this._position=e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"x",{get:function(){return this._position?this._position.x:null},set:function(t){this._checkPositionChange()&&(this._position||(this._position=e.Vector2.Zero()),this._position.x!==t&&(this._position.x=t,this.markAsDirty("position")))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"y",{get:function(){return this._position?this._position.y:null},set:function(t){this._checkPositionChange()&&(this._position||(this._position=e.Vector2.Zero()),this._position.y!==t&&(this._position.y=t,this.markAsDirty("position")))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"size",{get:function(){if(!this._size||null==this._size.width||null==this._size.height){if(i.boundinbBoxReentrency)return i.nullSize;if(this._boundingSize)return this._boundingSize;i.boundinbBoxReentrency=!0;this.boundingInfo;return i.boundinbBoxReentrency=!1,this._boundingSize}return this._size},set:function(e){this._size=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"width",{get:function(){return this.size?this.size.width:null},set:function(t){return this.size?void(this.size.width!==t&&(this.size.width=t,this.markAsDirty("size"),this._positioningDirty())):void(this.size=new e.Size(t,0))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"height",{get:function(){return this.size?this.size.height:null},set:function(t){return this.size?void(this.size.height!==t&&(this.size.height=t,this.markAsDirty("size"),this._positioningDirty())):void(this.size=new e.Size(0,t))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"rotation",{get:function(){return this._rotation},set:function(e){this._rotation=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"scale",{get:function(){return this._scale},set:function(e){this._scale=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"actualSize",{get:function(){return this._actualSize?this._actualSize:this._size},set:function(e){this._actualSize.equals(e)||(this._actualSize=e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"actualZOffset",{get:function(){return this._zOrder||1-this._hierarchyDepthOffset},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"minSize",{get:function(){return this._minSize},set:function(e){this._minSize&&e&&this._minSize.equals(e)||(this._minSize=e,this._parentLayoutDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"maxSize",{get:function(){return this._maxSize},set:function(e){this._maxSize&&e&&this._maxSize.equals(e)||(this._maxSize=e,this._parentLayoutDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"origin",{get:function(){return this._origin},set:function(e){this._origin=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"levelVisible",{get:function(){return this._isFlagSet(e.SmartPropertyPrim.flagLevelVisible)},set:function(t){this._changeFlags(e.SmartPropertyPrim.flagLevelVisible,t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isVisible",{get:function(){return this._isFlagSet(e.SmartPropertyPrim.flagIsVisible)},set:function(t){this._changeFlags(e.SmartPropertyPrim.flagIsVisible,t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"zOrder",{get:function(){return this._zOrder},set:function(e){this._zOrder=e,this.onZOrderChanged()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"margin",{get:function(){var e=this;return this._margin||(this._margin=new s(function(){return e.parent?e.parent.margin:null},function(){return e._positioningDirty()})),this._margin},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"_hasMargin",{get:function(){return null!==this._margin||null!==this._marginAlignment},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"padding",{get:function(){var e=this;return this._padding||(this._padding=new s(function(){return e.parent?e.parent.padding:null},function(){return e._positioningDirty()})),this._padding},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"_hasPadding",{get:function(){return null!==this._padding},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"marginAlignment",{get:function(){var e=this;return this._marginAlignment||(this._marginAlignment=new n(function(){return e._positioningDirty()})),this._marginAlignment},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"layoutEngine",{get:function(){return this._layoutEngine||(this._layoutEngine=e.CanvasLayoutEngine.Singleton),this._layoutEngine},set:function(e){this._layoutEngine!==e&&this._changeLayoutEngine(e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"layoutArea",{get:function(){return this._layoutArea},set:function(e){this._layoutArea.equals(e)||(this._positioningDirty(),this._layoutArea=e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"layoutAreaPos",{get:function(){return this._layoutAreaPos},set:function(e){this._layoutAreaPos.equals(e)||(this._positioningDirty(),this._layoutAreaPos=e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isPickable",{get:function(){return this._isFlagSet(e.SmartPropertyPrim.flagIsPickable)},set:function(t){this._changeFlags(e.SmartPropertyPrim.flagIsPickable,t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"hierarchyDepth",{get:function(){return this._hierarchyDepth},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"renderGroup",{get:function(){return this._renderGroup},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"globalTransform",{get:function(){return this._globalTransform},enumerable:!0,configurable:!0}),i.prototype.getGlobalPosition=function(){var t=new e.Vector2(0,0);return this.getGlobalPositionByRef(t),t},i.prototype.getGlobalPositionByRef=function(e){e.x=this.globalTransform.m[12],e.y=this.globalTransform.m[13]},Object.defineProperty(i.prototype,"invGlobalTransform",{get:function(){return this._invGlobalTransform},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"localTransform",{get:function(){return this._updateLocalTransform(),this._localTransform},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"boundingInfo",{get:function(){if(this._isFlagSet(e.SmartPropertyPrim.flagBoundingInfoDirty)){this._boundingInfo=this.levelBoundingInfo.clone();for(var t=this._boundingInfo,i=new e.BoundingInfo2D,r=0,n=this._children;r<n.length;r++){var o=n[r];o.boundingInfo.transformToRef(o.localTransform,i),t.unionToRef(i,t)}this._boundingSize=e.Size.Zero();var s=this._boundingInfo.max();this._boundingSize=new e.Size(this._size&&null!=this._size.width?this._size.width:Math.ceil(s.x),this._size&&null!=this._size.height?this._size.height:Math.ceil(s.y)),this._clearFlags(e.SmartPropertyPrim.flagBoundingInfoDirty)}return this._boundingInfo},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isSizeAuto",{get:function(){return null==this._size},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isPositionAuto",{get:function(){return null==this._position},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"pointerEventObservable",{get:function(){return this._pointerEventObservable},enumerable:!0,configurable:!0}),i.prototype.findById=function(e){if(this._id===e)return this;for(var t=0,i=this._children;t<i.length;t++){var r=i[t],n=r.findById(e);if(null!=n)return n}},i.prototype.onZOrderChanged=function(){},i.prototype.levelIntersect=function(e){return!1},i.prototype.setPointerEventCapture=function(e){return this.owner._setPointerCapture(e,this)},i.prototype.releasePointerEventsCapture=function(e){return this.owner._releasePointerCapture(e,this)},i.prototype.intersect=function(t){if(!t)return!1;var i=!t._globalPickPosition;if(i&&(t._globalPickPosition=e.Vector2.Zero(),e.Vector2.TransformToRef(t.pickPosition,this.globalTransform,t._globalPickPosition),t._localPickPosition=t.pickPosition.clone(),t.intersectedPrimitives=new Array,t.topMostIntersectedPrimitive=null),!t.intersectHidden&&!this.isVisible)return!1;if(this.isPickable&&!this.boundingInfo.doesIntersect(t._localPickPosition))return t._exit(i),!1;var r=!1;if(this.isPickable&&(r=this.levelIntersect(t))){var n=new o(this,t._localPickPosition.clone());if(t.intersectedPrimitives.push(n),(!t.topMostIntersectedPrimitive||t.topMostIntersectedPrimitive.prim.actualZOffset>n.prim.actualZOffset)&&(t.topMostIntersectedPrimitive=n),t.findFirstOnly)return t._exit(i),!0}if(!r||!t.findFirstOnly)for(var s=0,a=this._children;s<a.length;s++){var h=a[s];if(h.isPickable&&(t.intersectHidden||h.isVisible)&&(e.Vector2.TransformToRef(t._globalPickPosition,h.invGlobalTransform,t._localPickPosition),
h.intersect(t)&&t.findFirstOnly))return t._exit(i),!0}return t._exit(i),t.isIntersected},i.prototype.moveChild=function(e,t){if(e.parent!==this)return!1;var i,r,n=this._children.indexOf(e),o=t?this._children.indexOf(t):-1;t?(i=this._children[o]._siblingDepthOffset,r=this._children[o+1]._siblingDepthOffset):(i=1,r=this._children[1]._siblingDepthOffset),e._siblingDepthOffset=(r-i)/2,this._children.splice(o+1,0,this._children.splice(n,1)[0])},i.prototype.addChild=function(e){e._parent=this,this._boundingBoxDirty(),this._patchHierarchyDepth(e),this._children.push(e)},i.prototype.dispose=function(){if(!t.prototype.dispose.call(this))return!1;if(this._actionManager&&(this._actionManager.dispose(),this._actionManager=null),this._parent){var e=this._parent._children.indexOf(this);void 0!==e&&this._parent._children.splice(e,1),this._parent=null}if(this._children)for(;this._children.length>0;)this._children[this._children.length-1].dispose();return!0},i.prototype.onPrimBecomesDirty=function(){this._renderGroup&&this._renderGroup._addPrimToDirtyList(this)},i.prototype._needPrepare=function(){return this._areSomeFlagsSet(e.SmartPropertyPrim.flagVisibilityChanged|e.SmartPropertyPrim.flagModelDirty)||0!==this._instanceDirtyFlags||this._globalTransformProcessStep!==this._globalTransformStep},i.prototype._prepareRender=function(e){this._prepareRenderPre(e),this._prepareRenderPost(e)},i.prototype._prepareRenderPre=function(e){},i.prototype._prepareRenderPost=function(t){if(this instanceof e.Group2D){var r=this;if(r.isRenderableGroup)return}this._children.length>0&&(this._globalTransformProcessStep!==this._globalTransformStep||this.checkPropertiesDirty(i.isVisibleProperty.flagId))&&this._children.forEach(function(i){i instanceof e.Group2D&&i.isRenderableGroup||i._prepareRender(t)}),this._clearFlags(e.SmartPropertyPrim.flagModelDirty),this._instanceDirtyFlags=0},i.prototype._canvasPreInit=function(e){},i.CheckParent=function(e){},i.prototype.updateCachedStatesOf=function(e,t){for(var i=0;i<e.length;i++){var r=e[i];r.updateCachedStates(t)}},i.prototype._parentLayoutDirty=function(){this._parent&&!this._parent.isDisposed&&this._parent._setLayoutDirty()},i.prototype._setLayoutDirty=function(){this.isDirty||this.onPrimBecomesDirty(),this._setFlags(e.SmartPropertyPrim.flagLayoutDirty)},i.prototype._checkPositionChange=function(){return this.parent&&this.parent.layoutEngine.isChildPositionAllowed===!1?(console.log("Can't manually set the position of "+this.id+", the Layout Engine of its parent doesn't allow it"),!1):!0},i.prototype._positioningDirty=function(){this.isDirty||this.onPrimBecomesDirty(),this._setFlags(e.SmartPropertyPrim.flagPositioningDirty)},i.prototype._changeLayoutEngine=function(e){this._layoutEngine=e},i.prototype._updateLocalTransform=function(){var t=!1,r=null;this._parent?(r=this._parent._marginOffset,t=!r.equals(this._parentMargingOffset),this._parentMargingOffset.copyFrom(r)):r=i._v0;var n=i.actualPositionProperty.flagId|i.rotationProperty.flagId|i.scaleProperty.flagId|i.originProperty.flagId;if(t||this.checkPropertiesDirty(n)){var o,s=e.Quaternion.RotationAxis(new e.Vector3(0,0,1),this._rotation);if(0===this._origin.x&&0===this._origin.y)o=e.Matrix.Compose(new e.Vector3(this._scale,this._scale,1),s,new e.Vector3(this.actualPosition.x+r.x,this.actualPosition.y+r.y,0)),this._localTransform=o;else{var a=this.actualSize;e.Matrix.TranslationToRef(-a.width*this._origin.x,-a.height*this._origin.y,0,i._t0),s.toRotationMatrix(i._t1),i._t0.multiplyToRef(i._t1,i._t2),e.Matrix.ScalingToRef(this._scale,this._scale,1,i._t0),i._t2.multiplyToRef(i._t0,i._t1),e.Matrix.TranslationToRef(a.width*this._origin.x+this.actualPosition.x+r.x,a.height*this._origin.y+this.actualPosition.y+r.y,0,i._t2),i._t1.multiplyToRef(i._t2,this._localTransform)}return this.clearPropertiesDirty(n),!0}return!1},i.prototype.updateCachedStates=function(t){if(!this.isDisposed){this._parent&&(this._parent._globalTransformProcessStep!==this.owner._globalTransformProcessStep||this._parent._areSomeFlagsSet(e.SmartPropertyPrim.flagLayoutDirty|e.SmartPropertyPrim.flagPositioningDirty))&&this._parent.updateCachedStates(!1);var r=this.checkPropertiesDirty(i.sizeProperty.flagId);if(!this._isFlagSet(e.SmartPropertyPrim.flagLayoutDirty)&&r){var n=this.size;n&&(null!=this.size.width&&(this.actualSize.width=this.size.width),null!=this.size.height&&(this.actualSize.height=this.size.height),this.clearPropertiesDirty(i.sizeProperty.flagId))}var o=this._isFlagSet(e.SmartPropertyPrim.flagPositioningDirty);this._isFlagSet(e.SmartPropertyPrim.flagLayoutDirty)&&(this._layoutEngine.updateLayout(this),this._clearFlags(e.SmartPropertyPrim.flagLayoutDirty));var s=o&&!this._isFlagSet(e.SmartPropertyPrim.flagPositioningDirty);if(!s&&(r||this._isFlagSet(e.SmartPropertyPrim.flagPositioningDirty)||this._parent&&!this._parent.contentArea.equals(this._parentContentArea))&&(this._updatePositioning(),this._clearFlags(e.SmartPropertyPrim.flagPositioningDirty),s=!0),s&&this._parent&&this._parentContentArea.copyFrom(this._parent.contentArea),this===this.owner||this._globalTransformProcessStep!==this.owner._globalTransformProcessStep){var a=this.isVisible;this.isVisible=(!this._parent||this._parent.isVisible)&&this.levelVisible,this._changeFlags(e.SmartPropertyPrim.flagVisibilityChanged,a!==this.isVisible);var h=this._updateLocalTransform(),c=null!=this._parent?this._parent._globalTransformStep!==this._parentTransformStep:!1;if(!this._globalTransform||h||c){var l=this._parent?this._parent._globalTransform:null;this._globalTransform=this._parent?this._localTransform.multiply(l):this._localTransform,this._invGlobalTransform=e.Matrix.Invert(this._globalTransform),this._globalTransformStep=this.owner._globalTransformProcessStep+1,this._parentTransformStep=this._parent?this._parent._globalTransformStep:0}this._globalTransformProcessStep=this.owner._globalTransformProcessStep}if(t)for(var u=0,f=this._children;u<f.length;u++){var d=f[u];d.updateCachedStates(!(d instanceof e.Group2D&&d.isRenderableGroup))}}},i.prototype._updatePositioning=function(){this._hasMargin||null!=this.actualSize.width&&null!=this.actualSize.height||(null==this.actualSize.width&&(this.marginAlignment.horizontal=n.AlignStretch),null==this.actualSize.height&&(this.marginAlignment.vertical=n.AlignStretch)),this._hasMargin&&(this.margin.computeWithAlignment(this.layoutArea,this.size,this.marginAlignment,this._marginOffset,i._size),this.actualPosition=this._marginOffset.add(this._layoutAreaPos),null!=this.size.width&&(this.size.width=i._size.width),null!=this.size.height&&(this.size.height=i._size.height),this.actualSize.copyFrom(i._size.clone())),this._hasPadding?(this._getInitialContentAreaToRef(this.actualSize,i._icPos,i._icArea),i._icArea.width=Math.max(0,i._icArea.width),i._icArea.height=Math.max(0,i._icArea.height),this.padding.compute(i._icArea,this._marginOffset,i._size),this._marginOffset.x+=i._icPos.x,this._marginOffset.y+=i._icPos.y,this._contentArea.copyFrom(i._size)):(this._getInitialContentAreaToRef(this.actualSize,i._icPos,i._icArea),i._icArea.width=Math.max(0,i._icArea.width),i._icArea.height=Math.max(0,i._icArea.height),this._marginOffset.copyFrom(i._icPos),this._contentArea.copyFrom(i._icArea))},Object.defineProperty(i.prototype,"contentArea",{get:function(){return this._isFlagSet(e.SmartPropertyPrim.flagPositioningDirty)&&(this._updatePositioning(),this._clearFlags(e.SmartPropertyPrim.flagPositioningDirty)),this._contentArea},enumerable:!0,configurable:!0}),i.prototype._patchHierarchy=function(t){if(this._owner=t,null==this._renderGroup){if(this instanceof e.Group2D){var i=this;i.detectGroupStates(),i._trackedNode&&!i._isFlagSet(e.SmartPropertyPrim.flagTrackedGroup)&&i.owner._registerTrackedNode(this)}if(this._parent&&(this._renderGroup=this.parent.traverseUp(function(t){return t instanceof e.Group2D&&t.isRenderableGroup}),this._parentLayoutDirty()),this._renderGroup&&this.isDirty){var r=this._renderGroup._renderableData._primDirtyList,n=r.indexOf(this);-1===n&&r.push(this)}for(var o=0,s=this._children;o<s.length;o++){var a=s[o];this._patchHierarchyDepth(a),a._patchHierarchy(t)}}},i.prototype._patchHierarchyDepth=function(t){t._hierarchyDepth=this._hierarchyDepth+1,t._hierarchyDepthOffset=this._hierarchyDepthOffset+(this._children.length+1)*this._siblingDepthOffset,t._siblingDepthOffset=this._siblingDepthOffset/e.Canvas2D.hierarchyLevelMaxSiblingCount},i.prototype._getInitialContentAreaToRef=function(e,t,i){i.width=e.width,i.height=e.height,t.x=t.y=0},i.PRIM2DBASE_PROPCOUNT=15,i._nullPosition=e.Vector2.Zero(),i.boundinbBoxReentrency=!1,i.nullSize=e.Size.Zero(),i._isCanvasInit=!1,i._t0=new e.Matrix,i._t1=new e.Matrix,i._t2=new e.Matrix,i._v0=e.Vector2.Zero(),i._icPos=e.Vector2.Zero(),i._icArea=e.Size.Zero(),i._size=e.Size.Zero(),__decorate([e.instanceLevelProperty(1,function(e){return i.actualPositionProperty=e},!1,!0)],i.prototype,"actualPosition",null),__decorate([e.dynamicLevelProperty(1,function(e){return i.positionProperty=e},!1,!0)],i.prototype,"position",null),__decorate([e.dynamicLevelProperty(2,function(e){return i.sizeProperty=e},!1,!0)],i.prototype,"size",null),__decorate([e.instanceLevelProperty(3,function(e){return i.rotationProperty=e},!1,!0)],i.prototype,"rotation",null),__decorate([e.instanceLevelProperty(4,function(e){return i.scaleProperty=e},!1,!0)],i.prototype,"scale",null),__decorate([e.dynamicLevelProperty(5,function(e){return i.originProperty=e},!1,!0)],i.prototype,"origin",null),__decorate([e.dynamicLevelProperty(6,function(e){return i.levelVisibleProperty=e})],i.prototype,"levelVisible",null),__decorate([e.instanceLevelProperty(7,function(e){return i.isVisibleProperty=e})],i.prototype,"isVisible",null),__decorate([e.instanceLevelProperty(8,function(e){return i.zOrderProperty=e})],i.prototype,"zOrder",null),__decorate([e.dynamicLevelProperty(9,function(e){return i.marginProperty=e})],i.prototype,"margin",null),__decorate([e.dynamicLevelProperty(10,function(e){return i.paddingProperty=e})],i.prototype,"padding",null),__decorate([e.dynamicLevelProperty(11,function(e){return i.marginAlignmentProperty=e})],i.prototype,"marginAlignment",null),i=__decorate([e.className("Prim2DBase")],i)}(e.SmartPropertyPrim);e.Prim2DBase=h}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(t,i,r){this._partCount=r,this.owner=t,this.modelRenderCache=i,this.modelRenderCache.addRef(),this.partIndexFromId=new e.StringDictionary,this._usedShaderCategories=new Array(r),this._strides=new Array(r),this._opaqueData=null,this._alphaTestData=null,this._transparentData=null,this.opaqueDirty=this.alphaTestDirty=this.transparentDirty=this.transparentOrderDirty=!1}return t.prototype.dispose=function(){if(this._isDisposed)return!1;this.modelRenderCache&&this.modelRenderCache.dispose();var e=this.owner.owner.engine;return this.opaqueData&&(this.opaqueData.forEach(function(t){return t.dispose(e)}),this.opaqueData=null),this.partIndexFromId=null,this._isDisposed=!0,!0},Object.defineProperty(t.prototype,"hasOpaqueData",{get:function(){return null!=this._opaqueData},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasAlphaTestData",{get:function(){return null!=this._alphaTestData},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasTransparentData",{get:function(){return null!=this._transparentData},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"opaqueData",{get:function(){if(!this._opaqueData){this._opaqueData=new Array(this._partCount);for(var e=0;e<this._partCount;e++)this._opaqueData[e]=new r(this._strides[e])}return this._opaqueData},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alphaTestData",{get:function(){if(!this._alphaTestData){this._alphaTestData=new Array(this._partCount);for(var e=0;e<this._partCount;e++)this._alphaTestData[e]=new r(this._strides[e])}return this._alphaTestData},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"transparentData",{get:function(){if(!this._transparentData){this._transparentData=new Array(this._partCount);for(var e=0;e<this._partCount;e++){var t=this.modelRenderCache._partData[e]._zBiasOffset;this._transparentData[e]=new n(this._strides[e],t)}}return this._transparentData},enumerable:!0,configurable:!0}),t.prototype.sortTransparentData=function(){if(this.transparentOrderDirty){for(var e=0;e<this._transparentData.length;e++){var t=this._transparentData[e];t._partData.sort()}this.transparentOrderDirty=!1}},Object.defineProperty(t.prototype,"usedShaderCategories",{get:function(){return this._usedShaderCategories},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"strides",{get:function(){return this._strides},enumerable:!0,configurable:!0}),t}();e.GroupInstanceInfo=t;var i=function(){function e(){}return e}();e.TransparentSegment=i;var r=function(){function t(t){this._partData=null,this._partBuffer=null,this._partBufferSize=0,this._partData=new e.DynamicFloatArray(t/4,50),this._isDisposed=!1}return t.prototype.dispose=function(e){return this._isDisposed?!1:(this._partBuffer&&(e._releaseBuffer(this._partBuffer),this._partBuffer=null),this._partData=null,void(this._isDisposed=!0))},t}();e.GroupInfoPartData=r;var n=function(e){function t(t,i){e.call(this,t),this._partData.compareValueOffset=i,this._partData.sortingAscending=!1}return __extends(t,e),t}(r);e.TransparentGroupInfoPartData=n;var o=function(){function t(t,i){this._engine=t,this._modelKey=i,this._nextKey=1,this._refCounter=1,this._instancesData=new e.StringDictionary,this._partData=null}return t.prototype.dispose=function(){if(0!==--this._refCounter)return!1;var e=this._engine.getExternalData("__BJSCANVAS2D__");return e&&e.DisposeModelRenderCache(this),!0},Object.defineProperty(t.prototype,"isDisposed",{get:function(){return this._refCounter<=0},enumerable:!0,configurable:!0}),t.prototype.addRef=function(){return++this._refCounter},Object.defineProperty(t.prototype,"modelKey",{get:function(){return this._modelKey},enumerable:!0,configurable:!0}),t.prototype.render=function(e,t){return!0},t.prototype.addInstanceDataParts=function(e){var t=this._nextKey.toString();if(!this._instancesData.add(t,e))throw Error("Key: "+t+" is already allocated");return++this._nextKey,t},t.prototype.removeInstanceData=function(e){this._instancesData.remove(e)},t.prototype.getPartIndexFromId=function(e){for(var t=0;t<this._partData.length;t++)if(this._partData[t]._partId===e)return t;return null},t.prototype.loadInstancingAttributes=function(e,t){var i=this.getPartIndexFromId(e);if(null===i)return null;var r=this._partsClassInfo[i],n=this._partData[i]._partUsedCategories,o=r.classContent.getInstancingAttributeInfos(t,n);return o},t.prototype.setupUniforms=function(e,i,r,n){var o=this._partData[i],s=o._partDataStride/4*n,a=this._partsClassInfo[i];a.fullContent.forEach(function(i,n){if(!n.category||-1!==o._partUsedCategories.indexOf(n.category))switch(n.dataType){case 4:var a=n.instanceOffset.get(o._partJoinedUsedCategories);e.setFloat(n.attributeName,r.buffer[s+a]);break;case 0:var a=n.instanceOffset.get(o._partJoinedUsedCategories);t.v2.x=r.buffer[s+a+0],t.v2.y=r.buffer[s+a+1],e.setVector2(n.attributeName,t.v2);break;case 5:case 1:var a=n.instanceOffset.get(o._partJoinedUsedCategories);t.v3.x=r.buffer[s+a+0],t.v3.y=r.buffer[s+a+1],t.v3.z=r.buffer[s+a+2],e.setVector3(n.attributeName,t.v3);break;case 6:case 2:var a=n.instanceOffset.get(o._partJoinedUsedCategories);t.v4.x=r.buffer[s+a+0],t.v4.y=r.buffer[s+a+1],t.v4.z=r.buffer[s+a+2],t.v4.w=r.buffer[s+a+3],e.setVector4(n.attributeName,t.v4)}})},t.v2=e.Vector2.Zero(),t.v3=e.Vector3.Zero(),t.v4=e.Vector4.Zero(),t}();e.ModelRenderCache=o;var s=function(){function e(){}return e}();e.ModelRenderCachePartData=s}(BABYLON||(BABYLON={}));var BABYLON;!function(e){function t(t,n){return function(o,s,a){var h=e.ClassTreeInfo.getOrRegister(o,function(e){return new i(e)}),c=h.getLevelOf(o),l=s;n=n||l;var u=c.levelContent.get(l);if(u)throw new Error("The ID "+l+" is already taken by another instance data");u=new r,u.attributeName=n,u.category=t||null,u.category&&(u.delimitedCategory=";"+u.category+";"),c.levelContent.add(l,u),a.get=function(){return null},a.set=function(e){if(!u.category||-1!==i._CurCategories.indexOf(u.delimitedCategory)){u.size?u.instanceOffset.contains(i._CurCategories)||c.classContent.mapProperty(u,!1):(u.setSize(e),c.classContent.mapProperty(u,!0));var t=this;if(t.dataBuffer&&t.dataElements){var r=t.dataElements[t.curElement].offset+u.instanceOffset.get(i._CurCategories);u.writeData(t.dataBuffer.buffer,r,e)}}}}}var i=function(){function t(t){this._baseInfo=t,this._nextOffset=new e.StringDictionary,this._attributes=new Array}return t.prototype.mapProperty=function(e,i){var r=this._nextOffset.getOrAdd(t._CurCategories,0);e.instanceOffset.add(t._CurCategories,this._getBaseOffset(t._CurCategories)+r),this._nextOffset.set(t._CurCategories,r+e.size/4),i&&this._attributes.push(e)},t.prototype.getInstancingAttributeInfos=function(t,i){for(var r=";"+i.join(";")+";",n=new Array,o=this;o;){for(var s=0,a=o._attributes;s<a.length;s++){var h=a[s];if(!h.category||-1!==i.indexOf(h.category)){var c=t.getAttributeLocationByName(h.attributeName),l=new e.InstancingAttributeInfo;l.index=c,l.attributeSize=h.size/4,l.offset=4*h.instanceOffset.get(r),l.attributeName=h.attributeName,n.push(l)}}o=o._baseInfo}return n},t.prototype.getShaderAttributes=function(e){for(var t=new Array,i=this;i;){for(var r=0,n=i._attributes;r<n.length;r++){var o=n[r];o.category&&-1===e.indexOf(o.category)||t.push(o.attributeName)}i=i._baseInfo}return t},t.prototype._getBaseOffset=function(e){for(var t=0,i=this._baseInfo;i;)t+=i._nextOffset.getOrAdd(e,0),i=i._baseInfo;return t},t}();e.InstanceClassInfo=i;var r=function(){function t(){this.instanceOffset=new e.StringDictionary}return t.prototype.setSize=function(t){if(t instanceof e.Vector2)return this.size=8,void(this.dataType=0);if(t instanceof e.Vector3)return this.size=12,void(this.dataType=1);if(t instanceof e.Vector4)return this.size=16,void(this.dataType=2);if(t instanceof e.Matrix)throw new Error("Matrix type is not supported by WebGL Instance Buffer, you have to use four Vector4 properties instead");return"number"==typeof t?(this.size=4,void(this.dataType=4)):t instanceof e.Color3?(this.size=12,void(this.dataType=5)):t instanceof e.Color4?(this.size=16,void(this.dataType=6)):t instanceof e.Size?(this.size=8,void(this.dataType=7)):void 0},t.prototype.writeData=function(e,t,i){switch(this.dataType){case 0:var r=i;e[t+0]=r.x,e[t+1]=r.y;break;case 1:var r=i;e[t+0]=r.x,e[t+1]=r.y,e[t+2]=r.z;break;case 2:var r=i;e[t+0]=r.x,e[t+1]=r.y,e[t+2]=r.z,e[t+3]=r.w;break;case 5:var r=i;e[t+0]=r.r,e[t+1]=r.g,e[t+2]=r.b;break;case 6:var r=i;e[t+0]=r.r,e[t+1]=r.g,e[t+2]=r.b,e[t+3]=r.a;break;case 4:var r=i;e[t]=r;break;case 3:for(var r=i,n=0;16>n;n++)e[t+n]=r.m[n];break;case 7:var o=i;e[t+0]=o.width,e[t+1]=o.height}},t}();e.InstancePropInfo=r,e.instanceData=t;var n=function(){function i(e,t){this.id=e,this.curElement=0,this.dataElementCount=t}return Object.defineProperty(i.prototype,"zBias",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"transformX",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"transformY",{get:function(){return null},enumerable:!0,configurable:!0}),i.prototype.getClassTreeInfo=function(){return this.typeInfo||(this.typeInfo=e.ClassTreeInfo.get(Object.getPrototypeOf(this))),this.typeInfo},i.prototype.allocElements=function(){if(this.dataBuffer){for(var e=new Array(this.dataElementCount),t=0;t<this.dataElementCount;t++)e[t]=this.dataBuffer.allocElement();this.dataElements=e}},i.prototype.freeElements=function(){if(this.dataElements){for(var e=0,t=this.dataElements;e<t.length;e++){var i=t[e];this.dataBuffer.freeElement(i)}this.dataElements=null}},Object.defineProperty(i.prototype,"dataElementCount",{get:function(){return this._dataElementCount},set:function(e){e!==this._dataElementCount&&(this.freeElements(),this._dataElementCount=e,this.allocElements())},enumerable:!0,configurable:!0}),__decorate([t()],i.prototype,"zBias",null),__decorate([t()],i.prototype,"transformX",null),__decorate([t()],i.prototype,"transformY",null),i}();e.InstanceDataBase=n;var o=function(t){function r(e){t.call(this,e),this._isTransparent=!1,this._isAlphaTest=!1,this._transparentPrimitiveInfo=null}return __extends(r,t),Object.defineProperty(r.prototype,"isAlphaTest",{get:function(){return this._isAlphaTest},set:function(e){this._isAlphaTest=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isTransparent",{get:function(){return this._isTransparent},set:function(e){this._isTransparent=e},enumerable:!0,configurable:!0}),r.prototype.dispose=function(){return t.prototype.dispose.call(this)?(this._transparentPrimitiveInfo&&(this.renderGroup._renderableData.removeTransparentPrimitiveInfo(this._transparentPrimitiveInfo),this._transparentPrimitiveInfo=null),this._modelRenderInstanceID&&(this._modelRenderCache.removeInstanceData(this._modelRenderInstanceID),this._modelRenderInstanceID=null),this._modelRenderCache&&(this._modelRenderCache.dispose(),this._modelRenderCache=null),this._instanceDataParts&&(this._instanceDataParts.forEach(function(e){e.freeElements()}),this._instanceDataParts=null),!0):!1},r.prototype._prepareRenderPre=function(i){t.prototype._prepareRenderPre.call(this,i),this._isFlagSet(e.SmartPropertyPrim.flagModelDirty)&&this._modelRenderInstanceID&&(this._modelRenderCache.removeInstanceData(this._modelRenderInstanceID),this._modelRenderInstanceID=null);var r=!1;this._modelRenderCache&&!this._isFlagSet(e.SmartPropertyPrim.flagModelDirty)||(r=this._createModelRenderCache());var n=null,o=!1;this._modelRenderInstanceID||(o=!0,n=this._createModelDataParts()),r&&this.setupModelRenderCache(this._modelRenderCache),(this._isFlagSet(e.SmartPropertyPrim.flagVisibilityChanged)||i.forceRefreshPrimitive||o||0!==this._instanceDirtyFlags||this._globalTransformProcessStep!==this._globalTransformStep)&&(this.isTransparent,this._updateInstanceDataParts(n))},r.prototype._createModelRenderCache=function(){var t=this,i=!1;return this._modelRenderCache&&this._modelRenderCache.dispose(),this._modelRenderCache=this.owner._engineData.GetOrAddModelCache(this.modelKey,function(e){var r=t.createModelRenderCache(e);return i=!0,r}),this._clearFlags(e.SmartPropertyPrim.flagModelDirty),i||this._modelRenderCache.addRef(),i},r.prototype._createModelDataParts=function(){var t=this,i=this.createInstanceDataParts();this._instanceDataParts=i,this._modelRenderCache._partData||this._setupModelRenderCache(i);var r=this.renderGroup._renderableData._renderGroupInstancesInfo.getOrAddWithFactory(this.modelKey,function(i){for(var r=new e.GroupInstanceInfo(t.renderGroup,t._modelRenderCache,t._modelRenderCache._partData.length),n=0;n<t._modelRenderCache._partData.length;n++){var o=t._instanceDataParts[n];r.partIndexFromId.add(o.id.toString(),n),r.usedShaderCategories[n]=";"+t.getUsedShaderCategories(o).join(";")+";",r.strides[n]=t._modelRenderCache._partData[n]._partDataStride}return r}),n=null;n=this.isTransparent?r.transparentData:this.isAlphaTest?r.alphaTestData:r.opaqueData;for(var o=0;o<i.length;o++){var s=i[o];s.dataBuffer=n[o]._partData,s.allocElements()}return this._modelRenderInstanceID=this._modelRenderCache.addInstanceDataParts(this._instanceDataParts),r},r.prototype._setupModelRenderCache=function(t){var r=new Array;this._modelRenderCache._partData=new Array;for(var n=0;n<t.length;n++){var o=t[n],s=new e.ModelRenderCachePartData;this._modelRenderCache._partData.push(s);var a=this.getUsedShaderCategories(o),h=o.getClassTreeInfo(),c=this.isVisible;this.isVisible=!0;var l=";"+a.join(";")+";";s._partJoinedUsedCategories=l,i._CurCategories=l;var u=this.beforeRefreshForLayoutConstruction(o);this.refreshInstanceDataPart(o),this.afterRefreshForLayoutConstruction(o,u),this.isVisible=c;var f=0;h.fullContent.forEach(function(t,i){i.category&&-1===a.indexOf(i.category)||("zBias"===i.attributeName&&(s._zBiasOffset=i.instanceOffset.get(l)),i.size?f+=i.size:console.log("ERROR: Couldn't detect the size of the Property "+i.attributeName+" from type "+e.Tools.getClassName(h.type)+". Property is ignored."))}),s._partDataStride=f,s._partUsedCategories=a,s._partId=o.id,r.push(h)}this._modelRenderCache._partsClassInfo=r},r.prototype.onZOrderChanged=function(){if(this.isTransparent&&this._transparentPrimitiveInfo){this.renderGroup._renderableData.transparentPrimitiveZChanged(this._transparentPrimitiveInfo);var e=this.renderGroup._renderableData._renderGroupInstancesInfo.get(this.modelKey);e.transparentOrderDirty=!0}},r.prototype._updateInstanceDataParts=function(t){t||(t=this.renderGroup._renderableData._renderGroupInstancesInfo.get(this.modelKey)),this.isTransparent&&this._isFlagSet(e.SmartPropertyPrim.flagVisibilityChanged)&&(this.isVisible?this._transparentPrimitiveInfo||(this._transparentPrimitiveInfo=this.renderGroup._renderableData.addNewTransparentPrimitiveInfo(this,t)):this._transparentPrimitiveInfo&&(this.renderGroup._renderableData.removeTransparentPrimitiveInfo(this._transparentPrimitiveInfo),this._transparentPrimitiveInfo=null),t.transparentOrderDirty=!0);for(var r=0,n=this._instanceDataParts;r<n.length;r++){var o=n[r];this._isFlagSet(e.SmartPropertyPrim.flagVisibilityChanged)&&!o.dataElements&&o.allocElements(),i._CurCategories=t.usedShaderCategories[t.partIndexFromId.get(o.id.toString())],this.refreshInstanceDataPart(o)||o.dataElements&&o.freeElements()}this._instanceDirtyFlags=0,this.isTransparent?t.transparentDirty=!0:this.isAlphaTest?t.alphaTestDirty=!0:t.opaqueDirty=!0,this._clearFlags(e.SmartPropertyPrim.flagVisibilityChanged)},r.prototype._getFirstIndexInDataBuffer=function(){for(var e=0,t=this._instanceDataParts;e<t.length;e++){var i=t[e];if(i)return i.dataElements[0].offset/i.dataBuffer.stride}return null},r.prototype._getLastIndexInDataBuffer=function(){for(var e=0,t=this._instanceDataParts;e<t.length;e++){var i=t[e];if(i)return i.dataElements[i.dataElements.length-1].offset/i.dataBuffer.stride}return null},r.prototype._getNextPrimZOrder=function(){for(var e=this._instanceDataParts.length,t=0;e>t;t++){var i=this._instanceDataParts[t];if(i){var r=i.dataBuffer.stride,n=i.dataElements[i.dataElements.length-1].offset;return i.dataBuffer.totalElementCount*r<=n?null:i.dataBuffer[n+r+this.modelRenderCache._partData[t]._zBiasOffset]}}return null},r.prototype._getPrevPrimZOrder=function(){for(var e=this._instanceDataParts.length,t=0;e>t;t++){var i=this._instanceDataParts[t];if(i){var r=i.dataBuffer.stride,n=i.dataElements[0].offset;return 0===n?null:i.dataBuffer[n-r+this.modelRenderCache._partData[t]._zBiasOffset]}}return null},r.prototype.transformPointWithOriginByRef=function(e,t,i){var r=this.actualSize;i.x=e.x-(this.origin.x+(t?t.x:0))*r.width,i.y=e.y-(this.origin.y+(t?t.y:0))*r.height},r.prototype.transformPointWithOriginToRef=function(e,t,i){return this.transformPointWithOriginByRef(e,t,i),i},r.prototype.getDataPartEffectInfo=function(t,i,r){void 0===r&&(r=null);var n=e.Tools.first(this._instanceDataParts,function(e){return e.id===t});if(!n)return null;var o=this.owner.supportInstancedArray;if(null!=r){if(r&&o===!1)return null;o=r}var s=n.getClassTreeInfo(),a=this.getUsedShaderCategories(n),h=s.classContent.getShaderAttributes(a),c="";return a.forEach(function(e){c+="#define "+e+"\n"}),o&&(c+="#define Instanced\n"),{attributes:o?i.concat(h):i,uniforms:o?[]:h,defines:c}},Object.defineProperty(r.prototype,"modelRenderCache",{get:function(){return this._modelRenderCache},enumerable:!0,configurable:!0}),r.prototype.createModelRenderCache=function(e){return null},r.prototype.setupModelRenderCache=function(e){},r.prototype.createInstanceDataParts=function(){return null},r.prototype.getUsedShaderCategories=function(e){return[]},r.prototype.beforeRefreshForLayoutConstruction=function(e){},r.prototype.afterRefreshForLayoutConstruction=function(e,t){},r.prototype.refreshInstanceDataPart=function(e){return this.isVisible?(e.isVisible=this.isVisible,1===e.dataElementCount&&(e.curElement=0,this.updateInstanceDataPart(e)),!0):!1},r.prototype.updateInstanceDataPart=function(t,i){void 0===i&&(i=null);var r=this._globalTransform.multiply(this.renderGroup.invGlobalTransform),n=this.renderGroup.viewportSize,o=this.actualZOffset,s=0,a=0;i&&(s=i.x*r.m[0]+i.y*r.m[4],a=i.x*r.m[1]+i.y*r.m[5]);var h=n.width,c=n.height,l=1/o,u=new e.Vector4(2*r.m[0]/h,2*r.m[4]/h,0,2*(r.m[12]+s)/h-1),f=new e.Vector4(2*r.m[1]/c,2*r.m[5]/c,0,2*(r.m[13]+a)/c-1);t.transformX=u,t.transformY=f,t.zBias=new e.Vector2(o,l)},r.RENDERABLEPRIM2D_PROPCOUNT=e.Prim2DBase.PRIM2DBASE_PROPCOUNT+5,__decorate([e.dynamicLevelProperty(e.Prim2DBase.PRIM2DBASE_PROPCOUNT+0,function(e){return r.isAlphaTestProperty=e})],r.prototype,"isAlphaTest",null),__decorate([e.dynamicLevelProperty(e.Prim2DBase.PRIM2DBASE_PROPCOUNT+1,function(e){return r.isTransparentProperty=e})],r.prototype,"isTransparent",null),r=__decorate([e.className("RenderablePrim2D")],r)}(e.Prim2DBase);e.RenderablePrim2D=o}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(i){t.call(this,i),i||(i={});var r=null;i.border&&(r="string"==typeof i.border?e.Canvas2D.GetBrushFromString(i.border):i.border);var n=null;i.fill&&(n="string"==typeof i.fill?e.Canvas2D.GetBrushFromString(i.fill):i.fill),this.border=r,this.fill=n,this.borderThickness=i.borderThickness}return __extends(i,t),Object.defineProperty(i.prototype,"border",{get:function(){return this._border},set:function(e){this._border=e,this._updateTransparencyStatus()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"fill",{get:function(){return this._fill},set:function(e){this._fill=e,this._updateTransparencyStatus()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"borderThickness",{get:function(){return this._borderThickness},set:function(e){this._borderThickness=e},enumerable:!0,configurable:!0}),i.prototype.getUsedShaderCategories=function(r){var n=t.prototype.getUsedShaderCategories.call(this,r);if(r.id===i.SHAPE2D_FILLPARTID){var o=this.fill;o instanceof e.SolidColorBrush2D&&n.push(i.SHAPE2D_CATEGORY_FILLSOLID),o instanceof e.GradientColorBrush2D&&n.push(i.SHAPE2D_CATEGORY_FILLGRADIENT)}if(r.id===i.SHAPE2D_BORDERPARTID){n.push(i.SHAPE2D_CATEGORY_BORDER);var s=this.border;s instanceof e.SolidColorBrush2D&&n.push(i.SHAPE2D_CATEGORY_BORDERSOLID),s instanceof e.GradientColorBrush2D&&n.push(i.SHAPE2D_CATEGORY_BORDERGRADIENT)}return n},i.prototype.refreshInstanceDataPart=function(r){if(!t.prototype.refreshInstanceDataPart.call(this,r))return!1;if(r.id===i.SHAPE2D_FILLPARTID){var n=r;if(this.fill){var o=this.fill;if(o instanceof e.SolidColorBrush2D)n.fillSolidColor=o.color;else if(o instanceof e.GradientColorBrush2D){n.fillGradientColor1=o.color1,n.fillGradientColor2=o.color2;var s=e.Matrix.Compose(new e.Vector3(o.scale,o.scale,o.scale),e.Quaternion.RotationAxis(new e.Vector3(0,0,1),o.rotation),new e.Vector3(o.translation.x,o.translation.y,0)),a=new e.Vector4(s.m[1],s.m[5],s.m[9],s.m[13]);n.fillGradientTY=a}}}else if(r.id===i.SHAPE2D_BORDERPARTID){var n=r;if(this.border){n.borderThickness=this.borderThickness;var h=this.border;if(h instanceof e.SolidColorBrush2D)n.borderSolidColor=h.color;else if(h instanceof e.GradientColorBrush2D){n.borderGradientColor1=h.color1,n.borderGradientColor2=h.color2;var s=e.Matrix.Compose(new e.Vector3(h.scale,h.scale,h.scale),e.Quaternion.RotationAxis(new e.Vector3(0,0,1),h.rotation),new e.Vector3(h.translation.x,h.translation.y,0)),a=new e.Vector4(s.m[1],s.m[5],s.m[9],s.m[13]);n.borderGradientTY=a}}}return!0},i.prototype._updateTransparencyStatus=function(){this.isTransparent=this._border&&this._border.isTransparent()||this._fill&&this._fill.isTransparent()},i.SHAPE2D_BORDERPARTID=1,i.SHAPE2D_FILLPARTID=2,i.SHAPE2D_CATEGORY_BORDER="Border",i.SHAPE2D_CATEGORY_BORDERSOLID="BorderSolid",i.SHAPE2D_CATEGORY_BORDERGRADIENT="BorderGradient",i.SHAPE2D_CATEGORY_FILLSOLID="FillSolid",
i.SHAPE2D_CATEGORY_FILLGRADIENT="FillGradient",i.SHAPE2D_PROPCOUNT=e.RenderablePrim2D.RENDERABLEPRIM2D_PROPCOUNT+5,__decorate([e.modelLevelProperty(e.RenderablePrim2D.RENDERABLEPRIM2D_PROPCOUNT+1,function(e){return i.borderProperty=e},!0)],i.prototype,"border",null),__decorate([e.modelLevelProperty(e.RenderablePrim2D.RENDERABLEPRIM2D_PROPCOUNT+2,function(e){return i.fillProperty=e},!0)],i.prototype,"fill",null),__decorate([e.instanceLevelProperty(e.RenderablePrim2D.RENDERABLEPRIM2D_PROPCOUNT+3,function(e){return i.borderThicknessProperty=e})],i.prototype,"borderThickness",null),i=__decorate([e.className("Shape2D")],i)}(e.RenderablePrim2D);e.Shape2D=t;var i=function(i){function r(){i.apply(this,arguments)}return __extends(r,i),Object.defineProperty(r.prototype,"fillSolidColor",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"fillGradientColor1",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"fillGradientColor2",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"fillGradientTY",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"borderThickness",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"borderSolidColor",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"borderGradientColor1",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"borderGradientColor2",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"borderGradientTY",{get:function(){return null},enumerable:!0,configurable:!0}),__decorate([e.instanceData(t.SHAPE2D_CATEGORY_FILLSOLID)],r.prototype,"fillSolidColor",null),__decorate([e.instanceData(t.SHAPE2D_CATEGORY_FILLGRADIENT)],r.prototype,"fillGradientColor1",null),__decorate([e.instanceData(t.SHAPE2D_CATEGORY_FILLGRADIENT)],r.prototype,"fillGradientColor2",null),__decorate([e.instanceData(t.SHAPE2D_CATEGORY_FILLGRADIENT)],r.prototype,"fillGradientTY",null),__decorate([e.instanceData(t.SHAPE2D_CATEGORY_BORDER)],r.prototype,"borderThickness",null),__decorate([e.instanceData(t.SHAPE2D_CATEGORY_BORDERSOLID)],r.prototype,"borderSolidColor",null),__decorate([e.instanceData(t.SHAPE2D_CATEGORY_BORDERGRADIENT)],r.prototype,"borderGradientColor1",null),__decorate([e.instanceData(t.SHAPE2D_CATEGORY_BORDERGRADIENT)],r.prototype,"borderGradientColor2",null),__decorate([e.instanceData(t.SHAPE2D_CATEGORY_BORDERGRADIENT)],r.prototype,"borderGradientTY",null),r}(e.InstanceDataBase);e.Shape2DInstanceData=i}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function r(i){null==i&&(i={}),null==i.origin&&(i.origin=new e.Vector2(0,0)),t.call(this,i);var n=i.size||i.width||i.height?i.size||new e.Size(i.width||0,i.height||0):null;this._trackedNode=null==i.trackNode?null:i.trackNode,this._trackedNode&&this.owner&&this.owner._registerTrackedNode(this),this._cacheBehavior=null==i.cacheBehavior?r.GROUPCACHEBEHAVIOR_FOLLOWCACHESTRATEGY:i.cacheBehavior,this.size=n,this._viewportPosition=e.Vector2.Zero()}return __extends(r,t),r._createCachedCanvasGroup=function(t){var i=new r({parent:t,id:"__cachedCanvasGroup__",position:e.Vector2.Zero(),origin:e.Vector2.Zero(),size:null,isVisible:!0});return i},r.prototype.applyCachedTexture=function(t,i){if(this._bindCacheTarget(),t)for(var r=t.uvs,n=this._renderableData._cacheNode.UVs,o=0;4>o;o++)r[2*o+0]=n[o].x,r[2*o+1]=n[o].y;i&&(i.diffuseTexture=this._renderableData._cacheTexture,i.emissiveColor=new e.Color3(1,1,1)),this._renderableData._cacheTexture.hasAlpha=!0,this._unbindCacheTarget()},Object.defineProperty(r.prototype,"cachedRect",{get:function(){return this._renderableData?this._renderableData._cacheNode:null},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"cacheTexture",{get:function(){return this._renderableData?this._renderableData._cacheTexture:null},enumerable:!0,configurable:!0}),r.prototype.dispose=function(){return t.prototype.dispose.call(this)?(null!=this._trackedNode&&(this.owner._unregisterTrackedNode(this),this._trackedNode=null),this._renderableData&&(this._renderableData.dispose(),this._renderableData=null),!0):!1},Object.defineProperty(r.prototype,"isRenderableGroup",{get:function(){return this._isRenderableGroup},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isCachedGroup",{get:function(){return this._isCachedGroup},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"size",{get:function(){return this._size},set:function(e){this._size=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"viewportSize",{get:function(){return this._viewportSize},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"actualSize",{get:function(){var t;if(this._size)t=new e.Size(Math.ceil(this._size.width),Math.ceil(this._size.height));else{var i=this.boundingInfo.max();t=new e.Size(Math.ceil(i.x),Math.ceil(i.y))}return t.equals(this._actualSize)||(this.onPrimitivePropertyDirty(r.actualSizeProperty.flagId),this._actualSize=t,this.handleGroupChanged(r.actualSizeProperty)),t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"cacheBehavior",{get:function(){return this._cacheBehavior},enumerable:!0,configurable:!0}),r.prototype._addPrimToDirtyList=function(e){this._renderableData._primDirtyList.push(e)},r.prototype._renderCachedCanvas=function(){this.updateCachedStates(!0);var t=new e.PrepareRender2DContext;this._prepareGroupRender(t),this._groupRender()},Object.defineProperty(r.prototype,"trackedNode",{get:function(){return this._trackedNode},set:function(t){null!=t?(this._isFlagSet(e.SmartPropertyPrim.flagTrackedGroup)||this.owner._registerTrackedNode(this),this._trackedNode=t):(this._isFlagSet(e.SmartPropertyPrim.flagTrackedGroup)&&this.owner._unregisterTrackedNode(this),this._trackedNode=null)},enumerable:!0,configurable:!0}),r.prototype.levelIntersect=function(e){return!0},r.prototype.updateLevelBoundingInfo=function(){var t;t=this.size?this.size:new e.Size(0,0),e.BoundingInfo2D.CreateFromSizeToRef(t,this._levelBoundingInfo)},r.prototype._prepareGroupRender=function(t){var i=null;if((this._renderableData._primDirtyList.length>0||t.forceRefreshPrimitive)&&(i=this._renderableData._primDirtyList.sort(function(e,t){return e.hierarchyDepth-t.hierarchyDepth}),this.updateCachedStatesOf(i,!0)),this._isCachedGroup){var r=this.actualSize.clone();r.equals(this._viewportSize)||(t.forceRefreshPrimitive=!0),this._viewportSize=r}else{var n=this._globalTransform.getTranslation(),o=this.actualSize.clone(),s=this.owner._renderingSize;o.height=Math.min(o.height,s.height-n.y),o.width=Math.min(o.width,s.width-n.x);var a=n.x,h=n.y;this._viewportPosition.x=a,this._viewportPosition.y=h;var c=o.width,l=o.height;this._viewportSize?(this._viewportSize.width===c&&this._viewportSize.height===l||(t.forceRefreshPrimitive=!0),this._viewportSize.width=c,this._viewportSize.height=l):this._viewportSize=new e.Size(c,l)}if(this._renderableData._primDirtyList.length>0||t.forceRefreshPrimitive)if(this._cacheGroupDirty=this._isCachedGroup,t.forceRefreshPrimitive)for(var u=0,f=this._children;u<f.length;u++){var d=f[u];d._prepareRender(t)}else i||(i=this._renderableData._primDirtyList.sort(function(e,t){return e.hierarchyDepth-t.hierarchyDepth})),i.forEach(function(e){!e.isDisposed&&e._needPrepare()&&e._prepareRender(t)}),this._renderableData._primDirtyList.forEach(function(e){return e._resetPropertiesDirty()}),this._renderableData._primDirtyList.splice(0);this._renderableData._childrenRenderableGroups.forEach(function(e){e._prepareGroupRender(t)})},r.prototype._groupRender=function(){for(var t=this,i=this.owner.engine,r=0,n=0,o=this._renderableData._childrenRenderableGroups;n<o.length;n++){var s=o[n];s._groupRender()}if(!this.isCachedGroup||this._cacheGroupDirty){if(this.isCachedGroup)this._bindCacheTarget();else var a=i.setDirectViewport(this._viewportPosition.x,this._viewportPosition.y,this._viewportSize.width,this._viewportSize.height);var h=i.getAlphaTesting()===!0,c=i.getDepthWrite()===!0;i.setAlphaTesting(!1),i.setDepthWrite(!0);var l=new e.Render2DContext(e.Render2DContext.RenderModeOpaque);this._renderableData._renderGroupInstancesInfo.forEach(function(e,n){var o=t._prepareContext(i,l,n);if(null!==o&&(!t.owner.supportInstancedArray||o>0)){var s=!n.modelRenderCache.render(n,l);n.opaqueDirty=s,r+=s?1:0}}),i.setAlphaTesting(!0),i.setDepthWrite(!0),l=new e.Render2DContext(e.Render2DContext.RenderModeAlphaTest),this._renderableData._renderGroupInstancesInfo.forEach(function(e,n){var o=t._prepareContext(i,l,n);if(null!==o&&(!t.owner.supportInstancedArray||o>0)){var s=!n.modelRenderCache.render(n,l);n.opaqueDirty=s,r+=s?1:0}}),i.setAlphaTesting(!0),i.setDepthWrite(!1),this._renderableData._transparentListChanged&&this._updateTransparentData(),r+=this._renderTransparentData(),this._cacheGroupDirty=0!==r,this.isCachedGroup?this._unbindCacheTarget():a&&i.setViewport(a),i.setAlphaTesting(h),i.setDepthWrite(c)}},r.prototype._updateTransparentData=function(){var t=this._renderableData;if(null!==t._firstChangedPrim){t._transparentPrimitives.sort(function(e,t){return t._primitive.actualZOffset-e._primitive.actualZOffset});var i=function(e,i){var r=t._transparentPrimitives[i];if(e.groupInsanceInfo!==r._groupInstanceInfo)return!1;var n=r._primitive.actualZOffset;return r._transparentSegment=e,n<e.endZ&&(e.endZ=n,e.endDataIndex=r._primitive._getLastIndexInDataBuffer()+1),!0};t._transparentSegments.splice(0);for(var r=null,n=0;n<t._transparentPrimitives.length;n++){var o=t._transparentPrimitives[n];if(o._groupInstanceInfo.transparentOrderDirty&&o._groupInstanceInfo.sortTransparentData(),o._transparentSegment=null,r&&i(r,n),!o._transparentSegment){var s=new e.TransparentSegment;s.groupInsanceInfo=o._groupInstanceInfo;var a=o._primitive;s.startZ=a.actualZOffset,s.startDataIndex=a._getFirstIndexInDataBuffer(),s.endDataIndex=a._getLastIndexInDataBuffer()+1,s.endZ=s.startZ,o._transparentSegment=s,t._transparentSegments.push(s)}r=o._transparentSegment}t._firstChangedPrim=null,t._transparentListChanged=!1}},r.prototype._renderTransparentData=function(){for(var t=0,i=new e.Render2DContext(e.Render2DContext.RenderModeTransparent),r=this._renderableData,n=r._transparentSegments.length,o=0;n>o;o++){var s=r._transparentSegments[o],a=s.groupInsanceInfo,h=a.modelRenderCache;i.useInstancing=!1,i.partDataStartIndex=s.startDataIndex,i.partDataEndIndex=s.endDataIndex,i.groupInfoPartData=a.transparentData;var c=!h.render(a,i);t+=c?1:0}return t},r.prototype._prepareContext=function(t,i,r){var n,o,s=null;switch(i.renderMode){case e.Render2DContext.RenderModeOpaque:if(!r.hasOpaqueData)return null;n=function(e){r.opaqueDirty=e},o=function(){return r.opaqueDirty},i.groupInfoPartData=r.opaqueData,s=r.opaqueData;break;case e.Render2DContext.RenderModeAlphaTest:if(!r.hasAlphaTestData)return null;n=function(e){r.alphaTestDirty=e},o=function(){return r.alphaTestDirty},i.groupInfoPartData=r.alphaTestData,s=r.alphaTestData;break;default:throw new Error("_prepareContext is only for opaque or alphaTest")}var a=0;if(this.owner.supportInstancedArray){i.useInstancing=!0;for(var h=0;h<s.length;h++){var c=s[h],l=c._partData,u=l.pack();a+=l.usedElementCount;var f=l.usedElementCount*l.stride*4;!c._partBuffer||c._partBufferSize<f?(c._partBuffer&&t.deleteInstancesBuffer(c._partBuffer),c._partBuffer=t.createInstancesBuffer(f),c._partBufferSize=f,n(!1),t.updateArrayBuffer(u)):o()&&(t.bindArrayBuffer(c._partBuffer),t.updateArrayBuffer(u))}n(!1)}else{i.partDataStartIndex=0;for(var h=0;!i.groupInfoPartData[h];)h++;i.partDataEndIndex=i.groupInfoPartData[h]._partData.usedElementCount}return a},r.prototype._bindCacheTarget=function(){var t,i,r=this._renderableData;if(r._cacheNode){var n=r._cacheNode.contentSize,o=Math.ceil(this.actualSize.width),s=Math.ceil(this.actualSize.height);(n.width<o||n.height<s)&&(t=Math.floor(1.07*n.width),i=Math.floor(1.07*n.height),r._cacheTexture.freeRect(r._cacheNode),r._cacheNode=null)}if(!r._cacheNode){var a=this.owner._allocateGroupCache(this,this.renderGroup,t?new e.Size(t,i):null);r._cacheNode=a.node,r._cacheTexture=a.texture,r._cacheRenderSprite=a.sprite;var n=r._cacheNode.contentSize}var h=r._cacheNode;r._cacheTexture.bindTextureForPosSize(h.pos,this.actualSize,!0)},r.prototype._unbindCacheTarget=function(){this._renderableData._cacheTexture&&this._renderableData._cacheTexture.unbindTexture()},r.prototype.handleGroupChanged=function(t){var i=this._renderableData;this.isCachedGroup&&i._cacheRenderSprite&&(t.id===e.Prim2DBase.actualPositionProperty.id?i._cacheRenderSprite.actualPosition=this.actualPosition.clone():t.id===e.Prim2DBase.rotationProperty.id?i._cacheRenderSprite.rotation=this.rotation:t.id===e.Prim2DBase.scaleProperty.id?i._cacheRenderSprite.scale=this.scale:t.id===e.Prim2DBase.originProperty.id?i._cacheRenderSprite.origin=this.origin.clone():t.id===r.actualSizeProperty.id&&(i._cacheRenderSprite.size=this.actualSize.clone()))},r.prototype.detectGroupStates=function(){var t=this instanceof e.Canvas2D,n=this.owner.cachingStrategy;if(n===e.Canvas2D.CACHESTRATEGY_DONTCACHE)this._isRenderableGroup=t,this._isCachedGroup=!1;else if(n===e.Canvas2D.CACHESTRATEGY_CANVAS)t?(this._isRenderableGroup=!0,this._isCachedGroup=!0):(this._isRenderableGroup="__cachedCanvasGroup__"===this.id,this._isCachedGroup=!1);else if(n===e.Canvas2D.CACHESTRATEGY_TOPLEVELGROUPS)t?(this._isRenderableGroup=!0,this._isCachedGroup=!1):1===this.hierarchyDepth?(this._isRenderableGroup=!0,this._isCachedGroup=!0):(this._isRenderableGroup=!1,this._isCachedGroup=!1);else if(n===e.Canvas2D.CACHESTRATEGY_ALLGROUPS){var o=this.cacheBehavior;o!==r.GROUPCACHEBEHAVIOR_DONTCACHEOVERRIDE&&o!==r.GROUPCACHEBEHAVIOR_CACHEINPARENTGROUP||(this._isRenderableGroup=o===r.GROUPCACHEBEHAVIOR_DONTCACHEOVERRIDE,this._isCachedGroup=!1),o===r.GROUPCACHEBEHAVIOR_FOLLOWCACHESTRATEGY&&(this._isRenderableGroup=!0,this._isCachedGroup=!0)}if(this._isRenderableGroup&&(this._renderableData||(this._renderableData=new i)),this._isCachedGroup)for(var s=this.parent;s;){if(s instanceof r&&s._isRenderableGroup){-1===s._renderableData._childrenRenderableGroups.indexOf(this)&&s._renderableData._childrenRenderableGroups.push(this);break}s=s.parent}},r.GROUP2D_PROPCOUNT=e.Prim2DBase.PRIM2DBASE_PROPCOUNT+5,r.GROUPCACHEBEHAVIOR_FOLLOWCACHESTRATEGY=0,r.GROUPCACHEBEHAVIOR_DONTCACHEOVERRIDE=1,r.GROUPCACHEBEHAVIOR_CACHEINPARENTGROUP=2,__decorate([e.instanceLevelProperty(e.Prim2DBase.PRIM2DBASE_PROPCOUNT+1,function(e){return r.sizeProperty=e},!1,!0)],r.prototype,"size",null),__decorate([e.instanceLevelProperty(e.Prim2DBase.PRIM2DBASE_PROPCOUNT+2,function(e){return r.actualSizeProperty=e})],r.prototype,"actualSize",null),r=__decorate([e.className("Group2D")],r)}(e.Prim2DBase);e.Group2D=t;var i=function(){function t(){this._primDirtyList=new Array,this._childrenRenderableGroups=new Array,this._renderGroupInstancesInfo=new e.StringDictionary,this._transparentPrimitives=new Array,this._transparentSegments=new Array,this._firstChangedPrim=null,this._transparentListChanged=!1,this._cacheNode=null,this._cacheTexture=null,this._cacheRenderSprite=null}return t.prototype.dispose=function(){this._cacheRenderSprite&&(this._cacheRenderSprite.dispose(),this._cacheRenderSprite=null),this._cacheTexture&&this._cacheNode&&(this._cacheTexture.freeRect(this._cacheNode),this._cacheTexture=null,this._cacheNode=null),this._primDirtyList&&(this._primDirtyList.splice(0),this._primDirtyList=null),this._renderGroupInstancesInfo&&(this._renderGroupInstancesInfo.forEach(function(e,t){t.dispose()}),this._renderGroupInstancesInfo=null)},t.prototype.addNewTransparentPrimitiveInfo=function(e,t){var i=new r;return i._primitive=e,i._groupInstanceInfo=t,i._transparentSegment=null,this._transparentPrimitives.push(i),this._transparentListChanged=!0,this.updateSmallestZChangedPrim(i),i},t.prototype.removeTransparentPrimitiveInfo=function(e){var t=this._transparentPrimitives.indexOf(e);-1!==t&&(this._transparentPrimitives.splice(t,1),this._transparentListChanged=!0,this.updateSmallestZChangedPrim(e))},t.prototype.transparentPrimitiveZChanged=function(e){this._transparentListChanged=!0,this.updateSmallestZChangedPrim(e)},t.prototype.updateSmallestZChangedPrim=function(e){if(e._primitive){var t=e._primitive.actualZOffset,i=this._firstChangedPrim?this._firstChangedPrim._primitive.actualZOffset:Number.MIN_VALUE;t>i&&(this._firstChangedPrim=e)}},t}();e.RenderableGroupData=i;var r=function(){function e(){}return e}();e.TransparentPrimitiveInfo=r}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(e,i){t.call(this,e,i),this.effectsReady=!1,this.fillVB=null,this.fillIB=null,this.fillIndicesCount=0,this.instancingFillAttributes=null,this.effectFill=null,this.effectFillInstanced=null,this.borderVB=null,this.borderIB=null,this.borderIndicesCount=0,this.instancingBorderAttributes=null,this.effectBorder=null,this.effectBorderInstanced=null}return __extends(i,t),i.prototype.render=function(t,i){if(!this.effectsReady){if(this.effectFill&&(!this.effectFill.isReady()||this.effectFillInstanced&&!this.effectFillInstanced.isReady())||this.effectBorder&&(!this.effectBorder.isReady()||this.effectBorderInstanced&&!this.effectBorderInstanced.isReady()))return!1;this.effectsReady=!0}var r=t.owner.owner.engine,n=0;this.effectFill&&this.effectBorder&&(n=r.getDepthFunction(),r.setDepthFunctionToLessOrEqual());var o=r.getAlphaMode();if(this.effectFill){var s=t.partIndexFromId.get(e.Shape2D.SHAPE2D_FILLPARTID.toString()),a=i.groupInfoPartData[s];i.renderMode!==e.Render2DContext.RenderModeOpaque&&r.setAlphaMode(e.Engine.ALPHA_COMBINE);var h=i.useInstancing?this.effectFillInstanced:this.effectFill;if(r.enableEffect(h),r.bindBuffersDirectly(this.fillVB,this.fillIB,[1],4,h),i.useInstancing)this.instancingFillAttributes||(this.instancingFillAttributes=this.loadInstancingAttributes(e.Shape2D.SHAPE2D_FILLPARTID,h)),r.updateAndBindInstancesBuffer(a._partBuffer,null,this.instancingFillAttributes),r.draw(!0,0,this.fillIndicesCount,a._partData.usedElementCount),r.unbindInstanceAttributes();else for(var c=i.partDataStartIndex;c<i.partDataEndIndex;c++)this.setupUniforms(h,s,a._partData,c),r.draw(!0,0,this.fillIndicesCount)}if(this.effectBorder){var s=t.partIndexFromId.get(e.Shape2D.SHAPE2D_BORDERPARTID.toString()),a=i.groupInfoPartData[s];i.renderMode!==e.Render2DContext.RenderModeOpaque&&r.setAlphaMode(e.Engine.ALPHA_COMBINE);var h=i.useInstancing?this.effectBorderInstanced:this.effectBorder;if(r.enableEffect(h),r.bindBuffersDirectly(this.borderVB,this.borderIB,[1],4,h),i.useInstancing)this.instancingBorderAttributes||(this.instancingBorderAttributes=this.loadInstancingAttributes(e.Shape2D.SHAPE2D_BORDERPARTID,h)),r.updateAndBindInstancesBuffer(a._partBuffer,null,this.instancingBorderAttributes),r.draw(!0,0,this.borderIndicesCount,a._partData.usedElementCount),r.unbindInstanceAttributes();else for(var c=i.partDataStartIndex;c<i.partDataEndIndex;c++)this.setupUniforms(h,s,a._partData,c),r.draw(!0,0,this.borderIndicesCount)}return r.setAlphaMode(o),this.effectFill&&this.effectBorder&&r.setDepthFunction(n),!0},i.prototype.dispose=function(){return t.prototype.dispose.call(this)?(this.fillVB&&(this._engine._releaseBuffer(this.fillVB),this.fillVB=null),this.fillIB&&(this._engine._releaseBuffer(this.fillIB),this.fillIB=null),this.effectFill&&(this._engine._releaseEffect(this.effectFill),this.effectFill=null),this.effectFillInstanced&&(this._engine._releaseEffect(this.effectFillInstanced),this.effectFillInstanced=null),this.borderVB&&(this._engine._releaseBuffer(this.borderVB),this.borderVB=null),this.borderIB&&(this._engine._releaseBuffer(this.borderIB),this.borderIB=null),this.effectBorder&&(this._engine._releaseEffect(this.effectBorder),this.effectBorder=null),this.effectBorderInstanced&&(this._engine._releaseEffect(this.effectBorderInstanced),this.effectBorderInstanced=null),!0):!1},i}(e.ModelRenderCache);e.Rectangle2DRenderCache=t;var i=function(t){function i(e){t.call(this,e,1)}return __extends(i,t),Object.defineProperty(i.prototype,"properties",{get:function(){return null},enumerable:!0,configurable:!0}),__decorate([e.instanceData()],i.prototype,"properties",null),i}(e.Shape2DInstanceData);e.Rectangle2DInstanceData=i;var r=function(r){function n(t){if(null==t&&(t={}),r.call(this,t),null!=t.size)this.size=t.size;else if(t.width||t.height){var i=new e.Size(t.width,t.height);this.size=i}var n=null==t.roundRadius?0:t.roundRadius,o=null==t.borderThickness?1:t.borderThickness;this.roundRadius=n,this.borderThickness=o}return __extends(n,r),Object.defineProperty(n.prototype,"actualSize",{get:function(){return this._actualSize?this._actualSize:this.size},set:function(e){this._actualSize=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"notRounded",{get:function(){return this._notRounded},set:function(e){this._notRounded=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"roundRadius",{get:function(){return this._roundRadius},set:function(e){this._roundRadius=e,this.notRounded=0===e,this._positioningDirty()},enumerable:!0,configurable:!0}),n.prototype.levelIntersect=function(e){if(this.notRounded)return!0;var t=this.size;n._i0.x=e._localPickPosition.x,n._i0.y=e._localPickPosition.y;var i=this.roundRadius,r=i*i;return n._i1.x=i,n._i1.y=i,n._i0.x<=n._i1.x&&n._i0.y<=n._i1.y?(n._i2.x=n._i0.x-n._i1.x,n._i2.y=n._i0.y-n._i1.y,n._i2.lengthSquared()<=r):(n._i1.x=i,n._i1.y=t.height-i,n._i0.x<=n._i1.x&&n._i0.y>=n._i1.y?(n._i2.x=n._i0.x-n._i1.x,n._i2.y=n._i0.y-n._i1.y,n._i2.lengthSquared()<=r):(n._i1.x=t.width-i,n._i1.y=t.height-i,n._i0.x>=n._i1.x&&n._i0.y>=n._i1.y?(n._i2.x=n._i0.x-n._i1.x,n._i2.y=n._i0.y-n._i1.y,n._i2.lengthSquared()<=r):(n._i1.x=t.width-i,n._i1.y=i,n._i0.x>=n._i1.x&&n._i0.y<=n._i1.y?(n._i2.x=n._i0.x-n._i1.x,n._i2.y=n._i0.y-n._i1.y,n._i2.lengthSquared()<=r):!0)))},n.prototype.updateLevelBoundingInfo=function(){e.BoundingInfo2D.CreateFromSizeToRef(this.actualSize,this._levelBoundingInfo)},n.prototype.createModelRenderCache=function(e){var i=new t(this.owner.engine,e);return i},n.prototype.setupModelRenderCache=function(t){var i=t,r=this.owner.engine;if(this.fill){for(var o=4*(this.notRounded?1:n.roundSubdivisions)+1,s=new Float32Array(o),a=0;o>a;a++)s[a]=a;i.fillVB=r.createVertexBuffer(s);for(var h=o-1,c=new Float32Array(3*h),a=0;h>a;a++)c[3*a+0]=0,c[3*a+2]=a+1,c[3*a+1]=a+2;c[3*h-2]=1,i.fillIB=r.createIndexBuffer(c),i.fillIndicesCount=3*h;var l=this.getDataPartEffectInfo(e.Shape2D.SHAPE2D_FILLPARTID,["index"],!0);l&&(i.effectFillInstanced=r.createEffect("rect2d",l.attributes,l.uniforms,[],l.defines,null)),l=this.getDataPartEffectInfo(e.Shape2D.SHAPE2D_FILLPARTID,["index"],!1),i.effectFill=r.createEffect("rect2d",l.attributes,l.uniforms,[],l.defines,null)}if(this.border){for(var o=4*(this.notRounded?1:n.roundSubdivisions)*2,s=new Float32Array(o),a=0;o>a;a++)s[a]=a;i.borderVB=r.createVertexBuffer(s);for(var h=o,u=h/2,c=new Float32Array(3*h),a=0;u>a;a++){var f=a,d=(a+1)%u;c[6*a+0]=u+d,c[6*a+1]=u+f,c[6*a+2]=f,c[6*a+3]=d,c[6*a+4]=u+d,c[6*a+5]=f}i.borderIB=r.createIndexBuffer(c),i.borderIndicesCount=3*h;var l=this.getDataPartEffectInfo(e.Shape2D.SHAPE2D_BORDERPARTID,["index"],!0);l&&(i.effectBorderInstanced=r.createEffect("rect2d",l.attributes,l.uniforms,[],l.defines,null)),l=this.getDataPartEffectInfo(e.Shape2D.SHAPE2D_BORDERPARTID,["index"],!1),i.effectBorder=r.createEffect("rect2d",l.attributes,l.uniforms,[],l.defines,null)}return i},n.prototype._getInitialContentAreaToRef=function(e,t,i){if(this._notRounded)r.prototype._getInitialContentAreaToRef.call(this,e,t,i);else{var n=Math.round(1.3*(this.roundRadius-this.roundRadius/Math.sqrt(2)));t.x=t.y=n,i.width=Math.max(0,e.width-2*n),i.height=Math.max(0,e.height-2*n)}},n.prototype.createInstanceDataParts=function(){var t=new Array;return this.border&&t.push(new i(e.Shape2D.SHAPE2D_BORDERPARTID)),this.fill&&t.push(new i(e.Shape2D.SHAPE2D_FILLPARTID)),t},n.prototype.refreshInstanceDataPart=function(t){if(!r.prototype.refreshInstanceDataPart.call(this,t))return!1;if(t.id===e.Shape2D.SHAPE2D_BORDERPARTID){var i=t,n=this.actualSize;i.properties=new e.Vector3(n.width,n.height,this.roundRadius||0)}else if(t.id===e.Shape2D.SHAPE2D_FILLPARTID){var i=t,n=this.actualSize;i.properties=new e.Vector3(n.width,n.height,this.roundRadius||0)}return!0},n._i0=e.Vector2.Zero(),n._i1=e.Vector2.Zero(),n._i2=e.Vector2.Zero(),n.roundSubdivisions=16,__decorate([e.instanceLevelProperty(e.Shape2D.SHAPE2D_PROPCOUNT+1,function(e){return n.actualSizeProperty=e},!1,!0)],n.prototype,"actualSize",null),__decorate([e.modelLevelProperty(e.Shape2D.SHAPE2D_PROPCOUNT+2,function(e){return n.notRoundedProperty=e})],n.prototype,"notRounded",null),__decorate([e.instanceLevelProperty(e.Shape2D.SHAPE2D_PROPCOUNT+3,function(e){return n.roundRadiusProperty=e})],n.prototype,"roundRadius",null),n=__decorate([e.className("Rectangle2D")],n)}(e.Shape2D);e.Rectangle2D=r}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(e,i){t.call(this,e,i),this.effectsReady=!1,this.fillVB=null,this.fillIB=null,this.fillIndicesCount=0,this.instancingFillAttributes=null,this.effectFillInstanced=null,this.effectFill=null,this.borderVB=null,this.borderIB=null,this.borderIndicesCount=0,this.instancingBorderAttributes=null,this.effectBorderInstanced=null,this.effectBorder=null}return __extends(i,t),i.prototype.render=function(t,i){if(!this.effectsReady){if(this.effectFill&&(!this.effectFill.isReady()||this.effectFillInstanced&&!this.effectFillInstanced.isReady())||this.effectBorder&&(!this.effectBorder.isReady()||this.effectBorderInstanced&&!this.effectBorderInstanced.isReady()))return!1;this.effectsReady=!0}var r=t.owner.owner.engine,n=0;this.effectFill&&this.effectBorder&&(n=r.getDepthFunction(),r.setDepthFunctionToLessOrEqual());var o=r.getAlphaMode();if(this.effectFill){var s=t.partIndexFromId.get(e.Shape2D.SHAPE2D_FILLPARTID.toString()),a=i.groupInfoPartData[s];i.renderMode!==e.Render2DContext.RenderModeOpaque&&r.setAlphaMode(e.Engine.ALPHA_COMBINE);var h=i.useInstancing?this.effectFillInstanced:this.effectFill;if(r.enableEffect(h),r.bindBuffersDirectly(this.fillVB,this.fillIB,[1],4,h),i.useInstancing)this.instancingFillAttributes||(this.instancingFillAttributes=this.loadInstancingAttributes(e.Shape2D.SHAPE2D_FILLPARTID,h)),r.updateAndBindInstancesBuffer(a._partBuffer,null,this.instancingFillAttributes),r.draw(!0,0,this.fillIndicesCount,a._partData.usedElementCount),r.unbindInstanceAttributes();else for(var c=i.partDataStartIndex;c<i.partDataEndIndex;c++)this.setupUniforms(h,s,a._partData,c),r.draw(!0,0,this.fillIndicesCount)}if(this.effectBorder){var s=t.partIndexFromId.get(e.Shape2D.SHAPE2D_BORDERPARTID.toString()),a=i.groupInfoPartData[s];i.renderMode!==e.Render2DContext.RenderModeOpaque&&r.setAlphaMode(e.Engine.ALPHA_COMBINE);var h=i.useInstancing?this.effectBorderInstanced:this.effectBorder;if(r.enableEffect(h),r.bindBuffersDirectly(this.borderVB,this.borderIB,[1],4,h),i.useInstancing)this.instancingBorderAttributes||(this.instancingBorderAttributes=this.loadInstancingAttributes(e.Shape2D.SHAPE2D_BORDERPARTID,h)),r.updateAndBindInstancesBuffer(a._partBuffer,null,this.instancingBorderAttributes),r.draw(!0,0,this.borderIndicesCount,a._partData.usedElementCount),r.unbindInstanceAttributes();else for(var c=i.partDataStartIndex;c<i.partDataEndIndex;c++)this.setupUniforms(h,s,a._partData,c),r.draw(!0,0,this.borderIndicesCount)}return r.setAlphaMode(o),this.effectFill&&this.effectBorder&&r.setDepthFunction(n),!0},i.prototype.dispose=function(){return t.prototype.dispose.call(this)?(this.fillVB&&(this._engine._releaseBuffer(this.fillVB),this.fillVB=null),this.fillIB&&(this._engine._releaseBuffer(this.fillIB),this.fillIB=null),this.effectFill&&(this._engine._releaseEffect(this.effectFill),this.effectFill=null),this.effectFillInstanced&&(this._engine._releaseEffect(this.effectFillInstanced),this.effectFillInstanced=null),this.borderVB&&(this._engine._releaseBuffer(this.borderVB),this.borderVB=null),this.borderIB&&(this._engine._releaseBuffer(this.borderIB),this.borderIB=null),this.effectBorder&&(this._engine._releaseEffect(this.effectBorder),this.effectBorder=null),this.effectBorderInstanced&&(this._engine._releaseEffect(this.effectBorderInstanced),this.effectBorderInstanced=null),!0):!1},i}(e.ModelRenderCache);e.Ellipse2DRenderCache=t;var i=function(t){function i(e){t.call(this,e,1)}return __extends(i,t),Object.defineProperty(i.prototype,"properties",{get:function(){return null},enumerable:!0,configurable:!0}),__decorate([e.instanceData()],i.prototype,"properties",null),i}(e.Shape2DInstanceData);e.Ellipse2DInstanceData=i;var r=function(r){function n(t){if(null==t&&(t={}),r.call(this,t),null!=t.size)this.size=t.size;else if(t.width||t.height){var i=new e.Size(t.width,t.height);this.size=i}var n=null==t.subdivisions?64:t.subdivisions;this.subdivisions=n}return __extends(n,r),Object.defineProperty(n.prototype,"actualSize",{get:function(){return this._actualSize?this._actualSize:this.size},set:function(e){this._actualSize=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"subdivisions",{get:function(){return this._subdivisions},set:function(e){this._subdivisions=e},enumerable:!0,configurable:!0}),n.prototype.levelIntersect=function(e){var t=this.size.width/2,i=this.size.height/2,r=e._localPickPosition.x-t,n=e._localPickPosition.y-i;return 1>=r*r/(t*t)+n*n/(i*i)},n.prototype.updateLevelBoundingInfo=function(){e.BoundingInfo2D.CreateFromSizeToRef(this.actualSize,this._levelBoundingInfo)},n.prototype.createModelRenderCache=function(e){var i=new t(this.owner.engine,e);return i},n.prototype.setupModelRenderCache=function(t){var i=t,r=this.owner.engine;if(this.fill){for(var n=this.subdivisions+1,o=new Float32Array(n),s=0;n>s;s++)o[s]=s;i.fillVB=r.createVertexBuffer(o);for(var a=n-1,h=new Float32Array(3*a),s=0;a>s;s++)h[3*s+0]=0,h[3*s+2]=s+1,h[3*s+1]=s+2;h[3*a-2]=1,i.fillIB=r.createIndexBuffer(h),i.fillIndicesCount=3*a;var c=this.getDataPartEffectInfo(e.Shape2D.SHAPE2D_FILLPARTID,["index"],!0);c&&(i.effectFillInstanced=r.createEffect({vertex:"ellipse2d",fragment:"ellipse2d"},c.attributes,c.uniforms,[],c.defines,null)),c=this.getDataPartEffectInfo(e.Shape2D.SHAPE2D_FILLPARTID,["index"],!1),i.effectFill=r.createEffect({vertex:"ellipse2d",fragment:"ellipse2d"},c.attributes,c.uniforms,[],c.defines,null)}if(this.border){for(var n=2*this.subdivisions,o=new Float32Array(n),s=0;n>s;s++)o[s]=s;i.borderVB=r.createVertexBuffer(o);for(var a=n,l=a/2,h=new Float32Array(3*a),s=0;l>s;s++){var u=s,f=(s+1)%l;h[6*s+0]=l+f,h[6*s+1]=l+u,h[6*s+2]=u,h[6*s+3]=f,h[6*s+4]=l+f,h[6*s+5]=u}i.borderIB=r.createIndexBuffer(h),i.borderIndicesCount=3*a;var c=this.getDataPartEffectInfo(e.Shape2D.SHAPE2D_BORDERPARTID,["index"],!0);c&&(i.effectBorderInstanced=r.createEffect("ellipse2d",c.attributes,c.uniforms,[],c.defines,null)),c=this.getDataPartEffectInfo(e.Shape2D.SHAPE2D_BORDERPARTID,["index"],!1),i.effectBorder=r.createEffect("ellipse2d",c.attributes,c.uniforms,[],c.defines,null)}return i},n.prototype.createInstanceDataParts=function(){var t=new Array;return this.border&&t.push(new i(e.Shape2D.SHAPE2D_BORDERPARTID)),this.fill&&t.push(new i(e.Shape2D.SHAPE2D_FILLPARTID)),t},n.prototype.refreshInstanceDataPart=function(t){if(!r.prototype.refreshInstanceDataPart.call(this,t))return!1;if(t.id===e.Shape2D.SHAPE2D_BORDERPARTID){var i=t,n=this.actualSize;i.properties=new e.Vector3(n.width,n.height,this.subdivisions)}else if(t.id===e.Shape2D.SHAPE2D_FILLPARTID){var i=t,n=this.actualSize;i.properties=new e.Vector3(n.width,n.height,this.subdivisions)}return!0},__decorate([e.instanceLevelProperty(e.Shape2D.SHAPE2D_PROPCOUNT+1,function(e){return n.acutalSizeProperty=e},!1,!0)],n.prototype,"actualSize",null),__decorate([e.modelLevelProperty(e.Shape2D.SHAPE2D_PROPCOUNT+2,function(e){return n.subdivisionsProperty=e;
})],n.prototype,"subdivisions",null),n=__decorate([e.className("Ellipse2D")],n)}(e.Shape2D);e.Ellipse2D=r}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(){t.apply(this,arguments),this.effectsReady=!1,this.vb=null,this.ib=null,this.instancingAttributes=null,this.texture=null,this.effect=null,this.effectInstanced=null}return __extends(i,t),i.prototype.render=function(t,i){if(!this.effectsReady){if(this.effect&&(!this.effect.isReady()||this.effectInstanced&&!this.effectInstanced.isReady()))return!1;this.effectsReady=!0}var n=t.owner.owner.engine,o=i.useInstancing?this.effectInstanced:this.effect;n.enableEffect(o),o.setTexture("diffuseSampler",this.texture),n.bindBuffersDirectly(this.vb,this.ib,[1],4,o);var s=n.getAlphaMode();i.renderMode!==e.Render2DContext.RenderModeOpaque&&n.setAlphaMode(e.Engine.ALPHA_COMBINE);var a=i.groupInfoPartData[0];if(i.useInstancing)this.instancingAttributes||(this.instancingAttributes=this.loadInstancingAttributes(r.SPRITE2D_MAINPARTID,o)),n.updateAndBindInstancesBuffer(a._partBuffer,null,this.instancingAttributes),n.draw(!0,0,6,a._partData.usedElementCount),n.unbindInstanceAttributes();else for(var h=i.partDataStartIndex;h<i.partDataEndIndex;h++)this.setupUniforms(o,0,a._partData,h),n.draw(!0,0,6);return n.setAlphaMode(s),!0},i.prototype.dispose=function(){return t.prototype.dispose.call(this)?(this.vb&&(this._engine._releaseBuffer(this.vb),this.vb=null),this.ib&&(this._engine._releaseBuffer(this.ib),this.ib=null),this.texture&&(this.texture.dispose(),this.texture=null),this.effect&&(this._engine._releaseEffect(this.effect),this.effect=null),this.effectInstanced&&(this._engine._releaseEffect(this.effectInstanced),this.effectInstanced=null),!0):!1},i}(e.ModelRenderCache);e.Sprite2DRenderCache=t;var i=function(t){function i(e){t.call(this,e,1)}return __extends(i,t),Object.defineProperty(i.prototype,"topLeftUV",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"sizeUV",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"textureSize",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"properties",{get:function(){return null},enumerable:!0,configurable:!0}),__decorate([e.instanceData()],i.prototype,"topLeftUV",null),__decorate([e.instanceData()],i.prototype,"sizeUV",null),__decorate([e.instanceData()],i.prototype,"textureSize",null),__decorate([e.instanceData()],i.prototype,"properties",null),i}(e.InstanceDataBase);e.Sprite2DInstanceData=i;var r=function(r){function n(t,i){if(i||(i={}),r.call(this,i),this.texture=t,this.texture.wrapU=e.Texture.CLAMP_ADDRESSMODE,this.texture.wrapV=e.Texture.CLAMP_ADDRESSMODE,this.size=i.spriteSize||null,this.spriteLocation=i.spriteLocation||new e.Vector2(0,0),this.spriteFrame=0,this.invertY=null==i.invertY?!1:i.invertY,this.alignToPixel=null==i.alignToPixel?!0:i.alignToPixel,this._isTransparent=!0,!this.size){var n=t.getSize();this.size=new e.Size(n.width,n.height)}}return __extends(n,r),Object.defineProperty(n.prototype,"texture",{get:function(){return this._texture},set:function(e){this._texture=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"actualSize",{get:function(){return this._actualSize?this._actualSize:this.size},set:function(e){this._actualSize=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"spriteLocation",{get:function(){return this._location},set:function(e){this._location=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"spriteFrame",{get:function(){return this._spriteFrame},set:function(e){this._spriteFrame=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"invertY",{get:function(){return this._invertY},set:function(e){this._invertY=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"alignToPixel",{get:function(){return this._alignToPixel},set:function(e){this._alignToPixel=e},enumerable:!0,configurable:!0}),n.prototype.updateLevelBoundingInfo=function(){e.BoundingInfo2D.CreateFromSizeToRef(this.size,this._levelBoundingInfo)},n.prototype.getAnimatables=function(){var e=new Array;return this.texture&&this.texture.animations&&this.texture.animations.length>0&&e.push(this.texture),e},n.prototype.levelIntersect=function(e){return!0},n._createCachedCanvasSprite=function(t,i,r,o){var s=new n(i,{parent:t,id:"__cachedCanvasSprite__",position:e.Vector2.Zero(),origin:e.Vector2.Zero(),spriteSize:r,spriteLocation:o,alignToPixel:!0});return s},n.prototype.createModelRenderCache=function(e){var i=new t(this.owner.engine,e);return i},n.prototype.setupModelRenderCache=function(e){for(var t=e,i=this.owner.engine,r=new Float32Array(4),o=0;4>o;o++)r[o]=o;t.vb=i.createVertexBuffer(r);var s=new Float32Array(6);s[0]=0,s[1]=2,s[2]=1,s[3]=0,s[4]=3,s[5]=2,t.ib=i.createIndexBuffer(s),t.texture=this.texture;var a=this.getDataPartEffectInfo(n.SPRITE2D_MAINPARTID,["index"],!0);return a&&(t.effectInstanced=i.createEffect("sprite2d",a.attributes,a.uniforms,["diffuseSampler"],a.defines,null)),a=this.getDataPartEffectInfo(n.SPRITE2D_MAINPARTID,["index"],!1),t.effect=i.createEffect("sprite2d",a.attributes,a.uniforms,["diffuseSampler"],a.defines,null),t},n.prototype.createInstanceDataParts=function(){return[new i(n.SPRITE2D_MAINPARTID)]},n.prototype.refreshInstanceDataPart=function(t){if(!r.prototype.refreshInstanceDataPart.call(this,t))return!1;if(t.id===n.SPRITE2D_MAINPARTID){var i=this._instanceDataParts[0],o=this.texture.getBaseSize(),s=this.spriteLocation,a=this.actualSize;i.topLeftUV=new e.Vector2(s.x/o.width,s.y/o.height);var h=new e.Vector2(a.width/o.width,a.height/o.height);i.sizeUV=h,n._prop.x=this.spriteFrame,n._prop.y=this.invertY?1:0,n._prop.z=this.alignToPixel?1:0,i.properties=n._prop,i.textureSize=new e.Vector2(o.width,o.height)}return!0},n.SPRITE2D_MAINPARTID=1,n._prop=e.Vector3.Zero(),__decorate([e.modelLevelProperty(e.RenderablePrim2D.RENDERABLEPRIM2D_PROPCOUNT+1,function(e){return n.textureProperty=e})],n.prototype,"texture",null),__decorate([e.instanceLevelProperty(e.RenderablePrim2D.RENDERABLEPRIM2D_PROPCOUNT+2,function(e){return n.actualSizeProperty=e},!1,!0)],n.prototype,"actualSize",null),__decorate([e.instanceLevelProperty(e.RenderablePrim2D.RENDERABLEPRIM2D_PROPCOUNT+3,function(e){return n.spriteLocationProperty=e})],n.prototype,"spriteLocation",null),__decorate([e.instanceLevelProperty(e.RenderablePrim2D.RENDERABLEPRIM2D_PROPCOUNT+4,function(e){return n.spriteFrameProperty=e})],n.prototype,"spriteFrame",null),__decorate([e.instanceLevelProperty(e.RenderablePrim2D.RENDERABLEPRIM2D_PROPCOUNT+5,function(e){return n.invertYProperty=e})],n.prototype,"invertY",null),n=__decorate([e.className("Sprite2D")],n)}(e.RenderablePrim2D);e.Sprite2D=r}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(){t.apply(this,arguments),this.effectsReady=!1,this.vb=null,this.ib=null,this.instancingAttributes=null,this.fontTexture=null,this.effect=null,this.effectInstanced=null}return __extends(i,t),i.prototype.render=function(t,i){if(!this.effectsReady){if(this.effect&&(!this.effect.isReady()||this.effectInstanced&&!this.effectInstanced.isReady()))return!1;this.effectsReady=!0}var n=t.owner.owner.engine;this.fontTexture.update();var o=i.useInstancing?this.effectInstanced:this.effect;n.enableEffect(o),o.setTexture("diffuseSampler",this.fontTexture),n.bindBuffersDirectly(this.vb,this.ib,[1],4,o);var s=n.getAlphaMode();n.setAlphaMode(e.Engine.ALPHA_COMBINE,!0);var a=i.groupInfoPartData[0];if(i.useInstancing)this.instancingAttributes||(this.instancingAttributes=this.loadInstancingAttributes(r.TEXT2D_MAINPARTID,o)),n.updateAndBindInstancesBuffer(a._partBuffer,null,this.instancingAttributes),n.draw(!0,0,6,a._partData.usedElementCount),n.unbindInstanceAttributes();else for(var h=i.partDataStartIndex;h<i.partDataEndIndex;h++)this.setupUniforms(o,0,a._partData,h),n.draw(!0,0,6);return n.setAlphaMode(s),!0},i.prototype.dispose=function(){return t.prototype.dispose.call(this)?(this.vb&&(this._engine._releaseBuffer(this.vb),this.vb=null),this.ib&&(this._engine._releaseBuffer(this.ib),this.ib=null),this.fontTexture&&(this.fontTexture.dispose(),this.fontTexture=null),this.effect&&(this._engine._releaseEffect(this.effect),this.effect=null),this.effectInstanced&&(this._engine._releaseEffect(this.effectInstanced),this.effectInstanced=null),!0):!1},i}(e.ModelRenderCache);e.Text2DRenderCache=t;var i=function(t){function i(e,i){t.call(this,e,i)}return __extends(i,t),Object.defineProperty(i.prototype,"topLeftUV",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"sizeUV",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"textureSize",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"color",{get:function(){return null},enumerable:!0,configurable:!0}),__decorate([e.instanceData()],i.prototype,"topLeftUV",null),__decorate([e.instanceData()],i.prototype,"sizeUV",null),__decorate([e.instanceData()],i.prototype,"textureSize",null),__decorate([e.instanceData()],i.prototype,"color",null),i}(e.InstanceDataBase);e.Text2DInstanceData=i;var r=function(r){function n(t,i){i||(i={}),r.call(this,i),this.fontName=null==i.fontName?"12pt Arial":i.fontName,this.defaultFontColor=null==i.defaultFontColor?new e.Color4(1,1,1,1):i.defaultFontColor,this._tabulationSize=null==i.tabulationSize?4:i.tabulationSize,this._textSize=null,this.text=t,this.size=null==i.size?null:i.size,this.isAlphaTest=!0}return __extends(n,r),Object.defineProperty(n.prototype,"fontName",{get:function(){return this._fontName},set:function(e){if(this._fontName)throw new Error("Font Name change is not supported right now.");this._fontName=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"defaultFontColor",{get:function(){return this._defaultFontColor},set:function(e){this._defaultFontColor=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"text",{get:function(){return this._text},set:function(e){this._text=e,this._textSize=null,this._size=null,this._updateCharCount();this.textSize},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"size",{get:function(){return null!=this._size?this._size:this.textSize},set:function(e){this._size=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"actualSize",{get:function(){return this._actualSize?this._actualSize:this.size},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"textSize",{get:function(){if(!this._textSize){if(!this.owner)return n.nullSize;var t=this.fontTexture.measureText(this._text,this._tabulationSize);t.equals(this._textSize)||(this.onPrimitivePropertyDirty(e.Prim2DBase.sizeProperty.flagId),this._positioningDirty()),this._textSize=t}return this._textSize},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"fontTexture",{get:function(){return this._fontTexture?this._fontTexture:(this._fontTexture=e.FontTexture.GetCachedFontTexture(this.owner.scene,this.fontName),this._fontTexture)},enumerable:!0,configurable:!0}),n.prototype.dispose=function(){return r.prototype.dispose.call(this)?(this._fontTexture&&(e.FontTexture.ReleaseCachedFontTexture(this.owner.scene,this.fontName),this._fontTexture=null),!0):!1},n.prototype.updateLevelBoundingInfo=function(){e.BoundingInfo2D.CreateFromSizeToRef(this.actualSize,this._levelBoundingInfo)},n.prototype.levelIntersect=function(e){return!0},n.prototype.createModelRenderCache=function(e){var i=new t(this.owner.engine,e);return i},n.prototype.setupModelRenderCache=function(e){var t=e,i=this.owner.engine;t.fontTexture=this.fontTexture;for(var r=new Float32Array(4),o=0;4>o;o++)r[o]=o;t.vb=i.createVertexBuffer(r);var s=new Float32Array(6);s[0]=0,s[1]=2,s[2]=1,s[3]=0,s[4]=3,s[5]=2,t.ib=i.createIndexBuffer(s);var a=this.getDataPartEffectInfo(n.TEXT2D_MAINPARTID,["index"],!0);return a&&(t.effectInstanced=i.createEffect("text2d",a.attributes,a.uniforms,["diffuseSampler"],a.defines,null)),a=this.getDataPartEffectInfo(n.TEXT2D_MAINPARTID,["index"],!1),t.effect=i.createEffect("text2d",a.attributes,a.uniforms,["diffuseSampler"],a.defines,null),t},n.prototype.createInstanceDataParts=function(){return[new i(n.TEXT2D_MAINPARTID,this._charCount)]},n.prototype.beforeRefreshForLayoutConstruction=function(e){if(!this._charCount){var t=this._text;return this.text="A",t}},n.prototype.afterRefreshForLayoutConstruction=function(e,t){void 0!==t&&(this.text=t)},n.prototype.refreshInstanceDataPart=function(t){if(!r.prototype.refreshInstanceDataPart.call(this,t))return!1;if(t.id===n.TEXT2D_MAINPARTID){var i=t,o=this.fontTexture,s=o.getSize(),a=e.Vector2.Zero(),h=this.fontTexture.lineHeight;a.y=(this.textSize.height/h-1)*h;var c=0;i.dataElementCount=this._charCount,i.curElement=0;for(var l=0,u=this.text;l<u.length;l++){var f=u[l];if("\n"===f&&(a.x=0,a.y-=o.lineHeight),"	"!==f){if(!(" ">f)){this.updateInstanceDataPart(i,a);var d=o.getChar(f);a.x+=d.charWidth,i.topLeftUV=d.topLeftUV;var p=d.bottomRightUV.subtract(d.topLeftUV);i.sizeUV=p,i.textureSize=new e.Vector2(s.width,s.height),i.color=this.defaultFontColor,++i.curElement}}else{var _=c+this._tabulationSize;_-=_%this._tabulationSize,a.x+=(_-c)*o.spaceWidth,c=_}}}return!0},n.prototype._updateCharCount=function(){for(var e=0,t=0,i=this._text;t<i.length;t++){var r=i[t];"\r"===r||"\n"===r||"	"===r||" ">r||++e}this._charCount=e},n.TEXT2D_MAINPARTID=1,__decorate([e.modelLevelProperty(e.RenderablePrim2D.RENDERABLEPRIM2D_PROPCOUNT+1,function(e){return n.fontProperty=e},!1,!0)],n.prototype,"fontName",null),__decorate([e.dynamicLevelProperty(e.RenderablePrim2D.RENDERABLEPRIM2D_PROPCOUNT+2,function(e){return n.defaultFontColorProperty=e})],n.prototype,"defaultFontColor",null),__decorate([e.instanceLevelProperty(e.RenderablePrim2D.RENDERABLEPRIM2D_PROPCOUNT+3,function(e){return n.textProperty=e},!1,!0)],n.prototype,"text",null),__decorate([e.instanceLevelProperty(e.RenderablePrim2D.RENDERABLEPRIM2D_PROPCOUNT+4,function(e){return n.sizeProperty=e})],n.prototype,"size",null),n=__decorate([e.className("Text2D")],n)}(e.RenderablePrim2D);e.Text2D=r}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(e,i){t.call(this,e,i),this.effectsReady=!1,this.fillVB=null,this.fillIB=null,this.fillIndicesCount=0,this.instancingFillAttributes=null,this.effectFill=null,this.effectFillInstanced=null,this.borderVB=null,this.borderIB=null,this.borderIndicesCount=0,this.instancingBorderAttributes=null,this.effectBorder=null,this.effectBorderInstanced=null}return __extends(i,t),i.prototype.render=function(t,i){if(!this.effectsReady){if(this.effectFill&&(!this.effectFill.isReady()||this.effectFillInstanced&&!this.effectFillInstanced.isReady())||this.effectBorder&&(!this.effectBorder.isReady()||this.effectBorderInstanced&&!this.effectBorderInstanced.isReady()))return!1;this.effectsReady=!0}var r=t.owner.owner.engine,n=0;this.effectFill&&this.effectBorder&&(n=r.getDepthFunction(),r.setDepthFunctionToLessOrEqual());var o=r.getAlphaMode();if(this.effectFill){var s=t.partIndexFromId.get(e.Shape2D.SHAPE2D_FILLPARTID.toString()),a=i.groupInfoPartData[s];i.renderMode!==e.Render2DContext.RenderModeOpaque&&r.setAlphaMode(e.Engine.ALPHA_COMBINE);var h=i.useInstancing?this.effectFillInstanced:this.effectFill;if(r.enableEffect(h),r.bindBuffersDirectly(this.fillVB,this.fillIB,[2],8,h),i.useInstancing)this.instancingFillAttributes||(this.instancingFillAttributes=this.loadInstancingAttributes(e.Shape2D.SHAPE2D_FILLPARTID,h)),r.updateAndBindInstancesBuffer(a._partBuffer,null,this.instancingFillAttributes),r.draw(!0,0,this.fillIndicesCount,a._partData.usedElementCount),r.unbindInstanceAttributes();else for(var c=i.partDataStartIndex;c<i.partDataEndIndex;c++)this.setupUniforms(h,s,a._partData,c),r.draw(!0,0,this.fillIndicesCount)}if(this.effectBorder){var s=t.partIndexFromId.get(e.Shape2D.SHAPE2D_BORDERPARTID.toString()),a=i.groupInfoPartData[s];i.renderMode!==e.Render2DContext.RenderModeOpaque&&r.setAlphaMode(e.Engine.ALPHA_COMBINE);var h=i.useInstancing?this.effectBorderInstanced:this.effectBorder;if(r.enableEffect(h),r.bindBuffersDirectly(this.borderVB,this.borderIB,[2],8,h),i.useInstancing)this.instancingBorderAttributes||(this.instancingBorderAttributes=this.loadInstancingAttributes(e.Shape2D.SHAPE2D_BORDERPARTID,h)),r.updateAndBindInstancesBuffer(a._partBuffer,null,this.instancingBorderAttributes),r.draw(!0,0,this.borderIndicesCount,a._partData.usedElementCount),r.unbindInstanceAttributes();else for(var c=i.partDataStartIndex;c<i.partDataEndIndex;c++)this.setupUniforms(h,s,a._partData,c),r.draw(!0,0,this.borderIndicesCount)}return r.setAlphaMode(o),this.effectFill&&this.effectBorder&&r.setDepthFunction(n),!0},i.prototype.dispose=function(){return t.prototype.dispose.call(this)?(this.fillVB&&(this._engine._releaseBuffer(this.fillVB),this.fillVB=null),this.fillIB&&(this._engine._releaseBuffer(this.fillIB),this.fillIB=null),this.effectFill&&(this._engine._releaseEffect(this.effectFill),this.effectFill=null),this.effectFillInstanced&&(this._engine._releaseEffect(this.effectFillInstanced),this.effectFillInstanced=null),this.borderVB&&(this._engine._releaseBuffer(this.borderVB),this.borderVB=null),this.borderIB&&(this._engine._releaseBuffer(this.borderIB),this.borderIB=null),this.effectBorder&&(this._engine._releaseEffect(this.effectBorder),this.effectBorder=null),this.effectBorderInstanced&&(this._engine._releaseEffect(this.effectBorderInstanced),this.effectBorderInstanced=null),!0):!1},i}(e.ModelRenderCache);e.Lines2DRenderCache=t;var i=function(t){function i(e){t.call(this,e,1)}return __extends(i,t),Object.defineProperty(i.prototype,"boundingMin",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"boundingMax",{get:function(){return null},enumerable:!0,configurable:!0}),__decorate([e.instanceData(e.Shape2D.SHAPE2D_CATEGORY_FILLGRADIENT)],i.prototype,"boundingMin",null),__decorate([e.instanceData(e.Shape2D.SHAPE2D_CATEGORY_FILLGRADIENT)],i.prototype,"boundingMax",null),i}(e.Shape2DInstanceData);e.Lines2DInstanceData=i;var r=function(r){function n(t,i){i||(i={}),r.call(this,i),this._fillVB=null,this._fillIB=null,this._borderVB=null,this._borderIB=null,this._size=e.Size.Zero(),this._boundingMin=null,this._boundingMax=null;var n=null==i.fillThickness?1:i.fillThickness,o=null==i.startCap?0:i.startCap,s=null==i.endCap?0:i.endCap,a=null==i.closed?!1:i.closed;this.points=t,this.fillThickness=n,this.startCap=o,this.endCap=s,this.closed=a}return __extends(n,r),Object.defineProperty(n,"NoCap",{get:function(){return n._noCap},enumerable:!0,configurable:!0}),Object.defineProperty(n,"RoundCap",{get:function(){return n._roundCap},enumerable:!0,configurable:!0}),Object.defineProperty(n,"TriangleCap",{get:function(){return n._triangleCap},enumerable:!0,configurable:!0}),Object.defineProperty(n,"SquareAnchorCap",{get:function(){return n._squareAnchorCap},enumerable:!0,configurable:!0}),Object.defineProperty(n,"RoundAnchorCap",{get:function(){return n._roundAnchorCap},enumerable:!0,configurable:!0}),Object.defineProperty(n,"DiamondAnchorCap",{get:function(){return n._diamondAnchorCap},enumerable:!0,configurable:!0}),Object.defineProperty(n,"ArrowCap",{get:function(){return n._arrowCap},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"points",{get:function(){return this._points},set:function(e){this._points=e,this._boundingBoxDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"fillThickness",{get:function(){return this._fillThickness},set:function(e){this._fillThickness=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"closed",{get:function(){return this._closed},set:function(e){this._closed=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"startCap",{get:function(){return this._startCap},set:function(e){this._startCap=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"endCap",{get:function(){return this._endCap},set:function(e){this._endCap=e},enumerable:!0,configurable:!0}),n.prototype.levelIntersect=function(t){var i=this;null==this._contour&&this._computeLines2D();var r=this.points.length,o=this.closed?r+1:r,s=t._localPickPosition;this.transformPointWithOriginToRef(this._contour[0],null,n._prevA),this.transformPointWithOriginToRef(this._contour[1],null,n._prevB);for(var a=1;o>a;a++){if(this.transformPointWithOriginToRef(this._contour[a%r*2+0],null,n._curA),this.transformPointWithOriginToRef(this._contour[a%r*2+1],null,n._curB),e.Vector2.PointInTriangle(s,n._prevA,n._prevB,n._curA))return!0;if(e.Vector2.PointInTriangle(s,n._curA,n._prevB,n._curB))return!0;n._prevA.x=n._curA.x,n._prevA.y=n._curA.y,n._prevB.x=n._curB.x,n._prevB.y=n._curB.y}var h=function(t,r){for(var o=t.length,a=0;o>a;a+=3)if(n._curA.x=r[2*t[a+0]+0],n._curA.y=r[2*t[a+0]+1],i.transformPointWithOriginToRef(n._curA,null,n._curB),n._curA.x=r[2*t[a+1]+0],n._curA.y=r[2*t[a+1]+1],i.transformPointWithOriginToRef(n._curA,null,n._prevA),n._curA.x=r[2*t[a+2]+0],n._curA.y=r[2*t[a+2]+1],i.transformPointWithOriginToRef(n._curA,null,n._prevB),e.Vector2.PointInTriangle(s,n._prevA,n._prevB,n._curB))return!0;return!1};if(this._startCapTriIndices){if(h(this._startCapTriIndices,this._startCapContour))return!0;if(h(this._endCapTriIndices,this._endCapContour))return!0}return!1},Object.defineProperty(n.prototype,"boundingMin",{get:function(){return this._boundingMin||this._computeLines2D(),this._boundingMin},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"boundingMax",{get:function(){return this._boundingMax||this._computeLines2D(),this._boundingMax},enumerable:!0,configurable:!0}),n.prototype.getUsedShaderCategories=function(t){var i=r.prototype.getUsedShaderCategories.call(this,t),n=i.indexOf(e.Shape2D.SHAPE2D_CATEGORY_BORDER);return-1!==n&&i.splice(n,1),i},n.prototype.updateLevelBoundingInfo=function(){this._boundingMin||this._computeLines2D(),e.BoundingInfo2D.CreateFromMinMaxToRef(this._boundingMin.x,this._boundingMax.x,this._boundingMin.y,this._boundingMax.y,this._levelBoundingInfo)},n.prototype.createModelRenderCache=function(e){var i=new t(this.owner.engine,e);return i},n.prototype._perp=function(e,t){t.x=e.y,t.y=-e.x},n.prototype._direction=function(e,t,i){e.subtractToRef(t,i),i.normalize()},n.prototype._computeMiter=function(t,i,r,o){return r.addToRef(o,t),t.normalize(),i.x=-t.y,i.y=t.x,n._miterTps.x=-r.y,n._miterTps.y=r.x,1/e.Vector2.Dot(i,n._miterTps)},n.prototype._intersect=function(e,t,i,r,n,o,s,a){var h=(e-i)*(o-a)-(t-r)*(n-s);if(0===h)return!1;var c=((n-s)*(e*r-t*i)-(e-i)*(n*a-o*s))/h;return c<Math.min(e,i)||c>Math.max(e,i)?!1:!(c<Math.min(n,s)||c>Math.max(n,s))},n.prototype._updateMinMax=function(e,t){t>=e.length||(this._boundingMin.x=Math.min(this._boundingMin.x,e[t]),this._boundingMax.x=Math.max(this._boundingMax.x,e[t]),this._boundingMin.y=Math.min(this._boundingMin.y,e[t+1]),this._boundingMax.y=Math.max(this._boundingMax.y,e[t+1]))},n.prototype._store=function(t,i,r,o,s,a,h,c,l){var u=null!=c&&!isNaN(c),f=r*(u?8:4);if(!(f>=t.length)){0===r?this._perp(a,n._startDir):r===o-1&&(this._perp(a,n._endDir),n._endDir.x*=-1,n._endDir.y*=-1);var d=!1;if(t[f+0]=s.x+a.x*h,t[f+1]=s.y+a.y*h,t[f+2]=s.x+a.x*-h,t[f+3]=s.y+a.y*-h,this._updateMinMax(t,f),this._updateMinMax(t,f+2),void 0!==l){var p=l*(u?8:4);if(this._intersect(t[f+0],t[f+1],t[p+0],t[p+1],t[f+2],t[f+3],t[p+2],t[p+3])){d=!0;var _=t[f+0];t[f+0]=t[f+2],t[f+2]=_,_=t[f+1],t[f+1]=t[f+3],t[f+3]=_}}if(u){var m=h+c;t[f+4]=s.x+a.x*(d?-m:m),t[f+5]=s.y+a.y*(d?-m:m),t[f+6]=s.x+a.x*(d?m:-m),t[f+7]=s.y+a.y*(d?m:-m),this._updateMinMax(t,f+4),this._updateMinMax(t,f+6)}i&&(f+=u?4:0,i.push(new e.Vector2(t[f+0],t[f+1])),i.push(new e.Vector2(t[f+2],t[f+3])))}},n.prototype._getCapSize=function(e,t){void 0===t&&(t=!1);var i=n._roundCapSubDiv,r=0,o=0;switch(e){case n.NoCap:!this.closed&&t?(r=4,o=6):r=o=0;break;case n.RoundCap:t?(r=i,o=3*(i-2)):(r=i/2+1,o=i/2*3);break;case n.ArrowCap:t?(r=12,o=24):(r=3,o=3);break;case n.TriangleCap:t?(r=6,o=12):(r=3,o=3);break;case n.DiamondAnchorCap:t?(r=10,o=24):(r=5,o=9);break;case n.SquareAnchorCap:t?(r=12,o=30):(r=4,o=6);break;case n.RoundAnchorCap:t?(r=2*i,o=6*(i-1)):(r=i+1,o=3*(i+1))}return{vbsize:2*r,ibsize:o}},n.prototype._storeVertex=function(e,t,i,r,o,s,a){var h=Math.cos(o),c=Math.sin(o);n._tpsV.x=h*s.x+-c*s.y+r.x,n._tpsV.y=c*s.x+h*s.y+r.y;var l=t+2*i;return e[l+0]=n._tpsV.x,e[l+1]=n._tpsV.y,a&&(a.push(n._tpsV.x),a.push(n._tpsV.y)),this._updateMinMax(e,l),(t+2*i)/2},n.prototype._storeIndex=function(e,t,i,r){e[t+i]=r},n.prototype._buildCap=function(t,i,r,o,s,a,h,c,l,u){var f=n._roundCapSubDiv,d=new e.Vector2(1,0),p=Math.atan2(l.y,l.x)-Math.atan2(d.y,d.x),_=a/2,m=a,g=null!=h,v=h;switch(c){case n.NoCap:if(g&&!this.closed){var y=0,x=0,b=this._storeVertex(t,i,y++,s,p,new e.Vector2(0,_+v),u),P=this._storeVertex(t,i,y++,s,p,new e.Vector2(v,_+v),u),A=this._storeVertex(t,i,y++,s,p,new e.Vector2(v,-(_+v)),u),T=this._storeVertex(t,i,y++,s,p,new e.Vector2(0,-(_+v)),u);this._storeIndex(r,o,x++,b),this._storeIndex(r,o,x++,P),this._storeIndex(r,o,x++,A),this._storeIndex(r,o,x++,b),this._storeIndex(r,o,x++,A),this._storeIndex(r,o,x++,T)}break;case n.ArrowCap:_*=2;case n.TriangleCap:if(g){var E=c===n.TriangleCap?v:Math.sqrt(v*v*2),b=this._storeVertex(t,i,0,s,p,new e.Vector2(0,_),null),P=this._storeVertex(t,i,1,s,p,new e.Vector2(_,0),null),A=this._storeVertex(t,i,2,s,p,new e.Vector2(0,-_),null),T=this._storeVertex(t,i,3,s,p,new e.Vector2(0,_+E),u),C=this._storeVertex(t,i,4,s,p,new e.Vector2(_+E,0),u),S=this._storeVertex(t,i,5,s,p,new e.Vector2(0,-(_+E)),u),x=0;if(this._storeIndex(r,o,x++,b),this._storeIndex(r,o,x++,T),this._storeIndex(r,o,x++,C),this._storeIndex(r,o,x++,b),this._storeIndex(r,o,x++,C),this._storeIndex(r,o,x++,P),this._storeIndex(r,o,x++,S),this._storeIndex(r,o,x++,A),this._storeIndex(r,o,x++,P),this._storeIndex(r,o,x++,S),this._storeIndex(r,o,x++,P),this._storeIndex(r,o,x++,C),c===n.ArrowCap){var M=a/2,I=this._storeVertex(t,i,9,s,p,new e.Vector2(0,-(M+v)),null),D=this._storeVertex(t,i,11,s,p,new e.Vector2(-v,-(_+E)),u),R=this._storeVertex(t,i,10,s,p,new e.Vector2(-v,-(M+v)),u),O=this._storeVertex(t,i,6,s,p,new e.Vector2(0,M+v),null),w=this._storeVertex(t,i,7,s,p,new e.Vector2(-v,M+v),u),L=this._storeVertex(t,i,8,s,p,new e.Vector2(-v,_+E),u);this._storeIndex(r,o,x++,O),this._storeIndex(r,o,x++,w),this._storeIndex(r,o,x++,L),this._storeIndex(r,o,x++,O),this._storeIndex(r,o,x++,L),this._storeIndex(r,o,x++,T),this._storeIndex(r,o,x++,I),this._storeIndex(r,o,x++,D),this._storeIndex(r,o,x++,R),this._storeIndex(r,o,x++,I),this._storeIndex(r,o,x++,S),this._storeIndex(r,o,x++,D)}}else{var b=this._storeVertex(t,i,0,s,p,new e.Vector2(0,_),u),P=this._storeVertex(t,i,1,s,p,new e.Vector2(_,0),u),A=this._storeVertex(t,i,2,s,p,new e.Vector2(0,-_),u);this._storeIndex(r,o,0,b),this._storeIndex(r,o,1,P),this._storeIndex(r,o,2,A)}break;case n.RoundCap:if(g)for(var B=-Math.PI/2,V=Math.PI/(f/2-1),x=0,F=0;f/2>F;F++){var b=this._storeVertex(t,i,2*F+0,s,p,new e.Vector2(Math.cos(B)*_,Math.sin(B)*_),null),P=this._storeVertex(t,i,2*F+1,s,p,new e.Vector2(Math.cos(B)*(_+v),Math.sin(B)*(_+v)),u);F>0&&(this._storeIndex(r,o,x++,b-2),this._storeIndex(r,o,x++,P-2),this._storeIndex(r,o,x++,P),this._storeIndex(r,o,x++,b-2),this._storeIndex(r,o,x++,P),this._storeIndex(r,o,x++,b)),B+=V}else{var N=this._storeVertex(t,i,0,s,p,new e.Vector2(0,0),null),B=-Math.PI/2,V=Math.PI/(f/2-1);this._storeVertex(t,i,1,s,p,new e.Vector2(Math.cos(B)*_,Math.sin(B)*_),null),B+=V;for(var F=1;f/2>F;F++){var P=this._storeVertex(t,i,F+1,s,p,new e.Vector2(Math.cos(B)*_,Math.sin(B)*_),u);this._storeIndex(r,o,3*F+0,N),this._storeIndex(r,o,3*F+1,P-1),this._storeIndex(r,o,3*F+2,P),B+=V}}break;case n.SquareAnchorCap:var y=0,N=g?null:u,b=this._storeVertex(t,i,y++,s,p,new e.Vector2(0,m),N),P=this._storeVertex(t,i,y++,s,p,new e.Vector2(2*m,m),N),A=this._storeVertex(t,i,y++,s,p,new e.Vector2(2*m,-m),N),T=this._storeVertex(t,i,y++,s,p,new e.Vector2(0,-m),N);if(g){var C=this._storeVertex(t,i,y++,s,p,new e.Vector2(0,_+v),null),S=this._storeVertex(t,i,y++,s,p,new e.Vector2(-v,_+v),u),O=this._storeVertex(t,i,y++,s,p,new e.Vector2(-v,m+v),u),w=this._storeVertex(t,i,y++,s,p,new e.Vector2(2*m+v,m+v),u),L=this._storeVertex(t,i,y++,s,p,new e.Vector2(2*m+v,-(m+v)),u),I=this._storeVertex(t,i,y++,s,p,new e.Vector2(-v,-(m+v)),u),R=this._storeVertex(t,i,y++,s,p,new e.Vector2(-v,-(_+v)),u),D=this._storeVertex(t,i,y++,s,p,new e.Vector2(0,-(_+v)),null),x=0;this._storeIndex(r,o,x++,S),this._storeIndex(r,o,x++,b),this._storeIndex(r,o,x++,C),this._storeIndex(r,o,x++,S),this._storeIndex(r,o,x++,O),this._storeIndex(r,o,x++,b),this._storeIndex(r,o,x++,b),this._storeIndex(r,o,x++,O),this._storeIndex(r,o,x++,w),this._storeIndex(r,o,x++,b),this._storeIndex(r,o,x++,w),this._storeIndex(r,o,x++,P),this._storeIndex(r,o,x++,P),this._storeIndex(r,o,x++,w),this._storeIndex(r,o,x++,L),this._storeIndex(r,o,x++,P),this._storeIndex(r,o,x++,L),this._storeIndex(r,o,x++,A),this._storeIndex(r,o,x++,A),this._storeIndex(r,o,x++,L),this._storeIndex(r,o,x++,I),this._storeIndex(r,o,x++,A),this._storeIndex(r,o,x++,I),this._storeIndex(r,o,x++,T),this._storeIndex(r,o,x++,I),this._storeIndex(r,o,x++,R),this._storeIndex(r,o,x++,T),this._storeIndex(r,o,x++,R),this._storeIndex(r,o,x++,D),this._storeIndex(r,o,x++,T)}else this._storeIndex(r,o,0,b),this._storeIndex(r,o,1,P),this._storeIndex(r,o,2,A),this._storeIndex(r,o,3,b),this._storeIndex(r,o,4,A),this._storeIndex(r,o,5,T);break;case n.RoundAnchorCap:var z=Math.sqrt(m*m-_*_),k=new e.Vector2(z,0),B=e.Tools.ToRadians(-150),V=e.Tools.ToRadians(300)/(f-1);if(g)for(var x=0,F=0;f>F;F++){var b=this._storeVertex(t,i,2*F+0,s,p,new e.Vector2(z+Math.cos(B)*m,Math.sin(B)*m),null),P=this._storeVertex(t,i,2*F+1,s,p,new e.Vector2(z+Math.cos(B)*(m+v),Math.sin(B)*(m+v)),u);F>0&&(this._storeIndex(r,o,x++,b-2),this._storeIndex(r,o,x++,P-2),this._storeIndex(r,o,x++,P),this._storeIndex(r,o,x++,b-2),this._storeIndex(r,o,x++,P),this._storeIndex(r,o,x++,b)),B+=V}else{var N=this._storeVertex(t,i,0,s,p,k,null);this._storeVertex(t,i,1,s,p,new e.Vector2(z+Math.cos(B)*m,Math.sin(B)*m),null),B+=V;for(var F=1;f>F;F++){var P=this._storeVertex(t,i,F+1,s,p,new e.Vector2(z+Math.cos(B)*m,Math.sin(B)*m),u);this._storeIndex(r,o,3*F+0,N),this._storeIndex(r,o,3*F+1,P-1),this._storeIndex(r,o,3*F+2,P),B+=V}this._storeIndex(r,o,3*f+0,N),this._storeIndex(r,o,3*f+1,N+1),this._storeIndex(r,o,3*f+2,N+f)}break;case n.DiamondAnchorCap:var y=0,N=g?null:u,b=this._storeVertex(t,i,y++,s,p,new e.Vector2(0,_),N),P=this._storeVertex(t,i,y++,s,p,new e.Vector2(_,m),N),A=this._storeVertex(t,i,y++,s,p,new e.Vector2(3*_,0),N),T=this._storeVertex(t,i,y++,s,p,new e.Vector2(_,-m),N),C=this._storeVertex(t,i,y++,s,p,new e.Vector2(0,-_),N);if(g){var E=Math.sqrt(v*v*2),S=this._storeVertex(t,i,y++,s,p,new e.Vector2(-E,_),u),O=this._storeVertex(t,i,y++,s,p,new e.Vector2(_,m+E),u),w=this._storeVertex(t,i,y++,s,p,new e.Vector2(3*_+E,0),u),L=this._storeVertex(t,i,y++,s,p,new e.Vector2(_,-(m+E)),u),I=this._storeVertex(t,i,y++,s,p,new e.Vector2(-E,-_),u),x=0;this._storeIndex(r,o,x++,S),this._storeIndex(r,o,x++,O),this._storeIndex(r,o,x++,b),this._storeIndex(r,o,x++,b),this._storeIndex(r,o,x++,O),this._storeIndex(r,o,x++,P),this._storeIndex(r,o,x++,P),this._storeIndex(r,o,x++,O),this._storeIndex(r,o,x++,w),this._storeIndex(r,o,x++,P),this._storeIndex(r,o,x++,w),this._storeIndex(r,o,x++,A),this._storeIndex(r,o,x++,A),this._storeIndex(r,o,x++,w),this._storeIndex(r,o,x++,L),this._storeIndex(r,o,x++,A),this._storeIndex(r,o,x++,L),this._storeIndex(r,o,x++,T),this._storeIndex(r,o,x++,T),this._storeIndex(r,o,x++,L),this._storeIndex(r,o,x++,I),this._storeIndex(r,o,x++,T),this._storeIndex(r,o,x++,I),this._storeIndex(r,o,x++,C)}else this._storeIndex(r,o,0,b),this._storeIndex(r,o,1,P),this._storeIndex(r,o,2,A),this._storeIndex(r,o,3,b),this._storeIndex(r,o,4,A),this._storeIndex(r,o,5,C),this._storeIndex(r,o,6,C),
this._storeIndex(r,o,7,A),this._storeIndex(r,o,8,T)}return null},n.prototype._buildLine=function(t,i,r,n){var o=e.Vector2.Zero(),s=e.Vector2.Zero(),a=e.Vector2.Zero(),h=e.Vector2.Zero(),c=null;this.closed&&this.points.push(this.points[0]);for(var l=this.points.length,u=1;l>u;u++){var f=this.points[u-1],d=this.points[u],p=u<this.points.length-1?this.points[u+1]:null;if(this._direction(d,f,o),c||(c=e.Vector2.Zero(),this._perp(o,c)),1===u&&this._store(t,i,0,l,this.points[0],c,r,n),p){this._direction(p,d,s);var _=this._computeMiter(a,h,o,s);this._store(t,i,u,l,this.points[u],h,_*r,_*n,u-1)}else this._perp(o,c),this._store(t,i,u,l,this.points[u],c,r,n,u-1)}if(this.points.length>2&&this.closed){var m=this.points[l-2],g=this.points[0],v=this.points[1];this._direction(g,m,o),this._direction(v,g,s),this._perp(o,c);var y=this._computeMiter(a,h,o,s);if(this._store(t,null,0,l,this.points[0],h,y*r,y*n,1),i){var x=null==n?0:4;i[0].x=t[x+0],i[0].y=t[x+1],i[1].x=t[x+2],i[1].y=t[x+3]}}this.closed&&this.points.splice(l-1)},n.prototype.setupModelRenderCache=function(t){var i=t,r=this.owner.engine;if(null===this._fillVB&&this._computeLines2D(),this.fill){i.fillVB=r.createVertexBuffer(this._fillVB),i.fillIB=r.createIndexBuffer(this._fillIB),i.fillIndicesCount=this._fillIB.length;var n=this.getDataPartEffectInfo(e.Shape2D.SHAPE2D_FILLPARTID,["position"],!0);n&&(i.effectFillInstanced=r.createEffect("lines2d",n.attributes,n.uniforms,[],n.defines,null)),n=this.getDataPartEffectInfo(e.Shape2D.SHAPE2D_FILLPARTID,["position"],!1),i.effectFill=r.createEffect("lines2d",n.attributes,n.uniforms,[],n.defines,null)}if(this.border){i.borderVB=r.createVertexBuffer(this._borderVB),i.borderIB=r.createIndexBuffer(this._borderIB),i.borderIndicesCount=this._borderIB.length;var n=this.getDataPartEffectInfo(e.Shape2D.SHAPE2D_BORDERPARTID,["position"],!0);n&&(i.effectBorderInstanced=r.createEffect({vertex:"lines2d",fragment:"lines2d"},n.attributes,n.uniforms,[],n.defines,null)),n=this.getDataPartEffectInfo(e.Shape2D.SHAPE2D_BORDERPARTID,["position"],!1),i.effectBorder=r.createEffect({vertex:"lines2d",fragment:"lines2d"},n.attributes,n.uniforms,[],n.defines,null)}return this._fillVB=null,this._fillIB=null,this._borderVB=null,this._borderIB=null,i},n.prototype._computeLines2D=function(){this._boundingMin=new e.Vector2(Number.MAX_VALUE,Number.MAX_VALUE),this._boundingMax=new e.Vector2(Number.MIN_VALUE,Number.MIN_VALUE);var t=new Array,i=new Array,r=new Array;if(this.fill){var o=this._getCapSize(this.startCap),s=this._getCapSize(this.endCap),a=this.points.length,h=2*a*2+o.vbsize+s.vbsize;this._fillVB=new Float32Array(h);var c=this._fillVB,l=this.fillThickness/2,u=this.points.length;this._buildLine(c,this.border?null:t,l);var f=2*u,d=2*(a-(this.closed?0:1));this._fillIB=new Float32Array(3*d+o.ibsize+s.ibsize);for(var p=this._fillIB,_=0;d>_;_+=2)p[3*_+0]=_+0,p[3*_+1]=_+1,p[3*_+2]=(_+2)%f,p[3*_+3]=_+1,p[3*_+4]=(_+3)%f,p[3*_+5]=(_+2)%f;this._buildCap(c,2*a*2,p,3*d,this.points[0],this.fillThickness,null,this.startCap,n._startDir,this.border?null:i),this._buildCap(c,2*a*2+o.vbsize,p,3*d+o.ibsize,this.points[u-1],this.fillThickness,null,this.endCap,n._endDir,this.border?null:i)}if(this.border){var o=this._getCapSize(this.startCap,!0),s=this._getCapSize(this.endCap,!0),a=this.points.length,h=2*a*2*2+o.vbsize+s.vbsize;this._borderVB=new Float32Array(h);var c=this._borderVB,l=this.fillThickness/2,m=this.borderThickness,u=this.points.length;this._buildLine(c,t,l,m);var f=2*u*2,d=2*(a-(this.closed?0:1))*2;this._borderIB=new Float32Array(3*d+o.ibsize+s.ibsize);for(var p=this._borderIB,_=0;d>_;_+=4)p[3*_+0]=_+0,p[3*_+1]=_+2,p[3*_+2]=(_+6)%f,p[3*_+3]=_+0,p[3*_+4]=(_+6)%f,p[3*_+5]=(_+4)%f,p[3*_+6]=_+3,p[3*_+7]=_+1,p[3*_+8]=(_+5)%f,p[3*_+9]=_+3,p[3*_+10]=(_+5)%f,p[3*_+11]=(_+7)%f;this._buildCap(c,2*a*2*2,p,3*d,this.points[0],this.fillThickness,this.borderThickness,this.startCap,n._startDir,i),this._buildCap(c,2*a*2*2+o.vbsize,p,3*d+o.ibsize,this.points[u-1],this.fillThickness,this.borderThickness,this.endCap,n._endDir,r)}if(this._contour=t,i.length>0){var g=Earcut.earcut(i,null,2);this._startCapTriIndices=g,this._startCapContour=i}if(r.length>0){var v=Earcut.earcut(r,null,2);this._endCapContour=r,this._endCapTriIndices=v}var y=this._boundingMax.subtract(this._boundingMin);this._size.width=y.x,this._size.height=y.y},Object.defineProperty(n.prototype,"size",{get:function(){return null==this._size&&this._computeLines2D(),this._size},enumerable:!0,configurable:!0}),n.prototype.createInstanceDataParts=function(){var t=new Array;return this.border&&t.push(new i(e.Shape2D.SHAPE2D_BORDERPARTID)),this.fill&&t.push(new i(e.Shape2D.SHAPE2D_FILLPARTID)),t},n.prototype.refreshInstanceDataPart=function(t){if(!r.prototype.refreshInstanceDataPart.call(this,t))return!1;if(t.id===e.Shape2D.SHAPE2D_BORDERPARTID){var i=t;this.border instanceof e.GradientColorBrush2D&&(i.boundingMin=this.boundingMin,i.boundingMax=this.boundingMax)}else if(t.id===e.Shape2D.SHAPE2D_FILLPARTID){var i=t;this.fill instanceof e.GradientColorBrush2D&&(i.boundingMin=this.boundingMin,i.boundingMax=this.boundingMax)}return!0},n._prevA=e.Vector2.Zero(),n._prevB=e.Vector2.Zero(),n._curA=e.Vector2.Zero(),n._curB=e.Vector2.Zero(),n._miterTps=e.Vector2.Zero(),n._startDir=e.Vector2.Zero(),n._endDir=e.Vector2.Zero(),n._tpsV=e.Vector2.Zero(),n._noCap=0,n._roundCap=1,n._triangleCap=2,n._squareAnchorCap=3,n._roundAnchorCap=4,n._diamondAnchorCap=5,n._arrowCap=6,n._roundCapSubDiv=36,__decorate([e.modelLevelProperty(e.Shape2D.SHAPE2D_PROPCOUNT+1,function(e){return n.pointsProperty=e})],n.prototype,"points",null),__decorate([e.modelLevelProperty(e.Shape2D.SHAPE2D_PROPCOUNT+2,function(e){return n.fillThicknessProperty=e})],n.prototype,"fillThickness",null),__decorate([e.modelLevelProperty(e.Shape2D.SHAPE2D_PROPCOUNT+3,function(e){return n.closedProperty=e})],n.prototype,"closed",null),__decorate([e.modelLevelProperty(e.Shape2D.SHAPE2D_PROPCOUNT+4,function(e){return n.startCapProperty=e})],n.prototype,"startCap",null),__decorate([e.modelLevelProperty(e.Shape2D.SHAPE2D_PROPCOUNT+5,function(e){return n.endCapProperty=e})],n.prototype,"endCap",null),n=__decorate([e.className("Lines2D")],n)}(e.Shape2D);e.Lines2D=r}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(){this._modelCache=new e.StringDictionary}return t.prototype.GetOrAddModelCache=function(e,t){return this._modelCache.getOrAddWithFactory(e,t)},t.prototype.DisposeModelRenderCache=function(e){return e.isDisposed?(this._modelCache.remove(e.modelKey),!0):!1},t}();e.Canvas2DEngineBoundData=t;var i=function(i){function r(n,o){var s=this;i.call(this,o),this.worldSpaceToNodeLocal=function(t){var i=s._worldSpaceNode;if(i){var r=i.getWorldMatrix().clone();r.invert();var n=e.Vector3.TransformCoordinates(t,r),o=s._renderScaleFactor,a=new e.Vector2(n.x*o,n.y*o),h=s.actualSize;s.origin;return a.x+=.5*h.width,a.y+=.5*h.width,a}},this._notifDebugMode=!1,this._mapCounter=0,e.Prim2DBase._isCanvasInit=!1,o||(o={});var a=null==o.renderScaleFactor?1:o.renderScaleFactor;this._cachingStrategy!==r.CACHESTRATEGY_TOPLEVELGROUPS&&(this._background=new e.Rectangle2D({parent:this,id:"###CANVAS BACKGROUND###",size:o.size}),this._background.zOrder=1,this._background.isPickable=!1,this._background.origin=e.Vector2.Zero(),this._background.levelVisible=!1,null!=o.backgroundRoundRadius&&(this.backgroundRoundRadius=o.backgroundRoundRadius),null!=o.backgroundBorder&&("string"==typeof o.backgroundBorder?this.backgroundBorder=r.GetBrushFromString(o.backgroundBorder):this.backgroundBorder=o.backgroundBorder),null!=o.backgroundBorderThickNess&&(this.backgroundBorderThickness=o.backgroundBorderThickNess),null!=o.backgroundFill&&("string"==typeof o.backgroundFill?this.backgroundFill=r.GetBrushFromString(o.backgroundFill):this.backgroundFill=o.backgroundFill),this._background._patchHierarchy(this));var h=n.getEngine();this.__engineData=h.getOrAddExternalDataWithFactory("__BJSCANVAS2D__",function(e){return new t}),this._renderScaleFactor=a,this._primPointerInfo=new e.PrimitivePointerInfo,this._capturedPointers=new e.StringDictionary,this._pickStartingPosition=e.Vector2.Zero(),this._hierarchyLevelMaxSiblingCount=50,this._hierarchyDepthOffset=0,this._siblingDepthOffset=1/this._hierarchyLevelMaxSiblingCount,this._scene=n,this._engine=h,this._renderingSize=new e.Size(0,0),this._trackedGroups=new Array,this._patchHierarchy(this);var c=null==o.enableInteraction?!0:o.enableInteraction;this._fitRenderingDevice=!o.size,o.size?(o.size.height*=a,o.size.width*=a):o.size=new e.Size(h.getRenderWidth(),h.getRenderHeight()),n.onDisposeObservable.add(function(e,t){s.dispose()}),this._isScreenSpace?this._afterRenderObserver=this._scene.onAfterRenderObservable.add(function(e,t){s._engine.clear(null,!1,!0),s._render()}):this._beforeRenderObserver=this._scene.onBeforeRenderObservable.add(function(e,t){s._render()}),this._supprtInstancedArray=null!==this._engine.getCaps().instancedArrays,this._setupInteraction(c)}return __extends(r,i),r.prototype._canvasPreInit=function(e){var t=null==e.cachingStrategy?r.CACHESTRATEGY_DONTCACHE:e.cachingStrategy;this._cachingStrategy=t,this._isScreenSpace=null==e.isScreenSpace?!0:e.isScreenSpace},r.prototype._setupInteraction=function(e){var t=this;if(e!==this._interactionEnabled)if(this._interactionEnabled=e,this._isScreenSpace){if(!e)return void(this._scenePrePointerObserver&&(this.scene.onPrePointerObservable.remove(this._scenePrePointerObserver),this._scenePrePointerObserver=null));this._scenePrePointerObserver=this.scene.onPrePointerObservable.add(function(e,i){var r=1/t.engine.getHardwareScalingLevel(),n=e.localPosition.multiplyByFloats(r,r);t._handlePointerEventForInteraction(e,n,i)})}else{var i=this.scene;e?(i.constantlyUpdateMeshUnderPointer=!0,this._scenePointerObserver=i.onPointerObservable.add(function(e,i){if(e.pickInfo.hit&&e.pickInfo.pickedMesh===t._worldSpaceNode&&t.worldSpaceToNodeLocal){var r=t.worldSpaceToNodeLocal(e.pickInfo.pickedPoint);t._handlePointerEventForInteraction(e,r,i)}})):this._scenePointerObserver&&(this.scene.onPointerObservable.remove(this._scenePointerObserver),this._scenePointerObserver=null)}},r.prototype._setPointerCapture=function(t,i){if(this.isPointerCaptured(t))return!1;try{this.engine.getRenderingCanvas().setPointerCapture(t)}catch(r){}return this._primPointerInfo.updateRelatedTarget(i,e.Vector2.Zero()),this._bubbleNotifyPrimPointerObserver(i,e.PrimitivePointerInfo.PointerGotCapture,null),this._capturedPointers.add(t.toString(),i),!0},r.prototype._releasePointerCapture=function(t,i){if(this._capturedPointers.get(t.toString())!==i)return!1;try{this.engine.getRenderingCanvas().releasePointerCapture(t)}catch(r){}return this._primPointerInfo.updateRelatedTarget(i,e.Vector2.Zero()),this._bubbleNotifyPrimPointerObserver(i,e.PrimitivePointerInfo.PointerLostCapture,null),this._capturedPointers.remove(t.toString()),!0},r.prototype.isPointerCaptured=function(e){return this._capturedPointers.contains(e.toString())},r.prototype.getCapturedPrimitive=function(e){return 0===this._capturedPointers.count?null:this._capturedPointers.get(e.toString())},r.prototype._handlePointerEventForInteraction=function(t,i,r){if(!this.isDisposed){this._updatePointerInfo(t,i);var n=this.getCapturedPrimitive(this._primPointerInfo.pointerId);if(this._updateIntersectionList(this._primPointerInfo.canvasPointerPos,null!==n),this._updateOverStatus(),this._actualOverPrimitive||n){var o=n||this._actualOverPrimitive.prim,s=n?this._primPointerInfo.canvasPointerPos.subtract(new e.Vector2(o.globalTransform.m[12],o.globalTransform.m[13])):this._actualOverPrimitive.intersectionLocation;this._primPointerInfo.updateRelatedTarget(o,s),t.type===e.PointerEventTypes.POINTERWHEEL?this._bubbleNotifyPrimPointerObserver(o,e.PrimitivePointerInfo.PointerMouseWheel,t.event):t.type===e.PointerEventTypes.POINTERMOVE?this._bubbleNotifyPrimPointerObserver(o,e.PrimitivePointerInfo.PointerMove,t.event):t.type===e.PointerEventTypes.POINTERDOWN?this._bubbleNotifyPrimPointerObserver(o,e.PrimitivePointerInfo.PointerDown,t.event):t.type===e.PointerEventTypes.POINTERUP&&this._bubbleNotifyPrimPointerObserver(o,e.PrimitivePointerInfo.PointerUp,t.event)}}},r.prototype._updatePointerInfo=function(t,i){var r=this._primPointerInfo;r.canvasPointerPos||(r.canvasPointerPos=e.Vector2.Zero());var n=this._scene.cameraToUseForPointers||this._scene.activeCamera,o=this._scene.getEngine();if(this._isScreenSpace){var s=n.viewport,a=s.toGlobal(o.getRenderWidth(),o.getRenderHeight()),h=i.x-a.x,c=i.y-a.y;r.canvasPointerPos.x=h-this.actualPosition.x,r.canvasPointerPos.y=o.getRenderHeight()-c-this.actualPosition.y}else r.canvasPointerPos.x=i.x,r.canvasPointerPos.y=i.y;if(r.mouseWheelDelta=0,t.type===e.PointerEventTypes.POINTERWHEEL){var l=t.event;l.wheelDelta?r.mouseWheelDelta=l.wheelDelta/(40*e.PrimitivePointerInfo.MouseWheelPrecision):l.detail&&(r.mouseWheelDelta=-l.detail/e.PrimitivePointerInfo.MouseWheelPrecision)}else{var u=t.event;r.ctrlKey=u.ctrlKey,r.altKey=u.altKey,r.shiftKey=u.shiftKey,r.metaKey=u.metaKey,r.button=u.button,r.buttons=u.buttons,r.pointerId=u.pointerId,r.width=u.width,r.height=u.height,r.presssure=u.pressure,r.tilt.x=u.tiltX,r.tilt.y=u.tiltY,r.isCaptured=null!==this.getCapturedPrimitive(u.pointerId)}},r.prototype._updateIntersectionList=function(e,t){if(this.scene.getRenderId()!==this._intersectionRenderId){this._globalTransform||this.updateCachedStates(!0);var i=r._interInfo;if(i.pickPosition.x=e.x,i.pickPosition.y=e.y,i.findFirstOnly=!1,!t&&!this.boundingInfo.doesIntersect(i.pickPosition))return this._previousIntersectionList=this._actualIntersectionList,this._actualIntersectionList=null,this._previousOverPrimitive=this._actualOverPrimitive,void(this._actualOverPrimitive=null);this.intersect(i),this._previousIntersectionList=this._actualIntersectionList,this._actualIntersectionList=i.intersectedPrimitives,this._previousOverPrimitive=this._actualOverPrimitive,this._actualOverPrimitive=i.topMostIntersectedPrimitive,this._intersectionRenderId=this.scene.getRenderId()}},r.prototype._updateOverStatus=function(){if(this.scene.getRenderId()!==this._hoverStatusRenderId&&this._previousIntersectionList&&this._actualIntersectionList){var t=this._previousOverPrimitive?this._previousOverPrimitive.prim:null,i=this._actualOverPrimitive?this._actualOverPrimitive.prim:null;if(t!==i){var r=this.getCapturedPrimitive(this._primPointerInfo.pointerId);(r&&r===t||!r&&t)&&(this._primPointerInfo.updateRelatedTarget(t,this._previousOverPrimitive.intersectionLocation),this._bubbleNotifyPrimPointerObserver(t,e.PrimitivePointerInfo.PointerOut,null)),(r&&r===i||!r&&i)&&(this._primPointerInfo.updateRelatedTarget(i,this._actualOverPrimitive.intersectionLocation),this._bubbleNotifyPrimPointerObserver(i,e.PrimitivePointerInfo.PointerOver,null))}this._hoverStatusRenderId=this.scene.getRenderId()}},r.prototype._updatePrimPointerPos=function(e){if(this._primPointerInfo.isCaptured)this._primPointerInfo.primitivePointerPos=this._primPointerInfo.relatedTargetPointerPos;else for(var t=0,i=this._actualIntersectionList;t<i.length;t++){var r=i[t];if(r.prim===e)return void(this._primPointerInfo.primitivePointerPos=r.intersectionLocation)}},r.prototype._debugExecObserver=function(t,i){if(this._notifDebugMode){for(var r="",n=0;n<t.hierarchyDepth;n++)r+="  ";var o=this._primPointerInfo;r+="[RID:"+this.scene.getRenderId()+"] ["+t.hierarchyDepth+"] event:"+e.PrimitivePointerInfo.getEventTypeName(i)+", id: "+t.id+" ("+e.Tools.getClassName(t)+"), primPos: "+o.primitivePointerPos.toString()+", canvasPos: "+o.canvasPointerPos.toString(),console.log(r)}},r.prototype._bubbleNotifyPrimPointerObserver=function(t,i,r){var n=this._primPointerInfo;0!==(i&(e.PrimitivePointerInfo.PointerOver|e.PrimitivePointerInfo.PointerOut))&&this._notifParents(t,i);for(var o=!1,s=t;s;){if(!o&&(this._updatePrimPointerPos(s),this._debugExecObserver(s,i),s._pointerEventObservable.notifyObservers(n,i),this._triggerActionManager(s,n,i,r),n.cancelBubble)){if(0===(i&(e.PrimitivePointerInfo.PointerOver|e.PrimitivePointerInfo.PointerOut)))return;o=!0}o&&this._updatePrimPointerPos(s),i===e.PrimitivePointerInfo.PointerOver?(this._debugExecObserver(s,e.PrimitivePointerInfo.PointerEnter),s._pointerEventObservable.notifyObservers(n,e.PrimitivePointerInfo.PointerEnter)):i===e.PrimitivePointerInfo.PointerOut&&(this._debugExecObserver(s,e.PrimitivePointerInfo.PointerLeave),s._pointerEventObservable.notifyObservers(n,e.PrimitivePointerInfo.PointerLeave)),s=s.parent}},r.prototype._triggerActionManager=function(t,i,r,n){var o=this;if(this._globalTransform||this.updateCachedStates(!0),0!==(r&e.PrimitivePointerInfo.PointerDown)){if(this._pickStartingPosition=i.primitivePointerPos.clone(),this._pickStartingTime=(new Date).getTime(),this._pickedDownPrim=null,t.actionManager){if(this._pickedDownPrim=t,t.actionManager.hasPickTriggers){var s=e.ActionEvent.CreateNewFromPrimitive(t,i.primitivePointerPos,n);switch(n.button){case 0:t.actionManager.processTrigger(e.ActionManager.OnLeftPickTrigger,s);break;case 1:t.actionManager.processTrigger(e.ActionManager.OnCenterPickTrigger,s);break;case 2:t.actionManager.processTrigger(e.ActionManager.OnRightPickTrigger,s)}t.actionManager.processTrigger(e.ActionManager.OnPickDownTrigger,s)}t.actionManager.hasSpecificTrigger(e.ActionManager.OnLongPressTrigger)&&window.setTimeout(function(){var i=o._primPointerInfo,r=o.getCapturedPrimitive(i.pointerId);o._updateIntersectionList(i.canvasPointerPos,null!==r);var s=new e.IntersectInfo2D;s.pickPosition=i.canvasPointerPos.clone(),s.findFirstOnly=!1,o.intersect(s),null!==s.isPrimIntersected(t)&&t.actionManager&&0!==o._pickStartingTime&&(new Date).getTime()-o._pickStartingTime>e.ActionManager.LongPressDelay&&Math.abs(o._pickStartingPosition.x-s.pickPosition.x)<e.ActionManager.DragMovementThreshold&&Math.abs(o._pickStartingPosition.y-s.pickPosition.y)<e.ActionManager.DragMovementThreshold&&(o._pickStartingTime=0,t.actionManager.processTrigger(e.ActionManager.OnLongPressTrigger,e.ActionEvent.CreateNewFromPrimitive(t,i.primitivePointerPos,n)))},e.ActionManager.LongPressDelay)}}else if(0!==(r&e.PrimitivePointerInfo.PointerUp)){this._pickStartingTime=0;var s=e.ActionEvent.CreateNewFromPrimitive(t,i.primitivePointerPos,n);t.actionManager&&(t.actionManager.processTrigger(e.ActionManager.OnPickUpTrigger,s),Math.abs(this._pickStartingPosition.x-i.canvasPointerPos.x)<e.ActionManager.DragMovementThreshold&&Math.abs(this._pickStartingPosition.y-i.canvasPointerPos.y)<e.ActionManager.DragMovementThreshold&&t.actionManager.processTrigger(e.ActionManager.OnPickTrigger,s)),this._pickedDownPrim&&this._pickedDownPrim.actionManager&&this._pickedDownPrim!==t&&this._pickedDownPrim.actionManager.processTrigger(e.ActionManager.OnPickOutTrigger,s)}else if(0!==(r&e.PrimitivePointerInfo.PointerOver)){if(t.actionManager){var s=e.ActionEvent.CreateNewFromPrimitive(t,i.primitivePointerPos,n);t.actionManager.processTrigger(e.ActionManager.OnPointerOverTrigger,s)}}else if(0!==(r&e.PrimitivePointerInfo.PointerOut)&&t.actionManager){var s=e.ActionEvent.CreateNewFromPrimitive(t,i.primitivePointerPos,n);t.actionManager.processTrigger(e.ActionManager.OnPointerOutTrigger,s)}},r.prototype._notifParents=function(t,i){for(var r=this._primPointerInfo,n=this;n;)this._updatePrimPointerPos(n),i===e.PrimitivePointerInfo.PointerOver?(this._debugExecObserver(n,e.PrimitivePointerInfo.PointerEnter),n._pointerEventObservable.notifyObservers(r,e.PrimitivePointerInfo.PointerEnter)):i===e.PrimitivePointerInfo.PointerOut&&(this._debugExecObserver(n,e.PrimitivePointerInfo.PointerLeave),n._pointerEventObservable.notifyObservers(r,e.PrimitivePointerInfo.PointerLeave)),n=n.parent},r.prototype.dispose=function(){return i.prototype.dispose.call(this)?(this.interactionEnabled&&this._setupInteraction(!1),this._beforeRenderObserver&&(this._scene.onBeforeRenderObservable.remove(this._beforeRenderObserver),this._beforeRenderObserver=null),this._afterRenderObserver&&(this._scene.onAfterRenderObservable.remove(this._afterRenderObserver),this._afterRenderObserver=null),void(this._groupCacheMaps&&(this._groupCacheMaps.forEach(function(e){return e.dispose()}),this._groupCacheMaps=null))):!1},Object.defineProperty(r.prototype,"scene",{get:function(){return this._scene},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"engine",{get:function(){return this._engine},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"cachingStrategy",{get:function(){return this._cachingStrategy},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"worldSpaceCanvasNode",{get:function(){return this._worldSpaceNode},set:function(e){this._worldSpaceNode=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"supportInstancedArray",{get:function(){return this._supprtInstancedArray},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"backgroundFill",{get:function(){return this._background&&this._background.isVisible?this._background.fill:null},set:function(e){this.checkBackgroundAvailability(),e!==this._background.fill&&(this._background.fill=e,this._background.levelVisible=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"backgroundBorder",{get:function(){return this._background&&this._background.isVisible?this._background.border:null},set:function(e){this.checkBackgroundAvailability(),e!==this._background.border&&(this._background.border=e,this._background.levelVisible=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"backgroundBorderThickness",{get:function(){return this._background&&this._background.isVisible?this._background.borderThickness:null},set:function(e){this.checkBackgroundAvailability(),e!==this._background.borderThickness&&(this._background.borderThickness=e)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"backgroundRoundRadius",{get:function(){return this._background&&this._background.isVisible?this._background.roundRadius:null},set:function(e){this.checkBackgroundAvailability(),e!==this._background.roundRadius&&(this._background.roundRadius=e,this._background.levelVisible=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"interactionEnabled",{get:function(){return this._interactionEnabled},set:function(e){this._setupInteraction(e)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"_engineData",{get:function(){return this.__engineData},enumerable:!0,configurable:!0}),r.prototype.checkBackgroundAvailability=function(){if(this._cachingStrategy===r.CACHESTRATEGY_TOPLEVELGROUPS)throw Error("Can't use Canvas Background with the caching strategy TOPLEVELGROUPS")},r.prototype.onPrimBecomesDirty=function(){this._addPrimToDirtyList(this)},r.prototype._updateTrackedNodes=function(){var t=this.scene.cameraToUseForPointers||this.scene.activeCamera;t.getViewMatrix().multiplyToRef(t.getProjectionMatrix(),r._m);for(var i=this.engine.getRenderHeight(),n=t.viewport.toGlobal(this.engine.getRenderWidth(),i),o=0,s=this._trackedGroups;o<s.length;o++){var a=s[o];if(!a.isDisposed&&a.isVisible){var h=a.trackedNode,c=h.getWorldMatrix(),l=e.Vector3.Project(r._v,c,r._m,n);a.x=Math.round(l.x),a.y=Math.round(i-l.y)}}},r.prototype._updateCanvasState=function(){if(this.scene.getRenderId()!==this._updateRenderId){var t=!1,i=this.engine.getRenderWidth();i!==this._renderingSize.width&&(t=!0),this._renderingSize.width=i;var r=this.engine.getRenderHeight();r!==this._renderingSize.height&&(t=!0),this._renderingSize.height=r,t&&this._fitRenderingDevice&&(this.size=this._renderingSize,this._background&&(this._background.size=this.size),this._setLayoutDirty());var n=new e.PrepareRender2DContext;++this._globalTransformProcessStep,this.updateCachedStates(!1),this._prepareGroupRender(n),this._updateRenderId=this.scene.getRenderId()}},r.prototype._render=function(){this._updateTrackedNodes(),this._updateCanvasState(),this._primPointerInfo.canvasPointerPos&&(this._updateIntersectionList(this._primPointerInfo.canvasPointerPos,!1),this._updateOverStatus()),this.engine.setState(!1),this._groupRender(),this._cachingStrategy===r.CACHESTRATEGY_CANVAS&&this._cachedCanvasGroup&&this._cachedCanvasGroup._renderCachedCanvas()},r.prototype._allocateGroupCache=function(t,i,n){var o=t.actualSize;o=new e.Size(Math.ceil(o.width),Math.ceil(o.height)),n&&(o.width=Math.max(n.width,o.width),o.height=Math.max(n.height,o.height)),this._groupCacheMaps||(this._groupCacheMaps=new Array);for(var s=null,a=0,h=this._groupCacheMaps;a<h.length;a++){var c=h[a],l=c.allocateRect(o);if(l){s={node:l,texture:c};break}}if(!s){var u=new e.Size(r._groupTextureCacheSize,r._groupTextureCacheSize);(o.width>u.width||o.height>u.height)&&(u.width=Math.pow(2,Math.ceil(Math.log(o.width)/Math.log(2))),u.height=Math.pow(2,Math.ceil(Math.log(o.height)/Math.log(2))));var f="groupsMapChache"+this._mapCounter+"forCanvas"+this.id;c=new e.MapTexture(f,this._scene,u),this._groupCacheMaps.push(c);var l=c.allocateRect(o);s={node:l,texture:c}}if(t!==this||this._isScreenSpace){var l=s.node;if(this._cachingStrategy===r.CACHESTRATEGY_CANVAS){this._cachedCanvasGroup=e.Group2D._createCachedCanvasGroup(this);var d=new e.Sprite2D(c,{parent:this._cachedCanvasGroup,id:"__cachedCanvasSprite__",spriteSize:l.contentSize,spriteLocation:l.pos});d.zOrder=1,d.origin=e.Vector2.Zero()}else{var d=new e.Sprite2D(c,{parent:i,id:"__cachedSpriteOfGroup__"+t.id,x:t.actualPosition.x,y:t.actualPosition.y,spriteSize:l.contentSize,spriteLocation:l.pos});d.origin=t.origin.clone(),s.sprite=d}}return s},r.prototype._registerTrackedNode=function(t){t._isFlagSet(e.SmartPropertyPrim.flagTrackedGroup)||(this._trackedGroups.push(t),t._setFlags(e.SmartPropertyPrim.flagTrackedGroup))},r.prototype._unregisterTrackedNode=function(t){if(t._isFlagSet(e.SmartPropertyPrim.flagTrackedGroup)){var i=this._trackedGroups.indexOf(t);-1!==i&&this._trackedGroups.splice(i,1),t._clearFlags(e.SmartPropertyPrim.flagTrackedGroup)}},r.GetSolidColorBrush=function(t){return r._solidColorBrushes.getOrAddWithFactory(t.toHexString(),function(){return new e.SolidColorBrush2D(t.clone(),!0)})},r.GetSolidColorBrushFromHex=function(t){return r._solidColorBrushes.getOrAddWithFactory(t,function(){return new e.SolidColorBrush2D(e.Color4.FromHexString(t),!0)})},r.GetGradientColorBrush=function(t,i,n,o,s){return void 0===n&&(n=e.Vector2.Zero()),void 0===o&&(o=0),void 0===s&&(s=1),r._gradientColorBrushes.getOrAddWithFactory(e.GradientColorBrush2D.BuildKey(t,i,n,o,s),function(){return new e.GradientColorBrush2D(t,i,n,o,s,!0)})},r.GetBrushFromString=function(t){t=t.trim();var i=t.split(",");if(1===i.length){var n=null;if(0===t.indexOf("solid:"))n=t.substr(6).trim();else{if(0!==t.indexOf("#"))return null;n=t}return r.GetSolidColorBrushFromHex(n)}0===i[0].indexOf("gradient:")&&(i[0]=i[0].substr(9).trim());try{var o=e.Color4.FromHexString(i[0].trim()),s=e.Color4.FromHexString(i[1].trim()),a=e.Vector2.Zero();if(i.length>2){var h=i[2].trim();if("["!==h.charAt(0)||"]"!==h.charAt(h.length-1))return null;var c=h.indexOf(":"),l=parseFloat(h.substr(1,c)),u=parseFloat(h.substr(c+1,h.length-(c+1)));a=new e.Vector2(l,u)}var f=0;i.length>3&&(f=e.Tools.ToRadians(parseFloat(i[3].trim())));var d=1;return i.length>4&&(d=parseFloat(i[4].trim())),r.GetGradientColorBrush(o,s,a,f,d)}catch(p){return null}},r.CACHESTRATEGY_TOPLEVELGROUPS=1,r.CACHESTRATEGY_ALLGROUPS=2,r.CACHESTRATEGY_CANVAS=3,r.CACHESTRATEGY_DONTCACHE=4,r.hierarchyLevelMaxSiblingCount=50,r._interInfo=new e.IntersectInfo2D,r._v=e.Vector3.Zero(),r._m=e.Matrix.Identity(),r._groupTextureCacheSize=1024,r._solidColorBrushes=new e.StringDictionary,r._gradientColorBrushes=new e.StringDictionary,r=__decorate([e.className("Canvas2D")],r)}(e.Group2D);e.Canvas2D=i;var r=function(t){function r(r,n,o){e.Prim2DBase._isCanvasInit=!0;var s=o;if(s.isScreenSpace=!1,s.size=n.clone(),o.cachingStrategy=null==o.cachingStrategy?i.CACHESTRATEGY_CANVAS:o.cachingStrategy,o.cachingStrategy!==i.CACHESTRATEGY_CANVAS)throw new Error("Right now only the CACHESTRATEGY_CANVAS cache Strategy is supported for WorldSpace Canvas. More will come soon!");t.call(this,r,o),e.Prim2DBase._isCanvasInit=!1;var a=!o||null==o.customWorldSpaceNode,h=o?o.id||null:null;if(a){var c=new e.WorldSpaceCanvas2DNode(h,r,this),l=e.VertexData.CreatePlane({width:n.width,height:n.height,sideOrientation:o&&o.sideOrientation||e.Mesh.DEFAULTSIDE}),u=new e.StandardMaterial(h+"_Material",r);this.applyCachedTexture(l,u),l.applyToMesh(c,!1),u.specularColor=new e.Color3(0,0,0),u.disableLighting=!0,u.useAlphaFromDiffuseTexture=!0,c.position=o&&o.worldPosition||e.Vector3.Zero(),c.rotationQuaternion=o&&o.worldRotation||e.Quaternion.Identity(),c.material=u,this._worldSpaceNode=c}else this._worldSpaceNode=o.customWorldSpaceNode,this.applyCachedTexture(null,null)}return __extends(r,t),r=__decorate([e.className("WorldSpaceCanvas2D")],r)}(i);e.WorldSpaceCanvas2D=r;var n=function(t){function i(i,r){e.Prim2DBase._isCanvasInit=!0,t.call(this,i,r)}return __extends(i,t),i=__decorate([e.className("ScreenSpaceCanvas2D")],i)}(i);e.ScreenSpaceCanvas2D=n}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(e){function t(t,i,r){e.call(this,t,i),this._canvas=r}return __extends(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this._canvas&&(this._canvas.dispose(),this._canvas=null)},t}(e.Mesh);e.WorldSpaceCanvas2DNode=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(){this.layoutDirtyOnPropertyChangedMask=0}return t.prototype.updateLayout=function(e){},Object.defineProperty(t.prototype,"isChildPositionAllowed",{get:function(){return!1},enumerable:!0,configurable:!0}),t.prototype.isLocked=function(){return this._isLocked},t.prototype.lock=function(){return this._isLocked?!1:(this._isLocked=!0,!0)},t=__decorate([e.className("LayoutEngineBase")],t)}();e.LayoutEngineBase=t;var i=function(t){function i(){t.apply(this,arguments)}return __extends(i,t),i.prototype.updateLayout=function(t){if(t._isFlagSet(e.SmartPropertyPrim.flagLayoutDirty)){for(var i=0,r=t.children;i<r.length;i++){var n=r[i];this._doUpdate(n)}t._clearFlags(e.SmartPropertyPrim.flagLayoutDirty)}},i.prototype._doUpdate=function(t){t instanceof e.Canvas2D?t.layoutArea=t.actualSize:t.parent instanceof e.Canvas2D?t.layoutArea=t.owner.actualSize:t.layoutArea=t.parent.contentArea},Object.defineProperty(i.prototype,"isChildPositionAllowed",{get:function(){return!0},enumerable:!0,configurable:!0}),i.Singleton=new i,i=__decorate([e.className("CanvasLayoutEngine")],i)}(t);e.CanvasLayoutEngine=i;var r=function(t){function i(){t.call(this),this._isHorizontal=!0,this.layoutDirtyOnPropertyChangedMask=e.Prim2DBase.sizeProperty.flagId}return __extends(i,t),Object.defineProperty(i,"Horizontal",{get:function(){return i._horizontal||(i._horizontal=new i,i._horizontal.isHorizontal=!0,i._horizontal.lock()),i._horizontal},enumerable:!0,configurable:!0}),Object.defineProperty(i,"Vertical",{get:function(){return i._vertical||(i._vertical=new i,i._vertical.isHorizontal=!1,i._vertical.lock()),i._vertical},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isHorizontal",{get:function(){return this._isHorizontal},set:function(e){this.isLocked()||(this._isHorizontal=e)},enumerable:!0,configurable:!0}),i.prototype.updateLayout=function(t){if(t._isFlagSet(e.SmartPropertyPrim.flagLayoutDirty)){for(var i=0,r=0,n=this.isHorizontal,o=0,s=0,a=t.children;s<a.length;s++){var h=a[s],c=h.layoutArea;h.margin.computeArea(h.actualSize,c),o=Math.max(o,n?c.height:c.width)}for(var l=0,u=t.children;l<u.length;l++){var h=u[l];h.layoutAreaPos=new e.Vector2(i,r);var c=h.layoutArea;n?(i+=c.width,h.layoutArea=new e.Size(c.width,o)):(r+=c.height,h.layoutArea=new e.Size(o,c.height))}t._clearFlags(e.SmartPropertyPrim.flagLayoutDirty)}},Object.defineProperty(i.prototype,"isChildPositionAllowed",{get:function(){return!1},enumerable:!0,configurable:!0}),i._horizontal=null,i._vertical=null,i=__decorate([e.className("StackPanelLayoutEngine")],i)}(t);e.StackPanelLayoutEngine=r;
}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(i,r,n,o){t.call(this,i,r),this._textures={},this._floats={},this._floatsArrays={},this._colors3={},this._colors4={},this._vectors2={},this._vectors3={},this._vectors4={},this._matrices={},this._matrices3x3={},this._matrices2x2={},this._cachedWorldViewMatrix=new e.Matrix,this._shaderPath=n,o.needAlphaBlending=o.needAlphaBlending||!1,o.needAlphaTesting=o.needAlphaTesting||!1,o.attributes=o.attributes||["position","normal","uv"],o.uniforms=o.uniforms||["worldViewProjection"],o.samplers=o.samplers||[],o.defines=o.defines||[],this._options=o}return __extends(i,t),i.prototype.needAlphaBlending=function(){return this._options.needAlphaBlending},i.prototype.needAlphaTesting=function(){return this._options.needAlphaTesting},i.prototype._checkUniform=function(e){-1===this._options.uniforms.indexOf(e)&&this._options.uniforms.push(e)},i.prototype.setTexture=function(e,t){return-1===this._options.samplers.indexOf(e)&&this._options.samplers.push(e),this._textures[e]=t,this},i.prototype.setFloat=function(e,t){return this._checkUniform(e),this._floats[e]=t,this},i.prototype.setFloats=function(e,t){return this._checkUniform(e),this._floatsArrays[e]=t,this},i.prototype.setColor3=function(e,t){return this._checkUniform(e),this._colors3[e]=t,this},i.prototype.setColor4=function(e,t){return this._checkUniform(e),this._colors4[e]=t,this},i.prototype.setVector2=function(e,t){return this._checkUniform(e),this._vectors2[e]=t,this},i.prototype.setVector3=function(e,t){return this._checkUniform(e),this._vectors3[e]=t,this},i.prototype.setVector4=function(e,t){return this._checkUniform(e),this._vectors4[e]=t,this},i.prototype.setMatrix=function(e,t){return this._checkUniform(e),this._matrices[e]=t,this},i.prototype.setMatrix3x3=function(e,t){return this._checkUniform(e),this._matrices3x3[e]=t,this},i.prototype.setMatrix2x2=function(e,t){return this._checkUniform(e),this._matrices2x2[e]=t,this},i.prototype.isReady=function(t,i){var r=this.getScene(),n=r.getEngine();if(!this.checkReadyOnEveryCall&&this._renderId===r.getRenderId())return!0;var o=[],s=new e.EffectFallbacks;i&&o.push("#define INSTANCES");for(var a=0;a<this._options.defines.length;a++)o.push(this._options.defines[a]);t&&t.useBones&&t.computeBonesUsingShaders&&(o.push("#define NUM_BONE_INFLUENCERS "+t.numBoneInfluencers),o.push("#define BonesPerMesh "+(t.skeleton.bones.length+1)),s.addCPUSkinningFallback(0,t)),n.getAlphaTesting()&&o.push("#define ALPHATEST");var h=this._effect,c=o.join("\n");return this._effect=n.createEffect(this._shaderPath,this._options.attributes,this._options.uniforms,this._options.samplers,c,s,this.onCompiled,this.onError),this._effect.isReady()?(h!==this._effect&&r.resetCachedMaterial(),this._renderId=r.getRenderId(),!0):!1},i.prototype.bindOnlyWorldMatrix=function(e){var t=this.getScene();-1!==this._options.uniforms.indexOf("world")&&this._effect.setMatrix("world",e),-1!==this._options.uniforms.indexOf("worldView")&&(e.multiplyToRef(t.getViewMatrix(),this._cachedWorldViewMatrix),this._effect.setMatrix("worldView",this._cachedWorldViewMatrix)),-1!==this._options.uniforms.indexOf("worldViewProjection")&&this._effect.setMatrix("worldViewProjection",e.multiply(t.getTransformMatrix()))},i.prototype.bind=function(e,i){if(this.bindOnlyWorldMatrix(e),this.getScene().getCachedMaterial()!==this){-1!==this._options.uniforms.indexOf("view")&&this._effect.setMatrix("view",this.getScene().getViewMatrix()),-1!==this._options.uniforms.indexOf("projection")&&this._effect.setMatrix("projection",this.getScene().getProjectionMatrix()),-1!==this._options.uniforms.indexOf("viewProjection")&&this._effect.setMatrix("viewProjection",this.getScene().getTransformMatrix()),i&&i.useBones&&i.computeBonesUsingShaders&&this._effect.setMatrices("mBones",i.skeleton.getTransformMatrices(i));for(var r in this._textures)this._effect.setTexture(r,this._textures[r]);for(r in this._floats)this._effect.setFloat(r,this._floats[r]);for(r in this._floatsArrays)this._effect.setArray(r,this._floatsArrays[r]);for(r in this._colors3)this._effect.setColor3(r,this._colors3[r]);for(r in this._colors4){var n=this._colors4[r];this._effect.setFloat4(r,n.r,n.g,n.b,n.a)}for(r in this._vectors2)this._effect.setVector2(r,this._vectors2[r]);for(r in this._vectors3)this._effect.setVector3(r,this._vectors3[r]);for(r in this._vectors4)this._effect.setVector4(r,this._vectors4[r]);for(r in this._matrices)this._effect.setMatrix(r,this._matrices[r]);for(r in this._matrices3x3)this._effect.setMatrix3x3(r,this._matrices3x3[r]);for(r in this._matrices2x2)this._effect.setMatrix2x2(r,this._matrices2x2[r])}t.prototype.bind.call(this,e,i)},i.prototype.clone=function(e){var t=new i(e,this.getScene(),this._shaderPath,this._options);return t},i.prototype.dispose=function(e,i){if(i)for(var r in this._textures)this._textures[r].dispose();this._textures={},t.prototype.dispose.call(this,e,i)},i.prototype.serialize=function(){var t=e.SerializationHelper.Serialize(this);t.customType="BABYLON.ShaderMaterial",t.options=this._options,t.shaderPath=this._shaderPath,t.textures={};for(var i in this._textures)t.textures[i]=this._textures[i].serialize();t.floats={};for(i in this._floats)t.floats[i]=this._floats[i];t.floatArrays={};for(i in this._floatsArrays)t.floatArrays[i]=this._floatsArrays[i];t.colors3={};for(i in this._colors3)t.colors3[i]=this._colors3[i].asArray();t.colors4={};for(i in this._colors4)t.colors4[i]=this._colors4[i].asArray();t.vectors2={};for(i in this._vectors2)t.vectors2[i]=this._vectors2[i].asArray();t.vectors3={};for(i in this._vectors3)t.vectors3[i]=this._vectors3[i].asArray();t.vectors4={};for(i in this._vectors4)t.vectors4[i]=this._vectors4[i].asArray();t.matrices={};for(i in this._matrices)t.matrices[i]=this._matrices[i].asArray();t.matrices3x3={};for(i in this._matrices3x3)t.matrices3x3[i]=this._matrices3x3[i];t.matrices2x2={};for(i in this._matrices2x2)t.matrices2x2[i]=this._matrices2x2[i];return t},i.Parse=function(t,r,n){var o=e.SerializationHelper.Parse(function(){return new i(t.name,r,t.shaderPath,t.options)},t,r,n);for(var s in t.textures)o.setTexture(s,e.Texture.Parse(t.textures[s],r,n));for(s in t.floats)o.setFloat(s,t.floats[s]);for(s in t.floatsArrays)o.setFloats(s,t.floatsArrays[s]);for(s in t.colors3)o.setColor3(s,e.Color3.FromArray(t.colors3[s]));for(s in t.colors4)o.setColor4(s,e.Color4.FromArray(t.colors4[s]));for(s in t.vectors2)o.setVector2(s,e.Vector2.FromArray(t.vectors2[s]));for(s in t.vectors3)o.setVector3(s,e.Vector3.FromArray(t.vectors3[s]));for(s in t.vectors4)o.setVector4(s,e.Vector4.FromArray(t.vectors4[s]));for(s in t.matrices)o.setMatrix(s,e.Matrix.FromArray(t.matrices[s]));for(s in t.matrices3x3)o.setMatrix3x3(s,t.matrices3x3[s]);for(s in t.matrices2x2)o.setMatrix2x2(s,t.matrices2x2[s]);return o},i}(e.Material);e.ShaderMaterial=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t;!function(t){function i(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}function r(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)}var n=542327876,o=131072,s=512,a=4,h=64,c=131072,l=i("DXT1"),u=i("DXT3"),f=i("DXT5"),d=31,p=0,_=1,m=2,g=3,v=4,y=7,x=20,b=21,P=22,A=28,T=function(){function t(){}return t.GetDDSInfo=function(e){var t=new Int32Array(e,0,d),i=1;return t[m]&o&&(i=Math.max(1,t[y])),{width:t[v],height:t[g],mipmapCount:i,isFourCC:(t[x]&a)===a,isRGB:(t[x]&h)===h,isLuminance:(t[x]&c)===c,isCube:(t[A]&s)===s}},t.GetRGBAArrayBuffer=function(e,t,i,r,n){for(var o=new Uint8Array(r),s=new Uint8Array(n),a=0,h=t-1;h>=0;h--)for(var c=0;e>c;c++){var l=i+4*(c+h*e);o[a+2]=s[l],o[a+1]=s[l+1],o[a]=s[l+2],o[a+3]=s[l+3],a+=4}return o},t.GetRGBArrayBuffer=function(e,t,i,r,n){for(var o=new Uint8Array(r),s=new Uint8Array(n),a=0,h=t-1;h>=0;h--)for(var c=0;e>c;c++){var l=i+3*(c+h*e);o[a+2]=s[l],o[a+1]=s[l+1],o[a]=s[l+2],a+=3}return o},t.GetLuminanceArrayBuffer=function(e,t,i,r,n){for(var o=new Uint8Array(r),s=new Uint8Array(n),a=0,h=t-1;h>=0;h--)for(var c=0;e>c;c++){var l=i+(c+h*e);o[a]=s[l],a++}return o},t.UploadDDSLevels=function(i,s,a,h,c,x){var A,T,E,C,S,M,I,D,R,O,w=new Int32Array(a,0,d);if(w[p]!=n)return void e.Tools.Error("Invalid magic number in DDS header");if(!h.isFourCC&&!h.isRGB&&!h.isLuminance)return void e.Tools.Error("Unsupported format, must contain a FourCC, RGB or LUMINANCE code");if(h.isFourCC)switch(A=w[b]){case l:T=8,E=s.COMPRESSED_RGBA_S3TC_DXT1_EXT;break;case u:T=16,E=s.COMPRESSED_RGBA_S3TC_DXT3_EXT;break;case f:T=16,E=s.COMPRESSED_RGBA_S3TC_DXT5_EXT;break;default:return void console.error("Unsupported FourCC code:",r(A))}R=1,w[m]&o&&c!==!1&&(R=Math.max(1,w[y]));for(var L=w[P],B=0;x>B;B++){var V=1===x?i.TEXTURE_2D:i.TEXTURE_CUBE_MAP_POSITIVE_X+B;for(C=w[v],S=w[g],I=w[_]+4,O=0;R>O;++O){if(h.isRGB)24===L?(M=C*S*3,D=t.GetRGBArrayBuffer(C,S,I,M,a),i.texImage2D(V,O,i.RGB,C,S,0,i.RGB,i.UNSIGNED_BYTE,D)):(M=C*S*4,D=t.GetRGBAArrayBuffer(C,S,I,M,a),i.texImage2D(V,O,i.RGBA,C,S,0,i.RGBA,i.UNSIGNED_BYTE,D));else if(h.isLuminance){var F=i.getParameter(i.UNPACK_ALIGNMENT),N=C,z=Math.floor((C+F-1)/F)*F;M=z*(S-1)+N,D=t.GetLuminanceArrayBuffer(C,S,I,M,a),i.texImage2D(V,O,i.LUMINANCE,C,S,0,i.LUMINANCE,i.UNSIGNED_BYTE,D)}else M=Math.max(4,C)/4*Math.max(4,S)/4*T,D=new Uint8Array(a,I,M),i.compressedTexImage2D(V,O,E,C,S,0,D);I+=M,C*=.5,S*=.5,C=Math.max(1,C),S=Math.max(1,S)}}},t}();t.DDSTools=T}(t=e.Internals||(e.Internals={}))}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(t,i){return void 0===t&&(t=!0),void 0===i&&(i=10),this._useDeltaForWorldStep=t,this.name="CannonJSPlugin",this._physicsMaterials=[],this._fixedTimeStep=1/60,this._currentCollisionGroup=2,this._minus90X=new e.Quaternion(-.7071067811865475,0,0,.7071067811865475),this._plus90X=new e.Quaternion(.7071067811865475,0,0,.7071067811865475),this._tmpPosition=e.Vector3.Zero(),this._tmpQuaternion=new e.Quaternion,this._tmpDeltaPosition=e.Vector3.Zero(),this._tmpDeltaRotation=new e.Quaternion,this._tmpUnityRotation=new e.Quaternion,this.isSupported()?(this.world=new CANNON.World,this.world.broadphase=new CANNON.NaiveBroadphase,void(this.world.solver.iterations=i)):void e.Tools.Error("CannonJS is not available. Please make sure you included the js file.")}return t.prototype.setGravity=function(e){this.world.gravity.copy(e)},t.prototype.setTimeStep=function(e){this._fixedTimeStep=e},t.prototype.executeStep=function(e,t){this.world.step(this._fixedTimeStep,this._useDeltaForWorldStep?1e3*e:0,3)},t.prototype.applyImpulse=function(e,t,i){var r=new CANNON.Vec3(i.x,i.y,i.z),n=new CANNON.Vec3(t.x,t.y,t.z);e.physicsBody.applyImpulse(n,r)},t.prototype.applyForce=function(e,t,i){var r=new CANNON.Vec3(i.x,i.y,i.z),n=new CANNON.Vec3(t.x,t.y,t.z);e.physicsBody.applyImpulse(n,r)},t.prototype.generatePhysicsBody=function(e){if(e.parent)return void(e.physicsBody&&(this.removePhysicsBody(e),e.forceUpdate()));if(e.isBodyInitRequired()){var t=this._createShape(e),i=e.physicsBody;i&&this.removePhysicsBody(e);var r=this._addMaterial("mat-"+e.uniqueId,e.getParam("friction"),e.getParam("restitution")),n={mass:e.getParam("mass"),material:r},o=e.getParam("nativeOptions");for(var s in o)o.hasOwnProperty(s)&&(n[s]=o[s]);e.physicsBody=new CANNON.Body(n),e.physicsBody.addEventListener("collide",e.onCollide),this.world.addEventListener("preStep",e.beforeStep),this.world.addEventListener("postStep",e.afterStep),e.physicsBody.addShape(t),this.world.add(e.physicsBody),i&&["force","torque","velocity","angularVelocity"].forEach(function(t){e.physicsBody[t].copy(i[t])}),this._processChildMeshes(e)}this._updatePhysicsBodyTransformation(e)},t.prototype._processChildMeshes=function(t){var i=this,r=t.object.getChildMeshes?t.object.getChildMeshes():[];if(r.length){var n=function(e,r){var o=r.getPhysicsImpostor();if(o){var s=o.parent;if(s!==t){var e=r.position;o.physicsBody&&(i.removePhysicsBody(o),o.physicsBody=null),o.parent=t,o.resetUpdateFlags(),t.physicsBody.addShape(i._createShape(o),new CANNON.Vec3(e.x,e.y,e.z)),t.physicsBody.mass+=o.getParam("mass")}}r.getChildMeshes().forEach(n.bind(i,r.position))};r.forEach(n.bind(this,e.Vector3.Zero()))}},t.prototype.removePhysicsBody=function(e){e.physicsBody.removeEventListener("collide",e.onCollide),this.world.removeEventListener("preStep",e.beforeStep),this.world.removeEventListener("postStep",e.afterStep),this.world.remove(e.physicsBody)},t.prototype.generateJoint=function(t){var i=t.mainImpostor.physicsBody,r=t.connectedImpostor.physicsBody;if(i&&r){var n,o=t.joint.jointData,s={pivotA:o.mainPivot?(new CANNON.Vec3).copy(o.mainPivot):null,pivotB:o.connectedPivot?(new CANNON.Vec3).copy(o.connectedPivot):null,axisA:o.mainAxis?(new CANNON.Vec3).copy(o.mainAxis):null,axisB:o.connectedAxis?(new CANNON.Vec3).copy(o.connectedAxis):null,maxForce:o.nativeParams.maxForce,collideConnected:!!o.collision};switch(t.joint.type){case e.PhysicsJoint.HingeJoint:case e.PhysicsJoint.Hinge2Joint:n=new CANNON.HingeConstraint(i,r,s);break;case e.PhysicsJoint.DistanceJoint:n=new CANNON.DistanceConstraint(i,r,o.maxDistance||2);break;case e.PhysicsJoint.SpringJoint:var a=o;n=new CANNON.Spring(i,r,{restLength:a.length,stiffness:a.stiffness,damping:a.damping,localAnchorA:s.pivotA,localAnchorB:s.pivotB});break;case e.PhysicsJoint.LockJoint:n=new CANNON.LockConstraint(i,r,s);break;case e.PhysicsJoint.PointToPointJoint:case e.PhysicsJoint.BallAndSocketJoint:default:n=new CANNON.PointToPointConstraint(i,s.pivotA,r,s.pivotA,s.maxForce)}n.collideConnected=!!o.collision,t.joint.physicsJoint=n,t.joint.type!==e.PhysicsJoint.SpringJoint?this.world.addConstraint(n):t.mainImpostor.registerAfterPhysicsStep(function(){n.applyForce()})}},t.prototype.removeJoint=function(e){this.world.removeConstraint(e.joint.physicsJoint)},t.prototype._addMaterial=function(e,t,i){var r,n;for(r=0;r<this._physicsMaterials.length;r++)if(n=this._physicsMaterials[r],n.friction===t&&n.restitution===i)return n;var o=new CANNON.Material(e);return o.friction=t,o.restitution=i,this._physicsMaterials.push(o),o},t.prototype._checkWithEpsilon=function(t){return t<e.PhysicsEngine.Epsilon?e.PhysicsEngine.Epsilon:t},t.prototype._createShape=function(t){var i,r=t.object,n=t.getObjectExtendSize();switch(t.type){case e.PhysicsEngine.SphereImpostor:var o=n.x,s=n.y,a=n.z;i=new CANNON.Sphere(Math.max(this._checkWithEpsilon(o),this._checkWithEpsilon(s),this._checkWithEpsilon(a))/2);break;case e.PhysicsImpostor.CylinderImpostor:i=new CANNON.Cylinder(this._checkWithEpsilon(n.x)/2,this._checkWithEpsilon(n.x)/2,this._checkWithEpsilon(n.y),16);break;case e.PhysicsImpostor.BoxImpostor:var h=n.scale(.5);i=new CANNON.Box(new CANNON.Vec3(this._checkWithEpsilon(h.x),this._checkWithEpsilon(h.y),this._checkWithEpsilon(h.z)));break;case e.PhysicsImpostor.PlaneImpostor:e.Tools.Warn("Attention, PlaneImposter might not behave as you expect. Consider using BoxImposter instead"),i=new CANNON.Plane;break;case e.PhysicsImpostor.MeshImpostor:var c=r.getVerticesData?r.getVerticesData(e.VertexBuffer.PositionKind):[],l=r.getIndices?r.getIndices():[];e.Tools.Warn("MeshImpostor only collides against spheres."),i=new CANNON.Trimesh(c,l);break;case e.PhysicsImpostor.HeightmapImpostor:i=this._createHeightmap(r);break;case e.PhysicsImpostor.ParticleImpostor:i=new CANNON.Particle}return i},t.prototype._createHeightmap=function(t,i){for(var r=t.getVerticesData(e.VertexBuffer.PositionKind),n=[],o=i||~~(Math.sqrt(r.length/3)-1),s=Math.min(t.getBoundingInfo().boundingBox.extendSize.x,t.getBoundingInfo().boundingBox.extendSize.z),a=2*s/o,h=t.getBoundingInfo().boundingBox.extendSize.y,c=0;c<r.length;c+=3){var l=Math.round(r[c+0]/a+o/2),u=Math.round(-1*(r[c+2]/a-o/2)),f=r[c+1]+h;n[l]||(n[l]=[]),n[l][u]||(n[l][u]=f),n[l][u]=Math.max(f,n[l][u])}for(var l=0;o>=l;++l){if(!n[l]){for(var d=1;!n[(l+d)%o];)d++;n[l]=n[(l+d)%o].slice()}for(var u=0;o>=u;++u)if(!n[l][u]){for(var p,d=1;void 0===p;)p=n[l][(u+d++)%o];n[l][u]=p}}var _=new CANNON.Heightfield(n,{elementSize:a});return _.minY=h,_},t.prototype._updatePhysicsBodyTransformation=function(t){var i=t.object;i.computeWorldMatrix&&i.computeWorldMatrix(!0);var r=t.getObjectCenter();t.getObjectExtendSize();this._tmpDeltaPosition.copyFrom(i.position.subtract(r)),this._tmpPosition.copyFrom(r);var n=i.rotationQuaternion;if(t.type!==e.PhysicsImpostor.PlaneImpostor&&t.type!==e.PhysicsImpostor.HeightmapImpostor&&t.type!==e.PhysicsImpostor.CylinderImpostor||(n=n.multiply(this._minus90X),t.setDeltaRotation(this._plus90X)),t.type===e.PhysicsEngine.HeightmapImpostor){var o=i,s=o.rotationQuaternion;o.rotationQuaternion=this._tmpUnityRotation,o.computeWorldMatrix(!0);var a=r.clone(),h=o.getPivotMatrix()||e.Matrix.Translation(0,0,0);o.rotationQuaternion=s;var c=e.Matrix.Translation(o.getBoundingInfo().boundingBox.extendSize.x,0,-o.getBoundingInfo().boundingBox.extendSize.z);o.setPivotMatrix(c),o.computeWorldMatrix(!0);var l=o.getBoundingInfo().boundingBox.center.subtract(r).subtract(o.position).negate();this._tmpPosition.copyFromFloats(l.x,l.y-o.getBoundingInfo().boundingBox.extendSize.y,l.z),this._tmpDeltaPosition.copyFrom(o.getBoundingInfo().boundingBox.center.subtract(a)),this._tmpDeltaPosition.y+=o.getBoundingInfo().boundingBox.extendSize.y,o.setPivotMatrix(h),o.computeWorldMatrix(!0)}else t.type===e.PhysicsEngine.MeshImpostor&&(this._tmpDeltaPosition.copyFromFloats(0,0,0),this._tmpPosition.copyFrom(i.position));t.setDeltaPosition(this._tmpDeltaPosition),t.physicsBody.position.copy(this._tmpPosition),t.physicsBody.quaternion.copy(n)},t.prototype.setTransformationFromPhysicsBody=function(e){e.object.position.copyFrom(e.physicsBody.position),e.object.rotationQuaternion.copyFrom(e.physicsBody.quaternion)},t.prototype.setPhysicsBodyTransformation=function(e,t,i){e.physicsBody.position.copy(t),e.physicsBody.quaternion.copy(i)},t.prototype.isSupported=function(){return void 0!==window.CANNON},t.prototype.setLinearVelocity=function(e,t){e.physicsBody.velocity.copy(t)},t.prototype.setAngularVelocity=function(e,t){e.physicsBody.angularVelocity.copy(t)},t.prototype.getLinearVelocity=function(t){var i=t.physicsBody.velocity;return i?new e.Vector3(i.x,i.y,i.z):null},t.prototype.getAngularVelocity=function(t){var i=t.physicsBody.angularVelocity;return i?new e.Vector3(i.x,i.y,i.z):null},t.prototype.setBodyMass=function(e,t){e.physicsBody.mass=t,e.physicsBody.updateMassProperties()},t.prototype.sleepBody=function(e){e.physicsBody.sleep()},t.prototype.wakeUpBody=function(e){e.physicsBody.wakeUp()},t.prototype.updateDistanceJoint=function(e,t,i){e.physicsJoint.distance=t},t.prototype.enableMotor=function(e,t){t||e.physicsJoint.enableMotor()},t.prototype.disableMotor=function(e,t){t||e.physicsJoint.disableMotor()},t.prototype.setMotor=function(e,t,i,r){r||(e.physicsJoint.enableMotor(),e.physicsJoint.setMotorSpeed(t),i&&this.setLimit(e,i))},t.prototype.setLimit=function(e,t,i){e.physicsJoint.motorEquation.maxForce=t,e.physicsJoint.motorEquation.minForce=void 0===i?-t:i},t.prototype.dispose=function(){},t}();e.CannonJSPlugin=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(t){this.name="OimoJSPlugin",this._tmpImpostorsArray=[],this._tmpPositionVector=e.Vector3.Zero(),this.world=new OIMO.World(1/60,2,t,!0),this.world.clear(),this.world.isNoStat=!0}return t.prototype.setGravity=function(e){this.world.gravity.copy(e)},t.prototype.setTimeStep=function(e){this.world.timeStep=e},t.prototype.executeStep=function(e,t){var i=this;t.forEach(function(e){e.beforeStep()}),this.world.step(),t.forEach(function(e){e.afterStep(),i._tmpImpostorsArray[e.uniqueId]=e});for(var r=this.world.contacts;null!==r;)if(!r.touching||r.body1.sleeping||r.body2.sleeping){var n=this._tmpImpostorsArray[+r.body1.name],o=this._tmpImpostorsArray[+r.body2.name];n&&o?(n.onCollide({body:o.physicsBody}),o.onCollide({body:n.physicsBody}),r=r.next):r=r.next}else r=r.next},t.prototype.applyImpulse=function(e,t,i){var r=e.physicsBody.massInfo.mass;e.physicsBody.applyImpulse(i.scale(OIMO.INV_SCALE),t.scale(OIMO.INV_SCALE*r))},t.prototype.applyForce=function(t,i,r){e.Tools.Warn("Oimo doesn't support applying force. Using impule instead."),this.applyImpulse(t,i,r)},t.prototype.generatePhysicsBody=function(t){function i(e){e.getChildMeshes&&e.getChildMeshes().forEach(function(e){e.physicsImpostor&&(s.push(e.physicsImpostor),e.physicsImpostor._init())})}function r(t){return Math.max(t,e.PhysicsEngine.Epsilon)}var n=this;if(t.parent)return void(t.physicsBody&&(this.removePhysicsBody(t),t.forceUpdate()));if(t.isBodyInitRequired()){var o={name:t.uniqueId,config:[t.getParam("mass")||1,t.getParam("friction"),t.getParam("restitution")],size:[],type:[],pos:[],rot:[],move:0!==t.getParam("mass"),world:this.world},s=[t];i(t.object),s.forEach(function(i){var s=i.object.rotationQuaternion,a=(new OIMO.Euler).setFromQuaternion({x:t.object.rotationQuaternion.x,y:t.object.rotationQuaternion.y,z:t.object.rotationQuaternion.z,s:t.object.rotationQuaternion.w}),h=i.getObjectExtendSize();if(i===t){var c=t.getObjectCenter();t.object.position.subtractToRef(c,n._tmpPositionVector),o.pos.push(c.x),o.pos.push(c.y),o.pos.push(c.z),o.rot.push(a.x/(OIMO.degtorad||OIMO.TO_RAD)),o.rot.push(a.y/(OIMO.degtorad||OIMO.TO_RAD)),o.rot.push(a.z/(OIMO.degtorad||OIMO.TO_RAD))}else o.pos.push(i.object.position.x),o.pos.push(i.object.position.y),o.pos.push(i.object.position.z),o.rot.push(0),o.rot.push(0),o.rot.push(0);switch(i.type){case e.PhysicsImpostor.ParticleImpostor:e.Tools.Warn("No Particle support in Oimo.js. using SphereImpostor instead");case e.PhysicsImpostor.SphereImpostor:var l=h.x,u=h.y,f=h.z,d=Math.max(r(l),r(u),r(f))/2;o.type.push("sphere"),o.size.push(d),o.size.push(d),o.size.push(d);break;case e.PhysicsImpostor.CylinderImpostor:var p=r(h.x)/2,_=r(h.y);o.type.push("cylinder"),o.size.push(p),o.size.push(_),o.size.push(_);break;case e.PhysicsImpostor.PlaneImpostor:case e.PhysicsImpostor.BoxImpostor:default:var p=r(h.x),_=r(h.y),m=r(h.z);o.type.push("box"),o.size.push(p),o.size.push(_),o.size.push(m)}i.object.rotationQuaternion=s}),t.physicsBody=new OIMO.Body(o).body}else this._tmpPositionVector.copyFromFloats(0,0,0);t.setDeltaPosition(this._tmpPositionVector)},t.prototype.removePhysicsBody=function(e){this.world.removeRigidBody(e.physicsBody)},t.prototype.generateJoint=function(t){var i=t.mainImpostor.physicsBody,r=t.connectedImpostor.physicsBody;if(i&&r){var n,o=t.joint.jointData,s=o.nativeParams||{},a={body1:i,body2:r,axe1:s.axe1||(o.mainAxis?o.mainAxis.asArray():null),axe2:s.axe2||(o.connectedAxis?o.connectedAxis.asArray():null),pos1:s.pos1||(o.mainPivot?o.mainPivot.asArray():null),pos2:s.pos2||(o.connectedPivot?o.connectedPivot.asArray():null),min:s.min,max:s.max,collision:s.collision||o.collision,spring:s.spring,world:this.world};switch(t.joint.type){case e.PhysicsJoint.BallAndSocketJoint:n="jointBall";break;case e.PhysicsJoint.SpringJoint:e.Tools.Warn("Oimo.js doesn't support Spring Constraint. Simulating using DistanceJoint instead");var h=o;a.min=h.length||a.min,a.max=Math.max(a.min,a.max);case e.PhysicsJoint.DistanceJoint:n="jointDistance",a.max=o.maxDistance;break;case e.PhysicsJoint.PrismaticJoint:n="jointPrisme";break;case e.PhysicsJoint.SliderJoint:n="jointSlide";break;case e.PhysicsJoint.WheelJoint:n="jointWheel";break;case e.PhysicsJoint.HingeJoint:default:n="jointHinge"}a.type=n,t.joint.physicsJoint=new OIMO.Link(a).joint}},t.prototype.removeJoint=function(t){try{this.world.removeJoint(t.joint.physicsJoint)}catch(i){e.Tools.Warn(i)}},t.prototype.isSupported=function(){return void 0!==OIMO},t.prototype.setTransformationFromPhysicsBody=function(e){if(!e.physicsBody.sleeping){if(e.physicsBody.shapes.next){var t=this._getLastShape(e.physicsBody);e.object.position.x=t.position.x*OIMO.WORLD_SCALE,e.object.position.y=t.position.y*OIMO.WORLD_SCALE,e.object.position.z=t.position.z*OIMO.WORLD_SCALE}else e.object.position.copyFrom(e.physicsBody.getPosition());e.object.rotationQuaternion.copyFrom(e.physicsBody.getQuaternion()),e.object.rotationQuaternion.normalize()}},t.prototype.setPhysicsBodyTransformation=function(e,t,i){var r=e.physicsBody;r.position.init(t.x*OIMO.INV_SCALE,t.y*OIMO.INV_SCALE,t.z*OIMO.INV_SCALE),r.orientation.init(i.w,i.x,i.y,i.z),r.syncShapes(),r.awake()},t.prototype._getLastShape=function(e){for(var t=e.shapes;t.next;)t=t.next;return t},t.prototype.setLinearVelocity=function(e,t){e.physicsBody.linearVelocity.init(t.x,t.y,t.z)},t.prototype.setAngularVelocity=function(e,t){e.physicsBody.angularVelocity.init(t.x,t.y,t.z)},t.prototype.getLinearVelocity=function(t){var i=t.physicsBody.linearVelocity;return i?new e.Vector3(i.x,i.y,i.z):null},t.prototype.getAngularVelocity=function(t){var i=t.physicsBody.angularVelocity;return i?new e.Vector3(i.x,i.y,i.z):null},t.prototype.setBodyMass=function(e,t){var i=0===t;e.physicsBody.shapes.density=i?1:t,e.physicsBody.setupMass(i?2:1)},t.prototype.sleepBody=function(e){e.physicsBody.sleep()},t.prototype.wakeUpBody=function(e){e.physicsBody.awake()},t.prototype.updateDistanceJoint=function(e,t,i){e.physicsJoint.limitMotoe.upperLimit=t,void 0!==i&&(e.physicsJoint.limitMotoe.lowerLimit=i)},t.prototype.setMotor=function(e,t,i,r){var n=r?e.physicsJoint.rotationalLimitMotor2:e.physicsJoint.rotationalLimitMotor1||e.physicsJoint.rotationalLimitMotor||e.physicsJoint.limitMotor;n&&n.setMotor(t,i)},t.prototype.setLimit=function(e,t,i,r){var n=r?e.physicsJoint.rotationalLimitMotor2:e.physicsJoint.rotationalLimitMotor1||e.physicsJoint.rotationalLimitMotor||e.physicsJoint.limitMotor;n&&n.setLimit(t,void 0===i?-t:i)},t.prototype.dispose=function(){this.world.clear()},t}();e.OimoJSPlugin=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(e){function t(t,i,r,n,o,s){e.call(this,t,"displayPass",["passSampler"],["passSampler"],i,r,n,o,s)}return __extends(t,e),t}(e.PostProcess);e.DisplayPassPostProcess=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function e(e,t,i){this.quality=e,this.distance=t,this.optimizeMesh=i}return e}();e.SimplificationSettings=t;var i=function(){function t(){this.running=!1,this._simplificationArray=[]}return t.prototype.addTask=function(e){this._simplificationArray.push(e)},t.prototype.executeNext=function(){var e=this._simplificationArray.pop();e?(this.running=!0,this.runSimplification(e)):this.running=!1},t.prototype.runSimplification=function(t){var i=this;if(t.parallelProcessing)t.settings.forEach(function(e){var r=i.getSimplifier(t);r.simplify(e,function(r){t.mesh.addLODLevel(e.distance,r),r.isVisible=!0,e.quality===t.settings[t.settings.length-1].quality&&t.successCallback&&t.successCallback(),i.executeNext()})});else{var r=this.getSimplifier(t),n=function(e,i){r.simplify(e,function(r){t.mesh.addLODLevel(e.distance,r),r.isVisible=!0,i()})};e.AsyncLoop.Run(t.settings.length,function(e){n(t.settings[e.index],function(){e.executeNext()})},function(){t.successCallback&&t.successCallback(),i.executeNext()})}},t.prototype.getSimplifier=function(e){switch(e.simplificationType){case r.QUADRATIC:default:return new h(e.mesh)}},t}();e.SimplificationQueue=i,function(e){e[e.QUADRATIC=0]="QUADRATIC"}(e.SimplificationType||(e.SimplificationType={}));var r=e.SimplificationType,n=function(){function e(e){this.vertices=e,this.error=new Array(4),this.deleted=!1,this.isDirty=!1,this.deletePending=!1,this.borderFactor=0}return e}();e.DecimationTriangle=n;var o=function(){function e(e,t){this.position=e,this.id=t,this.isBorder=!0,this.q=new s,this.triangleCount=0,this.triangleStart=0,this.originalOffsets=[]}return e.prototype.updatePosition=function(e){this.position.copyFrom(e)},e}();e.DecimationVertex=o;var s=function(){function e(e){this.data=new Array(10);for(var t=0;10>t;++t)e&&e[t]?this.data[t]=e[t]:this.data[t]=0}return e.prototype.det=function(e,t,i,r,n,o,s,a,h){var c=this.data[e]*this.data[n]*this.data[h]+this.data[i]*this.data[r]*this.data[a]+this.data[t]*this.data[o]*this.data[s]-this.data[i]*this.data[n]*this.data[s]-this.data[e]*this.data[o]*this.data[a]-this.data[t]*this.data[r]*this.data[h];return c},e.prototype.addInPlace=function(e){for(var t=0;10>t;++t)this.data[t]+=e.data[t]},e.prototype.addArrayInPlace=function(e){for(var t=0;10>t;++t)this.data[t]+=e[t]},e.prototype.add=function(t){for(var i=new e,r=0;10>r;++r)i.data[r]=this.data[r]+t.data[r];return i},e.FromData=function(t,i,r,n){return new e(e.DataFromNumbers(t,i,r,n))},e.DataFromNumbers=function(e,t,i,r){return[e*e,e*t,e*i,e*r,t*t,t*i,t*r,i*i,i*r,r*r]},e}();e.QuadraticMatrix=s;var a=function(){function e(e,t){this.vertexId=e,this.triangleId=t}return e}();e.Reference=a;var h=function(){function t(t){this._mesh=t,this.initialized=!1,this.syncIterations=5e3,this.aggressiveness=7,this.decimationIterations=100,this.boundingBoxEpsilon=e.Epsilon}return t.prototype.simplify=function(t,i){var r=this;this.initDecimatedMesh(),e.AsyncLoop.Run(this._mesh.subMeshes.length,function(e){r.initWithMesh(e.index,function(){r.runDecimation(t,e.index,function(){e.executeNext()})},t.optimizeMesh)},function(){setTimeout(function(){i(r._reconstructedMesh)},0)})},t.prototype.isTriangleOnBoundingBox=function(e){var t=this,i=0;return e.vertices.forEach(function(e){var r=0,n=e.position,o=t._mesh.getBoundingInfo().boundingBox;(o.maximum.x-n.x<t.boundingBoxEpsilon||n.x-o.minimum.x>t.boundingBoxEpsilon)&&++r,o.maximum.y!==n.y&&n.y!==o.minimum.y||++r,o.maximum.z!==n.z&&n.z!==o.minimum.z||++r,r>1&&++i}),i>1&&console.log(e,i),i>1},t.prototype.runDecimation=function(t,i,r){var n=this,o=~~(this.triangles.length*t.quality),s=0,a=this.triangles.length,h=function(t,i){setTimeout(function(){t%5===0&&n.updateMesh(0===t);for(var r=0;r<n.triangles.length;++r)n.triangles[r].isDirty=!1;var h=1e-9*Math.pow(t+3,n.aggressiveness),c=function(t){var i=~~((n.triangles.length/2+t)%n.triangles.length),r=n.triangles[i];if(r&&!(r.error[3]>h||r.deleted||r.isDirty))for(var o=0;3>o;++o)if(r.error[o]<h){var a=[],c=[],l=r.vertices[o],u=r.vertices[(o+1)%3];if(l.isBorder||u.isBorder)continue;var f=e.Vector3.Zero(),d=e.Vector3.Zero(),p=e.Vector2.Zero(),_=new e.Color4(0,0,0,1);n.calculateError(l,u,f,d,p,_);var m=[];if(n.isFlipped(l,u,f,a,r.borderFactor,m))continue;if(n.isFlipped(u,l,f,c,r.borderFactor,m))continue;if(a.indexOf(!0)<0||c.indexOf(!0)<0)continue;var g=[];if(m.forEach(function(e){-1===g.indexOf(e)&&(e.deletePending=!0,g.push(e))}),g.length%2!==0)continue;l.q=u.q.add(l.q),l.updatePosition(f);var v=n.references.length;s=n.updateTriangles(l,l,a,s),s=n.updateTriangles(l,u,c,s);var y=n.references.length-v;if(y<=l.triangleCount){if(y)for(var x=0;y>x;x++)n.references[l.triangleStart+x]=n.references[v+x]}else l.triangleStart=v;l.triangleCount=y;break}};e.AsyncLoop.SyncAsyncForLoop(n.triangles.length,n.syncIterations,c,i,function(){return o>=a-s})},0)};e.AsyncLoop.Run(this.decimationIterations,function(e){o>=a-s?e.breakLoop():h(e.index,function(){e.executeNext()})},function(){setTimeout(function(){n.reconstructMesh(i),r()},0)})},t.prototype.initWithMesh=function(t,i,r){var s=this;this.vertices=[],this.triangles=[];var a=this._mesh.getVerticesData(e.VertexBuffer.PositionKind),h=this._mesh.getIndices(),c=this._mesh.subMeshes[t],l=function(e){if(r)for(var t=0;t<s.vertices.length;++t)if(s.vertices[t].position.equals(e))return s.vertices[t];return null},u=[],f=function(t){var i=t+c.verticesStart,r=e.Vector3.FromArray(a,3*i),n=l(r)||new o(r,s.vertices.length);n.originalOffsets.push(i),n.id===s.vertices.length&&s.vertices.push(n),u.push(n.id)},d=c.verticesCount;e.AsyncLoop.SyncAsyncForLoop(d,this.syncIterations/4>>0,f,function(){var t=function(e){var t=c.indexStart/3+e,i=3*t,r=h[i+0],o=h[i+1],a=h[i+2],l=s.vertices[u[r-c.verticesStart]],f=s.vertices[u[o-c.verticesStart]],d=s.vertices[u[a-c.verticesStart]],p=new n([l,f,d]);p.originalOffset=i,s.triangles.push(p)};e.AsyncLoop.SyncAsyncForLoop(c.indexCount/3,s.syncIterations,t,function(){s.init(i)})})},t.prototype.init=function(t){var i=this,r=function(t){var r=i.triangles[t];r.normal=e.Vector3.Cross(r.vertices[1].position.subtract(r.vertices[0].position),r.vertices[2].position.subtract(r.vertices[0].position)).normalize();
for(var n=0;3>n;n++)r.vertices[n].q.addArrayInPlace(s.DataFromNumbers(r.normal.x,r.normal.y,r.normal.z,-e.Vector3.Dot(r.normal,r.vertices[0].position)))};e.AsyncLoop.SyncAsyncForLoop(this.triangles.length,this.syncIterations,r,function(){var r=function(e){for(var t=i.triangles[e],r=0;3>r;++r)t.error[r]=i.calculateError(t.vertices[r],t.vertices[(r+1)%3]);t.error[3]=Math.min(t.error[0],t.error[1],t.error[2])};e.AsyncLoop.SyncAsyncForLoop(i.triangles.length,i.syncIterations,r,function(){i.initialized=!0,t()})})},t.prototype.reconstructMesh=function(t){var i,r=[];for(i=0;i<this.vertices.length;++i)this.vertices[i].triangleCount=0;var n,o;for(i=0;i<this.triangles.length;++i)if(!this.triangles[i].deleted){for(n=this.triangles[i],o=0;3>o;++o)n.vertices[o].triangleCount=1;r.push(n)}var s=this._reconstructedMesh.getVerticesData(e.VertexBuffer.PositionKind)||[],a=this._reconstructedMesh.getVerticesData(e.VertexBuffer.NormalKind)||[],h=this._reconstructedMesh.getVerticesData(e.VertexBuffer.UVKind)||[],c=this._reconstructedMesh.getVerticesData(e.VertexBuffer.ColorKind)||[],l=this._mesh.getVerticesData(e.VertexBuffer.NormalKind),u=this._mesh.getVerticesData(e.VertexBuffer.UVKind),f=this._mesh.getVerticesData(e.VertexBuffer.ColorKind),d=0;for(i=0;i<this.vertices.length;++i){var p=this.vertices[i];p.id=d,p.triangleCount&&p.originalOffsets.forEach(function(e){s.push(p.position.x),s.push(p.position.y),s.push(p.position.z),a.push(l[3*e]),a.push(l[3*e+1]),a.push(l[3*e+2]),u&&u.length?(h.push(u[2*e]),h.push(u[2*e+1])):f&&f.length&&(c.push(f[4*e]),c.push(f[4*e+1]),c.push(f[4*e+2]),c.push(f[4*e+3])),++d})}var _=this._reconstructedMesh.getTotalIndices(),m=this._reconstructedMesh.getTotalVertices(),g=this._reconstructedMesh.subMeshes;this._reconstructedMesh.subMeshes=[];var v=this._reconstructedMesh.getIndices(),y=this._mesh.getIndices();for(i=0;i<r.length;++i)n=r[i],[0,1,2].forEach(function(e){var t=y[n.originalOffset+e],i=n.vertices[e].originalOffsets.indexOf(t);0>i&&(i=0),v.push(n.vertices[e].id+i+m)});this._reconstructedMesh.setIndices(v),this._reconstructedMesh.setVerticesData(e.VertexBuffer.PositionKind,s),this._reconstructedMesh.setVerticesData(e.VertexBuffer.NormalKind,a),h.length>0&&this._reconstructedMesh.setVerticesData(e.VertexBuffer.UVKind,h),c.length>0&&this._reconstructedMesh.setVerticesData(e.VertexBuffer.ColorKind,c);var x=this._mesh.subMeshes[t];if(t>0){this._reconstructedMesh.subMeshes=[],g.forEach(function(t){new e.SubMesh(t.materialIndex,t.verticesStart,t.verticesCount,t.indexStart,t.indexCount,t.getMesh())});new e.SubMesh(x.materialIndex,m,d,_,3*r.length,this._reconstructedMesh)}},t.prototype.initDecimatedMesh=function(){this._reconstructedMesh=new e.Mesh(this._mesh.name+"Decimated",this._mesh.getScene()),this._reconstructedMesh.material=this._mesh.material,this._reconstructedMesh.parent=this._mesh.parent,this._reconstructedMesh.isVisible=!1,this._reconstructedMesh.renderingGroupId=this._mesh.renderingGroupId},t.prototype.isFlipped=function(t,i,r,n,o,s){for(var a=0;a<t.triangleCount;++a){var h=this.triangles[this.references[t.triangleStart+a].triangleId];if(!h.deleted){var c=this.references[t.triangleStart+a].vertexId,l=h.vertices[(c+1)%3],u=h.vertices[(c+2)%3];if(l!==i&&u!==i){var f=l.position.subtract(r);f=f.normalize();var d=u.position.subtract(r);if(d=d.normalize(),Math.abs(e.Vector3.Dot(f,d))>.999)return!0;var p=e.Vector3.Cross(f,d).normalize();if(n[a]=!1,e.Vector3.Dot(p,h.normal)<.2)return!0}else n[a]=!0,s.push(h)}}return!1},t.prototype.updateTriangles=function(e,t,i,r){for(var n=r,o=0;o<t.triangleCount;++o){var s=this.references[t.triangleStart+o],a=this.triangles[s.triangleId];a.deleted||(i[o]&&a.deletePending?(a.deleted=!0,n++):(a.vertices[s.vertexId]=e,a.isDirty=!0,a.error[0]=this.calculateError(a.vertices[0],a.vertices[1])+a.borderFactor/2,a.error[1]=this.calculateError(a.vertices[1],a.vertices[2])+a.borderFactor/2,a.error[2]=this.calculateError(a.vertices[2],a.vertices[0])+a.borderFactor/2,a.error[3]=Math.min(a.error[0],a.error[1],a.error[2]),this.references.push(s)))}return n},t.prototype.identifyBorder=function(){for(var e=0;e<this.vertices.length;++e){var t,i=[],r=[],n=this.vertices[e];for(t=0;t<n.triangleCount;++t)for(var o=this.triangles[this.references[n.triangleStart+t].triangleId],s=0;3>s;s++){for(var a=0,h=o.vertices[s];a<i.length&&r[a]!==h.id;)++a;a===i.length?(i.push(1),r.push(h.id)):i[a]++}for(t=0;t<i.length;++t)1===i[t]?this.vertices[r[t]].isBorder=!0:this.vertices[r[t]].isBorder=!1}},t.prototype.updateMesh=function(e){void 0===e&&(e=!1);var t;if(!e){var i=[];for(t=0;t<this.triangles.length;++t)this.triangles[t].deleted||i.push(this.triangles[t]);this.triangles=i}for(t=0;t<this.vertices.length;++t)this.vertices[t].triangleCount=0,this.vertices[t].triangleStart=0;var r,n,o;for(t=0;t<this.triangles.length;++t)for(r=this.triangles[t],n=0;3>n;++n)o=r.vertices[n],o.triangleCount++;var s=0;for(t=0;t<this.vertices.length;++t)this.vertices[t].triangleStart=s,s+=this.vertices[t].triangleCount,this.vertices[t].triangleCount=0;var h=new Array(3*this.triangles.length);for(t=0;t<this.triangles.length;++t)for(r=this.triangles[t],n=0;3>n;++n)o=r.vertices[n],h[o.triangleStart+o.triangleCount]=new a(n,t),o.triangleCount++;this.references=h,e&&this.identifyBorder()},t.prototype.vertexError=function(e,t){var i=t.x,r=t.y,n=t.z;return e.data[0]*i*i+2*e.data[1]*i*r+2*e.data[2]*i*n+2*e.data[3]*i+e.data[4]*r*r+2*e.data[5]*r*n+2*e.data[6]*r+e.data[7]*n*n+2*e.data[8]*n+e.data[9]},t.prototype.calculateError=function(t,i,r,n,o,s){var a=t.q.add(i.q),h=t.isBorder&&i.isBorder,c=0,l=a.det(0,1,2,1,4,5,2,5,7);if(0===l||h){var u=t.position.add(i.position).divide(new e.Vector3(2,2,2)),f=this.vertexError(a,t.position),d=this.vertexError(a,i.position),p=this.vertexError(a,u);c=Math.min(f,d,p),c===f?r&&r.copyFrom(t.position):c===d?r&&r.copyFrom(i.position):r&&r.copyFrom(u)}else r||(r=e.Vector3.Zero()),r.x=-1/l*a.det(1,2,3,4,5,6,5,7,8),r.y=1/l*a.det(0,2,3,1,5,6,2,7,8),r.z=-1/l*a.det(0,1,3,1,4,6,2,5,8),c=this.vertexError(a,r);return c},t}();e.QuadraticErrorSimplification=h}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=[],i=function(i,r){if(!t[i.id]){if(i instanceof e.Geometry.Primitives.Box)r.boxes.push(i.serialize());else if(i instanceof e.Geometry.Primitives.Sphere)r.spheres.push(i.serialize());else if(i instanceof e.Geometry.Primitives.Cylinder)r.cylinders.push(i.serialize());else if(i instanceof e.Geometry.Primitives.Torus)r.toruses.push(i.serialize());else if(i instanceof e.Geometry.Primitives.Ground)r.grounds.push(i.serialize());else if(i instanceof e.Geometry.Primitives.Plane)r.planes.push(i.serialize());else if(i instanceof e.Geometry.Primitives.TorusKnot)r.torusKnots.push(i.serialize());else{if(i instanceof e.Geometry.Primitives._Primitive)throw new Error("Unknown primitive type");r.vertexData.push(i.serializeVerticeData())}t[i.id]=!0}},r=function(t,r){var n={};n.name=t.name,n.id=t.id,e.Tags.HasTags(t)&&(n.tags=e.Tags.GetTags(t)),n.position=t.position.asArray(),t.rotationQuaternion?n.rotationQuaternion=t.rotationQuaternion.asArray():t.rotation&&(n.rotation=t.rotation.asArray()),n.scaling=t.scaling.asArray(),n.localMatrix=t.getPivotMatrix().asArray(),n.isEnabled=t.isEnabled(),n.isVisible=t.isVisible,n.infiniteDistance=t.infiniteDistance,n.pickable=t.isPickable,n.receiveShadows=t.receiveShadows,n.billboardMode=t.billboardMode,n.visibility=t.visibility,n.checkCollisions=t.checkCollisions,t.parent&&(n.parentId=t.parent.id);var o=t._geometry;if(o){var s=o.id;n.geometryId=s,t.getScene().getGeometryByID(s)||i(o,r.geometries),n.subMeshes=[];for(var a=0;a<t.subMeshes.length;a++){var h=t.subMeshes[a];n.subMeshes.push({materialIndex:h.materialIndex,verticesStart:h.verticesStart,verticesCount:h.verticesCount,indexStart:h.indexStart,indexCount:h.indexCount})}}t.material?n.materialId=t.material.id:t.material=null,t.skeleton&&(n.skeletonId=t.skeleton.id),t.getPhysicsImpostor()&&(n.physicsMass=t.getPhysicsMass(),n.physicsFriction=t.getPhysicsFriction(),n.physicsRestitution=t.getPhysicsRestitution(),n.physicsImpostor=t.getPhysicsImpostor().type),n.instances=[];for(var c=0;c<t.instances.length;c++){var l=t.instances[c],u={name:l.name,position:l.position.asArray(),scaling:l.scaling.asArray()};l.rotationQuaternion?u.rotationQuaternion=l.rotationQuaternion.asArray():l.rotation&&(u.rotation=l.rotation.asArray()),n.instances.push(u),e.Animation.AppendSerializedAnimations(l,u),u.ranges=l.serializeAnimationRanges()}return e.Animation.AppendSerializedAnimations(t,n),n.ranges=t.serializeAnimationRanges(),n.layerMask=t.layerMask,t.actionManager&&(n.actions=t.actionManager.serialize(t.name)),n},n=function(t,n){if(t.delayLoadState===e.Engine.DELAYLOADSTATE_LOADED||t.delayLoadState===e.Engine.DELAYLOADSTATE_NONE){t.material&&(t.material instanceof e.StandardMaterial?(n.materials=n.materials||[],n.materials.some(function(e){return e.id===t.material.id})||n.materials.push(t.material.serialize())):t.material instanceof e.MultiMaterial&&(n.multiMaterials=n.multiMaterials||[],n.multiMaterials.some(function(e){return e.id===t.material.id})||n.multiMaterials.push(t.material.serialize())));var o=t._geometry;o&&(n.geometries||(n.geometries={},n.geometries.boxes=[],n.geometries.spheres=[],n.geometries.cylinders=[],n.geometries.toruses=[],n.geometries.grounds=[],n.geometries.planes=[],n.geometries.torusKnots=[],n.geometries.vertexData=[]),i(o,n.geometries)),t.skeleton&&(n.skeletons=n.skeletons||[],n.skeletons.push(t.skeleton.serialize())),n.meshes=n.meshes||[],n.meshes.push(r(t,n))}},o=function(){function o(){}return o.ClearCache=function(){t=[]},o.Serialize=function(n){var o={};o.useDelayedTextureLoading=n.useDelayedTextureLoading,o.autoClear=n.autoClear,o.clearColor=n.clearColor.asArray(),o.ambientColor=n.ambientColor.asArray(),o.gravity=n.gravity.asArray(),o.collisionsEnabled=n.collisionsEnabled,o.workerCollisions=n.workerCollisions,n.fogMode&&0!==n.fogMode&&(o.fogMode=n.fogMode,o.fogColor=n.fogColor.asArray(),o.fogStart=n.fogStart,o.fogEnd=n.fogEnd,o.fogDensity=n.fogDensity),n.isPhysicsEnabled()&&(o.physicsEnabled=!0,o.physicsGravity=n.getPhysicsEngine().gravity.asArray(),o.physicsEngine=n.getPhysicsEngine().getPhysicsPluginName()),o.lights=[];var s,a;for(s=0;s<n.lights.length;s++)a=n.lights[s],o.lights.push(a.serialize());for(o.cameras=[],s=0;s<n.cameras.length;s++){var h=n.cameras[s];o.cameras.push(h.serialize())}n.activeCamera&&(o.activeCameraID=n.activeCamera.id),e.Animation.AppendSerializedAnimations(n,o),o.materials=[],o.multiMaterials=[];var c;for(s=0;s<n.materials.length;s++)c=n.materials[s],o.materials.push(c.serialize());for(o.multiMaterials=[],s=0;s<n.multiMaterials.length;s++){var l=n.multiMaterials[s];o.multiMaterials.push(l.serialize())}for(o.skeletons=[],s=0;s<n.skeletons.length;s++)o.skeletons.push(n.skeletons[s].serialize());o.geometries={},o.geometries.boxes=[],o.geometries.spheres=[],o.geometries.cylinders=[],o.geometries.toruses=[],o.geometries.grounds=[],o.geometries.planes=[],o.geometries.torusKnots=[],o.geometries.vertexData=[],t=[];var u=n.getGeometries();for(s=0;s<u.length;s++){var f=u[s];f.isReady()&&i(f,o.geometries)}for(o.meshes=[],s=0;s<n.meshes.length;s++){var d=n.meshes[s];if(d instanceof e.Mesh){var p=d;p.delayLoadState!==e.Engine.DELAYLOADSTATE_LOADED&&p.delayLoadState!==e.Engine.DELAYLOADSTATE_NONE||o.meshes.push(r(p,o))}}for(o.particleSystems=[],s=0;s<n.particleSystems.length;s++)o.particleSystems.push(n.particleSystems[s].serialize());for(o.lensFlareSystems=[],s=0;s<n.lensFlareSystems.length;s++)o.lensFlareSystems.push(n.lensFlareSystems[s].serialize());for(o.shadowGenerators=[],s=0;s<n.lights.length;s++)a=n.lights[s],a.getShadowGenerator()&&o.shadowGenerators.push(a.getShadowGenerator().serialize());return n.actionManager&&(o.actions=n.actionManager.serialize("scene")),o},o.SerializeMesh=function(t,i,r){void 0===i&&(i=!1),void 0===r&&(r=!1);var o={};if(t=t instanceof Array?t:[t],i||r)for(var s=0;s<t.length;++s)r&&t[s].getDescendants().forEach(function(i){i instanceof e.Mesh&&t.indexOf(i)<0&&t.push(i)}),i&&t[s].parent&&t.indexOf(t[s].parent)<0&&t.push(t[s].parent);return t.forEach(function(e){n(e,o)}),o},o}();e.SceneSerializer=o}(BABYLON||(BABYLON={}));var Earcut;!function(e){function t(e,t,r){r=r||2;var o=t&&t.length,s=o?t[0]*r:e.length,a=i(e,0,s,r,!0),h=[];if(!a)return h;var l,u,f,d,p,_,m;if(o&&(a=c(e,t,a,r)),e.length>80*r){l=f=e[0],u=d=e[1];for(var g=r;s>g;g+=r)p=e[g],_=e[g+1],l>p&&(l=p),u>_&&(u=_),p>f&&(f=p),_>d&&(d=_);m=Math.max(f-l,d-u)}return n(a,h,r,l,u,m,void 0),h}function i(e,t,i,r,n){var o,s;if(n===D(e,t,i,r)>0)for(o=t;i>o;o+=r)s=C(o,e[o],e[o+1],s);else for(o=i-r;o>=t;o-=r)s=C(o,e[o],e[o+1],s);return s&&x(s,s.next)&&(S(s),s=s.next),s}function r(e,t){if(!e)return e;t||(t=e);var i,r=e;do if(i=!1,r.steiner||!x(r,r.next)&&0!==y(r.prev,r,r.next))r=r.next;else{if(S(r),r=t=r.prev,r===r.next)return null;i=!0}while(i||r!==t);return t}function n(e,t,i,c,l,u,f){if(e){!f&&u&&d(e,c,l,u);for(var p,_,m=e;e.prev!==e.next;)if(p=e.prev,_=e.next,u?s(e,c,l,u):o(e))t.push(p.i/i),t.push(e.i/i),t.push(_.i/i),S(e),e=_.next,m=_.next;else if(e=_,e===m){f?1===f?(e=a(e,t,i),n(e,t,i,c,l,u,2)):2===f&&h(e,t,i,c,l,u):n(r(e,void 0),t,i,c,l,u,1);break}}}function o(e){var t=e.prev,i=e,r=e.next;if(y(t,i,r)>=0)return!1;for(var n=e.next.next;n!==e.prev;){if(g(t.x,t.y,i.x,i.y,r.x,r.y,n.x,n.y)&&y(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function s(e,t,i,r){var n=e.prev,o=e,s=e.next;if(y(n,o,s)>=0)return!1;for(var a=n.x<o.x?n.x<s.x?n.x:s.x:o.x<s.x?o.x:s.x,h=n.y<o.y?n.y<s.y?n.y:s.y:o.y<s.y?o.y:s.y,c=n.x>o.x?n.x>s.x?n.x:s.x:o.x>s.x?o.x:s.x,l=n.y>o.y?n.y>s.y?n.y:s.y:o.y>s.y?o.y:s.y,u=_(a,h,t,i,r),f=_(c,l,t,i,r),d=e.nextZ;d&&d.z<=f;){if(d!==e.prev&&d!==e.next&&g(n.x,n.y,o.x,o.y,s.x,s.y,d.x,d.y)&&y(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(d=e.prevZ;d&&d.z>=u;){if(d!==e.prev&&d!==e.next&&g(n.x,n.y,o.x,o.y,s.x,s.y,d.x,d.y)&&y(d.prev,d,d.next)>=0)return!1;d=d.prevZ}return!0}function a(e,t,i){var r=e;do{var n=r.prev,o=r.next.next;!x(n,o)&&b(n,r,r.next,o)&&A(n,o)&&A(o,n)&&(t.push(n.i/i),t.push(r.i/i),t.push(o.i/i),S(r),S(r.next),r=e=o),r=r.next}while(r!==e);return r}function h(e,t,i,o,s,a){var h=e;do{for(var c=h.next.next;c!==h.prev;){if(h.i!==c.i&&v(h,c)){var l=E(h,c);return h=r(h,h.next),l=r(l,l.next),n(h,t,i,o,s,a,void 0),void n(l,t,i,o,s,a,void 0)}c=c.next}h=h.next}while(h!==e)}function c(e,t,n,o){var s,a,h,c,f,d=[];for(s=0,a=t.length;a>s;s++)h=t[s]*o,c=a-1>s?t[s+1]*o:e.length,f=i(e,h,c,o,!1),f===f.next&&(f.steiner=!0),d.push(m(f));for(d.sort(l),s=0;s<d.length;s++)u(d[s],n),n=r(n,n.next);return n}function l(e,t){return e.x-t.x}function u(e,t){if(t=f(e,t)){var i=E(t,e);r(i,i.next)}}function f(e,t){var i,r=t,n=e.x,o=e.y,s=-(1/0);do{if(o<=r.y&&o>=r.next.y){var a=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(n>=a&&a>s){if(s=a,a===n){if(o===r.y)return r;if(o===r.next.y)return r.next}i=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!i)return null;if(n===s)return i.prev;var h,c=i,l=i.x,u=i.y,f=1/0;for(r=i.next;r!==c;)n>=r.x&&r.x>=l&&g(u>o?n:s,o,l,u,u>o?s:n,o,r.x,r.y)&&(h=Math.abs(o-r.y)/(n-r.x),(f>h||h===f&&r.x>i.x)&&A(r,e)&&(i=r,f=h)),r=r.next;return i}function d(e,t,i,r){var n=e;do null===n.z&&(n.z=_(n.x,n.y,t,i,r)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==e);n.prevZ.nextZ=null,n.prevZ=null,p(n)}function p(e){var t,i,r,n,o,s,a,h,c=1;do{for(i=e,e=null,o=null,s=0;i;){for(s++,r=i,a=0,t=0;c>t&&(a++,r=r.nextZ,r);t++);for(h=c;a>0||h>0&&r;)0===a?(n=r,r=r.nextZ,h--):0!==h&&r?i.z<=r.z?(n=i,i=i.nextZ,a--):(n=r,r=r.nextZ,h--):(n=i,i=i.nextZ,a--),o?o.nextZ=n:e=n,n.prevZ=o,o=n;i=r}o.nextZ=null,c*=2}while(s>1);return e}function _(e,t,i,r,n){return e=32767*(e-i)/n,t=32767*(t-r)/n,e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e|t<<1}function m(e){var t=e,i=e;do t.x<i.x&&(i=t),t=t.next;while(t!==e);return i}function g(e,t,i,r,n,o,s,a){return(n-s)*(t-a)-(e-s)*(o-a)>=0&&(e-s)*(r-a)-(i-s)*(t-a)>=0&&(i-s)*(o-a)-(n-s)*(r-a)>=0}function v(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!P(e,t)&&A(e,t)&&A(t,e)&&T(e,t)}function y(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function x(e,t){return e.x===t.x&&e.y===t.y}function b(e,t,i,r){return x(e,t)&&x(i,r)||x(e,r)&&x(i,t)?!0:y(e,t,i)>0!=y(e,t,r)>0&&y(i,r,e)>0!=y(i,r,t)>0}function P(e,t){var i=e;do{if(i.i!==e.i&&i.next.i!==e.i&&i.i!==t.i&&i.next.i!==t.i&&b(i,i.next,e,t))return!0;i=i.next}while(i!==e);return!1}function A(e,t){return y(e.prev,e,e.next)<0?y(e,t,e.next)>=0&&y(e,e.prev,t)>=0:y(e,t,e.prev)<0||y(e,e.next,t)<0}function T(e,t){var i=e,r=!1,n=(e.x+t.x)/2,o=(e.y+t.y)/2;do i.y>o!=i.next.y>o&&n<(i.next.x-i.x)*(o-i.y)/(i.next.y-i.y)+i.x&&(r=!r),i=i.next;while(i!==e);return r}function E(e,t){var i=new M(e.i,e.x,e.y),r=new M(t.i,t.x,t.y),n=e.next,o=t.prev;return e.next=t,t.prev=e,i.next=n,n.prev=i,r.next=i,i.prev=r,o.next=r,r.prev=o,r}function C(e,t,i,r){var n=new M(e,t,i);return r?(n.next=r.next,n.prev=r,r.next.prev=n,r.next=n):(n.prev=n,n.next=n),n}function S(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function M(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function I(e,t,i,r){var n=t&&t.length,o=n?t[0]*i:e.length,s=Math.abs(D(e,0,o,i));if(n)for(var a=0,h=t.length;h>a;a++){var c=t[a]*i,l=h-1>a?t[a+1]*i:e.length;s-=Math.abs(D(e,c,l,i))}var u=0;for(a=0;a<r.length;a+=3){var f=r[a]*i,d=r[a+1]*i,p=r[a+2]*i;u+=Math.abs((e[f]-e[p])*(e[d+1]-e[f+1])-(e[f]-e[d])*(e[p+1]-e[f+1]))}return 0===s&&0===u?0:Math.abs((u-s)/s)}function D(e,t,i,r){for(var n=0,o=t,s=i-r;i>o;o+=r)n+=(e[s]-e[o])*(e[o+1]+e[s+1]),s=o;return n}function R(e){for(var t=e[0][0].length,i={vertices:[],holes:[],dimensions:t},r=0,n=0;n<e.length;n++){for(var o=0;o<e[n].length;o++)for(var s=0;t>s;s++)i.vertices.push(e[n][o][s]);n>0&&(r+=e[n-1].length,i.holes.push(r))}return i}e.earcut=t,e.deviation=I,e.flatten=R}(Earcut||(Earcut={}));var BABYLON;!function(e){var t=0,i=function(){function t(e,t,i){this.pos=e,this.normal=t,this.uv=i}return t.prototype.clone=function(){return new t(this.pos.clone(),this.normal.clone(),this.uv.clone())},t.prototype.flip=function(){this.normal=this.normal.scale(-1)},t.prototype.interpolate=function(i,r){return new t(e.Vector3.Lerp(this.pos,i.pos,r),e.Vector3.Lerp(this.normal,i.normal,r),e.Vector2.Lerp(this.uv,i.uv,r))},t}(),r=function(){function t(e,t){this.normal=e,this.w=t}return t.FromPoints=function(i,r,n){var o=n.subtract(i),s=r.subtract(i);if(0===o.lengthSquared()||0===s.lengthSquared())return null;var a=e.Vector3.Normalize(e.Vector3.Cross(o,s));return new t(a,e.Vector3.Dot(a,i))},t.prototype.clone=function(){return new t(this.normal.clone(),this.w)},t.prototype.flip=function(){this.normal.scaleInPlace(-1),this.w=-this.w},t.prototype.splitPolygon=function(i,r,o,s,a){var h,c,l=0,u=1,f=2,d=3,p=0,_=[];for(h=0;h<i.vertices.length;h++){c=e.Vector3.Dot(this.normal,i.vertices[h].pos)-this.w;var m=c<-t.EPSILON?f:c>t.EPSILON?u:l;p|=m,_.push(m)}switch(p){case l:(e.Vector3.Dot(this.normal,i.plane.normal)>0?r:o).push(i);break;case u:s.push(i);break;case f:a.push(i);break;case d:var g=[],v=[];for(h=0;h<i.vertices.length;h++){var y=(h+1)%i.vertices.length,x=_[h],b=_[y],P=i.vertices[h],A=i.vertices[y];if(x!==f&&g.push(P),x!==u&&v.push(x!==f?P.clone():P),(x|b)===d){c=(this.w-e.Vector3.Dot(this.normal,P.pos))/e.Vector3.Dot(this.normal,A.pos.subtract(P.pos));var T=P.interpolate(A,c);g.push(T),v.push(T.clone())}}var E;g.length>=3&&(E=new n(g,i.shared),E.plane&&s.push(E)),v.length>=3&&(E=new n(v,i.shared),E.plane&&a.push(E))}},t.EPSILON=1e-5,t}(),n=function(){function e(e,t){this.vertices=e,this.shared=t,this.plane=r.FromPoints(e[0].pos,e[1].pos,e[2].pos)}return e.prototype.clone=function(){var t=this.vertices.map(function(e){return e.clone()});return new e(t,this.shared)},e.prototype.flip=function(){this.vertices.reverse().map(function(e){e.flip()}),this.plane.flip()},e}(),o=function(){function e(e){this.plane=null,this.front=null,this.back=null,this.polygons=[],e&&this.build(e)}return e.prototype.clone=function(){var t=new e;return t.plane=this.plane&&this.plane.clone(),t.front=this.front&&this.front.clone(),t.back=this.back&&this.back.clone(),t.polygons=this.polygons.map(function(e){return e.clone()}),t},e.prototype.invert=function(){for(var e=0;e<this.polygons.length;e++)this.polygons[e].flip();this.plane&&this.plane.flip(),this.front&&this.front.invert(),this.back&&this.back.invert();var t=this.front;this.front=this.back,this.back=t},e.prototype.clipPolygons=function(e){if(!this.plane)return e.slice();for(var t=[],i=[],r=0;r<e.length;r++)this.plane.splitPolygon(e[r],t,i,t,i);return this.front&&(t=this.front.clipPolygons(t)),i=this.back?this.back.clipPolygons(i):[],t.concat(i)},e.prototype.clipTo=function(e){this.polygons=e.clipPolygons(this.polygons),this.front&&this.front.clipTo(e),this.back&&this.back.clipTo(e)},e.prototype.allPolygons=function(){var e=this.polygons.slice();return this.front&&(e=e.concat(this.front.allPolygons())),this.back&&(e=e.concat(this.back.allPolygons())),e},e.prototype.build=function(t){if(t.length){this.plane||(this.plane=t[0].plane.clone());for(var i=[],r=[],n=0;n<t.length;n++)this.plane.splitPolygon(t[n],this.polygons,this.polygons,i,r);i.length&&(this.front||(this.front=new e),this.front.build(i)),r.length&&(this.back||(this.back=new e),this.back.build(r))}},e}(),s=function(){function r(){this.polygons=new Array}return r.FromMesh=function(o){var s,a,h,c,l,u,f,d,p,_,m,g=new Array;if(!(o instanceof e.Mesh))throw"BABYLON.CSG: Wrong Mesh type, must be BABYLON.Mesh";o.computeWorldMatrix(!0),f=o.getWorldMatrix(),d=o.position.clone(),p=o.rotation.clone(),o.rotationQuaternion&&(_=o.rotationQuaternion.clone()),m=o.scaling.clone();for(var v=o.getIndices(),y=o.getVerticesData(e.VertexBuffer.PositionKind),x=o.getVerticesData(e.VertexBuffer.NormalKind),b=o.getVerticesData(e.VertexBuffer.UVKind),P=o.subMeshes,A=0,T=P.length;T>A;A++)for(var E=P[A].indexStart,C=P[A].indexCount+P[A].indexStart;C>E;E+=3){u=[];for(var S=0;3>S;S++){var M=new e.Vector3(x[3*v[E+S]],x[3*v[E+S]+1],x[3*v[E+S]+2]);h=new e.Vector2(b[2*v[E+S]],b[2*v[E+S]+1]);var I=new e.Vector3(y[3*v[E+S]],y[3*v[E+S]+1],y[3*v[E+S]+2]);c=e.Vector3.TransformCoordinates(I,f),a=e.Vector3.TransformNormal(M,f),s=new i(c,a,h),u.push(s)}l=new n(u,{subMeshId:A,meshId:t,materialIndex:P[A].materialIndex}),l.plane&&g.push(l)}var D=r.FromPolygons(g);return D.matrix=f,D.position=d,D.rotation=p,D.scaling=m,D.rotationQuaternion=_,t++,D},r.FromPolygons=function(e){var t=new r;return t.polygons=e,t},r.prototype.clone=function(){var e=new r;return e.polygons=this.polygons.map(function(e){return e.clone()}),e.copyTransformAttributes(this),e},r.prototype.toPolygons=function(){return this.polygons},r.prototype.union=function(e){var t=new o(this.clone().polygons),i=new o(e.clone().polygons);return t.clipTo(i),i.clipTo(t),i.invert(),i.clipTo(t),i.invert(),t.build(i.allPolygons()),r.FromPolygons(t.allPolygons()).copyTransformAttributes(this)},r.prototype.unionInPlace=function(e){var t=new o(this.polygons),i=new o(e.polygons);t.clipTo(i),i.clipTo(t),i.invert(),i.clipTo(t),i.invert(),t.build(i.allPolygons()),this.polygons=t.allPolygons()},r.prototype.subtract=function(e){var t=new o(this.clone().polygons),i=new o(e.clone().polygons);return t.invert(),t.clipTo(i),i.clipTo(t),i.invert(),i.clipTo(t),i.invert(),t.build(i.allPolygons()),t.invert(),r.FromPolygons(t.allPolygons()).copyTransformAttributes(this)},r.prototype.subtractInPlace=function(e){var t=new o(this.polygons),i=new o(e.polygons);t.invert(),t.clipTo(i),i.clipTo(t),i.invert(),i.clipTo(t),i.invert(),t.build(i.allPolygons()),t.invert(),this.polygons=t.allPolygons()},r.prototype.intersect=function(e){var t=new o(this.clone().polygons),i=new o(e.clone().polygons);return t.invert(),i.clipTo(t),i.invert(),t.clipTo(i),i.clipTo(t),t.build(i.allPolygons()),t.invert(),r.FromPolygons(t.allPolygons()).copyTransformAttributes(this)},r.prototype.intersectInPlace=function(e){var t=new o(this.polygons),i=new o(e.polygons);t.invert(),i.clipTo(t),i.invert(),t.clipTo(i),i.clipTo(t),t.build(i.allPolygons()),t.invert(),this.polygons=t.allPolygons()},r.prototype.inverse=function(){var e=this.clone();return e.inverseInPlace(),e},r.prototype.inverseInPlace=function(){this.polygons.map(function(e){e.flip()})},r.prototype.copyTransformAttributes=function(e){return this.matrix=e.matrix,this.position=e.position,this.rotation=e.rotation,this.scaling=e.scaling,this.rotationQuaternion=e.rotationQuaternion,this},r.prototype.buildMeshGeometry=function(t,i,r){var n=this.matrix.clone();n.invert();var o,s,a,h=new e.Mesh(t,i),c=[],l=[],u=[],f=[],d=e.Vector3.Zero(),p=e.Vector3.Zero(),_=e.Vector2.Zero(),m=this.polygons,g=[0,0,0],v={},y=0,x={};r&&m.sort(function(e,t){return e.shared.meshId===t.shared.meshId?e.shared.subMeshId-t.shared.subMeshId:e.shared.meshId-t.shared.meshId});for(var b=0,P=m.length;P>b;b++){o=m[b],x[o.shared.meshId]||(x[o.shared.meshId]={}),x[o.shared.meshId][o.shared.subMeshId]||(x[o.shared.meshId][o.shared.subMeshId]={indexStart:+(1/0),indexEnd:-(1/0),materialIndex:o.shared.materialIndex}),a=x[o.shared.meshId][o.shared.subMeshId];for(var A=2,T=o.vertices.length;T>A;A++){g[0]=0,g[1]=A-1,g[2]=A;for(var E=0;3>E;E++){d.copyFrom(o.vertices[g[E]].pos),p.copyFrom(o.vertices[g[E]].normal),_.copyFrom(o.vertices[g[E]].uv);var C=e.Vector3.TransformCoordinates(d,n),S=e.Vector3.TransformNormal(p,n);s=v[C.x+","+C.y+","+C.z],"undefined"!=typeof s&&u[3*s]===S.x&&u[3*s+1]===S.y&&u[3*s+2]===S.z&&f[2*s]===_.x&&f[2*s+1]===_.y||(c.push(C.x,C.y,C.z),f.push(_.x,_.y),u.push(p.x,p.y,p.z),s=v[C.x+","+C.y+","+C.z]=c.length/3-1),l.push(s),a.indexStart=Math.min(y,a.indexStart),a.indexEnd=Math.max(y,a.indexEnd),y++}}}if(h.setVerticesData(e.VertexBuffer.PositionKind,c),h.setVerticesData(e.VertexBuffer.NormalKind,u),h.setVerticesData(e.VertexBuffer.UVKind,f),h.setIndices(l),r){var M,I=0;h.subMeshes=new Array;for(var D in x){M=-1;for(var R in x[D])a=x[D][R],e.SubMesh.CreateFromIndices(a.materialIndex+I,a.indexStart,a.indexEnd-a.indexStart+1,h),M=Math.max(a.materialIndex,M);I+=++M}}return h},r.prototype.toMesh=function(e,t,i,r){var n=this.buildMeshGeometry(e,i,r);return n.material=t,n.position.copyFrom(this.position),n.rotation.copyFrom(this.rotation),this.rotationQuaternion&&(n.rotationQuaternion=this.rotationQuaternion.clone()),n.scaling.copyFrom(this.scaling),n.computeWorldMatrix(!0),n},r}();e.CSG=s}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(i,r,n,o){var s=this;t.call(this,i,"vrDistortionCorrection",["LensCenter","Scale","ScaleIn","HmdWarpParam"],null,o.postProcessScaleFactor,r,e.Texture.BILINEAR_SAMPLINGMODE,null,null),this._isRightEye=n,this._distortionFactors=o.distortionK,this._postProcessScaleFactor=o.postProcessScaleFactor,this._lensCenterOffset=o.lensCenterOffset,this.onSizeChangedObservable.add(function(){s.aspectRatio=.5*s.width/s.height,s._scaleIn=new e.Vector2(2,2/s.aspectRatio),s._scaleFactor=new e.Vector2(.5*(1/s._postProcessScaleFactor),.5*(1/s._postProcessScaleFactor)*s.aspectRatio),s._lensCenter=new e.Vector2(s._isRightEye?.5-.5*s._lensCenterOffset:.5+.5*s._lensCenterOffset,.5)}),this.onApplyObservable.add(function(e){e.setFloat2("LensCenter",s._lensCenter.x,s._lensCenter.y),e.setFloat2("Scale",s._scaleFactor.x,s._scaleFactor.y),e.setFloat2("ScaleIn",s._scaleIn.x,s._scaleIn.y),e.setFloat4("HmdWarpParam",s._distortionFactors[0],s._distortionFactors[1],s._distortionFactors[2],s._distortionFactors[3])})}return __extends(i,t),i}(e.PostProcess);e.VRDistortionCorrectionPostProcess=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){!function(e){e[e.X=0]="X",e[e.Y=1]="Y",e[e.Z=2]="Z"}(e.JoystickAxis||(e.JoystickAxis={}));var t=e.JoystickAxis,i=function(){function i(r){var n=this;r?this._leftJoystick=!0:this._leftJoystick=!1,this._joystickIndex=i._globalJoystickIndex,i._globalJoystickIndex++,this._axisTargetedByLeftAndRight=t.X,this._axisTargetedByUpAndDown=t.Y,this.reverseLeftRight=!1,this.reverseUpDown=!1,this._touches=new e.StringDictionary,this.deltaPosition=e.Vector3.Zero(),this._joystickSensibility=25,this._inversedSensibility=1/(this._joystickSensibility/1e3),this._rotationSpeed=25,this._inverseRotationSpeed=1/(this._rotationSpeed/1e3),this._rotateOnAxisRelativeToMesh=!1,this._onResize=function(e){i.vjCanvasWidth=window.innerWidth,i.vjCanvasHeight=window.innerHeight,i.vjCanvas.width=i.vjCanvasWidth,i.vjCanvas.height=i.vjCanvasHeight,i.halfWidth=i.vjCanvasWidth/2,i.halfHeight=i.vjCanvasHeight/2},i.vjCanvas||(window.addEventListener("resize",this._onResize,!1),i.vjCanvas=document.createElement("canvas"),i.vjCanvasWidth=window.innerWidth,i.vjCanvasHeight=window.innerHeight,i.vjCanvas.width=window.innerWidth,i.vjCanvas.height=window.innerHeight,i.vjCanvas.style.width="100%",i.vjCanvas.style.height="100%",i.vjCanvas.style.position="absolute",i.vjCanvas.style.backgroundColor="transparent",i.vjCanvas.style.top="0px",i.vjCanvas.style.left="0px",i.vjCanvas.style.zIndex="5",i.vjCanvas.style.msTouchAction="none",i.vjCanvas.setAttribute("touch-action","none"),i.vjCanvasContext=i.vjCanvas.getContext("2d"),i.vjCanvasContext.strokeStyle="#ffffff",i.vjCanvasContext.lineWidth=2,document.body.appendChild(i.vjCanvas)),i.halfWidth=i.vjCanvas.width/2,i.halfHeight=i.vjCanvas.height/2,this.pressed=!1,this._joystickColor="cyan",this._joystickPointerID=-1,this._joystickPointerPos=new e.Vector2(0,0),this._joystickPreviousPointerPos=new e.Vector2(0,0),this._joystickPointerStartPos=new e.Vector2(0,0),this._deltaJoystickVector=new e.Vector2(0,0),this._onPointerDownHandlerRef=function(e){n._onPointerDown(e)},this._onPointerMoveHandlerRef=function(e){n._onPointerMove(e)},this._onPointerOutHandlerRef=function(e){n._onPointerUp(e)},this._onPointerUpHandlerRef=function(e){n._onPointerUp(e)},i.vjCanvas.addEventListener("pointerdown",this._onPointerDownHandlerRef,!1),i.vjCanvas.addEventListener("pointermove",this._onPointerMoveHandlerRef,!1),i.vjCanvas.addEventListener("pointerup",this._onPointerUpHandlerRef,!1),i.vjCanvas.addEventListener("pointerout",this._onPointerUpHandlerRef,!1),i.vjCanvas.addEventListener("contextmenu",function(e){e.preventDefault()},!1),requestAnimationFrame(function(){n._drawVirtualJoystick()})}return i.prototype.setJoystickSensibility=function(e){this._joystickSensibility=e,this._inversedSensibility=1/(this._joystickSensibility/1e3)},i.prototype._onPointerDown=function(e){var t;e.preventDefault(),t=this._leftJoystick===!0?e.clientX<i.halfWidth:e.clientX>i.halfWidth,t&&this._joystickPointerID<0?(this._joystickPointerID=e.pointerId,this._joystickPointerStartPos.x=e.clientX,this._joystickPointerStartPos.y=e.clientY,this._joystickPointerPos=this._joystickPointerStartPos.clone(),this._joystickPreviousPointerPos=this._joystickPointerStartPos.clone(),this._deltaJoystickVector.x=0,this._deltaJoystickVector.y=0,this.pressed=!0,this._touches.add(e.pointerId.toString(),e)):i._globalJoystickIndex<2&&this._action&&(this._action(),this._touches.add(e.pointerId.toString(),{x:e.clientX,y:e.clientY,prevX:e.clientX,prevY:e.clientY}))},i.prototype._onPointerMove=function(e){if(this._joystickPointerID==e.pointerId){this._joystickPointerPos.x=e.clientX,this._joystickPointerPos.y=e.clientY,this._deltaJoystickVector=this._joystickPointerPos.clone(),this._deltaJoystickVector=this._deltaJoystickVector.subtract(this._joystickPointerStartPos);var i=this.reverseLeftRight?-1:1,r=i*this._deltaJoystickVector.x/this._inversedSensibility;switch(this._axisTargetedByLeftAndRight){case t.X:this.deltaPosition.x=Math.min(1,Math.max(-1,r));break;case t.Y:this.deltaPosition.y=Math.min(1,Math.max(-1,r));break;case t.Z:this.deltaPosition.z=Math.min(1,Math.max(-1,r))}var n=this.reverseUpDown?1:-1,o=n*this._deltaJoystickVector.y/this._inversedSensibility;switch(this._axisTargetedByUpAndDown){case t.X:this.deltaPosition.x=Math.min(1,Math.max(-1,o));break;case t.Y:this.deltaPosition.y=Math.min(1,Math.max(-1,o));
break;case t.Z:this.deltaPosition.z=Math.min(1,Math.max(-1,o))}}else{var s=this._touches.get(e.pointerId.toString());s&&(s.x=e.clientX,s.y=e.clientY)}},i.prototype._onPointerUp=function(e){if(this._joystickPointerID==e.pointerId)i.vjCanvasContext.clearRect(this._joystickPointerStartPos.x-63,this._joystickPointerStartPos.y-63,126,126),i.vjCanvasContext.clearRect(this._joystickPreviousPointerPos.x-41,this._joystickPreviousPointerPos.y-41,82,82),this._joystickPointerID=-1,this.pressed=!1;else{var t=this._touches.get(e.pointerId.toString());t&&i.vjCanvasContext.clearRect(t.prevX-43,t.prevY-43,86,86)}this._deltaJoystickVector.x=0,this._deltaJoystickVector.y=0,this._touches.remove(e.pointerId.toString())},i.prototype.setJoystickColor=function(e){this._joystickColor=e},i.prototype.setActionOnTouch=function(e){this._action=e},i.prototype.setAxisForLeftRight=function(e){switch(e){case t.X:case t.Y:case t.Z:this._axisTargetedByLeftAndRight=e;break;default:this._axisTargetedByLeftAndRight=t.X}},i.prototype.setAxisForUpDown=function(e){switch(e){case t.X:case t.Y:case t.Z:this._axisTargetedByUpAndDown=e;break;default:this._axisTargetedByUpAndDown=t.Y}},i.prototype._clearCanvas=function(){this._leftJoystick?i.vjCanvasContext.clearRect(0,0,i.vjCanvasWidth/2,i.vjCanvasHeight):i.vjCanvasContext.clearRect(i.vjCanvasWidth/2,0,i.vjCanvasWidth,i.vjCanvasHeight)},i.prototype._drawVirtualJoystick=function(){var e=this;this.pressed&&this._touches.forEach(function(t){t.pointerId===e._joystickPointerID?(i.vjCanvasContext.clearRect(e._joystickPointerStartPos.x-63,e._joystickPointerStartPos.y-63,126,126),i.vjCanvasContext.clearRect(e._joystickPreviousPointerPos.x-41,e._joystickPreviousPointerPos.y-41,82,82),i.vjCanvasContext.beginPath(),i.vjCanvasContext.lineWidth=6,i.vjCanvasContext.strokeStyle=e._joystickColor,i.vjCanvasContext.arc(e._joystickPointerStartPos.x,e._joystickPointerStartPos.y,40,0,2*Math.PI,!0),i.vjCanvasContext.stroke(),i.vjCanvasContext.closePath(),i.vjCanvasContext.beginPath(),i.vjCanvasContext.strokeStyle=e._joystickColor,i.vjCanvasContext.lineWidth=2,i.vjCanvasContext.arc(e._joystickPointerStartPos.x,e._joystickPointerStartPos.y,60,0,2*Math.PI,!0),i.vjCanvasContext.stroke(),i.vjCanvasContext.closePath(),i.vjCanvasContext.beginPath(),i.vjCanvasContext.strokeStyle=e._joystickColor,i.vjCanvasContext.arc(e._joystickPointerPos.x,e._joystickPointerPos.y,40,0,2*Math.PI,!0),i.vjCanvasContext.stroke(),i.vjCanvasContext.closePath(),e._joystickPreviousPointerPos=e._joystickPointerPos.clone()):(i.vjCanvasContext.clearRect(t.prevX-43,t.prevY-43,86,86),i.vjCanvasContext.beginPath(),i.vjCanvasContext.fillStyle="white",i.vjCanvasContext.beginPath(),i.vjCanvasContext.strokeStyle="red",i.vjCanvasContext.lineWidth=6,i.vjCanvasContext.arc(t.x,t.y,40,0,2*Math.PI,!0),i.vjCanvasContext.stroke(),i.vjCanvasContext.closePath(),t.prevX=t.x,t.prevY=t.y)}),requestAnimationFrame(function(){e._drawVirtualJoystick()})},i.prototype.releaseCanvas=function(){i.vjCanvas&&(i.vjCanvas.removeEventListener("pointerdown",this._onPointerDownHandlerRef),i.vjCanvas.removeEventListener("pointermove",this._onPointerMoveHandlerRef),i.vjCanvas.removeEventListener("pointerup",this._onPointerUpHandlerRef),i.vjCanvas.removeEventListener("pointerout",this._onPointerUpHandlerRef),window.removeEventListener("resize",this._onResize),document.body.removeChild(i.vjCanvas),i.vjCanvas=null)},i._globalJoystickIndex=0,i}();e.VirtualJoystick=i}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(e){function t(t,i,r){e.call(this,t,i,r),this.inputs.addVirtualJoystick()}return __extends(t,e),t}(e.FreeCamera);e.VirtualJoysticksCamera=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(){}return t.prototype.getLeftJoystick=function(){return this._leftjoystick},t.prototype.getRightJoystick=function(){return this._rightjoystick},t.prototype.checkInputs=function(){if(this._leftjoystick){var t=this.camera,i=50*t._computeLocalCameraSpeed(),r=e.Matrix.RotationYawPitchRoll(t.rotation.y,t.rotation.x,0),n=e.Vector3.TransformCoordinates(new e.Vector3(this._leftjoystick.deltaPosition.x*i,this._leftjoystick.deltaPosition.y*i,this._leftjoystick.deltaPosition.z*i),r);t.cameraDirection=t.cameraDirection.add(n),t.cameraRotation=t.cameraRotation.addVector3(this._rightjoystick.deltaPosition),this._leftjoystick.pressed||(this._leftjoystick.deltaPosition=this._leftjoystick.deltaPosition.scale(.9)),this._rightjoystick.pressed||(this._rightjoystick.deltaPosition=this._rightjoystick.deltaPosition.scale(.9))}},t.prototype.attachControl=function(t,i){this._leftjoystick=new e.VirtualJoystick(!0),this._leftjoystick.setAxisForUpDown(e.JoystickAxis.Z),this._leftjoystick.setAxisForLeftRight(e.JoystickAxis.X),this._leftjoystick.setJoystickSensibility(.15),this._rightjoystick=new e.VirtualJoystick(!1),this._rightjoystick.setAxisForUpDown(e.JoystickAxis.X),this._rightjoystick.setAxisForLeftRight(e.JoystickAxis.Y),this._rightjoystick.reverseUpDown=!0,this._rightjoystick.setJoystickSensibility(.05),this._rightjoystick.setJoystickColor("yellow")},t.prototype.detachControl=function(e){this._leftjoystick.releaseCanvas(),this._rightjoystick.releaseCanvas()},t.prototype.getTypeName=function(){return"FreeCameraVirtualJoystickInput"},t.prototype.getSimpleName=function(){return"virtualJoystick"},t}();e.FreeCameraVirtualJoystickInput=t,e.CameraInputTypes.FreeCameraVirtualJoystickInput=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(e){function t(t,i,r,n,o,s){var a=this;e.call(this,t,"anaglyph",null,["leftSampler"],i,r[1],n,o,s),this._passedProcess=r[0]._rigPostProcess,this.onApplyObservable.add(function(e){e.setTextureFromPostProcess("leftSampler",a._passedProcess)})}return __extends(t,e),t}(e.PostProcess);e.AnaglyphPostProcess=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(e){this._scene=e}return t.prototype.render=function(t,i,r){var n=this;void 0===r&&(r=!1);var o=this._scene,s=this._scene.getEngine(),a=null!==s.getCaps().instancedArrays&&null!==i.visibleInstances[t._id]&&void 0!==i.visibleInstances[t._id];if(this.isReady(t,a)){var h=t.getRenderingMesh(),c=t.getMaterial();if(s.enableEffect(this._effect),this._effect.setFloat("offset",r?0:h.outlineWidth),this._effect.setColor4("color",r?h.overlayColor:h.outlineColor,r?h.overlayAlpha:1),this._effect.setMatrix("viewProjection",o.getTransformMatrix()),h.useBones&&h.computeBonesUsingShaders&&this._effect.setMatrices("mBones",h.skeleton.getTransformMatrices(h)),h._bind(t,this._effect,e.Material.TriangleFillMode),c&&c.needAlphaTesting()){var l=c.getAlphaTestTexture();this._effect.setTexture("diffuseSampler",l),this._effect.setMatrix("diffuseMatrix",l.getTextureMatrix())}h._processRendering(t,this._effect,e.Material.TriangleFillMode,i,a,function(e,t){n._effect.setMatrix("world",t)})}},t.prototype.isReady=function(t,i){var r=[],n=[e.VertexBuffer.PositionKind,e.VertexBuffer.NormalKind],o=t.getMesh(),s=t.getMaterial();s&&s.needAlphaTesting()&&(r.push("#define ALPHATEST"),o.isVerticesDataPresent(e.VertexBuffer.UVKind)&&(n.push(e.VertexBuffer.UVKind),r.push("#define UV1")),o.isVerticesDataPresent(e.VertexBuffer.UV2Kind)&&(n.push(e.VertexBuffer.UV2Kind),r.push("#define UV2"))),o.useBones&&o.computeBonesUsingShaders?(n.push(e.VertexBuffer.MatricesIndicesKind),n.push(e.VertexBuffer.MatricesWeightsKind),o.numBoneInfluencers>4&&(n.push(e.VertexBuffer.MatricesIndicesExtraKind),n.push(e.VertexBuffer.MatricesWeightsExtraKind)),r.push("#define NUM_BONE_INFLUENCERS "+o.numBoneInfluencers),r.push("#define BonesPerMesh "+(o.skeleton.bones.length+1))):r.push("#define NUM_BONE_INFLUENCERS 0"),i&&(r.push("#define INSTANCES"),n.push("world0"),n.push("world1"),n.push("world2"),n.push("world3"));var a=r.join("\n");return this._cachedDefines!==a&&(this._cachedDefines=a,this._effect=this._scene.getEngine().createEffect("outline",n,["world","mBones","viewProjection","diffuseMatrix","offset","color"],["diffuseSampler"],a)),this._effect.isReady()},t}();e.OutlineRenderer=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(e,t,i,r){this.name=e,this.meshesNames=t,this.rootUrl=i,this.sceneFilename=r,this.isCompleted=!1}return t.prototype.run=function(t,i,r){var n=this;e.SceneLoader.ImportMesh(this.meshesNames,this.rootUrl,this.sceneFilename,t,function(e,t,r){n.loadedMeshes=e,n.loadedParticleSystems=t,n.loadedSkeletons=r,n.isCompleted=!0,n.onSuccess&&n.onSuccess(n),i()},null,function(){n.onError&&n.onError(n),r()})},t}();e.MeshAssetTask=t;var i=function(){function t(e,t){this.name=e,this.url=t,this.isCompleted=!1}return t.prototype.run=function(t,i,r){var n=this;e.Tools.LoadFile(this.url,function(e){n.text=e,n.isCompleted=!0,n.onSuccess&&n.onSuccess(n),i()},null,t.database,!1,function(){n.onError&&n.onError(n),r()})},t}();e.TextFileAssetTask=i;var r=function(){function t(e,t){this.name=e,this.url=t,this.isCompleted=!1}return t.prototype.run=function(t,i,r){var n=this;e.Tools.LoadFile(this.url,function(e){n.data=e,n.isCompleted=!0,n.onSuccess&&n.onSuccess(n),i()},null,t.database,!0,function(){n.onError&&n.onError(n),r()})},t}();e.BinaryFileAssetTask=r;var n=function(){function e(e,t){this.name=e,this.url=t,this.isCompleted=!1}return e.prototype.run=function(e,t,i){var r=this,n=new Image;n.onload=function(){r.image=n,r.isCompleted=!0,r.onSuccess&&r.onSuccess(r),t()},n.onerror=function(){r.onError&&r.onError(r),i()},n.src=this.url},e}();e.ImageAssetTask=n;var o=function(){function t(t,i,r,n,o){void 0===o&&(o=e.Texture.TRILINEAR_SAMPLINGMODE),this.name=t,this.url=i,this.noMipmap=r,this.invertY=n,this.samplingMode=o,this.isCompleted=!1}return t.prototype.run=function(t,i,r){var n=this,o=function(){n.isCompleted=!0,n.onSuccess&&n.onSuccess(n),i()},s=function(){n.onError&&n.onError(n),r()};this.texture=new e.Texture(this.url,t,this.noMipmap,this.invertY,this.samplingMode,o,s)},t}();e.TextureAssetTask=o;var s=function(){function s(e){this._tasks=new Array,this._waitingTasksCount=0,this.useDefaultLoadingScreen=!0,this._scene=e}return s.prototype.addMeshTask=function(e,i,r,n){var o=new t(e,i,r,n);return this._tasks.push(o),o},s.prototype.addTextFileTask=function(e,t){var r=new i(e,t);return this._tasks.push(r),r},s.prototype.addBinaryFileTask=function(e,t){var i=new r(e,t);return this._tasks.push(i),i},s.prototype.addImageTask=function(e,t){var i=new n(e,t);return this._tasks.push(i),i},s.prototype.addTextureTask=function(t,i,r,n,s){void 0===s&&(s=e.Texture.TRILINEAR_SAMPLINGMODE);var a=new o(t,i,r,n,s);return this._tasks.push(a),a},s.prototype._decreaseWaitingTasksCount=function(){this._waitingTasksCount--,0===this._waitingTasksCount&&(this.onFinish&&this.onFinish(this._tasks),this._scene.getEngine().hideLoadingUI())},s.prototype._runTask=function(e){var t=this;e.run(this._scene,function(){t.onTaskSuccess&&t.onTaskSuccess(e),t._decreaseWaitingTasksCount()},function(){t.onTaskError&&t.onTaskError(e),t._decreaseWaitingTasksCount()})},s.prototype.reset=function(){return this._tasks=new Array,this},s.prototype.load=function(){if(this._waitingTasksCount=this._tasks.length,0===this._waitingTasksCount)return this.onFinish&&this.onFinish(this._tasks),this;this.useDefaultLoadingScreen&&this._scene.getEngine().displayLoadingUI();for(var e=0;e<this._tasks.length;e++){var t=this._tasks[e];this._runTask(t)}return this},s}();e.AssetsManager=s}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(){this.compensateDistortion=!0}return Object.defineProperty(t.prototype,"aspectRatio",{get:function(){return this.hResolution/(2*this.vResolution)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"aspectRatioFov",{get:function(){return 2*Math.atan(this.postProcessScaleFactor*this.vScreenSize/(2*this.eyeToScreenDistance))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"leftHMatrix",{get:function(){var t=this.hScreenSize/4-this.lensSeparationDistance/2,i=4*t/this.hScreenSize;return e.Matrix.Translation(i,0,0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rightHMatrix",{get:function(){var t=this.hScreenSize/4-this.lensSeparationDistance/2,i=4*t/this.hScreenSize;return e.Matrix.Translation(-i,0,0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"leftPreViewMatrix",{get:function(){return e.Matrix.Translation(.5*this.interpupillaryDistance,0,0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rightPreViewMatrix",{get:function(){return e.Matrix.Translation(-.5*this.interpupillaryDistance,0,0)},enumerable:!0,configurable:!0}),t.GetDefault=function(){var e=new t;return e.hResolution=1280,e.vResolution=800,e.hScreenSize=.149759993,e.vScreenSize=.0935999975,e.vScreenCenter=.0467999987,e.eyeToScreenDistance=.0410000011,e.lensSeparationDistance=.063500002,e.interpupillaryDistance=.064000003,e.distortionK=[1,.219999999,.239999995,0],e.chromaAbCorrection=[.995999992,-.00400000019,1.01400006,0],e.postProcessScaleFactor=1.714605507808412,e.lensCenterOffset=.151976421,e},t}();e.VRCameraMetrics=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(i,r,n,o){void 0===o&&(o=!0),t.call(this,i,r,n),this.rotationQuaternion=new e.Quaternion;var s=e.VRCameraMetrics.GetDefault();s.compensateDistortion=o,this.setCameraRigMode(e.Camera.RIG_MODE_VR,{vrCameraMetrics:s}),this.inputs.addDeviceOrientation()}return __extends(i,t),i.prototype.getTypeName=function(){return"VRDeviceOrientationFreeCamera"},i}(e.FreeCamera);e.VRDeviceOrientationFreeCamera=t;var i=function(t){function i(i,r,n,o,s,a,h){void 0===h&&(h=!0),t.call(this,i,r,n,o,s,a);var c=e.VRCameraMetrics.GetDefault();c.compensateDistortion=h,this.setCameraRigMode(e.Camera.RIG_MODE_VR,{vrCameraMetrics:c}),this.inputs.addVRDeviceOrientation()}return __extends(i,t),i.prototype.getTypeName=function(){return"VRDeviceOrientationArcRotateCamera"},i}(e.ArcRotateCamera);e.VRDeviceOrientationArcRotateCamera=i}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(i,r,n,o){void 0===o&&(o=!0),t.call(this,i,r,n),this._hmdDevice=null,this._sensorDevice=null,this._cacheState=null,this._vrEnabled=!1;var s=e.VRCameraMetrics.GetDefault();s.compensateDistortion=o,this.setCameraRigMode(e.Camera.RIG_MODE_VR,{vrCameraMetrics:s}),this._getWebVRDevices=this._getWebVRDevices.bind(this),this.rotationQuaternion=new e.Quaternion}return __extends(i,t),i.prototype._getWebVRDevices=function(e){var t=e.length,i=0;for(this._sensorDevice=null,this._hmdDevice=null;t>i&&null===this._hmdDevice;)e[i]instanceof HMDVRDevice&&(this._hmdDevice=e[i]),i++;for(i=0;t>i&&null===this._sensorDevice;)e[i]instanceof PositionSensorVRDevice&&(!this._hmdDevice||e[i].hardwareUnitId===this._hmdDevice.hardwareUnitId)&&(this._sensorDevice=e[i]),i++;this._vrEnabled=!(!this._sensorDevice||!this._hmdDevice)},i.prototype._checkInputs=function(){this._vrEnabled&&(this._cacheState=this._sensorDevice.getState(),this.rotationQuaternion.copyFrom(this._cacheState.orientation),this.rotationQuaternion.z*=-1,this.rotationQuaternion.w*=-1),t.prototype._checkInputs.call(this)},i.prototype.attachControl=function(i,r){t.prototype.attachControl.call(this,i,r),r=e.Camera.ForceAttachControlToAlwaysPreventDefault?!1:r,navigator.getVRDevices?navigator.getVRDevices().then(this._getWebVRDevices):navigator.mozGetVRDevices&&navigator.mozGetVRDevices(this._getWebVRDevices)},i.prototype.detachControl=function(e){t.prototype.detachControl.call(this,e),this._vrEnabled=!1},i.prototype.requestVRFullscreen=function(e){this._hmdDevice&&this.getEngine().switchFullscreen(e,{vrDisplay:this._hmdDevice})},i.prototype.getTypeName=function(){return"WebVRFreeCamera"},i}(e.FreeCamera);e.WebVRFreeCamera=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function e(e){void 0===e&&(e=0),this.priority=e,this.apply=function(e){return!0}}return e}();e.SceneOptimization=t;var i=function(e){function t(t,i){var r=this;void 0===t&&(t=0),void 0===i&&(i=1024),e.call(this,t),this.priority=t,this.maximumSize=i,this.apply=function(e){for(var t=!0,i=0;i<e.textures.length;i++){var n=e.textures[i];if(n.canRescale){var o=n.getSize(),s=Math.max(o.width,o.height);s>r.maximumSize&&(n.scale(.5),t=!1)}}return t}}return __extends(t,e),t}(t);e.TextureOptimization=i;var r=function(e){function t(t,i){var r=this;void 0===t&&(t=0),void 0===i&&(i=2),e.call(this,t),this.priority=t,this.maximumScale=i,this._currentScale=1,this.apply=function(e){return r._currentScale++,e.getEngine().setHardwareScalingLevel(r._currentScale),r._currentScale>=r.maximumScale}}return __extends(t,e),t}(t);e.HardwareScalingOptimization=r;var n=function(e){function t(){e.apply(this,arguments),this.apply=function(e){return e.shadowsEnabled=!1,!0}}return __extends(t,e),t}(t);e.ShadowsOptimization=n;var o=function(e){function t(){e.apply(this,arguments),this.apply=function(e){return e.postProcessesEnabled=!1,!0}}return __extends(t,e),t}(t);e.PostProcessesOptimization=o;var s=function(e){function t(){e.apply(this,arguments),this.apply=function(e){return e.lensFlaresEnabled=!1,!0}}return __extends(t,e),t}(t);e.LensFlaresOptimization=s;var a=function(e){function t(){e.apply(this,arguments),this.apply=function(e){return e.particlesEnabled=!1,!0}}return __extends(t,e),t}(t);e.ParticlesOptimization=a;var h=function(e){function t(){e.apply(this,arguments),this.apply=function(e){return e.renderTargetsEnabled=!1,!0}}return __extends(t,e),t}(t);e.RenderTargetsOptimization=h;var c=function(t){function i(){var r=this;t.apply(this,arguments),this._canBeMerged=function(t){if(!(t instanceof e.Mesh))return!1;var i=t;return i.isVisible&&i.isEnabled()?i.instances.length>0?!1:i.skeleton||i.hasLODLevels?!1:!i.parent:!1},this.apply=function(t,n){for(var o=t.meshes.slice(0),s=o.length,a=0;s>a;a++){var h=new Array,c=o[a];if(r._canBeMerged(c)){h.push(c);for(var l=a+1;s>l;l++){var u=o[l];r._canBeMerged(u)&&u.material===c.material&&u.checkCollisions===c.checkCollisions&&(h.push(u),s--,o.splice(l,1),l--)}h.length<2||e.Mesh.MergeMeshes(h)}}return void 0!=n?n&&t.createOrUpdateSelectionOctree():i.UpdateSelectionTree&&t.createOrUpdateSelectionOctree(),!0}}return __extends(i,t),Object.defineProperty(i,"UpdateSelectionTree",{get:function(){return i._UpdateSelectionTree},set:function(e){i._UpdateSelectionTree=e},enumerable:!0,configurable:!0}),i._UpdateSelectionTree=!1,i}(t);e.MergeMeshesOptimization=c;var l=function(){function e(e,t){void 0===e&&(e=60),void 0===t&&(t=2e3),this.targetFrameRate=e,this.trackerDuration=t,this.optimizations=new Array}return e.LowDegradationAllowed=function(t){var r=new e(t),h=0;return r.optimizations.push(new c(h)),r.optimizations.push(new n(h)),r.optimizations.push(new s(h)),h++,r.optimizations.push(new o(h)),r.optimizations.push(new a(h)),h++,r.optimizations.push(new i(h,1024)),r},e.ModerateDegradationAllowed=function(t){var l=new e(t),u=0;return l.optimizations.push(new c(u)),l.optimizations.push(new n(u)),l.optimizations.push(new s(u)),u++,l.optimizations.push(new o(u)),l.optimizations.push(new a(u)),u++,l.optimizations.push(new i(u,512)),u++,l.optimizations.push(new h(u)),u++,l.optimizations.push(new r(u,2)),l},e.HighDegradationAllowed=function(t){var l=new e(t),u=0;return l.optimizations.push(new c(u)),l.optimizations.push(new n(u)),l.optimizations.push(new s(u)),u++,l.optimizations.push(new o(u)),l.optimizations.push(new a(u)),u++,l.optimizations.push(new i(u,256)),u++,l.optimizations.push(new h(u)),u++,l.optimizations.push(new r(u,4)),l},e}();e.SceneOptimizerOptions=l;var u=function(){function e(){}return e._CheckCurrentState=function(t,i,r,n,o){if(t.getEngine().getFps()>=i.targetFrameRate)return void(n&&n());for(var s=!0,a=!0,h=0;h<i.optimizations.length;h++){var c=i.optimizations[h];c.priority===r&&(a=!1,s=s&&c.apply(t))}return a?void(o&&o()):(s&&r++,void t.executeWhenReady(function(){setTimeout(function(){e._CheckCurrentState(t,i,r,n,o)},i.trackerDuration)}))},e.OptimizeAsync=function(t,i,r,n){i||(i=l.ModerateDegradationAllowed()),t.executeWhenReady(function(){setTimeout(function(){e._CheckCurrentState(t,i,0,r,n)},i.trackerDuration)})},e}();e.SceneOptimizer=u}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t;!function(e){var t=function(){function e(e,t){this.distance=e,this.mesh=t}return e}();e.MeshLODLevel=t}(t=e.Internals||(e.Internals={}))}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(i,r,n,o,s,a,h,c){void 0===a&&(a=!0),void 0===h&&(h=!1),void 0===c&&(c=e.Texture.TRILINEAR_SAMPLINGMODE),t.call(this,null,s,!a,h),this.format=o,this._texture=s.getEngine().createRawTexture(i,r,n,o,a,h,c),this.wrapU=e.Texture.CLAMP_ADDRESSMODE,this.wrapV=e.Texture.CLAMP_ADDRESSMODE}return __extends(i,t),i.prototype.update=function(e){this.getScene().getEngine().updateRawTexture(this._texture,e,this.format,this._invertY)},i.CreateLuminanceTexture=function(t,r,n,o,s,a,h){return void 0===s&&(s=!0),void 0===a&&(a=!1),void 0===h&&(h=e.Texture.TRILINEAR_SAMPLINGMODE),new i(t,r,n,e.Engine.TEXTUREFORMAT_LUMINANCE,o,s,a,h)},i.CreateLuminanceAlphaTexture=function(t,r,n,o,s,a,h){return void 0===s&&(s=!0),void 0===a&&(a=!1),void 0===h&&(h=e.Texture.TRILINEAR_SAMPLINGMODE),new i(t,r,n,e.Engine.TEXTUREFORMAT_LUMINANCE_ALPHA,o,s,a,h)},i.CreateAlphaTexture=function(t,r,n,o,s,a,h){return void 0===s&&(s=!0),void 0===a&&(a=!1),void 0===h&&(h=e.Texture.TRILINEAR_SAMPLINGMODE),new i(t,r,n,e.Engine.TEXTUREFORMAT_ALPHA,o,s,a,h)},i.CreateRGBTexture=function(t,r,n,o,s,a,h){return void 0===s&&(s=!0),void 0===a&&(a=!1),void 0===h&&(h=e.Texture.TRILINEAR_SAMPLINGMODE),new i(t,r,n,e.Engine.TEXTUREFORMAT_RGB,o,s,a,h)},i.CreateRGBATexture=function(t,r,n,o,s,a,h){return void 0===s&&(s=!0),void 0===a&&(a=!1),void 0===h&&(h=e.Texture.TRILINEAR_SAMPLINGMODE),new i(t,r,n,e.Engine.TEXTUREFORMAT_RGBA,o,s,a,h)},i}(e.Texture);e.RawTexture=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(e){function t(t,i){e.call(this,t.x,t.y),this.index=i}return __extends(t,e),t}(e.Vector2),i=function(){function i(){this.elements=new Array}return i.prototype.add=function(e){var i=this,r=new Array;return e.forEach(function(e){if(0===r.length||!e.equalsWithEpsilon(r[0])){var n=new t(e,i.elements.length);r.push(n),i.elements.push(n)}}),r},i.prototype.computeBounds=function(){var t=new e.Vector2(this.elements[0].x,this.elements[0].y),i=new e.Vector2(this.elements[0].x,this.elements[0].y);return this.elements.forEach(function(e){e.x<t.x?t.x=e.x:e.x>i.x&&(i.x=e.x),e.y<t.y?t.y=e.y:e.y>i.y&&(i.y=e.y)}),{min:t,max:i,width:i.x-t.x,height:i.y-t.y}},i}(),r=function(){function t(){}return t.Rectangle=function(t,i,r,n){return[new e.Vector2(t,i),new e.Vector2(r,i),new e.Vector2(r,n),new e.Vector2(t,n)]},t.Circle=function(t,i,r,n){void 0===i&&(i=0),void 0===r&&(r=0),void 0===n&&(n=32);for(var o=new Array,s=0,a=2*Math.PI/n,h=0;n>h;h++)o.push(new e.Vector2(i+Math.cos(s)*t,r+Math.sin(s)*t)),s-=a;return o},t.Parse=function(t){var i,r=t.split(/[^-+eE\.\d]+/).map(parseFloat).filter(function(e){return!isNaN(e)}),n=[];for(i=0;i<(2147483646&r.length);i+=2)n.push(new e.Vector2(r[i],r[i+1]));return n},t.StartingAt=function(t,i){return e.Path2.StartingAt(t,i)},t}();e.Polygon=r;var n=function(){function t(t,r,n){this._points=new i,this._outlinepoints=new i,this._holes=[],this._epoints=new Array,this._eholes=new Array,this._name=t,this._scene=n;var o;o=r instanceof e.Path2?r.getPoints():r,this._addToepoint(o),this._points.add(o),this._outlinepoints.add(o)}return t.prototype._addToepoint=function(e){for(var t=0;t<e.length;t++){var i=e[t];this._epoints.push(i.x,i.y)}},t.prototype.addHole=function(e){this._points.add(e);var t=new i;return t.add(e),this._holes.push(t),this._eholes.push(this._epoints.length/2),this._addToepoint(e),this},t.prototype.build=function(t,i){var r=this;void 0===t&&(t=!1);var n=new e.Mesh(this._name,this._scene),o=[],s=[],a=[],h=this._points.computeBounds();this._points.elements.forEach(function(e){o.push(0,1,0),s.push(e.x,0,e.y),a.push((e.x-h.min.x)/h.width,(e.y-h.min.y)/h.height)});for(var c=[],l=Earcut.earcut(this._epoints,this._eholes,2),u=0;u<l.length;u++)c.push(l[u]);if(i>0){var f=s.length/3;this._points.elements.forEach(function(e){o.push(0,-1,0),s.push(e.x,-i,e.y),a.push(1-(e.x-h.min.x)/h.width,1-(e.y-h.min.y)/h.height)});for(var d=c.length,u=0;d>u;u+=3){var p=c[u+0],_=c[u+1],m=c[u+2];c.push(m+f),c.push(_+f),c.push(p+f)}this.addSide(s,o,a,c,h,this._outlinepoints,i,!1),this._holes.forEach(function(e){r.addSide(s,o,a,c,h,e,i,!0)})}return n.setVerticesData(e.VertexBuffer.PositionKind,s,t),n.setVerticesData(e.VertexBuffer.NormalKind,o,t),n.setVerticesData(e.VertexBuffer.UVKind,a,t),n.setIndices(c),n},t.prototype.addSide=function(t,i,r,n,o,s,a,h){for(var c=t.length/3,l=0,u=0;u<s.elements.length;u++){var f,d=s.elements[u];f=u+1>s.elements.length-1?s.elements[0]:s.elements[u+1],t.push(d.x,0,d.y),t.push(d.x,-a,d.y),t.push(f.x,0,f.y),t.push(f.x,-a,f.y);var p=new e.Vector3(d.x,0,d.y),_=new e.Vector3(f.x,0,f.y),m=_.subtract(p),g=new e.Vector3(0,1,0),v=e.Vector3.Cross(m,g);v=v.normalize(),r.push(l/o.width,0),r.push(l/o.width,1),l+=m.length(),r.push(l/o.width,0),r.push(l/o.width,1),h?(i.push(v.x,v.y,v.z),i.push(v.x,v.y,v.z),i.push(v.x,v.y,v.z),i.push(v.x,v.y,v.z),n.push(c),n.push(c+2),n.push(c+1),n.push(c+1),n.push(c+2),n.push(c+3)):(i.push(-v.x,-v.y,-v.z),i.push(-v.x,-v.y,-v.z),i.push(-v.x,-v.y,-v.z),i.push(-v.x,-v.y,-v.z),n.push(c),n.push(c+1),n.push(c+2),n.push(c+1),n.push(c+3),n.push(c+2)),c+=4}},t}();e.PolygonMeshBuilder=n}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(t,i,r){void 0===r&&(r=2),this.maxDepth=r,this.dynamicContent=new Array,this._maxBlockCapacity=i||64,this._selectionContent=new e.SmartArray(1024),this._creationFunc=t}return t.prototype.update=function(e,i,r){t._CreateBlocks(e,i,r,this._maxBlockCapacity,0,this.maxDepth,this,this._creationFunc)},t.prototype.addMesh=function(e){for(var t=0;t<this.blocks.length;t++){var i=this.blocks[t];i.addEntry(e)}},t.prototype.select=function(e,t){this._selectionContent.reset();for(var i=0;i<this.blocks.length;i++){var r=this.blocks[i];r.select(e,this._selectionContent,t)}return t?this._selectionContent.concat(this.dynamicContent):this._selectionContent.concatWithNoDuplicate(this.dynamicContent),this._selectionContent},t.prototype.intersects=function(e,t,i){this._selectionContent.reset();for(var r=0;r<this.blocks.length;r++){var n=this.blocks[r];n.intersects(e,t,this._selectionContent,i)}return i?this._selectionContent.concat(this.dynamicContent):this._selectionContent.concatWithNoDuplicate(this.dynamicContent),this._selectionContent},t.prototype.intersectsRay=function(e){this._selectionContent.reset();for(var t=0;t<this.blocks.length;t++){var i=this.blocks[t];i.intersectsRay(e,this._selectionContent)}return this._selectionContent.concatWithNoDuplicate(this.dynamicContent),this._selectionContent},t._CreateBlocks=function(t,i,r,n,o,s,a,h){a.blocks=new Array;for(var c=new e.Vector3((i.x-t.x)/2,(i.y-t.y)/2,(i.z-t.z)/2),l=0;2>l;l++)for(var u=0;2>u;u++)for(var f=0;2>f;f++){var d=t.add(c.multiplyByFloats(l,u,f)),p=t.add(c.multiplyByFloats(l+1,u+1,f+1)),_=new e.OctreeBlock(d,p,n,o+1,s,h);_.addEntries(r),a.blocks.push(_)}},t.CreationFuncForMeshes=function(e,t){!e.isBlocked&&e.getBoundingInfo().boundingBox.intersectsMinMax(t.minPoint,t.maxPoint)&&t.entries.push(e)},t.CreationFuncForSubMeshes=function(e,t){e.getBoundingInfo().boundingBox.intersectsMinMax(t.minPoint,t.maxPoint)&&t.entries.push(e)},t}();e.Octree=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(e,t,i,r,n,o){this.entries=new Array,this._boundingVectors=new Array,this._capacity=i,this._depth=r,this._maxDepth=n,this._creationFunc=o,this._minPoint=e,this._maxPoint=t,this._boundingVectors.push(e.clone()),this._boundingVectors.push(t.clone()),this._boundingVectors.push(e.clone()),this._boundingVectors[2].x=t.x,this._boundingVectors.push(e.clone()),this._boundingVectors[3].y=t.y,this._boundingVectors.push(e.clone()),this._boundingVectors[4].z=t.z,this._boundingVectors.push(t.clone()),this._boundingVectors[5].z=e.z,this._boundingVectors.push(t.clone()),this._boundingVectors[6].x=e.x,this._boundingVectors.push(t.clone()),this._boundingVectors[7].y=e.y}return Object.defineProperty(t.prototype,"capacity",{get:function(){return this._capacity},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minPoint",{get:function(){return this._minPoint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxPoint",{get:function(){return this._maxPoint},enumerable:!0,configurable:!0}),t.prototype.addEntry=function(e){if(this.blocks)for(var t=0;t<this.blocks.length;t++){var i=this.blocks[t];i.addEntry(e)}else this._creationFunc(e,this),this.entries.length>this.capacity&&this._depth<this._maxDepth&&this.createInnerBlocks()},t.prototype.addEntries=function(e){for(var t=0;t<e.length;t++){var i=e[t];this.addEntry(i)}},t.prototype.select=function(t,i,r){if(e.BoundingBox.IsInFrustum(this._boundingVectors,t)){if(this.blocks){for(var n=0;n<this.blocks.length;n++){var o=this.blocks[n];o.select(t,i,r)}return}r?i.concat(this.entries):i.concatWithNoDuplicate(this.entries)}},t.prototype.intersects=function(t,i,r,n){if(e.BoundingBox.IntersectsSphere(this._minPoint,this._maxPoint,t,i)){if(this.blocks){for(var o=0;o<this.blocks.length;o++){var s=this.blocks[o];s.intersects(t,i,r,n)}return}n?r.concat(this.entries):r.concatWithNoDuplicate(this.entries)}},t.prototype.intersectsRay=function(e,t){if(e.intersectsBoxMinMax(this._minPoint,this._maxPoint)){if(this.blocks){for(var i=0;i<this.blocks.length;i++){var r=this.blocks[i];r.intersectsRay(e,t)}return}t.concatWithNoDuplicate(this.entries)}},t.prototype.createInnerBlocks=function(){e.Octree._CreateBlocks(this._minPoint,this._maxPoint,this.entries,this._capacity,this._depth,this._maxDepth,this,this._creationFunc)},t}();e.OctreeBlock=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(i,r,n,o,s,a,h,c){var l=this;void 0===a&&(a=e.Texture.BILINEAR_SAMPLINGMODE),t.call(this,i,"blur",["screenSize","direction","blurWidth"],null,o,s,a,h,c),this.direction=r,this.blurWidth=n,this.onApplyObservable.add(function(e){e.setFloat2("screenSize",l.width,l.height),e.setVector2("direction",l.direction),e.setFloat("blurWidth",l.blurWidth)})}return __extends(i,t),i}(e.PostProcess);e.BlurPostProcess=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(i,r,n,o,s,a,h,c,l,u){var f=this;t.call(this,i,"refraction",["baseColor","depth","colorLevel"],["refractionSampler"],a,h,c,l,u),this.color=n,this.depth=o,this.colorLevel=s,this.onActivateObservable.add(function(t){f._refRexture=f._refRexture||new e.Texture(r,t.getScene())}),this.onApplyObservable.add(function(e){e.setColor3("baseColor",f.color),e.setFloat("depth",f.depth),e.setFloat("colorLevel",f.colorLevel),e.setTexture("refractionSampler",f._refRexture)})}return __extends(i,t),i.prototype.dispose=function(e){this._refRexture&&this._refRexture.dispose(),t.prototype.dispose.call(this,e)},i}(e.PostProcess);e.RefractionPostProcess=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(e){function t(t,i,r,n,o,s){e.call(this,t,"blackAndWhite",null,null,i,r,n,o,s)}return __extends(t,e),t}(e.PostProcess);e.BlackAndWhitePostProcess=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(e){function t(t,i,r,n,o,s,a){var h=this;e.call(this,t,"convolution",["kernel","screenSize"],null,r,n,o,s,a),this.kernel=i,this.onApply=function(e){e.setFloat2("screenSize",h.width,h.height),e.setArray("kernel",h.kernel)}}return __extends(t,e),t.EdgeDetect0Kernel=[1,0,-1,0,0,0,-1,0,1],t.EdgeDetect1Kernel=[0,1,0,1,-4,1,0,1,0],t.EdgeDetect2Kernel=[-1,-1,-1,-1,8,-1,-1,-1,-1],t.SharpenKernel=[0,-1,0,-1,5,-1,0,-1,0],t.EmbossKernel=[-2,-1,0,-1,1,1,0,1,2],t.GaussianKernel=[0,1,0,1,1,1,0,1,0],t}(e.PostProcess);e.ConvolutionPostProcess=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(e){function t(t,i,r,n,o,s,a){var h=this;e.call(this,t,"filter",["kernelMatrix"],null,r,n,o,s,a),this.kernelMatrix=i,
this.onApply=function(e){e.setMatrix("kernelMatrix",h.kernelMatrix)}}return __extends(t,e),t}(e.PostProcess);e.FilterPostProcess=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(e){function t(t,i,r,n,o,s){var a=this;e.call(this,t,"fxaa",["texelSize"],null,i,r,n,o,s),this.onSizeChangedObservable.add(function(){a.texelWidth=1/a.width,a.texelHeight=1/a.height}),this.onApplyObservable.add(function(e){e.setFloat2("texelSize",a.texelWidth,a.texelHeight)})}return __extends(t,e),t}(e.PostProcess);e.FxaaPostProcess=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(i,r,n,o,s,a){var h=this;t.call(this,i,"stereoscopicInterlace",["stepSize"],["camASampler"],1,r[1],o,s,a,n?"#define IS_STEREOSCOPIC_HORIZ 1":void 0),this._passedProcess=r[0]._rigPostProcess,this._stepSize=new e.Vector2(1/this.width,1/this.height),this.onSizeChangedObservable.add(function(){h._stepSize=new e.Vector2(1/h.width,1/h.height)}),this.onApplyObservable.add(function(e){e.setTextureFromPostProcess("camASampler",h._passedProcess),e.setFloat2("stepSize",h._stepSize.x,h._stepSize.y)})}return __extends(i,t),i}(e.PostProcess);e.StereoscopicInterlacePostProcess=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(t,i,r,n,o){this.size=t,this.position=i,this.dispose=function(){this.texture&&this.texture.dispose();var e=this._system.lensFlares.indexOf(this);this._system.lensFlares.splice(e,1)},this.color=r||new e.Color3(1,1,1),this.texture=n?new e.Texture(n,o.getScene(),!0):null,this._system=o,o.lensFlares.push(this)}return t}();e.LensFlare=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(t,i,r){this.name=t,this.lensFlares=new Array,this.borderLimit=300,this.layerMask=268435455,this._vertexBuffers={},this._isEnabled=!0,this._scene=r,this._emitter=i,this.id=t,r.lensFlareSystems.push(this),this.meshesSelectionPredicate=function(e){return e.material&&e.isVisible&&e.isEnabled()&&e.isBlocker&&0!=(e.layerMask&r.activeCamera.layerMask)};var n=r.getEngine(),o=[];o.push(1,1),o.push(-1,1),o.push(-1,-1),o.push(1,-1),this._vertexBuffers[e.VertexBuffer.PositionKind]=new e.VertexBuffer(n,o,e.VertexBuffer.PositionKind,!1,!1,2);var s=[];s.push(0),s.push(1),s.push(2),s.push(0),s.push(2),s.push(3),this._indexBuffer=n.createIndexBuffer(s),this._effect=n.createEffect("lensFlare",[e.VertexBuffer.PositionKind],["color","viewportMatrix"],["textureSampler"],"")}return Object.defineProperty(t.prototype,"isEnabled",{get:function(){return this._isEnabled},set:function(e){this._isEnabled=e},enumerable:!0,configurable:!0}),t.prototype.getScene=function(){return this._scene},t.prototype.getEmitter=function(){return this._emitter},t.prototype.setEmitter=function(e){this._emitter=e},t.prototype.getEmitterPosition=function(){return this._emitter.getAbsolutePosition?this._emitter.getAbsolutePosition():this._emitter.position},t.prototype.computeEffectivePosition=function(t){var i=this.getEmitterPosition();return i=e.Vector3.Project(i,e.Matrix.Identity(),this._scene.getTransformMatrix(),t),this._positionX=i.x,this._positionY=i.y,i=e.Vector3.TransformCoordinates(this.getEmitterPosition(),this._scene.getViewMatrix()),i.z>0&&this._positionX>t.x&&this._positionX<t.x+t.width&&this._positionY>t.y&&this._positionY<t.y+t.height},t.prototype._isVisible=function(){if(!this._isEnabled)return!1;var t=this.getEmitterPosition(),i=t.subtract(this._scene.activeCamera.position),r=i.length();i.normalize();var n=new e.Ray(this._scene.activeCamera.position,i),o=this._scene.pickWithRay(n,this.meshesSelectionPredicate,!0);return!o.hit||o.distance>r},t.prototype.render=function(){if(!this._effect.isReady())return!1;var t=this._scene.getEngine(),i=this._scene.activeCamera.viewport,r=i.toGlobal(t.getRenderWidth(!0),t.getRenderHeight(!0));if(!this.computeEffectivePosition(r))return!1;if(!this._isVisible())return!1;var n,o;n=this._positionX<this.borderLimit+r.x?this.borderLimit+r.x-this._positionX:this._positionX>r.x+r.width-this.borderLimit?this._positionX-r.x-r.width+this.borderLimit:0,o=this._positionY<this.borderLimit+r.y?this.borderLimit+r.y-this._positionY:this._positionY>r.y+r.height-this.borderLimit?this._positionY-r.y-r.height+this.borderLimit:0;var s=n>o?n:o;s>this.borderLimit&&(s=this.borderLimit);var a=1-s/this.borderLimit;if(0>a)return!1;a>1&&(a=1);var h=r.x+r.width/2,c=r.y+r.height/2,l=h-this._positionX,u=c-this._positionY;t.enableEffect(this._effect),t.setState(!1),t.setDepthBuffer(!1),t.setAlphaMode(e.Engine.ALPHA_ONEONE),t.bindBuffers(this._vertexBuffers,this._indexBuffer,this._effect);for(var f=0;f<this.lensFlares.length;f++){var d=this.lensFlares[f],p=h-l*d.position,_=c-u*d.position,m=d.size,g=d.size*t.getAspectRatio(this._scene.activeCamera,!0),v=2*(p/r.width)-1,y=1-2*(_/r.height),x=e.Matrix.FromValues(m/2,0,0,0,0,g/2,0,0,0,0,1,0,v,y,0,1);this._effect.setMatrix("viewportMatrix",x),this._effect.setTexture("textureSampler",d.texture),this._effect.setFloat4("color",d.color.r*a,d.color.g*a,d.color.b*a,1),t.draw(!0,0,6)}return t.setDepthBuffer(!0),t.setAlphaMode(e.Engine.ALPHA_DISABLE),!0},t.prototype.dispose=function(){var t=this._vertexBuffers[e.VertexBuffer.PositionKind];for(t&&(t.dispose(),this._vertexBuffers[e.VertexBuffer.PositionKind]=null),this._indexBuffer&&(this._scene.getEngine()._releaseBuffer(this._indexBuffer),this._indexBuffer=null);this.lensFlares.length;)this.lensFlares[0].dispose();var i=this._scene.lensFlareSystems.indexOf(this);this._scene.lensFlareSystems.splice(i,1)},t.Parse=function(i,r,n){var o=r.getLastEntryByID(i.emitterId),s=i.name||"lensFlareSystem#"+i.emitterId,a=new t(s,o,r);a.id=i.id||s,a.borderLimit=i.borderLimit;for(var h=0;h<i.flares.length;h++){var c=i.flares[h];new e.LensFlare(c.size,c.position,e.Color3.FromArray(c.color),n+c.textureName,a)}return a},t.prototype.serialize=function(){var t={};t.id=this.id,t.name=this.name,t.emitterId=this.getEmitter().id,t.borderLimit=this.borderLimit,t.flares=[];for(var i=0;i<this.lensFlares.length;i++){var r=this.lensFlares[i];t.flares.push({size:r.size,position:r.position,color:r.color.asArray(),textureName:e.Tools.GetFilename(r.texture.name)})}return t},t}();e.LensFlareSystem=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(e){function t(t,i,r){e.call(this,t,i,r),this.inputs.addDeviceOrientation()}return __extends(t,e),Object.defineProperty(t.prototype,"angularSensibility",{get:function(){return 0},set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"moveSensibility",{get:function(){return 0},set:function(e){},enumerable:!0,configurable:!0}),t.prototype.getTypeName=function(){return"DeviceOrientationCamera"},t}(e.FreeCamera);e.DeviceOrientationCamera=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(e){function t(t,i,r){e.call(this,t,i,r),this.inputs.addGamepad()}return __extends(t,e),Object.defineProperty(t.prototype,"gamepadAngularSensibility",{get:function(){var e=this.inputs.attached.gamepad;return e?e.gamepadAngularSensibility:void 0},set:function(e){var t=this.inputs.attached.gamepad;t&&(t.gamepadAngularSensibility=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"gamepadMoveSensibility",{get:function(){var e=this.inputs.attached.gamepad;return e?e.gamepadMoveSensibility:void 0},set:function(e){var t=this.inputs.attached.gamepad;t&&(t.gamepadMoveSensibility=e)},enumerable:!0,configurable:!0}),t.prototype.getTypeName=function(){return"UniversalCamera"},t}(e.TouchCamera);e.UniversalCamera=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function e(e){var t=this;this.babylonGamepads=[],this.oneGamepadConnected=!1,this.isMonitoring=!1,this.gamepadEventSupported="GamepadEvent"in window,this.gamepadSupportAvailable=navigator.getGamepads||!!navigator.webkitGetGamepads||!!navigator.msGetGamepads||!!navigator.webkitGamepads,this._callbackGamepadConnected=e,this.gamepadSupportAvailable&&(this.gamepadEventSupported?(this._onGamepadConnectedEvent=function(e){t._onGamepadConnected(e)},this._onGamepadDisonnectedEvent=function(e){t._onGamepadDisconnected(e)},window.addEventListener("gamepadconnected",this._onGamepadConnectedEvent,!1),window.addEventListener("gamepaddisconnected",this._onGamepadDisonnectedEvent,!1)):this._startMonitoringGamepads())}return e.prototype.dispose=function(){e.gamepadDOMInfo&&document.body.removeChild(e.gamepadDOMInfo),this._onGamepadConnectedEvent&&(window.removeEventListener("gamepadconnected",this._onGamepadConnectedEvent,!1),window.removeEventListener("gamepaddisconnected",this._onGamepadDisonnectedEvent,!1),this._onGamepadConnectedEvent=null,this._onGamepadDisonnectedEvent=null)},e.prototype._onGamepadConnected=function(e){var t=this._addNewGamepad(e.gamepad);this._callbackGamepadConnected&&this._callbackGamepadConnected(t),this._startMonitoringGamepads()},e.prototype._addNewGamepad=function(t){this.oneGamepadConnected||(this.oneGamepadConnected=!0,e.gamepadDOMInfo&&(document.body.removeChild(e.gamepadDOMInfo),e.gamepadDOMInfo=null));var i;return i=-1!==t.id.search("Xbox 360")||-1!==t.id.search("xinput")?new a(t.id,t.index,t):new n(t.id,t.index,t),this.babylonGamepads.push(i),i},e.prototype._onGamepadDisconnected=function(e){for(var t in this.babylonGamepads)if(this.babylonGamepads[t].index==e.gamepad.index){this.babylonGamepads.splice(+t,1);break}0==this.babylonGamepads.length&&this._stopMonitoringGamepads()},e.prototype._startMonitoringGamepads=function(){this.isMonitoring||(this.isMonitoring=!0,this._checkGamepadsStatus())},e.prototype._stopMonitoringGamepads=function(){this.isMonitoring=!1},e.prototype._checkGamepadsStatus=function(){var e=this;this._updateGamepadObjects();for(var t in this.babylonGamepads)this.babylonGamepads[t].update();this.isMonitoring&&(window.requestAnimationFrame?window.requestAnimationFrame(function(){e._checkGamepadsStatus()}):window.mozRequestAnimationFrame?window.mozRequestAnimationFrame(function(){e._checkGamepadsStatus()}):window.webkitRequestAnimationFrame&&window.webkitRequestAnimationFrame(function(){e._checkGamepadsStatus()}))},e.prototype._updateGamepadObjects=function(){for(var e=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads():[],t=0;t<e.length;t++)if(e[t])if(e[t].index in this.babylonGamepads)this.babylonGamepads[t].browserGamepad=e[t];else{var i=this._addNewGamepad(e[t]);this._callbackGamepadConnected&&this._callbackGamepadConnected(i)}},e}();e.Gamepads=t;var i=function(){function e(e,t){this.x=e,this.y=t}return e}();e.StickValues=i;var r=function(){function e(e,t,i){this.id=e,this.index=t,this.browserGamepad=i,this.browserGamepad.axes.length>=2&&(this._leftStick={x:this.browserGamepad.axes[0],y:this.browserGamepad.axes[1]}),this.browserGamepad.axes.length>=4&&(this._rightStick={x:this.browserGamepad.axes[2],y:this.browserGamepad.axes[3]})}return e.prototype.onleftstickchanged=function(e){this._onleftstickchanged=e},e.prototype.onrightstickchanged=function(e){this._onrightstickchanged=e},Object.defineProperty(e.prototype,"leftStick",{get:function(){return this._leftStick},set:function(e){!this._onleftstickchanged||this._leftStick.x===e.x&&this._leftStick.y===e.y||this._onleftstickchanged(e),this._leftStick=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightStick",{get:function(){return this._rightStick},set:function(e){!this._onrightstickchanged||this._rightStick.x===e.x&&this._rightStick.y===e.y||this._onrightstickchanged(e),this._rightStick=e},enumerable:!0,configurable:!0}),e.prototype.update=function(){this._leftStick&&(this.leftStick={x:this.browserGamepad.axes[0],y:this.browserGamepad.axes[1]}),this._rightStick&&(this.rightStick={x:this.browserGamepad.axes[2],y:this.browserGamepad.axes[3]})},e}();e.Gamepad=r;var n=function(e){function t(t,i,r){e.call(this,t,i,r),this.id=t,this.index=i,this.gamepad=r,this._buttons=new Array(r.buttons.length)}return __extends(t,e),t.prototype.onbuttondown=function(e){this._onbuttondown=e},t.prototype.onbuttonup=function(e){this._onbuttonup=e},t.prototype._setButtonValue=function(e,t,i){return e!==t&&(this._onbuttondown&&1===e&&this._onbuttondown(i),this._onbuttonup&&0===e&&this._onbuttonup(i)),e},t.prototype.update=function(){e.prototype.update.call(this);for(var t=0;t<this._buttons.length;t++)this._buttons[t]=this._setButtonValue(this.gamepad.buttons[t].value,this._buttons[t],t)},t}(r);e.GenericPad=n,function(e){e[e.A=0]="A",e[e.B=1]="B",e[e.X=2]="X",e[e.Y=3]="Y",e[e.Start=4]="Start",e[e.Back=5]="Back",e[e.LB=6]="LB",e[e.RB=7]="RB",e[e.LeftStick=8]="LeftStick",e[e.RightStick=9]="RightStick"}(e.Xbox360Button||(e.Xbox360Button={}));var o=e.Xbox360Button;!function(e){e[e.Up=0]="Up",e[e.Down=1]="Down",e[e.Left=2]="Left",e[e.Right=3]="Right"}(e.Xbox360Dpad||(e.Xbox360Dpad={}));var s=e.Xbox360Dpad,a=function(e){function t(){e.apply(this,arguments),this._leftTrigger=0,this._rightTrigger=0,this._buttonA=0,this._buttonB=0,this._buttonX=0,this._buttonY=0,this._buttonBack=0,this._buttonStart=0,this._buttonLB=0,this._buttonRB=0,this._buttonLeftStick=0,this._buttonRightStick=0,this._dPadUp=0,this._dPadDown=0,this._dPadLeft=0,this._dPadRight=0}return __extends(t,e),t.prototype.onlefttriggerchanged=function(e){this._onlefttriggerchanged=e},t.prototype.onrighttriggerchanged=function(e){this._onrighttriggerchanged=e},Object.defineProperty(t.prototype,"leftTrigger",{get:function(){return this._leftTrigger},set:function(e){this._onlefttriggerchanged&&this._leftTrigger!==e&&this._onlefttriggerchanged(e),this._leftTrigger=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rightTrigger",{get:function(){return this._rightTrigger},set:function(e){this._onrighttriggerchanged&&this._rightTrigger!==e&&this._onrighttriggerchanged(e),this._rightTrigger=e},enumerable:!0,configurable:!0}),t.prototype.onbuttondown=function(e){this._onbuttondown=e},t.prototype.onbuttonup=function(e){this._onbuttonup=e},t.prototype.ondpaddown=function(e){this._ondpaddown=e},t.prototype.ondpadup=function(e){this._ondpadup=e},t.prototype._setButtonValue=function(e,t,i){return e!==t&&(this._onbuttondown&&1===e&&this._onbuttondown(i),this._onbuttonup&&0===e&&this._onbuttonup(i)),e},t.prototype._setDPadValue=function(e,t,i){return e!==t&&(this._ondpaddown&&1===e&&this._ondpaddown(i),this._ondpadup&&0===e&&this._ondpadup(i)),e},Object.defineProperty(t.prototype,"buttonA",{get:function(){return this._buttonA},set:function(e){this._buttonA=this._setButtonValue(e,this._buttonA,o.A)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"buttonB",{get:function(){return this._buttonB},set:function(e){this._buttonB=this._setButtonValue(e,this._buttonB,o.B)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"buttonX",{get:function(){return this._buttonX},set:function(e){this._buttonX=this._setButtonValue(e,this._buttonX,o.X)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"buttonY",{get:function(){return this._buttonY},set:function(e){this._buttonY=this._setButtonValue(e,this._buttonY,o.Y)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"buttonStart",{get:function(){return this._buttonStart},set:function(e){this._buttonStart=this._setButtonValue(e,this._buttonStart,o.Start)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"buttonBack",{get:function(){return this._buttonBack},set:function(e){this._buttonBack=this._setButtonValue(e,this._buttonBack,o.Back)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"buttonLB",{get:function(){return this._buttonLB},set:function(e){this._buttonLB=this._setButtonValue(e,this._buttonLB,o.LB)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"buttonRB",{get:function(){return this._buttonRB},set:function(e){this._buttonRB=this._setButtonValue(e,this._buttonRB,o.RB)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"buttonLeftStick",{get:function(){return this._buttonLeftStick},set:function(e){this._buttonLeftStick=this._setButtonValue(e,this._buttonLeftStick,o.LeftStick)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"buttonRightStick",{get:function(){return this._buttonRightStick},set:function(e){this._buttonRightStick=this._setButtonValue(e,this._buttonRightStick,o.RightStick)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dPadUp",{get:function(){return this._dPadUp},set:function(e){this._dPadUp=this._setDPadValue(e,this._dPadUp,s.Up)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dPadDown",{get:function(){return this._dPadDown},set:function(e){this._dPadDown=this._setDPadValue(e,this._dPadDown,s.Down)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dPadLeft",{get:function(){return this._dPadLeft},set:function(e){this._dPadLeft=this._setDPadValue(e,this._dPadLeft,s.Left)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dPadRight",{get:function(){return this._dPadRight},set:function(e){this._dPadRight=this._setDPadValue(e,this._dPadRight,s.Right)},enumerable:!0,configurable:!0}),t.prototype.update=function(){e.prototype.update.call(this),this.buttonA=this.browserGamepad.buttons[0].value,this.buttonB=this.browserGamepad.buttons[1].value,this.buttonX=this.browserGamepad.buttons[2].value,this.buttonY=this.browserGamepad.buttons[3].value,this.buttonLB=this.browserGamepad.buttons[4].value,this.buttonRB=this.browserGamepad.buttons[5].value,this.leftTrigger=this.browserGamepad.buttons[6].value,this.rightTrigger=this.browserGamepad.buttons[7].value,this.buttonBack=this.browserGamepad.buttons[8].value,this.buttonStart=this.browserGamepad.buttons[9].value,this.buttonLeftStick=this.browserGamepad.buttons[10].value,this.buttonRightStick=this.browserGamepad.buttons[11].value,this.dPadUp=this.browserGamepad.buttons[12].value,this.dPadDown=this.browserGamepad.buttons[13].value,this.dPadLeft=this.browserGamepad.buttons[14].value,this.dPadRight=this.browserGamepad.buttons[15].value},t}(r);e.Xbox360Pad=a}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(i,r,n){e.Tools.Warn("Deprecated. Please use Universal Camera instead."),t.call(this,i,r,n)}return __extends(i,t),Object.defineProperty(i.prototype,"gamepadAngularSensibility",{get:function(){var e=this.inputs.attached.gamepad;return e?e.gamepadAngularSensibility:void 0},set:function(e){var t=this.inputs.attached.gamepad;t&&(t.gamepadAngularSensibility=e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"gamepadMoveSensibility",{get:function(){var e=this.inputs.attached.gamepad;return e?e.gamepadMoveSensibility:void 0},set:function(e){var t=this.inputs.attached.gamepad;t&&(t.gamepadMoveSensibility=e)},enumerable:!0,configurable:!0}),i.prototype.getTypeName=function(){return"GamepadCamera"},i}(e.UniversalCamera);e.GamepadCamera=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(t){this.SMOOTHING=.75,this.FFT_SIZE=512,this.BARGRAPHAMPLITUDE=256,this.DEBUGCANVASPOS={x:20,y:20},this.DEBUGCANVASSIZE={width:320,height:200},this._scene=t,this._audioEngine=e.Engine.audioEngine,this._audioEngine.canUseWebAudio&&(this._webAudioAnalyser=this._audioEngine.audioContext.createAnalyser(),this._webAudioAnalyser.minDecibels=-140,this._webAudioAnalyser.maxDecibels=0,this._byteFreqs=new Uint8Array(this._webAudioAnalyser.frequencyBinCount),this._byteTime=new Uint8Array(this._webAudioAnalyser.frequencyBinCount),this._floatFreqs=new Float32Array(this._webAudioAnalyser.frequencyBinCount))}return t.prototype.getFrequencyBinCount=function(){return this._audioEngine.canUseWebAudio?this._webAudioAnalyser.frequencyBinCount:0},t.prototype.getByteFrequencyData=function(){return this._audioEngine.canUseWebAudio&&(this._webAudioAnalyser.smoothingTimeConstant=this.SMOOTHING,this._webAudioAnalyser.fftSize=this.FFT_SIZE,this._webAudioAnalyser.getByteFrequencyData(this._byteFreqs)),this._byteFreqs},t.prototype.getByteTimeDomainData=function(){return this._audioEngine.canUseWebAudio&&(this._webAudioAnalyser.smoothingTimeConstant=this.SMOOTHING,this._webAudioAnalyser.fftSize=this.FFT_SIZE,this._webAudioAnalyser.getByteTimeDomainData(this._byteTime)),this._byteTime},t.prototype.getFloatFrequencyData=function(){return this._audioEngine.canUseWebAudio&&(this._webAudioAnalyser.smoothingTimeConstant=this.SMOOTHING,this._webAudioAnalyser.fftSize=this.FFT_SIZE,this._webAudioAnalyser.getFloatFrequencyData(this._floatFreqs)),this._floatFreqs},t.prototype.drawDebugCanvas=function(){var e=this;if(this._audioEngine.canUseWebAudio&&(this._debugCanvas||(this._debugCanvas=document.createElement("canvas"),this._debugCanvas.width=this.DEBUGCANVASSIZE.width,this._debugCanvas.height=this.DEBUGCANVASSIZE.height,this._debugCanvas.style.position="absolute",this._debugCanvas.style.top=this.DEBUGCANVASPOS.y+"px",this._debugCanvas.style.left=this.DEBUGCANVASPOS.x+"px",this._debugCanvasContext=this._debugCanvas.getContext("2d"),document.body.appendChild(this._debugCanvas),this._registerFunc=function(){e.drawDebugCanvas()},this._scene.registerBeforeRender(this._registerFunc)),this._registerFunc)){var t=this.getByteFrequencyData();this._debugCanvasContext.fillStyle="rgb(0, 0, 0)",this._debugCanvasContext.fillRect(0,0,this.DEBUGCANVASSIZE.width,this.DEBUGCANVASSIZE.height);for(var i=0;i<this.getFrequencyBinCount();i++){var r=t[i],n=r/this.BARGRAPHAMPLITUDE,o=this.DEBUGCANVASSIZE.height*n,s=this.DEBUGCANVASSIZE.height-o-1,a=this.DEBUGCANVASSIZE.width/this.getFrequencyBinCount(),h=i/this.getFrequencyBinCount()*360;this._debugCanvasContext.fillStyle="hsl("+h+", 100%, 50%)",this._debugCanvasContext.fillRect(i*a,s,a,o)}}},t.prototype.stopDebugCanvas=function(){this._debugCanvas&&(this._scene.unregisterBeforeRender(this._registerFunc),this._registerFunc=null,document.body.removeChild(this._debugCanvas),this._debugCanvas=null,this._debugCanvasContext=null)},t.prototype.connectAudioNodes=function(e,t){this._audioEngine.canUseWebAudio&&(e.connect(this._webAudioAnalyser),this._webAudioAnalyser.connect(t))},t.prototype.dispose=function(){this._audioEngine.canUseWebAudio&&this._webAudioAnalyser.disconnect()},t}();e.Analyser=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(t,i){var r=this;void 0===i&&(i=e.Engine.TEXTURETYPE_FLOAT),this._viewMatrix=e.Matrix.Zero(),this._projectionMatrix=e.Matrix.Zero(),this._transformMatrix=e.Matrix.Zero(),this._worldViewProjection=e.Matrix.Zero(),this._scene=t;var n=t.getEngine();this._depthMap=new e.RenderTargetTexture("depthMap",{width:n.getRenderWidth(),height:n.getRenderHeight()},this._scene,!1,!0,i),this._depthMap.wrapU=e.Texture.CLAMP_ADDRESSMODE,this._depthMap.wrapV=e.Texture.CLAMP_ADDRESSMODE,this._depthMap.refreshRate=1,this._depthMap.renderParticles=!1,this._depthMap.renderList=null,this._depthMap.onClearObservable.add(function(t){t.clear(new e.Color4(1,1,1,1),!0,!0)});var o=function(t){var i=t.getRenderingMesh(),n=r._scene,o=n.getEngine();o.setState(t.getMaterial().backFaceCulling);var s=i._getInstancesRenderList(t._id);if(!s.mustReturn){var a=null!==o.getCaps().instancedArrays&&null!==s.visibleInstances[t._id];if(r.isReady(t,a)){o.enableEffect(r._effect),i._bind(t,r._effect,e.Material.TriangleFillMode);var h=t.getMaterial();if(r._effect.setMatrix("viewProjection",n.getTransformMatrix()),r._effect.setFloat("far",n.activeCamera.maxZ),h&&h.needAlphaTesting()){var c=h.getAlphaTestTexture();r._effect.setTexture("diffuseSampler",c),r._effect.setMatrix("diffuseMatrix",c.getTextureMatrix())}i.useBones&&i.computeBonesUsingShaders&&r._effect.setMatrices("mBones",i.skeleton.getTransformMatrices(i)),i._processRendering(t,r._effect,e.Material.TriangleFillMode,s,a,function(e,t){return r._effect.setMatrix("world",t)})}}};this._depthMap.customRenderFunction=function(e,t){var i;for(i=0;i<e.length;i++)o(e.data[i]);for(i=0;i<t.length;i++)o(t.data[i])}}return t.prototype.isReady=function(t,i){var r=t.getMaterial();if(r.disableDepthWrite)return!1;var n=[],o=[e.VertexBuffer.PositionKind],s=t.getMesh();s.getScene();r&&r.needAlphaTesting()&&(n.push("#define ALPHATEST"),s.isVerticesDataPresent(e.VertexBuffer.UVKind)&&(o.push(e.VertexBuffer.UVKind),n.push("#define UV1")),s.isVerticesDataPresent(e.VertexBuffer.UV2Kind)&&(o.push(e.VertexBuffer.UV2Kind),n.push("#define UV2"))),s.useBones&&s.computeBonesUsingShaders?(o.push(e.VertexBuffer.MatricesIndicesKind),o.push(e.VertexBuffer.MatricesWeightsKind),s.numBoneInfluencers>4&&(o.push(e.VertexBuffer.MatricesIndicesExtraKind),o.push(e.VertexBuffer.MatricesWeightsExtraKind)),n.push("#define NUM_BONE_INFLUENCERS "+s.numBoneInfluencers),n.push("#define BonesPerMesh "+(s.skeleton.bones.length+1))):n.push("#define NUM_BONE_INFLUENCERS 0"),i&&(n.push("#define INSTANCES"),o.push("world0"),o.push("world1"),o.push("world2"),o.push("world3"));var a=n.join("\n");return this._cachedDefines!==a&&(this._cachedDefines=a,this._effect=this._scene.getEngine().createEffect("depth",o,["world","mBones","viewProjection","diffuseMatrix","far"],["diffuseSampler"],a)),this._effect.isReady()},t.prototype.getDepthMap=function(){return this._depthMap},t.prototype.dispose=function(){this._depthMap.dispose()},t}();e.DepthRenderer=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(i,r,n,o){var s=this;t.call(this,r.getEngine(),i),this.SSAOOriginalSceneColorEffect="SSAOOriginalSceneColorEffect",this.SSAORenderEffect="SSAORenderEffect",this.SSAOBlurHRenderEffect="SSAOBlurHRenderEffect",this.SSAOBlurVRenderEffect="SSAOBlurVRenderEffect",this.SSAOCombineRenderEffect="SSAOCombineRenderEffect",this.totalStrength=1,this.radius=1e-4,this.area=.0075,this.fallOff=1e-6,this.base=.5,this._firstUpdate=!0,this._scene=r,this._createRandomTexture(),this._depthTexture=r.enableDepthRenderer().getDepthMap();var a=n.ssaoRatio||n,h=n.combineRatio||n;this._ratio={ssaoRatio:a,combineRatio:h},this._originalColorPostProcess=new e.PassPostProcess("SSAOOriginalSceneColor",h,null,e.Texture.BILINEAR_SAMPLINGMODE,r.getEngine(),!1),this._createSSAOPostProcess(a),this._createBlurPostProcess(a),this._createSSAOCombinePostProcess(h),this.addEffect(new e.PostProcessRenderEffect(r.getEngine(),this.SSAOOriginalSceneColorEffect,function(){return s._originalColorPostProcess},!0)),this.addEffect(new e.PostProcessRenderEffect(r.getEngine(),this.SSAORenderEffect,function(){return s._ssaoPostProcess},!0)),this.addEffect(new e.PostProcessRenderEffect(r.getEngine(),this.SSAOBlurHRenderEffect,function(){return s._blurHPostProcess},!0)),this.addEffect(new e.PostProcessRenderEffect(r.getEngine(),this.SSAOBlurVRenderEffect,function(){return s._blurVPostProcess},!0)),this.addEffect(new e.PostProcessRenderEffect(r.getEngine(),this.SSAOCombineRenderEffect,function(){return s._ssaoCombinePostProcess},!0)),r.postProcessRenderPipelineManager.addPipeline(this),o&&r.postProcessRenderPipelineManager.attachCamerasToRenderPipeline(i,o)}return __extends(i,t),i.prototype.getBlurHPostProcess=function(){return e.Tools.Error("SSAORenderinPipeline.getBlurHPostProcess() is deprecated, no more blur post-process exists"),null},i.prototype.getBlurVPostProcess=function(){return e.Tools.Error("SSAORenderinPipeline.getBlurVPostProcess() is deprecated, no more blur post-process exists"),null},i.prototype.dispose=function(e){void 0===e&&(e=!1);for(var t=0;t<this._scene.cameras.length;t++){var i=this._scene.cameras[t];this._originalColorPostProcess.dispose(i),this._ssaoPostProcess.dispose(i),this._blurHPostProcess.dispose(i),this._blurVPostProcess.dispose(i),this._ssaoCombinePostProcess.dispose(i)}this._randomTexture.dispose(),e&&this._scene.disableDepthRenderer(),this._scene.postProcessRenderPipelineManager.detachCamerasFromRenderPipeline(this._name,this._scene.cameras)},i.prototype._createBlurPostProcess=function(t){for(var i=this,r=[],n=-8;8>n;n++)r.push(2*n);this._blurHPostProcess=new e.PostProcess("BlurH","ssao",["outSize","samplerOffsets"],["depthSampler"],t,null,e.Texture.TRILINEAR_SAMPLINGMODE,this._scene.getEngine(),!1,"#define BILATERAL_BLUR\n#define BILATERAL_BLUR_H\n#define SAMPLES 16"),this._blurHPostProcess.onApply=function(e){e.setFloat("outSize",i._ssaoCombinePostProcess.width),e.setTexture("depthSampler",i._depthTexture),i._firstUpdate&&e.setArray("samplerOffsets",r)},this._blurVPostProcess=new e.PostProcess("BlurV","ssao",["outSize","samplerOffsets"],["depthSampler"],t,null,e.Texture.TRILINEAR_SAMPLINGMODE,this._scene.getEngine(),!1,"#define BILATERAL_BLUR\n#define SAMPLES 16"),this._blurVPostProcess.onApply=function(e){e.setFloat("outSize",i._ssaoCombinePostProcess.height),e.setTexture("depthSampler",i._depthTexture),i._firstUpdate&&(e.setArray("samplerOffsets",r),i._firstUpdate=!1)}},i.prototype._createSSAOPostProcess=function(t){var i=this,r=16,n=[.5381,.1856,-.4319,.1379,.2486,.443,.3371,.5679,-.0057,-.6999,-.0451,-.0019,.0689,-.1598,-.8547,.056,.0069,-.1843,-.0146,.1402,.0762,.01,-.1924,-.0344,-.3577,-.5301,-.4358,-.3169,.1063,.0158,.0103,-.5869,.0046,-.0897,-.494,.3287,.7119,-.0154,-.0918,-.0533,.0596,-.5411,.0352,-.0631,.546,-.4776,.2847,-.0271],o=1/r;this._ssaoPostProcess=new e.PostProcess("ssao","ssao",["sampleSphere","samplesFactor","randTextureTiles","totalStrength","radius","area","fallOff","base","range","viewport"],["randomSampler"],t,null,e.Texture.BILINEAR_SAMPLINGMODE,this._scene.getEngine(),!1,"#define SAMPLES "+r+"\n#define SSAO");new e.Vector2(0,0);this._ssaoPostProcess.onApply=function(e){i._firstUpdate&&(e.setArray3("sampleSphere",n),e.setFloat("samplesFactor",o),e.setFloat("randTextureTiles",4)),e.setFloat("totalStrength",i.totalStrength),e.setFloat("radius",i.radius),e.setFloat("area",i.area),e.setFloat("fallOff",i.fallOff),e.setFloat("base",i.base),e.setTexture("textureSampler",i._depthTexture),e.setTexture("randomSampler",i._randomTexture)}},i.prototype._createSSAOCombinePostProcess=function(t){var i=this;this._ssaoCombinePostProcess=new e.PostProcess("ssaoCombine","ssaoCombine",[],["originalColor"],t,null,e.Texture.BILINEAR_SAMPLINGMODE,this._scene.getEngine(),!1),this._ssaoCombinePostProcess.onApply=function(e){e.setTextureFromPostProcess("originalColor",i._originalColorPostProcess)}},i.prototype._createRandomTexture=function(){var t=512;this._randomTexture=new e.DynamicTexture("SSAORandomTexture",t,this._scene,!1,e.Texture.TRILINEAR_SAMPLINGMODE),this._randomTexture.wrapU=e.Texture.WRAP_ADDRESSMODE,this._randomTexture.wrapV=e.Texture.WRAP_ADDRESSMODE;for(var i=this._randomTexture.getContext(),r=function(e,t){return Math.random()*(t-e)+e},n=e.Vector3.Zero(),o=0;t>o;o++)for(var s=0;t>s;s++)n.x=Math.floor(255*r(-1,1)),n.y=Math.floor(255*r(-1,1)),n.z=Math.floor(255*r(-1,1)),i.fillStyle="rgb("+n.x+", "+n.y+", "+n.z+")",i.fillRect(o,s,1,1);this._randomTexture.update(!1)},__decorate([e.serialize()],i.prototype,"totalStrength",void 0),__decorate([e.serialize()],i.prototype,"radius",void 0),__decorate([e.serialize()],i.prototype,"area",void 0),__decorate([e.serialize()],i.prototype,"fallOff",void 0),__decorate([e.serialize()],i.prototype,"base",void 0),__decorate([e.serialize()],i.prototype,"_ratio",void 0),i}(e.PostProcessRenderPipeline);e.SSAORenderingPipeline=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(r,n,o,s,a,h,c,l,u){var f=this;void 0===a&&(a=100),void 0===h&&(h=e.Texture.BILINEAR_SAMPLINGMODE),t.call(this,r,"volumetricLightScattering",["decay","exposure","weight","meshPositionOnScreen","density"],["lightScatteringSampler"],n.postProcessRatio||n,o,h,c,l,"#define NUM_SAMPLES "+a),this._screenCoordinates=e.Vector2.Zero(),this.customMeshPosition=e.Vector3.Zero(),this.useCustomMeshPosition=!1,this.invert=!0,this.excludedMeshes=new Array,this.exposure=.3,this.decay=.96815,this.weight=.58767,this.density=.926,u=null===o?u:o.getScene();var c=u.getEngine();this._viewPort=new e.Viewport(0,0,1,1).toGlobal(c.getRenderWidth(),c.getRenderHeight()),this.mesh=null!==s?s:i.CreateDefaultMesh("VolumetricLightScatteringMesh",u),this._createPass(u,n.passRatio||n),this.onActivate=function(e){f.isSupported||f.dispose(e),
f.onActivate=null},this.onApplyObservable.add(function(e){f._updateMeshScreenCoordinates(u),e.setTexture("lightScatteringSampler",f._volumetricLightScatteringRTT),e.setFloat("exposure",f.exposure),e.setFloat("decay",f.decay),e.setFloat("weight",f.weight),e.setFloat("density",f.density),e.setVector2("meshPositionOnScreen",f._screenCoordinates)})}return __extends(i,t),Object.defineProperty(i.prototype,"useDiffuseColor",{get:function(){return e.Tools.Warn("VolumetricLightScatteringPostProcess.useDiffuseColor is no longer used, use the mesh material directly instead"),!1},set:function(t){e.Tools.Warn("VolumetricLightScatteringPostProcess.useDiffuseColor is no longer used, use the mesh material directly instead")},enumerable:!0,configurable:!0}),i.prototype.isReady=function(t,i){var r=t.getMesh();if(r===this.mesh)return r.material.isReady(r);var n=[],o=[e.VertexBuffer.PositionKind],s=t.getMaterial();s&&(s.needAlphaTesting()&&n.push("#define ALPHATEST"),r.isVerticesDataPresent(e.VertexBuffer.UVKind)&&(o.push(e.VertexBuffer.UVKind),n.push("#define UV1")),r.isVerticesDataPresent(e.VertexBuffer.UV2Kind)&&(o.push(e.VertexBuffer.UV2Kind),n.push("#define UV2"))),r.useBones&&r.computeBonesUsingShaders?(o.push(e.VertexBuffer.MatricesIndicesKind),o.push(e.VertexBuffer.MatricesWeightsKind),n.push("#define NUM_BONE_INFLUENCERS "+r.numBoneInfluencers),n.push("#define BonesPerMesh "+(r.skeleton.bones.length+1))):n.push("#define NUM_BONE_INFLUENCERS 0"),i&&(n.push("#define INSTANCES"),o.push("world0"),o.push("world1"),o.push("world2"),o.push("world3"));var a=n.join("\n");return this._cachedDefines!==a&&(this._cachedDefines=a,this._volumetricLightScatteringPass=r.getScene().getEngine().createEffect({vertexElement:"depth",fragmentElement:"volumetricLightScatteringPass"},o,["world","mBones","viewProjection","diffuseMatrix"],["diffuseSampler"],a)),this._volumetricLightScatteringPass.isReady()},i.prototype.setCustomMeshPosition=function(e){this.customMeshPosition=e},i.prototype.getCustomMeshPosition=function(){return this.customMeshPosition},i.prototype.dispose=function(e){var i=e.getScene().customRenderTargets.indexOf(this._volumetricLightScatteringRTT);-1!==i&&e.getScene().customRenderTargets.splice(i,1),this._volumetricLightScatteringRTT.dispose(),t.prototype.dispose.call(this,e)},i.prototype.getPass=function(){return this._volumetricLightScatteringRTT},i.prototype._meshExcluded=function(e){return this.excludedMeshes.length>0&&-1!==this.excludedMeshes.indexOf(e)},i.prototype._createPass=function(t,i){var r=this,n=t.getEngine();this._volumetricLightScatteringRTT=new e.RenderTargetTexture("volumetricLightScatteringMap",{width:n.getRenderWidth()*i,height:n.getRenderHeight()*i},t,!1,!0,e.Engine.TEXTURETYPE_UNSIGNED_INT),this._volumetricLightScatteringRTT.wrapU=e.Texture.CLAMP_ADDRESSMODE,this._volumetricLightScatteringRTT.wrapV=e.Texture.CLAMP_ADDRESSMODE,this._volumetricLightScatteringRTT.renderList=null,this._volumetricLightScatteringRTT.renderParticles=!1,t.customRenderTargets.push(this._volumetricLightScatteringRTT);var o,s=function(t){var i=t.getRenderingMesh();if(!r._meshExcluded(i)){var n=i.getScene(),o=n.getEngine();o.setState(t.getMaterial().backFaceCulling);var s=i._getInstancesRenderList(t._id);if(!s.mustReturn){var a=null!==o.getCaps().instancedArrays&&null!==s.visibleInstances[t._id];if(r.isReady(t,a)){var h=r._volumetricLightScatteringPass;if(i===r.mesh&&(h=t.getMaterial().getEffect()),o.enableEffect(h),i._bind(t,h,e.Material.TriangleFillMode),i===r.mesh)t.getMaterial().bind(i.getWorldMatrix(),i);else{var c=t.getMaterial();if(r._volumetricLightScatteringPass.setMatrix("viewProjection",n.getTransformMatrix()),c&&c.needAlphaTesting()){var l=c.getAlphaTestTexture();r._volumetricLightScatteringPass.setTexture("diffuseSampler",l),l&&r._volumetricLightScatteringPass.setMatrix("diffuseMatrix",l.getTextureMatrix())}i.useBones&&i.computeBonesUsingShaders&&r._volumetricLightScatteringPass.setMatrices("mBones",i.skeleton.getTransformMatrices(i))}i._processRendering(t,r._volumetricLightScatteringPass,e.Material.TriangleFillMode,s,a,function(e,t){return h.setMatrix("world",t)})}}}},a=new e.Color4(0,0,0,1);this._volumetricLightScatteringRTT.onBeforeRenderObservable.add(function(){o=t.clearColor,t.clearColor=a}),this._volumetricLightScatteringRTT.onAfterRenderObservable.add(function(){t.clearColor=o}),this._volumetricLightScatteringRTT.customRenderFunction=function(i,r,n){var o,a=t.getEngine();for(o=0;o<i.length;o++)s(i.data[o]);for(a.setAlphaTesting(!0),o=0;o<r.length;o++)s(r.data[o]);if(a.setAlphaTesting(!1),n.length){for(o=0;o<n.length;o++){var h=n.data[o];h._alphaIndex=h.getMesh().alphaIndex,h._distanceToCamera=h.getBoundingInfo().boundingSphere.centerWorld.subtract(t.activeCamera.position).length()}var c=n.data.slice(0,n.length);for(c.sort(function(e,t){return e._alphaIndex>t._alphaIndex?1:e._alphaIndex<t._alphaIndex?-1:e._distanceToCamera<t._distanceToCamera?1:e._distanceToCamera>t._distanceToCamera?-1:0}),a.setAlphaMode(e.Engine.ALPHA_COMBINE),o=0;o<c.length;o++)s(c[o]);a.setAlphaMode(e.Engine.ALPHA_DISABLE)}}},i.prototype._updateMeshScreenCoordinates=function(t){var i,r=t.getTransformMatrix();i=this.useCustomMeshPosition?this.customMeshPosition:this.attachedNode?this.attachedNode.position:this.mesh.parent?this.mesh.getAbsolutePosition():this.mesh.position;var n=e.Vector3.Project(i,e.Matrix.Identity(),r,this._viewPort);this._screenCoordinates.x=n.x/this._viewPort.width,this._screenCoordinates.y=n.y/this._viewPort.height,this.invert&&(this._screenCoordinates.y=1-this._screenCoordinates.y)},i.CreateDefaultMesh=function(t,i){var r=e.Mesh.CreatePlane(t,1,i);r.billboardMode=e.AbstractMesh.BILLBOARDMODE_ALL;var n=new e.StandardMaterial(t+"Material",i);return n.emissiveColor=new e.Color3(1,1,1),r.material=n,r},__decorate([e.serializeAsVector3()],i.prototype,"customMeshPosition",void 0),__decorate([e.serialize()],i.prototype,"useCustomMeshPosition",void 0),__decorate([e.serialize()],i.prototype,"invert",void 0),__decorate([e.serializeAsMeshReference()],i.prototype,"mesh",void 0),__decorate([e.serialize()],i.prototype,"excludedMeshes",void 0),__decorate([e.serialize()],i.prototype,"exposure",void 0),__decorate([e.serialize()],i.prototype,"decay",void 0),__decorate([e.serialize()],i.prototype,"weight",void 0),__decorate([e.serialize()],i.prototype,"density",void 0),i}(e.PostProcess);e.VolumetricLightScatteringPostProcess=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(i,r,n,o,s){var a=this;void 0===o&&(o=1),t.call(this,n.getEngine(),i),this.LensChromaticAberrationEffect="LensChromaticAberrationEffect",this.HighlightsEnhancingEffect="HighlightsEnhancingEffect",this.LensDepthOfFieldEffect="LensDepthOfFieldEffect",this._scene=n,this._depthTexture=n.enableDepthRenderer().getDepthMap(),r.grain_texture?this._grainTexture=r.grain_texture:this._createGrainTexture(),this._edgeBlur=r.edge_blur?r.edge_blur:0,this._grainAmount=r.grain_amount?r.grain_amount:0,this._chromaticAberration=r.chromatic_aberration?r.chromatic_aberration:0,this._distortion=r.distortion?r.distortion:0,this._highlightsGain=void 0!==r.dof_gain?r.dof_gain:-1,this._highlightsThreshold=r.dof_threshold?r.dof_threshold:1,this._dofDistance=void 0!==r.dof_focus_distance?r.dof_focus_distance:-1,this._dofAperture=r.dof_aperture?r.dof_aperture:1,this._dofDarken=r.dof_darken?r.dof_darken:0,this._dofPentagon=void 0!==r.dof_pentagon?r.dof_pentagon:!0,this._blurNoise=void 0!==r.blur_noise?r.blur_noise:!0,this._createChromaticAberrationPostProcess(o),this._createHighlightsPostProcess(o),this._createDepthOfFieldPostProcess(o/4),this.addEffect(new e.PostProcessRenderEffect(n.getEngine(),this.LensChromaticAberrationEffect,function(){return a._chromaticAberrationPostProcess},!0)),this.addEffect(new e.PostProcessRenderEffect(n.getEngine(),this.HighlightsEnhancingEffect,function(){return a._highlightsPostProcess},!0)),this.addEffect(new e.PostProcessRenderEffect(n.getEngine(),this.LensDepthOfFieldEffect,function(){return a._depthOfFieldPostProcess},!0)),-1===this._highlightsGain&&this._disableEffect(this.HighlightsEnhancingEffect,null),n.postProcessRenderPipelineManager.addPipeline(this),s&&n.postProcessRenderPipelineManager.attachCamerasToRenderPipeline(i,s)}return __extends(i,t),i.prototype.setEdgeBlur=function(e){this._edgeBlur=e},i.prototype.disableEdgeBlur=function(){this._edgeBlur=0},i.prototype.setGrainAmount=function(e){this._grainAmount=e},i.prototype.disableGrain=function(){this._grainAmount=0},i.prototype.setChromaticAberration=function(e){this._chromaticAberration=e},i.prototype.disableChromaticAberration=function(){this._chromaticAberration=0},i.prototype.setEdgeDistortion=function(e){this._distortion=e},i.prototype.disableEdgeDistortion=function(){this._distortion=0},i.prototype.setFocusDistance=function(e){this._dofDistance=e},i.prototype.disableDepthOfField=function(){this._dofDistance=-1},i.prototype.setAperture=function(e){this._dofAperture=e},i.prototype.setDarkenOutOfFocus=function(e){this._dofDarken=e},i.prototype.enablePentagonBokeh=function(){this._highlightsPostProcess.updateEffect("#define PENTAGON\n")},i.prototype.disablePentagonBokeh=function(){this._highlightsPostProcess.updateEffect()},i.prototype.enableNoiseBlur=function(){this._blurNoise=!0},i.prototype.disableNoiseBlur=function(){this._blurNoise=!1},i.prototype.setHighlightsGain=function(e){this._highlightsGain=e},i.prototype.setHighlightsThreshold=function(e){-1===this._highlightsGain&&(this._highlightsGain=1),this._highlightsThreshold=e},i.prototype.disableHighlights=function(){this._highlightsGain=-1},i.prototype.dispose=function(e){void 0===e&&(e=!1),this._scene.postProcessRenderPipelineManager.detachCamerasFromRenderPipeline(this._name,this._scene.cameras),this._chromaticAberrationPostProcess=void 0,this._highlightsPostProcess=void 0,this._depthOfFieldPostProcess=void 0,this._grainTexture.dispose(),e&&this._scene.disableDepthRenderer()},i.prototype._createChromaticAberrationPostProcess=function(t){var i=this;this._chromaticAberrationPostProcess=new e.PostProcess("LensChromaticAberration","chromaticAberration",["chromatic_aberration","screen_width","screen_height"],[],t,null,e.Texture.TRILINEAR_SAMPLINGMODE,this._scene.getEngine(),!1),this._chromaticAberrationPostProcess.onApply=function(e){e.setFloat("chromatic_aberration",i._chromaticAberration),e.setFloat("screen_width",i._scene.getEngine().getRenderingCanvas().width),e.setFloat("screen_height",i._scene.getEngine().getRenderingCanvas().height)}},i.prototype._createHighlightsPostProcess=function(t){var i=this;this._highlightsPostProcess=new e.PostProcess("LensHighlights","lensHighlights",["gain","threshold","screen_width","screen_height"],[],t,null,e.Texture.TRILINEAR_SAMPLINGMODE,this._scene.getEngine(),!1,this._dofPentagon?"#define PENTAGON\n":""),this._highlightsPostProcess.onApply=function(e){e.setFloat("gain",i._highlightsGain),e.setFloat("threshold",i._highlightsThreshold),e.setTextureFromPostProcess("textureSampler",i._chromaticAberrationPostProcess),e.setFloat("screen_width",i._scene.getEngine().getRenderingCanvas().width),e.setFloat("screen_height",i._scene.getEngine().getRenderingCanvas().height)}},i.prototype._createDepthOfFieldPostProcess=function(t){var i=this;this._depthOfFieldPostProcess=new e.PostProcess("LensDepthOfField","depthOfField",["grain_amount","blur_noise","screen_width","screen_height","distortion","dof_enabled","screen_distance","aperture","darken","edge_blur","highlights","near","far"],["depthSampler","grainSampler","highlightsSampler"],t,null,e.Texture.TRILINEAR_SAMPLINGMODE,this._scene.getEngine(),!1),this._depthOfFieldPostProcess.onApply=function(e){e.setTexture("depthSampler",i._depthTexture),e.setTexture("grainSampler",i._grainTexture),e.setTextureFromPostProcess("textureSampler",i._highlightsPostProcess),e.setTextureFromPostProcess("highlightsSampler",i._depthOfFieldPostProcess),e.setFloat("grain_amount",i._grainAmount),e.setBool("blur_noise",i._blurNoise),e.setFloat("screen_width",i._scene.getEngine().getRenderingCanvas().width),e.setFloat("screen_height",i._scene.getEngine().getRenderingCanvas().height),e.setFloat("distortion",i._distortion),e.setBool("dof_enabled",-1!==i._dofDistance),e.setFloat("screen_distance",1/(.1-1/i._dofDistance)),e.setFloat("aperture",i._dofAperture),e.setFloat("darken",i._dofDarken),e.setFloat("edge_blur",i._edgeBlur),e.setBool("highlights",-1!==i._highlightsGain),e.setFloat("near",i._scene.activeCamera.minZ),e.setFloat("far",i._scene.activeCamera.maxZ)}},i.prototype._createGrainTexture=function(){var t=512;this._grainTexture=new e.DynamicTexture("LensNoiseTexture",t,this._scene,!1,e.Texture.BILINEAR_SAMPLINGMODE),this._grainTexture.wrapU=e.Texture.WRAP_ADDRESSMODE,this._grainTexture.wrapV=e.Texture.WRAP_ADDRESSMODE;for(var i,r=this._grainTexture.getContext(),n=function(e,t){return Math.random()*(t-e)+e},o=0;t>o;o++)for(var s=0;t>s;s++)i=Math.floor(255*n(.42,.58)),r.fillStyle="rgb("+i+", "+i+", "+i+")",r.fillRect(o,s,1,1);this._grainTexture.update(!1)},i}(e.PostProcessRenderPipeline);e.LensRenderingPipeline=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(i,r,n,o,s,a,h){var c=this;t.call(this,i,"colorCorrection",null,["colorTable"],n,o,s,a,h),this._colorTableTexture=new e.Texture(r,o.getScene(),!0,!1,e.Texture.TRILINEAR_SAMPLINGMODE),this._colorTableTexture.anisotropicFilteringLevel=1,this._colorTableTexture.wrapU=e.Texture.CLAMP_ADDRESSMODE,this._colorTableTexture.wrapV=e.Texture.CLAMP_ADDRESSMODE,this.onApply=function(e){e.setTexture("colorTable",c._colorTableTexture)}}return __extends(i,t),i}(e.PostProcess);e.ColorCorrectionPostProcess=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(i,r,n,o){t.call(this,i,r,o),this.interaxialDistance=n,this.setCameraRigMode(e.Camera.RIG_MODE_STEREOSCOPIC_ANAGLYPH,{interaxialDistance:n})}return __extends(i,t),i.prototype.getTypeName=function(){return"AnaglyphFreeCamera"},i}(e.FreeCamera);e.AnaglyphFreeCamera=t;var i=function(t){function i(i,r,n,o,s,a,h){t.call(this,i,r,n,o,s,h),this.interaxialDistance=a,this.setCameraRigMode(e.Camera.RIG_MODE_STEREOSCOPIC_ANAGLYPH,{interaxialDistance:a})}return __extends(i,t),i.prototype.getTypeName=function(){return"AnaglyphArcRotateCamera"},i}(e.ArcRotateCamera);e.AnaglyphArcRotateCamera=i;var r=function(t){function i(i,r,n,o){t.call(this,i,r,o),this.interaxialDistance=n,this.setCameraRigMode(e.Camera.RIG_MODE_STEREOSCOPIC_ANAGLYPH,{interaxialDistance:n})}return __extends(i,t),i.prototype.getTypeName=function(){return"AnaglyphGamepadCamera"},i}(e.GamepadCamera);e.AnaglyphGamepadCamera=r;var n=function(t){function i(i,r,n,o){t.call(this,i,r,o),this.interaxialDistance=n,this.setCameraRigMode(e.Camera.RIG_MODE_STEREOSCOPIC_ANAGLYPH,{interaxialDistance:n})}return __extends(i,t),i.prototype.getTypeName=function(){return"AnaglyphUniversalCamera"},i}(e.UniversalCamera);e.AnaglyphUniversalCamera=n;var o=function(t){function i(i,r,n,o,s){t.call(this,i,r,s),this.interaxialDistance=n,this.isStereoscopicSideBySide=o,this.setCameraRigMode(o?e.Camera.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:e.Camera.RIG_MODE_STEREOSCOPIC_OVERUNDER,{interaxialDistance:n})}return __extends(i,t),i.prototype.getTypeName=function(){return"StereoscopicFreeCamera"},i}(e.FreeCamera);e.StereoscopicFreeCamera=o;var s=function(t){function i(i,r,n,o,s,a,h,c){t.call(this,i,r,n,o,s,c),this.interaxialDistance=a,this.isStereoscopicSideBySide=h,this.setCameraRigMode(h?e.Camera.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:e.Camera.RIG_MODE_STEREOSCOPIC_OVERUNDER,{interaxialDistance:a})}return __extends(i,t),i.prototype.getTypeName=function(){return"StereoscopicArcRotateCamera"},i}(e.ArcRotateCamera);e.StereoscopicArcRotateCamera=s;var a=function(t){function i(i,r,n,o,s){t.call(this,i,r,s),this.interaxialDistance=n,this.isStereoscopicSideBySide=o,this.setCameraRigMode(o?e.Camera.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:e.Camera.RIG_MODE_STEREOSCOPIC_OVERUNDER,{interaxialDistance:n})}return __extends(i,t),i.prototype.getTypeName=function(){return"StereoscopicGamepadCamera"},i}(e.GamepadCamera);e.StereoscopicGamepadCamera=a;var h=function(t){function i(i,r,n,o,s){t.call(this,i,r,s),this.interaxialDistance=n,this.isStereoscopicSideBySide=o,this.setCameraRigMode(o?e.Camera.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:e.Camera.RIG_MODE_STEREOSCOPIC_OVERUNDER,{interaxialDistance:n})}return __extends(i,t),i.prototype.getTypeName=function(){return"StereoscopicUniversalCamera"},i}(e.UniversalCamera);e.StereoscopicUniversalCamera=h}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(r,n,o,s,a){var h=this;void 0===s&&(s=null),t.call(this,n.getEngine(),r),this.gaussCoeff=.3,this.gaussMean=1,this.gaussStandDev=.8,this.gaussMultiplier=4,this.exposure=1,this.minimumLuminance=1,this.maximumLuminance=1e20,this.luminanceIncreaserate=.5,this.luminanceDecreaseRate=.5,this.brightThreshold=.8,this._needUpdate=!0,this._scene=n,this._createBrightPassPostProcess(n,o),this._createDownSampleX4PostProcess(n,o),this._createGaussianBlurPostProcess(n,o),this._createTextureAdderPostProcess(n,o),this._createLuminanceGeneratorPostProcess(n),this._createHDRPostProcess(n,o),null===s?this._originalPostProcess=new e.PassPostProcess("hdr",o,null,e.Texture.BILINEAR_SAMPLINGMODE,n.getEngine(),!1):this._originalPostProcess=s,this.addEffect(new e.PostProcessRenderEffect(n.getEngine(),"HDRPassPostProcess",function(){return h._originalPostProcess},!0)),this.addEffect(new e.PostProcessRenderEffect(n.getEngine(),"HDRBrightPass",function(){return h._brightPassPostProcess},!0)),this.addEffect(new e.PostProcessRenderEffect(n.getEngine(),"HDRDownSampleX4",function(){return h._downSampleX4PostProcess},!0)),this.addEffect(new e.PostProcessRenderEffect(n.getEngine(),"HDRGaussianBlurH",function(){return h._guassianBlurHPostProcess},!0)),this.addEffect(new e.PostProcessRenderEffect(n.getEngine(),"HDRGaussianBlurV",function(){return h._guassianBlurVPostProcess},!0)),this.addEffect(new e.PostProcessRenderEffect(n.getEngine(),"HDRTextureAdder",function(){return h._textureAdderPostProcess},!0));for(var c=function(t){h.addEffect(new e.PostProcessRenderEffect(n.getEngine(),"HDRDownSampler"+t,function(){return h._downSamplePostProcesses[t]},!0))},l=i.LUM_STEPS-1;l>=0;l--)c(l);this.addEffect(new e.PostProcessRenderEffect(n.getEngine(),"HDR",function(){return h._hdrPostProcess},!0)),n.postProcessRenderPipelineManager.addPipeline(this),null!==a&&n.postProcessRenderPipelineManager.attachCamerasToRenderPipeline(r,a),this.update()}return __extends(i,t),i.prototype.update=function(){this._needUpdate=!0},i.prototype.getCurrentLuminance=function(){return this._hdrCurrentLuminance},i.prototype.getOutputLuminance=function(){return this._hdrOutputLuminance},i.prototype.dispose=function(){this._originalPostProcess=void 0,this._brightPassPostProcess=void 0,this._downSampleX4PostProcess=void 0,this._guassianBlurHPostProcess=void 0,this._guassianBlurVPostProcess=void 0,this._textureAdderPostProcess=void 0;for(var e=i.LUM_STEPS-1;e>=0;e--)this._downSamplePostProcesses[e]=void 0;this._hdrPostProcess=void 0,this._scene.postProcessRenderPipelineManager.detachCamerasFromRenderPipeline(this._name,this._scene.cameras)},i.prototype._createHDRPostProcess=function(t,i){var r=this,n=0;this._hdrOutputLuminance=-1,this._hdrCurrentLuminance=1,this._hdrPostProcess=new e.PostProcess("hdr","hdr",["exposure","avgLuminance"],["otherSampler"],i,null,e.Texture.BILINEAR_SAMPLINGMODE,t.getEngine(),!1,"#define HDR"),this._hdrPostProcess.onApply=function(i){if(r._hdrOutputLuminance<0)r._hdrOutputLuminance=r._hdrCurrentLuminance;else{var o=(n-(n+t.getEngine().getDeltaTime()))/1e3;r._hdrCurrentLuminance<r._hdrOutputLuminance+r.luminanceDecreaseRate*o?r._hdrOutputLuminance+=r.luminanceDecreaseRate*o:r._hdrCurrentLuminance>r._hdrOutputLuminance-r.luminanceIncreaserate*o?r._hdrOutputLuminance-=r.luminanceIncreaserate*o:r._hdrOutputLuminance=r._hdrCurrentLuminance}r._hdrOutputLuminance=e.MathTools.Clamp(r._hdrOutputLuminance,r.minimumLuminance,r.maximumLuminance),n+=t.getEngine().getDeltaTime(),i.setTextureFromPostProcess("textureSampler",r._textureAdderPostProcess),i.setTextureFromPostProcess("otherSampler",r._originalPostProcess),i.setFloat("exposure",r.exposure),i.setFloat("avgLuminance",r._hdrOutputLuminance),r._needUpdate=!1}},i.prototype._createTextureAdderPostProcess=function(t,i){var r=this;this._textureAdderPostProcess=new e.PostProcess("hdr","hdr",[],["otherSampler"],i,null,e.Texture.BILINEAR_SAMPLINGMODE,t.getEngine(),!1,"#define TEXTURE_ADDER"),this._textureAdderPostProcess.onApply=function(e){e.setTextureFromPostProcess("otherSampler",r._originalPostProcess)}},i.prototype._createDownSampleX4PostProcess=function(t,i){var r=this,n=new Array(32);this._downSampleX4PostProcess=new e.PostProcess("hdr","hdr",["dsOffsets"],[],i/4,null,e.Texture.BILINEAR_SAMPLINGMODE,t.getEngine(),!1,"#define DOWN_SAMPLE_X4"),this._downSampleX4PostProcess.onApply=function(e){if(r._needUpdate)for(var t=0,i=-2;2>i;i++)for(var o=-2;2>o;o++)n[t]=(i+.5)*(1/r._downSampleX4PostProcess.width),n[t+1]=(o+.5)*(1/r._downSampleX4PostProcess.height),t+=2;e.setArray2("dsOffsets",n)}},i.prototype._createBrightPassPostProcess=function(t,i){var r=this,n=new Array(8),o=function(e){if(r._needUpdate){var t=1/r._brightPassPostProcess.width,i=1/r._brightPassPostProcess.height;n[0]=-.5*t,n[1]=.5*i,n[2]=.5*t,n[3]=.5*i,n[4]=-.5*t,n[5]=-.5*i,n[6]=.5*t,n[7]=-.5*i}e.setArray2("dsOffsets",n),e.setFloat("brightThreshold",r.brightThreshold)};this._brightPassPostProcess=new e.PostProcess("hdr","hdr",["dsOffsets","brightThreshold"],[],i,null,e.Texture.BILINEAR_SAMPLINGMODE,t.getEngine(),!1,"#define BRIGHT_PASS"),this._brightPassPostProcess.onApply=o},i.prototype._createLuminanceGeneratorPostProcess=function(t){var r,n=this,o=i.LUM_STEPS,s=new Array(8),a=new Array(18);this._downSamplePostProcesses=new Array(o);var h=function(e,t){var i=1/e,r=1/t;s[0]=-.5*i,s[1]=.5*r,s[2]=.5*i,s[3]=.5*r,s[4]=-.5*i,s[5]=-.5*r,s[6]=.5*i,s[7]=-.5*r},c=function(e,t){for(var i=0,r=-1;2>r;r++)for(var n=-1;2>n;n++)a[i]=r/e,a[i+1]=n/t,i+=2},l=function(e){n._needUpdate&&h(n._textureAdderPostProcess.width,n._textureAdderPostProcess.height),e.setTextureFromPostProcess("textureSampler",n._textureAdderPostProcess),e.setArray2("lumOffsets",s)},u=function(e){var t=e;return function(e){h(n._downSamplePostProcesses[t].width,n._downSamplePostProcesses[t].height),c(n._downSamplePostProcesses[t].width,n._downSamplePostProcesses[t].height),r=.5/n._downSamplePostProcesses[t].width,e.setTextureFromPostProcess("textureSampler",n._downSamplePostProcesses[t+1]),e.setFloat("halfDestPixelSize",r),e.setArray2("dsOffsets",a)}},f=function(i){var r=t.getEngine().readPixels(0,0,1,1),o=new e.Vector4(1/16581375,1/65025,1/255,1);n._hdrCurrentLuminance=(r[0]*o.x+r[1]*o.y+r[2]*o.z+r[3]*o.w)/100},d={width:Math.pow(3,o-1),height:Math.pow(3,o-1)};this._downSamplePostProcesses[o-1]=new e.PostProcess("hdr","hdr",["lumOffsets"],[],d,null,e.Texture.NEAREST_SAMPLINGMODE,t.getEngine(),!1,"#define LUMINANCE_GENERATOR",e.Engine.TEXTURETYPE_FLOAT),this._downSamplePostProcesses[o-1].onApply=l;for(var p=o-2;p>=0;p--){var _=Math.pow(3,p);d={width:_,height:_};var m="#define DOWN_SAMPLE\n";0===p&&(m+="#define FINAL_DOWN_SAMPLE\n"),this._downSamplePostProcesses[p]=new e.PostProcess("hdr","hdr",["dsOffsets","halfDestPixelSize"],[],d,null,e.Texture.NEAREST_SAMPLINGMODE,t.getEngine(),!1,m,e.Engine.TEXTURETYPE_FLOAT),this._downSamplePostProcesses[p].onApply=u(p),0===p&&(this._downSamplePostProcesses[p].onAfterRender=f)}},i.prototype._createGaussianBlurPostProcess=function(t,i){var r=this,n=new Array(9),o=new Array(9),s=new Array(9),a=["blurOffsets","blurWeights","multiplier"],h=function(e){for(var i={width:t.getEngine().getRenderWidth(),height:t.getEngine().getRenderHeight()},r=0;9>r;r++){var s=(r-4)*(1/(e===!0?i.height:i.width));e?o[r]=s:n[r]=s}},c=function(){for(var e=0,t=0;9>t;t++)e=(t-4)/4,s[t]=r.gaussCoeff*(1/Math.sqrt(2*Math.PI*r.gaussStandDev))*Math.exp(-((e-r.gaussMean)*(e-r.gaussMean))/(2*r.gaussStandDev*r.gaussStandDev))},l=function(e){return function(t){r._needUpdate&&(c(),h(e)),t.setArray("blurOffsets",e?o:n),t.setArray("blurWeights",s),t.setFloat("multiplier",r.gaussMultiplier)}};this._guassianBlurHPostProcess=new e.PostProcess("hdr","hdr",a,[],i/4,null,e.Texture.BILINEAR_SAMPLINGMODE,t.getEngine(),!1,"#define GAUSSIAN_BLUR_H"),this._guassianBlurHPostProcess.onApply=l(!1),this._guassianBlurVPostProcess=new e.PostProcess("hdr","hdr",a,[],i/4,null,e.Texture.BILINEAR_SAMPLINGMODE,t.getEngine(),!1,"#define GAUSSIAN_BLUR_V"),this._guassianBlurVPostProcess.onApply=l(!0)},i.LUM_STEPS=6,i}(e.PostProcessRenderPipeline);e.HDRRenderingPipeline=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function e(){this.edges=new Array,this.edgesConnectedCount=0}return e}(),i=function(){function i(e,t,i){void 0===t&&(t=.95),void 0===i&&(i=!1),this.edgesWidthScalerForOrthographic=1e3,this.edgesWidthScalerForPerspective=50,this._linesPositions=new Array,this._linesNormals=new Array,this._linesIndices=new Array,this._buffers={},this._checkVerticesInsteadOfIndices=!1,this._source=e,this._checkVerticesInsteadOfIndices=i,this._epsilon=t,this._prepareRessources(),this._generateEdgesLines()}return i.prototype._prepareRessources=function(){this._lineShader||(this._lineShader=new e.ShaderMaterial("lineShader",this._source.getScene(),"line",{attributes:["position","normal"],uniforms:["worldViewProjection","color","width","aspectRatio"]}),this._lineShader.disableDepthWrite=!0,this._lineShader.backFaceCulling=!1)},i.prototype.dispose=function(){var t=this._buffers[e.VertexBuffer.PositionKind];t&&(t.dispose(),this._buffers[e.VertexBuffer.PositionKind]=null),t=this._buffers[e.VertexBuffer.NormalKind],t&&(t.dispose(),this._buffers[e.VertexBuffer.NormalKind]=null),this._source.getScene().getEngine()._releaseBuffer(this._ib),this._lineShader.dispose()},i.prototype._processEdgeForAdjacencies=function(e,t,i,r,n){return e===i&&t===r||e===r&&t===i?0:e===r&&t===n||e===n&&t===r?1:e===n&&t===i||e===i&&t===n?2:-1},i.prototype._processEdgeForAdjacenciesWithVertices=function(e,t,i,r,n){return e.equalsWithEpsilon(i)&&t.equalsWithEpsilon(r)||e.equalsWithEpsilon(r)&&t.equalsWithEpsilon(i)?0:e.equalsWithEpsilon(r)&&t.equalsWithEpsilon(n)||e.equalsWithEpsilon(n)&&t.equalsWithEpsilon(r)?1:e.equalsWithEpsilon(n)&&t.equalsWithEpsilon(i)||e.equalsWithEpsilon(i)&&t.equalsWithEpsilon(n)?2:-1},i.prototype._checkEdge=function(t,i,r,n,o){var s;if(void 0===i)s=!0;else{var a=e.Vector3.Dot(r[t],r[i]);s=a<this._epsilon}if(s){var h=this._linesPositions.length/3,c=n.subtract(o);c.normalize(),this._linesPositions.push(n.x),this._linesPositions.push(n.y),this._linesPositions.push(n.z),this._linesPositions.push(n.x),this._linesPositions.push(n.y),this._linesPositions.push(n.z),this._linesPositions.push(o.x),this._linesPositions.push(o.y),this._linesPositions.push(o.z),this._linesPositions.push(o.x),this._linesPositions.push(o.y),this._linesPositions.push(o.z),this._linesNormals.push(o.x),this._linesNormals.push(o.y),this._linesNormals.push(o.z),this._linesNormals.push(-1),this._linesNormals.push(o.x),this._linesNormals.push(o.y),this._linesNormals.push(o.z),this._linesNormals.push(1),this._linesNormals.push(n.x),this._linesNormals.push(n.y),this._linesNormals.push(n.z),this._linesNormals.push(-1),this._linesNormals.push(n.x),this._linesNormals.push(n.y),this._linesNormals.push(n.z),this._linesNormals.push(1),this._linesIndices.push(h),this._linesIndices.push(h+1),this._linesIndices.push(h+2),this._linesIndices.push(h),this._linesIndices.push(h+2),this._linesIndices.push(h+3)}},i.prototype._generateEdgesLines=function(){var i,r,n=this._source.getVerticesData(e.VertexBuffer.PositionKind),o=this._source.getIndices(),s=new Array,a=new Array;for(i=0;i<o.length;i+=3){r=new t;var h=o[i],c=o[i+1],l=o[i+2];r.p0=new e.Vector3(n[3*h],n[3*h+1],n[3*h+2]),r.p1=new e.Vector3(n[3*c],n[3*c+1],n[3*c+2]),r.p2=new e.Vector3(n[3*l],n[3*l+1],n[3*l+2]);var u=e.Vector3.Cross(r.p1.subtract(r.p0),r.p2.subtract(r.p1));u.normalize(),a.push(u),s.push(r)}for(i=0;i<s.length;i++){r=s[i];for(var f=i+1;f<s.length;f++){var d=s[f];if(3===r.edgesConnectedCount)break;if(3!==d.edgesConnectedCount)for(var p=o[3*f],_=o[3*f+1],m=o[3*f+2],g=0;3>g;g++){var v;if(void 0===r.edges[g]){switch(g){case 0:v=this._checkVerticesInsteadOfIndices?this._processEdgeForAdjacenciesWithVertices(r.p0,r.p1,d.p0,d.p1,d.p2):this._processEdgeForAdjacencies(o[3*i],o[3*i+1],p,_,m);break;case 1:v=this._checkVerticesInsteadOfIndices?this._processEdgeForAdjacenciesWithVertices(r.p1,r.p2,d.p0,d.p1,d.p2):this._processEdgeForAdjacencies(o[3*i+1],o[3*i+2],p,_,m);break;case 2:v=this._checkVerticesInsteadOfIndices?this._processEdgeForAdjacenciesWithVertices(r.p2,r.p0,d.p0,d.p1,d.p2):this._processEdgeForAdjacencies(o[3*i+2],o[3*i],p,_,m)}if(-1!==v&&(r.edges[g]=f,d.edges[v]=i,r.edgesConnectedCount++,d.edgesConnectedCount++,3===r.edgesConnectedCount))break}}}}for(i=0;i<s.length;i++){var y=s[i];this._checkEdge(i,y.edges[0],a,y.p0,y.p1),this._checkEdge(i,y.edges[1],a,y.p1,y.p2),this._checkEdge(i,y.edges[2],a,y.p2,y.p0)}var x=this._source.getScene().getEngine();this._buffers[e.VertexBuffer.PositionKind]=new e.VertexBuffer(x,this._linesPositions,e.VertexBuffer.PositionKind,!1),this._buffers[e.VertexBuffer.NormalKind]=new e.VertexBuffer(x,this._linesNormals,e.VertexBuffer.NormalKind,!1,!1,4),this._ib=x.createIndexBuffer(this._linesIndices),this._indicesCount=this._linesIndices.length},i.prototype.render=function(){if(this._lineShader.isReady()){var t=this._source.getScene(),i=t.getEngine();this._lineShader._preBind(),i.bindBuffers(this._buffers,this._ib,this._lineShader.getEffect()),t.resetCachedMaterial(),this._lineShader.setColor4("color",this._source.edgesColor),t.activeCamera.mode===e.Camera.ORTHOGRAPHIC_CAMERA?this._lineShader.setFloat("width",this._source.edgesWidth/this.edgesWidthScalerForOrthographic):this._lineShader.setFloat("width",this._source.edgesWidth/this.edgesWidthScalerForPerspective),this._lineShader.setFloat("aspectRatio",i.getAspectRatio(t.activeCamera)),this._lineShader.bind(this._source.getWorldMatrix()),i.draw(!0,0,this._indicesCount),this._lineShader.unbind(),i.setDepthWrite(!0)}},i}();e.EdgesRenderer=i}(BABYLON||(BABYLON={}));var BABYLON;!function(e){!function(e){e[e.Hable=0]="Hable",e[e.Reinhard=1]="Reinhard",e[e.HejiDawson=2]="HejiDawson",e[e.Photographic=3]="Photographic"}(e.TonemappingOperator||(e.TonemappingOperator={}));var t=e.TonemappingOperator,i=function(i){function r(r,n,o,s,a,h,c){var l=this;void 0===a&&(a=e.Texture.BILINEAR_SAMPLINGMODE),void 0===c&&(c=e.Engine.TEXTURETYPE_UNSIGNED_INT),i.call(this,r,"tonemap",["_ExposureAdjustment"],null,1,s,a,h,!0,u,c),this._operator=n,this.exposureAdjustment=o;var u="#define ";this._operator===t.Hable?u+="HABLE_TONEMAPPING":this._operator===t.Reinhard?u+="REINHARD_TONEMAPPING":this._operator===t.HejiDawson?u+="OPTIMIZED_HEJIDAWSON_TONEMAPPING":this._operator===t.Photographic&&(u+="PHOTOGRAPHIC_TONEMAPPING"),this.updateEffect(u),this.onApply=function(e){e.setFloat("_ExposureAdjustment",l.exposureAdjustment)}}return __extends(r,i),r}(e.PostProcess);e.TonemapPostProcess=i}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(t,i,r,n){var o=this;void 0===n&&(n=!0),this.name=t,this._viewMatrix=e.Matrix.Identity(),this._target=e.Vector3.Zero(),this._add=e.Vector3.Zero(),this.invertYAxis=!1,this.position=e.Vector3.Zero(),this._scene=r,this._scene.reflectionProbes.push(this),this._renderTargetTexture=new e.RenderTargetTexture(t,i,r,n,!0,e.Engine.TEXTURETYPE_UNSIGNED_INT,!0),this._renderTargetTexture.onBeforeRenderObservable.add(function(t){switch(t){case 0:o._add.copyFromFloats(1,0,0);break;case 1:o._add.copyFromFloats(-1,0,0);break;case 2:o._add.copyFromFloats(0,o.invertYAxis?1:-1,0);break;case 3:o._add.copyFromFloats(0,o.invertYAxis?-1:1,0);break;case 4:o._add.copyFromFloats(0,0,1);break;case 5:
o._add.copyFromFloats(0,0,-1)}o._attachedMesh&&o.position.copyFrom(o._attachedMesh.getAbsolutePosition()),o.position.addToRef(o._add,o._target),e.Matrix.LookAtLHToRef(o.position,o._target,e.Vector3.Up(),o._viewMatrix),r.setTransformMatrix(o._viewMatrix,o._projectionMatrix)}),this._renderTargetTexture.onAfterUnbindObservable.add(function(){r.updateTransformMatrix(!0)}),this._projectionMatrix=e.Matrix.PerspectiveFovLH(Math.PI/2,1,r.activeCamera.minZ,r.activeCamera.maxZ)}return Object.defineProperty(t.prototype,"refreshRate",{get:function(){return this._renderTargetTexture.refreshRate},set:function(e){this._renderTargetTexture.refreshRate=e},enumerable:!0,configurable:!0}),t.prototype.getScene=function(){return this._scene},Object.defineProperty(t.prototype,"cubeTexture",{get:function(){return this._renderTargetTexture},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderList",{get:function(){return this._renderTargetTexture.renderList},enumerable:!0,configurable:!0}),t.prototype.attachToMesh=function(e){this._attachedMesh=e},t.prototype.dispose=function(){var e=this._scene.reflectionProbes.indexOf(this);-1!==e&&this._scene.reflectionProbes.splice(e,1),this._renderTargetTexture&&(this._renderTargetTexture.dispose(),this._renderTargetTexture=null)},t}();e.ReflectionProbe=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(t,i,r,n,o){this.color=new e.Color4(1,1,1,1),this.position=e.Vector3.Zero(),this.rotation=e.Vector3.Zero(),this.scaling=new e.Vector3(1,1,1),this.uvs=new e.Vector4(0,0,1,1),this.velocity=e.Vector3.Zero(),this.alive=!0,this.isVisible=!0,this.idx=t,this._pos=i,this._model=r,this.shapeId=n,this.idxInShape=o}return Object.defineProperty(t.prototype,"scale",{get:function(){return this.scaling},set:function(e){this.scaling=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"quaternion",{get:function(){return this.rotationQuaternion},set:function(e){this.rotationQuaternion=e},enumerable:!0,configurable:!0}),t}();e.SolidParticle=t;var i=function(){function e(e,t,i,r,n){this.shapeID=e,this._shape=t,this._shapeUV=i,this._positionFunction=r,this._vertexFunction=n}return e}();e.ModelShape=i}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(t,i,r){this.particles=new Array,this.nbParticles=0,this.billboard=!1,this.counter=0,this.vars={},this._positions=new Array,this._indices=new Array,this._normals=new Array,this._colors=new Array,this._uvs=new Array,this._index=0,this._updatable=!0,this._pickable=!1,this._isVisibilityBoxLocked=!1,this._alwaysVisible=!1,this._shapeCounter=0,this._copy=new e.SolidParticle(null,null,null,null,null),this._color=new e.Color4(0,0,0,0),this._computeParticleColor=!0,this._computeParticleTexture=!0,this._computeParticleRotation=!0,this._computeParticleVertex=!1,this._computeBoundingBox=!1,this._cam_axisZ=e.Vector3.Zero(),this._cam_axisY=e.Vector3.Zero(),this._cam_axisX=e.Vector3.Zero(),this._axisX=e.Axis.X,this._axisY=e.Axis.Y,this._axisZ=e.Axis.Z,this._fakeCamPos=e.Vector3.Zero(),this._rotMatrix=new e.Matrix,this._invertMatrix=new e.Matrix,this._rotated=e.Vector3.Zero(),this._quaternion=new e.Quaternion,this._vertex=e.Vector3.Zero(),this._normal=e.Vector3.Zero(),this._yaw=0,this._pitch=0,this._roll=0,this._halfroll=0,this._halfpitch=0,this._halfyaw=0,this._sinRoll=0,this._cosRoll=0,this._sinPitch=0,this._cosPitch=0,this._sinYaw=0,this._cosYaw=0,this._w=0,this._minimum=e.Tmp.Vector3[0],this._maximum=e.Tmp.Vector3[1],this.name=t,this._scene=i,this._camera=i.activeCamera,this._pickable=r?r.isPickable:!1,r&&r.updatable?this._updatable=r.updatable:this._updatable=!0,this._pickable&&(this.pickedParticles=[])}return t.prototype.buildMesh=function(){if(0===this.nbParticles){var t=e.MeshBuilder.CreateDisc("",{radius:1,tessellation:3},this._scene);this.addShape(t,1),t.dispose()}this._positions32=new Float32Array(this._positions),this._uvs32=new Float32Array(this._uvs),this._colors32=new Float32Array(this._colors),e.VertexData.ComputeNormals(this._positions32,this._indices,this._normals),this._normals32=new Float32Array(this._normals),this._fixedNormal32=new Float32Array(this._normals);var i=new e.VertexData;i.set(this._positions32,e.VertexBuffer.PositionKind),i.indices=this._indices,i.set(this._normals32,e.VertexBuffer.NormalKind),this._uvs32&&i.set(this._uvs32,e.VertexBuffer.UVKind),this._colors32&&i.set(this._colors32,e.VertexBuffer.ColorKind);var r=new e.Mesh(this.name,this._scene);return i.applyToMesh(r,this._updatable),this.mesh=r,this.mesh.isPickable=this._pickable,this._positions=null,this._normals=null,this._uvs=null,this._colors=null,this._updatable||(this.particles.length=0),r},t.prototype.digest=function(t,i){var r=i&&i.facetNb||1,n=i&&i.number,o=i&&i.delta||0,s=t.getVerticesData(e.VertexBuffer.PositionKind),a=t.getIndices(),h=t.getVerticesData(e.VertexBuffer.UVKind),c=t.getVerticesData(e.VertexBuffer.ColorKind),l=0,u=a.length/3;n?(n=n>u?u:n,r=Math.round(u/n),o=0):r=r>u?u:r;for(var f=[],d=[],p=[],_=[],m=e.Tmp.Vector3[0],g=r;u>l;){r=g+Math.floor((1+o)*Math.random()),l>u-r&&(r=u-l),f.length=0,d.length=0,p.length=0,_.length=0;for(var v=0,y=3*l;3*(l+r)>y;y++){d.push(v);var x=a[y];f.push(s[3*x],s[3*x+1],s[3*x+2]),h&&p.push(h[2*x],h[2*x+1]),c&&_.push(c[4*x],c[4*x+1],c[4*x+2],c[4*x+3]),v++}var b,P=this.nbParticles,A=this._posToShape(f),T=this._uvsToShapeUV(p);for(b=0;b<A.length;b++)m.addInPlace(A[b]);for(m.scaleInPlace(1/A.length),b=0;b<A.length;b++)A[b].subtractInPlace(m);var E=new e.ModelShape(this._shapeCounter,A,T,null,null);this._meshBuilder(this._index,A,this._positions,d,this._indices,p,this._uvs,_,this._colors,P,0,null),this._addParticle(P,this._positions.length,E,this._shapeCounter,0),this.particles[this.nbParticles].position.addInPlace(m),this._index+=A.length,P++,this.nbParticles++,this._shapeCounter++,l+=r}return this},t.prototype._resetCopy=function(){this._copy.position.x=0,this._copy.position.y=0,this._copy.position.z=0,this._copy.rotation.x=0,this._copy.rotation.y=0,this._copy.rotation.z=0,this._copy.rotationQuaternion=null,this._copy.scaling.x=1,this._copy.scaling.y=1,this._copy.scaling.z=1,this._copy.uvs.x=0,this._copy.uvs.y=0,this._copy.uvs.z=1,this._copy.uvs.w=1,this._copy.color=null},t.prototype._meshBuilder=function(t,i,r,n,o,s,a,h,c,l,u,f){var d,p=0,_=0;for(this._resetCopy(),f&&f.positionFunction&&f.positionFunction(this._copy,l,u),this._copy.rotationQuaternion?this._quaternion.copyFrom(this._copy.rotationQuaternion):(this._yaw=this._copy.rotation.y,this._pitch=this._copy.rotation.x,this._roll=this._copy.rotation.z,this._quaternionRotationYPR()),this._quaternionToRotationMatrix(),d=0;d<i.length;d++)this._vertex.x=i[d].x,this._vertex.y=i[d].y,this._vertex.z=i[d].z,f&&f.vertexFunction&&f.vertexFunction(this._copy,this._vertex,d),this._vertex.x*=this._copy.scaling.x,this._vertex.y*=this._copy.scaling.y,this._vertex.z*=this._copy.scaling.z,e.Vector3.TransformCoordinatesToRef(this._vertex,this._rotMatrix,this._rotated),r.push(this._copy.position.x+this._rotated.x,this._copy.position.y+this._rotated.y,this._copy.position.z+this._rotated.z),s&&(a.push((this._copy.uvs.z-this._copy.uvs.x)*s[p]+this._copy.uvs.x,(this._copy.uvs.w-this._copy.uvs.y)*s[p+1]+this._copy.uvs.y),p+=2),this._copy.color?this._color=this._copy.color:h&&h[_]?(this._color.r=h[_],this._color.g=h[_+1],this._color.b=h[_+2],this._color.a=h[_+3]):(this._color.r=1,this._color.g=1,this._color.b=1,this._color.a=1),c.push(this._color.r,this._color.g,this._color.b,this._color.a),_+=4;for(d=0;d<n.length;d++)o.push(t+n[d]);if(this._pickable){var m=n.length/3;for(d=0;m>d;d++)this.pickedParticles.push({idx:l,faceId:d})}},t.prototype._posToShape=function(t){for(var i=[],r=0;r<t.length;r+=3)i.push(new e.Vector3(t[r],t[r+1],t[r+2]));return i},t.prototype._uvsToShapeUV=function(e){var t=[];if(e)for(var i=0;i<e.length;i++)t.push(e[i]);return t},t.prototype._addParticle=function(t,i,r,n,o){this.particles.push(new e.SolidParticle(t,i,r,n,o))},t.prototype.addShape=function(t,i,r){for(var n=t.getVerticesData(e.VertexBuffer.PositionKind),o=t.getIndices(),s=t.getVerticesData(e.VertexBuffer.UVKind),a=t.getVerticesData(e.VertexBuffer.ColorKind),h=this._posToShape(n),c=this._uvsToShapeUV(s),l=r?r.positionFunction:null,u=r?r.vertexFunction:null,f=new e.ModelShape(this._shapeCounter,h,c,l,u),d=this.nbParticles,p=0;i>p;p++)this._meshBuilder(this._index,h,this._positions,o,this._indices,s,this._uvs,a,this._colors,d,p,r),this._updatable&&this._addParticle(d,this._positions.length,f,this._shapeCounter,p),this._index+=h.length,d++;return this.nbParticles+=i,this._shapeCounter++,this._shapeCounter-1},t.prototype._rebuildParticle=function(t){this._resetCopy(),t._model._positionFunction&&t._model._positionFunction(this._copy,t.idx,t.idxInShape),this._copy.rotationQuaternion?this._quaternion.copyFrom(this._copy.rotationQuaternion):(this._yaw=this._copy.rotation.y,this._pitch=this._copy.rotation.x,this._roll=this._copy.rotation.z,this._quaternionRotationYPR()),this._quaternionToRotationMatrix(),this._shape=t._model._shape;for(var i=0;i<this._shape.length;i++)this._vertex.x=this._shape[i].x,this._vertex.y=this._shape[i].y,this._vertex.z=this._shape[i].z,t._model._vertexFunction&&t._model._vertexFunction(this._copy,this._vertex,i),this._vertex.x*=this._copy.scaling.x,this._vertex.y*=this._copy.scaling.y,this._vertex.z*=this._copy.scaling.z,e.Vector3.TransformCoordinatesToRef(this._vertex,this._rotMatrix,this._rotated),this._positions32[t._pos+3*i]=this._copy.position.x+this._rotated.x,this._positions32[t._pos+3*i+1]=this._copy.position.y+this._rotated.y,this._positions32[t._pos+3*i+2]=this._copy.position.z+this._rotated.z;t.position.x=0,t.position.y=0,t.position.z=0,t.rotation.x=0,t.rotation.y=0,t.rotation.z=0,t.rotationQuaternion=null,t.scaling.x=1,t.scaling.y=1,t.scaling.z=1},t.prototype.rebuildMesh=function(){for(var t=0;t<this.particles.length;t++)this._rebuildParticle(this.particles[t]);this.mesh.updateVerticesData(e.VertexBuffer.PositionKind,this._positions32,!1,!1)},t.prototype.setParticles=function(t,i,r){if(void 0===t&&(t=0),void 0===i&&(i=this.nbParticles-1),void 0===r&&(r=!0),this._updatable){this.beforeUpdateParticles(t,i,r),this._cam_axisX.x=1,this._cam_axisX.y=0,this._cam_axisX.z=0,this._cam_axisY.x=0,this._cam_axisY.y=1,this._cam_axisY.z=0,this._cam_axisZ.x=0,this._cam_axisZ.y=0,this._cam_axisZ.z=1,this.billboard&&(this._yaw=this.mesh.rotation.y,this._pitch=this.mesh.rotation.x,this._roll=this.mesh.rotation.z,this._quaternionRotationYPR(),this._quaternionToRotationMatrix(),this._rotMatrix.invertToRef(this._invertMatrix),e.Vector3.TransformCoordinatesToRef(this._camera.globalPosition,this._invertMatrix,this._fakeCamPos),this._fakeCamPos.subtractToRef(this.mesh.position,this._cam_axisZ),e.Vector3.CrossToRef(this._cam_axisZ,this._axisX,this._cam_axisY),e.Vector3.CrossToRef(this._cam_axisZ,this._cam_axisY,this._cam_axisX),this._cam_axisY.normalize(),this._cam_axisX.normalize(),this._cam_axisZ.normalize()),e.Matrix.IdentityToRef(this._rotMatrix);var n=0,o=0,s=0,a=0,h=0,c=0,l=0;this._computeBoundingBox&&(e.Vector3.FromFloatsToRef(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,this._minimum),e.Vector3.FromFloatsToRef(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,this._maximum)),i=i>this.nbParticles-1?this.nbParticles-1:i;for(var u=t;i>=u;u++){if(this._particle=this.particles[u],this._shape=this._particle._model._shape,this._shapeUV=this._particle._model._shapeUV,this.updateParticle(this._particle),this._particle.isVisible)for(this.billboard&&(this._particle.rotation.x=0,this._particle.rotation.y=0),this._computeParticleRotation&&(this._particle.rotationQuaternion?this._quaternion.copyFrom(this._particle.rotationQuaternion):(this._yaw=this._particle.rotation.y,this._pitch=this._particle.rotation.x,this._roll=this._particle.rotation.z,this._quaternionRotationYPR()),this._quaternionToRotationMatrix()),l=0;l<this._shape.length;l++)n=o+3*l,s=a+4*l,h=c+2*l,this._vertex.x=this._shape[l].x,this._vertex.y=this._shape[l].y,this._vertex.z=this._shape[l].z,this._computeParticleVertex&&this.updateParticleVertex(this._particle,this._vertex,l),this._vertex.x*=this._particle.scaling.x,this._vertex.y*=this._particle.scaling.y,this._vertex.z*=this._particle.scaling.z,this._w=this._vertex.x*this._rotMatrix.m[3]+this._vertex.y*this._rotMatrix.m[7]+this._vertex.z*this._rotMatrix.m[11]+this._rotMatrix.m[15],this._rotated.x=(this._vertex.x*this._rotMatrix.m[0]+this._vertex.y*this._rotMatrix.m[4]+this._vertex.z*this._rotMatrix.m[8]+this._rotMatrix.m[12])/this._w,this._rotated.y=(this._vertex.x*this._rotMatrix.m[1]+this._vertex.y*this._rotMatrix.m[5]+this._vertex.z*this._rotMatrix.m[9]+this._rotMatrix.m[13])/this._w,this._rotated.z=(this._vertex.x*this._rotMatrix.m[2]+this._vertex.y*this._rotMatrix.m[6]+this._vertex.z*this._rotMatrix.m[10]+this._rotMatrix.m[14])/this._w,this._positions32[n]=this._particle.position.x+this._cam_axisX.x*this._rotated.x+this._cam_axisY.x*this._rotated.y+this._cam_axisZ.x*this._rotated.z,this._positions32[n+1]=this._particle.position.y+this._cam_axisX.y*this._rotated.x+this._cam_axisY.y*this._rotated.y+this._cam_axisZ.y*this._rotated.z,this._positions32[n+2]=this._particle.position.z+this._cam_axisX.z*this._rotated.x+this._cam_axisY.z*this._rotated.y+this._cam_axisZ.z*this._rotated.z,this._computeBoundingBox&&(this._positions32[n]<this._minimum.x&&(this._minimum.x=this._positions32[n]),this._positions32[n]>this._maximum.x&&(this._maximum.x=this._positions32[n]),this._positions32[n+1]<this._minimum.y&&(this._minimum.y=this._positions32[n+1]),this._positions32[n+1]>this._maximum.y&&(this._maximum.y=this._positions32[n+1]),this._positions32[n+2]<this._minimum.z&&(this._minimum.z=this._positions32[n+2]),this._positions32[n+2]>this._maximum.z&&(this._maximum.z=this._positions32[n+2])),this._computeParticleVertex||this.billboard||(this._normal.x=this._fixedNormal32[n],this._normal.y=this._fixedNormal32[n+1],this._normal.z=this._fixedNormal32[n+2],this._w=this._normal.x*this._rotMatrix.m[3]+this._normal.y*this._rotMatrix.m[7]+this._normal.z*this._rotMatrix.m[11]+this._rotMatrix.m[15],this._rotated.x=(this._normal.x*this._rotMatrix.m[0]+this._normal.y*this._rotMatrix.m[4]+this._normal.z*this._rotMatrix.m[8]+this._rotMatrix.m[12])/this._w,this._rotated.y=(this._normal.x*this._rotMatrix.m[1]+this._normal.y*this._rotMatrix.m[5]+this._normal.z*this._rotMatrix.m[9]+this._rotMatrix.m[13])/this._w,this._rotated.z=(this._normal.x*this._rotMatrix.m[2]+this._normal.y*this._rotMatrix.m[6]+this._normal.z*this._rotMatrix.m[10]+this._rotMatrix.m[14])/this._w,this._normals32[n]=this._cam_axisX.x*this._rotated.x+this._cam_axisY.x*this._rotated.y+this._cam_axisZ.x*this._rotated.z,this._normals32[n+1]=this._cam_axisX.y*this._rotated.x+this._cam_axisY.y*this._rotated.y+this._cam_axisZ.y*this._rotated.z,this._normals32[n+2]=this._cam_axisX.z*this._rotated.x+this._cam_axisY.z*this._rotated.y+this._cam_axisZ.z*this._rotated.z),this._computeParticleColor&&(this._colors32[s]=this._particle.color.r,this._colors32[s+1]=this._particle.color.g,this._colors32[s+2]=this._particle.color.b,this._colors32[s+3]=this._particle.color.a),this._computeParticleTexture&&(this._uvs32[h]=this._shapeUV[2*l]*(this._particle.uvs.z-this._particle.uvs.x)+this._particle.uvs.x,this._uvs32[h+1]=this._shapeUV[2*l+1]*(this._particle.uvs.w-this._particle.uvs.y)+this._particle.uvs.y);else for(l=0;l<this._shape.length;l++)n=o+3*l,s=a+4*l,h=c+2*l,this._positions32[n]=this._camera.position.x,this._positions32[n+1]=this._camera.position.y,this._positions32[n+2]=this._camera.position.z,this._normals32[n]=0,this._normals32[n+1]=0,this._normals32[n+2]=0,this._computeParticleColor&&(this._colors32[s]=this._particle.color.r,this._colors32[s+1]=this._particle.color.g,this._colors32[s+2]=this._particle.color.b,this._colors32[s+3]=this._particle.color.a),this._computeParticleTexture&&(this._uvs32[h]=this._shapeUV[2*l]*(this._particle.uvs.z-this._particle.uvs.x)+this._particle.uvs.x,this._uvs32[h+1]=this._shapeUV[2*l+1]*(this._particle.uvs.w-this._particle.uvs.y)+this._particle.uvs.y);o=n+3,a=s+4,c=h+2}if(r&&(this._computeParticleColor&&this.mesh.updateVerticesData(e.VertexBuffer.ColorKind,this._colors32,!1,!1),this._computeParticleTexture&&this.mesh.updateVerticesData(e.VertexBuffer.UVKind,this._uvs32,!1,!1),this.mesh.updateVerticesData(e.VertexBuffer.PositionKind,this._positions32,!1,!1),!this.mesh.areNormalsFrozen)){if(this._computeParticleVertex||this.billboard){e.VertexData.ComputeNormals(this._positions32,this._indices,this._normals32);for(var f=0;f<this._normals32.length;f++)this._fixedNormal32[f]=this._normals32[f]}this.mesh.updateVerticesData(e.VertexBuffer.NormalKind,this._normals32,!1,!1)}this._computeBoundingBox&&(this.mesh._boundingInfo=new e.BoundingInfo(this._minimum,this._maximum),this.mesh._boundingInfo.update(this.mesh._worldMatrix)),this.afterUpdateParticles(t,i,r)}},t.prototype._quaternionRotationYPR=function(){this._halfroll=.5*this._roll,this._halfpitch=.5*this._pitch,this._halfyaw=.5*this._yaw,this._sinRoll=Math.sin(this._halfroll),this._cosRoll=Math.cos(this._halfroll),this._sinPitch=Math.sin(this._halfpitch),this._cosPitch=Math.cos(this._halfpitch),this._sinYaw=Math.sin(this._halfyaw),this._cosYaw=Math.cos(this._halfyaw),this._quaternion.x=this._cosYaw*this._sinPitch*this._cosRoll+this._sinYaw*this._cosPitch*this._sinRoll,this._quaternion.y=this._sinYaw*this._cosPitch*this._cosRoll-this._cosYaw*this._sinPitch*this._sinRoll,this._quaternion.z=this._cosYaw*this._cosPitch*this._sinRoll-this._sinYaw*this._sinPitch*this._cosRoll,this._quaternion.w=this._cosYaw*this._cosPitch*this._cosRoll+this._sinYaw*this._sinPitch*this._sinRoll},t.prototype._quaternionToRotationMatrix=function(){this._rotMatrix.m[0]=1-2*(this._quaternion.y*this._quaternion.y+this._quaternion.z*this._quaternion.z),this._rotMatrix.m[1]=2*(this._quaternion.x*this._quaternion.y+this._quaternion.z*this._quaternion.w),this._rotMatrix.m[2]=2*(this._quaternion.z*this._quaternion.x-this._quaternion.y*this._quaternion.w),this._rotMatrix.m[3]=0,this._rotMatrix.m[4]=2*(this._quaternion.x*this._quaternion.y-this._quaternion.z*this._quaternion.w),this._rotMatrix.m[5]=1-2*(this._quaternion.z*this._quaternion.z+this._quaternion.x*this._quaternion.x),this._rotMatrix.m[6]=2*(this._quaternion.y*this._quaternion.z+this._quaternion.x*this._quaternion.w),this._rotMatrix.m[7]=0,this._rotMatrix.m[8]=2*(this._quaternion.z*this._quaternion.x+this._quaternion.y*this._quaternion.w),this._rotMatrix.m[9]=2*(this._quaternion.y*this._quaternion.z-this._quaternion.x*this._quaternion.w),this._rotMatrix.m[10]=1-2*(this._quaternion.y*this._quaternion.y+this._quaternion.x*this._quaternion.x),this._rotMatrix.m[11]=0,this._rotMatrix.m[12]=0,this._rotMatrix.m[13]=0,this._rotMatrix.m[14]=0,this._rotMatrix.m[15]=1},t.prototype.dispose=function(){this.mesh.dispose(),this.vars=null,this._positions=null,this._indices=null,this._normals=null,this._uvs=null,this._colors=null,this._positions32=null,this._normals32=null,this._fixedNormal32=null,this._uvs32=null,this._colors32=null,this.pickedParticles=null},t.prototype.refreshVisibleSize=function(){this._isVisibilityBoxLocked||this.mesh.refreshBoundingInfo()},t.prototype.setVisibilityBox=function(t){var i=t/2;this.mesh._boundingInfo=new e.BoundingInfo(new e.Vector3(-i,-i,-i),new e.Vector3(i,i,i))},Object.defineProperty(t.prototype,"isAlwaysVisible",{get:function(){return this._alwaysVisible},set:function(e){this._alwaysVisible=e,this.mesh.alwaysSelectAsActiveMesh=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isVisibilityBoxLocked",{get:function(){return this._isVisibilityBoxLocked},set:function(e){this._isVisibilityBoxLocked=e,this.mesh.getBoundingInfo().isLocked=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"computeParticleRotation",{get:function(){return this._computeParticleRotation},set:function(e){this._computeParticleRotation=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"computeParticleColor",{get:function(){return this._computeParticleColor},set:function(e){this._computeParticleColor=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"computeParticleTexture",{get:function(){return this._computeParticleTexture},set:function(e){this._computeParticleTexture=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"computeParticleVertex",{get:function(){return this._computeParticleVertex},set:function(e){this._computeParticleVertex=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"computeBoundingBox",{get:function(){return this._computeBoundingBox},set:function(e){this._computeBoundingBox=e},enumerable:!0,configurable:!0}),t.prototype.initParticles=function(){},t.prototype.recycleParticle=function(e){return e},t.prototype.updateParticle=function(e){return e},t.prototype.updateParticleVertex=function(e,t,i){return t},t.prototype.beforeUpdateParticles=function(e,t,i){},t.prototype.afterUpdateParticles=function(e,t,i){},t}();e.SolidParticleSystem=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t;!function(t){var i=function(){function e(e,t,i,r){this.name=e,this.worldAxisForNormal=t,this.worldAxisForFileX=i,this.worldAxisForFileY=r}return e}(),r=function(){function t(){}return t.ConvertCubeMapToSphericalPolynomial=function(t){for(var i=new e.SphericalHarmonics,r=0,n=2/t.size,o=n,s=.5*n-1,a=0;6>a;a++)for(var h=this.FileFaces[a],c=t[h.name],l=s,u=0;u<t.size;u++){for(var f=s,d=0;d<t.size;d++){var p=h.worldAxisForFileX.scale(f).add(h.worldAxisForFileY.scale(l)).add(h.worldAxisForNormal);p.normalize();var _,m=Math.pow(1+f*f+l*l,-1.5),g=c[u*t.size*3+3*d+0],v=c[u*t.size*3+3*d+1],y=c[u*t.size*3+3*d+2],_=new e.Color3(g,v,y);i.addLight(p,_,m),r+=m,f+=n}l+=o}var x=4*Math.PI,b=x/r;return i.scale(b),i.scale(1/Math.PI),e.SphericalPolynomial.getSphericalPolynomialFromHarmonics(i)},t.FileFaces=[new i("right",new e.Vector3(1,0,0),new e.Vector3(0,0,-1),new e.Vector3(0,-1,0)),new i("left",new e.Vector3(-1,0,0),new e.Vector3(0,0,1),new e.Vector3(0,-1,0)),new i("up",new e.Vector3(0,1,0),new e.Vector3(1,0,0),new e.Vector3(0,0,1)),new i("down",new e.Vector3(0,-1,0),new e.Vector3(1,0,0),new e.Vector3(0,0,-1)),new i("front",new e.Vector3(0,0,1),new e.Vector3(1,0,0),new e.Vector3(0,-1,0)),new i("back",new e.Vector3(0,0,-1),new e.Vector3(-1,0,0),new e.Vector3(0,-1,0))],t}();t.CubeMapToSphericalPolynomialTools=r}(t=e.Internals||(e.Internals={}))}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t;!function(t){var i=function(){function t(){}return t.ConvertPanoramaToCubemap=function(e,t,i,r){if(!e)throw"ConvertPanoramaToCubemap: input cannot be null";if(e.length!=t*i*3)throw"ConvertPanoramaToCubemap: input size is wrong";var n=this.CreateCubemapTexture(r,this.FACE_FRONT,e,t,i),o=this.CreateCubemapTexture(r,this.FACE_BACK,e,t,i),s=this.CreateCubemapTexture(r,this.FACE_LEFT,e,t,i),a=this.CreateCubemapTexture(r,this.FACE_RIGHT,e,t,i),h=this.CreateCubemapTexture(r,this.FACE_UP,e,t,i),c=this.CreateCubemapTexture(r,this.FACE_DOWN,e,t,i);return{front:n,back:o,left:s,right:a,up:h,down:c,size:r}},t.CreateCubemapTexture=function(e,t,i,r,n){for(var o=new ArrayBuffer(e*e*4*3),s=new Float32Array(o),a=t[1].subtract(t[0]).scale(1/e),h=t[3].subtract(t[2]).scale(1/e),c=1/e,l=0,u=0;e>u;u++){for(var f=t[0],d=t[2],p=0;e>p;p++){var _=d.subtract(f).scale(l).add(f);_.normalize();var m=this.CalcProjectionSpherical(_,i,r,n);s[u*e*3+3*p+0]=m.r,s[u*e*3+3*p+1]=m.g,s[u*e*3+3*p+2]=m.b,f=f.add(a),d=d.add(h)}l+=c}return s},t.CalcProjectionSpherical=function(e,t,i,r){for(var n=Math.atan2(e.z,e.x),o=Math.acos(e.y);n<-Math.PI;)n+=2*Math.PI;for(;n>Math.PI;)n-=2*Math.PI;var s=n/Math.PI,a=o/Math.PI;s=.5*s+.5;var h=Math.round(s*i);0>h?h=0:h>=i&&(h=i-1);var c=Math.round(a*r);0>c?c=0:c>=r&&(c=r-1);var l=r-c-1,u=t[l*i*3+3*h+0],f=t[l*i*3+3*h+1],d=t[l*i*3+3*h+2];return{r:u,g:f,b:d}},t.FACE_FRONT=[new e.Vector3(-1,-1,-1),new e.Vector3(1,-1,-1),new e.Vector3(-1,1,-1),new e.Vector3(1,1,-1)],t.FACE_BACK=[new e.Vector3(1,-1,1),new e.Vector3(-1,-1,1),new e.Vector3(1,1,1),new e.Vector3(-1,1,1)],t.FACE_RIGHT=[new e.Vector3(1,-1,-1),new e.Vector3(1,-1,1),new e.Vector3(1,1,-1),new e.Vector3(1,1,1)],t.FACE_LEFT=[new e.Vector3(-1,-1,1),new e.Vector3(-1,-1,-1),new e.Vector3(-1,1,1),new e.Vector3(-1,1,-1)],t.FACE_DOWN=[new e.Vector3(-1,1,-1),new e.Vector3(1,1,-1),new e.Vector3(-1,1,1),new e.Vector3(1,1,1)],t.FACE_UP=[new e.Vector3(-1,-1,1),new e.Vector3(1,-1,1),new e.Vector3(-1,-1,-1),new e.Vector3(1,-1,-1)],t}();t.PanoramaToCubeMapTools=i}(t=e.Internals||(e.Internals={}))}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t;!function(e){var t=function(){function t(){}return t.Ldexp=function(e,t){return t>1023?e*Math.pow(2,1023)*Math.pow(2,t-1023):-1074>t?e*Math.pow(2,-1074)*Math.pow(2,t+1074):e*Math.pow(2,t)},t.Rgbe2float=function(e,t,i,r,n,o){n>0?(n=this.Ldexp(1,n-136),e[o+0]=t*n,e[o+1]=i*n,e[o+2]=r*n):(e[o+0]=0,e[o+1]=0,e[o+2]=0)},t.readStringLine=function(e,t){for(var i="",r="",n=t;n<e.length-t&&(r=String.fromCharCode(e[n]),"\n"!=r);n++)i+=r;return i},t.RGBE_ReadHeader=function(e){var t=0,i=0,r=this.readStringLine(e,0);if("#"!=r[0]||"?"!=r[1])throw"Bad HDR Format.";var n=!1,o=!1,s=0;do s+=r.length+1,r=this.readStringLine(e,s),"FORMAT=32-bit_rle_rgbe"==r?o=!0:0==r.length&&(n=!0);while(!n);if(!o)throw"HDR Bad header format, unsupported FORMAT";s+=r.length+1,r=this.readStringLine(e,s);var a=/^\-Y (.*) \+X (.*)$/g,h=a.exec(r);if(h.length<3)throw"HDR Bad header format, no size";if(i=parseInt(h[2]),t=parseInt(h[1]),8>i||i>32767)throw"HDR Bad header format, unsupported size";return s+=r.length+1,{height:t,width:i,dataPosition:s}},t.GetCubeMapTextureData=function(t,i){var r=new Uint8Array(t),n=this.RGBE_ReadHeader(r),o=this.RGBE_ReadPixels_RLE(r,n),s=e.PanoramaToCubeMapTools.ConvertPanoramaToCubemap(o,n.width,n.height,i);return s},t.RGBE_ReadPixels=function(e,t){return this.RGBE_ReadPixels_RLE(e,t)},t.RGBE_ReadPixels_RLE=function(e,t){for(var i,r,n,o,s,a=t.height,h=t.width,c=t.dataPosition,l=0,u=0,f=0,d=new ArrayBuffer(4*h),p=new Uint8Array(d),_=new ArrayBuffer(t.width*t.height*4*3),m=new Float32Array(_);a>0;){if(i=e[c++],r=e[c++],n=e[c++],o=e[c++],2!=i||2!=r||128&n)throw"HDR Bad header format, not RLE";if((n<<8|o)!=h)throw"HDR Bad header format, wrong scan line width";for(l=0,f=0;4>f;f++)for(u=(f+1)*h;u>l;)if(i=e[c++],r=e[c++],i>128){if(s=i-128,0==s||s>u-l)throw"HDR Bad Format, bad scanline data (run)";for(;s-- >0;)p[l++]=r}else{if(s=i,0==s||s>u-l)throw"HDR Bad Format, bad scanline data (non-run)";if(p[l++]=r,--s>0)for(var g=0;s>g;g++)p[l++]=e[c++]}for(f=0;h>f;f++)i=p[f],r=p[f+h],n=p[f+2*h],o=p[f+3*h],this.Rgbe2float(m,i,r,n,o,(t.height-a)*h*3+3*f);a--}return m},t}();e.HDRTools=t}(t=e.Internals||(e.Internals={}))}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t;!function(t){var i=function(){function t(){this.min=new e.Vector3(0,0,0),this.max=new e.Vector3(0,0,0),this.clear()}return t.prototype.clear=function(){this.min.x=t.MAX,this.min.y=t.MAX,this.min.z=t.MAX,this.max.x=t.MIN,this.max.y=t.MIN,this.max.z=t.MIN},t.prototype.augment=function(e,t,i){this.min.x=Math.min(this.min.x,e),this.min.y=Math.min(this.min.y,t),this.min.z=Math.min(this.min.z,i),this.max.x=Math.max(this.max.x,e),this.max.y=Math.max(this.max.y,t),this.max.z=Math.max(this.max.z,i)},t.prototype.clampMin=function(e,t,i){this.min.x=Math.max(this.min.x,e),this.min.y=Math.max(this.min.y,t),this.min.z=Math.max(this.min.z,i)},t.prototype.clampMax=function(e,t,i){this.max.x=Math.min(this.max.x,e),this.max.y=Math.min(this.max.y,t),this.max.z=Math.min(this.max.z,i)},t.prototype.empty=function(){return this.min.x>this.max.y||this.min.y>this.max.y||this.min.z>this.max.y},t.MAX=Number.MAX_VALUE,t.MIN=Number.MIN_VALUE,t}(),r=function(){function t(e,t,i,r,n,o,s,a,h,c){this.input=e,this.inputSize=t,this.outputSize=i,this.maxNumMipLevels=r,this.numChannels=n,this.isFloat=o,this.specularPower=s,this.cosinePowerDropPerMip=a,this.excludeBase=h,this.fixup=c,this._outputSurface=[],this._numMipLevels=0}return t.prototype.filterCubeMap=function(){return this.init(),this.filterCubeMapMipChain(),this._outputSurface},t.prototype.init=function(){var e,i,r;for(0==this.maxNumMipLevels&&(this.maxNumMipLevels=t.CP_MAX_MIPLEVELS),r=this.outputSize,i=0;i<this.maxNumMipLevels;i++){for(this._outputSurface.length++,this._outputSurface[i]=[],e=0;6>e;e++)this._outputSurface[i].length++,this.isFloat?this._outputSurface[i][e]=new Float32Array(r*r*this.numChannels):this._outputSurface[i][e]=new Uint32Array(r*r*this.numChannels);if(r>>=1,this._numMipLevels++,0==r)return void(this.maxNumMipLevels=i)}},t.prototype.filterCubeMapMipChain=function(){var e=this.specularPower;this.precomputeFilterLookupTables(this.inputSize);for(var t=0;t<this._numMipLevels;t++){this.excludeBase&&0==t&&(e=1e5);var i=this.input,r=this._outputSurface[t],n=this.outputSize>>t,o=this.getBaseFilterAngle(e);this.filterCubeSurfaces(i,this.inputSize,r,n,o,e),this.fixup&&this.fixupCubeEdges(r,n),this.excludeBase&&0==t&&(e=this.specularPower),e*=this.cosinePowerDropPerMip}},t.prototype.getBaseFilterAngle=function(e){var t=1e-6,i=180;return i=Math.acos(Math.pow(t,1/e)),i*=180/Math.PI,i*=2},t.prototype.precomputeFilterLookupTables=function(e){this._normCubeMap=[],this.buildNormalizerSolidAngleCubemap(e)},t.prototype.buildNormalizerSolidAngleCubemap=function(e){var t,i,r;for(t=0;6>t;t++){this._normCubeMap.push(new Float32Array(e*e*4));this.input[t];for(r=0;e>r;r++)for(i=0;e>i;i++){var n=this.texelCoordToVect(t,i,r,e,this.fixup);this._normCubeMap[t][4*(r*e+i)+0]=n.x,this._normCubeMap[t][4*(r*e+i)+1]=n.y,this._normCubeMap[t][4*(r*e+i)+2]=n.z;var o=this.texelCoordSolidAngle(t,i,r,e);this._normCubeMap[t][4*(r*e+i)+4]=o}}},t.prototype.texelCoordToVect=function(e,i,r,n,o){var s,a;if(s=2*(i+.5)/n-1,a=2*(r+.5)/n-1,o&&n>1){var h=Math.pow(n,2)/Math.pow(n-1,3);s=h*Math.pow(s,3)+s,a=h*Math.pow(a,3)+a}var c=t._sgFace2DMapping[e][t.CP_UDIR];t._vectorTemp.x=c[0]*s,t._vectorTemp.y=c[1]*s,t._vectorTemp.z=c[2]*s;var l=t._sgFace2DMapping[e][t.CP_VDIR];t._vectorTemp.x+=l[0]*a,t._vectorTemp.y+=l[1]*a,t._vectorTemp.z+=l[2]*a;var u=t._sgFace2DMapping[e][t.CP_FACEAXIS];return t._vectorTemp.x+=u[0],t._vectorTemp.y+=u[1],t._vectorTemp.z+=u[2],t._vectorTemp.normalize(),t._vectorTemp},t.prototype.vectToTexelCoord=function(e,i,r,n){var o,s,a=Math.abs(e),h=Math.abs(i),c=Math.abs(r);a>=h&&a>=c?(o=a,s=e>=0?t.CP_FACE_X_POS:t.CP_FACE_X_NEG):h>=a&&h>=c?(o=h,s=i>=0?t.CP_FACE_Y_POS:t.CP_FACE_Y_NEG):(o=c,s=r>=0?t.CP_FACE_Z_POS:t.CP_FACE_Z_NEG);var l=1/o;e*=l,i*=l,r*=l;var u=t._sgFace2DMapping[s][t.CP_UDIR],f=u[0]*e+u[1]*i+u[2]*r;u=t._sgFace2DMapping[s][t.CP_VDIR];var d=u[0]*e+u[1]*i+u[2]*r,p=Math.floor(.5*(n-1)*(f+1)),_=Math.floor(.5*(n-1)*(d+1));return t._vectorTemp.x=s,t._vectorTemp.y=p,t._vectorTemp.z=_,t._vectorTemp},t.prototype.areaElement=function(e,t){return Math.atan2(e*t,Math.sqrt(e*e+t*t+1))},t.prototype.texelCoordSolidAngle=function(e,t,i,r){t=2*(t+.5)/r-1,i=2*(i+.5)/r-1;var n=1/r,o=t-n,s=i-n,a=t+n,h=i+n,c=this.areaElement(o,s)-this.areaElement(o,h)-this.areaElement(a,s)+this.areaElement(a,h);return c},t.prototype.filterCubeSurfaces=function(e,t,r,n,o,s){var a,h,c,l=[];for(a=0;6>a;a++)l.push(new i);var u=180/Math.PI*Math.atan2(1,t),f=o/2;u>f&&(f=u),f>90&&(f=90);var d=Math.ceil(f/u);1>d&&(d=1);var p=Math.cos(Math.PI/180*f);for(a=0;6>a;a++)for(c=0;n>c;c++)for(h=0;n>h;h++){var _=this.texelCoordToVect(a,h,c,n,this.fixup).clone();this.clearFilterExtents(l),this.determineFilterExtents(_,t,d,l);var m=this.processFilterExtents(_,p,l,e,t,s);r[a][(c*n+h)*this.numChannels+0]=m.x,r[a][(c*n+h)*this.numChannels+1]=m.y,r[a][(c*n+h)*this.numChannels+2]=m.z}},t.prototype.clearFilterExtents=function(e){for(var t=0;6>t;t++)e[t].clear()},t.prototype.determineFilterExtents=function(e,i,r,n){var o,s,a,h=[0,0,0,0],c=[0,0,0,0],l=[0,0,0,0],u=this.vectToTexelCoord(e.x,e.y,e.z,i),f=u.x,d=u.y,p=u.z;n[f].augment(d-r,p-r,0),n[f].augment(d+r,p+r,0),n[f].clampMin(0,0,0),n[f].clampMax(i-1,i-1,0);var _=n[f].min.x,m=n[f].min.y,g=n[f].max.x,v=n[f].max.y;
h[0]=r-d,c[0]=m,l[0]=v,h[1]=d+r-(i-1),c[1]=m,l[1]=v,h[2]=r-p,c[2]=_,l[2]=g,h[3]=p+r-(i-1),c[3]=_,l[3]=g;for(var y=0;4>y;y++){if(h[y]>0){switch(o=t._sgCubeNgh[f][y][0],s=t._sgCubeNgh[f][y][1],y!=s&&y+s!=3||(c[y]=i-1-c[y],l[y]=i-1-l[y]),t._sgCubeNgh[f][y][1]){case t.CP_EDGE_LEFT:n[o].augment(0,c[y],0),n[o].augment(h[y],l[y],0);break;case t.CP_EDGE_RIGHT:n[o].augment(i-1,c[y],0),n[o].augment(i-1-h[y],l[y],0);break;case t.CP_EDGE_TOP:n[o].augment(c[y],0,0),n[o].augment(l[y],h[y],0);break;case t.CP_EDGE_BOTTOM:n[o].augment(c[y],i-1,0),n[o].augment(l[y],i-1-h[y],0)}n[o].clampMin(0,0,0),n[o].clampMax(i-1,i-1,0)}if(h[y]>i){switch(f){case t.CP_FACE_X_POS:a=t.CP_FACE_X_NEG;break;case t.CP_FACE_X_NEG:a=t.CP_FACE_X_POS;break;case t.CP_FACE_Y_POS:a=t.CP_FACE_Y_NEG;break;case t.CP_FACE_Y_NEG:a=t.CP_FACE_Y_POS;break;case t.CP_FACE_Z_POS:a=t.CP_FACE_Z_NEG;break;case t.CP_FACE_Z_NEG:a=t.CP_FACE_Z_POS}n[a].augment(0,0,0),n[a].augment(i-1,i-1,0)}}},t.prototype.processFilterExtents=function(e,i,r,n,o,s){for(var a=[0,0,0,0],h=0,c=0,l=this.numChannels,u=o,f=4*u,d=u*this.numChannels,p=1,_=0;6>_;_++)if(!r[_].empty())for(var m=r[_].min.x,g=r[_].min.y,v=r[_].max.x,y=r[_].max.y,x=4*(g*u+m),b=this.numChannels*(g*u+m),P=g;y>=P;P++){for(var A=0,T=0,E=m;v>=E;E++){var C=this._normCubeMap[_][x+A+0],S=this._normCubeMap[_][x+A+1],M=this._normCubeMap[_][x+A+2],I=C*e.x+S*e.y+M*e.z;if(I>=i&&I>0){var D=this._normCubeMap[_][x+A+3];for(D*=Math.pow(I,s+p),c=0;l>c;c++)a[c]+=D*n[_][b+T],T++;h+=D}else T+=l;A+=4}x+=f,b+=d}if(0!=h)t._vectorTemp.x=a[0]/h,t._vectorTemp.y=a[1]/h,t._vectorTemp.z=a[2]/h,this.numChannels>3&&(t._vectorTemp.w=a[3]/h);else{var R=this.vectToTexelCoord(e.x,e.y,e.z,o).clone();t._vectorTemp.x=n[R.x][this.numChannels*(R.z*o+R.y)+0],t._vectorTemp.y=n[R.x][this.numChannels*(R.z*o+R.y)+1],t._vectorTemp.z=n[R.x][this.numChannels*(R.z*o+R.y)+2],this.numChannels>3&&(t._vectorTemp.z=n[R.x][this.numChannels*(R.z*o+R.y)+3])}return t._vectorTemp},t.prototype.fixupCubeEdges=function(e,i){var r,n,o,s,a=0,h=[0,0,0,0,0,0,0,0],c=[[],[],[],[]],l=[[[],[],[]],[[],[],[]],[[],[],[]],[[],[],[]],[[],[],[]],[[],[],[]],[[],[],[]],[[],[],[]]];if(!(1>i))if(1!=i){for(s=0;6>s;s++)for(c[0]=[s,0],c[1]=[s,(i-1)*this.numChannels],c[2]=[s,i*(i-1)*this.numChannels],c[3]=[s,(i*(i-1)+(i-1))*this.numChannels],a=0;4>a;a++){var u=t._sgCubeCornerList[s][a];l[u][h[u]]=c[a],h[u]++}for(a=0;8>a;a++)for(r=0;r<this.numChannels;r++){var f=0;for(o=0;3>o;o++)f+=e[l[a][o][0]][l[a][o][1]+r];for(f*=1/3,o=0;3>o;o++)e[l[a][o][0]][l[a][o][1]+r]=f}for(o=0;12>o;o++){var d=t._sgCubeEdgeList[o][0],p=t._sgCubeEdgeList[o][1],_=t._sgCubeNgh[d][p][0],m=t._sgCubeNgh[d][p][1],g=0,v=0,y=0,x=0;switch(p){case t.CP_EDGE_LEFT:y=this.numChannels*i;break;case t.CP_EDGE_RIGHT:g+=(i-1)*this.numChannels,y=this.numChannels*i;break;case t.CP_EDGE_TOP:y=this.numChannels;break;case t.CP_EDGE_BOTTOM:g+=i*(i-1)*this.numChannels,y=this.numChannels}if(p==m||p+m==3)switch(m){case t.CP_EDGE_LEFT:v+=(i-1)*i*this.numChannels,x=-(this.numChannels*i);break;case t.CP_EDGE_RIGHT:v+=((i-1)*i+(i-1))*this.numChannels,x=-(this.numChannels*i);break;case t.CP_EDGE_TOP:v+=(i-1)*this.numChannels,x=-this.numChannels;break;case t.CP_EDGE_BOTTOM:v+=((i-1)*i+(i-1))*this.numChannels,x=-this.numChannels}else switch(m){case t.CP_EDGE_LEFT:x=this.numChannels*i;break;case t.CP_EDGE_RIGHT:v+=(i-1)*this.numChannels,x=this.numChannels*i;break;case t.CP_EDGE_TOP:x=this.numChannels;break;case t.CP_EDGE_BOTTOM:v+=i*(i-1)*this.numChannels,x=this.numChannels}for(g+=y,v+=x,n=1;i-1>n;n++){for(r=0;r<this.numChannels;r++){var b=e[d][g+r],P=e[_][v+r],A=.5*(b+P);e[d][g+r]=A,e[_][v+r]=A}g+=y,v+=x}}}else for(r=0;r<this.numChannels;r++){var T=0;for(s=0;6>s;s++)T+=e[s][r];for(T/=6,s=0;6>s;s++)e[s][r]=T}},t.CP_MAX_MIPLEVELS=16,t.CP_UDIR=0,t.CP_VDIR=1,t.CP_FACEAXIS=2,t.CP_FACE_X_POS=0,t.CP_FACE_X_NEG=1,t.CP_FACE_Y_POS=2,t.CP_FACE_Y_NEG=3,t.CP_FACE_Z_POS=4,t.CP_FACE_Z_NEG=5,t.CP_EDGE_LEFT=0,t.CP_EDGE_RIGHT=1,t.CP_EDGE_TOP=2,t.CP_EDGE_BOTTOM=3,t.CP_CORNER_NNN=0,t.CP_CORNER_NNP=1,t.CP_CORNER_NPN=2,t.CP_CORNER_NPP=3,t.CP_CORNER_PNN=4,t.CP_CORNER_PNP=5,t.CP_CORNER_PPN=6,t.CP_CORNER_PPP=7,t._vectorTemp=new e.Vector4(0,0,0,0),t._sgFace2DMapping=[[[0,0,-1],[0,-1,0],[1,0,0]],[[0,0,1],[0,-1,0],[-1,0,0]],[[1,0,0],[0,0,1],[0,1,0]],[[1,0,0],[0,0,-1],[0,-1,0]],[[1,0,0],[0,-1,0],[0,0,1]],[[-1,0,0],[0,-1,0],[0,0,-1]]],t._sgCubeNgh=[[[t.CP_FACE_Z_POS,t.CP_EDGE_RIGHT],[t.CP_FACE_Z_NEG,t.CP_EDGE_LEFT],[t.CP_FACE_Y_POS,t.CP_EDGE_RIGHT],[t.CP_FACE_Y_NEG,t.CP_EDGE_RIGHT]],[[t.CP_FACE_Z_NEG,t.CP_EDGE_RIGHT],[t.CP_FACE_Z_POS,t.CP_EDGE_LEFT],[t.CP_FACE_Y_POS,t.CP_EDGE_LEFT],[t.CP_FACE_Y_NEG,t.CP_EDGE_LEFT]],[[t.CP_FACE_X_NEG,t.CP_EDGE_TOP],[t.CP_FACE_X_POS,t.CP_EDGE_TOP],[t.CP_FACE_Z_NEG,t.CP_EDGE_TOP],[t.CP_FACE_Z_POS,t.CP_EDGE_TOP]],[[t.CP_FACE_X_NEG,t.CP_EDGE_BOTTOM],[t.CP_FACE_X_POS,t.CP_EDGE_BOTTOM],[t.CP_FACE_Z_POS,t.CP_EDGE_BOTTOM],[t.CP_FACE_Z_NEG,t.CP_EDGE_BOTTOM]],[[t.CP_FACE_X_NEG,t.CP_EDGE_RIGHT],[t.CP_FACE_X_POS,t.CP_EDGE_LEFT],[t.CP_FACE_Y_POS,t.CP_EDGE_BOTTOM],[t.CP_FACE_Y_NEG,t.CP_EDGE_TOP]],[[t.CP_FACE_X_POS,t.CP_EDGE_RIGHT],[t.CP_FACE_X_NEG,t.CP_EDGE_LEFT],[t.CP_FACE_Y_POS,t.CP_EDGE_TOP],[t.CP_FACE_Y_NEG,t.CP_EDGE_BOTTOM]]],t._sgCubeEdgeList=[[t.CP_FACE_X_POS,t.CP_EDGE_LEFT],[t.CP_FACE_X_POS,t.CP_EDGE_RIGHT],[t.CP_FACE_X_POS,t.CP_EDGE_TOP],[t.CP_FACE_X_POS,t.CP_EDGE_BOTTOM],[t.CP_FACE_X_NEG,t.CP_EDGE_LEFT],[t.CP_FACE_X_NEG,t.CP_EDGE_RIGHT],[t.CP_FACE_X_NEG,t.CP_EDGE_TOP],[t.CP_FACE_X_NEG,t.CP_EDGE_BOTTOM],[t.CP_FACE_Z_POS,t.CP_EDGE_TOP],[t.CP_FACE_Z_POS,t.CP_EDGE_BOTTOM],[t.CP_FACE_Z_NEG,t.CP_EDGE_TOP],[t.CP_FACE_Z_NEG,t.CP_EDGE_BOTTOM]],t._sgCubeCornerList=[[t.CP_CORNER_PPP,t.CP_CORNER_PPN,t.CP_CORNER_PNP,t.CP_CORNER_PNN],[t.CP_CORNER_NPN,t.CP_CORNER_NPP,t.CP_CORNER_NNN,t.CP_CORNER_NNP],[t.CP_CORNER_NPN,t.CP_CORNER_PPN,t.CP_CORNER_NPP,t.CP_CORNER_PPP],[t.CP_CORNER_NNP,t.CP_CORNER_PNP,t.CP_CORNER_NNN,t.CP_CORNER_PNN],[t.CP_CORNER_NPP,t.CP_CORNER_PPP,t.CP_CORNER_NNP,t.CP_CORNER_PNP],[t.CP_CORNER_PPN,t.CP_CORNER_NPN,t.CP_CORNER_PNN,t.CP_CORNER_NNN]],t}();t.PMREMGenerator=r}(t=e.Internals||(e.Internals={}))}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(i,r,n,o,s,a,h){void 0===o&&(o=!1),void 0===s&&(s=!0),void 0===a&&(a=!1),void 0===h&&(h=!1),t.call(this,r),this._useInGammaSpace=!1,this._generateHarmonics=!0,this._isBABYLONPreprocessed=!1,this.coordinatesMode=e.Texture.CUBIC_MODE,this.sphericalPolynomial=null,this.isPMREM=!1,i&&(this.name=i,this.url=i,this.hasAlpha=!1,this.isCube=!0,this._textureMatrix=e.Matrix.Identity(),n?(this._isBABYLONPreprocessed=!1,this._noMipmap=o,this._size=n,this._useInGammaSpace=a,this._usePMREMGenerator=h&&r.getEngine().getCaps().textureLOD&&this.getScene().getEngine().getCaps().textureFloat&&!this._useInGammaSpace):(this._isBABYLONPreprocessed=!0,this._noMipmap=!1,this._useInGammaSpace=!1,this._usePMREMGenerator=r.getEngine().getCaps().textureLOD&&this.getScene().getEngine().getCaps().textureFloat&&!this._useInGammaSpace),this.isPMREM=this._usePMREMGenerator,this._texture=this._getFromCache(i,this._noMipmap),this._texture||(r.useDelayedTextureLoading?this.delayLoadState=e.Engine.DELAYLOADSTATE_NOTLOADED:this.loadTexture()))}return __extends(i,t),i.prototype.loadBabylonTexture=function(){var t=this,i=0,r=null,n=!this._useInGammaSpace&&this.getScene().getEngine().getCaps().textureFloat?function(e){for(var n=[],o=30,s=0;i>s;s++){n.push([]);for(var a=3*Math.pow(t._size>>s,2),h=0;6>h;h++){var c=r.subarray(o,o+a);n[s].push(c),o+=a}}return n}:null,o=function(o){var s=new Int32Array(o);r=new Float32Array(o);s[0];t._size=s[1],t.getScene().getEngine().updateTextureSize(t._texture,t._size,t._size),t.sphericalPolynomial=new e.SphericalPolynomial,t.sphericalPolynomial.x.copyFromFloats(r[2],r[3],r[4]),t.sphericalPolynomial.y.copyFromFloats(r[5],r[6],r[7]),t.sphericalPolynomial.z.copyFromFloats(r[8],r[9],r[10]),t.sphericalPolynomial.xx.copyFromFloats(r[11],r[12],r[13]),t.sphericalPolynomial.yy.copyFromFloats(r[14],r[15],r[16]),t.sphericalPolynomial.zz.copyFromFloats(r[17],r[18],r[19]),t.sphericalPolynomial.xy.copyFromFloats(r[20],r[21],r[22]),t.sphericalPolynomial.yz.copyFromFloats(r[23],r[24],r[25]),t.sphericalPolynomial.zx.copyFromFloats(r[26],r[27],r[28]),i=s[29];for(var a=30,h=[],c=3*Math.pow(t._size,2),l=0;6>l;l++)h.push(r.subarray(a,a+c)),a+=c;for(var u=[],f=null,d=0;6>d;d++){var p=null;if(n)p=h[d];else{var _=[0,2,4,1,3,5][d];if(p=h[_],!t.getScene().getEngine().getCaps().textureFloat){var m=new ArrayBuffer(c);f=new Uint8Array(m)}for(var g=0;g<t._size*t._size;g++)if(t._useInGammaSpace&&(p[3*g+0]=Math.pow(p[3*g+0],e.ToGammaSpace),p[3*g+1]=Math.pow(p[3*g+1],e.ToGammaSpace),p[3*g+2]=Math.pow(p[3*g+2],e.ToGammaSpace)),f){var v=Math.max(255*p[3*g+0],0),y=Math.max(255*p[3*g+1],0),x=Math.max(255*p[3*g+2],0),b=Math.max(Math.max(v,y),x);if(b>255){var P=255/b;v*=P,y*=P,x*=P}f[3*g+0]=v,f[3*g+1]=y,f[3*g+2]=x}}f?u.push(f):u.push(p)}return u};this._texture=this.getScene().getEngine().createRawCubeTexture(this.url,this.getScene(),this._size,e.Engine.TEXTUREFORMAT_RGB,this.getScene().getEngine().getCaps().textureFloat?e.Engine.TEXTURETYPE_FLOAT:e.Engine.TEXTURETYPE_UNSIGNED_INT,this._noMipmap,o,n)},i.prototype.loadHDRTexture=function(){var t=this,r=function(r){var n=e.Internals.HDRTools.GetCubeMapTextureData(r,t._size);t._generateHarmonics&&(t.sphericalPolynomial=e.Internals.CubeMapToSphericalPolynomialTools.ConvertCubeMapToSphericalPolynomial(n));for(var o=[],s=null,a=0;6>a;a++){if(!t.getScene().getEngine().getCaps().textureFloat){var h=new ArrayBuffer(t._size*t._size*3);s=new Uint8Array(h)}var c=n[i._facesMapping[a]];if(t._useInGammaSpace||s)for(var l=0;l<t._size*t._size;l++)if(t._useInGammaSpace&&(c[3*l+0]=Math.pow(c[3*l+0],e.ToGammaSpace),c[3*l+1]=Math.pow(c[3*l+1],e.ToGammaSpace),c[3*l+2]=Math.pow(c[3*l+2],e.ToGammaSpace)),s){var u=Math.max(255*c[3*l+0],0),f=Math.max(255*c[3*l+1],0),d=Math.max(255*c[3*l+2],0),p=Math.max(Math.max(u,f),d);if(p>255){var _=255/p;u*=_,f*=_,d*=_}s[3*l+0]=u,s[3*l+1]=f,s[3*l+2]=d}s?o.push(s):o.push(c)}return o},n=null;!this._noMipmap&&this._usePMREMGenerator&&(n=function(i){var r=new e.Internals.PMREMGenerator(i,t._size,t._size,0,3,t.getScene().getEngine().getCaps().textureFloat,2048,.25,!1,!0);return r.filterCubeMap()}),this._texture=this.getScene().getEngine().createRawCubeTexture(this.url,this.getScene(),this._size,e.Engine.TEXTUREFORMAT_RGB,this.getScene().getEngine().getCaps().textureFloat?e.Engine.TEXTURETYPE_FLOAT:e.Engine.TEXTURETYPE_UNSIGNED_INT,this._noMipmap,r,n)},i.prototype.loadTexture=function(){this._isBABYLONPreprocessed?this.loadBabylonTexture():this.loadHDRTexture()},i.prototype.clone=function(){var e=this._isBABYLONPreprocessed?null:this._size,t=new i(this.url,this.getScene(),e,this._noMipmap,this._generateHarmonics,this._useInGammaSpace,this._usePMREMGenerator);return t.level=this.level,t.wrapU=this.wrapU,t.wrapV=this.wrapV,t.coordinatesIndex=this.coordinatesIndex,t.coordinatesMode=this.coordinatesMode,t},i.prototype.delayLoad=function(){this.delayLoadState===e.Engine.DELAYLOADSTATE_NOTLOADED&&(this.delayLoadState=e.Engine.DELAYLOADSTATE_LOADED,this._texture=this._getFromCache(this.url,this._noMipmap),this._texture||this.loadTexture())},i.prototype.getReflectionTextureMatrix=function(){return this._textureMatrix},i.Parse=function(t,i,r){var n=null;if(t.name&&!t.isRenderTarget){var o=t.isBABYLONPreprocessed?null:t.size;n=new e.HDRCubeTexture(r+t.name,i,o,n.generateHarmonics,n.useInGammaSpace,n.usePMREMGenerator),n.name=t.name,n.hasAlpha=t.hasAlpha,n.level=t.level,n.coordinatesMode=t.coordinatesMode}return n},i.prototype.serialize=function(){if(!this.name)return null;var e={};return e.name=this.name,e.hasAlpha=this.hasAlpha,e.isCube=!0,e.level=this.level,e.size=this._size,e.coordinatesMode=this.coordinatesMode,e.useInGammaSpace=this._useInGammaSpace,e.generateHarmonics=this._generateHarmonics,e.usePMREMGenerator=this._usePMREMGenerator,e.isBABYLONPreprocessed=this._isBABYLONPreprocessed,e},i.generateBabylonHDROnDisk=function(e,t,r){void 0===r&&(r=null);var n=function(e){var t=new Blob([e],{type:"application/octet-stream"}),i=window.URL.createObjectURL(t),r=document.createElement("a");document.body.appendChild(r),r.style.display="none",r.href=i,r.download="envmap.babylon.hdr",r.click()};i.generateBabylonHDR(e,t,n,r)},i.generateBabylonHDR=function(t,i,r,n){if(void 0===n&&(n=null),!t)return null;if(!e.Tools.IsExponentOfTwo(i))return null;var o=function(t){var n=e.Internals.HDRTools.GetCubeMapTextureData(t,i),o=e.Internals.CubeMapToSphericalPolynomialTools.ConvertCubeMapToSphericalPolynomial(n),s=[];s.push(n.right),s.push(n.left),s.push(n.up),s.push(n.down),s.push(n.front),s.push(n.back);var a=new e.Internals.PMREMGenerator(s,i,i,0,3,!0,2048,.25,!1,!0),h=a.filterCubeMap(),c=4;c+=4,c+=108,c+=4;for(var l=0;l<h.length;l++){var u=i>>l;c+=6*u*u*3*4}var f=new ArrayBuffer(c),d=new Int32Array(f),p=new Float32Array(f);d[0]=1,d[1]=i,o.x.toArray(p,2),o.y.toArray(p,5),o.z.toArray(p,8),o.xx.toArray(p,11),o.yy.toArray(p,14),o.zz.toArray(p,17),o.xy.toArray(p,20),o.yz.toArray(p,23),o.zx.toArray(p,26),d[29]=h.length;for(var _=30,l=0;l<h.length;l++)for(var m=3*Math.pow(i>>l,2),g=0;6>g;g++)p.set(h[l][g],_),_+=m;r(f)};e.Tools.LoadFile(t,function(e){o(e)},null,null,!0,n)},i._facesMapping=["right","up","front","left","down","back"],i}(e.BaseTexture);e.HDRCubeTexture=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t;!function(t){var i=function(){function t(t,i,r,n,o){void 0===n&&(n=!0),void 0===o&&(o=1),this.skeleton=t,this.mesh=i,this.autoUpdateBonesMatrices=n,this.renderingGroupId=o,this.color=e.Color3.White(),this._debugLines=[],this._isEnabled=!1,this._scene=r,this.update(),this._renderFunction=this.update.bind(this)}return Object.defineProperty(t.prototype,"isEnabled",{get:function(){return this._isEnabled},set:function(e){this._isEnabled!==e&&(this._isEnabled=e,e?this._scene.registerBeforeRender(this._renderFunction):this._scene.unregisterBeforeRender(this._renderFunction))},enumerable:!0,configurable:!0}),t.prototype._getBonePosition=function(t,i,r,n,o,s){void 0===n&&(n=0),void 0===o&&(o=0),void 0===s&&(s=0);var a=e.Tmp.Matrix[0],h=i.getParent();if(a.copyFrom(i.getLocalMatrix()),0!==n||0!==o||0!==s){var c=e.Tmp.Matrix[1];e.Matrix.IdentityToRef(c),c.m[12]=n,c.m[13]=o,c.m[14]=s,c.multiplyToRef(a,a)}h&&a.multiplyToRef(h.getAbsoluteTransform(),a),a.multiplyToRef(r,a),t.x=a.m[12],t.y=a.m[13],t.z=a.m[14]},t.prototype._getLinesForBonesWithLength=function(t,i){for(var r=t.length,n=0;r>n;n++){var o=t[n],s=this._debugLines[n];s||(s=[e.Vector3.Zero(),e.Vector3.Zero()],this._debugLines[n]=s),this._getBonePosition(s[0],o,i),this._getBonePosition(s[1],o,i,0,o.length,0)}},t.prototype._getLinesForBonesNoLength=function(t,i){for(var r=t.length,n=0,o=r-1;o>=0;o--){var s=t[o],a=s.getParent();if(a){var h=this._debugLines[n];h||(h=[e.Vector3.Zero(),e.Vector3.Zero()],this._debugLines[n]=h),this._getBonePosition(h[0],s,i),this._getBonePosition(h[1],a,i),n++}}},t.prototype.update=function(){this.autoUpdateBonesMatrices&&this._updateBoneMatrix(this.skeleton.bones[0]),void 0===this.skeleton.bones[0].length?this._getLinesForBonesNoLength(this.skeleton.bones,this.mesh.getWorldMatrix()):this._getLinesForBonesWithLength(this.skeleton.bones,this.mesh.getWorldMatrix()),this._debugMesh?e.MeshBuilder.CreateLineSystem(null,{lines:this._debugLines,updatable:!0,instance:this._debugMesh},this._scene):(this._debugMesh=e.MeshBuilder.CreateLineSystem(null,{lines:this._debugLines,updatable:!0},this._scene),this._debugMesh.renderingGroupId=this.renderingGroupId),this._debugMesh.color=this.color},t.prototype._updateBoneMatrix=function(e){e.getParent()&&e.getLocalMatrix().multiplyToRef(e.getParent().getAbsoluteTransform(),e.getAbsoluteTransform());for(var t=e.children,i=t.length,r=0;i>r;r++)this._updateBoneMatrix(t[r])},t.prototype.dispose=function(){this._debugMesh&&(this.isEnabled=!1,this._debugMesh.dispose(),this._debugMesh=null)},t}();t.SkeletonViewer=i}(t=e.Debug||(e.Debug={}))}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(){this._dirty=!0,this._tempColor=new e.Color4(0,0,0,0),this._globalCurve=new e.Color4(0,0,0,0),this._highlightsCurve=new e.Color4(0,0,0,0),this._midtonesCurve=new e.Color4(0,0,0,0),this._shadowsCurve=new e.Color4(0,0,0,0),this._positiveCurve=new e.Color4(0,0,0,0),this._negativeCurve=new e.Color4(0,0,0,0),this._globalHue=30,this._globalDensity=0,this._globalSaturation=0,this._globalExposure=0,this._highlightsHue=30,this._highlightsDensity=0,this._highlightsSaturation=0,this._highlightsExposure=0,this._midtonesHue=30,this._midtonesDensity=0,this._midtonesSaturation=0,this._midtonesExposure=0,this._shadowsHue=30,this._shadowsDensity=0,this._shadowsSaturation=0,this._shadowsExposure=0}return Object.defineProperty(t.prototype,"GlobalHue",{get:function(){return this._globalHue},set:function(e){this._globalHue=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"GlobalDensity",{get:function(){return this._globalDensity},set:function(e){this._globalDensity=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"GlobalSaturation",{get:function(){return this._globalSaturation},set:function(e){this._globalSaturation=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"HighlightsHue",{get:function(){return this._highlightsHue},set:function(e){this._highlightsHue=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"HighlightsDensity",{get:function(){return this._highlightsDensity},set:function(e){this._highlightsDensity=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"HighlightsSaturation",{get:function(){return this._highlightsSaturation},set:function(e){this._highlightsSaturation=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"HighlightsExposure",{get:function(){return this._highlightsExposure},set:function(e){this._highlightsExposure=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"MidtonesHue",{get:function(){return this._midtonesHue},set:function(e){this._midtonesHue=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"MidtonesDensity",{get:function(){return this._midtonesDensity},set:function(e){this._midtonesDensity=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"MidtonesSaturation",{get:function(){return this._midtonesSaturation},set:function(e){this._midtonesSaturation=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"MidtonesExposure",{get:function(){return this._midtonesExposure},set:function(e){this._midtonesExposure=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ShadowsHue",{get:function(){return this._shadowsHue},set:function(e){this._shadowsHue=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ShadowsDensity",{get:function(){return this._shadowsDensity},set:function(e){this._shadowsDensity=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ShadowsSaturation",{get:function(){return this._shadowsSaturation},set:function(e){this._shadowsSaturation=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ShadowsExposure",{get:function(){return this._shadowsExposure},set:function(e){this._shadowsExposure=e,this._dirty=!0},enumerable:!0,configurable:!0}),t.Bind=function(e,t){e._dirty&&(e._dirty=!1,e.getColorGradingDataToRef(e._globalHue,e._globalDensity,e._globalSaturation,e._globalExposure,e._globalCurve),e.getColorGradingDataToRef(e._highlightsHue,e._highlightsDensity,e._highlightsSaturation,e._highlightsExposure,e._tempColor),e._tempColor.multiplyToRef(e._globalCurve,e._highlightsCurve),e.getColorGradingDataToRef(e._midtonesHue,e._midtonesDensity,e._midtonesSaturation,e._midtonesExposure,e._tempColor),e._tempColor.multiplyToRef(e._globalCurve,e._midtonesCurve),e.getColorGradingDataToRef(e._shadowsHue,e._shadowsDensity,e._shadowsSaturation,e._shadowsExposure,e._tempColor),e._tempColor.multiplyToRef(e._globalCurve,e._shadowsCurve),e._highlightsCurve.subtractToRef(e._midtonesCurve,e._positiveCurve),e._midtonesCurve.subtractToRef(e._shadowsCurve,e._negativeCurve)),t.setFloat4("vCameraColorCurvePositive",e._positiveCurve.r,e._positiveCurve.g,e._positiveCurve.b,e._positiveCurve.a),t.setFloat4("vCameraColorCurveNeutral",e._midtonesCurve.r,e._midtonesCurve.g,e._midtonesCurve.b,e._midtonesCurve.a),t.setFloat4("vCameraColorCurveNegative",e._negativeCurve.r,e._negativeCurve.g,e._negativeCurve.b,e._negativeCurve.a)},t.PrepareUniforms=function(e){e.push("vCameraColorCurveNeutral","vCameraColorCurvePositive","vCameraColorCurveNegative")},t.prototype.getColorGradingDataToRef=function(e,i,r,n,o){null!=e&&(e=t.clamp(e,0,360),i=t.clamp(i,-100,100),r=t.clamp(r,-100,100),n=t.clamp(n,-100,100),i=t.applyColorGradingSliderNonlinear(i),i*=.5,n=t.applyColorGradingSliderNonlinear(n),0>i&&(i*=-1,e=(e+180)%360),t.fromHSBToRef(e,i,50+.25*n,o),o.scaleToRef(2,o),o.a=1+.01*r)},t.applyColorGradingSliderNonlinear=function(e){e/=100;var t=Math.abs(e);return t=Math.pow(t,2),0>e&&(t*=-1),t*=100},t.fromHSBToRef=function(e,i,r,n){var o=t.clamp(e,0,360),s=t.clamp(i/100,0,1),a=t.clamp(r/100,0,1);if(0===s)n.r=a,n.g=a,n.b=a;else{o/=60;var h=Math.floor(o),c=o-h,l=a*(1-s),u=a*(1-s*c),f=a*(1-s*(1-c));switch(h){case 0:n.r=a,n.g=f,n.b=l;break;case 1:n.r=u,n.g=a,n.b=l;break;case 2:n.r=l,n.g=a,n.b=f;break;case 3:n.r=l,n.g=u,n.b=a;break;case 4:n.r=f,n.g=l,n.b=a;break;default:n.r=a,n.g=l,n.b=u}}n.a=1},t.clamp=function(e,t,i){return Math.min(Math.max(e,t),i)},t.prototype.clone=function(){return e.SerializationHelper.Clone(function(){return new t},this)},t.prototype.serialize=function(){return e.SerializationHelper.Serialize(this)},t.Parse=function(i){return e.SerializationHelper.Parse(function(){return new t},i,null,null)},__decorate([e.serialize()],t.prototype,"_globalHue",void 0),__decorate([e.serialize()],t.prototype,"_globalDensity",void 0),__decorate([e.serialize()],t.prototype,"_globalSaturation",void 0),__decorate([e.serialize()],t.prototype,"_globalExposure",void 0),__decorate([e.serialize()],t.prototype,"_highlightsHue",void 0),__decorate([e.serialize()],t.prototype,"_highlightsDensity",void 0),__decorate([e.serialize()],t.prototype,"_highlightsSaturation",void 0),__decorate([e.serialize()],t.prototype,"_highlightsExposure",void 0),__decorate([e.serialize()],t.prototype,"_midtonesHue",void 0),__decorate([e.serialize()],t.prototype,"_midtonesDensity",void 0),__decorate([e.serialize()],t.prototype,"_midtonesSaturation",void 0),__decorate([e.serialize()],t.prototype,"_midtonesExposure",void 0),t}();e.ColorCurves=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(t){function i(i,r){t.call(this,r),i&&(this._textureMatrix=e.Matrix.Identity(),this.name=i,this.url=i,this.hasAlpha=!1,this.isCube=!1,this.wrapU=e.Texture.CLAMP_ADDRESSMODE,this.wrapV=e.Texture.CLAMP_ADDRESSMODE,this.anisotropicFilteringLevel=1,this._texture=this._getFromCache(i,!0),this._texture||(r.useDelayedTextureLoading?this.delayLoadState=e.Engine.DELAYLOADSTATE_NOTLOADED:this.loadTexture()))}return __extends(i,t),i.prototype.getTextureMatrix=function(){return this._textureMatrix},i.prototype.load3dlTexture=function(){var t=this,r=this.getScene().getEngine().createRawTexture(null,1,1,e.Engine.TEXTUREFORMAT_RGBA,!1,!1,e.Texture.BILINEAR_SAMPLINGMODE);this._texture=r;var n=function(n){for(var o,s,a,h=n.split("\n"),c=0,l=0,u=0,f=0,d=0,p=0;p<h.length;p++)if(a=h[p],i._noneEmptyLineRegex.test(a)&&0!==a.indexOf("#")){var _=a.split(" ");if(0!==c){if(0!=c){var m=Math.max(parseInt(_[0]),0),g=Math.max(parseInt(_[1]),0),v=Math.max(parseInt(_[2]),0);d=Math.max(m,d),d=Math.max(g,d),d=Math.max(v,d);var y=4*(l+f*c+u*c*c);s[y+0]=m,s[y+1]=g,s[y+2]=v,s[y+3]=0,f++,f%c==0&&(u++,f=0,u%c==0&&(l++,u=0))}}else c=_.length,o=new Uint8Array(c*c*c*4),s=new Float32Array(c*c*c*4)}for(var p=0;p<s.length;p++){var x=s[p];o[p]=x/d*255}t.getScene().getEngine().updateTextureSize(r,c*c,c),t.getScene().getEngine().updateRawTexture(r,o,e.Engine.TEXTUREFORMAT_RGBA,!1)};return e.Tools.LoadFile(this.url,n),this._texture},i.prototype.loadTexture=function(){this.url&&this.url.toLocaleLowerCase().indexOf(".3dl")==this.url.length-4&&this.load3dlTexture()},i.prototype.clone=function(){var e=new i(this.url,this.getScene());return e.level=this.level,e},i.prototype.delayLoad=function(){this.delayLoadState===e.Engine.DELAYLOADSTATE_NOTLOADED&&(this.delayLoadState=e.Engine.DELAYLOADSTATE_LOADED,this._texture=this._getFromCache(this.url,!0),this._texture||this.loadTexture())},i.Parse=function(t,i,r){var n=null;return t.name&&!t.isRenderTarget&&(n=new e.ColorGradingTexture(t.name,i),n.name=t.name,n.level=t.level),n},i.prototype.serialize=function(){if(!this.name)return null;var e={};return e.name=this.name,e.level=this.level,e},i._noneEmptyLineRegex=/\S+/,i}(e.BaseTexture);e.ColorGradingTexture=t}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(e){function t(){e.call(this),this.ALBEDO=!1,this.AMBIENT=!1,this.OPACITY=!1,this.OPACITYRGB=!1,this.REFLECTION=!1,this.EMISSIVE=!1,this.REFLECTIVITY=!1,this.BUMP=!1,this.PARALLAX=!1,this.PARALLAXOCCLUSION=!1,this.SPECULAROVERALPHA=!1,this.CLIPPLANE=!1,this.ALPHATEST=!1,this.ALPHAFROMALBEDO=!1,this.POINTSIZE=!1,this.FOG=!1,this.SPECULARTERM=!1,this.OPACITYFRESNEL=!1,this.EMISSIVEFRESNEL=!1,this.FRESNEL=!1,this.NORMAL=!1,this.UV1=!1,this.UV2=!1,this.VERTEXCOLOR=!1,this.VERTEXALPHA=!1,this.NUM_BONE_INFLUENCERS=0,this.BonesPerMesh=0,this.INSTANCES=!1,this.MICROSURFACEFROMREFLECTIVITYMAP=!1,this.MICROSURFACEAUTOMATIC=!1,this.EMISSIVEASILLUMINATION=!1,this.LINKEMISSIVEWITHALBEDO=!1,this.LIGHTMAP=!1,this.USELIGHTMAPASSHADOWMAP=!1,this.REFLECTIONMAP_3D=!1,this.REFLECTIONMAP_SPHERICAL=!1,this.REFLECTIONMAP_PLANAR=!1,this.REFLECTIONMAP_CUBIC=!1,this.REFLECTIONMAP_PROJECTION=!1,this.REFLECTIONMAP_SKYBOX=!1,this.REFLECTIONMAP_EXPLICIT=!1,this.REFLECTIONMAP_EQUIRECTANGULAR=!1,this.INVERTCUBICMAP=!1,this.LOGARITHMICDEPTH=!1,this.CAMERATONEMAP=!1,this.CAMERACONTRAST=!1,this.CAMERACOLORGRADING=!1,this.CAMERACOLORCURVES=!1,this.OVERLOADEDVALUES=!1,this.OVERLOADEDSHADOWVALUES=!1,this.USESPHERICALFROMREFLECTIONMAP=!1,this.REFRACTION=!1,this.REFRACTIONMAP_3D=!1,this.LINKREFRACTIONTOTRANSPARENCY=!1,this.REFRACTIONMAPINLINEARSPACE=!1,this.LODBASEDMICROSFURACE=!1,this.USEPHYSICALLIGHTFALLOFF=!1,this.RADIANCEOVERALPHA=!1,this.USEPMREMREFLECTION=!1,this.USEPMREMREFRACTION=!1,this.OPENGLNORMALMAP=!1,this.INVERTNORMALMAPX=!1,this.INVERTNORMALMAPY=!1,this.rebuild()}return __extends(t,e),t}(e.MaterialDefines),i=function(i){function r(r,n){var o=this;i.call(this,r,n),this.directIntensity=1,this.emissiveIntensity=1,this.environmentIntensity=1,this.specularIntensity=1,this._lightingInfos=new e.Vector4(this.directIntensity,this.emissiveIntensity,this.environmentIntensity,this.specularIntensity),this.disableBumpMap=!1,this.overloadedShadowIntensity=1,this.overloadedShadeIntensity=1,this._overloadedShadowInfos=new e.Vector4(this.overloadedShadowIntensity,this.overloadedShadeIntensity,0,0),this.cameraExposure=1,this.cameraContrast=1,this.cameraColorGradingTexture=null,this._cameraColorGradingScaleOffset=new e.Vector4(1,1,0,0),this._cameraColorGradingInfos=new e.Vector4(1,1,0,0),this.cameraColorCurves=null,this._cameraInfos=new e.Vector4(1,1,0,0),this._microsurfaceTextureLods=new e.Vector2(0,0),this.overloadedAmbient=e.Color3.White(),this.overloadedAmbientIntensity=0,this.overloadedAlbedo=e.Color3.White(),this.overloadedAlbedoIntensity=0,this.overloadedReflectivity=new e.Color3(.3,.3,.3),this.overloadedReflectivityIntensity=0,this.overloadedEmissive=e.Color3.White(),this.overloadedEmissiveIntensity=0,this._overloadedIntensity=new e.Vector4(this.overloadedAmbientIntensity,this.overloadedAlbedoIntensity,this.overloadedReflectivityIntensity,this.overloadedEmissiveIntensity),this.overloadedReflection=e.Color3.White(),this.overloadedReflectionIntensity=0,this.overloadedMicroSurface=0,this.overloadedMicroSurfaceIntensity=0,this._overloadedMicroSurface=new e.Vector3(this.overloadedMicroSurface,this.overloadedMicroSurfaceIntensity,this.overloadedReflectionIntensity),this.ambientColor=new e.Color3(0,0,0),this.albedoColor=new e.Color3(1,1,1),this.reflectivityColor=new e.Color3(1,1,1),this.reflectionColor=new e.Color3(.5,.5,.5),this.emissiveColor=new e.Color3(0,0,0),this.microSurface=.9,this.indexOfRefraction=.66,this.invertRefractionY=!1,this.linkRefractionWithTransparency=!1,this.linkEmissiveWithAlbedo=!1,this.useLightmapAsShadowmap=!1,this.useEmissiveAsIllumination=!1,this.useAlphaFromAlbedoTexture=!1,this.useSpecularOverAlpha=!0,this.useMicroSurfaceFromReflectivityMapAlpha=!1,this.useAutoMicroSurfaceFromReflectivityMap=!1,this.useScalarInLinearSpace=!1,this.usePhysicalLightFalloff=!0,this.useRadianceOverAlpha=!0,this.useParallax=!1,this.useParallaxOcclusion=!1,this.parallaxScaleBias=.05,this.disableLighting=!1,this.maxSimultaneousLights=4,this.invertNormalMapX=!1,this.invertNormalMapY=!1,this._renderTargets=new e.SmartArray(16),this._worldViewProjectionMatrix=e.Matrix.Zero(),this._globalAmbientColor=new e.Color3(0,0,0),this._tempColor=new e.Color3,this._defines=new t,this._cachedDefines=new t,this._myScene=null,this._myShadowGenerator=null,this._cachedDefines.BonesPerMesh=-1,this.getRenderTargetTextures=function(){return o._renderTargets.reset(),o.reflectionTexture&&o.reflectionTexture.isRenderTarget&&o._renderTargets.push(o.reflectionTexture),o.refractionTexture&&o.refractionTexture.isRenderTarget&&o._renderTargets.push(o.refractionTexture),o._renderTargets}}return __extends(r,i),Object.defineProperty(r.prototype,"useLogarithmicDepth",{get:function(){return this._useLogarithmicDepth},set:function(e){this._useLogarithmicDepth=e&&this.getScene().getEngine().getCaps().fragmentDepthSupported},enumerable:!0,configurable:!0}),r.prototype.needAlphaBlending=function(){return this.linkRefractionWithTransparency?!1:this.alpha<1||null!=this.opacityTexture||this._shouldUseAlphaFromAlbedoTexture()||this.opacityFresnelParameters&&this.opacityFresnelParameters.isEnabled},r.prototype.needAlphaTesting=function(){return this.linkRefractionWithTransparency?!1:null!=this.albedoTexture&&this.albedoTexture.hasAlpha},r.prototype._shouldUseAlphaFromAlbedoTexture=function(){return null!=this.albedoTexture&&this.albedoTexture.hasAlpha&&this.useAlphaFromAlbedoTexture},r.prototype.getAlphaTestTexture=function(){return this.albedoTexture},r.prototype._checkCache=function(e,t,i){return t?this._defines.INSTANCES!==i?!1:!(!t._materialDefines||!t._materialDefines.isEqual(this._defines)):!0},r.prototype.convertColorToLinearSpaceToRef=function(e,t){r.convertColorToLinearSpaceToRef(e,t,this.useScalarInLinearSpace)},r.convertColorToLinearSpaceToRef=function(e,t,i){i?(t.r=e.r,t.g=e.g,t.b=e.b):e.toLinearSpaceToRef(t)},r.BindLights=function(t,i,n,o,s,a,h){for(var c=0,l=!1,u=0;u<t.lights.length;u++){var f=t.lights[u];if(f.isEnabled()&&f.canAffectMesh(i)&&(e.MaterialHelper.BindLightProperties(f,n,c),this.convertColorToLinearSpaceToRef(f.diffuse,r._scaledAlbedo,s),r._scaledAlbedo.scaleToRef(f.intensity,r._scaledAlbedo),n.setColor4("vLightDiffuse"+c,r._scaledAlbedo,h?f.radius:f.range),o.SPECULARTERM&&(this.convertColorToLinearSpaceToRef(f.specular,r._scaledReflectivity,s),r._scaledReflectivity.scaleToRef(f.intensity,r._scaledReflectivity),n.setColor3("vLightSpecular"+c,r._scaledReflectivity)),t.shadowsEnabled&&(l=e.MaterialHelper.BindLightShadow(f,t,i,c,n,l)),c++,c===a))break}},r.prototype.isReady=function(i,r){if(this.checkReadyOnlyOnce&&this._wasPreviouslyReady)return!0;var n=this.getScene();if(!this.checkReadyOnEveryCall&&this._renderId===n.getRenderId()&&this._checkCache(n,i,r))return!0;var o=n.getEngine(),s=!1,a=!1;if(this._defines.reset(),n.texturesEnabled){if(n.texturesEnabled){if(n.getEngine().getCaps().textureLOD&&(this._defines.LODBASEDMICROSFURACE=!0),
this.albedoTexture&&e.StandardMaterial.DiffuseTextureEnabled){if(!this.albedoTexture.isReady())return!1;a=!0,this._defines.ALBEDO=!0}if(this.ambientTexture&&e.StandardMaterial.AmbientTextureEnabled){if(!this.ambientTexture.isReady())return!1;a=!0,this._defines.AMBIENT=!0}if(this.opacityTexture&&e.StandardMaterial.OpacityTextureEnabled){if(!this.opacityTexture.isReady())return!1;a=!0,this._defines.OPACITY=!0,this.opacityTexture.getAlphaFromRGB&&(this._defines.OPACITYRGB=!0)}if(this.reflectionTexture&&e.StandardMaterial.ReflectionTextureEnabled){if(!this.reflectionTexture.isReady())return!1;switch(s=!0,this._defines.REFLECTION=!0,this.reflectionTexture.coordinatesMode===e.Texture.INVCUBIC_MODE&&(this._defines.INVERTCUBICMAP=!0),this._defines.REFLECTIONMAP_3D=this.reflectionTexture.isCube,this.reflectionTexture.coordinatesMode){case e.Texture.CUBIC_MODE:case e.Texture.INVCUBIC_MODE:this._defines.REFLECTIONMAP_CUBIC=!0;break;case e.Texture.EXPLICIT_MODE:this._defines.REFLECTIONMAP_EXPLICIT=!0;break;case e.Texture.PLANAR_MODE:this._defines.REFLECTIONMAP_PLANAR=!0;break;case e.Texture.PROJECTION_MODE:this._defines.REFLECTIONMAP_PROJECTION=!0;break;case e.Texture.SKYBOX_MODE:this._defines.REFLECTIONMAP_SKYBOX=!0;break;case e.Texture.SPHERICAL_MODE:this._defines.REFLECTIONMAP_SPHERICAL=!0;break;case e.Texture.EQUIRECTANGULAR_MODE:this._defines.REFLECTIONMAP_EQUIRECTANGULAR=!0}this.reflectionTexture instanceof e.HDRCubeTexture&&this.reflectionTexture&&(this._defines.USESPHERICALFROMREFLECTIONMAP=!0,s=!0,this.reflectionTexture.isPMREM&&(this._defines.USEPMREMREFLECTION=!0))}if(this.lightmapTexture&&e.StandardMaterial.LightmapTextureEnabled){if(!this.lightmapTexture.isReady())return!1;a=!0,this._defines.LIGHTMAP=!0,this._defines.USELIGHTMAPASSHADOWMAP=this.useLightmapAsShadowmap}if(this.emissiveTexture&&e.StandardMaterial.EmissiveTextureEnabled){if(!this.emissiveTexture.isReady())return!1;a=!0,this._defines.EMISSIVE=!0}if(this.reflectivityTexture&&e.StandardMaterial.SpecularTextureEnabled){if(!this.reflectivityTexture.isReady())return!1;a=!0,this._defines.REFLECTIVITY=!0,this._defines.MICROSURFACEFROMREFLECTIVITYMAP=this.useMicroSurfaceFromReflectivityMapAlpha,this._defines.MICROSURFACEAUTOMATIC=this.useAutoMicroSurfaceFromReflectivityMap}}if(n.getEngine().getCaps().standardDerivatives&&this.bumpTexture&&e.StandardMaterial.BumpTextureEnabled&&!this.disableBumpMap){if(!this.bumpTexture.isReady())return!1;a=!0,this._defines.BUMP=!0,this.useParallax&&(this._defines.PARALLAX=!0,this.useParallaxOcclusion&&(this._defines.PARALLAXOCCLUSION=!0)),this.invertNormalMapX&&(this._defines.INVERTNORMALMAPX=!0),this.invertNormalMapY&&(this._defines.INVERTNORMALMAPY=!0)}if(this.refractionTexture&&e.StandardMaterial.RefractionTextureEnabled){if(!this.refractionTexture.isReady())return!1;a=!0,this._defines.REFRACTION=!0,this._defines.REFRACTIONMAP_3D=this.refractionTexture.isCube,this.linkRefractionWithTransparency&&(this._defines.LINKREFRACTIONTOTRANSPARENCY=!0),this.refractionTexture instanceof e.HDRCubeTexture&&(this._defines.REFRACTIONMAPINLINEARSPACE=!0,this.refractionTexture.isPMREM&&(this._defines.USEPMREMREFRACTION=!0))}if(this.cameraColorGradingTexture){if(!this.cameraColorGradingTexture.isReady())return!1;this._defines.CAMERACOLORGRADING=!0}}if(n.clipPlane&&(this._defines.CLIPPLANE=!0),o.getAlphaTesting()&&(this._defines.ALPHATEST=!0),this._shouldUseAlphaFromAlbedoTexture()&&(this._defines.ALPHAFROMALBEDO=!0),this.useEmissiveAsIllumination&&(this._defines.EMISSIVEASILLUMINATION=!0),this.linkEmissiveWithAlbedo&&(this._defines.LINKEMISSIVEWITHALBEDO=!0),this.useLogarithmicDepth&&(this._defines.LOGARITHMICDEPTH=!0),1!=this.cameraContrast&&(this._defines.CAMERACONTRAST=!0),1!=this.cameraExposure&&(this._defines.CAMERATONEMAP=!0),this.cameraColorCurves&&(this._defines.CAMERACOLORCURVES=!0),1==this.overloadedShadeIntensity&&1==this.overloadedShadowIntensity||(this._defines.OVERLOADEDSHADOWVALUES=!0),(this.overloadedMicroSurfaceIntensity>0||this.overloadedEmissiveIntensity>0||this.overloadedReflectivityIntensity>0||this.overloadedAlbedoIntensity>0||this.overloadedAmbientIntensity>0||this.overloadedReflectionIntensity>0)&&(this._defines.OVERLOADEDVALUES=!0),(this.pointsCloud||n.forcePointsCloud)&&(this._defines.POINTSIZE=!0),n.fogEnabled&&i&&i.applyFog&&n.fogMode!==e.Scene.FOGMODE_NONE&&this.fogEnabled&&(this._defines.FOG=!0),n.lightsEnabled&&!this.disableLighting&&(s=e.MaterialHelper.PrepareDefinesForLights(n,i,this._defines,this.maxSimultaneousLights)||s),e.StandardMaterial.FresnelEnabled&&(this.opacityFresnelParameters&&this.opacityFresnelParameters.isEnabled||this.emissiveFresnelParameters&&this.emissiveFresnelParameters.isEnabled)&&(this.opacityFresnelParameters&&this.opacityFresnelParameters.isEnabled&&(this._defines.OPACITYFRESNEL=!0),this.emissiveFresnelParameters&&this.emissiveFresnelParameters.isEnabled&&(this._defines.EMISSIVEFRESNEL=!0),s=!0,this._defines.FRESNEL=!0),this._defines.SPECULARTERM&&this.useSpecularOverAlpha&&(this._defines.SPECULAROVERALPHA=!0),this.usePhysicalLightFalloff&&(this._defines.USEPHYSICALLIGHTFALLOFF=!0),this.useRadianceOverAlpha&&(this._defines.RADIANCEOVERALPHA=!0),i&&(s&&i.isVerticesDataPresent(e.VertexBuffer.NormalKind)&&(this._defines.NORMAL=!0),a&&(i.isVerticesDataPresent(e.VertexBuffer.UVKind)&&(this._defines.UV1=!0),i.isVerticesDataPresent(e.VertexBuffer.UV2Kind)&&(this._defines.UV2=!0)),i.useVertexColors&&i.isVerticesDataPresent(e.VertexBuffer.ColorKind)&&(this._defines.VERTEXCOLOR=!0,i.hasVertexAlpha&&(this._defines.VERTEXALPHA=!0)),i.useBones&&i.computeBonesUsingShaders&&(this._defines.NUM_BONE_INFLUENCERS=i.numBoneInfluencers,this._defines.BonesPerMesh=i.skeleton.bones.length+1),r&&(this._defines.INSTANCES=!0)),!this._defines.isEqual(this._cachedDefines)){this._defines.cloneTo(this._cachedDefines),n.resetCachedMaterial();var h=new e.EffectFallbacks;this._defines.REFLECTION&&h.addFallback(0,"REFLECTION"),this._defines.REFRACTION&&h.addFallback(0,"REFRACTION"),this._defines.REFLECTIVITY&&h.addFallback(0,"REFLECTIVITY"),this._defines.BUMP&&h.addFallback(0,"BUMP"),this._defines.PARALLAX&&h.addFallback(1,"PARALLAX"),this._defines.PARALLAXOCCLUSION&&h.addFallback(0,"PARALLAXOCCLUSION"),this._defines.SPECULAROVERALPHA&&h.addFallback(0,"SPECULAROVERALPHA"),this._defines.FOG&&h.addFallback(1,"FOG"),this._defines.POINTSIZE&&h.addFallback(0,"POINTSIZE"),this._defines.LOGARITHMICDEPTH&&h.addFallback(0,"LOGARITHMICDEPTH"),e.MaterialHelper.HandleFallbacksForShadows(this._defines,h,this.maxSimultaneousLights),this._defines.SPECULARTERM&&h.addFallback(0,"SPECULARTERM"),this._defines.OPACITYFRESNEL&&h.addFallback(1,"OPACITYFRESNEL"),this._defines.EMISSIVEFRESNEL&&h.addFallback(2,"EMISSIVEFRESNEL"),this._defines.FRESNEL&&h.addFallback(3,"FRESNEL"),this._defines.NUM_BONE_INFLUENCERS>0&&h.addCPUSkinningFallback(0,i);var c=[e.VertexBuffer.PositionKind];this._defines.NORMAL&&c.push(e.VertexBuffer.NormalKind),this._defines.UV1&&c.push(e.VertexBuffer.UVKind),this._defines.UV2&&c.push(e.VertexBuffer.UV2Kind),this._defines.VERTEXCOLOR&&c.push(e.VertexBuffer.ColorKind),e.MaterialHelper.PrepareAttributesForBones(c,i,this._defines,h),e.MaterialHelper.PrepareAttributesForInstances(c,this._defines);var l="pbr";n.getEngine().getCaps().standardDerivatives||(l="legacypbr");var u=this._defines.toString(),f=["world","view","viewProjection","vEyePosition","vLightsType","vAmbientColor","vAlbedoColor","vReflectivityColor","vEmissiveColor","vReflectionColor","vFogInfos","vFogColor","pointSize","vAlbedoInfos","vAmbientInfos","vOpacityInfos","vReflectionInfos","vEmissiveInfos","vReflectivityInfos","vBumpInfos","vLightmapInfos","vRefractionInfos","mBones","vClipPlane","albedoMatrix","ambientMatrix","opacityMatrix","reflectionMatrix","emissiveMatrix","reflectivityMatrix","bumpMatrix","lightmapMatrix","refractionMatrix","depthValues","opacityParts","emissiveLeftColor","emissiveRightColor","vLightingIntensity","vOverloadedShadowIntensity","vOverloadedIntensity","vOverloadedAlbedo","vOverloadedReflection","vOverloadedReflectivity","vOverloadedEmissive","vOverloadedMicroSurface","logarithmicDepthConstant","vSphericalX","vSphericalY","vSphericalZ","vSphericalXX","vSphericalYY","vSphericalZZ","vSphericalXY","vSphericalYZ","vSphericalZX","vMicrosurfaceTextureLods","vCameraInfos","vCameraColorGradingInfos","vCameraColorGradingScaleOffset"],d=["albedoSampler","ambientSampler","opacitySampler","reflectionCubeSampler","reflection2DSampler","emissiveSampler","reflectivitySampler","bumpSampler","lightmapSampler","refractionCubeSampler","refraction2DSampler","cameraColorGrading2DSampler"];e.ColorCurves.PrepareUniforms(f),e.MaterialHelper.PrepareUniformsAndSamplersList(f,d,this._defines,this.maxSimultaneousLights),this._effect=n.getEngine().createEffect(l,c,f,d,u,h,this.onCompiled,this.onError,{maxSimultaneousLights:this.maxSimultaneousLights})}return this._effect.isReady()?(this._renderId=n.getRenderId(),this._wasPreviouslyReady=!0,i&&(i._materialDefines||(i._materialDefines=new t),this._defines.cloneTo(i._materialDefines)),!0):!1},r.prototype.unbind=function(){this.reflectionTexture&&this.reflectionTexture.isRenderTarget&&this._effect.setTexture("reflection2DSampler",null),this.refractionTexture&&this.refractionTexture.isRenderTarget&&this._effect.setTexture("refraction2DSampler",null),i.prototype.unbind.call(this)},r.prototype.bindOnlyWorldMatrix=function(e){this._effect.setMatrix("world",e)},r.prototype.bind=function(t,n){if(this._myScene=this.getScene(),this.bindOnlyWorldMatrix(t),e.MaterialHelper.BindBonesParameters(n,this._effect),this._myScene.getCachedMaterial()!==this){if(this._effect.setMatrix("viewProjection",this._myScene.getTransformMatrix()),e.StandardMaterial.FresnelEnabled&&(this.opacityFresnelParameters&&this.opacityFresnelParameters.isEnabled&&this._effect.setColor4("opacityParts",new e.Color3(this.opacityFresnelParameters.leftColor.toLuminance(),this.opacityFresnelParameters.rightColor.toLuminance(),this.opacityFresnelParameters.bias),this.opacityFresnelParameters.power),this.emissiveFresnelParameters&&this.emissiveFresnelParameters.isEnabled&&(this._effect.setColor4("emissiveLeftColor",this.emissiveFresnelParameters.leftColor,this.emissiveFresnelParameters.power),this._effect.setColor4("emissiveRightColor",this.emissiveFresnelParameters.rightColor,this.emissiveFresnelParameters.bias))),this._myScene.texturesEnabled){if(this.albedoTexture&&e.StandardMaterial.DiffuseTextureEnabled&&(this._effect.setTexture("albedoSampler",this.albedoTexture),this._effect.setFloat2("vAlbedoInfos",this.albedoTexture.coordinatesIndex,this.albedoTexture.level),this._effect.setMatrix("albedoMatrix",this.albedoTexture.getTextureMatrix())),this.ambientTexture&&e.StandardMaterial.AmbientTextureEnabled&&(this._effect.setTexture("ambientSampler",this.ambientTexture),this._effect.setFloat2("vAmbientInfos",this.ambientTexture.coordinatesIndex,this.ambientTexture.level),this._effect.setMatrix("ambientMatrix",this.ambientTexture.getTextureMatrix())),this.opacityTexture&&e.StandardMaterial.OpacityTextureEnabled&&(this._effect.setTexture("opacitySampler",this.opacityTexture),this._effect.setFloat2("vOpacityInfos",this.opacityTexture.coordinatesIndex,this.opacityTexture.level),this._effect.setMatrix("opacityMatrix",this.opacityTexture.getTextureMatrix())),this.reflectionTexture&&e.StandardMaterial.ReflectionTextureEnabled&&(this._microsurfaceTextureLods.x=Math.round(Math.log(this.reflectionTexture.getSize().width)*Math.LOG2E),this.reflectionTexture.isCube?this._effect.setTexture("reflectionCubeSampler",this.reflectionTexture):this._effect.setTexture("reflection2DSampler",this.reflectionTexture),this._effect.setMatrix("reflectionMatrix",this.reflectionTexture.getReflectionTextureMatrix()),this._effect.setFloat2("vReflectionInfos",this.reflectionTexture.level,0),this._defines.USESPHERICALFROMREFLECTIONMAP&&(this._effect.setFloat3("vSphericalX",this.reflectionTexture.sphericalPolynomial.x.x,this.reflectionTexture.sphericalPolynomial.x.y,this.reflectionTexture.sphericalPolynomial.x.z),this._effect.setFloat3("vSphericalY",this.reflectionTexture.sphericalPolynomial.y.x,this.reflectionTexture.sphericalPolynomial.y.y,this.reflectionTexture.sphericalPolynomial.y.z),this._effect.setFloat3("vSphericalZ",this.reflectionTexture.sphericalPolynomial.z.x,this.reflectionTexture.sphericalPolynomial.z.y,this.reflectionTexture.sphericalPolynomial.z.z),this._effect.setFloat3("vSphericalXX",this.reflectionTexture.sphericalPolynomial.xx.x,this.reflectionTexture.sphericalPolynomial.xx.y,this.reflectionTexture.sphericalPolynomial.xx.z),this._effect.setFloat3("vSphericalYY",this.reflectionTexture.sphericalPolynomial.yy.x,this.reflectionTexture.sphericalPolynomial.yy.y,this.reflectionTexture.sphericalPolynomial.yy.z),this._effect.setFloat3("vSphericalZZ",this.reflectionTexture.sphericalPolynomial.zz.x,this.reflectionTexture.sphericalPolynomial.zz.y,this.reflectionTexture.sphericalPolynomial.zz.z),this._effect.setFloat3("vSphericalXY",this.reflectionTexture.sphericalPolynomial.xy.x,this.reflectionTexture.sphericalPolynomial.xy.y,this.reflectionTexture.sphericalPolynomial.xy.z),this._effect.setFloat3("vSphericalYZ",this.reflectionTexture.sphericalPolynomial.yz.x,this.reflectionTexture.sphericalPolynomial.yz.y,this.reflectionTexture.sphericalPolynomial.yz.z),this._effect.setFloat3("vSphericalZX",this.reflectionTexture.sphericalPolynomial.zx.x,this.reflectionTexture.sphericalPolynomial.zx.y,this.reflectionTexture.sphericalPolynomial.zx.z))),this.emissiveTexture&&e.StandardMaterial.EmissiveTextureEnabled&&(this._effect.setTexture("emissiveSampler",this.emissiveTexture),this._effect.setFloat2("vEmissiveInfos",this.emissiveTexture.coordinatesIndex,this.emissiveTexture.level),this._effect.setMatrix("emissiveMatrix",this.emissiveTexture.getTextureMatrix())),this.lightmapTexture&&e.StandardMaterial.LightmapTextureEnabled&&(this._effect.setTexture("lightmapSampler",this.lightmapTexture),this._effect.setFloat2("vLightmapInfos",this.lightmapTexture.coordinatesIndex,this.lightmapTexture.level),this._effect.setMatrix("lightmapMatrix",this.lightmapTexture.getTextureMatrix())),this.reflectivityTexture&&e.StandardMaterial.SpecularTextureEnabled&&(this._effect.setTexture("reflectivitySampler",this.reflectivityTexture),this._effect.setFloat2("vReflectivityInfos",this.reflectivityTexture.coordinatesIndex,this.reflectivityTexture.level),this._effect.setMatrix("reflectivityMatrix",this.reflectivityTexture.getTextureMatrix())),this.bumpTexture&&this._myScene.getEngine().getCaps().standardDerivatives&&e.StandardMaterial.BumpTextureEnabled&&!this.disableBumpMap&&(this._effect.setTexture("bumpSampler",this.bumpTexture),this._effect.setFloat3("vBumpInfos",this.bumpTexture.coordinatesIndex,1/this.bumpTexture.level,this.parallaxScaleBias),this._effect.setMatrix("bumpMatrix",this.bumpTexture.getTextureMatrix())),this.refractionTexture&&e.StandardMaterial.RefractionTextureEnabled){this._microsurfaceTextureLods.y=Math.round(Math.log(this.refractionTexture.getSize().width)*Math.LOG2E);var o=1;this.refractionTexture.isCube?this._effect.setTexture("refractionCubeSampler",this.refractionTexture):(this._effect.setTexture("refraction2DSampler",this.refractionTexture),this._effect.setMatrix("refractionMatrix",this.refractionTexture.getReflectionTextureMatrix()),this.refractionTexture.depth&&(o=this.refractionTexture.depth)),this._effect.setFloat4("vRefractionInfos",this.refractionTexture.level,this.indexOfRefraction,o,this.invertRefractionY?-1:1)}if((this.reflectionTexture||this.refractionTexture)&&this._effect.setFloat2("vMicrosurfaceTextureLods",this._microsurfaceTextureLods.x,this._microsurfaceTextureLods.y),this.cameraColorGradingTexture){this._effect.setTexture("cameraColorGrading2DSampler",this.cameraColorGradingTexture),this._cameraColorGradingInfos.x=this.cameraColorGradingTexture.level,this._cameraColorGradingInfos.y=this.cameraColorGradingTexture.getSize().height,this._cameraColorGradingInfos.z=this._cameraColorGradingInfos.y-1,this._cameraColorGradingInfos.w=1/this._cameraColorGradingInfos.y,this._effect.setFloat4("vCameraColorGradingInfos",this._cameraColorGradingInfos.x,this._cameraColorGradingInfos.y,this._cameraColorGradingInfos.z,this._cameraColorGradingInfos.w);var s=this._cameraColorGradingInfos.w/this._cameraColorGradingInfos.y,a=1/this._cameraColorGradingInfos.y;this._cameraColorGradingScaleOffset.x=this._cameraColorGradingInfos.z*s,this._cameraColorGradingScaleOffset.y=this._cameraColorGradingInfos.z/this._cameraColorGradingInfos.y,this._cameraColorGradingScaleOffset.z=.5*s,this._cameraColorGradingScaleOffset.w=.5*a,this._effect.setFloat4("vCameraColorGradingScaleOffset",this._cameraColorGradingScaleOffset.x,this._cameraColorGradingScaleOffset.y,this._cameraColorGradingScaleOffset.z,this._cameraColorGradingScaleOffset.w)}}e.MaterialHelper.BindClipPlane(this._effect,this._myScene),this.pointsCloud&&this._effect.setFloat("pointSize",this.pointSize),this._myScene.ambientColor.multiplyToRef(this.ambientColor,this._globalAmbientColor),this.convertColorToLinearSpaceToRef(this.reflectivityColor,r._scaledReflectivity),this._effect.setVector3("vEyePosition",this._myScene._mirroredCameraPosition?this._myScene._mirroredCameraPosition:this._myScene.activeCamera.position),this._effect.setColor3("vAmbientColor",this._globalAmbientColor),this._effect.setColor4("vReflectivityColor",r._scaledReflectivity,this.microSurface),this.convertColorToLinearSpaceToRef(this.emissiveColor,r._scaledEmissive),this._effect.setColor3("vEmissiveColor",r._scaledEmissive),this.convertColorToLinearSpaceToRef(this.reflectionColor,r._scaledReflection),this._effect.setColor3("vReflectionColor",r._scaledReflection)}this._myScene.getCachedMaterial()===this&&this.isFrozen||(this.convertColorToLinearSpaceToRef(this.albedoColor,r._scaledAlbedo),this._effect.setColor4("vAlbedoColor",r._scaledAlbedo,this.alpha*n.visibility),this._myScene.lightsEnabled&&!this.disableLighting&&r.BindLights(this._myScene,n,this._effect,this._defines,this.useScalarInLinearSpace,this.maxSimultaneousLights,this.usePhysicalLightFalloff),(this._myScene.fogEnabled&&n.applyFog&&this._myScene.fogMode!==e.Scene.FOGMODE_NONE||this.reflectionTexture)&&this._effect.setMatrix("view",this._myScene.getViewMatrix()),e.MaterialHelper.BindFogParameters(this._myScene,n,this._effect),this._lightingInfos.x=this.directIntensity,this._lightingInfos.y=this.emissiveIntensity,this._lightingInfos.z=this.environmentIntensity,this._lightingInfos.w=this.specularIntensity,this._effect.setVector4("vLightingIntensity",this._lightingInfos),this._overloadedShadowInfos.x=this.overloadedShadowIntensity,this._overloadedShadowInfos.y=this.overloadedShadeIntensity,this._effect.setVector4("vOverloadedShadowIntensity",this._overloadedShadowInfos),this._cameraInfos.x=this.cameraExposure,this._cameraInfos.y=this.cameraContrast,this._effect.setVector4("vCameraInfos",this._cameraInfos),this.cameraColorCurves&&e.ColorCurves.Bind(this.cameraColorCurves,this._effect),this._overloadedIntensity.x=this.overloadedAmbientIntensity,this._overloadedIntensity.y=this.overloadedAlbedoIntensity,this._overloadedIntensity.z=this.overloadedReflectivityIntensity,this._overloadedIntensity.w=this.overloadedEmissiveIntensity,this._effect.setVector4("vOverloadedIntensity",this._overloadedIntensity),this.convertColorToLinearSpaceToRef(this.overloadedAmbient,this._tempColor),this._effect.setColor3("vOverloadedAmbient",this._tempColor),this.convertColorToLinearSpaceToRef(this.overloadedAlbedo,this._tempColor),this._effect.setColor3("vOverloadedAlbedo",this._tempColor),this.convertColorToLinearSpaceToRef(this.overloadedReflectivity,this._tempColor),this._effect.setColor3("vOverloadedReflectivity",this._tempColor),this.convertColorToLinearSpaceToRef(this.overloadedEmissive,this._tempColor),this._effect.setColor3("vOverloadedEmissive",this._tempColor),this.convertColorToLinearSpaceToRef(this.overloadedReflection,this._tempColor),this._effect.setColor3("vOverloadedReflection",this._tempColor),this._overloadedMicroSurface.x=this.overloadedMicroSurface,this._overloadedMicroSurface.y=this.overloadedMicroSurfaceIntensity,this._overloadedMicroSurface.z=this.overloadedReflectionIntensity,this._effect.setVector3("vOverloadedMicroSurface",this._overloadedMicroSurface),e.MaterialHelper.BindLogDepth(this._defines,this._effect,this._myScene)),i.prototype.bind.call(this,t,n),this._myScene=null},r.prototype.getAnimatables=function(){var e=[];return this.albedoTexture&&this.albedoTexture.animations&&this.albedoTexture.animations.length>0&&e.push(this.albedoTexture),this.ambientTexture&&this.ambientTexture.animations&&this.ambientTexture.animations.length>0&&e.push(this.ambientTexture),this.opacityTexture&&this.opacityTexture.animations&&this.opacityTexture.animations.length>0&&e.push(this.opacityTexture),this.reflectionTexture&&this.reflectionTexture.animations&&this.reflectionTexture.animations.length>0&&e.push(this.reflectionTexture),this.emissiveTexture&&this.emissiveTexture.animations&&this.emissiveTexture.animations.length>0&&e.push(this.emissiveTexture),this.reflectivityTexture&&this.reflectivityTexture.animations&&this.reflectivityTexture.animations.length>0&&e.push(this.reflectivityTexture),this.bumpTexture&&this.bumpTexture.animations&&this.bumpTexture.animations.length>0&&e.push(this.bumpTexture),this.lightmapTexture&&this.lightmapTexture.animations&&this.lightmapTexture.animations.length>0&&e.push(this.lightmapTexture),this.refractionTexture&&this.refractionTexture.animations&&this.refractionTexture.animations.length>0&&e.push(this.refractionTexture),this.cameraColorGradingTexture&&this.cameraColorGradingTexture.animations&&this.cameraColorGradingTexture.animations.length>0&&e.push(this.cameraColorGradingTexture),e},r.prototype.dispose=function(e,t){t&&(this.albedoTexture&&this.albedoTexture.dispose(),this.ambientTexture&&this.ambientTexture.dispose(),this.opacityTexture&&this.opacityTexture.dispose(),this.reflectionTexture&&this.reflectionTexture.dispose(),this.emissiveTexture&&this.emissiveTexture.dispose(),this.reflectivityTexture&&this.reflectivityTexture.dispose(),this.bumpTexture&&this.bumpTexture.dispose(),this.lightmapTexture&&this.lightmapTexture.dispose(),this.refractionTexture&&this.refractionTexture.dispose(),this.cameraColorGradingTexture&&this.cameraColorGradingTexture.dispose()),i.prototype.dispose.call(this,e,t)},r.prototype.clone=function(t){var i=this;return e.SerializationHelper.Clone(function(){return new r(t,i.getScene())},this)},r.prototype.serialize=function(){var t=e.SerializationHelper.Serialize(this);return t.customType="BABYLON.PBRMaterial",t},r.Parse=function(t,i,n){return e.SerializationHelper.Parse(function(){return new r(t.name,i)},t,i,n)},r._scaledAlbedo=new e.Color3,r._scaledReflectivity=new e.Color3,r._scaledEmissive=new e.Color3,r._scaledReflection=new e.Color3,__decorate([e.serialize()],r.prototype,"directIntensity",void 0),__decorate([e.serialize()],r.prototype,"emissiveIntensity",void 0),__decorate([e.serialize()],r.prototype,"environmentIntensity",void 0),__decorate([e.serialize()],r.prototype,"specularIntensity",void 0),__decorate([e.serialize()],r.prototype,"disableBumpMap",void 0),__decorate([e.serialize()],r.prototype,"overloadedShadowIntensity",void 0),__decorate([e.serialize()],r.prototype,"overloadedShadeIntensity",void 0),__decorate([e.serialize()],r.prototype,"cameraExposure",void 0),__decorate([e.serialize()],r.prototype,"cameraContrast",void 0),__decorate([e.serializeAsTexture()],r.prototype,"cameraColorGradingTexture",void 0),__decorate([e.serializeAsColorCurves()],r.prototype,"cameraColorCurves",void 0),__decorate([e.serializeAsColor3()],r.prototype,"overloadedAmbient",void 0),__decorate([e.serialize()],r.prototype,"overloadedAmbientIntensity",void 0),__decorate([e.serializeAsColor3()],r.prototype,"overloadedAlbedo",void 0),__decorate([e.serialize()],r.prototype,"overloadedAlbedoIntensity",void 0),__decorate([e.serializeAsColor3()],r.prototype,"overloadedReflectivity",void 0),__decorate([e.serialize()],r.prototype,"overloadedReflectivityIntensity",void 0),__decorate([e.serializeAsColor3()],r.prototype,"overloadedEmissive",void 0),__decorate([e.serialize()],r.prototype,"overloadedEmissiveIntensity",void 0),__decorate([e.serializeAsColor3()],r.prototype,"overloadedReflection",void 0),__decorate([e.serialize()],r.prototype,"overloadedReflectionIntensity",void 0),__decorate([e.serialize()],r.prototype,"overloadedMicroSurface",void 0),__decorate([e.serialize()],r.prototype,"overloadedMicroSurfaceIntensity",void 0),__decorate([e.serializeAsTexture()],r.prototype,"albedoTexture",void 0),__decorate([e.serializeAsTexture()],r.prototype,"ambientTexture",void 0),__decorate([e.serializeAsTexture()],r.prototype,"opacityTexture",void 0),__decorate([e.serializeAsTexture()],r.prototype,"reflectionTexture",void 0),__decorate([e.serializeAsTexture()],r.prototype,"emissiveTexture",void 0),__decorate([e.serializeAsTexture()],r.prototype,"reflectivityTexture",void 0),__decorate([e.serializeAsTexture()],r.prototype,"bumpTexture",void 0),__decorate([e.serializeAsTexture()],r.prototype,"lightmapTexture",void 0),__decorate([e.serializeAsTexture()],r.prototype,"refractionTexture",void 0),__decorate([e.serializeAsColor3("ambient")],r.prototype,"ambientColor",void 0),__decorate([e.serializeAsColor3("albedo")],r.prototype,"albedoColor",void 0),__decorate([e.serializeAsColor3("reflectivity")],r.prototype,"reflectivityColor",void 0),__decorate([e.serializeAsColor3("reflection")],r.prototype,"reflectionColor",void 0),__decorate([e.serializeAsColor3("emissive")],r.prototype,"emissiveColor",void 0),__decorate([e.serialize()],r.prototype,"microSurface",void 0),__decorate([e.serialize()],r.prototype,"indexOfRefraction",void 0),__decorate([e.serialize()],r.prototype,"invertRefractionY",void 0),__decorate([e.serializeAsFresnelParameters()],r.prototype,"opacityFresnelParameters",void 0),__decorate([e.serializeAsFresnelParameters()],r.prototype,"emissiveFresnelParameters",void 0),__decorate([e.serialize()],r.prototype,"linkRefractionWithTransparency",void 0),__decorate([e.serialize()],r.prototype,"linkEmissiveWithAlbedo",void 0),__decorate([e.serialize()],r.prototype,"useLightmapAsShadowmap",void 0),__decorate([e.serialize()],r.prototype,"useEmissiveAsIllumination",void 0),__decorate([e.serialize()],r.prototype,"useAlphaFromAlbedoTexture",void 0),__decorate([e.serialize()],r.prototype,"useSpecularOverAlpha",void 0),__decorate([e.serialize()],r.prototype,"useMicroSurfaceFromReflectivityMapAlpha",void 0),__decorate([e.serialize()],r.prototype,"useAutoMicroSurfaceFromReflectivityMap",void 0),__decorate([e.serialize()],r.prototype,"useScalarInLinearSpace",void 0),__decorate([e.serialize()],r.prototype,"usePhysicalLightFalloff",void 0),__decorate([e.serialize()],r.prototype,"useRadianceOverAlpha",void 0),__decorate([e.serialize()],r.prototype,"useParallax",void 0),__decorate([e.serialize()],r.prototype,"useParallaxOcclusion",void 0),__decorate([e.serialize()],r.prototype,"parallaxScaleBias",void 0),__decorate([e.serialize()],r.prototype,"disableLighting",void 0),__decorate([e.serialize()],r.prototype,"maxSimultaneousLights",void 0),__decorate([e.serialize()],r.prototype,"invertNormalMapX",void 0),__decorate([e.serialize()],r.prototype,"invertNormalMapY",void 0),__decorate([e.serialize()],r.prototype,"useLogarithmicDepth",null),r}(e.Material);e.PBRMaterial=i}(BABYLON||(BABYLON={}));var BABYLON;!function(e){var t=function(){function t(t){var i=this;this._transformationMatrix=e.Matrix.Identity(),this._enabled=!1,this._labelsEnabled=!1,this._displayStatistics=!0,this._displayTree=!1,this._displayLogs=!1,this._skeletonViewers=new Array,this._identityMatrix=e.Matrix.Identity(),this.axisRatio=.02,this.accentColor="orange",this._scene=t,this._syncPositions=function(){var e=i._scene.getEngine(),t=e.getRenderingCanvasClientRect();i._showUI&&(i._statsDiv.style.left=t.width-410+"px",i._statsDiv.style.top=t.height-290+"px",i._statsDiv.style.width="400px",i._statsDiv.style.height="auto",i._statsSubsetDiv.style.maxHeight="240px",i._optionsDiv.style.left="0px",i._optionsDiv.style.top="10px",i._optionsDiv.style.width="200px",i._optionsDiv.style.height="auto",i._optionsSubsetDiv.style.maxHeight=t.height-225+"px",i._logDiv.style.left="0px",i._logDiv.style.top=t.height-170+"px",i._logDiv.style.width="600px",i._logDiv.style.height="160px",i._treeDiv.style.left=t.width-310+"px",i._treeDiv.style.top="10px",i._treeDiv.style.width="300px",i._treeDiv.style.height="auto",i._treeSubsetDiv.style.maxHeight=t.height-340+"px"),i._globalDiv.style.left=t.left+"px",i._globalDiv.style.top=t.top+"px",i._drawingCanvas.style.left="0px",i._drawingCanvas.style.top="0px",i._drawingCanvas.style.width=e.getRenderWidth()+"px",i._drawingCanvas.style.height=e.getRenderHeight()+"px";var r=window.devicePixelRatio||1,n=i._drawingContext,o=n.webkitBackingStorePixelRatio||n.mozBackingStorePixelRatio||n.msBackingStorePixelRatio||n.oBackingStorePixelRatio||n.backingStorePixelRatio||1;i._ratio=r/o,i._drawingCanvas.width=e.getRenderWidth()*i._ratio,i._drawingCanvas.height=e.getRenderHeight()*i._ratio},this._onCanvasClick=function(e){i._clickPosition={x:e.clientX*i._ratio,y:e.clientY*i._ratio}},this._syncUI=function(){i._showUI&&(i._displayStatistics?(i._displayStats(),i._statsDiv.style.display=""):i._statsDiv.style.display="none",i._displayLogs?i._logDiv.style.display="":i._logDiv.style.display="none",i._displayTree?(i._treeDiv.style.display="",i._needToRefreshMeshesTree&&(i._needToRefreshMeshesTree=!1,i._refreshMeshesTreeContent())):i._treeDiv.style.display="none")},this._syncData=function(){if(i._labelsEnabled||!i._showUI){i._camera.getViewMatrix().multiplyToRef(i._camera.getProjectionMatrix(),i._transformationMatrix),i._drawingContext.clearRect(0,0,i._drawingCanvas.width,i._drawingCanvas.height);var t,r,n=i._scene.getEngine(),o=i._camera.viewport,s=o.toGlobal(n.getRenderWidth(),n.getRenderHeight()),a=i._camera.getActiveMeshes();for(t=0;t<a.length;t++){var h=a.data[t],c=h.getBoundingInfo().boundingSphere.center;r=e.Vector3.Project(c,h.getWorldMatrix(),i._transformationMatrix,s),(h.renderOverlay||i.shouldDisplayAxis&&i.shouldDisplayAxis(h))&&i._renderAxis(r,h,s),i.shouldDisplayLabel&&!i.shouldDisplayLabel(h)||i._renderLabel(h.name,r,12,function(){h.renderOverlay=!h.renderOverlay},function(){return h.renderOverlay?"red":"black"})}var l=i._scene.cameras;for(t=0;t<l.length;t++){var u=l[t];u!==i._camera&&(r=e.Vector3.Project(e.Vector3.Zero(),u.getWorldMatrix(),i._transformationMatrix,s),i.shouldDisplayLabel&&!i.shouldDisplayLabel(u)||i._renderLabel(u.name,r,12,function(){i._camera.detachControl(n.getRenderingCanvas()),i._camera=u,i._camera.attachControl(n.getRenderingCanvas())},function(){return"purple"}))}var f=i._scene.lights;for(t=0;t<f.length;t++){var d=f[t];d.position&&(r=e.Vector3.Project(d.getAbsolutePosition(),i._identityMatrix,i._transformationMatrix,s),i.shouldDisplayLabel&&!i.shouldDisplayLabel(d)||i._renderLabel(d.name,r,-20,function(){d.setEnabled(!d.isEnabled())},function(){return d.isEnabled()?"orange":"gray"}))}}i._clickPosition=void 0}}return t.prototype._refreshMeshesTreeContent=function(){for(;this._treeSubsetDiv.hasChildNodes();)this._treeSubsetDiv.removeChild(this._treeSubsetDiv.lastChild);var e=this._scene.meshes.slice(0,this._scene.meshes.length);e.sort(function(e,t){return e.name===t.name?0:e.name>t.name?1:-1});for(var t=0;t<e.length;t++){var i=e[t];i.isEnabled()&&this._generateAdvancedCheckBox(this._treeSubsetDiv,i.name,i.getTotalVertices()+" verts",i.isVisible,function(e,t){t.isVisible=e.checked},i)}},t.prototype._renderSingleAxis=function(e,t,i,r,n){this._drawingContext.beginPath(),this._drawingContext.moveTo(e.x,e.y),this._drawingContext.lineTo(t.x,t.y),this._drawingContext.strokeStyle=n,this._drawingContext.lineWidth=4,this._drawingContext.stroke(),this._drawingContext.font="normal 14px Segoe UI",this._drawingContext.fillStyle=n,this._drawingContext.fillText(r,i.x,i.y);
},t.prototype._renderAxis=function(t,i,r){var n=i.getBoundingInfo().boundingSphere.center,o=i.getWorldMatrix(),s=e.Vector3.UnprojectFromTransform(t.add(new e.Vector3(this._drawingCanvas.width*this.axisRatio,0,0)),r.width,r.height,o,this._transformationMatrix),a=s.subtract(n).length(),h=e.Vector3.Project(n.add(new e.Vector3(a,0,0)),o,this._transformationMatrix,r),c=e.Vector3.Project(n.add(new e.Vector3(1.5*a,0,0)),o,this._transformationMatrix,r);this._renderSingleAxis(t,h,c,"x","#FF0000");var l=e.Vector3.Project(n.add(new e.Vector3(0,a,0)),o,this._transformationMatrix,r),u=e.Vector3.Project(n.add(new e.Vector3(0,1.5*a,0)),o,this._transformationMatrix,r);this._renderSingleAxis(t,l,u,"y","#00FF00");var f=e.Vector3.Project(n.add(new e.Vector3(0,0,a)),o,this._transformationMatrix,r),d=e.Vector3.Project(n.add(new e.Vector3(0,0,1.5*a)),o,this._transformationMatrix,r);this._renderSingleAxis(t,f,d,"z","#0000FF")},t.prototype._renderLabel=function(e,t,i,r,n){if(t.z>0&&t.z<1){this._drawingContext.font="normal 12px Segoe UI";var o=this._drawingContext.measureText(e),s=t.x-o.width/2,a=t.y,h=this._drawingCanvas.getBoundingClientRect();this._showUI&&this._isClickInsideRect(h.left*this._ratio+s-5,h.top*this._ratio+a-i-12,o.width+10,17)&&r(),this._drawingContext.beginPath(),this._drawingContext.rect(s-5,a-i-12,o.width+10,17),this._drawingContext.fillStyle=n(),this._drawingContext.globalAlpha=.5,this._drawingContext.fill(),this._drawingContext.globalAlpha=1,this._drawingContext.strokeStyle="#FFFFFF",this._drawingContext.lineWidth=1,this._drawingContext.stroke(),this._drawingContext.fillStyle="#FFFFFF",this._drawingContext.fillText(e,s,a-i),this._drawingContext.beginPath(),this._drawingContext.arc(t.x,a,5,0,2*Math.PI,!1),this._drawingContext.fill()}},t.prototype._isClickInsideRect=function(e,t,i,r){return this._clickPosition?this._clickPosition.x<e||this._clickPosition.x>e+i?!1:!(this._clickPosition.y<t||this._clickPosition.y>t+r):!1},t.prototype.isVisible=function(){return this._enabled},t.prototype.hide=function(){if(this._enabled){this._enabled=!1;var t=this._scene.getEngine();this._scene.unregisterBeforeRender(this._syncData),this._scene.unregisterAfterRender(this._syncUI),this._rootElement.removeChild(this._globalDiv),this._scene.forceShowBoundingBoxes=!1,this._scene.forceWireframe=!1,e.StandardMaterial.DiffuseTextureEnabled=!0,e.StandardMaterial.AmbientTextureEnabled=!0,e.StandardMaterial.SpecularTextureEnabled=!0,e.StandardMaterial.EmissiveTextureEnabled=!0,e.StandardMaterial.BumpTextureEnabled=!0,e.StandardMaterial.OpacityTextureEnabled=!0,e.StandardMaterial.ReflectionTextureEnabled=!0,e.StandardMaterial.LightmapTextureEnabled=!0,e.StandardMaterial.RefractionTextureEnabled=!0,this._scene.shadowsEnabled=!0,this._scene.particlesEnabled=!0,this._scene.postProcessesEnabled=!0,this._scene.collisionsEnabled=!0,this._scene.lightsEnabled=!0,this._scene.texturesEnabled=!0,this._scene.lensFlaresEnabled=!0,this._scene.proceduralTexturesEnabled=!0,this._scene.renderTargetsEnabled=!0,this._scene.probesEnabled=!0,t.getRenderingCanvas().removeEventListener("click",this._onCanvasClick),this._clearSkeletonViewers()}},t.prototype._clearSkeletonViewers=function(){for(var e=0;e<this._skeletonViewers.length;e++)this._skeletonViewers[e].dispose();this._skeletonViewers=[]},t.prototype.show=function(e,t,i){if(void 0===e&&(e=!0),void 0===t&&(t=null),void 0===i&&(i=null),!this._enabled){this._enabled=!0,t?this._camera=t:this._camera=this._scene.activeCamera,this._showUI=e;var r=this._scene.getEngine();this._globalDiv=document.createElement("div"),this._rootElement=i||document.body,this._rootElement.appendChild(this._globalDiv),this._generateDOMelements(),r.getRenderingCanvas().addEventListener("click",this._onCanvasClick),this._syncPositions(),this._scene.registerBeforeRender(this._syncData),this._scene.registerAfterRender(this._syncUI)}},t.prototype._clearLabels=function(){this._drawingContext.clearRect(0,0,this._drawingCanvas.width,this._drawingCanvas.height);for(var e=0;e<this._scene.meshes.length;e++){var t=this._scene.meshes[e];t.renderOverlay=!1}},t.prototype._generateheader=function(e,t){var i=document.createElement("div");i.innerHTML=t+"&nbsp;",i.style.textAlign="right",i.style.width="100%",i.style.color="white",i.style.backgroundColor="Black",i.style.padding="5px 5px 4px 0px",i.style.marginLeft="-5px",i.style.fontWeight="bold",e.appendChild(i)},t.prototype._generateTexBox=function(e,t,i){var r=document.createElement("label");r.style.display="inline",r.innerHTML=t,r.style.color=i,e.appendChild(r),e.appendChild(document.createElement("br"))},t.prototype._generateAdvancedCheckBox=function(e,t,i,r,n,o){void 0===o&&(o=null);var s=document.createElement("label");s.style.display="inline";var a=document.createElement("input");a.type="checkbox",a.checked=r,a.style.display="inline",a.style.margin="0px 5px 0px 0px",a.style.verticalAlign="sub",a.addEventListener("change",function(e){n(e.target,o)}),s.appendChild(a);var h=document.createElement("span"),c=document.createElement("span"),l=document.createElement("span");l.style.cssFloat="right",c.innerHTML=t,l.innerHTML=i,l.style.fontSize="12px",l.style.maxWidth="200px",h.appendChild(c),h.appendChild(l),s.appendChild(h),e.appendChild(s),e.appendChild(document.createElement("br"))},t.prototype._generateCheckBox=function(e,t,i,r,n){void 0===n&&(n=null);var o=document.createElement("label");o.style.display="inline";var s=document.createElement("input");s.type="checkbox",s.checked=i,s.style.display="inline",s.style.margin="0px 5px 0px 0px",s.style.verticalAlign="sub",s.addEventListener("change",function(e){r(e.target,n)}),o.appendChild(s),o.appendChild(document.createTextNode(t)),e.appendChild(o),e.appendChild(document.createElement("br"))},t.prototype._generateButton=function(e,t,i,r){void 0===r&&(r=null);var n=document.createElement("button");n.innerHTML=t,n.style.height="24px",n.style.width="150px",n.style.marginBottom="5px",n.style.color="#444444",n.style.border="1px solid white",n.className="debugLayerButton",n.addEventListener("click",function(e){i(e.target,r)}),e.appendChild(n),e.appendChild(document.createElement("br"))},t.prototype._generateRadio=function(e,t,i,r,n,o){void 0===o&&(o=null);var s=document.createElement("label");s.style.display="inline";var a=document.createElement("input");a.type="radio",a.name=i,a.checked=r,a.style.display="inline",a.style.margin="0px 5px 0px 0px",a.style.verticalAlign="sub",a.addEventListener("change",function(e){n(e.target,o)}),s.appendChild(a),s.appendChild(document.createTextNode(t)),e.appendChild(s),e.appendChild(document.createElement("br"))},t.prototype._generateDOMelements=function(){var t=this;if(this._globalDiv.id="DebugLayer",this._globalDiv.style.position="absolute",this._globalDiv.style.fontFamily="Segoe UI, Arial",this._globalDiv.style.fontSize="14px",this._globalDiv.style.color="white",this._drawingCanvas=document.createElement("canvas"),this._drawingCanvas.id="DebugLayerDrawingCanvas",this._drawingCanvas.style.position="absolute",this._drawingCanvas.style.pointerEvents="none",this._drawingCanvas.style.backgroundColor="transparent",this._drawingContext=this._drawingCanvas.getContext("2d"),this._globalDiv.appendChild(this._drawingCanvas),this._showUI){var i="rgba(128, 128, 128, 0.4)",r="rgb(180, 180, 180) solid 1px";this._statsDiv=document.createElement("div"),this._statsDiv.id="DebugLayerStats",this._statsDiv.style.border=r,this._statsDiv.style.position="absolute",this._statsDiv.style.background=i,this._statsDiv.style.padding="0px 0px 0px 5px",this._generateheader(this._statsDiv,"STATISTICS"),this._statsSubsetDiv=document.createElement("div"),this._statsSubsetDiv.style.paddingTop="5px",this._statsSubsetDiv.style.paddingBottom="5px",this._statsSubsetDiv.style.overflowY="auto",this._statsDiv.appendChild(this._statsSubsetDiv),this._treeDiv=document.createElement("div"),this._treeDiv.id="DebugLayerTree",this._treeDiv.style.border=r,this._treeDiv.style.position="absolute",this._treeDiv.style.background=i,this._treeDiv.style.padding="0px 0px 0px 5px",this._treeDiv.style.display="none",this._generateheader(this._treeDiv,"MESHES TREE"),this._treeSubsetDiv=document.createElement("div"),this._treeSubsetDiv.style.paddingTop="5px",this._treeSubsetDiv.style.paddingRight="5px",this._treeSubsetDiv.style.overflowY="auto",this._treeSubsetDiv.style.maxHeight="300px",this._treeDiv.appendChild(this._treeSubsetDiv),this._needToRefreshMeshesTree=!0,this._logDiv=document.createElement("div"),this._logDiv.style.border=r,this._logDiv.id="DebugLayerLogs",this._logDiv.style.position="absolute",this._logDiv.style.background=i,this._logDiv.style.padding="0px 0px 0px 5px",this._logDiv.style.display="none",this._generateheader(this._logDiv,"LOGS"),this._logSubsetDiv=document.createElement("div"),this._logSubsetDiv.style.height="127px",this._logSubsetDiv.style.paddingTop="5px",this._logSubsetDiv.style.overflowY="auto",this._logSubsetDiv.style.fontSize="12px",this._logSubsetDiv.style.fontFamily="consolas",this._logSubsetDiv.innerHTML=e.Tools.LogCache,this._logDiv.appendChild(this._logSubsetDiv),e.Tools.OnNewCacheEntry=function(e){t._logSubsetDiv.innerHTML=e+t._logSubsetDiv.innerHTML},this._optionsDiv=document.createElement("div"),this._optionsDiv.id="DebugLayerOptions",this._optionsDiv.style.border=r,this._optionsDiv.style.position="absolute",this._optionsDiv.style.background=i,this._optionsDiv.style.padding="0px 0px 0px 5px",this._optionsDiv.style.overflowY="auto",this._generateheader(this._optionsDiv,"OPTIONS"),this._optionsSubsetDiv=document.createElement("div"),this._optionsSubsetDiv.style.paddingTop="5px",this._optionsSubsetDiv.style.paddingBottom="5px",this._optionsSubsetDiv.style.overflowY="auto",this._optionsSubsetDiv.style.maxHeight="200px",this._optionsDiv.appendChild(this._optionsSubsetDiv),this._generateTexBox(this._optionsSubsetDiv,"<b>Windows:</b>",this.accentColor),this._generateCheckBox(this._optionsSubsetDiv,"Statistics",this._displayStatistics,function(e){t._displayStatistics=e.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Logs",this._displayLogs,function(e){t._displayLogs=e.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Meshes tree",this._displayTree,function(e){t._displayTree=e.checked,t._needToRefreshMeshesTree=!0}),this._optionsSubsetDiv.appendChild(document.createElement("br")),this._generateTexBox(this._optionsSubsetDiv,"<b>General:</b>",this.accentColor),this._generateCheckBox(this._optionsSubsetDiv,"Bounding boxes",this._scene.forceShowBoundingBoxes,function(e){t._scene.forceShowBoundingBoxes=e.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Clickable labels",this._labelsEnabled,function(e){t._labelsEnabled=e.checked,t._labelsEnabled||t._clearLabels()}),this._generateCheckBox(this._optionsSubsetDiv,"Generate user marks (F12)",e.Tools.PerformanceLogLevel===e.Tools.PerformanceUserMarkLogLevel,function(t){t.checked?e.Tools.PerformanceLogLevel=e.Tools.PerformanceUserMarkLogLevel:e.Tools.PerformanceLogLevel=e.Tools.PerformanceNoneLogLevel}),this._optionsSubsetDiv.appendChild(document.createElement("br")),this._generateTexBox(this._optionsSubsetDiv,"<b>Rendering mode:</b>",this.accentColor),this._generateRadio(this._optionsSubsetDiv,"Solid","renderMode",!this._scene.forceWireframe&&!this._scene.forcePointsCloud,function(e){e.checked&&(t._scene.forceWireframe=!1,t._scene.forcePointsCloud=!1)}),this._generateRadio(this._optionsSubsetDiv,"Wireframe","renderMode",this._scene.forceWireframe,function(e){e.checked&&(t._scene.forceWireframe=!0,t._scene.forcePointsCloud=!1)}),this._generateRadio(this._optionsSubsetDiv,"Point","renderMode",this._scene.forcePointsCloud,function(e){e.checked&&(t._scene.forceWireframe=!1,t._scene.forcePointsCloud=!0)}),this._optionsSubsetDiv.appendChild(document.createElement("br")),this._generateTexBox(this._optionsSubsetDiv,"<b>Texture channels:</b>",this.accentColor),this._generateCheckBox(this._optionsSubsetDiv,"Diffuse",e.StandardMaterial.DiffuseTextureEnabled,function(t){e.StandardMaterial.DiffuseTextureEnabled=t.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Ambient",e.StandardMaterial.AmbientTextureEnabled,function(t){e.StandardMaterial.AmbientTextureEnabled=t.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Specular",e.StandardMaterial.SpecularTextureEnabled,function(t){e.StandardMaterial.SpecularTextureEnabled=t.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Emissive",e.StandardMaterial.EmissiveTextureEnabled,function(t){e.StandardMaterial.EmissiveTextureEnabled=t.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Bump",e.StandardMaterial.BumpTextureEnabled,function(t){e.StandardMaterial.BumpTextureEnabled=t.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Opacity",e.StandardMaterial.OpacityTextureEnabled,function(t){e.StandardMaterial.OpacityTextureEnabled=t.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Reflection",e.StandardMaterial.ReflectionTextureEnabled,function(t){e.StandardMaterial.ReflectionTextureEnabled=t.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Refraction",e.StandardMaterial.RefractionTextureEnabled,function(t){e.StandardMaterial.RefractionTextureEnabled=t.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Lightmap",e.StandardMaterial.LightmapTextureEnabled,function(t){e.StandardMaterial.LightmapTextureEnabled=t.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Fresnel",e.StandardMaterial.FresnelEnabled,function(t){e.StandardMaterial.FresnelEnabled=t.checked}),this._optionsSubsetDiv.appendChild(document.createElement("br")),this._generateTexBox(this._optionsSubsetDiv,"<b>Options:</b>",this.accentColor),this._generateCheckBox(this._optionsSubsetDiv,"Animations",this._scene.animationsEnabled,function(e){t._scene.animationsEnabled=e.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Collisions",this._scene.collisionsEnabled,function(e){t._scene.collisionsEnabled=e.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Fog",this._scene.fogEnabled,function(e){t._scene.fogEnabled=e.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Lens flares",this._scene.lensFlaresEnabled,function(e){t._scene.lensFlaresEnabled=e.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Lights",this._scene.lightsEnabled,function(e){t._scene.lightsEnabled=e.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Particles",this._scene.particlesEnabled,function(e){t._scene.particlesEnabled=e.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Post-processes",this._scene.postProcessesEnabled,function(e){t._scene.postProcessesEnabled=e.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Probes",this._scene.probesEnabled,function(e){t._scene.probesEnabled=e.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Procedural textures",this._scene.proceduralTexturesEnabled,function(e){t._scene.proceduralTexturesEnabled=e.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Render targets",this._scene.renderTargetsEnabled,function(e){t._scene.renderTargetsEnabled=e.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Shadows",this._scene.shadowsEnabled,function(e){t._scene.shadowsEnabled=e.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Skeletons",this._scene.skeletonsEnabled,function(e){t._scene.skeletonsEnabled=e.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Sprites",this._scene.spritesEnabled,function(e){t._scene.spritesEnabled=e.checked}),this._generateCheckBox(this._optionsSubsetDiv,"Textures",this._scene.texturesEnabled,function(e){t._scene.texturesEnabled=e.checked}),e.AudioEngine&&e.Engine.audioEngine.canUseWebAudio&&(this._optionsSubsetDiv.appendChild(document.createElement("br")),this._generateTexBox(this._optionsSubsetDiv,"<b>Audio:</b>",this.accentColor),this._generateRadio(this._optionsSubsetDiv,"Headphones","panningModel",this._scene.headphone,function(e){e.checked&&(t._scene.headphone=!0)}),this._generateRadio(this._optionsSubsetDiv,"Normal Speakers","panningModel",!this._scene.headphone,function(e){e.checked&&(t._scene.headphone=!1)}),this._generateCheckBox(this._optionsSubsetDiv,"Disable audio",!this._scene.audioEnabled,function(e){t._scene.audioEnabled=!e.checked})),this._optionsSubsetDiv.appendChild(document.createElement("br")),this._generateTexBox(this._optionsSubsetDiv,"<b>Viewers:</b>",this.accentColor),this._generateCheckBox(this._optionsSubsetDiv,"Skeletons",!1,function(i){if(!i.checked)return void t._clearSkeletonViewers();for(var r=0;r<t._scene.meshes.length;r++){var n=t._scene.meshes[r];if(n.skeleton){for(var o=!1,s=0;s<t._skeletonViewers.length;s++)if(t._skeletonViewers[s].skeleton===n.skeleton){o=!0;break}if(o)continue;var a=new e.Debug.SkeletonViewer(n.skeleton,n,t._scene);a.isEnabled=!0,t._skeletonViewers.push(a)}}}),this._optionsSubsetDiv.appendChild(document.createElement("br")),this._generateTexBox(this._optionsSubsetDiv,"<b>Tools:</b>",this.accentColor),this._generateButton(this._optionsSubsetDiv,"Dump rendertargets",function(e){t._scene.dumpNextRenderTargets=!0}),this._generateButton(this._optionsSubsetDiv,"Run SceneOptimizer",function(i){e.SceneOptimizer.OptimizeAsync(t._scene)}),this._generateButton(this._optionsSubsetDiv,"Log camera object",function(e){t._camera?console.log(t._camera):console.warn("No camera defined, or debug layer created before camera creation!")}),this._optionsSubsetDiv.appendChild(document.createElement("br")),this._globalDiv.appendChild(this._statsDiv),this._globalDiv.appendChild(this._logDiv),this._globalDiv.appendChild(this._optionsDiv),this._globalDiv.appendChild(this._treeDiv)}},t.prototype._displayStats=function(){var t=this._scene,i=t.getEngine(),r=i.getGlInfo();this._statsSubsetDiv.innerHTML="Babylon.js v"+e.Engine.Version+" - <b>"+e.Tools.Format(i.getFps(),0)+" fps</b><br><br><div style='column-count: 2;-moz-column-count:2;-webkit-column-count:2'><b>Count</b><br>Total meshes: "+t.meshes.length+"<br>Total lights: "+t.lights.length+"<br>Total vertices: "+t.getTotalVertices()+"<br>Total materials: "+t.materials.length+"<br>Total textures: "+t.textures.length+"<br>Active meshes: "+t.getActiveMeshes().length+"<br>Active indices: "+t.getActiveIndices()+"<br>Active bones: "+t.getActiveBones()+"<br>Active particles: "+t.getActiveParticles()+"<br><b>Draw calls: "+i.drawCalls+"</b><br><br><b>Duration</b><br>Meshes selection:</i> "+e.Tools.Format(t.getEvaluateActiveMeshesDuration())+" ms<br>Render Targets: "+e.Tools.Format(t.getRenderTargetsDuration())+" ms<br>Particles: "+e.Tools.Format(t.getParticlesDuration())+" ms<br>Sprites: "+e.Tools.Format(t.getSpritesDuration())+" ms<br><br>Render: <b>"+e.Tools.Format(t.getRenderDuration())+" ms</b><br>Frame: "+e.Tools.Format(t.getLastFrameDuration())+" ms<br>Potential FPS: "+e.Tools.Format(1e3/t.getLastFrameDuration(),0)+"<br>Resolution: "+i.getRenderWidth()+"x"+i.getRenderHeight()+"<br><br></div><div style='column-count: 2;-moz-column-count:2;-webkit-column-count:2'><b>Extensions</b><br>Std derivatives: "+(i.getCaps().standardDerivatives?"Yes":"No")+"<br>Compressed textures: "+(i.getCaps().s3tc?"Yes":"No")+"<br>Hardware instances: "+(i.getCaps().instancedArrays?"Yes":"No")+"<br>Texture float: "+(i.getCaps().textureFloat?"Yes":"No")+"<br><br>32bits indices: "+(i.getCaps().uintIndices?"Yes":"No")+"<br>Fragment depth: "+(i.getCaps().fragmentDepthSupported?"Yes":"No")+"<br>High precision shaders: "+(i.getCaps().highPrecisionShaderSupported?"Yes":"No")+"<br>Draw buffers: "+(i.getCaps().drawBuffersExtension?"Yes":"No")+"<br></div><br><div style='column-count: 2;-moz-column-count:2;-webkit-column-count:2'><b>Caps.</b><br>Max textures units: "+i.getCaps().maxTexturesImageUnits+"<br>Max textures size: "+i.getCaps().maxTextureSize+"<br>Max anisotropy: "+i.getCaps().maxAnisotropy+"<br><b>Info</b><br>WebGL feature level: "+i.webGLVersion+"<br>"+r.version+"<br></div><br>"+r.renderer+"<br>",this.customStatsFunction&&(this._statsSubsetDiv.innerHTML+=this.customStatsFunction())},t}();e.DebugLayer=t}(BABYLON||(BABYLON={})),BABYLON.Effect.ShadersStore={anaglyphPixelShader:"\nvarying vec2 vUV;\nuniform sampler2D textureSampler;\nuniform sampler2D leftSampler;\nvoid main(void)\n{\nvec4 leftFrag=texture2D(leftSampler,vUV);\nleftFrag=vec4(1.0,leftFrag.g,leftFrag.b,1.0);\nvec4 rightFrag=texture2D(textureSampler,vUV);\nrightFrag=vec4(rightFrag.r,1.0,1.0,1.0);\ngl_FragColor=vec4(rightFrag.rgb*leftFrag.rgb,1.0);\n}",blackAndWhitePixelShader:"\nvarying vec2 vUV;\nuniform sampler2D textureSampler;\nvoid main(void) \n{\nfloat luminance=dot(texture2D(textureSampler,vUV).rgb,vec3(0.3,0.59,0.11));\ngl_FragColor=vec4(luminance,luminance,luminance,1.0);\n}",blurPixelShader:"\nvarying vec2 vUV;\nuniform sampler2D textureSampler;\n\nuniform vec2 screenSize;\nuniform vec2 direction;\nuniform float blurWidth;\nvoid main(void)\n{\nfloat weights[7];\nweights[0]=0.05;\nweights[1]=0.1;\nweights[2]=0.2;\nweights[3]=0.3;\nweights[4]=0.2;\nweights[5]=0.1;\nweights[6]=0.05;\nvec2 texelSize=vec2(1.0/screenSize.x,1.0/screenSize.y);\nvec2 texelStep=texelSize*direction*blurWidth;\nvec2 start=vUV-3.0*texelStep;\nvec4 baseColor=vec4(0.,0.,0.,0.);\nvec2 texelOffset=vec2(0.,0.);\nfor (int i=0; i<7; i++)\n{\nbaseColor+=texture2D(textureSampler,start+texelOffset)*weights[i];\ntexelOffset+=texelStep;\n}\ngl_FragColor=baseColor;\n}",chromaticAberrationPixelShader:"\nuniform sampler2D textureSampler; \n\nuniform float chromatic_aberration;\nuniform float screen_width;\nuniform float screen_height;\n\nvarying vec2 vUV;\nvoid main(void)\n{\nvec2 centered_screen_pos=vec2(vUV.x-0.5,vUV.y-0.5);\nfloat radius2=centered_screen_pos.x*centered_screen_pos.x\n+centered_screen_pos.y*centered_screen_pos.y;\nfloat radius=sqrt(radius2);\nvec4 original=texture2D(textureSampler,vUV);\nif (chromatic_aberration>0.0) {\n\nvec3 ref_indices=vec3(-0.3,0.0,0.3);\nfloat ref_shiftX=chromatic_aberration*radius*17.0/screen_width;\nfloat ref_shiftY=chromatic_aberration*radius*17.0/screen_height;\n\nvec2 ref_coords_r=vec2(vUV.x+ref_indices.r*ref_shiftX,vUV.y+ref_indices.r*ref_shiftY*0.5);\nvec2 ref_coords_g=vec2(vUV.x+ref_indices.g*ref_shiftX,vUV.y+ref_indices.g*ref_shiftY*0.5);\nvec2 ref_coords_b=vec2(vUV.x+ref_indices.b*ref_shiftX,vUV.y+ref_indices.b*ref_shiftY*0.5);\noriginal.r=texture2D(textureSampler,ref_coords_r).r;\noriginal.g=texture2D(textureSampler,ref_coords_g).g;\noriginal.b=texture2D(textureSampler,ref_coords_b).b;\n}\ngl_FragColor=original;\n}",colorPixelShader:"uniform vec4 color;\nvoid main(void) {\ngl_FragColor=color;\n}",colorVertexShader:"\nattribute vec3 position;\n\nuniform mat4 worldViewProjection;\nvoid main(void) {\ngl_Position=worldViewProjection*vec4(position,1.0);\n}",colorCorrectionPixelShader:"\nuniform sampler2D textureSampler; \nuniform sampler2D colorTable; \n\nvarying vec2 vUV;\n\nconst float SLICE_COUNT=16.0; \n\nvec4 sampleAs3DTexture(sampler2D texture,vec3 uv,float width) {\nfloat sliceSize=1.0/width; \nfloat slicePixelSize=sliceSize/width; \nfloat sliceInnerSize=slicePixelSize*(width-1.0); \nfloat zSlice0=min(floor(uv.z*width),width-1.0);\nfloat zSlice1=min(zSlice0+1.0,width-1.0);\nfloat xOffset=slicePixelSize*0.5+uv.x*sliceInnerSize;\nfloat s0=xOffset+(zSlice0*sliceSize);\nfloat s1=xOffset+(zSlice1*sliceSize);\nvec4 slice0Color=texture2D(texture,vec2(s0,uv.y));\nvec4 slice1Color=texture2D(texture,vec2(s1,uv.y));\nfloat zOffset=mod(uv.z*width,1.0);\nvec4 result=mix(slice0Color,slice1Color,zOffset);\nreturn result;\n}\nvoid main(void)\n{\nvec4 screen_color=texture2D(textureSampler,vUV);\ngl_FragColor=sampleAs3DTexture(colorTable,screen_color.rgb,SLICE_COUNT);\n}",convolutionPixelShader:"\nvarying vec2 vUV;\nuniform sampler2D textureSampler;\nuniform vec2 screenSize;\nuniform float kernel[9];\nvoid main(void)\n{\nvec2 onePixel=vec2(1.0,1.0)/screenSize;\nvec4 colorSum =\ntexture2D(textureSampler,vUV+onePixel*vec2(-1,-1))*kernel[0] +\ntexture2D(textureSampler,vUV+onePixel*vec2(0,-1))*kernel[1] +\ntexture2D(textureSampler,vUV+onePixel*vec2(1,-1))*kernel[2] +\ntexture2D(textureSampler,vUV+onePixel*vec2(-1,0))*kernel[3] +\ntexture2D(textureSampler,vUV+onePixel*vec2(0,0))*kernel[4] +\ntexture2D(textureSampler,vUV+onePixel*vec2(1,0))*kernel[5] +\ntexture2D(textureSampler,vUV+onePixel*vec2(-1,1))*kernel[6] +\ntexture2D(textureSampler,vUV+onePixel*vec2(0,1))*kernel[7] +\ntexture2D(textureSampler,vUV+onePixel*vec2(1,1))*kernel[8];\nfloat kernelWeight =\nkernel[0] +\nkernel[1] +\nkernel[2] +\nkernel[3] +\nkernel[4] +\nkernel[5] +\nkernel[6] +\nkernel[7] +\nkernel[8];\nif (kernelWeight<=0.0) {\nkernelWeight=1.0;\n}\ngl_FragColor=vec4((colorSum/kernelWeight).rgb,1);\n}",defaultPixelShader:"#ifdef BUMP\n#extension GL_OES_standard_derivatives : enable\n#endif\n#ifdef LOGARITHMICDEPTH\n#extension GL_EXT_frag_depth : enable\n#endif\n\n#define RECIPROCAL_PI2 0.15915494\nuniform vec3 vEyePosition;\nuniform vec3 vAmbientColor;\nuniform vec4 vDiffuseColor;\n#ifdef SPECULARTERM\nuniform vec4 vSpecularColor;\n#endif\nuniform vec3 vEmissiveColor;\n\nvarying vec3 vPositionW;\n#ifdef NORMAL\nvarying vec3 vNormalW;\n#endif\n#ifdef VERTEXCOLOR\nvarying vec4 vColor;\n#endif\n\n#include<helperFunctions>\n\n#include<lightFragmentDeclaration>[0..maxSimultaneousLights]\n#include<lightsFragmentFunctions>\n#include<shadowsFragmentFunctions>\n\n#ifdef DIFFUSE\nvarying vec2 vDiffuseUV;\nuniform sampler2D diffuseSampler;\nuniform vec2 vDiffuseInfos;\n#endif\n#ifdef AMBIENT\nvarying vec2 vAmbientUV;\nuniform sampler2D ambientSampler;\nuniform vec2 vAmbientInfos;\n#endif\n#ifdef OPACITY \nvarying vec2 vOpacityUV;\nuniform sampler2D opacitySampler;\nuniform vec2 vOpacityInfos;\n#endif\n#ifdef EMISSIVE\nvarying vec2 vEmissiveUV;\nuniform vec2 vEmissiveInfos;\nuniform sampler2D emissiveSampler;\n#endif\n#ifdef LIGHTMAP\nvarying vec2 vLightmapUV;\nuniform vec2 vLightmapInfos;\nuniform sampler2D lightmapSampler;\n#endif\n#if defined(REFLECTIONMAP_SPHERICAL) || defined(REFLECTIONMAP_PROJECTION) || defined(REFRACTION)\nuniform mat4 view;\n#endif\n#ifdef REFRACTION\nuniform vec4 vRefractionInfos;\n#ifdef REFRACTIONMAP_3D\nuniform samplerCube refractionCubeSampler;\n#else\nuniform sampler2D refraction2DSampler;\nuniform mat4 refractionMatrix;\n#endif\n#ifdef REFRACTIONFRESNEL\nuniform vec4 refractionLeftColor;\nuniform vec4 refractionRightColor;\n#endif\n#endif\n#if defined(SPECULAR) && defined(SPECULARTERM)\nvarying vec2 vSpecularUV;\nuniform vec2 vSpecularInfos;\nuniform sampler2D specularSampler;\n#endif\n\n#include<fresnelFunction>\n#ifdef DIFFUSEFRESNEL\nuniform vec4 diffuseLeftColor;\nuniform vec4 diffuseRightColor;\n#endif\n#ifdef OPACITYFRESNEL\nuniform vec4 opacityParts;\n#endif\n#ifdef EMISSIVEFRESNEL\nuniform vec4 emissiveLeftColor;\nuniform vec4 emissiveRightColor;\n#endif\n\n#ifdef REFLECTION\nuniform vec2 vReflectionInfos;\n#ifdef REFLECTIONMAP_3D\nuniform samplerCube reflectionCubeSampler;\n#else\nuniform sampler2D reflection2DSampler;\n#endif\n#ifdef REFLECTIONMAP_SKYBOX\nvarying vec3 vPositionUVW;\n#else\n#ifdef REFLECTIONMAP_EQUIRECTANGULAR_FIXED\nvarying vec3 vDirectionW;\n#endif\n#if defined(REFLECTIONMAP_PLANAR) || defined(REFLECTIONMAP_CUBIC) || defined(REFLECTIONMAP_PROJECTION)\nuniform mat4 reflectionMatrix;\n#endif\n#endif\n#include<reflectionFunction>\n#ifdef REFLECTIONFRESNEL\nuniform vec4 reflectionLeftColor;\nuniform vec4 reflectionRightColor;\n#endif\n#endif\n#include<bumpFragmentFunctions>\n#include<clipPlaneFragmentDeclaration>\n#include<logDepthDeclaration>\n#include<fogFragmentDeclaration>\nvoid main(void) {\n#include<clipPlaneFragment>\nvec3 viewDirectionW=normalize(vEyePosition-vPositionW);\n\nvec4 baseColor=vec4(1.,1.,1.,1.);\nvec3 diffuseColor=vDiffuseColor.rgb;\n\nfloat alpha=vDiffuseColor.a;\n\n#ifdef NORMAL\nvec3 normalW=normalize(vNormalW);\n#else\nvec3 normalW=vec3(1.0,1.0,1.0);\n#endif\n#ifdef DIFFUSE\nvec2 diffuseUV=vDiffuseUV;\n#endif\n#include<bumpFragment>\n#ifdef DIFFUSE\nbaseColor=texture2D(diffuseSampler,diffuseUV);\n#ifdef ALPHATEST\nif (baseColor.a<0.4)\ndiscard;\n#endif\n#ifdef ALPHAFROMDIFFUSE\nalpha*=baseColor.a;\n#endif\nbaseColor.rgb*=vDiffuseInfos.y;\n#endif\n#ifdef VERTEXCOLOR\nbaseColor.rgb*=vColor.rgb;\n#endif\n\nvec3 baseAmbientColor=vec3(1.,1.,1.);\n#ifdef AMBIENT\nbaseAmbientColor=texture2D(ambientSampler,vAmbientUV).rgb*vAmbientInfos.y;\n#endif\n\n#ifdef SPECULARTERM\nfloat glossiness=vSpecularColor.a;\nvec3 specularColor=vSpecularColor.rgb;\n#ifdef SPECULAR\nvec4 specularMapColor=texture2D(specularSampler,vSpecularUV);\nspecularColor=specularMapColor.rgb;\n#ifdef GLOSSINESS\nglossiness=glossiness*specularMapColor.a;\n#endif\n#endif\n#else\nfloat glossiness=0.;\n#endif\n\nvec3 diffuseBase=vec3(0.,0.,0.);\nlightingInfo info;\n#ifdef SPECULARTERM\nvec3 specularBase=vec3(0.,0.,0.);\n#endif\nfloat shadow=1.;\n#include<lightFragment>[0..maxSimultaneousLights]\n\nvec3 refractionColor=vec3(0.,0.,0.);\n#ifdef REFRACTION\nvec3 refractionVector=normalize(refract(-viewDirectionW,normalW,vRefractionInfos.y));\n#ifdef REFRACTIONMAP_3D\nrefractionVector.y=refractionVector.y*vRefractionInfos.w;\nif (dot(refractionVector,viewDirectionW)<1.0)\n{\nrefractionColor=textureCube(refractionCubeSampler,refractionVector).rgb*vRefractionInfos.x;\n}\n#else\nvec3 vRefractionUVW=vec3(refractionMatrix*(view*vec4(vPositionW+refractionVector*vRefractionInfos.z,1.0)));\nvec2 refractionCoords=vRefractionUVW.xy/vRefractionUVW.z;\nrefractionCoords.y=1.0-refractionCoords.y;\nrefractionColor=texture2D(refraction2DSampler,refractionCoords).rgb*vRefractionInfos.x;\n#endif\n#endif\n\nvec3 reflectionColor=vec3(0.,0.,0.);\n#ifdef REFLECTION\nvec3 vReflectionUVW=computeReflectionCoords(vec4(vPositionW,1.0),normalW);\n#ifdef REFLECTIONMAP_3D\n#ifdef ROUGHNESS\nfloat bias=vReflectionInfos.y;\n#ifdef SPECULARTERM\n#ifdef SPECULAR\n#ifdef GLOSSINESS\nbias*=(1.0-specularMapColor.a);\n#endif\n#endif\n#endif\nreflectionColor=textureCube(reflectionCubeSampler,vReflectionUVW,bias).rgb*vReflectionInfos.x;\n#else\nreflectionColor=textureCube(reflectionCubeSampler,vReflectionUVW).rgb*vReflectionInfos.x;\n#endif\n#else\nvec2 coords=vReflectionUVW.xy;\n#ifdef REFLECTIONMAP_PROJECTION\ncoords/=vReflectionUVW.z;\n#endif\ncoords.y=1.0-coords.y;\nreflectionColor=texture2D(reflection2DSampler,coords).rgb*vReflectionInfos.x;\n#endif\n#ifdef REFLECTIONFRESNEL\nfloat reflectionFresnelTerm=computeFresnelTerm(viewDirectionW,normalW,reflectionRightColor.a,reflectionLeftColor.a);\n#ifdef REFLECTIONFRESNELFROMSPECULAR\n#ifdef SPECULARTERM\nreflectionColor*=specularColor.rgb*(1.0-reflectionFresnelTerm)+reflectionFresnelTerm*reflectionRightColor.rgb;\n#else\nreflectionColor*=reflectionLeftColor.rgb*(1.0-reflectionFresnelTerm)+reflectionFresnelTerm*reflectionRightColor.rgb;\n#endif\n#else\nreflectionColor*=reflectionLeftColor.rgb*(1.0-reflectionFresnelTerm)+reflectionFresnelTerm*reflectionRightColor.rgb;\n#endif\n#endif\n#endif\n#ifdef REFRACTIONFRESNEL\nfloat refractionFresnelTerm=computeFresnelTerm(viewDirectionW,normalW,refractionRightColor.a,refractionLeftColor.a);\nrefractionColor*=refractionLeftColor.rgb*(1.0-refractionFresnelTerm)+refractionFresnelTerm*refractionRightColor.rgb;\n#endif\n#ifdef OPACITY\nvec4 opacityMap=texture2D(opacitySampler,vOpacityUV);\n#ifdef OPACITYRGB\nopacityMap.rgb=opacityMap.rgb*vec3(0.3,0.59,0.11);\nalpha*=(opacityMap.x+opacityMap.y+opacityMap.z)* vOpacityInfos.y;\n#else\nalpha*=opacityMap.a*vOpacityInfos.y;\n#endif\n#endif\n#ifdef VERTEXALPHA\nalpha*=vColor.a;\n#endif\n#ifdef OPACITYFRESNEL\nfloat opacityFresnelTerm=computeFresnelTerm(viewDirectionW,normalW,opacityParts.z,opacityParts.w);\nalpha+=opacityParts.x*(1.0-opacityFresnelTerm)+opacityFresnelTerm*opacityParts.y;\n#endif\n\nvec3 emissiveColor=vEmissiveColor;\n#ifdef EMISSIVE\nemissiveColor+=texture2D(emissiveSampler,vEmissiveUV).rgb*vEmissiveInfos.y;\n#endif\n#ifdef EMISSIVEFRESNEL\nfloat emissiveFresnelTerm=computeFresnelTerm(viewDirectionW,normalW,emissiveRightColor.a,emissiveLeftColor.a);\nemissiveColor*=emissiveLeftColor.rgb*(1.0-emissiveFresnelTerm)+emissiveFresnelTerm*emissiveRightColor.rgb;\n#endif\n\n#ifdef DIFFUSEFRESNEL\nfloat diffuseFresnelTerm=computeFresnelTerm(viewDirectionW,normalW,diffuseRightColor.a,diffuseLeftColor.a);\ndiffuseBase*=diffuseLeftColor.rgb*(1.0-diffuseFresnelTerm)+diffuseFresnelTerm*diffuseRightColor.rgb;\n#endif\n\n#ifdef EMISSIVEASILLUMINATION\nvec3 finalDiffuse=clamp(diffuseBase*diffuseColor+vAmbientColor,0.0,1.0)*baseColor.rgb;\n#else\n#ifdef LINKEMISSIVEWITHDIFFUSE\nvec3 finalDiffuse=clamp((diffuseBase+emissiveColor)*diffuseColor+vAmbientColor,0.0,1.0)*baseColor.rgb;\n#else\nvec3 finalDiffuse=clamp(diffuseBase*diffuseColor+emissiveColor+vAmbientColor,0.0,1.0)*baseColor.rgb;\n#endif\n#endif\n#ifdef SPECULARTERM\nvec3 finalSpecular=specularBase*specularColor;\n#else\nvec3 finalSpecular=vec3(0.0);\n#endif\n#ifdef SPECULAROVERALPHA\nalpha=clamp(alpha+dot(finalSpecular,vec3(0.3,0.59,0.11)),0.,1.);\n#endif\n#ifdef REFLECTIONOVERALPHA\nalpha=clamp(alpha+dot(reflectionColor,vec3(0.3,0.59,0.11)),0.,1.);\n#endif\n\n#ifdef EMISSIVEASILLUMINATION\nvec4 color=vec4(clamp(finalDiffuse*baseAmbientColor+finalSpecular+reflectionColor+emissiveColor+refractionColor,0.0,1.0),alpha);\n#else\nvec4 color=vec4(finalDiffuse*baseAmbientColor+finalSpecular+reflectionColor+refractionColor,alpha);\n#endif\n#ifdef LIGHTMAP\nvec3 lightmapColor=texture2D(lightmapSampler,vLightmapUV).rgb*vLightmapInfos.y;\n#ifdef USELIGHTMAPASSHADOWMAP\ncolor.rgb*=lightmapColor;\n#else\ncolor.rgb+=lightmapColor;\n#endif\n#endif\n#include<logDepthFragment>\n#include<fogFragment>\ngl_FragColor=color;\n}",
defaultVertexShader:"\nattribute vec3 position;\n#ifdef NORMAL\nattribute vec3 normal;\n#endif\n#ifdef UV1\nattribute vec2 uv;\n#endif\n#ifdef UV2\nattribute vec2 uv2;\n#endif\n#ifdef VERTEXCOLOR\nattribute vec4 color;\n#endif\n#include<bonesDeclaration>\n\n#include<instancesDeclaration>\nuniform mat4 view;\nuniform mat4 viewProjection;\n#ifdef DIFFUSE\nvarying vec2 vDiffuseUV;\nuniform mat4 diffuseMatrix;\nuniform vec2 vDiffuseInfos;\n#endif\n#ifdef AMBIENT\nvarying vec2 vAmbientUV;\nuniform mat4 ambientMatrix;\nuniform vec2 vAmbientInfos;\n#endif\n#ifdef OPACITY\nvarying vec2 vOpacityUV;\nuniform mat4 opacityMatrix;\nuniform vec2 vOpacityInfos;\n#endif\n#ifdef EMISSIVE\nvarying vec2 vEmissiveUV;\nuniform vec2 vEmissiveInfos;\nuniform mat4 emissiveMatrix;\n#endif\n#ifdef LIGHTMAP\nvarying vec2 vLightmapUV;\nuniform vec2 vLightmapInfos;\nuniform mat4 lightmapMatrix;\n#endif\n#if defined(SPECULAR) && defined(SPECULARTERM)\nvarying vec2 vSpecularUV;\nuniform vec2 vSpecularInfos;\nuniform mat4 specularMatrix;\n#endif\n#ifdef BUMP\nvarying vec2 vBumpUV;\nuniform vec3 vBumpInfos;\nuniform mat4 bumpMatrix;\n#endif\n#include<pointCloudVertexDeclaration>\n\nvarying vec3 vPositionW;\n#ifdef NORMAL\nvarying vec3 vNormalW;\n#endif\n#ifdef VERTEXCOLOR\nvarying vec4 vColor;\n#endif\n#include<clipPlaneVertexDeclaration>\n#include<fogVertexDeclaration>\n#include<shadowsVertexDeclaration>[0..maxSimultaneousLights]\n#ifdef REFLECTIONMAP_SKYBOX\nvarying vec3 vPositionUVW;\n#endif\n#ifdef REFLECTIONMAP_EQUIRECTANGULAR_FIXED\nvarying vec3 vDirectionW;\n#endif\n#include<logDepthDeclaration>\nvoid main(void) {\n#ifdef REFLECTIONMAP_SKYBOX\nvPositionUVW=position;\n#endif \n#include<instancesVertex>\n#include<bonesVertex>\ngl_Position=viewProjection*finalWorld*vec4(position,1.0);\nvec4 worldPos=finalWorld*vec4(position,1.0);\nvPositionW=vec3(worldPos);\n#ifdef NORMAL\nvNormalW=normalize(vec3(finalWorld*vec4(normal,0.0)));\n#endif\n#ifdef REFLECTIONMAP_EQUIRECTANGULAR_FIXED\nvDirectionW=normalize(vec3(finalWorld*vec4(position,0.0)));\n#endif\n\n#ifndef UV1\nvec2 uv=vec2(0.,0.);\n#endif\n#ifndef UV2\nvec2 uv2=vec2(0.,0.);\n#endif\n#ifdef DIFFUSE\nif (vDiffuseInfos.x == 0.)\n{\nvDiffuseUV=vec2(diffuseMatrix*vec4(uv,1.0,0.0));\n}\nelse\n{\nvDiffuseUV=vec2(diffuseMatrix*vec4(uv2,1.0,0.0));\n}\n#endif\n#ifdef AMBIENT\nif (vAmbientInfos.x == 0.)\n{\nvAmbientUV=vec2(ambientMatrix*vec4(uv,1.0,0.0));\n}\nelse\n{\nvAmbientUV=vec2(ambientMatrix*vec4(uv2,1.0,0.0));\n}\n#endif\n#ifdef OPACITY\nif (vOpacityInfos.x == 0.)\n{\nvOpacityUV=vec2(opacityMatrix*vec4(uv,1.0,0.0));\n}\nelse\n{\nvOpacityUV=vec2(opacityMatrix*vec4(uv2,1.0,0.0));\n}\n#endif\n#ifdef EMISSIVE\nif (vEmissiveInfos.x == 0.)\n{\nvEmissiveUV=vec2(emissiveMatrix*vec4(uv,1.0,0.0));\n}\nelse\n{\nvEmissiveUV=vec2(emissiveMatrix*vec4(uv2,1.0,0.0));\n}\n#endif\n#ifdef LIGHTMAP\nif (vLightmapInfos.x == 0.)\n{\nvLightmapUV=vec2(lightmapMatrix*vec4(uv,1.0,0.0));\n}\nelse\n{\nvLightmapUV=vec2(lightmapMatrix*vec4(uv2,1.0,0.0));\n}\n#endif\n#if defined(SPECULAR) && defined(SPECULARTERM)\nif (vSpecularInfos.x == 0.)\n{\nvSpecularUV=vec2(specularMatrix*vec4(uv,1.0,0.0));\n}\nelse\n{\nvSpecularUV=vec2(specularMatrix*vec4(uv2,1.0,0.0));\n}\n#endif\n#ifdef BUMP\nif (vBumpInfos.x == 0.)\n{\nvBumpUV=vec2(bumpMatrix*vec4(uv,1.0,0.0));\n}\nelse\n{\nvBumpUV=vec2(bumpMatrix*vec4(uv2,1.0,0.0));\n}\n#endif\n#include<clipPlaneVertex>\n#include<fogVertex>\n#include<shadowsVertex>[0..maxSimultaneousLights]\n\n#ifdef VERTEXCOLOR\nvColor=color;\n#endif\n#include<pointCloudVertex>\n#include<logDepthVertex>\n}",depthPixelShader:"#ifdef ALPHATEST\nvarying vec2 vUV;\nuniform sampler2D diffuseSampler;\n#endif\nuniform float far;\nvoid main(void)\n{\n#ifdef ALPHATEST\nif (texture2D(diffuseSampler,vUV).a<0.4)\ndiscard;\n#endif\nfloat depth=(gl_FragCoord.z/gl_FragCoord.w)/far;\ngl_FragColor=vec4(depth,depth*depth,0.0,1.0);\n}",depthVertexShader:"\nattribute vec3 position;\n#include<bonesDeclaration>\n\n#include<instancesDeclaration>\nuniform mat4 viewProjection;\n#if defined(ALPHATEST) || defined(NEED_UV)\nvarying vec2 vUV;\nuniform mat4 diffuseMatrix;\n#ifdef UV1\nattribute vec2 uv;\n#endif\n#ifdef UV2\nattribute vec2 uv2;\n#endif\n#endif\nvoid main(void)\n{\n#include<instancesVertex>\n#include<bonesVertex>\ngl_Position=viewProjection*finalWorld*vec4(position,1.0);\n#if defined(ALPHATEST) || defined(BASIC_RENDER)\n#ifdef UV1\nvUV=vec2(diffuseMatrix*vec4(uv,1.0,0.0));\n#endif\n#ifdef UV2\nvUV=vec2(diffuseMatrix*vec4(uv2,1.0,0.0));\n#endif\n#endif\n}",depthBoxBlurPixelShader:"\nvarying vec2 vUV;\nuniform sampler2D textureSampler;\n\nuniform vec2 screenSize;\nvoid main(void)\n{\nvec4 colorDepth=vec4(0.0);\nfor (int x=-OFFSET; x<=OFFSET; x++)\nfor (int y=-OFFSET; y<=OFFSET; y++)\ncolorDepth+=texture2D(textureSampler,vUV+vec2(x,y)/screenSize);\ngl_FragColor=(colorDepth/float((OFFSET*2+1)*(OFFSET*2+1)));\n}",depthOfFieldPixelShader:"\n\n\n\n\nuniform sampler2D textureSampler;\nuniform sampler2D highlightsSampler;\nuniform sampler2D depthSampler;\nuniform sampler2D grainSampler;\n\nuniform float grain_amount;\nuniform bool blur_noise;\nuniform float screen_width;\nuniform float screen_height;\nuniform float distortion;\nuniform bool dof_enabled;\n\nuniform float screen_distance; \nuniform float aperture;\nuniform float darken;\nuniform float edge_blur;\nuniform bool highlights;\n\nuniform float near;\nuniform float far;\n\nvarying vec2 vUV;\n\n#define PI 3.14159265\n#define TWOPI 6.28318530\n#define inverse_focal_length 0.1 \n\nvec2 centered_screen_pos;\nvec2 distorted_coords;\nfloat radius2;\nfloat radius;\n\nvec2 rand(vec2 co)\n{\nfloat noise1=(fract(sin(dot(co,vec2(12.9898,78.233)))*43758.5453));\nfloat noise2=(fract(sin(dot(co,vec2(12.9898,78.233)*2.0))*43758.5453));\nreturn clamp(vec2(noise1,noise2),0.0,1.0);\n}\n\nvec2 getDistortedCoords(vec2 coords) {\nif (distortion == 0.0) { return coords; }\nvec2 direction=1.0*normalize(centered_screen_pos);\nvec2 dist_coords=vec2(0.5,0.5);\ndist_coords.x=0.5+direction.x*radius2*1.0;\ndist_coords.y=0.5+direction.y*radius2*1.0;\nfloat dist_amount=clamp(distortion*0.23,0.0,1.0);\ndist_coords=mix(coords,dist_coords,dist_amount);\nreturn dist_coords;\n}\n\nfloat sampleScreen(inout vec4 color,const in vec2 offset,const in float weight) {\n\nvec2 coords=distorted_coords;\nfloat angle=rand(coords*100.0).x*TWOPI;\ncoords+=vec2(offset.x*cos(angle)-offset.y*sin(angle),offset.x*sin(angle)+offset.y*cos(angle));\ncolor+=texture2D(textureSampler,coords)*weight;\nreturn weight;\n}\n\nfloat getBlurLevel(float size) {\nreturn min(3.0,ceil(size/1.0));\n}\n\nvec4 getBlurColor(float size) {\nvec4 col=texture2D(textureSampler,distorted_coords);\nif (size == 0.0) { return col; }\n\n\nfloat blur_level=getBlurLevel(size);\nfloat w=(size/screen_width);\nfloat h=(size/screen_height);\nfloat total_weight=1.0;\nvec2 sample_coords;\ntotal_weight+=sampleScreen(col,vec2(-0.50*w,0.24*h),0.93);\ntotal_weight+=sampleScreen(col,vec2(0.30*w,-0.75*h),0.90);\ntotal_weight+=sampleScreen(col,vec2(0.36*w,0.96*h),0.87);\ntotal_weight+=sampleScreen(col,vec2(-1.08*w,-0.55*h),0.85);\ntotal_weight+=sampleScreen(col,vec2(1.33*w,-0.37*h),0.83);\ntotal_weight+=sampleScreen(col,vec2(-0.82*w,1.31*h),0.80);\ntotal_weight+=sampleScreen(col,vec2(-0.31*w,-1.67*h),0.78);\ntotal_weight+=sampleScreen(col,vec2(1.47*w,1.11*h),0.76);\ntotal_weight+=sampleScreen(col,vec2(-1.97*w,0.19*h),0.74);\ntotal_weight+=sampleScreen(col,vec2(1.42*w,-1.57*h),0.72);\nif (blur_level>1.0) {\ntotal_weight+=sampleScreen(col,vec2(0.01*w,2.25*h),0.70);\ntotal_weight+=sampleScreen(col,vec2(-1.62*w,-1.74*h),0.67);\ntotal_weight+=sampleScreen(col,vec2(2.49*w,0.20*h),0.65);\ntotal_weight+=sampleScreen(col,vec2(-2.07*w,1.61*h),0.63);\ntotal_weight+=sampleScreen(col,vec2(0.46*w,-2.70*h),0.61);\ntotal_weight+=sampleScreen(col,vec2(1.55*w,2.40*h),0.59);\ntotal_weight+=sampleScreen(col,vec2(-2.88*w,-0.75*h),0.56);\ntotal_weight+=sampleScreen(col,vec2(2.73*w,-1.44*h),0.54);\ntotal_weight+=sampleScreen(col,vec2(-1.08*w,3.02*h),0.52);\ntotal_weight+=sampleScreen(col,vec2(-1.28*w,-3.05*h),0.49);\n}\nif (blur_level>2.0) {\ntotal_weight+=sampleScreen(col,vec2(3.11*w,1.43*h),0.46);\ntotal_weight+=sampleScreen(col,vec2(-3.36*w,1.08*h),0.44);\ntotal_weight+=sampleScreen(col,vec2(1.80*w,-3.16*h),0.41);\ntotal_weight+=sampleScreen(col,vec2(0.83*w,3.65*h),0.38);\ntotal_weight+=sampleScreen(col,vec2(-3.16*w,-2.19*h),0.34);\ntotal_weight+=sampleScreen(col,vec2(3.92*w,-0.53*h),0.31);\ntotal_weight+=sampleScreen(col,vec2(-2.59*w,3.12*h),0.26);\ntotal_weight+=sampleScreen(col,vec2(-0.20*w,-4.15*h),0.22);\ntotal_weight+=sampleScreen(col,vec2(3.02*w,3.00*h),0.15);\n}\ncol/=total_weight; \n\nif (darken>0.0) {\ncol.rgb*=clamp(0.3,1.0,1.05-size*0.5*darken);\n}\n\n\n\n\nreturn col;\n}\nvoid main(void)\n{\n\ncentered_screen_pos=vec2(vUV.x-0.5,vUV.y-0.5);\nradius2=centered_screen_pos.x*centered_screen_pos.x+centered_screen_pos.y*centered_screen_pos.y;\nradius=sqrt(radius2);\ndistorted_coords=getDistortedCoords(vUV); \nvec2 texels_coords=vec2(vUV.x*screen_width,vUV.y*screen_height); \nfloat depth=texture2D(depthSampler,distorted_coords).r; \nfloat distance=near+(far-near)*depth; \nvec4 color=texture2D(textureSampler,vUV); \n\n\nfloat coc=abs(aperture*(screen_distance*(inverse_focal_length-1.0/distance)-1.0));\n\nif (dof_enabled == false || coc<0.07) { coc=0.0; }\n\nfloat edge_blur_amount=0.0;\nif (edge_blur>0.0) {\nedge_blur_amount=clamp((radius*2.0-1.0+0.15*edge_blur)*1.5,0.0,1.0)*1.3;\n}\n\nfloat blur_amount=max(edge_blur_amount,coc);\n\nif (blur_amount == 0.0) {\ngl_FragColor=texture2D(textureSampler,distorted_coords);\n}\nelse {\n\ngl_FragColor=getBlurColor(blur_amount*1.7);\n\nif (highlights) {\ngl_FragColor.rgb+=clamp(coc,0.0,1.0)*texture2D(highlightsSampler,distorted_coords).rgb;\n}\nif (blur_noise) {\n\nvec2 noise=rand(distorted_coords)*0.01*blur_amount;\nvec2 blurred_coord=vec2(distorted_coords.x+noise.x,distorted_coords.y+noise.y);\ngl_FragColor=0.04*texture2D(textureSampler,blurred_coord)+0.96*gl_FragColor;\n}\n}\n\nif (grain_amount>0.0) {\nvec4 grain_color=texture2D(grainSampler,texels_coords*0.003);\ngl_FragColor.rgb+=(-0.5+grain_color.rgb)*0.30*grain_amount;\n}\n}\n",displayPassPixelShader:"\nvarying vec2 vUV;\nuniform sampler2D textureSampler;\nuniform sampler2D passSampler;\nvoid main(void)\n{\ngl_FragColor=texture2D(passSampler,vUV);\n}",ellipse2dPixelShader:"varying vec4 vColor;\nvoid main(void) {\ngl_FragColor=vColor;\n}",ellipse2dVertexShader:"\n#ifdef Instanced\n#define att attribute\n#else\n#define att uniform\n#endif\nattribute float index;\natt vec2 zBias;\natt vec4 transformX;\natt vec4 transformY;\n#ifdef Border\natt float borderThickness;\n#endif\n#ifdef FillSolid\natt vec4 fillSolidColor;\n#endif\n#ifdef BorderSolid\natt vec4 borderSolidColor;\n#endif\n#ifdef FillGradient\natt vec4 fillGradientColor1;\natt vec4 fillGradientColor2;\natt vec4 fillGradientTY;\n#endif\n#ifdef BorderGradient\natt vec4 borderGradientColor1;\natt vec4 borderGradientColor2;\natt vec4 borderGradientTY;\n#endif\n\natt vec3 properties;\n#define TWOPI 6.28318530\n\nvarying vec2 vUV;\nvarying vec4 vColor;\nvoid main(void) {\nvec2 pos2;\n#ifdef Border\nfloat w=properties.x;\nfloat h=properties.y;\nfloat ms=properties.z;\nvec2 borderOffset=vec2(1.0,1.0);\nfloat segi=index;\nif (index<ms) {\nborderOffset=vec2(1.0-(borderThickness*2.0/w),1.0-(borderThickness*2.0/h));\n}\nelse {\nsegi-=ms;\n}\nfloat angle=TWOPI*segi/ms;\npos2.x=(cos(angle)/2.0)+0.5;\npos2.y=(sin(angle)/2.0)+0.5;\npos2.x=((pos2.x-0.5)*borderOffset.x)+0.5;\npos2.y=((pos2.y-0.5)*borderOffset.y)+0.5;\n#else\nif (index == 0.0) {\npos2=vec2(0.5,0.5);\n}\nelse {\nfloat ms=properties.z;\nfloat angle=TWOPI*(index-1.0)/ms;\npos2.x=(cos(angle)/2.0)+0.5;\npos2.y=(sin(angle)/2.0)+0.5;\n}\n#endif\n#ifdef FillSolid\nvColor=fillSolidColor;\n#endif\n#ifdef BorderSolid\nvColor=borderSolidColor;\n#endif\n#ifdef FillGradient\nfloat v=dot(vec4(pos2.xy,1,1),fillGradientTY);\nvColor=mix(fillGradientColor2,fillGradientColor1,v); \n#endif\n#ifdef BorderGradient\nfloat v=dot(vec4(pos2.xy,1,1),borderGradientTY);\nvColor=mix(borderGradientColor2,borderGradientColor1,v); \n#endif\nvec4 pos;\npos.xy=pos2.xy*properties.xy;\npos.z=1.0;\npos.w=1.0;\ngl_Position=vec4(dot(pos,transformX),dot(pos,transformY),zBias.x,1);\n}",filterPixelShader:"\nvarying vec2 vUV;\nuniform sampler2D textureSampler;\nuniform mat4 kernelMatrix;\nvoid main(void)\n{\nvec3 baseColor=texture2D(textureSampler,vUV).rgb;\nvec3 updatedColor=(kernelMatrix*vec4(baseColor,1.0)).rgb;\ngl_FragColor=vec4(updatedColor,1.0);\n}",fxaaPixelShader:"#define FXAA_REDUCE_MIN (1.0/128.0)\n#define FXAA_REDUCE_MUL (1.0/8.0)\n#define FXAA_SPAN_MAX 8.0\nvarying vec2 vUV;\nuniform sampler2D textureSampler;\nuniform vec2 texelSize;\nvoid main(){\nvec2 localTexelSize=texelSize;\nvec4 rgbNW=texture2D(textureSampler,(vUV+vec2(-1.0,-1.0)*localTexelSize));\nvec4 rgbNE=texture2D(textureSampler,(vUV+vec2(1.0,-1.0)*localTexelSize));\nvec4 rgbSW=texture2D(textureSampler,(vUV+vec2(-1.0,1.0)*localTexelSize));\nvec4 rgbSE=texture2D(textureSampler,(vUV+vec2(1.0,1.0)*localTexelSize));\nvec4 rgbM=texture2D(textureSampler,vUV);\nvec4 luma=vec4(0.299,0.587,0.114,1.0);\nfloat lumaNW=dot(rgbNW,luma);\nfloat lumaNE=dot(rgbNE,luma);\nfloat lumaSW=dot(rgbSW,luma);\nfloat lumaSE=dot(rgbSE,luma);\nfloat lumaM=dot(rgbM,luma);\nfloat lumaMin=min(lumaM,min(min(lumaNW,lumaNE),min(lumaSW,lumaSE)));\nfloat lumaMax=max(lumaM,max(max(lumaNW,lumaNE),max(lumaSW,lumaSE)));\nvec2 dir=vec2(-((lumaNW+lumaNE)-(lumaSW+lumaSE)),((lumaNW+lumaSW)-(lumaNE+lumaSE)));\nfloat dirReduce=max(\n(lumaNW+lumaNE+lumaSW+lumaSE)*(0.25*FXAA_REDUCE_MUL),\nFXAA_REDUCE_MIN);\nfloat rcpDirMin=1.0/(min(abs(dir.x),abs(dir.y))+dirReduce);\ndir=min(vec2(FXAA_SPAN_MAX,FXAA_SPAN_MAX),\nmax(vec2(-FXAA_SPAN_MAX,-FXAA_SPAN_MAX),\ndir*rcpDirMin))*localTexelSize;\nvec4 rgbA=0.5*(\ntexture2D(textureSampler,vUV+dir*(1.0/3.0-0.5)) +\ntexture2D(textureSampler,vUV+dir*(2.0/3.0-0.5)));\nvec4 rgbB=rgbA*0.5+0.25*(\ntexture2D(textureSampler,vUV+dir*-0.5) +\ntexture2D(textureSampler,vUV+dir*0.5));\nfloat lumaB=dot(rgbB,luma);\nif ((lumaB<lumaMin) || (lumaB>lumaMax)) {\ngl_FragColor=rgbA;\n}\nelse {\ngl_FragColor=rgbB;\n}\n}",hdrPixelShader:"uniform sampler2D textureSampler;\nvarying vec2 vUV;\n#if defined(GAUSSIAN_BLUR_H) || defined(GAUSSIAN_BLUR_V)\nuniform float blurOffsets[9];\nuniform float blurWeights[9];\nuniform float multiplier;\nvoid main(void) {\nvec4 color=vec4(0.0,0.0,0.0,0.0);\nfor (int i=0; i<9; i++) {\n#ifdef GAUSSIAN_BLUR_H\ncolor+=(texture2D(textureSampler,vUV+vec2(blurOffsets[i]*multiplier,0.0))*blurWeights[i]);\n#else\ncolor+=(texture2D(textureSampler,vUV+vec2(0.0,blurOffsets[i]*multiplier))*blurWeights[i]);\n#endif\n}\ncolor.a=1.0;\ngl_FragColor=color;\n}\n#endif\n#if defined(TEXTURE_ADDER)\nuniform sampler2D otherSampler;\nvoid main() {\nvec4 sum=texture2D(textureSampler,vUV)+texture2D(otherSampler,vUV);\nsum.a=clamp(sum.a,0.0,1.0);\ngl_FragColor=sum;\n}\n#endif\n#if defined(LUMINANCE_GENERATOR)\nuniform vec2 lumOffsets[4];\nvoid main() {\nfloat average=0.0;\nvec4 color=vec4(0.0,0.0,0.0,0.0);\nfloat maximum=-1e20;\nfor (int i=0; i<4; i++) {\ncolor=texture2D(textureSampler,vUV+lumOffsets[i]);\nfloat GreyValue=length(color.rgb);\nmaximum=max(maximum,GreyValue);\naverage+=(0.25*log(1e-5+GreyValue));\n}\naverage=exp(average);\ngl_FragColor=vec4(average,maximum,0.0,1.0);\n}\n#endif\n#if defined(DOWN_SAMPLE)\nuniform vec2 dsOffsets[9];\nuniform float halfDestPixelSize;\n#ifdef FINAL_DOWN_SAMPLE\nvec4 pack(float value) {\nconst vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);\nconst vec4 bit_mask=vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);\nvec4 res=fract(value*bit_shift);\nres-=res.xxyz*bit_mask;\nreturn res;\n}\n#endif\nvoid main() {\nvec4 color=vec4(0.0,0.0,0.0,0.0);\nfloat average=0.0;\nfor (int i=0; i<9; i++) {\ncolor=texture2D(textureSampler,vUV+vec2(halfDestPixelSize,halfDestPixelSize)+dsOffsets[i]);\naverage+=color.r;\n}\naverage/=9.0;\n#ifndef FINAL_DOWN_SAMPLE\ngl_FragColor=vec4(average,average,0.0,1.0);\n#else\ngl_FragColor=pack(average);\n#endif\n}\n#endif\n#if defined(BRIGHT_PASS)\nuniform vec2 dsOffsets[4];\nuniform float brightThreshold;\nvoid main() {\nvec4 average=vec4(0.0,0.0,0.0,0.0);\naverage=texture2D(textureSampler,vUV+vec2(dsOffsets[0].x,dsOffsets[0].y));\naverage+=texture2D(textureSampler,vUV+vec2(dsOffsets[1].x,dsOffsets[1].y));\naverage+=texture2D(textureSampler,vUV+vec2(dsOffsets[2].x,dsOffsets[2].y));\naverage+=texture2D(textureSampler,vUV+vec2(dsOffsets[3].x,dsOffsets[3].y));\naverage*=0.25;\nfloat luminance=length(average.rgb);\nif (luminance<brightThreshold) {\naverage=vec4(0.0,0.0,0.0,1.0);\n}\ngl_FragColor=average;\n}\n#endif\n#if defined(DOWN_SAMPLE_X4)\nuniform vec2 dsOffsets[16];\nvoid main() {\nvec4 average=vec4(0.0,0.0,0.0,0.0);\naverage=texture2D(textureSampler,vUV+dsOffsets[0]);\naverage+=texture2D(textureSampler,vUV+dsOffsets[1]);\naverage+=texture2D(textureSampler,vUV+dsOffsets[2]);\naverage+=texture2D(textureSampler,vUV+dsOffsets[3]);\naverage+=texture2D(textureSampler,vUV+dsOffsets[4]);\naverage+=texture2D(textureSampler,vUV+dsOffsets[5]);\naverage+=texture2D(textureSampler,vUV+dsOffsets[6]);\naverage+=texture2D(textureSampler,vUV+dsOffsets[7]);\naverage+=texture2D(textureSampler,vUV+dsOffsets[8]);\naverage+=texture2D(textureSampler,vUV+dsOffsets[9]);\naverage+=texture2D(textureSampler,vUV+dsOffsets[10]);\naverage+=texture2D(textureSampler,vUV+dsOffsets[11]);\naverage+=texture2D(textureSampler,vUV+dsOffsets[12]);\naverage+=texture2D(textureSampler,vUV+dsOffsets[13]);\naverage+=texture2D(textureSampler,vUV+dsOffsets[14]);\naverage+=texture2D(textureSampler,vUV+dsOffsets[15]);\naverage/=16.0;\ngl_FragColor=average;\n}\n#endif\n#if defined(HDR)\nuniform sampler2D otherSampler;\nuniform float exposure;\nuniform float avgLuminance;\nvoid main() {\nvec4 color=texture2D(textureSampler,vUV)+texture2D(otherSampler,vUV);\nvec4 adjustedColor=color/avgLuminance*exposure;\ncolor=adjustedColor;\ncolor.a=1.0;\ngl_FragColor=color;\n}\n#endif\n",layerPixelShader:"\nvarying vec2 vUV;\nuniform sampler2D textureSampler;\n\nuniform vec4 color;\nvoid main(void) {\nvec4 baseColor=texture2D(textureSampler,vUV);\n#ifdef ALPHATEST\nif (baseColor.a<0.4)\ndiscard;\n#endif\ngl_FragColor=baseColor*color;\n}",layerVertexShader:"\nattribute vec2 position;\n\nuniform vec2 scale;\nuniform vec2 offset;\nuniform mat4 textureMatrix;\n\nvarying vec2 vUV;\nconst vec2 madd=vec2(0.5,0.5);\nvoid main(void) { \nvec2 shiftedPosition=position*scale+offset;\nvUV=vec2(textureMatrix*vec4(shiftedPosition*madd+madd,1.0,0.0));\ngl_Position=vec4(shiftedPosition,0.0,1.0);\n}",legacydefaultPixelShader:"#define MAP_PROJECTION 4.\n\nuniform vec3 vEyePosition;\nuniform vec3 vAmbientColor;\nuniform vec4 vDiffuseColor;\n#ifdef SPECULARTERM\nuniform vec4 vSpecularColor;\n#endif\nuniform vec3 vEmissiveColor;\n\nvarying vec3 vPositionW;\nvarying vec3 vNormalW;\n#ifdef VERTEXCOLOR\nvarying vec4 vColor;\n#endif\n\n#include<lightFragmentDeclaration>[0..3]\n#include<lightsFragmentFunctions>\n#include<shadowsFragmentFunctions>\n\n#ifdef DIFFUSE\nvarying vec2 vDiffuseUV;\nuniform sampler2D diffuseSampler;\nuniform vec2 vDiffuseInfos;\n#endif\n#ifdef AMBIENT\nvarying vec2 vAmbientUV;\nuniform sampler2D ambientSampler;\nuniform vec2 vAmbientInfos;\n#endif\n#ifdef OPACITY \nvarying vec2 vOpacityUV;\nuniform sampler2D opacitySampler;\nuniform vec2 vOpacityInfos;\n#endif\n#ifdef REFLECTION\nvarying vec3 vReflectionUVW;\n#ifdef REFLECTIONMAP_3D\nuniform samplerCube reflectionCubeSampler;\n#else\nuniform sampler2D reflection2DSampler;\n#endif\nuniform vec2 vReflectionInfos;\n#endif\n#ifdef EMISSIVE\nvarying vec2 vEmissiveUV;\nuniform vec2 vEmissiveInfos;\nuniform sampler2D emissiveSampler;\n#endif\n#if defined(SPECULAR) && defined(SPECULARTERM)\nvarying vec2 vSpecularUV;\nuniform vec2 vSpecularInfos;\nuniform sampler2D specularSampler;\n#endif\n\n#include<fresnelFunction>\n#ifdef DIFFUSEFRESNEL\nuniform vec4 diffuseLeftColor;\nuniform vec4 diffuseRightColor;\n#endif\n#ifdef OPACITYFRESNEL\nuniform vec4 opacityParts;\n#endif\n#ifdef REFLECTIONFRESNEL\nuniform vec4 reflectionLeftColor;\nuniform vec4 reflectionRightColor;\n#endif\n#ifdef EMISSIVEFRESNEL\nuniform vec4 emissiveLeftColor;\nuniform vec4 emissiveRightColor;\n#endif\n#include<clipPlaneFragmentDeclaration>\n#include<fogFragmentDeclaration>\nvoid main(void) {\n#include<clipPlaneFragment>\nvec3 viewDirectionW=normalize(vEyePosition-vPositionW);\n\nvec4 baseColor=vec4(1.,1.,1.,1.);\nvec3 diffuseColor=vDiffuseColor.rgb;\n#ifdef DIFFUSE\nbaseColor=texture2D(diffuseSampler,vDiffuseUV);\n#ifdef ALPHATEST\nif (baseColor.a<0.4)\ndiscard;\n#endif\nbaseColor.rgb*=vDiffuseInfos.y;\n#endif\n#ifdef VERTEXCOLOR\nbaseColor.rgb*=vColor.rgb;\n#endif\n\nvec3 normalW=normalize(vNormalW);\n\nvec3 baseAmbientColor=vec3(1.,1.,1.);\n#ifdef AMBIENT\nbaseAmbientColor=texture2D(ambientSampler,vAmbientUV).rgb*vAmbientInfos.y;\n#endif\n\nvec3 diffuseBase=vec3(0.,0.,0.);\nlightingInfo info;\nfloat glossiness=0.;\n#ifdef SPECULARTERM\nvec3 specularBase=vec3(0.,0.,0.);\nglossiness=vSpecularColor.a;\n#endif\nfloat shadow=1.;\n#include<lightFragment>[0..3]\n\nvec3 reflectionColor=vec3(0.,0.,0.);\n#ifdef REFLECTION\n#ifdef REFLECTIONMAP_3D\nreflectionColor=textureCube(reflectionCubeSampler,vReflectionUVW).rgb*vReflectionInfos.x;\n#else\nvec2 coords=vReflectionUVW.xy;\n#ifdef REFLECTIONMAP_PROJECTION\ncoords/=vReflectionUVW.z;\n#endif\ncoords.y=1.0-coords.y;\nreflectionColor=texture2D(reflection2DSampler,coords).rgb*vReflectionInfos.x;\n#endif\n#ifdef REFLECTIONFRESNEL\nfloat reflectionFresnelTerm=computeFresnelTerm(viewDirectionW,normalW,reflectionRightColor.a,reflectionLeftColor.a);\nreflectionColor*=reflectionLeftColor.rgb*(1.0-reflectionFresnelTerm)+reflectionFresnelTerm*reflectionRightColor.rgb;\n#endif\n#endif\n\nfloat alpha=vDiffuseColor.a;\n#ifdef OPACITY\nvec4 opacityMap=texture2D(opacitySampler,vOpacityUV);\n#ifdef OPACITYRGB\nopacityMap.rgb=opacityMap.rgb*vec3(0.3,0.59,0.11);\nalpha*=(opacityMap.x+opacityMap.y+opacityMap.z)* vOpacityInfos.y;\n#else\nalpha*=opacityMap.a*vOpacityInfos.y;\n#endif\n#endif\n#ifdef VERTEXALPHA\nalpha*=vColor.a;\n#endif\n#ifdef OPACITYFRESNEL\nfloat opacityFresnelTerm=computeFresnelTerm(viewDirectionW,normalW,opacityParts.z,opacityParts.w);\nalpha+=opacityParts.x*(1.0-opacityFresnelTerm)+opacityFresnelTerm*opacityParts.y;\n#endif\n\nvec3 emissiveColor=vEmissiveColor;\n#ifdef EMISSIVE\nemissiveColor+=texture2D(emissiveSampler,vEmissiveUV).rgb*vEmissiveInfos.y;\n#endif\n#ifdef EMISSIVEFRESNEL\nfloat emissiveFresnelTerm=computeFresnelTerm(viewDirectionW,normalW,emissiveRightColor.a,emissiveLeftColor.a);\nemissiveColor*=emissiveLeftColor.rgb*(1.0-emissiveFresnelTerm)+emissiveFresnelTerm*emissiveRightColor.rgb;\n#endif\n\n#ifdef SPECULARTERM\nvec3 specularColor=vSpecularColor.rgb;\n#ifdef SPECULAR\nspecularColor=texture2D(specularSampler,vSpecularUV).rgb*vSpecularInfos.y;\n#endif\n#endif\n\n#ifdef DIFFUSEFRESNEL\nfloat diffuseFresnelTerm=computeFresnelTerm(viewDirectionW,normalW,diffuseRightColor.a,diffuseLeftColor.a);\ndiffuseBase*=diffuseLeftColor.rgb*(1.0-diffuseFresnelTerm)+diffuseFresnelTerm*diffuseRightColor.rgb;\n#endif\n\nvec3 finalDiffuse=clamp(diffuseBase*diffuseColor+emissiveColor+vAmbientColor,0.0,1.0)*baseColor.rgb;\n#ifdef SPECULARTERM\nvec3 finalSpecular=specularBase*specularColor;\n#else\nvec3 finalSpecular=vec3(0.0);\n#endif\nvec4 color=vec4(finalDiffuse*baseAmbientColor+finalSpecular+reflectionColor,alpha);\n#include<fogFragment>\ngl_FragColor=color;\n}",legacydefaultVertexShader:"\nattribute vec3 position;\nattribute vec3 normal;\n#ifdef UV1\nattribute vec2 uv;\n#endif\n#ifdef UV2\nattribute vec2 uv2;\n#endif\n#ifdef VERTEXCOLOR\nattribute vec4 color;\n#endif\n#include<bonesDeclaration>\n\nuniform mat4 world;\nuniform mat4 view;\nuniform mat4 viewProjection;\n#ifdef DIFFUSE\nvarying vec2 vDiffuseUV;\nuniform mat4 diffuseMatrix;\nuniform vec2 vDiffuseInfos;\n#endif\n#ifdef AMBIENT\nvarying vec2 vAmbientUV;\nuniform mat4 ambientMatrix;\nuniform vec2 vAmbientInfos;\n#endif\n#ifdef OPACITY\nvarying vec2 vOpacityUV;\nuniform mat4 opacityMatrix;\nuniform vec2 vOpacityInfos;\n#endif\n#ifdef EMISSIVE\nvarying vec2 vEmissiveUV;\nuniform vec2 vEmissiveInfos;\nuniform mat4 emissiveMatrix;\n#endif\n#if defined(SPECULAR) && defined(SPECULARTERM)\nvarying vec2 vSpecularUV;\nuniform vec2 vSpecularInfos;\nuniform mat4 specularMatrix;\n#endif\n#ifdef BUMP\nvarying vec2 vBumpUV;\nuniform vec2 vBumpInfos;\nuniform mat4 bumpMatrix;\n#endif\n\nvarying vec3 vPositionW;\nvarying vec3 vNormalW;\n#ifdef VERTEXCOLOR\nvarying vec4 vColor;\n#endif\n#include<clipPlaneVertexDeclaration>\n#include<fogVertexDeclaration>\n#include<shadowsVertexDeclaration>[0..maxSimultaneousLights]\n#ifdef REFLECTION\nuniform vec3 vEyePosition;\nvarying vec3 vReflectionUVW;\nuniform mat4 reflectionMatrix;\nvec3 computeReflectionCoords(vec4 worldPos,vec3 worldNormal)\n{\n#ifdef REFLECTIONMAP_SPHERICAL\nvec3 coords=vec3(view*vec4(worldNormal,0.0));\nreturn vec3(reflectionMatrix*vec4(coords,1.0));\n#endif\n#ifdef REFLECTIONMAP_PLANAR\nvec3 viewDir=worldPos.xyz-vEyePosition;\nvec3 coords=normalize(reflect(viewDir,worldNormal));\nreturn vec3(reflectionMatrix*vec4(coords,1));\n#endif\n#ifdef REFLECTIONMAP_CUBIC\nvec3 viewDir=worldPos.xyz-vEyePosition;\nvec3 coords=reflect(viewDir,worldNormal);\n#ifdef INVERTCUBICMAP\ncoords.y=1.0-coords.y;\n#endif\nreturn vec3(reflectionMatrix*vec4(coords,0));\n#endif\n#ifdef REFLECTIONMAP_PROJECTION\nreturn vec3(reflectionMatrix*(view*worldPos));\n#endif\n#ifdef REFLECTIONMAP_SKYBOX\nreturn position;\n#endif\n#ifdef REFLECTIONMAP_EXPLICIT\nreturn vec3(0,0,0);\n#endif\n}\n#endif\nvoid main(void) {\nmat4 finalWorld=world;\n#include<bonesVertex>\ngl_Position=viewProjection*finalWorld*vec4(position,1.0);\nvec4 worldPos=finalWorld*vec4(position,1.0);\nvPositionW=vec3(worldPos);\nvNormalW=normalize(vec3(finalWorld*vec4(normal,0.0)));\n\n#ifndef UV1\nvec2 uv=vec2(0.,0.);\n#endif\n#ifndef UV2\nvec2 uv2=vec2(0.,0.);\n#endif\n#ifdef DIFFUSE\nif (vDiffuseInfos.x == 0.)\n{\nvDiffuseUV=vec2(diffuseMatrix*vec4(uv,1.0,0.0));\n}\nelse\n{\nvDiffuseUV=vec2(diffuseMatrix*vec4(uv2,1.0,0.0));\n}\n#endif\n#ifdef AMBIENT\nif (vAmbientInfos.x == 0.)\n{\nvAmbientUV=vec2(ambientMatrix*vec4(uv,1.0,0.0));\n}\nelse\n{\nvAmbientUV=vec2(ambientMatrix*vec4(uv2,1.0,0.0));\n}\n#endif\n#ifdef OPACITY\nif (vOpacityInfos.x == 0.)\n{\nvOpacityUV=vec2(opacityMatrix*vec4(uv,1.0,0.0));\n}\nelse\n{\nvOpacityUV=vec2(opacityMatrix*vec4(uv2,1.0,0.0));\n}\n#endif\n#ifdef REFLECTION\nvReflectionUVW=computeReflectionCoords(vec4(vPositionW,1.0),vNormalW);\n#endif\n#ifdef EMISSIVE\nif (vEmissiveInfos.x == 0.)\n{\nvEmissiveUV=vec2(emissiveMatrix*vec4(uv,1.0,0.0));\n}\nelse\n{\nvEmissiveUV=vec2(emissiveMatrix*vec4(uv2,1.0,0.0));\n}\n#endif\n#if defined(SPECULAR) && defined(SPECULARTERM)\nif (vSpecularInfos.x == 0.)\n{\nvSpecularUV=vec2(specularMatrix*vec4(uv,1.0,0.0));\n}\nelse\n{\nvSpecularUV=vec2(specularMatrix*vec4(uv2,1.0,0.0));\n}\n#endif\n#ifdef BUMP\nif (vBumpInfos.x == 0.)\n{\nvBumpUV=vec2(bumpMatrix*vec4(uv,1.0,0.0));\n}\nelse\n{\nvBumpUV=vec2(bumpMatrix*vec4(uv2,1.0,0.0));\n}\n#endif\n#include<clipPlaneVertex>\n#include<fogVertex>\n#include<shadowsVertex>[0..maxSimultaneousLights]\n\n#ifdef VERTEXCOLOR\nvColor=color;\n#endif\n}",legacypbrPixelShader:"precision mediump float;\n\n#define RECIPROCAL_PI2 0.15915494\n#define FRESNEL_MAXIMUM_ON_ROUGH 0.25\nuniform vec3 vEyePosition;\nuniform vec3 vAmbientColor;\nuniform vec4 vAlbedoColor;\nuniform vec3 vReflectionColor;\n\nuniform vec4 vLightingIntensity;\nuniform vec4 vCameraInfos;\n#ifdef OVERLOADEDVALUES\nuniform vec4 vOverloadedIntensity;\nuniform vec3 vOverloadedAmbient;\nuniform vec3 vOverloadedAlbedo;\nuniform vec3 vOverloadedReflectivity;\nuniform vec3 vOverloadedEmissive;\nuniform vec3 vOverloadedReflection;\nuniform vec3 vOverloadedMicroSurface;\n#endif\n#ifdef OVERLOADEDSHADOWVALUES\nuniform vec4 vOverloadedShadowIntensity;\n#endif\nuniform vec4 vReflectivityColor;\nuniform vec3 vEmissiveColor;\n\nvarying vec3 vPositionW;\n#ifdef NORMAL\nvarying vec3 vNormalW;\n#endif\n#ifdef VERTEXCOLOR\nvarying vec4 vColor;\n#endif\n\n#include<lightFragmentDeclaration>[0..maxSimultaneousLights]\n\n#ifdef ALBEDO\nvarying vec2 vAlbedoUV;\nuniform sampler2D albedoSampler;\nuniform vec2 vAlbedoInfos;\n#endif\n#ifdef AMBIENT\nvarying vec2 vAmbientUV;\nuniform sampler2D ambientSampler;\nuniform vec2 vAmbientInfos;\n#endif\n#ifdef OPACITY \nvarying vec2 vOpacityUV;\nuniform sampler2D opacitySampler;\nuniform vec2 vOpacityInfos;\n#endif\n#ifdef EMISSIVE\nvarying vec2 vEmissiveUV;\nuniform vec2 vEmissiveInfos;\nuniform sampler2D emissiveSampler;\n#endif\n#ifdef LIGHTMAP\nvarying vec2 vLightmapUV;\nuniform vec2 vLightmapInfos;\nuniform sampler2D lightmapSampler;\n#endif\n#if defined(REFLECTIVITY)\nvarying vec2 vReflectivityUV;\nuniform vec2 vReflectivityInfos;\nuniform sampler2D reflectivitySampler;\n#endif\n#include<clipPlaneFragmentDeclaration>\n#ifdef CAMERACOLORGRADING\nuniform sampler2D cameraColorGrading2DSampler;\nuniform vec4 vCameraColorGradingInfos;\nuniform vec4 vCameraColorGradingScaleOffset;\n#endif\n\n#include<pbrFunctions>\n#include<harmonicsFunctions>\n#include<pbrLightFunctions>\nvoid main(void) {\n#include<clipPlaneFragment>\nvec3 viewDirectionW=normalize(vEyePosition-vPositionW);\n\nvec4 surfaceAlbedo=vec4(1.,1.,1.,1.);\nvec3 surfaceAlbedoContribution=vAlbedoColor.rgb;\n\nfloat alpha=vAlbedoColor.a;\n#ifdef ALBEDO\nsurfaceAlbedo=texture2D(albedoSampler,vAlbedoUV);\nsurfaceAlbedo=vec4(toLinearSpace(surfaceAlbedo.rgb),surfaceAlbedo.a);\n#ifdef ALPHATEST\nif (baseColor.a<0.4)\ndiscard;\n#endif\n#ifdef ALPHAFROMALBEDO\nalpha*=surfaceAlbedo.a;\n#endif\nsurfaceAlbedo.rgb*=vAlbedoInfos.y;\n#else\n\nsurfaceAlbedo.rgb=surfaceAlbedoContribution;\nsurfaceAlbedoContribution=vec3(1.,1.,1.);\n#endif\n#ifdef VERTEXCOLOR\nbaseColor.rgb*=vColor.rgb;\n#endif\n#ifdef OVERLOADEDVALUES\nsurfaceAlbedo.rgb=mix(surfaceAlbedo.rgb,vOverloadedAlbedo,vOverloadedIntensity.y);\n#endif\n\n#ifdef NORMAL\nvec3 normalW=normalize(vNormalW);\n#else\nvec3 normalW=vec3(1.0,1.0,1.0);\n#endif\n\nvec3 ambientColor=vec3(1.,1.,1.);\n#ifdef AMBIENT\nambientColor=texture2D(ambientSampler,vAmbientUV).rgb*vAmbientInfos.y;\n#ifdef OVERLOADEDVALUES\nambientColor.rgb=mix(ambientColor.rgb,vOverloadedAmbient,vOverloadedIntensity.x);\n#endif\n#endif\n\nfloat microSurface=vReflectivityColor.a;\nvec3 surfaceReflectivityColor=vReflectivityColor.rgb;\n#ifdef OVERLOADEDVALUES\nsurfaceReflectivityColor.rgb=mix(surfaceReflectivityColor.rgb,vOverloadedReflectivity,vOverloadedIntensity.z);\n#endif\n#ifdef REFLECTIVITY\nvec4 surfaceReflectivityColorMap=texture2D(reflectivitySampler,vReflectivityUV);\nsurfaceReflectivityColor=surfaceReflectivityColorMap.rgb;\nsurfaceReflectivityColor=toLinearSpace(surfaceReflectivityColor);\n#ifdef OVERLOADEDVALUES\nsurfaceReflectivityColor=mix(surfaceReflectivityColor,vOverloadedReflectivity,vOverloadedIntensity.z);\n#endif\n#ifdef MICROSURFACEFROMREFLECTIVITYMAP\nmicroSurface=surfaceReflectivityColorMap.a;\n#else\n#ifdef MICROSURFACEAUTOMATIC\nmicroSurface=computeDefaultMicroSurface(microSurface,surfaceReflectivityColor);\n#endif\n#endif\n#endif\n#ifdef OVERLOADEDVALUES\nmicroSurface=mix(microSurface,vOverloadedMicroSurface.x,vOverloadedMicroSurface.y);\n#endif\n\nfloat NdotV=max(0.00000000001,dot(normalW,viewDirectionW));\n\nmicroSurface=clamp(microSurface,0.,1.)*0.98;\n\nfloat roughness=clamp(1.-microSurface,0.000001,1.0);\n\nvec3 lightDiffuseContribution=vec3(0.,0.,0.);\n#ifdef OVERLOADEDSHADOWVALUES\nvec3 shadowedOnlyLightDiffuseContribution=vec3(1.,1.,1.);\n#endif\n#ifdef SPECULARTERM\nvec3 lightSpecularContribution= vec3(0.,0.,0.);\n#endif\nfloat notShadowLevel=1.; \nfloat NdotL=-1.;\nlightingInfo info;\n#include<pbrLightFunctionsCall>[0..maxSimultaneousLights]\n#ifdef SPECULARTERM\nlightSpecularContribution*=vLightingIntensity.w;\n#endif\n#ifdef OPACITY\nvec4 opacityMap=texture2D(opacitySampler,vOpacityUV);\n#ifdef OPACITYRGB\nopacityMap.rgb=opacityMap.rgb*vec3(0.3,0.59,0.11);\nalpha*=(opacityMap.x+opacityMap.y+opacityMap.z)* vOpacityInfos.y;\n#else\nalpha*=opacityMap.a*vOpacityInfos.y;\n#endif\n#endif\n#ifdef VERTEXALPHA\nalpha*=vColor.a;\n#endif\n\nvec3 environmentRadiance=vReflectionColor.rgb;\nvec3 environmentIrradiance=vReflectionColor.rgb;\n#ifdef OVERLOADEDVALUES\nenvironmentIrradiance=mix(environmentIrradiance,vOverloadedReflection,vOverloadedMicroSurface.z);\nenvironmentRadiance=mix(environmentRadiance,vOverloadedReflection,vOverloadedMicroSurface.z);\n#endif\nenvironmentRadiance*=vLightingIntensity.z;\nenvironmentIrradiance*=vLightingIntensity.z;\n\nvec3 specularEnvironmentR0=surfaceReflectivityColor.rgb;\nvec3 specularEnvironmentR90=vec3(1.0,1.0,1.0);\nvec3 specularEnvironmentReflectance=FresnelSchlickEnvironmentGGX(clamp(NdotV,0.,1.),specularEnvironmentR0,specularEnvironmentR90,sqrt(microSurface));\n\nfloat reflectance=max(max(surfaceReflectivityColor.r,surfaceReflectivityColor.g),surfaceReflectivityColor.b);\nsurfaceAlbedo.rgb=(1.-reflectance)*surfaceAlbedo.rgb;\nenvironmentRadiance*=specularEnvironmentReflectance;\n\nvec3 surfaceEmissiveColor=vEmissiveColor;\n#ifdef EMISSIVE\nvec3 emissiveColorTex=texture2D(emissiveSampler,vEmissiveUV).rgb;\nsurfaceEmissiveColor=toLinearSpace(emissiveColorTex.rgb)*surfaceEmissiveColor*vEmissiveInfos.y;\n#endif\n#ifdef OVERLOADEDVALUES\nsurfaceEmissiveColor=mix(surfaceEmissiveColor,vOverloadedEmissive,vOverloadedIntensity.w);\n#endif\n\n#ifdef EMISSIVEASILLUMINATION\nvec3 finalDiffuse=max(lightDiffuseContribution*surfaceAlbedoContribution+vAmbientColor,0.0)*surfaceAlbedo.rgb;\n#ifdef OVERLOADEDSHADOWVALUES\nshadowedOnlyLightDiffuseContribution=max(shadowedOnlyLightDiffuseContribution*surfaceAlbedoContribution+vAmbientColor,0.0)*surfaceAlbedo.rgb;\n#endif\n#else\n#ifdef LINKEMISSIVEWITHALBEDO\nvec3 finalDiffuse=max((lightDiffuseContribution+surfaceEmissiveColor)*surfaceAlbedoContribution+vAmbientColor,0.0)*surfaceAlbedo.rgb;\n#ifdef OVERLOADEDSHADOWVALUES\nshadowedOnlyLightDiffuseContribution=max((shadowedOnlyLightDiffuseContribution+surfaceEmissiveColor)*surfaceAlbedoContribution+vAmbientColor,0.0)*surfaceAlbedo.rgb;\n#endif\n#else\nvec3 finalDiffuse=max(lightDiffuseContribution*surfaceAlbedoContribution+surfaceEmissiveColor+vAmbientColor,0.0)*surfaceAlbedo.rgb;\n#ifdef OVERLOADEDSHADOWVALUES\nshadowedOnlyLightDiffuseContribution=max(shadowedOnlyLightDiffuseContribution*surfaceAlbedoContribution+surfaceEmissiveColor+vAmbientColor,0.0)*surfaceAlbedo.rgb;\n#endif\n#endif\n#endif\n#ifdef OVERLOADEDSHADOWVALUES\nfinalDiffuse=mix(finalDiffuse,shadowedOnlyLightDiffuseContribution,(1.0-vOverloadedShadowIntensity.y));\n#endif\n#ifdef SPECULARTERM\nvec3 finalSpecular=lightSpecularContribution*surfaceReflectivityColor;\n#else\nvec3 finalSpecular=vec3(0.0);\n#endif\n#ifdef SPECULAROVERALPHA\nalpha=clamp(alpha+getLuminance(finalSpecular),0.,1.);\n#endif\n#ifdef RADIANCEOVERALPHA\nalpha=clamp(alpha+getLuminance(environmentRadiance),0.,1.);\n#endif\n\n\n#ifdef EMISSIVEASILLUMINATION\nvec4 finalColor=vec4(finalDiffuse*ambientColor*vLightingIntensity.x+surfaceAlbedo.rgb*environmentIrradiance+finalSpecular*vLightingIntensity.x+environmentRadiance+surfaceEmissiveColor*vLightingIntensity.y,alpha);\n#else\nvec4 finalColor=vec4(finalDiffuse*ambientColor*vLightingIntensity.x+surfaceAlbedo.rgb*environmentIrradiance+finalSpecular*vLightingIntensity.x+environmentRadiance,alpha);\n#endif\nfinalColor=max(finalColor,0.0);\n#ifdef CAMERATONEMAP\nfinalColor.rgb=toneMaps(finalColor.rgb);\n#endif\nfinalColor.rgb=toGammaSpace(finalColor.rgb);\n#ifdef CAMERACONTRAST\nfinalColor=contrasts(finalColor);\n#endif\nfinalColor.rgb=clamp(finalColor.rgb,0.,1.);\n#ifdef CAMERACOLORGRADING\nfinalColor=colorGrades(finalColor,cameraColorGrading2DSampler,vCameraColorGradingInfos,vCameraColorGradingScaleOffset);\n#endif\ngl_FragColor=finalColor;\n}",
legacypbrVertexShader:"precision mediump float;\n\nattribute vec3 position;\nattribute vec3 normal;\n#ifdef UV1\nattribute vec2 uv;\n#endif\n#ifdef UV2\nattribute vec2 uv2;\n#endif\n#ifdef VERTEXCOLOR\nattribute vec4 color;\n#endif\n#include<bonesDeclaration>\n\nuniform mat4 world;\nuniform mat4 view;\nuniform mat4 viewProjection;\n#ifdef ALBEDO\nvarying vec2 vAlbedoUV;\nuniform mat4 albedoMatrix;\nuniform vec2 vAlbedoInfos;\n#endif\n#ifdef AMBIENT\nvarying vec2 vAmbientUV;\nuniform mat4 ambientMatrix;\nuniform vec2 vAmbientInfos;\n#endif\n#ifdef OPACITY\nvarying vec2 vOpacityUV;\nuniform mat4 opacityMatrix;\nuniform vec2 vOpacityInfos;\n#endif\n#ifdef EMISSIVE\nvarying vec2 vEmissiveUV;\nuniform vec2 vEmissiveInfos;\nuniform mat4 emissiveMatrix;\n#endif\n#if defined(REFLECTIVITY)\nvarying vec2 vReflectivityUV;\nuniform vec2 vReflectivityInfos;\nuniform mat4 reflectivityMatrix;\n#endif\n\nvarying vec3 vPositionW;\nvarying vec3 vNormalW;\n#ifdef VERTEXCOLOR\nvarying vec4 vColor;\n#endif\n#include<clipPlaneVertexDeclaration>\nvoid main(void) {\nmat4 finalWorld=world;\n#include<bonesVertex>\ngl_Position=viewProjection*finalWorld*vec4(position,1.0);\nvec4 worldPos=finalWorld*vec4(position,1.0);\nvPositionW=vec3(worldPos);\nvNormalW=normalize(vec3(finalWorld*vec4(normal,0.0)));\n\n#ifndef UV1\nvec2 uv=vec2(0.,0.);\n#endif\n#ifndef UV2\nvec2 uv2=vec2(0.,0.);\n#endif\n#ifdef ALBEDO\nif (vAlbedoInfos.x == 0.)\n{\nvAlbedoUV=vec2(albedoMatrix*vec4(uv,1.0,0.0));\n}\nelse\n{\nvAlbedoUV=vec2(albedoMatrix*vec4(uv2,1.0,0.0));\n}\n#endif\n#ifdef AMBIENT\nif (vAmbientInfos.x == 0.)\n{\nvAmbientUV=vec2(ambientMatrix*vec4(uv,1.0,0.0));\n}\nelse\n{\nvAmbientUV=vec2(ambientMatrix*vec4(uv2,1.0,0.0));\n}\n#endif\n#ifdef OPACITY\nif (vOpacityInfos.x == 0.)\n{\nvOpacityUV=vec2(opacityMatrix*vec4(uv,1.0,0.0));\n}\nelse\n{\nvOpacityUV=vec2(opacityMatrix*vec4(uv2,1.0,0.0));\n}\n#endif\n#ifdef EMISSIVE\nif (vEmissiveInfos.x == 0.)\n{\nvEmissiveUV=vec2(emissiveMatrix*vec4(uv,1.0,0.0));\n}\nelse\n{\nvEmissiveUV=vec2(emissiveMatrix*vec4(uv2,1.0,0.0));\n}\n#endif\n#if defined(REFLECTIVITY)\nif (vReflectivityInfos.x == 0.)\n{\nvReflectivityUV=vec2(reflectivityMatrix*vec4(uv,1.0,0.0));\n}\nelse\n{\nvReflectivityUV=vec2(reflectivityMatrix*vec4(uv2,1.0,0.0));\n}\n#endif\n#include<clipPlaneVertex>\n\n#ifdef VERTEXCOLOR\nvColor=color;\n#endif\n}",lensFlarePixelShader:"\nvarying vec2 vUV;\nuniform sampler2D textureSampler;\n\nuniform vec4 color;\nvoid main(void) {\nvec4 baseColor=texture2D(textureSampler,vUV);\ngl_FragColor=baseColor*color;\n}",lensFlareVertexShader:"\nattribute vec2 position;\n\nuniform mat4 viewportMatrix;\n\nvarying vec2 vUV;\nconst vec2 madd=vec2(0.5,0.5);\nvoid main(void) { \nvUV=position*madd+madd;\ngl_Position=viewportMatrix*vec4(position,0.0,1.0);\n}",lensHighlightsPixelShader:"\nuniform sampler2D textureSampler; \n\nuniform float gain;\nuniform float threshold;\nuniform float screen_width;\nuniform float screen_height;\n\nvarying vec2 vUV;\n\nvec4 highlightColor(vec4 color) {\nvec4 highlight=color;\nfloat luminance=dot(highlight.rgb,vec3(0.2125,0.7154,0.0721));\nfloat lum_threshold;\nif (threshold>1.0) { lum_threshold=0.94+0.01*threshold; }\nelse { lum_threshold=0.5+0.44*threshold; }\nluminance=clamp((luminance-lum_threshold)*(1.0/(1.0-lum_threshold)),0.0,1.0);\nhighlight*=luminance*gain;\nhighlight.a=1.0;\nreturn highlight;\n}\nvoid main(void)\n{\nvec4 original=texture2D(textureSampler,vUV);\n\nif (gain == -1.0) {\ngl_FragColor=vec4(0.0,0.0,0.0,1.0);\nreturn;\n}\nfloat w=2.0/screen_width;\nfloat h=2.0/screen_height;\nfloat weight=1.0;\n\nvec4 blurred=vec4(0.0,0.0,0.0,0.0);\n#ifdef PENTAGON\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(-0.84*w,0.43*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(0.48*w,-1.29*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(0.61*w,1.51*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(-1.55*w,-0.74*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(1.71*w,-0.52*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(-0.94*w,1.59*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(-0.40*w,-1.87*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(1.62*w,1.16*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(-2.09*w,0.25*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(1.46*w,-1.71*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(0.08*w,2.42*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(-1.85*w,-1.89*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(2.89*w,0.16*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(-2.29*w,1.88*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(0.40*w,-2.81*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(1.54*w,2.26*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(-2.60*w,-0.61*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(2.31*w,-1.30*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(-0.83*w,2.53*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(-1.12*w,-2.48*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(2.60*w,1.11*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(-2.82*w,0.99*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(1.50*w,-2.81*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(0.85*w,3.33*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(-2.94*w,-1.92*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(3.27*w,-0.53*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(-1.95*w,2.48*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(-0.23*w,-3.04*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(2.17*w,2.05*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(-2.97*w,-0.04*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(2.25*w,-2.00*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(-0.31*w,3.08*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(-1.94*w,-2.59*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(3.37*w,0.64*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(-3.13*w,1.93*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(1.03*w,-3.65*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(1.60*w,3.17*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(-3.14*w,-1.19*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(3.00*w,-1.19*h)));\n#else\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(-0.85*w,0.36*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(0.52*w,-1.14*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(0.46*w,1.42*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(-1.46*w,-0.83*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(1.79*w,-0.42*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(-1.11*w,1.62*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(-0.29*w,-2.07*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(1.69*w,1.39*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(-2.28*w,0.12*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(1.65*w,-1.69*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(-0.08*w,2.44*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(-1.63*w,-1.90*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(2.55*w,0.31*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(-2.13*w,1.52*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(0.56*w,-2.61*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(1.38*w,2.34*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(-2.64*w,-0.81*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(2.53*w,-1.21*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(-1.06*w,2.63*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(-1.00*w,-2.69*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(2.59*w,1.32*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(-2.82*w,0.78*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(1.57*w,-2.50*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(0.54*w,2.93*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(-2.39*w,-1.81*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(3.01*w,-0.28*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(-2.04*w,2.25*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(-0.02*w,-3.05*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(2.09*w,2.25*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(-3.07*w,-0.25*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(2.44*w,-1.90*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(-0.52*w,3.05*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(-1.68*w,-2.61*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(3.01*w,0.79*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(-2.76*w,1.46*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(1.05*w,-2.94*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(1.21*w,2.88*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(-2.84*w,-1.30*h)));\nblurred+=highlightColor(texture2D(textureSampler,vUV+vec2(2.98*w,-0.96*h)));\n#endif\nblurred/=39.0;\ngl_FragColor=blurred;\n\n}",linePixelShader:"uniform vec4 color;\nvoid main(void) {\ngl_FragColor=color;\n}",lineVertexShader:"\nattribute vec3 position;\nattribute vec4 normal;\n\nuniform mat4 worldViewProjection;\nuniform float width;\nuniform float aspectRatio;\nvoid main(void) {\nvec4 viewPosition=worldViewProjection*vec4(position,1.0);\nvec4 viewPositionNext=worldViewProjection*vec4(normal.xyz,1.0);\nvec2 currentScreen=viewPosition.xy/viewPosition.w;\nvec2 nextScreen=viewPositionNext.xy/viewPositionNext.w;\ncurrentScreen.x*=aspectRatio;\nnextScreen.x*=aspectRatio;\nvec2 dir=normalize(nextScreen-currentScreen);\nvec2 normalDir=vec2(-dir.y,dir.x);\nnormalDir*=width/2.0;\nnormalDir.x/=aspectRatio;\nvec4 offset=vec4(normalDir*normal.w,0.0,0.0);\ngl_Position=viewPosition+offset;\n}",lines2dPixelShader:"varying vec4 vColor;\nvoid main(void) {\ngl_FragColor=vColor;\n}",lines2dVertexShader:"\n#ifdef Instanced\n#define att attribute\n#else\n#define att uniform\n#endif\nattribute vec2 position;\natt vec2 zBias;\natt vec4 transformX;\natt vec4 transformY;\n#ifdef FillSolid\natt vec4 fillSolidColor;\n#endif\n#ifdef BorderSolid\natt vec4 borderSolidColor;\n#endif\n#ifdef FillGradient\natt vec2 boundingMin;\natt vec2 boundingMax;\natt vec4 fillGradientColor1;\natt vec4 fillGradientColor2;\natt vec4 fillGradientTY;\n#endif\n#ifdef BorderGradient\natt vec4 borderGradientColor1;\natt vec4 borderGradientColor2;\natt vec4 borderGradientTY;\n#endif\n#define TWOPI 6.28318530\n\nvarying vec2 vUV;\nvarying vec4 vColor;\nvoid main(void) {\n#ifdef FillSolid\nvColor=fillSolidColor;\n#endif\n#ifdef BorderSolid\nvColor=borderSolidColor;\n#endif\n#ifdef FillGradient\nfloat v=dot(vec4((position.xy-boundingMin)/(boundingMax-boundingMin),1,1),fillGradientTY);\nvColor=mix(fillGradientColor2,fillGradientColor1,v); \n#endif\n#ifdef BorderGradient\nfloat v=dot(vec4((position.xy-boundingMin)/(boundingMax-boundingMin),1,1),borderGradientTY);\nvColor=mix(borderGradientColor2,borderGradientColor1,v); \n#endif\nvec4 pos;\npos.xy=position.xy;\npos.z=1.0;\npos.w=1.0;\ngl_Position=vec4(dot(pos,transformX),dot(pos,transformY),zBias.x,1);\n}",outlinePixelShader:"uniform vec4 color;\n#ifdef ALPHATEST\nvarying vec2 vUV;\nuniform sampler2D diffuseSampler;\n#endif\nvoid main(void) {\n#ifdef ALPHATEST\nif (texture2D(diffuseSampler,vUV).a<0.4)\ndiscard;\n#endif\ngl_FragColor=color;\n}",outlineVertexShader:"\nattribute vec3 position;\nattribute vec3 normal;\n#include<bonesDeclaration>\n\nuniform float offset;\n#include<instancesDeclaration>\nuniform mat4 viewProjection;\n#ifdef ALPHATEST\nvarying vec2 vUV;\nuniform mat4 diffuseMatrix;\n#ifdef UV1\nattribute vec2 uv;\n#endif\n#ifdef UV2\nattribute vec2 uv2;\n#endif\n#endif\nvoid main(void)\n{\nvec3 offsetPosition=position+normal*offset;\n#include<instancesVertex>\n#include<bonesVertex>\ngl_Position=viewProjection*finalWorld*vec4(offsetPosition,1.0);\n#ifdef ALPHATEST\n#ifdef UV1\nvUV=vec2(diffuseMatrix*vec4(uv,1.0,0.0));\n#endif\n#ifdef UV2\nvUV=vec2(diffuseMatrix*vec4(uv2,1.0,0.0));\n#endif\n#endif\n}\n",particlesPixelShader:"\nvarying vec2 vUV;\nvarying vec4 vColor;\nuniform vec4 textureMask;\nuniform sampler2D diffuseSampler;\n#ifdef CLIPPLANE\nvarying float fClipDistance;\n#endif\nvoid main(void) {\n#ifdef CLIPPLANE\nif (fClipDistance>0.0)\ndiscard;\n#endif\nvec4 baseColor=texture2D(diffuseSampler,vUV);\ngl_FragColor=(baseColor*textureMask+(vec4(1.,1.,1.,1.)-textureMask))*vColor;\n}",particlesVertexShader:"\nattribute vec3 position;\nattribute vec4 color;\nattribute vec4 options;\n\nuniform mat4 view;\nuniform mat4 projection;\n\nvarying vec2 vUV;\nvarying vec4 vColor;\n#ifdef CLIPPLANE\nuniform vec4 vClipPlane;\nuniform mat4 invView;\nvarying float fClipDistance;\n#endif\nvoid main(void) { \nvec3 viewPos=(view*vec4(position,1.0)).xyz; \nvec3 cornerPos;\nfloat size=options.y;\nfloat angle=options.x;\nvec2 offset=options.zw;\ncornerPos=vec3(offset.x-0.5,offset.y-0.5,0.)*size;\n\nvec3 rotatedCorner;\nrotatedCorner.x=cornerPos.x*cos(angle)-cornerPos.y*sin(angle);\nrotatedCorner.y=cornerPos.x*sin(angle)+cornerPos.y*cos(angle);\nrotatedCorner.z=0.;\n\nviewPos+=rotatedCorner;\ngl_Position=projection*vec4(viewPos,1.0); \nvColor=color;\nvUV=offset;\n\n#ifdef CLIPPLANE\nvec4 worldPos=invView*vec4(viewPos,1.0);\nfClipDistance=dot(worldPos,vClipPlane);\n#endif\n}",passPixelShader:"\nvarying vec2 vUV;\nuniform sampler2D textureSampler;\nvoid main(void) \n{\ngl_FragColor=texture2D(textureSampler,vUV);\n}",pbrPixelShader:"#ifdef BUMP\n#extension GL_OES_standard_derivatives : enable\n#endif\n#ifdef LODBASEDMICROSFURACE\n#extension GL_EXT_shader_texture_lod : enable\n#endif\n#ifdef LOGARITHMICDEPTH\n#extension GL_EXT_frag_depth : enable\n#endif\nprecision highp float;\nuniform vec3 vEyePosition;\nuniform vec3 vAmbientColor;\nuniform vec3 vReflectionColor;\nuniform vec4 vAlbedoColor;\n\nuniform vec4 vLightingIntensity;\nuniform vec4 vCameraInfos;\n#ifdef OVERLOADEDVALUES\nuniform vec4 vOverloadedIntensity;\nuniform vec3 vOverloadedAmbient;\nuniform vec3 vOverloadedAlbedo;\nuniform vec3 vOverloadedReflectivity;\nuniform vec3 vOverloadedEmissive;\nuniform vec3 vOverloadedReflection;\nuniform vec3 vOverloadedMicroSurface;\n#endif\n#ifdef OVERLOADEDSHADOWVALUES\nuniform vec4 vOverloadedShadowIntensity;\n#endif\n#if defined(REFLECTION) || defined(REFRACTION)\nuniform vec2 vMicrosurfaceTextureLods;\n#endif\nuniform vec4 vReflectivityColor;\nuniform vec3 vEmissiveColor;\n\nvarying vec3 vPositionW;\n#ifdef NORMAL\nvarying vec3 vNormalW;\n#endif\n#ifdef VERTEXCOLOR\nvarying vec4 vColor;\n#endif\n\n#include<lightFragmentDeclaration>[0..maxSimultaneousLights]\n\n#ifdef ALBEDO\nvarying vec2 vAlbedoUV;\nuniform sampler2D albedoSampler;\nuniform vec2 vAlbedoInfos;\n#endif\n#ifdef AMBIENT\nvarying vec2 vAmbientUV;\nuniform sampler2D ambientSampler;\nuniform vec2 vAmbientInfos;\n#endif\n#ifdef OPACITY \nvarying vec2 vOpacityUV;\nuniform sampler2D opacitySampler;\nuniform vec2 vOpacityInfos;\n#endif\n#ifdef EMISSIVE\nvarying vec2 vEmissiveUV;\nuniform vec2 vEmissiveInfos;\nuniform sampler2D emissiveSampler;\n#endif\n#ifdef LIGHTMAP\nvarying vec2 vLightmapUV;\nuniform vec2 vLightmapInfos;\nuniform sampler2D lightmapSampler;\n#endif\n#if defined(REFLECTIVITY)\nvarying vec2 vReflectivityUV;\nuniform vec2 vReflectivityInfos;\nuniform sampler2D reflectivitySampler;\n#endif\n\n#include<fresnelFunction>\n#ifdef OPACITYFRESNEL\nuniform vec4 opacityParts;\n#endif\n#ifdef EMISSIVEFRESNEL\nuniform vec4 emissiveLeftColor;\nuniform vec4 emissiveRightColor;\n#endif\n\n#if defined(REFLECTIONMAP_SPHERICAL) || defined(REFLECTIONMAP_PROJECTION) || defined(REFRACTION)\nuniform mat4 view;\n#endif\n\n#ifdef REFRACTION\nuniform vec4 vRefractionInfos;\n#ifdef REFRACTIONMAP_3D\nuniform samplerCube refractionCubeSampler;\n#else\nuniform sampler2D refraction2DSampler;\nuniform mat4 refractionMatrix;\n#endif\n#endif\n\n#ifdef REFLECTION\nuniform vec2 vReflectionInfos;\n#ifdef REFLECTIONMAP_3D\nuniform samplerCube reflectionCubeSampler;\n#else\nuniform sampler2D reflection2DSampler;\n#endif\n#ifdef REFLECTIONMAP_SKYBOX\nvarying vec3 vPositionUVW;\n#else\n#ifdef REFLECTIONMAP_EQUIRECTANGULAR_FIXED\nvarying vec3 vDirectionW;\n#endif\n#if defined(REFLECTIONMAP_PLANAR) || defined(REFLECTIONMAP_CUBIC) || defined(REFLECTIONMAP_PROJECTION)\nuniform mat4 reflectionMatrix;\n#endif\n#endif\n#include<reflectionFunction>\n#endif\n#ifdef CAMERACOLORGRADING\n#include<colorGradingDefinition>\n#endif\n#ifdef CAMERACOLORCURVES\n#include<colorCurvesDefinition>\n#endif\n\n#include<pbrShadowFunctions>\n#include<pbrFunctions>\n#ifdef CAMERACOLORGRADING\n#include<colorGrading>\n#endif\n#ifdef CAMERACOLORCURVES\n#include<colorCurves>\n#endif\n#include<harmonicsFunctions>\n#include<pbrLightFunctions>\n#include<bumpFragmentFunctions>\n#include<clipPlaneFragmentDeclaration>\n#include<logDepthDeclaration>\n\n#include<fogFragmentDeclaration>\nvoid main(void) {\n#include<clipPlaneFragment>\nvec3 viewDirectionW=normalize(vEyePosition-vPositionW);\n\nvec4 surfaceAlbedo=vec4(1.,1.,1.,1.);\nvec3 surfaceAlbedoContribution=vAlbedoColor.rgb;\n\nfloat alpha=vAlbedoColor.a;\n#ifdef ALBEDO\nsurfaceAlbedo=texture2D(albedoSampler,vAlbedoUV);\nsurfaceAlbedo=vec4(toLinearSpace(surfaceAlbedo.rgb),surfaceAlbedo.a);\n#ifndef LINKREFRACTIONTOTRANSPARENCY\n#ifdef ALPHATEST\nif (surfaceAlbedo.a<0.4)\ndiscard;\n#endif\n#endif\n#ifdef ALPHAFROMALBEDO\nalpha*=surfaceAlbedo.a;\n#endif\nsurfaceAlbedo.rgb*=vAlbedoInfos.y;\n#else\n\nsurfaceAlbedo.rgb=surfaceAlbedoContribution;\nsurfaceAlbedoContribution=vec3(1.,1.,1.);\n#endif\n#ifdef VERTEXCOLOR\nsurfaceAlbedo.rgb*=vColor.rgb;\n#endif\n#ifdef OVERLOADEDVALUES\nsurfaceAlbedo.rgb=mix(surfaceAlbedo.rgb,vOverloadedAlbedo,vOverloadedIntensity.y);\n#endif\n\n#ifdef NORMAL\nvec3 normalW=normalize(vNormalW);\n#else\nvec3 normalW=vec3(1.0,1.0,1.0);\n#endif\n#include<bumpFragment>\n\nvec3 ambientColor=vec3(1.,1.,1.);\n#ifdef AMBIENT\nambientColor=texture2D(ambientSampler,vAmbientUV).rgb*vAmbientInfos.y;\n#ifdef OVERLOADEDVALUES\nambientColor.rgb=mix(ambientColor.rgb,vOverloadedAmbient,vOverloadedIntensity.x);\n#endif\n#endif\n\nfloat microSurface=vReflectivityColor.a;\nvec3 surfaceReflectivityColor=vReflectivityColor.rgb;\n#ifdef OVERLOADEDVALUES\nsurfaceReflectivityColor.rgb=mix(surfaceReflectivityColor.rgb,vOverloadedReflectivity,vOverloadedIntensity.z);\n#endif\n#ifdef REFLECTIVITY\nvec4 surfaceReflectivityColorMap=texture2D(reflectivitySampler,vReflectivityUV);\nsurfaceReflectivityColor=surfaceReflectivityColorMap.rgb;\nsurfaceReflectivityColor=toLinearSpace(surfaceReflectivityColor);\n#ifdef OVERLOADEDVALUES\nsurfaceReflectivityColor=mix(surfaceReflectivityColor,vOverloadedReflectivity,vOverloadedIntensity.z);\n#endif\n#ifdef MICROSURFACEFROMREFLECTIVITYMAP\nmicroSurface=surfaceReflectivityColorMap.a;\n#else\n#ifdef MICROSURFACEAUTOMATIC\nmicroSurface=computeDefaultMicroSurface(microSurface,surfaceReflectivityColor);\n#endif\n#endif\n#endif\n#ifdef OVERLOADEDVALUES\nmicroSurface=mix(microSurface,vOverloadedMicroSurface.x,vOverloadedMicroSurface.y);\n#endif\n\nfloat NdotV=max(0.00000000001,dot(normalW,viewDirectionW));\n\nmicroSurface=clamp(microSurface,0.,1.)*0.98;\n\nfloat roughness=clamp(1.-microSurface,0.000001,1.0);\n\nvec3 lightDiffuseContribution=vec3(0.,0.,0.);\n#ifdef OVERLOADEDSHADOWVALUES\nvec3 shadowedOnlyLightDiffuseContribution=vec3(1.,1.,1.);\n#endif\n#ifdef SPECULARTERM\nvec3 lightSpecularContribution=vec3(0.,0.,0.);\n#endif\nfloat notShadowLevel=1.; \nfloat NdotL=-1.;\nlightingInfo info;\n\nfloat reflectance=max(max(surfaceReflectivityColor.r,surfaceReflectivityColor.g),surfaceReflectivityColor.b);\n\n\nfloat reflectance90=clamp(reflectance*25.0,0.0,1.0);\nvec3 specularEnvironmentR0=surfaceReflectivityColor.rgb;\nvec3 specularEnvironmentR90=vec3(1.0,1.0,1.0)*reflectance90;\n#include<pbrLightFunctionsCall>[0..maxSimultaneousLights]\n#ifdef SPECULARTERM\nlightSpecularContribution*=vLightingIntensity.w;\n#endif\n#ifdef OPACITY\nvec4 opacityMap=texture2D(opacitySampler,vOpacityUV);\n#ifdef OPACITYRGB\nopacityMap.rgb=opacityMap.rgb*vec3(0.3,0.59,0.11);\nalpha*=(opacityMap.x+opacityMap.y+opacityMap.z)* vOpacityInfos.y;\n#else\nalpha*=opacityMap.a*vOpacityInfos.y;\n#endif\n#endif\n#ifdef VERTEXALPHA\nalpha*=vColor.a;\n#endif\n#ifdef OPACITYFRESNEL\nfloat opacityFresnelTerm=computeFresnelTerm(viewDirectionW,normalW,opacityParts.z,opacityParts.w);\nalpha+=opacityParts.x*(1.0-opacityFresnelTerm)+opacityFresnelTerm*opacityParts.y;\n#endif\n\nvec3 surfaceRefractionColor=vec3(0.,0.,0.);\n\n#ifdef LODBASEDMICROSFURACE\nfloat alphaG=convertRoughnessToAverageSlope(roughness);\n#endif\n#ifdef REFRACTION\nvec3 refractionVector=refract(-viewDirectionW,normalW,vRefractionInfos.y);\n#ifdef LODBASEDMICROSFURACE\n#ifdef USEPMREMREFRACTION\nfloat lodRefraction=getMipMapIndexFromAverageSlopeWithPMREM(vMicrosurfaceTextureLods.y,alphaG);\n#else\nfloat lodRefraction=getMipMapIndexFromAverageSlope(vMicrosurfaceTextureLods.y,alphaG);\n#endif\n#else\nfloat biasRefraction=(vMicrosurfaceTextureLods.y+2.)*(1.0-microSurface);\n#endif\n#ifdef REFRACTIONMAP_3D\nrefractionVector.y=refractionVector.y*vRefractionInfos.w;\nif (dot(refractionVector,viewDirectionW)<1.0)\n{\n#ifdef LODBASEDMICROSFURACE\n#ifdef USEPMREMREFRACTION\n\nif ((vMicrosurfaceTextureLods.y-lodRefraction)>4.0)\n{\n\nfloat scaleRefraction=1.-exp2(lodRefraction)/exp2(vMicrosurfaceTextureLods.y); \nfloat maxRefraction=max(max(abs(refractionVector.x),abs(refractionVector.y)),abs(refractionVector.z));\nif (abs(refractionVector.x) != maxRefraction) refractionVector.x*=scaleRefraction;\nif (abs(refractionVector.y) != maxRefraction) refractionVector.y*=scaleRefraction;\nif (abs(refractionVector.z) != maxRefraction) refractionVector.z*=scaleRefraction;\n}\n#endif\nsurfaceRefractionColor=textureCubeLodEXT(refractionCubeSampler,refractionVector,lodRefraction).rgb*vRefractionInfos.x;\n#else\nsurfaceRefractionColor=textureCube(refractionCubeSampler,refractionVector,biasRefraction).rgb*vRefractionInfos.x;\n#endif\n}\n#ifndef REFRACTIONMAPINLINEARSPACE\nsurfaceRefractionColor=toLinearSpace(surfaceRefractionColor.rgb);\n#endif\n#else\nvec3 vRefractionUVW=vec3(refractionMatrix*(view*vec4(vPositionW+refractionVector*vRefractionInfos.z,1.0)));\nvec2 refractionCoords=vRefractionUVW.xy/vRefractionUVW.z;\nrefractionCoords.y=1.0-refractionCoords.y;\n#ifdef LODBASEDMICROSFURACE\nsurfaceRefractionColor=texture2DLodEXT(refraction2DSampler,refractionCoords,lodRefraction).rgb*vRefractionInfos.x;\n#else\nsurfaceRefractionColor=texture2D(refraction2DSampler,refractionCoords,biasRefraction).rgb*vRefractionInfos.x;\n#endif \nsurfaceRefractionColor=toLinearSpace(surfaceRefractionColor.rgb);\n#endif\n#endif\n\nvec3 environmentRadiance=vReflectionColor.rgb;\nvec3 environmentIrradiance=vReflectionColor.rgb;\n#ifdef REFLECTION\nvec3 vReflectionUVW=computeReflectionCoords(vec4(vPositionW,1.0),normalW);\n#ifdef LODBASEDMICROSFURACE\n#ifdef USEPMREMREFLECTION\nfloat lodReflection=getMipMapIndexFromAverageSlopeWithPMREM(vMicrosurfaceTextureLods.x,alphaG);\n#else\nfloat lodReflection=getMipMapIndexFromAverageSlope(vMicrosurfaceTextureLods.x,alphaG);\n#endif\n#else\nfloat biasReflection=(vMicrosurfaceTextureLods.x+2.)*(1.0-microSurface);\n#endif\n#ifdef REFLECTIONMAP_3D\n#ifdef LODBASEDMICROSFURACE\n#ifdef USEPMREMREFLECTION\n\nif ((vMicrosurfaceTextureLods.y-lodReflection)>4.0)\n{\n\nfloat scaleReflection=1.-exp2(lodReflection)/exp2(vMicrosurfaceTextureLods.x); \nfloat maxReflection=max(max(abs(vReflectionUVW.x),abs(vReflectionUVW.y)),abs(vReflectionUVW.z));\nif (abs(vReflectionUVW.x) != maxReflection) vReflectionUVW.x*=scaleReflection;\nif (abs(vReflectionUVW.y) != maxReflection) vReflectionUVW.y*=scaleReflection;\nif (abs(vReflectionUVW.z) != maxReflection) vReflectionUVW.z*=scaleReflection;\n}\n#endif\nenvironmentRadiance=textureCubeLodEXT(reflectionCubeSampler,vReflectionUVW,lodReflection).rgb*vReflectionInfos.x;\n#else\nenvironmentRadiance=textureCube(reflectionCubeSampler,vReflectionUVW,biasReflection).rgb*vReflectionInfos.x;\n#endif\n#ifdef USESPHERICALFROMREFLECTIONMAP\n#ifndef REFLECTIONMAP_SKYBOX\nvec3 normalEnvironmentSpace=(reflectionMatrix*vec4(normalW,1)).xyz;\nenvironmentIrradiance=EnvironmentIrradiance(normalEnvironmentSpace);\n#endif\n#else\nenvironmentRadiance=toLinearSpace(environmentRadiance.rgb);\nenvironmentIrradiance=textureCube(reflectionCubeSampler,normalW,20.).rgb*vReflectionInfos.x;\nenvironmentIrradiance=toLinearSpace(environmentIrradiance.rgb);\nenvironmentIrradiance*=0.2; \n#endif\n#else\nvec2 coords=vReflectionUVW.xy;\n#ifdef REFLECTIONMAP_PROJECTION\ncoords/=vReflectionUVW.z;\n#endif\ncoords.y=1.0-coords.y;\n#ifdef LODBASEDMICROSFURACE\nenvironmentRadiance=texture2DLodEXT(reflection2DSampler,coords,lodReflection).rgb*vReflectionInfos.x;\n#else\nenvironmentRadiance=texture2D(reflection2DSampler,coords,biasReflection).rgb*vReflectionInfos.x;\n#endif\nenvironmentRadiance=toLinearSpace(environmentRadiance.rgb);\nenvironmentIrradiance=texture2D(reflection2DSampler,coords,20.).rgb*vReflectionInfos.x;\nenvironmentIrradiance=toLinearSpace(environmentIrradiance.rgb);\n#endif\n#endif\n#ifdef OVERLOADEDVALUES\nenvironmentIrradiance=mix(environmentIrradiance,vOverloadedReflection,vOverloadedMicroSurface.z);\nenvironmentRadiance=mix(environmentRadiance,vOverloadedReflection,vOverloadedMicroSurface.z);\n#endif\nenvironmentRadiance*=vLightingIntensity.z;\nenvironmentIrradiance*=vLightingIntensity.z;\n\nvec3 specularEnvironmentReflectance=FresnelSchlickEnvironmentGGX(clamp(NdotV,0.,1.),specularEnvironmentR0,specularEnvironmentR90,sqrt(microSurface));\n\nvec3 refractance=vec3(0.0,0.0,0.0);\n#ifdef REFRACTION\nvec3 transmission=vec3(1.0,1.0,1.0);\n#ifdef LINKREFRACTIONTOTRANSPARENCY\n\ntransmission*=(1.0-alpha);\n\n\nvec3 mixedAlbedo=surfaceAlbedoContribution.rgb*surfaceAlbedo.rgb;\nfloat maxChannel=max(max(mixedAlbedo.r,mixedAlbedo.g),mixedAlbedo.b);\nvec3 tint=clamp(maxChannel*mixedAlbedo,0.0,1.0);\n\nsurfaceAlbedoContribution*=alpha;\n\nenvironmentIrradiance*=alpha;\n\nsurfaceRefractionColor*=tint;\n\nalpha=1.0;\n#endif\n\nvec3 bounceSpecularEnvironmentReflectance=(2.0*specularEnvironmentReflectance)/(1.0+specularEnvironmentReflectance);\nspecularEnvironmentReflectance=mix(bounceSpecularEnvironmentReflectance,specularEnvironmentReflectance,alpha);\n\ntransmission*=1.0-specularEnvironmentReflectance;\n\nrefractance=surfaceRefractionColor*transmission;\n#endif\n\nsurfaceAlbedo.rgb=(1.-reflectance)*surfaceAlbedo.rgb;\nrefractance*=vLightingIntensity.z;\nenvironmentRadiance*=specularEnvironmentReflectance;\n\nvec3 surfaceEmissiveColor=vEmissiveColor;\n#ifdef EMISSIVE\nvec3 emissiveColorTex=texture2D(emissiveSampler,vEmissiveUV).rgb;\nsurfaceEmissiveColor=toLinearSpace(emissiveColorTex.rgb)*surfaceEmissiveColor*vEmissiveInfos.y;\n#endif\n#ifdef OVERLOADEDVALUES\nsurfaceEmissiveColor=mix(surfaceEmissiveColor,vOverloadedEmissive,vOverloadedIntensity.w);\n#endif\n#ifdef EMISSIVEFRESNEL\nfloat emissiveFresnelTerm=computeFresnelTerm(viewDirectionW,normalW,emissiveRightColor.a,emissiveLeftColor.a);\nsurfaceEmissiveColor*=emissiveLeftColor.rgb*(1.0-emissiveFresnelTerm)+emissiveFresnelTerm*emissiveRightColor.rgb;\n#endif\n\n#ifdef EMISSIVEASILLUMINATION\nvec3 finalDiffuse=max(lightDiffuseContribution*surfaceAlbedoContribution+vAmbientColor,0.0)*surfaceAlbedo.rgb;\n#ifdef OVERLOADEDSHADOWVALUES\nshadowedOnlyLightDiffuseContribution=max(shadowedOnlyLightDiffuseContribution*surfaceAlbedoContribution+vAmbientColor,0.0)*surfaceAlbedo.rgb;\n#endif\n#else\n#ifdef LINKEMISSIVEWITHALBEDO\nvec3 finalDiffuse=max((lightDiffuseContribution+surfaceEmissiveColor)*surfaceAlbedoContribution+vAmbientColor,0.0)*surfaceAlbedo.rgb;\n#ifdef OVERLOADEDSHADOWVALUES\nshadowedOnlyLightDiffuseContribution=max((shadowedOnlyLightDiffuseContribution+surfaceEmissiveColor)*surfaceAlbedoContribution+vAmbientColor,0.0)*surfaceAlbedo.rgb;\n#endif\n#else\nvec3 finalDiffuse=max(lightDiffuseContribution*surfaceAlbedoContribution+surfaceEmissiveColor+vAmbientColor,0.0)*surfaceAlbedo.rgb;\n#ifdef OVERLOADEDSHADOWVALUES\nshadowedOnlyLightDiffuseContribution=max(shadowedOnlyLightDiffuseContribution*surfaceAlbedoContribution+surfaceEmissiveColor+vAmbientColor,0.0)*surfaceAlbedo.rgb;\n#endif\n#endif\n#endif\n#ifdef OVERLOADEDSHADOWVALUES\nfinalDiffuse=mix(finalDiffuse,shadowedOnlyLightDiffuseContribution,(1.0-vOverloadedShadowIntensity.y));\n#endif\n#ifdef SPECULARTERM\nvec3 finalSpecular=lightSpecularContribution*surfaceReflectivityColor;\n#else\nvec3 finalSpecular=vec3(0.0);\n#endif\n#ifdef SPECULAROVERALPHA\nalpha=clamp(alpha+getLuminance(finalSpecular),0.,1.);\n#endif\n#ifdef RADIANCEOVERALPHA\nalpha=clamp(alpha+getLuminance(environmentRadiance),0.,1.);\n#endif\n\n\n#ifdef EMISSIVEASILLUMINATION\nvec4 finalColor=vec4(finalDiffuse*ambientColor*vLightingIntensity.x+surfaceAlbedo.rgb*environmentIrradiance+finalSpecular*vLightingIntensity.x+environmentRadiance+surfaceEmissiveColor*vLightingIntensity.y+refractance,alpha);\n#else\nvec4 finalColor=vec4(finalDiffuse*ambientColor*vLightingIntensity.x+surfaceAlbedo.rgb*environmentIrradiance+finalSpecular*vLightingIntensity.x+environmentRadiance+refractance,alpha);\n#endif\n#ifdef LIGHTMAP\nvec3 lightmapColor=texture2D(lightmapSampler,vLightmapUV).rgb*vLightmapInfos.y;\n#ifdef USELIGHTMAPASSHADOWMAP\nfinalColor.rgb*=lightmapColor;\n#else\nfinalColor.rgb+=lightmapColor;\n#endif\n#endif\nfinalColor=max(finalColor,0.0);\n#ifdef CAMERATONEMAP\nfinalColor.rgb=toneMaps(finalColor.rgb);\n#endif\nfinalColor.rgb=toGammaSpace(finalColor.rgb);\n#include<logDepthFragment>\n#include<fogFragment>(color,finalColor)\n#ifdef CAMERACONTRAST\nfinalColor=contrasts(finalColor);\n#endif\nfinalColor.rgb=clamp(finalColor.rgb,0.,1.);\n#ifdef CAMERACOLORGRADING\nfinalColor=colorGrades(finalColor);\n#endif\n#ifdef CAMERACOLORCURVES\nfinalColor.rgb=applyColorCurves(finalColor.rgb);\n#endif\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ngl_FragColor=finalColor;\n}",pbrVertexShader:"precision highp float;\n\nattribute vec3 position;\n#ifdef NORMAL\nattribute vec3 normal;\n#endif\n#ifdef UV1\nattribute vec2 uv;\n#endif\n#ifdef UV2\nattribute vec2 uv2;\n#endif\n#ifdef VERTEXCOLOR\nattribute vec4 color;\n#endif\n#include<bonesDeclaration>\n\n#include<instancesDeclaration>\nuniform mat4 view;\nuniform mat4 viewProjection;\n#ifdef ALBEDO\nvarying vec2 vAlbedoUV;\nuniform mat4 albedoMatrix;\nuniform vec2 vAlbedoInfos;\n#endif\n#ifdef AMBIENT\nvarying vec2 vAmbientUV;\nuniform mat4 ambientMatrix;\nuniform vec2 vAmbientInfos;\n#endif\n#ifdef OPACITY\nvarying vec2 vOpacityUV;\nuniform mat4 opacityMatrix;\nuniform vec2 vOpacityInfos;\n#endif\n#ifdef EMISSIVE\nvarying vec2 vEmissiveUV;\nuniform vec2 vEmissiveInfos;\nuniform mat4 emissiveMatrix;\n#endif\n#ifdef LIGHTMAP\nvarying vec2 vLightmapUV;\nuniform vec2 vLightmapInfos;\nuniform mat4 lightmapMatrix;\n#endif\n#if defined(REFLECTIVITY)\nvarying vec2 vReflectivityUV;\nuniform vec2 vReflectivityInfos;\nuniform mat4 reflectivityMatrix;\n#endif\n#ifdef BUMP\nvarying vec2 vBumpUV;\nuniform vec3 vBumpInfos;\nuniform mat4 bumpMatrix;\n#endif\n#ifdef POINTSIZE\nuniform float pointSize;\n#endif\n\nvarying vec3 vPositionW;\n#ifdef NORMAL\nvarying vec3 vNormalW;\n#endif\n#ifdef VERTEXCOLOR\nvarying vec4 vColor;\n#endif\n#include<clipPlaneVertexDeclaration>\n#include<fogVertexDeclaration>\n#include<shadowsVertexDeclaration>[0..maxSimultaneousLights]\n#ifdef REFLECTIONMAP_SKYBOX\nvarying vec3 vPositionUVW;\n#endif\n#ifdef REFLECTIONMAP_EQUIRECTANGULAR_FIXED\nvarying vec3 vDirectionW;\n#endif\n#include<logDepthDeclaration>\nvoid main(void) {\n#ifdef REFLECTIONMAP_SKYBOX\nvPositionUVW=position;\n#endif \n#include<instancesVertex>\n#include<bonesVertex>\ngl_Position=viewProjection*finalWorld*vec4(position,1.0);\nvec4 worldPos=finalWorld*vec4(position,1.0);\nvPositionW=vec3(worldPos);\n#ifdef NORMAL\nvNormalW=normalize(vec3(finalWorld*vec4(normal,0.0)));\n#endif\n#ifdef REFLECTIONMAP_EQUIRECTANGULAR_FIXED\nvDirectionW=normalize(vec3(finalWorld*vec4(position,0.0)));\n#endif\n\n#ifndef UV1\nvec2 uv=vec2(0.,0.);\n#endif\n#ifndef UV2\nvec2 uv2=vec2(0.,0.);\n#endif\n#ifdef ALBEDO\nif (vAlbedoInfos.x == 0.)\n{\nvAlbedoUV=vec2(albedoMatrix*vec4(uv,1.0,0.0));\n}\nelse\n{\nvAlbedoUV=vec2(albedoMatrix*vec4(uv2,1.0,0.0));\n}\n#endif\n#ifdef AMBIENT\nif (vAmbientInfos.x == 0.)\n{\nvAmbientUV=vec2(ambientMatrix*vec4(uv,1.0,0.0));\n}\nelse\n{\nvAmbientUV=vec2(ambientMatrix*vec4(uv2,1.0,0.0));\n}\n#endif\n#ifdef OPACITY\nif (vOpacityInfos.x == 0.)\n{\nvOpacityUV=vec2(opacityMatrix*vec4(uv,1.0,0.0));\n}\nelse\n{\nvOpacityUV=vec2(opacityMatrix*vec4(uv2,1.0,0.0));\n}\n#endif\n#ifdef EMISSIVE\nif (vEmissiveInfos.x == 0.)\n{\nvEmissiveUV=vec2(emissiveMatrix*vec4(uv,1.0,0.0));\n}\nelse\n{\nvEmissiveUV=vec2(emissiveMatrix*vec4(uv2,1.0,0.0));\n}\n#endif\n#ifdef LIGHTMAP\nif (vLightmapInfos.x == 0.)\n{\nvLightmapUV=vec2(lightmapMatrix*vec4(uv,1.0,0.0));\n}\nelse\n{\nvLightmapUV=vec2(lightmapMatrix*vec4(uv2,1.0,0.0));\n}\n#endif\n#if defined(REFLECTIVITY)\nif (vReflectivityInfos.x == 0.)\n{\nvReflectivityUV=vec2(reflectivityMatrix*vec4(uv,1.0,0.0));\n}\nelse\n{\nvReflectivityUV=vec2(reflectivityMatrix*vec4(uv2,1.0,0.0));\n}\n#endif\n#ifdef BUMP\nif (vBumpInfos.x == 0.)\n{\nvBumpUV=vec2(bumpMatrix*vec4(uv,1.0,0.0));\n}\nelse\n{\nvBumpUV=vec2(bumpMatrix*vec4(uv2,1.0,0.0));\n}\n#endif\n\n#include<clipPlaneVertex>\n\n#include<fogVertex>\n\n#include<shadowsVertex>[0..maxSimultaneousLights]\n\n#ifdef VERTEXCOLOR\nvColor=color;\n#endif\n\n#ifdef POINTSIZE\ngl_PointSize=pointSize;\n#endif\n\n#include<logDepthVertex>\n}",
postprocessVertexShader:"\nattribute vec2 position;\nuniform vec2 scale;\n\nvarying vec2 vUV;\nconst vec2 madd=vec2(0.5,0.5);\nvoid main(void) { \nvUV=(position*madd+madd)*scale;\ngl_Position=vec4(position,0.0,1.0);\n}",proceduralVertexShader:"\nattribute vec2 position;\n\nvarying vec2 vPosition;\nvarying vec2 vUV;\nconst vec2 madd=vec2(0.5,0.5);\nvoid main(void) { \nvPosition=position;\nvUV=position*madd+madd;\ngl_Position=vec4(position,0.0,1.0);\n}",rect2dPixelShader:"varying vec4 vColor;\nvoid main(void) {\ngl_FragColor=vColor;\n}",rect2dVertexShader:"\n#ifdef Instanced\n#define att attribute\n#else\n#define att uniform\n#endif\nattribute float index;\natt vec2 zBias;\natt vec4 transformX;\natt vec4 transformY;\n#ifdef Border\natt float borderThickness;\n#endif\n#ifdef FillSolid\natt vec4 fillSolidColor;\n#endif\n#ifdef BorderSolid\natt vec4 borderSolidColor;\n#endif\n#ifdef FillGradient\natt vec4 fillGradientColor1;\natt vec4 fillGradientColor2;\natt vec4 fillGradientTY;\n#endif\n#ifdef BorderGradient\natt vec4 borderGradientColor1;\natt vec4 borderGradientColor2;\natt vec4 borderGradientTY;\n#endif\n\natt vec3 properties;\n\n#define rsub0 17.0\n#define rsub1 33.0\n#define rsub2 49.0\n#define rsub3 65.0\n#define rsub 64.0\n#define TWOPI 6.28318530\n\nvarying vec2 vUV;\nvarying vec4 vColor;\nvoid main(void) {\nvec2 pos2;\n\nif (properties.z == 0.0) {\n#ifdef Border\nfloat w=properties.x;\nfloat h=properties.y;\nvec2 borderOffset=vec2(1.0,1.0);\nfloat segi=index;\nif (index<4.0) {\nborderOffset=vec2(1.0-(borderThickness*2.0/w),1.0-(borderThickness*2.0/h));\n}\nelse {\nsegi-=4.0;\n}\nif (segi == 0.0) {\npos2=vec2(1.0,1.0);\n} \nelse if (segi == 1.0) {\npos2=vec2(1.0,0.0);\n}\nelse if (segi == 2.0) {\npos2=vec2(0.0,0.0);\n} \nelse {\npos2=vec2(0.0,1.0);\n}\npos2.x=((pos2.x-0.5)*borderOffset.x)+0.5;\npos2.y=((pos2.y-0.5)*borderOffset.y)+0.5;\n#else\nif (index == 0.0) {\npos2=vec2(0.5,0.5);\n}\nelse if (index == 1.0) {\npos2=vec2(1.0,1.0);\n}\nelse if (index == 2.0) {\npos2=vec2(1.0,0.0);\n}\nelse if (index == 3.0) {\npos2=vec2(0.0,0.0);\n}\nelse {\npos2=vec2(0.0,1.0);\n}\n#endif\n}\nelse\n{\n#ifdef Border\nfloat w=properties.x;\nfloat h=properties.y;\nfloat r=properties.z;\nfloat nru=r/w;\nfloat nrv=r/h;\nvec2 borderOffset=vec2(1.0,1.0);\nfloat segi=index;\nif (index<rsub) {\nborderOffset=vec2(1.0-(borderThickness*2.0/w),1.0-(borderThickness*2.0/h));\n}\nelse {\nsegi-=rsub;\n}\n\nif (segi<rsub0) {\npos2=vec2(1.0-nru,nrv);\n}\n\nelse if (segi<rsub1) {\npos2=vec2(nru,nrv);\n}\n\nelse if (segi<rsub2) {\npos2=vec2(nru,1.0-nrv);\n}\n\nelse {\npos2=vec2(1.0-nru,1.0-nrv);\n}\nfloat angle=TWOPI-((index-1.0)*TWOPI/(rsub-0.5));\npos2.x+=cos(angle)*nru;\npos2.y+=sin(angle)*nrv;\npos2.x=((pos2.x-0.5)*borderOffset.x)+0.5;\npos2.y=((pos2.y-0.5)*borderOffset.y)+0.5;\n#else\nif (index == 0.0) {\npos2=vec2(0.5,0.5);\n}\nelse {\nfloat w=properties.x;\nfloat h=properties.y;\nfloat r=properties.z;\nfloat nru=r/w;\nfloat nrv=r/h;\n\nif (index<rsub0) {\npos2=vec2(1.0-nru,nrv);\n}\n\nelse if (index<rsub1) {\npos2=vec2(nru,nrv);\n}\n\nelse if (index<rsub2) {\npos2=vec2(nru,1.0-nrv);\n}\n\nelse {\npos2=vec2(1.0-nru,1.0-nrv);\n}\nfloat angle=TWOPI-((index-1.0)*TWOPI/(rsub-0.5));\npos2.x+=cos(angle)*nru;\npos2.y+=sin(angle)*nrv;\n}\n#endif\n}\n#ifdef FillSolid\nvColor=fillSolidColor;\n#endif\n#ifdef BorderSolid\nvColor=borderSolidColor;\n#endif\n#ifdef FillGradient\nfloat v=dot(vec4(pos2.xy,1,1),fillGradientTY);\nvColor=mix(fillGradientColor2,fillGradientColor1,v); \n#endif\n#ifdef BorderGradient\nfloat v=dot(vec4(pos2.xy,1,1),borderGradientTY);\nvColor=mix(borderGradientColor2,borderGradientColor1,v); \n#endif\nvec4 pos;\npos.xy=pos2.xy*properties.xy;\npos.z=1.0;\npos.w=1.0;\ngl_Position=vec4(dot(pos,transformX),dot(pos,transformY),zBias.x,1);\n}",refractionPixelShader:"\nvarying vec2 vUV;\nuniform sampler2D textureSampler;\nuniform sampler2D refractionSampler;\n\nuniform vec3 baseColor;\nuniform float depth;\nuniform float colorLevel;\nvoid main() {\nfloat ref=1.0-texture2D(refractionSampler,vUV).r;\nvec2 uv=vUV-vec2(0.5);\nvec2 offset=uv*depth*ref;\nvec3 sourceColor=texture2D(textureSampler,vUV-offset).rgb;\ngl_FragColor=vec4(sourceColor+sourceColor*ref*colorLevel,1.0);\n}",shadowMapPixelShader:"vec4 pack(float depth)\n{\nconst vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);\nconst vec4 bit_mask=vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);\nvec4 res=fract(depth*bit_shift);\nres-=res.xxyz*bit_mask;\nreturn res;\n}\n\nvec2 packHalf(float depth) \n{ \nconst vec2 bitOffset=vec2(1.0/255.,0.);\nvec2 color=vec2(depth,fract(depth*255.));\nreturn color-(color.yy*bitOffset);\n}\nvarying vec4 vPosition;\n#ifdef ALPHATEST\nvarying vec2 vUV;\nuniform sampler2D diffuseSampler;\n#endif\n#ifdef CUBEMAP\nuniform vec3 lightPosition;\nuniform vec2 depthValues;\n#endif\nvoid main(void)\n{\n#ifdef ALPHATEST\nif (texture2D(diffuseSampler,vUV).a<0.4)\ndiscard;\n#endif\n#ifdef CUBEMAP\nvec3 directionToLight=vPosition.xyz-lightPosition;\nfloat depth=length(directionToLight);\ndepth=(depth-depthValues.x)/(depthValues.y-depthValues.x);\ndepth=clamp(depth,0.,1.0);\n#else\nfloat depth=vPosition.z/vPosition.w;\ndepth=depth*0.5+0.5;\n#endif\n#ifdef VSM\nfloat moment1=depth;\nfloat moment2=moment1*moment1;\ngl_FragColor=vec4(packHalf(moment1),packHalf(moment2));\n#else\ngl_FragColor=pack(depth);\n#endif\n}",shadowMapVertexShader:"\nattribute vec3 position;\n#include<bonesDeclaration>\n\n#include<instancesDeclaration>\nuniform mat4 viewProjection;\nvarying vec4 vPosition;\n#ifdef ALPHATEST\nvarying vec2 vUV;\nuniform mat4 diffuseMatrix;\n#ifdef UV1\nattribute vec2 uv;\n#endif\n#ifdef UV2\nattribute vec2 uv2;\n#endif\n#endif\nvoid main(void)\n{\n#include<instancesVertex>\n#include<bonesVertex>\n#ifdef CUBEMAP\nvPosition=finalWorld*vec4(position,1.0);\ngl_Position=viewProjection*finalWorld*vec4(position,1.0);\n#else\nvPosition=viewProjection*finalWorld*vec4(position,1.0);\ngl_Position=vPosition;\n#endif\n#ifdef ALPHATEST\n#ifdef UV1\nvUV=vec2(diffuseMatrix*vec4(uv,1.0,0.0));\n#endif\n#ifdef UV2\nvUV=vec2(diffuseMatrix*vec4(uv2,1.0,0.0));\n#endif\n#endif\n}",sprite2dPixelShader:"varying vec2 vUV;\nuniform sampler2D diffuseSampler;\nvoid main(void) {\nvec4 color=texture2D(diffuseSampler,vUV);\nif (color.a == 0.05) {\ndiscard;\n}\ngl_FragColor=color;\n}",sprite2dVertexShader:"\n#ifdef Instanced\n#define att attribute\n#else\n#define att uniform\n#endif\n\nattribute float index;\natt vec2 topLeftUV;\natt vec2 sizeUV;\natt vec2 textureSize;\n\natt vec3 properties;\natt vec2 zBias;\natt vec4 transformX;\natt vec4 transformY;\n\n\nvarying vec2 vUV;\nvarying vec4 vColor;\nvoid main(void) {\nvec2 pos2;\n\nvec2 off=vec2(0.0,0.0);\nfloat frame=properties.x;\nfloat invertY=properties.y;\nfloat alignToPixel=properties.z;\n\nif (index == 0.0) {\npos2=vec2(0.0,0.0);\nvUV=vec2(topLeftUV.x+(frame*sizeUV.x)+off.x,topLeftUV.y-off.y);\n}\n\nelse if (index == 1.0) {\npos2=vec2(0.0,1.0);\nvUV=vec2(topLeftUV.x+(frame*sizeUV.x)+off.x,(topLeftUV.y+sizeUV.y));\n}\n\nelse if (index == 2.0) {\npos2=vec2( 1.0,1.0);\nvUV=vec2(topLeftUV.x+sizeUV.x+(frame*sizeUV.x),(topLeftUV.y+sizeUV.y));\n}\n\nelse if (index == 3.0) {\npos2=vec2( 1.0,0.0);\nvUV=vec2(topLeftUV.x+sizeUV.x+(frame*sizeUV.x),topLeftUV.y-off.y);\n}\nif (invertY == 1.0) {\nvUV.y=1.0-vUV.y;\n}\nvec4 pos;\nif (alignToPixel == 1.0)\n{\npos.xy=floor(pos2.xy*sizeUV*textureSize);\n} else {\npos.xy=pos2.xy*sizeUV*textureSize;\n}\npos.z=1.0;\npos.w=1.0;\ngl_Position=vec4(dot(pos,transformX),dot(pos,transformY),zBias.x,1);\n} ",spritesPixelShader:"uniform bool alphaTest;\nvarying vec4 vColor;\n\nvarying vec2 vUV;\nuniform sampler2D diffuseSampler;\n\n#include<fogFragmentDeclaration>\nvoid main(void) {\nvec4 color=texture2D(diffuseSampler,vUV);\nif (alphaTest) \n{\nif (color.a<0.95)\ndiscard;\n}\ncolor*=vColor;\n#include<fogFragment>\ngl_FragColor=color;\n}",spritesVertexShader:"\nattribute vec4 position;\nattribute vec4 options;\nattribute vec4 cellInfo;\nattribute vec4 color;\n\nuniform vec2 textureInfos;\nuniform mat4 view;\nuniform mat4 projection;\n\nvarying vec2 vUV;\nvarying vec4 vColor;\n#include<fogVertexDeclaration>\nvoid main(void) { \nvec3 viewPos=(view*vec4(position.xyz,1.0)).xyz; \nvec2 cornerPos;\nfloat angle=position.w;\nvec2 size=vec2(options.x,options.y);\nvec2 offset=options.zw;\nvec2 uvScale=textureInfos.xy;\ncornerPos=vec2(offset.x-0.5,offset.y-0.5)*size;\n\nvec3 rotatedCorner;\nrotatedCorner.x=cornerPos.x*cos(angle)-cornerPos.y*sin(angle);\nrotatedCorner.y=cornerPos.x*sin(angle)+cornerPos.y*cos(angle);\nrotatedCorner.z=0.;\n\nviewPos+=rotatedCorner;\ngl_Position=projection*vec4(viewPos,1.0); \n\nvColor=color;\n\nvec2 uvOffset=vec2(abs(offset.x-cellInfo.x),1.0-abs(offset.y-cellInfo.y));\nvUV=(uvOffset+cellInfo.zw)*uvScale;\n\n#ifdef FOG\nfFogDistance=viewPos.z;\n#endif\n}",ssaoPixelShader:"\nuniform sampler2D textureSampler;\nvarying vec2 vUV;\n#ifdef SSAO\nuniform sampler2D randomSampler;\nuniform float randTextureTiles;\nuniform float samplesFactor;\nuniform vec3 sampleSphere[SAMPLES];\nuniform float totalStrength;\nuniform float radius;\nuniform float area;\nuniform float fallOff;\nuniform float base;\nvec3 normalFromDepth(float depth,vec2 coords)\n{\nvec2 offset1=vec2(0.0,radius);\nvec2 offset2=vec2(radius,0.0);\nfloat depth1=texture2D(textureSampler,coords+offset1).r;\nfloat depth2=texture2D(textureSampler,coords+offset2).r;\nvec3 p1=vec3(offset1,depth1-depth);\nvec3 p2=vec3(offset2,depth2-depth);\nvec3 normal=cross(p1,p2);\nnormal.z=-normal.z;\nreturn normalize(normal);\n}\nvoid main()\n{\nvec3 random=normalize(texture2D(randomSampler,vUV*randTextureTiles).rgb);\nfloat depth=texture2D(textureSampler,vUV).r;\nvec3 position=vec3(vUV,depth);\nvec3 normal=normalFromDepth(depth,vUV);\nfloat radiusDepth=radius/depth;\nfloat occlusion=0.0;\nvec3 ray;\nvec3 hemiRay;\nfloat occlusionDepth;\nfloat difference;\nfor (int i=0; i<SAMPLES; i++)\n{\nray=radiusDepth*reflect(sampleSphere[i],random);\nhemiRay=position+sign(dot(ray,normal))*ray;\nocclusionDepth=texture2D(textureSampler,clamp(hemiRay.xy,vec2(0.001,0.001),vec2(0.999,0.999))).r;\ndifference=depth-occlusionDepth;\nocclusion+=step(fallOff,difference)*(1.0-smoothstep(fallOff,area,difference));\n}\nfloat ao=1.0-totalStrength*occlusion*samplesFactor;\nfloat result=clamp(ao+base,0.0,1.0);\ngl_FragColor.r=result;\ngl_FragColor.g=result;\ngl_FragColor.b=result;\ngl_FragColor.a=1.0;\n}\n#endif\n#ifdef BILATERAL_BLUR\nuniform sampler2D depthSampler;\nuniform float outSize;\nuniform float samplerOffsets[SAMPLES];\nvoid main()\n{\nfloat texelsize=1.0/outSize;\nfloat compareDepth=texture2D(depthSampler,vUV).r;\nfloat result=0.0;\nfloat weightSum=0.0;\nfor (int i=0; i<SAMPLES; ++i)\n{\n#ifdef BILATERAL_BLUR_H\nvec2 sampleOffset=vec2(texelsize*samplerOffsets[i],0.0);\n#else\nvec2 sampleOffset=vec2(0.0,texelsize*samplerOffsets[i]);\n#endif\nvec2 samplePos=vUV+sampleOffset;\nfloat sampleDepth=texture2D(depthSampler,samplePos).r;\nfloat weight=(1.0/(0.0001+abs(compareDepth-sampleDepth)));\nresult+=texture2D(textureSampler,samplePos).r*weight;\nweightSum+=weight;\n}\nresult/=weightSum;\ngl_FragColor.rgb=vec3(result);\ngl_FragColor.a=1.0;\n}\n#endif\n",ssaoCombinePixelShader:"uniform sampler2D textureSampler;\nuniform sampler2D originalColor;\nvarying vec2 vUV;\nvoid main(void) {\nvec4 ssaoColor=texture2D(textureSampler,vUV);\nvec4 sceneColor=texture2D(originalColor,vUV);\ngl_FragColor=sceneColor*ssaoColor;\n}\n",stereoscopicInterlacePixelShader:"const vec3 TWO=vec3(2.0,2.0,2.0);\nvarying vec2 vUV;\nuniform sampler2D camASampler;\nuniform sampler2D textureSampler;\nuniform vec2 stepSize;\nvoid main(void)\n{\nbool useCamB;\nvec2 texCoord1;\nvec2 texCoord2;\nvec3 frag1;\nvec3 frag2;\n#ifdef IS_STEREOSCOPIC_HORIZ\nuseCamB=vUV.x>0.5;\ntexCoord1=vec2(useCamB ? (vUV.x-0.5)*2.0 : vUV.x*2.0,vUV.y);\ntexCoord2=vec2(texCoord1.x+stepSize.x,vUV.y);\n#else\nuseCamB=vUV.y>0.5;\ntexCoord1=vec2(vUV.x,useCamB ? (vUV.y-0.5)*2.0 : vUV.y*2.0);\ntexCoord2=vec2(vUV.x,texCoord1.y+stepSize.y);\n#endif\n\nif (useCamB){\nfrag1=texture2D(textureSampler,texCoord1).rgb;\nfrag2=texture2D(textureSampler,texCoord2).rgb;\n}else{\nfrag1=texture2D(camASampler ,texCoord1).rgb;\nfrag2=texture2D(camASampler ,texCoord2).rgb;\n}\ngl_FragColor=vec4((frag1+frag2)/TWO,1.0);\n}",text2dPixelShader:"varying vec4 vColor;\nvarying vec2 vUV;\n\nuniform sampler2D diffuseSampler;\nvoid main(void) {\nvec4 color=texture2D(diffuseSampler,vUV);\nif (color.a<0.05)\ndiscard;\ngl_FragColor=color*vColor;\n}",text2dVertexShader:"\n#ifdef Instanced\n#define att attribute\n#else\n#define att uniform\n#endif\n\nattribute float index;\natt vec2 zBias;\natt vec4 transformX;\natt vec4 transformY;\natt vec2 topLeftUV;\natt vec2 sizeUV;\natt vec2 textureSize;\natt vec4 color;\n\nvarying vec2 vUV;\nvarying vec4 vColor;\nvoid main(void) {\nvec2 pos2;\n\nif (index == 0.0) {\npos2=vec2(0.0,0.0);\nvUV=vec2(topLeftUV.x,topLeftUV.y+sizeUV.y);\n}\n\nelse if (index == 1.0) {\npos2=vec2(0.0,1.0);\nvUV=vec2(topLeftUV.x,topLeftUV.y);\n}\n\nelse if (index == 2.0) {\npos2=vec2(1.0,1.0);\nvUV=vec2(topLeftUV.x+sizeUV.x,topLeftUV.y);\n}\n\nelse if (index == 3.0) {\npos2=vec2(1.0,0.0);\nvUV=vec2(topLeftUV.x+sizeUV.x,topLeftUV.y+sizeUV.y);\n}\n\nvUV=(floor(vUV*textureSize)+vec2(0.0,0.0))/textureSize;\nvColor=color;\nvec4 pos;\npos.xy=floor(pos2.xy*sizeUV*textureSize); \npos.z=1.0;\npos.w=1.0;\ngl_Position=vec4(dot(pos,transformX),dot(pos,transformY),zBias.x,1);\n}",tonemapPixelShader:"\nvarying vec2 vUV;\nuniform sampler2D textureSampler;\n\nuniform float _ExposureAdjustment;\n#if defined(HABLE_TONEMAPPING)\nconst float A=0.15;\nconst float B=0.50;\nconst float C=0.10;\nconst float D=0.20;\nconst float E=0.02;\nconst float F=0.30;\nconst float W=11.2;\n#endif\nfloat Luminance(vec3 c)\n{\nreturn dot(c,vec3(0.22,0.707,0.071));\n}\nvoid main(void) \n{\nvec3 colour=texture2D(textureSampler,vUV).rgb;\n#if defined(REINHARD_TONEMAPPING)\nfloat lum=Luminance(colour.rgb); \nfloat lumTm=lum*_ExposureAdjustment;\nfloat scale=lumTm/(1.0+lumTm); \ncolour*=scale/lum;\n#elif defined(HABLE_TONEMAPPING)\ncolour*=_ExposureAdjustment;\nconst float ExposureBias=2.0;\nvec3 x=ExposureBias*colour;\nvec3 curr=((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;\nx=vec3(W,W,W);\nvec3 whiteScale=1.0/(((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F);\ncolour=curr*whiteScale;\n#elif defined(OPTIMIZED_HEJIDAWSON_TONEMAPPING)\ncolour*=_ExposureAdjustment;\nvec3 X=max(vec3(0.0,0.0,0.0),colour-0.004);\nvec3 retColor=(X*(6.2*X+0.5))/(X*(6.2*X+1.7)+0.06);\ncolour=retColor*retColor;\n#elif defined(PHOTOGRAPHIC_TONEMAPPING)\ncolour=vec3(1.0,1.0,1.0)-exp2(-_ExposureAdjustment*colour);\n#endif\ngl_FragColor=vec4(colour.rgb,1.0);\n}",volumetricLightScatteringPixelShader:"uniform sampler2D textureSampler;\nuniform sampler2D lightScatteringSampler;\nuniform float decay;\nuniform float exposure;\nuniform float weight;\nuniform float density;\nuniform vec2 meshPositionOnScreen;\nvarying vec2 vUV;\nvoid main(void) {\nvec2 tc=vUV;\nvec2 deltaTexCoord=(tc-meshPositionOnScreen.xy);\ndeltaTexCoord*=1.0/float(NUM_SAMPLES)*density;\nfloat illuminationDecay=1.0;\nvec4 color=texture2D(lightScatteringSampler,tc)*0.4;\nfor(int i=0; i<NUM_SAMPLES; i++) {\ntc-=deltaTexCoord;\nvec4 sample=texture2D(lightScatteringSampler,tc)*0.4;\nsample*=illuminationDecay*weight;\ncolor+=sample;\nilluminationDecay*=decay;\n}\nvec4 realColor=texture2D(textureSampler,vUV);\ngl_FragColor=((vec4((vec3(color.r,color.g,color.b)*exposure),1))+(realColor*(1.5-0.4)));\n}\n",volumetricLightScatteringPassPixelShader:"#if defined(ALPHATEST) || defined(NEED_UV)\nvarying vec2 vUV;\n#endif\n#if defined(ALPHATEST)\nuniform sampler2D diffuseSampler;\n#endif\nvoid main(void)\n{\n#if defined(ALPHATEST)\nvec4 diffuseColor=texture2D(diffuseSampler,vUV);\nif (diffuseColor.a<0.4)\ndiscard;\n#endif\ngl_FragColor=vec4(0.0,0.0,0.0,1.0);\n}\n",vrDistortionCorrectionPixelShader:"\nvarying vec2 vUV;\nuniform sampler2D textureSampler;\nuniform vec2 LensCenter;\nuniform vec2 Scale;\nuniform vec2 ScaleIn;\nuniform vec4 HmdWarpParam;\nvec2 HmdWarp(vec2 in01) {\nvec2 theta=(in01-LensCenter)*ScaleIn; \nfloat rSq=theta.x*theta.x+theta.y*theta.y;\nvec2 rvector=theta*(HmdWarpParam.x+HmdWarpParam.y*rSq+HmdWarpParam.z*rSq*rSq+HmdWarpParam.w*rSq*rSq*rSq);\nreturn LensCenter+Scale*rvector;\n}\nvoid main(void)\n{\nvec2 tc=HmdWarp(vUV);\nif (tc.x <0.0 || tc.x>1.0 || tc.y<0.0 || tc.y>1.0)\ngl_FragColor=vec4(0.0,0.0,0.0,1.0);\nelse{\ngl_FragColor=vec4(texture2D(textureSampler,tc).rgb,1.0);\n}\n}"},BABYLON.Effect.IncludesShadersStore={bonesDeclaration:"#if NUM_BONE_INFLUENCERS>0\nuniform mat4 mBones[BonesPerMesh];\nattribute vec4 matricesIndices;\nattribute vec4 matricesWeights;\n#if NUM_BONE_INFLUENCERS>4\nattribute vec4 matricesIndicesExtra;\nattribute vec4 matricesWeightsExtra;\n#endif\n#endif",bonesVertex:"#if NUM_BONE_INFLUENCERS>0\nmat4 influence;\ninfluence=mBones[int(matricesIndices[0])]*matricesWeights[0];\n#if NUM_BONE_INFLUENCERS>1\ninfluence+=mBones[int(matricesIndices[1])]*matricesWeights[1];\n#endif \n#if NUM_BONE_INFLUENCERS>2\ninfluence+=mBones[int(matricesIndices[2])]*matricesWeights[2];\n#endif \n#if NUM_BONE_INFLUENCERS>3\ninfluence+=mBones[int(matricesIndices[3])]*matricesWeights[3];\n#endif \n#if NUM_BONE_INFLUENCERS>4\ninfluence+=mBones[int(matricesIndicesExtra[0])]*matricesWeightsExtra[0];\n#endif \n#if NUM_BONE_INFLUENCERS>5\ninfluence+=mBones[int(matricesIndicesExtra[1])]*matricesWeightsExtra[1];\n#endif \n#if NUM_BONE_INFLUENCERS>6\ninfluence+=mBones[int(matricesIndicesExtra[2])]*matricesWeightsExtra[2];\n#endif \n#if NUM_BONE_INFLUENCERS>7\ninfluence+=mBones[int(matricesIndicesExtra[3])]*matricesWeightsExtra[3];\n#endif \nfinalWorld=finalWorld*influence;\n#endif",bumpFragment:"#ifdef BUMP\nvec2 bumpUV=vBumpUV;\n#endif\n#if defined(BUMP) || defined(PARALLAX)\nmat3 TBN=cotangent_frame(normalW*vBumpInfos.y,-viewDirectionW,bumpUV);\n#endif\n#ifdef PARALLAX\nmat3 invTBN=transposeMat3(TBN);\n#ifdef PARALLAXOCCLUSION\nvec2 uvOffset=parallaxOcclusion(invTBN*-viewDirectionW,invTBN*normalW,bumpUV,vBumpInfos.z);\n#else\nvec2 uvOffset=parallaxOffset(invTBN*viewDirectionW,vBumpInfos.z);\n#endif\ndiffuseUV+=uvOffset;\nbumpUV+=uvOffset;\n#endif\n#ifdef BUMP\nnormalW=perturbNormal(viewDirectionW,TBN,bumpUV);\n#endif",bumpFragmentFunctions:"#ifdef BUMP\nvarying vec2 vBumpUV;\nuniform vec3 vBumpInfos;\nuniform sampler2D bumpSampler;\n\nmat3 cotangent_frame(vec3 normal,vec3 p,vec2 uv)\n{\n\nvec3 dp1=dFdx(p);\nvec3 dp2=dFdy(p);\nvec2 duv1=dFdx(uv);\nvec2 duv2=dFdy(uv);\n\nvec3 dp2perp=cross(dp2,normal);\nvec3 dp1perp=cross(normal,dp1);\nvec3 tangent=dp2perp*duv1.x+dp1perp*duv2.x;\nvec3 binormal=dp2perp*duv1.y+dp1perp*duv2.y;\n\nfloat invmax=inversesqrt(max(dot(tangent,tangent),dot(binormal,binormal)));\nreturn mat3(tangent*invmax,binormal*invmax,normal);\n}\nvec3 perturbNormal(vec3 viewDir,mat3 cotangentFrame,vec2 uv)\n{\nvec3 map=texture2D(bumpSampler,uv).xyz;\n#ifdef INVERTNORMALMAPX\nmap.x=1.0-map.x;\n#endif\n#ifdef INVERTNORMALMAPY\nmap.y=1.0-map.y;\n#endif\nmap=map*255./127.-128./127.;\nreturn normalize(cotangentFrame*map);\n}\n#ifdef PARALLAX\nconst float minSamples=4.;\nconst float maxSamples=15.;\nconst int iMaxSamples=15;\n\nvec2 parallaxOcclusion(vec3 vViewDirCoT,vec3 vNormalCoT,vec2 texCoord,float parallaxScale) {\nfloat parallaxLimit=length(vViewDirCoT.xy)/vViewDirCoT.z;\nparallaxLimit*=parallaxScale;\nvec2 vOffsetDir=normalize(vViewDirCoT.xy);\nvec2 vMaxOffset=vOffsetDir*parallaxLimit;\nfloat numSamples=maxSamples+(dot(vViewDirCoT,vNormalCoT)*(minSamples-maxSamples));\nfloat stepSize=1.0/numSamples;\n\nfloat currRayHeight=1.0;\nvec2 vCurrOffset=vec2(0,0);\nvec2 vLastOffset=vec2(0,0);\nfloat lastSampledHeight=1.0;\nfloat currSampledHeight=1.0;\nfor (int i=0; i<iMaxSamples; i++)\n{\ncurrSampledHeight=texture2D(bumpSampler,vBumpUV+vCurrOffset).w;\n\nif (currSampledHeight>currRayHeight)\n{\nfloat delta1=currSampledHeight-currRayHeight;\nfloat delta2=(currRayHeight+stepSize)-lastSampledHeight;\nfloat ratio=delta1/(delta1+delta2);\nvCurrOffset=(ratio)* vLastOffset+(1.0-ratio)*vCurrOffset;\n\nbreak;\n}\nelse\n{\ncurrRayHeight-=stepSize;\nvLastOffset=vCurrOffset;\nvCurrOffset+=stepSize*vMaxOffset;\nlastSampledHeight=currSampledHeight;\n}\n}\nreturn vCurrOffset;\n}\nvec2 parallaxOffset(vec3 viewDir,float heightScale)\n{\n\nfloat height=texture2D(bumpSampler,vBumpUV).w;\nvec2 texCoordOffset=heightScale*viewDir.xy*height;\nreturn -texCoordOffset;\n}\n#endif\n#endif",clipPlaneFragment:"#ifdef CLIPPLANE\nif (fClipDistance>0.0)\n{\ndiscard;\n}\n#endif",clipPlaneFragmentDeclaration:"#ifdef CLIPPLANE\nvarying float fClipDistance;\n#endif",clipPlaneVertex:"#ifdef CLIPPLANE\nfClipDistance=dot(worldPos,vClipPlane);\n#endif",clipPlaneVertexDeclaration:"#ifdef CLIPPLANE\nuniform vec4 vClipPlane;\nvarying float fClipDistance;\n#endif",colorCurves:"const vec3 HDTVRec709_RGBLuminanceCoefficients=vec3(0.2126,0.7152,0.0722);\nvec3 applyColorCurves(vec3 original) {\nvec3 result=original;\n\n\n\nfloat luma=dot(result.rgb,HDTVRec709_RGBLuminanceCoefficients);\nvec2 curveMix=clamp(vec2(luma*3.0-1.5,luma*-3.0+1.5),vec2(0.0,0.0),vec2(1.0,1.0));\nvec4 colorCurve=vCameraColorCurveNeutral+curveMix.x*vCameraColorCurvePositive-curveMix.y*vCameraColorCurveNegative;\nresult.rgb*=colorCurve.rgb;\nresult.rgb=mix(vec3(luma,luma,luma),result.rgb,colorCurve.a);\nreturn result;\n}",colorCurvesDefinition:"uniform vec4 vCameraColorCurveNeutral;\nuniform vec4 vCameraColorCurvePositive;\nuniform vec4 vCameraColorCurveNegative;",colorGrading:"vec4 colorGrades(vec4 color) \n{ \n\nfloat sliceContinuous=color.z*vCameraColorGradingInfos.z;\nfloat sliceInteger=floor(sliceContinuous);\n\n\nfloat sliceFraction=sliceContinuous-sliceInteger; \n\nvec2 sliceUV=color.xy*vCameraColorGradingScaleOffset.xy+vCameraColorGradingScaleOffset.zw;\n\n\nsliceUV.x+=sliceInteger*vCameraColorGradingInfos.w;\nvec4 slice0Color=texture2D(cameraColorGrading2DSampler,sliceUV);\nsliceUV.x+=vCameraColorGradingInfos.w;\nvec4 slice1Color=texture2D(cameraColorGrading2DSampler,sliceUV);\nvec3 result=mix(slice0Color.rgb,slice1Color.rgb,sliceFraction);\ncolor.rgb=mix(color.rgb,result,vCameraColorGradingInfos.x);\nreturn color;\n}",colorGradingDefinition:"uniform sampler2D cameraColorGrading2DSampler;\nuniform vec4 vCameraColorGradingInfos;\nuniform vec4 vCameraColorGradingScaleOffset;",fogFragment:"#ifdef FOG\nfloat fog=CalcFogFactor();\ncolor.rgb=fog*color.rgb+(1.0-fog)*vFogColor;\n#endif",fogFragmentDeclaration:"#ifdef FOG\n#define FOGMODE_NONE 0.\n#define FOGMODE_EXP 1.\n#define FOGMODE_EXP2 2.\n#define FOGMODE_LINEAR 3.\n#define E 2.71828\nuniform vec4 vFogInfos;\nuniform vec3 vFogColor;\nvarying float fFogDistance;\nfloat CalcFogFactor()\n{\nfloat fogCoeff=1.0;\nfloat fogStart=vFogInfos.y;\nfloat fogEnd=vFogInfos.z;\nfloat fogDensity=vFogInfos.w;\nif (FOGMODE_LINEAR == vFogInfos.x)\n{\nfogCoeff=(fogEnd-fFogDistance)/(fogEnd-fogStart);\n}\nelse if (FOGMODE_EXP == vFogInfos.x)\n{\nfogCoeff=1.0/pow(E,fFogDistance*fogDensity);\n}\nelse if (FOGMODE_EXP2 == vFogInfos.x)\n{\nfogCoeff=1.0/pow(E,fFogDistance*fFogDistance*fogDensity*fogDensity);\n}\nreturn clamp(fogCoeff,0.0,1.0);\n}\n#endif",fogVertex:"#ifdef FOG\nfFogDistance=(view*worldPos).z;\n#endif",fogVertexDeclaration:"#ifdef FOG\nvarying float fFogDistance;\n#endif",fresnelFunction:"#ifdef FRESNEL\nfloat computeFresnelTerm(vec3 viewDirection,vec3 worldNormal,float bias,float power)\n{\nfloat fresnelTerm=pow(bias+abs(dot(viewDirection,worldNormal)),power);\nreturn clamp(fresnelTerm,0.,1.);\n}\n#endif",harmonicsFunctions:"#ifdef USESPHERICALFROMREFLECTIONMAP\nuniform vec3 vSphericalX;\nuniform vec3 vSphericalY;\nuniform vec3 vSphericalZ;\nuniform vec3 vSphericalXX;\nuniform vec3 vSphericalYY;\nuniform vec3 vSphericalZZ;\nuniform vec3 vSphericalXY;\nuniform vec3 vSphericalYZ;\nuniform vec3 vSphericalZX;\nvec3 EnvironmentIrradiance(vec3 normal)\n{\n\n\n\nvec3 result =\nvSphericalX*normal.x +\nvSphericalY*normal.y +\nvSphericalZ*normal.z +\nvSphericalXX*normal.x*normal.x +\nvSphericalYY*normal.y*normal.y +\nvSphericalZZ*normal.z*normal.z +\nvSphericalYZ*normal.y*normal.z +\nvSphericalZX*normal.z*normal.x +\nvSphericalXY*normal.x*normal.y;\nreturn result.rgb;\n}\n#endif",helperFunctions:"mat3 transposeMat3(mat3 inMatrix) {\nvec3 i0=inMatrix[0];\nvec3 i1=inMatrix[1];\nvec3 i2=inMatrix[2];\nmat3 outMatrix=mat3(\nvec3(i0.x,i1.x,i2.x),\nvec3(i0.y,i1.y,i2.y),\nvec3(i0.z,i1.z,i2.z)\n);\nreturn outMatrix;\n}",instancesDeclaration:"#ifdef INSTANCES\nattribute vec4 world0;\nattribute vec4 world1;\nattribute vec4 world2;\nattribute vec4 world3;\n#else\nuniform mat4 world;\n#endif",instancesVertex:"#ifdef INSTANCES\nmat4 finalWorld=mat4(world0,world1,world2,world3);\n#else\nmat4 finalWorld=world;\n#endif",lightFragment:"#ifdef LIGHT{X}\n#ifndef SPECULARTERM\nvec3 vLightSpecular{X}=vec3(0.);\n#endif\n#ifdef SPOTLIGHT{X}\ninfo=computeSpotLighting(viewDirectionW,normalW,vLightData{X},vLightDirection{X},vLightDiffuse{X}.rgb,vLightSpecular{X},vLightDiffuse{X}.a,glossiness);\n#endif\n#ifdef HEMILIGHT{X}\ninfo=computeHemisphericLighting(viewDirectionW,normalW,vLightData{X},vLightDiffuse{X}.rgb,vLightSpecular{X},vLightGround{X},glossiness);\n#endif\n#if defined(POINTLIGHT{X}) || defined(DIRLIGHT{X})\ninfo=computeLighting(viewDirectionW,normalW,vLightData{X},vLightDiffuse{X}.rgb,vLightSpecular{X},vLightDiffuse{X}.a,glossiness);\n#endif\n#ifdef SHADOW{X}\n#ifdef SHADOWVSM{X}\nshadow=computeShadowWithVSM(vPositionFromLight{X},shadowSampler{X},shadowsInfo{X}.z,shadowsInfo{X}.x);\n#else\n#ifdef SHADOWPCF{X}\n#if defined(POINTLIGHT{X})\nshadow=computeShadowWithPCFCube(vLightData{X}.xyz,shadowSampler{X},shadowsInfo{X}.y,shadowsInfo{X}.z,shadowsInfo{X}.x);\n#else\nshadow=computeShadowWithPCF(vPositionFromLight{X},shadowSampler{X},shadowsInfo{X}.y,shadowsInfo{X}.z,shadowsInfo{X}.x);\n#endif\n#else\n#if defined(POINTLIGHT{X})\nshadow=computeShadowCube(vLightData{X}.xyz,shadowSampler{X},shadowsInfo{X}.x,shadowsInfo{X}.z);\n#else\nshadow=computeShadow(vPositionFromLight{X},shadowSampler{X},shadowsInfo{X}.x,shadowsInfo{X}.z);\n#endif\n#endif\n#endif\n#else\nshadow=1.;\n#endif\ndiffuseBase+=info.diffuse*shadow;\n#ifdef SPECULARTERM\nspecularBase+=info.specular*shadow;\n#endif\n#endif",lightFragmentDeclaration:"#ifdef LIGHT{X}\nuniform vec4 vLightData{X};\nuniform vec4 vLightDiffuse{X};\n#ifdef SPECULARTERM\nuniform vec3 vLightSpecular{X};\n#endif\n#ifdef SHADOW{X}\n#if defined(SPOTLIGHT{X}) || defined(DIRLIGHT{X})\nvarying vec4 vPositionFromLight{X};\nuniform sampler2D shadowSampler{X};\n#else\nuniform samplerCube shadowSampler{X};\n#endif\nuniform vec3 shadowsInfo{X};\n#endif\n#ifdef SPOTLIGHT{X}\nuniform vec4 vLightDirection{X};\n#endif\n#ifdef HEMILIGHT{X}\nuniform vec3 vLightGround{X};\n#endif\n#endif",lightsFragmentFunctions:"\nstruct lightingInfo\n{\nvec3 diffuse;\n#ifdef SPECULARTERM\nvec3 specular;\n#endif\n};\nlightingInfo computeLighting(vec3 viewDirectionW,vec3 vNormal,vec4 lightData,vec3 diffuseColor,vec3 specularColor,float range,float glossiness) {\nlightingInfo result;\nvec3 lightVectorW;\nfloat attenuation=1.0;\nif (lightData.w == 0.)\n{\nvec3 direction=lightData.xyz-vPositionW;\nattenuation=max(0.,1.0-length(direction)/range);\nlightVectorW=normalize(direction);\n}\nelse\n{\nlightVectorW=normalize(-lightData.xyz);\n}\n\nfloat ndl=max(0.,dot(vNormal,lightVectorW));\nresult.diffuse=ndl*diffuseColor*attenuation;\n#ifdef SPECULARTERM\n\nvec3 angleW=normalize(viewDirectionW+lightVectorW);\nfloat specComp=max(0.,dot(vNormal,angleW));\nspecComp=pow(specComp,max(1.,glossiness));\nresult.specular=specComp*specularColor*attenuation;\n#endif\nreturn result;\n}\nlightingInfo computeSpotLighting(vec3 viewDirectionW,vec3 vNormal,vec4 lightData,vec4 lightDirection,vec3 diffuseColor,vec3 specularColor,float range,float glossiness) {\nlightingInfo result;\nvec3 direction=lightData.xyz-vPositionW;\nvec3 lightVectorW=normalize(direction);\nfloat attenuation=max(0.,1.0-length(direction)/range);\n\nfloat cosAngle=max(0.,dot(-lightDirection.xyz,lightVectorW));\nif (cosAngle>=lightDirection.w)\n{\ncosAngle=max(0.,pow(cosAngle,lightData.w));\nattenuation*=cosAngle;\n\nfloat ndl=max(0.,dot(vNormal,-lightDirection.xyz));\nresult.diffuse=ndl*diffuseColor*attenuation;\n#ifdef SPECULARTERM\n\nvec3 angleW=normalize(viewDirectionW-lightDirection.xyz);\nfloat specComp=max(0.,dot(vNormal,angleW));\nspecComp=pow(specComp,max(1.,glossiness));\nresult.specular=specComp*specularColor*attenuation;\n#endif\nreturn result;\n}\nresult.diffuse=vec3(0.);\n#ifdef SPECULARTERM\nresult.specular=vec3(0.);\n#endif\nreturn result;\n}\nlightingInfo computeHemisphericLighting(vec3 viewDirectionW,vec3 vNormal,vec4 lightData,vec3 diffuseColor,vec3 specularColor,vec3 groundColor,float glossiness) {\nlightingInfo result;\n\nfloat ndl=dot(vNormal,lightData.xyz)*0.5+0.5;\nresult.diffuse=mix(groundColor,diffuseColor,ndl);\n#ifdef SPECULARTERM\n\nvec3 angleW=normalize(viewDirectionW+lightData.xyz);\nfloat specComp=max(0.,dot(vNormal,angleW));\nspecComp=pow(specComp,max(1.,glossiness));\nresult.specular=specComp*specularColor;\n#endif\nreturn result;\n}\n",logDepthDeclaration:"#ifdef LOGARITHMICDEPTH\nuniform float logarithmicDepthConstant;\nvarying float vFragmentDepth;\n#endif",logDepthFragment:"#ifdef LOGARITHMICDEPTH\ngl_FragDepthEXT=log2(vFragmentDepth)*logarithmicDepthConstant*0.5;\n#endif",logDepthVertex:"#ifdef LOGARITHMICDEPTH\nvFragmentDepth=1.0+gl_Position.w;\ngl_Position.z=log2(max(0.000001,vFragmentDepth))*logarithmicDepthConstant;\n#endif",pbrFunctions:"\n#define RECIPROCAL_PI2 0.15915494\n#define FRESNEL_MAXIMUM_ON_ROUGH 0.25\n\nconst float kPi=3.1415926535897932384626433832795;\nconst float kRougnhessToAlphaScale=0.1;\nconst float kRougnhessToAlphaOffset=0.29248125;\nfloat Square(float value)\n{\nreturn value*value;\n}\nfloat getLuminance(vec3 color)\n{\nreturn clamp(dot(color,vec3(0.2126,0.7152,0.0722)),0.,1.);\n}\nfloat convertRoughnessToAverageSlope(float roughness)\n{\n\nconst float kMinimumVariance=0.0005;\nfloat alphaG=Square(roughness)+kMinimumVariance;\nreturn alphaG;\n}\n\nfloat getMipMapIndexFromAverageSlope(float maxMipLevel,float alpha)\n{\n\n\n\n\n\n\n\nfloat mip=kRougnhessToAlphaOffset+maxMipLevel+(maxMipLevel*kRougnhessToAlphaScale*log2(alpha));\nreturn clamp(mip,0.,maxMipLevel);\n}\nfloat getMipMapIndexFromAverageSlopeWithPMREM(float maxMipLevel,float alphaG)\n{\nfloat specularPower=clamp(2./alphaG-2.,0.000001,2048.);\n\nreturn clamp(- 0.5*log2(specularPower)+5.5,0.,maxMipLevel);\n}\n\nfloat smithVisibilityG1_TrowbridgeReitzGGX(float dot,float alphaG)\n{\nfloat tanSquared=(1.0-dot*dot)/(dot*dot);\nreturn 2.0/(1.0+sqrt(1.0+alphaG*alphaG*tanSquared));\n}\nfloat smithVisibilityG_TrowbridgeReitzGGX_Walter(float NdotL,float NdotV,float alphaG)\n{\nreturn smithVisibilityG1_TrowbridgeReitzGGX(NdotL,alphaG)*smithVisibilityG1_TrowbridgeReitzGGX(NdotV,alphaG);\n}\n\n\nfloat normalDistributionFunction_TrowbridgeReitzGGX(float NdotH,float alphaG)\n{\n\n\n\nfloat a2=Square(alphaG);\nfloat d=NdotH*NdotH*(a2-1.0)+1.0;\nreturn a2/(kPi*d*d);\n}\nvec3 fresnelSchlickGGX(float VdotH,vec3 reflectance0,vec3 reflectance90)\n{\nreturn reflectance0+(reflectance90-reflectance0)*pow(clamp(1.0-VdotH,0.,1.),5.0);\n}\nvec3 FresnelSchlickEnvironmentGGX(float VdotN,vec3 reflectance0,vec3 reflectance90,float smoothness)\n{\n\nfloat weight=mix(FRESNEL_MAXIMUM_ON_ROUGH,1.0,smoothness);\nreturn reflectance0+weight*(reflectance90-reflectance0)*pow(clamp(1.0-VdotN,0.,1.),5.0);\n}\n\nvec3 computeSpecularTerm(float NdotH,float NdotL,float NdotV,float VdotH,float roughness,vec3 specularColor,vec3 reflectance90)\n{\nfloat alphaG=convertRoughnessToAverageSlope(roughness);\nfloat distribution=normalDistributionFunction_TrowbridgeReitzGGX(NdotH,alphaG);\nfloat visibility=smithVisibilityG_TrowbridgeReitzGGX_Walter(NdotL,NdotV,alphaG);\nvisibility/=(4.0*NdotL*NdotV); \nvec3 fresnel=fresnelSchlickGGX(VdotH,specularColor,reflectance90);\nfloat specTerm=max(0.,visibility*distribution)*NdotL;\nreturn fresnel*specTerm*kPi; \n}\nfloat computeDiffuseTerm(float NdotL,float NdotV,float VdotH,float roughness)\n{\n\n\nfloat diffuseFresnelNV=pow(clamp(1.0-NdotL,0.000001,1.),5.0);\nfloat diffuseFresnelNL=pow(clamp(1.0-NdotV,0.000001,1.),5.0);\nfloat diffuseFresnel90=0.5+2.0*VdotH*VdotH*roughness;\nfloat diffuseFresnelTerm =\n(1.0+(diffuseFresnel90-1.0)*diffuseFresnelNL) *\n(1.0+(diffuseFresnel90-1.0)*diffuseFresnelNV);\nreturn diffuseFresnelTerm*NdotL;\n\n\n}\nfloat adjustRoughnessFromLightProperties(float roughness,float lightRadius,float lightDistance)\n{\n#ifdef USEPHYSICALLIGHTFALLOFF\n\nfloat lightRoughness=lightRadius/lightDistance;\n\nfloat totalRoughness=clamp(lightRoughness+roughness,0.,1.);\nreturn totalRoughness;\n#else\nreturn roughness;\n#endif\n}\nfloat computeDefaultMicroSurface(float microSurface,vec3 reflectivityColor)\n{\nfloat kReflectivityNoAlphaWorkflow_SmoothnessMax=0.95;\nfloat reflectivityLuminance=getLuminance(reflectivityColor);\nfloat reflectivityLuma=sqrt(reflectivityLuminance);\nmicroSurface=reflectivityLuma*kReflectivityNoAlphaWorkflow_SmoothnessMax;\nreturn microSurface;\n}\nvec3 toLinearSpace(vec3 color)\n{\nreturn vec3(pow(color.r,2.2),pow(color.g,2.2),pow(color.b,2.2));\n}\nvec3 toGammaSpace(vec3 color)\n{\nreturn vec3(pow(color.r,1.0/2.2),pow(color.g,1.0/2.2),pow(color.b,1.0/2.2));\n}\n#ifdef CAMERATONEMAP\nvec3 toneMaps(vec3 color)\n{\ncolor=max(color,0.0);\n\ncolor.rgb=color.rgb*vCameraInfos.x;\nfloat tuning=1.5; \n\n\nvec3 tonemapped=1.0-exp2(-color.rgb*tuning); \ncolor.rgb=mix(color.rgb,tonemapped,1.0);\nreturn color;\n}\n#endif\n#ifdef CAMERACONTRAST\nvec4 contrasts(vec4 color)\n{\ncolor=clamp(color,0.0,1.0);\nvec3 resultHighContrast=color.rgb*color.rgb*(3.0-2.0*color.rgb);\nfloat contrast=vCameraInfos.y;\nif (contrast<1.0)\n{\n\ncolor.rgb=mix(vec3(0.5,0.5,0.5),color.rgb,contrast);\n}\nelse\n{\n\ncolor.rgb=mix(color.rgb,resultHighContrast,contrast-1.0);\n}\nreturn color;\n}\n#endif",
pbrLightFunctions:"\nstruct lightingInfo\n{\nvec3 diffuse;\n#ifdef SPECULARTERM\nvec3 specular;\n#endif\n};\nfloat computeDistanceLightFalloff(vec3 lightOffset,float lightDistanceSquared,float range)\n{ \n#ifdef USEPHYSICALLIGHTFALLOFF\nfloat lightDistanceFalloff=1.0/((lightDistanceSquared+0.0001));\n#else\nfloat lightDistanceFalloff=max(0.,1.0-length(lightOffset)/range);\n#endif\nreturn lightDistanceFalloff;\n}\nfloat computeDirectionalLightFalloff(vec3 lightDirection,vec3 directionToLightCenterW,float lightAngle,float exponent)\n{\nfloat falloff=0.0;\n#ifdef USEPHYSICALLIGHTFALLOFF\nfloat cosHalfAngle=cos(lightAngle*0.5);\nconst float kMinusLog2ConeAngleIntensityRatio=6.64385618977; \n\n\n\n\n\nfloat concentrationKappa=kMinusLog2ConeAngleIntensityRatio/(1.0-cosHalfAngle);\n\n\nvec4 lightDirectionSpreadSG=vec4(-lightDirection*concentrationKappa,-concentrationKappa);\nfalloff=exp2(dot(vec4(directionToLightCenterW,1.0),lightDirectionSpreadSG));\n#else\nfloat cosAngle=max(0.000000000000001,dot(-lightDirection,directionToLightCenterW));\nif (cosAngle>=lightAngle)\n{\nfalloff=max(0.,pow(cosAngle,exponent));\n}\n#endif\nreturn falloff;\n}\nlightingInfo computeLighting(vec3 viewDirectionW,vec3 vNormal,vec4 lightData,vec3 diffuseColor,vec3 specularColor,float rangeRadius,float roughness,float NdotV,vec3 reflectance90,out float NdotL) {\nlightingInfo result;\nvec3 lightDirection;\nfloat attenuation=1.0;\nfloat lightDistance;\n\nif (lightData.w == 0.)\n{\nvec3 lightOffset=lightData.xyz-vPositionW;\nfloat lightDistanceSquared=dot(lightOffset,lightOffset);\nattenuation=computeDistanceLightFalloff(lightOffset,lightDistanceSquared,rangeRadius);\nlightDistance=sqrt(lightDistanceSquared);\nlightDirection=normalize(lightOffset);\n}\n\nelse\n{\nlightDistance=length(-lightData.xyz);\nlightDirection=normalize(-lightData.xyz);\n}\n\nroughness=adjustRoughnessFromLightProperties(roughness,rangeRadius,lightDistance);\n\nvec3 H=normalize(viewDirectionW+lightDirection);\nNdotL=max(0.00000000001,dot(vNormal,lightDirection));\nfloat VdotH=clamp(0.00000000001,1.0,dot(viewDirectionW,H));\nfloat diffuseTerm=computeDiffuseTerm(NdotL,NdotV,VdotH,roughness);\nresult.diffuse=diffuseTerm*diffuseColor*attenuation;\n#ifdef SPECULARTERM\n\nfloat NdotH=max(0.00000000001,dot(vNormal,H));\nvec3 specTerm=computeSpecularTerm(NdotH,NdotL,NdotV,VdotH,roughness,specularColor,reflectance90);\nresult.specular=specTerm*attenuation;\n#endif\nreturn result;\n}\nlightingInfo computeSpotLighting(vec3 viewDirectionW,vec3 vNormal,vec4 lightData,vec4 lightDirection,vec3 diffuseColor,vec3 specularColor,float rangeRadius,float roughness,float NdotV,vec3 reflectance90,out float NdotL) {\nlightingInfo result;\nvec3 lightOffset=lightData.xyz-vPositionW;\nvec3 directionToLightCenterW=normalize(lightOffset);\n\nfloat lightDistanceSquared=dot(lightOffset,lightOffset);\nfloat attenuation=computeDistanceLightFalloff(lightOffset,lightDistanceSquared,rangeRadius);\n\nfloat directionalAttenuation=computeDirectionalLightFalloff(lightDirection.xyz,directionToLightCenterW,lightDirection.w,lightData.w);\nattenuation*=directionalAttenuation;\n\nfloat lightDistance=sqrt(lightDistanceSquared);\nroughness=adjustRoughnessFromLightProperties(roughness,rangeRadius,lightDistance);\n\nvec3 H=normalize(viewDirectionW-lightDirection.xyz);\nNdotL=max(0.00000000001,dot(vNormal,-lightDirection.xyz));\nfloat VdotH=clamp(dot(viewDirectionW,H),0.00000000001,1.0);\nfloat diffuseTerm=computeDiffuseTerm(NdotL,NdotV,VdotH,roughness);\nresult.diffuse=diffuseTerm*diffuseColor*attenuation;\n#ifdef SPECULARTERM\n\nfloat NdotH=max(0.00000000001,dot(vNormal,H));\nvec3 specTerm=computeSpecularTerm(NdotH,NdotL,NdotV,VdotH,roughness,specularColor,reflectance90);\nresult.specular=specTerm*attenuation;\n#endif\nreturn result;\n}\nlightingInfo computeHemisphericLighting(vec3 viewDirectionW,vec3 vNormal,vec4 lightData,vec3 diffuseColor,vec3 specularColor,vec3 groundColor,float roughness,float NdotV,vec3 reflectance90,out float NdotL) {\nlightingInfo result;\n\n\n\nNdotL=dot(vNormal,lightData.xyz)*0.5+0.5;\nresult.diffuse=mix(groundColor,diffuseColor,NdotL);\n#ifdef SPECULARTERM\n\nvec3 lightVectorW=normalize(lightData.xyz);\nvec3 H=normalize(viewDirectionW+lightVectorW);\nfloat NdotH=max(0.00000000001,dot(vNormal,H));\nNdotL=max(0.00000000001,NdotL);\nfloat VdotH=clamp(0.00000000001,1.0,dot(viewDirectionW,H));\nvec3 specTerm=computeSpecularTerm(NdotH,NdotL,NdotV,VdotH,roughness,specularColor,reflectance90);\nresult.specular=specTerm;\n#endif\nreturn result;\n}",pbrLightFunctionsCall:"#ifdef LIGHT{X}\n#ifndef SPECULARTERM\nvec3 vLightSpecular{X}=vec3(0.0);\n#endif\n#ifdef SPOTLIGHT{X}\ninfo=computeSpotLighting(viewDirectionW,normalW,vLightData{X},vLightDirection{X},vLightDiffuse{X}.rgb,vLightSpecular{X},vLightDiffuse{X}.a,roughness,NdotV,specularEnvironmentR90,NdotL);\n#endif\n#ifdef HEMILIGHT{X}\ninfo=computeHemisphericLighting(viewDirectionW,normalW,vLightData{X},vLightDiffuse{X}.rgb,vLightSpecular{X},vLightGround{X},roughness,NdotV,specularEnvironmentR90,NdotL);\n#endif\n#if defined(POINTLIGHT{X}) || defined(DIRLIGHT{X})\ninfo=computeLighting(viewDirectionW,normalW,vLightData{X},vLightDiffuse{X}.rgb,vLightSpecular{X},vLightDiffuse{X}.a,roughness,NdotV,specularEnvironmentR90,NdotL);\n#endif\n#ifdef SHADOW{X}\n#ifdef SHADOWVSM{X}\nnotShadowLevel=computeShadowWithVSM(vPositionFromLight{X},shadowSampler{X},shadowsInfo{X}.z,shadowsInfo{X}.x);\n#else\n#ifdef SHADOWPCF{X}\n#if defined(POINTLIGHT{X})\nnotShadowLevel=computeShadowWithPCFCube(vLightData{X}.xyz,shadowSampler{X},shadowsInfo{X}.y,shadowsInfo{X}.z,shadowsInfo{X}.x);\n#else\nnotShadowLevel=computeShadowWithPCF(vPositionFromLight{X},shadowSampler{X},shadowsInfo{X}.y,shadowsInfo{X}.z,shadowsInfo{X}.x);\n#endif\n#else\n#if defined(POINTLIGHT{X})\nnotShadowLevel=computeShadowCube(vLightData{X}.xyz,shadowSampler{X},shadowsInfo{X}.x,shadowsInfo{X}.z);\n#else\nnotShadowLevel=computeShadow(vPositionFromLight{X},shadowSampler{X},shadowsInfo{X}.x,shadowsInfo{X}.z);\n#endif\n#endif\n#endif\n#else\nnotShadowLevel=1.;\n#endif\nlightDiffuseContribution+=info.diffuse*notShadowLevel;\n#ifdef OVERLOADEDSHADOWVALUES\nif (NdotL<0.000000000011)\n{\nnotShadowLevel=1.;\n}\nshadowedOnlyLightDiffuseContribution*=notShadowLevel;\n#endif\n#ifdef SPECULARTERM\nlightSpecularContribution+=info.specular*notShadowLevel;\n#endif\n#endif",pbrShadowFunctions:"\n#ifdef SHADOWS\nfloat unpack(vec4 color)\n{\nconst vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);\nreturn dot(color,bit_shift);\n}\nuniform vec2 depthValues;\nfloat computeShadowCube(vec3 lightPosition,samplerCube shadowSampler,float darkness,float bias)\n{\nvec3 directionToLight=vPositionW-lightPosition;\nfloat depth=length(directionToLight);\ndepth=clamp(depth,0.,1.0);\ndirectionToLight=normalize(directionToLight);\ndirectionToLight.y =-directionToLight.y;\nfloat shadow=unpack(textureCube(shadowSampler,directionToLight))+bias;\nif (depth>shadow)\n{\n#ifdef OVERLOADEDSHADOWVALUES\nreturn mix(1.0,darkness,vOverloadedShadowIntensity.x);\n#else\nreturn darkness;\n#endif\n}\nreturn 1.0;\n}\nfloat computeShadowWithPCFCube(vec3 lightPosition,samplerCube shadowSampler,float mapSize,float bias,float darkness)\n{\nvec3 directionToLight=vPositionW-lightPosition;\nfloat depth=length(directionToLight);\ndepth=(depth-depthValues.x)/(depthValues.y-depthValues.x);\ndepth=clamp(depth,0.,1.0);\ndirectionToLight=normalize(directionToLight);\ndirectionToLight.y=-directionToLight.y;\nfloat visibility=1.;\nvec3 poissonDisk[4];\npoissonDisk[0]=vec3(-1.0,1.0,-1.0);\npoissonDisk[1]=vec3(1.0,-1.0,-1.0);\npoissonDisk[2]=vec3(-1.0,-1.0,-1.0);\npoissonDisk[3]=vec3(1.0,-1.0,1.0);\n\nfloat biasedDepth=depth-bias;\nif (unpack(textureCube(shadowSampler,directionToLight+poissonDisk[0]*mapSize))<biasedDepth) visibility-=0.25;\nif (unpack(textureCube(shadowSampler,directionToLight+poissonDisk[1]*mapSize))<biasedDepth) visibility-=0.25;\nif (unpack(textureCube(shadowSampler,directionToLight+poissonDisk[2]*mapSize))<biasedDepth) visibility-=0.25;\nif (unpack(textureCube(shadowSampler,directionToLight+poissonDisk[3]*mapSize))<biasedDepth) visibility-=0.25;\n#ifdef OVERLOADEDSHADOWVALUES\nreturn min(1.0,mix(1.0,visibility+darkness,vOverloadedShadowIntensity.x));\n#else\nreturn min(1.0,visibility+darkness);\n#endif\n}\nfloat computeShadow(vec4 vPositionFromLight,sampler2D shadowSampler,float darkness,float bias)\n{\nvec3 depth=vPositionFromLight.xyz/vPositionFromLight.w;\ndepth=0.5*depth+vec3(0.5);\nvec2 uv=depth.xy;\nif (uv.x<0. || uv.x>1.0 || uv.y<0. || uv.y>1.0)\n{\nreturn 1.0;\n}\nfloat shadow=unpack(texture2D(shadowSampler,uv))+bias;\nif (depth.z>shadow)\n{\n#ifdef OVERLOADEDSHADOWVALUES\nreturn mix(1.0,darkness,vOverloadedShadowIntensity.x);\n#else\nreturn darkness;\n#endif\n}\nreturn 1.;\n}\nfloat computeShadowWithPCF(vec4 vPositionFromLight,sampler2D shadowSampler,float mapSize,float bias,float darkness)\n{\nvec3 depth=vPositionFromLight.xyz/vPositionFromLight.w;\ndepth=0.5*depth+vec3(0.5);\nvec2 uv=depth.xy;\nif (uv.x<0. || uv.x>1.0 || uv.y<0. || uv.y>1.0)\n{\nreturn 1.0;\n}\nfloat visibility=1.;\nvec2 poissonDisk[4];\npoissonDisk[0]=vec2(-0.94201624,-0.39906216);\npoissonDisk[1]=vec2(0.94558609,-0.76890725);\npoissonDisk[2]=vec2(-0.094184101,-0.92938870);\npoissonDisk[3]=vec2(0.34495938,0.29387760);\n\nfloat biasedDepth=depth.z-bias;\nif (unpack(texture2D(shadowSampler,uv+poissonDisk[0]*mapSize))<biasedDepth) visibility-=0.25;\nif (unpack(texture2D(shadowSampler,uv+poissonDisk[1]*mapSize))<biasedDepth) visibility-=0.25;\nif (unpack(texture2D(shadowSampler,uv+poissonDisk[2]*mapSize))<biasedDepth) visibility-=0.25;\nif (unpack(texture2D(shadowSampler,uv+poissonDisk[3]*mapSize))<biasedDepth) visibility-=0.25;\n#ifdef OVERLOADEDSHADOWVALUES\nreturn min(1.0,mix(1.0,visibility+darkness,vOverloadedShadowIntensity.x));\n#else\nreturn min(1.0,visibility+darkness);\n#endif\n}\n\nfloat unpackHalf(vec2 color)\n{\nreturn color.x+(color.y/255.0);\n}\nfloat linstep(float low,float high,float v) {\nreturn clamp((v-low)/(high-low),0.0,1.0);\n}\nfloat ChebychevInequality(vec2 moments,float compare,float bias)\n{\nfloat p=smoothstep(compare-bias,compare,moments.x);\nfloat variance=max(moments.y-moments.x*moments.x,0.02);\nfloat d=compare-moments.x;\nfloat p_max=linstep(0.2,1.0,variance/(variance+d*d));\nreturn clamp(max(p,p_max),0.0,1.0);\n}\nfloat computeShadowWithVSM(vec4 vPositionFromLight,sampler2D shadowSampler,float bias,float darkness)\n{\nvec3 depth=vPositionFromLight.xyz/vPositionFromLight.w;\ndepth=0.5*depth+vec3(0.5);\nvec2 uv=depth.xy;\nif (uv.x<0. || uv.x>1.0 || uv.y<0. || uv.y>1.0 || depth.z>=1.0)\n{\nreturn 1.0;\n}\nvec4 texel=texture2D(shadowSampler,uv);\nvec2 moments=vec2(unpackHalf(texel.xy),unpackHalf(texel.zw));\n#ifdef OVERLOADEDSHADOWVALUES\nreturn min(1.0,mix(1.0,1.0-ChebychevInequality(moments,depth.z,bias)+darkness,vOverloadedShadowIntensity.x));\n#else\nreturn min(1.0,1.0-ChebychevInequality(moments,depth.z,bias)+darkness);\n#endif\n}\n#endif",pointCloudVertex:"#ifdef POINTSIZE\ngl_PointSize=pointSize;\n#endif",pointCloudVertexDeclaration:"#ifdef POINTSIZE\nuniform float pointSize;\n#endif",reflectionFunction:"vec3 computeReflectionCoords(vec4 worldPos,vec3 worldNormal)\n{\n#ifdef REFLECTIONMAP_EQUIRECTANGULAR_FIXED\nvec3 direction=normalize(vDirectionW);\nfloat t=clamp(direction.y*-0.5+0.5,0.,1.0);\nfloat s=atan(direction.z,direction.x)*RECIPROCAL_PI2+0.5;\nreturn vec3(s,t,0);\n#endif\n#ifdef REFLECTIONMAP_EQUIRECTANGULAR\nvec3 cameraToVertex=normalize(worldPos.xyz-vEyePosition);\nvec3 r=reflect(cameraToVertex,worldNormal);\nfloat t=clamp(r.y*-0.5+0.5,0.,1.0);\nfloat s=atan(r.z,r.x)*RECIPROCAL_PI2+0.5;\nreturn vec3(s,t,0);\n#endif\n#ifdef REFLECTIONMAP_SPHERICAL\nvec3 viewDir=normalize(vec3(view*worldPos));\nvec3 viewNormal=normalize(vec3(view*vec4(worldNormal,0.0)));\nvec3 r=reflect(viewDir,viewNormal);\nr.z=r.z-1.0;\nfloat m=2.0*length(r);\nreturn vec3(r.x/m+0.5,1.0-r.y/m-0.5,0);\n#endif\n#ifdef REFLECTIONMAP_PLANAR\nvec3 viewDir=worldPos.xyz-vEyePosition;\nvec3 coords=normalize(reflect(viewDir,worldNormal));\nreturn vec3(reflectionMatrix*vec4(coords,1));\n#endif\n#ifdef REFLECTIONMAP_CUBIC\nvec3 viewDir=worldPos.xyz-vEyePosition;\nvec3 coords=reflect(viewDir,worldNormal);\n#ifdef INVERTCUBICMAP\ncoords.y=1.0-coords.y;\n#endif\nreturn vec3(reflectionMatrix*vec4(coords,0));\n#endif\n#ifdef REFLECTIONMAP_PROJECTION\nreturn vec3(reflectionMatrix*(view*worldPos));\n#endif\n#ifdef REFLECTIONMAP_SKYBOX\nreturn vPositionUVW;\n#endif\n#ifdef REFLECTIONMAP_EXPLICIT\nreturn vec3(0,0,0);\n#endif\n}",shadowsFragmentFunctions:"#ifdef SHADOWS\nfloat unpack(vec4 color)\n{\nconst vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);\nreturn dot(color,bit_shift);\n}\nuniform vec2 depthValues;\nfloat computeShadowCube(vec3 lightPosition,samplerCube shadowSampler,float darkness,float bias)\n{\nvec3 directionToLight=vPositionW-lightPosition;\nfloat depth=length(directionToLight);\ndepth=(depth-depthValues.x)/(depthValues.y-depthValues.x);\ndepth=clamp(depth,0.,1.0);\ndirectionToLight=normalize(directionToLight);\ndirectionToLight.y=-directionToLight.y;\nfloat shadow=unpack(textureCube(shadowSampler,directionToLight))+bias;\nif (depth>shadow)\n{\nreturn darkness;\n}\nreturn 1.0;\n}\nfloat computeShadowWithPCFCube(vec3 lightPosition,samplerCube shadowSampler,float mapSize,float bias,float darkness)\n{\nvec3 directionToLight=vPositionW-lightPosition;\nfloat depth=length(directionToLight);\ndepth=(depth-depthValues.x)/(depthValues.y-depthValues.x);\ndepth=clamp(depth,0.,1.0);\ndirectionToLight=normalize(directionToLight);\ndirectionToLight.y=-directionToLight.y;\nfloat visibility=1.;\nvec3 poissonDisk[4];\npoissonDisk[0]=vec3(-1.0,1.0,-1.0);\npoissonDisk[1]=vec3(1.0,-1.0,-1.0);\npoissonDisk[2]=vec3(-1.0,-1.0,-1.0);\npoissonDisk[3]=vec3(1.0,-1.0,1.0);\n\nfloat biasedDepth=depth-bias;\nif (unpack(textureCube(shadowSampler,directionToLight+poissonDisk[0]*mapSize))<biasedDepth) visibility-=0.25;\nif (unpack(textureCube(shadowSampler,directionToLight+poissonDisk[1]*mapSize))<biasedDepth) visibility-=0.25;\nif (unpack(textureCube(shadowSampler,directionToLight+poissonDisk[2]*mapSize))<biasedDepth) visibility-=0.25;\nif (unpack(textureCube(shadowSampler,directionToLight+poissonDisk[3]*mapSize))<biasedDepth) visibility-=0.25;\nreturn min(1.0,visibility+darkness);\n}\nfloat computeShadow(vec4 vPositionFromLight,sampler2D shadowSampler,float darkness,float bias)\n{\nvec3 depth=vPositionFromLight.xyz/vPositionFromLight.w;\ndepth=0.5*depth+vec3(0.5);\nvec2 uv=depth.xy;\nif (uv.x<0. || uv.x>1.0 || uv.y<0. || uv.y>1.0)\n{\nreturn 1.0;\n}\nfloat shadow=unpack(texture2D(shadowSampler,uv))+bias;\nif (depth.z>shadow)\n{\nreturn darkness;\n}\nreturn 1.;\n}\nfloat computeShadowWithPCF(vec4 vPositionFromLight,sampler2D shadowSampler,float mapSize,float bias,float darkness)\n{\nvec3 depth=vPositionFromLight.xyz/vPositionFromLight.w;\ndepth=0.5*depth+vec3(0.5);\nvec2 uv=depth.xy;\nif (uv.x<0. || uv.x>1.0 || uv.y<0. || uv.y>1.0)\n{\nreturn 1.0;\n}\nfloat visibility=1.;\nvec2 poissonDisk[4];\npoissonDisk[0]=vec2(-0.94201624,-0.39906216);\npoissonDisk[1]=vec2(0.94558609,-0.76890725);\npoissonDisk[2]=vec2(-0.094184101,-0.92938870);\npoissonDisk[3]=vec2(0.34495938,0.29387760);\n\nfloat biasedDepth=depth.z-bias;\nif (unpack(texture2D(shadowSampler,uv+poissonDisk[0]*mapSize))<biasedDepth) visibility-=0.25;\nif (unpack(texture2D(shadowSampler,uv+poissonDisk[1]*mapSize))<biasedDepth) visibility-=0.25;\nif (unpack(texture2D(shadowSampler,uv+poissonDisk[2]*mapSize))<biasedDepth) visibility-=0.25;\nif (unpack(texture2D(shadowSampler,uv+poissonDisk[3]*mapSize))<biasedDepth) visibility-=0.25;\nreturn min(1.0,visibility+darkness);\n}\n\nfloat unpackHalf(vec2 color)\n{\nreturn color.x+(color.y/255.0);\n}\nfloat linstep(float low,float high,float v) {\nreturn clamp((v-low)/(high-low),0.0,1.0);\n}\nfloat ChebychevInequality(vec2 moments,float compare,float bias)\n{\nfloat p=smoothstep(compare-bias,compare,moments.x);\nfloat variance=max(moments.y-moments.x*moments.x,0.02);\nfloat d=compare-moments.x;\nfloat p_max=linstep(0.2,1.0,variance/(variance+d*d));\nreturn clamp(max(p,p_max),0.0,1.0);\n}\nfloat computeShadowWithVSM(vec4 vPositionFromLight,sampler2D shadowSampler,float bias,float darkness)\n{\nvec3 depth=vPositionFromLight.xyz/vPositionFromLight.w;\ndepth=0.5*depth+vec3(0.5);\nvec2 uv=depth.xy;\nif (uv.x<0. || uv.x>1.0 || uv.y<0. || uv.y>1.0 || depth.z>=1.0)\n{\nreturn 1.0;\n}\nvec4 texel=texture2D(shadowSampler,uv);\nvec2 moments=vec2(unpackHalf(texel.xy),unpackHalf(texel.zw));\nreturn min(1.0,1.0-ChebychevInequality(moments,depth.z,bias)+darkness);\n}\n#endif",shadowsVertex:"#ifdef SHADOWS\n#if defined(SPOTLIGHT{X}) || defined(DIRLIGHT{X})\nvPositionFromLight{X}=lightMatrix{X}*worldPos;\n#endif\n#endif",shadowsVertexDeclaration:"#ifdef SHADOWS\n#if defined(SPOTLIGHT{X}) || defined(DIRLIGHT{X})\nuniform mat4 lightMatrix{X};\nvarying vec4 vPositionFromLight{X};\n#endif\n#endif\n"},BABYLON.CollisionWorker='var BABYLON;!function(t){var e=function(t,e,o,i){return t.x>o.x+i?!1:o.x-i>e.x?!1:t.y>o.y+i?!1:o.y-i>e.y?!1:t.z>o.z+i?!1:!(o.z-i>e.z)},o=function(t,e,o,i){var s=e*e-4*t*o,r={root:0,found:!1};if(0>s)return r;var n=Math.sqrt(s),c=(-e-n)/(2*t),h=(-e+n)/(2*t);if(c>h){var a=h;h=c,c=a}return c>0&&i>c?(r.root=c,r.found=!0,r):h>0&&i>h?(r.root=h,r.found=!0,r):r},i=function(){function i(){this.radius=new t.Vector3(1,1,1),this.retry=0,this.basePointWorld=t.Vector3.Zero(),this.velocityWorld=t.Vector3.Zero(),this.normalizedVelocity=t.Vector3.Zero(),this._collisionPoint=t.Vector3.Zero(),this._planeIntersectionPoint=t.Vector3.Zero(),this._tempVector=t.Vector3.Zero(),this._tempVector2=t.Vector3.Zero(),this._tempVector3=t.Vector3.Zero(),this._tempVector4=t.Vector3.Zero(),this._edge=t.Vector3.Zero(),this._baseToVertex=t.Vector3.Zero(),this._destinationPoint=t.Vector3.Zero(),this._slidePlaneNormal=t.Vector3.Zero(),this._displacementVector=t.Vector3.Zero()}return i.prototype._initialize=function(e,o,i){this.velocity=o,t.Vector3.NormalizeToRef(o,this.normalizedVelocity),this.basePoint=e,e.multiplyToRef(this.radius,this.basePointWorld),o.multiplyToRef(this.radius,this.velocityWorld),this.velocityWorldLength=this.velocityWorld.length(),this.epsilon=i,this.collisionFound=!1},i.prototype._checkPointInTriangle=function(e,o,i,s,r){o.subtractToRef(e,this._tempVector),i.subtractToRef(e,this._tempVector2),t.Vector3.CrossToRef(this._tempVector,this._tempVector2,this._tempVector4);var n=t.Vector3.Dot(this._tempVector4,r);return 0>n?!1:(s.subtractToRef(e,this._tempVector3),t.Vector3.CrossToRef(this._tempVector2,this._tempVector3,this._tempVector4),n=t.Vector3.Dot(this._tempVector4,r),0>n?!1:(t.Vector3.CrossToRef(this._tempVector3,this._tempVector,this._tempVector4),n=t.Vector3.Dot(this._tempVector4,r),n>=0))},i.prototype._canDoCollision=function(o,i,s,r){var n=t.Vector3.Distance(this.basePointWorld,o),c=Math.max(this.radius.x,this.radius.y,this.radius.z);return n>this.velocityWorldLength+c+i?!1:!!e(s,r,this.basePointWorld,this.velocityWorldLength+c)},i.prototype._testTriangle=function(e,i,s,r,n,c){var h,a=!1;i||(i=[]),i[e]||(i[e]=new t.Plane(0,0,0,0),i[e].copyFromPoints(s,r,n));var l=i[e];if(c||l.isFrontFacingTo(this.normalizedVelocity,0)){var _=l.signedDistanceTo(this.basePoint),d=t.Vector3.Dot(l.normal,this.velocity);if(0==d){if(Math.abs(_)>=1)return;a=!0,h=0}else{h=(-1-_)/d;var V=(1-_)/d;if(h>V){var u=V;V=h,h=u}if(h>1||0>V)return;0>h&&(h=0),h>1&&(h=1)}this._collisionPoint.copyFromFloats(0,0,0);var P=!1,p=1;if(a||(this.basePoint.subtractToRef(l.normal,this._planeIntersectionPoint),this.velocity.scaleToRef(h,this._tempVector),this._planeIntersectionPoint.addInPlace(this._tempVector),this._checkPointInTriangle(this._planeIntersectionPoint,s,r,n,l.normal)&&(P=!0,p=h,this._collisionPoint.copyFrom(this._planeIntersectionPoint))),!P){var m=this.velocity.lengthSquared(),f=m;this.basePoint.subtractToRef(s,this._tempVector);var T=2*t.Vector3.Dot(this.velocity,this._tempVector),b=this._tempVector.lengthSquared()-1,y=o(f,T,b,p);y.found&&(p=y.root,P=!0,this._collisionPoint.copyFrom(s)),this.basePoint.subtractToRef(r,this._tempVector),T=2*t.Vector3.Dot(this.velocity,this._tempVector),b=this._tempVector.lengthSquared()-1,y=o(f,T,b,p),y.found&&(p=y.root,P=!0,this._collisionPoint.copyFrom(r)),this.basePoint.subtractToRef(n,this._tempVector),T=2*t.Vector3.Dot(this.velocity,this._tempVector),b=this._tempVector.lengthSquared()-1,y=o(f,T,b,p),y.found&&(p=y.root,P=!0,this._collisionPoint.copyFrom(n)),r.subtractToRef(s,this._edge),s.subtractToRef(this.basePoint,this._baseToVertex);var g=this._edge.lengthSquared(),v=t.Vector3.Dot(this._edge,this.velocity),R=t.Vector3.Dot(this._edge,this._baseToVertex);if(f=g*-m+v*v,T=g*(2*t.Vector3.Dot(this.velocity,this._baseToVertex))-2*v*R,b=g*(1-this._baseToVertex.lengthSquared())+R*R,y=o(f,T,b,p),y.found){var D=(v*y.root-R)/g;D>=0&&1>=D&&(p=y.root,P=!0,this._edge.scaleInPlace(D),s.addToRef(this._edge,this._collisionPoint))}n.subtractToRef(r,this._edge),r.subtractToRef(this.basePoint,this._baseToVertex),g=this._edge.lengthSquared(),v=t.Vector3.Dot(this._edge,this.velocity),R=t.Vector3.Dot(this._edge,this._baseToVertex),f=g*-m+v*v,T=g*(2*t.Vector3.Dot(this.velocity,this._baseToVertex))-2*v*R,b=g*(1-this._baseToVertex.lengthSquared())+R*R,y=o(f,T,b,p),y.found&&(D=(v*y.root-R)/g,D>=0&&1>=D&&(p=y.root,P=!0,this._edge.scaleInPlace(D),r.addToRef(this._edge,this._collisionPoint))),s.subtractToRef(n,this._edge),n.subtractToRef(this.basePoint,this._baseToVertex),g=this._edge.lengthSquared(),v=t.Vector3.Dot(this._edge,this.velocity),R=t.Vector3.Dot(this._edge,this._baseToVertex),f=g*-m+v*v,T=g*(2*t.Vector3.Dot(this.velocity,this._baseToVertex))-2*v*R,b=g*(1-this._baseToVertex.lengthSquared())+R*R,y=o(f,T,b,p),y.found&&(D=(v*y.root-R)/g,D>=0&&1>=D&&(p=y.root,P=!0,this._edge.scaleInPlace(D),n.addToRef(this._edge,this._collisionPoint)))}if(P){var x=p*this.velocity.length();(!this.collisionFound||x<this.nearestDistance)&&(this.intersectionPoint?this.intersectionPoint.copyFrom(this._collisionPoint):this.intersectionPoint=this._collisionPoint.clone(),this.nearestDistance=x,this.collisionFound=!0)}}},i.prototype._collide=function(t,e,o,i,s,r,n){for(var c=i;s>c;c+=3){var h=e[o[c]-r],a=e[o[c+1]-r],l=e[o[c+2]-r];this._testTriangle(c,t,l,a,h,n)}},i.prototype._getResponse=function(e,o){e.addToRef(o,this._destinationPoint),o.scaleInPlace(this.nearestDistance/o.length()),this.basePoint.addToRef(o,e),e.subtractToRef(this.intersectionPoint,this._slidePlaneNormal),this._slidePlaneNormal.normalize(),this._slidePlaneNormal.scaleToRef(this.epsilon,this._displacementVector),e.addInPlace(this._displacementVector),this.intersectionPoint.addInPlace(this._displacementVector),this._slidePlaneNormal.scaleInPlace(t.Plane.SignedDistanceToPlaneFromPositionAndNormal(this.intersectionPoint,this._slidePlaneNormal,this._destinationPoint)),this._destinationPoint.subtractInPlace(this._slidePlaneNormal),this._destinationPoint.subtractToRef(this.intersectionPoint,o)},i}();t.Collider=i}(BABYLON||(BABYLON={}));var BABYLON;!function(o){o.WorkerIncluded=!0;var e=function(){function o(){this._meshes={},this._geometries={}}return o.prototype.getMeshes=function(){return this._meshes},o.prototype.getGeometries=function(){return this._geometries},o.prototype.getMesh=function(o){return this._meshes[o]},o.prototype.addMesh=function(o){this._meshes[o.uniqueId]=o},o.prototype.removeMesh=function(o){delete this._meshes[o]},o.prototype.getGeometry=function(o){return this._geometries[o]},o.prototype.addGeometry=function(o){this._geometries[o.id]=o},o.prototype.removeGeometry=function(o){delete this._geometries[o]},o}();o.CollisionCache=e;var i=function(){function e(e,i,r){this.collider=e,this._collisionCache=i,this.finalPosition=r,this.collisionsScalingMatrix=o.Matrix.Zero(),this.collisionTranformationMatrix=o.Matrix.Zero()}return e.prototype.collideWithWorld=function(o,e,i,r){var t=.01;if(this.collider.retry>=i)return void this.finalPosition.copyFrom(o);this.collider._initialize(o,e,t);for(var s,l=this._collisionCache.getMeshes(),n=Object.keys(l),a=n.length,c=0;a>c;++c)if(s=n[c],parseInt(s)!=r){var d=l[s];d.checkCollisions&&this.checkCollision(d)}return this.collider.collisionFound?(0===e.x&&0===e.y&&0===e.z||this.collider._getResponse(o,e),e.length()<=t?void this.finalPosition.copyFrom(o):(this.collider.retry++,void this.collideWithWorld(o,e,i,r))):void o.addToRef(e,this.finalPosition)},e.prototype.checkCollision=function(e){if(this.collider._canDoCollision(o.Vector3.FromArray(e.sphereCenter),e.sphereRadius,o.Vector3.FromArray(e.boxMinimum),o.Vector3.FromArray(e.boxMaximum))){o.Matrix.ScalingToRef(1/this.collider.radius.x,1/this.collider.radius.y,1/this.collider.radius.z,this.collisionsScalingMatrix);var i=o.Matrix.FromArray(e.worldMatrixFromCache);i.multiplyToRef(this.collisionsScalingMatrix,this.collisionTranformationMatrix),this.processCollisionsForSubMeshes(this.collisionTranformationMatrix,e)}},e.prototype.processCollisionsForSubMeshes=function(o,e){var i=e.subMeshes,r=i.length;if(!e.geometryId)return void console.log("no mesh geometry id");var t=this._collisionCache.getGeometry(e.geometryId);if(!t)return void console.log("couldn\'t find geometry",e.geometryId);for(var s=0;r>s;s++){var l=i[s];r>1&&!this.checkSubmeshCollision(l)||(this.collideForSubMesh(l,o,t),this.collider.collisionFound&&(this.collider.collidedMesh=e.uniqueId))}},e.prototype.collideForSubMesh=function(e,i,r){if(!r.positionsArray){r.positionsArray=[];for(var t=0,s=r.positions.length;s>t;t+=3){var l=o.Vector3.FromArray([r.positions[t],r.positions[t+1],r.positions[t+2]]);r.positionsArray.push(l)}}if(!e._lastColliderWorldVertices||!e._lastColliderTransformMatrix.equals(i)){e._lastColliderTransformMatrix=i.clone(),e._lastColliderWorldVertices=[],e._trianglePlanes=[];for(var n=e.verticesStart,a=e.verticesStart+e.verticesCount,t=n;a>t;t++)e._lastColliderWorldVertices.push(o.Vector3.TransformCoordinates(r.positionsArray[t],i))}this.collider._collide(e._trianglePlanes,e._lastColliderWorldVertices,r.indices,e.indexStart,e.indexStart+e.indexCount,e.verticesStart,e.hasMaterial)},e.prototype.checkSubmeshCollision=function(e){return this.collider._canDoCollision(o.Vector3.FromArray(e.sphereCenter),e.sphereRadius,o.Vector3.FromArray(e.boxMinimum),o.Vector3.FromArray(e.boxMaximum))},e}();o.CollideWorker=i;var r=function(){function r(){}return r.prototype.onInit=function(i){this._collisionCache=new e;var r={error:o.WorkerReplyType.SUCCESS,taskType:o.WorkerTaskType.INIT};postMessage(r,void 0)},r.prototype.onUpdate=function(e){var i=this,r={error:o.WorkerReplyType.SUCCESS,taskType:o.WorkerTaskType.UPDATE};try{for(var t in e.updatedGeometries)e.updatedGeometries.hasOwnProperty(t)&&this._collisionCache.addGeometry(e.updatedGeometries[t]);for(var s in e.updatedMeshes)e.updatedMeshes.hasOwnProperty(s)&&this._collisionCache.addMesh(e.updatedMeshes[s]);e.removedGeometries.forEach(function(o){i._collisionCache.removeGeometry(o)}),e.removedMeshes.forEach(function(o){i._collisionCache.removeMesh(o)})}catch(l){r.error=o.WorkerReplyType.UNKNOWN_ERROR}postMessage(r,void 0)},r.prototype.onCollision=function(e){var r=o.Vector3.Zero(),t=new o.Collider;t.radius=o.Vector3.FromArray(e.collider.radius);var s=new i(t,this._collisionCache,r);s.collideWithWorld(o.Vector3.FromArray(e.collider.position),o.Vector3.FromArray(e.collider.velocity),e.maximumRetry,e.excludedMeshUniqueId);var l={collidedMeshUniqueId:t.collidedMesh,collisionId:e.collisionId,newPosition:r.asArray()},n={error:o.WorkerReplyType.SUCCESS,taskType:o.WorkerTaskType.COLLIDE,payload:l};postMessage(n,void 0)},r}();o.CollisionDetectorTransferable=r;try{if(self&&self instanceof WorkerGlobalScope){window={},o.Collider||(importScripts("./babylon.collisionCoordinator.js"),importScripts("./babylon.collider.js"),importScripts("../Math/babylon.math.js"));var t=new r,s=function(e){var i=e.data;switch(i.taskType){case o.WorkerTaskType.INIT:t.onInit(i.payload);break;case o.WorkerTaskType.COLLIDE:t.onCollision(i.payload);break;case o.WorkerTaskType.UPDATE:t.onUpdate(i.payload)}};self.onmessage=s}}catch(l){console.log("single worker init")}}(BABYLON||(BABYLON={}));var BABYLON;!function(e){e.CollisionWorker="",function(e){e[e.INIT=0]="INIT",e[e.UPDATE=1]="UPDATE",e[e.COLLIDE=2]="COLLIDE"}(e.WorkerTaskType||(e.WorkerTaskType={}));var o=e.WorkerTaskType;!function(e){e[e.SUCCESS=0]="SUCCESS",e[e.UNKNOWN_ERROR=1]="UNKNOWN_ERROR"}(e.WorkerReplyType||(e.WorkerReplyType={}));var i=e.WorkerReplyType,t=function(){function t(){var r=this;this._scaledPosition=e.Vector3.Zero(),this._scaledVelocity=e.Vector3.Zero(),this.onMeshUpdated=function(e){r._addUpdateMeshesList[e.uniqueId]=t.SerializeMesh(e)},this.onGeometryUpdated=function(e){r._addUpdateGeometriesList[e.id]=t.SerializeGeometry(e)},this._afterRender=function(){if(r._init&&!(0==r._toRemoveGeometryArray.length&&0==r._toRemoveMeshesArray.length&&0==Object.keys(r._addUpdateGeometriesList).length&&0==Object.keys(r._addUpdateMeshesList).length||r._runningUpdated>4)){++r._runningUpdated;var e={updatedMeshes:r._addUpdateMeshesList,updatedGeometries:r._addUpdateGeometriesList,removedGeometries:r._toRemoveGeometryArray,removedMeshes:r._toRemoveMeshesArray},i={payload:e,taskType:o.UPDATE},t=[];for(var s in e.updatedGeometries)e.updatedGeometries.hasOwnProperty(s)&&(t.push(i.payload.updatedGeometries[s].indices.buffer),t.push(i.payload.updatedGeometries[s].normals.buffer),t.push(i.payload.updatedGeometries[s].positions.buffer));r._worker.postMessage(i,t),r._addUpdateMeshesList={},r._addUpdateGeometriesList={},r._toRemoveGeometryArray=[],r._toRemoveMeshesArray=[]}},this._onMessageFromWorker=function(t){var s=t.data;if(s.error!=i.SUCCESS)return void e.Tools.Warn("error returned from worker!");switch(s.taskType){case o.INIT:r._init=!0,r._scene.meshes.forEach(function(e){r.onMeshAdded(e)}),r._scene.getGeometries().forEach(function(e){r.onGeometryAdded(e)});break;case o.UPDATE:r._runningUpdated--;break;case o.COLLIDE:r._runningCollisionTask=!1;var n=s.payload;if(!r._collisionsCallbackArray[n.collisionId])return;r._collisionsCallbackArray[n.collisionId](n.collisionId,e.Vector3.FromArray(n.newPosition),r._scene.getMeshByUniqueID(n.collidedMeshUniqueId)),r._collisionsCallbackArray[n.collisionId]=void 0}},this._collisionsCallbackArray=[],this._init=!1,this._runningUpdated=0,this._runningCollisionTask=!1,this._addUpdateMeshesList={},this._addUpdateGeometriesList={},this._toRemoveGeometryArray=[],this._toRemoveMeshesArray=[]}return t.prototype.getNewPosition=function(e,i,t,r,s,n,a){if(this._init&&!this._collisionsCallbackArray[a]&&!this._collisionsCallbackArray[a+1e5]){e.divideToRef(t.radius,this._scaledPosition),i.divideToRef(t.radius,this._scaledVelocity),this._collisionsCallbackArray[a]=n;var d={collider:{position:this._scaledPosition.asArray(),velocity:this._scaledVelocity.asArray(),radius:t.radius.asArray()},collisionId:a,excludedMeshUniqueId:s?s.uniqueId:null,maximumRetry:r},l={payload:d,taskType:o.COLLIDE};this._worker.postMessage(l)}},t.prototype.init=function(i){this._scene=i,this._scene.registerAfterRender(this._afterRender);var t=e.WorkerIncluded?e.Engine.CodeRepository+"Collisions/babylon.collisionWorker.js":URL.createObjectURL(new Blob([e.CollisionWorker],{type:"application/javascript"}));this._worker=new Worker(t),this._worker.onmessage=this._onMessageFromWorker;var r={payload:{},taskType:o.INIT};this._worker.postMessage(r)},t.prototype.destroy=function(){this._scene.unregisterAfterRender(this._afterRender),this._worker.terminate()},t.prototype.onMeshAdded=function(e){e.registerAfterWorldMatrixUpdate(this.onMeshUpdated),this.onMeshUpdated(e)},t.prototype.onMeshRemoved=function(e){this._toRemoveMeshesArray.push(e.uniqueId)},t.prototype.onGeometryAdded=function(e){e.onGeometryUpdated=this.onGeometryUpdated,this.onGeometryUpdated(e)},t.prototype.onGeometryDeleted=function(e){this._toRemoveGeometryArray.push(e.id)},t.SerializeMesh=function(o){var i=[];o.subMeshes&&(i=o.subMeshes.map(function(e,o){return{position:o,verticesStart:e.verticesStart,verticesCount:e.verticesCount,indexStart:e.indexStart,indexCount:e.indexCount,hasMaterial:!!e.getMaterial(),sphereCenter:e.getBoundingInfo().boundingSphere.centerWorld.asArray(),sphereRadius:e.getBoundingInfo().boundingSphere.radiusWorld,boxMinimum:e.getBoundingInfo().boundingBox.minimumWorld.asArray(),boxMaximum:e.getBoundingInfo().boundingBox.maximumWorld.asArray()}}));var t=null;return o instanceof e.Mesh?t=o.geometry?o.geometry.id:null:o instanceof e.InstancedMesh&&(t=o.sourceMesh&&o.sourceMesh.geometry?o.sourceMesh.geometry.id:null),{uniqueId:o.uniqueId,id:o.id,name:o.name,geometryId:t,sphereCenter:o.getBoundingInfo().boundingSphere.centerWorld.asArray(),sphereRadius:o.getBoundingInfo().boundingSphere.radiusWorld,boxMinimum:o.getBoundingInfo().boundingBox.minimumWorld.asArray(),boxMaximum:o.getBoundingInfo().boundingBox.maximumWorld.asArray(),worldMatrixFromCache:o.worldMatrixFromCache.asArray(),subMeshes:i,checkCollisions:o.checkCollisions}},t.SerializeGeometry=function(o){return{id:o.id,positions:new Float32Array(o.getVerticesData(e.VertexBuffer.PositionKind)||[]),normals:new Float32Array(o.getVerticesData(e.VertexBuffer.NormalKind)||[]),indices:new Int32Array(o.getIndices()||[])}},t}();e.CollisionCoordinatorWorker=t;var r=function(){function o(){this._scaledPosition=e.Vector3.Zero(),this._scaledVelocity=e.Vector3.Zero(),this._finalPosition=e.Vector3.Zero()}return o.prototype.getNewPosition=function(e,o,i,t,r,s,n){e.divideToRef(i.radius,this._scaledPosition),o.divideToRef(i.radius,this._scaledVelocity),i.collidedMesh=null,i.retry=0,i.initialVelocity=this._scaledVelocity,i.initialPosition=this._scaledPosition,this._collideWithWorld(this._scaledPosition,this._scaledVelocity,i,t,this._finalPosition,r),this._finalPosition.multiplyInPlace(i.radius),s(n,this._finalPosition,i.collidedMesh)},o.prototype.init=function(e){this._scene=e},o.prototype.destroy=function(){},o.prototype.onMeshAdded=function(e){},o.prototype.onMeshUpdated=function(e){},o.prototype.onMeshRemoved=function(e){},o.prototype.onGeometryAdded=function(e){},o.prototype.onGeometryUpdated=function(e){},o.prototype.onGeometryDeleted=function(e){},o.prototype._collideWithWorld=function(o,i,t,r,s,n){void 0===n&&(n=null);var a=10*e.Engine.CollisionsEpsilon;if(t.retry>=r)return void s.copyFrom(o);t._initialize(o,i,a);for(var d=0;d<this._scene.meshes.length;d++){var l=this._scene.meshes[d];l.isEnabled()&&l.checkCollisions&&l.subMeshes&&l!==n&&l._checkCollision(t)}return t.collisionFound?(0===i.x&&0===i.y&&0===i.z||t._getResponse(o,i),i.length()<=a?void s.copyFrom(o):(t.retry++,void this._collideWithWorld(o,i,t,r,s,n))):void o.addToRef(i,s)},o}();e.CollisionCoordinatorLegacy=r}(BABYLON||(BABYLON={}));var BABYLON;!function(t){t.ToGammaSpace=1/2.2,t.ToLinearSpace=2.2,t.Epsilon=.001;var i=function(){function t(){}return t.WithinEpsilon=function(t,i,n){void 0===n&&(n=1.401298e-45);var r=t-i;return r>=-n&&n>=r},t.ToHex=function(t){var i=t.toString(16);return 15>=t?("0"+i).toUpperCase():i.toUpperCase()},t.Sign=function(t){return t=+t,0===t||isNaN(t)?t:t>0?1:-1},t.Clamp=function(t,i,n){return void 0===i&&(i=0),void 0===n&&(n=1),Math.min(n,Math.max(i,t))},t}();t.MathTools=i;var n=function(){function n(t,i,n){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=0),this.r=t,this.g=i,this.b=n}return n.prototype.toString=function(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+"}"},n.prototype.getClassName=function(){return"Color3"},n.prototype.getHashCode=function(){var t=this.r||0;return t=397*t^(this.g||0),t=397*t^(this.b||0)},n.prototype.toArray=function(t,i){return void 0===i&&(i=0),t[i]=this.r,t[i+1]=this.g,t[i+2]=this.b,this},n.prototype.toColor4=function(t){return void 0===t&&(t=1),new r(this.r,this.g,this.b,t)},n.prototype.asArray=function(){var t=[];return this.toArray(t,0),t},n.prototype.toLuminance=function(){return.3*this.r+.59*this.g+.11*this.b},n.prototype.multiply=function(t){return new n(this.r*t.r,this.g*t.g,this.b*t.b)},n.prototype.multiplyToRef=function(t,i){return i.r=this.r*t.r,i.g=this.g*t.g,i.b=this.b*t.b,this},n.prototype.equals=function(t){return t&&this.r===t.r&&this.g===t.g&&this.b===t.b},n.prototype.equalsFloats=function(t,i,n){return this.r===t&&this.g===i&&this.b===n},n.prototype.scale=function(t){return new n(this.r*t,this.g*t,this.b*t)},n.prototype.scaleToRef=function(t,i){return i.r=this.r*t,i.g=this.g*t,i.b=this.b*t,this},n.prototype.add=function(t){return new n(this.r+t.r,this.g+t.g,this.b+t.b)},n.prototype.addToRef=function(t,i){return i.r=this.r+t.r,i.g=this.g+t.g,i.b=this.b+t.b,this},n.prototype.subtract=function(t){return new n(this.r-t.r,this.g-t.g,this.b-t.b)},n.prototype.subtractToRef=function(t,i){return i.r=this.r-t.r,i.g=this.g-t.g,i.b=this.b-t.b,this},n.prototype.clone=function(){return new n(this.r,this.g,this.b)},n.prototype.copyFrom=function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},n.prototype.copyFromFloats=function(t,i,n){return this.r=t,this.g=i,this.b=n,this},n.prototype.toHexString=function(){var t=255*this.r|0,n=255*this.g|0,r=255*this.b|0;return"#"+i.ToHex(t)+i.ToHex(n)+i.ToHex(r)},n.prototype.toLinearSpace=function(){var t=new n;return this.toLinearSpaceToRef(t),t},n.prototype.toLinearSpaceToRef=function(i){return i.r=Math.pow(this.r,t.ToLinearSpace),i.g=Math.pow(this.g,t.ToLinearSpace),i.b=Math.pow(this.b,t.ToLinearSpace),this},n.prototype.toGammaSpace=function(){var t=new n;return this.toGammaSpaceToRef(t),t},n.prototype.toGammaSpaceToRef=function(i){return i.r=Math.pow(this.r,t.ToGammaSpace),i.g=Math.pow(this.g,t.ToGammaSpace),i.b=Math.pow(this.b,t.ToGammaSpace),this},n.FromHexString=function(t){if("#"!==t.substring(0,1)||7!==t.length)return new n(0,0,0);var i=parseInt(t.substring(1,3),16),r=parseInt(t.substring(3,5),16),o=parseInt(t.substring(5,7),16);return n.FromInts(i,r,o)},n.FromArray=function(t,i){return void 0===i&&(i=0),new n(t[i],t[i+1],t[i+2])},n.FromInts=function(t,i,r){return new n(t/255,i/255,r/255)},n.Lerp=function(t,i,r){var o=t.r+(i.r-t.r)*r,s=t.g+(i.g-t.g)*r,e=t.b+(i.b-t.b)*r;return new n(o,s,e)},n.Red=function(){return new n(1,0,0)},n.Green=function(){return new n(0,1,0)},n.Blue=function(){return new n(0,0,1)},n.Black=function(){return new n(0,0,0)},n.White=function(){return new n(1,1,1)},n.Purple=function(){return new n(.5,0,.5)},n.Magenta=function(){return new n(1,0,1)},n.Yellow=function(){return new n(1,1,0)},n.Gray=function(){return new n(.5,.5,.5)},n}();t.Color3=n;var r=function(){function t(t,i,n,r){this.r=t,this.g=i,this.b=n,this.a=r}return t.prototype.addInPlace=function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this.a+=t.a,this},t.prototype.asArray=function(){var t=[];return this.toArray(t,0),t},t.prototype.toArray=function(t,i){return void 0===i&&(i=0),t[i]=this.r,t[i+1]=this.g,t[i+2]=this.b,t[i+3]=this.a,this},t.prototype.add=function(i){return new t(this.r+i.r,this.g+i.g,this.b+i.b,this.a+i.a)},t.prototype.subtract=function(i){return new t(this.r-i.r,this.g-i.g,this.b-i.b,this.a-i.a)},t.prototype.subtractToRef=function(t,i){return i.r=this.r-t.r,i.g=this.g-t.g,i.b=this.b-t.b,i.a=this.a-t.a,this},t.prototype.scale=function(i){return new t(this.r*i,this.g*i,this.b*i,this.a*i)},t.prototype.scaleToRef=function(t,i){return i.r=this.r*t,i.g=this.g*t,i.b=this.b*t,i.a=this.a*t,this},t.prototype.multiply=function(i){return new t(this.r*i.r,this.g*i.g,this.b*i.b,this.a*i.a)},t.prototype.multiplyToRef=function(t,i){return i.r=this.r*t.r,i.g=this.g*t.g,i.b=this.b*t.b,i.a=this.a*t.a,i},t.prototype.toString=function(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+" A:"+this.a+"}"},t.prototype.getClassName=function(){return"Color4"},t.prototype.getHashCode=function(){var t=this.r||0;return t=397*t^(this.g||0),t=397*t^(this.b||0),t=397*t^(this.a||0)},t.prototype.clone=function(){return new t(this.r,this.g,this.b,this.a)},t.prototype.copyFrom=function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this},t.prototype.toHexString=function(){var t=255*this.r|0,n=255*this.g|0,r=255*this.b|0,o=255*this.a|0;return"#"+i.ToHex(t)+i.ToHex(n)+i.ToHex(r)+i.ToHex(o)},t.FromHexString=function(i){if("#"!==i.substring(0,1)||9!==i.length)return new t(0,0,0,0);var n=parseInt(i.substring(1,3),16),r=parseInt(i.substring(3,5),16),o=parseInt(i.substring(5,7),16),s=parseInt(i.substring(7,9),16);return t.FromInts(n,r,o,s)},t.Lerp=function(i,n,r){var o=new t(0,0,0,0);return t.LerpToRef(i,n,r,o),o},t.LerpToRef=function(t,i,n,r){r.r=t.r+(i.r-t.r)*n,r.g=t.g+(i.g-t.g)*n,r.b=t.b+(i.b-t.b)*n,r.a=t.a+(i.a-t.a)*n},t.FromArray=function(i,n){return void 0===n&&(n=0),new t(i[n],i[n+1],i[n+2],i[n+3])},t.FromInts=function(i,n,r,o){return new t(i/255,n/255,r/255,o/255)},t.CheckColors4=function(t,i){if(t.length===3*i){for(var n=[],r=0;r<t.length;r+=3){var o=r/3*4;n[o]=t[r],n[o+1]=t[r+1],n[o+2]=t[r+2],n[o+3]=1}return n}return t},t}();t.Color4=r;var o=function(){function n(t,i){this.x=t,this.y=i}return n.prototype.toString=function(){return"{X: "+this.x+" Y:"+this.y+"}"},n.prototype.getClassName=function(){return"Vector2"},n.prototype.getHashCode=function(){var t=this.x||0;return t=397*t^(this.y||0)},n.prototype.toArray=function(t,i){return void 0===i&&(i=0),t[i]=this.x,t[i+1]=this.y,this},n.prototype.asArray=function(){var t=[];return this.toArray(t,0),t},n.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this},n.prototype.copyFromFloats=function(t,i){return this.x=t,this.y=i,this},n.prototype.add=function(t){return new n(this.x+t.x,this.y+t.y)},n.prototype.addToRef=function(t,i){return i.x=this.x+t.x,i.y=this.y+t.y,this},n.prototype.addVector3=function(t){return new n(this.x+t.x,this.y+t.y)},n.prototype.subtract=function(t){return new n(this.x-t.x,this.y-t.y)},n.prototype.subtractToRef=function(t,i){return i.x=this.x-t.x,i.y=this.y-t.y,this},n.prototype.subtractInPlace=function(t){return this.x-=t.x,this.y-=t.y,this},n.prototype.multiplyInPlace=function(t){return this.x*=t.x,this.y*=t.y,this},n.prototype.multiply=function(t){return new n(this.x*t.x,this.y*t.y)},n.prototype.multiplyToRef=function(t,i){return i.x=this.x*t.x,i.y=this.y*t.y,this},n.prototype.multiplyByFloats=function(t,i){return new n(this.x*t,this.y*i)},n.prototype.divide=function(t){return new n(this.x/t.x,this.y/t.y)},n.prototype.divideToRef=function(t,i){return i.x=this.x/t.x,i.y=this.y/t.y,this},n.prototype.negate=function(){return new n(-this.x,-this.y)},n.prototype.scaleInPlace=function(t){return this.x*=t,this.y*=t,this},n.prototype.scale=function(t){return new n(this.x*t,this.y*t)},n.prototype.equals=function(t){return t&&this.x===t.x&&this.y===t.y},n.prototype.equalsWithEpsilon=function(n,r){return void 0===r&&(r=t.Epsilon),n&&i.WithinEpsilon(this.x,n.x,r)&&i.WithinEpsilon(this.y,n.y,r)},n.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},n.prototype.lengthSquared=function(){return this.x*this.x+this.y*this.y},n.prototype.normalize=function(){var t=this.length();if(0===t)return this;var i=1/t;return this.x*=i,this.y*=i,this},n.prototype.clone=function(){return new n(this.x,this.y)},n.Zero=function(){return new n(0,0)},n.FromArray=function(t,i){return void 0===i&&(i=0),new n(t[i],t[i+1])},n.FromArrayToRef=function(t,i,n){n.x=t[i],n.y=t[i+1]},n.CatmullRom=function(t,i,r,o,s){var e=s*s,h=s*e,a=.5*(2*i.x+(-t.x+r.x)*s+(2*t.x-5*i.x+4*r.x-o.x)*e+(-t.x+3*i.x-3*r.x+o.x)*h),u=.5*(2*i.y+(-t.y+r.y)*s+(2*t.y-5*i.y+4*r.y-o.y)*e+(-t.y+3*i.y-3*r.y+o.y)*h);return new n(a,u)},n.Clamp=function(t,i,r){var o=t.x;o=o>r.x?r.x:o,o=o<i.x?i.x:o;var s=t.y;return s=s>r.y?r.y:s,s=s<i.y?i.y:s,new n(o,s)},n.Hermite=function(t,i,r,o,s){var e=s*s,h=s*e,a=2*h-3*e+1,u=-2*h+3*e,m=h-2*e+s,y=h-e,c=t.x*a+r.x*u+i.x*m+o.x*y,p=t.y*a+r.y*u+i.y*m+o.y*y;return new n(c,p)},n.Lerp=function(t,i,r){var o=t.x+(i.x-t.x)*r,s=t.y+(i.y-t.y)*r;return new n(o,s)},n.Dot=function(t,i){return t.x*i.x+t.y*i.y},n.Normalize=function(t){var i=t.clone();return i.normalize(),i},n.Minimize=function(t,i){var r=t.x<i.x?t.x:i.x,o=t.y<i.y?t.y:i.y;return new n(r,o)},n.Maximize=function(t,i){var r=t.x>i.x?t.x:i.x,o=t.y>i.y?t.y:i.y;return new n(r,o)},n.Transform=function(t,i){var r=n.Zero();return n.TransformToRef(t,i,r),r},n.TransformToRef=function(t,i,n){var r=t.x*i.m[0]+t.y*i.m[4]+i.m[12],o=t.x*i.m[1]+t.y*i.m[5]+i.m[13];n.x=r,n.y=o},n.PointInTriangle=function(t,i,n,r){var o=.5*(-n.y*r.x+i.y*(-n.x+r.x)+i.x*(n.y-r.y)+n.x*r.y),s=0>o?-1:1,e=(i.y*r.x-i.x*r.y+(r.y-i.y)*t.x+(i.x-r.x)*t.y)*s,h=(i.x*n.y-i.y*n.x+(i.y-n.y)*t.x+(n.x-i.x)*t.y)*s;return e>0&&h>0&&2*o*s>e+h},n.Distance=function(t,i){return Math.sqrt(n.DistanceSquared(t,i))},n.DistanceSquared=function(t,i){var n=t.x-i.x,r=t.y-i.y;return n*n+r*r},n.DistanceOfPointFromSegment=function(t,i,r){var o=n.DistanceSquared(i,r);if(0===o)return n.Distance(t,i);var s=r.subtract(i),e=Math.max(0,Math.min(1,n.Dot(t.subtract(i),s)/o)),h=i.add(s.multiplyByFloats(e,e));return n.Distance(t,h)},n}();t.Vector2=o;var s=function(){function n(t,i,n){this.x=t,this.y=i,this.z=n}return n.prototype.toString=function(){return"{X: "+this.x+" Y:"+this.y+" Z:"+this.z+"}"},n.prototype.getClassName=function(){return"Vector3"},n.prototype.getHashCode=function(){var t=this.x||0;return t=397*t^(this.y||0),t=397*t^(this.z||0)},n.prototype.asArray=function(){var t=[];return this.toArray(t,0),t},n.prototype.toArray=function(t,i){return void 0===i&&(i=0),t[i]=this.x,t[i+1]=this.y,t[i+2]=this.z,this},n.prototype.toQuaternion=function(){var t=new a(0,0,0,1),i=Math.cos(.5*(this.x+this.z)),n=Math.sin(.5*(this.x+this.z)),r=Math.cos(.5*(this.z-this.x)),o=Math.sin(.5*(this.z-this.x)),s=Math.cos(.5*this.y),e=Math.sin(.5*this.y);return t.x=r*e,t.y=-o*e,t.z=n*s,t.w=i*s,t},n.prototype.addInPlace=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},n.prototype.add=function(t){return new n(this.x+t.x,this.y+t.y,this.z+t.z)},n.prototype.addToRef=function(t,i){return i.x=this.x+t.x,i.y=this.y+t.y,i.z=this.z+t.z,this},n.prototype.subtractInPlace=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},n.prototype.subtract=function(t){return new n(this.x-t.x,this.y-t.y,this.z-t.z)},n.prototype.subtractToRef=function(t,i){return i.x=this.x-t.x,i.y=this.y-t.y,i.z=this.z-t.z,this},n.prototype.subtractFromFloats=function(t,i,r){return new n(this.x-t,this.y-i,this.z-r)},n.prototype.subtractFromFloatsToRef=function(t,i,n,r){return r.x=this.x-t,r.y=this.y-i,r.z=this.z-n,this},n.prototype.negate=function(){return new n(-this.x,-this.y,-this.z)},n.prototype.scaleInPlace=function(t){return this.x*=t,this.y*=t,this.z*=t,this},n.prototype.scale=function(t){return new n(this.x*t,this.y*t,this.z*t)},n.prototype.scaleToRef=function(t,i){i.x=this.x*t,i.y=this.y*t,i.z=this.z*t},n.prototype.equals=function(t){return t&&this.x===t.x&&this.y===t.y&&this.z===t.z},n.prototype.equalsWithEpsilon=function(n,r){return void 0===r&&(r=t.Epsilon),n&&i.WithinEpsilon(this.x,n.x,r)&&i.WithinEpsilon(this.y,n.y,r)&&i.WithinEpsilon(this.z,n.z,r)},n.prototype.equalsToFloats=function(t,i,n){return this.x===t&&this.y===i&&this.z===n},n.prototype.multiplyInPlace=function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this},n.prototype.multiply=function(t){return new n(this.x*t.x,this.y*t.y,this.z*t.z)},n.prototype.multiplyToRef=function(t,i){return i.x=this.x*t.x,i.y=this.y*t.y,i.z=this.z*t.z,this},n.prototype.multiplyByFloats=function(t,i,r){return new n(this.x*t,this.y*i,this.z*r)},n.prototype.divide=function(t){return new n(this.x/t.x,this.y/t.y,this.z/t.z)},n.prototype.divideToRef=function(t,i){return i.x=this.x/t.x,i.y=this.y/t.y,i.z=this.z/t.z,this},n.prototype.MinimizeInPlace=function(t){return t.x<this.x&&(this.x=t.x),t.y<this.y&&(this.y=t.y),t.z<this.z&&(this.z=t.z),this},n.prototype.MaximizeInPlace=function(t){return t.x>this.x&&(this.x=t.x),t.y>this.y&&(this.y=t.y),t.z>this.z&&(this.z=t.z),this},n.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},n.prototype.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z},n.prototype.normalize=function(){var t=this.length();if(0===t||1===t)return this;var i=1/t;return this.x*=i,this.y*=i,this.z*=i,this},n.prototype.clone=function(){return new n(this.x,this.y,this.z)},n.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},n.prototype.copyFromFloats=function(t,i,n){return this.x=t,this.y=i,this.z=n,this},n.GetClipFactor=function(t,i,r,o){var s=n.Dot(t,r)-o,e=n.Dot(i,r)-o,h=s/(s-e);return h},n.FromArray=function(t,i){return i||(i=0),new n(t[i],t[i+1],t[i+2])},n.FromFloatArray=function(t,i){return i||(i=0),new n(t[i],t[i+1],t[i+2])},n.FromArrayToRef=function(t,i,n){n.x=t[i],n.y=t[i+1],n.z=t[i+2]},n.FromFloatArrayToRef=function(t,i,n){n.x=t[i],n.y=t[i+1],n.z=t[i+2]},n.FromFloatsToRef=function(t,i,n,r){r.x=t,r.y=i,r.z=n},n.Zero=function(){return new n(0,0,0)},n.Up=function(){return new n(0,1,0)},n.TransformCoordinates=function(t,i){var r=n.Zero();return n.TransformCoordinatesToRef(t,i,r),r},n.TransformCoordinatesToRef=function(t,i,n){var r=t.x*i.m[0]+t.y*i.m[4]+t.z*i.m[8]+i.m[12],o=t.x*i.m[1]+t.y*i.m[5]+t.z*i.m[9]+i.m[13],s=t.x*i.m[2]+t.y*i.m[6]+t.z*i.m[10]+i.m[14],e=t.x*i.m[3]+t.y*i.m[7]+t.z*i.m[11]+i.m[15];n.x=r/e,n.y=o/e,n.z=s/e},n.TransformCoordinatesFromFloatsToRef=function(t,i,n,r,o){var s=t*r.m[0]+i*r.m[4]+n*r.m[8]+r.m[12],e=t*r.m[1]+i*r.m[5]+n*r.m[9]+r.m[13],h=t*r.m[2]+i*r.m[6]+n*r.m[10]+r.m[14],a=t*r.m[3]+i*r.m[7]+n*r.m[11]+r.m[15];o.x=s/a,o.y=e/a,o.z=h/a},n.TransformNormal=function(t,i){var r=n.Zero();return n.TransformNormalToRef(t,i,r),r},n.TransformNormalToRef=function(t,i,n){n.x=t.x*i.m[0]+t.y*i.m[4]+t.z*i.m[8],n.y=t.x*i.m[1]+t.y*i.m[5]+t.z*i.m[9],n.z=t.x*i.m[2]+t.y*i.m[6]+t.z*i.m[10]},n.TransformNormalFromFloatsToRef=function(t,i,n,r,o){o.x=t*r.m[0]+i*r.m[4]+n*r.m[8],o.y=t*r.m[1]+i*r.m[5]+n*r.m[9],o.z=t*r.m[2]+i*r.m[6]+n*r.m[10]},n.CatmullRom=function(t,i,r,o,s){var e=s*s,h=s*e,a=.5*(2*i.x+(-t.x+r.x)*s+(2*t.x-5*i.x+4*r.x-o.x)*e+(-t.x+3*i.x-3*r.x+o.x)*h),u=.5*(2*i.y+(-t.y+r.y)*s+(2*t.y-5*i.y+4*r.y-o.y)*e+(-t.y+3*i.y-3*r.y+o.y)*h),m=.5*(2*i.z+(-t.z+r.z)*s+(2*t.z-5*i.z+4*r.z-o.z)*e+(-t.z+3*i.z-3*r.z+o.z)*h);return new n(a,u,m)},n.Clamp=function(t,i,r){var o=t.x;o=o>r.x?r.x:o,o=o<i.x?i.x:o;var s=t.y;s=s>r.y?r.y:s,s=s<i.y?i.y:s;var e=t.z;return e=e>r.z?r.z:e,e=e<i.z?i.z:e,new n(o,s,e)},n.Hermite=function(t,i,r,o,s){var e=s*s,h=s*e,a=2*h-3*e+1,u=-2*h+3*e,m=h-2*e+s,y=h-e,c=t.x*a+r.x*u+i.x*m+o.x*y,p=t.y*a+r.y*u+i.y*m+o.y*y,f=t.z*a+r.z*u+i.z*m+o.z*y;return new n(c,p,f)},n.Lerp=function(t,i,r){var o=t.x+(i.x-t.x)*r,s=t.y+(i.y-t.y)*r,e=t.z+(i.z-t.z)*r;return new n(o,s,e)},n.Dot=function(t,i){return t.x*i.x+t.y*i.y+t.z*i.z},n.Cross=function(t,i){var r=n.Zero();return n.CrossToRef(t,i,r),r},n.CrossToRef=function(t,i,n){M.Vector3[0].x=t.y*i.z-t.z*i.y,M.Vector3[0].y=t.z*i.x-t.x*i.z,M.Vector3[0].z=t.x*i.y-t.y*i.x,n.copyFrom(M.Vector3[0])},n.Normalize=function(t){var i=n.Zero();return n.NormalizeToRef(t,i),i},n.NormalizeToRef=function(t,i){i.copyFrom(t),i.normalize()},n.Project=function(t,i,r,o){var s=o.width,e=o.height,h=o.x,a=o.y,m=u.FromValues(s/2,0,0,0,0,-e/2,0,0,0,0,1,0,h+s/2,e/2+a,0,1),y=i.multiply(r).multiply(m);return n.TransformCoordinates(t,y)},n.UnprojectFromTransform=function(t,r,o,s,e){var h=s.multiply(e);h.invert(),t.x=t.x/r*2-1,t.y=-(t.y/o*2-1);var a=n.TransformCoordinates(t,h),u=t.x*h.m[3]+t.y*h.m[7]+t.z*h.m[11]+h.m[15];return i.WithinEpsilon(u,1)&&(a=a.scale(1/u)),a},n.Unproject=function(t,r,o,s,e,h){var a=s.multiply(e).multiply(h);a.invert();var u=new n(t.x/r*2-1,-(t.y/o*2-1),t.z),m=n.TransformCoordinates(u,a),y=u.x*a.m[3]+u.y*a.m[7]+u.z*a.m[11]+a.m[15];return i.WithinEpsilon(y,1)&&(m=m.scale(1/y)),m},n.Minimize=function(t,i){var n=t.clone();return n.MinimizeInPlace(i),n},n.Maximize=function(t,i){var n=t.clone();return n.MaximizeInPlace(i),n},n.Distance=function(t,i){return Math.sqrt(n.DistanceSquared(t,i))},n.DistanceSquared=function(t,i){var n=t.x-i.x,r=t.y-i.y,o=t.z-i.z;return n*n+r*r+o*o},n.Center=function(t,i){var n=t.add(i);return n.scaleInPlace(.5),n},n.RotationFromAxis=function(t,i,r){var o=n.Zero();return n.RotationFromAxisToRef(t,i,r,o),o},n.RotationFromAxisToRef=function(r,o,s,e){var h=r.normalize(),a=s.normalize(),u=p.X,m=p.Y,y=0,c=0,f=0,l=0,x=0,z=0,w=0,v=-1,d=0,g=M.Vector3[0],T=0,R=M.Vector3[1];i.WithinEpsilon(a.z,0,t.Epsilon)?z=1:i.WithinEpsilon(a.x,0,t.Epsilon)?l=1:(w=a.z/a.x,l=-w*Math.sqrt(1/(1+w*w)),z=Math.sqrt(1/(1+w*w))),R.x=l,R.y=x,R.z=z,R.normalize(),n.CrossToRef(h,R,g),g.normalize(),n.Dot(a,g)<0&&(v=1),T=n.Dot(h,R),T=Math.min(1,Math.max(-1,T)),f=Math.acos(T)*v,n.Dot(R,u)<0&&(f=Math.PI+f,R=R.scaleInPlace(-1),d++);var _=M.Vector3[2],b=M.Vector3[3];l=0,x=0,z=0,v=-1,i.WithinEpsilon(a.z,0,t.Epsilon)?l=1:(w=R.z/R.x,l=-w*Math.sqrt(1/(1+w*w)),z=Math.sqrt(1/(1+w*w))),_.x=l,_.y=x,_.z=z,_.normalize(),n.CrossToRef(_,R,b),b.normalize(),n.CrossToRef(a,_,g),g.normalize(),n.Dot(R,g)<0&&(v=1),T=n.Dot(a,_),T=Math.min(1,Math.max(-1,T)),c=Math.acos(T)*v,n.Dot(b,m)<0&&(c=Math.PI+c,d++),v=-1,n.CrossToRef(u,R,g),g.normalize(),n.Dot(g,m)<0&&(v=1),T=n.Dot(R,u),T=Math.min(1,Math.max(-1,T)),y=-Math.acos(T)*v,0>T&&2>d&&(y=Math.PI+y),e.x=c,e.y=y,e.z=f},n}();t.Vector3=s;var e=function(){function n(t,i,n,r){this.x=t,this.y=i,this.z=n,this.w=r}return n.prototype.toString=function(){return"{X: "+this.x+" Y:"+this.y+" Z:"+this.z+"W:"+this.w+"}"},n.prototype.getClassName=function(){return"Vector4"},n.prototype.getHashCode=function(){var t=this.x||0;return t=397*t^(this.y||0),t=397*t^(this.z||0),t=397*t^(this.w||0)},n.prototype.asArray=function(){var t=[];return this.toArray(t,0),t},n.prototype.toArray=function(t,i){return void 0===i&&(i=0),t[i]=this.x,t[i+1]=this.y,t[i+2]=this.z,t[i+3]=this.w,this},n.prototype.addInPlace=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this},n.prototype.add=function(t){return new n(this.x+t.x,this.y+t.y,this.z+t.z,this.w+t.w)},n.prototype.addToRef=function(t,i){return i.x=this.x+t.x,i.y=this.y+t.y,i.z=this.z+t.z,i.w=this.w+t.w,this},n.prototype.subtractInPlace=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this},n.prototype.subtract=function(t){return new n(this.x-t.x,this.y-t.y,this.z-t.z,this.w-t.w)},n.prototype.subtractToRef=function(t,i){return i.x=this.x-t.x,i.y=this.y-t.y,i.z=this.z-t.z,i.w=this.w-t.w,this},n.prototype.subtractFromFloats=function(t,i,r,o){return new n(this.x-t,this.y-i,this.z-r,this.w-o)},n.prototype.subtractFromFloatsToRef=function(t,i,n,r,o){return o.x=this.x-t,o.y=this.y-i,o.z=this.z-n,o.w=this.w-r,this},n.prototype.negate=function(){return new n(-this.x,-this.y,-this.z,-this.w)},n.prototype.scaleInPlace=function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},n.prototype.scale=function(t){return new n(this.x*t,this.y*t,this.z*t,this.w*t)},n.prototype.scaleToRef=function(t,i){i.x=this.x*t,i.y=this.y*t,i.z=this.z*t,i.w=this.w*t},n.prototype.equals=function(t){return t&&this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w},n.prototype.equalsWithEpsilon=function(n,r){return void 0===r&&(r=t.Epsilon),n&&i.WithinEpsilon(this.x,n.x,r)&&i.WithinEpsilon(this.y,n.y,r)&&i.WithinEpsilon(this.z,n.z,r)&&i.WithinEpsilon(this.w,n.w,r)},n.prototype.equalsToFloats=function(t,i,n,r){return this.x===t&&this.y===i&&this.z===n&&this.w===r},n.prototype.multiplyInPlace=function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this},n.prototype.multiply=function(t){return new n(this.x*t.x,this.y*t.y,this.z*t.z,this.w*t.w)},n.prototype.multiplyToRef=function(t,i){return i.x=this.x*t.x,i.y=this.y*t.y,i.z=this.z*t.z,i.w=this.w*t.w,this},n.prototype.multiplyByFloats=function(t,i,r,o){return new n(this.x*t,this.y*i,this.z*r,this.w*o)},n.prototype.divide=function(t){return new n(this.x/t.x,this.y/t.y,this.z/t.z,this.w/t.w)},n.prototype.divideToRef=function(t,i){return i.x=this.x/t.x,i.y=this.y/t.y,i.z=this.z/t.z,i.w=this.w/t.w,this},n.prototype.MinimizeInPlace=function(t){return t.x<this.x&&(this.x=t.x),t.y<this.y&&(this.y=t.y),t.z<this.z&&(this.z=t.z),t.w<this.w&&(this.w=t.w),this},n.prototype.MaximizeInPlace=function(t){return t.x>this.x&&(this.x=t.x),t.y>this.y&&(this.y=t.y),t.z>this.z&&(this.z=t.z),t.w>this.w&&(this.w=t.w),this},n.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},n.prototype.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},n.prototype.normalize=function(){var t=this.length();if(0===t)return this;var i=1/t;return this.x*=i,this.y*=i,this.z*=i,this.w*=i,this},n.prototype.toVector3=function(){return new s(this.x,this.y,this.z)},n.prototype.clone=function(){return new n(this.x,this.y,this.z,this.w)},n.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},n.prototype.copyFromFloats=function(t,i,n,r){return this.x=t,this.y=i,this.z=n,this.w=r,this},n.FromArray=function(t,i){return i||(i=0),new n(t[i],t[i+1],t[i+2],t[i+3])},n.FromArrayToRef=function(t,i,n){n.x=t[i],n.y=t[i+1],n.z=t[i+2],n.w=t[i+3]},n.FromFloatArrayToRef=function(t,i,n){n.x=t[i],n.y=t[i+1],n.z=t[i+2],n.w=t[i+3]},n.FromFloatsToRef=function(t,i,n,r,o){o.x=t,o.y=i,o.z=n,o.w=r},n.Zero=function(){return new n(0,0,0,0)},n.Normalize=function(t){var i=n.Zero();return n.NormalizeToRef(t,i),i},n.NormalizeToRef=function(t,i){i.copyFrom(t),i.normalize()},n.Minimize=function(t,i){var n=t.clone();return n.MinimizeInPlace(i),n},n.Maximize=function(t,i){var n=t.clone();return n.MaximizeInPlace(i),n},n.Distance=function(t,i){return Math.sqrt(n.DistanceSquared(t,i))},n.DistanceSquared=function(t,i){var n=t.x-i.x,r=t.y-i.y,o=t.z-i.z,s=t.w-i.w;return n*n+r*r+o*o+s*s},n.Center=function(t,i){var n=t.add(i);return n.scaleInPlace(.5),n},n}();t.Vector4=e;var h=function(){function t(t,i){this.width=t,this.height=i}return t.prototype.toString=function(){return"{W: "+this.width+", H: "+this.height+"}"},t.prototype.getClassName=function(){return"Size"},t.prototype.getHashCode=function(){var t=this.width||0;return t=397*t^(this.height||0)},t.prototype.copyFrom=function(t){this.width=t.width,this.height=t.height},t.prototype.clone=function(){return new t(this.width,this.height)},t.prototype.equals=function(t){return t?this.width===t.width&&this.height===t.height:!1},Object.defineProperty(t.prototype,"surface",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),t.Zero=function(){return new t(0,0)},t.prototype.add=function(i){var n=new t(this.width+i.width,this.height+i.height);return n},t.prototype.substract=function(i){var n=new t(this.width-i.width,this.height-i.height);return n},t.Lerp=function(i,n,r){var o=i.width+(n.width-i.width)*r,s=i.height+(n.height-i.height)*r;return new t(o,s)},t}();t.Size=h;var a=function(){function t(t,i,n,r){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=1),this.x=t,this.y=i,this.z=n,this.w=r}return t.prototype.toString=function(){return"{X: "+this.x+" Y:"+this.y+" Z:"+this.z+" W:"+this.w+"}"},t.prototype.getClassName=function(){return"Quaternion"},t.prototype.getHashCode=function(){var t=this.x||0;return t=397*t^(this.y||0),t=397*t^(this.z||0),t=397*t^(this.w||0)},t.prototype.asArray=function(){return[this.x,this.y,this.z,this.w]},t.prototype.equals=function(t){return t&&this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w},t.prototype.clone=function(){return new t(this.x,this.y,this.z,this.w)},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},t.prototype.copyFromFloats=function(t,i,n,r){return this.x=t,this.y=i,this.z=n,this.w=r,this},t.prototype.add=function(i){return new t(this.x+i.x,this.y+i.y,this.z+i.z,this.w+i.w)},t.prototype.subtract=function(i){return new t(this.x-i.x,this.y-i.y,this.z-i.z,this.w-i.w)},t.prototype.scale=function(i){return new t(this.x*i,this.y*i,this.z*i,this.w*i)},t.prototype.multiply=function(i){var n=new t(0,0,0,1);return this.multiplyToRef(i,n),n},t.prototype.multiplyToRef=function(t,i){var n=this.x*t.w+this.y*t.z-this.z*t.y+this.w*t.x,r=-this.x*t.z+this.y*t.w+this.z*t.x+this.w*t.y,o=this.x*t.y-this.y*t.x+this.z*t.w+this.w*t.z,s=-this.x*t.x-this.y*t.y-this.z*t.z+this.w*t.w;return i.copyFromFloats(n,r,o,s),this},t.prototype.multiplyInPlace=function(t){return this.multiplyToRef(t,this),this},t.prototype.conjugateToRef=function(t){return t.copyFromFloats(-this.x,-this.y,-this.z,this.w),this},t.prototype.conjugateInPlace=function(){return this.x*=-1,this.y*=-1,this.z*=-1,this},t.prototype.conjugate=function(){var i=new t(-this.x,-this.y,-this.z,this.w);return i},t.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},t.prototype.normalize=function(){var t=1/this.length();return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},t.prototype.toEulerAngles=function(t){void 0===t&&(t="YZX");var i=s.Zero();return this.toEulerAnglesToRef(i,t),i},t.prototype.toEulerAnglesToRef=function(t,i){void 0===i&&(i="YZX");var n,r,o,s=this.x,e=this.y,h=this.z,a=this.w;switch(i){case"YZX":var u=s*e+h*a;if(u>.499&&(n=2*Math.atan2(s,a),r=Math.PI/2,o=0),-.499>u&&(n=-2*Math.atan2(s,a),r=-Math.PI/2,o=0),isNaN(n)){var m=s*s,y=e*e,c=h*h;n=Math.atan2(2*e*a-2*s*h,1-2*y-2*c),r=Math.asin(2*u),o=Math.atan2(2*s*a-2*e*h,1-2*m-2*c)}break;default:throw new Error("Euler order "+i+" not supported yet.")}return t.y=n,t.z=r,t.x=o,this},t.prototype.toRotationMatrix=function(t){var i=this.x*this.x,n=this.y*this.y,r=this.z*this.z,o=this.x*this.y,s=this.z*this.w,e=this.z*this.x,h=this.y*this.w,a=this.y*this.z,u=this.x*this.w;return t.m[0]=1-2*(n+r),t.m[1]=2*(o+s),t.m[2]=2*(e-h),t.m[3]=0,t.m[4]=2*(o-s),t.m[5]=1-2*(r+i),t.m[6]=2*(a+u),t.m[7]=0,t.m[8]=2*(e+h),t.m[9]=2*(a-u),t.m[10]=1-2*(n+i),t.m[11]=0,t.m[12]=0,t.m[13]=0,t.m[14]=0,t.m[15]=1,this},t.prototype.fromRotationMatrix=function(i){return t.FromRotationMatrixToRef(i,this),this},t.FromRotationMatrix=function(i){var n=new t;return t.FromRotationMatrixToRef(i,n),n},t.FromRotationMatrixToRef=function(t,i){var n,r=t.m,o=r[0],s=r[4],e=r[8],h=r[1],a=r[5],u=r[9],m=r[2],y=r[6],c=r[10],p=o+a+c;p>0?(n=.5/Math.sqrt(p+1),i.w=.25/n,i.x=(y-u)*n,i.y=(e-m)*n,i.z=(h-s)*n):o>a&&o>c?(n=2*Math.sqrt(1+o-a-c),i.w=(y-u)/n,i.x=.25*n,i.y=(s+h)/n,i.z=(e+m)/n):a>c?(n=2*Math.sqrt(1+a-o-c),i.w=(e-m)/n,i.x=(s+h)/n,i.y=.25*n,i.z=(u+y)/n):(n=2*Math.sqrt(1+c-o-a),i.w=(h-s)/n,i.x=(e+m)/n,i.y=(u+y)/n,i.z=.25*n)},t.Inverse=function(i){return new t(-i.x,-i.y,-i.z,i.w)},t.Identity=function(){return new t(0,0,0,1)},t.RotationAxis=function(i,n){var r=new t,o=Math.sin(n/2);return i.normalize(),r.w=Math.cos(n/2),r.x=i.x*o,r.y=i.y*o,r.z=i.z*o,r},t.FromArray=function(i,n){return n||(n=0),new t(i[n],i[n+1],i[n+2],i[n+3])},t.RotationYawPitchRoll=function(i,n,r){var o=new t;return t.RotationYawPitchRollToRef(i,n,r,o),o},t.RotationYawPitchRollToRef=function(t,i,n,r){var o=.5*n,s=.5*i,e=.5*t,h=Math.sin(o),a=Math.cos(o),u=Math.sin(s),m=Math.cos(s),y=Math.sin(e),c=Math.cos(e);r.x=c*u*a+y*m*h,r.y=y*m*a-c*u*h,r.z=c*m*h-y*u*a,r.w=c*m*a+y*u*h},t.RotationAlphaBetaGamma=function(i,n,r){var o=new t;return t.RotationAlphaBetaGammaToRef(i,n,r,o),o},t.RotationAlphaBetaGammaToRef=function(t,i,n,r){var o=.5*(n+t),s=.5*(n-t),e=.5*i;r.x=Math.cos(s)*Math.sin(e),r.y=Math.sin(s)*Math.sin(e),r.z=Math.sin(o)*Math.cos(e),r.w=Math.cos(o)*Math.cos(e)},t.Slerp=function(i,n,r){var o,s,e=r,h=i.x*n.x+i.y*n.y+i.z*n.z+i.w*n.w,a=!1;if(0>h&&(a=!0,h=-h),h>.999999)s=1-e,o=a?-e:e;else{var u=Math.acos(h),m=1/Math.sin(u);s=Math.sin((1-e)*u)*m,o=a?-Math.sin(e*u)*m:Math.sin(e*u)*m}return new t(s*i.x+o*n.x,s*i.y+o*n.y,s*i.z+o*n.z,s*i.w+o*n.w)},t}();t.Quaternion=a;var u=function(){function t(){this.m=new Float32Array(16)}return t.prototype.isIdentity=function(){return 1!==this.m[0]||1!==this.m[5]||1!==this.m[10]||1!==this.m[15]?!1:0===this.m[1]&&0===this.m[2]&&0===this.m[3]&&0===this.m[4]&&0===this.m[6]&&0===this.m[7]&&0===this.m[8]&&0===this.m[9]&&0===this.m[11]&&0===this.m[12]&&0===this.m[13]&&0===this.m[14]},t.prototype.determinant=function(){var t=this.m[10]*this.m[15]-this.m[11]*this.m[14],i=this.m[9]*this.m[15]-this.m[11]*this.m[13],n=this.m[9]*this.m[14]-this.m[10]*this.m[13],r=this.m[8]*this.m[15]-this.m[11]*this.m[12],o=this.m[8]*this.m[14]-this.m[10]*this.m[12],s=this.m[8]*this.m[13]-this.m[9]*this.m[12];return this.m[0]*(this.m[5]*t-this.m[6]*i+this.m[7]*n)-this.m[1]*(this.m[4]*t-this.m[6]*r+this.m[7]*o)+this.m[2]*(this.m[4]*i-this.m[5]*r+this.m[7]*s)-this.m[3]*(this.m[4]*n-this.m[5]*o+this.m[6]*s)},t.prototype.toArray=function(){return this.m},t.prototype.asArray=function(){return this.toArray()},t.prototype.invert=function(){return this.invertToRef(this),this},t.prototype.reset=function(){for(var t=0;16>t;t++)this.m[t]=0;return this},t.prototype.add=function(i){var n=new t;return this.addToRef(i,n),n},t.prototype.addToRef=function(t,i){for(var n=0;16>n;n++)i.m[n]=this.m[n]+t.m[n];return this},t.prototype.addToSelf=function(t){for(var i=0;16>i;i++)this.m[i]+=t.m[i];return this},t.prototype.invertToRef=function(t){var i=this.m[0],n=this.m[1],r=this.m[2],o=this.m[3],s=this.m[4],e=this.m[5],h=this.m[6],a=this.m[7],u=this.m[8],m=this.m[9],y=this.m[10],c=this.m[11],p=this.m[12],f=this.m[13],l=this.m[14],x=this.m[15],z=y*x-c*l,w=m*x-c*f,v=m*l-y*f,d=u*x-c*p,g=u*l-y*p,T=u*f-m*p,R=e*z-h*w+a*v,_=-(s*z-h*d+a*g),M=s*w-e*d+a*T,b=-(s*v-e*g+h*T),F=1/(i*R+n*_+r*M+o*b),A=h*x-a*l,L=e*x-a*f,P=e*l-h*f,C=s*x-a*p,Z=s*l-h*p,S=s*f-e*p,I=h*c-a*y,q=e*c-a*m,H=e*y-h*m,N=s*c-a*u,V=s*y-h*u,D=s*m-e*u;return t.m[0]=R*F,t.m[4]=_*F,t.m[8]=M*F,t.m[12]=b*F,t.m[1]=-(n*z-r*w+o*v)*F,t.m[5]=(i*z-r*d+o*g)*F,t.m[9]=-(i*w-n*d+o*T)*F,t.m[13]=(i*v-n*g+r*T)*F,t.m[2]=(n*A-r*L+o*P)*F,t.m[6]=-(i*A-r*C+o*Z)*F,t.m[10]=(i*L-n*C+o*S)*F,t.m[14]=-(i*P-n*Z+r*S)*F,t.m[3]=-(n*I-r*q+o*H)*F,t.m[7]=(i*I-r*N+o*V)*F,t.m[11]=-(i*q-n*N+o*D)*F,t.m[15]=(i*H-n*V+r*D)*F,this},t.prototype.setTranslation=function(t){return this.m[12]=t.x,this.m[13]=t.y,this.m[14]=t.z,this},t.prototype.getTranslation=function(){return new s(this.m[12],this.m[13],this.m[14])},t.prototype.multiply=function(i){var n=new t;return this.multiplyToRef(i,n),n},t.prototype.copyFrom=function(t){for(var i=0;16>i;i++)this.m[i]=t.m[i];return this},t.prototype.copyToArray=function(t,i){void 0===i&&(i=0);for(var n=0;16>n;n++)t[i+n]=this.m[n];return this},t.prototype.multiplyToRef=function(t,i){return this.multiplyToArray(t,i.m,0),this},t.prototype.multiplyToArray=function(t,i,n){var r=this.m[0],o=this.m[1],s=this.m[2],e=this.m[3],h=this.m[4],a=this.m[5],u=this.m[6],m=this.m[7],y=this.m[8],c=this.m[9],p=this.m[10],f=this.m[11],l=this.m[12],x=this.m[13],z=this.m[14],w=this.m[15],v=t.m[0],d=t.m[1],g=t.m[2],T=t.m[3],R=t.m[4],_=t.m[5],M=t.m[6],b=t.m[7],F=t.m[8],A=t.m[9],L=t.m[10],P=t.m[11],C=t.m[12],Z=t.m[13],S=t.m[14],I=t.m[15];return i[n]=r*v+o*R+s*F+e*C,i[n+1]=r*d+o*_+s*A+e*Z,i[n+2]=r*g+o*M+s*L+e*S,i[n+3]=r*T+o*b+s*P+e*I,i[n+4]=h*v+a*R+u*F+m*C,i[n+5]=h*d+a*_+u*A+m*Z,i[n+6]=h*g+a*M+u*L+m*S,i[n+7]=h*T+a*b+u*P+m*I,i[n+8]=y*v+c*R+p*F+f*C,\ni[n+9]=y*d+c*_+p*A+f*Z,i[n+10]=y*g+c*M+p*L+f*S,i[n+11]=y*T+c*b+p*P+f*I,i[n+12]=l*v+x*R+z*F+w*C,i[n+13]=l*d+x*_+z*A+w*Z,i[n+14]=l*g+x*M+z*L+w*S,i[n+15]=l*T+x*b+z*P+w*I,this},t.prototype.equals=function(t){return t&&this.m[0]===t.m[0]&&this.m[1]===t.m[1]&&this.m[2]===t.m[2]&&this.m[3]===t.m[3]&&this.m[4]===t.m[4]&&this.m[5]===t.m[5]&&this.m[6]===t.m[6]&&this.m[7]===t.m[7]&&this.m[8]===t.m[8]&&this.m[9]===t.m[9]&&this.m[10]===t.m[10]&&this.m[11]===t.m[11]&&this.m[12]===t.m[12]&&this.m[13]===t.m[13]&&this.m[14]===t.m[14]&&this.m[15]===t.m[15]},t.prototype.clone=function(){return t.FromValues(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5],this.m[6],this.m[7],this.m[8],this.m[9],this.m[10],this.m[11],this.m[12],this.m[13],this.m[14],this.m[15])},t.prototype.getClassName=function(){return"Matrix"},t.prototype.getHashCode=function(){for(var t=this.m[0]||0,i=1;16>i;i++)t=397*t^(this.m[i]||0);return t},t.prototype.decompose=function(n,r,o){o.x=this.m[12],o.y=this.m[13],o.z=this.m[14];var s=i.Sign(this.m[0]*this.m[1]*this.m[2]*this.m[3])<0?-1:1,e=i.Sign(this.m[4]*this.m[5]*this.m[6]*this.m[7])<0?-1:1,h=i.Sign(this.m[8]*this.m[9]*this.m[10]*this.m[11])<0?-1:1;if(n.x=s*Math.sqrt(this.m[0]*this.m[0]+this.m[1]*this.m[1]+this.m[2]*this.m[2]),n.y=e*Math.sqrt(this.m[4]*this.m[4]+this.m[5]*this.m[5]+this.m[6]*this.m[6]),n.z=h*Math.sqrt(this.m[8]*this.m[8]+this.m[9]*this.m[9]+this.m[10]*this.m[10]),0===n.x||0===n.y||0===n.z)return r.x=0,r.y=0,r.z=0,r.w=1,!1;var u=t.FromValues(this.m[0]/n.x,this.m[1]/n.x,this.m[2]/n.x,0,this.m[4]/n.y,this.m[5]/n.y,this.m[6]/n.y,0,this.m[8]/n.z,this.m[9]/n.z,this.m[10]/n.z,0,0,0,0,1);return a.FromRotationMatrixToRef(u,r),!0},t.FromArray=function(i,n){var r=new t;return n||(n=0),t.FromArrayToRef(i,n,r),r},t.FromArrayToRef=function(t,i,n){for(var r=0;16>r;r++)n.m[r]=t[r+i]},t.FromFloat32ArrayToRefScaled=function(t,i,n,r){for(var o=0;16>o;o++)r.m[o]=t[o+i]*n},t.FromValuesToRef=function(t,i,n,r,o,s,e,h,a,u,m,y,c,p,f,l,x){x.m[0]=t,x.m[1]=i,x.m[2]=n,x.m[3]=r,x.m[4]=o,x.m[5]=s,x.m[6]=e,x.m[7]=h,x.m[8]=a,x.m[9]=u,x.m[10]=m,x.m[11]=y,x.m[12]=c,x.m[13]=p,x.m[14]=f,x.m[15]=l},t.prototype.getRow=function(t){if(0>t||t>3)return null;var i=4*t;return new e(this.m[i+0],this.m[i+1],this.m[i+2],this.m[i+3])},t.prototype.setRow=function(t,i){if(0>t||t>3)return this;var n=4*t;return this.m[n+0]=i.x,this.m[n+1]=i.y,this.m[n+2]=i.z,this.m[n+3]=i.w,this},t.FromValues=function(i,n,r,o,s,e,h,a,u,m,y,c,p,f,l,x){var z=new t;return z.m[0]=i,z.m[1]=n,z.m[2]=r,z.m[3]=o,z.m[4]=s,z.m[5]=e,z.m[6]=h,z.m[7]=a,z.m[8]=u,z.m[9]=m,z.m[10]=y,z.m[11]=c,z.m[12]=p,z.m[13]=f,z.m[14]=l,z.m[15]=x,z},t.Compose=function(i,n,r){var o=t.FromValues(i.x,0,0,0,0,i.y,0,0,0,0,i.z,0,0,0,0,1),s=t.Identity();return n.toRotationMatrix(s),o=o.multiply(s),o.setTranslation(r),o},t.Identity=function(){return t.FromValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},t.IdentityToRef=function(i){t.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,i)},t.Zero=function(){return t.FromValues(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)},t.RotationX=function(i){var n=new t;return t.RotationXToRef(i,n),n},t.Invert=function(i){var n=new t;return i.invertToRef(n),n},t.RotationXToRef=function(t,i){var n=Math.sin(t),r=Math.cos(t);i.m[0]=1,i.m[15]=1,i.m[5]=r,i.m[10]=r,i.m[9]=-n,i.m[6]=n,i.m[1]=0,i.m[2]=0,i.m[3]=0,i.m[4]=0,i.m[7]=0,i.m[8]=0,i.m[11]=0,i.m[12]=0,i.m[13]=0,i.m[14]=0},t.RotationY=function(i){var n=new t;return t.RotationYToRef(i,n),n},t.RotationYToRef=function(t,i){var n=Math.sin(t),r=Math.cos(t);i.m[5]=1,i.m[15]=1,i.m[0]=r,i.m[2]=-n,i.m[8]=n,i.m[10]=r,i.m[1]=0,i.m[3]=0,i.m[4]=0,i.m[6]=0,i.m[7]=0,i.m[9]=0,i.m[11]=0,i.m[12]=0,i.m[13]=0,i.m[14]=0},t.RotationZ=function(i){var n=new t;return t.RotationZToRef(i,n),n},t.RotationZToRef=function(t,i){var n=Math.sin(t),r=Math.cos(t);i.m[10]=1,i.m[15]=1,i.m[0]=r,i.m[1]=n,i.m[4]=-n,i.m[5]=r,i.m[2]=0,i.m[3]=0,i.m[6]=0,i.m[7]=0,i.m[8]=0,i.m[9]=0,i.m[11]=0,i.m[12]=0,i.m[13]=0,i.m[14]=0},t.RotationAxis=function(i,n){var r=t.Zero();return t.RotationAxisToRef(i,n,r),r},t.RotationAxisToRef=function(t,i,n){var r=Math.sin(-i),o=Math.cos(-i),s=1-o;t.normalize(),n.m[0]=t.x*t.x*s+o,n.m[1]=t.x*t.y*s-t.z*r,n.m[2]=t.x*t.z*s+t.y*r,n.m[3]=0,n.m[4]=t.y*t.x*s+t.z*r,n.m[5]=t.y*t.y*s+o,n.m[6]=t.y*t.z*s-t.x*r,n.m[7]=0,n.m[8]=t.z*t.x*s-t.y*r,n.m[9]=t.z*t.y*s+t.x*r,n.m[10]=t.z*t.z*s+o,n.m[11]=0,n.m[15]=1},t.RotationYawPitchRoll=function(i,n,r){var o=new t;return t.RotationYawPitchRollToRef(i,n,r,o),o},t.RotationYawPitchRollToRef=function(t,i,n,r){a.RotationYawPitchRollToRef(t,i,n,this._tempQuaternion),this._tempQuaternion.toRotationMatrix(r)},t.Scaling=function(i,n,r){var o=t.Zero();return t.ScalingToRef(i,n,r,o),o},t.ScalingToRef=function(t,i,n,r){r.m[0]=t,r.m[1]=0,r.m[2]=0,r.m[3]=0,r.m[4]=0,r.m[5]=i,r.m[6]=0,r.m[7]=0,r.m[8]=0,r.m[9]=0,r.m[10]=n,r.m[11]=0,r.m[12]=0,r.m[13]=0,r.m[14]=0,r.m[15]=1},t.Translation=function(i,n,r){var o=t.Identity();return t.TranslationToRef(i,n,r,o),o},t.TranslationToRef=function(i,n,r,o){t.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,i,n,r,1,o)},t.Lerp=function(i,n,r){for(var o=t.Zero(),s=0;16>s;s++)o.m[s]=i.m[s]*(1-r)+n.m[s]*r;return o},t.DecomposeLerp=function(i,n,r){var o=new s(0,0,0),e=new a,h=new s(0,0,0);i.decompose(o,e,h);var u=new s(0,0,0),m=new a,y=new s(0,0,0);n.decompose(u,m,y);var c=s.Lerp(o,u,r),p=a.Slerp(e,m,r),f=s.Lerp(h,y,r);return t.Compose(c,p,f)},t.LookAtLH=function(i,n,r){var o=t.Zero();return t.LookAtLHToRef(i,n,r,o),o},t.LookAtLHToRef=function(i,n,r,o){n.subtractToRef(i,this._zAxis),this._zAxis.normalize(),s.CrossToRef(r,this._zAxis,this._xAxis),0===this._xAxis.lengthSquared()?this._xAxis.x=1:this._xAxis.normalize(),s.CrossToRef(this._zAxis,this._xAxis,this._yAxis),this._yAxis.normalize();var e=-s.Dot(this._xAxis,i),h=-s.Dot(this._yAxis,i),a=-s.Dot(this._zAxis,i);return t.FromValuesToRef(this._xAxis.x,this._yAxis.x,this._zAxis.x,0,this._xAxis.y,this._yAxis.y,this._zAxis.y,0,this._xAxis.z,this._yAxis.z,this._zAxis.z,0,e,h,a,1,o)},t.OrthoLH=function(i,n,r,o){var s=t.Zero();return t.OrthoLHToRef(i,n,r,o,s),s},t.OrthoLHToRef=function(i,n,r,o,s){var e=2/i,h=2/n,a=1/(o-r),u=r/(r-o);t.FromValuesToRef(e,0,0,0,0,h,0,0,0,0,a,0,0,0,u,1,s)},t.OrthoOffCenterLH=function(i,n,r,o,s,e){var h=t.Zero();return t.OrthoOffCenterLHToRef(i,n,r,o,s,e,h),h},t.OrthoOffCenterLHToRef=function(t,i,n,r,o,s,e){e.m[0]=2/(i-t),e.m[1]=e.m[2]=e.m[3]=0,e.m[5]=2/(r-n),e.m[4]=e.m[6]=e.m[7]=0,e.m[10]=-1/(o-s),e.m[8]=e.m[9]=e.m[11]=0,e.m[12]=(t+i)/(t-i),e.m[13]=(r+n)/(n-r),e.m[14]=o/(o-s),e.m[15]=1},t.PerspectiveLH=function(i,n,r,o){var s=t.Zero();return s.m[0]=2*r/i,s.m[1]=s.m[2]=s.m[3]=0,s.m[5]=2*r/n,s.m[4]=s.m[6]=s.m[7]=0,s.m[10]=-o/(r-o),s.m[8]=s.m[9]=0,s.m[11]=1,s.m[12]=s.m[13]=s.m[15]=0,s.m[14]=r*o/(r-o),s},t.PerspectiveFovLH=function(i,n,r,o){var s=t.Zero();return t.PerspectiveFovLHToRef(i,n,r,o,s),s},t.PerspectiveFovLHToRef=function(t,i,n,r,o,s){void 0===s&&(s=!0);var e=1/Math.tan(.5*t);s?o.m[0]=e/i:o.m[0]=e,o.m[1]=o.m[2]=o.m[3]=0,s?o.m[5]=e:o.m[5]=e*i,o.m[4]=o.m[6]=o.m[7]=0,o.m[8]=o.m[9]=0,o.m[10]=-r/(n-r),o.m[11]=1,o.m[12]=o.m[13]=o.m[15]=0,o.m[14]=n*r/(n-r)},t.GetFinalMatrix=function(i,n,r,o,s,e){var h=i.width,a=i.height,u=i.x,m=i.y,y=t.FromValues(h/2,0,0,0,0,-a/2,0,0,0,0,e-s,0,u+h/2,a/2+m,s,1);return n.multiply(r).multiply(o).multiply(y)},t.GetAsMatrix2x2=function(t){return new Float32Array([t.m[0],t.m[1],t.m[4],t.m[5]])},t.GetAsMatrix3x3=function(t){return new Float32Array([t.m[0],t.m[1],t.m[2],t.m[4],t.m[5],t.m[6],t.m[8],t.m[9],t.m[10]])},t.Transpose=function(i){var n=new t;return n.m[0]=i.m[0],n.m[1]=i.m[4],n.m[2]=i.m[8],n.m[3]=i.m[12],n.m[4]=i.m[1],n.m[5]=i.m[5],n.m[6]=i.m[9],n.m[7]=i.m[13],n.m[8]=i.m[2],n.m[9]=i.m[6],n.m[10]=i.m[10],n.m[11]=i.m[14],n.m[12]=i.m[3],n.m[13]=i.m[7],n.m[14]=i.m[11],n.m[15]=i.m[15],n},t.Reflection=function(i){var n=new t;return t.ReflectionToRef(i,n),n},t.ReflectionToRef=function(t,i){t.normalize();var n=t.normal.x,r=t.normal.y,o=t.normal.z,s=-2*n,e=-2*r,h=-2*o;i.m[0]=s*n+1,i.m[1]=e*n,i.m[2]=h*n,i.m[3]=0,i.m[4]=s*r,i.m[5]=e*r+1,i.m[6]=h*r,i.m[7]=0,i.m[8]=s*o,i.m[9]=e*o,i.m[10]=h*o+1,i.m[11]=0,i.m[12]=s*t.d,i.m[13]=e*t.d,i.m[14]=h*t.d,i.m[15]=1},t._tempQuaternion=new a,t._xAxis=s.Zero(),t._yAxis=s.Zero(),t._zAxis=s.Zero(),t}();t.Matrix=u;var m=function(){function t(t,i,n,r){this.normal=new s(t,i,n),this.d=r}return t.prototype.asArray=function(){return[this.normal.x,this.normal.y,this.normal.z,this.d]},t.prototype.clone=function(){return new t(this.normal.x,this.normal.y,this.normal.z,this.d)},t.prototype.getClassName=function(){return"Plane"},t.prototype.getHashCode=function(){var t=this.normal.getHashCode();return t=397*t^(this.d||0)},t.prototype.normalize=function(){var t=Math.sqrt(this.normal.x*this.normal.x+this.normal.y*this.normal.y+this.normal.z*this.normal.z),i=0;return 0!==t&&(i=1/t),this.normal.x*=i,this.normal.y*=i,this.normal.z*=i,this.d*=i,this},t.prototype.transform=function(i){var n=u.Transpose(i),r=this.normal.x,o=this.normal.y,s=this.normal.z,e=this.d,h=r*n.m[0]+o*n.m[1]+s*n.m[2]+e*n.m[3],a=r*n.m[4]+o*n.m[5]+s*n.m[6]+e*n.m[7],m=r*n.m[8]+o*n.m[9]+s*n.m[10]+e*n.m[11],y=r*n.m[12]+o*n.m[13]+s*n.m[14]+e*n.m[15];return new t(h,a,m,y)},t.prototype.dotCoordinate=function(t){return this.normal.x*t.x+this.normal.y*t.y+this.normal.z*t.z+this.d},t.prototype.copyFromPoints=function(t,i,n){var r,o=i.x-t.x,s=i.y-t.y,e=i.z-t.z,h=n.x-t.x,a=n.y-t.y,u=n.z-t.z,m=s*u-e*a,y=e*h-o*u,c=o*a-s*h,p=Math.sqrt(m*m+y*y+c*c);return r=0!==p?1/p:0,this.normal.x=m*r,this.normal.y=y*r,this.normal.z=c*r,this.d=-(this.normal.x*t.x+this.normal.y*t.y+this.normal.z*t.z),this},t.prototype.isFrontFacingTo=function(t,i){var n=s.Dot(this.normal,t);return i>=n},t.prototype.signedDistanceTo=function(t){return s.Dot(t,this.normal)+this.d},t.FromArray=function(i){return new t(i[0],i[1],i[2],i[3])},t.FromPoints=function(i,n,r){var o=new t(0,0,0,0);return o.copyFromPoints(i,n,r),o},t.FromPositionAndNormal=function(i,n){var r=new t(0,0,0,0);return n.normalize(),r.normal=n,r.d=-(n.x*i.x+n.y*i.y+n.z*i.z),r},t.SignedDistanceToPlaneFromPositionAndNormal=function(t,i,n){var r=-(i.x*t.x+i.y*t.y+i.z*t.z);return s.Dot(n,i)+r},t}();t.Plane=m;var y=function(){function t(t,i,n,r){this.x=t,this.y=i,this.width=n,this.height=r}return t.prototype.toGlobal=function(i,n){return new t(this.x*i,this.y*n,this.width*i,this.height*n)},t}();t.Viewport=y;var c=function(){function t(){}return t.GetPlanes=function(i){for(var n=[],r=0;6>r;r++)n.push(new m(0,0,0,0));return t.GetPlanesToRef(i,n),n},t.GetPlanesToRef=function(t,i){i[0].normal.x=t.m[3]+t.m[2],i[0].normal.y=t.m[7]+t.m[6],i[0].normal.z=t.m[11]+t.m[10],i[0].d=t.m[15]+t.m[14],i[0].normalize(),i[1].normal.x=t.m[3]-t.m[2],i[1].normal.y=t.m[7]-t.m[6],i[1].normal.z=t.m[11]-t.m[10],i[1].d=t.m[15]-t.m[14],i[1].normalize(),i[2].normal.x=t.m[3]+t.m[0],i[2].normal.y=t.m[7]+t.m[4],i[2].normal.z=t.m[11]+t.m[8],i[2].d=t.m[15]+t.m[12],i[2].normalize(),i[3].normal.x=t.m[3]-t.m[0],i[3].normal.y=t.m[7]-t.m[4],i[3].normal.z=t.m[11]-t.m[8],i[3].d=t.m[15]-t.m[12],i[3].normalize(),i[4].normal.x=t.m[3]-t.m[1],i[4].normal.y=t.m[7]-t.m[5],i[4].normal.z=t.m[11]-t.m[9],i[4].d=t.m[15]-t.m[13],i[4].normalize(),i[5].normal.x=t.m[3]+t.m[1],i[5].normal.y=t.m[7]+t.m[5],i[5].normal.z=t.m[11]+t.m[9],i[5].d=t.m[15]+t.m[13],i[5].normalize()},t}();t.Frustum=c,function(t){t[t.LOCAL=0]="LOCAL",t[t.WORLD=1]="WORLD"}(t.Space||(t.Space={}));var p=(t.Space,function(){function t(){}return t.X=new s(1,0,0),t.Y=new s(0,1,0),t.Z=new s(0,0,1),t}());t.Axis=p;var f=function(){function t(){}return t.interpolate=function(t,i,n,r,o){for(var s=1-3*r+3*i,e=3*r-6*i,h=3*i,a=t,u=0;5>u;u++){var m=a*a,y=m*a,c=s*y+e*m+h*a,p=1/(3*s*m+2*e*a+h);a-=(c-t)*p,a=Math.min(1,Math.max(0,a))}return 3*Math.pow(1-a,2)*a*n+3*(1-a)*Math.pow(a,2)*o+Math.pow(a,3)},t}();t.BezierCurve=f,function(t){t[t.CW=0]="CW",t[t.CCW=1]="CCW"}(t.Orientation||(t.Orientation={}));var l=t.Orientation,x=function(){function t(t){var i=this;this.degrees=function(){return 180*i._radians/Math.PI},this.radians=function(){return i._radians},this._radians=t,this._radians<0&&(this._radians+=2*Math.PI)}return t.BetweenTwoPoints=function(i,n){var r=n.subtract(i),o=Math.atan2(r.y,r.x);return new t(o)},t.FromRadians=function(i){return new t(i)},t.FromDegrees=function(i){return new t(i*Math.PI/180)},t}();t.Angle=x;var z=function(){function t(t,i,n){this.startPoint=t,this.midPoint=i,this.endPoint=n;var r=Math.pow(i.x,2)+Math.pow(i.y,2),s=(Math.pow(t.x,2)+Math.pow(t.y,2)-r)/2,e=(r-Math.pow(n.x,2)-Math.pow(n.y,2))/2,h=(t.x-i.x)*(i.y-n.y)-(i.x-n.x)*(t.y-i.y);this.centerPoint=new o((s*(i.y-n.y)-e*(t.y-i.y))/h,((t.x-i.x)*e-(i.x-n.x)*s)/h),this.radius=this.centerPoint.subtract(this.startPoint).length(),this.startAngle=x.BetweenTwoPoints(this.centerPoint,this.startPoint);var a=this.startAngle.degrees(),u=x.BetweenTwoPoints(this.centerPoint,this.midPoint).degrees(),m=x.BetweenTwoPoints(this.centerPoint,this.endPoint).degrees();u-a>180&&(u-=360),-180>u-a&&(u+=360),m-u>180&&(m-=360),-180>m-u&&(m+=360),this.orientation=0>u-a?l.CW:l.CCW,this.angle=x.FromDegrees(this.orientation===l.CW?a-m:m-a)}return t}();t.Arc2=z;var w=function(){function t(t,i){this._points=new Array,this._length=0,this.closed=!1,this._points.push(new o(t,i))}return t.prototype.addLineTo=function(t,i){if(closed)return this;var n=new o(t,i),r=this._points[this._points.length-1];return this._points.push(n),this._length+=n.subtract(r).length(),this},t.prototype.addArcTo=function(t,i,n,r,s){if(void 0===s&&(s=36),closed)return this;var e=this._points[this._points.length-1],h=new o(t,i),a=new o(n,r),u=new z(e,h,a),m=u.angle.radians()/s;u.orientation===l.CW&&(m*=-1);for(var y=u.startAngle.radians()+m,c=0;s>c;c++){var p=Math.cos(y)*u.radius+u.centerPoint.x,f=Math.sin(y)*u.radius+u.centerPoint.y;this.addLineTo(p,f),y+=m}return this},t.prototype.close=function(){return this.closed=!0,this},t.prototype.length=function(){var t=this._length;if(!this.closed){var i=this._points[this._points.length-1],n=this._points[0];t+=n.subtract(i).length()}return t},t.prototype.getPoints=function(){return this._points},t.prototype.getPointAtLengthPosition=function(t){if(0>t||t>1)return o.Zero();for(var i=t*this.length(),n=0,r=0;r<this._points.length;r++){var s=(r+1)%this._points.length,e=this._points[r],h=this._points[s],a=h.subtract(e),u=a.length()+n;if(i>=n&&u>=i){var m=a.normalize(),y=i-n;return new o(e.x+m.x*y,e.y+m.y*y)}n=u}return o.Zero()},t.StartingAt=function(i,n){return new t(i,n)},t}();t.Path2=w;var v=function(){function n(t,i,n){this.path=t,this._curve=new Array,this._distances=new Array,this._tangents=new Array,this._normals=new Array,this._binormals=new Array;for(var r=0;r<t.length;r++)this._curve[r]=t[r].clone();this._raw=n||!1,this._compute(i)}return n.prototype.getCurve=function(){return this._curve},n.prototype.getTangents=function(){return this._tangents},n.prototype.getNormals=function(){return this._normals},n.prototype.getBinormals=function(){return this._binormals},n.prototype.getDistances=function(){return this._distances},n.prototype.update=function(t,i){for(var n=0;n<t.length;n++)this._curve[n].x=t[n].x,this._curve[n].y=t[n].y,this._curve[n].z=t[n].z;return this._compute(i),this},n.prototype._compute=function(t){var i=this._curve.length;this._tangents[0]=this._getFirstNonNullVector(0),this._raw||this._tangents[0].normalize(),this._tangents[i-1]=this._curve[i-1].subtract(this._curve[i-2]),this._raw||this._tangents[i-1].normalize();var n=this._tangents[0],r=this._normalVector(this._curve[0],n,t);this._normals[0]=r,this._raw||this._normals[0].normalize(),this._binormals[0]=s.Cross(n,this._normals[0]),this._raw||this._binormals[0].normalize(),this._distances[0]=0;for(var o,e,h,a,u=1;i>u;u++)o=this._getLastNonNullVector(u),i-1>u&&(e=this._getFirstNonNullVector(u),this._tangents[u]=o.add(e),this._tangents[u].normalize()),this._distances[u]=this._distances[u-1]+o.length(),h=this._tangents[u],a=this._binormals[u-1],this._normals[u]=s.Cross(a,h),this._raw||this._normals[u].normalize(),this._binormals[u]=s.Cross(h,this._normals[u]),this._raw||this._binormals[u].normalize()},n.prototype._getFirstNonNullVector=function(t){for(var i=1,n=this._curve[t+i].subtract(this._curve[t]);0===n.length()&&t+i+1<this._curve.length;)i++,n=this._curve[t+i].subtract(this._curve[t]);return n},n.prototype._getLastNonNullVector=function(t){for(var i=1,n=this._curve[t].subtract(this._curve[t-i]);0===n.length()&&t>i+1;)i++,n=this._curve[t].subtract(this._curve[t-i]);return n},n.prototype._normalVector=function(n,r,o){var e;if(void 0===o||null===o){var h;i.WithinEpsilon(r.y,1,t.Epsilon)?i.WithinEpsilon(r.x,1,t.Epsilon)?i.WithinEpsilon(r.z,1,t.Epsilon)||(h=new s(0,0,1)):h=new s(1,0,0):h=new s(0,-1,0),e=s.Cross(r,h)}else e=s.Cross(r,o),s.CrossToRef(e,r,e);return e.normalize(),e},n}();t.Path3D=v;var d=function(){function t(t){this._length=0,this._points=t,this._length=this._computeLength(t)}return t.CreateQuadraticBezier=function(i,n,r,o){o=o>2?o:3;for(var e=new Array,h=function(t,i,n,r){var o=(1-t)*(1-t)*i+2*t*(1-t)*n+t*t*r;return o},a=0;o>=a;a++)e.push(new s(h(a/o,i.x,n.x,r.x),h(a/o,i.y,n.y,r.y),h(a/o,i.z,n.z,r.z)));return new t(e)},t.CreateCubicBezier=function(i,n,r,o,e){e=e>3?e:4;for(var h=new Array,a=function(t,i,n,r,o){var s=(1-t)*(1-t)*(1-t)*i+3*t*(1-t)*(1-t)*n+3*t*t*(1-t)*r+t*t*t*o;return s},u=0;e>=u;u++)h.push(new s(a(u/e,i.x,n.x,r.x,o.x),a(u/e,i.y,n.y,r.y,o.y),a(u/e,i.z,n.z,r.z,o.z)));return new t(h)},t.CreateHermiteSpline=function(i,n,r,o,e){for(var h=new Array,a=1/e,u=0;e>=u;u++)h.push(s.Hermite(i,n,r,o,u*a));return new t(h)},t.prototype.getPoints=function(){return this._points},t.prototype.length=function(){return this._length},t.prototype["continue"]=function(i){for(var n=this._points[this._points.length-1],r=this._points.slice(),o=i.getPoints(),s=1;s<o.length;s++)r.push(o[s].subtract(o[0]).add(n));var e=new t(r);return e},t.prototype._computeLength=function(t){for(var i=0,n=1;n<t.length;n++)i+=t[n].subtract(t[n-1]).length();return i},t}();t.Curve3=d;var g=function(){function t(){this.L00=s.Zero(),this.L1_1=s.Zero(),this.L10=s.Zero(),this.L11=s.Zero(),this.L2_2=s.Zero(),this.L2_1=s.Zero(),this.L20=s.Zero(),this.L21=s.Zero(),this.L22=s.Zero()}return t.prototype.addLight=function(t,i,n){var r=new s(i.r,i.g,i.b),o=r.scale(n);this.L00=this.L00.add(o.scale(.282095)),this.L1_1=this.L1_1.add(o.scale(.488603*t.y)),this.L10=this.L10.add(o.scale(.488603*t.z)),this.L11=this.L11.add(o.scale(.488603*t.x)),this.L2_2=this.L2_2.add(o.scale(1.092548*t.x*t.y)),this.L2_1=this.L2_1.add(o.scale(1.092548*t.y*t.z)),this.L21=this.L21.add(o.scale(1.092548*t.x*t.z)),this.L20=this.L20.add(o.scale(.315392*(3*t.z*t.z-1))),this.L22=this.L22.add(o.scale(.546274*(t.x*t.x-t.y*t.y)))},t.prototype.scale=function(t){this.L00=this.L00.scale(t),this.L1_1=this.L1_1.scale(t),this.L10=this.L10.scale(t),this.L11=this.L11.scale(t),this.L2_2=this.L2_2.scale(t),this.L2_1=this.L2_1.scale(t),this.L20=this.L20.scale(t),this.L21=this.L21.scale(t),this.L22=this.L22.scale(t)},t}();t.SphericalHarmonics=g;var T=function(){function t(){this.x=s.Zero(),this.y=s.Zero(),this.z=s.Zero(),this.xx=s.Zero(),this.yy=s.Zero(),this.zz=s.Zero(),this.xy=s.Zero(),this.yz=s.Zero(),this.zx=s.Zero()}return t.prototype.addAmbient=function(t){var i=new s(t.r,t.g,t.b);this.xx=this.xx.add(i),this.yy=this.yy.add(i),this.zz=this.zz.add(i)},t.getSphericalPolynomialFromHarmonics=function(i){var n=new t;return n.x=i.L11.scale(1.02333),n.y=i.L1_1.scale(1.02333),n.z=i.L10.scale(1.02333),n.xx=i.L00.scale(.886277).subtract(i.L20.scale(.247708)).add(i.L22.scale(.429043)),n.yy=i.L00.scale(.886277).subtract(i.L20.scale(.247708)).subtract(i.L22.scale(.429043)),n.zz=i.L00.scale(.886277).add(i.L20.scale(.495417)),n.yz=i.L2_1.scale(.858086),n.zx=i.L21.scale(.858086),n.xy=i.L2_2.scale(.858086),n},t}();t.SphericalPolynomial=T;var R=function(){function t(t,i){void 0===t&&(t=s.Zero()),void 0===i&&(i=s.Up()),this.position=t,this.normal=i}return t.prototype.clone=function(){return new t(this.position.clone(),this.normal.clone())},t}();t.PositionNormalVertex=R;var _=function(){function t(t,i,n){void 0===t&&(t=s.Zero()),void 0===i&&(i=s.Up()),void 0===n&&(n=o.Zero()),this.position=t,this.normal=i,this.uv=n}return t.prototype.clone=function(){return new t(this.position.clone(),this.normal.clone(),this.uv.clone())},t}();t.PositionNormalTextureVertex=_;var M=function(){function t(){}return t.Color3=[n.Black(),n.Black(),n.Black()],t.Vector2=[o.Zero(),o.Zero(),o.Zero()],t.Vector3=[s.Zero(),s.Zero(),s.Zero(),s.Zero(),s.Zero(),s.Zero(),s.Zero(),s.Zero(),s.Zero()],t.Vector4=[e.Zero(),e.Zero(),e.Zero()],t.Quaternion=[new a(0,0,0,0)],t.Matrix=[u.Zero(),u.Zero(),u.Zero(),u.Zero(),u.Zero(),u.Zero(),u.Zero(),u.Zero()],t}();t.Tmp=M}(BABYLON||(BABYLON={}));',
("undefined"!=typeof window&&window.module||"undefined"!=typeof module)&&"undefined"!=typeof module.exports&&(module.exports=BABYLON);
},{}],3:[function(require,module,exports){
(function (Buffer){
(function (global, module) {

  var exports = module.exports;

  /**
   * Exports.
   */

  module.exports = expect;
  expect.Assertion = Assertion;

  /**
   * Exports version.
   */

  expect.version = '0.3.1';

  /**
   * Possible assertion flags.
   */

  var flags = {
      not: ['to', 'be', 'have', 'include', 'only']
    , to: ['be', 'have', 'include', 'only', 'not']
    , only: ['have']
    , have: ['own']
    , be: ['an']
  };

  function expect (obj) {
    return new Assertion(obj);
  }

  /**
   * Constructor
   *
   * @api private
   */

  function Assertion (obj, flag, parent) {
    this.obj = obj;
    this.flags = {};

    if (undefined != parent) {
      this.flags[flag] = true;

      for (var i in parent.flags) {
        if (parent.flags.hasOwnProperty(i)) {
          this.flags[i] = true;
        }
      }
    }

    var $flags = flag ? flags[flag] : keys(flags)
      , self = this;

    if ($flags) {
      for (var i = 0, l = $flags.length; i < l; i++) {
        // avoid recursion
        if (this.flags[$flags[i]]) continue;

        var name = $flags[i]
          , assertion = new Assertion(this.obj, name, this)

        if ('function' == typeof Assertion.prototype[name]) {
          // clone the function, make sure we dont touch the prot reference
          var old = this[name];
          this[name] = function () {
            return old.apply(self, arguments);
          };

          for (var fn in Assertion.prototype) {
            if (Assertion.prototype.hasOwnProperty(fn) && fn != name) {
              this[name][fn] = bind(assertion[fn], assertion);
            }
          }
        } else {
          this[name] = assertion;
        }
      }
    }
  }

  /**
   * Performs an assertion
   *
   * @api private
   */

  Assertion.prototype.assert = function (truth, msg, error, expected) {
    var msg = this.flags.not ? error : msg
      , ok = this.flags.not ? !truth : truth
      , err;

    if (!ok) {
      err = new Error(msg.call(this));
      if (arguments.length > 3) {
        err.actual = this.obj;
        err.expected = expected;
        err.showDiff = true;
      }
      throw err;
    }

    this.and = new Assertion(this.obj);
  };

  /**
   * Check if the value is truthy
   *
   * @api public
   */

  Assertion.prototype.ok = function () {
    this.assert(
        !!this.obj
      , function(){ return 'expected ' + i(this.obj) + ' to be truthy' }
      , function(){ return 'expected ' + i(this.obj) + ' to be falsy' });
  };

  /**
   * Creates an anonymous function which calls fn with arguments.
   *
   * @api public
   */

  Assertion.prototype.withArgs = function() {
    expect(this.obj).to.be.a('function');
    var fn = this.obj;
    var args = Array.prototype.slice.call(arguments);
    return expect(function() { fn.apply(null, args); });
  };

  /**
   * Assert that the function throws.
   *
   * @param {Function|RegExp} callback, or regexp to match error string against
   * @api public
   */

  Assertion.prototype.throwError =
  Assertion.prototype.throwException = function (fn) {
    expect(this.obj).to.be.a('function');

    var thrown = false
      , not = this.flags.not;

    try {
      this.obj();
    } catch (e) {
      if (isRegExp(fn)) {
        var subject = 'string' == typeof e ? e : e.message;
        if (not) {
          expect(subject).to.not.match(fn);
        } else {
          expect(subject).to.match(fn);
        }
      } else if ('function' == typeof fn) {
        fn(e);
      }
      thrown = true;
    }

    if (isRegExp(fn) && not) {
      // in the presence of a matcher, ensure the `not` only applies to
      // the matching.
      this.flags.not = false;
    }

    var name = this.obj.name || 'fn';
    this.assert(
        thrown
      , function(){ return 'expected ' + name + ' to throw an exception' }
      , function(){ return 'expected ' + name + ' not to throw an exception' });
  };

  /**
   * Checks if the array is empty.
   *
   * @api public
   */

  Assertion.prototype.empty = function () {
    var expectation;

    if ('object' == typeof this.obj && null !== this.obj && !isArray(this.obj)) {
      if ('number' == typeof this.obj.length) {
        expectation = !this.obj.length;
      } else {
        expectation = !keys(this.obj).length;
      }
    } else {
      if ('string' != typeof this.obj) {
        expect(this.obj).to.be.an('object');
      }

      expect(this.obj).to.have.property('length');
      expectation = !this.obj.length;
    }

    this.assert(
        expectation
      , function(){ return 'expected ' + i(this.obj) + ' to be empty' }
      , function(){ return 'expected ' + i(this.obj) + ' to not be empty' });
    return this;
  };

  /**
   * Checks if the obj exactly equals another.
   *
   * @api public
   */

  Assertion.prototype.be =
  Assertion.prototype.equal = function (obj) {
    this.assert(
        obj === this.obj
      , function(){ return 'expected ' + i(this.obj) + ' to equal ' + i(obj) }
      , function(){ return 'expected ' + i(this.obj) + ' to not equal ' + i(obj) });
    return this;
  };

  /**
   * Checks if the obj sortof equals another.
   *
   * @api public
   */

  Assertion.prototype.eql = function (obj) {
    this.assert(
        expect.eql(this.obj, obj)
      , function(){ return 'expected ' + i(this.obj) + ' to sort of equal ' + i(obj) }
      , function(){ return 'expected ' + i(this.obj) + ' to sort of not equal ' + i(obj) }
      , obj);
    return this;
  };

  /**
   * Assert within start to finish (inclusive).
   *
   * @param {Number} start
   * @param {Number} finish
   * @api public
   */

  Assertion.prototype.within = function (start, finish) {
    var range = start + '..' + finish;
    this.assert(
        this.obj >= start && this.obj <= finish
      , function(){ return 'expected ' + i(this.obj) + ' to be within ' + range }
      , function(){ return 'expected ' + i(this.obj) + ' to not be within ' + range });
    return this;
  };

  /**
   * Assert typeof / instance of
   *
   * @api public
   */

  Assertion.prototype.a =
  Assertion.prototype.an = function (type) {
    if ('string' == typeof type) {
      // proper english in error msg
      var n = /^[aeiou]/.test(type) ? 'n' : '';

      // typeof with support for 'array'
      this.assert(
          'array' == type ? isArray(this.obj) :
            'regexp' == type ? isRegExp(this.obj) :
              'object' == type
                ? 'object' == typeof this.obj && null !== this.obj
                : type == typeof this.obj
        , function(){ return 'expected ' + i(this.obj) + ' to be a' + n + ' ' + type }
        , function(){ return 'expected ' + i(this.obj) + ' not to be a' + n + ' ' + type });
    } else {
      // instanceof
      var name = type.name || 'supplied constructor';
      this.assert(
          this.obj instanceof type
        , function(){ return 'expected ' + i(this.obj) + ' to be an instance of ' + name }
        , function(){ return 'expected ' + i(this.obj) + ' not to be an instance of ' + name });
    }

    return this;
  };

  /**
   * Assert numeric value above _n_.
   *
   * @param {Number} n
   * @api public
   */

  Assertion.prototype.greaterThan =
  Assertion.prototype.above = function (n) {
    this.assert(
        this.obj > n
      , function(){ return 'expected ' + i(this.obj) + ' to be above ' + n }
      , function(){ return 'expected ' + i(this.obj) + ' to be below ' + n });
    return this;
  };

  /**
   * Assert numeric value below _n_.
   *
   * @param {Number} n
   * @api public
   */

  Assertion.prototype.lessThan =
  Assertion.prototype.below = function (n) {
    this.assert(
        this.obj < n
      , function(){ return 'expected ' + i(this.obj) + ' to be below ' + n }
      , function(){ return 'expected ' + i(this.obj) + ' to be above ' + n });
    return this;
  };

  /**
   * Assert string value matches _regexp_.
   *
   * @param {RegExp} regexp
   * @api public
   */

  Assertion.prototype.match = function (regexp) {
    this.assert(
        regexp.exec(this.obj)
      , function(){ return 'expected ' + i(this.obj) + ' to match ' + regexp }
      , function(){ return 'expected ' + i(this.obj) + ' not to match ' + regexp });
    return this;
  };

  /**
   * Assert property "length" exists and has value of _n_.
   *
   * @param {Number} n
   * @api public
   */

  Assertion.prototype.length = function (n) {
    expect(this.obj).to.have.property('length');
    var len = this.obj.length;
    this.assert(
        n == len
      , function(){ return 'expected ' + i(this.obj) + ' to have a length of ' + n + ' but got ' + len }
      , function(){ return 'expected ' + i(this.obj) + ' to not have a length of ' + len });
    return this;
  };

  /**
   * Assert property _name_ exists, with optional _val_.
   *
   * @param {String} name
   * @param {Mixed} val
   * @api public
   */

  Assertion.prototype.property = function (name, val) {
    if (this.flags.own) {
      this.assert(
          Object.prototype.hasOwnProperty.call(this.obj, name)
        , function(){ return 'expected ' + i(this.obj) + ' to have own property ' + i(name) }
        , function(){ return 'expected ' + i(this.obj) + ' to not have own property ' + i(name) });
      return this;
    }

    if (this.flags.not && undefined !== val) {
      if (undefined === this.obj[name]) {
        throw new Error(i(this.obj) + ' has no property ' + i(name));
      }
    } else {
      var hasProp;
      try {
        hasProp = name in this.obj
      } catch (e) {
        hasProp = undefined !== this.obj[name]
      }

      this.assert(
          hasProp
        , function(){ return 'expected ' + i(this.obj) + ' to have a property ' + i(name) }
        , function(){ return 'expected ' + i(this.obj) + ' to not have a property ' + i(name) });
    }

    if (undefined !== val) {
      this.assert(
          val === this.obj[name]
        , function(){ return 'expected ' + i(this.obj) + ' to have a property ' + i(name)
          + ' of ' + i(val) + ', but got ' + i(this.obj[name]) }
        , function(){ return 'expected ' + i(this.obj) + ' to not have a property ' + i(name)
          + ' of ' + i(val) });
    }

    this.obj = this.obj[name];
    return this;
  };

  /**
   * Assert that the array contains _obj_ or string contains _obj_.
   *
   * @param {Mixed} obj|string
   * @api public
   */

  Assertion.prototype.string =
  Assertion.prototype.contain = function (obj) {
    if ('string' == typeof this.obj) {
      this.assert(
          ~this.obj.indexOf(obj)
        , function(){ return 'expected ' + i(this.obj) + ' to contain ' + i(obj) }
        , function(){ return 'expected ' + i(this.obj) + ' to not contain ' + i(obj) });
    } else {
      this.assert(
          ~indexOf(this.obj, obj)
        , function(){ return 'expected ' + i(this.obj) + ' to contain ' + i(obj) }
        , function(){ return 'expected ' + i(this.obj) + ' to not contain ' + i(obj) });
    }
    return this;
  };

  /**
   * Assert exact keys or inclusion of keys by using
   * the `.own` modifier.
   *
   * @param {Array|String ...} keys
   * @api public
   */

  Assertion.prototype.key =
  Assertion.prototype.keys = function ($keys) {
    var str
      , ok = true;

    $keys = isArray($keys)
      ? $keys
      : Array.prototype.slice.call(arguments);

    if (!$keys.length) throw new Error('keys required');

    var actual = keys(this.obj)
      , len = $keys.length;

    // Inclusion
    ok = every($keys, function (key) {
      return ~indexOf(actual, key);
    });

    // Strict
    if (!this.flags.not && this.flags.only) {
      ok = ok && $keys.length == actual.length;
    }

    // Key string
    if (len > 1) {
      $keys = map($keys, function (key) {
        return i(key);
      });
      var last = $keys.pop();
      str = $keys.join(', ') + ', and ' + last;
    } else {
      str = i($keys[0]);
    }

    // Form
    str = (len > 1 ? 'keys ' : 'key ') + str;

    // Have / include
    str = (!this.flags.only ? 'include ' : 'only have ') + str;

    // Assertion
    this.assert(
        ok
      , function(){ return 'expected ' + i(this.obj) + ' to ' + str }
      , function(){ return 'expected ' + i(this.obj) + ' to not ' + str });

    return this;
  };

  /**
   * Assert a failure.
   *
   * @param {String ...} custom message
   * @api public
   */
  Assertion.prototype.fail = function (msg) {
    var error = function() { return msg || "explicit failure"; }
    this.assert(false, error, error);
    return this;
  };

  /**
   * Function bind implementation.
   */

  function bind (fn, scope) {
    return function () {
      return fn.apply(scope, arguments);
    }
  }

  /**
   * Array every compatibility
   *
   * @see bit.ly/5Fq1N2
   * @api public
   */

  function every (arr, fn, thisObj) {
    var scope = thisObj || global;
    for (var i = 0, j = arr.length; i < j; ++i) {
      if (!fn.call(scope, arr[i], i, arr)) {
        return false;
      }
    }
    return true;
  }

  /**
   * Array indexOf compatibility.
   *
   * @see bit.ly/a5Dxa2
   * @api public
   */

  function indexOf (arr, o, i) {
    if (Array.prototype.indexOf) {
      return Array.prototype.indexOf.call(arr, o, i);
    }

    if (arr.length === undefined) {
      return -1;
    }

    for (var j = arr.length, i = i < 0 ? i + j < 0 ? 0 : i + j : i || 0
        ; i < j && arr[i] !== o; i++);

    return j <= i ? -1 : i;
  }

  // https://gist.github.com/1044128/
  var getOuterHTML = function(element) {
    if ('outerHTML' in element) return element.outerHTML;
    var ns = "http://www.w3.org/1999/xhtml";
    var container = document.createElementNS(ns, '_');
    var xmlSerializer = new XMLSerializer();
    var html;
    if (document.xmlVersion) {
      return xmlSerializer.serializeToString(element);
    } else {
      container.appendChild(element.cloneNode(false));
      html = container.innerHTML.replace('><', '>' + element.innerHTML + '<');
      container.innerHTML = '';
      return html;
    }
  };

  // Returns true if object is a DOM element.
  var isDOMElement = function (object) {
    if (typeof HTMLElement === 'object') {
      return object instanceof HTMLElement;
    } else {
      return object &&
        typeof object === 'object' &&
        object.nodeType === 1 &&
        typeof object.nodeName === 'string';
    }
  };

  /**
   * Inspects an object.
   *
   * @see taken from node.js `util` module (copyright Joyent, MIT license)
   * @api private
   */

  function i (obj, showHidden, depth) {
    var seen = [];

    function stylize (str) {
      return str;
    }

    function format (value, recurseTimes) {
      // Provide a hook for user-specified inspect functions.
      // Check that value is an object with an inspect function on it
      if (value && typeof value.inspect === 'function' &&
          // Filter out the util module, it's inspect function is special
          value !== exports &&
          // Also filter out any prototype objects using the circular check.
          !(value.constructor && value.constructor.prototype === value)) {
        return value.inspect(recurseTimes);
      }

      // Primitive types cannot have properties
      switch (typeof value) {
        case 'undefined':
          return stylize('undefined', 'undefined');

        case 'string':
          var simple = '\'' + json.stringify(value).replace(/^"|"$/g, '')
                                                   .replace(/'/g, "\\'")
                                                   .replace(/\\"/g, '"') + '\'';
          return stylize(simple, 'string');

        case 'number':
          return stylize('' + value, 'number');

        case 'boolean':
          return stylize('' + value, 'boolean');
      }
      // For some reason typeof null is "object", so special case here.
      if (value === null) {
        return stylize('null', 'null');
      }

      if (isDOMElement(value)) {
        return getOuterHTML(value);
      }

      // Look up the keys of the object.
      var visible_keys = keys(value);
      var $keys = showHidden ? Object.getOwnPropertyNames(value) : visible_keys;

      // Functions without properties can be shortcutted.
      if (typeof value === 'function' && $keys.length === 0) {
        if (isRegExp(value)) {
          return stylize('' + value, 'regexp');
        } else {
          var name = value.name ? ': ' + value.name : '';
          return stylize('[Function' + name + ']', 'special');
        }
      }

      // Dates without properties can be shortcutted
      if (isDate(value) && $keys.length === 0) {
        return stylize(value.toUTCString(), 'date');
      }
      
      // Error objects can be shortcutted
      if (value instanceof Error) {
        return stylize("["+value.toString()+"]", 'Error');
      }

      var base, type, braces;
      // Determine the object type
      if (isArray(value)) {
        type = 'Array';
        braces = ['[', ']'];
      } else {
        type = 'Object';
        braces = ['{', '}'];
      }

      // Make functions say that they are functions
      if (typeof value === 'function') {
        var n = value.name ? ': ' + value.name : '';
        base = (isRegExp(value)) ? ' ' + value : ' [Function' + n + ']';
      } else {
        base = '';
      }

      // Make dates with properties first say the date
      if (isDate(value)) {
        base = ' ' + value.toUTCString();
      }

      if ($keys.length === 0) {
        return braces[0] + base + braces[1];
      }

      if (recurseTimes < 0) {
        if (isRegExp(value)) {
          return stylize('' + value, 'regexp');
        } else {
          return stylize('[Object]', 'special');
        }
      }

      seen.push(value);

      var output = map($keys, function (key) {
        var name, str;
        if (value.__lookupGetter__) {
          if (value.__lookupGetter__(key)) {
            if (value.__lookupSetter__(key)) {
              str = stylize('[Getter/Setter]', 'special');
            } else {
              str = stylize('[Getter]', 'special');
            }
          } else {
            if (value.__lookupSetter__(key)) {
              str = stylize('[Setter]', 'special');
            }
          }
        }
        if (indexOf(visible_keys, key) < 0) {
          name = '[' + key + ']';
        }
        if (!str) {
          if (indexOf(seen, value[key]) < 0) {
            if (recurseTimes === null) {
              str = format(value[key]);
            } else {
              str = format(value[key], recurseTimes - 1);
            }
            if (str.indexOf('\n') > -1) {
              if (isArray(value)) {
                str = map(str.split('\n'), function (line) {
                  return '  ' + line;
                }).join('\n').substr(2);
              } else {
                str = '\n' + map(str.split('\n'), function (line) {
                  return '   ' + line;
                }).join('\n');
              }
            }
          } else {
            str = stylize('[Circular]', 'special');
          }
        }
        if (typeof name === 'undefined') {
          if (type === 'Array' && key.match(/^\d+$/)) {
            return str;
          }
          name = json.stringify('' + key);
          if (name.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)) {
            name = name.substr(1, name.length - 2);
            name = stylize(name, 'name');
          } else {
            name = name.replace(/'/g, "\\'")
                       .replace(/\\"/g, '"')
                       .replace(/(^"|"$)/g, "'");
            name = stylize(name, 'string');
          }
        }

        return name + ': ' + str;
      });

      seen.pop();

      var numLinesEst = 0;
      var length = reduce(output, function (prev, cur) {
        numLinesEst++;
        if (indexOf(cur, '\n') >= 0) numLinesEst++;
        return prev + cur.length + 1;
      }, 0);

      if (length > 50) {
        output = braces[0] +
                 (base === '' ? '' : base + '\n ') +
                 ' ' +
                 output.join(',\n  ') +
                 ' ' +
                 braces[1];

      } else {
        output = braces[0] + base + ' ' + output.join(', ') + ' ' + braces[1];
      }

      return output;
    }
    return format(obj, (typeof depth === 'undefined' ? 2 : depth));
  }

  expect.stringify = i;

  function isArray (ar) {
    return Object.prototype.toString.call(ar) === '[object Array]';
  }

  function isRegExp(re) {
    var s;
    try {
      s = '' + re;
    } catch (e) {
      return false;
    }

    return re instanceof RegExp || // easy case
           // duck-type for context-switching evalcx case
           typeof(re) === 'function' &&
           re.constructor.name === 'RegExp' &&
           re.compile &&
           re.test &&
           re.exec &&
           s.match(/^\/.*\/[gim]{0,3}$/);
  }

  function isDate(d) {
    return d instanceof Date;
  }

  function keys (obj) {
    if (Object.keys) {
      return Object.keys(obj);
    }

    var keys = [];

    for (var i in obj) {
      if (Object.prototype.hasOwnProperty.call(obj, i)) {
        keys.push(i);
      }
    }

    return keys;
  }

  function map (arr, mapper, that) {
    if (Array.prototype.map) {
      return Array.prototype.map.call(arr, mapper, that);
    }

    var other= new Array(arr.length);

    for (var i= 0, n = arr.length; i<n; i++)
      if (i in arr)
        other[i] = mapper.call(that, arr[i], i, arr);

    return other;
  }

  function reduce (arr, fun) {
    if (Array.prototype.reduce) {
      return Array.prototype.reduce.apply(
          arr
        , Array.prototype.slice.call(arguments, 1)
      );
    }

    var len = +this.length;

    if (typeof fun !== "function")
      throw new TypeError();

    // no value to return if no initial value and an empty array
    if (len === 0 && arguments.length === 1)
      throw new TypeError();

    var i = 0;
    if (arguments.length >= 2) {
      var rv = arguments[1];
    } else {
      do {
        if (i in this) {
          rv = this[i++];
          break;
        }

        // if array contains no values, no initial value to return
        if (++i >= len)
          throw new TypeError();
      } while (true);
    }

    for (; i < len; i++) {
      if (i in this)
        rv = fun.call(null, rv, this[i], i, this);
    }

    return rv;
  }

  /**
   * Asserts deep equality
   *
   * @see taken from node.js `assert` module (copyright Joyent, MIT license)
   * @api private
   */

  expect.eql = function eql(actual, expected) {
    // 7.1. All identical values are equivalent, as determined by ===.
    if (actual === expected) {
      return true;
    } else if ('undefined' != typeof Buffer
      && Buffer.isBuffer(actual) && Buffer.isBuffer(expected)) {
      if (actual.length != expected.length) return false;

      for (var i = 0; i < actual.length; i++) {
        if (actual[i] !== expected[i]) return false;
      }

      return true;

      // 7.2. If the expected value is a Date object, the actual value is
      // equivalent if it is also a Date object that refers to the same time.
    } else if (actual instanceof Date && expected instanceof Date) {
      return actual.getTime() === expected.getTime();

      // 7.3. Other pairs that do not both pass typeof value == "object",
      // equivalence is determined by ==.
    } else if (typeof actual != 'object' && typeof expected != 'object') {
      return actual == expected;
    // If both are regular expression use the special `regExpEquiv` method
    // to determine equivalence.
    } else if (isRegExp(actual) && isRegExp(expected)) {
      return regExpEquiv(actual, expected);
    // 7.4. For all other Object pairs, including Array objects, equivalence is
    // determined by having the same number of owned properties (as verified
    // with Object.prototype.hasOwnProperty.call), the same set of keys
    // (although not necessarily the same order), equivalent values for every
    // corresponding key, and an identical "prototype" property. Note: this
    // accounts for both named and indexed properties on Arrays.
    } else {
      return objEquiv(actual, expected);
    }
  };

  function isUndefinedOrNull (value) {
    return value === null || value === undefined;
  }

  function isArguments (object) {
    return Object.prototype.toString.call(object) == '[object Arguments]';
  }

  function regExpEquiv (a, b) {
    return a.source === b.source && a.global === b.global &&
           a.ignoreCase === b.ignoreCase && a.multiline === b.multiline;
  }

  function objEquiv (a, b) {
    if (isUndefinedOrNull(a) || isUndefinedOrNull(b))
      return false;
    // an identical "prototype" property.
    if (a.prototype !== b.prototype) return false;
    //~~~I've managed to break Object.keys through screwy arguments passing.
    //   Converting to array solves the problem.
    if (isArguments(a)) {
      if (!isArguments(b)) {
        return false;
      }
      a = pSlice.call(a);
      b = pSlice.call(b);
      return expect.eql(a, b);
    }
    try{
      var ka = keys(a),
        kb = keys(b),
        key, i;
    } catch (e) {//happens when one is a string literal and the other isn't
      return false;
    }
    // having the same number of owned properties (keys incorporates hasOwnProperty)
    if (ka.length != kb.length)
      return false;
    //the same set of keys (although not necessarily the same order),
    ka.sort();
    kb.sort();
    //~~~cheap key test
    for (i = ka.length - 1; i >= 0; i--) {
      if (ka[i] != kb[i])
        return false;
    }
    //equivalent values for every corresponding key, and
    //~~~possibly expensive deep test
    for (i = ka.length - 1; i >= 0; i--) {
      key = ka[i];
      if (!expect.eql(a[key], b[key]))
         return false;
    }
    return true;
  }

  var json = (function () {
    "use strict";

    if ('object' == typeof JSON && JSON.parse && JSON.stringify) {
      return {
          parse: nativeJSON.parse
        , stringify: nativeJSON.stringify
      }
    }

    var JSON = {};

    function f(n) {
        // Format integers to have at least two digits.
        return n < 10 ? '0' + n : n;
    }

    function date(d, key) {
      return isFinite(d.valueOf()) ?
          d.getUTCFullYear()     + '-' +
          f(d.getUTCMonth() + 1) + '-' +
          f(d.getUTCDate())      + 'T' +
          f(d.getUTCHours())     + ':' +
          f(d.getUTCMinutes())   + ':' +
          f(d.getUTCSeconds())   + 'Z' : null;
    }

    var cx = /[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
        escapable = /[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
        gap,
        indent,
        meta = {    // table of character substitutions
            '\b': '\\b',
            '\t': '\\t',
            '\n': '\\n',
            '\f': '\\f',
            '\r': '\\r',
            '"' : '\\"',
            '\\': '\\\\'
        },
        rep;


    function quote(string) {

  // If the string contains no control characters, no quote characters, and no
  // backslash characters, then we can safely slap some quotes around it.
  // Otherwise we must also replace the offending characters with safe escape
  // sequences.

        escapable.lastIndex = 0;
        return escapable.test(string) ? '"' + string.replace(escapable, function (a) {
            var c = meta[a];
            return typeof c === 'string' ? c :
                '\\u' + ('0000' + a.charCodeAt(0).toString(16)).slice(-4);
        }) + '"' : '"' + string + '"';
    }


    function str(key, holder) {

  // Produce a string from holder[key].

        var i,          // The loop counter.
            k,          // The member key.
            v,          // The member value.
            length,
            mind = gap,
            partial,
            value = holder[key];

  // If the value has a toJSON method, call it to obtain a replacement value.

        if (value instanceof Date) {
            value = date(key);
        }

  // If we were called with a replacer function, then call the replacer to
  // obtain a replacement value.

        if (typeof rep === 'function') {
            value = rep.call(holder, key, value);
        }

  // What happens next depends on the value's type.

        switch (typeof value) {
        case 'string':
            return quote(value);

        case 'number':

  // JSON numbers must be finite. Encode non-finite numbers as null.

            return isFinite(value) ? String(value) : 'null';

        case 'boolean':
        case 'null':

  // If the value is a boolean or null, convert it to a string. Note:
  // typeof null does not produce 'null'. The case is included here in
  // the remote chance that this gets fixed someday.

            return String(value);

  // If the type is 'object', we might be dealing with an object or an array or
  // null.

        case 'object':

  // Due to a specification blunder in ECMAScript, typeof null is 'object',
  // so watch out for that case.

            if (!value) {
                return 'null';
            }

  // Make an array to hold the partial results of stringifying this object value.

            gap += indent;
            partial = [];

  // Is the value an array?

            if (Object.prototype.toString.apply(value) === '[object Array]') {

  // The value is an array. Stringify every element. Use null as a placeholder
  // for non-JSON values.

                length = value.length;
                for (i = 0; i < length; i += 1) {
                    partial[i] = str(i, value) || 'null';
                }

  // Join all of the elements together, separated with commas, and wrap them in
  // brackets.

                v = partial.length === 0 ? '[]' : gap ?
                    '[\n' + gap + partial.join(',\n' + gap) + '\n' + mind + ']' :
                    '[' + partial.join(',') + ']';
                gap = mind;
                return v;
            }

  // If the replacer is an array, use it to select the members to be stringified.

            if (rep && typeof rep === 'object') {
                length = rep.length;
                for (i = 0; i < length; i += 1) {
                    if (typeof rep[i] === 'string') {
                        k = rep[i];
                        v = str(k, value);
                        if (v) {
                            partial.push(quote(k) + (gap ? ': ' : ':') + v);
                        }
                    }
                }
            } else {

  // Otherwise, iterate through all of the keys in the object.

                for (k in value) {
                    if (Object.prototype.hasOwnProperty.call(value, k)) {
                        v = str(k, value);
                        if (v) {
                            partial.push(quote(k) + (gap ? ': ' : ':') + v);
                        }
                    }
                }
            }

  // Join all of the member texts together, separated with commas,
  // and wrap them in braces.

            v = partial.length === 0 ? '{}' : gap ?
                '{\n' + gap + partial.join(',\n' + gap) + '\n' + mind + '}' :
                '{' + partial.join(',') + '}';
            gap = mind;
            return v;
        }
    }

  // If the JSON object does not yet have a stringify method, give it one.

    JSON.stringify = function (value, replacer, space) {

  // The stringify method takes a value and an optional replacer, and an optional
  // space parameter, and returns a JSON text. The replacer can be a function
  // that can replace values, or an array of strings that will select the keys.
  // A default replacer method can be provided. Use of the space parameter can
  // produce text that is more easily readable.

        var i;
        gap = '';
        indent = '';

  // If the space parameter is a number, make an indent string containing that
  // many spaces.

        if (typeof space === 'number') {
            for (i = 0; i < space; i += 1) {
                indent += ' ';
            }

  // If the space parameter is a string, it will be used as the indent string.

        } else if (typeof space === 'string') {
            indent = space;
        }

  // If there is a replacer, it must be a function or an array.
  // Otherwise, throw an error.

        rep = replacer;
        if (replacer && typeof replacer !== 'function' &&
                (typeof replacer !== 'object' ||
                typeof replacer.length !== 'number')) {
            throw new Error('JSON.stringify');
        }

  // Make a fake root object containing our value under the key of ''.
  // Return the result of stringifying the value.

        return str('', {'': value});
    };

  // If the JSON object does not yet have a parse method, give it one.

    JSON.parse = function (text, reviver) {
    // The parse method takes a text and an optional reviver function, and returns
    // a JavaScript value if the text is a valid JSON text.

        var j;

        function walk(holder, key) {

    // The walk method is used to recursively walk the resulting structure so
    // that modifications can be made.

            var k, v, value = holder[key];
            if (value && typeof value === 'object') {
                for (k in value) {
                    if (Object.prototype.hasOwnProperty.call(value, k)) {
                        v = walk(value, k);
                        if (v !== undefined) {
                            value[k] = v;
                        } else {
                            delete value[k];
                        }
                    }
                }
            }
            return reviver.call(holder, key, value);
        }


    // Parsing happens in four stages. In the first stage, we replace certain
    // Unicode characters with escape sequences. JavaScript handles many characters
    // incorrectly, either silently deleting them, or treating them as line endings.

        text = String(text);
        cx.lastIndex = 0;
        if (cx.test(text)) {
            text = text.replace(cx, function (a) {
                return '\\u' +
                    ('0000' + a.charCodeAt(0).toString(16)).slice(-4);
            });
        }

    // In the second stage, we run the text against regular expressions that look
    // for non-JSON patterns. We are especially concerned with '()' and 'new'
    // because they can cause invocation, and '=' because it can cause mutation.
    // But just to be safe, we want to reject all unexpected forms.

    // We split the second stage into 4 regexp operations in order to work around
    // crippling inefficiencies in IE's and Safari's regexp engines. First we
    // replace the JSON backslash pairs with '@' (a non-JSON character). Second, we
    // replace all simple value tokens with ']' characters. Third, we delete all
    // open brackets that follow a colon or comma or that begin the text. Finally,
    // we look to see that the remaining characters are only whitespace or ']' or
    // ',' or ':' or '{' or '}'. If that is so, then the text is safe for eval.

        if (/^[\],:{}\s]*$/
                .test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g, '@')
                    .replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, ']')
                    .replace(/(?:^|:|,)(?:\s*\[)+/g, ''))) {

    // In the third stage we use the eval function to compile the text into a
    // JavaScript structure. The '{' operator is subject to a syntactic ambiguity
    // in JavaScript: it can begin a block or an object literal. We wrap the text
    // in parens to eliminate the ambiguity.

            j = eval('(' + text + ')');

    // In the optional fourth stage, we recursively walk the new structure, passing
    // each name/value pair to a reviver function for possible transformation.

            return typeof reviver === 'function' ?
                walk({'': j}, '') : j;
        }

    // If the text is not JSON parseable, then a SyntaxError is thrown.

        throw new SyntaxError('JSON.parse');
    };

    return JSON;
  })();

  if ('undefined' != typeof window) {
    window.expect = module.exports;
  }

})(
    this
  , 'undefined' != typeof module ? module : {exports: {}}
);

}).call(this,require("buffer").Buffer)

},{"buffer":4}],4:[function(require,module,exports){
(function (global){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
/* eslint-disable no-proto */

'use strict'

var base64 = require('base64-js')
var ieee754 = require('ieee754')
var isArray = require('isarray')

exports.Buffer = Buffer
exports.SlowBuffer = SlowBuffer
exports.INSPECT_MAX_BYTES = 50
Buffer.poolSize = 8192 // not used by this implementation

var rootParent = {}

/**
 * If `Buffer.TYPED_ARRAY_SUPPORT`:
 *   === true    Use Uint8Array implementation (fastest)
 *   === false   Use Object implementation (most compatible, even IE6)
 *
 * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,
 * Opera 11.6+, iOS 4.2+.
 *
 * Due to various browser bugs, sometimes the Object implementation will be used even
 * when the browser supports typed arrays.
 *
 * Note:
 *
 *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,
 *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.
 *
 *   - Safari 5-7 lacks support for changing the `Object.prototype.constructor` property
 *     on objects.
 *
 *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.
 *
 *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of
 *     incorrect length in some situations.

 * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they
 * get the Object implementation, which is slower but behaves correctly.
 */
Buffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined
  ? global.TYPED_ARRAY_SUPPORT
  : typedArraySupport()

function typedArraySupport () {
  function Bar () {}
  try {
    var arr = new Uint8Array(1)
    arr.foo = function () { return 42 }
    arr.constructor = Bar
    return arr.foo() === 42 && // typed array instances can be augmented
        arr.constructor === Bar && // constructor can be set
        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`
        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`
  } catch (e) {
    return false
  }
}

function kMaxLength () {
  return Buffer.TYPED_ARRAY_SUPPORT
    ? 0x7fffffff
    : 0x3fffffff
}

/**
 * Class: Buffer
 * =============
 *
 * The Buffer constructor returns instances of `Uint8Array` that are augmented
 * with function properties for all the node `Buffer` API functions. We use
 * `Uint8Array` so that square bracket notation works as expected -- it returns
 * a single octet.
 *
 * By augmenting the instances, we can avoid modifying the `Uint8Array`
 * prototype.
 */
function Buffer (arg) {
  if (!(this instanceof Buffer)) {
    // Avoid going through an ArgumentsAdaptorTrampoline in the common case.
    if (arguments.length > 1) return new Buffer(arg, arguments[1])
    return new Buffer(arg)
  }

  if (!Buffer.TYPED_ARRAY_SUPPORT) {
    this.length = 0
    this.parent = undefined
  }

  // Common case.
  if (typeof arg === 'number') {
    return fromNumber(this, arg)
  }

  // Slightly less common case.
  if (typeof arg === 'string') {
    return fromString(this, arg, arguments.length > 1 ? arguments[1] : 'utf8')
  }

  // Unusual.
  return fromObject(this, arg)
}

function fromNumber (that, length) {
  that = allocate(that, length < 0 ? 0 : checked(length) | 0)
  if (!Buffer.TYPED_ARRAY_SUPPORT) {
    for (var i = 0; i < length; i++) {
      that[i] = 0
    }
  }
  return that
}

function fromString (that, string, encoding) {
  if (typeof encoding !== 'string' || encoding === '') encoding = 'utf8'

  // Assumption: byteLength() return value is always < kMaxLength.
  var length = byteLength(string, encoding) | 0
  that = allocate(that, length)

  that.write(string, encoding)
  return that
}

function fromObject (that, object) {
  if (Buffer.isBuffer(object)) return fromBuffer(that, object)

  if (isArray(object)) return fromArray(that, object)

  if (object == null) {
    throw new TypeError('must start with number, buffer, array or string')
  }

  if (typeof ArrayBuffer !== 'undefined') {
    if (object.buffer instanceof ArrayBuffer) {
      return fromTypedArray(that, object)
    }
    if (object instanceof ArrayBuffer) {
      return fromArrayBuffer(that, object)
    }
  }

  if (object.length) return fromArrayLike(that, object)

  return fromJsonObject(that, object)
}

function fromBuffer (that, buffer) {
  var length = checked(buffer.length) | 0
  that = allocate(that, length)
  buffer.copy(that, 0, 0, length)
  return that
}

function fromArray (that, array) {
  var length = checked(array.length) | 0
  that = allocate(that, length)
  for (var i = 0; i < length; i += 1) {
    that[i] = array[i] & 255
  }
  return that
}

// Duplicate of fromArray() to keep fromArray() monomorphic.
function fromTypedArray (that, array) {
  var length = checked(array.length) | 0
  that = allocate(that, length)
  // Truncating the elements is probably not what people expect from typed
  // arrays with BYTES_PER_ELEMENT > 1 but it's compatible with the behavior
  // of the old Buffer constructor.
  for (var i = 0; i < length; i += 1) {
    that[i] = array[i] & 255
  }
  return that
}

function fromArrayBuffer (that, array) {
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    // Return an augmented `Uint8Array` instance, for best performance
    array.byteLength
    that = Buffer._augment(new Uint8Array(array))
  } else {
    // Fallback: Return an object instance of the Buffer class
    that = fromTypedArray(that, new Uint8Array(array))
  }
  return that
}

function fromArrayLike (that, array) {
  var length = checked(array.length) | 0
  that = allocate(that, length)
  for (var i = 0; i < length; i += 1) {
    that[i] = array[i] & 255
  }
  return that
}

// Deserialize { type: 'Buffer', data: [1,2,3,...] } into a Buffer object.
// Returns a zero-length buffer for inputs that don't conform to the spec.
function fromJsonObject (that, object) {
  var array
  var length = 0

  if (object.type === 'Buffer' && isArray(object.data)) {
    array = object.data
    length = checked(array.length) | 0
  }
  that = allocate(that, length)

  for (var i = 0; i < length; i += 1) {
    that[i] = array[i] & 255
  }
  return that
}

if (Buffer.TYPED_ARRAY_SUPPORT) {
  Buffer.prototype.__proto__ = Uint8Array.prototype
  Buffer.__proto__ = Uint8Array
} else {
  // pre-set for values that may exist in the future
  Buffer.prototype.length = undefined
  Buffer.prototype.parent = undefined
}

function allocate (that, length) {
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    // Return an augmented `Uint8Array` instance, for best performance
    that = Buffer._augment(new Uint8Array(length))
    that.__proto__ = Buffer.prototype
  } else {
    // Fallback: Return an object instance of the Buffer class
    that.length = length
    that._isBuffer = true
  }

  var fromPool = length !== 0 && length <= Buffer.poolSize >>> 1
  if (fromPool) that.parent = rootParent

  return that
}

function checked (length) {
  // Note: cannot use `length < kMaxLength` here because that fails when
  // length is NaN (which is otherwise coerced to zero.)
  if (length >= kMaxLength()) {
    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +
                         'size: 0x' + kMaxLength().toString(16) + ' bytes')
  }
  return length | 0
}

function SlowBuffer (subject, encoding) {
  if (!(this instanceof SlowBuffer)) return new SlowBuffer(subject, encoding)

  var buf = new Buffer(subject, encoding)
  delete buf.parent
  return buf
}

Buffer.isBuffer = function isBuffer (b) {
  return !!(b != null && b._isBuffer)
}

Buffer.compare = function compare (a, b) {
  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {
    throw new TypeError('Arguments must be Buffers')
  }

  if (a === b) return 0

  var x = a.length
  var y = b.length

  var i = 0
  var len = Math.min(x, y)
  while (i < len) {
    if (a[i] !== b[i]) break

    ++i
  }

  if (i !== len) {
    x = a[i]
    y = b[i]
  }

  if (x < y) return -1
  if (y < x) return 1
  return 0
}

Buffer.isEncoding = function isEncoding (encoding) {
  switch (String(encoding).toLowerCase()) {
    case 'hex':
    case 'utf8':
    case 'utf-8':
    case 'ascii':
    case 'binary':
    case 'base64':
    case 'raw':
    case 'ucs2':
    case 'ucs-2':
    case 'utf16le':
    case 'utf-16le':
      return true
    default:
      return false
  }
}

Buffer.concat = function concat (list, length) {
  if (!isArray(list)) throw new TypeError('list argument must be an Array of Buffers.')

  if (list.length === 0) {
    return new Buffer(0)
  }

  var i
  if (length === undefined) {
    length = 0
    for (i = 0; i < list.length; i++) {
      length += list[i].length
    }
  }

  var buf = new Buffer(length)
  var pos = 0
  for (i = 0; i < list.length; i++) {
    var item = list[i]
    item.copy(buf, pos)
    pos += item.length
  }
  return buf
}

function byteLength (string, encoding) {
  if (typeof string !== 'string') string = '' + string

  var len = string.length
  if (len === 0) return 0

  // Use a for loop to avoid recursion
  var loweredCase = false
  for (;;) {
    switch (encoding) {
      case 'ascii':
      case 'binary':
      // Deprecated
      case 'raw':
      case 'raws':
        return len
      case 'utf8':
      case 'utf-8':
        return utf8ToBytes(string).length
      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return len * 2
      case 'hex':
        return len >>> 1
      case 'base64':
        return base64ToBytes(string).length
      default:
        if (loweredCase) return utf8ToBytes(string).length // assume utf8
        encoding = ('' + encoding).toLowerCase()
        loweredCase = true
    }
  }
}
Buffer.byteLength = byteLength

function slowToString (encoding, start, end) {
  var loweredCase = false

  start = start | 0
  end = end === undefined || end === Infinity ? this.length : end | 0

  if (!encoding) encoding = 'utf8'
  if (start < 0) start = 0
  if (end > this.length) end = this.length
  if (end <= start) return ''

  while (true) {
    switch (encoding) {
      case 'hex':
        return hexSlice(this, start, end)

      case 'utf8':
      case 'utf-8':
        return utf8Slice(this, start, end)

      case 'ascii':
        return asciiSlice(this, start, end)

      case 'binary':
        return binarySlice(this, start, end)

      case 'base64':
        return base64Slice(this, start, end)

      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return utf16leSlice(this, start, end)

      default:
        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)
        encoding = (encoding + '').toLowerCase()
        loweredCase = true
    }
  }
}

Buffer.prototype.toString = function toString () {
  var length = this.length | 0
  if (length === 0) return ''
  if (arguments.length === 0) return utf8Slice(this, 0, length)
  return slowToString.apply(this, arguments)
}

Buffer.prototype.equals = function equals (b) {
  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')
  if (this === b) return true
  return Buffer.compare(this, b) === 0
}

Buffer.prototype.inspect = function inspect () {
  var str = ''
  var max = exports.INSPECT_MAX_BYTES
  if (this.length > 0) {
    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')
    if (this.length > max) str += ' ... '
  }
  return '<Buffer ' + str + '>'
}

Buffer.prototype.compare = function compare (b) {
  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')
  if (this === b) return 0
  return Buffer.compare(this, b)
}

Buffer.prototype.indexOf = function indexOf (val, byteOffset) {
  if (byteOffset > 0x7fffffff) byteOffset = 0x7fffffff
  else if (byteOffset < -0x80000000) byteOffset = -0x80000000
  byteOffset >>= 0

  if (this.length === 0) return -1
  if (byteOffset >= this.length) return -1

  // Negative offsets start from the end of the buffer
  if (byteOffset < 0) byteOffset = Math.max(this.length + byteOffset, 0)

  if (typeof val === 'string') {
    if (val.length === 0) return -1 // special case: looking for empty string always fails
    return String.prototype.indexOf.call(this, val, byteOffset)
  }
  if (Buffer.isBuffer(val)) {
    return arrayIndexOf(this, val, byteOffset)
  }
  if (typeof val === 'number') {
    if (Buffer.TYPED_ARRAY_SUPPORT && Uint8Array.prototype.indexOf === 'function') {
      return Uint8Array.prototype.indexOf.call(this, val, byteOffset)
    }
    return arrayIndexOf(this, [ val ], byteOffset)
  }

  function arrayIndexOf (arr, val, byteOffset) {
    var foundIndex = -1
    for (var i = 0; byteOffset + i < arr.length; i++) {
      if (arr[byteOffset + i] === val[foundIndex === -1 ? 0 : i - foundIndex]) {
        if (foundIndex === -1) foundIndex = i
        if (i - foundIndex + 1 === val.length) return byteOffset + foundIndex
      } else {
        foundIndex = -1
      }
    }
    return -1
  }

  throw new TypeError('val must be string, number or Buffer')
}

// `get` is deprecated
Buffer.prototype.get = function get (offset) {
  console.log('.get() is deprecated. Access using array indexes instead.')
  return this.readUInt8(offset)
}

// `set` is deprecated
Buffer.prototype.set = function set (v, offset) {
  console.log('.set() is deprecated. Access using array indexes instead.')
  return this.writeUInt8(v, offset)
}

function hexWrite (buf, string, offset, length) {
  offset = Number(offset) || 0
  var remaining = buf.length - offset
  if (!length) {
    length = remaining
  } else {
    length = Number(length)
    if (length > remaining) {
      length = remaining
    }
  }

  // must be an even number of digits
  var strLen = string.length
  if (strLen % 2 !== 0) throw new Error('Invalid hex string')

  if (length > strLen / 2) {
    length = strLen / 2
  }
  for (var i = 0; i < length; i++) {
    var parsed = parseInt(string.substr(i * 2, 2), 16)
    if (isNaN(parsed)) throw new Error('Invalid hex string')
    buf[offset + i] = parsed
  }
  return i
}

function utf8Write (buf, string, offset, length) {
  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)
}

function asciiWrite (buf, string, offset, length) {
  return blitBuffer(asciiToBytes(string), buf, offset, length)
}

function binaryWrite (buf, string, offset, length) {
  return asciiWrite(buf, string, offset, length)
}

function base64Write (buf, string, offset, length) {
  return blitBuffer(base64ToBytes(string), buf, offset, length)
}

function ucs2Write (buf, string, offset, length) {
  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)
}

Buffer.prototype.write = function write (string, offset, length, encoding) {
  // Buffer#write(string)
  if (offset === undefined) {
    encoding = 'utf8'
    length = this.length
    offset = 0
  // Buffer#write(string, encoding)
  } else if (length === undefined && typeof offset === 'string') {
    encoding = offset
    length = this.length
    offset = 0
  // Buffer#write(string, offset[, length][, encoding])
  } else if (isFinite(offset)) {
    offset = offset | 0
    if (isFinite(length)) {
      length = length | 0
      if (encoding === undefined) encoding = 'utf8'
    } else {
      encoding = length
      length = undefined
    }
  // legacy write(string, encoding, offset, length) - remove in v0.13
  } else {
    var swap = encoding
    encoding = offset
    offset = length | 0
    length = swap
  }

  var remaining = this.length - offset
  if (length === undefined || length > remaining) length = remaining

  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {
    throw new RangeError('attempt to write outside buffer bounds')
  }

  if (!encoding) encoding = 'utf8'

  var loweredCase = false
  for (;;) {
    switch (encoding) {
      case 'hex':
        return hexWrite(this, string, offset, length)

      case 'utf8':
      case 'utf-8':
        return utf8Write(this, string, offset, length)

      case 'ascii':
        return asciiWrite(this, string, offset, length)

      case 'binary':
        return binaryWrite(this, string, offset, length)

      case 'base64':
        // Warning: maxLength not taken into account in base64Write
        return base64Write(this, string, offset, length)

      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return ucs2Write(this, string, offset, length)

      default:
        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)
        encoding = ('' + encoding).toLowerCase()
        loweredCase = true
    }
  }
}

Buffer.prototype.toJSON = function toJSON () {
  return {
    type: 'Buffer',
    data: Array.prototype.slice.call(this._arr || this, 0)
  }
}

function base64Slice (buf, start, end) {
  if (start === 0 && end === buf.length) {
    return base64.fromByteArray(buf)
  } else {
    return base64.fromByteArray(buf.slice(start, end))
  }
}

function utf8Slice (buf, start, end) {
  end = Math.min(buf.length, end)
  var res = []

  var i = start
  while (i < end) {
    var firstByte = buf[i]
    var codePoint = null
    var bytesPerSequence = (firstByte > 0xEF) ? 4
      : (firstByte > 0xDF) ? 3
      : (firstByte > 0xBF) ? 2
      : 1

    if (i + bytesPerSequence <= end) {
      var secondByte, thirdByte, fourthByte, tempCodePoint

      switch (bytesPerSequence) {
        case 1:
          if (firstByte < 0x80) {
            codePoint = firstByte
          }
          break
        case 2:
          secondByte = buf[i + 1]
          if ((secondByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)
            if (tempCodePoint > 0x7F) {
              codePoint = tempCodePoint
            }
          }
          break
        case 3:
          secondByte = buf[i + 1]
          thirdByte = buf[i + 2]
          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)
            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {
              codePoint = tempCodePoint
            }
          }
          break
        case 4:
          secondByte = buf[i + 1]
          thirdByte = buf[i + 2]
          fourthByte = buf[i + 3]
          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)
            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {
              codePoint = tempCodePoint
            }
          }
      }
    }

    if (codePoint === null) {
      // we did not generate a valid codePoint so insert a
      // replacement char (U+FFFD) and advance only 1 byte
      codePoint = 0xFFFD
      bytesPerSequence = 1
    } else if (codePoint > 0xFFFF) {
      // encode to utf16 (surrogate pair dance)
      codePoint -= 0x10000
      res.push(codePoint >>> 10 & 0x3FF | 0xD800)
      codePoint = 0xDC00 | codePoint & 0x3FF
    }

    res.push(codePoint)
    i += bytesPerSequence
  }

  return decodeCodePointsArray(res)
}

// Based on http://stackoverflow.com/a/22747272/680742, the browser with
// the lowest limit is Chrome, with 0x10000 args.
// We go 1 magnitude less, for safety
var MAX_ARGUMENTS_LENGTH = 0x1000

function decodeCodePointsArray (codePoints) {
  var len = codePoints.length
  if (len <= MAX_ARGUMENTS_LENGTH) {
    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()
  }

  // Decode in chunks to avoid "call stack size exceeded".
  var res = ''
  var i = 0
  while (i < len) {
    res += String.fromCharCode.apply(
      String,
      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)
    )
  }
  return res
}

function asciiSlice (buf, start, end) {
  var ret = ''
  end = Math.min(buf.length, end)

  for (var i = start; i < end; i++) {
    ret += String.fromCharCode(buf[i] & 0x7F)
  }
  return ret
}

function binarySlice (buf, start, end) {
  var ret = ''
  end = Math.min(buf.length, end)

  for (var i = start; i < end; i++) {
    ret += String.fromCharCode(buf[i])
  }
  return ret
}

function hexSlice (buf, start, end) {
  var len = buf.length

  if (!start || start < 0) start = 0
  if (!end || end < 0 || end > len) end = len

  var out = ''
  for (var i = start; i < end; i++) {
    out += toHex(buf[i])
  }
  return out
}

function utf16leSlice (buf, start, end) {
  var bytes = buf.slice(start, end)
  var res = ''
  for (var i = 0; i < bytes.length; i += 2) {
    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)
  }
  return res
}

Buffer.prototype.slice = function slice (start, end) {
  var len = this.length
  start = ~~start
  end = end === undefined ? len : ~~end

  if (start < 0) {
    start += len
    if (start < 0) start = 0
  } else if (start > len) {
    start = len
  }

  if (end < 0) {
    end += len
    if (end < 0) end = 0
  } else if (end > len) {
    end = len
  }

  if (end < start) end = start

  var newBuf
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    newBuf = Buffer._augment(this.subarray(start, end))
  } else {
    var sliceLen = end - start
    newBuf = new Buffer(sliceLen, undefined)
    for (var i = 0; i < sliceLen; i++) {
      newBuf[i] = this[i + start]
    }
  }

  if (newBuf.length) newBuf.parent = this.parent || this

  return newBuf
}

/*
 * Need to make sure that buffer isn't trying to write out of bounds.
 */
function checkOffset (offset, ext, length) {
  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')
  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')
}

Buffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var val = this[offset]
  var mul = 1
  var i = 0
  while (++i < byteLength && (mul *= 0x100)) {
    val += this[offset + i] * mul
  }

  return val
}

Buffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) {
    checkOffset(offset, byteLength, this.length)
  }

  var val = this[offset + --byteLength]
  var mul = 1
  while (byteLength > 0 && (mul *= 0x100)) {
    val += this[offset + --byteLength] * mul
  }

  return val
}

Buffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 1, this.length)
  return this[offset]
}

Buffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  return this[offset] | (this[offset + 1] << 8)
}

Buffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  return (this[offset] << 8) | this[offset + 1]
}

Buffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return ((this[offset]) |
      (this[offset + 1] << 8) |
      (this[offset + 2] << 16)) +
      (this[offset + 3] * 0x1000000)
}

Buffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset] * 0x1000000) +
    ((this[offset + 1] << 16) |
    (this[offset + 2] << 8) |
    this[offset + 3])
}

Buffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var val = this[offset]
  var mul = 1
  var i = 0
  while (++i < byteLength && (mul *= 0x100)) {
    val += this[offset + i] * mul
  }
  mul *= 0x80

  if (val >= mul) val -= Math.pow(2, 8 * byteLength)

  return val
}

Buffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var i = byteLength
  var mul = 1
  var val = this[offset + --i]
  while (i > 0 && (mul *= 0x100)) {
    val += this[offset + --i] * mul
  }
  mul *= 0x80

  if (val >= mul) val -= Math.pow(2, 8 * byteLength)

  return val
}

Buffer.prototype.readInt8 = function readInt8 (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 1, this.length)
  if (!(this[offset] & 0x80)) return (this[offset])
  return ((0xff - this[offset] + 1) * -1)
}

Buffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  var val = this[offset] | (this[offset + 1] << 8)
  return (val & 0x8000) ? val | 0xFFFF0000 : val
}

Buffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  var val = this[offset + 1] | (this[offset] << 8)
  return (val & 0x8000) ? val | 0xFFFF0000 : val
}

Buffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset]) |
    (this[offset + 1] << 8) |
    (this[offset + 2] << 16) |
    (this[offset + 3] << 24)
}

Buffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset] << 24) |
    (this[offset + 1] << 16) |
    (this[offset + 2] << 8) |
    (this[offset + 3])
}

Buffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)
  return ieee754.read(this, offset, true, 23, 4)
}

Buffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)
  return ieee754.read(this, offset, false, 23, 4)
}

Buffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 8, this.length)
  return ieee754.read(this, offset, true, 52, 8)
}

Buffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 8, this.length)
  return ieee754.read(this, offset, false, 52, 8)
}

function checkInt (buf, value, offset, ext, max, min) {
  if (!Buffer.isBuffer(buf)) throw new TypeError('buffer must be a Buffer instance')
  if (value > max || value < min) throw new RangeError('value is out of bounds')
  if (offset + ext > buf.length) throw new RangeError('index out of range')
}

Buffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkInt(this, value, offset, byteLength, Math.pow(2, 8 * byteLength), 0)

  var mul = 1
  var i = 0
  this[offset] = value & 0xFF
  while (++i < byteLength && (mul *= 0x100)) {
    this[offset + i] = (value / mul) & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkInt(this, value, offset, byteLength, Math.pow(2, 8 * byteLength), 0)

  var i = byteLength - 1
  var mul = 1
  this[offset + i] = value & 0xFF
  while (--i >= 0 && (mul *= 0x100)) {
    this[offset + i] = (value / mul) & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)
  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)
  this[offset] = (value & 0xff)
  return offset + 1
}

function objectWriteUInt16 (buf, value, offset, littleEndian) {
  if (value < 0) value = 0xffff + value + 1
  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; i++) {
    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>
      (littleEndian ? i : 1 - i) * 8
  }
}

Buffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
  } else {
    objectWriteUInt16(this, value, offset, true)
  }
  return offset + 2
}

Buffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 8)
    this[offset + 1] = (value & 0xff)
  } else {
    objectWriteUInt16(this, value, offset, false)
  }
  return offset + 2
}

function objectWriteUInt32 (buf, value, offset, littleEndian) {
  if (value < 0) value = 0xffffffff + value + 1
  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; i++) {
    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff
  }
}

Buffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset + 3] = (value >>> 24)
    this[offset + 2] = (value >>> 16)
    this[offset + 1] = (value >>> 8)
    this[offset] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, true)
  }
  return offset + 4
}

Buffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 24)
    this[offset + 1] = (value >>> 16)
    this[offset + 2] = (value >>> 8)
    this[offset + 3] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, false)
  }
  return offset + 4
}

Buffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) {
    var limit = Math.pow(2, 8 * byteLength - 1)

    checkInt(this, value, offset, byteLength, limit - 1, -limit)
  }

  var i = 0
  var mul = 1
  var sub = value < 0 ? 1 : 0
  this[offset] = value & 0xFF
  while (++i < byteLength && (mul *= 0x100)) {
    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) {
    var limit = Math.pow(2, 8 * byteLength - 1)

    checkInt(this, value, offset, byteLength, limit - 1, -limit)
  }

  var i = byteLength - 1
  var mul = 1
  var sub = value < 0 ? 1 : 0
  this[offset + i] = value & 0xFF
  while (--i >= 0 && (mul *= 0x100)) {
    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)
  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)
  if (value < 0) value = 0xff + value + 1
  this[offset] = (value & 0xff)
  return offset + 1
}

Buffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
  } else {
    objectWriteUInt16(this, value, offset, true)
  }
  return offset + 2
}

Buffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 8)
    this[offset + 1] = (value & 0xff)
  } else {
    objectWriteUInt16(this, value, offset, false)
  }
  return offset + 2
}

Buffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
    this[offset + 2] = (value >>> 16)
    this[offset + 3] = (value >>> 24)
  } else {
    objectWriteUInt32(this, value, offset, true)
  }
  return offset + 4
}

Buffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)
  if (value < 0) value = 0xffffffff + value + 1
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 24)
    this[offset + 1] = (value >>> 16)
    this[offset + 2] = (value >>> 8)
    this[offset + 3] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, false)
  }
  return offset + 4
}

function checkIEEE754 (buf, value, offset, ext, max, min) {
  if (value > max || value < min) throw new RangeError('value is out of bounds')
  if (offset + ext > buf.length) throw new RangeError('index out of range')
  if (offset < 0) throw new RangeError('index out of range')
}

function writeFloat (buf, value, offset, littleEndian, noAssert) {
  if (!noAssert) {
    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)
  }
  ieee754.write(buf, value, offset, littleEndian, 23, 4)
  return offset + 4
}

Buffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {
  return writeFloat(this, value, offset, true, noAssert)
}

Buffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {
  return writeFloat(this, value, offset, false, noAssert)
}

function writeDouble (buf, value, offset, littleEndian, noAssert) {
  if (!noAssert) {
    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)
  }
  ieee754.write(buf, value, offset, littleEndian, 52, 8)
  return offset + 8
}

Buffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {
  return writeDouble(this, value, offset, true, noAssert)
}

Buffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {
  return writeDouble(this, value, offset, false, noAssert)
}

// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)
Buffer.prototype.copy = function copy (target, targetStart, start, end) {
  if (!start) start = 0
  if (!end && end !== 0) end = this.length
  if (targetStart >= target.length) targetStart = target.length
  if (!targetStart) targetStart = 0
  if (end > 0 && end < start) end = start

  // Copy 0 bytes; we're done
  if (end === start) return 0
  if (target.length === 0 || this.length === 0) return 0

  // Fatal error conditions
  if (targetStart < 0) {
    throw new RangeError('targetStart out of bounds')
  }
  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')
  if (end < 0) throw new RangeError('sourceEnd out of bounds')

  // Are we oob?
  if (end > this.length) end = this.length
  if (target.length - targetStart < end - start) {
    end = target.length - targetStart + start
  }

  var len = end - start
  var i

  if (this === target && start < targetStart && targetStart < end) {
    // descending copy from end
    for (i = len - 1; i >= 0; i--) {
      target[i + targetStart] = this[i + start]
    }
  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {
    // ascending copy from start
    for (i = 0; i < len; i++) {
      target[i + targetStart] = this[i + start]
    }
  } else {
    target._set(this.subarray(start, start + len), targetStart)
  }

  return len
}

// fill(value, start=0, end=buffer.length)
Buffer.prototype.fill = function fill (value, start, end) {
  if (!value) value = 0
  if (!start) start = 0
  if (!end) end = this.length

  if (end < start) throw new RangeError('end < start')

  // Fill 0 bytes; we're done
  if (end === start) return
  if (this.length === 0) return

  if (start < 0 || start >= this.length) throw new RangeError('start out of bounds')
  if (end < 0 || end > this.length) throw new RangeError('end out of bounds')

  var i
  if (typeof value === 'number') {
    for (i = start; i < end; i++) {
      this[i] = value
    }
  } else {
    var bytes = utf8ToBytes(value.toString())
    var len = bytes.length
    for (i = start; i < end; i++) {
      this[i] = bytes[i % len]
    }
  }

  return this
}

/**
 * Creates a new `ArrayBuffer` with the *copied* memory of the buffer instance.
 * Added in Node 0.12. Only available in browsers that support ArrayBuffer.
 */
Buffer.prototype.toArrayBuffer = function toArrayBuffer () {
  if (typeof Uint8Array !== 'undefined') {
    if (Buffer.TYPED_ARRAY_SUPPORT) {
      return (new Buffer(this)).buffer
    } else {
      var buf = new Uint8Array(this.length)
      for (var i = 0, len = buf.length; i < len; i += 1) {
        buf[i] = this[i]
      }
      return buf.buffer
    }
  } else {
    throw new TypeError('Buffer.toArrayBuffer not supported in this browser')
  }
}

// HELPER FUNCTIONS
// ================

var BP = Buffer.prototype

/**
 * Augment a Uint8Array *instance* (not the Uint8Array class!) with Buffer methods
 */
Buffer._augment = function _augment (arr) {
  arr.constructor = Buffer
  arr._isBuffer = true

  // save reference to original Uint8Array set method before overwriting
  arr._set = arr.set

  // deprecated
  arr.get = BP.get
  arr.set = BP.set

  arr.write = BP.write
  arr.toString = BP.toString
  arr.toLocaleString = BP.toString
  arr.toJSON = BP.toJSON
  arr.equals = BP.equals
  arr.compare = BP.compare
  arr.indexOf = BP.indexOf
  arr.copy = BP.copy
  arr.slice = BP.slice
  arr.readUIntLE = BP.readUIntLE
  arr.readUIntBE = BP.readUIntBE
  arr.readUInt8 = BP.readUInt8
  arr.readUInt16LE = BP.readUInt16LE
  arr.readUInt16BE = BP.readUInt16BE
  arr.readUInt32LE = BP.readUInt32LE
  arr.readUInt32BE = BP.readUInt32BE
  arr.readIntLE = BP.readIntLE
  arr.readIntBE = BP.readIntBE
  arr.readInt8 = BP.readInt8
  arr.readInt16LE = BP.readInt16LE
  arr.readInt16BE = BP.readInt16BE
  arr.readInt32LE = BP.readInt32LE
  arr.readInt32BE = BP.readInt32BE
  arr.readFloatLE = BP.readFloatLE
  arr.readFloatBE = BP.readFloatBE
  arr.readDoubleLE = BP.readDoubleLE
  arr.readDoubleBE = BP.readDoubleBE
  arr.writeUInt8 = BP.writeUInt8
  arr.writeUIntLE = BP.writeUIntLE
  arr.writeUIntBE = BP.writeUIntBE
  arr.writeUInt16LE = BP.writeUInt16LE
  arr.writeUInt16BE = BP.writeUInt16BE
  arr.writeUInt32LE = BP.writeUInt32LE
  arr.writeUInt32BE = BP.writeUInt32BE
  arr.writeIntLE = BP.writeIntLE
  arr.writeIntBE = BP.writeIntBE
  arr.writeInt8 = BP.writeInt8
  arr.writeInt16LE = BP.writeInt16LE
  arr.writeInt16BE = BP.writeInt16BE
  arr.writeInt32LE = BP.writeInt32LE
  arr.writeInt32BE = BP.writeInt32BE
  arr.writeFloatLE = BP.writeFloatLE
  arr.writeFloatBE = BP.writeFloatBE
  arr.writeDoubleLE = BP.writeDoubleLE
  arr.writeDoubleBE = BP.writeDoubleBE
  arr.fill = BP.fill
  arr.inspect = BP.inspect
  arr.toArrayBuffer = BP.toArrayBuffer

  return arr
}

var INVALID_BASE64_RE = /[^+\/0-9A-Za-z-_]/g

function base64clean (str) {
  // Node strips out invalid characters like \n and \t from the string, base64-js does not
  str = stringtrim(str).replace(INVALID_BASE64_RE, '')
  // Node converts strings with length < 2 to ''
  if (str.length < 2) return ''
  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not
  while (str.length % 4 !== 0) {
    str = str + '='
  }
  return str
}

function stringtrim (str) {
  if (str.trim) return str.trim()
  return str.replace(/^\s+|\s+$/g, '')
}

function toHex (n) {
  if (n < 16) return '0' + n.toString(16)
  return n.toString(16)
}

function utf8ToBytes (string, units) {
  units = units || Infinity
  var codePoint
  var length = string.length
  var leadSurrogate = null
  var bytes = []

  for (var i = 0; i < length; i++) {
    codePoint = string.charCodeAt(i)

    // is surrogate component
    if (codePoint > 0xD7FF && codePoint < 0xE000) {
      // last char was a lead
      if (!leadSurrogate) {
        // no lead yet
        if (codePoint > 0xDBFF) {
          // unexpected trail
          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
          continue
        } else if (i + 1 === length) {
          // unpaired lead
          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
          continue
        }

        // valid lead
        leadSurrogate = codePoint

        continue
      }

      // 2 leads in a row
      if (codePoint < 0xDC00) {
        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
        leadSurrogate = codePoint
        continue
      }

      // valid surrogate pair
      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000
    } else if (leadSurrogate) {
      // valid bmp char, but last char was a lead
      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
    }

    leadSurrogate = null

    // encode utf8
    if (codePoint < 0x80) {
      if ((units -= 1) < 0) break
      bytes.push(codePoint)
    } else if (codePoint < 0x800) {
      if ((units -= 2) < 0) break
      bytes.push(
        codePoint >> 0x6 | 0xC0,
        codePoint & 0x3F | 0x80
      )
    } else if (codePoint < 0x10000) {
      if ((units -= 3) < 0) break
      bytes.push(
        codePoint >> 0xC | 0xE0,
        codePoint >> 0x6 & 0x3F | 0x80,
        codePoint & 0x3F | 0x80
      )
    } else if (codePoint < 0x110000) {
      if ((units -= 4) < 0) break
      bytes.push(
        codePoint >> 0x12 | 0xF0,
        codePoint >> 0xC & 0x3F | 0x80,
        codePoint >> 0x6 & 0x3F | 0x80,
        codePoint & 0x3F | 0x80
      )
    } else {
      throw new Error('Invalid code point')
    }
  }

  return bytes
}

function asciiToBytes (str) {
  var byteArray = []
  for (var i = 0; i < str.length; i++) {
    // Node's code seems to be doing this and not & 0x7F..
    byteArray.push(str.charCodeAt(i) & 0xFF)
  }
  return byteArray
}

function utf16leToBytes (str, units) {
  var c, hi, lo
  var byteArray = []
  for (var i = 0; i < str.length; i++) {
    if ((units -= 2) < 0) break

    c = str.charCodeAt(i)
    hi = c >> 8
    lo = c % 256
    byteArray.push(lo)
    byteArray.push(hi)
  }

  return byteArray
}

function base64ToBytes (str) {
  return base64.toByteArray(base64clean(str))
}

function blitBuffer (src, dst, offset, length) {
  for (var i = 0; i < length; i++) {
    if ((i + offset >= dst.length) || (i >= src.length)) break
    dst[i + offset] = src[i]
  }
  return i
}

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"base64-js":5,"ieee754":6,"isarray":7}],5:[function(require,module,exports){
var lookup = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';

;(function (exports) {
	'use strict';

  var Arr = (typeof Uint8Array !== 'undefined')
    ? Uint8Array
    : Array

	var PLUS   = '+'.charCodeAt(0)
	var SLASH  = '/'.charCodeAt(0)
	var NUMBER = '0'.charCodeAt(0)
	var LOWER  = 'a'.charCodeAt(0)
	var UPPER  = 'A'.charCodeAt(0)
	var PLUS_URL_SAFE = '-'.charCodeAt(0)
	var SLASH_URL_SAFE = '_'.charCodeAt(0)

	function decode (elt) {
		var code = elt.charCodeAt(0)
		if (code === PLUS ||
		    code === PLUS_URL_SAFE)
			return 62 // '+'
		if (code === SLASH ||
		    code === SLASH_URL_SAFE)
			return 63 // '/'
		if (code < NUMBER)
			return -1 //no match
		if (code < NUMBER + 10)
			return code - NUMBER + 26 + 26
		if (code < UPPER + 26)
			return code - UPPER
		if (code < LOWER + 26)
			return code - LOWER + 26
	}

	function b64ToByteArray (b64) {
		var i, j, l, tmp, placeHolders, arr

		if (b64.length % 4 > 0) {
			throw new Error('Invalid string. Length must be a multiple of 4')
		}

		// the number of equal signs (place holders)
		// if there are two placeholders, than the two characters before it
		// represent one byte
		// if there is only one, then the three characters before it represent 2 bytes
		// this is just a cheap hack to not do indexOf twice
		var len = b64.length
		placeHolders = '=' === b64.charAt(len - 2) ? 2 : '=' === b64.charAt(len - 1) ? 1 : 0

		// base64 is 4/3 + up to two characters of the original data
		arr = new Arr(b64.length * 3 / 4 - placeHolders)

		// if there are placeholders, only get up to the last complete 4 chars
		l = placeHolders > 0 ? b64.length - 4 : b64.length

		var L = 0

		function push (v) {
			arr[L++] = v
		}

		for (i = 0, j = 0; i < l; i += 4, j += 3) {
			tmp = (decode(b64.charAt(i)) << 18) | (decode(b64.charAt(i + 1)) << 12) | (decode(b64.charAt(i + 2)) << 6) | decode(b64.charAt(i + 3))
			push((tmp & 0xFF0000) >> 16)
			push((tmp & 0xFF00) >> 8)
			push(tmp & 0xFF)
		}

		if (placeHolders === 2) {
			tmp = (decode(b64.charAt(i)) << 2) | (decode(b64.charAt(i + 1)) >> 4)
			push(tmp & 0xFF)
		} else if (placeHolders === 1) {
			tmp = (decode(b64.charAt(i)) << 10) | (decode(b64.charAt(i + 1)) << 4) | (decode(b64.charAt(i + 2)) >> 2)
			push((tmp >> 8) & 0xFF)
			push(tmp & 0xFF)
		}

		return arr
	}

	function uint8ToBase64 (uint8) {
		var i,
			extraBytes = uint8.length % 3, // if we have 1 byte left, pad 2 bytes
			output = "",
			temp, length

		function encode (num) {
			return lookup.charAt(num)
		}

		function tripletToBase64 (num) {
			return encode(num >> 18 & 0x3F) + encode(num >> 12 & 0x3F) + encode(num >> 6 & 0x3F) + encode(num & 0x3F)
		}

		// go through the array every three bytes, we'll deal with trailing stuff later
		for (i = 0, length = uint8.length - extraBytes; i < length; i += 3) {
			temp = (uint8[i] << 16) + (uint8[i + 1] << 8) + (uint8[i + 2])
			output += tripletToBase64(temp)
		}

		// pad the end with zeros, but make sure to not forget the extra bytes
		switch (extraBytes) {
			case 1:
				temp = uint8[uint8.length - 1]
				output += encode(temp >> 2)
				output += encode((temp << 4) & 0x3F)
				output += '=='
				break
			case 2:
				temp = (uint8[uint8.length - 2] << 8) + (uint8[uint8.length - 1])
				output += encode(temp >> 10)
				output += encode((temp >> 4) & 0x3F)
				output += encode((temp << 2) & 0x3F)
				output += '='
				break
		}

		return output
	}

	exports.toByteArray = b64ToByteArray
	exports.fromByteArray = uint8ToBase64
}(typeof exports === 'undefined' ? (this.base64js = {}) : exports))

},{}],6:[function(require,module,exports){
exports.read = function (buffer, offset, isLE, mLen, nBytes) {
  var e, m
  var eLen = nBytes * 8 - mLen - 1
  var eMax = (1 << eLen) - 1
  var eBias = eMax >> 1
  var nBits = -7
  var i = isLE ? (nBytes - 1) : 0
  var d = isLE ? -1 : 1
  var s = buffer[offset + i]

  i += d

  e = s & ((1 << (-nBits)) - 1)
  s >>= (-nBits)
  nBits += eLen
  for (; nBits > 0; e = e * 256 + buffer[offset + i], i += d, nBits -= 8) {}

  m = e & ((1 << (-nBits)) - 1)
  e >>= (-nBits)
  nBits += mLen
  for (; nBits > 0; m = m * 256 + buffer[offset + i], i += d, nBits -= 8) {}

  if (e === 0) {
    e = 1 - eBias
  } else if (e === eMax) {
    return m ? NaN : ((s ? -1 : 1) * Infinity)
  } else {
    m = m + Math.pow(2, mLen)
    e = e - eBias
  }
  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)
}

exports.write = function (buffer, value, offset, isLE, mLen, nBytes) {
  var e, m, c
  var eLen = nBytes * 8 - mLen - 1
  var eMax = (1 << eLen) - 1
  var eBias = eMax >> 1
  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)
  var i = isLE ? 0 : (nBytes - 1)
  var d = isLE ? 1 : -1
  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0

  value = Math.abs(value)

  if (isNaN(value) || value === Infinity) {
    m = isNaN(value) ? 1 : 0
    e = eMax
  } else {
    e = Math.floor(Math.log(value) / Math.LN2)
    if (value * (c = Math.pow(2, -e)) < 1) {
      e--
      c *= 2
    }
    if (e + eBias >= 1) {
      value += rt / c
    } else {
      value += rt * Math.pow(2, 1 - eBias)
    }
    if (value * c >= 2) {
      e++
      c /= 2
    }

    if (e + eBias >= eMax) {
      m = 0
      e = eMax
    } else if (e + eBias >= 1) {
      m = (value * c - 1) * Math.pow(2, mLen)
      e = e + eBias
    } else {
      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)
      e = 0
    }
  }

  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}

  e = (e << mLen) | m
  eLen += mLen
  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}

  buffer[offset + i - d] |= s * 128
}

},{}],7:[function(require,module,exports){
var toString = {}.toString;

module.exports = Array.isArray || function (arr) {
  return toString.call(arr) == '[object Array]';
};

},{}],8:[function(require,module,exports){
'use strict';

var expect = require('expect.js');
var BABYLON = require('babylonjs');

describe('wnp/lib/collision-gjk-epa', function() {
    var collisionner = require('../collision-gjk-epa');

    var points1 = [];

    for (var i = 0; i < Math.PI * 2; i += Math.PI / 4) {
        points1.push(new BABYLON.Vector2(Math.cos(i) * 2, Math.sin(i) * 2));
    }

    var points3d1 = [];
    for (i = 0; i < Math.PI * 2; i += Math.PI /4) {
        for (var j = Math.PI / 2; j < 3 * Math.PI / 2; j += Math.PI /4) {
            points3d1.push(new BABYLON.Vector3(Math.cos(j) * Math.cos(i) * 2, Math.cos(j) * Math.sin(i) * 2, Math.sin(j) * 2));
        }
    }

    it('checks if two cloud of point intersect in 2d', function() {
        for (var k = 0; k < 1; k += 0.3) {
            var points2 = [];
            for (var i = 0; i < Math.PI * 2; i += Math.PI / 4) {
                points2.push(new BABYLON.Vector2(Math.cos(i) + k, Math.sin(i) + k));
            }

            expect(collisionner.isIntersecting(points1, points2)).to.be(true);
            var result = collisionner.intersect(points1, points2);

            for (i = 0; i < points2.length; i++) {
                points2[i].addToRef(result, points2[i]);
            }

            expect(collisionner.isIntersecting(points1, points2)).to.be(false);
            expect(collisionner.intersect(points1, points2)).to.be.eql(false);
        }
    });

    it('checks if two cloud of point not intersect in 2d', function() {
        var points2 = [];
        for (var i = 0; i < Math.PI * 2; i += Math.PI / 4) {
            points2.push(new BABYLON.Vector2(Math.cos(i) + 3.1, Math.sin(i)));
        }
        expect(collisionner.isIntersecting(points1, points2)).to.be(false);
        expect(collisionner.intersect(points1, points2)).to.be.eql(false);
    });



    it('checks if two cloud of point intersect in 3d', function() {

        for (var k = 0; k < 1; k += 0.3) {
            var points3d2 = [];
            for (var i = 0; i < Math.PI * 2; i += Math.PI / 4) {
                for (var j = Math.PI / 2; j < 3 * Math.PI / 2; j += Math.PI / 4) {
                    points3d2.push(new BABYLON.Vector3(Math.cos(j) * Math.cos(i) + k, Math.cos(j) * Math.sin(i) + k, Math.sin(j) + k));
                }
            }
            expect(collisionner.isIntersecting(points3d1, points3d2)).to.be(true);
            var result = collisionner.intersect(points3d1, points3d2);
            result.addToRef(result.clone().normalize().scale(0.05), result);
            for (i = 0; i < points3d2.length; i++) {
                points3d2[i].addToRef(result, points3d2[i]);
            }

            expect(collisionner.isIntersecting(points3d1, points3d2)).to.be(false);
            expect(collisionner.intersect(points3d1, points3d2)).to.be.eql(false);
        }

    });

    it('checks if two cloud of point not intersect in 3d', function() {
        var points3d2 = [];
        for (var i = 0; i < Math.PI * 2; i += Math.PI / 4) {
            for (var j = Math.PI / 2; j < 3 * Math.PI / 2; j += Math.PI / 4) {
                points3d2.push(new BABYLON.Vector3(Math.cos(j) * Math.cos(i) + 3.1, Math.cos(j) * Math.sin(i), Math.sin(j)));
            }
        }
        expect(collisionner.isIntersecting(points3d1, points3d2)).to.be(false);
        expect(collisionner.intersect(points3d1, points3d2)).to.be.eql(false);
    });
});
},{"../collision-gjk-epa":1,"babylonjs":2,"expect.js":3}]},{},[8])(8)
});
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9ncnVudC1icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJjb2xsaXNpb24tZ2prLWVwYS5qcyIsIm5vZGVfbW9kdWxlcy9iYWJ5bG9uanMvYmFieWxvbi5qcyIsIm5vZGVfbW9kdWxlcy9leHBlY3QuanMvaW5kZXguanMiLCJub2RlX21vZHVsZXMvZ3J1bnQtYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvYnVmZmVyL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL2dydW50LWJyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2J1ZmZlci9ub2RlX21vZHVsZXMvYmFzZTY0LWpzL2xpYi9iNjQuanMiLCJub2RlX21vZHVsZXMvZ3J1bnQtYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvYnVmZmVyL25vZGVfbW9kdWxlcy9pZWVlNzU0L2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL2dydW50LWJyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2J1ZmZlci9ub2RlX21vZHVsZXMvaXNhcnJheS9pbmRleC5qcyIsInRlc3RzL2NvbGxpc2lvbi1namstZXBhLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeG9CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUN4Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FDcHdDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQzVnREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1SEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcEZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuLyoqXHJcbiAqIENsYXNzIHRvIGhlbHAgaW4gdGhlIGNvbGxpc2lvbiBpbiAyRCBhbmQgM0QuXHJcbiAqIFRvIHdvcmtzIHRoZSBhbGdvcml0aG0gbmVlZHMgdHdvIGNvbnZleGUgcG9pbnQgY2xvdWRcclxuICogbGlrZSBib3VuZGluZyBib3ggb3Igc210aGcgbGlrZSB0aGlzLlxyXG4gKiBUaGUgZnVuY3Rpb24gZnVuY3Rpb25zIGludGVyc2VjdCBhbmQgaXNJbnRlcnNlY3RpbmdcclxuICogaGVscHMgdG8gaGF2ZSBpbmZvcm1hdGlvbnMgYWJvdXQgdGhlIGNvbGxpc2lvbiBiZXR3ZWVuIHR3byBvYmplY3QuXHJcbiAqXHJcbiAqIEBjbGFzcyB3bnAuaGVscGVycy5Db2xsaXNpb25HamtFcGFcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqL1xyXG52YXIgVHJpYW5nbGUgPSBmdW5jdGlvbihhLCBiLCBjKSB7XHJcbiAgICAgIHRoaXMuYSA9IGE7XHJcbiAgICAgIHRoaXMuYiA9IGI7XHJcbiAgICAgIHRoaXMuYyA9IGM7XHJcbiAgICAgIHRoaXMubiA9IGEuY29uc3RydWN0b3IuQ3Jvc3MoYi5zdWJ0cmFjdChhKSwgYy5zdWJ0cmFjdChhKSkubm9ybWFsaXplKCk7XHJcbiAgfTtcclxuXHJcblxyXG52YXIgQ29sbGlzaW9uR2prRXBhID0ge1xyXG5cclxuICAgIEVQU0lMT046IDAuMDAwMDAxLFxyXG5cclxuICAgIC8qKlxyXG4gICAgICogTWV0aG9kIHRvIGdldCBhIG5vcm1hbCBvZiAzIHBvaW50cyBpbiAyRCBhbmQgM0QuXHJcbiAgICAgKlxyXG4gICAgICogQG1ldGhvZCBfZ2V0Tm9ybWFsXHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICogQHBhcmFtIHtCQUJZTE9OLlZlY3RvcjJ8QkFCWUxPTi5WZWN0b3IzfSBhXHJcbiAgICAgKiBAcGFyYW0ge0JBQllMT04uVmVjdG9yMnxCQUJZTE9OLlZlY3RvcjN9IGJcclxuICAgICAqIEBwYXJhbSB7QkFCWUxPTi5WZWN0b3IyfEJBQllMT04uVmVjdG9yM30gY1xyXG4gICAgICogQHJldHVybiB7QkFCWUxPTi5WZWN0b3IyfEJBQllMT04uVmVjdG9yM30gVGhlIG5vcm1hbC5cclxuICAgICAqL1xyXG4gICAgX2dldE5vcm1hbDogZnVuY3Rpb24oYSwgYiwgYykge1xyXG4gICAgICAgIHZhciBEb3QgPSBhLmNvbnN0cnVjdG9yLkRvdDtcclxuICAgICAgICB2YXIgYWMgPSBEb3QoYSwgYyk7IC8vIHBlcmZvcm0gYURvdChjKVxyXG4gICAgICAgIHZhciBiYyA9IERvdChiLCBjKTsgLy8gcGVyZm9ybSBiRG90KGMpXHJcblxyXG4gICAgICAgIC8vIHBlcmZvcm0gYiAqIGEuRG90KGMpIC0gYSAqIGIuRG90KGMpXHJcbiAgICAgICAgdmFyIHIgPSBiLnNjYWxlKGFjKS5zdWJ0cmFjdChhLnNjYWxlKGJjKSkubm9ybWFsaXplKCk7XHJcbiAgICAgICAgcmV0dXJuIHI7XHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxyXG4gICAgICogR2V0cyB0aGUgYmFyeWNlbnRlciBvZiBhIGNsb3VkIHBvaW50cy5cclxuICAgICAqXHJcbiAgICAgKiBAbWV0aG9kIF9nZXRCYXJ5Y2VudGVyXHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICogQHBhcmFtIHtCQUJZTE9OLlZlY3RvcjJ8QkFCWUxPTi5WZWN0b3IzW119IHZlcnRpY2VzIHRoZSBjbG91ZCBwb2ludHNcclxuICAgICAqIEByZXR1cm4ge0JBQllMT04uVmVjdG9yMnxCQUJZTE9OLlZlY3RvcjN9IFRoZSBiYXJ5Y2VudGVyLlxyXG4gICAgICovXHJcbiAgICBfZ2V0QmFyeWNlbnRlcjogZnVuY3Rpb24odmVydGljZXMpIHtcclxuICAgICAgICB2YXIgYXZnID0gdmVydGljZXNbMF0uY29uc3RydWN0b3IuWmVybygpO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdmVydGljZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgYXZnLmFkZFRvUmVmKHZlcnRpY2VzW2ldLCBhdmcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBhdmcuc2NhbGVJblBsYWNlKDEgLyB2ZXJ0aWNlcy5sZW5ndGgsIGF2Zyk7XHJcbiAgICAgICAgcmV0dXJuIGF2ZztcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXRzIHRoZSBmYXJ0aGVzdCBwb2ludCBvZiBhIGNsb3VkIHBvaW50cy5cclxuICAgICAqXHJcbiAgICAgKiBAbWV0aG9kIF9nZXRGYXJ0aGVzdFBvaW50SW5EaXJlY3Rpb25cclxuICAgICAqIEBwcml2YXRlXHJcbiAgICAgKiBAcGFyYW0ge0JBQllMT04uVmVjdG9yMnxCQUJZTE9OLlZlY3RvcjNbXX0gdmVydGljZXMgdGhlIGNsb3VkIHBvaW50cy5cclxuICAgICAqIEBwYXJhbSB7QkFCWUxPTi5WZWN0b3IyfEJBQllMT04uVmVjdG9yM30gZCBUaGUgZGlyZWN0aW9uIHRvIHNlYXJjaC5cclxuICAgICAqIEByZXR1cm4ge0JBQllMT04uVmVjdG9yMnxCQUJZTE9OLlZlY3RvcjN9IFRoZSBiYXJ5Y2VudGVyLlxyXG4gICAgICovXHJcbiAgICBfZ2V0RmFydGhlc3RQb2ludEluRGlyZWN0aW9uOiBmdW5jdGlvbih2ZXJ0aWNlcywgZCkge1xyXG4gICAgICAgIHZhciBEb3QgPSB2ZXJ0aWNlc1swXS5jb25zdHJ1Y3Rvci5Eb3Q7XHJcbiAgICAgICAgdmFyIG1heFByb2R1Y3QgPSBEb3QodmVydGljZXNbMF0sIGQpO1xyXG4gICAgICAgIHZhciBpbmRleCA9IDA7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCB2ZXJ0aWNlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgcHJvZHVjdCA9IERvdCh2ZXJ0aWNlc1tpXSwgZCk7XHJcbiAgICAgICAgICAgIGlmIChwcm9kdWN0ID4gbWF4UHJvZHVjdCkge1xyXG4gICAgICAgICAgICAgICAgbWF4UHJvZHVjdCA9IHByb2R1Y3Q7XHJcbiAgICAgICAgICAgICAgICBpbmRleCA9IGk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHZlcnRpY2VzW2luZGV4XTtcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXRzIHRoZSBuZWFyZXN0IGVkZ2Ugb2YgdGhlIHNpbXBsZXguXHJcbiAgICAgKlxyXG4gICAgICogQG1ldGhvZCBfZ2V0TmVhcmVzdEVkZ2VcclxuICAgICAqIEBwcml2YXRlXHJcbiAgICAgKiBAcGFyYW0ge0JBQllMT04uVmVjdG9yMnxCQUJZTE9OLlZlY3RvcjNbXX0gc2ltcGxleCBUaGUgc2ltcGxleC5cclxuICAgICAqIEByZXR1cm4ge09iamVjdH0gSW5mb3JtYXRpb25zIGFib3V0IHRoZSBuZWFyZXN0IGVkZ2UgKGRpc3RhbmNlLCBpbmRleCBhbmQgbm9ybWFsKS5cclxuICAgICAqL1xyXG4gICAgX2dldE5lYXJlc3RFZGdlOiBmdW5jdGlvbihzaW1wbGV4KSB7XHJcbiAgICAgICAgdmFyIGRpc3RhbmNlID0gSW5maW5pdHksXHJcbiAgICAgICAgICAgIGluZGV4LCBub3JtYWw7XHJcblxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2ltcGxleC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgaiA9IChpICsgMSkgJSBzaW1wbGV4Lmxlbmd0aDtcclxuICAgICAgICAgICAgdmFyIHYxID0gc2ltcGxleFtpXTtcclxuICAgICAgICAgICAgdmFyIHYyID0gc2ltcGxleFtqXTtcclxuXHJcbiAgICAgICAgICAgIHZhciBlZGdlID0gdjIuc3VidHJhY3QodjEpO1xyXG4gICAgICAgICAgICBpZiAoZWRnZS5sZW5ndGhTcXVhcmVkKCkgPT09IDApIHtcclxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB2YXIgb3JpZ2luVG92MSA9IHYxO1xyXG5cclxuICAgICAgICAgICAgdmFyIG4gPSB0aGlzLl9nZXROb3JtYWwoZWRnZSwgb3JpZ2luVG92MSwgZWRnZSk7XHJcblxyXG4gICAgICAgICAgICBpZiAobi5sZW5ndGhTcXVhcmVkKCkgPT09IDApIHtcclxuICAgICAgICAgICAgICAgIG4ueSA9IC1lZGdlLng7XHJcbiAgICAgICAgICAgICAgICBuLnggPSBlZGdlLnk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vbiA9IG4uc2NhbGUoMSAvIG4ubGVuZ3RoKCkpOyAvL25vcm1hbGl6ZVxyXG4gICAgICAgICAgICB2YXIgZGlzdCA9IE1hdGguYWJzKG4uY29uc3RydWN0b3IuRG90KG4sIHYxKSk7IC8vZGlzdGFuY2UgZnJvbSBvcmlnaW4gdG8gZWRnZVxyXG5cclxuICAgICAgICAgICAgaWYgKGRpc3QgPCBkaXN0YW5jZSkge1xyXG4gICAgICAgICAgICAgICAgZGlzdGFuY2UgPSBkaXN0O1xyXG4gICAgICAgICAgICAgICAgaW5kZXggPSBqO1xyXG4gICAgICAgICAgICAgICAgbm9ybWFsID0gbjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgZGlzdGFuY2U6IGRpc3RhbmNlLFxyXG4gICAgICAgICAgICBpbmRleDogaW5kZXgsXHJcbiAgICAgICAgICAgIG5vcm1hbDogbm9ybWFsXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxyXG4gICAgICogR2V0cyB0aGUgbmVhcmVzdCBUcmlhbmdsZSBvZiB0aGUgcG9seXRvcGUuXHJcbiAgICAgKlxyXG4gICAgICogQG1ldGhvZCBfZ2V0TmVhcmVzdFRyaWFuZ2xlXHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICogQHBhcmFtIHtCQUJZTE9OLlRyaWFuZ2xlW119IHBvbHl0b3BlIFRoZSBwb2x5dG9wZS5cclxuICAgICAqIEByZXR1cm4ge09iamVjdH0gSW5mb3JtYXRpb25zIGFib3V0IHRoZSBuZWFyZXN0IGVkZ2UgKGRpc3RhbmNlIGFuZCBpbmRleCkuXHJcbiAgICAgKi9cclxuICAgIF9nZXROZWFyZXN0VHJpYW5nbGU6IGZ1bmN0aW9uKHBvbHl0b3BlKSB7XHJcbiAgICAgICAgdmFyIGRpc3RhbmNlID0gSW5maW5pdHksXHJcbiAgICAgICAgICAgIGluZGV4O1xyXG5cclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBvbHl0b3BlLmxlbmd0aDsgaSsrKSB7XHJcblxyXG4gICAgICAgICAgICB2YXIgdHJpYW5nbGUgPSBwb2x5dG9wZVtpXTtcclxuICAgICAgICAgICAgdmFyIGRpc3QgPSBNYXRoLmFicyh0cmlhbmdsZS5uLmNvbnN0cnVjdG9yLkRvdCh0cmlhbmdsZS5uLCB0cmlhbmdsZS5hKSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoZGlzdCA8IGRpc3RhbmNlKSB7XHJcbiAgICAgICAgICAgICAgICBkaXN0YW5jZSA9IGRpc3Q7XHJcbiAgICAgICAgICAgICAgICBpbmRleCA9IGk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBkaXN0YW5jZTogZGlzdGFuY2UsXHJcbiAgICAgICAgICAgIGluZGV4OiBpbmRleFxyXG4gICAgICAgIH07XHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ2hlY2tzIGlmIHRoZSBvcmlnaW4gaXMgaW4gYSBsaW5lLlxyXG4gICAgICpcclxuICAgICAqIEBtZXRob2QgX2NvbnRhaW5zTGluZVxyXG4gICAgICogQHByaXZhdGVcclxuICAgICAqIEBwYXJhbSB7QkFCWUxPTi5WZWN0b3IyfEJBQllMT04uVmVjdG9yM1tdfSBzaW1wbGV4IFRoZSBzaW1wbGV4LlxyXG4gICAgICogQHBhcmFtIHtCQUJZTE9OLlZlY3RvcjJ8QkFCWUxPTi5WZWN0b3IzfSBkaXIgVGhlIGRpcmVjdGlvbi5cclxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59IEZhbHNlIGluIGFueSBjYXNlIGJlY2F1c2UgdGhlIGFsZ29yaXRobSBqdXN0IGJlZ2luLlxyXG4gICAgICovXHJcbiAgICBfY29udGFpbnNMaW5lOiBmdW5jdGlvbihzaW1wbGV4LCBkaXIpIHtcclxuICAgICAgICB2YXIgYSA9IHNpbXBsZXhbMV07XHJcbiAgICAgICAgdmFyIGIgPSBzaW1wbGV4WzBdO1xyXG4gICAgICAgIHZhciBhYiA9IGIuc3VidHJhY3QoYSk7XHJcbiAgICAgICAgdmFyIGFvID0gYS5zY2FsZSgtMSk7XHJcbiAgICAgICAgaWYgKGFiLmxlbmd0aFNxdWFyZWQoKSAhPT0gMCkge1xyXG4gICAgICAgICAgICBkaXIuY29weUZyb20odGhpcy5fZ2V0Tm9ybWFsKGFiLCBhbywgYWIpKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBkaXIuY29weUZyb20oYW8pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuICAgICAqIENoZWNrcyBpZiB0aGUgb3JpZ2luIGlzIGluIGEgdHJpYW5nbGUuXHJcbiAgICAgKlxyXG4gICAgICogQG1ldGhvZCBfY29udGFpbnNUcmlhbmdsZVxyXG4gICAgICogQHByaXZhdGVcclxuICAgICAqIEBwYXJhbSB7QkFCWUxPTi5WZWN0b3IyfEJBQllMT04uVmVjdG9yM1tdfSBzaW1wbGV4IFRoZSBzaW1wbGV4LlxyXG4gICAgICogQHBhcmFtIHtCQUJZTE9OLlZlY3RvcjJ8QkFCWUxPTi5WZWN0b3IzfSBkaXIgVGhlIGRpcmVjdGlvbi5cclxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59IElmIGluIDJEIGNhc2UsIG1heSByZXR1cm4gdHJ1ZSBpZiB0aGUgb3JpZ2luIGlzIGluIHRoZSB0cmlhbmdsZS5cclxuICAgICAqL1xyXG4gICAgX2NvbnRhaW5zVHJpYW5nbGU6IGZ1bmN0aW9uKHNpbXBsZXgsIGRpcikge1xyXG4gICAgICAgIHZhciBhID0gc2ltcGxleFsyXTtcclxuICAgICAgICB2YXIgRG90ID0gc2ltcGxleFsyXS5jb25zdHJ1Y3Rvci5Eb3Q7XHJcbiAgICAgICAgdmFyIGIgPSBzaW1wbGV4WzFdO1xyXG4gICAgICAgIHZhciBjID0gc2ltcGxleFswXTtcclxuICAgICAgICB2YXIgYWIgPSBiLnN1YnRyYWN0KGEpO1xyXG4gICAgICAgIHZhciBhYyA9IGMuc3VidHJhY3QoYSk7XHJcbiAgICAgICAgdmFyIGFvID0gYS5zY2FsZSgtMSk7XHJcblxyXG4gICAgICAgIHZhciBhYnAgPSB0aGlzLl9nZXROb3JtYWwoYWMsIGFiLCBhYik7XHJcbiAgICAgICAgdmFyIGFjcCA9IHRoaXMuX2dldE5vcm1hbChhYiwgYWMsIGFjKTtcclxuICAgICAgICBpZiAoRG90KGFicCwgYW8pID4gMCkge1xyXG4gICAgICAgICAgICBzaW1wbGV4LnNwbGljZSgwLCAxKTsgLy8gcmVtb3ZlIENcclxuICAgICAgICAgICAgZGlyLmNvcHlGcm9tKGFicCk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChEb3QoYWNwLCBhbykgPiAwKSB7XHJcbiAgICAgICAgICAgIHNpbXBsZXguc3BsaWNlKDEsIDEpOyAvLyByZW1vdmUgQlxyXG4gICAgICAgICAgICBkaXIuY29weUZyb20oYWNwKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAoZGlyLnogPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYWJjID0gc2ltcGxleFsyXS5jb25zdHJ1Y3Rvci5Dcm9zcyhhYiwgYWMpO1xyXG4gICAgICAgICAgICAgICAgZGlyLmNvcHlGcm9tKGFiYyk7XHJcbiAgICAgICAgICAgICAgICBpZiAoRG90KGFiYywgYW8pIDw9IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAvL3Vwc2lkZSBkb3duIHRldHJhaGVkcm9uXHJcbiAgICAgICAgICAgICAgICAgICAgc2ltcGxleFswXSA9IGI7XHJcbiAgICAgICAgICAgICAgICAgICAgc2ltcGxleFsxXSA9IGM7XHJcbiAgICAgICAgICAgICAgICAgICAgc2ltcGxleFsyXSA9IGE7XHJcbiAgICAgICAgICAgICAgICAgICAgZGlyLmNvcHlGcm9tKGFiYy5zY2FsZSgtMSkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDaGVja3MgaWYgdGhlIG9yaWdpbiBpcyBpbiBhIHRldHJhaGVkcm9uLlxyXG4gICAgICpcclxuICAgICAqIEBtZXRob2QgX2NvbnRhaW5zVGV0cmFoZWRyb25cclxuICAgICAqIEBwcml2YXRlXHJcbiAgICAgKiBAcGFyYW0ge0JBQllMT04uVmVjdG9yMnxCQUJZTE9OLlZlY3RvcjNbXX0gc2ltcGxleCBUaGUgc2ltcGxleC5cclxuICAgICAqIEBwYXJhbSB7QkFCWUxPTi5WZWN0b3IyfEJBQllMT04uVmVjdG9yM30gZGlyIFRoZSBkaXJlY3Rpb24uXHJcbiAgICAgKiBAcmV0dXJuIHtCb29sZWFufSBSZXR1cm4gdHJ1ZSBpZiB0aGUgb3JpZ2luIGlzIGluIHRoZSB0ZXRyYWhlZHJvbi5cclxuICAgICAqL1xyXG4gICAgX2NvbnRhaW5zVGV0cmFoZWRyb246IGZ1bmN0aW9uKHNpbXBsZXgsIGRpcikge1xyXG4gICAgICAgIHZhciBhID0gc2ltcGxleFszXTtcclxuICAgICAgICB2YXIgRG90ID0gYS5jb25zdHJ1Y3Rvci5Eb3Q7XHJcbiAgICAgICAgdmFyIENyb3NzID0gYS5jb25zdHJ1Y3Rvci5Dcm9zcztcclxuICAgICAgICB2YXIgYiA9IHNpbXBsZXhbMl07XHJcbiAgICAgICAgdmFyIGMgPSBzaW1wbGV4WzFdO1xyXG4gICAgICAgIHZhciBkID0gc2ltcGxleFswXTtcclxuICAgICAgICB2YXIgYWIgPSBiLnN1YnRyYWN0KGEpO1xyXG4gICAgICAgIHZhciBhYyA9IGMuc3VidHJhY3QoYSk7XHJcbiAgICAgICAgdmFyIGFkID0gZC5zdWJ0cmFjdChhKTtcclxuICAgICAgICB2YXIgYW8gPSBhLnNjYWxlKC0xKTtcclxuXHJcbiAgICAgICAgdmFyIGFiYyA9IENyb3NzKGFiLCBhYyk7XHJcbiAgICAgICAgdmFyIGFjZCA9IENyb3NzKGFjLCBhZCk7XHJcbiAgICAgICAgdmFyIGFkYiA9IENyb3NzKGFkLCBhYik7XHJcblxyXG4gICAgICAgIHZhciBhYmNUZXN0ID0gMHgxLFxyXG4gICAgICAgICAgICBhY2RUZXN0ID0gMHgyLFxyXG4gICAgICAgICAgICBhZGJUZXN0ID0gMHg0O1xyXG5cclxuICAgICAgICB2YXIgcGxhbmVUZXN0cyA9IChEb3QoYWJjLCBhbykgPiAwID8gYWJjVGVzdCA6IDApIHxcclxuICAgICAgICAgICAgKERvdChhY2QsIGFvKSA+IDAgPyBhY2RUZXN0IDogMCkgfFxyXG4gICAgICAgICAgICAoRG90KGFkYiwgYW8pID4gMCA/IGFkYlRlc3QgOiAwKTtcclxuXHJcbiAgICAgICAgc3dpdGNoIChwbGFuZVRlc3RzKSB7XHJcbiAgICAgICAgICAgIGNhc2UgYWJjVGVzdDpcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9jaGVja1RldHJhaGVkcm9uKGFvLCBhYiwgYWMsIGFiYywgZGlyLCBzaW1wbGV4KTtcclxuICAgICAgICAgICAgY2FzZSBhY2RUZXN0OlxyXG4gICAgICAgICAgICAgICAgc2ltcGxleFsyXSA9IGM7XHJcbiAgICAgICAgICAgICAgICBzaW1wbGV4WzFdID0gZDtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9jaGVja1RldHJhaGVkcm9uKGFvLCBhYywgYWQsIGFjZCwgZGlyLCBzaW1wbGV4KTtcclxuICAgICAgICAgICAgY2FzZSBhZGJUZXN0OlxyXG4gICAgICAgICAgICAgICAgLy9pbiBmcm9udCBvZiB0cmlhbmdsZSBBREJcclxuICAgICAgICAgICAgICAgIHNpbXBsZXhbMV0gPSBiO1xyXG4gICAgICAgICAgICAgICAgc2ltcGxleFsyXSA9IGQ7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY2hlY2tUZXRyYWhlZHJvbihhbywgYWQsIGFiLCBhZGIsIGRpciwgc2ltcGxleCk7XHJcbiAgICAgICAgICAgIGNhc2UgYWJjVGVzdCB8IGFjZFRlc3Q6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY2hlY2tUd29UZXRyYWhlZHJvbihhbywgYWIsIGFjLCBhYmMsIGRpciwgc2ltcGxleCk7XHJcbiAgICAgICAgICAgIGNhc2UgYWNkVGVzdCB8IGFkYlRlc3Q6XHJcbiAgICAgICAgICAgICAgICBzaW1wbGV4WzJdID0gYztcclxuICAgICAgICAgICAgICAgIHNpbXBsZXhbMV0gPSBkO1xyXG4gICAgICAgICAgICAgICAgc2ltcGxleFswXSA9IGI7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY2hlY2tUd29UZXRyYWhlZHJvbihhbywgYWMsIGFkLCBhY2QsIGRpciwgc2ltcGxleCk7XHJcbiAgICAgICAgICAgIGNhc2UgYWRiVGVzdCB8IGFiY1Rlc3Q6XHJcbiAgICAgICAgICAgICAgICBzaW1wbGV4WzFdID0gYjtcclxuICAgICAgICAgICAgICAgIHNpbXBsZXhbMl0gPSBkO1xyXG4gICAgICAgICAgICAgICAgc2ltcGxleFswXSA9IGM7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY2hlY2tUd29UZXRyYWhlZHJvbihhbywgYWQsIGFiLCBhZGIsIGRpciwgc2ltcGxleCk7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vb3JpZ2luIGluIHRldHJhaGVkcm9uXHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQG1ldGhvZCBfY2hlY2tUd29UZXRyYWhlZHJvblxyXG4gICAgICogQHByaXZhdGVcclxuICAgICAqL1xyXG4gICAgX2NoZWNrVHdvVGV0cmFoZWRyb246IGZ1bmN0aW9uKGFvLCBhYiwgYWMsIGFiYywgZGlyLCBzaW1wbGV4KSB7XHJcbiAgICAgICAgdmFyIGFiY19hYyA9IGFiYy5jb25zdHJ1Y3Rvci5Dcm9zcyhhYmMsIGFjKTtcclxuXHJcbiAgICAgICAgaWYgKGFiY19hYy5jb25zdHJ1Y3Rvci5Eb3QoYWJjX2FjLCBhbykgPiAwKSB7XHJcbiAgICAgICAgICAgIC8vdGhlIG9yaWdpbiBpcyBiZXlvbmQgQUMgZnJvbSBBQkMnc1xyXG4gICAgICAgICAgICAvL3BlcnNwZWN0aXZlLCBlZmZlY3RpdmVseSBleGNsdWRpbmdcclxuICAgICAgICAgICAgLy9BQ0QgZnJvbSBjb25zaWRlcmF0aW9uXHJcblxyXG4gICAgICAgICAgICAvL3dlIHRodXMgbmVlZCB0ZXN0IG9ubHkgQUNEXHJcbiAgICAgICAgICAgIHNpbXBsZXhbMl0gPSBzaW1wbGV4WzFdO1xyXG4gICAgICAgICAgICBzaW1wbGV4WzFdID0gc2ltcGxleFswXTtcclxuXHJcbiAgICAgICAgICAgIGFiID0gc2ltcGxleFsyXS5zdWJ0cmFjdChzaW1wbGV4WzNdKTtcclxuICAgICAgICAgICAgYWMgPSBzaW1wbGV4WzFdLnN1YnRyYWN0KHNpbXBsZXhbM10pO1xyXG4gICAgICAgICAgICBhYmMgPSBhYi5jb25zdHJ1Y3Rvci5Dcm9zcyhhYiwgYWMpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NoZWNrVGV0cmFoZWRyb24oYW8sIGFiLCBhYywgYWJjLCBkaXIsIHNpbXBsZXgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGFiX2FiYyA9IGFiYy5jb25zdHJ1Y3Rvci5Dcm9zcyhhYiwgYWJjKTtcclxuXHJcbiAgICAgICAgaWYgKGFiX2FiYy5jb25zdHJ1Y3Rvci5Eb3QoYWJfYWJjLCBhbykgPiAwKSB7XHJcblxyXG4gICAgICAgICAgICBzaW1wbGV4LnNwbGljZSgwLCAyKTtcclxuICAgICAgICAgICAgLy9kaXIgaXMgbm90IGFiX2FiYyBiZWNhdXNlIGl0J3Mgbm90IHBvaW50IHRvd2FyZHMgdGhlIG9yaWdpbjtcclxuICAgICAgICAgICAgLy9BQnhBMHhBQiBkaXJlY3Rpb24gd2UgYXJlIGxvb2tpbmcgZm9yXHJcbiAgICAgICAgICAgIGRpci5jb3B5RnJvbSh0aGlzLl9nZXROb3JtYWwoYWIsIGFvLCBhYikpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQG1ldGhvZCBfY2hlY2tUZXRyYWhlZHJvblxyXG4gICAgICogQHByaXZhdGVcclxuICAgICAqL1xyXG4gICAgX2NoZWNrVGV0cmFoZWRyb246IGZ1bmN0aW9uKGFvLCBhYiwgYWMsIGFiYywgZGlyLCBzaW1wbGV4KSB7XHJcblxyXG4gICAgICAgIHZhciBhY3AgPSBhYmMuY29uc3RydWN0b3IuQ3Jvc3MoYWJjLCBhYyk7XHJcblxyXG4gICAgICAgIGlmIChhY3AuY29uc3RydWN0b3IuRG90KGFjcCwgYW8pID4gMCkge1xyXG5cclxuICAgICAgICAgICAgc2ltcGxleFsyXSA9IHNpbXBsZXhbM107XHJcbiAgICAgICAgICAgIHNpbXBsZXguc3BsaWNlKDMsIDEpO1xyXG4gICAgICAgICAgICBzaW1wbGV4LnNwbGljZSgwLCAxKTtcclxuICAgICAgICAgICAgLy9kaXIgaXMgbm90IGFiY19hYyBiZWNhdXNlIGl0J3Mgbm90IHBvaW50IHRvd2FyZHMgdGhlIG9yaWdpbjtcclxuICAgICAgICAgICAgLy9BQ3hBMHhBQyBkaXJlY3Rpb24gd2UgYXJlIGxvb2tpbmcgZm9yXHJcbiAgICAgICAgICAgIGRpci5jb3B5RnJvbSh0aGlzLl9nZXROb3JtYWwoYWMsIGFvLCBhYykpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy9hbG1vc3QgdGhlIHNhbWUgbGlrZSB0cmlhbmdsZSBjaGVja3NcclxuICAgICAgICB2YXIgYWJfYWJjID0gYWIuY29uc3RydWN0b3IuQ3Jvc3MoYWIsIGFiYyk7XHJcblxyXG4gICAgICAgIGlmIChhYl9hYmMuY29uc3RydWN0b3IuRG90KGFiX2FiYywgYW8pID4gMCkge1xyXG5cclxuICAgICAgICAgICAgc2ltcGxleC5zcGxpY2UoMCwgMik7XHJcbiAgICAgICAgICAgIC8vZGlyIGlzIG5vdCBhYl9hYmMgYmVjYXVzZSBpdCdzIG5vdCBwb2ludCB0b3dhcmRzIHRoZSBvcmlnaW47XHJcbiAgICAgICAgICAgIC8vQUJ4QTB4QUIgZGlyZWN0aW9uIHdlIGFyZSBsb29raW5nIGZvclxyXG4gICAgICAgICAgICBkaXIuY29weUZyb20odGhpcy5fZ2V0Tm9ybWFsKGFiLCBhbywgYWIpKTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vYnVpbGQgbmV3IHRldHJhaGVkcm9uIHdpdGggbmV3IGJhc2VcclxuICAgICAgICBzaW1wbGV4LnNwbGljZSgwLCAxKTtcclxuXHJcbiAgICAgICAgZGlyLmNvcHlGcm9tKGFiYyk7XHJcblxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBBZGRzIGFkZ2UgdG8gdGhlIGxpc3QgYW5kIGNoZWNrcyBpZiB0aGUgZWRnZSBpZiBub3QgaW4uXHJcbiAgICAgKlxyXG4gICAgICogQG1ldGhvZCBfYWRkRWRnZVxyXG4gICAgICogQHByaXZhdGVcclxuICAgICAqIEBwYXJhbSB7T2JqZWN0W119IGVkZ2VzIFRoZSBlZGdlcy5cclxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBkaXIgVGhlIGVkZ2UgdG8gY2hlY2suXHJcbiAgICAgKi9cclxuICAgIF9hZGRFZGdlOiBmdW5jdGlvbihlZGdlcywgZWRnZSkge1xyXG4gICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgZWRnZXMubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICAgICAgaWYgKGVkZ2VzW2pdLmEgPT09IGVkZ2UuYiAmJiBlZGdlc1tqXS5iID09PSBlZGdlLmEpIHtcclxuICAgICAgICAgICAgICAgIGVkZ2VzLnNwbGljZShqLCAxKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlZGdlcy5wdXNoKGVkZ2UpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuICAgICAqIFRoZSBzdXBwb3J0IGZ1bmN0aW9uLlxyXG4gICAgICpcclxuICAgICAqIEBtZXRob2Qgc3VwcG9ydFxyXG4gICAgICogQHBhcmFtIHtCQUJZTE9OLlZlY3RvcjJ8QkFCWUxPTi5WZWN0b3IzW119IGNvbGxpZGVyUG9pbnRzIFRoZSBjb252ZXhlIGNvbGxpZGVyIG9iamVjdC5cclxuICAgICAqIEBwYXJhbSB7QkFCWUxPTi5WZWN0b3IyfEJBQllMT04uVmVjdG9yM1tdfSBjb2xsaWRlZFBvaW50cyBUaGUgY29udmV4ZSBjb2xsaWRlZCBvYmplY3QuXHJcbiAgICAgKiBAcGFyYW0ge0JBQllMT04uVmVjdG9yMnxCQUJZTE9OLlZlY3RvcjN9IGRpcmVjdGlvbiBUaGUgZGlyZWN0aW9uLlxyXG4gICAgICogQHJldHVybiB7QkFCWUxPTi5WZWN0b3IyfEJBQllMT04uVmVjdG9yM30gVGhlIHN1cHBvcnQgcG9pbnRzLlxyXG4gICAgICovXHJcbiAgICBzdXBwb3J0OiBmdW5jdGlvbihjb2xsaWRlclBvaW50cywgY29sbGlkZWRQb2ludHMsIGRpcmVjdGlvbikge1xyXG4gICAgICAgIC8vIGQgaXMgYSB2ZWN0b3IgZGlyZWN0aW9uIChkb2Vzbid0IGhhdmUgdG8gYmUgbm9ybWFsaXplZClcclxuICAgICAgICAvLyBnZXQgcG9pbnRzIG9uIHRoZSBlZGdlIG9mIHRoZSBzaGFwZXMgaW4gb3Bwb3NpdGUgZGlyZWN0aW9uc1xyXG4gICAgICAgIGRpcmVjdGlvbi5ub3JtYWxpemUoKTtcclxuICAgICAgICB2YXIgcDEgPSB0aGlzLl9nZXRGYXJ0aGVzdFBvaW50SW5EaXJlY3Rpb24oY29sbGlkZXJQb2ludHMsIGRpcmVjdGlvbik7XHJcbiAgICAgICAgdmFyIHAyID0gdGhpcy5fZ2V0RmFydGhlc3RQb2ludEluRGlyZWN0aW9uKGNvbGxpZGVkUG9pbnRzLCBkaXJlY3Rpb24uc2NhbGUoLTEpKTtcclxuICAgICAgICAvLyBwZXJmb3JtIHRoZSBNaW5rb3dza2kgRGlmZmVyZW5jZVxyXG4gICAgICAgIHZhciBwMyA9IHAxLnN1YnRyYWN0KHAyKTtcclxuICAgICAgICAvLyBwMyBpcyBub3cgYSBwb2ludCBpbiBNaW5rb3dza2kgc3BhY2Ugb24gdGhlIGVkZ2Ugb2YgdGhlIE1pbmtvd3NraSBEaWZmZXJlbmNlXHJcbiAgICAgICAgcmV0dXJuIHAzO1xyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuICAgICAqIENoZWNrcyBpZiB0aGUgc2ltcGxleCBjb250YWlucyB0aGUgb3JpZ2luLlxyXG4gICAgICpcclxuICAgICAqIEBtZXRob2QgZmluZFJlc3BvbnNlV2l0aEVkZ2VcclxuICAgICAqIEBwYXJhbSB7QkFCWUxPTi5WZWN0b3IyfEJBQllMT04uVmVjdG9yM1tdfSBzaW1wbGV4VGhlIHNpbXBsZXggb3IgZmFsc2UgaWYgbm8gaW50ZXJzZWN0aW9uLlxyXG4gICAgICogQHBhcmFtIHtCQUJZTE9OLlZlY3RvcjJ8QkFCWUxPTi5WZWN0b3IzfSBkaXIgVGhlIGRpcmVjdGlvbiB0byB0ZXN0LlxyXG4gICAgICogQHJldHVybiB7Qm9vbGVhbn0gQ29udGFpbnMgb3Igbm90LlxyXG4gICAgICovXHJcbiAgICBjb250YWluc09yaWdpbjogZnVuY3Rpb24oc2ltcGxleCwgZGlyKSB7XHJcbiAgICAgICAgaWYgKHNpbXBsZXgubGVuZ3RoID09PSAyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jb250YWluc0xpbmUoc2ltcGxleCwgZGlyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHNpbXBsZXgubGVuZ3RoID09PSAzKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jb250YWluc1RyaWFuZ2xlKHNpbXBsZXgsIGRpcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChzaW1wbGV4Lmxlbmd0aCA9PT0gNCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fY29udGFpbnNUZXRyYWhlZHJvbihzaW1wbGV4LCBkaXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxyXG4gICAgICogVGhlIEdKSyAoR2lsYmVydOKAk0pvaG5zb27igJNLZWVydGhpKSBhbGdvcml0aG0uXHJcbiAgICAgKiBDb21wdXRlcyBzdXBwb3J0IHBvaW50cyB0byBidWlsZCB0aGUgTWlua293c2t5IGRpZmZlcmVuY2UgYW5kXHJcbiAgICAgKiBjcmVhdGUgYSBzaW1wbGV4LiBUaGUgcG9pbnRzIG9mIHRoZSBjb2xsaWRlciBhbmQgdGhlIGNvbGxpZGVkIG9iamVjdFxyXG4gICAgICogbXVzdCBiZSBjb252ZXhlLlxyXG4gICAgICpcclxuICAgICAqIEBtZXRob2QgZmluZFJlc3BvbnNlV2l0aEVkZ2VcclxuICAgICAqIEBwYXJhbSB7QkFCWUxPTi5WZWN0b3IyfEJBQllMT04uVmVjdG9yM1tdfSBjb2xsaWRlclBvaW50cyBUaGUgY29udmV4ZSBjb2xsaWRlciBvYmplY3QuXHJcbiAgICAgKiBAcGFyYW0ge0JBQllMT04uVmVjdG9yMnxCQUJZTE9OLlZlY3RvcjNbXX0gY29sbGlkZWRQb2ludHMgVGhlIGNvbnZleGUgY29sbGlkZWQgb2JqZWN0LlxyXG4gICAgICogQHJldHVybiB7QkFCWUxPTi5WZWN0b3IyfEJBQllMT04uVmVjdG9yM1tdfSBUaGUgc2ltcGxleCBvciBmYWxzZSBpZiBubyBpbnRlcnNlY3Rpb24uXHJcbiAgICAgKi9cclxuICAgIGNoZWNrOiBmdW5jdGlvbihjb2xsaWRlclBvaW50cywgY29sbGlkZWRQb2ludHMpIHtcclxuICAgICAgICB2YXIgaXQgPSAwO1xyXG4gICAgICAgIHZhciBhLCBzaW1wbGV4ID0gW107XHJcblxyXG4gICAgICAgIHZhciBjb2xsaWRlckNlbnRlciA9IHRoaXMuX2dldEJhcnljZW50ZXIoY29sbGlkZXJQb2ludHMpO1xyXG4gICAgICAgIHZhciBjb2xsaWRlZENlbnRlciA9IHRoaXMuX2dldEJhcnljZW50ZXIoY29sbGlkZWRQb2ludHMpO1xyXG5cclxuICAgICAgICAvLyBpbml0aWFsIGRpcmVjdGlvbiBmcm9tIHRoZSBjZW50ZXIgb2YgMXN0IGJvZHkgdG8gdGhlIGNlbnRlciBvZiAybmQgYm9keVxyXG4gICAgICAgIHZhciBkaXIgPSBjb2xsaWRlckNlbnRlci5zdWJ0cmFjdChjb2xsaWRlZENlbnRlcikubm9ybWFsaXplKCk7XHJcblxyXG4gICAgICAgIC8vIGlmIGluaXRpYWwgZGlyZWN0aW9uIGlzIHplcm8g4oCTIHNldCBpdCB0byBhbnkgYXJiaXRyYXJ5IGF4aXMgKHdlIGNob29zZSBYKVxyXG4gICAgICAgIGlmIChkaXIubGVuZ3RoU3F1YXJlZCgpIDwgdGhpcy5FUFNJTE9OKSB7XHJcbiAgICAgICAgICAgIGRpci54ID0gMTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIHNldCB0aGUgZmlyc3Qgc3VwcG9ydCBhcyBpbml0aWFsIHBvaW50IG9mIHRoZSBuZXcgc2ltcGxleFxyXG4gICAgICAgIGEgPSBzaW1wbGV4WzBdID0gdGhpcy5zdXBwb3J0KGNvbGxpZGVyUG9pbnRzLCBjb2xsaWRlZFBvaW50cywgZGlyKTtcclxuXHJcbiAgICAgICAgaWYgKGEuY29uc3RydWN0b3IuRG90KGEsIGRpcikgPD0gMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBkaXIuc2NhbGVJblBsYWNlKC0xLCBkaXIpOyAvLyB3ZSB3aWxsIGJlIHNlYXJjaGluZyBpbiB0aGUgb3Bwb3NpdGUgZGlyZWN0aW9uIG5leHRcclxuXHJcbiAgICAgICAgdmFyIG1heCA9IGNvbGxpZGVkUG9pbnRzLmxlbmd0aCAqIGNvbGxpZGVyUG9pbnRzLmxlbmd0aDtcclxuICAgICAgICB3aGlsZSAoaXQgPCBtYXgpIHtcclxuICAgICAgICAgICAgaWYgKGRpci5sZW5ndGhTcXVhcmVkKCkgPT09IDAgJiYgc2ltcGxleC5sZW5ndGggPj0gMikge1xyXG4gICAgICAgICAgICAgICAgLy8gR2V0IHBlcnBlbmRpY3VsYXIgZGlyZWN0aW9uIHRvIGxhc3Qgc2ltcGxleFxyXG4gICAgICAgICAgICAgICAgZGlyID0gc2ltcGxleFtzaW1wbGV4Lmxlbmd0aCAtIDFdLnN1YnRyYWN0KHNpbXBsZXhbc2ltcGxleC5sZW5ndGggLSAyXSk7XHJcbiAgICAgICAgICAgICAgICB2YXIgdG1wID0gZGlyLnk7XHJcbiAgICAgICAgICAgICAgICBkaXIueSA9IC1kaXIueDtcclxuICAgICAgICAgICAgICAgIGRpci54ID0gdG1wO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhID0gdGhpcy5zdXBwb3J0KGNvbGxpZGVyUG9pbnRzLCBjb2xsaWRlZFBvaW50cywgZGlyKTtcclxuXHJcbiAgICAgICAgICAgIC8vIG1ha2Ugc3VyZSB0aGF0IHRoZSBsYXN0IHBvaW50IHdlIGFkZGVkIGFjdHVhbGx5IHBhc3NlZCB0aGUgb3JpZ2luXHJcbiAgICAgICAgICAgIGlmIChhLmNvbnN0cnVjdG9yLkRvdChhLCBkaXIpIDw9IDApIHtcclxuICAgICAgICAgICAgICAgIC8vIGlmIHRoZSBwb2ludCBhZGRlZCBsYXN0IHdhcyBub3QgcGFzdCB0aGUgb3JpZ2luIGluIHRoZSBkaXJlY3Rpb24gb2YgZFxyXG4gICAgICAgICAgICAgICAgLy8gdGhlbiB0aGUgTWlua293c2tpIFN1bSBjYW5ub3QgcG9zc2libHkgY29udGFpbiB0aGUgb3JpZ2luIHNpbmNlXHJcbiAgICAgICAgICAgICAgICAvLyB0aGUgbGFzdCBwb2ludCBhZGRlZCBpcyBvbiB0aGUgZWRnZSBvZiB0aGUgTWlua293c2tpIERpZmZlcmVuY2VcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc2ltcGxleC5wdXNoKGEpO1xyXG4gICAgICAgICAgICAvLyBvdGhlcndpc2Ugd2UgbmVlZCB0byBkZXRlcm1pbmUgaWYgdGhlIG9yaWdpbiBpcyBpblxyXG4gICAgICAgICAgICAvLyB0aGUgY3VycmVudCBzaW1wbGV4XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5jb250YWluc09yaWdpbihzaW1wbGV4LCBkaXIpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc2ltcGxleDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpdCsrO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBGaW5kcyB0aGUgcmVzcG9uc2Ugd2l0aCB0aGUgc2ltcGxleCAoZWRnZXMpIG9mIHRoZSBnamsgYWxnb3JpdGhtLlxyXG4gICAgICpcclxuICAgICAqIEBtZXRob2QgZmluZFJlc3BvbnNlV2l0aEVkZ2VcclxuICAgICAqIEBwYXJhbSB7QkFCWUxPTi5WZWN0b3IyW119IGNvbGxpZGVyUG9pbnRzIFRoZSBjb252ZXhlIGNvbGxpZGVyIG9iamVjdC5cclxuICAgICAqIEBwYXJhbSB7QkFCWUxPTi5WZWN0b3IyW119IGNvbGxpZGVkUG9pbnRzIFRoZSBjb252ZXhlIGNvbGxpZGVkIG9iamVjdC5cclxuICAgICAqIEBwYXJhbSB7QkFCWUxPTi5WZWN0b3IyW119IHNpbXBsZXggVGhlIHNpbXBsZXguXHJcbiAgICAgKiBAcmV0dXJuIHtCQUJZTE9OLlZlY3RvcjJ8QkFCWUxPTi5WZWN0b3IzfSBUaGUgcGVuZXRyYXRpb24gdmVjdG9yLlxyXG4gICAgICovXHJcbiAgICBmaW5kUmVzcG9uc2VXaXRoRWRnZTogZnVuY3Rpb24oY29sbGlkZXJQb2ludHMsIGNvbGxpZGVkUG9pbnRzLCBzaW1wbGV4KSB7XHJcbiAgICAgICAgdmFyIGVkZ2UgPSB0aGlzLl9nZXROZWFyZXN0RWRnZShzaW1wbGV4KTtcclxuICAgICAgICB2YXIgc3VwID0gdGhpcy5zdXBwb3J0KGNvbGxpZGVyUG9pbnRzLCBjb2xsaWRlZFBvaW50cywgZWRnZS5ub3JtYWwpOyAvL2dldCBzdXBwb3J0IHBvaW50IGluIGRpcmVjdGlvbiBvZiBlZGdlJ3Mgbm9ybWFsXHJcbiAgICAgICAgdmFyIGQgPSBNYXRoLmFicyhzdXAuY29uc3RydWN0b3IuRG90KHN1cCwgZWRnZS5ub3JtYWwpKTtcclxuXHJcbiAgICAgICAgaWYgKGQgLSBlZGdlLmRpc3RhbmNlIDw9IHRoaXMuRVBTSUxPTikge1xyXG4gICAgICAgICAgICByZXR1cm4gZWRnZS5ub3JtYWwuc2NhbGUoZWRnZS5kaXN0YW5jZSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgc2ltcGxleC5zcGxpY2UoZWRnZS5pbmRleCwgMCwgc3VwKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuICAgICAqIEZpbmRzIHRoZSByZXNwb25zZSB3aXRoIHRoZSBwb2x5dG9wZSBkb25lIHdpdGggdGhlIHNpbXBsZXggb2YgdGhlIGdqayBhbGdvcml0aG0uXHJcbiAgICAgKlxyXG4gICAgICogQG1ldGhvZCBmaW5kUmVzcG9uc2VXaXRoVHJpYW5nbGVcclxuICAgICAqIEBwYXJhbSB7QkFCWUxPTi5WZWN0b3IzW119IGNvbGxpZGVyUG9pbnRzIFRoZSBjb252ZXhlIGNvbGxpZGVyIG9iamVjdC5cclxuICAgICAqIEBwYXJhbSB7QkFCWUxPTi5WZWN0b3IzW119IGNvbGxpZGVkUG9pbnRzIFRoZSBjb252ZXhlIGNvbGxpZGVkIG9iamVjdC5cclxuICAgICAqIEBwYXJhbSB7VHJpYW5nbGVbXX0gcG9seXRvcGUgVGhlIHBvbHl0b3BlIGRvbmUgd2l0aCB0aGUgc2ltcGxleC5cclxuICAgICAqIEByZXR1cm4ge0JBQllMT04uVmVjdG9yMnxCQUJZTE9OLlZlY3RvcjN9IFRoZSBwZW5ldHJhdGlvbiB2ZWN0b3IuXHJcbiAgICAgKi9cclxuICAgIGZpbmRSZXNwb25zZVdpdGhUcmlhbmdsZTogZnVuY3Rpb24oY29sbGlkZXJQb2ludHMsIGNvbGxpZGVkUG9pbnRzLCBwb2x5dG9wZSkge1xyXG5cclxuICAgICAgICBpZiAocG9seXRvcGUubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBuZWFyZXN0ID0gdGhpcy5fZ2V0TmVhcmVzdFRyaWFuZ2xlKHBvbHl0b3BlKTtcclxuICAgICAgICB2YXIgdHJpYW5nbGUgPSBwb2x5dG9wZVtuZWFyZXN0LmluZGV4XTtcclxuXHJcbiAgICAgICAgdmFyIHN1cCA9IHRoaXMuc3VwcG9ydChjb2xsaWRlclBvaW50cywgY29sbGlkZWRQb2ludHMsIHRyaWFuZ2xlLm4pO1xyXG5cclxuICAgICAgICB2YXIgZCA9IE1hdGguYWJzKHN1cC5jb25zdHJ1Y3Rvci5Eb3Qoc3VwLCB0cmlhbmdsZS5uKSk7XHJcblxyXG4gICAgICAgIGlmICgoZCAtIG5lYXJlc3QuZGlzdGFuY2UgPD0gdGhpcy5FUFNJTE9OKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJpYW5nbGUubi5zY2FsZShuZWFyZXN0LmRpc3RhbmNlKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB2YXIgZWRnZXMgPSBbXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IHBvbHl0b3BlLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XHJcbiAgICAgICAgICAgICAgICB0cmlhbmdsZSA9IHBvbHl0b3BlW2ldO1xyXG4gICAgICAgICAgICAgICAgLy8gY2FuIHRoaXMgZmFjZSBiZSAnc2VlbicgYnkgZW50cnlfY3VyX3N1cHBvcnQ/XHJcbiAgICAgICAgICAgICAgICBpZiAodHJpYW5nbGUubi5jb25zdHJ1Y3Rvci5Eb3QodHJpYW5nbGUubiwgc3VwLnN1YnRyYWN0KHBvbHl0b3BlW2ldLmEpKSA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9hZGRFZGdlKGVkZ2VzLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGE6IHRyaWFuZ2xlLmEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGI6IHRyaWFuZ2xlLmJcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9hZGRFZGdlKGVkZ2VzLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGE6IHRyaWFuZ2xlLmIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGI6IHRyaWFuZ2xlLmNcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9hZGRFZGdlKGVkZ2VzLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGE6IHRyaWFuZ2xlLmMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGI6IHRyaWFuZ2xlLmFcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBwb2x5dG9wZS5zcGxpY2UoaSwgMSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIGNyZWF0ZSBuZXcgdHJpYW5nbGVzIGZyb20gdGhlIGVkZ2VzIGluIHRoZSBlZGdlIGxpc3RcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlZGdlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgdHJpYW5nbGUgPSBuZXcgVHJpYW5nbGUoc3VwLCBlZGdlc1tpXS5hLCBlZGdlc1tpXS5iKTtcclxuICAgICAgICAgICAgICAgIGlmICh0cmlhbmdsZS5uLmxlbmd0aCgpICE9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcG9seXRvcGUucHVzaCh0cmlhbmdsZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXRzIHRoZSByZXNwb25zZSBvZiB0aGUgcGVuZXRyYXRpb24gdmVjdG9yIHdpdGggdGhlIHNpbXBsZXguXHJcbiAgICAgKlxyXG4gICAgICogQG1ldGhvZCBnZXRSZXNwb25zZVxyXG4gICAgICogQHBhcmFtIHtCQUJZTE9OLlZlY3RvcjJ8QkFCWUxPTi5WZWN0b3IzW119IGNvbGxpZGVyUG9pbnRzIFRoZSBjb252ZXhlIGNvbGxpZGVyIG9iamVjdC5cclxuICAgICAqIEBwYXJhbSB7QkFCWUxPTi5WZWN0b3IyfEJBQllMT04uVmVjdG9yM1tdfSBjb2xsaWRlZFBvaW50cyBUaGUgY29udmV4ZSBjb2xsaWRlZCBvYmplY3QuXHJcbiAgICAgKiBAcGFyYW0ge0JBQllMT04uVmVjdG9yMnxCQUJZTE9OLlZlY3RvcjNbXX0gc2ltcGxleCBUaGUgc2ltcGxleCBvZiB0aGUgTWlua293c2t5IGRpZmZlcmVuY2UuXHJcbiAgICAgKiBAcmV0dXJuIHtCQUJZTE9OLlZlY3RvcjJ8QkFCWUxPTi5WZWN0b3IzfSBUaGUgcGVuZXRyYXRpb24gdmVjdG9yLlxyXG4gICAgICovXHJcbiAgICBnZXRSZXNwb25zZTogZnVuY3Rpb24oY29sbGlkZXJQb2ludHMsIGNvbGxpZGVkUG9pbnRzLCBzaW1wbGV4KSB7XHJcbiAgICAgICAgdmFyIGl0ID0gMCxcclxuICAgICAgICAgICAgcmVzcG9uc2U7XHJcbiAgICAgICAgdmFyIHBvbHl0b3BlID0gc2ltcGxleFswXS56ICE9PSB1bmRlZmluZWQgPyBbbmV3IFRyaWFuZ2xlKHNpbXBsZXhbMF0sIHNpbXBsZXhbMV0sIHNpbXBsZXhbMl0pLFxyXG4gICAgICAgICAgICBuZXcgVHJpYW5nbGUoc2ltcGxleFswXSwgc2ltcGxleFsyXSwgc2ltcGxleFszXSksXHJcbiAgICAgICAgICAgIG5ldyBUcmlhbmdsZShzaW1wbGV4WzBdLCBzaW1wbGV4WzNdLCBzaW1wbGV4WzFdKSxcclxuICAgICAgICAgICAgbmV3IFRyaWFuZ2xlKHNpbXBsZXhbMV0sIHNpbXBsZXhbM10sIHNpbXBsZXhbMl0pXHJcbiAgICAgICAgXSA6IG51bGw7XHJcblxyXG4gICAgICAgIHZhciBtYXggPSBjb2xsaWRlZFBvaW50cy5sZW5ndGggKiBjb2xsaWRlclBvaW50cy5sZW5ndGg7XHJcbiAgICAgICAgd2hpbGUgKGl0IDwgbWF4KSB7XHJcbiAgICAgICAgICAgIGlmIChzaW1wbGV4WzBdLnogPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgcmVzcG9uc2UgPSB0aGlzLmZpbmRSZXNwb25zZVdpdGhFZGdlKGNvbGxpZGVyUG9pbnRzLCBjb2xsaWRlZFBvaW50cywgc2ltcGxleCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXNwb25zZSA9IHRoaXMuZmluZFJlc3BvbnNlV2l0aFRyaWFuZ2xlKGNvbGxpZGVyUG9pbnRzLCBjb2xsaWRlZFBvaW50cywgcG9seXRvcGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG5vcm0gPSByZXNwb25zZS5jbG9uZSgpLm5vcm1hbGl6ZSgpLnNjYWxlSW5QbGFjZSh0aGlzLkVQU0lMT04pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmFkZFRvUmVmKG5vcm0sIHJlc3BvbnNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpdCsrO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ2hlY2tzIGlmIHRoZSBjb2xsaWRlciBhbmQgdGhlIGNvbGxpZGVkIG9iamVjdCBhcmUgaW50ZXJzZWN0aW5nLlxyXG4gICAgICpcclxuICAgICAqIEBtZXRob2QgaXNJbnRlcnNlY3RpbmdcclxuICAgICAqIEBwYXJhbSB7QkFCWUxPTi5WZWN0b3IyfEJBQllMT04uVmVjdG9yM1tdfSBjb2xsaWRlclBvaW50cyBUaGUgY29udmV4ZSBjb2xsaWRlciBvYmplY3QuXHJcbiAgICAgKiBAcGFyYW0ge0JBQllMT04uVmVjdG9yMnxCQUJZTE9OLlZlY3RvcjNbXX0gY29sbGlkZWRQb2ludHMgVGhlIGNvbnZleGUgY29sbGlkZWQgb2JqZWN0LlxyXG4gICAgICogQHJldHVybiB7Qm9vbGVhbn0gSXMgaW50ZXJzZWN0aW5nIG9yIG5vdC5cclxuICAgICAqL1xyXG4gICAgaXNJbnRlcnNlY3Rpbmc6IGZ1bmN0aW9uKGNvbGxpZGVyUG9pbnRzLCBjb2xsaWRlZFBvaW50cykge1xyXG4gICAgICAgIHJldHVybiAhIXRoaXMuY2hlY2soY29sbGlkZXJQb2ludHMsIGNvbGxpZGVkUG9pbnRzKTtcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDaGVja3MgaWYgdGhlIGNvbGxpZGVyIGFuZCB0aGUgY29sbGlkZWQgb2JqZWN0IGFyZSBpbnRlcnNlY3RpbmdcclxuICAgICAqIGFuZCBnaXZlIHRoZSByZXNwb25zZSB0byBiZSBvdXQgb2YgdGhlIG9iamVjdC5cclxuICAgICAqXHJcbiAgICAgKiBAbWV0aG9kIGludGVyc2VjdFxyXG4gICAgICogQHBhcmFtIHtCQUJZTE9OLlZlY3RvcjJ8QkFCWUxPTi5WZWN0b3IzW119IGNvbGxpZGVyUG9pbnRzIFRoZSBjb252ZXhlIGNvbGxpZGVyIG9iamVjdC5cclxuICAgICAqIEBwYXJhbSB7QkFCWUxPTi5WZWN0b3IyfEJBQllMT04uVmVjdG9yM1tdfSBjb2xsaWRlZFBvaW50cyBUaGUgY29udmV4ZSBjb2xsaWRlZCBvYmplY3QuXHJcbiAgICAgKiBAcmV0dXJuIHtCQUJZTE9OLlZlY3RvcjJ8QkFCWUxPTi5WZWN0b3IzfSBUaGUgcGVuZXRyYXRpb24gdmVjdG9yLlxyXG4gICAgICovXHJcbiAgICBpbnRlcnNlY3Q6IGZ1bmN0aW9uKGNvbGxpZGVyUG9pbnRzLCBjb2xsaWRlZFBvaW50cykge1xyXG4gICAgICAgIHZhciBzaW1wbGV4ID0gdGhpcy5jaGVjayhjb2xsaWRlclBvaW50cywgY29sbGlkZWRQb2ludHMpO1xyXG5cclxuICAgICAgICAvL3RoaXMuY3ViZSA9IHRoaXMuY3ViZSB8fCBbXTtcclxuICAgICAgICBpZiAoc2ltcGxleCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRSZXNwb25zZShjb2xsaWRlclBvaW50cywgY29sbGlkZWRQb2ludHMsIHNpbXBsZXgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBDb2xsaXNpb25HamtFcGE7XHJcbiIsInZhciBfX2RlY29yYXRlPXRoaXMmJnRoaXMuX19kZWNvcmF0ZXx8ZnVuY3Rpb24oZSx0LGkscil7dmFyIG4sbz1hcmd1bWVudHMubGVuZ3RoLHM9Mz5vP3Q6bnVsbD09PXI/cj1PYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHQsaSk6cjtpZihcIm9iamVjdFwiPT10eXBlb2YgUmVmbGVjdCYmXCJmdW5jdGlvblwiPT10eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSlzPVJlZmxlY3QuZGVjb3JhdGUoZSx0LGkscik7ZWxzZSBmb3IodmFyIGE9ZS5sZW5ndGgtMTthPj0wO2EtLSkobj1lW2FdKSYmKHM9KDM+bz9uKHMpOm8+Mz9uKHQsaSxzKTpuKHQsaSkpfHxzKTtyZXR1cm4gbz4zJiZzJiZPYmplY3QuZGVmaW5lUHJvcGVydHkodCxpLHMpLHN9LF9fZXh0ZW5kcz10aGlzJiZ0aGlzLl9fZXh0ZW5kc3x8ZnVuY3Rpb24oZSx0KXtmdW5jdGlvbiBpKCl7dGhpcy5jb25zdHJ1Y3Rvcj1lfWZvcih2YXIgciBpbiB0KXQuaGFzT3duUHJvcGVydHkocikmJihlW3JdPXRbcl0pO2kucHJvdG90eXBlPXQucHJvdG90eXBlLGUucHJvdG90eXBlPW5ldyBpfSxCQUJZTE9OOyFmdW5jdGlvbihlKXtlLlRvR2FtbWFTcGFjZT0xLzIuMixlLlRvTGluZWFyU3BhY2U9Mi4yLGUuRXBzaWxvbj0uMDAxO3ZhciB0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSgpe31yZXR1cm4gZS5XaXRoaW5FcHNpbG9uPWZ1bmN0aW9uKGUsdCxpKXt2b2lkIDA9PT1pJiYoaT0xLjQwMTI5OGUtNDUpO3ZhciByPWUtdDtyZXR1cm4gcj49LWkmJmk+PXJ9LGUuVG9IZXg9ZnVuY3Rpb24oZSl7dmFyIHQ9ZS50b1N0cmluZygxNik7cmV0dXJuIDE1Pj1lPyhcIjBcIit0KS50b1VwcGVyQ2FzZSgpOnQudG9VcHBlckNhc2UoKX0sZS5TaWduPWZ1bmN0aW9uKGUpe3JldHVybiBlPStlLDA9PT1lfHxpc05hTihlKT9lOmU+MD8xOi0xfSxlLkNsYW1wPWZ1bmN0aW9uKGUsdCxpKXtyZXR1cm4gdm9pZCAwPT09dCYmKHQ9MCksdm9pZCAwPT09aSYmKGk9MSksTWF0aC5taW4oaSxNYXRoLm1heCh0LGUpKX0sZX0oKTtlLk1hdGhUb29scz10O3ZhciBpPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gaShlLHQsaSl7dm9pZCAwPT09ZSYmKGU9MCksdm9pZCAwPT09dCYmKHQ9MCksdm9pZCAwPT09aSYmKGk9MCksdGhpcy5yPWUsdGhpcy5nPXQsdGhpcy5iPWl9cmV0dXJuIGkucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuXCJ7UjogXCIrdGhpcy5yK1wiIEc6XCIrdGhpcy5nK1wiIEI6XCIrdGhpcy5iK1wifVwifSxpLnByb3RvdHlwZS5nZXRDbGFzc05hbWU9ZnVuY3Rpb24oKXtyZXR1cm5cIkNvbG9yM1wifSxpLnByb3RvdHlwZS5nZXRIYXNoQ29kZT1mdW5jdGlvbigpe3ZhciBlPXRoaXMucnx8MDtyZXR1cm4gZT0zOTcqZV4odGhpcy5nfHwwKSxlPTM5NyplXih0aGlzLmJ8fDApfSxpLnByb3RvdHlwZS50b0FycmF5PWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHZvaWQgMD09PXQmJih0PTApLGVbdF09dGhpcy5yLGVbdCsxXT10aGlzLmcsZVt0KzJdPXRoaXMuYix0aGlzfSxpLnByb3RvdHlwZS50b0NvbG9yND1mdW5jdGlvbihlKXtyZXR1cm4gdm9pZCAwPT09ZSYmKGU9MSksbmV3IHIodGhpcy5yLHRoaXMuZyx0aGlzLmIsZSl9LGkucHJvdG90eXBlLmFzQXJyYXk9ZnVuY3Rpb24oKXt2YXIgZT1bXTtyZXR1cm4gdGhpcy50b0FycmF5KGUsMCksZX0saS5wcm90b3R5cGUudG9MdW1pbmFuY2U9ZnVuY3Rpb24oKXtyZXR1cm4uMyp0aGlzLnIrLjU5KnRoaXMuZysuMTEqdGhpcy5ifSxpLnByb3RvdHlwZS5tdWx0aXBseT1mdW5jdGlvbihlKXtyZXR1cm4gbmV3IGkodGhpcy5yKmUucix0aGlzLmcqZS5nLHRoaXMuYiplLmIpfSxpLnByb3RvdHlwZS5tdWx0aXBseVRvUmVmPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQucj10aGlzLnIqZS5yLHQuZz10aGlzLmcqZS5nLHQuYj10aGlzLmIqZS5iLHRoaXN9LGkucHJvdG90eXBlLmVxdWFscz1mdW5jdGlvbihlKXtyZXR1cm4gZSYmdGhpcy5yPT09ZS5yJiZ0aGlzLmc9PT1lLmcmJnRoaXMuYj09PWUuYn0saS5wcm90b3R5cGUuZXF1YWxzRmxvYXRzPWZ1bmN0aW9uKGUsdCxpKXtyZXR1cm4gdGhpcy5yPT09ZSYmdGhpcy5nPT09dCYmdGhpcy5iPT09aX0saS5wcm90b3R5cGUuc2NhbGU9ZnVuY3Rpb24oZSl7cmV0dXJuIG5ldyBpKHRoaXMuciplLHRoaXMuZyplLHRoaXMuYiplKX0saS5wcm90b3R5cGUuc2NhbGVUb1JlZj1mdW5jdGlvbihlLHQpe3JldHVybiB0LnI9dGhpcy5yKmUsdC5nPXRoaXMuZyplLHQuYj10aGlzLmIqZSx0aGlzfSxpLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oZSl7cmV0dXJuIG5ldyBpKHRoaXMucitlLnIsdGhpcy5nK2UuZyx0aGlzLmIrZS5iKX0saS5wcm90b3R5cGUuYWRkVG9SZWY9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdC5yPXRoaXMucitlLnIsdC5nPXRoaXMuZytlLmcsdC5iPXRoaXMuYitlLmIsdGhpc30saS5wcm90b3R5cGUuc3VidHJhY3Q9ZnVuY3Rpb24oZSl7cmV0dXJuIG5ldyBpKHRoaXMuci1lLnIsdGhpcy5nLWUuZyx0aGlzLmItZS5iKX0saS5wcm90b3R5cGUuc3VidHJhY3RUb1JlZj1mdW5jdGlvbihlLHQpe3JldHVybiB0LnI9dGhpcy5yLWUucix0Lmc9dGhpcy5nLWUuZyx0LmI9dGhpcy5iLWUuYix0aGlzfSxpLnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbigpe3JldHVybiBuZXcgaSh0aGlzLnIsdGhpcy5nLHRoaXMuYil9LGkucHJvdG90eXBlLmNvcHlGcm9tPWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLnI9ZS5yLHRoaXMuZz1lLmcsdGhpcy5iPWUuYix0aGlzfSxpLnByb3RvdHlwZS5jb3B5RnJvbUZsb2F0cz1mdW5jdGlvbihlLHQsaSl7cmV0dXJuIHRoaXMucj1lLHRoaXMuZz10LHRoaXMuYj1pLHRoaXN9LGkucHJvdG90eXBlLnRvSGV4U3RyaW5nPWZ1bmN0aW9uKCl7dmFyIGU9MjU1KnRoaXMucnwwLGk9MjU1KnRoaXMuZ3wwLHI9MjU1KnRoaXMuYnwwO3JldHVyblwiI1wiK3QuVG9IZXgoZSkrdC5Ub0hleChpKSt0LlRvSGV4KHIpfSxpLnByb3RvdHlwZS50b0xpbmVhclNwYWNlPWZ1bmN0aW9uKCl7dmFyIGU9bmV3IGk7cmV0dXJuIHRoaXMudG9MaW5lYXJTcGFjZVRvUmVmKGUpLGV9LGkucHJvdG90eXBlLnRvTGluZWFyU3BhY2VUb1JlZj1mdW5jdGlvbih0KXtyZXR1cm4gdC5yPU1hdGgucG93KHRoaXMucixlLlRvTGluZWFyU3BhY2UpLHQuZz1NYXRoLnBvdyh0aGlzLmcsZS5Ub0xpbmVhclNwYWNlKSx0LmI9TWF0aC5wb3codGhpcy5iLGUuVG9MaW5lYXJTcGFjZSksdGhpc30saS5wcm90b3R5cGUudG9HYW1tYVNwYWNlPWZ1bmN0aW9uKCl7dmFyIGU9bmV3IGk7cmV0dXJuIHRoaXMudG9HYW1tYVNwYWNlVG9SZWYoZSksZX0saS5wcm90b3R5cGUudG9HYW1tYVNwYWNlVG9SZWY9ZnVuY3Rpb24odCl7cmV0dXJuIHQucj1NYXRoLnBvdyh0aGlzLnIsZS5Ub0dhbW1hU3BhY2UpLHQuZz1NYXRoLnBvdyh0aGlzLmcsZS5Ub0dhbW1hU3BhY2UpLHQuYj1NYXRoLnBvdyh0aGlzLmIsZS5Ub0dhbW1hU3BhY2UpLHRoaXN9LGkuRnJvbUhleFN0cmluZz1mdW5jdGlvbihlKXtpZihcIiNcIiE9PWUuc3Vic3RyaW5nKDAsMSl8fDchPT1lLmxlbmd0aClyZXR1cm4gbmV3IGkoMCwwLDApO3ZhciB0PXBhcnNlSW50KGUuc3Vic3RyaW5nKDEsMyksMTYpLHI9cGFyc2VJbnQoZS5zdWJzdHJpbmcoMyw1KSwxNiksbj1wYXJzZUludChlLnN1YnN0cmluZyg1LDcpLDE2KTtyZXR1cm4gaS5Gcm9tSW50cyh0LHIsbil9LGkuRnJvbUFycmF5PWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHZvaWQgMD09PXQmJih0PTApLG5ldyBpKGVbdF0sZVt0KzFdLGVbdCsyXSl9LGkuRnJvbUludHM9ZnVuY3Rpb24oZSx0LHIpe3JldHVybiBuZXcgaShlLzI1NSx0LzI1NSxyLzI1NSl9LGkuTGVycD1mdW5jdGlvbihlLHQscil7dmFyIG49ZS5yKyh0LnItZS5yKSpyLG89ZS5nKyh0LmctZS5nKSpyLHM9ZS5iKyh0LmItZS5iKSpyO3JldHVybiBuZXcgaShuLG8scyl9LGkuUmVkPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBpKDEsMCwwKX0saS5HcmVlbj1mdW5jdGlvbigpe3JldHVybiBuZXcgaSgwLDEsMCl9LGkuQmx1ZT1mdW5jdGlvbigpe3JldHVybiBuZXcgaSgwLDAsMSl9LGkuQmxhY2s9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGkoMCwwLDApfSxpLldoaXRlPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBpKDEsMSwxKX0saS5QdXJwbGU9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGkoLjUsMCwuNSl9LGkuTWFnZW50YT1mdW5jdGlvbigpe3JldHVybiBuZXcgaSgxLDAsMSl9LGkuWWVsbG93PWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBpKDEsMSwwKX0saS5HcmF5PWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBpKC41LC41LC41KX0saX0oKTtlLkNvbG9yMz1pO3ZhciByPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlLHQsaSxyKXt0aGlzLnI9ZSx0aGlzLmc9dCx0aGlzLmI9aSx0aGlzLmE9cn1yZXR1cm4gZS5wcm90b3R5cGUuYWRkSW5QbGFjZT1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5yKz1lLnIsdGhpcy5nKz1lLmcsdGhpcy5iKz1lLmIsdGhpcy5hKz1lLmEsdGhpc30sZS5wcm90b3R5cGUuYXNBcnJheT1mdW5jdGlvbigpe3ZhciBlPVtdO3JldHVybiB0aGlzLnRvQXJyYXkoZSwwKSxlfSxlLnByb3RvdHlwZS50b0FycmF5PWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHZvaWQgMD09PXQmJih0PTApLGVbdF09dGhpcy5yLGVbdCsxXT10aGlzLmcsZVt0KzJdPXRoaXMuYixlW3QrM109dGhpcy5hLHRoaXN9LGUucHJvdG90eXBlLmFkZD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUodGhpcy5yK3Qucix0aGlzLmcrdC5nLHRoaXMuYit0LmIsdGhpcy5hK3QuYSl9LGUucHJvdG90eXBlLnN1YnRyYWN0PWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0aGlzLnItdC5yLHRoaXMuZy10LmcsdGhpcy5iLXQuYix0aGlzLmEtdC5hKX0sZS5wcm90b3R5cGUuc3VidHJhY3RUb1JlZj1mdW5jdGlvbihlLHQpe3JldHVybiB0LnI9dGhpcy5yLWUucix0Lmc9dGhpcy5nLWUuZyx0LmI9dGhpcy5iLWUuYix0LmE9dGhpcy5hLWUuYSx0aGlzfSxlLnByb3RvdHlwZS5zY2FsZT1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUodGhpcy5yKnQsdGhpcy5nKnQsdGhpcy5iKnQsdGhpcy5hKnQpfSxlLnByb3RvdHlwZS5zY2FsZVRvUmVmPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQucj10aGlzLnIqZSx0Lmc9dGhpcy5nKmUsdC5iPXRoaXMuYiplLHQuYT10aGlzLmEqZSx0aGlzfSxlLnByb3RvdHlwZS5tdWx0aXBseT1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUodGhpcy5yKnQucix0aGlzLmcqdC5nLHRoaXMuYip0LmIsdGhpcy5hKnQuYSl9LGUucHJvdG90eXBlLm11bHRpcGx5VG9SZWY9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdC5yPXRoaXMuciplLnIsdC5nPXRoaXMuZyplLmcsdC5iPXRoaXMuYiplLmIsdC5hPXRoaXMuYSplLmEsdH0sZS5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm5cIntSOiBcIit0aGlzLnIrXCIgRzpcIit0aGlzLmcrXCIgQjpcIit0aGlzLmIrXCIgQTpcIit0aGlzLmErXCJ9XCJ9LGUucHJvdG90eXBlLmdldENsYXNzTmFtZT1mdW5jdGlvbigpe3JldHVyblwiQ29sb3I0XCJ9LGUucHJvdG90eXBlLmdldEhhc2hDb2RlPWZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5yfHwwO3JldHVybiBlPTM5NyplXih0aGlzLmd8fDApLGU9Mzk3KmVeKHRoaXMuYnx8MCksZT0zOTcqZV4odGhpcy5hfHwwKX0sZS5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGUodGhpcy5yLHRoaXMuZyx0aGlzLmIsdGhpcy5hKX0sZS5wcm90b3R5cGUuY29weUZyb209ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMucj1lLnIsdGhpcy5nPWUuZyx0aGlzLmI9ZS5iLHRoaXMuYT1lLmEsdGhpc30sZS5wcm90b3R5cGUudG9IZXhTdHJpbmc9ZnVuY3Rpb24oKXt2YXIgZT0yNTUqdGhpcy5yfDAsaT0yNTUqdGhpcy5nfDAscj0yNTUqdGhpcy5ifDAsbj0yNTUqdGhpcy5hfDA7cmV0dXJuXCIjXCIrdC5Ub0hleChlKSt0LlRvSGV4KGkpK3QuVG9IZXgocikrdC5Ub0hleChuKX0sZS5Gcm9tSGV4U3RyaW5nPWZ1bmN0aW9uKHQpe2lmKFwiI1wiIT09dC5zdWJzdHJpbmcoMCwxKXx8OSE9PXQubGVuZ3RoKXJldHVybiBuZXcgZSgwLDAsMCwwKTt2YXIgaT1wYXJzZUludCh0LnN1YnN0cmluZygxLDMpLDE2KSxyPXBhcnNlSW50KHQuc3Vic3RyaW5nKDMsNSksMTYpLG49cGFyc2VJbnQodC5zdWJzdHJpbmcoNSw3KSwxNiksbz1wYXJzZUludCh0LnN1YnN0cmluZyg3LDkpLDE2KTtyZXR1cm4gZS5Gcm9tSW50cyhpLHIsbixvKX0sZS5MZXJwPWZ1bmN0aW9uKHQsaSxyKXt2YXIgbj1uZXcgZSgwLDAsMCwwKTtyZXR1cm4gZS5MZXJwVG9SZWYodCxpLHIsbiksbn0sZS5MZXJwVG9SZWY9ZnVuY3Rpb24oZSx0LGkscil7ci5yPWUucisodC5yLWUucikqaSxyLmc9ZS5nKyh0LmctZS5nKSppLHIuYj1lLmIrKHQuYi1lLmIpKmksci5hPWUuYSsodC5hLWUuYSkqaX0sZS5Gcm9tQXJyYXk9ZnVuY3Rpb24odCxpKXtyZXR1cm4gdm9pZCAwPT09aSYmKGk9MCksbmV3IGUodFtpXSx0W2krMV0sdFtpKzJdLHRbaSszXSl9LGUuRnJvbUludHM9ZnVuY3Rpb24odCxpLHIsbil7cmV0dXJuIG5ldyBlKHQvMjU1LGkvMjU1LHIvMjU1LG4vMjU1KX0sZS5DaGVja0NvbG9yczQ9ZnVuY3Rpb24oZSx0KXtpZihlLmxlbmd0aD09PTMqdCl7Zm9yKHZhciBpPVtdLHI9MDtyPGUubGVuZ3RoO3IrPTMpe3ZhciBuPXIvMyo0O2lbbl09ZVtyXSxpW24rMV09ZVtyKzFdLGlbbisyXT1lW3IrMl0saVtuKzNdPTF9cmV0dXJuIGl9cmV0dXJuIGV9LGV9KCk7ZS5Db2xvcjQ9cjt2YXIgbj1mdW5jdGlvbigpe2Z1bmN0aW9uIGkoZSx0KXt0aGlzLng9ZSx0aGlzLnk9dH1yZXR1cm4gaS5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm5cIntYOiBcIit0aGlzLngrXCIgWTpcIit0aGlzLnkrXCJ9XCJ9LGkucHJvdG90eXBlLmdldENsYXNzTmFtZT1mdW5jdGlvbigpe3JldHVyblwiVmVjdG9yMlwifSxpLnByb3RvdHlwZS5nZXRIYXNoQ29kZT1mdW5jdGlvbigpe3ZhciBlPXRoaXMueHx8MDtyZXR1cm4gZT0zOTcqZV4odGhpcy55fHwwKX0saS5wcm90b3R5cGUudG9BcnJheT1mdW5jdGlvbihlLHQpe3JldHVybiB2b2lkIDA9PT10JiYodD0wKSxlW3RdPXRoaXMueCxlW3QrMV09dGhpcy55LHRoaXN9LGkucHJvdG90eXBlLmFzQXJyYXk9ZnVuY3Rpb24oKXt2YXIgZT1bXTtyZXR1cm4gdGhpcy50b0FycmF5KGUsMCksZX0saS5wcm90b3R5cGUuY29weUZyb209ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMueD1lLngsdGhpcy55PWUueSx0aGlzfSxpLnByb3RvdHlwZS5jb3B5RnJvbUZsb2F0cz1mdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLng9ZSx0aGlzLnk9dCx0aGlzfSxpLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oZSl7cmV0dXJuIG5ldyBpKHRoaXMueCtlLngsdGhpcy55K2UueSl9LGkucHJvdG90eXBlLmFkZFRvUmVmPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQueD10aGlzLngrZS54LHQueT10aGlzLnkrZS55LHRoaXN9LGkucHJvdG90eXBlLmFkZFZlY3RvcjM9ZnVuY3Rpb24oZSl7cmV0dXJuIG5ldyBpKHRoaXMueCtlLngsdGhpcy55K2UueSl9LGkucHJvdG90eXBlLnN1YnRyYWN0PWZ1bmN0aW9uKGUpe3JldHVybiBuZXcgaSh0aGlzLngtZS54LHRoaXMueS1lLnkpfSxpLnByb3RvdHlwZS5zdWJ0cmFjdFRvUmVmPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQueD10aGlzLngtZS54LHQueT10aGlzLnktZS55LHRoaXN9LGkucHJvdG90eXBlLnN1YnRyYWN0SW5QbGFjZT1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy54LT1lLngsdGhpcy55LT1lLnksdGhpc30saS5wcm90b3R5cGUubXVsdGlwbHlJblBsYWNlPWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLngqPWUueCx0aGlzLnkqPWUueSx0aGlzfSxpLnByb3RvdHlwZS5tdWx0aXBseT1mdW5jdGlvbihlKXtyZXR1cm4gbmV3IGkodGhpcy54KmUueCx0aGlzLnkqZS55KX0saS5wcm90b3R5cGUubXVsdGlwbHlUb1JlZj1mdW5jdGlvbihlLHQpe3JldHVybiB0Lng9dGhpcy54KmUueCx0Lnk9dGhpcy55KmUueSx0aGlzfSxpLnByb3RvdHlwZS5tdWx0aXBseUJ5RmxvYXRzPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIG5ldyBpKHRoaXMueCplLHRoaXMueSp0KX0saS5wcm90b3R5cGUuZGl2aWRlPWZ1bmN0aW9uKGUpe3JldHVybiBuZXcgaSh0aGlzLngvZS54LHRoaXMueS9lLnkpfSxpLnByb3RvdHlwZS5kaXZpZGVUb1JlZj1mdW5jdGlvbihlLHQpe3JldHVybiB0Lng9dGhpcy54L2UueCx0Lnk9dGhpcy55L2UueSx0aGlzfSxpLnByb3RvdHlwZS5uZWdhdGU9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGkoLXRoaXMueCwtdGhpcy55KX0saS5wcm90b3R5cGUuc2NhbGVJblBsYWNlPWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLngqPWUsdGhpcy55Kj1lLHRoaXN9LGkucHJvdG90eXBlLnNjYWxlPWZ1bmN0aW9uKGUpe3JldHVybiBuZXcgaSh0aGlzLngqZSx0aGlzLnkqZSl9LGkucHJvdG90eXBlLmVxdWFscz1mdW5jdGlvbihlKXtyZXR1cm4gZSYmdGhpcy54PT09ZS54JiZ0aGlzLnk9PT1lLnl9LGkucHJvdG90eXBlLmVxdWFsc1dpdGhFcHNpbG9uPWZ1bmN0aW9uKGkscil7cmV0dXJuIHZvaWQgMD09PXImJihyPWUuRXBzaWxvbiksaSYmdC5XaXRoaW5FcHNpbG9uKHRoaXMueCxpLngscikmJnQuV2l0aGluRXBzaWxvbih0aGlzLnksaS55LHIpfSxpLnByb3RvdHlwZS5sZW5ndGg9ZnVuY3Rpb24oKXtyZXR1cm4gTWF0aC5zcXJ0KHRoaXMueCp0aGlzLngrdGhpcy55KnRoaXMueSl9LGkucHJvdG90eXBlLmxlbmd0aFNxdWFyZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy54KnRoaXMueCt0aGlzLnkqdGhpcy55fSxpLnByb3RvdHlwZS5ub3JtYWxpemU9ZnVuY3Rpb24oKXt2YXIgZT10aGlzLmxlbmd0aCgpO2lmKDA9PT1lKXJldHVybiB0aGlzO3ZhciB0PTEvZTtyZXR1cm4gdGhpcy54Kj10LHRoaXMueSo9dCx0aGlzfSxpLnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbigpe3JldHVybiBuZXcgaSh0aGlzLngsdGhpcy55KX0saS5aZXJvPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBpKDAsMCl9LGkuRnJvbUFycmF5PWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHZvaWQgMD09PXQmJih0PTApLG5ldyBpKGVbdF0sZVt0KzFdKX0saS5Gcm9tQXJyYXlUb1JlZj1mdW5jdGlvbihlLHQsaSl7aS54PWVbdF0saS55PWVbdCsxXX0saS5DYXRtdWxsUm9tPWZ1bmN0aW9uKGUsdCxyLG4sbyl7dmFyIHM9bypvLGE9bypzLGg9LjUqKDIqdC54KygtZS54K3IueCkqbysoMiplLngtNSp0LngrNCpyLngtbi54KSpzKygtZS54KzMqdC54LTMqci54K24ueCkqYSksYz0uNSooMip0LnkrKC1lLnkrci55KSpvKygyKmUueS01KnQueSs0KnIueS1uLnkpKnMrKC1lLnkrMyp0LnktMypyLnkrbi55KSphKTtyZXR1cm4gbmV3IGkoaCxjKX0saS5DbGFtcD1mdW5jdGlvbihlLHQscil7dmFyIG49ZS54O249bj5yLng/ci54Om4sbj1uPHQueD90Lng6bjt2YXIgbz1lLnk7cmV0dXJuIG89bz5yLnk/ci55Om8sbz1vPHQueT90Lnk6byxuZXcgaShuLG8pfSxpLkhlcm1pdGU9ZnVuY3Rpb24oZSx0LHIsbixvKXt2YXIgcz1vKm8sYT1vKnMsaD0yKmEtMypzKzEsYz0tMiphKzMqcyxsPWEtMipzK28sdT1hLXMsZj1lLngqaCtyLngqYyt0LngqbCtuLngqdSxkPWUueSpoK3IueSpjK3QueSpsK24ueSp1O3JldHVybiBuZXcgaShmLGQpfSxpLkxlcnA9ZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUueCsodC54LWUueCkqcixvPWUueSsodC55LWUueSkqcjtyZXR1cm4gbmV3IGkobixvKX0saS5Eb3Q9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gZS54KnQueCtlLnkqdC55fSxpLk5vcm1hbGl6ZT1mdW5jdGlvbihlKXt2YXIgdD1lLmNsb25lKCk7cmV0dXJuIHQubm9ybWFsaXplKCksdH0saS5NaW5pbWl6ZT1mdW5jdGlvbihlLHQpe3ZhciByPWUueDx0Lng/ZS54OnQueCxuPWUueTx0Lnk/ZS55OnQueTtyZXR1cm4gbmV3IGkocixuKX0saS5NYXhpbWl6ZT1mdW5jdGlvbihlLHQpe3ZhciByPWUueD50Lng/ZS54OnQueCxuPWUueT50Lnk/ZS55OnQueTtyZXR1cm4gbmV3IGkocixuKX0saS5UcmFuc2Zvcm09ZnVuY3Rpb24oZSx0KXt2YXIgcj1pLlplcm8oKTtyZXR1cm4gaS5UcmFuc2Zvcm1Ub1JlZihlLHQscikscn0saS5UcmFuc2Zvcm1Ub1JlZj1mdW5jdGlvbihlLHQsaSl7dmFyIHI9ZS54KnQubVswXStlLnkqdC5tWzRdK3QubVsxMl0sbj1lLngqdC5tWzFdK2UueSp0Lm1bNV0rdC5tWzEzXTtpLng9cixpLnk9bn0saS5Qb2ludEluVHJpYW5nbGU9ZnVuY3Rpb24oZSx0LGkscil7dmFyIG49LjUqKC1pLnkqci54K3QueSooLWkueCtyLngpK3QueCooaS55LXIueSkraS54KnIueSksbz0wPm4/LTE6MSxzPSh0Lnkqci54LXQueCpyLnkrKHIueS10LnkpKmUueCsodC54LXIueCkqZS55KSpvLGE9KHQueCppLnktdC55KmkueCsodC55LWkueSkqZS54KyhpLngtdC54KSplLnkpKm87cmV0dXJuIHM+MCYmYT4wJiYyKm4qbz5zK2F9LGkuRGlzdGFuY2U9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gTWF0aC5zcXJ0KGkuRGlzdGFuY2VTcXVhcmVkKGUsdCkpfSxpLkRpc3RhbmNlU3F1YXJlZD1mdW5jdGlvbihlLHQpe3ZhciBpPWUueC10Lngscj1lLnktdC55O3JldHVybiBpKmkrcipyfSxpLkRpc3RhbmNlT2ZQb2ludEZyb21TZWdtZW50PWZ1bmN0aW9uKGUsdCxyKXt2YXIgbj1pLkRpc3RhbmNlU3F1YXJlZCh0LHIpO2lmKDA9PT1uKXJldHVybiBpLkRpc3RhbmNlKGUsdCk7dmFyIG89ci5zdWJ0cmFjdCh0KSxzPU1hdGgubWF4KDAsTWF0aC5taW4oMSxpLkRvdChlLnN1YnRyYWN0KHQpLG8pL24pKSxhPXQuYWRkKG8ubXVsdGlwbHlCeUZsb2F0cyhzLHMpKTtyZXR1cm4gaS5EaXN0YW5jZShlLGEpfSxpfSgpO2UuVmVjdG9yMj1uO3ZhciBvPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gaShlLHQsaSl7dGhpcy54PWUsdGhpcy55PXQsdGhpcy56PWl9cmV0dXJuIGkucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuXCJ7WDogXCIrdGhpcy54K1wiIFk6XCIrdGhpcy55K1wiIFo6XCIrdGhpcy56K1wifVwifSxpLnByb3RvdHlwZS5nZXRDbGFzc05hbWU9ZnVuY3Rpb24oKXtyZXR1cm5cIlZlY3RvcjNcIn0saS5wcm90b3R5cGUuZ2V0SGFzaENvZGU9ZnVuY3Rpb24oKXt2YXIgZT10aGlzLnh8fDA7cmV0dXJuIGU9Mzk3KmVeKHRoaXMueXx8MCksZT0zOTcqZV4odGhpcy56fHwwKX0saS5wcm90b3R5cGUuYXNBcnJheT1mdW5jdGlvbigpe3ZhciBlPVtdO3JldHVybiB0aGlzLnRvQXJyYXkoZSwwKSxlfSxpLnByb3RvdHlwZS50b0FycmF5PWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHZvaWQgMD09PXQmJih0PTApLGVbdF09dGhpcy54LGVbdCsxXT10aGlzLnksZVt0KzJdPXRoaXMueix0aGlzfSxpLnByb3RvdHlwZS50b1F1YXRlcm5pb249ZnVuY3Rpb24oKXt2YXIgZT1uZXcgaCgwLDAsMCwxKSx0PU1hdGguY29zKC41Kih0aGlzLngrdGhpcy56KSksaT1NYXRoLnNpbiguNSoodGhpcy54K3RoaXMueikpLHI9TWF0aC5jb3MoLjUqKHRoaXMuei10aGlzLngpKSxuPU1hdGguc2luKC41Kih0aGlzLnotdGhpcy54KSksbz1NYXRoLmNvcyguNSp0aGlzLnkpLHM9TWF0aC5zaW4oLjUqdGhpcy55KTtyZXR1cm4gZS54PXIqcyxlLnk9LW4qcyxlLno9aSpvLGUudz10Km8sZX0saS5wcm90b3R5cGUuYWRkSW5QbGFjZT1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy54Kz1lLngsdGhpcy55Kz1lLnksdGhpcy56Kz1lLnosdGhpc30saS5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGUpe3JldHVybiBuZXcgaSh0aGlzLngrZS54LHRoaXMueStlLnksdGhpcy56K2Uueil9LGkucHJvdG90eXBlLmFkZFRvUmVmPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQueD10aGlzLngrZS54LHQueT10aGlzLnkrZS55LHQuej10aGlzLnorZS56LHRoaXN9LGkucHJvdG90eXBlLnN1YnRyYWN0SW5QbGFjZT1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy54LT1lLngsdGhpcy55LT1lLnksdGhpcy56LT1lLnosdGhpc30saS5wcm90b3R5cGUuc3VidHJhY3Q9ZnVuY3Rpb24oZSl7cmV0dXJuIG5ldyBpKHRoaXMueC1lLngsdGhpcy55LWUueSx0aGlzLnotZS56KX0saS5wcm90b3R5cGUuc3VidHJhY3RUb1JlZj1mdW5jdGlvbihlLHQpe3JldHVybiB0Lng9dGhpcy54LWUueCx0Lnk9dGhpcy55LWUueSx0Lno9dGhpcy56LWUueix0aGlzfSxpLnByb3RvdHlwZS5zdWJ0cmFjdEZyb21GbG9hdHM9ZnVuY3Rpb24oZSx0LHIpe3JldHVybiBuZXcgaSh0aGlzLngtZSx0aGlzLnktdCx0aGlzLnotcil9LGkucHJvdG90eXBlLnN1YnRyYWN0RnJvbUZsb2F0c1RvUmVmPWZ1bmN0aW9uKGUsdCxpLHIpe3JldHVybiByLng9dGhpcy54LWUsci55PXRoaXMueS10LHIuej10aGlzLnotaSx0aGlzfSxpLnByb3RvdHlwZS5uZWdhdGU9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGkoLXRoaXMueCwtdGhpcy55LC10aGlzLnopfSxpLnByb3RvdHlwZS5zY2FsZUluUGxhY2U9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMueCo9ZSx0aGlzLnkqPWUsdGhpcy56Kj1lLHRoaXN9LGkucHJvdG90eXBlLnNjYWxlPWZ1bmN0aW9uKGUpe3JldHVybiBuZXcgaSh0aGlzLngqZSx0aGlzLnkqZSx0aGlzLnoqZSl9LGkucHJvdG90eXBlLnNjYWxlVG9SZWY9ZnVuY3Rpb24oZSx0KXt0Lng9dGhpcy54KmUsdC55PXRoaXMueSplLHQuej10aGlzLnoqZX0saS5wcm90b3R5cGUuZXF1YWxzPWZ1bmN0aW9uKGUpe3JldHVybiBlJiZ0aGlzLng9PT1lLngmJnRoaXMueT09PWUueSYmdGhpcy56PT09ZS56fSxpLnByb3RvdHlwZS5lcXVhbHNXaXRoRXBzaWxvbj1mdW5jdGlvbihpLHIpe3JldHVybiB2b2lkIDA9PT1yJiYocj1lLkVwc2lsb24pLGkmJnQuV2l0aGluRXBzaWxvbih0aGlzLngsaS54LHIpJiZ0LldpdGhpbkVwc2lsb24odGhpcy55LGkueSxyKSYmdC5XaXRoaW5FcHNpbG9uKHRoaXMueixpLnoscil9LGkucHJvdG90eXBlLmVxdWFsc1RvRmxvYXRzPWZ1bmN0aW9uKGUsdCxpKXtyZXR1cm4gdGhpcy54PT09ZSYmdGhpcy55PT09dCYmdGhpcy56PT09aX0saS5wcm90b3R5cGUubXVsdGlwbHlJblBsYWNlPWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLngqPWUueCx0aGlzLnkqPWUueSx0aGlzLnoqPWUueix0aGlzfSxpLnByb3RvdHlwZS5tdWx0aXBseT1mdW5jdGlvbihlKXtyZXR1cm4gbmV3IGkodGhpcy54KmUueCx0aGlzLnkqZS55LHRoaXMueiplLnopfSxpLnByb3RvdHlwZS5tdWx0aXBseVRvUmVmPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQueD10aGlzLngqZS54LHQueT10aGlzLnkqZS55LHQuej10aGlzLnoqZS56LHRoaXN9LGkucHJvdG90eXBlLm11bHRpcGx5QnlGbG9hdHM9ZnVuY3Rpb24oZSx0LHIpe3JldHVybiBuZXcgaSh0aGlzLngqZSx0aGlzLnkqdCx0aGlzLnoqcil9LGkucHJvdG90eXBlLmRpdmlkZT1mdW5jdGlvbihlKXtyZXR1cm4gbmV3IGkodGhpcy54L2UueCx0aGlzLnkvZS55LHRoaXMuei9lLnopfSxpLnByb3RvdHlwZS5kaXZpZGVUb1JlZj1mdW5jdGlvbihlLHQpe3JldHVybiB0Lng9dGhpcy54L2UueCx0Lnk9dGhpcy55L2UueSx0Lno9dGhpcy56L2Uueix0aGlzfSxpLnByb3RvdHlwZS5NaW5pbWl6ZUluUGxhY2U9ZnVuY3Rpb24oZSl7cmV0dXJuIGUueDx0aGlzLngmJih0aGlzLng9ZS54KSxlLnk8dGhpcy55JiYodGhpcy55PWUueSksZS56PHRoaXMueiYmKHRoaXMuej1lLnopLHRoaXN9LGkucHJvdG90eXBlLk1heGltaXplSW5QbGFjZT1mdW5jdGlvbihlKXtyZXR1cm4gZS54PnRoaXMueCYmKHRoaXMueD1lLngpLGUueT50aGlzLnkmJih0aGlzLnk9ZS55KSxlLno+dGhpcy56JiYodGhpcy56PWUueiksdGhpc30saS5wcm90b3R5cGUubGVuZ3RoPWZ1bmN0aW9uKCl7cmV0dXJuIE1hdGguc3FydCh0aGlzLngqdGhpcy54K3RoaXMueSp0aGlzLnkrdGhpcy56KnRoaXMueil9LGkucHJvdG90eXBlLmxlbmd0aFNxdWFyZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy54KnRoaXMueCt0aGlzLnkqdGhpcy55K3RoaXMueip0aGlzLnp9LGkucHJvdG90eXBlLm5vcm1hbGl6ZT1mdW5jdGlvbigpe3ZhciBlPXRoaXMubGVuZ3RoKCk7aWYoMD09PWV8fDE9PT1lKXJldHVybiB0aGlzO3ZhciB0PTEvZTtyZXR1cm4gdGhpcy54Kj10LHRoaXMueSo9dCx0aGlzLnoqPXQsdGhpc30saS5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGkodGhpcy54LHRoaXMueSx0aGlzLnopfSxpLnByb3RvdHlwZS5jb3B5RnJvbT1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy54PWUueCx0aGlzLnk9ZS55LHRoaXMuej1lLnosdGhpc30saS5wcm90b3R5cGUuY29weUZyb21GbG9hdHM9ZnVuY3Rpb24oZSx0LGkpe3JldHVybiB0aGlzLng9ZSx0aGlzLnk9dCx0aGlzLno9aSx0aGlzfSxpLkdldENsaXBGYWN0b3I9ZnVuY3Rpb24oZSx0LHIsbil7dmFyIG89aS5Eb3QoZSxyKS1uLHM9aS5Eb3QodCxyKS1uLGE9by8oby1zKTtyZXR1cm4gYX0saS5Gcm9tQXJyYXk9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdHx8KHQ9MCksbmV3IGkoZVt0XSxlW3QrMV0sZVt0KzJdKX0saS5Gcm9tRmxvYXRBcnJheT1mdW5jdGlvbihlLHQpe3JldHVybiB0fHwodD0wKSxuZXcgaShlW3RdLGVbdCsxXSxlW3QrMl0pfSxpLkZyb21BcnJheVRvUmVmPWZ1bmN0aW9uKGUsdCxpKXtpLng9ZVt0XSxpLnk9ZVt0KzFdLGkuej1lW3QrMl19LGkuRnJvbUZsb2F0QXJyYXlUb1JlZj1mdW5jdGlvbihlLHQsaSl7aS54PWVbdF0saS55PWVbdCsxXSxpLno9ZVt0KzJdfSxpLkZyb21GbG9hdHNUb1JlZj1mdW5jdGlvbihlLHQsaSxyKXtyLng9ZSxyLnk9dCxyLno9aX0saS5aZXJvPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBpKDAsMCwwKX0saS5VcD1mdW5jdGlvbigpe3JldHVybiBuZXcgaSgwLDEsMCl9LGkuVHJhbnNmb3JtQ29vcmRpbmF0ZXM9ZnVuY3Rpb24oZSx0KXt2YXIgcj1pLlplcm8oKTtyZXR1cm4gaS5UcmFuc2Zvcm1Db29yZGluYXRlc1RvUmVmKGUsdCxyKSxyfSxpLlRyYW5zZm9ybUNvb3JkaW5hdGVzVG9SZWY9ZnVuY3Rpb24oZSx0LGkpe3ZhciByPWUueCp0Lm1bMF0rZS55KnQubVs0XStlLnoqdC5tWzhdK3QubVsxMl0sbj1lLngqdC5tWzFdK2UueSp0Lm1bNV0rZS56KnQubVs5XSt0Lm1bMTNdLG89ZS54KnQubVsyXStlLnkqdC5tWzZdK2Uueip0Lm1bMTBdK3QubVsxNF0scz1lLngqdC5tWzNdK2UueSp0Lm1bN10rZS56KnQubVsxMV0rdC5tWzE1XTtpLng9ci9zLGkueT1uL3MsaS56PW8vc30saS5UcmFuc2Zvcm1Db29yZGluYXRlc0Zyb21GbG9hdHNUb1JlZj1mdW5jdGlvbihlLHQsaSxyLG4pe3ZhciBvPWUqci5tWzBdK3Qqci5tWzRdK2kqci5tWzhdK3IubVsxMl0scz1lKnIubVsxXSt0KnIubVs1XStpKnIubVs5XStyLm1bMTNdLGE9ZSpyLm1bMl0rdCpyLm1bNl0raSpyLm1bMTBdK3IubVsxNF0saD1lKnIubVszXSt0KnIubVs3XStpKnIubVsxMV0rci5tWzE1XTtuLng9by9oLG4ueT1zL2gsbi56PWEvaH0saS5UcmFuc2Zvcm1Ob3JtYWw9ZnVuY3Rpb24oZSx0KXt2YXIgcj1pLlplcm8oKTtyZXR1cm4gaS5UcmFuc2Zvcm1Ob3JtYWxUb1JlZihlLHQscikscn0saS5UcmFuc2Zvcm1Ob3JtYWxUb1JlZj1mdW5jdGlvbihlLHQsaSl7aS54PWUueCp0Lm1bMF0rZS55KnQubVs0XStlLnoqdC5tWzhdLGkueT1lLngqdC5tWzFdK2UueSp0Lm1bNV0rZS56KnQubVs5XSxpLno9ZS54KnQubVsyXStlLnkqdC5tWzZdK2Uueip0Lm1bMTBdfSxpLlRyYW5zZm9ybU5vcm1hbEZyb21GbG9hdHNUb1JlZj1mdW5jdGlvbihlLHQsaSxyLG4pe24ueD1lKnIubVswXSt0KnIubVs0XStpKnIubVs4XSxuLnk9ZSpyLm1bMV0rdCpyLm1bNV0raSpyLm1bOV0sbi56PWUqci5tWzJdK3Qqci5tWzZdK2kqci5tWzEwXX0saS5DYXRtdWxsUm9tPWZ1bmN0aW9uKGUsdCxyLG4sbyl7dmFyIHM9bypvLGE9bypzLGg9LjUqKDIqdC54KygtZS54K3IueCkqbysoMiplLngtNSp0LngrNCpyLngtbi54KSpzKygtZS54KzMqdC54LTMqci54K24ueCkqYSksYz0uNSooMip0LnkrKC1lLnkrci55KSpvKygyKmUueS01KnQueSs0KnIueS1uLnkpKnMrKC1lLnkrMyp0LnktMypyLnkrbi55KSphKSxsPS41KigyKnQueisoLWUueityLnopKm8rKDIqZS56LTUqdC56KzQqci56LW4ueikqcysoLWUueiszKnQuei0zKnIueituLnopKmEpO3JldHVybiBuZXcgaShoLGMsbCl9LGkuQ2xhbXA9ZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUueDtuPW4+ci54P3IueDpuLG49bjx0Lng/dC54Om47dmFyIG89ZS55O289bz5yLnk/ci55Om8sbz1vPHQueT90Lnk6bzt2YXIgcz1lLno7cmV0dXJuIHM9cz5yLno/ci56OnMscz1zPHQuej90Lno6cyxuZXcgaShuLG8scyl9LGkuSGVybWl0ZT1mdW5jdGlvbihlLHQscixuLG8pe3ZhciBzPW8qbyxhPW8qcyxoPTIqYS0zKnMrMSxjPS0yKmErMypzLGw9YS0yKnMrbyx1PWEtcyxmPWUueCpoK3IueCpjK3QueCpsK24ueCp1LGQ9ZS55Kmgrci55KmMrdC55Kmwrbi55KnUscD1lLnoqaCtyLnoqYyt0LnoqbCtuLnoqdTtyZXR1cm4gbmV3IGkoZixkLHApfSxpLkxlcnA9ZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUueCsodC54LWUueCkqcixvPWUueSsodC55LWUueSkqcixzPWUueisodC56LWUueikqcjtyZXR1cm4gbmV3IGkobixvLHMpfSxpLkRvdD1mdW5jdGlvbihlLHQpe3JldHVybiBlLngqdC54K2UueSp0LnkrZS56KnQuen0saS5Dcm9zcz1mdW5jdGlvbihlLHQpe3ZhciByPWkuWmVybygpO3JldHVybiBpLkNyb3NzVG9SZWYoZSx0LHIpLHJ9LGkuQ3Jvc3NUb1JlZj1mdW5jdGlvbihlLHQsaSl7RS5WZWN0b3IzWzBdLng9ZS55KnQuei1lLnoqdC55LEUuVmVjdG9yM1swXS55PWUueip0LngtZS54KnQueixFLlZlY3RvcjNbMF0uej1lLngqdC55LWUueSp0LngsaS5jb3B5RnJvbShFLlZlY3RvcjNbMF0pfSxpLk5vcm1hbGl6ZT1mdW5jdGlvbihlKXt2YXIgdD1pLlplcm8oKTtyZXR1cm4gaS5Ob3JtYWxpemVUb1JlZihlLHQpLHR9LGkuTm9ybWFsaXplVG9SZWY9ZnVuY3Rpb24oZSx0KXt0LmNvcHlGcm9tKGUpLHQubm9ybWFsaXplKCl9LGkuUHJvamVjdD1mdW5jdGlvbihlLHQscixuKXt2YXIgbz1uLndpZHRoLHM9bi5oZWlnaHQsYT1uLngsaD1uLnksbD1jLkZyb21WYWx1ZXMoby8yLDAsMCwwLDAsLXMvMiwwLDAsMCwwLDEsMCxhK28vMixzLzIraCwwLDEpLHU9dC5tdWx0aXBseShyKS5tdWx0aXBseShsKTtyZXR1cm4gaS5UcmFuc2Zvcm1Db29yZGluYXRlcyhlLHUpfSxpLlVucHJvamVjdEZyb21UcmFuc2Zvcm09ZnVuY3Rpb24oZSxyLG4sbyxzKXt2YXIgYT1vLm11bHRpcGx5KHMpO2EuaW52ZXJ0KCksZS54PWUueC9yKjItMSxlLnk9LShlLnkvbioyLTEpO3ZhciBoPWkuVHJhbnNmb3JtQ29vcmRpbmF0ZXMoZSxhKSxjPWUueCphLm1bM10rZS55KmEubVs3XStlLnoqYS5tWzExXSthLm1bMTVdO3JldHVybiB0LldpdGhpbkVwc2lsb24oYywxKSYmKGg9aC5zY2FsZSgxL2MpKSxofSxpLlVucHJvamVjdD1mdW5jdGlvbihlLHIsbixvLHMsYSl7dmFyIGg9by5tdWx0aXBseShzKS5tdWx0aXBseShhKTtoLmludmVydCgpO3ZhciBjPW5ldyBpKGUueC9yKjItMSwtKGUueS9uKjItMSksZS56KSxsPWkuVHJhbnNmb3JtQ29vcmRpbmF0ZXMoYyxoKSx1PWMueCpoLm1bM10rYy55KmgubVs3XStjLnoqaC5tWzExXStoLm1bMTVdO3JldHVybiB0LldpdGhpbkVwc2lsb24odSwxKSYmKGw9bC5zY2FsZSgxL3UpKSxsfSxpLk1pbmltaXplPWZ1bmN0aW9uKGUsdCl7dmFyIGk9ZS5jbG9uZSgpO3JldHVybiBpLk1pbmltaXplSW5QbGFjZSh0KSxpfSxpLk1heGltaXplPWZ1bmN0aW9uKGUsdCl7dmFyIGk9ZS5jbG9uZSgpO3JldHVybiBpLk1heGltaXplSW5QbGFjZSh0KSxpfSxpLkRpc3RhbmNlPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIE1hdGguc3FydChpLkRpc3RhbmNlU3F1YXJlZChlLHQpKX0saS5EaXN0YW5jZVNxdWFyZWQ9ZnVuY3Rpb24oZSx0KXt2YXIgaT1lLngtdC54LHI9ZS55LXQueSxuPWUuei10Lno7cmV0dXJuIGkqaStyKnIrbipufSxpLkNlbnRlcj1mdW5jdGlvbihlLHQpe3ZhciBpPWUuYWRkKHQpO3JldHVybiBpLnNjYWxlSW5QbGFjZSguNSksaX0saS5Sb3RhdGlvbkZyb21BeGlzPWZ1bmN0aW9uKGUsdCxyKXt2YXIgbj1pLlplcm8oKTtyZXR1cm4gaS5Sb3RhdGlvbkZyb21BeGlzVG9SZWYoZSx0LHIsbiksbn0saS5Sb3RhdGlvbkZyb21BeGlzVG9SZWY9ZnVuY3Rpb24ocixuLG8scyl7dmFyIGE9ci5ub3JtYWxpemUoKSxoPW8ubm9ybWFsaXplKCksYz1kLlgsbD1kLlksdT0wLGY9MCxwPTAsXz0wLG09MCxnPTAsdj0wLHk9LTEseD0wLGI9RS5WZWN0b3IzWzBdLFA9MCxBPUUuVmVjdG9yM1sxXTt0LldpdGhpbkVwc2lsb24oaC56LDAsZS5FcHNpbG9uKT9nPTE6dC5XaXRoaW5FcHNpbG9uKGgueCwwLGUuRXBzaWxvbik/Xz0xOih2PWguei9oLngsXz0tdipNYXRoLnNxcnQoMS8oMSt2KnYpKSxnPU1hdGguc3FydCgxLygxK3YqdikpKSxBLng9XyxBLnk9bSxBLno9ZyxBLm5vcm1hbGl6ZSgpLGkuQ3Jvc3NUb1JlZihhLEEsYiksYi5ub3JtYWxpemUoKSxpLkRvdChoLGIpPDAmJih5PTEpLFA9aS5Eb3QoYSxBKSxQPU1hdGgubWluKDEsTWF0aC5tYXgoLTEsUCkpLHA9TWF0aC5hY29zKFApKnksaS5Eb3QoQSxjKTwwJiYocD1NYXRoLlBJK3AsQT1BLnNjYWxlSW5QbGFjZSgtMSkseCsrKTt2YXIgVD1FLlZlY3RvcjNbMl0sQz1FLlZlY3RvcjNbM107Xz0wLG09MCxnPTAseT0tMSx0LldpdGhpbkVwc2lsb24oaC56LDAsZS5FcHNpbG9uKT9fPTE6KHY9QS56L0EueCxfPS12Kk1hdGguc3FydCgxLygxK3YqdikpLGc9TWF0aC5zcXJ0KDEvKDErdip2KSkpLFQueD1fLFQueT1tLFQuej1nLFQubm9ybWFsaXplKCksaS5Dcm9zc1RvUmVmKFQsQSxDKSxDLm5vcm1hbGl6ZSgpLGkuQ3Jvc3NUb1JlZihoLFQsYiksYi5ub3JtYWxpemUoKSxpLkRvdChBLGIpPDAmJih5PTEpLFA9aS5Eb3QoaCxUKSxQPU1hdGgubWluKDEsTWF0aC5tYXgoLTEsUCkpLGY9TWF0aC5hY29zKFApKnksaS5Eb3QoQyxsKTwwJiYoZj1NYXRoLlBJK2YseCsrKSx5PS0xLGkuQ3Jvc3NUb1JlZihjLEEsYiksYi5ub3JtYWxpemUoKSxpLkRvdChiLGwpPDAmJih5PTEpLFA9aS5Eb3QoQSxjKSxQPU1hdGgubWluKDEsTWF0aC5tYXgoLTEsUCkpLHU9LU1hdGguYWNvcyhQKSp5LDA+UCYmMj54JiYodT1NYXRoLlBJK3UpLHMueD1mLHMueT11LHMuej1wfSxpfSgpO2UuVmVjdG9yMz1vO3ZhciBzPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gaShlLHQsaSxyKXt0aGlzLng9ZSx0aGlzLnk9dCx0aGlzLno9aSx0aGlzLnc9cn1yZXR1cm4gaS5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm5cIntYOiBcIit0aGlzLngrXCIgWTpcIit0aGlzLnkrXCIgWjpcIit0aGlzLnorXCJXOlwiK3RoaXMudytcIn1cIn0saS5wcm90b3R5cGUuZ2V0Q2xhc3NOYW1lPWZ1bmN0aW9uKCl7cmV0dXJuXCJWZWN0b3I0XCJ9LGkucHJvdG90eXBlLmdldEhhc2hDb2RlPWZ1bmN0aW9uKCl7dmFyIGU9dGhpcy54fHwwO3JldHVybiBlPTM5NyplXih0aGlzLnl8fDApLGU9Mzk3KmVeKHRoaXMuenx8MCksZT0zOTcqZV4odGhpcy53fHwwKX0saS5wcm90b3R5cGUuYXNBcnJheT1mdW5jdGlvbigpe3ZhciBlPVtdO3JldHVybiB0aGlzLnRvQXJyYXkoZSwwKSxlfSxpLnByb3RvdHlwZS50b0FycmF5PWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHZvaWQgMD09PXQmJih0PTApLGVbdF09dGhpcy54LGVbdCsxXT10aGlzLnksZVt0KzJdPXRoaXMueixlW3QrM109dGhpcy53LHRoaXN9LGkucHJvdG90eXBlLmFkZEluUGxhY2U9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMueCs9ZS54LHRoaXMueSs9ZS55LHRoaXMueis9ZS56LHRoaXMudys9ZS53LHRoaXN9LGkucHJvdG90eXBlLmFkZD1mdW5jdGlvbihlKXtyZXR1cm4gbmV3IGkodGhpcy54K2UueCx0aGlzLnkrZS55LHRoaXMueitlLnosdGhpcy53K2Uudyl9LGkucHJvdG90eXBlLmFkZFRvUmVmPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQueD10aGlzLngrZS54LHQueT10aGlzLnkrZS55LHQuej10aGlzLnorZS56LHQudz10aGlzLncrZS53LHRoaXN9LGkucHJvdG90eXBlLnN1YnRyYWN0SW5QbGFjZT1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy54LT1lLngsdGhpcy55LT1lLnksdGhpcy56LT1lLnosdGhpcy53LT1lLncsdGhpc30saS5wcm90b3R5cGUuc3VidHJhY3Q9ZnVuY3Rpb24oZSl7cmV0dXJuIG5ldyBpKHRoaXMueC1lLngsdGhpcy55LWUueSx0aGlzLnotZS56LHRoaXMudy1lLncpfSxpLnByb3RvdHlwZS5zdWJ0cmFjdFRvUmVmPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQueD10aGlzLngtZS54LHQueT10aGlzLnktZS55LHQuej10aGlzLnotZS56LHQudz10aGlzLnctZS53LHRoaXN9LGkucHJvdG90eXBlLnN1YnRyYWN0RnJvbUZsb2F0cz1mdW5jdGlvbihlLHQscixuKXtyZXR1cm4gbmV3IGkodGhpcy54LWUsdGhpcy55LXQsdGhpcy56LXIsdGhpcy53LW4pfSxpLnByb3RvdHlwZS5zdWJ0cmFjdEZyb21GbG9hdHNUb1JlZj1mdW5jdGlvbihlLHQsaSxyLG4pe3JldHVybiBuLng9dGhpcy54LWUsbi55PXRoaXMueS10LG4uej10aGlzLnotaSxuLnc9dGhpcy53LXIsdGhpc30saS5wcm90b3R5cGUubmVnYXRlPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBpKC10aGlzLngsLXRoaXMueSwtdGhpcy56LC10aGlzLncpfSxpLnByb3RvdHlwZS5zY2FsZUluUGxhY2U9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMueCo9ZSx0aGlzLnkqPWUsdGhpcy56Kj1lLHRoaXMudyo9ZSx0aGlzfSxpLnByb3RvdHlwZS5zY2FsZT1mdW5jdGlvbihlKXtyZXR1cm4gbmV3IGkodGhpcy54KmUsdGhpcy55KmUsdGhpcy56KmUsdGhpcy53KmUpfSxpLnByb3RvdHlwZS5zY2FsZVRvUmVmPWZ1bmN0aW9uKGUsdCl7dC54PXRoaXMueCplLHQueT10aGlzLnkqZSx0Lno9dGhpcy56KmUsdC53PXRoaXMudyplfSxpLnByb3RvdHlwZS5lcXVhbHM9ZnVuY3Rpb24oZSl7cmV0dXJuIGUmJnRoaXMueD09PWUueCYmdGhpcy55PT09ZS55JiZ0aGlzLno9PT1lLnomJnRoaXMudz09PWUud30saS5wcm90b3R5cGUuZXF1YWxzV2l0aEVwc2lsb249ZnVuY3Rpb24oaSxyKXtyZXR1cm4gdm9pZCAwPT09ciYmKHI9ZS5FcHNpbG9uKSxpJiZ0LldpdGhpbkVwc2lsb24odGhpcy54LGkueCxyKSYmdC5XaXRoaW5FcHNpbG9uKHRoaXMueSxpLnkscikmJnQuV2l0aGluRXBzaWxvbih0aGlzLnosaS56LHIpJiZ0LldpdGhpbkVwc2lsb24odGhpcy53LGkudyxyKX0saS5wcm90b3R5cGUuZXF1YWxzVG9GbG9hdHM9ZnVuY3Rpb24oZSx0LGkscil7cmV0dXJuIHRoaXMueD09PWUmJnRoaXMueT09PXQmJnRoaXMuej09PWkmJnRoaXMudz09PXJ9LGkucHJvdG90eXBlLm11bHRpcGx5SW5QbGFjZT1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy54Kj1lLngsdGhpcy55Kj1lLnksdGhpcy56Kj1lLnosdGhpcy53Kj1lLncsdGhpc30saS5wcm90b3R5cGUubXVsdGlwbHk9ZnVuY3Rpb24oZSl7cmV0dXJuIG5ldyBpKHRoaXMueCplLngsdGhpcy55KmUueSx0aGlzLnoqZS56LHRoaXMudyplLncpfSxpLnByb3RvdHlwZS5tdWx0aXBseVRvUmVmPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQueD10aGlzLngqZS54LHQueT10aGlzLnkqZS55LHQuej10aGlzLnoqZS56LHQudz10aGlzLncqZS53LHRoaXN9LGkucHJvdG90eXBlLm11bHRpcGx5QnlGbG9hdHM9ZnVuY3Rpb24oZSx0LHIsbil7cmV0dXJuIG5ldyBpKHRoaXMueCplLHRoaXMueSp0LHRoaXMueipyLHRoaXMudypuKX0saS5wcm90b3R5cGUuZGl2aWRlPWZ1bmN0aW9uKGUpe3JldHVybiBuZXcgaSh0aGlzLngvZS54LHRoaXMueS9lLnksdGhpcy56L2Uueix0aGlzLncvZS53KX0saS5wcm90b3R5cGUuZGl2aWRlVG9SZWY9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdC54PXRoaXMueC9lLngsdC55PXRoaXMueS9lLnksdC56PXRoaXMuei9lLnosdC53PXRoaXMudy9lLncsdGhpc30saS5wcm90b3R5cGUuTWluaW1pemVJblBsYWNlPWZ1bmN0aW9uKGUpe3JldHVybiBlLng8dGhpcy54JiYodGhpcy54PWUueCksZS55PHRoaXMueSYmKHRoaXMueT1lLnkpLGUuejx0aGlzLnomJih0aGlzLno9ZS56KSxlLnc8dGhpcy53JiYodGhpcy53PWUudyksdGhpc30saS5wcm90b3R5cGUuTWF4aW1pemVJblBsYWNlPWZ1bmN0aW9uKGUpe3JldHVybiBlLng+dGhpcy54JiYodGhpcy54PWUueCksZS55PnRoaXMueSYmKHRoaXMueT1lLnkpLGUuej50aGlzLnomJih0aGlzLno9ZS56KSxlLnc+dGhpcy53JiYodGhpcy53PWUudyksdGhpc30saS5wcm90b3R5cGUubGVuZ3RoPWZ1bmN0aW9uKCl7cmV0dXJuIE1hdGguc3FydCh0aGlzLngqdGhpcy54K3RoaXMueSp0aGlzLnkrdGhpcy56KnRoaXMueit0aGlzLncqdGhpcy53KX0saS5wcm90b3R5cGUubGVuZ3RoU3F1YXJlZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLngqdGhpcy54K3RoaXMueSp0aGlzLnkrdGhpcy56KnRoaXMueit0aGlzLncqdGhpcy53fSxpLnByb3RvdHlwZS5ub3JtYWxpemU9ZnVuY3Rpb24oKXt2YXIgZT10aGlzLmxlbmd0aCgpO2lmKDA9PT1lKXJldHVybiB0aGlzO3ZhciB0PTEvZTtyZXR1cm4gdGhpcy54Kj10LHRoaXMueSo9dCx0aGlzLnoqPXQsdGhpcy53Kj10LHRoaXN9LGkucHJvdG90eXBlLnRvVmVjdG9yMz1mdW5jdGlvbigpe3JldHVybiBuZXcgbyh0aGlzLngsdGhpcy55LHRoaXMueil9LGkucHJvdG90eXBlLmNsb25lPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBpKHRoaXMueCx0aGlzLnksdGhpcy56LHRoaXMudyl9LGkucHJvdG90eXBlLmNvcHlGcm9tPWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLng9ZS54LHRoaXMueT1lLnksdGhpcy56PWUueix0aGlzLnc9ZS53LHRoaXN9LGkucHJvdG90eXBlLmNvcHlGcm9tRmxvYXRzPWZ1bmN0aW9uKGUsdCxpLHIpe3JldHVybiB0aGlzLng9ZSx0aGlzLnk9dCx0aGlzLno9aSx0aGlzLnc9cix0aGlzfSxpLkZyb21BcnJheT1mdW5jdGlvbihlLHQpe3JldHVybiB0fHwodD0wKSxuZXcgaShlW3RdLGVbdCsxXSxlW3QrMl0sZVt0KzNdKX0saS5Gcm9tQXJyYXlUb1JlZj1mdW5jdGlvbihlLHQsaSl7aS54PWVbdF0saS55PWVbdCsxXSxpLno9ZVt0KzJdLGkudz1lW3QrM119LGkuRnJvbUZsb2F0QXJyYXlUb1JlZj1mdW5jdGlvbihlLHQsaSl7aS54PWVbdF0saS55PWVbdCsxXSxpLno9ZVt0KzJdLGkudz1lW3QrM119LGkuRnJvbUZsb2F0c1RvUmVmPWZ1bmN0aW9uKGUsdCxpLHIsbil7bi54PWUsbi55PXQsbi56PWksbi53PXJ9LGkuWmVybz1mdW5jdGlvbigpe3JldHVybiBuZXcgaSgwLDAsMCwwKX0saS5Ob3JtYWxpemU9ZnVuY3Rpb24oZSl7dmFyIHQ9aS5aZXJvKCk7cmV0dXJuIGkuTm9ybWFsaXplVG9SZWYoZSx0KSx0fSxpLk5vcm1hbGl6ZVRvUmVmPWZ1bmN0aW9uKGUsdCl7dC5jb3B5RnJvbShlKSx0Lm5vcm1hbGl6ZSgpfSxpLk1pbmltaXplPWZ1bmN0aW9uKGUsdCl7dmFyIGk9ZS5jbG9uZSgpO3JldHVybiBpLk1pbmltaXplSW5QbGFjZSh0KSxpfSxpLk1heGltaXplPWZ1bmN0aW9uKGUsdCl7dmFyIGk9ZS5jbG9uZSgpO3JldHVybiBpLk1heGltaXplSW5QbGFjZSh0KSxpfSxpLkRpc3RhbmNlPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIE1hdGguc3FydChpLkRpc3RhbmNlU3F1YXJlZChlLHQpKX0saS5EaXN0YW5jZVNxdWFyZWQ9ZnVuY3Rpb24oZSx0KXt2YXIgaT1lLngtdC54LHI9ZS55LXQueSxuPWUuei10Lnosbz1lLnctdC53O3JldHVybiBpKmkrcipyK24qbitvKm99LGkuQ2VudGVyPWZ1bmN0aW9uKGUsdCl7dmFyIGk9ZS5hZGQodCk7cmV0dXJuIGkuc2NhbGVJblBsYWNlKC41KSxpfSxpfSgpO2UuVmVjdG9yND1zO3ZhciBhPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlLHQpe3RoaXMud2lkdGg9ZSx0aGlzLmhlaWdodD10fXJldHVybiBlLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVyblwie1c6IFwiK3RoaXMud2lkdGgrXCIsIEg6IFwiK3RoaXMuaGVpZ2h0K1wifVwifSxlLnByb3RvdHlwZS5nZXRDbGFzc05hbWU9ZnVuY3Rpb24oKXtyZXR1cm5cIlNpemVcIn0sZS5wcm90b3R5cGUuZ2V0SGFzaENvZGU9ZnVuY3Rpb24oKXt2YXIgZT10aGlzLndpZHRofHwwO3JldHVybiBlPTM5NyplXih0aGlzLmhlaWdodHx8MCl9LGUucHJvdG90eXBlLmNvcHlGcm9tPWZ1bmN0aW9uKGUpe3RoaXMud2lkdGg9ZS53aWR0aCx0aGlzLmhlaWdodD1lLmhlaWdodH0sZS5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGUodGhpcy53aWR0aCx0aGlzLmhlaWdodCl9LGUucHJvdG90eXBlLmVxdWFscz1mdW5jdGlvbihlKXtyZXR1cm4gZT90aGlzLndpZHRoPT09ZS53aWR0aCYmdGhpcy5oZWlnaHQ9PT1lLmhlaWdodDohMX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KGUucHJvdG90eXBlLFwic3VyZmFjZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy53aWR0aCp0aGlzLmhlaWdodH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxlLlplcm89ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGUoMCwwKX0sZS5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKHQpe3ZhciBpPW5ldyBlKHRoaXMud2lkdGgrdC53aWR0aCx0aGlzLmhlaWdodCt0LmhlaWdodCk7cmV0dXJuIGl9LGUucHJvdG90eXBlLnN1YnN0cmFjdD1mdW5jdGlvbih0KXt2YXIgaT1uZXcgZSh0aGlzLndpZHRoLXQud2lkdGgsdGhpcy5oZWlnaHQtdC5oZWlnaHQpO3JldHVybiBpfSxlLkxlcnA9ZnVuY3Rpb24odCxpLHIpe3ZhciBuPXQud2lkdGgrKGkud2lkdGgtdC53aWR0aCkqcixvPXQuaGVpZ2h0KyhpLmhlaWdodC10LmhlaWdodCkqcjtyZXR1cm4gbmV3IGUobixvKX0sZX0oKTtlLlNpemU9YTt2YXIgaD1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSx0LGkscil7dm9pZCAwPT09ZSYmKGU9MCksdm9pZCAwPT09dCYmKHQ9MCksdm9pZCAwPT09aSYmKGk9MCksdm9pZCAwPT09ciYmKHI9MSksdGhpcy54PWUsdGhpcy55PXQsdGhpcy56PWksdGhpcy53PXJ9cmV0dXJuIGUucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuXCJ7WDogXCIrdGhpcy54K1wiIFk6XCIrdGhpcy55K1wiIFo6XCIrdGhpcy56K1wiIFc6XCIrdGhpcy53K1wifVwifSxlLnByb3RvdHlwZS5nZXRDbGFzc05hbWU9ZnVuY3Rpb24oKXtyZXR1cm5cIlF1YXRlcm5pb25cIn0sZS5wcm90b3R5cGUuZ2V0SGFzaENvZGU9ZnVuY3Rpb24oKXt2YXIgZT10aGlzLnh8fDA7cmV0dXJuIGU9Mzk3KmVeKHRoaXMueXx8MCksZT0zOTcqZV4odGhpcy56fHwwKSxlPTM5NyplXih0aGlzLnd8fDApfSxlLnByb3RvdHlwZS5hc0FycmF5PWZ1bmN0aW9uKCl7cmV0dXJuW3RoaXMueCx0aGlzLnksdGhpcy56LHRoaXMud119LGUucHJvdG90eXBlLmVxdWFscz1mdW5jdGlvbihlKXtyZXR1cm4gZSYmdGhpcy54PT09ZS54JiZ0aGlzLnk9PT1lLnkmJnRoaXMuej09PWUueiYmdGhpcy53PT09ZS53fSxlLnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbigpe3JldHVybiBuZXcgZSh0aGlzLngsdGhpcy55LHRoaXMueix0aGlzLncpfSxlLnByb3RvdHlwZS5jb3B5RnJvbT1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy54PWUueCx0aGlzLnk9ZS55LHRoaXMuej1lLnosdGhpcy53PWUudyx0aGlzfSxlLnByb3RvdHlwZS5jb3B5RnJvbUZsb2F0cz1mdW5jdGlvbihlLHQsaSxyKXtyZXR1cm4gdGhpcy54PWUsdGhpcy55PXQsdGhpcy56PWksdGhpcy53PXIsdGhpc30sZS5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0aGlzLngrdC54LHRoaXMueSt0LnksdGhpcy56K3Queix0aGlzLncrdC53KX0sZS5wcm90b3R5cGUuc3VidHJhY3Q9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlKHRoaXMueC10LngsdGhpcy55LXQueSx0aGlzLnotdC56LHRoaXMudy10LncpfSxlLnByb3RvdHlwZS5zY2FsZT1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUodGhpcy54KnQsdGhpcy55KnQsdGhpcy56KnQsdGhpcy53KnQpfSxlLnByb3RvdHlwZS5tdWx0aXBseT1mdW5jdGlvbih0KXt2YXIgaT1uZXcgZSgwLDAsMCwxKTtyZXR1cm4gdGhpcy5tdWx0aXBseVRvUmVmKHQsaSksaX0sZS5wcm90b3R5cGUubXVsdGlwbHlUb1JlZj1mdW5jdGlvbihlLHQpe3ZhciBpPXRoaXMueCplLncrdGhpcy55KmUuei10aGlzLnoqZS55K3RoaXMudyplLngscj0tdGhpcy54KmUueit0aGlzLnkqZS53K3RoaXMueiplLngrdGhpcy53KmUueSxuPXRoaXMueCplLnktdGhpcy55KmUueCt0aGlzLnoqZS53K3RoaXMudyplLnosbz0tdGhpcy54KmUueC10aGlzLnkqZS55LXRoaXMueiplLnordGhpcy53KmUudztyZXR1cm4gdC5jb3B5RnJvbUZsb2F0cyhpLHIsbixvKSx0aGlzfSxlLnByb3RvdHlwZS5tdWx0aXBseUluUGxhY2U9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMubXVsdGlwbHlUb1JlZihlLHRoaXMpLHRoaXN9LGUucHJvdG90eXBlLmNvbmp1Z2F0ZVRvUmVmPWZ1bmN0aW9uKGUpe3JldHVybiBlLmNvcHlGcm9tRmxvYXRzKC10aGlzLngsLXRoaXMueSwtdGhpcy56LHRoaXMudyksdGhpc30sZS5wcm90b3R5cGUuY29uanVnYXRlSW5QbGFjZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLngqPS0xLHRoaXMueSo9LTEsdGhpcy56Kj0tMSx0aGlzfSxlLnByb3RvdHlwZS5jb25qdWdhdGU9ZnVuY3Rpb24oKXt2YXIgdD1uZXcgZSgtdGhpcy54LC10aGlzLnksLXRoaXMueix0aGlzLncpO3JldHVybiB0fSxlLnByb3RvdHlwZS5sZW5ndGg9ZnVuY3Rpb24oKXtyZXR1cm4gTWF0aC5zcXJ0KHRoaXMueCp0aGlzLngrdGhpcy55KnRoaXMueSt0aGlzLnoqdGhpcy56K3RoaXMudyp0aGlzLncpfSxlLnByb3RvdHlwZS5ub3JtYWxpemU9ZnVuY3Rpb24oKXt2YXIgZT0xL3RoaXMubGVuZ3RoKCk7cmV0dXJuIHRoaXMueCo9ZSx0aGlzLnkqPWUsdGhpcy56Kj1lLHRoaXMudyo9ZSx0aGlzfSxlLnByb3RvdHlwZS50b0V1bGVyQW5nbGVzPWZ1bmN0aW9uKGUpe3ZvaWQgMD09PWUmJihlPVwiWVpYXCIpO3ZhciB0PW8uWmVybygpO3JldHVybiB0aGlzLnRvRXVsZXJBbmdsZXNUb1JlZih0LGUpLHR9LGUucHJvdG90eXBlLnRvRXVsZXJBbmdsZXNUb1JlZj1mdW5jdGlvbihlLHQpe3ZvaWQgMD09PXQmJih0PVwiWVpYXCIpO3ZhciBpLHIsbixvPXRoaXMueCxzPXRoaXMueSxhPXRoaXMueixoPXRoaXMudztzd2l0Y2godCl7Y2FzZVwiWVpYXCI6dmFyIGM9bypzK2EqaDtpZihjPi40OTkmJihpPTIqTWF0aC5hdGFuMihvLGgpLHI9TWF0aC5QSS8yLG49MCksLS40OTk+YyYmKGk9LTIqTWF0aC5hdGFuMihvLGgpLHI9LU1hdGguUEkvMixuPTApLGlzTmFOKGkpKXt2YXIgbD1vKm8sdT1zKnMsZj1hKmE7aT1NYXRoLmF0YW4yKDIqcypoLTIqbyphLDEtMip1LTIqZikscj1NYXRoLmFzaW4oMipjKSxuPU1hdGguYXRhbjIoMipvKmgtMipzKmEsMS0yKmwtMipmKX1icmVhaztkZWZhdWx0OnRocm93IG5ldyBFcnJvcihcIkV1bGVyIG9yZGVyIFwiK3QrXCIgbm90IHN1cHBvcnRlZCB5ZXQuXCIpfXJldHVybiBlLnk9aSxlLno9cixlLng9bix0aGlzfSxlLnByb3RvdHlwZS50b1JvdGF0aW9uTWF0cml4PWZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMueCp0aGlzLngsaT10aGlzLnkqdGhpcy55LHI9dGhpcy56KnRoaXMueixuPXRoaXMueCp0aGlzLnksbz10aGlzLnoqdGhpcy53LHM9dGhpcy56KnRoaXMueCxhPXRoaXMueSp0aGlzLncsaD10aGlzLnkqdGhpcy56LGM9dGhpcy54KnRoaXMudztyZXR1cm4gZS5tWzBdPTEtMiooaStyKSxlLm1bMV09MioobitvKSxlLm1bMl09Mioocy1hKSxlLm1bM109MCxlLm1bNF09Mioobi1vKSxlLm1bNV09MS0yKihyK3QpLGUubVs2XT0yKihoK2MpLGUubVs3XT0wLGUubVs4XT0yKihzK2EpLGUubVs5XT0yKihoLWMpLGUubVsxMF09MS0yKihpK3QpLGUubVsxMV09MCxlLm1bMTJdPTAsZS5tWzEzXT0wLGUubVsxNF09MCxlLm1bMTVdPTEsdGhpc30sZS5wcm90b3R5cGUuZnJvbVJvdGF0aW9uTWF0cml4PWZ1bmN0aW9uKHQpe3JldHVybiBlLkZyb21Sb3RhdGlvbk1hdHJpeFRvUmVmKHQsdGhpcyksdGhpc30sZS5Gcm9tUm90YXRpb25NYXRyaXg9ZnVuY3Rpb24odCl7dmFyIGk9bmV3IGU7cmV0dXJuIGUuRnJvbVJvdGF0aW9uTWF0cml4VG9SZWYodCxpKSxpfSxlLkZyb21Sb3RhdGlvbk1hdHJpeFRvUmVmPWZ1bmN0aW9uKGUsdCl7dmFyIGkscj1lLm0sbj1yWzBdLG89cls0XSxzPXJbOF0sYT1yWzFdLGg9cls1XSxjPXJbOV0sbD1yWzJdLHU9cls2XSxmPXJbMTBdLGQ9bitoK2Y7ZD4wPyhpPS41L01hdGguc3FydChkKzEpLHQudz0uMjUvaSx0Lng9KHUtYykqaSx0Lnk9KHMtbCkqaSx0Lno9KGEtbykqaSk6bj5oJiZuPmY/KGk9MipNYXRoLnNxcnQoMStuLWgtZiksdC53PSh1LWMpL2ksdC54PS4yNSppLHQueT0obythKS9pLHQuej0ocytsKS9pKTpoPmY/KGk9MipNYXRoLnNxcnQoMStoLW4tZiksdC53PShzLWwpL2ksdC54PShvK2EpL2ksdC55PS4yNSppLHQuej0oYyt1KS9pKTooaT0yKk1hdGguc3FydCgxK2Ytbi1oKSx0Lnc9KGEtbykvaSx0Lng9KHMrbCkvaSx0Lnk9KGMrdSkvaSx0Lno9LjI1KmkpfSxlLkludmVyc2U9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlKC10LngsLXQueSwtdC56LHQudyl9LGUuSWRlbnRpdHk9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGUoMCwwLDAsMSl9LGUuUm90YXRpb25BeGlzPWZ1bmN0aW9uKHQsaSl7dmFyIHI9bmV3IGUsbj1NYXRoLnNpbihpLzIpO3JldHVybiB0Lm5vcm1hbGl6ZSgpLHIudz1NYXRoLmNvcyhpLzIpLHIueD10LngqbixyLnk9dC55Km4sci56PXQueipuLHJ9LGUuRnJvbUFycmF5PWZ1bmN0aW9uKHQsaSl7cmV0dXJuIGl8fChpPTApLG5ldyBlKHRbaV0sdFtpKzFdLHRbaSsyXSx0W2krM10pfSxlLlJvdGF0aW9uWWF3UGl0Y2hSb2xsPWZ1bmN0aW9uKHQsaSxyKXt2YXIgbj1uZXcgZTtyZXR1cm4gZS5Sb3RhdGlvbllhd1BpdGNoUm9sbFRvUmVmKHQsaSxyLG4pLG59LGUuUm90YXRpb25ZYXdQaXRjaFJvbGxUb1JlZj1mdW5jdGlvbihlLHQsaSxyKXt2YXIgbj0uNSppLG89LjUqdCxzPS41KmUsYT1NYXRoLnNpbihuKSxoPU1hdGguY29zKG4pLGM9TWF0aC5zaW4obyksbD1NYXRoLmNvcyhvKSx1PU1hdGguc2luKHMpLGY9TWF0aC5jb3Mocyk7ci54PWYqYypoK3UqbCphLHIueT11KmwqaC1mKmMqYSxyLno9ZipsKmEtdSpjKmgsci53PWYqbCpoK3UqYyphfSxlLlJvdGF0aW9uQWxwaGFCZXRhR2FtbWE9ZnVuY3Rpb24odCxpLHIpe3ZhciBuPW5ldyBlO3JldHVybiBlLlJvdGF0aW9uQWxwaGFCZXRhR2FtbWFUb1JlZih0LGkscixuKSxufSxlLlJvdGF0aW9uQWxwaGFCZXRhR2FtbWFUb1JlZj1mdW5jdGlvbihlLHQsaSxyKXt2YXIgbj0uNSooaStlKSxvPS41KihpLWUpLHM9LjUqdDtyLng9TWF0aC5jb3MobykqTWF0aC5zaW4ocyksci55PU1hdGguc2luKG8pKk1hdGguc2luKHMpLHIuej1NYXRoLnNpbihuKSpNYXRoLmNvcyhzKSxyLnc9TWF0aC5jb3MobikqTWF0aC5jb3Mocyl9LGUuU2xlcnA9ZnVuY3Rpb24odCxpLHIpe3ZhciBuLG8scz1yLGE9dC54KmkueCt0LnkqaS55K3QueippLnordC53KmkudyxoPSExO2lmKDA+YSYmKGg9ITAsYT0tYSksYT4uOTk5OTk5KW89MS1zLG49aD8tczpzO2Vsc2V7dmFyIGM9TWF0aC5hY29zKGEpLGw9MS9NYXRoLnNpbihjKTtvPU1hdGguc2luKCgxLXMpKmMpKmwsbj1oPy1NYXRoLnNpbihzKmMpKmw6TWF0aC5zaW4ocypjKSpsfXJldHVybiBuZXcgZShvKnQueCtuKmkueCxvKnQueStuKmkueSxvKnQueituKmkueixvKnQudytuKmkudyl9LGV9KCk7ZS5RdWF0ZXJuaW9uPWg7dmFyIGM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7dGhpcy5tPW5ldyBGbG9hdDMyQXJyYXkoMTYpfXJldHVybiBlLnByb3RvdHlwZS5pc0lkZW50aXR5PWZ1bmN0aW9uKCl7cmV0dXJuIDEhPT10aGlzLm1bMF18fDEhPT10aGlzLm1bNV18fDEhPT10aGlzLm1bMTBdfHwxIT09dGhpcy5tWzE1XT8hMTowPT09dGhpcy5tWzFdJiYwPT09dGhpcy5tWzJdJiYwPT09dGhpcy5tWzNdJiYwPT09dGhpcy5tWzRdJiYwPT09dGhpcy5tWzZdJiYwPT09dGhpcy5tWzddJiYwPT09dGhpcy5tWzhdJiYwPT09dGhpcy5tWzldJiYwPT09dGhpcy5tWzExXSYmMD09PXRoaXMubVsxMl0mJjA9PT10aGlzLm1bMTNdJiYwPT09dGhpcy5tWzE0XX0sZS5wcm90b3R5cGUuZGV0ZXJtaW5hbnQ9ZnVuY3Rpb24oKXt2YXIgZT10aGlzLm1bMTBdKnRoaXMubVsxNV0tdGhpcy5tWzExXSp0aGlzLm1bMTRdLHQ9dGhpcy5tWzldKnRoaXMubVsxNV0tdGhpcy5tWzExXSp0aGlzLm1bMTNdLGk9dGhpcy5tWzldKnRoaXMubVsxNF0tdGhpcy5tWzEwXSp0aGlzLm1bMTNdLHI9dGhpcy5tWzhdKnRoaXMubVsxNV0tdGhpcy5tWzExXSp0aGlzLm1bMTJdLG49dGhpcy5tWzhdKnRoaXMubVsxNF0tdGhpcy5tWzEwXSp0aGlzLm1bMTJdLG89dGhpcy5tWzhdKnRoaXMubVsxM10tdGhpcy5tWzldKnRoaXMubVsxMl07cmV0dXJuIHRoaXMubVswXSoodGhpcy5tWzVdKmUtdGhpcy5tWzZdKnQrdGhpcy5tWzddKmkpLXRoaXMubVsxXSoodGhpcy5tWzRdKmUtdGhpcy5tWzZdKnIrdGhpcy5tWzddKm4pK3RoaXMubVsyXSoodGhpcy5tWzRdKnQtdGhpcy5tWzVdKnIrdGhpcy5tWzddKm8pLXRoaXMubVszXSoodGhpcy5tWzRdKmktdGhpcy5tWzVdKm4rdGhpcy5tWzZdKm8pfSxlLnByb3RvdHlwZS50b0FycmF5PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubX0sZS5wcm90b3R5cGUuYXNBcnJheT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRvQXJyYXkoKX0sZS5wcm90b3R5cGUuaW52ZXJ0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaW52ZXJ0VG9SZWYodGhpcyksdGhpc30sZS5wcm90b3R5cGUucmVzZXQ9ZnVuY3Rpb24oKXtmb3IodmFyIGU9MDsxNj5lO2UrKyl0aGlzLm1bZV09MDtyZXR1cm4gdGhpc30sZS5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKHQpe3ZhciBpPW5ldyBlO3JldHVybiB0aGlzLmFkZFRvUmVmKHQsaSksaX0sZS5wcm90b3R5cGUuYWRkVG9SZWY9ZnVuY3Rpb24oZSx0KXtmb3IodmFyIGk9MDsxNj5pO2krKyl0Lm1baV09dGhpcy5tW2ldK2UubVtpXTtyZXR1cm4gdGhpc30sZS5wcm90b3R5cGUuYWRkVG9TZWxmPWZ1bmN0aW9uKGUpe2Zvcih2YXIgdD0wOzE2PnQ7dCsrKXRoaXMubVt0XSs9ZS5tW3RdO3JldHVybiB0aGlzfSxlLnByb3RvdHlwZS5pbnZlcnRUb1JlZj1mdW5jdGlvbihlKXt2YXIgdD10aGlzLm1bMF0saT10aGlzLm1bMV0scj10aGlzLm1bMl0sbj10aGlzLm1bM10sbz10aGlzLm1bNF0scz10aGlzLm1bNV0sYT10aGlzLm1bNl0saD10aGlzLm1bN10sYz10aGlzLm1bOF0sbD10aGlzLm1bOV0sdT10aGlzLm1bMTBdLGY9dGhpcy5tWzExXSxkPXRoaXMubVsxMl0scD10aGlzLm1bMTNdLF89dGhpcy5tWzE0XSxtPXRoaXMubVsxNV0sZz11Km0tZipfLHY9bCptLWYqcCx5PWwqXy11KnAseD1jKm0tZipkLGI9YypfLXUqZCxQPWMqcC1sKmQsQT1zKmctYSp2K2gqeSxUPS0obypnLWEqeCtoKmIpLEU9byp2LXMqeCtoKlAsQz0tKG8qeS1zKmIrYSpQKSxTPTEvKHQqQStpKlQrcipFK24qQyksTT1hKm0taCpfLEk9cyptLWgqcCxEPXMqXy1hKnAsUj1vKm0taCpkLE89bypfLWEqZCx3PW8qcC1zKmQsTD1hKmYtaCp1LEI9cypmLWgqbCxWPXMqdS1hKmwsRj1vKmYtaCpjLE49byp1LWEqYyx6PW8qbC1zKmM7cmV0dXJuIGUubVswXT1BKlMsZS5tWzRdPVQqUyxlLm1bOF09RSpTLGUubVsxMl09QypTLGUubVsxXT0tKGkqZy1yKnYrbip5KSpTLGUubVs1XT0odCpnLXIqeCtuKmIpKlMsZS5tWzldPS0odCp2LWkqeCtuKlApKlMsZS5tWzEzXT0odCp5LWkqYityKlApKlMsZS5tWzJdPShpKk0tcipJK24qRCkqUyxlLm1bNl09LSh0Kk0tcipSK24qTykqUyxlLm1bMTBdPSh0KkktaSpSK24qdykqUyxlLm1bMTRdPS0odCpELWkqTytyKncpKlMsZS5tWzNdPS0oaSpMLXIqQituKlYpKlMsZS5tWzddPSh0KkwtcipGK24qTikqUyxlLm1bMTFdPS0odCpCLWkqRituKnopKlMsZS5tWzE1XT0odCpWLWkqTityKnopKlMsdGhpc30sZS5wcm90b3R5cGUuc2V0VHJhbnNsYXRpb249ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMubVsxMl09ZS54LHRoaXMubVsxM109ZS55LHRoaXMubVsxNF09ZS56LHRoaXN9LGUucHJvdG90eXBlLmdldFRyYW5zbGF0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBvKHRoaXMubVsxMl0sdGhpcy5tWzEzXSx0aGlzLm1bMTRdKX0sZS5wcm90b3R5cGUubXVsdGlwbHk9ZnVuY3Rpb24odCl7dmFyIGk9bmV3IGU7cmV0dXJuIHRoaXMubXVsdGlwbHlUb1JlZih0LGkpLGl9LGUucHJvdG90eXBlLmNvcHlGcm9tPWZ1bmN0aW9uKGUpe2Zvcih2YXIgdD0wOzE2PnQ7dCsrKXRoaXMubVt0XT1lLm1bdF07cmV0dXJuIHRoaXN9LGUucHJvdG90eXBlLmNvcHlUb0FycmF5PWZ1bmN0aW9uKGUsdCl7dm9pZCAwPT09dCYmKHQ9MCk7Zm9yKHZhciBpPTA7MTY+aTtpKyspZVt0K2ldPXRoaXMubVtpXTtyZXR1cm4gdGhpc30sZS5wcm90b3R5cGUubXVsdGlwbHlUb1JlZj1mdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLm11bHRpcGx5VG9BcnJheShlLHQubSwwKSx0aGlzfSxlLnByb3RvdHlwZS5tdWx0aXBseVRvQXJyYXk9ZnVuY3Rpb24oZSx0LGkpe3ZhciByPXRoaXMubVswXSxuPXRoaXMubVsxXSxvPXRoaXMubVsyXSxzPXRoaXMubVszXSxhPXRoaXMubVs0XSxoPXRoaXMubVs1XSxjPXRoaXMubVs2XSxsPXRoaXMubVs3XSx1PXRoaXMubVs4XSxmPXRoaXMubVs5XSxkPXRoaXMubVsxMF0scD10aGlzLm1bMTFdLF89dGhpcy5tWzEyXSxtPXRoaXMubVsxM10sZz10aGlzLm1bMTRdLHY9dGhpcy5tWzE1XSx5PWUubVswXSx4PWUubVsxXSxiPWUubVsyXSxQPWUubVszXSxBPWUubVs0XSxUPWUubVs1XSxFPWUubVs2XSxDPWUubVs3XSxTPWUubVs4XSxNPWUubVs5XSxJPWUubVsxMF0sRD1lLm1bMTFdLFI9ZS5tWzEyXSxPPWUubVsxM10sdz1lLm1bMTRdLEw9ZS5tWzE1XTtcbnJldHVybiB0W2ldPXIqeStuKkErbypTK3MqUix0W2krMV09cip4K24qVCtvKk0rcypPLHRbaSsyXT1yKmIrbipFK28qSStzKncsdFtpKzNdPXIqUCtuKkMrbypEK3MqTCx0W2krNF09YSp5K2gqQStjKlMrbCpSLHRbaSs1XT1hKngraCpUK2MqTStsKk8sdFtpKzZdPWEqYitoKkUrYypJK2wqdyx0W2krN109YSpQK2gqQytjKkQrbCpMLHRbaSs4XT11KnkrZipBK2QqUytwKlIsdFtpKzldPXUqeCtmKlQrZCpNK3AqTyx0W2krMTBdPXUqYitmKkUrZCpJK3Aqdyx0W2krMTFdPXUqUCtmKkMrZCpEK3AqTCx0W2krMTJdPV8qeSttKkErZypTK3YqUix0W2krMTNdPV8qeCttKlQrZypNK3YqTyx0W2krMTRdPV8qYittKkUrZypJK3Yqdyx0W2krMTVdPV8qUCttKkMrZypEK3YqTCx0aGlzfSxlLnByb3RvdHlwZS5lcXVhbHM9ZnVuY3Rpb24oZSl7cmV0dXJuIGUmJnRoaXMubVswXT09PWUubVswXSYmdGhpcy5tWzFdPT09ZS5tWzFdJiZ0aGlzLm1bMl09PT1lLm1bMl0mJnRoaXMubVszXT09PWUubVszXSYmdGhpcy5tWzRdPT09ZS5tWzRdJiZ0aGlzLm1bNV09PT1lLm1bNV0mJnRoaXMubVs2XT09PWUubVs2XSYmdGhpcy5tWzddPT09ZS5tWzddJiZ0aGlzLm1bOF09PT1lLm1bOF0mJnRoaXMubVs5XT09PWUubVs5XSYmdGhpcy5tWzEwXT09PWUubVsxMF0mJnRoaXMubVsxMV09PT1lLm1bMTFdJiZ0aGlzLm1bMTJdPT09ZS5tWzEyXSYmdGhpcy5tWzEzXT09PWUubVsxM10mJnRoaXMubVsxNF09PT1lLm1bMTRdJiZ0aGlzLm1bMTVdPT09ZS5tWzE1XX0sZS5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oKXtyZXR1cm4gZS5Gcm9tVmFsdWVzKHRoaXMubVswXSx0aGlzLm1bMV0sdGhpcy5tWzJdLHRoaXMubVszXSx0aGlzLm1bNF0sdGhpcy5tWzVdLHRoaXMubVs2XSx0aGlzLm1bN10sdGhpcy5tWzhdLHRoaXMubVs5XSx0aGlzLm1bMTBdLHRoaXMubVsxMV0sdGhpcy5tWzEyXSx0aGlzLm1bMTNdLHRoaXMubVsxNF0sdGhpcy5tWzE1XSl9LGUucHJvdG90eXBlLmdldENsYXNzTmFtZT1mdW5jdGlvbigpe3JldHVyblwiTWF0cml4XCJ9LGUucHJvdG90eXBlLmdldEhhc2hDb2RlPWZ1bmN0aW9uKCl7Zm9yKHZhciBlPXRoaXMubVswXXx8MCx0PTE7MTY+dDt0KyspZT0zOTcqZV4odGhpcy5tW3RdfHwwKTtyZXR1cm4gZX0sZS5wcm90b3R5cGUuZGVjb21wb3NlPWZ1bmN0aW9uKGkscixuKXtuLng9dGhpcy5tWzEyXSxuLnk9dGhpcy5tWzEzXSxuLno9dGhpcy5tWzE0XTt2YXIgbz10LlNpZ24odGhpcy5tWzBdKnRoaXMubVsxXSp0aGlzLm1bMl0qdGhpcy5tWzNdKTwwPy0xOjEscz10LlNpZ24odGhpcy5tWzRdKnRoaXMubVs1XSp0aGlzLm1bNl0qdGhpcy5tWzddKTwwPy0xOjEsYT10LlNpZ24odGhpcy5tWzhdKnRoaXMubVs5XSp0aGlzLm1bMTBdKnRoaXMubVsxMV0pPDA/LTE6MTtpZihpLng9bypNYXRoLnNxcnQodGhpcy5tWzBdKnRoaXMubVswXSt0aGlzLm1bMV0qdGhpcy5tWzFdK3RoaXMubVsyXSp0aGlzLm1bMl0pLGkueT1zKk1hdGguc3FydCh0aGlzLm1bNF0qdGhpcy5tWzRdK3RoaXMubVs1XSp0aGlzLm1bNV0rdGhpcy5tWzZdKnRoaXMubVs2XSksaS56PWEqTWF0aC5zcXJ0KHRoaXMubVs4XSp0aGlzLm1bOF0rdGhpcy5tWzldKnRoaXMubVs5XSt0aGlzLm1bMTBdKnRoaXMubVsxMF0pLDA9PT1pLnh8fDA9PT1pLnl8fDA9PT1pLnopcmV0dXJuIHIueD0wLHIueT0wLHIuej0wLHIudz0xLCExO3ZhciBjPWUuRnJvbVZhbHVlcyh0aGlzLm1bMF0vaS54LHRoaXMubVsxXS9pLngsdGhpcy5tWzJdL2kueCwwLHRoaXMubVs0XS9pLnksdGhpcy5tWzVdL2kueSx0aGlzLm1bNl0vaS55LDAsdGhpcy5tWzhdL2kueix0aGlzLm1bOV0vaS56LHRoaXMubVsxMF0vaS56LDAsMCwwLDAsMSk7cmV0dXJuIGguRnJvbVJvdGF0aW9uTWF0cml4VG9SZWYoYyxyKSwhMH0sZS5Gcm9tQXJyYXk9ZnVuY3Rpb24odCxpKXt2YXIgcj1uZXcgZTtyZXR1cm4gaXx8KGk9MCksZS5Gcm9tQXJyYXlUb1JlZih0LGkscikscn0sZS5Gcm9tQXJyYXlUb1JlZj1mdW5jdGlvbihlLHQsaSl7Zm9yKHZhciByPTA7MTY+cjtyKyspaS5tW3JdPWVbcit0XX0sZS5Gcm9tRmxvYXQzMkFycmF5VG9SZWZTY2FsZWQ9ZnVuY3Rpb24oZSx0LGkscil7Zm9yKHZhciBuPTA7MTY+bjtuKyspci5tW25dPWVbbit0XSppfSxlLkZyb21WYWx1ZXNUb1JlZj1mdW5jdGlvbihlLHQsaSxyLG4sbyxzLGEsaCxjLGwsdSxmLGQscCxfLG0pe20ubVswXT1lLG0ubVsxXT10LG0ubVsyXT1pLG0ubVszXT1yLG0ubVs0XT1uLG0ubVs1XT1vLG0ubVs2XT1zLG0ubVs3XT1hLG0ubVs4XT1oLG0ubVs5XT1jLG0ubVsxMF09bCxtLm1bMTFdPXUsbS5tWzEyXT1mLG0ubVsxM109ZCxtLm1bMTRdPXAsbS5tWzE1XT1ffSxlLnByb3RvdHlwZS5nZXRSb3c9ZnVuY3Rpb24oZSl7aWYoMD5lfHxlPjMpcmV0dXJuIG51bGw7dmFyIHQ9NCplO3JldHVybiBuZXcgcyh0aGlzLm1bdCswXSx0aGlzLm1bdCsxXSx0aGlzLm1bdCsyXSx0aGlzLm1bdCszXSl9LGUucHJvdG90eXBlLnNldFJvdz1mdW5jdGlvbihlLHQpe2lmKDA+ZXx8ZT4zKXJldHVybiB0aGlzO3ZhciBpPTQqZTtyZXR1cm4gdGhpcy5tW2krMF09dC54LHRoaXMubVtpKzFdPXQueSx0aGlzLm1baSsyXT10LnosdGhpcy5tW2krM109dC53LHRoaXN9LGUuRnJvbVZhbHVlcz1mdW5jdGlvbih0LGkscixuLG8scyxhLGgsYyxsLHUsZixkLHAsXyxtKXt2YXIgZz1uZXcgZTtyZXR1cm4gZy5tWzBdPXQsZy5tWzFdPWksZy5tWzJdPXIsZy5tWzNdPW4sZy5tWzRdPW8sZy5tWzVdPXMsZy5tWzZdPWEsZy5tWzddPWgsZy5tWzhdPWMsZy5tWzldPWwsZy5tWzEwXT11LGcubVsxMV09ZixnLm1bMTJdPWQsZy5tWzEzXT1wLGcubVsxNF09XyxnLm1bMTVdPW0sZ30sZS5Db21wb3NlPWZ1bmN0aW9uKHQsaSxyKXt2YXIgbj1lLkZyb21WYWx1ZXModC54LDAsMCwwLDAsdC55LDAsMCwwLDAsdC56LDAsMCwwLDAsMSksbz1lLklkZW50aXR5KCk7cmV0dXJuIGkudG9Sb3RhdGlvbk1hdHJpeChvKSxuPW4ubXVsdGlwbHkobyksbi5zZXRUcmFuc2xhdGlvbihyKSxufSxlLklkZW50aXR5PWZ1bmN0aW9uKCl7cmV0dXJuIGUuRnJvbVZhbHVlcygxLDAsMCwwLDAsMSwwLDAsMCwwLDEsMCwwLDAsMCwxKX0sZS5JZGVudGl0eVRvUmVmPWZ1bmN0aW9uKHQpe2UuRnJvbVZhbHVlc1RvUmVmKDEsMCwwLDAsMCwxLDAsMCwwLDAsMSwwLDAsMCwwLDEsdCl9LGUuWmVybz1mdW5jdGlvbigpe3JldHVybiBlLkZyb21WYWx1ZXMoMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCl9LGUuUm90YXRpb25YPWZ1bmN0aW9uKHQpe3ZhciBpPW5ldyBlO3JldHVybiBlLlJvdGF0aW9uWFRvUmVmKHQsaSksaX0sZS5JbnZlcnQ9ZnVuY3Rpb24odCl7dmFyIGk9bmV3IGU7cmV0dXJuIHQuaW52ZXJ0VG9SZWYoaSksaX0sZS5Sb3RhdGlvblhUb1JlZj1mdW5jdGlvbihlLHQpe3ZhciBpPU1hdGguc2luKGUpLHI9TWF0aC5jb3MoZSk7dC5tWzBdPTEsdC5tWzE1XT0xLHQubVs1XT1yLHQubVsxMF09cix0Lm1bOV09LWksdC5tWzZdPWksdC5tWzFdPTAsdC5tWzJdPTAsdC5tWzNdPTAsdC5tWzRdPTAsdC5tWzddPTAsdC5tWzhdPTAsdC5tWzExXT0wLHQubVsxMl09MCx0Lm1bMTNdPTAsdC5tWzE0XT0wfSxlLlJvdGF0aW9uWT1mdW5jdGlvbih0KXt2YXIgaT1uZXcgZTtyZXR1cm4gZS5Sb3RhdGlvbllUb1JlZih0LGkpLGl9LGUuUm90YXRpb25ZVG9SZWY9ZnVuY3Rpb24oZSx0KXt2YXIgaT1NYXRoLnNpbihlKSxyPU1hdGguY29zKGUpO3QubVs1XT0xLHQubVsxNV09MSx0Lm1bMF09cix0Lm1bMl09LWksdC5tWzhdPWksdC5tWzEwXT1yLHQubVsxXT0wLHQubVszXT0wLHQubVs0XT0wLHQubVs2XT0wLHQubVs3XT0wLHQubVs5XT0wLHQubVsxMV09MCx0Lm1bMTJdPTAsdC5tWzEzXT0wLHQubVsxNF09MH0sZS5Sb3RhdGlvblo9ZnVuY3Rpb24odCl7dmFyIGk9bmV3IGU7cmV0dXJuIGUuUm90YXRpb25aVG9SZWYodCxpKSxpfSxlLlJvdGF0aW9uWlRvUmVmPWZ1bmN0aW9uKGUsdCl7dmFyIGk9TWF0aC5zaW4oZSkscj1NYXRoLmNvcyhlKTt0Lm1bMTBdPTEsdC5tWzE1XT0xLHQubVswXT1yLHQubVsxXT1pLHQubVs0XT0taSx0Lm1bNV09cix0Lm1bMl09MCx0Lm1bM109MCx0Lm1bNl09MCx0Lm1bN109MCx0Lm1bOF09MCx0Lm1bOV09MCx0Lm1bMTFdPTAsdC5tWzEyXT0wLHQubVsxM109MCx0Lm1bMTRdPTB9LGUuUm90YXRpb25BeGlzPWZ1bmN0aW9uKHQsaSl7dmFyIHI9ZS5aZXJvKCk7cmV0dXJuIGUuUm90YXRpb25BeGlzVG9SZWYodCxpLHIpLHJ9LGUuUm90YXRpb25BeGlzVG9SZWY9ZnVuY3Rpb24oZSx0LGkpe3ZhciByPU1hdGguc2luKC10KSxuPU1hdGguY29zKC10KSxvPTEtbjtlLm5vcm1hbGl6ZSgpLGkubVswXT1lLngqZS54Km8rbixpLm1bMV09ZS54KmUueSpvLWUueipyLGkubVsyXT1lLngqZS56Km8rZS55KnIsaS5tWzNdPTAsaS5tWzRdPWUueSplLngqbytlLnoqcixpLm1bNV09ZS55KmUueSpvK24saS5tWzZdPWUueSplLnoqby1lLngqcixpLm1bN109MCxpLm1bOF09ZS56KmUueCpvLWUueSpyLGkubVs5XT1lLnoqZS55Km8rZS54KnIsaS5tWzEwXT1lLnoqZS56Km8rbixpLm1bMTFdPTAsaS5tWzE1XT0xfSxlLlJvdGF0aW9uWWF3UGl0Y2hSb2xsPWZ1bmN0aW9uKHQsaSxyKXt2YXIgbj1uZXcgZTtyZXR1cm4gZS5Sb3RhdGlvbllhd1BpdGNoUm9sbFRvUmVmKHQsaSxyLG4pLG59LGUuUm90YXRpb25ZYXdQaXRjaFJvbGxUb1JlZj1mdW5jdGlvbihlLHQsaSxyKXtoLlJvdGF0aW9uWWF3UGl0Y2hSb2xsVG9SZWYoZSx0LGksdGhpcy5fdGVtcFF1YXRlcm5pb24pLHRoaXMuX3RlbXBRdWF0ZXJuaW9uLnRvUm90YXRpb25NYXRyaXgocil9LGUuU2NhbGluZz1mdW5jdGlvbih0LGkscil7dmFyIG49ZS5aZXJvKCk7cmV0dXJuIGUuU2NhbGluZ1RvUmVmKHQsaSxyLG4pLG59LGUuU2NhbGluZ1RvUmVmPWZ1bmN0aW9uKGUsdCxpLHIpe3IubVswXT1lLHIubVsxXT0wLHIubVsyXT0wLHIubVszXT0wLHIubVs0XT0wLHIubVs1XT10LHIubVs2XT0wLHIubVs3XT0wLHIubVs4XT0wLHIubVs5XT0wLHIubVsxMF09aSxyLm1bMTFdPTAsci5tWzEyXT0wLHIubVsxM109MCxyLm1bMTRdPTAsci5tWzE1XT0xfSxlLlRyYW5zbGF0aW9uPWZ1bmN0aW9uKHQsaSxyKXt2YXIgbj1lLklkZW50aXR5KCk7cmV0dXJuIGUuVHJhbnNsYXRpb25Ub1JlZih0LGkscixuKSxufSxlLlRyYW5zbGF0aW9uVG9SZWY9ZnVuY3Rpb24odCxpLHIsbil7ZS5Gcm9tVmFsdWVzVG9SZWYoMSwwLDAsMCwwLDEsMCwwLDAsMCwxLDAsdCxpLHIsMSxuKX0sZS5MZXJwPWZ1bmN0aW9uKHQsaSxyKXtmb3IodmFyIG49ZS5aZXJvKCksbz0wOzE2Pm87bysrKW4ubVtvXT10Lm1bb10qKDEtcikraS5tW29dKnI7cmV0dXJuIG59LGUuRGVjb21wb3NlTGVycD1mdW5jdGlvbih0LGkscil7dmFyIG49bmV3IG8oMCwwLDApLHM9bmV3IGgsYT1uZXcgbygwLDAsMCk7dC5kZWNvbXBvc2UobixzLGEpO3ZhciBjPW5ldyBvKDAsMCwwKSxsPW5ldyBoLHU9bmV3IG8oMCwwLDApO2kuZGVjb21wb3NlKGMsbCx1KTt2YXIgZj1vLkxlcnAobixjLHIpLGQ9aC5TbGVycChzLGwscikscD1vLkxlcnAoYSx1LHIpO3JldHVybiBlLkNvbXBvc2UoZixkLHApfSxlLkxvb2tBdExIPWZ1bmN0aW9uKHQsaSxyKXt2YXIgbj1lLlplcm8oKTtyZXR1cm4gZS5Mb29rQXRMSFRvUmVmKHQsaSxyLG4pLG59LGUuTG9va0F0TEhUb1JlZj1mdW5jdGlvbih0LGkscixuKXtpLnN1YnRyYWN0VG9SZWYodCx0aGlzLl96QXhpcyksdGhpcy5fekF4aXMubm9ybWFsaXplKCksby5Dcm9zc1RvUmVmKHIsdGhpcy5fekF4aXMsdGhpcy5feEF4aXMpLDA9PT10aGlzLl94QXhpcy5sZW5ndGhTcXVhcmVkKCk/dGhpcy5feEF4aXMueD0xOnRoaXMuX3hBeGlzLm5vcm1hbGl6ZSgpLG8uQ3Jvc3NUb1JlZih0aGlzLl96QXhpcyx0aGlzLl94QXhpcyx0aGlzLl95QXhpcyksdGhpcy5feUF4aXMubm9ybWFsaXplKCk7dmFyIHM9LW8uRG90KHRoaXMuX3hBeGlzLHQpLGE9LW8uRG90KHRoaXMuX3lBeGlzLHQpLGg9LW8uRG90KHRoaXMuX3pBeGlzLHQpO3JldHVybiBlLkZyb21WYWx1ZXNUb1JlZih0aGlzLl94QXhpcy54LHRoaXMuX3lBeGlzLngsdGhpcy5fekF4aXMueCwwLHRoaXMuX3hBeGlzLnksdGhpcy5feUF4aXMueSx0aGlzLl96QXhpcy55LDAsdGhpcy5feEF4aXMueix0aGlzLl95QXhpcy56LHRoaXMuX3pBeGlzLnosMCxzLGEsaCwxLG4pfSxlLk9ydGhvTEg9ZnVuY3Rpb24odCxpLHIsbil7dmFyIG89ZS5aZXJvKCk7cmV0dXJuIGUuT3J0aG9MSFRvUmVmKHQsaSxyLG4sbyksb30sZS5PcnRob0xIVG9SZWY9ZnVuY3Rpb24odCxpLHIsbixvKXt2YXIgcz0yL3QsYT0yL2ksaD0xLyhuLXIpLGM9ci8oci1uKTtlLkZyb21WYWx1ZXNUb1JlZihzLDAsMCwwLDAsYSwwLDAsMCwwLGgsMCwwLDAsYywxLG8pfSxlLk9ydGhvT2ZmQ2VudGVyTEg9ZnVuY3Rpb24odCxpLHIsbixvLHMpe3ZhciBhPWUuWmVybygpO3JldHVybiBlLk9ydGhvT2ZmQ2VudGVyTEhUb1JlZih0LGkscixuLG8scyxhKSxhfSxlLk9ydGhvT2ZmQ2VudGVyTEhUb1JlZj1mdW5jdGlvbihlLHQsaSxyLG4sbyxzKXtzLm1bMF09Mi8odC1lKSxzLm1bMV09cy5tWzJdPXMubVszXT0wLHMubVs1XT0yLyhyLWkpLHMubVs0XT1zLm1bNl09cy5tWzddPTAscy5tWzEwXT0tMS8obi1vKSxzLm1bOF09cy5tWzldPXMubVsxMV09MCxzLm1bMTJdPShlK3QpLyhlLXQpLHMubVsxM109KHIraSkvKGktcikscy5tWzE0XT1uLyhuLW8pLHMubVsxNV09MX0sZS5QZXJzcGVjdGl2ZUxIPWZ1bmN0aW9uKHQsaSxyLG4pe3ZhciBvPWUuWmVybygpO3JldHVybiBvLm1bMF09MipyL3Qsby5tWzFdPW8ubVsyXT1vLm1bM109MCxvLm1bNV09MipyL2ksby5tWzRdPW8ubVs2XT1vLm1bN109MCxvLm1bMTBdPS1uLyhyLW4pLG8ubVs4XT1vLm1bOV09MCxvLm1bMTFdPTEsby5tWzEyXT1vLm1bMTNdPW8ubVsxNV09MCxvLm1bMTRdPXIqbi8oci1uKSxvfSxlLlBlcnNwZWN0aXZlRm92TEg9ZnVuY3Rpb24odCxpLHIsbil7dmFyIG89ZS5aZXJvKCk7cmV0dXJuIGUuUGVyc3BlY3RpdmVGb3ZMSFRvUmVmKHQsaSxyLG4sbyksb30sZS5QZXJzcGVjdGl2ZUZvdkxIVG9SZWY9ZnVuY3Rpb24oZSx0LGkscixuLG8pe3ZvaWQgMD09PW8mJihvPSEwKTt2YXIgcz0xL01hdGgudGFuKC41KmUpO28/bi5tWzBdPXMvdDpuLm1bMF09cyxuLm1bMV09bi5tWzJdPW4ubVszXT0wLG8/bi5tWzVdPXM6bi5tWzVdPXMqdCxuLm1bNF09bi5tWzZdPW4ubVs3XT0wLG4ubVs4XT1uLm1bOV09MCxuLm1bMTBdPS1yLyhpLXIpLG4ubVsxMV09MSxuLm1bMTJdPW4ubVsxM109bi5tWzE1XT0wLG4ubVsxNF09aSpyLyhpLXIpfSxlLkdldEZpbmFsTWF0cml4PWZ1bmN0aW9uKHQsaSxyLG4sbyxzKXt2YXIgYT10LndpZHRoLGg9dC5oZWlnaHQsYz10LngsbD10LnksdT1lLkZyb21WYWx1ZXMoYS8yLDAsMCwwLDAsLWgvMiwwLDAsMCwwLHMtbywwLGMrYS8yLGgvMitsLG8sMSk7cmV0dXJuIGkubXVsdGlwbHkocikubXVsdGlwbHkobikubXVsdGlwbHkodSl9LGUuR2V0QXNNYXRyaXgyeDI9ZnVuY3Rpb24oZSl7cmV0dXJuIG5ldyBGbG9hdDMyQXJyYXkoW2UubVswXSxlLm1bMV0sZS5tWzRdLGUubVs1XV0pfSxlLkdldEFzTWF0cml4M3gzPWZ1bmN0aW9uKGUpe3JldHVybiBuZXcgRmxvYXQzMkFycmF5KFtlLm1bMF0sZS5tWzFdLGUubVsyXSxlLm1bNF0sZS5tWzVdLGUubVs2XSxlLm1bOF0sZS5tWzldLGUubVsxMF1dKX0sZS5UcmFuc3Bvc2U9ZnVuY3Rpb24odCl7dmFyIGk9bmV3IGU7cmV0dXJuIGkubVswXT10Lm1bMF0saS5tWzFdPXQubVs0XSxpLm1bMl09dC5tWzhdLGkubVszXT10Lm1bMTJdLGkubVs0XT10Lm1bMV0saS5tWzVdPXQubVs1XSxpLm1bNl09dC5tWzldLGkubVs3XT10Lm1bMTNdLGkubVs4XT10Lm1bMl0saS5tWzldPXQubVs2XSxpLm1bMTBdPXQubVsxMF0saS5tWzExXT10Lm1bMTRdLGkubVsxMl09dC5tWzNdLGkubVsxM109dC5tWzddLGkubVsxNF09dC5tWzExXSxpLm1bMTVdPXQubVsxNV0saX0sZS5SZWZsZWN0aW9uPWZ1bmN0aW9uKHQpe3ZhciBpPW5ldyBlO3JldHVybiBlLlJlZmxlY3Rpb25Ub1JlZih0LGkpLGl9LGUuUmVmbGVjdGlvblRvUmVmPWZ1bmN0aW9uKGUsdCl7ZS5ub3JtYWxpemUoKTt2YXIgaT1lLm5vcm1hbC54LHI9ZS5ub3JtYWwueSxuPWUubm9ybWFsLnosbz0tMippLHM9LTIqcixhPS0yKm47dC5tWzBdPW8qaSsxLHQubVsxXT1zKmksdC5tWzJdPWEqaSx0Lm1bM109MCx0Lm1bNF09bypyLHQubVs1XT1zKnIrMSx0Lm1bNl09YSpyLHQubVs3XT0wLHQubVs4XT1vKm4sdC5tWzldPXMqbix0Lm1bMTBdPWEqbisxLHQubVsxMV09MCx0Lm1bMTJdPW8qZS5kLHQubVsxM109cyplLmQsdC5tWzE0XT1hKmUuZCx0Lm1bMTVdPTF9LGUuX3RlbXBRdWF0ZXJuaW9uPW5ldyBoLGUuX3hBeGlzPW8uWmVybygpLGUuX3lBeGlzPW8uWmVybygpLGUuX3pBeGlzPW8uWmVybygpLGV9KCk7ZS5NYXRyaXg9Yzt2YXIgbD1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSx0LGkscil7dGhpcy5ub3JtYWw9bmV3IG8oZSx0LGkpLHRoaXMuZD1yfXJldHVybiBlLnByb3RvdHlwZS5hc0FycmF5PWZ1bmN0aW9uKCl7cmV0dXJuW3RoaXMubm9ybWFsLngsdGhpcy5ub3JtYWwueSx0aGlzLm5vcm1hbC56LHRoaXMuZF19LGUucHJvdG90eXBlLmNsb25lPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBlKHRoaXMubm9ybWFsLngsdGhpcy5ub3JtYWwueSx0aGlzLm5vcm1hbC56LHRoaXMuZCl9LGUucHJvdG90eXBlLmdldENsYXNzTmFtZT1mdW5jdGlvbigpe3JldHVyblwiUGxhbmVcIn0sZS5wcm90b3R5cGUuZ2V0SGFzaENvZGU9ZnVuY3Rpb24oKXt2YXIgZT10aGlzLm5vcm1hbC5nZXRIYXNoQ29kZSgpO3JldHVybiBlPTM5NyplXih0aGlzLmR8fDApfSxlLnByb3RvdHlwZS5ub3JtYWxpemU9ZnVuY3Rpb24oKXt2YXIgZT1NYXRoLnNxcnQodGhpcy5ub3JtYWwueCp0aGlzLm5vcm1hbC54K3RoaXMubm9ybWFsLnkqdGhpcy5ub3JtYWwueSt0aGlzLm5vcm1hbC56KnRoaXMubm9ybWFsLnopLHQ9MDtyZXR1cm4gMCE9PWUmJih0PTEvZSksdGhpcy5ub3JtYWwueCo9dCx0aGlzLm5vcm1hbC55Kj10LHRoaXMubm9ybWFsLnoqPXQsdGhpcy5kKj10LHRoaXN9LGUucHJvdG90eXBlLnRyYW5zZm9ybT1mdW5jdGlvbih0KXt2YXIgaT1jLlRyYW5zcG9zZSh0KSxyPXRoaXMubm9ybWFsLngsbj10aGlzLm5vcm1hbC55LG89dGhpcy5ub3JtYWwueixzPXRoaXMuZCxhPXIqaS5tWzBdK24qaS5tWzFdK28qaS5tWzJdK3MqaS5tWzNdLGg9cippLm1bNF0rbippLm1bNV0rbyppLm1bNl0rcyppLm1bN10sbD1yKmkubVs4XStuKmkubVs5XStvKmkubVsxMF0rcyppLm1bMTFdLHU9cippLm1bMTJdK24qaS5tWzEzXStvKmkubVsxNF0rcyppLm1bMTVdO3JldHVybiBuZXcgZShhLGgsbCx1KX0sZS5wcm90b3R5cGUuZG90Q29vcmRpbmF0ZT1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5ub3JtYWwueCplLngrdGhpcy5ub3JtYWwueSplLnkrdGhpcy5ub3JtYWwueiplLnordGhpcy5kfSxlLnByb3RvdHlwZS5jb3B5RnJvbVBvaW50cz1mdW5jdGlvbihlLHQsaSl7dmFyIHIsbj10LngtZS54LG89dC55LWUueSxzPXQuei1lLnosYT1pLngtZS54LGg9aS55LWUueSxjPWkuei1lLnosbD1vKmMtcypoLHU9cyphLW4qYyxmPW4qaC1vKmEsZD1NYXRoLnNxcnQobCpsK3UqdStmKmYpO3JldHVybiByPTAhPT1kPzEvZDowLHRoaXMubm9ybWFsLng9bCpyLHRoaXMubm9ybWFsLnk9dSpyLHRoaXMubm9ybWFsLno9ZipyLHRoaXMuZD0tKHRoaXMubm9ybWFsLngqZS54K3RoaXMubm9ybWFsLnkqZS55K3RoaXMubm9ybWFsLnoqZS56KSx0aGlzfSxlLnByb3RvdHlwZS5pc0Zyb250RmFjaW5nVG89ZnVuY3Rpb24oZSx0KXt2YXIgaT1vLkRvdCh0aGlzLm5vcm1hbCxlKTtyZXR1cm4gdD49aX0sZS5wcm90b3R5cGUuc2lnbmVkRGlzdGFuY2VUbz1mdW5jdGlvbihlKXtyZXR1cm4gby5Eb3QoZSx0aGlzLm5vcm1hbCkrdGhpcy5kfSxlLkZyb21BcnJheT1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUodFswXSx0WzFdLHRbMl0sdFszXSl9LGUuRnJvbVBvaW50cz1mdW5jdGlvbih0LGkscil7dmFyIG49bmV3IGUoMCwwLDAsMCk7cmV0dXJuIG4uY29weUZyb21Qb2ludHModCxpLHIpLG59LGUuRnJvbVBvc2l0aW9uQW5kTm9ybWFsPWZ1bmN0aW9uKHQsaSl7dmFyIHI9bmV3IGUoMCwwLDAsMCk7cmV0dXJuIGkubm9ybWFsaXplKCksci5ub3JtYWw9aSxyLmQ9LShpLngqdC54K2kueSp0LnkraS56KnQueikscn0sZS5TaWduZWREaXN0YW5jZVRvUGxhbmVGcm9tUG9zaXRpb25BbmROb3JtYWw9ZnVuY3Rpb24oZSx0LGkpe3ZhciByPS0odC54KmUueCt0LnkqZS55K3QueiplLnopO3JldHVybiBvLkRvdChpLHQpK3J9LGV9KCk7ZS5QbGFuZT1sO3ZhciB1PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlLHQsaSxyKXt0aGlzLng9ZSx0aGlzLnk9dCx0aGlzLndpZHRoPWksdGhpcy5oZWlnaHQ9cn1yZXR1cm4gZS5wcm90b3R5cGUudG9HbG9iYWw9ZnVuY3Rpb24odCxpKXtyZXR1cm4gbmV3IGUodGhpcy54KnQsdGhpcy55KmksdGhpcy53aWR0aCp0LHRoaXMuaGVpZ2h0KmkpfSxlfSgpO2UuVmlld3BvcnQ9dTt2YXIgZj1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoKXt9cmV0dXJuIGUuR2V0UGxhbmVzPWZ1bmN0aW9uKHQpe2Zvcih2YXIgaT1bXSxyPTA7Nj5yO3IrKylpLnB1c2gobmV3IGwoMCwwLDAsMCkpO3JldHVybiBlLkdldFBsYW5lc1RvUmVmKHQsaSksaX0sZS5HZXRQbGFuZXNUb1JlZj1mdW5jdGlvbihlLHQpe3RbMF0ubm9ybWFsLng9ZS5tWzNdK2UubVsyXSx0WzBdLm5vcm1hbC55PWUubVs3XStlLm1bNl0sdFswXS5ub3JtYWwuej1lLm1bMTFdK2UubVsxMF0sdFswXS5kPWUubVsxNV0rZS5tWzE0XSx0WzBdLm5vcm1hbGl6ZSgpLHRbMV0ubm9ybWFsLng9ZS5tWzNdLWUubVsyXSx0WzFdLm5vcm1hbC55PWUubVs3XS1lLm1bNl0sdFsxXS5ub3JtYWwuej1lLm1bMTFdLWUubVsxMF0sdFsxXS5kPWUubVsxNV0tZS5tWzE0XSx0WzFdLm5vcm1hbGl6ZSgpLHRbMl0ubm9ybWFsLng9ZS5tWzNdK2UubVswXSx0WzJdLm5vcm1hbC55PWUubVs3XStlLm1bNF0sdFsyXS5ub3JtYWwuej1lLm1bMTFdK2UubVs4XSx0WzJdLmQ9ZS5tWzE1XStlLm1bMTJdLHRbMl0ubm9ybWFsaXplKCksdFszXS5ub3JtYWwueD1lLm1bM10tZS5tWzBdLHRbM10ubm9ybWFsLnk9ZS5tWzddLWUubVs0XSx0WzNdLm5vcm1hbC56PWUubVsxMV0tZS5tWzhdLHRbM10uZD1lLm1bMTVdLWUubVsxMl0sdFszXS5ub3JtYWxpemUoKSx0WzRdLm5vcm1hbC54PWUubVszXS1lLm1bMV0sdFs0XS5ub3JtYWwueT1lLm1bN10tZS5tWzVdLHRbNF0ubm9ybWFsLno9ZS5tWzExXS1lLm1bOV0sdFs0XS5kPWUubVsxNV0tZS5tWzEzXSx0WzRdLm5vcm1hbGl6ZSgpLHRbNV0ubm9ybWFsLng9ZS5tWzNdK2UubVsxXSx0WzVdLm5vcm1hbC55PWUubVs3XStlLm1bNV0sdFs1XS5ub3JtYWwuej1lLm1bMTFdK2UubVs5XSx0WzVdLmQ9ZS5tWzE1XStlLm1bMTNdLHRbNV0ubm9ybWFsaXplKCl9LGV9KCk7ZS5GcnVzdHVtPWYsZnVuY3Rpb24oZSl7ZVtlLkxPQ0FMPTBdPVwiTE9DQUxcIixlW2UuV09STEQ9MV09XCJXT1JMRFwifShlLlNwYWNlfHwoZS5TcGFjZT17fSkpO3ZhciBkPShlLlNwYWNlLGZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSgpe31yZXR1cm4gZS5YPW5ldyBvKDEsMCwwKSxlLlk9bmV3IG8oMCwxLDApLGUuWj1uZXcgbygwLDAsMSksZX0oKSk7ZS5BeGlzPWQ7dmFyIHA9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7fXJldHVybiBlLmludGVycG9sYXRlPWZ1bmN0aW9uKGUsdCxpLHIsbil7Zm9yKHZhciBvPTEtMypyKzMqdCxzPTMqci02KnQsYT0zKnQsaD1lLGM9MDs1PmM7YysrKXt2YXIgbD1oKmgsdT1sKmgsZj1vKnUrcypsK2EqaCxkPTEvKDMqbypsKzIqcypoK2EpO2gtPShmLWUpKmQsaD1NYXRoLm1pbigxLE1hdGgubWF4KDAsaCkpfXJldHVybiAzKk1hdGgucG93KDEtaCwyKSpoKmkrMyooMS1oKSpNYXRoLnBvdyhoLDIpKm4rTWF0aC5wb3coaCwzKX0sZX0oKTtlLkJlemllckN1cnZlPXAsZnVuY3Rpb24oZSl7ZVtlLkNXPTBdPVwiQ1dcIixlW2UuQ0NXPTFdPVwiQ0NXXCJ9KGUuT3JpZW50YXRpb258fChlLk9yaWVudGF0aW9uPXt9KSk7dmFyIF89ZS5PcmllbnRhdGlvbixtPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlKXt2YXIgdD10aGlzO3RoaXMuZGVncmVlcz1mdW5jdGlvbigpe3JldHVybiAxODAqdC5fcmFkaWFucy9NYXRoLlBJfSx0aGlzLnJhZGlhbnM9ZnVuY3Rpb24oKXtyZXR1cm4gdC5fcmFkaWFuc30sdGhpcy5fcmFkaWFucz1lLHRoaXMuX3JhZGlhbnM8MCYmKHRoaXMuX3JhZGlhbnMrPTIqTWF0aC5QSSl9cmV0dXJuIGUuQmV0d2VlblR3b1BvaW50cz1mdW5jdGlvbih0LGkpe3ZhciByPWkuc3VidHJhY3QodCksbj1NYXRoLmF0YW4yKHIueSxyLngpO3JldHVybiBuZXcgZShuKX0sZS5Gcm9tUmFkaWFucz1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUodCl9LGUuRnJvbURlZ3JlZXM9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlKHQqTWF0aC5QSS8xODApfSxlfSgpO2UuQW5nbGU9bTt2YXIgZz1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSx0LGkpe3RoaXMuc3RhcnRQb2ludD1lLHRoaXMubWlkUG9pbnQ9dCx0aGlzLmVuZFBvaW50PWk7dmFyIHI9TWF0aC5wb3codC54LDIpK01hdGgucG93KHQueSwyKSxvPShNYXRoLnBvdyhlLngsMikrTWF0aC5wb3coZS55LDIpLXIpLzIscz0oci1NYXRoLnBvdyhpLngsMiktTWF0aC5wb3coaS55LDIpKS8yLGE9KGUueC10LngpKih0LnktaS55KS0odC54LWkueCkqKGUueS10LnkpO3RoaXMuY2VudGVyUG9pbnQ9bmV3IG4oKG8qKHQueS1pLnkpLXMqKGUueS10LnkpKS9hLCgoZS54LXQueCkqcy0odC54LWkueCkqbykvYSksdGhpcy5yYWRpdXM9dGhpcy5jZW50ZXJQb2ludC5zdWJ0cmFjdCh0aGlzLnN0YXJ0UG9pbnQpLmxlbmd0aCgpLHRoaXMuc3RhcnRBbmdsZT1tLkJldHdlZW5Ud29Qb2ludHModGhpcy5jZW50ZXJQb2ludCx0aGlzLnN0YXJ0UG9pbnQpO3ZhciBoPXRoaXMuc3RhcnRBbmdsZS5kZWdyZWVzKCksYz1tLkJldHdlZW5Ud29Qb2ludHModGhpcy5jZW50ZXJQb2ludCx0aGlzLm1pZFBvaW50KS5kZWdyZWVzKCksbD1tLkJldHdlZW5Ud29Qb2ludHModGhpcy5jZW50ZXJQb2ludCx0aGlzLmVuZFBvaW50KS5kZWdyZWVzKCk7Yy1oPjE4MCYmKGMtPTM2MCksLTE4MD5jLWgmJihjKz0zNjApLGwtYz4xODAmJihsLT0zNjApLC0xODA+bC1jJiYobCs9MzYwKSx0aGlzLm9yaWVudGF0aW9uPTA+Yy1oP18uQ1c6Xy5DQ1csdGhpcy5hbmdsZT1tLkZyb21EZWdyZWVzKHRoaXMub3JpZW50YXRpb249PT1fLkNXP2gtbDpsLWgpfXJldHVybiBlfSgpO2UuQXJjMj1nO3ZhciB2PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlLHQpe3RoaXMuX3BvaW50cz1uZXcgQXJyYXksdGhpcy5fbGVuZ3RoPTAsdGhpcy5jbG9zZWQ9ITEsdGhpcy5fcG9pbnRzLnB1c2gobmV3IG4oZSx0KSl9cmV0dXJuIGUucHJvdG90eXBlLmFkZExpbmVUbz1mdW5jdGlvbihlLHQpe2lmKGNsb3NlZClyZXR1cm4gdGhpczt2YXIgaT1uZXcgbihlLHQpLHI9dGhpcy5fcG9pbnRzW3RoaXMuX3BvaW50cy5sZW5ndGgtMV07cmV0dXJuIHRoaXMuX3BvaW50cy5wdXNoKGkpLHRoaXMuX2xlbmd0aCs9aS5zdWJ0cmFjdChyKS5sZW5ndGgoKSx0aGlzfSxlLnByb3RvdHlwZS5hZGRBcmNUbz1mdW5jdGlvbihlLHQsaSxyLG8pe2lmKHZvaWQgMD09PW8mJihvPTM2KSxjbG9zZWQpcmV0dXJuIHRoaXM7dmFyIHM9dGhpcy5fcG9pbnRzW3RoaXMuX3BvaW50cy5sZW5ndGgtMV0sYT1uZXcgbihlLHQpLGg9bmV3IG4oaSxyKSxjPW5ldyBnKHMsYSxoKSxsPWMuYW5nbGUucmFkaWFucygpL287Yy5vcmllbnRhdGlvbj09PV8uQ1cmJihsKj0tMSk7Zm9yKHZhciB1PWMuc3RhcnRBbmdsZS5yYWRpYW5zKCkrbCxmPTA7bz5mO2YrKyl7dmFyIGQ9TWF0aC5jb3ModSkqYy5yYWRpdXMrYy5jZW50ZXJQb2ludC54LHA9TWF0aC5zaW4odSkqYy5yYWRpdXMrYy5jZW50ZXJQb2ludC55O3RoaXMuYWRkTGluZVRvKGQscCksdSs9bH1yZXR1cm4gdGhpc30sZS5wcm90b3R5cGUuY2xvc2U9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jbG9zZWQ9ITAsdGhpc30sZS5wcm90b3R5cGUubGVuZ3RoPWZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5fbGVuZ3RoO2lmKCF0aGlzLmNsb3NlZCl7dmFyIHQ9dGhpcy5fcG9pbnRzW3RoaXMuX3BvaW50cy5sZW5ndGgtMV0saT10aGlzLl9wb2ludHNbMF07ZSs9aS5zdWJ0cmFjdCh0KS5sZW5ndGgoKX1yZXR1cm4gZX0sZS5wcm90b3R5cGUuZ2V0UG9pbnRzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3BvaW50c30sZS5wcm90b3R5cGUuZ2V0UG9pbnRBdExlbmd0aFBvc2l0aW9uPWZ1bmN0aW9uKGUpe2lmKDA+ZXx8ZT4xKXJldHVybiBuLlplcm8oKTtmb3IodmFyIHQ9ZSp0aGlzLmxlbmd0aCgpLGk9MCxyPTA7cjx0aGlzLl9wb2ludHMubGVuZ3RoO3IrKyl7dmFyIG89KHIrMSkldGhpcy5fcG9pbnRzLmxlbmd0aCxzPXRoaXMuX3BvaW50c1tyXSxhPXRoaXMuX3BvaW50c1tvXSxoPWEuc3VidHJhY3QocyksYz1oLmxlbmd0aCgpK2k7aWYodD49aSYmYz49dCl7dmFyIGw9aC5ub3JtYWxpemUoKSx1PXQtaTtyZXR1cm4gbmV3IG4ocy54K2wueCp1LHMueStsLnkqdSl9aT1jfXJldHVybiBuLlplcm8oKX0sZS5TdGFydGluZ0F0PWZ1bmN0aW9uKHQsaSl7cmV0dXJuIG5ldyBlKHQsaSl9LGV9KCk7ZS5QYXRoMj12O3ZhciB5PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gaShlLHQsaSl7dGhpcy5wYXRoPWUsdGhpcy5fY3VydmU9bmV3IEFycmF5LHRoaXMuX2Rpc3RhbmNlcz1uZXcgQXJyYXksdGhpcy5fdGFuZ2VudHM9bmV3IEFycmF5LHRoaXMuX25vcm1hbHM9bmV3IEFycmF5LHRoaXMuX2Jpbm9ybWFscz1uZXcgQXJyYXk7Zm9yKHZhciByPTA7cjxlLmxlbmd0aDtyKyspdGhpcy5fY3VydmVbcl09ZVtyXS5jbG9uZSgpO3RoaXMuX3Jhdz1pfHwhMSx0aGlzLl9jb21wdXRlKHQpfXJldHVybiBpLnByb3RvdHlwZS5nZXRDdXJ2ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9jdXJ2ZX0saS5wcm90b3R5cGUuZ2V0VGFuZ2VudHM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fdGFuZ2VudHN9LGkucHJvdG90eXBlLmdldE5vcm1hbHM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fbm9ybWFsc30saS5wcm90b3R5cGUuZ2V0Qmlub3JtYWxzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2Jpbm9ybWFsc30saS5wcm90b3R5cGUuZ2V0RGlzdGFuY2VzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2Rpc3RhbmNlc30saS5wcm90b3R5cGUudXBkYXRlPWZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBpPTA7aTxlLmxlbmd0aDtpKyspdGhpcy5fY3VydmVbaV0ueD1lW2ldLngsdGhpcy5fY3VydmVbaV0ueT1lW2ldLnksdGhpcy5fY3VydmVbaV0uej1lW2ldLno7cmV0dXJuIHRoaXMuX2NvbXB1dGUodCksdGhpc30saS5wcm90b3R5cGUuX2NvbXB1dGU9ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5fY3VydmUubGVuZ3RoO3RoaXMuX3RhbmdlbnRzWzBdPXRoaXMuX2dldEZpcnN0Tm9uTnVsbFZlY3RvcigwKSx0aGlzLl9yYXd8fHRoaXMuX3RhbmdlbnRzWzBdLm5vcm1hbGl6ZSgpLHRoaXMuX3RhbmdlbnRzW3QtMV09dGhpcy5fY3VydmVbdC0xXS5zdWJ0cmFjdCh0aGlzLl9jdXJ2ZVt0LTJdKSx0aGlzLl9yYXd8fHRoaXMuX3RhbmdlbnRzW3QtMV0ubm9ybWFsaXplKCk7dmFyIGk9dGhpcy5fdGFuZ2VudHNbMF0scj10aGlzLl9ub3JtYWxWZWN0b3IodGhpcy5fY3VydmVbMF0saSxlKTt0aGlzLl9ub3JtYWxzWzBdPXIsdGhpcy5fcmF3fHx0aGlzLl9ub3JtYWxzWzBdLm5vcm1hbGl6ZSgpLHRoaXMuX2Jpbm9ybWFsc1swXT1vLkNyb3NzKGksdGhpcy5fbm9ybWFsc1swXSksdGhpcy5fcmF3fHx0aGlzLl9iaW5vcm1hbHNbMF0ubm9ybWFsaXplKCksdGhpcy5fZGlzdGFuY2VzWzBdPTA7Zm9yKHZhciBuLHMsYSxoLGM9MTt0PmM7YysrKW49dGhpcy5fZ2V0TGFzdE5vbk51bGxWZWN0b3IoYyksdC0xPmMmJihzPXRoaXMuX2dldEZpcnN0Tm9uTnVsbFZlY3RvcihjKSx0aGlzLl90YW5nZW50c1tjXT1uLmFkZChzKSx0aGlzLl90YW5nZW50c1tjXS5ub3JtYWxpemUoKSksdGhpcy5fZGlzdGFuY2VzW2NdPXRoaXMuX2Rpc3RhbmNlc1tjLTFdK24ubGVuZ3RoKCksYT10aGlzLl90YW5nZW50c1tjXSxoPXRoaXMuX2Jpbm9ybWFsc1tjLTFdLHRoaXMuX25vcm1hbHNbY109by5Dcm9zcyhoLGEpLHRoaXMuX3Jhd3x8dGhpcy5fbm9ybWFsc1tjXS5ub3JtYWxpemUoKSx0aGlzLl9iaW5vcm1hbHNbY109by5Dcm9zcyhhLHRoaXMuX25vcm1hbHNbY10pLHRoaXMuX3Jhd3x8dGhpcy5fYmlub3JtYWxzW2NdLm5vcm1hbGl6ZSgpfSxpLnByb3RvdHlwZS5fZ2V0Rmlyc3ROb25OdWxsVmVjdG9yPWZ1bmN0aW9uKGUpe2Zvcih2YXIgdD0xLGk9dGhpcy5fY3VydmVbZSt0XS5zdWJ0cmFjdCh0aGlzLl9jdXJ2ZVtlXSk7MD09PWkubGVuZ3RoKCkmJmUrdCsxPHRoaXMuX2N1cnZlLmxlbmd0aDspdCsrLGk9dGhpcy5fY3VydmVbZSt0XS5zdWJ0cmFjdCh0aGlzLl9jdXJ2ZVtlXSk7cmV0dXJuIGl9LGkucHJvdG90eXBlLl9nZXRMYXN0Tm9uTnVsbFZlY3Rvcj1mdW5jdGlvbihlKXtmb3IodmFyIHQ9MSxpPXRoaXMuX2N1cnZlW2VdLnN1YnRyYWN0KHRoaXMuX2N1cnZlW2UtdF0pOzA9PT1pLmxlbmd0aCgpJiZlPnQrMTspdCsrLGk9dGhpcy5fY3VydmVbZV0uc3VidHJhY3QodGhpcy5fY3VydmVbZS10XSk7cmV0dXJuIGl9LGkucHJvdG90eXBlLl9ub3JtYWxWZWN0b3I9ZnVuY3Rpb24oaSxyLG4pe3ZhciBzO2lmKHZvaWQgMD09PW58fG51bGw9PT1uKXt2YXIgYTt0LldpdGhpbkVwc2lsb24oci55LDEsZS5FcHNpbG9uKT90LldpdGhpbkVwc2lsb24oci54LDEsZS5FcHNpbG9uKT90LldpdGhpbkVwc2lsb24oci56LDEsZS5FcHNpbG9uKXx8KGE9bmV3IG8oMCwwLDEpKTphPW5ldyBvKDEsMCwwKTphPW5ldyBvKDAsLTEsMCkscz1vLkNyb3NzKHIsYSl9ZWxzZSBzPW8uQ3Jvc3MocixuKSxvLkNyb3NzVG9SZWYocyxyLHMpO3JldHVybiBzLm5vcm1hbGl6ZSgpLHN9LGl9KCk7ZS5QYXRoM0Q9eTt2YXIgeD1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSl7dGhpcy5fbGVuZ3RoPTAsdGhpcy5fcG9pbnRzPWUsdGhpcy5fbGVuZ3RoPXRoaXMuX2NvbXB1dGVMZW5ndGgoZSl9cmV0dXJuIGUuQ3JlYXRlUXVhZHJhdGljQmV6aWVyPWZ1bmN0aW9uKHQsaSxyLG4pe249bj4yP246Mztmb3IodmFyIHM9bmV3IEFycmF5LGE9ZnVuY3Rpb24oZSx0LGkscil7dmFyIG49KDEtZSkqKDEtZSkqdCsyKmUqKDEtZSkqaStlKmUqcjtyZXR1cm4gbn0saD0wO24+PWg7aCsrKXMucHVzaChuZXcgbyhhKGgvbix0LngsaS54LHIueCksYShoL24sdC55LGkueSxyLnkpLGEoaC9uLHQueixpLnosci56KSkpO3JldHVybiBuZXcgZShzKX0sZS5DcmVhdGVDdWJpY0Jlemllcj1mdW5jdGlvbih0LGkscixuLHMpe3M9cz4zP3M6NDtmb3IodmFyIGE9bmV3IEFycmF5LGg9ZnVuY3Rpb24oZSx0LGkscixuKXt2YXIgbz0oMS1lKSooMS1lKSooMS1lKSp0KzMqZSooMS1lKSooMS1lKSppKzMqZSplKigxLWUpKnIrZSplKmUqbjtyZXR1cm4gb30sYz0wO3M+PWM7YysrKWEucHVzaChuZXcgbyhoKGMvcyx0LngsaS54LHIueCxuLngpLGgoYy9zLHQueSxpLnksci55LG4ueSksaChjL3MsdC56LGkueixyLnosbi56KSkpO3JldHVybiBuZXcgZShhKX0sZS5DcmVhdGVIZXJtaXRlU3BsaW5lPWZ1bmN0aW9uKHQsaSxyLG4scyl7Zm9yKHZhciBhPW5ldyBBcnJheSxoPTEvcyxjPTA7cz49YztjKyspYS5wdXNoKG8uSGVybWl0ZSh0LGkscixuLGMqaCkpO3JldHVybiBuZXcgZShhKX0sZS5wcm90b3R5cGUuZ2V0UG9pbnRzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3BvaW50c30sZS5wcm90b3R5cGUubGVuZ3RoPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2xlbmd0aH0sZS5wcm90b3R5cGVbXCJjb250aW51ZVwiXT1mdW5jdGlvbih0KXtmb3IodmFyIGk9dGhpcy5fcG9pbnRzW3RoaXMuX3BvaW50cy5sZW5ndGgtMV0scj10aGlzLl9wb2ludHMuc2xpY2UoKSxuPXQuZ2V0UG9pbnRzKCksbz0xO288bi5sZW5ndGg7bysrKXIucHVzaChuW29dLnN1YnRyYWN0KG5bMF0pLmFkZChpKSk7dmFyIHM9bmV3IGUocik7cmV0dXJuIHN9LGUucHJvdG90eXBlLl9jb21wdXRlTGVuZ3RoPWZ1bmN0aW9uKGUpe2Zvcih2YXIgdD0wLGk9MTtpPGUubGVuZ3RoO2krKyl0Kz1lW2ldLnN1YnRyYWN0KGVbaS0xXSkubGVuZ3RoKCk7cmV0dXJuIHR9LGV9KCk7ZS5DdXJ2ZTM9eDt2YXIgYj1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoKXt0aGlzLkwwMD1vLlplcm8oKSx0aGlzLkwxXzE9by5aZXJvKCksdGhpcy5MMTA9by5aZXJvKCksdGhpcy5MMTE9by5aZXJvKCksdGhpcy5MMl8yPW8uWmVybygpLHRoaXMuTDJfMT1vLlplcm8oKSx0aGlzLkwyMD1vLlplcm8oKSx0aGlzLkwyMT1vLlplcm8oKSx0aGlzLkwyMj1vLlplcm8oKX1yZXR1cm4gZS5wcm90b3R5cGUuYWRkTGlnaHQ9ZnVuY3Rpb24oZSx0LGkpe3ZhciByPW5ldyBvKHQucix0LmcsdC5iKSxuPXIuc2NhbGUoaSk7dGhpcy5MMDA9dGhpcy5MMDAuYWRkKG4uc2NhbGUoLjI4MjA5NSkpLHRoaXMuTDFfMT10aGlzLkwxXzEuYWRkKG4uc2NhbGUoLjQ4ODYwMyplLnkpKSx0aGlzLkwxMD10aGlzLkwxMC5hZGQobi5zY2FsZSguNDg4NjAzKmUueikpLHRoaXMuTDExPXRoaXMuTDExLmFkZChuLnNjYWxlKC40ODg2MDMqZS54KSksdGhpcy5MMl8yPXRoaXMuTDJfMi5hZGQobi5zY2FsZSgxLjA5MjU0OCplLngqZS55KSksdGhpcy5MMl8xPXRoaXMuTDJfMS5hZGQobi5zY2FsZSgxLjA5MjU0OCplLnkqZS56KSksdGhpcy5MMjE9dGhpcy5MMjEuYWRkKG4uc2NhbGUoMS4wOTI1NDgqZS54KmUueikpLHRoaXMuTDIwPXRoaXMuTDIwLmFkZChuLnNjYWxlKC4zMTUzOTIqKDMqZS56KmUuei0xKSkpLHRoaXMuTDIyPXRoaXMuTDIyLmFkZChuLnNjYWxlKC41NDYyNzQqKGUueCplLngtZS55KmUueSkpKX0sZS5wcm90b3R5cGUuc2NhbGU9ZnVuY3Rpb24oZSl7dGhpcy5MMDA9dGhpcy5MMDAuc2NhbGUoZSksdGhpcy5MMV8xPXRoaXMuTDFfMS5zY2FsZShlKSx0aGlzLkwxMD10aGlzLkwxMC5zY2FsZShlKSx0aGlzLkwxMT10aGlzLkwxMS5zY2FsZShlKSx0aGlzLkwyXzI9dGhpcy5MMl8yLnNjYWxlKGUpLHRoaXMuTDJfMT10aGlzLkwyXzEuc2NhbGUoZSksdGhpcy5MMjA9dGhpcy5MMjAuc2NhbGUoZSksdGhpcy5MMjE9dGhpcy5MMjEuc2NhbGUoZSksdGhpcy5MMjI9dGhpcy5MMjIuc2NhbGUoZSl9LGV9KCk7ZS5TcGhlcmljYWxIYXJtb25pY3M9Yjt2YXIgUD1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoKXt0aGlzLng9by5aZXJvKCksdGhpcy55PW8uWmVybygpLHRoaXMuej1vLlplcm8oKSx0aGlzLnh4PW8uWmVybygpLHRoaXMueXk9by5aZXJvKCksdGhpcy56ej1vLlplcm8oKSx0aGlzLnh5PW8uWmVybygpLHRoaXMueXo9by5aZXJvKCksdGhpcy56eD1vLlplcm8oKX1yZXR1cm4gZS5wcm90b3R5cGUuYWRkQW1iaWVudD1mdW5jdGlvbihlKXt2YXIgdD1uZXcgbyhlLnIsZS5nLGUuYik7dGhpcy54eD10aGlzLnh4LmFkZCh0KSx0aGlzLnl5PXRoaXMueXkuYWRkKHQpLHRoaXMueno9dGhpcy56ei5hZGQodCl9LGUuZ2V0U3BoZXJpY2FsUG9seW5vbWlhbEZyb21IYXJtb25pY3M9ZnVuY3Rpb24odCl7dmFyIGk9bmV3IGU7cmV0dXJuIGkueD10LkwxMS5zY2FsZSgxLjAyMzMzKSxpLnk9dC5MMV8xLnNjYWxlKDEuMDIzMzMpLGkuej10LkwxMC5zY2FsZSgxLjAyMzMzKSxpLnh4PXQuTDAwLnNjYWxlKC44ODYyNzcpLnN1YnRyYWN0KHQuTDIwLnNjYWxlKC4yNDc3MDgpKS5hZGQodC5MMjIuc2NhbGUoLjQyOTA0MykpLGkueXk9dC5MMDAuc2NhbGUoLjg4NjI3Nykuc3VidHJhY3QodC5MMjAuc2NhbGUoLjI0NzcwOCkpLnN1YnRyYWN0KHQuTDIyLnNjYWxlKC40MjkwNDMpKSxpLnp6PXQuTDAwLnNjYWxlKC44ODYyNzcpLmFkZCh0LkwyMC5zY2FsZSguNDk1NDE3KSksaS55ej10LkwyXzEuc2NhbGUoLjg1ODA4NiksaS56eD10LkwyMS5zY2FsZSguODU4MDg2KSxpLnh5PXQuTDJfMi5zY2FsZSguODU4MDg2KSxpfSxlfSgpO2UuU3BoZXJpY2FsUG9seW5vbWlhbD1QO3ZhciBBPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlLHQpe3ZvaWQgMD09PWUmJihlPW8uWmVybygpKSx2b2lkIDA9PT10JiYodD1vLlVwKCkpLHRoaXMucG9zaXRpb249ZSx0aGlzLm5vcm1hbD10fXJldHVybiBlLnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbigpe3JldHVybiBuZXcgZSh0aGlzLnBvc2l0aW9uLmNsb25lKCksdGhpcy5ub3JtYWwuY2xvbmUoKSl9LGV9KCk7ZS5Qb3NpdGlvbk5vcm1hbFZlcnRleD1BO3ZhciBUPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlLHQsaSl7dm9pZCAwPT09ZSYmKGU9by5aZXJvKCkpLHZvaWQgMD09PXQmJih0PW8uVXAoKSksdm9pZCAwPT09aSYmKGk9bi5aZXJvKCkpLHRoaXMucG9zaXRpb249ZSx0aGlzLm5vcm1hbD10LHRoaXMudXY9aX1yZXR1cm4gZS5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGUodGhpcy5wb3NpdGlvbi5jbG9uZSgpLHRoaXMubm9ybWFsLmNsb25lKCksdGhpcy51di5jbG9uZSgpKX0sZX0oKTtlLlBvc2l0aW9uTm9ybWFsVGV4dHVyZVZlcnRleD1UO3ZhciBFPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSgpe31yZXR1cm4gZS5Db2xvcjM9W2kuQmxhY2soKSxpLkJsYWNrKCksaS5CbGFjaygpXSxlLlZlY3RvcjI9W24uWmVybygpLG4uWmVybygpLG4uWmVybygpXSxlLlZlY3RvcjM9W28uWmVybygpLG8uWmVybygpLG8uWmVybygpLG8uWmVybygpLG8uWmVybygpLG8uWmVybygpLG8uWmVybygpLG8uWmVybygpLG8uWmVybygpXSxlLlZlY3RvcjQ9W3MuWmVybygpLHMuWmVybygpLHMuWmVybygpXSxlLlF1YXRlcm5pb249W25ldyBoKDAsMCwwLDApXSxlLk1hdHJpeD1bYy5aZXJvKCksYy5aZXJvKCksYy5aZXJvKCksYy5aZXJvKCksYy5aZXJvKCksYy5aZXJvKCksYy5aZXJvKCksYy5aZXJvKCldLGV9KCk7ZS5UbXA9RX0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdChlLHQpe3JldHVybiBmdW5jdGlvbihpLHIpe2kuX19zZXJpYWxpemFibGVNZW1iZXJzfHwoaS5fX3NlcmlhbGl6YWJsZU1lbWJlcnM9e30pLGkuX19zZXJpYWxpemFibGVNZW1iZXJzW3JdPXt0eXBlOmUsc291cmNlTmFtZTp0fX19ZnVuY3Rpb24gaShlKXtyZXR1cm4gdCgwLGUpfWZ1bmN0aW9uIHIoZSl7cmV0dXJuIHQoMSxlKX1mdW5jdGlvbiBuKGUpe3JldHVybiB0KDIsZSl9ZnVuY3Rpb24gbyhlKXtyZXR1cm4gdCgzLGUpfWZ1bmN0aW9uIHMoZSl7cmV0dXJuIHQoNCxlKX1mdW5jdGlvbiBhKGUpe3JldHVybiB0KDUsZSl9ZnVuY3Rpb24gaChlKXtyZXR1cm4gdCg2LGUpfWZ1bmN0aW9uIGMoZSl7cmV0dXJuIHQoNyxlKX1lLnNlcmlhbGl6ZT1pLGUuc2VyaWFsaXplQXNUZXh0dXJlPXIsZS5zZXJpYWxpemVBc0NvbG9yMz1uLGUuc2VyaWFsaXplQXNGcmVzbmVsUGFyYW1ldGVycz1vLGUuc2VyaWFsaXplQXNWZWN0b3IyPXMsZS5zZXJpYWxpemVBc1ZlY3RvcjM9YSxlLnNlcmlhbGl6ZUFzTWVzaFJlZmVyZW5jZT1oLGUuc2VyaWFsaXplQXNDb2xvckN1cnZlcz1jO3ZhciBsPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCgpe31yZXR1cm4gdC5TZXJpYWxpemU9ZnVuY3Rpb24odCxpKXtpfHwoaT17fSksaS50YWdzPWUuVGFncy5HZXRUYWdzKHQpO2Zvcih2YXIgciBpbiB0Ll9fc2VyaWFsaXphYmxlTWVtYmVycyl7dmFyIG49dC5fX3NlcmlhbGl6YWJsZU1lbWJlcnNbcl0sbz1uLnNvdXJjZU5hbWV8fHIscz1uLnR5cGUsYT10W3JdO2lmKHZvaWQgMCE9PWEmJm51bGwhPT1hKXN3aXRjaChzKXtjYXNlIDA6aVtvXT1hO2JyZWFrO2Nhc2UgMTppW29dPWEuc2VyaWFsaXplKCk7YnJlYWs7Y2FzZSAyOmlbb109YS5hc0FycmF5KCk7YnJlYWs7Y2FzZSAzOmlbb109YS5zZXJpYWxpemUoKTticmVhaztjYXNlIDQ6aVtvXT1hLmFzQXJyYXkoKTticmVhaztjYXNlIDU6aVtvXT1hLmFzQXJyYXkoKTticmVhaztjYXNlIDY6aVtvXT1hLmlkO2JyZWFrO2Nhc2UgNzppW29dPWEuc2VyaWFsaXplKCl9fXJldHVybiBpfSx0LlBhcnNlPWZ1bmN0aW9uKHQsaSxyLG4pe3ZhciBvPXQoKTtlLlRhZ3MuQWRkVGFnc1RvKG8saS50YWdzKTtmb3IodmFyIHMgaW4gby5fX3NlcmlhbGl6YWJsZU1lbWJlcnMpe3ZhciBhPW8uX19zZXJpYWxpemFibGVNZW1iZXJzW3NdLGg9aVthLnNvdXJjZU5hbWV8fHNdLGM9YS50eXBlO2lmKHZvaWQgMCE9PWgmJm51bGwhPT1oKXN3aXRjaChjKXtjYXNlIDA6b1tzXT1oO2JyZWFrO2Nhc2UgMTpvW3NdPWUuVGV4dHVyZS5QYXJzZShoLHIsbik7YnJlYWs7Y2FzZSAyOm9bc109ZS5Db2xvcjMuRnJvbUFycmF5KGgpO2JyZWFrO2Nhc2UgMzpvW3NdPWUuRnJlc25lbFBhcmFtZXRlcnMuUGFyc2UoaCk7YnJlYWs7Y2FzZSA0Om9bc109ZS5WZWN0b3IyLkZyb21BcnJheShoKTticmVhaztjYXNlIDU6b1tzXT1lLlZlY3RvcjMuRnJvbUFycmF5KGgpO2JyZWFrO2Nhc2UgNjpvW3NdPXIuZ2V0TGFzdE1lc2hCeUlEKGgpO2JyZWFrO2Nhc2UgNzpvW3NdPWUuQ29sb3JDdXJ2ZXMuUGFyc2UoaCl9fXJldHVybiBvfSx0LkNsb25lPWZ1bmN0aW9uKHQsaSl7dmFyIHI9dCgpO2UuVGFncy5BZGRUYWdzVG8ocixpLnRhZ3MpO2Zvcih2YXIgbiBpbiByLl9fc2VyaWFsaXphYmxlTWVtYmVycyl7dmFyIG89ci5fX3NlcmlhbGl6YWJsZU1lbWJlcnNbbl0scz1pW25dLGE9by50eXBlO2lmKHZvaWQgMCE9PXMmJm51bGwhPT1zKXN3aXRjaChhKXtjYXNlIDA6Y2FzZSA2OnJbbl09czticmVhaztjYXNlIDE6Y2FzZSAyOmNhc2UgMzpjYXNlIDQ6Y2FzZSA1OmNhc2UgNzpyW25dPXMuY2xvbmUoKX19cmV0dXJuIHJ9LHR9KCk7ZS5TZXJpYWxpemF0aW9uSGVscGVyPWx9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlLHQpe3ZvaWQgMD09PXQmJih0PSExKSx0aGlzLm1hc2s9ZSx0aGlzLnNraXBOZXh0T2JzZXJ2ZXJzPXR9cmV0dXJuIGV9KCk7ZS5FdmVudFN0YXRlPXQ7dmFyIGk9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUsdCl7dGhpcy5jYWxsYmFjaz1lLHRoaXMubWFzaz10fXJldHVybiBlfSgpO2UuT2JzZXJ2ZXI9aTt2YXIgcj1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoKXt0aGlzLl9vYnNlcnZlcnM9bmV3IEFycmF5fXJldHVybiBlLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oZSx0LHIpe2lmKHZvaWQgMD09PXQmJih0PS0xKSx2b2lkIDA9PT1yJiYocj0hMSksIWUpcmV0dXJuIG51bGw7dmFyIG49bmV3IGkoZSx0KTtyZXR1cm4gcj90aGlzLl9vYnNlcnZlcnMudW5zaGlmdChuKTp0aGlzLl9vYnNlcnZlcnMucHVzaChuKSxufSxlLnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5fb2JzZXJ2ZXJzLmluZGV4T2YoZSk7cmV0dXJuLTEhPT10Pyh0aGlzLl9vYnNlcnZlcnMuc3BsaWNlKHQsMSksITApOiExfSxlLnByb3RvdHlwZS5yZW1vdmVDYWxsYmFjaz1mdW5jdGlvbihlKXtmb3IodmFyIHQ9MDt0PHRoaXMuX29ic2VydmVycy5sZW5ndGg7dCsrKWlmKHRoaXMuX29ic2VydmVyc1t0XS5jYWxsYmFjaz09PWUpcmV0dXJuIHRoaXMuX29ic2VydmVycy5zcGxpY2UodCwxKSwhMDtyZXR1cm4hMX0sZS5wcm90b3R5cGUubm90aWZ5T2JzZXJ2ZXJzPWZ1bmN0aW9uKGUsaSl7dm9pZCAwPT09aSYmKGk9LTEpO2Zvcih2YXIgcj1uZXcgdChpKSxuPTAsbz10aGlzLl9vYnNlcnZlcnM7bjxvLmxlbmd0aDtuKyspe3ZhciBzPW9bbl07aWYocy5tYXNrJmkmJnMuY2FsbGJhY2soZSxyKSxyLnNraXBOZXh0T2JzZXJ2ZXJzKWJyZWFrfX0sZS5wcm90b3R5cGUuaGFzT2JzZXJ2ZXJzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX29ic2VydmVycy5sZW5ndGg+MH0sZS5wcm90b3R5cGUuY2xlYXI9ZnVuY3Rpb24oKXt0aGlzLl9vYnNlcnZlcnM9bmV3IEFycmF5fSxlLnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbigpe3ZhciB0PW5ldyBlO3JldHVybiB0Ll9vYnNlcnZlcnM9dGhpcy5fb2JzZXJ2ZXJzLnNsaWNlKDApLHR9LGV9KCk7ZS5PYnNlcnZhYmxlPXJ9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdChlLGkpe3RoaXMuaWRiRmFjdG9yeT13aW5kb3cuaW5kZXhlZERCfHx3aW5kb3cubW96SW5kZXhlZERCfHx3aW5kb3cud2Via2l0SW5kZXhlZERCfHx3aW5kb3cubXNJbmRleGVkREIsdGhpcy5jYWxsYmFja01hbmlmZXN0Q2hlY2tlZD1pLHRoaXMuY3VycmVudFNjZW5lVXJsPXQuUmV0dXJuRnVsbFVybExvY2F0aW9uKGUpLHRoaXMuZGI9bnVsbCx0aGlzLmVuYWJsZVNjZW5lT2ZmbGluZT0hMSx0aGlzLmVuYWJsZVRleHR1cmVzT2ZmbGluZT0hMSx0aGlzLm1hbmlmZXN0VmVyc2lvbkZvdW5kPTAsdGhpcy5tdXN0VXBkYXRlUmVzc291cmNlcz0hMSx0aGlzLmhhc1JlYWNoZWRRdW90YT0hMSx0LklEQlN0b3JhZ2VFbmFibGVkP3RoaXMuY2hlY2tNYW5pZmVzdEZpbGUoKTp0aGlzLmNhbGxiYWNrTWFuaWZlc3RDaGVja2VkKCEwKX1yZXR1cm4gdC5wcm90b3R5cGUuY2hlY2tNYW5pZmVzdEZpbGU9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KCl7ci5lbmFibGVTY2VuZU9mZmxpbmU9ITEsci5lbmFibGVUZXh0dXJlc09mZmxpbmU9ITEsci5jYWxsYmFja01hbmlmZXN0Q2hlY2tlZCghMSl9dmFyIGk9dGhpcyxyPXRoaXMsbj0hMSxvPXRoaXMuY3VycmVudFNjZW5lVXJsK1wiLm1hbmlmZXN0XCIscz1uZXcgWE1MSHR0cFJlcXVlc3Q7bmF2aWdhdG9yLm9uTGluZSYmKG49ITAsbz1vKyhudWxsPT1vLm1hdGNoKC9cXD8vKT9cIj9cIjpcIiZcIikrKG5ldyBEYXRlKS5nZXRUaW1lKCkpLHMub3BlbihcIkdFVFwiLG8sITApLHMuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIixmdW5jdGlvbigpe2lmKDIwMD09PXMuc3RhdHVzfHxlLlRvb2xzLlZhbGlkYXRlWEhSRGF0YShzLDEpKXRyeXt2YXIgcj1KU09OLnBhcnNlKHMucmVzcG9uc2UpO2kuZW5hYmxlU2NlbmVPZmZsaW5lPXIuZW5hYmxlU2NlbmVPZmZsaW5lLGkuZW5hYmxlVGV4dHVyZXNPZmZsaW5lPXIuZW5hYmxlVGV4dHVyZXNPZmZsaW5lLHIudmVyc2lvbiYmIWlzTmFOKHBhcnNlSW50KHIudmVyc2lvbikpJiYoaS5tYW5pZmVzdFZlcnNpb25Gb3VuZD1yLnZlcnNpb24pLGkuY2FsbGJhY2tNYW5pZmVzdENoZWNrZWQmJmkuY2FsbGJhY2tNYW5pZmVzdENoZWNrZWQoITApfWNhdGNoKG4pe3QoKX1lbHNlIHQoKX0sITEpLHMuYWRkRXZlbnRMaXN0ZW5lcihcImVycm9yXCIsZnVuY3Rpb24oZSl7aWYobil7bj0hMTt2YXIgcj1pLmN1cnJlbnRTY2VuZVVybCtcIi5tYW5pZmVzdFwiO3Mub3BlbihcIkdFVFwiLHIsITApLHMuc2VuZCgpfWVsc2UgdCgpfSwhMSk7dHJ5e3Muc2VuZCgpfWNhdGNoKGEpe2UuVG9vbHMuRXJyb3IoXCJFcnJvciBvbiBYSFIgc2VuZCByZXF1ZXN0LlwiKSxyLmNhbGxiYWNrTWFuaWZlc3RDaGVja2VkKCExKX19LHQucHJvdG90eXBlLm9wZW5Bc3luYz1mdW5jdGlvbih0LGkpe2Z1bmN0aW9uIHIoKXtvLmlzU3VwcG9ydGVkPSExLGkmJmkoKX12YXIgbj10aGlzLG89dGhpcztpZih0aGlzLmlkYkZhY3RvcnkmJih0aGlzLmVuYWJsZVNjZW5lT2ZmbGluZXx8dGhpcy5lbmFibGVUZXh0dXJlc09mZmxpbmUpKWlmKHRoaXMuZGIpdCYmdCgpO2Vsc2V7dGhpcy5oYXNSZWFjaGVkUXVvdGE9ITEsdGhpcy5pc1N1cHBvcnRlZD0hMDt2YXIgcz10aGlzLmlkYkZhY3Rvcnkub3BlbihcImJhYnlsb25qc1wiLDEpO3Mub25lcnJvcj1mdW5jdGlvbihlKXtyKCl9LHMub25ibG9ja2VkPWZ1bmN0aW9uKHQpe2UuVG9vbHMuRXJyb3IoXCJJREIgcmVxdWVzdCBibG9ja2VkLiBQbGVhc2UgcmVsb2FkIHRoZSBwYWdlLlwiKSxyKCl9LHMub25zdWNjZXNzPWZ1bmN0aW9uKGUpe24uZGI9cy5yZXN1bHQsdCgpfSxzLm9udXBncmFkZW5lZWRlZD1mdW5jdGlvbih0KXtuLmRiPXQudGFyZ2V0LnJlc3VsdDt0cnl7bi5kYi5jcmVhdGVPYmplY3RTdG9yZShcInNjZW5lc1wiLHtrZXlQYXRoOlwic2NlbmVVcmxcIn0pLG4uZGIuY3JlYXRlT2JqZWN0U3RvcmUoXCJ2ZXJzaW9uc1wiLHtrZXlQYXRoOlwic2NlbmVVcmxcIn0pLG4uZGIuY3JlYXRlT2JqZWN0U3RvcmUoXCJ0ZXh0dXJlc1wiLHtrZXlQYXRoOlwidGV4dHVyZVVybFwifSl9Y2F0Y2goaSl7ZS5Ub29scy5FcnJvcihcIkVycm9yIHdoaWxlIGNyZWF0aW5nIG9iamVjdCBzdG9yZXMuIEV4Y2VwdGlvbjogXCIraS5tZXNzYWdlKSxyKCl9fX1lbHNlIHRoaXMuaXNTdXBwb3J0ZWQ9ITEsaSYmaSgpfSx0LnByb3RvdHlwZS5sb2FkSW1hZ2VGcm9tREI9ZnVuY3Rpb24oZSxpKXt2YXIgcj10aGlzLG49dC5SZXR1cm5GdWxsVXJsTG9jYXRpb24oZSksbz1mdW5jdGlvbigpe3IuaGFzUmVhY2hlZFF1b3RhfHxudWxsPT09ci5kYj9pLnNyYz1lOnIuX3NhdmVJbWFnZUludG9EQkFzeW5jKG4saSl9O3RoaXMubXVzdFVwZGF0ZVJlc3NvdXJjZXM/bygpOnRoaXMuX2xvYWRJbWFnZUZyb21EQkFzeW5jKG4saSxvKX0sdC5wcm90b3R5cGUuX2xvYWRJbWFnZUZyb21EQkFzeW5jPWZ1bmN0aW9uKHQsaSxyKXtpZih0aGlzLmlzU3VwcG9ydGVkJiZudWxsIT09dGhpcy5kYil7dmFyIG4sbz10aGlzLmRiLnRyYW5zYWN0aW9uKFtcInRleHR1cmVzXCJdKTtvLm9uYWJvcnQ9ZnVuY3Rpb24oZSl7aS5zcmM9dH0sby5vbmNvbXBsZXRlPWZ1bmN0aW9uKG8pe3ZhciBzO2lmKG4pe3ZhciBhPXdpbmRvdy5VUkx8fHdpbmRvdy53ZWJraXRVUkw7cz1hLmNyZWF0ZU9iamVjdFVSTChuLmRhdGEse29uZVRpbWVPbmx5OiEwfSksaS5vbmVycm9yPWZ1bmN0aW9uKCl7ZS5Ub29scy5FcnJvcihcIkVycm9yIGxvYWRpbmcgaW1hZ2UgZnJvbSBibG9iIFVSTDogXCIrcytcIiBzd2l0Y2hpbmcgYmFjayB0byB3ZWIgdXJsOiBcIit0KSxpLnNyYz10fSxpLnNyYz1zfWVsc2UgcigpfTt2YXIgcz1vLm9iamVjdFN0b3JlKFwidGV4dHVyZXNcIikuZ2V0KHQpO3Mub25zdWNjZXNzPWZ1bmN0aW9uKGUpe249ZS50YXJnZXQucmVzdWx0fSxzLm9uZXJyb3I9ZnVuY3Rpb24ocil7ZS5Ub29scy5FcnJvcihcIkVycm9yIGxvYWRpbmcgdGV4dHVyZSBcIit0K1wiIGZyb20gREIuXCIpLGkuc3JjPXR9fWVsc2UgZS5Ub29scy5FcnJvcihcIkVycm9yOiBJbmRleGVkREIgbm90IHN1cHBvcnRlZCBieSB5b3VyIGJyb3dzZXIgb3IgQmFieWxvbkpTIERhdGFiYXNlIGlzIG5vdCBvcGVuLlwiKSxpLnNyYz10fSx0LnByb3RvdHlwZS5fc2F2ZUltYWdlSW50b0RCQXN5bmM9ZnVuY3Rpb24oaSxyKXt2YXIgbj10aGlzO2lmKHRoaXMuaXNTdXBwb3J0ZWQpe3ZhciBvPWZ1bmN0aW9uKCl7dmFyIGU7aWYocyl7dmFyIHQ9d2luZG93LlVSTHx8d2luZG93LndlYmtpdFVSTDt0cnl7ZT10LmNyZWF0ZU9iamVjdFVSTChzLHtvbmVUaW1lT25seTohMH0pfWNhdGNoKGkpe2U9dC5jcmVhdGVPYmplY3RVUkwocyl9fXIuc3JjPWV9O2lmKHQuSXNVQVN1cHBvcnRpbmdCbG9iU3RvcmFnZSl7dmFyIHMsYT1uZXcgWE1MSHR0cFJlcXVlc3Q7YS5vcGVuKFwiR0VUXCIsaSwhMCksYS5yZXNwb25zZVR5cGU9XCJibG9iXCIsYS5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLGZ1bmN0aW9uKCl7aWYoMjAwPT09YS5zdGF0dXMpe3M9YS5yZXNwb25zZTt2YXIgZT1uLmRiLnRyYW5zYWN0aW9uKFtcInRleHR1cmVzXCJdLFwicmVhZHdyaXRlXCIpO2Uub25hYm9ydD1mdW5jdGlvbihlKXt0cnl7ZS5zcmNFbGVtZW50LmVycm9yJiZcIlF1b3RhRXhjZWVkZWRFcnJvclwiPT09ZS5zcmNFbGVtZW50LmVycm9yLm5hbWUmJih0aGlzLmhhc1JlYWNoZWRRdW90YT0hMCl9Y2F0Y2godCl7fW8oKX0sZS5vbmNvbXBsZXRlPWZ1bmN0aW9uKGUpe28oKX07dmFyIGg9e3RleHR1cmVVcmw6aSxkYXRhOnN9O3RyeXt2YXIgYz1lLm9iamVjdFN0b3JlKFwidGV4dHVyZXNcIikucHV0KGgpO2Mub25zdWNjZXNzPWZ1bmN0aW9uKGUpe30sYy5vbmVycm9yPWZ1bmN0aW9uKGUpe28oKX19Y2F0Y2gobCl7MjU9PT1sLmNvZGUmJih0LklzVUFTdXBwb3J0aW5nQmxvYlN0b3JhZ2U9ITEpLHIuc3JjPWl9fWVsc2Ugci5zcmM9aX0sITEpLGEuYWRkRXZlbnRMaXN0ZW5lcihcImVycm9yXCIsZnVuY3Rpb24odCl7ZS5Ub29scy5FcnJvcihcIkVycm9yIGluIFhIUiByZXF1ZXN0IGluIEJBQllMT04uRGF0YWJhc2UuXCIpLHIuc3JjPWl9LCExKSxhLnNlbmQoKX1lbHNlIHIuc3JjPWl9ZWxzZSBlLlRvb2xzLkVycm9yKFwiRXJyb3I6IEluZGV4ZWREQiBub3Qgc3VwcG9ydGVkIGJ5IHlvdXIgYnJvd3NlciBvciBCYWJ5bG9uSlMgRGF0YWJhc2UgaXMgbm90IG9wZW4uXCIpLHIuc3JjPWl9LHQucHJvdG90eXBlLl9jaGVja1ZlcnNpb25Gcm9tREI9ZnVuY3Rpb24oZSx0KXt2YXIgaT10aGlzLHI9ZnVuY3Rpb24ocil7aS5fc2F2ZVZlcnNpb25JbnRvREJBc3luYyhlLHQpfTt0aGlzLl9sb2FkVmVyc2lvbkZyb21EQkFzeW5jKGUsdCxyKX0sdC5wcm90b3R5cGUuX2xvYWRWZXJzaW9uRnJvbURCQXN5bmM9ZnVuY3Rpb24odCxpLHIpe3ZhciBuPXRoaXM7aWYodGhpcy5pc1N1cHBvcnRlZCl7dmFyIG87dHJ5e3ZhciBzPXRoaXMuZGIudHJhbnNhY3Rpb24oW1widmVyc2lvbnNcIl0pO3Mub25jb21wbGV0ZT1mdW5jdGlvbihlKXtvP24ubWFuaWZlc3RWZXJzaW9uRm91bmQ+by5kYXRhPyhuLm11c3RVcGRhdGVSZXNzb3VyY2VzPSEwLHIoKSk6aShvLmRhdGEpOihuLm11c3RVcGRhdGVSZXNzb3VyY2VzPSEwLHIoKSl9LHMub25hYm9ydD1mdW5jdGlvbihlKXtpKC0xKX07dmFyIGE9cy5vYmplY3RTdG9yZShcInZlcnNpb25zXCIpLmdldCh0KTthLm9uc3VjY2Vzcz1mdW5jdGlvbihlKXtvPWUudGFyZ2V0LnJlc3VsdH0sYS5vbmVycm9yPWZ1bmN0aW9uKHIpe2UuVG9vbHMuRXJyb3IoXCJFcnJvciBsb2FkaW5nIHZlcnNpb24gZm9yIHNjZW5lIFwiK3QrXCIgZnJvbSBEQi5cIiksaSgtMSl9fWNhdGNoKGgpe2UuVG9vbHMuRXJyb3IoXCJFcnJvciB3aGlsZSBhY2Nlc3NpbmcgJ3ZlcnNpb25zJyBvYmplY3Qgc3RvcmUgKFJFQUQgT1ApLiBFeGNlcHRpb246IFwiK2gubWVzc2FnZSksaSgtMSl9fWVsc2UgZS5Ub29scy5FcnJvcihcIkVycm9yOiBJbmRleGVkREIgbm90IHN1cHBvcnRlZCBieSB5b3VyIGJyb3dzZXIgb3IgQmFieWxvbkpTIERhdGFiYXNlIGlzIG5vdCBvcGVuLlwiKSxpKC0xKX0sdC5wcm90b3R5cGUuX3NhdmVWZXJzaW9uSW50b0RCQXN5bmM9ZnVuY3Rpb24odCxpKXt2YXIgcj10aGlzO2lmKHRoaXMuaXNTdXBwb3J0ZWQmJiF0aGlzLmhhc1JlYWNoZWRRdW90YSl0cnl7dmFyIG49dGhpcy5kYi50cmFuc2FjdGlvbihbXCJ2ZXJzaW9uc1wiXSxcInJlYWR3cml0ZVwiKTtuLm9uYWJvcnQ9ZnVuY3Rpb24oZSl7dHJ5e2Uuc3JjRWxlbWVudC5lcnJvciYmXCJRdW90YUV4Y2VlZGVkRXJyb3JcIj09PWUuc3JjRWxlbWVudC5lcnJvci5uYW1lJiYoci5oYXNSZWFjaGVkUXVvdGE9ITApfWNhdGNoKHQpe31pKC0xKX0sbi5vbmNvbXBsZXRlPWZ1bmN0aW9uKGUpe2koci5tYW5pZmVzdFZlcnNpb25Gb3VuZCl9O3ZhciBvPXtzY2VuZVVybDp0LGRhdGE6dGhpcy5tYW5pZmVzdFZlcnNpb25Gb3VuZH0scz1uLm9iamVjdFN0b3JlKFwidmVyc2lvbnNcIikucHV0KG8pO3Mub25zdWNjZXNzPWZ1bmN0aW9uKGUpe30scy5vbmVycm9yPWZ1bmN0aW9uKHQpe2UuVG9vbHMuRXJyb3IoXCJFcnJvciBpbiBEQiBhZGQgdmVyc2lvbiByZXF1ZXN0IGluIEJBQllMT04uRGF0YWJhc2UuXCIpfX1jYXRjaChhKXtlLlRvb2xzLkVycm9yKFwiRXJyb3Igd2hpbGUgYWNjZXNzaW5nICd2ZXJzaW9ucycgb2JqZWN0IHN0b3JlIChXUklURSBPUCkuIEV4Y2VwdGlvbjogXCIrYS5tZXNzYWdlKSxpKC0xKX1lbHNlIGkoLTEpfSx0LnByb3RvdHlwZS5sb2FkRmlsZUZyb21EQj1mdW5jdGlvbihlLGkscixuLG8pe3ZhciBzPXRoaXMsYT10LlJldHVybkZ1bGxVcmxMb2NhdGlvbihlKSxoPWZ1bmN0aW9uKGUpe3MuX3NhdmVGaWxlSW50b0RCQXN5bmMoYSxpLHIpfTt0aGlzLl9jaGVja1ZlcnNpb25Gcm9tREIoYSxmdW5jdGlvbihlKXstMSE9PWU/cy5tdXN0VXBkYXRlUmVzc291cmNlcz9zLl9zYXZlRmlsZUludG9EQkFzeW5jKGEsaSxyLG8pOnMuX2xvYWRGaWxlRnJvbURCQXN5bmMoYSxpLGgsbyk6bigpfSl9LHQucHJvdG90eXBlLl9sb2FkRmlsZUZyb21EQkFzeW5jPWZ1bmN0aW9uKHQsaSxyLG4pe2lmKHRoaXMuaXNTdXBwb3J0ZWQpe3ZhciBvO289LTEhPT10LmluZGV4T2YoXCIuYmFieWxvblwiKT9cInNjZW5lc1wiOlwidGV4dHVyZXNcIjt2YXIgcyxhPXRoaXMuZGIudHJhbnNhY3Rpb24oW29dKTthLm9uY29tcGxldGU9ZnVuY3Rpb24oZSl7cz9pKHMuZGF0YSk6cigpfSxhLm9uYWJvcnQ9ZnVuY3Rpb24oZSl7cigpfTt2YXIgaD1hLm9iamVjdFN0b3JlKG8pLmdldCh0KTtoLm9uc3VjY2Vzcz1mdW5jdGlvbihlKXtzPWUudGFyZ2V0LnJlc3VsdH0saC5vbmVycm9yPWZ1bmN0aW9uKGkpe2UuVG9vbHMuRXJyb3IoXCJFcnJvciBsb2FkaW5nIGZpbGUgXCIrdCtcIiBmcm9tIERCLlwiKSxyKCl9fWVsc2UgZS5Ub29scy5FcnJvcihcIkVycm9yOiBJbmRleGVkREIgbm90IHN1cHBvcnRlZCBieSB5b3VyIGJyb3dzZXIgb3IgQmFieWxvbkpTIERhdGFiYXNlIGlzIG5vdCBvcGVuLlwiKSxpKCl9LHQucHJvdG90eXBlLl9zYXZlRmlsZUludG9EQkFzeW5jPWZ1bmN0aW9uKHQsaSxyLG4pe3ZhciBvPXRoaXM7aWYodGhpcy5pc1N1cHBvcnRlZCl7dmFyIHM7cz0tMSE9PXQuaW5kZXhPZihcIi5iYWJ5bG9uXCIpP1wic2NlbmVzXCI6XCJ0ZXh0dXJlc1wiO3ZhciBhLGg9bmV3IFhNTEh0dHBSZXF1ZXN0O2gub3BlbihcIkdFVFwiLHQsITApLG4mJihoLnJlc3BvbnNlVHlwZT1cImFycmF5YnVmZmVyXCIpLGgub25wcm9ncmVzcz1yLGguYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIixmdW5jdGlvbigpe2lmKDIwMD09PWguc3RhdHVzfHxlLlRvb2xzLlZhbGlkYXRlWEhSRGF0YShoLG4/NjoxKSlpZihhPW4/aC5yZXNwb25zZTpoLnJlc3BvbnNlVGV4dCxvLmhhc1JlYWNoZWRRdW90YSlpKGEpO2Vsc2V7dmFyIHI9by5kYi50cmFuc2FjdGlvbihbc10sXCJyZWFkd3JpdGVcIik7ci5vbmFib3J0PWZ1bmN0aW9uKGUpe3RyeXtlLnNyY0VsZW1lbnQuZXJyb3ImJlwiUXVvdGFFeGNlZWRlZEVycm9yXCI9PT1lLnNyY0VsZW1lbnQuZXJyb3IubmFtZSYmKHRoaXMuaGFzUmVhY2hlZFF1b3RhPSEwKX1jYXRjaCh0KXt9aShhKX0sci5vbmNvbXBsZXRlPWZ1bmN0aW9uKGUpe2koYSl9O3ZhciBjO2M9XCJzY2VuZXNcIj09PXM/e3NjZW5lVXJsOnQsZGF0YTphLHZlcnNpb246by5tYW5pZmVzdFZlcnNpb25Gb3VuZH06e3RleHR1cmVVcmw6dCxkYXRhOmF9O3RyeXt2YXIgbD1yLm9iamVjdFN0b3JlKHMpLnB1dChjKTtsLm9uc3VjY2Vzcz1mdW5jdGlvbihlKXt9LGwub25lcnJvcj1mdW5jdGlvbih0KXtlLlRvb2xzLkVycm9yKFwiRXJyb3IgaW4gREIgYWRkIGZpbGUgcmVxdWVzdCBpbiBCQUJZTE9OLkRhdGFiYXNlLlwiKX19Y2F0Y2godSl7aShhKX19ZWxzZSBpKCl9LCExKSxoLmFkZEV2ZW50TGlzdGVuZXIoXCJlcnJvclwiLGZ1bmN0aW9uKHQpe2UuVG9vbHMuRXJyb3IoXCJlcnJvciBvbiBYSFIgcmVxdWVzdC5cIiksaSgpfSwhMSksaC5zZW5kKCl9ZWxzZSBlLlRvb2xzLkVycm9yKFwiRXJyb3I6IEluZGV4ZWREQiBub3Qgc3VwcG9ydGVkIGJ5IHlvdXIgYnJvd3NlciBvciBCYWJ5bG9uSlMgRGF0YWJhc2UgaXMgbm90IG9wZW4uXCIpLGkoKX0sdC5Jc1VBU3VwcG9ydGluZ0Jsb2JTdG9yYWdlPSEwLHQuSURCU3RvcmFnZUVuYWJsZWQ9ITAsdC5wYXJzZVVSTD1mdW5jdGlvbihlKXt2YXIgdD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYVwiKTt0LmhyZWY9ZTt2YXIgaT1lLnN1YnN0cmluZygwLGUubGFzdEluZGV4T2YoXCIjXCIpKSxyPWUuc3Vic3RyaW5nKGkubGFzdEluZGV4T2YoXCIvXCIpKzEsZS5sZW5ndGgpLG49ZS5zdWJzdHJpbmcoMCxlLmluZGV4T2YociwwKSk7cmV0dXJuIG59LHQuUmV0dXJuRnVsbFVybExvY2F0aW9uPWZ1bmN0aW9uKGUpe3JldHVybi0xPT09ZS5pbmRleE9mKFwiaHR0cDovXCIpP3QucGFyc2VVUkwod2luZG93LmxvY2F0aW9uLmhyZWYpK2U6ZX0sdH0oKTtlLkRhdGFiYXNlPXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0OyFmdW5jdGlvbih0KXt2YXIgaT1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoKXt9cmV0dXJuIHQuR2V0VEdBSGVhZGVyPWZ1bmN0aW9uKGUpe3ZhciB0PTAsaT17aWRfbGVuZ3RoOmVbdCsrXSxjb2xvcm1hcF90eXBlOmVbdCsrXSxpbWFnZV90eXBlOmVbdCsrXSxcbmNvbG9ybWFwX2luZGV4OmVbdCsrXXxlW3QrK108PDgsY29sb3JtYXBfbGVuZ3RoOmVbdCsrXXxlW3QrK108PDgsY29sb3JtYXBfc2l6ZTplW3QrK10sb3JpZ2luOltlW3QrK118ZVt0KytdPDw4LGVbdCsrXXxlW3QrK108PDhdLHdpZHRoOmVbdCsrXXxlW3QrK108PDgsaGVpZ2h0OmVbdCsrXXxlW3QrK108PDgscGl4ZWxfc2l6ZTplW3QrK10sZmxhZ3M6ZVt0KytdfTtyZXR1cm4gaX0sdC5VcGxvYWRDb250ZW50PWZ1bmN0aW9uKGkscil7aWYoci5sZW5ndGg8MTkpcmV0dXJuIHZvaWQgZS5Ub29scy5FcnJvcihcIlVuYWJsZSB0byBsb2FkIFRHQSBmaWxlIC0gTm90IGVub3VnaCBkYXRhIHRvIGNvbnRhaW4gaGVhZGVyXCIpO3ZhciBuPTE4LG89dC5HZXRUR0FIZWFkZXIocik7aWYoby5pZF9sZW5ndGgrbj5yLmxlbmd0aClyZXR1cm4gdm9pZCBlLlRvb2xzLkVycm9yKFwiVW5hYmxlIHRvIGxvYWQgVEdBIGZpbGUgLSBOb3QgZW5vdWdoIGRhdGFcIik7bis9by5pZF9sZW5ndGg7dmFyIHM9ITEsYT0hMSxoPSExLGM9ITE7c3dpdGNoKG8uaW1hZ2VfdHlwZSl7Y2FzZSB0Ll9UWVBFX1JMRV9JTkRFWEVEOnM9ITA7Y2FzZSB0Ll9UWVBFX0lOREVYRUQ6YT0hMDticmVhaztjYXNlIHQuX1RZUEVfUkxFX1JHQjpzPSEwO2Nhc2UgdC5fVFlQRV9SR0I6aD0hMDticmVhaztjYXNlIHQuX1RZUEVfUkxFX0dSRVk6cz0hMDtjYXNlIHQuX1RZUEVfR1JFWTpjPSEwfXZhciBsLHUsZj0oMTUmby5mbGFncyxvLnBpeGVsX3NpemU+PjMpLGQ9by53aWR0aCpvLmhlaWdodCpmO2lmKGEmJih1PXIuc3ViYXJyYXkobixuKz1vLmNvbG9ybWFwX2xlbmd0aCooby5jb2xvcm1hcF9zaXplPj4zKSkpLHMpe2w9bmV3IFVpbnQ4QXJyYXkoZCk7Zm9yKHZhciBwLF8sbSxnPTAsdj1uZXcgVWludDhBcnJheShmKTtkPm4mJmQ+ZzspaWYocD1yW24rK10sXz0oMTI3JnApKzEsMTI4JnApe2ZvcihtPTA7Zj5tOysrbSl2W21dPXJbbisrXTtmb3IobT0wO18+bTsrK20pbC5zZXQodixnK20qZik7Zys9ZipffWVsc2V7Zm9yKF8qPWYsbT0wO18+bTsrK20pbFtnK21dPXJbbisrXTtnKz1ffX1lbHNlIGw9ci5zdWJhcnJheShuLG4rPWE/by53aWR0aCpvLmhlaWdodDpkKTt2YXIgeSx4LGIsUCxBLFQ7c3dpdGNoKChvLmZsYWdzJnQuX09SSUdJTl9NQVNLKT4+dC5fT1JJR0lOX1NISUZUKXtkZWZhdWx0OmNhc2UgdC5fT1JJR0lOX1VMOnk9MCxiPTEsVD1vLndpZHRoLHg9MCxQPTEsQT1vLmhlaWdodDticmVhaztjYXNlIHQuX09SSUdJTl9CTDp5PTAsYj0xLFQ9by53aWR0aCx4PW8uaGVpZ2h0LTEsUD0tMSxBPS0xO2JyZWFrO2Nhc2UgdC5fT1JJR0lOX1VSOnk9by53aWR0aC0xLGI9LTEsVD0tMSx4PTAsUD0xLEE9by5oZWlnaHQ7YnJlYWs7Y2FzZSB0Ll9PUklHSU5fQlI6eT1vLndpZHRoLTEsYj0tMSxUPS0xLHg9by5oZWlnaHQtMSxQPS0xLEE9LTF9dmFyIEU9XCJfZ2V0SW1hZ2VEYXRhXCIrKGM/XCJHcmV5XCI6XCJcIikrby5waXhlbF9zaXplK1wiYml0c1wiLEM9dFtFXShvLHUsbCx4LFAsQSx5LGIsVCk7aS50ZXhJbWFnZTJEKGkuVEVYVFVSRV8yRCwwLGkuUkdCQSxvLndpZHRoLG8uaGVpZ2h0LDAsaS5SR0JBLGkuVU5TSUdORURfQllURSxDKX0sdC5fZ2V0SW1hZ2VEYXRhOGJpdHM9ZnVuY3Rpb24oZSx0LGkscixuLG8scyxhLGgpe3ZhciBjLGwsdSxmPWksZD10LHA9ZS53aWR0aCxfPWUuaGVpZ2h0LG09MCxnPW5ldyBVaW50OEFycmF5KHAqXyo0KTtmb3IodT1yO3UhPT1vO3UrPW4pZm9yKGw9cztsIT09aDtsKz1hLG0rKyljPWZbbV0sZ1s0KihsK3AqdSkrM109MjU1LGdbNCoobCtwKnUpKzJdPWRbMypjKzBdLGdbNCoobCtwKnUpKzFdPWRbMypjKzFdLGdbNCoobCtwKnUpKzBdPWRbMypjKzJdO3JldHVybiBnfSx0Ll9nZXRJbWFnZURhdGExNmJpdHM9ZnVuY3Rpb24oZSx0LGkscixuLG8scyxhLGgpe3ZhciBjLGwsdSxmPWksZD1lLndpZHRoLHA9ZS5oZWlnaHQsXz0wLG09bmV3IFVpbnQ4QXJyYXkoZCpwKjQpO2Zvcih1PXI7dSE9PW87dSs9bilmb3IobD1zO2whPT1oO2wrPWEsXys9MiljPWZbXyswXSsoZltfKzFdPDw4KSxtWzQqKGwrZCp1KSswXT0oMzE3NDQmYyk+PjcsbVs0KihsK2QqdSkrMV09KDk5MiZjKT4+MixtWzQqKGwrZCp1KSsyXT0oMzEmYyk+PjMsbVs0KihsK2QqdSkrM109MzI3NjgmYz8wOjI1NTtyZXR1cm4gbX0sdC5fZ2V0SW1hZ2VEYXRhMjRiaXRzPWZ1bmN0aW9uKGUsdCxpLHIsbixvLHMsYSxoKXt2YXIgYyxsLHU9aSxmPWUud2lkdGgsZD1lLmhlaWdodCxwPTAsXz1uZXcgVWludDhBcnJheShmKmQqNCk7Zm9yKGw9cjtsIT09bztsKz1uKWZvcihjPXM7YyE9PWg7Yys9YSxwKz0zKV9bNCooYytmKmwpKzNdPTI1NSxfWzQqKGMrZipsKSsyXT11W3ArMF0sX1s0KihjK2YqbCkrMV09dVtwKzFdLF9bNCooYytmKmwpKzBdPXVbcCsyXTtyZXR1cm4gX30sdC5fZ2V0SW1hZ2VEYXRhMzJiaXRzPWZ1bmN0aW9uKGUsdCxpLHIsbixvLHMsYSxoKXt2YXIgYyxsLHU9aSxmPWUud2lkdGgsZD1lLmhlaWdodCxwPTAsXz1uZXcgVWludDhBcnJheShmKmQqNCk7Zm9yKGw9cjtsIT09bztsKz1uKWZvcihjPXM7YyE9PWg7Yys9YSxwKz00KV9bNCooYytmKmwpKzJdPXVbcCswXSxfWzQqKGMrZipsKSsxXT11W3ArMV0sX1s0KihjK2YqbCkrMF09dVtwKzJdLF9bNCooYytmKmwpKzNdPXVbcCszXTtyZXR1cm4gX30sdC5fZ2V0SW1hZ2VEYXRhR3JleThiaXRzPWZ1bmN0aW9uKGUsdCxpLHIsbixvLHMsYSxoKXt2YXIgYyxsLHUsZj1pLGQ9ZS53aWR0aCxwPWUuaGVpZ2h0LF89MCxtPW5ldyBVaW50OEFycmF5KGQqcCo0KTtmb3IodT1yO3UhPT1vO3UrPW4pZm9yKGw9cztsIT09aDtsKz1hLF8rKyljPWZbX10sbVs0KihsK2QqdSkrMF09YyxtWzQqKGwrZCp1KSsxXT1jLG1bNCoobCtkKnUpKzJdPWMsbVs0KihsK2QqdSkrM109MjU1O3JldHVybiBtfSx0Ll9nZXRJbWFnZURhdGFHcmV5MTZiaXRzPWZ1bmN0aW9uKGUsdCxpLHIsbixvLHMsYSxoKXt2YXIgYyxsLHU9aSxmPWUud2lkdGgsZD1lLmhlaWdodCxwPTAsXz1uZXcgVWludDhBcnJheShmKmQqNCk7Zm9yKGw9cjtsIT09bztsKz1uKWZvcihjPXM7YyE9PWg7Yys9YSxwKz0yKV9bNCooYytmKmwpKzBdPXVbcCswXSxfWzQqKGMrZipsKSsxXT11W3ArMF0sX1s0KihjK2YqbCkrMl09dVtwKzBdLF9bNCooYytmKmwpKzNdPXVbcCsxXTtyZXR1cm4gX30sdC5fVFlQRV9OT19EQVRBPTAsdC5fVFlQRV9JTkRFWEVEPTEsdC5fVFlQRV9SR0I9Mix0Ll9UWVBFX0dSRVk9Myx0Ll9UWVBFX1JMRV9JTkRFWEVEPTksdC5fVFlQRV9STEVfUkdCPTEwLHQuX1RZUEVfUkxFX0dSRVk9MTEsdC5fT1JJR0lOX01BU0s9NDgsdC5fT1JJR0lOX1NISUZUPTQsdC5fT1JJR0lOX0JMPTAsdC5fT1JJR0lOX0JSPTEsdC5fT1JJR0lOX1VMPTIsdC5fT1JJR0lOX1VSPTMsdH0oKTt0LlRHQVRvb2xzPWl9KHQ9ZS5JbnRlcm5hbHN8fChlLkludGVybmFscz17fSkpfShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbigpe2Z1bmN0aW9uIGUodCl7dGhpcy5sZW5ndGg9MCx0aGlzLl9kdXBsaWNhdGVJZD0wLHRoaXMuZGF0YT1uZXcgQXJyYXkodCksdGhpcy5faWQ9ZS5fR2xvYmFsSWQrK31yZXR1cm4gZS5wcm90b3R5cGUucHVzaD1mdW5jdGlvbihlKXt0aGlzLmRhdGFbdGhpcy5sZW5ndGgrK109ZSx0aGlzLmxlbmd0aD50aGlzLmRhdGEubGVuZ3RoJiYodGhpcy5kYXRhLmxlbmd0aCo9MiksZS5fX3NtYXJ0QXJyYXlGbGFnc3x8KGUuX19zbWFydEFycmF5RmxhZ3M9e30pLGUuX19zbWFydEFycmF5RmxhZ3NbdGhpcy5faWRdPXRoaXMuX2R1cGxpY2F0ZUlkfSxlLnByb3RvdHlwZS5wdXNoTm9EdXBsaWNhdGU9ZnVuY3Rpb24oZSl7cmV0dXJuIGUuX19zbWFydEFycmF5RmxhZ3MmJmUuX19zbWFydEFycmF5RmxhZ3NbdGhpcy5faWRdPT09dGhpcy5fZHVwbGljYXRlSWQ/ITE6KHRoaXMucHVzaChlKSwhMCl9LGUucHJvdG90eXBlLnNvcnQ9ZnVuY3Rpb24oZSl7dGhpcy5kYXRhLnNvcnQoZSl9LGUucHJvdG90eXBlLnJlc2V0PWZ1bmN0aW9uKCl7dGhpcy5sZW5ndGg9MCx0aGlzLl9kdXBsaWNhdGVJZCsrfSxlLnByb3RvdHlwZS5jb25jYXQ9ZnVuY3Rpb24oZSl7aWYoMCE9PWUubGVuZ3RoKXt0aGlzLmxlbmd0aCtlLmxlbmd0aD50aGlzLmRhdGEubGVuZ3RoJiYodGhpcy5kYXRhLmxlbmd0aD0yKih0aGlzLmxlbmd0aCtlLmxlbmd0aCkpO2Zvcih2YXIgdD0wO3Q8ZS5sZW5ndGg7dCsrKXRoaXMuZGF0YVt0aGlzLmxlbmd0aCsrXT0oZS5kYXRhfHxlKVt0XX19LGUucHJvdG90eXBlLmNvbmNhdFdpdGhOb0R1cGxpY2F0ZT1mdW5jdGlvbihlKXtpZigwIT09ZS5sZW5ndGgpe3RoaXMubGVuZ3RoK2UubGVuZ3RoPnRoaXMuZGF0YS5sZW5ndGgmJih0aGlzLmRhdGEubGVuZ3RoPTIqKHRoaXMubGVuZ3RoK2UubGVuZ3RoKSk7Zm9yKHZhciB0PTA7dDxlLmxlbmd0aDt0Kyspe3ZhciBpPShlLmRhdGF8fGUpW3RdO3RoaXMucHVzaE5vRHVwbGljYXRlKGkpfX19LGUucHJvdG90eXBlLmluZGV4T2Y9ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5kYXRhLmluZGV4T2YoZSk7cmV0dXJuIHQ+PXRoaXMubGVuZ3RoPy0xOnR9LGUuX0dsb2JhbElkPTAsZX0oKTtlLlNtYXJ0QXJyYXk9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7dGhpcy5fY291bnQ9MCx0aGlzLl9kYXRhPXt9fXJldHVybiBlLnByb3RvdHlwZS5nZXQ9ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5fZGF0YVtlXTtyZXR1cm4gdm9pZCAwIT09dD90OnZvaWQgMH0sZS5wcm90b3R5cGUuZ2V0T3JBZGRXaXRoRmFjdG9yeT1mdW5jdGlvbihlLHQpe3ZhciBpPXRoaXMuZ2V0KGUpO3JldHVybiB2b2lkIDAhPT1pP2k6KGk9dChlKSxpJiZ0aGlzLmFkZChlLGkpLGkpfSxlLnByb3RvdHlwZS5nZXRPckFkZD1mdW5jdGlvbihlLHQpe3ZhciBpPXRoaXMuZ2V0KGUpO3JldHVybiB2b2lkIDAhPT1pP2k6KHRoaXMuYWRkKGUsdCksdCl9LGUucHJvdG90eXBlLmNvbnRhaW5zPWZ1bmN0aW9uKGUpe3JldHVybiB2b2lkIDAhPT10aGlzLl9kYXRhW2VdfSxlLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdm9pZCAwIT09dGhpcy5fZGF0YVtlXT8hMToodGhpcy5fZGF0YVtlXT10LCsrdGhpcy5fY291bnQsITApfSxlLnByb3RvdHlwZS5zZXQ9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdm9pZCAwPT09dGhpcy5fZGF0YVtlXT8hMToodGhpcy5fZGF0YVtlXT10LCEwKX0sZS5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmNvbnRhaW5zKGUpPyhkZWxldGUgdGhpcy5fZGF0YVtlXSwtLXRoaXMuX2NvdW50LCEwKTohMX0sZS5wcm90b3R5cGUuY2xlYXI9ZnVuY3Rpb24oKXt0aGlzLl9kYXRhPXt9LHRoaXMuX2NvdW50PTB9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLnByb3RvdHlwZSxcImNvdW50XCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9jb3VudH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxlLnByb3RvdHlwZS5mb3JFYWNoPWZ1bmN0aW9uKGUpe2Zvcih2YXIgdCBpbiB0aGlzLl9kYXRhKXt2YXIgaT10aGlzLl9kYXRhW3RdO2UodCxpKX19LGUucHJvdG90eXBlLmZpcnN0PWZ1bmN0aW9uKGUpe2Zvcih2YXIgdCBpbiB0aGlzLl9kYXRhKXt2YXIgaT10aGlzLl9kYXRhW3RdLHI9ZSh0LGkpO2lmKHIpcmV0dXJuIHJ9cmV0dXJuIG51bGx9LGV9KCk7ZS5TdHJpbmdEaWN0aW9uYXJ5PXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQoZSl7cmV0dXJuIGZ1bmN0aW9uKHQpe3QuX19ianNjbGFzc05hbWVfXz1lfX12YXIgaSxyPWZ1bmN0aW9uKHQsaSl7cmV0dXJuIHQ/dCBpbnN0YW5jZW9mIGUuTWVzaD9udWxsOnQgaW5zdGFuY2VvZiBlLlN1Yk1lc2g/dC5jbG9uZShpKTp0LmNsb25lP3QuY2xvbmUoKTpudWxsOm51bGx9LG49ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KCl7fXJldHVybiB0Lkluc3RhbnRpYXRlPWZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1lLnNwbGl0KFwiLlwiKSxpPXdpbmRvd3x8dGhpcyxyPTAsbj10Lmxlbmd0aDtuPnI7cisrKWk9aVt0W3JdXTtyZXR1cm5cImZ1bmN0aW9uXCIhPXR5cGVvZiBpP251bGw6aX0sdC5TZXRJbW1lZGlhdGU9ZnVuY3Rpb24oZSl7d2luZG93LnNldEltbWVkaWF0ZT93aW5kb3cuc2V0SW1tZWRpYXRlKGUpOnNldFRpbWVvdXQoZSwxKX0sdC5Jc0V4cG9uZW50T2ZUd289ZnVuY3Rpb24oZSl7dmFyIHQ9MTtkbyB0Kj0yO3doaWxlKGU+dCk7cmV0dXJuIHQ9PT1lfSx0LkdldEV4cG9uZW50T2ZUd289ZnVuY3Rpb24oZSx0KXt2YXIgaT0xO2RvIGkqPTI7d2hpbGUoZT5pKTtyZXR1cm4gaT50JiYoaT10KSxpfSx0LkdldEZpbGVuYW1lPWZ1bmN0aW9uKGUpe3ZhciB0PWUubGFzdEluZGV4T2YoXCIvXCIpO3JldHVybiAwPnQ/ZTplLnN1YnN0cmluZyh0KzEpfSx0LkdldERPTVRleHRDb250ZW50PWZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1cIlwiLGk9ZS5maXJzdENoaWxkO2k7KTM9PT1pLm5vZGVUeXBlJiYodCs9aS50ZXh0Q29udGVudCksaT1pLm5leHRTaWJsaW5nO3JldHVybiB0fSx0LlRvRGVncmVlcz1mdW5jdGlvbihlKXtyZXR1cm4gMTgwKmUvTWF0aC5QSX0sdC5Ub1JhZGlhbnM9ZnVuY3Rpb24oZSl7cmV0dXJuIGUqTWF0aC5QSS8xODB9LHQuRW5jb2RlQXJyYXlCdWZmZXJUb2Jhc2U2ND1mdW5jdGlvbihlKXtmb3IodmFyIHQsaSxyLG4sbyxzLGEsaD1cIkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky89XCIsYz1cIlwiLGw9MCx1PW5ldyBVaW50OEFycmF5KGUpO2w8dS5sZW5ndGg7KXQ9dVtsKytdLGk9bDx1Lmxlbmd0aD91W2wrK106TnVtYmVyLk5hTixyPWw8dS5sZW5ndGg/dVtsKytdOk51bWJlci5OYU4sbj10Pj4yLG89KDMmdCk8PDR8aT4+NCxzPSgxNSZpKTw8MnxyPj42LGE9NjMmcixpc05hTihpKT9zPWE9NjQ6aXNOYU4ocikmJihhPTY0KSxjKz1oLmNoYXJBdChuKStoLmNoYXJBdChvKStoLmNoYXJBdChzKStoLmNoYXJBdChhKTtyZXR1cm5cImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxcIitjfSx0LkV4dHJhY3RNaW5BbmRNYXhJbmRleGVkPWZ1bmN0aW9uKHQsaSxyLG4sbyl7dm9pZCAwPT09byYmKG89bnVsbCk7Zm9yKHZhciBzPW5ldyBlLlZlY3RvcjMoTnVtYmVyLk1BWF9WQUxVRSxOdW1iZXIuTUFYX1ZBTFVFLE51bWJlci5NQVhfVkFMVUUpLGE9bmV3IGUuVmVjdG9yMygtTnVtYmVyLk1BWF9WQUxVRSwtTnVtYmVyLk1BWF9WQUxVRSwtTnVtYmVyLk1BWF9WQUxVRSksaD1yO3Irbj5oO2grKyl7dmFyIGM9bmV3IGUuVmVjdG9yMyh0WzMqaVtoXV0sdFszKmlbaF0rMV0sdFszKmlbaF0rMl0pO3M9ZS5WZWN0b3IzLk1pbmltaXplKGMscyksYT1lLlZlY3RvcjMuTWF4aW1pemUoYyxhKX1yZXR1cm4gbyYmKHMueC09cy54Km8ueCtvLnkscy55LT1zLnkqby54K28ueSxzLnotPXMueipvLngrby55LGEueCs9YS54Km8ueCtvLnksYS55Kz1hLnkqby54K28ueSxhLnorPWEueipvLngrby55KSx7bWluaW11bTpzLG1heGltdW06YX19LHQuRXh0cmFjdE1pbkFuZE1heD1mdW5jdGlvbih0LGkscixuLG8pe3ZvaWQgMD09PW4mJihuPW51bGwpO3ZhciBzPW5ldyBlLlZlY3RvcjMoTnVtYmVyLk1BWF9WQUxVRSxOdW1iZXIuTUFYX1ZBTFVFLE51bWJlci5NQVhfVkFMVUUpLGE9bmV3IGUuVmVjdG9yMygtTnVtYmVyLk1BWF9WQUxVRSwtTnVtYmVyLk1BWF9WQUxVRSwtTnVtYmVyLk1BWF9WQUxVRSk7b3x8KG89Myk7Zm9yKHZhciBoPWk7aStyPmg7aCsrKXt2YXIgYz1uZXcgZS5WZWN0b3IzKHRbaCpvXSx0W2gqbysxXSx0W2gqbysyXSk7cz1lLlZlY3RvcjMuTWluaW1pemUoYyxzKSxhPWUuVmVjdG9yMy5NYXhpbWl6ZShjLGEpfXJldHVybiBuJiYocy54LT1zLngqbi54K24ueSxzLnktPXMueSpuLngrbi55LHMuei09cy56Km4ueCtuLnksYS54Kz1hLngqbi54K24ueSxhLnkrPWEueSpuLngrbi55LGEueis9YS56Km4ueCtuLnkpLHttaW5pbXVtOnMsbWF4aW11bTphfX0sdC5WZWN0b3IyQXJyYXlGZWVkZXI9ZnVuY3Rpb24odCl7cmV0dXJuIGZ1bmN0aW9uKGkpe3ZhciByPXZvaWQgMCE9PXQuQllURVNfUEVSX0VMRU1FTlQsbj1yP3QubGVuZ3RoLzI6dC5sZW5ndGg7aWYoaT49bilyZXR1cm4gbnVsbDtpZihyKXt2YXIgbz10O3JldHVybiBuZXcgZS5WZWN0b3IyKG9bMippKzBdLG9bMippKzFdKX12YXIgcz10O3JldHVybiBzW2ldfX0sdC5FeHRyYWN0TWluQW5kTWF4VmVjdG9yMj1mdW5jdGlvbih0LGkpe3ZvaWQgMD09PWkmJihpPW51bGwpO2Zvcih2YXIgcj1uZXcgZS5WZWN0b3IyKE51bWJlci5NQVhfVkFMVUUsTnVtYmVyLk1BWF9WQUxVRSksbj1uZXcgZS5WZWN0b3IyKC1OdW1iZXIuTUFYX1ZBTFVFLC1OdW1iZXIuTUFYX1ZBTFVFKSxvPTAscz10KG8rKyk7czspcj1lLlZlY3RvcjIuTWluaW1pemUocyxyKSxuPWUuVmVjdG9yMi5NYXhpbWl6ZShzLG4pLHM9dChvKyspO3JldHVybiBpJiYoci54LT1yLngqaS54K2kueSxyLnktPXIueSppLngraS55LG4ueCs9bi54KmkueCtpLnksbi55Kz1uLnkqaS54K2kueSkse21pbmltdW06cixtYXhpbXVtOm59fSx0Lk1ha2VBcnJheT1mdW5jdGlvbihlLHQpe3JldHVybiB0PT09ITB8fHZvaWQgMCE9PWUmJm51bGwhPWU/QXJyYXkuaXNBcnJheShlKT9lOltlXTp2b2lkIDB9LHQuR2V0UG9pbnRlclByZWZpeD1mdW5jdGlvbigpe3ZhciBlPVwicG9pbnRlclwiO3JldHVybiB3aW5kb3cuUG9pbnRlckV2ZW50fHxuYXZpZ2F0b3IucG9pbnRlckVuYWJsZWR8fChlPVwibW91c2VcIiksZX0sdC5RdWV1ZU5ld0ZyYW1lPWZ1bmN0aW9uKGUpe3dpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWU/d2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShlKTp3aW5kb3cubXNSZXF1ZXN0QW5pbWF0aW9uRnJhbWU/d2luZG93Lm1zUmVxdWVzdEFuaW1hdGlvbkZyYW1lKGUpOndpbmRvdy53ZWJraXRSZXF1ZXN0QW5pbWF0aW9uRnJhbWU/d2luZG93LndlYmtpdFJlcXVlc3RBbmltYXRpb25GcmFtZShlKTp3aW5kb3cubW96UmVxdWVzdEFuaW1hdGlvbkZyYW1lP3dpbmRvdy5tb3pSZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZSk6d2luZG93Lm9SZXF1ZXN0QW5pbWF0aW9uRnJhbWU/d2luZG93Lm9SZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZSk6d2luZG93LnNldFRpbWVvdXQoZSwxNil9LHQuUmVxdWVzdEZ1bGxzY3JlZW49ZnVuY3Rpb24oZSx0KXt2YXIgaT1lLnJlcXVlc3RGdWxsc2NyZWVufHxlLm1zUmVxdWVzdEZ1bGxzY3JlZW58fGUud2Via2l0UmVxdWVzdEZ1bGxzY3JlZW58fGUubW96UmVxdWVzdEZ1bGxTY3JlZW47aSYmaS5jYWxsKGUsdCl9LHQuRXhpdEZ1bGxzY3JlZW49ZnVuY3Rpb24oKXtkb2N1bWVudC5leGl0RnVsbHNjcmVlbj9kb2N1bWVudC5leGl0RnVsbHNjcmVlbigpOmRvY3VtZW50Lm1vekNhbmNlbEZ1bGxTY3JlZW4/ZG9jdW1lbnQubW96Q2FuY2VsRnVsbFNjcmVlbigpOmRvY3VtZW50LndlYmtpdENhbmNlbEZ1bGxTY3JlZW4/ZG9jdW1lbnQud2Via2l0Q2FuY2VsRnVsbFNjcmVlbigpOmRvY3VtZW50Lm1zQ2FuY2VsRnVsbFNjcmVlbiYmZG9jdW1lbnQubXNDYW5jZWxGdWxsU2NyZWVuKCl9LHQuQ2xlYW5Vcmw9ZnVuY3Rpb24oZSl7cmV0dXJuIGU9ZS5yZXBsYWNlKC8jL2dtLFwiJTIzXCIpfSx0LkxvYWRJbWFnZT1mdW5jdGlvbihpLHIsbixvKXtpIGluc3RhbmNlb2YgQXJyYXlCdWZmZXImJihpPXQuRW5jb2RlQXJyYXlCdWZmZXJUb2Jhc2U2NChpKSksaT10LkNsZWFuVXJsKGkpO3ZhciBzPW5ldyBJbWFnZTtpZihcImRhdGE6XCIhPT1pLnN1YnN0cigwLDUpJiZ0LkNvcnNCZWhhdmlvcilzd2l0Y2godHlwZW9mIHQuQ29yc0JlaGF2aW9yKXtjYXNlXCJmdW5jdGlvblwiOnZhciBhPXQuQ29yc0JlaGF2aW9yKGkpO2EmJihzLmNyb3NzT3JpZ2luPWEpO2JyZWFrO2Nhc2VcInN0cmluZ1wiOmRlZmF1bHQ6cy5jcm9zc09yaWdpbj10LkNvcnNCZWhhdmlvcn1zLm9ubG9hZD1mdW5jdGlvbigpe3Iocyl9LHMub25lcnJvcj1mdW5jdGlvbihlKXt0LkVycm9yKFwiRXJyb3Igd2hpbGUgdHJ5aW5nIHRvIGxvYWQgdGV4dHVyZTogXCIraSksdC5Vc2VGYWxsYmFja1RleHR1cmU/KHMuc3JjPVwiZGF0YTppbWFnZS9qcGc7YmFzZTY0LC85ai80QUFRU2taSlJnQUJBUUVBWUFCZ0FBRC80UUJtUlhocFpnQUFUVTBBS2dBQUFBZ0FCQUVhQUFVQUFBQUJBQUFBUGdFYkFBVUFBQUFCQUFBQVJnRW9BQU1BQUFBQkFBSUFBQUV4QUFJQUFBQVFBQUFBVGdBQUFBQUFBQUJnQUFBQUFRQUFBR0FBQUFBQmNHRnBiblF1Ym1WMElEUXVNQzQxQVAvYkFFTUFCQUlEQXdNQ0JBTURBd1FFQkFRRkNRWUZCUVVGQ3dnSUJna05DdzBORFFzTURBNFFGQkVPRHhNUERBd1NHQklURlJZWEZ4Y09FUmtiR1JZYUZCWVhGdi9iQUVNQkJBUUVCUVVGQ2dZR0NoWVBEQThXRmhZV0ZoWVdGaFlXRmhZV0ZoWVdGaFlXRmhZV0ZoWVdGaFlXRmhZV0ZoWVdGaFlXRmhZV0ZoWVdGaFlXRmhZV0Z2L0FBQkVJQVFBQkFBTUJJZ0FDRVFFREVRSC94QUFmQUFBQkJRRUJBUUVCQVFBQUFBQUFBQUFBQVFJREJBVUdCd2dKQ2d2L3hBQzFFQUFDQVFNREFnUURCUVVFQkFBQUFYMEJBZ01BQkJFRkVpRXhRUVlUVVdFSEluRVVNb0dSb1FnalFySEJGVkxSOENRelluS0NDUW9XRnhnWkdpVW1KeWdwS2pRMU5qYzRPVHBEUkVWR1IwaEpTbE5VVlZaWFdGbGFZMlJsWm1kb2FXcHpkSFYyZDNoNWVvT0VoWWFIaUltS2twT1VsWmFYbUptYW9xT2twYWFucUttcXNyTzB0YmEzdUxtNndzUEV4Y2JIeU1uSzB0UFUxZGJYMk5uYTRlTGo1T1htNStqcDZ2SHk4L1QxOXZmNCtmci94QUFmQVFBREFRRUJBUUVCQVFFQkFBQUFBQUFBQVFJREJBVUdCd2dKQ2d2L3hBQzFFUUFDQVFJRUJBTUVCd1VFQkFBQkFuY0FBUUlERVFRRklURUdFa0ZSQjJGeEV5SXlnUWdVUXBHaHNjRUpJek5TOEJWaWN0RUtGaVEwNFNYeEZ4Z1pHaVluS0NrcU5UWTNPRGs2UTBSRlJrZElTVXBUVkZWV1YxaFpXbU5rWldabmFHbHFjM1IxZG5kNGVYcUNnNFNGaG9lSWlZcVNrNVNWbHBlWW1acWlvNlNscHFlb3FhcXlzN1MxdHJlNHVickN3OFRGeHNmSXljclMwOVRWMXRmWTJkcmk0K1RsNXVmbzZlcnk4L1QxOXZmNCtmci8yZ0FNQXdFQUFoRURFUUEvQVBINktLSytGUDc2UGwraWlpdnVqK0JUNmdvb29yNFUvdm8rWDZLS0srNlA0RlBxQ2lpaXZoVCsrajVmb29vcjdvL2dVK29LS0tLK0ZQNzZQbCtpaWl2dWorQlQ2Z29vb3I0VS92bytYNktLSys2UDRGUHFDaWlpdmhUKytqNWZvb29yN28vZ1Urb0tLS0srRlA3NlBsK2lpaXZ1aitCVDZnb29vcjRVL3ZvK1g2S0tLKzZQNEZDaWlpZ0Q2Z29vb3I0VS92bytYNktLSys2UDRGUHFDaWlpdmhUKytqNWZvb29yN28vZ1Urb0tLS0srRlA3NlBsK2lpaXZ1aitCVDZnb29vcjRVL3ZvK1g2S0tLKzZQNEZQcUNpaWl2aFQrK2o1Zm9vb3I3by9nVStvS0tLSytGUDc2UGwraWlpdnVqK0JUNmdvb29yNFUvdm8rWDZLS0srNlA0RlBxQ2lpaXZoVCsrZ29vb29BK1g2S0tLKzZQNEZQcUNpaWl2aFQrK2o1Zm9vb3I3by9nVStvS0tLSytGUDc2UGwraWlpdnVqK0JUNmdvb29yNFUvdm8rWDZLS0srNlA0RlBxQ2lpaXZoVCsrajVmb29vcjdvL2dVK29LS0tLK0ZQNzZQbCtpaWl2dWorQlQ2Z29vb3I0VS92bytYNktLSys2UDRGUHFDaWlpdmhUKytqNWZvb29yN28vZ1VLS0tLQVBxQ2lpaXZoVCsrajVmb29vcjdvL2dVK29LS0tLK0ZQNzZQbCtpaWl2dWorQlQ2Z29vb3I0VS92bytYNktLSys2UDRGUHFDaWlpdmhUKytqNWZvb29yN28vZ1Urb0tLS0srRlA3NlBsK2lpaXZ1aitCVDZnb29vcjRVL3ZvK1g2S0tLKzZQNEZQcUNpaWl2aFQrK2o1Zm9vb3I3by9nVStvS0tLSytGUDc2Q2lpaWdENWZvb29yN28vZ1Urb0tLS0srRlA3NlBsK2lpaXZ1aitCVDZnb29vcjRVL3ZvK1g2S0tLKzZQNEZQcUNpaWl2aFQrK2o1Zm9vb3I3by9nVStvS0tLSytGUDc2UGwraWlpdnVqK0JUNmdvb29yNFUvdm8rWDZLS0srNlA0RlBxQ2lpaXZoVCsrajVmb29vcjdvL2dVK29LS0tLK0ZQNzZQbCtpaWl2dWorQlFvb29vQStvS0tLSytGUDc2UGwraWlpdnVqK0JUNmdvb29yNFUvdm8rWDZLS0srNlA0RlBxQ2lpaXZoVCsrajVmb29vcjdvL2dVK29LS0tLK0ZQNzZQbCtpaWl2dWorQlQ2Z29vb3I0VS92bytYNktLSys2UDRGUHFDaWlpdmhUKytqNWZvb29yN28vZ1Urb0tLS0srRlA3NlBsK2lpaXZ1aitCVDZnb29vcjRVL3ZvS0tLS0FQbCtpaWl2dWorQlQ2Z29vb3I0VS92bytYNktLSys2UDRGUHFDaWlpdmhUKytqNWZvb29yN28vZ1Urb0tLS0srRlA3NlBsK2lpaXZ1aitCVDZnb29vcjRVL3ZvK1g2S0tLKzZQNEZQcUNpaWl2aFQrK2o1Zm9vb3I3by9nVStvS0tLSytGUDc2UGwraWlpdnVqK0JUNmdvb29yNFUvdm8rWDZLS0srNlA0RkNpaWlnRDZnb29vcjRVL3ZvK1g2S0tLKzZQNEZQcUNpaWl2aFQrK2o1Zm9vb3I3by9nVStvS0tLSytGUDc2UGwraWlpdnVqK0JUNmdvb29yNFUvdm8rWDZLS0srNlA0RlBxQ2lpaXZoVCsrajVmb29vcjdvL2dVK29LS0tLK0ZQNzZQbCtpaWl2dWorQlQ2Z29vb3I0VS92bytYNktLSys2UDRGUHFDaWlpdmhUKytnb29vb0ErWDZLS0srNlA0RlBxQ2lpaXZoVCsrajVmb29vcjdvL2dVK29LS0tLK0ZQNzZQbCtpaWl2dWorQlQ2Z29vb3I0VS92bytYNktLSys2UDRGUHFDaWlpdmhUKytqNWZvb29yN28vZ1Urb0tLS0srRlA3NlBsK2lpaXZ1aitCVDZnb29vcjRVL3ZvK1g2S0tLKzZQNEZQcUNpaWl2aFQrK2o1Zm9vb3I3by9nVUtLS0tBUHFDaWlpdmhUKytqNWZvb29yN28vZ1Urb0tLS0srRlA3NlBsK2lpaXZ1aitCVDZnb29vcjRVL3ZvK1g2S0tLKzZQNEZQcUNpaWl2aFQrK2o1Zm9vb3I3by9nVStvS0tLSytGUDc2UGwraWlpdnVqK0JUNmdvb29yNFUvdm8rWDZLS0srNlA0RlBxQ2lpaXZoVCsrajVmb29vcjdvL2dVK29LS0tLK0ZQNzZDaWlpZ0Q1Zm9vb3I3by9nVStvS0tLSytGUDc2UGwraWlpdnVqK0JUNmdvb29yNFUvdm8rWDZLS0srNlA0RlBxQ2lpaXZoVCsrajVmb29vcjdvL2dVK29LS0tLK0ZQNzZQbCtpaWl2dWorQlQ2Z29vb3I0VS92bytYNktLSys2UDRGUHFDaWlpdmhUKytqNWZvb29yN28vZ1Urb0tLS0srRlA3NlBsK2lpaXZ1aitCUW9vb29BK29LS0tLK0ZQNzZQbCtpaWl2dWorQlQ2Z29vb3I0VS92bytYNktLSys2UDRGUHFDaWlpdmhUKytqNWZvb29yN28vZ1Urb0tLS0srRlA3NlBsK2lpaXZ1aitCVDZnb29vcjRVL3ZvK1g2S0tLKzZQNEZQcUNpaWl2aFQrK2o1Zm9vb3I3by9nVStvS0tLSytGUDc2UGwraWlpdnVqK0JUNmdvb29yNFUvdm9LS0tLQVBsK2lpaXZ1aitCVDZnb29vcjRVL3ZvK1g2S0tLKzZQNEZQcUNpaWl2aFQrK2o1Zm9vb3I3by9nVStvS0tLSytGUDc2UGwraWlpdnVqK0JUNmdvb29yNFUvdm8rWDZLS0srNlA0RlBxQ2lpaXZoVCsrajVmb29vcjdvL2dVK29LS0tLK0ZQNzZQbCtpaWl2dWorQlQ2Z29vb3I0VS92bytYNktLSys2UDRGQ2lpaWdENmdvb29yNFUvdm8rWDZLS0srNlA0RlBxQ2lpaXZoVCsrajVmb29vcjdvL2dVK29LS0tLK0ZQNzZQbCtpaWl2dWorQlQ2Z29vb3I0VS92bytYNktLSys2UDRGUHFDaWlpdmhUKytqNWZvb29yN28vZ1Urb0tLS0srRlA3NlBsK2lpaXZ1aitCVDZnb29vcjRVL3ZvK1g2S0tLKzZQNEZQcUNpaWl2aFQrK2dvb29vQStYNktLSys2UDRGUHFDaWlpdmhUKytqNWZvb29yN28vZ1Urb0tLS0srRlA3NlBsK2lpaXZ1aitCVDZnb29vcjRVL3ZvK1g2S0tLKzZQNEZQcUNpaWl2aFQrK2o1Zm9vb3I3by9nVStvS0tLSytGUDc2UGwraWlpdnVqK0JUNmdvb29yNFUvdm8rWDZLS0srNlA0RlBxQ2lpaXZoVCsrajVmb29vcjdvL2dVS0tLS0FQcUNpaWl2aFQrK2o1Zm9vb3I3by9nVStvS0tLSytGUDc2UGwraWlpdnVqK0JUNmdvb29yNFUvdm8rWDZLS0srNlA0RlBxQ2lpaXZoVCsrajVmb29vcjdvL2dVK29LS0tLK0ZQNzZQbCtpaWl2dWorQlQ2Z29vb3I0VS92bytYNktLSys2UDRGUHFDaWlpdmhUKytqNWZvb29yN28vZ1Urb0tLS0srRlA3NlAvL1pcIixyKHMpKTpuKCl9O3ZhciBoPWZ1bmN0aW9uKCl7cy5zcmM9aX0sYz1mdW5jdGlvbigpe28ubG9hZEltYWdlRnJvbURCKGkscyl9O2lmKFwiZGF0YTpcIiE9PWkuc3Vic3RyKDAsNSkmJm8mJm8uZW5hYmxlVGV4dHVyZXNPZmZsaW5lJiZlLkRhdGFiYXNlLklzVUFTdXBwb3J0aW5nQmxvYlN0b3JhZ2Upby5vcGVuQXN5bmMoYyxoKTtlbHNlIGlmKC0xPT09aS5pbmRleE9mKFwiZmlsZTpcIikpaCgpO2Vsc2UgdHJ5e3ZhciBsLHU9aS5zdWJzdHJpbmcoNSkudG9Mb3dlckNhc2UoKTt0cnl7bD1VUkwuY3JlYXRlT2JqZWN0VVJMKGUuRmlsZXNJbnB1dC5GaWxlc1RleHR1cmVzW3VdLHtvbmVUaW1lT25seTohMH0pfWNhdGNoKGYpe2w9VVJMLmNyZWF0ZU9iamVjdFVSTChlLkZpbGVzSW5wdXQuRmlsZXNUZXh0dXJlc1t1XSl9cy5zcmM9bH1jYXRjaChkKXtzLnNyYz1udWxsfXJldHVybiBzfSx0LkxvYWRGaWxlPWZ1bmN0aW9uKGkscixuLG8scyxhKXtpPXQuQ2xlYW5VcmwoaSk7dmFyIGg9ZnVuY3Rpb24oKXt2YXIgZT1uZXcgWE1MSHR0cFJlcXVlc3Qsbz10LkJhc2VVcmwraTtlLm9wZW4oXCJHRVRcIixvLCEwKSxzJiYoZS5yZXNwb25zZVR5cGU9XCJhcnJheWJ1ZmZlclwiKSxlLm9ucHJvZ3Jlc3M9bixlLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpe2lmKDQ9PT1lLnJlYWR5U3RhdGUpaWYoMjAwPT09ZS5zdGF0dXN8fHQuVmFsaWRhdGVYSFJEYXRhKGUscz82OjEpKXIocz9lLnJlc3BvbnNlOmUucmVzcG9uc2VUZXh0KTtlbHNle2lmKCFhKXRocm93IG5ldyBFcnJvcihcIkVycm9yIHN0YXR1czogXCIrZS5zdGF0dXMrXCIgLSBVbmFibGUgdG8gbG9hZCBcIitvKTthKCl9fSxlLnNlbmQobnVsbCl9LGM9ZnVuY3Rpb24oKXtvLmxvYWRGaWxlRnJvbURCKGkscixuLGgscyl9O2lmKC0xIT09aS5pbmRleE9mKFwiZmlsZTpcIikpe3ZhciBsPWkuc3Vic3RyaW5nKDUpLnRvTG93ZXJDYXNlKCk7dC5SZWFkRmlsZShlLkZpbGVzSW5wdXQuRmlsZXNUb0xvYWRbbF0scixuLHMpfWVsc2UgbyYmby5lbmFibGVTY2VuZU9mZmxpbmU/by5vcGVuQXN5bmMoYyxoKTpoKCl9LHQuUmVhZEZpbGVBc0RhdGFVUkw9ZnVuY3Rpb24oZSx0LGkpe3ZhciByPW5ldyBGaWxlUmVhZGVyO3Iub25sb2FkPWZ1bmN0aW9uKGUpe3QoZS50YXJnZXQucmVzdWx0KX0sci5vbnByb2dyZXNzPWksci5yZWFkQXNEYXRhVVJMKGUpfSx0LlJlYWRGaWxlPWZ1bmN0aW9uKGUsaSxyLG4pe3ZhciBvPW5ldyBGaWxlUmVhZGVyO28ub25lcnJvcj1mdW5jdGlvbihyKXt0LkxvZyhcIkVycm9yIHdoaWxlIHJlYWRpbmcgZmlsZTogXCIrZS5uYW1lKSxpKEpTT04uc3RyaW5naWZ5KHthdXRvQ2xlYXI6ITAsY2xlYXJDb2xvcjpbMSwwLDBdLGFtYmllbnRDb2xvcjpbMCwwLDBdLGdyYXZpdHk6WzAsLTkuODA3LDBdLG1lc2hlczpbXSxjYW1lcmFzOltdLGxpZ2h0czpbXX0pKX0sby5vbmxvYWQ9ZnVuY3Rpb24oZSl7aShlLnRhcmdldC5yZXN1bHQpfSxvLm9ucHJvZ3Jlc3M9cixuP28ucmVhZEFzQXJyYXlCdWZmZXIoZSk6by5yZWFkQXNUZXh0KGUpfSx0LkZpbGVBc1VSTD1mdW5jdGlvbihlKXt2YXIgdD1uZXcgQmxvYihbZV0pLGk9d2luZG93LlVSTHx8d2luZG93LndlYmtpdFVSTCxyPWkuY3JlYXRlT2JqZWN0VVJMKHQpO3JldHVybiByfSx0LkZvcm1hdD1mdW5jdGlvbihlLHQpe3JldHVybiB2b2lkIDA9PT10JiYodD0yKSxlLnRvRml4ZWQodCl9LHQuQ2hlY2tFeHRlbmRzPWZ1bmN0aW9uKGUsdCxpKXtlLng8dC54JiYodC54PWUueCksZS55PHQueSYmKHQueT1lLnkpLGUuejx0LnomJih0Lno9ZS56KSxlLng+aS54JiYoaS54PWUueCksZS55PmkueSYmKGkueT1lLnkpLGUuej5pLnomJihpLno9ZS56KX0sdC5EZWVwQ29weT1mdW5jdGlvbihlLHQsaSxuKXtmb3IodmFyIG8gaW4gZSlpZigoXCJfXCIhPT1vWzBdfHxuJiYtMSE9PW4uaW5kZXhPZihvKSkmJighaXx8LTE9PT1pLmluZGV4T2YobykpKXt2YXIgcz1lW29dLGE9dHlwZW9mIHM7aWYoXCJmdW5jdGlvblwiIT09YSlpZihcIm9iamVjdFwiPT09YSlpZihzIGluc3RhbmNlb2YgQXJyYXkpe2lmKHRbb109W10scy5sZW5ndGg+MClpZihcIm9iamVjdFwiPT10eXBlb2Ygc1swXSlmb3IodmFyIGg9MDtoPHMubGVuZ3RoO2grKyl7dmFyIGM9cihzW2hdLHQpOy0xPT09dFtvXS5pbmRleE9mKGMpJiZ0W29dLnB1c2goYyl9ZWxzZSB0W29dPXMuc2xpY2UoMCl9ZWxzZSB0W29dPXIocyx0KTtlbHNlIHRbb109c319LHQuSXNFbXB0eT1mdW5jdGlvbihlKXtmb3IodmFyIHQgaW4gZSlyZXR1cm4hMTtyZXR1cm4hMH0sdC5SZWdpc3RlclRvcFJvb3RFdmVudHM9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PTA7dDxlLmxlbmd0aDt0Kyspe3ZhciBpPWVbdF07d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoaS5uYW1lLGkuaGFuZGxlciwhMSk7dHJ5e3dpbmRvdy5wYXJlbnQmJndpbmRvdy5wYXJlbnQuYWRkRXZlbnRMaXN0ZW5lcihpLm5hbWUsaS5oYW5kbGVyLCExKX1jYXRjaChyKXt9fX0sdC5VbnJlZ2lzdGVyVG9wUm9vdEV2ZW50cz1mdW5jdGlvbihlKXtmb3IodmFyIHQ9MDt0PGUubGVuZ3RoO3QrKyl7dmFyIGk9ZVt0XTt3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihpLm5hbWUsaS5oYW5kbGVyKTt0cnl7d2luZG93LnBhcmVudCYmd2luZG93LnBhcmVudC5yZW1vdmVFdmVudExpc3RlbmVyKGkubmFtZSxpLmhhbmRsZXIpfWNhdGNoKHIpe319fSx0LkR1bXBGcmFtZWJ1ZmZlcj1mdW5jdGlvbihlLHQscixuKXtmb3IodmFyIG89NCplLHM9dC8yLGE9ci5yZWFkUGl4ZWxzKDAsMCxlLHQpLGg9MDtzPmg7aCsrKWZvcih2YXIgYz0wO28+YztjKyspe3ZhciBsPWMraCpvLHU9dC1oLTEsZj1jK3UqbyxkPWFbbF07YVtsXT1hW2ZdLGFbZl09ZH1pfHwoaT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpKSxpLndpZHRoPWUsaS5oZWlnaHQ9dDt2YXIgcD1pLmdldENvbnRleHQoXCIyZFwiKSxfPXAuY3JlYXRlSW1hZ2VEYXRhKGUsdCksbT1fLmRhdGE7bS5zZXQoYSkscC5wdXRJbWFnZURhdGEoXywwLDApO3ZhciBnPWkudG9EYXRhVVJMKCk7aWYobiluKGcpO2Vsc2UgaWYoXCJkb3dubG9hZFwiaW4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImFcIikpe3ZhciB2PXdpbmRvdy5kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYVwiKTt2LmhyZWY9Zzt2YXIgeT1uZXcgRGF0ZSx4PSh5LmdldEZ1bGxZZWFyKCkrXCItXCIrKHkuZ2V0TW9udGgoKSsxKSkuc2xpY2UoLTIpK1wiLVwiK3kuZ2V0RGF0ZSgpK1wiX1wiK3kuZ2V0SG91cnMoKStcIi1cIisoXCIwXCIreS5nZXRNaW51dGVzKCkpLnNsaWNlKC0yKTt2LnNldEF0dHJpYnV0ZShcImRvd25sb2FkXCIsXCJzY3JlZW5zaG90X1wiK3grXCIucG5nXCIpLHdpbmRvdy5kb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHYpLHYuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsZnVuY3Rpb24oKXt2LnBhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQodil9KSx2LmNsaWNrKCl9ZWxzZXt2YXIgYj13aW5kb3cub3BlbihcIlwiKSxQPWIuZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImltZ1wiKTtQLnNyYz1nLGIuZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChQKX19LHQuQ3JlYXRlU2NyZWVuc2hvdD1mdW5jdGlvbihpLHIsbixvKXt2YXIgcyxhO2lmKG4ucHJlY2lzaW9uKXM9TWF0aC5yb3VuZChpLmdldFJlbmRlcldpZHRoKCkqbi5wcmVjaXNpb24pLGE9TWF0aC5yb3VuZChzL2kuZ2V0QXNwZWN0UmF0aW8ocikpLG49e3dpZHRoOnMsaGVpZ2h0OmF9O2Vsc2UgaWYobi53aWR0aCYmbi5oZWlnaHQpcz1uLndpZHRoLGE9bi5oZWlnaHQ7ZWxzZSBpZihuLndpZHRoJiYhbi5oZWlnaHQpcz1uLndpZHRoLGE9TWF0aC5yb3VuZChzL2kuZ2V0QXNwZWN0UmF0aW8ocikpLG49e3dpZHRoOnMsaGVpZ2h0OmF9O2Vsc2UgaWYobi5oZWlnaHQmJiFuLndpZHRoKWE9bi5oZWlnaHQscz1NYXRoLnJvdW5kKGEqaS5nZXRBc3BlY3RSYXRpbyhyKSksbj17d2lkdGg6cyxoZWlnaHQ6YX07ZWxzZXtpZihpc05hTihuKSlyZXR1cm4gdm9pZCB0LkVycm9yKFwiSW52YWxpZCAnc2l6ZScgcGFyYW1ldGVyICFcIik7YT1uLHM9bn12YXIgaD1yLmdldFNjZW5lKCksYz1udWxsO2guYWN0aXZlQ2FtZXJhIT09ciYmKGM9aC5hY3RpdmVDYW1lcmEsaC5hY3RpdmVDYW1lcmE9cik7dmFyIGw9bmV3IGUuUmVuZGVyVGFyZ2V0VGV4dHVyZShcInNjcmVlblNob3RcIixuLGgsITEsITEpO2wucmVuZGVyTGlzdD1oLm1lc2hlcyxsLm9uQWZ0ZXJSZW5kZXJPYnNlcnZhYmxlLmFkZChmdW5jdGlvbigpe3QuRHVtcEZyYW1lYnVmZmVyKHMsYSxpLG8pfSksaC5pbmNyZW1lbnRSZW5kZXJJZCgpLGgucmVzZXRDYWNoZWRNYXRlcmlhbCgpLGwucmVuZGVyKCEwKSxsLmRpc3Bvc2UoKSxjJiYoaC5hY3RpdmVDYW1lcmE9Yyksci5nZXRQcm9qZWN0aW9uTWF0cml4KCEwKX0sdC5WYWxpZGF0ZVhIUkRhdGE9ZnVuY3Rpb24odCxpKXt2b2lkIDA9PT1pJiYoaT03KTt0cnl7aWYoMSZpKXtpZih0LnJlc3BvbnNlVGV4dCYmdC5yZXNwb25zZVRleHQubGVuZ3RoPjApcmV0dXJuITA7aWYoMT09PWkpcmV0dXJuITF9aWYoMiZpKXt2YXIgcj1lLkludGVybmFscy5UR0FUb29scy5HZXRUR0FIZWFkZXIodC5yZXNwb25zZSk7aWYoci53aWR0aCYmci5oZWlnaHQmJnIud2lkdGg+MCYmci5oZWlnaHQ+MClyZXR1cm4hMDtpZigyPT09aSlyZXR1cm4hMX1pZig0Jmkpe3ZhciBuPW5ldyBVaW50OEFycmF5KHQucmVzcG9uc2UsMCwzKTtyZXR1cm4gNjg9PT1uWzBdJiY2OD09PW5bMV0mJjgzPT09blsyXX19Y2F0Y2gobyl7fXJldHVybiExfSxPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIk5vbmVMb2dMZXZlbFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdC5fTm9uZUxvZ0xldmVsfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiTWVzc2FnZUxvZ0xldmVsXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0Ll9NZXNzYWdlTG9nTGV2ZWx9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJXYXJuaW5nTG9nTGV2ZWxcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHQuX1dhcm5pbmdMb2dMZXZlbH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIkVycm9yTG9nTGV2ZWxcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHQuX0Vycm9yTG9nTGV2ZWx9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJBbGxMb2dMZXZlbFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdC5fTWVzc2FnZUxvZ0xldmVsfHQuX1dhcm5pbmdMb2dMZXZlbHx0Ll9FcnJvckxvZ0xldmVsfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLHQuX0FkZExvZ0VudHJ5PWZ1bmN0aW9uKGUpe3QuX0xvZ0NhY2hlPWUrdC5fTG9nQ2FjaGUsdC5Pbk5ld0NhY2hlRW50cnkmJnQuT25OZXdDYWNoZUVudHJ5KGUpfSx0Ll9Gb3JtYXRNZXNzYWdlPWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKGUpe3JldHVybiAxMD5lP1wiMFwiK2U6XCJcIitlfSxpPW5ldyBEYXRlO3JldHVyblwiW1wiK3QoaS5nZXRIb3VycygpKStcIjpcIit0KGkuZ2V0TWludXRlcygpKStcIjpcIit0KGkuZ2V0U2Vjb25kcygpKStcIl06IFwiK2V9LHQuX0xvZ0Rpc2FibGVkPWZ1bmN0aW9uKGUpe30sdC5fTG9nRW5hYmxlZD1mdW5jdGlvbihlKXt2YXIgaT10Ll9Gb3JtYXRNZXNzYWdlKGUpO2NvbnNvbGUubG9nKFwiQkpTIC0gXCIraSk7dmFyIHI9XCI8ZGl2IHN0eWxlPSdjb2xvcjp3aGl0ZSc+XCIraStcIjwvZGl2Pjxicj5cIjt0Ll9BZGRMb2dFbnRyeShyKX0sdC5fV2FybkRpc2FibGVkPWZ1bmN0aW9uKGUpe30sdC5fV2FybkVuYWJsZWQ9ZnVuY3Rpb24oZSl7dmFyIGk9dC5fRm9ybWF0TWVzc2FnZShlKTtjb25zb2xlLndhcm4oXCJCSlMgLSBcIitpKTt2YXIgcj1cIjxkaXYgc3R5bGU9J2NvbG9yOm9yYW5nZSc+XCIraStcIjwvZGl2Pjxicj5cIjt0Ll9BZGRMb2dFbnRyeShyKX0sdC5fRXJyb3JEaXNhYmxlZD1mdW5jdGlvbihlKXt9LHQuX0Vycm9yRW5hYmxlZD1mdW5jdGlvbihlKXt0LmVycm9yc0NvdW50Kys7dmFyIGk9dC5fRm9ybWF0TWVzc2FnZShlKTtjb25zb2xlLmVycm9yKFwiQkpTIC0gXCIraSk7dmFyIHI9XCI8ZGl2IHN0eWxlPSdjb2xvcjpyZWQnPlwiK2krXCI8L2Rpdj48YnI+XCI7dC5fQWRkTG9nRW50cnkocil9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiTG9nQ2FjaGVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHQuX0xvZ0NhY2hlfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLHQuQ2xlYXJMb2dDYWNoZT1mdW5jdGlvbigpe3QuX0xvZ0NhY2hlPVwiXCIsdC5lcnJvcnNDb3VudD0wfSxPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIkxvZ0xldmVsc1wiLHtzZXQ6ZnVuY3Rpb24oZSl7KGUmdC5NZXNzYWdlTG9nTGV2ZWwpPT09dC5NZXNzYWdlTG9nTGV2ZWw/dC5Mb2c9dC5fTG9nRW5hYmxlZDp0LkxvZz10Ll9Mb2dEaXNhYmxlZCwoZSZ0Lldhcm5pbmdMb2dMZXZlbCk9PT10Lldhcm5pbmdMb2dMZXZlbD90Lldhcm49dC5fV2FybkVuYWJsZWQ6dC5XYXJuPXQuX1dhcm5EaXNhYmxlZCwoZSZ0LkVycm9yTG9nTGV2ZWwpPT09dC5FcnJvckxvZ0xldmVsP3QuRXJyb3I9dC5fRXJyb3JFbmFibGVkOnQuRXJyb3I9dC5fRXJyb3JEaXNhYmxlZH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIlBlcmZvcm1hbmNlTm9uZUxvZ0xldmVsXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0Ll9QZXJmb3JtYW5jZU5vbmVMb2dMZXZlbH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIlBlcmZvcm1hbmNlVXNlck1hcmtMb2dMZXZlbFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdC5fUGVyZm9ybWFuY2VVc2VyTWFya0xvZ0xldmVsfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiUGVyZm9ybWFuY2VDb25zb2xlTG9nTGV2ZWxcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHQuX1BlcmZvcm1hbmNlQ29uc29sZUxvZ0xldmVsfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiUGVyZm9ybWFuY2VMb2dMZXZlbFwiLHtzZXQ6ZnVuY3Rpb24oZSl7cmV0dXJuKGUmdC5QZXJmb3JtYW5jZVVzZXJNYXJrTG9nTGV2ZWwpPT09dC5QZXJmb3JtYW5jZVVzZXJNYXJrTG9nTGV2ZWw/KHQuU3RhcnRQZXJmb3JtYW5jZUNvdW50ZXI9dC5fU3RhcnRVc2VyTWFyayx2b2lkKHQuRW5kUGVyZm9ybWFuY2VDb3VudGVyPXQuX0VuZFVzZXJNYXJrKSk6KGUmdC5QZXJmb3JtYW5jZUNvbnNvbGVMb2dMZXZlbCk9PT10LlBlcmZvcm1hbmNlQ29uc29sZUxvZ0xldmVsPyh0LlN0YXJ0UGVyZm9ybWFuY2VDb3VudGVyPXQuX1N0YXJ0UGVyZm9ybWFuY2VDb25zb2xlLHZvaWQodC5FbmRQZXJmb3JtYW5jZUNvdW50ZXI9dC5fRW5kUGVyZm9ybWFuY2VDb25zb2xlKSk6KHQuU3RhcnRQZXJmb3JtYW5jZUNvdW50ZXI9dC5fU3RhcnRQZXJmb3JtYW5jZUNvdW50ZXJEaXNhYmxlZCx2b2lkKHQuRW5kUGVyZm9ybWFuY2VDb3VudGVyPXQuX0VuZFBlcmZvcm1hbmNlQ291bnRlckRpc2FibGVkKSl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksdC5fU3RhcnRQZXJmb3JtYW5jZUNvdW50ZXJEaXNhYmxlZD1mdW5jdGlvbihlLHQpe30sdC5fRW5kUGVyZm9ybWFuY2VDb3VudGVyRGlzYWJsZWQ9ZnVuY3Rpb24oZSx0KXt9LHQuX1N0YXJ0VXNlck1hcms9ZnVuY3Rpb24oZSxpKXt2b2lkIDA9PT1pJiYoaT0hMCksaSYmdC5fcGVyZm9ybWFuY2UubWFyayYmdC5fcGVyZm9ybWFuY2UubWFyayhlK1wiLUJlZ2luXCIpfSx0Ll9FbmRVc2VyTWFyaz1mdW5jdGlvbihlLGkpe3ZvaWQgMD09PWkmJihpPSEwKSxpJiZ0Ll9wZXJmb3JtYW5jZS5tYXJrJiYodC5fcGVyZm9ybWFuY2UubWFyayhlK1wiLUVuZFwiKSx0Ll9wZXJmb3JtYW5jZS5tZWFzdXJlKGUsZStcIi1CZWdpblwiLGUrXCItRW5kXCIpKX0sdC5fU3RhcnRQZXJmb3JtYW5jZUNvbnNvbGU9ZnVuY3Rpb24oZSxpKXt2b2lkIDA9PT1pJiYoaT0hMCksaSYmKHQuX1N0YXJ0VXNlck1hcmsoZSxpKSxjb25zb2xlLnRpbWUmJmNvbnNvbGUudGltZShlKSl9LHQuX0VuZFBlcmZvcm1hbmNlQ29uc29sZT1mdW5jdGlvbihlLGkpe3ZvaWQgMD09PWkmJihpPSEwKSxpJiYodC5fRW5kVXNlck1hcmsoZSxpKSxjb25zb2xlLnRpbWUmJmNvbnNvbGUudGltZUVuZChlKSl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiTm93XCIse2dldDpmdW5jdGlvbigpe3JldHVybiB3aW5kb3cucGVyZm9ybWFuY2UmJndpbmRvdy5wZXJmb3JtYW5jZS5ub3c/d2luZG93LnBlcmZvcm1hbmNlLm5vdygpOihuZXcgRGF0ZSkuZ2V0VGltZSgpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLHQuZ2V0Q2xhc3NOYW1lPWZ1bmN0aW9uKGUsdCl7dm9pZCAwPT09dCYmKHQ9ITEpO3ZhciBpPW51bGw7aWYoIXQmJmUuZ2V0Q2xhc3NOYW1lKWk9ZS5nZXRDbGFzc05hbWUoKTtlbHNle2lmKGUgaW5zdGFuY2VvZiBPYmplY3Qpe3ZhciByPXQ/ZTpPYmplY3QuZ2V0UHJvdG90eXBlT2YoZSk7aT1yLmNvbnN0cnVjdG9yLl9fYmpzY2xhc3NOYW1lX199aXx8KGk9dHlwZW9mIGUpfXJldHVybiBpfSx0LmZpcnN0PWZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBpPTA7aTxlLmxlbmd0aDtpKyspe3ZhciByPWVbaV07aWYodChyKSlyZXR1cm4gcn19LHQuYXJyYXlPclN0cmluZ0ZlZWRlcj1mdW5jdGlvbihlKXtyZXR1cm4gZnVuY3Rpb24oaSl7aWYoaT49ZS5sZW5ndGgpcmV0dXJuIG51bGw7dmFyIHI9ZS5jaGFyQ29kZUF0P2UuY2hhckNvZGVBdChpKTplW2ldO3JldHVybiByJiZyLmdldEhhc2hDb2RlJiYocj1yLmdldEhhc2hDb2RlKCkpLFwic3RyaW5nXCI9PXR5cGVvZiByP3QuaGFzaENvZGVGcm9tU3RyZWFtKHQuYXJyYXlPclN0cmluZ0ZlZWRlcihyKSk6cn19LHQuaGFzaENvZGVGcm9tU3RyZWFtPWZ1bmN0aW9uKGUpe2Zvcih2YXIgdD0wLGk9MCxyPWUoaSsrKTtudWxsIT1yOyl0PSh0PDw1KS10K3IsdHw9MCxyPWUoaSsrKTtyZXR1cm4gdH0sdC5CYXNlVXJsPVwiXCIsdC5Db3JzQmVoYXZpb3I9XCJhbm9ueW1vdXNcIix0LlVzZUZhbGxiYWNrVGV4dHVyZT0hMCx0Ll9Ob25lTG9nTGV2ZWw9MCx0Ll9NZXNzYWdlTG9nTGV2ZWw9MSx0Ll9XYXJuaW5nTG9nTGV2ZWw9Mix0Ll9FcnJvckxvZ0xldmVsPTQsdC5fTG9nQ2FjaGU9XCJcIix0LmVycm9yc0NvdW50PTAsdC5Mb2c9dC5fTG9nRW5hYmxlZCx0Lldhcm49dC5fV2FybkVuYWJsZWQsdC5FcnJvcj10Ll9FcnJvckVuYWJsZWQsdC5fUGVyZm9ybWFuY2VOb25lTG9nTGV2ZWw9MCx0Ll9QZXJmb3JtYW5jZVVzZXJNYXJrTG9nTGV2ZWw9MSx0Ll9QZXJmb3JtYW5jZUNvbnNvbGVMb2dMZXZlbD0yLHQuX3BlcmZvcm1hbmNlPXdpbmRvdy5wZXJmb3JtYW5jZSx0LlN0YXJ0UGVyZm9ybWFuY2VDb3VudGVyPXQuX1N0YXJ0UGVyZm9ybWFuY2VDb3VudGVyRGlzYWJsZWQsdC5FbmRQZXJmb3JtYW5jZUNvdW50ZXI9dC5fRW5kUGVyZm9ybWFuY2VDb3VudGVyRGlzYWJsZWQsdH0oKTtlLlRvb2xzPW4sZS5jbGFzc05hbWU9dDt2YXIgbz1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSx0LGkscil7dm9pZCAwPT09ciYmKHI9MCksdGhpcy5pdGVyYXRpb25zPWUsdGhpcy5fZm49dCx0aGlzLl9zdWNjZXNzQ2FsbGJhY2s9aSx0aGlzLmluZGV4PXItMSx0aGlzLl9kb25lPSExfXJldHVybiBlLnByb3RvdHlwZS5leGVjdXRlTmV4dD1mdW5jdGlvbigpe3RoaXMuX2RvbmV8fCh0aGlzLmluZGV4KzE8dGhpcy5pdGVyYXRpb25zPygrK3RoaXMuaW5kZXgsdGhpcy5fZm4odGhpcykpOnRoaXMuYnJlYWtMb29wKCkpfSxlLnByb3RvdHlwZS5icmVha0xvb3A9ZnVuY3Rpb24oKXt0aGlzLl9kb25lPSEwLHRoaXMuX3N1Y2Nlc3NDYWxsYmFjaygpfSxlLlJ1bj1mdW5jdGlvbih0LGkscixuKXt2b2lkIDA9PT1uJiYobj0wKTt2YXIgbz1uZXcgZSh0LGkscixuKTtyZXR1cm4gby5leGVjdXRlTmV4dCgpLG99LGUuU3luY0FzeW5jRm9yTG9vcD1mdW5jdGlvbih0LGkscixuLG8scyl7dm9pZCAwPT09cyYmKHM9MCksZS5SdW4oTWF0aC5jZWlsKHQvaSksZnVuY3Rpb24oZSl7byYmbygpP2UuYnJlYWtMb29wKCk6c2V0VGltZW91dChmdW5jdGlvbigpe2Zvcih2YXIgbj0wO2k+bjsrK24pe3ZhciBzPWUuaW5kZXgqaStuO2lmKHM+PXQpYnJlYWs7aWYocihzKSxvJiZvKCkpe2UuYnJlYWtMb29wKCk7YnJlYWt9fWUuZXhlY3V0ZU5leHQoKX0scyl9LG4pfSxlfSgpO2UuQXN5bmNMb29wPW99KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0OyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoKXt0aGlzLl9pc0FscGhhQmxlbmREaXJ0eT0hMSx0aGlzLl9pc0JsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzRGlydHk9ITEsdGhpcy5fYWxwaGFCbGVuZD0hMSx0aGlzLl9ibGVuZEZ1bmN0aW9uUGFyYW1ldGVycz1uZXcgQXJyYXkoNCl9cmV0dXJuIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLnByb3RvdHlwZSxcImlzRGlydHlcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lzQWxwaGFCbGVuZERpcnR5fHx0aGlzLl9pc0JsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzRGlydHl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGUucHJvdG90eXBlLFwiYWxwaGFCbGVuZFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fYWxwaGFCbGVuZH0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX2FscGhhQmxlbmQhPT1lJiYodGhpcy5fYWxwaGFCbGVuZD1lLHRoaXMuX2lzQWxwaGFCbGVuZERpcnR5PSEwKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxlLnByb3RvdHlwZS5zZXRBbHBoYUJsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzPWZ1bmN0aW9uKGUsdCxpLHIpe3RoaXMuX2JsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzWzBdPT09ZSYmdGhpcy5fYmxlbmRGdW5jdGlvblBhcmFtZXRlcnNbMV09PT10JiZ0aGlzLl9ibGVuZEZ1bmN0aW9uUGFyYW1ldGVyc1syXT09PWkmJnRoaXMuX2JsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzWzNdPT09cnx8KHRoaXMuX2JsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzWzBdPWUsdGhpcy5fYmxlbmRGdW5jdGlvblBhcmFtZXRlcnNbMV09dCx0aGlzLl9ibGVuZEZ1bmN0aW9uUGFyYW1ldGVyc1syXT1pLHRoaXMuX2JsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzWzNdPXIsdGhpcy5faXNCbGVuZEZ1bmN0aW9uUGFyYW1ldGVyc0RpcnR5PSEwKX0sZS5wcm90b3R5cGUucmVzZXQ9ZnVuY3Rpb24oKXt0aGlzLl9hbHBoYUJsZW5kPSExLHRoaXMuX2JsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzWzBdPW51bGwsdGhpcy5fYmxlbmRGdW5jdGlvblBhcmFtZXRlcnNbMV09bnVsbCx0aGlzLl9ibGVuZEZ1bmN0aW9uUGFyYW1ldGVyc1syXT1udWxsLHRoaXMuX2JsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzWzNdPW51bGwsdGhpcy5faXNBbHBoYUJsZW5kRGlydHk9ITAsdGhpcy5faXNCbGVuZEZ1bmN0aW9uUGFyYW1ldGVyc0RpcnR5PSExfSxlLnByb3RvdHlwZS5hcHBseT1mdW5jdGlvbihlKXt0aGlzLmlzRGlydHkmJih0aGlzLl9pc0FscGhhQmxlbmREaXJ0eSYmKHRoaXMuX2FscGhhQmxlbmQ/ZS5lbmFibGUoZS5CTEVORCk6ZS5kaXNhYmxlKGUuQkxFTkQpLHRoaXMuX2lzQWxwaGFCbGVuZERpcnR5PSExKSx0aGlzLl9pc0JsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzRGlydHkmJihlLmJsZW5kRnVuY1NlcGFyYXRlKHRoaXMuX2JsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzWzBdLHRoaXMuX2JsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzWzFdLHRoaXMuX2JsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzWzJdLHRoaXMuX2JsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzWzNdKSx0aGlzLl9pc0JsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzRGlydHk9ITEpKX0sZX0oKTtlLl9BbHBoYVN0YXRlPXR9KHQ9ZS5JbnRlcm5hbHN8fChlLkludGVybmFscz17fSkpfShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdDshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7dGhpcy5faXNEZXB0aFRlc3REaXJ0eT0hMSx0aGlzLl9pc0RlcHRoTWFza0RpcnR5PSExLHRoaXMuX2lzRGVwdGhGdW5jRGlydHk9ITEsdGhpcy5faXNDdWxsRmFjZURpcnR5PSExLHRoaXMuX2lzQ3VsbERpcnR5PSExLHRoaXMuX2lzWk9mZnNldERpcnR5PSExfXJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkoZS5wcm90b3R5cGUsXCJpc0RpcnR5XCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9pc0RlcHRoRnVuY0RpcnR5fHx0aGlzLl9pc0RlcHRoVGVzdERpcnR5fHx0aGlzLl9pc0RlcHRoTWFza0RpcnR5fHx0aGlzLl9pc0N1bGxGYWNlRGlydHl8fHRoaXMuX2lzQ3VsbERpcnR5fHx0aGlzLl9pc1pPZmZzZXREaXJ0eX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZS5wcm90b3R5cGUsXCJ6T2Zmc2V0XCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl96T2Zmc2V0fSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fek9mZnNldCE9PWUmJih0aGlzLl96T2Zmc2V0PWUsdGhpcy5faXNaT2Zmc2V0RGlydHk9ITApfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLnByb3RvdHlwZSxcImN1bGxGYWNlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9jdWxsRmFjZX0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX2N1bGxGYWNlIT09ZSYmKHRoaXMuX2N1bGxGYWNlPWUsdGhpcy5faXNDdWxsRmFjZURpcnR5PSEwKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZS5wcm90b3R5cGUsXCJjdWxsXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9jdWxsfSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fY3VsbCE9PWUmJih0aGlzLl9jdWxsPWUsdGhpcy5faXNDdWxsRGlydHk9ITApfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLnByb3RvdHlwZSxcImRlcHRoRnVuY1wiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZGVwdGhGdW5jfSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fZGVwdGhGdW5jIT09ZSYmKHRoaXMuX2RlcHRoRnVuYz1lLHRoaXMuX2lzRGVwdGhGdW5jRGlydHk9ITApfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLnByb3RvdHlwZSxcImRlcHRoTWFza1wiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZGVwdGhNYXNrfSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fZGVwdGhNYXNrIT09ZSYmKHRoaXMuX2RlcHRoTWFzaz1lLHRoaXMuX2lzRGVwdGhNYXNrRGlydHk9ITApfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLnByb3RvdHlwZSxcImRlcHRoVGVzdFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZGVwdGhUZXN0fSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fZGVwdGhUZXN0IT09ZSYmKHRoaXMuX2RlcHRoVGVzdD1lLHRoaXMuX2lzRGVwdGhUZXN0RGlydHk9ITApfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLGUucHJvdG90eXBlLnJlc2V0PWZ1bmN0aW9uKCl7dGhpcy5fZGVwdGhNYXNrPSEwLHRoaXMuX2RlcHRoVGVzdD0hMCx0aGlzLl9kZXB0aEZ1bmM9bnVsbCx0aGlzLl9jdWxsRmFjZT1udWxsLHRoaXMuX2N1bGw9bnVsbCx0aGlzLl96T2Zmc2V0PTAsdGhpcy5faXNEZXB0aFRlc3REaXJ0eT0hMCx0aGlzLl9pc0RlcHRoTWFza0RpcnR5PSEwLHRoaXMuX2lzRGVwdGhGdW5jRGlydHk9ITEsdGhpcy5faXNDdWxsRmFjZURpcnR5PSExLHRoaXMuX2lzQ3VsbERpcnR5PSExLHRoaXMuX2lzWk9mZnNldERpcnR5PSExfSxlLnByb3RvdHlwZS5hcHBseT1mdW5jdGlvbihlKXt0aGlzLmlzRGlydHkmJih0aGlzLl9pc0N1bGxEaXJ0eSYmKHRoaXMuY3VsbD9lLmVuYWJsZShlLkNVTExfRkFDRSk6ZS5kaXNhYmxlKGUuQ1VMTF9GQUNFKSx0aGlzLl9pc0N1bGxEaXJ0eT0hMSksdGhpcy5faXNDdWxsRmFjZURpcnR5JiYoZS5jdWxsRmFjZSh0aGlzLmN1bGxGYWNlKSx0aGlzLl9pc0N1bGxGYWNlRGlydHk9ITEpLHRoaXMuX2lzRGVwdGhNYXNrRGlydHkmJihlLmRlcHRoTWFzayh0aGlzLmRlcHRoTWFzayksdGhpcy5faXNEZXB0aE1hc2tEaXJ0eT0hMSksdGhpcy5faXNEZXB0aFRlc3REaXJ0eSYmKHRoaXMuZGVwdGhUZXN0P2UuZW5hYmxlKGUuREVQVEhfVEVTVCk6ZS5kaXNhYmxlKGUuREVQVEhfVEVTVCksdGhpcy5faXNEZXB0aFRlc3REaXJ0eT0hMSksdGhpcy5faXNEZXB0aEZ1bmNEaXJ0eSYmKGUuZGVwdGhGdW5jKHRoaXMuZGVwdGhGdW5jKSx0aGlzLl9pc0RlcHRoRnVuY0RpcnR5PSExKSx0aGlzLl9pc1pPZmZzZXREaXJ0eSYmKHRoaXMuek9mZnNldD8oZS5lbmFibGUoZS5QT0xZR09OX09GRlNFVF9GSUxMKSxlLnBvbHlnb25PZmZzZXQodGhpcy56T2Zmc2V0LDApKTplLmRpc2FibGUoZS5QT0xZR09OX09GRlNFVF9GSUxMKSx0aGlzLl9pc1pPZmZzZXREaXJ0eT0hMSkpfSxlfSgpO2UuX0RlcHRoQ3VsbGluZ1N0YXRlPXR9KHQ9ZS5JbnRlcm5hbHN8fChlLkludGVybmFscz17fSkpfShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbihlLHQsaSxyKXt2YXIgbj1lLmNyZWF0ZVNoYWRlcihcInZlcnRleFwiPT09aT9lLlZFUlRFWF9TSEFERVI6ZS5GUkFHTUVOVF9TSEFERVIpO2lmKGUuc2hhZGVyU291cmNlKG4sKHI/citcIlxcblwiOlwiXCIpK3QpLGUuY29tcGlsZVNoYWRlcihuKSwhZS5nZXRTaGFkZXJQYXJhbWV0ZXIobixlLkNPTVBJTEVfU1RBVFVTKSl0aHJvdyBuZXcgRXJyb3IoZS5nZXRTaGFkZXJJbmZvTG9nKG4pKTtyZXR1cm4gbn0saT1mdW5jdGlvbihlLHQpe3ZhciBpPWUuVU5TSUdORURfQllURTtyZXR1cm4gdD09PWMuVEVYVFVSRVRZUEVfRkxPQVQmJihpPWUuRkxPQVQpLGl9LHI9ZnVuY3Rpb24odCxpLHIpe3ZhciBuPXIuTkVBUkVTVCxvPXIuTkVBUkVTVDtyZXR1cm4gdD09PWUuVGV4dHVyZS5CSUxJTkVBUl9TQU1QTElOR01PREU/KG49ci5MSU5FQVIsbz1pP3IuTElORUFSX01JUE1BUF9ORUFSRVNUOnIuTElORUFSKTp0PT09ZS5UZXh0dXJlLlRSSUxJTkVBUl9TQU1QTElOR01PREU/KG49ci5MSU5FQVIsbz1pP3IuTElORUFSX01JUE1BUF9MSU5FQVI6ci5MSU5FQVIpOnQ9PT1lLlRleHR1cmUuTkVBUkVTVF9TQU1QTElOR01PREUmJihuPXIuTkVBUkVTVCxvPWk/ci5ORUFSRVNUX01JUE1BUF9MSU5FQVI6ci5ORUFSRVNUKSx7bWluOm8sbWFnOm59fSxuPWZ1bmN0aW9uKHQsaSxuLG8scyxhLGgsYyxsLHUsZil7dm9pZCAwPT09ZiYmKGY9ZS5UZXh0dXJlLlRSSUxJTkVBUl9TQU1QTElOR01PREUpO3ZhciBkPW4uZ2V0RW5naW5lKCkscD1lLlRvb2xzLkdldEV4cG9uZW50T2ZUd28obyxkLmdldENhcHMoKS5tYXhUZXh0dXJlU2l6ZSksXz1lLlRvb2xzLkdldEV4cG9uZW50T2ZUd28ocyxkLmdldENhcHMoKS5tYXhUZXh0dXJlU2l6ZSk7aS5iaW5kVGV4dHVyZShpLlRFWFRVUkVfMkQsdCksaS5waXhlbFN0b3JlaShpLlVOUEFDS19GTElQX1lfV0VCR0wsdm9pZCAwPT09YT8xOmE/MTowKSx0Ll9iYXNlV2lkdGg9byx0Ll9iYXNlSGVpZ2h0PXMsdC5fd2lkdGg9cCx0Ll9oZWlnaHQ9Xyx0LmlzUmVhZHk9ITAsbChwLF8pO3ZhciBtPXIoZiwhaCxpKTtpLnRleFBhcmFtZXRlcmkoaS5URVhUVVJFXzJELGkuVEVYVFVSRV9NQUdfRklMVEVSLG0ubWFnKSxpLnRleFBhcmFtZXRlcmkoaS5URVhUVVJFXzJELGkuVEVYVFVSRV9NSU5fRklMVEVSLG0ubWluKSxofHxjfHxpLmdlbmVyYXRlTWlwbWFwKGkuVEVYVFVSRV8yRCksaS5iaW5kVGV4dHVyZShpLlRFWFRVUkVfMkQsbnVsbCksZC5yZXNldFRleHR1cmVDYWNoZSgpLG4uX3JlbW92ZVBlbmRpbmdEYXRhKHQpLHUmJnUoKX0sbz1mdW5jdGlvbih0LGkscixuLG8pe3ZhciBzLGE9ZnVuY3Rpb24oKXtyW2ldPXMsci5faW50ZXJuYWxDb3VudCsrLG4uX3JlbW92ZVBlbmRpbmdEYXRhKHMpLDY9PT1yLl9pbnRlcm5hbENvdW50JiZvKHIpfSxoPWZ1bmN0aW9uKCl7bi5fcmVtb3ZlUGVuZGluZ0RhdGEocyl9O3M9ZS5Ub29scy5Mb2FkSW1hZ2UodCxhLGgsbi5kYXRhYmFzZSksbi5fYWRkUGVuZGluZ0RhdGEocyl9LHM9ZnVuY3Rpb24oZSx0LGkscil7dmFyIG49W107bi5faW50ZXJuYWxDb3VudD0wO2Zvcih2YXIgcz0wOzY+cztzKyspbyhyW3NdLHMsbix0LGkpfSxhPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSgpe31yZXR1cm4gZX0oKTtlLkluc3RhbmNpbmdBdHRyaWJ1dGVJbmZvPWE7dmFyIGg9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7fXJldHVybiBlfSgpO2UuRW5naW5lQ2FwYWJpbGl0aWVzPWg7dmFyIGM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBvKHQsaSxyLG4pe3ZhciBzPXRoaXM7aWYodm9pZCAwPT09biYmKG49ITApLHRoaXMuaXNGdWxsc2NyZWVuPSExLHRoaXMuaXNQb2ludGVyTG9jaz0hMSx0aGlzLmN1bGxCYWNrRmFjZXM9ITAsdGhpcy5yZW5kZXJFdmVuSW5CYWNrZ3JvdW5kPSEwLHRoaXMuZW5hYmxlT2ZmbGluZVN1cHBvcnQ9ITAsdGhpcy5zY2VuZXM9bmV3IEFycmF5LHRoaXMuX3dpbmRvd0lzQmFja2dyb3VuZD0hMSx0aGlzLl93ZWJHTFZlcnNpb249XCIxLjBcIix0aGlzLl9kcmF3Q2FsbHM9MCx0aGlzLl9yZW5kZXJpbmdRdWV1ZUxhdW5jaGVkPSExLHRoaXMuX2FjdGl2ZVJlbmRlckxvb3BzPVtdLHRoaXMuZnBzUmFuZ2U9NjAsdGhpcy5wcmV2aW91c0ZyYW1lc0R1cmF0aW9uPVtdLHRoaXMuZnBzPTYwLHRoaXMuZGVsdGFUaW1lPTAsdGhpcy5fZGVwdGhDdWxsaW5nU3RhdGU9bmV3IGUuSW50ZXJuYWxzLl9EZXB0aEN1bGxpbmdTdGF0ZSx0aGlzLl9hbHBoYVN0YXRlPW5ldyBlLkludGVybmFscy5fQWxwaGFTdGF0ZSx0aGlzLl9hbHBoYU1vZGU9by5BTFBIQV9ESVNBQkxFLHRoaXMuX2xvYWRlZFRleHR1cmVzQ2FjaGU9bmV3IEFycmF5LHRoaXMuX21heFRleHR1cmVDaGFubmVscz0xNix0aGlzLl9hY3RpdmVUZXh0dXJlc0NhY2hlPW5ldyBBcnJheSh0aGlzLl9tYXhUZXh0dXJlQ2hhbm5lbHMpLHRoaXMuX2NvbXBpbGVkRWZmZWN0cz17fSx0aGlzLl91aW50SW5kaWNlc0N1cnJlbnRseVNldD0hMSx0aGlzLl9jdXJyZW50Qm91bmRCdWZmZXI9bmV3IEFycmF5LHRoaXMuX2N1cnJlbnRJbnN0YW5jZUxvY2F0aW9ucz1uZXcgQXJyYXksdGhpcy5fY3VycmVudEluc3RhbmNlQnVmZmVycz1uZXcgQXJyYXksdGhpcy5fcmVuZGVyaW5nQ2FudmFzPXQsdGhpcy5fZXh0ZXJuYWxEYXRhPW5ldyBlLlN0cmluZ0RpY3Rpb25hcnkscj1yfHx7fSxyLmFudGlhbGlhcz1pLHZvaWQgMD09PXIucHJlc2VydmVEcmF3aW5nQnVmZmVyJiYoci5wcmVzZXJ2ZURyYXdpbmdCdWZmZXI9ITEpLCF0aGlzLl9nbCl0cnl7dGhpcy5fZ2w9dC5nZXRDb250ZXh0KFwid2ViZ2xcIixyKXx8dC5nZXRDb250ZXh0KFwiZXhwZXJpbWVudGFsLXdlYmdsXCIscil9Y2F0Y2goYSl7dGhyb3cgbmV3IEVycm9yKFwiV2ViR0wgbm90IHN1cHBvcnRlZFwiKX1pZighdGhpcy5fZ2wpdGhyb3cgbmV3IEVycm9yKFwiV2ViR0wgbm90IHN1cHBvcnRlZFwiKTt0aGlzLl9vbkJsdXI9ZnVuY3Rpb24oKXtzLl93aW5kb3dJc0JhY2tncm91bmQ9ITB9LHRoaXMuX29uRm9jdXM9ZnVuY3Rpb24oKXtzLl93aW5kb3dJc0JhY2tncm91bmQ9ITF9LHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwiYmx1clwiLHRoaXMuX29uQmx1ciksd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJmb2N1c1wiLHRoaXMuX29uRm9jdXMpO3ZhciBjPXIubGltaXREZXZpY2VSYXRpb3x8d2luZG93LmRldmljZVBpeGVsUmF0aW98fDE7dGhpcy5faGFyZHdhcmVTY2FsaW5nTGV2ZWw9bj8xL01hdGgubWluKGMsd2luZG93LmRldmljZVBpeGVsUmF0aW98fDEpOjEsdGhpcy5yZXNpemUoKSx0aGlzLl9jYXBzPW5ldyBoLHRoaXMuX2NhcHMubWF4VGV4dHVyZXNJbWFnZVVuaXRzPXRoaXMuX2dsLmdldFBhcmFtZXRlcih0aGlzLl9nbC5NQVhfVEVYVFVSRV9JTUFHRV9VTklUUyksdGhpcy5fY2Fwcy5tYXhUZXh0dXJlU2l6ZT10aGlzLl9nbC5nZXRQYXJhbWV0ZXIodGhpcy5fZ2wuTUFYX1RFWFRVUkVfU0laRSksdGhpcy5fY2Fwcy5tYXhDdWJlbWFwVGV4dHVyZVNpemU9dGhpcy5fZ2wuZ2V0UGFyYW1ldGVyKHRoaXMuX2dsLk1BWF9DVUJFX01BUF9URVhUVVJFX1NJWkUpLFxudGhpcy5fY2Fwcy5tYXhSZW5kZXJUZXh0dXJlU2l6ZT10aGlzLl9nbC5nZXRQYXJhbWV0ZXIodGhpcy5fZ2wuTUFYX1JFTkRFUkJVRkZFUl9TSVpFKSx0aGlzLl9nbFZlcnNpb249dGhpcy5fZ2wuZ2V0UGFyYW1ldGVyKHRoaXMuX2dsLlZFUlNJT04pO3ZhciBsPXRoaXMuX2dsLmdldEV4dGVuc2lvbihcIldFQkdMX2RlYnVnX3JlbmRlcmVyX2luZm9cIik7aWYobnVsbCE9bCYmKHRoaXMuX2dsUmVuZGVyZXI9dGhpcy5fZ2wuZ2V0UGFyYW1ldGVyKGwuVU5NQVNLRURfUkVOREVSRVJfV0VCR0wpLHRoaXMuX2dsVmVuZG9yPXRoaXMuX2dsLmdldFBhcmFtZXRlcihsLlVOTUFTS0VEX1ZFTkRPUl9XRUJHTCkpLHRoaXMuX2dsVmVuZG9yfHwodGhpcy5fZ2xWZW5kb3I9XCJVbmtub3duIHZlbmRvclwiKSx0aGlzLl9nbFJlbmRlcmVyfHwodGhpcy5fZ2xSZW5kZXJlcj1cIlVua25vd24gcmVuZGVyZXJcIiksdGhpcy5fY2Fwcy5zdGFuZGFyZERlcml2YXRpdmVzPW51bGwhPT10aGlzLl9nbC5nZXRFeHRlbnNpb24oXCJPRVNfc3RhbmRhcmRfZGVyaXZhdGl2ZXNcIiksdGhpcy5fY2Fwcy5zM3RjPXRoaXMuX2dsLmdldEV4dGVuc2lvbihcIldFQkdMX2NvbXByZXNzZWRfdGV4dHVyZV9zM3RjXCIpLHRoaXMuX2NhcHMudGV4dHVyZUZsb2F0PW51bGwhPT10aGlzLl9nbC5nZXRFeHRlbnNpb24oXCJPRVNfdGV4dHVyZV9mbG9hdFwiKSx0aGlzLl9jYXBzLnRleHR1cmVBbmlzb3Ryb3BpY0ZpbHRlckV4dGVuc2lvbj10aGlzLl9nbC5nZXRFeHRlbnNpb24oXCJFWFRfdGV4dHVyZV9maWx0ZXJfYW5pc290cm9waWNcIil8fHRoaXMuX2dsLmdldEV4dGVuc2lvbihcIldFQktJVF9FWFRfdGV4dHVyZV9maWx0ZXJfYW5pc290cm9waWNcIil8fHRoaXMuX2dsLmdldEV4dGVuc2lvbihcIk1PWl9FWFRfdGV4dHVyZV9maWx0ZXJfYW5pc290cm9waWNcIiksdGhpcy5fY2Fwcy5tYXhBbmlzb3Ryb3B5PXRoaXMuX2NhcHMudGV4dHVyZUFuaXNvdHJvcGljRmlsdGVyRXh0ZW5zaW9uP3RoaXMuX2dsLmdldFBhcmFtZXRlcih0aGlzLl9jYXBzLnRleHR1cmVBbmlzb3Ryb3BpY0ZpbHRlckV4dGVuc2lvbi5NQVhfVEVYVFVSRV9NQVhfQU5JU09UUk9QWV9FWFQpOjAsdGhpcy5fY2Fwcy5pbnN0YW5jZWRBcnJheXM9dGhpcy5fZ2wuZ2V0RXh0ZW5zaW9uKFwiQU5HTEVfaW5zdGFuY2VkX2FycmF5c1wiKSx0aGlzLl9jYXBzLnVpbnRJbmRpY2VzPW51bGwhPT10aGlzLl9nbC5nZXRFeHRlbnNpb24oXCJPRVNfZWxlbWVudF9pbmRleF91aW50XCIpLHRoaXMuX2NhcHMuZnJhZ21lbnREZXB0aFN1cHBvcnRlZD1udWxsIT09dGhpcy5fZ2wuZ2V0RXh0ZW5zaW9uKFwiRVhUX2ZyYWdfZGVwdGhcIiksdGhpcy5fY2Fwcy5oaWdoUHJlY2lzaW9uU2hhZGVyU3VwcG9ydGVkPSEwLHRoaXMuX2NhcHMuZHJhd0J1ZmZlcnNFeHRlbnNpb249dGhpcy5fZ2wuZ2V0RXh0ZW5zaW9uKFwiV0VCR0xfZHJhd19idWZmZXJzXCIpLHRoaXMuX2NhcHMudGV4dHVyZUZsb2F0TGluZWFyRmlsdGVyaW5nPXRoaXMuX2dsLmdldEV4dGVuc2lvbihcIk9FU190ZXh0dXJlX2Zsb2F0X2xpbmVhclwiKSx0aGlzLl9jYXBzLnRleHR1cmVMT0Q9dGhpcy5fZ2wuZ2V0RXh0ZW5zaW9uKFwiRVhUX3NoYWRlcl90ZXh0dXJlX2xvZFwiKSx0aGlzLl9nbC5nZXRTaGFkZXJQcmVjaXNpb25Gb3JtYXQpe3ZhciB1PXRoaXMuX2dsLmdldFNoYWRlclByZWNpc2lvbkZvcm1hdCh0aGlzLl9nbC5GUkFHTUVOVF9TSEFERVIsdGhpcy5fZ2wuSElHSF9GTE9BVCk7dGhpcy5fY2Fwcy5oaWdoUHJlY2lzaW9uU2hhZGVyU3VwcG9ydGVkPTAhPT11LnByZWNpc2lvbn10aGlzLnNldERlcHRoQnVmZmVyKCEwKSx0aGlzLnNldERlcHRoRnVuY3Rpb25Ub0xlc3NPckVxdWFsKCksdGhpcy5zZXREZXB0aFdyaXRlKCEwKSx0aGlzLl9vbkZ1bGxzY3JlZW5DaGFuZ2U9ZnVuY3Rpb24oKXt2b2lkIDAhPT1kb2N1bWVudC5mdWxsc2NyZWVuP3MuaXNGdWxsc2NyZWVuPWRvY3VtZW50LmZ1bGxzY3JlZW46dm9pZCAwIT09ZG9jdW1lbnQubW96RnVsbFNjcmVlbj9zLmlzRnVsbHNjcmVlbj1kb2N1bWVudC5tb3pGdWxsU2NyZWVuOnZvaWQgMCE9PWRvY3VtZW50LndlYmtpdElzRnVsbFNjcmVlbj9zLmlzRnVsbHNjcmVlbj1kb2N1bWVudC53ZWJraXRJc0Z1bGxTY3JlZW46dm9pZCAwIT09ZG9jdW1lbnQubXNJc0Z1bGxTY3JlZW4mJihzLmlzRnVsbHNjcmVlbj1kb2N1bWVudC5tc0lzRnVsbFNjcmVlbikscy5pc0Z1bGxzY3JlZW4mJnMuX3BvaW50ZXJMb2NrUmVxdWVzdGVkJiYodC5yZXF1ZXN0UG9pbnRlckxvY2s9dC5yZXF1ZXN0UG9pbnRlckxvY2t8fHQubXNSZXF1ZXN0UG9pbnRlckxvY2t8fHQubW96UmVxdWVzdFBvaW50ZXJMb2NrfHx0LndlYmtpdFJlcXVlc3RQb2ludGVyTG9jayx0LnJlcXVlc3RQb2ludGVyTG9jayYmdC5yZXF1ZXN0UG9pbnRlckxvY2soKSl9LGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJmdWxsc2NyZWVuY2hhbmdlXCIsdGhpcy5fb25GdWxsc2NyZWVuQ2hhbmdlLCExKSxkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwibW96ZnVsbHNjcmVlbmNoYW5nZVwiLHRoaXMuX29uRnVsbHNjcmVlbkNoYW5nZSwhMSksZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIndlYmtpdGZ1bGxzY3JlZW5jaGFuZ2VcIix0aGlzLl9vbkZ1bGxzY3JlZW5DaGFuZ2UsITEpLGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtc2Z1bGxzY3JlZW5jaGFuZ2VcIix0aGlzLl9vbkZ1bGxzY3JlZW5DaGFuZ2UsITEpLHRoaXMuX29uUG9pbnRlckxvY2tDaGFuZ2U9ZnVuY3Rpb24oKXtzLmlzUG9pbnRlckxvY2s9ZG9jdW1lbnQubW96UG9pbnRlckxvY2tFbGVtZW50PT09dHx8ZG9jdW1lbnQud2Via2l0UG9pbnRlckxvY2tFbGVtZW50PT09dHx8ZG9jdW1lbnQubXNQb2ludGVyTG9ja0VsZW1lbnQ9PT10fHxkb2N1bWVudC5wb2ludGVyTG9ja0VsZW1lbnQ9PT10fSxkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwicG9pbnRlcmxvY2tjaGFuZ2VcIix0aGlzLl9vblBvaW50ZXJMb2NrQ2hhbmdlLCExKSxkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwibXNwb2ludGVybG9ja2NoYW5nZVwiLHRoaXMuX29uUG9pbnRlckxvY2tDaGFuZ2UsITEpLGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3pwb2ludGVybG9ja2NoYW5nZVwiLHRoaXMuX29uUG9pbnRlckxvY2tDaGFuZ2UsITEpLGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ3ZWJraXRwb2ludGVybG9ja2NoYW5nZVwiLHRoaXMuX29uUG9pbnRlckxvY2tDaGFuZ2UsITEpLGUuQXVkaW9FbmdpbmUmJiFvLmF1ZGlvRW5naW5lJiYoby5hdWRpb0VuZ2luZT1uZXcgZS5BdWRpb0VuZ2luZSksdGhpcy5fbG9hZGluZ1NjcmVlbj1uZXcgZS5EZWZhdWx0TG9hZGluZ1NjcmVlbih0aGlzLl9yZW5kZXJpbmdDYW52YXMpLGUuVG9vbHMuTG9nKFwiQmFieWxvbi5qcyBlbmdpbmUgKHZcIitvLlZlcnNpb24rXCIpIGxhdW5jaGVkXCIpfXJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkobyxcIkFMUEhBX0RJU0FCTEVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIG8uX0FMUEhBX0RJU0FCTEV9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sXCJBTFBIQV9PTkVPTkVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIG8uX0FMUEhBX09ORU9ORX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkobyxcIkFMUEhBX0FERFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gby5fQUxQSEFfQUREfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLFwiQUxQSEFfQ09NQklORVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gby5fQUxQSEFfQ09NQklORX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkobyxcIkFMUEhBX1NVQlRSQUNUXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBvLl9BTFBIQV9TVUJUUkFDVH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkobyxcIkFMUEhBX01VTFRJUExZXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBvLl9BTFBIQV9NVUxUSVBMWX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkobyxcIkFMUEhBX01BWElNSVpFRFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gby5fQUxQSEFfTUFYSU1JWkVEfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLFwiREVMQVlMT0FEU1RBVEVfTk9ORVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gby5fREVMQVlMT0FEU1RBVEVfTk9ORX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkobyxcIkRFTEFZTE9BRFNUQVRFX0xPQURFRFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gby5fREVMQVlMT0FEU1RBVEVfTE9BREVEfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLFwiREVMQVlMT0FEU1RBVEVfTE9BRElOR1wiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gby5fREVMQVlMT0FEU1RBVEVfTE9BRElOR30sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkobyxcIkRFTEFZTE9BRFNUQVRFX05PVExPQURFRFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gby5fREVMQVlMT0FEU1RBVEVfTk9UTE9BREVEfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLFwiVEVYVFVSRUZPUk1BVF9BTFBIQVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gby5fVEVYVFVSRUZPUk1BVF9BTFBIQX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkobyxcIlRFWFRVUkVGT1JNQVRfTFVNSU5BTkNFXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBvLl9URVhUVVJFRk9STUFUX0xVTUlOQU5DRX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkobyxcIlRFWFRVUkVGT1JNQVRfTFVNSU5BTkNFX0FMUEhBXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBvLl9URVhUVVJFRk9STUFUX0xVTUlOQU5DRV9BTFBIQX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkobyxcIlRFWFRVUkVGT1JNQVRfUkdCXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBvLl9URVhUVVJFRk9STUFUX1JHQn0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkobyxcIlRFWFRVUkVGT1JNQVRfUkdCQVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gby5fVEVYVFVSRUZPUk1BVF9SR0JBfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLFwiVEVYVFVSRVRZUEVfVU5TSUdORURfSU5UXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBvLl9URVhUVVJFVFlQRV9VTlNJR05FRF9JTlR9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sXCJURVhUVVJFVFlQRV9GTE9BVFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gby5fVEVYVFVSRVRZUEVfRkxPQVR9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sXCJWZXJzaW9uXCIse2dldDpmdW5jdGlvbigpe3JldHVyblwiMi40LjBcIn0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoby5wcm90b3R5cGUsXCJ3ZWJHTFZlcnNpb25cIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3dlYkdMVmVyc2lvbn0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxvLnByb3RvdHlwZS5fcHJlcGFyZVdvcmtpbmdDYW52YXM9ZnVuY3Rpb24oKXt0aGlzLl93b3JraW5nQ2FudmFzfHwodGhpcy5fd29ya2luZ0NhbnZhcz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpLHRoaXMuX3dvcmtpbmdDb250ZXh0PXRoaXMuX3dvcmtpbmdDYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpKX0sby5wcm90b3R5cGUucmVzZXRUZXh0dXJlQ2FjaGU9ZnVuY3Rpb24oKXtmb3IodmFyIGU9MDtlPHRoaXMuX21heFRleHR1cmVDaGFubmVscztlKyspdGhpcy5fYWN0aXZlVGV4dHVyZXNDYWNoZVtlXT1udWxsfSxvLnByb3RvdHlwZS5nZXRHbEluZm89ZnVuY3Rpb24oKXtyZXR1cm57dmVuZG9yOnRoaXMuX2dsVmVuZG9yLHJlbmRlcmVyOnRoaXMuX2dsUmVuZGVyZXIsdmVyc2lvbjp0aGlzLl9nbFZlcnNpb259fSxvLnByb3RvdHlwZS5nZXRBc3BlY3RSYXRpbz1mdW5jdGlvbihlLHQpe3ZvaWQgMD09PXQmJih0PSExKTt2YXIgaT1lLnZpZXdwb3J0O3JldHVybiB0aGlzLmdldFJlbmRlcldpZHRoKHQpKmkud2lkdGgvKHRoaXMuZ2V0UmVuZGVySGVpZ2h0KHQpKmkuaGVpZ2h0KX0sby5wcm90b3R5cGUuZ2V0UmVuZGVyV2lkdGg9ZnVuY3Rpb24oZSl7cmV0dXJuIHZvaWQgMD09PWUmJihlPSExKSwhZSYmdGhpcy5fY3VycmVudFJlbmRlclRhcmdldD90aGlzLl9jdXJyZW50UmVuZGVyVGFyZ2V0Ll93aWR0aDp0aGlzLl9yZW5kZXJpbmdDYW52YXMud2lkdGh9LG8ucHJvdG90eXBlLmdldFJlbmRlckhlaWdodD1mdW5jdGlvbihlKXtyZXR1cm4gdm9pZCAwPT09ZSYmKGU9ITEpLCFlJiZ0aGlzLl9jdXJyZW50UmVuZGVyVGFyZ2V0P3RoaXMuX2N1cnJlbnRSZW5kZXJUYXJnZXQuX2hlaWdodDp0aGlzLl9yZW5kZXJpbmdDYW52YXMuaGVpZ2h0fSxvLnByb3RvdHlwZS5nZXRSZW5kZXJpbmdDYW52YXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcmVuZGVyaW5nQ2FudmFzfSxvLnByb3RvdHlwZS5nZXRSZW5kZXJpbmdDYW52YXNDbGllbnRSZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3JlbmRlcmluZ0NhbnZhcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKX0sby5wcm90b3R5cGUuc2V0SGFyZHdhcmVTY2FsaW5nTGV2ZWw9ZnVuY3Rpb24oZSl7dGhpcy5faGFyZHdhcmVTY2FsaW5nTGV2ZWw9ZSx0aGlzLnJlc2l6ZSgpfSxvLnByb3RvdHlwZS5nZXRIYXJkd2FyZVNjYWxpbmdMZXZlbD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9oYXJkd2FyZVNjYWxpbmdMZXZlbH0sby5wcm90b3R5cGUuZ2V0TG9hZGVkVGV4dHVyZXNDYWNoZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9sb2FkZWRUZXh0dXJlc0NhY2hlfSxvLnByb3RvdHlwZS5nZXRDYXBzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2NhcHN9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLnByb3RvdHlwZSxcImRyYXdDYWxsc1wiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZHJhd0NhbGxzfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLG8ucHJvdG90eXBlLnJlc2V0RHJhd0NhbGxzPWZ1bmN0aW9uKCl7dGhpcy5fZHJhd0NhbGxzPTB9LG8ucHJvdG90eXBlLmdldERlcHRoRnVuY3Rpb249ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZGVwdGhDdWxsaW5nU3RhdGUuZGVwdGhGdW5jfSxvLnByb3RvdHlwZS5zZXREZXB0aEZ1bmN0aW9uPWZ1bmN0aW9uKGUpe3RoaXMuX2RlcHRoQ3VsbGluZ1N0YXRlLmRlcHRoRnVuYz1lfSxvLnByb3RvdHlwZS5zZXREZXB0aEZ1bmN0aW9uVG9HcmVhdGVyPWZ1bmN0aW9uKCl7dGhpcy5fZGVwdGhDdWxsaW5nU3RhdGUuZGVwdGhGdW5jPXRoaXMuX2dsLkdSRUFURVJ9LG8ucHJvdG90eXBlLnNldERlcHRoRnVuY3Rpb25Ub0dyZWF0ZXJPckVxdWFsPWZ1bmN0aW9uKCl7dGhpcy5fZGVwdGhDdWxsaW5nU3RhdGUuZGVwdGhGdW5jPXRoaXMuX2dsLkdFUVVBTH0sby5wcm90b3R5cGUuc2V0RGVwdGhGdW5jdGlvblRvTGVzcz1mdW5jdGlvbigpe3RoaXMuX2RlcHRoQ3VsbGluZ1N0YXRlLmRlcHRoRnVuYz10aGlzLl9nbC5MRVNTfSxvLnByb3RvdHlwZS5zZXREZXB0aEZ1bmN0aW9uVG9MZXNzT3JFcXVhbD1mdW5jdGlvbigpe3RoaXMuX2RlcHRoQ3VsbGluZ1N0YXRlLmRlcHRoRnVuYz10aGlzLl9nbC5MRVFVQUx9LG8ucHJvdG90eXBlLnN0b3BSZW5kZXJMb29wPWZ1bmN0aW9uKGUpe2lmKCFlKXJldHVybiB2b2lkKHRoaXMuX2FjdGl2ZVJlbmRlckxvb3BzPVtdKTt2YXIgdD10aGlzLl9hY3RpdmVSZW5kZXJMb29wcy5pbmRleE9mKGUpO3Q+PTAmJnRoaXMuX2FjdGl2ZVJlbmRlckxvb3BzLnNwbGljZSh0LDEpfSxvLnByb3RvdHlwZS5fcmVuZGVyTG9vcD1mdW5jdGlvbigpe3ZhciB0PSEwO2lmKCF0aGlzLnJlbmRlckV2ZW5JbkJhY2tncm91bmQmJnRoaXMuX3dpbmRvd0lzQmFja2dyb3VuZCYmKHQ9ITEpLHQpe3RoaXMuYmVnaW5GcmFtZSgpO2Zvcih2YXIgaT0wO2k8dGhpcy5fYWN0aXZlUmVuZGVyTG9vcHMubGVuZ3RoO2krKyl7dmFyIHI9dGhpcy5fYWN0aXZlUmVuZGVyTG9vcHNbaV07cigpfXRoaXMuZW5kRnJhbWUoKX10aGlzLl9hY3RpdmVSZW5kZXJMb29wcy5sZW5ndGg+MD9lLlRvb2xzLlF1ZXVlTmV3RnJhbWUodGhpcy5fYmluZGVkUmVuZGVyRnVuY3Rpb24pOnRoaXMuX3JlbmRlcmluZ1F1ZXVlTGF1bmNoZWQ9ITF9LG8ucHJvdG90eXBlLnJ1blJlbmRlckxvb3A9ZnVuY3Rpb24odCl7LTE9PT10aGlzLl9hY3RpdmVSZW5kZXJMb29wcy5pbmRleE9mKHQpJiYodGhpcy5fYWN0aXZlUmVuZGVyTG9vcHMucHVzaCh0KSx0aGlzLl9yZW5kZXJpbmdRdWV1ZUxhdW5jaGVkfHwodGhpcy5fcmVuZGVyaW5nUXVldWVMYXVuY2hlZD0hMCx0aGlzLl9iaW5kZWRSZW5kZXJGdW5jdGlvbj10aGlzLl9yZW5kZXJMb29wLmJpbmQodGhpcyksZS5Ub29scy5RdWV1ZU5ld0ZyYW1lKHRoaXMuX2JpbmRlZFJlbmRlckZ1bmN0aW9uKSkpfSxvLnByb3RvdHlwZS5zd2l0Y2hGdWxsc2NyZWVuPWZ1bmN0aW9uKHQsaSl7dGhpcy5pc0Z1bGxzY3JlZW4/ZS5Ub29scy5FeGl0RnVsbHNjcmVlbigpOih0aGlzLl9wb2ludGVyTG9ja1JlcXVlc3RlZD10LGUuVG9vbHMuUmVxdWVzdEZ1bGxzY3JlZW4odGhpcy5fcmVuZGVyaW5nQ2FudmFzLGkpKX0sby5wcm90b3R5cGUuY2xlYXI9ZnVuY3Rpb24oZSx0LGkpe3RoaXMuYXBwbHlTdGF0ZXMoKSx0JiZ0aGlzLl9nbC5jbGVhckNvbG9yKGUucixlLmcsZS5iLHZvaWQgMCE9PWUuYT9lLmE6MSksaSYmdGhpcy5fZGVwdGhDdWxsaW5nU3RhdGUuZGVwdGhNYXNrJiZ0aGlzLl9nbC5jbGVhckRlcHRoKDEpO3ZhciByPTA7dCYmKHJ8PXRoaXMuX2dsLkNPTE9SX0JVRkZFUl9CSVQpLGkmJnRoaXMuX2RlcHRoQ3VsbGluZ1N0YXRlLmRlcHRoTWFzayYmKHJ8PXRoaXMuX2dsLkRFUFRIX0JVRkZFUl9CSVQpLHRoaXMuX2dsLmNsZWFyKHIpfSxvLnByb3RvdHlwZS5zY2lzc29yQ2xlYXI9ZnVuY3Rpb24oZSx0LGkscixuKXt2YXIgbz10aGlzLl9nbCxzPW8uZ2V0UGFyYW1ldGVyKG8uU0NJU1NPUl9URVNUKSxhPW8uZ2V0UGFyYW1ldGVyKG8uU0NJU1NPUl9CT1gpO28uZW5hYmxlKG8uU0NJU1NPUl9URVNUKSxvLnNjaXNzb3IoZSx0LGksciksdGhpcy5jbGVhcihuLCEwLCEwKSxvLnNjaXNzb3IoYVswXSxhWzFdLGFbMl0sYVszXSkscz09PSEwP28uZW5hYmxlKG8uU0NJU1NPUl9URVNUKTpvLmRpc2FibGUoby5TQ0lTU09SX1RFU1QpfSxvLnByb3RvdHlwZS5zZXRWaWV3cG9ydD1mdW5jdGlvbihlLHQsaSl7dmFyIHI9dHx8KG5hdmlnYXRvci5pc0NvY29vbkpTP3dpbmRvdy5pbm5lcldpZHRoOnRoaXMuX3JlbmRlcmluZ0NhbnZhcy53aWR0aCksbj1pfHwobmF2aWdhdG9yLmlzQ29jb29uSlM/d2luZG93LmlubmVySGVpZ2h0OnRoaXMuX3JlbmRlcmluZ0NhbnZhcy5oZWlnaHQpLG89ZS54fHwwLHM9ZS55fHwwO3RoaXMuX2NhY2hlZFZpZXdwb3J0PWUsdGhpcy5fZ2wudmlld3BvcnQobypyLHMqbixyKmUud2lkdGgsbiplLmhlaWdodCl9LG8ucHJvdG90eXBlLnNldERpcmVjdFZpZXdwb3J0PWZ1bmN0aW9uKGUsdCxpLHIpe3ZhciBuPXRoaXMuX2NhY2hlZFZpZXdwb3J0O3JldHVybiB0aGlzLl9jYWNoZWRWaWV3cG9ydD1udWxsLHRoaXMuX2dsLnZpZXdwb3J0KGUsdCxpLHIpLG59LG8ucHJvdG90eXBlLmJlZ2luRnJhbWU9ZnVuY3Rpb24oKXt0aGlzLl9tZWFzdXJlRnBzKCl9LG8ucHJvdG90eXBlLmVuZEZyYW1lPWZ1bmN0aW9uKCl7fSxvLnByb3RvdHlwZS5yZXNpemU9ZnVuY3Rpb24oKXt2YXIgZT1uYXZpZ2F0b3IuaXNDb2Nvb25KUz93aW5kb3cuaW5uZXJXaWR0aDp0aGlzLl9yZW5kZXJpbmdDYW52YXMuY2xpZW50V2lkdGgsdD1uYXZpZ2F0b3IuaXNDb2Nvb25KUz93aW5kb3cuaW5uZXJIZWlnaHQ6dGhpcy5fcmVuZGVyaW5nQ2FudmFzLmNsaWVudEhlaWdodDt0aGlzLnNldFNpemUoZS90aGlzLl9oYXJkd2FyZVNjYWxpbmdMZXZlbCx0L3RoaXMuX2hhcmR3YXJlU2NhbGluZ0xldmVsKTtmb3IodmFyIGk9MDtpPHRoaXMuc2NlbmVzLmxlbmd0aDtpKyspe3ZhciByPXRoaXMuc2NlbmVzW2ldO3IuZGVidWdMYXllci5pc1Zpc2libGUoKSYmci5kZWJ1Z0xheWVyLl9zeW5jUG9zaXRpb25zKCl9fSxvLnByb3RvdHlwZS5zZXRTaXplPWZ1bmN0aW9uKGUsdCl7dGhpcy5fcmVuZGVyaW5nQ2FudmFzLndpZHRoPWUsdGhpcy5fcmVuZGVyaW5nQ2FudmFzLmhlaWdodD10O2Zvcih2YXIgaT0wO2k8dGhpcy5zY2VuZXMubGVuZ3RoO2krKylmb3IodmFyIHI9dGhpcy5zY2VuZXNbaV0sbj0wO248ci5jYW1lcmFzLmxlbmd0aDtuKyspe3ZhciBvPXIuY2FtZXJhc1tuXTtvLl9jdXJyZW50UmVuZGVySWQ9MH19LG8ucHJvdG90eXBlLmJpbmRGcmFtZWJ1ZmZlcj1mdW5jdGlvbihlLHQsaSxyKXt0aGlzLl9jdXJyZW50UmVuZGVyVGFyZ2V0PWU7dmFyIG49dGhpcy5fZ2w7bi5iaW5kRnJhbWVidWZmZXIobi5GUkFNRUJVRkZFUixlLl9mcmFtZWJ1ZmZlciksZS5pc0N1YmU/bi5mcmFtZWJ1ZmZlclRleHR1cmUyRChuLkZSQU1FQlVGRkVSLG4uQ09MT1JfQVRUQUNITUVOVDAsbi5URVhUVVJFX0NVQkVfTUFQX1BPU0lUSVZFX1grdCxlLDApOm4uZnJhbWVidWZmZXJUZXh0dXJlMkQobi5GUkFNRUJVRkZFUixuLkNPTE9SX0FUVEFDSE1FTlQwLG4uVEVYVFVSRV8yRCxlLDApLHRoaXMuX2dsLnZpZXdwb3J0KDAsMCxpfHxlLl93aWR0aCxyfHxlLl9oZWlnaHQpLHRoaXMud2lwZUNhY2hlcygpfSxvLnByb3RvdHlwZS51bkJpbmRGcmFtZWJ1ZmZlcj1mdW5jdGlvbihlLHQpe2lmKHZvaWQgMD09PXQmJih0PSExKSx0aGlzLl9jdXJyZW50UmVuZGVyVGFyZ2V0PW51bGwsZS5nZW5lcmF0ZU1pcE1hcHMmJiF0KXt2YXIgaT10aGlzLl9nbDtpLmJpbmRUZXh0dXJlKGkuVEVYVFVSRV8yRCxlKSxpLmdlbmVyYXRlTWlwbWFwKGkuVEVYVFVSRV8yRCksaS5iaW5kVGV4dHVyZShpLlRFWFRVUkVfMkQsbnVsbCl9dGhpcy5fZ2wuYmluZEZyYW1lYnVmZmVyKHRoaXMuX2dsLkZSQU1FQlVGRkVSLG51bGwpfSxvLnByb3RvdHlwZS5nZW5lcmF0ZU1pcE1hcHNGb3JDdWJlbWFwPWZ1bmN0aW9uKGUpe2lmKGUuZ2VuZXJhdGVNaXBNYXBzKXt2YXIgdD10aGlzLl9nbDt0LmJpbmRUZXh0dXJlKHQuVEVYVFVSRV9DVUJFX01BUCxlKSx0LmdlbmVyYXRlTWlwbWFwKHQuVEVYVFVSRV9DVUJFX01BUCksdC5iaW5kVGV4dHVyZSh0LlRFWFRVUkVfQ1VCRV9NQVAsbnVsbCl9fSxvLnByb3RvdHlwZS5mbHVzaEZyYW1lYnVmZmVyPWZ1bmN0aW9uKCl7dGhpcy5fZ2wuZmx1c2goKX0sby5wcm90b3R5cGUucmVzdG9yZURlZmF1bHRGcmFtZWJ1ZmZlcj1mdW5jdGlvbigpe3RoaXMuX2N1cnJlbnRSZW5kZXJUYXJnZXQ9bnVsbCx0aGlzLl9nbC5iaW5kRnJhbWVidWZmZXIodGhpcy5fZ2wuRlJBTUVCVUZGRVIsbnVsbCksdGhpcy5zZXRWaWV3cG9ydCh0aGlzLl9jYWNoZWRWaWV3cG9ydCksdGhpcy53aXBlQ2FjaGVzKCl9LG8ucHJvdG90eXBlLl9yZXNldFZlcnRleEJ1ZmZlckJpbmRpbmc9ZnVuY3Rpb24oKXt0aGlzLmJpbmRCdWZmZXIobnVsbCx0aGlzLl9nbC5BUlJBWV9CVUZGRVIpLHRoaXMuX2NhY2hlZFZlcnRleEJ1ZmZlcnM9bnVsbH0sby5wcm90b3R5cGUuY3JlYXRlVmVydGV4QnVmZmVyPWZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuX2dsLmNyZWF0ZUJ1ZmZlcigpO3JldHVybiB0aGlzLmJpbmRCdWZmZXIodCx0aGlzLl9nbC5BUlJBWV9CVUZGRVIpLGUgaW5zdGFuY2VvZiBGbG9hdDMyQXJyYXk/dGhpcy5fZ2wuYnVmZmVyRGF0YSh0aGlzLl9nbC5BUlJBWV9CVUZGRVIsZSx0aGlzLl9nbC5TVEFUSUNfRFJBVyk6dGhpcy5fZ2wuYnVmZmVyRGF0YSh0aGlzLl9nbC5BUlJBWV9CVUZGRVIsbmV3IEZsb2F0MzJBcnJheShlKSx0aGlzLl9nbC5TVEFUSUNfRFJBVyksdGhpcy5fcmVzZXRWZXJ0ZXhCdWZmZXJCaW5kaW5nKCksdC5yZWZlcmVuY2VzPTEsdH0sby5wcm90b3R5cGUuY3JlYXRlRHluYW1pY1ZlcnRleEJ1ZmZlcj1mdW5jdGlvbihlKXt2YXIgdD10aGlzLl9nbC5jcmVhdGVCdWZmZXIoKTtyZXR1cm4gdGhpcy5iaW5kQnVmZmVyKHQsdGhpcy5fZ2wuQVJSQVlfQlVGRkVSKSxlIGluc3RhbmNlb2YgRmxvYXQzMkFycmF5P3RoaXMuX2dsLmJ1ZmZlckRhdGEodGhpcy5fZ2wuQVJSQVlfQlVGRkVSLGUsdGhpcy5fZ2wuRFlOQU1JQ19EUkFXKTp0aGlzLl9nbC5idWZmZXJEYXRhKHRoaXMuX2dsLkFSUkFZX0JVRkZFUixuZXcgRmxvYXQzMkFycmF5KGUpLHRoaXMuX2dsLkRZTkFNSUNfRFJBVyksdGhpcy5fcmVzZXRWZXJ0ZXhCdWZmZXJCaW5kaW5nKCksdC5yZWZlcmVuY2VzPTEsdH0sby5wcm90b3R5cGUudXBkYXRlRHluYW1pY1ZlcnRleEJ1ZmZlcj1mdW5jdGlvbihlLHQsaSxyKXt0aGlzLmJpbmRCdWZmZXIoZSx0aGlzLl9nbC5BUlJBWV9CVUZGRVIpLHZvaWQgMD09PWkmJihpPTApLHZvaWQgMD09PXI/dCBpbnN0YW5jZW9mIEZsb2F0MzJBcnJheT90aGlzLl9nbC5idWZmZXJTdWJEYXRhKHRoaXMuX2dsLkFSUkFZX0JVRkZFUixpLHQpOnRoaXMuX2dsLmJ1ZmZlclN1YkRhdGEodGhpcy5fZ2wuQVJSQVlfQlVGRkVSLGksbmV3IEZsb2F0MzJBcnJheSh0KSk6dCBpbnN0YW5jZW9mIEZsb2F0MzJBcnJheT90aGlzLl9nbC5idWZmZXJTdWJEYXRhKHRoaXMuX2dsLkFSUkFZX0JVRkZFUiwwLHQuc3ViYXJyYXkoaSxpK3IpKTp0aGlzLl9nbC5idWZmZXJTdWJEYXRhKHRoaXMuX2dsLkFSUkFZX0JVRkZFUiwwLG5ldyBGbG9hdDMyQXJyYXkodCkuc3ViYXJyYXkoaSxpK3IpKSx0aGlzLl9yZXNldFZlcnRleEJ1ZmZlckJpbmRpbmcoKX0sby5wcm90b3R5cGUuX3Jlc2V0SW5kZXhCdWZmZXJCaW5kaW5nPWZ1bmN0aW9uKCl7dGhpcy5iaW5kQnVmZmVyKG51bGwsdGhpcy5fZ2wuRUxFTUVOVF9BUlJBWV9CVUZGRVIpLHRoaXMuX2NhY2hlZEluZGV4QnVmZmVyPW51bGx9LG8ucHJvdG90eXBlLmNyZWF0ZUluZGV4QnVmZmVyPWZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuX2dsLmNyZWF0ZUJ1ZmZlcigpO3RoaXMuYmluZEJ1ZmZlcih0LHRoaXMuX2dsLkVMRU1FTlRfQVJSQVlfQlVGRkVSKTt2YXIgaSxyPSExO2lmKHRoaXMuX2NhcHMudWludEluZGljZXMpe2Zvcih2YXIgbj0wO248ZS5sZW5ndGg7bisrKWlmKGVbbl0+NjU1MzUpe3I9ITA7YnJlYWt9aT1yP25ldyBVaW50MzJBcnJheShlKTpuZXcgVWludDE2QXJyYXkoZSl9ZWxzZSBpPW5ldyBVaW50MTZBcnJheShlKTtyZXR1cm4gdGhpcy5fZ2wuYnVmZmVyRGF0YSh0aGlzLl9nbC5FTEVNRU5UX0FSUkFZX0JVRkZFUixpLHRoaXMuX2dsLlNUQVRJQ19EUkFXKSx0aGlzLl9yZXNldEluZGV4QnVmZmVyQmluZGluZygpLHQucmVmZXJlbmNlcz0xLHQuaXMzMkJpdHM9cix0fSxvLnByb3RvdHlwZS5iaW5kQXJyYXlCdWZmZXI9ZnVuY3Rpb24oZSl7dGhpcy5iaW5kQnVmZmVyKGUsdGhpcy5fZ2wuQVJSQVlfQlVGRkVSKX0sby5wcm90b3R5cGUudXBkYXRlQXJyYXlCdWZmZXI9ZnVuY3Rpb24oZSl7dGhpcy5fZ2wuYnVmZmVyU3ViRGF0YSh0aGlzLl9nbC5BUlJBWV9CVUZGRVIsMCxlKX0sby5wcm90b3R5cGUuYmluZEJ1ZmZlcj1mdW5jdGlvbihlLHQpe3RoaXMuX2N1cnJlbnRCb3VuZEJ1ZmZlclt0XSE9PWUmJih0aGlzLl9nbC5iaW5kQnVmZmVyKHQsZSksdGhpcy5fY3VycmVudEJvdW5kQnVmZmVyW3RdPWUpfSxvLnByb3RvdHlwZS5iaW5kQnVmZmVyc0RpcmVjdGx5PWZ1bmN0aW9uKGUsdCxpLHIsbil7aWYodGhpcy5fY2FjaGVkVmVydGV4QnVmZmVycyE9PWV8fHRoaXMuX2NhY2hlZEVmZmVjdEZvclZlcnRleEJ1ZmZlcnMhPT1uKXt0aGlzLl9jYWNoZWRWZXJ0ZXhCdWZmZXJzPWUsdGhpcy5fY2FjaGVkRWZmZWN0Rm9yVmVydGV4QnVmZmVycz1uLHRoaXMuYmluZEJ1ZmZlcihlLHRoaXMuX2dsLkFSUkFZX0JVRkZFUik7Zm9yKHZhciBvPTAscz0wO3M8aS5sZW5ndGg7cysrKXt2YXIgYT1uLmdldEF0dHJpYnV0ZUxvY2F0aW9uKHMpO2E+PTAmJnRoaXMuX2dsLnZlcnRleEF0dHJpYlBvaW50ZXIoYSxpW3NdLHRoaXMuX2dsLkZMT0FULCExLHIsbyksbys9NCppW3NdfX10aGlzLl9jYWNoZWRJbmRleEJ1ZmZlciE9PXQmJih0aGlzLl9jYWNoZWRJbmRleEJ1ZmZlcj10LHRoaXMuYmluZEJ1ZmZlcih0LHRoaXMuX2dsLkVMRU1FTlRfQVJSQVlfQlVGRkVSKSx0aGlzLl91aW50SW5kaWNlc0N1cnJlbnRseVNldD10LmlzMzJCaXRzKX0sby5wcm90b3R5cGUuYmluZEJ1ZmZlcnM9ZnVuY3Rpb24oZSx0LGkpe2lmKHRoaXMuX2NhY2hlZFZlcnRleEJ1ZmZlcnMhPT1lfHx0aGlzLl9jYWNoZWRFZmZlY3RGb3JWZXJ0ZXhCdWZmZXJzIT09aSl7dGhpcy5fY2FjaGVkVmVydGV4QnVmZmVycz1lLHRoaXMuX2NhY2hlZEVmZmVjdEZvclZlcnRleEJ1ZmZlcnM9aTtmb3IodmFyIHI9aS5nZXRBdHRyaWJ1dGVzTmFtZXMoKSxuPTA7bjxyLmxlbmd0aDtuKyspe3ZhciBvPWkuZ2V0QXR0cmlidXRlTG9jYXRpb24obik7aWYobz49MCl7dmFyIHM9ZVtyW25dXTtpZighcyljb250aW51ZTt2YXIgYT1zLmdldEJ1ZmZlcigpO3RoaXMuYmluZEJ1ZmZlcihhLHRoaXMuX2dsLkFSUkFZX0JVRkZFUiksdGhpcy5fZ2wudmVydGV4QXR0cmliUG9pbnRlcihvLHMuZ2V0U2l6ZSgpLHRoaXMuX2dsLkZMT0FULCExLDQqcy5nZXRTdHJpZGVTaXplKCksNCpzLmdldE9mZnNldCgpKSxzLmdldElzSW5zdGFuY2VkKCkmJih0aGlzLl9jYXBzLmluc3RhbmNlZEFycmF5cy52ZXJ0ZXhBdHRyaWJEaXZpc29yQU5HTEUobywxKSx0aGlzLl9jdXJyZW50SW5zdGFuY2VMb2NhdGlvbnMucHVzaChvKSx0aGlzLl9jdXJyZW50SW5zdGFuY2VCdWZmZXJzLnB1c2goYSkpfX19bnVsbCE9dCYmdGhpcy5fY2FjaGVkSW5kZXhCdWZmZXIhPT10JiYodGhpcy5fY2FjaGVkSW5kZXhCdWZmZXI9dCx0aGlzLmJpbmRCdWZmZXIodCx0aGlzLl9nbC5FTEVNRU5UX0FSUkFZX0JVRkZFUiksdGhpcy5fdWludEluZGljZXNDdXJyZW50bHlTZXQ9dC5pczMyQml0cyl9LG8ucHJvdG90eXBlLnVuYmluZEluc3RhbmNlQXR0cmlidXRlcz1mdW5jdGlvbigpe2Zvcih2YXIgZSx0PTAsaT10aGlzLl9jdXJyZW50SW5zdGFuY2VMb2NhdGlvbnMubGVuZ3RoO2k+dDt0Kyspe3ZhciByPXRoaXMuX2N1cnJlbnRJbnN0YW5jZUJ1ZmZlcnNbdF07ZSE9ciYmKGU9cix0aGlzLmJpbmRCdWZmZXIocix0aGlzLl9nbC5BUlJBWV9CVUZGRVIpKTt2YXIgbj10aGlzLl9jdXJyZW50SW5zdGFuY2VMb2NhdGlvbnNbdF07dGhpcy5fY2Fwcy5pbnN0YW5jZWRBcnJheXMudmVydGV4QXR0cmliRGl2aXNvckFOR0xFKG4sMCl9dGhpcy5fY3VycmVudEluc3RhbmNlQnVmZmVycy5sZW5ndGg9MCx0aGlzLl9jdXJyZW50SW5zdGFuY2VMb2NhdGlvbnMubGVuZ3RoPTB9LG8ucHJvdG90eXBlLl9yZWxlYXNlQnVmZmVyPWZ1bmN0aW9uKGUpe3JldHVybiBlLnJlZmVyZW5jZXMtLSwwPT09ZS5yZWZlcmVuY2VzPyh0aGlzLl9nbC5kZWxldGVCdWZmZXIoZSksITApOiExfSxvLnByb3RvdHlwZS5jcmVhdGVJbnN0YW5jZXNCdWZmZXI9ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5fZ2wuY3JlYXRlQnVmZmVyKCk7cmV0dXJuIHQuY2FwYWNpdHk9ZSx0aGlzLmJpbmRCdWZmZXIodCx0aGlzLl9nbC5BUlJBWV9CVUZGRVIpLHRoaXMuX2dsLmJ1ZmZlckRhdGEodGhpcy5fZ2wuQVJSQVlfQlVGRkVSLGUsdGhpcy5fZ2wuRFlOQU1JQ19EUkFXKSx0fSxvLnByb3RvdHlwZS5kZWxldGVJbnN0YW5jZXNCdWZmZXI9ZnVuY3Rpb24oZSl7dGhpcy5fZ2wuZGVsZXRlQnVmZmVyKGUpfSxvLnByb3RvdHlwZS51cGRhdGVBbmRCaW5kSW5zdGFuY2VzQnVmZmVyPWZ1bmN0aW9uKGUsdCxpKXtpZih0aGlzLmJpbmRCdWZmZXIoZSx0aGlzLl9nbC5BUlJBWV9CVUZGRVIpLHQmJnRoaXMuX2dsLmJ1ZmZlclN1YkRhdGEodGhpcy5fZ2wuQVJSQVlfQlVGRkVSLDAsdCksdm9pZCAwIT09aVswXS5pbmRleCl7Zm9yKHZhciByPTAsbj0wO248aS5sZW5ndGg7bisrKXt2YXIgbz1pW25dO3IrPTQqby5hdHRyaWJ1dGVTaXplfWZvcih2YXIgbj0wO248aS5sZW5ndGg7bisrKXt2YXIgbz1pW25dO3RoaXMuX2dsLmVuYWJsZVZlcnRleEF0dHJpYkFycmF5KG8uaW5kZXgpLHRoaXMuX2dsLnZlcnRleEF0dHJpYlBvaW50ZXIoby5pbmRleCxvLmF0dHJpYnV0ZVNpemUsby5hdHRyaWJ5dGVUeXBlfHx0aGlzLl9nbC5GTE9BVCxvLm5vcm1hbGl6ZWR8fCExLHIsby5vZmZzZXQpLHRoaXMuX2NhcHMuaW5zdGFuY2VkQXJyYXlzLnZlcnRleEF0dHJpYkRpdmlzb3JBTkdMRShvLmluZGV4LDEpLHRoaXMuX2N1cnJlbnRJbnN0YW5jZUxvY2F0aW9ucy5wdXNoKG8uaW5kZXgpLHRoaXMuX2N1cnJlbnRJbnN0YW5jZUJ1ZmZlcnMucHVzaChlKX19ZWxzZSBmb3IodmFyIHM9MDs0PnM7cysrKXt2YXIgYT1pW3NdO3RoaXMuX2dsLmVuYWJsZVZlcnRleEF0dHJpYkFycmF5KGEpLHRoaXMuX2dsLnZlcnRleEF0dHJpYlBvaW50ZXIoYSw0LHRoaXMuX2dsLkZMT0FULCExLDY0LDE2KnMpLHRoaXMuX2NhcHMuaW5zdGFuY2VkQXJyYXlzLnZlcnRleEF0dHJpYkRpdmlzb3JBTkdMRShhLDEpLHRoaXMuX2N1cnJlbnRJbnN0YW5jZUxvY2F0aW9ucy5wdXNoKGEpLHRoaXMuX2N1cnJlbnRJbnN0YW5jZUJ1ZmZlcnMucHVzaChlKX19LG8ucHJvdG90eXBlLmFwcGx5U3RhdGVzPWZ1bmN0aW9uKCl7dGhpcy5fZGVwdGhDdWxsaW5nU3RhdGUuYXBwbHkodGhpcy5fZ2wpLHRoaXMuX2FscGhhU3RhdGUuYXBwbHkodGhpcy5fZ2wpfSxvLnByb3RvdHlwZS5kcmF3PWZ1bmN0aW9uKGUsdCxpLHIpe3RoaXMuYXBwbHlTdGF0ZXMoKSx0aGlzLl9kcmF3Q2FsbHMrKzt2YXIgbj10aGlzLl91aW50SW5kaWNlc0N1cnJlbnRseVNldD90aGlzLl9nbC5VTlNJR05FRF9JTlQ6dGhpcy5fZ2wuVU5TSUdORURfU0hPUlQsbz10aGlzLl91aW50SW5kaWNlc0N1cnJlbnRseVNldD80OjI7cmV0dXJuIHI/dm9pZCB0aGlzLl9jYXBzLmluc3RhbmNlZEFycmF5cy5kcmF3RWxlbWVudHNJbnN0YW5jZWRBTkdMRShlP3RoaXMuX2dsLlRSSUFOR0xFUzp0aGlzLl9nbC5MSU5FUyxpLG4sdCpvLHIpOnZvaWQgdGhpcy5fZ2wuZHJhd0VsZW1lbnRzKGU/dGhpcy5fZ2wuVFJJQU5HTEVTOnRoaXMuX2dsLkxJTkVTLGksbix0Km8pfSxvLnByb3RvdHlwZS5kcmF3UG9pbnRDbG91ZHM9ZnVuY3Rpb24oZSx0LGkpe3JldHVybiB0aGlzLmFwcGx5U3RhdGVzKCksdGhpcy5fZHJhd0NhbGxzKyssaT92b2lkIHRoaXMuX2NhcHMuaW5zdGFuY2VkQXJyYXlzLmRyYXdBcnJheXNJbnN0YW5jZWRBTkdMRSh0aGlzLl9nbC5QT0lOVFMsZSx0LGkpOnZvaWQgdGhpcy5fZ2wuZHJhd0FycmF5cyh0aGlzLl9nbC5QT0lOVFMsZSx0KX0sby5wcm90b3R5cGUuZHJhd1VuSW5kZXhlZD1mdW5jdGlvbihlLHQsaSxyKXtyZXR1cm4gdGhpcy5hcHBseVN0YXRlcygpLHRoaXMuX2RyYXdDYWxscysrLHI/dm9pZCB0aGlzLl9jYXBzLmluc3RhbmNlZEFycmF5cy5kcmF3QXJyYXlzSW5zdGFuY2VkQU5HTEUoZT90aGlzLl9nbC5UUklBTkdMRVM6dGhpcy5fZ2wuTElORVMsdCxpLHIpOnZvaWQgdGhpcy5fZ2wuZHJhd0FycmF5cyhlP3RoaXMuX2dsLlRSSUFOR0xFUzp0aGlzLl9nbC5MSU5FUyx0LGkpfSxvLnByb3RvdHlwZS5fcmVsZWFzZUVmZmVjdD1mdW5jdGlvbihlKXt0aGlzLl9jb21waWxlZEVmZmVjdHNbZS5fa2V5XSYmKGRlbGV0ZSB0aGlzLl9jb21waWxlZEVmZmVjdHNbZS5fa2V5XSxlLmdldFByb2dyYW0oKSYmdGhpcy5fZ2wuZGVsZXRlUHJvZ3JhbShlLmdldFByb2dyYW0oKSkpfSxvLnByb3RvdHlwZS5jcmVhdGVFZmZlY3Q9ZnVuY3Rpb24odCxpLHIsbixvLHMsYSxoLGMpe3ZhciBsPXQudmVydGV4RWxlbWVudHx8dC52ZXJ0ZXh8fHQsdT10LmZyYWdtZW50RWxlbWVudHx8dC5mcmFnbWVudHx8dCxmPWwrXCIrXCIrdStcIkBcIitvO2lmKHRoaXMuX2NvbXBpbGVkRWZmZWN0c1tmXSlyZXR1cm4gdGhpcy5fY29tcGlsZWRFZmZlY3RzW2ZdO3ZhciBkPW5ldyBlLkVmZmVjdCh0LGkscixuLHRoaXMsbyxzLGEsaCxjKTtyZXR1cm4gZC5fa2V5PWYsdGhpcy5fY29tcGlsZWRFZmZlY3RzW2ZdPWQsZH0sby5wcm90b3R5cGUuY3JlYXRlRWZmZWN0Rm9yUGFydGljbGVzPWZ1bmN0aW9uKGUsdCxpLHIsbixvLHMpe3JldHVybiB2b2lkIDA9PT10JiYodD1bXSksdm9pZCAwPT09aSYmKGk9W10pLHZvaWQgMD09PXImJihyPVwiXCIpLHRoaXMuY3JlYXRlRWZmZWN0KHt2ZXJ0ZXg6XCJwYXJ0aWNsZXNcIixmcmFnbWVudEVsZW1lbnQ6ZX0sW1wicG9zaXRpb25cIixcImNvbG9yXCIsXCJvcHRpb25zXCJdLFtcInZpZXdcIixcInByb2plY3Rpb25cIl0uY29uY2F0KHQpLFtcImRpZmZ1c2VTYW1wbGVyXCJdLmNvbmNhdChpKSxyLG4sbyxzKX0sby5wcm90b3R5cGUuY3JlYXRlU2hhZGVyUHJvZ3JhbT1mdW5jdGlvbihlLGkscil7dmFyIG49dCh0aGlzLl9nbCxlLFwidmVydGV4XCIsciksbz10KHRoaXMuX2dsLGksXCJmcmFnbWVudFwiLHIpLHM9dGhpcy5fZ2wuY3JlYXRlUHJvZ3JhbSgpO3RoaXMuX2dsLmF0dGFjaFNoYWRlcihzLG4pLHRoaXMuX2dsLmF0dGFjaFNoYWRlcihzLG8pLHRoaXMuX2dsLmxpbmtQcm9ncmFtKHMpO3ZhciBhPXRoaXMuX2dsLmdldFByb2dyYW1QYXJhbWV0ZXIocyx0aGlzLl9nbC5MSU5LX1NUQVRVUyk7aWYoIWEpe3ZhciBoPXRoaXMuX2dsLmdldFByb2dyYW1JbmZvTG9nKHMpO2lmKGgpdGhyb3cgbmV3IEVycm9yKGgpfXJldHVybiB0aGlzLl9nbC5kZWxldGVTaGFkZXIobiksdGhpcy5fZ2wuZGVsZXRlU2hhZGVyKG8pLHN9LG8ucHJvdG90eXBlLmdldFVuaWZvcm1zPWZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBpPVtdLHI9MDtyPHQubGVuZ3RoO3IrKylpLnB1c2godGhpcy5fZ2wuZ2V0VW5pZm9ybUxvY2F0aW9uKGUsdFtyXSkpO3JldHVybiBpfSxvLnByb3RvdHlwZS5nZXRBdHRyaWJ1dGVzPWZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBpPVtdLHI9MDtyPHQubGVuZ3RoO3IrKyl0cnl7aS5wdXNoKHRoaXMuX2dsLmdldEF0dHJpYkxvY2F0aW9uKGUsdFtyXSkpfWNhdGNoKG4pe2kucHVzaCgtMSl9cmV0dXJuIGl9LG8ucHJvdG90eXBlLmVuYWJsZUVmZmVjdD1mdW5jdGlvbihlKXtpZighZXx8IWUuZ2V0QXR0cmlidXRlc0NvdW50KCl8fHRoaXMuX2N1cnJlbnRFZmZlY3Q9PT1lKXJldHVybiB2b2lkKGUmJmUub25CaW5kJiZlLm9uQmluZChlKSk7dGhpcy5fdmVydGV4QXR0cmliQXJyYXlzVG9Vc2U9dGhpcy5fdmVydGV4QXR0cmliQXJyYXlzVG9Vc2V8fFtdLHRoaXMuX3ZlcnRleEF0dHJpYkFycmF5c0VuYWJsZWQ9dGhpcy5fdmVydGV4QXR0cmliQXJyYXlzRW5hYmxlZHx8W10sdGhpcy5fZ2wudXNlUHJvZ3JhbShlLmdldFByb2dyYW0oKSk7dmFyIHQsaTtmb3IodD0wLGk9dGhpcy5fdmVydGV4QXR0cmliQXJyYXlzVG9Vc2UubGVuZ3RoO2k+dDt0KyspdGhpcy5fdmVydGV4QXR0cmliQXJyYXlzVG9Vc2VbdF09ITE7dmFyIHI9ZS5nZXRBdHRyaWJ1dGVzQ291bnQoKTtmb3IodD0wO3I+dDt0Kyspe3ZhciBuPWUuZ2V0QXR0cmlidXRlTG9jYXRpb24odCk7bj49MCYmKHRoaXMuX3ZlcnRleEF0dHJpYkFycmF5c1RvVXNlW25dPSEwKX1mb3IodD0wLGk9dGhpcy5fdmVydGV4QXR0cmliQXJyYXlzRW5hYmxlZC5sZW5ndGg7aT50O3QrKyl0PnRoaXMuX2dsLlZFUlRFWF9BVFRSSUJfQVJSQVlfRU5BQkxFRHx8IXRoaXMuX3ZlcnRleEF0dHJpYkFycmF5c0VuYWJsZWRbdF18fHRoaXMuX3ZlcnRleEF0dHJpYkFycmF5c1RvVXNlW3RdfHwodGhpcy5fdmVydGV4QXR0cmliQXJyYXlzRW5hYmxlZFt0XT0hMSx0aGlzLl9nbC5kaXNhYmxlVmVydGV4QXR0cmliQXJyYXkodCkpO2Zvcih0PTAsaT10aGlzLl92ZXJ0ZXhBdHRyaWJBcnJheXNUb1VzZS5sZW5ndGg7aT50O3QrKyl0aGlzLl92ZXJ0ZXhBdHRyaWJBcnJheXNUb1VzZVt0XSYmIXRoaXMuX3ZlcnRleEF0dHJpYkFycmF5c0VuYWJsZWRbdF0mJih0aGlzLl92ZXJ0ZXhBdHRyaWJBcnJheXNFbmFibGVkW3RdPSEwLHRoaXMuX2dsLmVuYWJsZVZlcnRleEF0dHJpYkFycmF5KHQpKTt0aGlzLl9jdXJyZW50RWZmZWN0PWUsZS5vbkJpbmQmJmUub25CaW5kKGUpfSxvLnByb3RvdHlwZS5zZXRBcnJheT1mdW5jdGlvbihlLHQpe2UmJnRoaXMuX2dsLnVuaWZvcm0xZnYoZSx0KX0sby5wcm90b3R5cGUuc2V0QXJyYXkyPWZ1bmN0aW9uKGUsdCl7ZSYmdC5sZW5ndGglMj09PTAmJnRoaXMuX2dsLnVuaWZvcm0yZnYoZSx0KX0sby5wcm90b3R5cGUuc2V0QXJyYXkzPWZ1bmN0aW9uKGUsdCl7ZSYmdC5sZW5ndGglMz09PTAmJnRoaXMuX2dsLnVuaWZvcm0zZnYoZSx0KX0sby5wcm90b3R5cGUuc2V0QXJyYXk0PWZ1bmN0aW9uKGUsdCl7ZSYmdC5sZW5ndGglND09PTAmJnRoaXMuX2dsLnVuaWZvcm00ZnYoZSx0KX0sby5wcm90b3R5cGUuc2V0TWF0cmljZXM9ZnVuY3Rpb24oZSx0KXtlJiZ0aGlzLl9nbC51bmlmb3JtTWF0cml4NGZ2KGUsITEsdCl9LG8ucHJvdG90eXBlLnNldE1hdHJpeD1mdW5jdGlvbihlLHQpe2UmJnRoaXMuX2dsLnVuaWZvcm1NYXRyaXg0ZnYoZSwhMSx0LnRvQXJyYXkoKSl9LG8ucHJvdG90eXBlLnNldE1hdHJpeDN4Mz1mdW5jdGlvbihlLHQpe2UmJnRoaXMuX2dsLnVuaWZvcm1NYXRyaXgzZnYoZSwhMSx0KX0sby5wcm90b3R5cGUuc2V0TWF0cml4MngyPWZ1bmN0aW9uKGUsdCl7ZSYmdGhpcy5fZ2wudW5pZm9ybU1hdHJpeDJmdihlLCExLHQpfSxvLnByb3RvdHlwZS5zZXRGbG9hdD1mdW5jdGlvbihlLHQpe2UmJnRoaXMuX2dsLnVuaWZvcm0xZihlLHQpfSxvLnByb3RvdHlwZS5zZXRGbG9hdDI9ZnVuY3Rpb24oZSx0LGkpe2UmJnRoaXMuX2dsLnVuaWZvcm0yZihlLHQsaSl9LG8ucHJvdG90eXBlLnNldEZsb2F0Mz1mdW5jdGlvbihlLHQsaSxyKXtlJiZ0aGlzLl9nbC51bmlmb3JtM2YoZSx0LGkscil9LG8ucHJvdG90eXBlLnNldEJvb2w9ZnVuY3Rpb24oZSx0KXtlJiZ0aGlzLl9nbC51bmlmb3JtMWkoZSx0KX0sby5wcm90b3R5cGUuc2V0RmxvYXQ0PWZ1bmN0aW9uKGUsdCxpLHIsbil7ZSYmdGhpcy5fZ2wudW5pZm9ybTRmKGUsdCxpLHIsbil9LG8ucHJvdG90eXBlLnNldENvbG9yMz1mdW5jdGlvbihlLHQpe2UmJnRoaXMuX2dsLnVuaWZvcm0zZihlLHQucix0LmcsdC5iKX0sby5wcm90b3R5cGUuc2V0Q29sb3I0PWZ1bmN0aW9uKGUsdCxpKXtlJiZ0aGlzLl9nbC51bmlmb3JtNGYoZSx0LnIsdC5nLHQuYixpKX0sby5wcm90b3R5cGUuc2V0U3RhdGU9ZnVuY3Rpb24oZSx0LGkscil7dm9pZCAwPT09dCYmKHQ9MCksdm9pZCAwPT09ciYmKHI9ITEpO3ZhciBuPXI/dGhpcy5fZ2wuRlJPTlQ6dGhpcy5fZ2wuQkFDSyxvPXI/dGhpcy5fZ2wuQkFDSzp0aGlzLl9nbC5GUk9OVCxzPXRoaXMuY3VsbEJhY2tGYWNlcz9uOm87KHRoaXMuX2RlcHRoQ3VsbGluZ1N0YXRlLmN1bGwhPT1lfHxpfHx0aGlzLl9kZXB0aEN1bGxpbmdTdGF0ZS5jdWxsRmFjZSE9PXMpJiYoZT8odGhpcy5fZGVwdGhDdWxsaW5nU3RhdGUuY3VsbEZhY2U9cyx0aGlzLl9kZXB0aEN1bGxpbmdTdGF0ZS5jdWxsPSEwKTp0aGlzLl9kZXB0aEN1bGxpbmdTdGF0ZS5jdWxsPSExKSx0aGlzLl9kZXB0aEN1bGxpbmdTdGF0ZS56T2Zmc2V0PXR9LG8ucHJvdG90eXBlLnNldERlcHRoQnVmZmVyPWZ1bmN0aW9uKGUpe3RoaXMuX2RlcHRoQ3VsbGluZ1N0YXRlLmRlcHRoVGVzdD1lfSxvLnByb3RvdHlwZS5nZXREZXB0aFdyaXRlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2RlcHRoQ3VsbGluZ1N0YXRlLmRlcHRoTWFza30sby5wcm90b3R5cGUuc2V0RGVwdGhXcml0ZT1mdW5jdGlvbihlKXt0aGlzLl9kZXB0aEN1bGxpbmdTdGF0ZS5kZXB0aE1hc2s9ZX0sby5wcm90b3R5cGUuc2V0Q29sb3JXcml0ZT1mdW5jdGlvbihlKXt0aGlzLl9nbC5jb2xvck1hc2soZSxlLGUsZSl9LG8ucHJvdG90eXBlLnNldEFscGhhTW9kZT1mdW5jdGlvbihlLHQpe2lmKHZvaWQgMD09PXQmJih0PSExKSx0aGlzLl9hbHBoYU1vZGUhPT1lKXtzd2l0Y2goZSl7Y2FzZSBvLkFMUEhBX0RJU0FCTEU6dGhpcy5fYWxwaGFTdGF0ZS5hbHBoYUJsZW5kPSExO2JyZWFrO2Nhc2Ugby5BTFBIQV9DT01CSU5FOnRoaXMuX2FscGhhU3RhdGUuc2V0QWxwaGFCbGVuZEZ1bmN0aW9uUGFyYW1ldGVycyh0aGlzLl9nbC5TUkNfQUxQSEEsdGhpcy5fZ2wuT05FX01JTlVTX1NSQ19BTFBIQSx0aGlzLl9nbC5PTkUsdGhpcy5fZ2wuT05FKSx0aGlzLl9hbHBoYVN0YXRlLmFscGhhQmxlbmQ9ITA7YnJlYWs7Y2FzZSBvLkFMUEhBX09ORU9ORTp0aGlzLl9hbHBoYVN0YXRlLnNldEFscGhhQmxlbmRGdW5jdGlvblBhcmFtZXRlcnModGhpcy5fZ2wuT05FLHRoaXMuX2dsLk9ORSx0aGlzLl9nbC5aRVJPLHRoaXMuX2dsLk9ORSksdGhpcy5fYWxwaGFTdGF0ZS5hbHBoYUJsZW5kPSEwO2JyZWFrO2Nhc2Ugby5BTFBIQV9BREQ6dGhpcy5fYWxwaGFTdGF0ZS5zZXRBbHBoYUJsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzKHRoaXMuX2dsLlNSQ19BTFBIQSx0aGlzLl9nbC5PTkUsdGhpcy5fZ2wuWkVSTyx0aGlzLl9nbC5PTkUpLHRoaXMuX2FscGhhU3RhdGUuYWxwaGFCbGVuZD0hMDticmVhaztjYXNlIG8uQUxQSEFfU1VCVFJBQ1Q6dGhpcy5fYWxwaGFTdGF0ZS5zZXRBbHBoYUJsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzKHRoaXMuX2dsLlpFUk8sdGhpcy5fZ2wuT05FX01JTlVTX1NSQ19DT0xPUix0aGlzLl9nbC5PTkUsdGhpcy5fZ2wuT05FKSx0aGlzLl9hbHBoYVN0YXRlLmFscGhhQmxlbmQ9ITA7YnJlYWs7Y2FzZSBvLkFMUEhBX01VTFRJUExZOnRoaXMuX2FscGhhU3RhdGUuc2V0QWxwaGFCbGVuZEZ1bmN0aW9uUGFyYW1ldGVycyh0aGlzLl9nbC5EU1RfQ09MT1IsdGhpcy5fZ2wuWkVSTyx0aGlzLl9nbC5PTkUsdGhpcy5fZ2wuT05FKSx0aGlzLl9hbHBoYVN0YXRlLmFscGhhQmxlbmQ9ITA7YnJlYWs7Y2FzZSBvLkFMUEhBX01BWElNSVpFRDp0aGlzLl9hbHBoYVN0YXRlLnNldEFscGhhQmxlbmRGdW5jdGlvblBhcmFtZXRlcnModGhpcy5fZ2wuU1JDX0FMUEhBLHRoaXMuX2dsLk9ORV9NSU5VU19TUkNfQ09MT1IsdGhpcy5fZ2wuT05FLHRoaXMuX2dsLk9ORSksdGhpcy5fYWxwaGFTdGF0ZS5hbHBoYUJsZW5kPSEwfXR8fHRoaXMuc2V0RGVwdGhXcml0ZShlPT09by5BTFBIQV9ESVNBQkxFKSx0aGlzLl9hbHBoYU1vZGU9ZX19LG8ucHJvdG90eXBlLmdldEFscGhhTW9kZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9hbHBoYU1vZGV9LG8ucHJvdG90eXBlLnNldEFscGhhVGVzdGluZz1mdW5jdGlvbihlKXt0aGlzLl9hbHBoYVRlc3Q9ZX0sby5wcm90b3R5cGUuZ2V0QWxwaGFUZXN0aW5nPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2FscGhhVGVzdH0sby5wcm90b3R5cGUud2lwZUNhY2hlcz1mdW5jdGlvbigpe3RoaXMucmVzZXRUZXh0dXJlQ2FjaGUoKSx0aGlzLl9jdXJyZW50RWZmZWN0PW51bGwsdGhpcy5fZGVwdGhDdWxsaW5nU3RhdGUucmVzZXQoKSx0aGlzLnNldERlcHRoRnVuY3Rpb25Ub0xlc3NPckVxdWFsKCksdGhpcy5fYWxwaGFTdGF0ZS5yZXNldCgpLHRoaXMuX2NhY2hlZFZlcnRleEJ1ZmZlcnM9bnVsbCx0aGlzLl9jYWNoZWRJbmRleEJ1ZmZlcj1udWxsLHRoaXMuX2NhY2hlZEVmZmVjdEZvclZlcnRleEJ1ZmZlcnM9bnVsbH0sby5wcm90b3R5cGUuc2V0U2FtcGxpbmdNb2RlPWZ1bmN0aW9uKHQsaSl7dmFyIHI9dGhpcy5fZ2w7ci5iaW5kVGV4dHVyZShyLlRFWFRVUkVfMkQsdCk7dmFyIG49ci5ORUFSRVNULG89ci5ORUFSRVNUO2k9PT1lLlRleHR1cmUuQklMSU5FQVJfU0FNUExJTkdNT0RFPyhuPXIuTElORUFSLG89ci5MSU5FQVIpOmk9PT1lLlRleHR1cmUuVFJJTElORUFSX1NBTVBMSU5HTU9ERSYmKG49ci5MSU5FQVIsbz1yLkxJTkVBUl9NSVBNQVBfTElORUFSKSxyLnRleFBhcmFtZXRlcmkoci5URVhUVVJFXzJELHIuVEVYVFVSRV9NQUdfRklMVEVSLG4pLHIudGV4UGFyYW1ldGVyaShyLlRFWFRVUkVfMkQsci5URVhUVVJFX01JTl9GSUxURVIsbyksci5iaW5kVGV4dHVyZShyLlRFWFRVUkVfMkQsbnVsbCksdC5zYW1wbGluZ01vZGU9aX0sby5wcm90b3R5cGUuY3JlYXRlVGV4dHVyZT1mdW5jdGlvbih0LGkscixvLHMsYSxoLGMpe3ZhciBsPXRoaXM7dm9pZCAwPT09cyYmKHM9ZS5UZXh0dXJlLlRSSUxJTkVBUl9TQU1QTElOR01PREUpLHZvaWQgMD09PWEmJihhPW51bGwpLHZvaWQgMD09PWgmJihoPW51bGwpLHZvaWQgMD09PWMmJihjPW51bGwpO3ZhciB1LGY9dGhpcy5fZ2wuY3JlYXRlVGV4dHVyZSgpLGQ9ITE7aWYoXCJkYXRhOlwiPT09dC5zdWJzdHIoMCw1KSYmKGQ9ITApLGQpe3ZhciBwPXQ7ZD1wLnNwbGl0KFwiOlwiKSx0PXAsdT1kWzFdLnN1YnN0cihkWzFdLmxlbmd0aC00LDQpLnRvTG93ZXJDYXNlKCl9ZWxzZSB1PXQuc3Vic3RyKHQubGVuZ3RoLTQsNCkudG9Mb3dlckNhc2UoKTt2YXIgXz10aGlzLmdldENhcHMoKS5zM3RjJiZcIi5kZHNcIj09PXUsbT1cIi50Z2FcIj09PXU7by5fYWRkUGVuZGluZ0RhdGEoZiksZi51cmw9dCxmLm5vTWlwbWFwPWksZi5yZWZlcmVuY2VzPTEsZi5zYW1wbGluZ01vZGU9cyx0aGlzLl9sb2FkZWRUZXh0dXJlc0NhY2hlLnB1c2goZik7dmFyIGcsdj1mdW5jdGlvbigpe28uX3JlbW92ZVBlbmRpbmdEYXRhKGYpLGgmJmgoKX07aWYobSlnPWZ1bmN0aW9uKHQpe3ZhciBoPW5ldyBVaW50OEFycmF5KHQpLGM9ZS5JbnRlcm5hbHMuVEdBVG9vbHMuR2V0VEdBSGVhZGVyKGgpO24oZixsLl9nbCxvLGMud2lkdGgsYy5oZWlnaHQscixpLCExLGZ1bmN0aW9uKCl7ZS5JbnRlcm5hbHMuVEdBVG9vbHMuVXBsb2FkQ29udGVudChsLl9nbCxoKX0sYSxzKX0sZCBpbnN0YW5jZW9mIEFycmF5P2coYyk6ZS5Ub29scy5Mb2FkRmlsZSh0LGZ1bmN0aW9uKGUpe2coZSl9LHYsby5kYXRhYmFzZSwhMCk7ZWxzZSBpZihfKWc9ZnVuY3Rpb24odCl7dmFyIGg9ZS5JbnRlcm5hbHMuRERTVG9vbHMuR2V0RERTSW5mbyh0KSxjPShoLmlzUkdCfHxoLmlzTHVtaW5hbmNlfHxoLm1pcG1hcENvdW50PjEpJiYhaSYmaC53aWR0aD4+aC5taXBtYXBDb3VudC0xPT09MTtuKGYsbC5fZ2wsbyxoLndpZHRoLGguaGVpZ2h0LHIsIWMsaC5pc0ZvdXJDQyxmdW5jdGlvbigpe2UuSW50ZXJuYWxzLkREU1Rvb2xzLlVwbG9hZEREU0xldmVscyhsLl9nbCxsLmdldENhcHMoKS5zM3RjLHQsaCxjLDEpfSxhLHMpfSxkIGluc3RhbmNlb2YgQXJyYXk/ZyhjKTplLlRvb2xzLkxvYWRGaWxlKHQsZnVuY3Rpb24oZSl7ZyhlKX0sdixvLmRhdGFiYXNlLCEwKTtlbHNle3ZhciB5PWZ1bmN0aW9uKHQpe24oZixsLl9nbCxvLHQud2lkdGgsdC5oZWlnaHQscixpLCExLGZ1bmN0aW9uKGkscil7dmFyIG49dC53aWR0aD09PWkmJnQuaGVpZ2h0PT09cjtufHwobC5fcHJlcGFyZVdvcmtpbmdDYW52YXMoKSxsLl93b3JraW5nQ2FudmFzLndpZHRoPWksbC5fd29ya2luZ0NhbnZhcy5oZWlnaHQ9cixzPT09ZS5UZXh0dXJlLk5FQVJFU1RfU0FNUExJTkdNT0RFJiYobC5fd29ya2luZ0NvbnRleHQuaW1hZ2VTbW9vdGhpbmdFbmFibGVkPSExLGwuX3dvcmtpbmdDb250ZXh0Lm1vekltYWdlU21vb3RoaW5nRW5hYmxlZD0hMSxsLl93b3JraW5nQ29udGV4dC5vSW1hZ2VTbW9vdGhpbmdFbmFibGVkPSExLGwuX3dvcmtpbmdDb250ZXh0LndlYmtpdEltYWdlU21vb3RoaW5nRW5hYmxlZD0hMSxsLl93b3JraW5nQ29udGV4dC5tc0ltYWdlU21vb3RoaW5nRW5hYmxlZD0hMSksbC5fd29ya2luZ0NvbnRleHQuZHJhd0ltYWdlKHQsMCwwLHQud2lkdGgsdC5oZWlnaHQsMCwwLGkscikscz09PWUuVGV4dHVyZS5ORUFSRVNUX1NBTVBMSU5HTU9ERSYmKGwuX3dvcmtpbmdDb250ZXh0LmltYWdlU21vb3RoaW5nRW5hYmxlZD0hMCxsLl93b3JraW5nQ29udGV4dC5tb3pJbWFnZVNtb290aGluZ0VuYWJsZWQ9ITAsbC5fd29ya2luZ0NvbnRleHQub0ltYWdlU21vb3RoaW5nRW5hYmxlZD0hMCxsLl93b3JraW5nQ29udGV4dC53ZWJraXRJbWFnZVNtb290aGluZ0VuYWJsZWQ9ITAsbC5fd29ya2luZ0NvbnRleHQubXNJbWFnZVNtb290aGluZ0VuYWJsZWQ9ITApKSxsLl9nbC50ZXhJbWFnZTJEKGwuX2dsLlRFWFRVUkVfMkQsMCxsLl9nbC5SR0JBLGwuX2dsLlJHQkEsbC5fZ2wuVU5TSUdORURfQllURSxuP3Q6bC5fd29ya2luZ0NhbnZhcyl9LGEscyl9O2QgaW5zdGFuY2VvZiBBcnJheT9lLlRvb2xzLkxvYWRJbWFnZShjLHksdixvLmRhdGFiYXNlKTplLlRvb2xzLkxvYWRJbWFnZSh0LHksdixvLmRhdGFiYXNlKX1yZXR1cm4gZn0sby5wcm90b3R5cGUuX2dldEludGVybmFsRm9ybWF0PWZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuX2dsLlJHQkE7c3dpdGNoKGUpe2Nhc2Ugby5URVhUVVJFRk9STUFUX0FMUEhBOnQ9dGhpcy5fZ2wuQUxQSEE7YnJlYWs7Y2FzZSBvLlRFWFRVUkVGT1JNQVRfTFVNSU5BTkNFOnQ9dGhpcy5fZ2wuTFVNSU5BTkNFO2JyZWFrO2Nhc2Ugby5URVhUVVJFRk9STUFUX0xVTUlOQU5DRV9BTFBIQTp0PXRoaXMuX2dsLkxVTUlOQU5DRV9BTFBIQTticmVhaztjYXNlIG8uVEVYVFVSRUZPUk1BVF9SR0I6dD10aGlzLl9nbC5SR0I7YnJlYWs7Y2FzZSBvLlRFWFRVUkVGT1JNQVRfUkdCQTp0PXRoaXMuX2dsLlJHQkF9cmV0dXJuIHR9LG8ucHJvdG90eXBlLnVwZGF0ZVJhd1RleHR1cmU9ZnVuY3Rpb24oZSx0LGkscixuKXt2b2lkIDA9PT1uJiYobj1udWxsKTt2YXIgbz10aGlzLl9nZXRJbnRlcm5hbEZvcm1hdChpKTt0aGlzLl9nbC5iaW5kVGV4dHVyZSh0aGlzLl9nbC5URVhUVVJFXzJELGUpLHRoaXMuX2dsLnBpeGVsU3RvcmVpKHRoaXMuX2dsLlVOUEFDS19GTElQX1lfV0VCR0wsdm9pZCAwPT09cj8xOnI/MTowKSxlLl93aWR0aCU0IT09MCYmdGhpcy5fZ2wucGl4ZWxTdG9yZWkodGhpcy5fZ2wuVU5QQUNLX0FMSUdOTUVOVCwxKSxuP3RoaXMuX2dsLmNvbXByZXNzZWRUZXhJbWFnZTJEKHRoaXMuX2dsLlRFWFRVUkVfMkQsMCx0aGlzLmdldENhcHMoKS5zM3RjW25dLGUuX3dpZHRoLGUuX2hlaWdodCwwLHQpOnRoaXMuX2dsLnRleEltYWdlMkQodGhpcy5fZ2wuVEVYVFVSRV8yRCwwLG8sZS5fd2lkdGgsZS5faGVpZ2h0LDAsbyx0aGlzLl9nbC5VTlNJR05FRF9CWVRFLHQpLGUuZ2VuZXJhdGVNaXBNYXBzJiZ0aGlzLl9nbC5nZW5lcmF0ZU1pcG1hcCh0aGlzLl9nbC5URVhUVVJFXzJEKSx0aGlzLl9nbC5iaW5kVGV4dHVyZSh0aGlzLl9nbC5URVhUVVJFXzJELG51bGwpLHRoaXMucmVzZXRUZXh0dXJlQ2FjaGUoKSxlLmlzUmVhZHk9ITB9LG8ucHJvdG90eXBlLmNyZWF0ZVJhd1RleHR1cmU9ZnVuY3Rpb24oZSx0LGksbixvLHMsYSxoKXt2b2lkIDA9PT1oJiYoaD1udWxsKTt2YXIgYz10aGlzLl9nbC5jcmVhdGVUZXh0dXJlKCk7Yy5fYmFzZVdpZHRoPXQsYy5fYmFzZUhlaWdodD1pLGMuX3dpZHRoPXQsYy5faGVpZ2h0PWksYy5yZWZlcmVuY2VzPTEsdGhpcy51cGRhdGVSYXdUZXh0dXJlKGMsZSxuLHMsaCksdGhpcy5fZ2wuYmluZFRleHR1cmUodGhpcy5fZ2wuVEVYVFVSRV8yRCxjKTt2YXIgbD1yKGEsbyx0aGlzLl9nbCk7cmV0dXJuIHRoaXMuX2dsLnRleFBhcmFtZXRlcmkodGhpcy5fZ2wuVEVYVFVSRV8yRCx0aGlzLl9nbC5URVhUVVJFX01BR19GSUxURVIsbC5tYWcpLHRoaXMuX2dsLnRleFBhcmFtZXRlcmkodGhpcy5fZ2wuVEVYVFVSRV8yRCx0aGlzLl9nbC5URVhUVVJFX01JTl9GSUxURVIsbC5taW4pLHRoaXMuX2dsLmJpbmRUZXh0dXJlKHRoaXMuX2dsLlRFWFRVUkVfMkQsbnVsbCksYy5zYW1wbGluZ01vZGU9YSx0aGlzLl9sb2FkZWRUZXh0dXJlc0NhY2hlLnB1c2goYyksY30sby5wcm90b3R5cGUuY3JlYXRlRHluYW1pY1RleHR1cmU9ZnVuY3Rpb24odCxpLHIsbil7dmFyIG89dGhpcy5fZ2wuY3JlYXRlVGV4dHVyZSgpO3JldHVybiBvLl9iYXNlV2lkdGg9dCxvLl9iYXNlSGVpZ2h0PWksciYmKHQ9ZS5Ub29scy5HZXRFeHBvbmVudE9mVHdvKHQsdGhpcy5fY2Fwcy5tYXhUZXh0dXJlU2l6ZSksaT1lLlRvb2xzLkdldEV4cG9uZW50T2ZUd28oaSx0aGlzLl9jYXBzLm1heFRleHR1cmVTaXplKSksdGhpcy5yZXNldFRleHR1cmVDYWNoZSgpLG8uX3dpZHRoPXQsby5faGVpZ2h0PWksby5pc1JlYWR5PSExLG8uZ2VuZXJhdGVNaXBNYXBzPXIsby5yZWZlcmVuY2VzPTEsby5zYW1wbGluZ01vZGU9bix0aGlzLnVwZGF0ZVRleHR1cmVTYW1wbGluZ01vZGUobixvKSx0aGlzLl9sb2FkZWRUZXh0dXJlc0NhY2hlLnB1c2gobyksb30sby5wcm90b3R5cGUudXBkYXRlVGV4dHVyZVNhbXBsaW5nTW9kZT1mdW5jdGlvbihlLHQpe3ZhciBpPXIoZSx0LmdlbmVyYXRlTWlwTWFwcyx0aGlzLl9nbCk7dC5pc0N1YmU/KHRoaXMuX2dsLmJpbmRUZXh0dXJlKHRoaXMuX2dsLlRFWFRVUkVfQ1VCRV9NQVAsdCksdGhpcy5fZ2wudGV4UGFyYW1ldGVyaSh0aGlzLl9nbC5URVhUVVJFX0NVQkVfTUFQLHRoaXMuX2dsLlRFWFRVUkVfTUFHX0ZJTFRFUixpLm1hZyksdGhpcy5fZ2wudGV4UGFyYW1ldGVyaSh0aGlzLl9nbC5URVhUVVJFX0NVQkVfTUFQLHRoaXMuX2dsLlRFWFRVUkVfTUlOX0ZJTFRFUixpLm1pbiksdGhpcy5fZ2wuYmluZFRleHR1cmUodGhpcy5fZ2wuVEVYVFVSRV9DVUJFX01BUCxudWxsKSk6KHRoaXMuX2dsLmJpbmRUZXh0dXJlKHRoaXMuX2dsLlRFWFRVUkVfMkQsdCksdGhpcy5fZ2wudGV4UGFyYW1ldGVyaSh0aGlzLl9nbC5URVhUVVJFXzJELHRoaXMuX2dsLlRFWFRVUkVfTUFHX0ZJTFRFUixpLm1hZyksdGhpcy5fZ2wudGV4UGFyYW1ldGVyaSh0aGlzLl9nbC5URVhUVVJFXzJELHRoaXMuX2dsLlRFWFRVUkVfTUlOX0ZJTFRFUixpLm1pbiksdGhpcy5fZ2wuYmluZFRleHR1cmUodGhpcy5fZ2wuVEVYVFVSRV8yRCxudWxsKSl9LG8ucHJvdG90eXBlLnVwZGF0ZUR5bmFtaWNUZXh0dXJlPWZ1bmN0aW9uKGUsdCxpLHIpe3ZvaWQgMD09PXImJihyPSExKSx0aGlzLl9nbC5iaW5kVGV4dHVyZSh0aGlzLl9nbC5URVhUVVJFXzJELGUpLHRoaXMuX2dsLnBpeGVsU3RvcmVpKHRoaXMuX2dsLlVOUEFDS19GTElQX1lfV0VCR0wsaT8xOjApLHImJnRoaXMuX2dsLnBpeGVsU3RvcmVpKHRoaXMuX2dsLlVOUEFDS19QUkVNVUxUSVBMWV9BTFBIQV9XRUJHTCwxKSx0aGlzLl9nbC50ZXhJbWFnZTJEKHRoaXMuX2dsLlRFWFRVUkVfMkQsMCx0aGlzLl9nbC5SR0JBLHRoaXMuX2dsLlJHQkEsdGhpcy5fZ2wuVU5TSUdORURfQllURSx0KSxlLmdlbmVyYXRlTWlwTWFwcyYmdGhpcy5fZ2wuZ2VuZXJhdGVNaXBtYXAodGhpcy5fZ2wuVEVYVFVSRV8yRCksdGhpcy5fZ2wuYmluZFRleHR1cmUodGhpcy5fZ2wuVEVYVFVSRV8yRCxudWxsKSx0aGlzLnJlc2V0VGV4dHVyZUNhY2hlKCksZS5pc1JlYWR5PSEwfSxvLnByb3RvdHlwZS51cGRhdGVWaWRlb1RleHR1cmU9ZnVuY3Rpb24oZSx0LGkpe2lmKCFlLl9pc0Rpc2FibGVkKXt0aGlzLl9nbC5iaW5kVGV4dHVyZSh0aGlzLl9nbC5URVhUVVJFXzJELGUpLHRoaXMuX2dsLnBpeGVsU3RvcmVpKHRoaXMuX2dsLlVOUEFDS19GTElQX1lfV0VCR0wsaT8wOjEpO3RyeXt2b2lkIDA9PT10aGlzLl92aWRlb1RleHR1cmVTdXBwb3J0ZWQmJih0aGlzLl9nbC50ZXhJbWFnZTJEKHRoaXMuX2dsLlRFWFRVUkVfMkQsMCx0aGlzLl9nbC5SR0JBLHRoaXMuX2dsLlJHQkEsdGhpcy5fZ2wuVU5TSUdORURfQllURSx0KSwwIT09dGhpcy5fZ2wuZ2V0RXJyb3IoKT90aGlzLl92aWRlb1RleHR1cmVTdXBwb3J0ZWQ9ITE6dGhpcy5fdmlkZW9UZXh0dXJlU3VwcG9ydGVkPSEwKSx0aGlzLl92aWRlb1RleHR1cmVTdXBwb3J0ZWQ/dGhpcy5fZ2wudGV4SW1hZ2UyRCh0aGlzLl9nbC5URVhUVVJFXzJELDAsdGhpcy5fZ2wuUkdCQSx0aGlzLl9nbC5SR0JBLHRoaXMuX2dsLlVOU0lHTkVEX0JZVEUsdCk6KGUuX3dvcmtpbmdDYW52YXN8fChlLl93b3JraW5nQ2FudmFzPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIiksZS5fd29ya2luZ0NvbnRleHQ9ZS5fd29ya2luZ0NhbnZhcy5nZXRDb250ZXh0KFwiMmRcIiksZS5fd29ya2luZ0NhbnZhcy53aWR0aD1lLl93aWR0aCxlLl93b3JraW5nQ2FudmFzLmhlaWdodD1lLl9oZWlnaHQpLGUuX3dvcmtpbmdDb250ZXh0LmRyYXdJbWFnZSh0LDAsMCx0LnZpZGVvV2lkdGgsdC52aWRlb0hlaWdodCwwLDAsZS5fd2lkdGgsZS5faGVpZ2h0KSx0aGlzLl9nbC50ZXhJbWFnZTJEKHRoaXMuX2dsLlRFWFRVUkVfMkQsMCx0aGlzLl9nbC5SR0JBLHRoaXMuX2dsLlJHQkEsdGhpcy5fZ2wuVU5TSUdORURfQllURSxlLl93b3JraW5nQ2FudmFzKSksZS5nZW5lcmF0ZU1pcE1hcHMmJnRoaXMuX2dsLmdlbmVyYXRlTWlwbWFwKHRoaXMuX2dsLlRFWFRVUkVfMkQpLHRoaXMuX2dsLmJpbmRUZXh0dXJlKHRoaXMuX2dsLlRFWFRVUkVfMkQsbnVsbCksdGhpcy5yZXNldFRleHR1cmVDYWNoZSgpLGUuaXNSZWFkeT0hMH1jYXRjaChyKXtlLl9pc0Rpc2FibGVkPSEwfX19LG8ucHJvdG90eXBlLmNyZWF0ZVJlbmRlclRhcmdldFRleHR1cmU9ZnVuY3Rpb24odCxuKXt2YXIgcz0hMSxhPSEwLGg9by5URVhUVVJFVFlQRV9VTlNJR05FRF9JTlQsYz1lLlRleHR1cmUuVFJJTElORUFSX1NBTVBMSU5HTU9ERTt2b2lkIDAhPT1uJiYocz12b2lkIDA9PT1uLmdlbmVyYXRlTWlwTWFwcz9uOm4uZ2VuZXJhdGVNaXBNYXBzLGE9dm9pZCAwPT09bi5nZW5lcmF0ZURlcHRoQnVmZmVyPyEwOm4uZ2VuZXJhdGVEZXB0aEJ1ZmZlcixoPXZvaWQgMD09PW4udHlwZT9oOm4udHlwZSx2b2lkIDAhPT1uLnNhbXBsaW5nTW9kZSYmKGM9bi5zYW1wbGluZ01vZGUpLGg9PT1vLlRFWFRVUkVUWVBFX0ZMT0FUJiYoYz1lLlRleHR1cmUuTkVBUkVTVF9TQU1QTElOR01PREUpKTt2YXIgbD10aGlzLl9nbCx1PWwuY3JlYXRlVGV4dHVyZSgpO2wuYmluZFRleHR1cmUobC5URVhUVVJFXzJELHUpO3ZhciBmPXQud2lkdGh8fHQsZD10LmhlaWdodHx8dCxwPXIoYyxzLGwpO2ghPT1vLlRFWFRVUkVUWVBFX0ZMT0FUfHx0aGlzLl9jYXBzLnRleHR1cmVGbG9hdHx8KGg9by5URVhUVVJFVFlQRV9VTlNJR05FRF9JTlQsZS5Ub29scy5XYXJuKFwiRmxvYXQgdGV4dHVyZXMgYXJlIG5vdCBzdXBwb3J0ZWQuIFJlbmRlciB0YXJnZXQgZm9yY2VkIHRvIFRFWFRVUkVUWVBFX1VOU0lHTkVEX0JZVEUgdHlwZVwiKSksbC50ZXhQYXJhbWV0ZXJpKGwuVEVYVFVSRV8yRCxsLlRFWFRVUkVfTUFHX0ZJTFRFUixwLm1hZyksbC50ZXhQYXJhbWV0ZXJpKGwuVEVYVFVSRV8yRCxsLlRFWFRVUkVfTUlOX0ZJTFRFUixwLm1pbiksbC50ZXhQYXJhbWV0ZXJpKGwuVEVYVFVSRV8yRCxsLlRFWFRVUkVfV1JBUF9TLGwuQ0xBTVBfVE9fRURHRSksbC50ZXhQYXJhbWV0ZXJpKGwuVEVYVFVSRV8yRCxsLlRFWFRVUkVfV1JBUF9ULGwuQ0xBTVBfVE9fRURHRSksbC50ZXhJbWFnZTJEKGwuVEVYVFVSRV8yRCwwLGwuUkdCQSxmLGQsMCxsLlJHQkEsaShsLGgpLG51bGwpO3ZhciBfO2EmJihfPWwuY3JlYXRlUmVuZGVyYnVmZmVyKCksbC5iaW5kUmVuZGVyYnVmZmVyKGwuUkVOREVSQlVGRkVSLF8pLGwucmVuZGVyYnVmZmVyU3RvcmFnZShsLlJFTkRFUkJVRkZFUixsLkRFUFRIX0NPTVBPTkVOVDE2LGYsZCkpO3ZhciBtPWwuY3JlYXRlRnJhbWVidWZmZXIoKTtyZXR1cm4gbC5iaW5kRnJhbWVidWZmZXIobC5GUkFNRUJVRkZFUixtKSxhJiZsLmZyYW1lYnVmZmVyUmVuZGVyYnVmZmVyKGwuRlJBTUVCVUZGRVIsbC5ERVBUSF9BVFRBQ0hNRU5ULGwuUkVOREVSQlVGRkVSLF8pLHMmJnRoaXMuX2dsLmdlbmVyYXRlTWlwbWFwKHRoaXMuX2dsLlRFWFRVUkVfMkQpLGwuYmluZFRleHR1cmUobC5URVhUVVJFXzJELG51bGwpLGwuYmluZFJlbmRlcmJ1ZmZlcihsLlJFTkRFUkJVRkZFUixudWxsKSxsLmJpbmRGcmFtZWJ1ZmZlcihsLkZSQU1FQlVGRkVSLG51bGwpLHUuX2ZyYW1lYnVmZmVyPW0sYSYmKHUuX2RlcHRoQnVmZmVyPV8pLHUuX2Jhc2VXaWR0aD1mLHUuX2Jhc2VIZWlnaHQ9ZCx1Ll93aWR0aD1mLHUuX2hlaWdodD1kLHUuaXNSZWFkeT0hMCx1LmdlbmVyYXRlTWlwTWFwcz1zLHUucmVmZXJlbmNlcz0xLHUuc2FtcGxpbmdNb2RlPWMsdGhpcy5yZXNldFRleHR1cmVDYWNoZSgpLHRoaXMuX2xvYWRlZFRleHR1cmVzQ2FjaGUucHVzaCh1KSxcbnV9LG8ucHJvdG90eXBlLmNyZWF0ZVJlbmRlclRhcmdldEN1YmVUZXh0dXJlPWZ1bmN0aW9uKHQsaSl7dmFyIG49dGhpcy5fZ2wsbz1uLmNyZWF0ZVRleHR1cmUoKSxzPSEwLGE9ZS5UZXh0dXJlLlRSSUxJTkVBUl9TQU1QTElOR01PREU7dm9pZCAwIT09aSYmKHM9dm9pZCAwPT09aS5nZW5lcmF0ZU1pcE1hcHM/aTppLmdlbmVyYXRlTWlwTWFwcyx2b2lkIDAhPT1pLnNhbXBsaW5nTW9kZSYmKGE9aS5zYW1wbGluZ01vZGUpKSxvLmlzQ3ViZT0hMCxvLnJlZmVyZW5jZXM9MSxvLmdlbmVyYXRlTWlwTWFwcz1zLG8ucmVmZXJlbmNlcz0xLG8uc2FtcGxpbmdNb2RlPWE7dmFyIGg9cihhLHMsbik7bi5iaW5kVGV4dHVyZShuLlRFWFRVUkVfQ1VCRV9NQVAsbyk7Zm9yKHZhciBjPTA7Nj5jO2MrKyluLnRleEltYWdlMkQobi5URVhUVVJFX0NVQkVfTUFQX1BPU0lUSVZFX1grYywwLG4uUkdCQSx0LHQsMCxuLlJHQkEsbi5VTlNJR05FRF9CWVRFLG51bGwpO24udGV4UGFyYW1ldGVyaShuLlRFWFRVUkVfQ1VCRV9NQVAsbi5URVhUVVJFX01BR19GSUxURVIsaC5tYWcpLG4udGV4UGFyYW1ldGVyaShuLlRFWFRVUkVfQ1VCRV9NQVAsbi5URVhUVVJFX01JTl9GSUxURVIsaC5taW4pLG4udGV4UGFyYW1ldGVyaShuLlRFWFRVUkVfQ1VCRV9NQVAsbi5URVhUVVJFX1dSQVBfUyxuLkNMQU1QX1RPX0VER0UpLG4udGV4UGFyYW1ldGVyaShuLlRFWFRVUkVfQ1VCRV9NQVAsbi5URVhUVVJFX1dSQVBfVCxuLkNMQU1QX1RPX0VER0UpO3ZhciBsPW4uY3JlYXRlUmVuZGVyYnVmZmVyKCk7bi5iaW5kUmVuZGVyYnVmZmVyKG4uUkVOREVSQlVGRkVSLGwpLG4ucmVuZGVyYnVmZmVyU3RvcmFnZShuLlJFTkRFUkJVRkZFUixuLkRFUFRIX0NPTVBPTkVOVDE2LHQsdCk7dmFyIHU9bi5jcmVhdGVGcmFtZWJ1ZmZlcigpO3JldHVybiBuLmJpbmRGcmFtZWJ1ZmZlcihuLkZSQU1FQlVGRkVSLHUpLG4uZnJhbWVidWZmZXJSZW5kZXJidWZmZXIobi5GUkFNRUJVRkZFUixuLkRFUFRIX0FUVEFDSE1FTlQsbi5SRU5ERVJCVUZGRVIsbCksby5nZW5lcmF0ZU1pcE1hcHMmJihuLmJpbmRUZXh0dXJlKG4uVEVYVFVSRV9DVUJFX01BUCxvKSxuLmdlbmVyYXRlTWlwbWFwKG4uVEVYVFVSRV9DVUJFX01BUCkpLG4uYmluZFRleHR1cmUobi5URVhUVVJFX0NVQkVfTUFQLG51bGwpLG4uYmluZFJlbmRlcmJ1ZmZlcihuLlJFTkRFUkJVRkZFUixudWxsKSxuLmJpbmRGcmFtZWJ1ZmZlcihuLkZSQU1FQlVGRkVSLG51bGwpLG8uX2ZyYW1lYnVmZmVyPXUsby5fZGVwdGhCdWZmZXI9bCx0aGlzLnJlc2V0VGV4dHVyZUNhY2hlKCksby5fd2lkdGg9dCxvLl9oZWlnaHQ9dCxvLmlzUmVhZHk9ITAsb30sby5wcm90b3R5cGUuY3JlYXRlQ3ViZVRleHR1cmU9ZnVuY3Rpb24odCxpLHIsbil7dmFyIG89dGhpcyxhPXRoaXMuX2dsLGg9YS5jcmVhdGVUZXh0dXJlKCk7aC5pc0N1YmU9ITAsaC51cmw9dCxoLnJlZmVyZW5jZXM9MTt2YXIgYz10LnN1YnN0cih0Lmxlbmd0aC00LDQpLnRvTG93ZXJDYXNlKCksbD10aGlzLmdldENhcHMoKS5zM3RjJiZcIi5kZHNcIj09PWM7cmV0dXJuIGw/ZS5Ub29scy5Mb2FkRmlsZSh0LGZ1bmN0aW9uKHQpe3ZhciBpPWUuSW50ZXJuYWxzLkREU1Rvb2xzLkdldEREU0luZm8odCkscj0oaS5pc1JHQnx8aS5pc0x1bWluYW5jZXx8aS5taXBtYXBDb3VudD4xKSYmIW47YS5iaW5kVGV4dHVyZShhLlRFWFRVUkVfQ1VCRV9NQVAsaCksYS5waXhlbFN0b3JlaShhLlVOUEFDS19GTElQX1lfV0VCR0wsMSksZS5JbnRlcm5hbHMuRERTVG9vbHMuVXBsb2FkRERTTGV2ZWxzKG8uX2dsLG8uZ2V0Q2FwcygpLnMzdGMsdCxpLHIsNiksbnx8aS5pc0ZvdXJDQ3x8MSE9PWkubWlwbWFwQ291bnR8fGEuZ2VuZXJhdGVNaXBtYXAoYS5URVhUVVJFX0NVQkVfTUFQKSxhLnRleFBhcmFtZXRlcmkoYS5URVhUVVJFX0NVQkVfTUFQLGEuVEVYVFVSRV9NQUdfRklMVEVSLGEuTElORUFSKSxhLnRleFBhcmFtZXRlcmkoYS5URVhUVVJFX0NVQkVfTUFQLGEuVEVYVFVSRV9NSU5fRklMVEVSLHI/YS5MSU5FQVJfTUlQTUFQX0xJTkVBUjphLkxJTkVBUiksYS50ZXhQYXJhbWV0ZXJpKGEuVEVYVFVSRV9DVUJFX01BUCxhLlRFWFRVUkVfV1JBUF9TLGEuQ0xBTVBfVE9fRURHRSksYS50ZXhQYXJhbWV0ZXJpKGEuVEVYVFVSRV9DVUJFX01BUCxhLlRFWFRVUkVfV1JBUF9ULGEuQ0xBTVBfVE9fRURHRSksYS5iaW5kVGV4dHVyZShhLlRFWFRVUkVfQ1VCRV9NQVAsbnVsbCksby5yZXNldFRleHR1cmVDYWNoZSgpLGguX3dpZHRoPWkud2lkdGgsaC5faGVpZ2h0PWkuaGVpZ2h0LGguaXNSZWFkeT0hMH0sbnVsbCxudWxsLCEwKTpzKHQsaSxmdW5jdGlvbih0KXt2YXIgaT1lLlRvb2xzLkdldEV4cG9uZW50T2ZUd28odFswXS53aWR0aCxvLl9jYXBzLm1heEN1YmVtYXBUZXh0dXJlU2l6ZSkscj1pO28uX3ByZXBhcmVXb3JraW5nQ2FudmFzKCksby5fd29ya2luZ0NhbnZhcy53aWR0aD1pLG8uX3dvcmtpbmdDYW52YXMuaGVpZ2h0PXI7dmFyIHM9W2EuVEVYVFVSRV9DVUJFX01BUF9QT1NJVElWRV9YLGEuVEVYVFVSRV9DVUJFX01BUF9QT1NJVElWRV9ZLGEuVEVYVFVSRV9DVUJFX01BUF9QT1NJVElWRV9aLGEuVEVYVFVSRV9DVUJFX01BUF9ORUdBVElWRV9YLGEuVEVYVFVSRV9DVUJFX01BUF9ORUdBVElWRV9ZLGEuVEVYVFVSRV9DVUJFX01BUF9ORUdBVElWRV9aXTthLmJpbmRUZXh0dXJlKGEuVEVYVFVSRV9DVUJFX01BUCxoKSxhLnBpeGVsU3RvcmVpKGEuVU5QQUNLX0ZMSVBfWV9XRUJHTCwwKTtmb3IodmFyIGM9MDtjPHMubGVuZ3RoO2MrKylvLl93b3JraW5nQ29udGV4dC5kcmF3SW1hZ2UodFtjXSwwLDAsdFtjXS53aWR0aCx0W2NdLmhlaWdodCwwLDAsaSxyKSxhLnRleEltYWdlMkQoc1tjXSwwLGEuUkdCQSxhLlJHQkEsYS5VTlNJR05FRF9CWVRFLG8uX3dvcmtpbmdDYW52YXMpO258fGEuZ2VuZXJhdGVNaXBtYXAoYS5URVhUVVJFX0NVQkVfTUFQKSxhLnRleFBhcmFtZXRlcmkoYS5URVhUVVJFX0NVQkVfTUFQLGEuVEVYVFVSRV9NQUdfRklMVEVSLGEuTElORUFSKSxhLnRleFBhcmFtZXRlcmkoYS5URVhUVVJFX0NVQkVfTUFQLGEuVEVYVFVSRV9NSU5fRklMVEVSLG4/YS5MSU5FQVI6YS5MSU5FQVJfTUlQTUFQX0xJTkVBUiksYS50ZXhQYXJhbWV0ZXJpKGEuVEVYVFVSRV9DVUJFX01BUCxhLlRFWFRVUkVfV1JBUF9TLGEuQ0xBTVBfVE9fRURHRSksYS50ZXhQYXJhbWV0ZXJpKGEuVEVYVFVSRV9DVUJFX01BUCxhLlRFWFRVUkVfV1JBUF9ULGEuQ0xBTVBfVE9fRURHRSksYS5iaW5kVGV4dHVyZShhLlRFWFRVUkVfQ1VCRV9NQVAsbnVsbCksby5yZXNldFRleHR1cmVDYWNoZSgpLGguX3dpZHRoPWksaC5faGVpZ2h0PXIsaC5pc1JlYWR5PSEwfSxyKSxofSxvLnByb3RvdHlwZS51cGRhdGVUZXh0dXJlU2l6ZT1mdW5jdGlvbihlLHQsaSl7ZS5fd2lkdGg9dCxlLl9oZWlnaHQ9aSxlLl9zaXplPXQqaSxlLl9iYXNlV2lkdGg9dCxlLl9iYXNlSGVpZ2h0PWl9LG8ucHJvdG90eXBlLmNyZWF0ZVJhd0N1YmVUZXh0dXJlPWZ1bmN0aW9uKHQsaSxyLG4scyxhLGgsYyl7dmFyIGw9dGhpcyx1PXRoaXMuX2dsLGY9dS5jcmVhdGVUZXh0dXJlKCk7aS5fYWRkUGVuZGluZ0RhdGEoZiksZi5pc0N1YmU9ITAsZi5yZWZlcmVuY2VzPTEsZi51cmw9dDt2YXIgZD10aGlzLl9nZXRJbnRlcm5hbEZvcm1hdChuKSxwPXUuVU5TSUdORURfQllURTtzPT09by5URVhUVVJFVFlQRV9GTE9BVCYmKHA9dS5GTE9BVCk7dmFyIF89cixtPV8sZz1lLlRvb2xzLklzRXhwb25lbnRPZlR3byhfKSYmZS5Ub29scy5Jc0V4cG9uZW50T2ZUd28obSk7Zi5fd2lkdGg9XyxmLl9oZWlnaHQ9bTt2YXIgdj1mdW5jdGlvbigpe2kuX3JlbW92ZVBlbmRpbmdEYXRhKGYpfSx5PWZ1bmN0aW9uKHQpe3ZhciByPWgodCksbj1bdS5URVhUVVJFX0NVQkVfTUFQX1BPU0lUSVZFX1gsdS5URVhUVVJFX0NVQkVfTUFQX1BPU0lUSVZFX1ksdS5URVhUVVJFX0NVQkVfTUFQX1BPU0lUSVZFX1osdS5URVhUVVJFX0NVQkVfTUFQX05FR0FUSVZFX1gsdS5URVhUVVJFX0NVQkVfTUFQX05FR0FUSVZFX1ksdS5URVhUVVJFX0NVQkVfTUFQX05FR0FUSVZFX1pdO2lmKF89Zi5fd2lkdGgsbT1mLl9oZWlnaHQsZz1lLlRvb2xzLklzRXhwb25lbnRPZlR3byhfKSYmZS5Ub29scy5Jc0V4cG9uZW50T2ZUd28obSksdS5iaW5kVGV4dHVyZSh1LlRFWFRVUkVfQ1VCRV9NQVAsZiksdS5waXhlbFN0b3JlaSh1LlVOUEFDS19GTElQX1lfV0VCR0wsMCksIWEmJmcpaWYoYyl7dmFyIG89W107by5wdXNoKHJbMF0pLG8ucHVzaChyWzNdKSxvLnB1c2goclsxXSksby5wdXNoKHJbNF0pLG8ucHVzaChyWzJdKSxvLnB1c2gocls1XSk7Zm9yKHZhciBzPWMobyksdj0wO3Y8cy5sZW5ndGg7disrKXt2YXIgeT1fPj52O3UudGV4SW1hZ2UyRChuWzBdLHYsZCx5LHksMCxkLHAsc1t2XVswXSksdS50ZXhJbWFnZTJEKG5bMV0sdixkLHkseSwwLGQscCxzW3ZdWzJdKSx1LnRleEltYWdlMkQoblsyXSx2LGQseSx5LDAsZCxwLHNbdl1bNF0pLHUudGV4SW1hZ2UyRChuWzNdLHYsZCx5LHksMCxkLHAsc1t2XVsxXSksdS50ZXhJbWFnZTJEKG5bNF0sdixkLHkseSwwLGQscCxzW3ZdWzNdKSx1LnRleEltYWdlMkQobls1XSx2LGQseSx5LDAsZCxwLHNbdl1bNV0pfX1lbHNle2Zvcih2YXIgeD0wO3g8bi5sZW5ndGg7eCsrKXt2YXIgYj1yW3hdO3UudGV4SW1hZ2UyRChuW3hdLDAsZCxfLG0sMCxkLHAsYil9aWYodS5nZW5lcmF0ZU1pcG1hcCh1LlRFWFRVUkVfQ1VCRV9NQVApLHA9PT11LkZMT0FUJiZkPT09dS5SR0ImJjEyODI9PT11LmdldEVycm9yKCkpe2UuVG9vbHMuTG9nKFwiUkdCMzJGIG5vdCByZW5kZXJhYmxlIG9uIEZpcmVmb3gsIHRyeWluZyBmYWxsYmFjayB0byBSR0JBMzJGLlwiKTtmb3IodmFyIHg9MDt4PG4ubGVuZ3RoO3grKyl7Zm9yKHZhciBiPXJbeF0sUD1uZXcgRmxvYXQzMkFycmF5KF8qbSo0KSxBPTA7Xz5BO0ErKylmb3IodmFyIFQ9MDttPlQ7VCsrKXt2YXIgRT0zKihUKl8rQSksQz00KihUKl8rQSk7UFtDKzBdPWJbRSswXSxQW0MrMV09YltFKzFdLFBbQysyXT1iW0UrMl0sUFtDKzNdPTF9dS50ZXhJbWFnZTJEKG5beF0sMCx1LlJHQkEsXyxtLDAsdS5SR0JBLHAsUCl9dS5nZW5lcmF0ZU1pcG1hcCh1LlRFWFRVUkVfQ1VCRV9NQVApfX1lbHNlIGE9ITA7cCE9PXUuRkxPQVR8fGwuX2NhcHMudGV4dHVyZUZsb2F0TGluZWFyRmlsdGVyaW5nPyh1LnRleFBhcmFtZXRlcmkodS5URVhUVVJFX0NVQkVfTUFQLHUuVEVYVFVSRV9NQUdfRklMVEVSLHUuTElORUFSKSx1LnRleFBhcmFtZXRlcmkodS5URVhUVVJFX0NVQkVfTUFQLHUuVEVYVFVSRV9NSU5fRklMVEVSLGE/dS5MSU5FQVI6dS5MSU5FQVJfTUlQTUFQX0xJTkVBUikpOih1LnRleFBhcmFtZXRlcmkodS5URVhUVVJFX0NVQkVfTUFQLHUuVEVYVFVSRV9NQUdfRklMVEVSLHUuTkVBUkVTVCksdS50ZXhQYXJhbWV0ZXJpKHUuVEVYVFVSRV9DVUJFX01BUCx1LlRFWFRVUkVfTUlOX0ZJTFRFUix1Lk5FQVJFU1QpKSx1LnRleFBhcmFtZXRlcmkodS5URVhUVVJFX0NVQkVfTUFQLHUuVEVYVFVSRV9XUkFQX1MsdS5DTEFNUF9UT19FREdFKSx1LnRleFBhcmFtZXRlcmkodS5URVhUVVJFX0NVQkVfTUFQLHUuVEVYVFVSRV9XUkFQX1QsdS5DTEFNUF9UT19FREdFKSx1LmJpbmRUZXh0dXJlKHUuVEVYVFVSRV9DVUJFX01BUCxudWxsKSxmLmlzUmVhZHk9ITAsbC5yZXNldFRleHR1cmVDYWNoZSgpLGkuX3JlbW92ZVBlbmRpbmdEYXRhKGYpfTtyZXR1cm4gZS5Ub29scy5Mb2FkRmlsZSh0LGZ1bmN0aW9uKGUpe3koZSl9LHYsaS5kYXRhYmFzZSwhMCksZn0sby5wcm90b3R5cGUuX3JlbGVhc2VUZXh0dXJlPWZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuX2dsO2UuX2ZyYW1lYnVmZmVyJiZ0LmRlbGV0ZUZyYW1lYnVmZmVyKGUuX2ZyYW1lYnVmZmVyKSxlLl9kZXB0aEJ1ZmZlciYmdC5kZWxldGVSZW5kZXJidWZmZXIoZS5fZGVwdGhCdWZmZXIpLHQuZGVsZXRlVGV4dHVyZShlKSx0aGlzLnVuYmluZEFsbFRleHR1cmVzKCk7dmFyIGk9dGhpcy5fbG9hZGVkVGV4dHVyZXNDYWNoZS5pbmRleE9mKGUpOy0xIT09aSYmdGhpcy5fbG9hZGVkVGV4dHVyZXNDYWNoZS5zcGxpY2UoaSwxKX0sby5wcm90b3R5cGUuYmluZFNhbXBsZXJzPWZ1bmN0aW9uKGUpe3RoaXMuX2dsLnVzZVByb2dyYW0oZS5nZXRQcm9ncmFtKCkpO2Zvcih2YXIgdD1lLmdldFNhbXBsZXJzKCksaT0wO2k8dC5sZW5ndGg7aSsrKXt2YXIgcj1lLmdldFVuaWZvcm0odFtpXSk7dGhpcy5fZ2wudW5pZm9ybTFpKHIsaSl9dGhpcy5fY3VycmVudEVmZmVjdD1udWxsfSxvLnByb3RvdHlwZS5fYmluZFRleHR1cmU9ZnVuY3Rpb24oZSx0KXswPmV8fCh0aGlzLl9nbC5hY3RpdmVUZXh0dXJlKHRoaXMuX2dsW1wiVEVYVFVSRVwiK2VdKSx0aGlzLl9nbC5iaW5kVGV4dHVyZSh0aGlzLl9nbC5URVhUVVJFXzJELHQpLHRoaXMuX2FjdGl2ZVRleHR1cmVzQ2FjaGVbZV09bnVsbCl9LG8ucHJvdG90eXBlLnNldFRleHR1cmVGcm9tUG9zdFByb2Nlc3M9ZnVuY3Rpb24oZSx0KXt0aGlzLl9iaW5kVGV4dHVyZShlLHQuX3RleHR1cmVzLmRhdGFbdC5fY3VycmVudFJlbmRlclRleHR1cmVJbmRdKX0sby5wcm90b3R5cGUudW5iaW5kQWxsVGV4dHVyZXM9ZnVuY3Rpb24oKXtmb3IodmFyIGU9MDtlPHRoaXMuX2NhcHMubWF4VGV4dHVyZXNJbWFnZVVuaXRzO2UrKyl0aGlzLl9nbC5hY3RpdmVUZXh0dXJlKHRoaXMuX2dsW1wiVEVYVFVSRVwiK2VdKSx0aGlzLl9nbC5iaW5kVGV4dHVyZSh0aGlzLl9nbC5URVhUVVJFXzJELG51bGwpLHRoaXMuX2dsLmJpbmRUZXh0dXJlKHRoaXMuX2dsLlRFWFRVUkVfQ1VCRV9NQVAsbnVsbCksdGhpcy5fYWN0aXZlVGV4dHVyZXNDYWNoZVtlXT1udWxsfSxvLnByb3RvdHlwZS5zZXRUZXh0dXJlPWZ1bmN0aW9uKHQsaSl7aWYoISgwPnQpKXtpZighaXx8IWkuaXNSZWFkeSgpKXJldHVybiB2b2lkKG51bGwhPXRoaXMuX2FjdGl2ZVRleHR1cmVzQ2FjaGVbdF0mJih0aGlzLl9nbC5hY3RpdmVUZXh0dXJlKHRoaXMuX2dsW1wiVEVYVFVSRVwiK3RdKSx0aGlzLl9nbC5iaW5kVGV4dHVyZSh0aGlzLl9nbC5URVhUVVJFXzJELG51bGwpLHRoaXMuX2dsLmJpbmRUZXh0dXJlKHRoaXMuX2dsLlRFWFRVUkVfQ1VCRV9NQVAsbnVsbCksdGhpcy5fYWN0aXZlVGV4dHVyZXNDYWNoZVt0XT1udWxsKSk7dmFyIHI9ITE7aWYoaSBpbnN0YW5jZW9mIGUuVmlkZW9UZXh0dXJlKXRoaXMuX2dsLmFjdGl2ZVRleHR1cmUodGhpcy5fZ2xbXCJURVhUVVJFXCIrdF0pLHI9ITAsaS51cGRhdGUoKTtlbHNlIGlmKGkuZGVsYXlMb2FkU3RhdGU9PT1vLkRFTEFZTE9BRFNUQVRFX05PVExPQURFRClyZXR1cm4gdm9pZCBpLmRlbGF5TG9hZCgpO2lmKHRoaXMuX2FjdGl2ZVRleHR1cmVzQ2FjaGVbdF0hPT1pKXt0aGlzLl9hY3RpdmVUZXh0dXJlc0NhY2hlW3RdPWk7dmFyIG49aS5nZXRJbnRlcm5hbFRleHR1cmUoKTtpZihyfHx0aGlzLl9nbC5hY3RpdmVUZXh0dXJlKHRoaXMuX2dsW1wiVEVYVFVSRVwiK3RdKSxuLmlzQ3ViZSl7aWYodGhpcy5fZ2wuYmluZFRleHR1cmUodGhpcy5fZ2wuVEVYVFVSRV9DVUJFX01BUCxuKSxuLl9jYWNoZWRDb29yZGluYXRlc01vZGUhPT1pLmNvb3JkaW5hdGVzTW9kZSl7bi5fY2FjaGVkQ29vcmRpbmF0ZXNNb2RlPWkuY29vcmRpbmF0ZXNNb2RlO3ZhciBzPWkuY29vcmRpbmF0ZXNNb2RlIT09ZS5UZXh0dXJlLkNVQklDX01PREUmJmkuY29vcmRpbmF0ZXNNb2RlIT09ZS5UZXh0dXJlLlNLWUJPWF9NT0RFP3RoaXMuX2dsLlJFUEVBVDp0aGlzLl9nbC5DTEFNUF9UT19FREdFO3RoaXMuX2dsLnRleFBhcmFtZXRlcmkodGhpcy5fZ2wuVEVYVFVSRV9DVUJFX01BUCx0aGlzLl9nbC5URVhUVVJFX1dSQVBfUyxzKSx0aGlzLl9nbC50ZXhQYXJhbWV0ZXJpKHRoaXMuX2dsLlRFWFRVUkVfQ1VCRV9NQVAsdGhpcy5fZ2wuVEVYVFVSRV9XUkFQX1Qscyl9dGhpcy5fc2V0QW5pc290cm9waWNMZXZlbCh0aGlzLl9nbC5URVhUVVJFX0NVQkVfTUFQLGkpfWVsc2V7aWYodGhpcy5fZ2wuYmluZFRleHR1cmUodGhpcy5fZ2wuVEVYVFVSRV8yRCxuKSxuLl9jYWNoZWRXcmFwVSE9PWkud3JhcFUpc3dpdGNoKG4uX2NhY2hlZFdyYXBVPWkud3JhcFUsaS53cmFwVSl7Y2FzZSBlLlRleHR1cmUuV1JBUF9BRERSRVNTTU9ERTp0aGlzLl9nbC50ZXhQYXJhbWV0ZXJpKHRoaXMuX2dsLlRFWFRVUkVfMkQsdGhpcy5fZ2wuVEVYVFVSRV9XUkFQX1MsdGhpcy5fZ2wuUkVQRUFUKTticmVhaztjYXNlIGUuVGV4dHVyZS5DTEFNUF9BRERSRVNTTU9ERTp0aGlzLl9nbC50ZXhQYXJhbWV0ZXJpKHRoaXMuX2dsLlRFWFRVUkVfMkQsdGhpcy5fZ2wuVEVYVFVSRV9XUkFQX1MsdGhpcy5fZ2wuQ0xBTVBfVE9fRURHRSk7YnJlYWs7Y2FzZSBlLlRleHR1cmUuTUlSUk9SX0FERFJFU1NNT0RFOnRoaXMuX2dsLnRleFBhcmFtZXRlcmkodGhpcy5fZ2wuVEVYVFVSRV8yRCx0aGlzLl9nbC5URVhUVVJFX1dSQVBfUyx0aGlzLl9nbC5NSVJST1JFRF9SRVBFQVQpfWlmKG4uX2NhY2hlZFdyYXBWIT09aS53cmFwVilzd2l0Y2gobi5fY2FjaGVkV3JhcFY9aS53cmFwVixpLndyYXBWKXtjYXNlIGUuVGV4dHVyZS5XUkFQX0FERFJFU1NNT0RFOnRoaXMuX2dsLnRleFBhcmFtZXRlcmkodGhpcy5fZ2wuVEVYVFVSRV8yRCx0aGlzLl9nbC5URVhUVVJFX1dSQVBfVCx0aGlzLl9nbC5SRVBFQVQpO2JyZWFrO2Nhc2UgZS5UZXh0dXJlLkNMQU1QX0FERFJFU1NNT0RFOnRoaXMuX2dsLnRleFBhcmFtZXRlcmkodGhpcy5fZ2wuVEVYVFVSRV8yRCx0aGlzLl9nbC5URVhUVVJFX1dSQVBfVCx0aGlzLl9nbC5DTEFNUF9UT19FREdFKTticmVhaztjYXNlIGUuVGV4dHVyZS5NSVJST1JfQUREUkVTU01PREU6dGhpcy5fZ2wudGV4UGFyYW1ldGVyaSh0aGlzLl9nbC5URVhUVVJFXzJELHRoaXMuX2dsLlRFWFRVUkVfV1JBUF9ULHRoaXMuX2dsLk1JUlJPUkVEX1JFUEVBVCl9dGhpcy5fc2V0QW5pc290cm9waWNMZXZlbCh0aGlzLl9nbC5URVhUVVJFXzJELGkpfX19fSxvLnByb3RvdHlwZS5fc2V0QW5pc290cm9waWNMZXZlbD1mdW5jdGlvbih0LGkpe3ZhciByPXRoaXMuX2NhcHMudGV4dHVyZUFuaXNvdHJvcGljRmlsdGVyRXh0ZW5zaW9uLG49aS5hbmlzb3Ryb3BpY0ZpbHRlcmluZ0xldmVsO2kuZ2V0SW50ZXJuYWxUZXh0dXJlKCkuc2FtcGxpbmdNb2RlPT09ZS5UZXh0dXJlLk5FQVJFU1RfU0FNUExJTkdNT0RFJiYobj0xKSxyJiZpLl9jYWNoZWRBbmlzb3Ryb3BpY0ZpbHRlcmluZ0xldmVsIT09biYmKHRoaXMuX2dsLnRleFBhcmFtZXRlcmYodCxyLlRFWFRVUkVfTUFYX0FOSVNPVFJPUFlfRVhULE1hdGgubWluKG4sdGhpcy5fY2Fwcy5tYXhBbmlzb3Ryb3B5KSksaS5fY2FjaGVkQW5pc290cm9waWNGaWx0ZXJpbmdMZXZlbD1uKX0sby5wcm90b3R5cGUucmVhZFBpeGVscz1mdW5jdGlvbihlLHQsaSxyKXt2YXIgbj1uZXcgVWludDhBcnJheShyKmkqNCk7cmV0dXJuIHRoaXMuX2dsLnJlYWRQaXhlbHMoZSx0LGkscix0aGlzLl9nbC5SR0JBLHRoaXMuX2dsLlVOU0lHTkVEX0JZVEUsbiksbn0sby5wcm90b3R5cGUuYWRkRXh0ZXJuYWxEYXRhPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuX2V4dGVybmFsRGF0YS5hZGQoZSx0KX0sby5wcm90b3R5cGUuZ2V0RXh0ZXJuYWxEYXRhPWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9leHRlcm5hbERhdGEuZ2V0KGUpfSxvLnByb3RvdHlwZS5nZXRPckFkZEV4dGVybmFsRGF0YVdpdGhGYWN0b3J5PWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuX2V4dGVybmFsRGF0YS5nZXRPckFkZFdpdGhGYWN0b3J5KGUsdCl9LG8ucHJvdG90eXBlLnJlbW92ZUV4dGVybmFsRGF0YT1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fZXh0ZXJuYWxEYXRhLnJlbW92ZShlKX0sby5wcm90b3R5cGUucmVsZWFzZUludGVybmFsVGV4dHVyZT1mdW5jdGlvbihlKXtpZihlJiYoZS5yZWZlcmVuY2VzLS0sMD09PWUucmVmZXJlbmNlcykpe3ZhciB0PXRoaXMuZ2V0TG9hZGVkVGV4dHVyZXNDYWNoZSgpLGk9dC5pbmRleE9mKGUpO2k+LTEmJnQuc3BsaWNlKGksMSksdGhpcy5fcmVsZWFzZVRleHR1cmUoZSl9fSxvLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7Zm9yKHRoaXMuaGlkZUxvYWRpbmdVSSgpLHRoaXMuc3RvcFJlbmRlckxvb3AoKTt0aGlzLnNjZW5lcy5sZW5ndGg7KXRoaXMuc2NlbmVzWzBdLmRpc3Bvc2UoKTtvLmF1ZGlvRW5naW5lLmRpc3Bvc2UoKTtmb3IodmFyIGUgaW4gdGhpcy5fY29tcGlsZWRFZmZlY3RzKXRoaXMuX2dsLmRlbGV0ZVByb2dyYW0odGhpcy5fY29tcGlsZWRFZmZlY3RzW2VdLl9wcm9ncmFtKTtpZih0aGlzLl92ZXJ0ZXhBdHRyaWJBcnJheXNFbmFibGVkKWZvcih2YXIgdD0wLGk9dGhpcy5fdmVydGV4QXR0cmliQXJyYXlzRW5hYmxlZC5sZW5ndGg7aT50O3QrKyl0PnRoaXMuX2dsLlZFUlRFWF9BVFRSSUJfQVJSQVlfRU5BQkxFRHx8IXRoaXMuX3ZlcnRleEF0dHJpYkFycmF5c0VuYWJsZWRbdF18fHRoaXMuX2dsLmRpc2FibGVWZXJ0ZXhBdHRyaWJBcnJheSh0KTt0aGlzLl9nbD1udWxsLHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwiYmx1clwiLHRoaXMuX29uQmx1ciksd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJmb2N1c1wiLHRoaXMuX29uRm9jdXMpLGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJmdWxsc2NyZWVuY2hhbmdlXCIsdGhpcy5fb25GdWxsc2NyZWVuQ2hhbmdlKSxkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW96ZnVsbHNjcmVlbmNoYW5nZVwiLHRoaXMuX29uRnVsbHNjcmVlbkNoYW5nZSksZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIndlYmtpdGZ1bGxzY3JlZW5jaGFuZ2VcIix0aGlzLl9vbkZ1bGxzY3JlZW5DaGFuZ2UpLGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtc2Z1bGxzY3JlZW5jaGFuZ2VcIix0aGlzLl9vbkZ1bGxzY3JlZW5DaGFuZ2UpLGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJwb2ludGVybG9ja2NoYW5nZVwiLHRoaXMuX29uUG9pbnRlckxvY2tDaGFuZ2UpLGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtc3BvaW50ZXJsb2NrY2hhbmdlXCIsdGhpcy5fb25Qb2ludGVyTG9ja0NoYW5nZSksZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1venBvaW50ZXJsb2NrY2hhbmdlXCIsdGhpcy5fb25Qb2ludGVyTG9ja0NoYW5nZSksZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIndlYmtpdHBvaW50ZXJsb2NrY2hhbmdlXCIsdGhpcy5fb25Qb2ludGVyTG9ja0NoYW5nZSl9LG8ucHJvdG90eXBlLmRpc3BsYXlMb2FkaW5nVUk9ZnVuY3Rpb24oKXt0aGlzLl9sb2FkaW5nU2NyZWVuLmRpc3BsYXlMb2FkaW5nVUkoKX0sby5wcm90b3R5cGUuaGlkZUxvYWRpbmdVST1mdW5jdGlvbigpe3RoaXMuX2xvYWRpbmdTY3JlZW4uaGlkZUxvYWRpbmdVSSgpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkoby5wcm90b3R5cGUsXCJsb2FkaW5nU2NyZWVuXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9sb2FkaW5nU2NyZWVufSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fbG9hZGluZ1NjcmVlbj1lfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLnByb3RvdHlwZSxcImxvYWRpbmdVSVRleHRcIix7c2V0OmZ1bmN0aW9uKGUpe3RoaXMuX2xvYWRpbmdTY3JlZW4ubG9hZGluZ1VJVGV4dD1lfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLnByb3RvdHlwZSxcImxvYWRpbmdVSUJhY2tncm91bmRDb2xvclwiLHtzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fbG9hZGluZ1NjcmVlbi5sb2FkaW5nVUlCYWNrZ3JvdW5kQ29sb3I9ZX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxvLnByb3RvdHlwZS5nZXRGcHM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5mcHN9LG8ucHJvdG90eXBlLmdldERlbHRhVGltZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmRlbHRhVGltZX0sby5wcm90b3R5cGUuX21lYXN1cmVGcHM9ZnVuY3Rpb24oKXt0aGlzLnByZXZpb3VzRnJhbWVzRHVyYXRpb24ucHVzaChlLlRvb2xzLk5vdyk7dmFyIHQ9dGhpcy5wcmV2aW91c0ZyYW1lc0R1cmF0aW9uLmxlbmd0aDtpZih0Pj0yJiYodGhpcy5kZWx0YVRpbWU9dGhpcy5wcmV2aW91c0ZyYW1lc0R1cmF0aW9uW3QtMV0tdGhpcy5wcmV2aW91c0ZyYW1lc0R1cmF0aW9uW3QtMl0pLHQ+PXRoaXMuZnBzUmFuZ2Upe3Q+dGhpcy5mcHNSYW5nZSYmKHRoaXMucHJldmlvdXNGcmFtZXNEdXJhdGlvbi5zcGxpY2UoMCwxKSx0PXRoaXMucHJldmlvdXNGcmFtZXNEdXJhdGlvbi5sZW5ndGgpO2Zvcih2YXIgaT0wLHI9MDt0LTE+cjtyKyspaSs9dGhpcy5wcmV2aW91c0ZyYW1lc0R1cmF0aW9uW3IrMV0tdGhpcy5wcmV2aW91c0ZyYW1lc0R1cmF0aW9uW3JdO3RoaXMuZnBzPTFlMy8oaS8odC0xKSl9fSxvLmlzU3VwcG9ydGVkPWZ1bmN0aW9uKCl7dHJ5e2lmKG5hdmlnYXRvci5pc0NvY29vbkpTKXJldHVybiEwO3ZhciBlPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIiksdD1lLmdldENvbnRleHQoXCJ3ZWJnbFwiKXx8ZS5nZXRDb250ZXh0KFwiZXhwZXJpbWVudGFsLXdlYmdsXCIpO3JldHVybiBudWxsIT10JiYhIXdpbmRvdy5XZWJHTFJlbmRlcmluZ0NvbnRleHR9Y2F0Y2goaSl7cmV0dXJuITF9fSxvLl9BTFBIQV9ESVNBQkxFPTAsby5fQUxQSEFfQUREPTEsby5fQUxQSEFfQ09NQklORT0yLG8uX0FMUEhBX1NVQlRSQUNUPTMsby5fQUxQSEFfTVVMVElQTFk9NCxvLl9BTFBIQV9NQVhJTUlaRUQ9NSxvLl9BTFBIQV9PTkVPTkU9NixvLl9ERUxBWUxPQURTVEFURV9OT05FPTAsby5fREVMQVlMT0FEU1RBVEVfTE9BREVEPTEsby5fREVMQVlMT0FEU1RBVEVfTE9BRElORz0yLG8uX0RFTEFZTE9BRFNUQVRFX05PVExPQURFRD00LG8uX1RFWFRVUkVGT1JNQVRfQUxQSEE9MCxvLl9URVhUVVJFRk9STUFUX0xVTUlOQU5DRT0xLG8uX1RFWFRVUkVGT1JNQVRfTFVNSU5BTkNFX0FMUEhBPTIsby5fVEVYVFVSRUZPUk1BVF9SR0I9NCxvLl9URVhUVVJFRk9STUFUX1JHQkE9NSxvLl9URVhUVVJFVFlQRV9VTlNJR05FRF9JTlQ9MCxvLl9URVhUVVJFVFlQRV9GTE9BVD0xLG8uQ29sbGlzaW9uc0Vwc2lsb249LjAwMSxvLkNvZGVSZXBvc2l0b3J5PVwic3JjL1wiLG8uU2hhZGVyc1JlcG9zaXRvcnk9XCJzcmMvU2hhZGVycy9cIixvfSgpO2UuRW5naW5lPWN9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdChlLHQpe3RoaXMuc3RhdGU9XCJcIix0aGlzLmFuaW1hdGlvbnM9bmV3IEFycmF5LHRoaXMuX3Jhbmdlcz17fSx0aGlzLl9jaGlsZHJlbkZsYWc9LTEsdGhpcy5faXNFbmFibGVkPSEwLHRoaXMuX2lzUmVhZHk9ITAsdGhpcy5fY3VycmVudFJlbmRlcklkPS0xLHRoaXMuX3BhcmVudFJlbmRlcklkPS0xLHRoaXMubmFtZT1lLHRoaXMuaWQ9ZSx0aGlzLl9zY2VuZT10LHRoaXMuX2luaXRDYWNoZSgpfXJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJwYXJlbnRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3BhcmVudE5vZGV9LHNldDpmdW5jdGlvbihlKXtpZih0aGlzLl9wYXJlbnROb2RlIT09ZSl7aWYodGhpcy5fcGFyZW50Tm9kZSl7dmFyIHQ9dGhpcy5fcGFyZW50Tm9kZS5fY2hpbGRyZW4uaW5kZXhPZih0aGlzKTstMSE9PXQmJnRoaXMuX3BhcmVudE5vZGUuX2NoaWxkcmVuLnNwbGljZSh0LDEpfXRoaXMuX3BhcmVudE5vZGU9ZSx0aGlzLl9wYXJlbnROb2RlJiYodGhpcy5fcGFyZW50Tm9kZS5fY2hpbGRyZW58fCh0aGlzLl9wYXJlbnROb2RlLl9jaGlsZHJlbj1uZXcgQXJyYXkpLHRoaXMuX3BhcmVudE5vZGUuX2NoaWxkcmVuLnB1c2godGhpcykpfX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSx0LnByb3RvdHlwZS5nZXRTY2VuZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9zY2VuZX0sdC5wcm90b3R5cGUuZ2V0RW5naW5lPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3NjZW5lLmdldEVuZ2luZSgpfSx0LnByb3RvdHlwZS5nZXRXb3JsZE1hdHJpeD1mdW5jdGlvbigpe3JldHVybiBlLk1hdHJpeC5JZGVudGl0eSgpfSx0LnByb3RvdHlwZS5faW5pdENhY2hlPWZ1bmN0aW9uKCl7dGhpcy5fY2FjaGU9e30sdGhpcy5fY2FjaGUucGFyZW50PXZvaWQgMH0sdC5wcm90b3R5cGUudXBkYXRlQ2FjaGU9ZnVuY3Rpb24oZSl7IWUmJnRoaXMuaXNTeW5jaHJvbml6ZWQoKXx8KHRoaXMuX2NhY2hlLnBhcmVudD10aGlzLnBhcmVudCx0aGlzLl91cGRhdGVDYWNoZSgpKX0sdC5wcm90b3R5cGUuX3VwZGF0ZUNhY2hlPWZ1bmN0aW9uKGUpe30sdC5wcm90b3R5cGUuX2lzU3luY2hyb25pemVkPWZ1bmN0aW9uKCl7cmV0dXJuITB9LHQucHJvdG90eXBlLl9tYXJrU3luY2VkV2l0aFBhcmVudD1mdW5jdGlvbigpe3RoaXMuX3BhcmVudFJlbmRlcklkPXRoaXMucGFyZW50Ll9jdXJyZW50UmVuZGVySWR9LHQucHJvdG90eXBlLmlzU3luY2hyb25pemVkV2l0aFBhcmVudD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnBhcmVudD90aGlzLl9wYXJlbnRSZW5kZXJJZCE9PXRoaXMucGFyZW50Ll9jdXJyZW50UmVuZGVySWQ/ITE6dGhpcy5wYXJlbnQuaXNTeW5jaHJvbml6ZWQoKTohMH0sdC5wcm90b3R5cGUuaXNTeW5jaHJvbml6ZWQ9ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5oYXNOZXdQYXJlbnQoKTtyZXR1cm4gdD10fHwhdGhpcy5pc1N5bmNocm9uaXplZFdpdGhQYXJlbnQoKSx0PXR8fCF0aGlzLl9pc1N5bmNocm9uaXplZCgpLGUmJnRoaXMudXBkYXRlQ2FjaGUoITApLCF0fSx0LnByb3RvdHlwZS5oYXNOZXdQYXJlbnQ9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2NhY2hlLnBhcmVudD09PXRoaXMucGFyZW50PyExOihlJiYodGhpcy5fY2FjaGUucGFyZW50PXRoaXMucGFyZW50KSwhMCl9LHQucHJvdG90eXBlLmlzUmVhZHk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faXNSZWFkeX0sdC5wcm90b3R5cGUuaXNFbmFibGVkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lzRW5hYmxlZD90aGlzLnBhcmVudD90aGlzLnBhcmVudC5pc0VuYWJsZWQoKTohMDohMX0sdC5wcm90b3R5cGUuc2V0RW5hYmxlZD1mdW5jdGlvbihlKXt0aGlzLl9pc0VuYWJsZWQ9ZX0sdC5wcm90b3R5cGUuaXNEZXNjZW5kYW50T2Y9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMucGFyZW50P3RoaXMucGFyZW50PT09ZT8hMDp0aGlzLnBhcmVudC5pc0Rlc2NlbmRhbnRPZihlKTohMX0sdC5wcm90b3R5cGUuX2dldERlc2NlbmRhbnRzPWZ1bmN0aW9uKGUsdCxpKXtpZih2b2lkIDA9PT10JiYodD0hMSksdGhpcy5fY2hpbGRyZW4pZm9yKHZhciByPTA7cjx0aGlzLl9jaGlsZHJlbi5sZW5ndGg7cisrKXt2YXIgbj10aGlzLl9jaGlsZHJlbltyXTtpJiYhaShuKXx8ZS5wdXNoKG4pLHR8fG4uX2dldERlc2NlbmRhbnRzKGUsITEsaSl9fSx0LnByb3RvdHlwZS5nZXREZXNjZW5kYW50cz1mdW5jdGlvbihlLHQpe3ZhciBpPVtdO3JldHVybiB0aGlzLl9nZXREZXNjZW5kYW50cyhpLGUsdCksaX0sdC5wcm90b3R5cGUuZ2V0Q2hpbGRyZW49ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuZ2V0RGVzY2VuZGFudHMoITAsZSl9LHQucHJvdG90eXBlLmdldENoaWxkTWVzaGVzPWZ1bmN0aW9uKHQsaSl7dmFyIHI9W107cmV0dXJuIHRoaXMuX2dldERlc2NlbmRhbnRzKHIsdCxmdW5jdGlvbih0KXtyZXR1cm4oIWl8fGkodCkpJiZ0IGluc3RhbmNlb2YgZS5BYnN0cmFjdE1lc2h9KSxyfSx0LnByb3RvdHlwZS5fc2V0UmVhZHk9ZnVuY3Rpb24oZSl7aWYoZSE9PXRoaXMuX2lzUmVhZHkpe2lmKCFlKXJldHVybiB2b2lkKHRoaXMuX2lzUmVhZHk9ITEpO3RoaXMuX2lzUmVhZHk9ITAsdGhpcy5vblJlYWR5JiZ0aGlzLm9uUmVhZHkodGhpcyl9fSx0LnByb3RvdHlwZS5nZXRBbmltYXRpb25CeU5hbWU9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PTA7dDx0aGlzLmFuaW1hdGlvbnMubGVuZ3RoO3QrKyl7dmFyIGk9dGhpcy5hbmltYXRpb25zW3RdO2lmKGkubmFtZT09PWUpcmV0dXJuIGl9cmV0dXJuIG51bGx9LHQucHJvdG90eXBlLmNyZWF0ZUFuaW1hdGlvblJhbmdlPWZ1bmN0aW9uKHQsaSxyKXtpZighdGhpcy5fcmFuZ2VzW3RdKXt0aGlzLl9yYW5nZXNbdF09bmV3IGUuQW5pbWF0aW9uUmFuZ2UodCxpLHIpO2Zvcih2YXIgbj0wLG89dGhpcy5hbmltYXRpb25zLmxlbmd0aDtvPm47bisrKXRoaXMuYW5pbWF0aW9uc1tuXSYmdGhpcy5hbmltYXRpb25zW25dLmNyZWF0ZVJhbmdlKHQsaSxyKX19LHQucHJvdG90eXBlLmRlbGV0ZUFuaW1hdGlvblJhbmdlPWZ1bmN0aW9uKGUsdCl7dm9pZCAwPT09dCYmKHQ9ITApO2Zvcih2YXIgaT0wLHI9dGhpcy5hbmltYXRpb25zLmxlbmd0aDtyPmk7aSsrKXRoaXMuYW5pbWF0aW9uc1tpXSYmdGhpcy5hbmltYXRpb25zW2ldLmRlbGV0ZVJhbmdlKGUsdCk7dGhpcy5fcmFuZ2VzW2VdPXZvaWQgMH0sdC5wcm90b3R5cGUuZ2V0QW5pbWF0aW9uUmFuZ2U9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX3Jhbmdlc1tlXX0sdC5wcm90b3R5cGUuYmVnaW5BbmltYXRpb249ZnVuY3Rpb24oZSx0LGkscil7dmFyIG49dGhpcy5nZXRBbmltYXRpb25SYW5nZShlKTtyZXR1cm4gbj92b2lkIHRoaXMuX3NjZW5lLmJlZ2luQW5pbWF0aW9uKHRoaXMsbi5mcm9tLG4udG8sdCxpLHIpOm51bGx9LHQucHJvdG90eXBlLnNlcmlhbGl6ZUFuaW1hdGlvblJhbmdlcz1mdW5jdGlvbigpe3ZhciBlPVtdO2Zvcih2YXIgdCBpbiB0aGlzLl9yYW5nZXMpe3ZhciBpPXt9O2kubmFtZT10LGkuZnJvbT10aGlzLl9yYW5nZXNbdF0uZnJvbSxpLnRvPXRoaXMuX3Jhbmdlc1t0XS50byxlLnB1c2goaSl9cmV0dXJuIGV9LHQucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXt0aGlzLnBhcmVudD1udWxsfSx0LlBhcnNlQW5pbWF0aW9uUmFuZ2VzPWZ1bmN0aW9uKGUsdCxpKXtpZih0LnJhbmdlcylmb3IodmFyIHI9MDtyPHQucmFuZ2VzLmxlbmd0aDtyKyspe3ZhciBuPXQucmFuZ2VzW3JdO2UuY3JlYXRlQW5pbWF0aW9uUmFuZ2Uobi5uYW1lLG4uZnJvbSxuLnRvKX19LF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHQucHJvdG90eXBlLFwibmFtZVwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0sdC5wcm90b3R5cGUsXCJpZFwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0sdC5wcm90b3R5cGUsXCJ1bmlxdWVJZFwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0sdC5wcm90b3R5cGUsXCJzdGF0ZVwiLHZvaWQgMCksdH0oKTtlLk5vZGU9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KGUsdCxpLHIsbixvLHMsYSl7dGhpcy5fZW5naW5lPWUsdGhpcy5fY2FudmFzPWksdGhpcy5fY3VycmVudFNjZW5lPXQsdGhpcy5fc2NlbmVMb2FkZWRDYWxsYmFjaz1yLHRoaXMuX3Byb2dyZXNzQ2FsbGJhY2s9bix0aGlzLl9hZGRpdGlvbm5hbFJlbmRlckxvb3BMb2dpY0NhbGxiYWNrPW8sdGhpcy5fdGV4dHVyZUxvYWRpbmdDYWxsYmFjaz1zLHRoaXMuX3N0YXJ0aW5nUHJvY2Vzc2luZ0ZpbGVzQ2FsbGJhY2s9YX1yZXR1cm4gdC5wcm90b3R5cGUubW9uaXRvckVsZW1lbnRGb3JEcmFnTkRyb3A9ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcztlJiYodGhpcy5fZWxlbWVudFRvTW9uaXRvcj1lLHRoaXMuX2VsZW1lbnRUb01vbml0b3IuYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdlbnRlclwiLGZ1bmN0aW9uKGUpe3QuZHJhZyhlKX0sITEpLHRoaXMuX2VsZW1lbnRUb01vbml0b3IuYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdvdmVyXCIsZnVuY3Rpb24oZSl7dC5kcmFnKGUpfSwhMSksdGhpcy5fZWxlbWVudFRvTW9uaXRvci5hZGRFdmVudExpc3RlbmVyKFwiZHJvcFwiLGZ1bmN0aW9uKGUpe3QuZHJvcChlKX0sITEpKX0sdC5wcm90b3R5cGUucmVuZGVyRnVuY3Rpb249ZnVuY3Rpb24oKXtpZih0aGlzLl9hZGRpdGlvbm5hbFJlbmRlckxvb3BMb2dpY0NhbGxiYWNrJiZ0aGlzLl9hZGRpdGlvbm5hbFJlbmRlckxvb3BMb2dpY0NhbGxiYWNrKCksdGhpcy5fY3VycmVudFNjZW5lKXtpZih0aGlzLl90ZXh0dXJlTG9hZGluZ0NhbGxiYWNrKXt2YXIgZT10aGlzLl9jdXJyZW50U2NlbmUuZ2V0V2FpdGluZ0l0ZW1zQ291bnQoKTtlPjAmJnRoaXMuX3RleHR1cmVMb2FkaW5nQ2FsbGJhY2soZSl9dGhpcy5fY3VycmVudFNjZW5lLnJlbmRlcigpfX0sdC5wcm90b3R5cGUuZHJhZz1mdW5jdGlvbihlKXtlLnN0b3BQcm9wYWdhdGlvbigpLGUucHJldmVudERlZmF1bHQoKX0sdC5wcm90b3R5cGUuZHJvcD1mdW5jdGlvbihlKXtlLnN0b3BQcm9wYWdhdGlvbigpLGUucHJldmVudERlZmF1bHQoKSx0aGlzLmxvYWRGaWxlcyhlKX0sdC5wcm90b3R5cGUubG9hZEZpbGVzPWZ1bmN0aW9uKGUpe2lmKHRoaXMuX3N0YXJ0aW5nUHJvY2Vzc2luZ0ZpbGVzQ2FsbGJhY2smJnRoaXMuX3N0YXJ0aW5nUHJvY2Vzc2luZ0ZpbGVzQ2FsbGJhY2soKSxlJiZlLmRhdGFUcmFuc2ZlciYmZS5kYXRhVHJhbnNmZXIuZmlsZXMmJih0aGlzLl9maWxlc1RvTG9hZD1lLmRhdGFUcmFuc2Zlci5maWxlcyksZSYmZS50YXJnZXQmJmUudGFyZ2V0LmZpbGVzJiYodGhpcy5fZmlsZXNUb0xvYWQ9ZS50YXJnZXQuZmlsZXMpLHRoaXMuX2ZpbGVzVG9Mb2FkJiZ0aGlzLl9maWxlc1RvTG9hZC5sZW5ndGg+MCl7Zm9yKHZhciBpPTA7aTx0aGlzLl9maWxlc1RvTG9hZC5sZW5ndGg7aSsrKXN3aXRjaCh0aGlzLl9maWxlc1RvTG9hZFtpXS50eXBlKXtjYXNlXCJpbWFnZS9qcGVnXCI6Y2FzZVwiaW1hZ2UvcG5nXCI6Y2FzZVwiaW1hZ2UvYm1wXCI6dC5GaWxlc1RleHR1cmVzW3RoaXMuX2ZpbGVzVG9Mb2FkW2ldLm5hbWUudG9Mb3dlckNhc2UoKV09dGhpcy5fZmlsZXNUb0xvYWRbaV07YnJlYWs7Y2FzZVwiaW1hZ2UvdGFyZ2FcIjpjYXNlXCJpbWFnZS92bmQubXMtZGRzXCI6Y2FzZVwiYXVkaW8vd2F2XCI6Y2FzZVwiYXVkaW8veC13YXZcIjpjYXNlXCJhdWRpby9tcDNcIjpjYXNlXCJhdWRpby9tcGVnXCI6Y2FzZVwiYXVkaW8vbXBlZzNcIjpjYXNlXCJhdWRpby94LW1wZWctM1wiOmNhc2VcImF1ZGlvL29nZ1wiOnQuRmlsZXNUb0xvYWRbdGhpcy5fZmlsZXNUb0xvYWRbaV0ubmFtZS50b0xvd2VyQ2FzZSgpXT10aGlzLl9maWxlc1RvTG9hZFtpXTticmVhaztkZWZhdWx0Oi0xIT09dGhpcy5fZmlsZXNUb0xvYWRbaV0ubmFtZS5pbmRleE9mKFwiLm10bFwiKT90LkZpbGVzVG9Mb2FkW3RoaXMuX2ZpbGVzVG9Mb2FkW2ldLm5hbWUudG9Mb3dlckNhc2UoKV09dGhpcy5fZmlsZXNUb0xvYWRbaV06LTE9PT10aGlzLl9maWxlc1RvTG9hZFtpXS5uYW1lLmluZGV4T2YoXCIuYmFieWxvblwiKSYmLTE9PT10aGlzLl9maWxlc1RvTG9hZFtpXS5uYW1lLmluZGV4T2YoXCIuc3RsXCIpJiYtMT09PXRoaXMuX2ZpbGVzVG9Mb2FkW2ldLm5hbWUuaW5kZXhPZihcIi5vYmpcIil8fC0xIT09dGhpcy5fZmlsZXNUb0xvYWRbaV0ubmFtZS5pbmRleE9mKFwiLm1hbmlmZXN0XCIpfHwtMSE9PXRoaXMuX2ZpbGVzVG9Mb2FkW2ldLm5hbWUuaW5kZXhPZihcIi5pbmNyZW1lbnRhbFwiKXx8LTEhPT10aGlzLl9maWxlc1RvTG9hZFtpXS5uYW1lLmluZGV4T2YoXCIuYmFieWxvbm1lc2hkYXRhXCIpfHwtMSE9PXRoaXMuX2ZpbGVzVG9Mb2FkW2ldLm5hbWUuaW5kZXhPZihcIi5iYWJ5bG9uZ2VvbWV0cnlkYXRhXCIpfHwtMSE9PXRoaXMuX2ZpbGVzVG9Mb2FkW2ldLm5hbWUuaW5kZXhPZihcIi5iYWJ5bG9uYmluYXJ5bWVzaGRhdGFcIil8fC0xIT09dGhpcy5fZmlsZXNUb0xvYWRbaV0ubmFtZS5pbmRleE9mKFwiLmJpbmFyeS5iYWJ5bG9uXCIpfHwodGhpcy5fc2NlbmVGaWxlVG9Mb2FkPXRoaXMuX2ZpbGVzVG9Mb2FkW2ldKX10aGlzLnJlbG9hZCgpfX0sdC5wcm90b3R5cGUucmVsb2FkPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcyxpPXRoaXM7dGhpcy5fc2NlbmVGaWxlVG9Mb2FkPyh0aGlzLl9jdXJyZW50U2NlbmUmJihlLlRvb2xzLmVycm9yc0NvdW50PjAmJihlLlRvb2xzLkNsZWFyTG9nQ2FjaGUoKSxlLlRvb2xzLkxvZyhcIkJhYnlsb24uanMgZW5naW5lICh2XCIrZS5FbmdpbmUuVmVyc2lvbitcIikgbGF1bmNoZWRcIikpLHRoaXMuX2VuZ2luZS5zdG9wUmVuZGVyTG9vcCgpLHRoaXMuX2N1cnJlbnRTY2VuZS5kaXNwb3NlKCkpLGUuU2NlbmVMb2FkZXIuTG9hZChcImZpbGU6XCIsdGhpcy5fc2NlbmVGaWxlVG9Mb2FkLHRoaXMuX2VuZ2luZSxmdW5jdGlvbihlKXtpLl9jdXJyZW50U2NlbmU9ZSxpLl9jdXJyZW50U2NlbmUuZXhlY3V0ZVdoZW5SZWFkeShmdW5jdGlvbigpe2kuX2N1cnJlbnRTY2VuZS5hY3RpdmVDYW1lcmEmJjAhPT1pLl9jdXJyZW50U2NlbmUubGlnaHRzLmxlbmd0aHx8aS5fY3VycmVudFNjZW5lLmNyZWF0ZURlZmF1bHRDYW1lcmFPckxpZ2h0KCksaS5fY3VycmVudFNjZW5lLmFjdGl2ZUNhbWVyYS5hdHRhY2hDb250cm9sKGkuX2NhbnZhcyksaS5fc2NlbmVMb2FkZWRDYWxsYmFjayYmaS5fc2NlbmVMb2FkZWRDYWxsYmFjayh0Ll9zY2VuZUZpbGVUb0xvYWQsaS5fY3VycmVudFNjZW5lKSxpLl9lbmdpbmUucnVuUmVuZGVyTG9vcChmdW5jdGlvbigpe2kucmVuZGVyRnVuY3Rpb24oKX0pfSl9LGZ1bmN0aW9uKGUpe3QuX3Byb2dyZXNzQ2FsbGJhY2smJnQuX3Byb2dyZXNzQ2FsbGJhY2soZSl9KSk6ZS5Ub29scy5FcnJvcihcIlBsZWFzZSBwcm92aWRlIGEgdmFsaWQgLmJhYnlsb24gZmlsZS5cIil9LHQuRmlsZXNUZXh0dXJlcz1uZXcgQXJyYXksdC5GaWxlc1RvTG9hZD1uZXcgQXJyYXksdH0oKTtlLkZpbGVzSW5wdXQ9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUsdCxpKXt0aGlzLmJ1PWUsdGhpcy5idj10LHRoaXMuZGlzdGFuY2U9aSx0aGlzLmZhY2VJZD0wLHRoaXMuc3ViTWVzaElkPTB9cmV0dXJuIGV9KCk7ZS5JbnRlcnNlY3Rpb25JbmZvPXQ7dmFyIGk9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KCl7dGhpcy5oaXQ9ITEsdGhpcy5kaXN0YW5jZT0wLHRoaXMucGlja2VkUG9pbnQ9bnVsbCx0aGlzLnBpY2tlZE1lc2g9bnVsbCx0aGlzLmJ1PTAsdGhpcy5idj0wLHRoaXMuZmFjZUlkPS0xLHRoaXMuc3ViTWVzaElkPTAsdGhpcy5waWNrZWRTcHJpdGU9bnVsbH1yZXR1cm4gdC5wcm90b3R5cGUuZ2V0Tm9ybWFsPWZ1bmN0aW9uKHQsaSl7aWYodm9pZCAwPT09dCYmKHQ9ITEpLHZvaWQgMD09PWkmJihpPSEwKSwhdGhpcy5waWNrZWRNZXNofHwhdGhpcy5waWNrZWRNZXNoLmlzVmVydGljZXNEYXRhUHJlc2VudChlLlZlcnRleEJ1ZmZlci5Ob3JtYWxLaW5kKSlyZXR1cm4gbnVsbDt2YXIgcixuPXRoaXMucGlja2VkTWVzaC5nZXRJbmRpY2VzKCk7aWYoaSl7dmFyIG89dGhpcy5waWNrZWRNZXNoLmdldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5Ob3JtYWxLaW5kKSxzPWUuVmVjdG9yMy5Gcm9tQXJyYXkobywzKm5bMyp0aGlzLmZhY2VJZF0pLGE9ZS5WZWN0b3IzLkZyb21BcnJheShvLDMqblszKnRoaXMuZmFjZUlkKzFdKSxoPWUuVmVjdG9yMy5Gcm9tQXJyYXkobywzKm5bMyp0aGlzLmZhY2VJZCsyXSk7cz1zLnNjYWxlKHRoaXMuYnUpLGE9YS5zY2FsZSh0aGlzLmJ2KSxoPWguc2NhbGUoMS10aGlzLmJ1LXRoaXMuYnYpLHI9bmV3IGUuVmVjdG9yMyhzLngrYS54K2gueCxzLnkrYS55K2gueSxzLnorYS56K2gueil9ZWxzZXt2YXIgYz10aGlzLnBpY2tlZE1lc2guZ2V0VmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLlBvc2l0aW9uS2luZCksbD1lLlZlY3RvcjMuRnJvbUFycmF5KGMsMypuWzMqdGhpcy5mYWNlSWRdKSx1PWUuVmVjdG9yMy5Gcm9tQXJyYXkoYywzKm5bMyp0aGlzLmZhY2VJZCsxXSksZj1lLlZlY3RvcjMuRnJvbUFycmF5KGMsMypuWzMqdGhpcy5mYWNlSWQrMl0pLGQ9bC5zdWJ0cmFjdCh1KSxwPWYuc3VidHJhY3QodSk7cj1lLlZlY3RvcjMuQ3Jvc3MoZCxwKX1yZXR1cm4gdCYmKHI9ZS5WZWN0b3IzLlRyYW5zZm9ybU5vcm1hbChyLHRoaXMucGlja2VkTWVzaC5nZXRXb3JsZE1hdHJpeCgpKSksZS5WZWN0b3IzLk5vcm1hbGl6ZShyKX0sdC5wcm90b3R5cGUuZ2V0VGV4dHVyZUNvb3JkaW5hdGVzPWZ1bmN0aW9uKCl7aWYoIXRoaXMucGlja2VkTWVzaHx8IXRoaXMucGlja2VkTWVzaC5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZS5WZXJ0ZXhCdWZmZXIuVVZLaW5kKSlyZXR1cm4gbnVsbDt2YXIgdD10aGlzLnBpY2tlZE1lc2guZ2V0SW5kaWNlcygpLGk9dGhpcy5waWNrZWRNZXNoLmdldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5VVktpbmQpLHI9ZS5WZWN0b3IyLkZyb21BcnJheShpLDIqdFszKnRoaXMuZmFjZUlkXSksbj1lLlZlY3RvcjIuRnJvbUFycmF5KGksMip0WzMqdGhpcy5mYWNlSWQrMV0pLG89ZS5WZWN0b3IyLkZyb21BcnJheShpLDIqdFszKnRoaXMuZmFjZUlkKzJdKTtyZXR1cm4gcj1yLnNjYWxlKDEtdGhpcy5idS10aGlzLmJ2KSxuPW4uc2NhbGUodGhpcy5idSksbz1vLnNjYWxlKHRoaXMuYnYpLG5ldyBlLlZlY3RvcjIoci54K24ueCtvLngsci55K24ueStvLnkpfSx0fSgpO2UuUGlja2luZ0luZm89aX0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQsaSl7dGhpcy5taW5pbXVtPXQsdGhpcy5tYXhpbXVtPWksdGhpcy5fdGVtcFJhZGl1c1ZlY3Rvcj1lLlZlY3RvcjMuWmVybygpO3ZhciByPWUuVmVjdG9yMy5EaXN0YW5jZSh0LGkpO3RoaXMuY2VudGVyPWUuVmVjdG9yMy5MZXJwKHQsaSwuNSksdGhpcy5yYWRpdXM9LjUqcix0aGlzLmNlbnRlcldvcmxkPWUuVmVjdG9yMy5aZXJvKCksdGhpcy5fdXBkYXRlKGUuTWF0cml4LklkZW50aXR5KCkpfXJldHVybiB0LnByb3RvdHlwZS5fdXBkYXRlPWZ1bmN0aW9uKHQpe2UuVmVjdG9yMy5UcmFuc2Zvcm1Db29yZGluYXRlc1RvUmVmKHRoaXMuY2VudGVyLHQsdGhpcy5jZW50ZXJXb3JsZCksZS5WZWN0b3IzLlRyYW5zZm9ybU5vcm1hbEZyb21GbG9hdHNUb1JlZigxLDEsMSx0LHRoaXMuX3RlbXBSYWRpdXNWZWN0b3IpLHRoaXMucmFkaXVzV29ybGQ9TWF0aC5tYXgoTWF0aC5hYnModGhpcy5fdGVtcFJhZGl1c1ZlY3Rvci54KSxNYXRoLmFicyh0aGlzLl90ZW1wUmFkaXVzVmVjdG9yLnkpLE1hdGguYWJzKHRoaXMuX3RlbXBSYWRpdXNWZWN0b3IueikpKnRoaXMucmFkaXVzfSx0LnByb3RvdHlwZS5pc0luRnJ1c3R1bT1mdW5jdGlvbihlKXtmb3IodmFyIHQ9MDs2PnQ7dCsrKWlmKGVbdF0uZG90Q29vcmRpbmF0ZSh0aGlzLmNlbnRlcldvcmxkKTw9LXRoaXMucmFkaXVzV29ybGQpcmV0dXJuITE7cmV0dXJuITB9LHQucHJvdG90eXBlLmludGVyc2VjdHNQb2ludD1mdW5jdGlvbih0KXt2YXIgaT10aGlzLmNlbnRlcldvcmxkLngtdC54LHI9dGhpcy5jZW50ZXJXb3JsZC55LXQueSxuPXRoaXMuY2VudGVyV29ybGQuei10Lnosbz1NYXRoLnNxcnQoaSppK3IqcituKm4pO3JldHVybiEoTWF0aC5hYnModGhpcy5yYWRpdXNXb3JsZC1vKTxlLkVwc2lsb24pfSx0LkludGVyc2VjdHM9ZnVuY3Rpb24oZSx0KXt2YXIgaT1lLmNlbnRlcldvcmxkLngtdC5jZW50ZXJXb3JsZC54LHI9ZS5jZW50ZXJXb3JsZC55LXQuY2VudGVyV29ybGQueSxuPWUuY2VudGVyV29ybGQuei10LmNlbnRlcldvcmxkLnosbz1NYXRoLnNxcnQoaSppK3IqcituKm4pO3JldHVybiEoZS5yYWRpdXNXb3JsZCt0LnJhZGl1c1dvcmxkPG8pfSx0fSgpO2UuQm91bmRpbmdTcGhlcmU9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQsaSl7dGhpcy5taW5pbXVtPXQsdGhpcy5tYXhpbXVtPWksdGhpcy52ZWN0b3JzPW5ldyBBcnJheSx0aGlzLnZlY3RvcnNXb3JsZD1uZXcgQXJyYXksdGhpcy52ZWN0b3JzLnB1c2godGhpcy5taW5pbXVtLmNsb25lKCkpLHRoaXMudmVjdG9ycy5wdXNoKHRoaXMubWF4aW11bS5jbG9uZSgpKSx0aGlzLnZlY3RvcnMucHVzaCh0aGlzLm1pbmltdW0uY2xvbmUoKSksdGhpcy52ZWN0b3JzWzJdLng9dGhpcy5tYXhpbXVtLngsdGhpcy52ZWN0b3JzLnB1c2godGhpcy5taW5pbXVtLmNsb25lKCkpLHRoaXMudmVjdG9yc1szXS55PXRoaXMubWF4aW11bS55LHRoaXMudmVjdG9ycy5wdXNoKHRoaXMubWluaW11bS5jbG9uZSgpKSx0aGlzLnZlY3RvcnNbNF0uej10aGlzLm1heGltdW0ueix0aGlzLnZlY3RvcnMucHVzaCh0aGlzLm1heGltdW0uY2xvbmUoKSksdGhpcy52ZWN0b3JzWzVdLno9dGhpcy5taW5pbXVtLnosdGhpcy52ZWN0b3JzLnB1c2godGhpcy5tYXhpbXVtLmNsb25lKCkpLHRoaXMudmVjdG9yc1s2XS54PXRoaXMubWluaW11bS54LHRoaXMudmVjdG9ycy5wdXNoKHRoaXMubWF4aW11bS5jbG9uZSgpKSx0aGlzLnZlY3RvcnNbN10ueT10aGlzLm1pbmltdW0ueSx0aGlzLmNlbnRlcj10aGlzLm1heGltdW0uYWRkKHRoaXMubWluaW11bSkuc2NhbGUoLjUpLHRoaXMuZXh0ZW5kU2l6ZT10aGlzLm1heGltdW0uc3VidHJhY3QodGhpcy5taW5pbXVtKS5zY2FsZSguNSksdGhpcy5kaXJlY3Rpb25zPVtlLlZlY3RvcjMuWmVybygpLGUuVmVjdG9yMy5aZXJvKCksZS5WZWN0b3IzLlplcm8oKV07Zm9yKHZhciByPTA7cjx0aGlzLnZlY3RvcnMubGVuZ3RoO3IrKyl0aGlzLnZlY3RvcnNXb3JsZFtyXT1lLlZlY3RvcjMuWmVybygpO3RoaXMubWluaW11bVdvcmxkPWUuVmVjdG9yMy5aZXJvKCksdGhpcy5tYXhpbXVtV29ybGQ9ZS5WZWN0b3IzLlplcm8oKSx0aGlzLl91cGRhdGUoZS5NYXRyaXguSWRlbnRpdHkoKSl9cmV0dXJuIHQucHJvdG90eXBlLmdldFdvcmxkTWF0cml4PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3dvcmxkTWF0cml4fSx0LnByb3RvdHlwZS5zZXRXb3JsZE1hdHJpeD1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fd29ybGRNYXRyaXguY29weUZyb20oZSksdGhpc30sdC5wcm90b3R5cGUuX3VwZGF0ZT1mdW5jdGlvbih0KXtlLlZlY3RvcjMuRnJvbUZsb2F0c1RvUmVmKE51bWJlci5NQVhfVkFMVUUsTnVtYmVyLk1BWF9WQUxVRSxOdW1iZXIuTUFYX1ZBTFVFLHRoaXMubWluaW11bVdvcmxkKSxlLlZlY3RvcjMuRnJvbUZsb2F0c1RvUmVmKC1OdW1iZXIuTUFYX1ZBTFVFLC1OdW1iZXIuTUFYX1ZBTFVFLC1OdW1iZXIuTUFYX1ZBTFVFLHRoaXMubWF4aW11bVdvcmxkKTtmb3IodmFyIGk9MDtpPHRoaXMudmVjdG9ycy5sZW5ndGg7aSsrKXt2YXIgcj10aGlzLnZlY3RvcnNXb3JsZFtpXTtlLlZlY3RvcjMuVHJhbnNmb3JtQ29vcmRpbmF0ZXNUb1JlZih0aGlzLnZlY3RvcnNbaV0sdCxyKSxyLng8dGhpcy5taW5pbXVtV29ybGQueCYmKHRoaXMubWluaW11bVdvcmxkLng9ci54KSxyLnk8dGhpcy5taW5pbXVtV29ybGQueSYmKHRoaXMubWluaW11bVdvcmxkLnk9ci55KSxyLno8dGhpcy5taW5pbXVtV29ybGQueiYmKHRoaXMubWluaW11bVdvcmxkLno9ci56KSxyLng+dGhpcy5tYXhpbXVtV29ybGQueCYmKHRoaXMubWF4aW11bVdvcmxkLng9ci54KSxyLnk+dGhpcy5tYXhpbXVtV29ybGQueSYmKHRoaXMubWF4aW11bVdvcmxkLnk9ci55KSxyLno+dGhpcy5tYXhpbXVtV29ybGQueiYmKHRoaXMubWF4aW11bVdvcmxkLno9ci56KX10aGlzLm1heGltdW1Xb3JsZC5hZGRUb1JlZih0aGlzLm1pbmltdW1Xb3JsZCx0aGlzLmNlbnRlciksdGhpcy5jZW50ZXIuc2NhbGVJblBsYWNlKC41KSxlLlZlY3RvcjMuRnJvbUZsb2F0QXJyYXlUb1JlZih0Lm0sMCx0aGlzLmRpcmVjdGlvbnNbMF0pLGUuVmVjdG9yMy5Gcm9tRmxvYXRBcnJheVRvUmVmKHQubSw0LHRoaXMuZGlyZWN0aW9uc1sxXSksZS5WZWN0b3IzLkZyb21GbG9hdEFycmF5VG9SZWYodC5tLDgsdGhpcy5kaXJlY3Rpb25zWzJdKSx0aGlzLl93b3JsZE1hdHJpeD10fSx0LnByb3RvdHlwZS5pc0luRnJ1c3R1bT1mdW5jdGlvbihlKXtyZXR1cm4gdC5Jc0luRnJ1c3R1bSh0aGlzLnZlY3RvcnNXb3JsZCxlKX0sdC5wcm90b3R5cGUuaXNDb21wbGV0ZWx5SW5GcnVzdHVtPWZ1bmN0aW9uKGUpe3JldHVybiB0LklzQ29tcGxldGVseUluRnJ1c3R1bSh0aGlzLnZlY3RvcnNXb3JsZCxlKX0sdC5wcm90b3R5cGUuaW50ZXJzZWN0c1BvaW50PWZ1bmN0aW9uKHQpe3ZhciBpPS1lLkVwc2lsb247cmV0dXJuIHRoaXMubWF4aW11bVdvcmxkLngtdC54PGl8fGk+dC54LXRoaXMubWluaW11bVdvcmxkLng/ITE6dGhpcy5tYXhpbXVtV29ybGQueS10Lnk8aXx8aT50LnktdGhpcy5taW5pbXVtV29ybGQueT8hMTohKHRoaXMubWF4aW11bVdvcmxkLnotdC56PGl8fGk+dC56LXRoaXMubWluaW11bVdvcmxkLnopfSx0LnByb3RvdHlwZS5pbnRlcnNlY3RzU3BoZXJlPWZ1bmN0aW9uKGUpe3JldHVybiB0LkludGVyc2VjdHNTcGhlcmUodGhpcy5taW5pbXVtV29ybGQsdGhpcy5tYXhpbXVtV29ybGQsZS5jZW50ZXJXb3JsZCxlLnJhZGl1c1dvcmxkKX0sdC5wcm90b3R5cGUuaW50ZXJzZWN0c01pbk1heD1mdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLm1heGltdW1Xb3JsZC54PGUueHx8dGhpcy5taW5pbXVtV29ybGQueD50Lng/ITE6dGhpcy5tYXhpbXVtV29ybGQueTxlLnl8fHRoaXMubWluaW11bVdvcmxkLnk+dC55PyExOiEodGhpcy5tYXhpbXVtV29ybGQuejxlLnp8fHRoaXMubWluaW11bVdvcmxkLno+dC56KX0sdC5JbnRlcnNlY3RzPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIGUubWF4aW11bVdvcmxkLng8dC5taW5pbXVtV29ybGQueHx8ZS5taW5pbXVtV29ybGQueD50Lm1heGltdW1Xb3JsZC54PyExOmUubWF4aW11bVdvcmxkLnk8dC5taW5pbXVtV29ybGQueXx8ZS5taW5pbXVtV29ybGQueT50Lm1heGltdW1Xb3JsZC55PyExOiEoZS5tYXhpbXVtV29ybGQuejx0Lm1pbmltdW1Xb3JsZC56fHxlLm1pbmltdW1Xb3JsZC56PnQubWF4aW11bVdvcmxkLnopfSx0LkludGVyc2VjdHNTcGhlcmU9ZnVuY3Rpb24odCxpLHIsbil7dmFyIG89ZS5WZWN0b3IzLkNsYW1wKHIsdCxpKSxzPWUuVmVjdG9yMy5EaXN0YW5jZVNxdWFyZWQocixvKTtyZXR1cm4gbipuPj1zfSx0LklzQ29tcGxldGVseUluRnJ1c3R1bT1mdW5jdGlvbihlLHQpe2Zvcih2YXIgaT0wOzY+aTtpKyspZm9yKHZhciByPTA7OD5yO3IrKylpZih0W2ldLmRvdENvb3JkaW5hdGUoZVtyXSk8MClyZXR1cm4hMTtyZXR1cm4hMH0sdC5Jc0luRnJ1c3R1bT1mdW5jdGlvbihlLHQpe2Zvcih2YXIgaT0wOzY+aTtpKyspe2Zvcih2YXIgcj04LG49MDs4Pm4mJnRbaV0uZG90Q29vcmRpbmF0ZShlW25dKTwwO24rKyktLXI7aWYoMD09PXIpcmV0dXJuITF9cmV0dXJuITB9LHR9KCk7ZS5Cb3VuZGluZ0JveD10fShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbih0LGkpe3ZhciByPWUuVmVjdG9yMy5Eb3QoaS5jZW50ZXIsdCksbj1NYXRoLmFicyhlLlZlY3RvcjMuRG90KGkuZGlyZWN0aW9uc1swXSx0KSkqaS5leHRlbmRTaXplLngsbz1NYXRoLmFicyhlLlZlY3RvcjMuRG90KGkuZGlyZWN0aW9uc1sxXSx0KSkqaS5leHRlbmRTaXplLnkscz1NYXRoLmFicyhlLlZlY3RvcjMuRG90KGkuZGlyZWN0aW9uc1syXSx0KSkqaS5leHRlbmRTaXplLnosYT1uK28rcztyZXR1cm57bWluOnItYSxtYXg6cithfX0saT1mdW5jdGlvbihlLHQsaSxyKXtyZXR1cm4hKGU+cnx8aT50KX0scj1mdW5jdGlvbihlLHIsbil7dmFyIG89dChlLHIpLHM9dChlLG4pO3JldHVybiBpKG8ubWluLG8ubWF4LHMubWluLHMubWF4KX0sbj1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCxpKXt0aGlzLm1pbmltdW09dCx0aGlzLm1heGltdW09aSx0aGlzLl9pc0xvY2tlZD0hMSx0aGlzLmJvdW5kaW5nQm94PW5ldyBlLkJvdW5kaW5nQm94KHQsaSksdGhpcy5ib3VuZGluZ1NwaGVyZT1uZXcgZS5Cb3VuZGluZ1NwaGVyZSh0LGkpfXJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJpc0xvY2tlZFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faXNMb2NrZWR9LHNldDpmdW5jdGlvbihlKXt0aGlzLl9pc0xvY2tlZD1lfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLHQucHJvdG90eXBlLnVwZGF0ZT1mdW5jdGlvbihlKXt0aGlzLl9pc0xvY2tlZHx8KHRoaXMuYm91bmRpbmdCb3guX3VwZGF0ZShlKSx0aGlzLmJvdW5kaW5nU3BoZXJlLl91cGRhdGUoZSkpfSx0LnByb3RvdHlwZS5pc0luRnJ1c3R1bT1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5ib3VuZGluZ1NwaGVyZS5pc0luRnJ1c3R1bShlKT90aGlzLmJvdW5kaW5nQm94LmlzSW5GcnVzdHVtKGUpOiExfSx0LnByb3RvdHlwZS5pc0NvbXBsZXRlbHlJbkZydXN0dW09ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuYm91bmRpbmdCb3guaXNDb21wbGV0ZWx5SW5GcnVzdHVtKGUpfSx0LnByb3RvdHlwZS5fY2hlY2tDb2xsaXNpb249ZnVuY3Rpb24oZSl7cmV0dXJuIGUuX2NhbkRvQ29sbGlzaW9uKHRoaXMuYm91bmRpbmdTcGhlcmUuY2VudGVyV29ybGQsdGhpcy5ib3VuZGluZ1NwaGVyZS5yYWRpdXNXb3JsZCx0aGlzLmJvdW5kaW5nQm94Lm1pbmltdW1Xb3JsZCx0aGlzLmJvdW5kaW5nQm94Lm1heGltdW1Xb3JsZCl9LHQucHJvdG90eXBlLmludGVyc2VjdHNQb2ludD1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5ib3VuZGluZ1NwaGVyZS5jZW50ZXJXb3JsZCYmdGhpcy5ib3VuZGluZ1NwaGVyZS5pbnRlcnNlY3RzUG9pbnQoZSk/ISF0aGlzLmJvdW5kaW5nQm94LmludGVyc2VjdHNQb2ludChlKTohMX0sdC5wcm90b3R5cGUuaW50ZXJzZWN0cz1mdW5jdGlvbih0LGkpe2lmKCF0aGlzLmJvdW5kaW5nU3BoZXJlLmNlbnRlcldvcmxkfHwhdC5ib3VuZGluZ1NwaGVyZS5jZW50ZXJXb3JsZClyZXR1cm4hMTtpZighZS5Cb3VuZGluZ1NwaGVyZS5JbnRlcnNlY3RzKHRoaXMuYm91bmRpbmdTcGhlcmUsdC5ib3VuZGluZ1NwaGVyZSkpcmV0dXJuITE7aWYoIWUuQm91bmRpbmdCb3guSW50ZXJzZWN0cyh0aGlzLmJvdW5kaW5nQm94LHQuYm91bmRpbmdCb3gpKXJldHVybiExO2lmKCFpKXJldHVybiEwO3ZhciBuPXRoaXMuYm91bmRpbmdCb3gsbz10LmJvdW5kaW5nQm94O3JldHVybiByKG4uZGlyZWN0aW9uc1swXSxuLG8pJiZyKG4uZGlyZWN0aW9uc1sxXSxuLG8pJiZyKG4uZGlyZWN0aW9uc1syXSxuLG8pJiZyKG8uZGlyZWN0aW9uc1swXSxuLG8pJiZyKG8uZGlyZWN0aW9uc1sxXSxuLG8pJiZyKG8uZGlyZWN0aW9uc1syXSxuLG8pJiZyKGUuVmVjdG9yMy5Dcm9zcyhuLmRpcmVjdGlvbnNbMF0sby5kaXJlY3Rpb25zWzBdKSxuLG8pJiZyKGUuVmVjdG9yMy5Dcm9zcyhuLmRpcmVjdGlvbnNbMF0sby5kaXJlY3Rpb25zWzFdKSxuLG8pJiZyKGUuVmVjdG9yMy5Dcm9zcyhuLmRpcmVjdGlvbnNbMF0sby5kaXJlY3Rpb25zWzJdKSxuLG8pJiZyKGUuVmVjdG9yMy5Dcm9zcyhuLmRpcmVjdGlvbnNbMV0sby5kaXJlY3Rpb25zWzBdKSxuLG8pJiZyKGUuVmVjdG9yMy5Dcm9zcyhuLmRpcmVjdGlvbnNbMV0sby5kaXJlY3Rpb25zWzFdKSxuLG8pJiZyKGUuVmVjdG9yMy5Dcm9zcyhuLmRpcmVjdGlvbnNbMV0sby5kaXJlY3Rpb25zWzJdKSxuLG8pJiZyKGUuVmVjdG9yMy5Dcm9zcyhuLmRpcmVjdGlvbnNbMl0sby5kaXJlY3Rpb25zWzBdKSxuLG8pJiZyKGUuVmVjdG9yMy5Dcm9zcyhuLmRpcmVjdGlvbnNbMl0sby5kaXJlY3Rpb25zWzFdKSxuLG8pPyEhcihlLlZlY3RvcjMuQ3Jvc3Mobi5kaXJlY3Rpb25zWzJdLG8uZGlyZWN0aW9uc1syXSksbixvKTohMX0sdH0oKTtlLkJvdW5kaW5nSW5mbz1ufShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoZSx0LGkpe3ZvaWQgMD09PWkmJihpPU51bWJlci5NQVhfVkFMVUUpLHRoaXMub3JpZ2luPWUsdGhpcy5kaXJlY3Rpb249dCx0aGlzLmxlbmd0aD1pfXJldHVybiB0LnByb3RvdHlwZS5pbnRlcnNlY3RzQm94TWluTWF4PWZ1bmN0aW9uKGUsdCl7dmFyIGkscixuLG8scz0wLGE9TnVtYmVyLk1BWF9WQUxVRTtpZihNYXRoLmFicyh0aGlzLmRpcmVjdGlvbi54KTwxZS03KXtpZih0aGlzLm9yaWdpbi54PGUueHx8dGhpcy5vcmlnaW4ueD50LngpcmV0dXJuITF9ZWxzZSBpZihpPTEvdGhpcy5kaXJlY3Rpb24ueCxyPShlLngtdGhpcy5vcmlnaW4ueCkqaSxuPSh0LngtdGhpcy5vcmlnaW4ueCkqaSxuPT09LSgxLzApJiYobj0xLzApLHI+biYmKG89cixyPW4sbj1vKSxzPU1hdGgubWF4KHIscyksYT1NYXRoLm1pbihuLGEpLHM+YSlyZXR1cm4hMTtpZihNYXRoLmFicyh0aGlzLmRpcmVjdGlvbi55KTwxZS03KXtpZih0aGlzLm9yaWdpbi55PGUueXx8dGhpcy5vcmlnaW4ueT50LnkpcmV0dXJuITF9ZWxzZSBpZihpPTEvdGhpcy5kaXJlY3Rpb24ueSxyPShlLnktdGhpcy5vcmlnaW4ueSkqaSxuPSh0LnktdGhpcy5vcmlnaW4ueSkqaSxuPT09LSgxLzApJiYobj0xLzApLHI+biYmKG89cixyPW4sbj1vKSxzPU1hdGgubWF4KHIscyksYT1NYXRoLm1pbihuLGEpLHM+YSlyZXR1cm4hMTtpZihNYXRoLmFicyh0aGlzLmRpcmVjdGlvbi56KTwxZS03KXtpZih0aGlzLm9yaWdpbi56PGUuenx8dGhpcy5vcmlnaW4uej50LnopcmV0dXJuITF9ZWxzZSBpZihpPTEvdGhpcy5kaXJlY3Rpb24ueixyPShlLnotdGhpcy5vcmlnaW4ueikqaSxuPSh0LnotdGhpcy5vcmlnaW4ueikqaSxuPT09LSgxLzApJiYobj0xLzApLHI+biYmKG89cixyPW4sbj1vKSxzPU1hdGgubWF4KHIscyksYT1NYXRoLm1pbihuLGEpLHM+YSlyZXR1cm4hMTtyZXR1cm4hMH0sdC5wcm90b3R5cGUuaW50ZXJzZWN0c0JveD1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5pbnRlcnNlY3RzQm94TWluTWF4KGUubWluaW11bSxlLm1heGltdW0pfSx0LnByb3RvdHlwZS5pbnRlcnNlY3RzU3BoZXJlPWZ1bmN0aW9uKGUpe3ZhciB0PWUuY2VudGVyLngtdGhpcy5vcmlnaW4ueCxpPWUuY2VudGVyLnktdGhpcy5vcmlnaW4ueSxyPWUuY2VudGVyLnotdGhpcy5vcmlnaW4ueixuPXQqdCtpKmkrcipyLG89ZS5yYWRpdXMqZS5yYWRpdXM7aWYobz49bilyZXR1cm4hMDt2YXIgcz10KnRoaXMuZGlyZWN0aW9uLngraSp0aGlzLmRpcmVjdGlvbi55K3IqdGhpcy5kaXJlY3Rpb24uejtpZigwPnMpcmV0dXJuITE7dmFyIGE9bi1zKnM7cmV0dXJuIG8+PWF9LHQucHJvdG90eXBlLmludGVyc2VjdHNUcmlhbmdsZT1mdW5jdGlvbih0LGkscil7dGhpcy5fZWRnZTF8fCh0aGlzLl9lZGdlMT1lLlZlY3RvcjMuWmVybygpLHRoaXMuX2VkZ2UyPWUuVmVjdG9yMy5aZXJvKCksdGhpcy5fcHZlYz1lLlZlY3RvcjMuWmVybygpLHRoaXMuX3R2ZWM9ZS5WZWN0b3IzLlplcm8oKSx0aGlzLl9xdmVjPWUuVmVjdG9yMy5aZXJvKCkpLGkuc3VidHJhY3RUb1JlZih0LHRoaXMuX2VkZ2UxKSxyLnN1YnRyYWN0VG9SZWYodCx0aGlzLl9lZGdlMiksZS5WZWN0b3IzLkNyb3NzVG9SZWYodGhpcy5kaXJlY3Rpb24sdGhpcy5fZWRnZTIsdGhpcy5fcHZlYyk7dmFyIG49ZS5WZWN0b3IzLkRvdCh0aGlzLl9lZGdlMSx0aGlzLl9wdmVjKTtpZigwPT09bilyZXR1cm4gbnVsbDt2YXIgbz0xL247dGhpcy5vcmlnaW4uc3VidHJhY3RUb1JlZih0LHRoaXMuX3R2ZWMpO3ZhciBzPWUuVmVjdG9yMy5Eb3QodGhpcy5fdHZlYyx0aGlzLl9wdmVjKSpvO2lmKDA+c3x8cz4xKXJldHVybiBudWxsO2UuVmVjdG9yMy5Dcm9zc1RvUmVmKHRoaXMuX3R2ZWMsdGhpcy5fZWRnZTEsdGhpcy5fcXZlYyk7dmFyIGE9ZS5WZWN0b3IzLkRvdCh0aGlzLmRpcmVjdGlvbix0aGlzLl9xdmVjKSpvO2lmKDA+YXx8cythPjEpcmV0dXJuIG51bGw7dmFyIGg9ZS5WZWN0b3IzLkRvdCh0aGlzLl9lZGdlMix0aGlzLl9xdmVjKSpvO3JldHVybiBoPnRoaXMubGVuZ3RoP251bGw6bmV3IGUuSW50ZXJzZWN0aW9uSW5mbyhzLGEsaCl9LHQucHJvdG90eXBlLmludGVyc2VjdHNQbGFuZT1mdW5jdGlvbih0KXt2YXIgaSxyPWUuVmVjdG9yMy5Eb3QodC5ub3JtYWwsdGhpcy5kaXJlY3Rpb24pO2lmKE1hdGguYWJzKHIpPDkuOTk5OTk5OTc0NzUyNDNlLTcpcmV0dXJuIG51bGw7dmFyIG49ZS5WZWN0b3IzLkRvdCh0Lm5vcm1hbCx0aGlzLm9yaWdpbik7cmV0dXJuIGk9KC10LmQtbikvciwwPmk/LTkuOTk5OTk5OTc0NzUyNDNlLTc+aT9udWxsOjA6aX0sdC5wcm90b3R5cGUuaW50ZXJzZWN0aW9uU2VnbWVudD1mdW5jdGlvbihpLHIsbil7dmFyIG8scyxhLGgsYz10aGlzLm9yaWdpbi5hZGQodGhpcy5kaXJlY3Rpb24ubXVsdGlwbHlCeUZsb2F0cyh0LnJheWwsdC5yYXlsLHQucmF5bCkpLGw9ci5zdWJ0cmFjdChpKSx1PWMuc3VidHJhY3QodGhpcy5vcmlnaW4pLGY9aS5zdWJ0cmFjdCh0aGlzLm9yaWdpbiksZD1lLlZlY3RvcjMuRG90KGwsbCkscD1lLlZlY3RvcjMuRG90KGwsdSksXz1lLlZlY3RvcjMuRG90KHUsdSksbT1lLlZlY3RvcjMuRG90KGwsZiksZz1lLlZlY3RvcjMuRG90KHUsZiksdj1kKl8tcCpwLHk9dix4PXY7XG52PHQuc21hbGxudW0/KHM9MCx5PTEsaD1nLHg9Xyk6KHM9cCpnLV8qbSxoPWQqZy1wKm0sMD5zPyhzPTAsaD1nLHg9Xyk6cz55JiYocz15LGg9ZytwLHg9XykpLDA+aD8oaD0wLDA+LW0/cz0wOi1tPmQ/cz15OihzPS1tLHk9ZCkpOmg+eCYmKGg9eCwwPi1tK3A/cz0wOi1tK3A+ZD9zPXk6KHM9LW0rcCx5PWQpKSxvPU1hdGguYWJzKHMpPHQuc21hbGxudW0/MDpzL3ksYT1NYXRoLmFicyhoKTx0LnNtYWxsbnVtPzA6aC94O3ZhciBiPXUubXVsdGlwbHlCeUZsb2F0cyhhLGEsYSksUD1mLmFkZChsLm11bHRpcGx5QnlGbG9hdHMobyxvLG8pKS5zdWJ0cmFjdChiKSxBPWE+MCYmYTw9dGhpcy5sZW5ndGgmJlAubGVuZ3RoU3F1YXJlZCgpPG4qbjtyZXR1cm4gQT9iLmxlbmd0aCgpOi0xfSx0LkNyZWF0ZU5ldz1mdW5jdGlvbihpLHIsbixvLHMsYSxoKXt2YXIgYz1lLlZlY3RvcjMuVW5wcm9qZWN0KG5ldyBlLlZlY3RvcjMoaSxyLDApLG4sbyxzLGEsaCksbD1lLlZlY3RvcjMuVW5wcm9qZWN0KG5ldyBlLlZlY3RvcjMoaSxyLDEpLG4sbyxzLGEsaCksdT1sLnN1YnRyYWN0KGMpO3JldHVybiB1Lm5vcm1hbGl6ZSgpLG5ldyB0KGMsdSl9LHQuQ3JlYXRlTmV3RnJvbVRvPWZ1bmN0aW9uKGkscixuKXt2b2lkIDA9PT1uJiYobj1lLk1hdHJpeC5JZGVudGl0eSgpKTt2YXIgbz1yLnN1YnRyYWN0KGkpLHM9TWF0aC5zcXJ0KG8ueCpvLngrby55Km8ueStvLnoqby56KTtyZXR1cm4gby5ub3JtYWxpemUoKSx0LlRyYW5zZm9ybShuZXcgdChpLG8scyksbil9LHQuVHJhbnNmb3JtPWZ1bmN0aW9uKGkscil7dmFyIG49ZS5WZWN0b3IzLlRyYW5zZm9ybUNvb3JkaW5hdGVzKGkub3JpZ2luLHIpLG89ZS5WZWN0b3IzLlRyYW5zZm9ybU5vcm1hbChpLmRpcmVjdGlvbixyKTtyZXR1cm4gby5ub3JtYWxpemUoKSxuZXcgdChuLG8saS5sZW5ndGgpfSx0LnNtYWxsbnVtPTFlLTgsdC5yYXlsPTFlOSx0fSgpO2UuUmF5PXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGkocixuKXt2YXIgbz10aGlzO3QuY2FsbCh0aGlzLHIsbiksdGhpcy5vbkRpc3Bvc2VPYnNlcnZhYmxlPW5ldyBlLk9ic2VydmFibGUsdGhpcy5vbkNvbGxpZGVPYnNlcnZhYmxlPW5ldyBlLk9ic2VydmFibGUsdGhpcy5vbkNvbGxpc2lvblBvc2l0aW9uQ2hhbmdlT2JzZXJ2YWJsZT1uZXcgZS5PYnNlcnZhYmxlLHRoaXMub25BZnRlcldvcmxkTWF0cml4VXBkYXRlT2JzZXJ2YWJsZT1uZXcgZS5PYnNlcnZhYmxlLHRoaXMuZGVmaW5lZEZhY2luZ0ZvcndhcmQ9ITAsdGhpcy5wb3NpdGlvbj1uZXcgZS5WZWN0b3IzKDAsMCwwKSx0aGlzLl9yb3RhdGlvbj1uZXcgZS5WZWN0b3IzKDAsMCwwKSx0aGlzLl9zY2FsaW5nPW5ldyBlLlZlY3RvcjMoMSwxLDEpLHRoaXMuYmlsbGJvYXJkTW9kZT1pLkJJTExCT0FSRE1PREVfTk9ORSx0aGlzLnZpc2liaWxpdHk9MSx0aGlzLmFscGhhSW5kZXg9TnVtYmVyLk1BWF9WQUxVRSx0aGlzLmluZmluaXRlRGlzdGFuY2U9ITEsdGhpcy5pc1Zpc2libGU9ITAsdGhpcy5pc1BpY2thYmxlPSEwLHRoaXMuc2hvd0JvdW5kaW5nQm94PSExLHRoaXMuc2hvd1N1Yk1lc2hlc0JvdW5kaW5nQm94PSExLHRoaXMuaXNCbG9ja2VyPSExLHRoaXMucmVuZGVyaW5nR3JvdXBJZD0wLHRoaXMucmVjZWl2ZVNoYWRvd3M9ITEsdGhpcy5yZW5kZXJPdXRsaW5lPSExLHRoaXMub3V0bGluZUNvbG9yPWUuQ29sb3IzLlJlZCgpLHRoaXMub3V0bGluZVdpZHRoPS4wMix0aGlzLnJlbmRlck92ZXJsYXk9ITEsdGhpcy5vdmVybGF5Q29sb3I9ZS5Db2xvcjMuUmVkKCksdGhpcy5vdmVybGF5QWxwaGE9LjUsdGhpcy5oYXNWZXJ0ZXhBbHBoYT0hMSx0aGlzLnVzZVZlcnRleENvbG9ycz0hMCx0aGlzLmFwcGx5Rm9nPSEwLHRoaXMuY29tcHV0ZUJvbmVzVXNpbmdTaGFkZXJzPSEwLHRoaXMuc2NhbGluZ0RldGVybWluYW50PTEsdGhpcy5udW1Cb25lSW5mbHVlbmNlcnM9NCx0aGlzLnVzZU9jdHJlZUZvclJlbmRlcmluZ1NlbGVjdGlvbj0hMCx0aGlzLnVzZU9jdHJlZUZvclBpY2tpbmc9ITAsdGhpcy51c2VPY3RyZWVGb3JDb2xsaXNpb25zPSEwLHRoaXMubGF5ZXJNYXNrPTI2ODQzNTQ1NSx0aGlzLmFsd2F5c1NlbGVjdEFzQWN0aXZlTWVzaD0hMSx0aGlzLl9jaGVja0NvbGxpc2lvbnM9ITEsdGhpcy5lbGxpcHNvaWQ9bmV3IGUuVmVjdG9yMyguNSwxLC41KSx0aGlzLmVsbGlwc29pZE9mZnNldD1uZXcgZS5WZWN0b3IzKDAsMCwwKSx0aGlzLl9jb2xsaWRlcj1uZXcgZS5Db2xsaWRlcix0aGlzLl9vbGRQb3NpdGlvbkZvckNvbGxpc2lvbnM9bmV3IGUuVmVjdG9yMygwLDAsMCksdGhpcy5fZGlmZlBvc2l0aW9uRm9yQ29sbGlzaW9ucz1uZXcgZS5WZWN0b3IzKDAsMCwwKSx0aGlzLl9uZXdQb3NpdGlvbkZvckNvbGxpc2lvbnM9bmV3IGUuVmVjdG9yMygwLDAsMCksdGhpcy5lZGdlc1dpZHRoPTEsdGhpcy5lZGdlc0NvbG9yPW5ldyBlLkNvbG9yNCgxLDAsMCwxKSx0aGlzLl9sb2NhbFdvcmxkPWUuTWF0cml4Llplcm8oKSx0aGlzLl93b3JsZE1hdHJpeD1lLk1hdHJpeC5aZXJvKCksdGhpcy5fcm90YXRlWUJ5UEk9ZS5NYXRyaXguUm90YXRpb25ZKE1hdGguUEkpLHRoaXMuX2Fic29sdXRlUG9zaXRpb249ZS5WZWN0b3IzLlplcm8oKSx0aGlzLl9jb2xsaXNpb25zVHJhbnNmb3JtTWF0cml4PWUuTWF0cml4Llplcm8oKSx0aGlzLl9jb2xsaXNpb25zU2NhbGluZ01hdHJpeD1lLk1hdHJpeC5aZXJvKCksdGhpcy5faXNEaXJ0eT0hMSx0aGlzLl9waXZvdE1hdHJpeD1lLk1hdHJpeC5JZGVudGl0eSgpLHRoaXMuX2lzRGlzcG9zZWQ9ITEsdGhpcy5fcmVuZGVySWQ9MCx0aGlzLl9pbnRlcnNlY3Rpb25zSW5Qcm9ncmVzcz1uZXcgQXJyYXksdGhpcy5faXNXb3JsZE1hdHJpeEZyb3plbj0hMSx0aGlzLl91bkluZGV4ZWQ9ITEsdGhpcy5fb25Db2xsaXNpb25Qb3NpdGlvbkNoYW5nZT1mdW5jdGlvbih0LGkscil7dm9pZCAwPT09ciYmKHI9bnVsbCksby5nZXRTY2VuZSgpLndvcmtlckNvbGxpc2lvbnMmJmkubXVsdGlwbHlJblBsYWNlKG8uX2NvbGxpZGVyLnJhZGl1cyksaS5zdWJ0cmFjdFRvUmVmKG8uX29sZFBvc2l0aW9uRm9yQ29sbGlzaW9ucyxvLl9kaWZmUG9zaXRpb25Gb3JDb2xsaXNpb25zKSxvLl9kaWZmUG9zaXRpb25Gb3JDb2xsaXNpb25zLmxlbmd0aCgpPmUuRW5naW5lLkNvbGxpc2lvbnNFcHNpbG9uJiZvLnBvc2l0aW9uLmFkZEluUGxhY2Uoby5fZGlmZlBvc2l0aW9uRm9yQ29sbGlzaW9ucyksciYmby5vbkNvbGxpZGVPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhyKSxvLm9uQ29sbGlzaW9uUG9zaXRpb25DaGFuZ2VPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhvLnBvc2l0aW9uKX0sbi5hZGRNZXNoKHRoaXMpfXJldHVybiBfX2V4dGVuZHMoaSx0KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaSxcIkJJTExCT0FSRE1PREVfTk9ORVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gaS5fQklMTEJPQVJETU9ERV9OT05FfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLFwiQklMTEJPQVJETU9ERV9YXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBpLl9CSUxMQk9BUkRNT0RFX1h9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGksXCJCSUxMQk9BUkRNT0RFX1lcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGkuX0JJTExCT0FSRE1PREVfWX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaSxcIkJJTExCT0FSRE1PREVfWlwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gaS5fQklMTEJPQVJETU9ERV9afSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLFwiQklMTEJPQVJETU9ERV9BTExcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGkuX0JJTExCT0FSRE1PREVfQUxMfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcIm9uRGlzcG9zZVwiLHtzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fb25EaXNwb3NlT2JzZXJ2ZXImJnRoaXMub25EaXNwb3NlT2JzZXJ2YWJsZS5yZW1vdmUodGhpcy5fb25EaXNwb3NlT2JzZXJ2ZXIpLHRoaXMuX29uRGlzcG9zZU9ic2VydmVyPXRoaXMub25EaXNwb3NlT2JzZXJ2YWJsZS5hZGQoZSl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGkucHJvdG90eXBlLFwib25Db2xsaWRlXCIse3NldDpmdW5jdGlvbihlKXt0aGlzLl9vbkNvbGxpZGVPYnNlcnZlciYmdGhpcy5vbkNvbGxpZGVPYnNlcnZhYmxlLnJlbW92ZSh0aGlzLl9vbkNvbGxpZGVPYnNlcnZlciksdGhpcy5fb25Db2xsaWRlT2JzZXJ2ZXI9dGhpcy5vbkNvbGxpZGVPYnNlcnZhYmxlLmFkZChlKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJvbkNvbGxpc2lvblBvc2l0aW9uQ2hhbmdlXCIse3NldDpmdW5jdGlvbihlKXt0aGlzLl9vbkNvbGxpc2lvblBvc2l0aW9uQ2hhbmdlT2JzZXJ2ZXImJnRoaXMub25Db2xsaXNpb25Qb3NpdGlvbkNoYW5nZU9ic2VydmFibGUucmVtb3ZlKHRoaXMuX29uQ29sbGlzaW9uUG9zaXRpb25DaGFuZ2VPYnNlcnZlciksdGhpcy5fb25Db2xsaXNpb25Qb3NpdGlvbkNoYW5nZU9ic2VydmVyPXRoaXMub25Db2xsaXNpb25Qb3NpdGlvbkNoYW5nZU9ic2VydmFibGUuYWRkKGUpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcInNrZWxldG9uXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9za2VsZXRvbn0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX3NrZWxldG9uJiZ0aGlzLl9za2VsZXRvbi5uZWVkSW5pdGlhbFNraW5NYXRyaXgmJnRoaXMuX3NrZWxldG9uLl91bnJlZ2lzdGVyTWVzaFdpdGhQb3NlTWF0cml4KHRoaXMpLGUmJmUubmVlZEluaXRpYWxTa2luTWF0cml4JiZlLl9yZWdpc3Rlck1lc2hXaXRoUG9zZU1hdHJpeCh0aGlzKSx0aGlzLl9za2VsZXRvbj1lLHRoaXMuX3NrZWxldG9ufHwodGhpcy5fYm9uZXNUcmFuc2Zvcm1NYXRyaWNlcz1udWxsKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxpLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbih0KXt2YXIgaT1cIk5hbWU6IFwiK3RoaXMubmFtZStcIiwgaXNJbnN0YW5jZTogXCIrKHRoaXMgaW5zdGFuY2VvZiBlLkluc3RhbmNlZE1lc2g/XCJZRVNcIjpcIk5PXCIpO3JldHVybiBpKz1cIiwgIyBvZiBzdWJtZXNoZXM6IFwiKyh0aGlzLnN1Yk1lc2hlcz90aGlzLnN1Yk1lc2hlcy5sZW5ndGg6MCksdGhpcy5fc2tlbGV0b24mJihpKz1cIiwgc2tlbGV0b246IFwiK3RoaXMuX3NrZWxldG9uLm5hbWUpLHQmJihpKz1cIiwgYmlsbGJvYXJkIG1vZGU6IFwiK1tcIk5PTkVcIixcIlhcIixcIllcIixudWxsLFwiWlwiLG51bGwsbnVsbCxcIkFMTFwiXVt0aGlzLmJpbGxib2FyZE1vZGVdLGkrPVwiLCBmcmVlemUgd3JsZCBtYXQ6IFwiKyh0aGlzLl9pc1dvcmxkTWF0cml4RnJvemVufHx0aGlzLl93YWl0aW5nRnJlZXplV29ybGRNYXRyaXg/XCJZRVNcIjpcIk5PXCIpKSxpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJyb3RhdGlvblwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcm90YXRpb259LHNldDpmdW5jdGlvbihlKXt0aGlzLl9yb3RhdGlvbj1lfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcInNjYWxpbmdcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3NjYWxpbmd9LHNldDpmdW5jdGlvbihlKXt0aGlzLl9zY2FsaW5nPWUsdGhpcy5waHlzaWNzSW1wb3N0b3ImJnRoaXMucGh5c2ljc0ltcG9zdG9yLmZvcmNlVXBkYXRlKCl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGkucHJvdG90eXBlLFwicm90YXRpb25RdWF0ZXJuaW9uXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9yb3RhdGlvblF1YXRlcm5pb259LHNldDpmdW5jdGlvbihlKXt0aGlzLl9yb3RhdGlvblF1YXRlcm5pb249ZSxlJiZ0aGlzLnJvdGF0aW9uLmxlbmd0aCgpJiZ0aGlzLnJvdGF0aW9uLmNvcHlGcm9tRmxvYXRzKDAsMCwwKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxpLnByb3RvdHlwZS51cGRhdGVQb3NlTWF0cml4PWZ1bmN0aW9uKGUpe3RoaXMuX3Bvc2VNYXRyaXguY29weUZyb20oZSl9LGkucHJvdG90eXBlLmdldFBvc2VNYXRyaXg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcG9zZU1hdHJpeH0saS5wcm90b3R5cGUuZGlzYWJsZUVkZ2VzUmVuZGVyaW5nPWZ1bmN0aW9uKCl7dm9pZCAwIT09dGhpcy5fZWRnZXNSZW5kZXJlciYmKHRoaXMuX2VkZ2VzUmVuZGVyZXIuZGlzcG9zZSgpLHRoaXMuX2VkZ2VzUmVuZGVyZXI9dm9pZCAwKX0saS5wcm90b3R5cGUuZW5hYmxlRWRnZXNSZW5kZXJpbmc9ZnVuY3Rpb24odCxpKXt2b2lkIDA9PT10JiYodD0uOTUpLHZvaWQgMD09PWkmJihpPSExKSx0aGlzLmRpc2FibGVFZGdlc1JlbmRlcmluZygpLHRoaXMuX2VkZ2VzUmVuZGVyZXI9bmV3IGUuRWRnZXNSZW5kZXJlcih0aGlzLHQsaSl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcImlzQmxvY2tlZFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4hMX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxpLnByb3RvdHlwZS5nZXRMT0Q9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXN9LGkucHJvdG90eXBlLmdldFRvdGFsVmVydGljZXM9ZnVuY3Rpb24oKXtyZXR1cm4gMH0saS5wcm90b3R5cGUuZ2V0SW5kaWNlcz1mdW5jdGlvbigpe3JldHVybiBudWxsfSxpLnByb3RvdHlwZS5nZXRWZXJ0aWNlc0RhdGE9ZnVuY3Rpb24oZSl7cmV0dXJuIG51bGx9LGkucHJvdG90eXBlLmlzVmVydGljZXNEYXRhUHJlc2VudD1mdW5jdGlvbihlKXtyZXR1cm4hMX0saS5wcm90b3R5cGUuZ2V0Qm91bmRpbmdJbmZvPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX21hc3Rlck1lc2g/dGhpcy5fbWFzdGVyTWVzaC5nZXRCb3VuZGluZ0luZm8oKToodGhpcy5fYm91bmRpbmdJbmZvfHx0aGlzLl91cGRhdGVCb3VuZGluZ0luZm8oKSx0aGlzLl9ib3VuZGluZ0luZm8pfSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJ1c2VCb25lc1wiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5za2VsZXRvbiYmdGhpcy5nZXRTY2VuZSgpLnNrZWxldG9uc0VuYWJsZWQmJnRoaXMuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGUuVmVydGV4QnVmZmVyLk1hdHJpY2VzSW5kaWNlc0tpbmQpJiZ0aGlzLmlzVmVydGljZXNEYXRhUHJlc2VudChlLlZlcnRleEJ1ZmZlci5NYXRyaWNlc1dlaWdodHNLaW5kKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxpLnByb3RvdHlwZS5fcHJlQWN0aXZhdGU9ZnVuY3Rpb24oKXt9LGkucHJvdG90eXBlLl9wcmVBY3RpdmF0ZUZvckludGVybWVkaWF0ZVJlbmRlcmluZz1mdW5jdGlvbihlKXt9LGkucHJvdG90eXBlLl9hY3RpdmF0ZT1mdW5jdGlvbihlKXt0aGlzLl9yZW5kZXJJZD1lfSxpLnByb3RvdHlwZS5nZXRXb3JsZE1hdHJpeD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9tYXN0ZXJNZXNoP3RoaXMuX21hc3Rlck1lc2guZ2V0V29ybGRNYXRyaXgoKToodGhpcy5fY3VycmVudFJlbmRlcklkIT09dGhpcy5nZXRTY2VuZSgpLmdldFJlbmRlcklkKCkmJnRoaXMuY29tcHV0ZVdvcmxkTWF0cml4KCksdGhpcy5fd29ybGRNYXRyaXgpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJ3b3JsZE1hdHJpeEZyb21DYWNoZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fd29ybGRNYXRyaXh9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGkucHJvdG90eXBlLFwiYWJzb2x1dGVQb3NpdGlvblwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fYWJzb2x1dGVQb3NpdGlvbn0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxpLnByb3RvdHlwZS5mcmVlemVXb3JsZE1hdHJpeD1mdW5jdGlvbigpe3RoaXMuX2lzV29ybGRNYXRyaXhGcm96ZW49ITEsdGhpcy5jb21wdXRlV29ybGRNYXRyaXgoITApLHRoaXMuX2lzV29ybGRNYXRyaXhGcm96ZW49ITB9LGkucHJvdG90eXBlLnVuZnJlZXplV29ybGRNYXRyaXg9ZnVuY3Rpb24oKXt0aGlzLl9pc1dvcmxkTWF0cml4RnJvemVuPSExLHRoaXMuY29tcHV0ZVdvcmxkTWF0cml4KCEwKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KGkucHJvdG90eXBlLFwiaXNXb3JsZE1hdHJpeEZyb3plblwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faXNXb3JsZE1hdHJpeEZyb3plbn0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxpLnByb3RvdHlwZS5yb3RhdGU9ZnVuY3Rpb24odCxpLHIpe3Qubm9ybWFsaXplKCksdGhpcy5yb3RhdGlvblF1YXRlcm5pb258fCh0aGlzLnJvdGF0aW9uUXVhdGVybmlvbj1lLlF1YXRlcm5pb24uUm90YXRpb25ZYXdQaXRjaFJvbGwodGhpcy5yb3RhdGlvbi55LHRoaXMucm90YXRpb24ueCx0aGlzLnJvdGF0aW9uLnopLHRoaXMucm90YXRpb249ZS5WZWN0b3IzLlplcm8oKSk7dmFyIG47aWYociYmciE9PWUuU3BhY2UuTE9DQUwpe2lmKHRoaXMucGFyZW50KXt2YXIgbz10aGlzLnBhcmVudC5nZXRXb3JsZE1hdHJpeCgpLmNsb25lKCk7by5pbnZlcnQoKSx0PWUuVmVjdG9yMy5UcmFuc2Zvcm1Ob3JtYWwodCxvKX1uPWUuUXVhdGVybmlvbi5Sb3RhdGlvbkF4aXModCxpKSx0aGlzLnJvdGF0aW9uUXVhdGVybmlvbj1uLm11bHRpcGx5KHRoaXMucm90YXRpb25RdWF0ZXJuaW9uKX1lbHNlIG49ZS5RdWF0ZXJuaW9uLlJvdGF0aW9uQXhpcyh0LGkpLHRoaXMucm90YXRpb25RdWF0ZXJuaW9uPXRoaXMucm90YXRpb25RdWF0ZXJuaW9uLm11bHRpcGx5KG4pfSxpLnByb3RvdHlwZS50cmFuc2xhdGU9ZnVuY3Rpb24odCxpLHIpe3ZhciBuPXQuc2NhbGUoaSk7aWYociYmciE9PWUuU3BhY2UuTE9DQUwpdGhpcy5zZXRBYnNvbHV0ZVBvc2l0aW9uKHRoaXMuZ2V0QWJzb2x1dGVQb3NpdGlvbigpLmFkZChuKSk7ZWxzZXt2YXIgbz10aGlzLmdldFBvc2l0aW9uRXhwcmVzc2VkSW5Mb2NhbFNwYWNlKCkuYWRkKG4pO3RoaXMuc2V0UG9zaXRpb25XaXRoTG9jYWxWZWN0b3Iobyl9fSxpLnByb3RvdHlwZS5nZXRBYnNvbHV0ZVBvc2l0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29tcHV0ZVdvcmxkTWF0cml4KCksdGhpcy5fYWJzb2x1dGVQb3NpdGlvbn0saS5wcm90b3R5cGUuc2V0QWJzb2x1dGVQb3NpdGlvbj1mdW5jdGlvbih0KXtpZih0KXt2YXIgaSxyLG47aWYodm9pZCAwPT09dC54KXtpZihhcmd1bWVudHMubGVuZ3RoPDMpcmV0dXJuO2k9YXJndW1lbnRzWzBdLHI9YXJndW1lbnRzWzFdLG49YXJndW1lbnRzWzJdfWVsc2UgaT10Lngscj10Lnksbj10Lno7aWYodGhpcy5wYXJlbnQpe3ZhciBvPXRoaXMucGFyZW50LmdldFdvcmxkTWF0cml4KCkuY2xvbmUoKTtvLmludmVydCgpO3ZhciBzPW5ldyBlLlZlY3RvcjMoaSxyLG4pO3RoaXMucG9zaXRpb249ZS5WZWN0b3IzLlRyYW5zZm9ybUNvb3JkaW5hdGVzKHMsbyl9ZWxzZSB0aGlzLnBvc2l0aW9uLng9aSx0aGlzLnBvc2l0aW9uLnk9cix0aGlzLnBvc2l0aW9uLno9bn19LGkucHJvdG90eXBlLm1vdmVQT1Y9ZnVuY3Rpb24oZSx0LGkpe3RoaXMucG9zaXRpb24uYWRkSW5QbGFjZSh0aGlzLmNhbGNNb3ZlUE9WKGUsdCxpKSl9LGkucHJvdG90eXBlLmNhbGNNb3ZlUE9WPWZ1bmN0aW9uKHQsaSxyKXt2YXIgbj1uZXcgZS5NYXRyaXgsbz10aGlzLnJvdGF0aW9uUXVhdGVybmlvbj90aGlzLnJvdGF0aW9uUXVhdGVybmlvbjplLlF1YXRlcm5pb24uUm90YXRpb25ZYXdQaXRjaFJvbGwodGhpcy5yb3RhdGlvbi55LHRoaXMucm90YXRpb24ueCx0aGlzLnJvdGF0aW9uLnopO28udG9Sb3RhdGlvbk1hdHJpeChuKTt2YXIgcz1lLlZlY3RvcjMuWmVybygpLGE9dGhpcy5kZWZpbmVkRmFjaW5nRm9yd2FyZD8tMToxO3JldHVybiBlLlZlY3RvcjMuVHJhbnNmb3JtQ29vcmRpbmF0ZXNGcm9tRmxvYXRzVG9SZWYodCphLGksciphLG4scyksc30saS5wcm90b3R5cGUucm90YXRlUE9WPWZ1bmN0aW9uKGUsdCxpKXt0aGlzLnJvdGF0aW9uLmFkZEluUGxhY2UodGhpcy5jYWxjUm90YXRlUE9WKGUsdCxpKSl9LGkucHJvdG90eXBlLmNhbGNSb3RhdGVQT1Y9ZnVuY3Rpb24odCxpLHIpe3ZhciBuPXRoaXMuZGVmaW5lZEZhY2luZ0ZvcndhcmQ/MTotMTtyZXR1cm4gbmV3IGUuVmVjdG9yMyh0Km4saSxyKm4pfSxpLnByb3RvdHlwZS5zZXRQaXZvdE1hdHJpeD1mdW5jdGlvbihlKXt0aGlzLl9waXZvdE1hdHJpeD1lLHRoaXMuX2NhY2hlLnBpdm90TWF0cml4VXBkYXRlZD0hMH0saS5wcm90b3R5cGUuZ2V0UGl2b3RNYXRyaXg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcGl2b3RNYXRyaXh9LGkucHJvdG90eXBlLl9pc1N5bmNocm9uaXplZD1mdW5jdGlvbigpe2lmKHRoaXMuX2lzRGlydHkpcmV0dXJuITE7aWYodGhpcy5iaWxsYm9hcmRNb2RlIT09dGhpcy5fY2FjaGUuYmlsbGJvYXJkTW9kZXx8dGhpcy5iaWxsYm9hcmRNb2RlIT09aS5CSUxMQk9BUkRNT0RFX05PTkUpcmV0dXJuITE7aWYodGhpcy5fY2FjaGUucGl2b3RNYXRyaXhVcGRhdGVkKXJldHVybiExO2lmKHRoaXMuaW5maW5pdGVEaXN0YW5jZSlyZXR1cm4hMTtpZighdGhpcy5fY2FjaGUucG9zaXRpb24uZXF1YWxzKHRoaXMucG9zaXRpb24pKXJldHVybiExO2lmKHRoaXMucm90YXRpb25RdWF0ZXJuaW9uKXtpZighdGhpcy5fY2FjaGUucm90YXRpb25RdWF0ZXJuaW9uLmVxdWFscyh0aGlzLnJvdGF0aW9uUXVhdGVybmlvbikpcmV0dXJuITF9ZWxzZSBpZighdGhpcy5fY2FjaGUucm90YXRpb24uZXF1YWxzKHRoaXMucm90YXRpb24pKXJldHVybiExO3JldHVybiEhdGhpcy5fY2FjaGUuc2NhbGluZy5lcXVhbHModGhpcy5zY2FsaW5nKX0saS5wcm90b3R5cGUuX2luaXRDYWNoZT1mdW5jdGlvbigpe3QucHJvdG90eXBlLl9pbml0Q2FjaGUuY2FsbCh0aGlzKSx0aGlzLl9jYWNoZS5sb2NhbE1hdHJpeFVwZGF0ZWQ9ITEsdGhpcy5fY2FjaGUucG9zaXRpb249ZS5WZWN0b3IzLlplcm8oKSx0aGlzLl9jYWNoZS5zY2FsaW5nPWUuVmVjdG9yMy5aZXJvKCksdGhpcy5fY2FjaGUucm90YXRpb249ZS5WZWN0b3IzLlplcm8oKSx0aGlzLl9jYWNoZS5yb3RhdGlvblF1YXRlcm5pb249bmV3IGUuUXVhdGVybmlvbigwLDAsMCwwKSx0aGlzLl9jYWNoZS5iaWxsYm9hcmRNb2RlPS0xfSxpLnByb3RvdHlwZS5tYXJrQXNEaXJ0eT1mdW5jdGlvbihlKXtcInJvdGF0aW9uXCI9PT1lJiYodGhpcy5yb3RhdGlvblF1YXRlcm5pb249bnVsbCksdGhpcy5fY3VycmVudFJlbmRlcklkPU51bWJlci5NQVhfVkFMVUUsdGhpcy5faXNEaXJ0eT0hMH0saS5wcm90b3R5cGUuX3VwZGF0ZUJvdW5kaW5nSW5mbz1mdW5jdGlvbigpe3RoaXMuX2JvdW5kaW5nSW5mbz10aGlzLl9ib3VuZGluZ0luZm98fG5ldyBlLkJvdW5kaW5nSW5mbyh0aGlzLmFic29sdXRlUG9zaXRpb24sdGhpcy5hYnNvbHV0ZVBvc2l0aW9uKSx0aGlzLl9ib3VuZGluZ0luZm8udXBkYXRlKHRoaXMud29ybGRNYXRyaXhGcm9tQ2FjaGUpLHRoaXMuX3VwZGF0ZVN1Yk1lc2hlc0JvdW5kaW5nSW5mbyh0aGlzLndvcmxkTWF0cml4RnJvbUNhY2hlKX0saS5wcm90b3R5cGUuX3VwZGF0ZVN1Yk1lc2hlc0JvdW5kaW5nSW5mbz1mdW5jdGlvbihlKXtpZih0aGlzLnN1Yk1lc2hlcylmb3IodmFyIHQ9MDt0PHRoaXMuc3ViTWVzaGVzLmxlbmd0aDt0Kyspe3ZhciBpPXRoaXMuc3ViTWVzaGVzW3RdO2kuSXNHbG9iYWx8fGkudXBkYXRlQm91bmRpbmdJbmZvKGUpfX0saS5wcm90b3R5cGUuY29tcHV0ZVdvcmxkTWF0cml4PWZ1bmN0aW9uKHQpe2lmKHRoaXMuX2lzV29ybGRNYXRyaXhGcm96ZW4pcmV0dXJuIHRoaXMuX3dvcmxkTWF0cml4O2lmKCF0JiYodGhpcy5fY3VycmVudFJlbmRlcklkPT09dGhpcy5nZXRTY2VuZSgpLmdldFJlbmRlcklkKCl8fHRoaXMuaXNTeW5jaHJvbml6ZWQoITApKSlyZXR1cm4gdGhpcy5fY3VycmVudFJlbmRlcklkPXRoaXMuZ2V0U2NlbmUoKS5nZXRSZW5kZXJJZCgpLHRoaXMuX3dvcmxkTWF0cml4O2lmKHRoaXMuX2NhY2hlLnBvc2l0aW9uLmNvcHlGcm9tKHRoaXMucG9zaXRpb24pLHRoaXMuX2NhY2hlLnNjYWxpbmcuY29weUZyb20odGhpcy5zY2FsaW5nKSx0aGlzLl9jYWNoZS5waXZvdE1hdHJpeFVwZGF0ZWQ9ITEsdGhpcy5fY2FjaGUuYmlsbGJvYXJkTW9kZT10aGlzLmJpbGxib2FyZE1vZGUsdGhpcy5fY3VycmVudFJlbmRlcklkPXRoaXMuZ2V0U2NlbmUoKS5nZXRSZW5kZXJJZCgpLHRoaXMuX2lzRGlydHk9ITEsZS5NYXRyaXguU2NhbGluZ1RvUmVmKHRoaXMuc2NhbGluZy54KnRoaXMuc2NhbGluZ0RldGVybWluYW50LHRoaXMuc2NhbGluZy55KnRoaXMuc2NhbGluZ0RldGVybWluYW50LHRoaXMuc2NhbGluZy56KnRoaXMuc2NhbGluZ0RldGVybWluYW50LGUuVG1wLk1hdHJpeFsxXSksdGhpcy5yb3RhdGlvblF1YXRlcm5pb24pe3ZhciByPXRoaXMucm90YXRpb24ubGVuZ3RoKCk7ciYmKHRoaXMucm90YXRpb25RdWF0ZXJuaW9uLm11bHRpcGx5SW5QbGFjZShlLlF1YXRlcm5pb24uUm90YXRpb25ZYXdQaXRjaFJvbGwodGhpcy5yb3RhdGlvbi55LHRoaXMucm90YXRpb24ueCx0aGlzLnJvdGF0aW9uLnopKSx0aGlzLnJvdGF0aW9uLmNvcHlGcm9tRmxvYXRzKDAsMCwwKSl9aWYodGhpcy5yb3RhdGlvblF1YXRlcm5pb24/KHRoaXMucm90YXRpb25RdWF0ZXJuaW9uLnRvUm90YXRpb25NYXRyaXgoZS5UbXAuTWF0cml4WzBdKSx0aGlzLl9jYWNoZS5yb3RhdGlvblF1YXRlcm5pb24uY29weUZyb20odGhpcy5yb3RhdGlvblF1YXRlcm5pb24pKTooZS5NYXRyaXguUm90YXRpb25ZYXdQaXRjaFJvbGxUb1JlZih0aGlzLnJvdGF0aW9uLnksdGhpcy5yb3RhdGlvbi54LHRoaXMucm90YXRpb24ueixlLlRtcC5NYXRyaXhbMF0pLHRoaXMuX2NhY2hlLnJvdGF0aW9uLmNvcHlGcm9tKHRoaXMucm90YXRpb24pKSx0aGlzLmluZmluaXRlRGlzdGFuY2UmJiF0aGlzLnBhcmVudCl7dmFyIG49dGhpcy5nZXRTY2VuZSgpLmFjdGl2ZUNhbWVyYTtpZihuKXt2YXIgbz1uLmdldFdvcmxkTWF0cml4KCkscz1uZXcgZS5WZWN0b3IzKG8ubVsxMl0sby5tWzEzXSxvLm1bMTRdKTtlLk1hdHJpeC5UcmFuc2xhdGlvblRvUmVmKHRoaXMucG9zaXRpb24ueCtzLngsdGhpcy5wb3NpdGlvbi55K3MueSx0aGlzLnBvc2l0aW9uLnorcy56LGUuVG1wLk1hdHJpeFsyXSl9fWVsc2UgZS5NYXRyaXguVHJhbnNsYXRpb25Ub1JlZih0aGlzLnBvc2l0aW9uLngsdGhpcy5wb3NpdGlvbi55LHRoaXMucG9zaXRpb24ueixlLlRtcC5NYXRyaXhbMl0pO2lmKHRoaXMuX3Bpdm90TWF0cml4Lm11bHRpcGx5VG9SZWYoZS5UbXAuTWF0cml4WzFdLGUuVG1wLk1hdHJpeFs0XSksZS5UbXAuTWF0cml4WzRdLm11bHRpcGx5VG9SZWYoZS5UbXAuTWF0cml4WzBdLGUuVG1wLk1hdHJpeFs1XSksdGhpcy5iaWxsYm9hcmRNb2RlIT09aS5CSUxMQk9BUkRNT0RFX05PTkUmJnRoaXMuZ2V0U2NlbmUoKS5hY3RpdmVDYW1lcmEpe2UuVG1wLlZlY3RvcjNbMF0uY29weUZyb20odGhpcy5wb3NpdGlvbik7dmFyIGE9ZS5UbXAuVmVjdG9yM1swXTtpZih0aGlzLnBhcmVudCYmdGhpcy5wYXJlbnQuZ2V0V29ybGRNYXRyaXgpe3RoaXMuX21hcmtTeW5jZWRXaXRoUGFyZW50KCk7dmFyIGg7dGhpcy5fbWVzaFRvQm9uZVJlZmVyYWw/KHRoaXMucGFyZW50LmdldFdvcmxkTWF0cml4KCkubXVsdGlwbHlUb1JlZih0aGlzLl9tZXNoVG9Cb25lUmVmZXJhbC5nZXRXb3JsZE1hdHJpeCgpLGUuVG1wLk1hdHJpeFs2XSksaD1lLlRtcC5NYXRyaXhbNl0pOmg9dGhpcy5wYXJlbnQuZ2V0V29ybGRNYXRyaXgoKSxlLlZlY3RvcjMuVHJhbnNmb3JtTm9ybWFsVG9SZWYoYSxoLGUuVG1wLlZlY3RvcjNbMV0pLGE9ZS5UbXAuVmVjdG9yM1sxXX12YXIgYz10aGlzLmdldFNjZW5lKCkuYWN0aXZlQ2FtZXJhLmdsb2JhbFBvc2l0aW9uLmNsb25lKCk7dGhpcy5wYXJlbnQmJnRoaXMucGFyZW50LnBvc2l0aW9uJiYoYS5hZGRJblBsYWNlKHRoaXMucGFyZW50LnBvc2l0aW9uKSxlLk1hdHJpeC5UcmFuc2xhdGlvblRvUmVmKGEueCxhLnksYS56LGUuVG1wLk1hdHJpeFsyXSkpLCh0aGlzLmJpbGxib2FyZE1vZGUmaS5CSUxMQk9BUkRNT0RFX0FMTCkhPT1pLkJJTExCT0FSRE1PREVfQUxMJiYodGhpcy5iaWxsYm9hcmRNb2RlJmkuQklMTEJPQVJETU9ERV9YJiYoYy54PWEueCtlLkVwc2lsb24pLHRoaXMuYmlsbGJvYXJkTW9kZSZpLkJJTExCT0FSRE1PREVfWSYmKGMueT1hLnkrZS5FcHNpbG9uKSx0aGlzLmJpbGxib2FyZE1vZGUmaS5CSUxMQk9BUkRNT0RFX1omJihjLno9YS56K2UuRXBzaWxvbikpLGUuTWF0cml4Lkxvb2tBdExIVG9SZWYoYSxjLGUuVmVjdG9yMy5VcCgpLGUuVG1wLk1hdHJpeFszXSksZS5UbXAuTWF0cml4WzNdLm1bMTJdPWUuVG1wLk1hdHJpeFszXS5tWzEzXT1lLlRtcC5NYXRyaXhbM10ubVsxNF09MCxlLlRtcC5NYXRyaXhbM10uaW52ZXJ0KCksZS5UbXAuTWF0cml4WzVdLm11bHRpcGx5VG9SZWYoZS5UbXAuTWF0cml4WzNdLHRoaXMuX2xvY2FsV29ybGQpLHRoaXMuX3JvdGF0ZVlCeVBJLm11bHRpcGx5VG9SZWYodGhpcy5fbG9jYWxXb3JsZCxlLlRtcC5NYXRyaXhbNV0pfXJldHVybiBlLlRtcC5NYXRyaXhbNV0ubXVsdGlwbHlUb1JlZihlLlRtcC5NYXRyaXhbMl0sdGhpcy5fbG9jYWxXb3JsZCksdGhpcy5wYXJlbnQmJnRoaXMucGFyZW50LmdldFdvcmxkTWF0cml4JiZ0aGlzLmJpbGxib2FyZE1vZGU9PT1pLkJJTExCT0FSRE1PREVfTk9ORT8odGhpcy5fbWFya1N5bmNlZFdpdGhQYXJlbnQoKSx0aGlzLl9tZXNoVG9Cb25lUmVmZXJhbD8odGhpcy5fbG9jYWxXb3JsZC5tdWx0aXBseVRvUmVmKHRoaXMucGFyZW50LmdldFdvcmxkTWF0cml4KCksZS5UbXAuTWF0cml4WzZdKSxlLlRtcC5NYXRyaXhbNl0ubXVsdGlwbHlUb1JlZih0aGlzLl9tZXNoVG9Cb25lUmVmZXJhbC5nZXRXb3JsZE1hdHJpeCgpLHRoaXMuX3dvcmxkTWF0cml4KSk6dGhpcy5fbG9jYWxXb3JsZC5tdWx0aXBseVRvUmVmKHRoaXMucGFyZW50LmdldFdvcmxkTWF0cml4KCksdGhpcy5fd29ybGRNYXRyaXgpKTp0aGlzLl93b3JsZE1hdHJpeC5jb3B5RnJvbSh0aGlzLl9sb2NhbFdvcmxkKSx0aGlzLl91cGRhdGVCb3VuZGluZ0luZm8oKSx0aGlzLl9hYnNvbHV0ZVBvc2l0aW9uLmNvcHlGcm9tRmxvYXRzKHRoaXMuX3dvcmxkTWF0cml4Lm1bMTJdLHRoaXMuX3dvcmxkTWF0cml4Lm1bMTNdLHRoaXMuX3dvcmxkTWF0cml4Lm1bMTRdKSx0aGlzLm9uQWZ0ZXJXb3JsZE1hdHJpeFVwZGF0ZU9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpLHRoaXMuX3Bvc2VNYXRyaXh8fCh0aGlzLl9wb3NlTWF0cml4PWUuTWF0cml4LkludmVydCh0aGlzLl93b3JsZE1hdHJpeCkpLHRoaXMuX3dvcmxkTWF0cml4fSxpLnByb3RvdHlwZS5yZWdpc3RlckFmdGVyV29ybGRNYXRyaXhVcGRhdGU9ZnVuY3Rpb24oZSl7dGhpcy5vbkFmdGVyV29ybGRNYXRyaXhVcGRhdGVPYnNlcnZhYmxlLmFkZChlKX0saS5wcm90b3R5cGUudW5yZWdpc3RlckFmdGVyV29ybGRNYXRyaXhVcGRhdGU9ZnVuY3Rpb24oZSl7dGhpcy5vbkFmdGVyV29ybGRNYXRyaXhVcGRhdGVPYnNlcnZhYmxlLnJlbW92ZUNhbGxiYWNrKGUpfSxpLnByb3RvdHlwZS5zZXRQb3NpdGlvbldpdGhMb2NhbFZlY3Rvcj1mdW5jdGlvbih0KXt0aGlzLmNvbXB1dGVXb3JsZE1hdHJpeCgpLHRoaXMucG9zaXRpb249ZS5WZWN0b3IzLlRyYW5zZm9ybU5vcm1hbCh0LHRoaXMuX2xvY2FsV29ybGQpfSxpLnByb3RvdHlwZS5nZXRQb3NpdGlvbkV4cHJlc3NlZEluTG9jYWxTcGFjZT1mdW5jdGlvbigpe3RoaXMuY29tcHV0ZVdvcmxkTWF0cml4KCk7dmFyIHQ9dGhpcy5fbG9jYWxXb3JsZC5jbG9uZSgpO3JldHVybiB0LmludmVydCgpLGUuVmVjdG9yMy5UcmFuc2Zvcm1Ob3JtYWwodGhpcy5wb3NpdGlvbix0KX0saS5wcm90b3R5cGUubG9jYWxseVRyYW5zbGF0ZT1mdW5jdGlvbih0KXt0aGlzLmNvbXB1dGVXb3JsZE1hdHJpeCghMCksdGhpcy5wb3NpdGlvbj1lLlZlY3RvcjMuVHJhbnNmb3JtQ29vcmRpbmF0ZXModCx0aGlzLl9sb2NhbFdvcmxkKX0saS5wcm90b3R5cGUubG9va0F0PWZ1bmN0aW9uKHQsaSxyLG4pe2k9aXx8MCxyPXJ8fDAsbj1ufHwwO3ZhciBvPXQuc3VidHJhY3QodGhpcy5wb3NpdGlvbikscz0tTWF0aC5hdGFuMihvLnosby54KS1NYXRoLlBJLzIsYT1NYXRoLnNxcnQoby54Km8ueCtvLnoqby56KSxoPU1hdGguYXRhbjIoby55LGEpO3RoaXMucm90YXRpb25RdWF0ZXJuaW9uPWUuUXVhdGVybmlvbi5Sb3RhdGlvbllhd1BpdGNoUm9sbChzK2ksaCtyLG4pfSxpLnByb3RvdHlwZS5hdHRhY2hUb0JvbmU9ZnVuY3Rpb24oZSx0KXt0aGlzLl9tZXNoVG9Cb25lUmVmZXJhbD10LHRoaXMucGFyZW50PWUsZS5nZXRXb3JsZE1hdHJpeCgpLmRldGVybWluYW50KCk8MCYmKHRoaXMuc2NhbGluZ0RldGVybWluYW50Kj0tMSl9LGkucHJvdG90eXBlLmRldGFjaEZyb21Cb25lPWZ1bmN0aW9uKCl7dGhpcy5wYXJlbnQuZ2V0V29ybGRNYXRyaXgoKS5kZXRlcm1pbmFudCgpPDAmJih0aGlzLnNjYWxpbmdEZXRlcm1pbmFudCo9LTEpLHRoaXMuX21lc2hUb0JvbmVSZWZlcmFsPW51bGwsdGhpcy5wYXJlbnQ9bnVsbH0saS5wcm90b3R5cGUuaXNJbkZydXN0dW09ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2JvdW5kaW5nSW5mby5pc0luRnJ1c3R1bShlKX0saS5wcm90b3R5cGUuaXNDb21wbGV0ZWx5SW5GcnVzdHVtPWZ1bmN0aW9uKHQpe3R8fCh0PXRoaXMuZ2V0U2NlbmUoKS5hY3RpdmVDYW1lcmEpO3ZhciBpPXQuZ2V0Vmlld01hdHJpeCgpLm11bHRpcGx5KHQuZ2V0UHJvamVjdGlvbk1hdHJpeCgpKTtyZXR1cm4hIXRoaXMuX2JvdW5kaW5nSW5mby5pc0NvbXBsZXRlbHlJbkZydXN0dW0oZS5GcnVzdHVtLkdldFBsYW5lcyhpKSl9LGkucHJvdG90eXBlLmludGVyc2VjdHNNZXNoPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuX2JvdW5kaW5nSW5mbyYmZS5fYm91bmRpbmdJbmZvP3RoaXMuX2JvdW5kaW5nSW5mby5pbnRlcnNlY3RzKGUuX2JvdW5kaW5nSW5mbyx0KTohMX0saS5wcm90b3R5cGUuaW50ZXJzZWN0c1BvaW50PWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9ib3VuZGluZ0luZm8/dGhpcy5fYm91bmRpbmdJbmZvLmludGVyc2VjdHNQb2ludChlKTohMX0saS5wcm90b3R5cGUuc2V0UGh5c2ljc1N0YXRlPWZ1bmN0aW9uKHQsaSl7cmV0dXJuIHQuaW1wb3N0b3ImJihpPXQsdD10LmltcG9zdG9yKSx0aGlzLnBoeXNpY3NJbXBvc3Rvcj1uZXcgZS5QaHlzaWNzSW1wb3N0b3IodGhpcyx0LGksdGhpcy5nZXRTY2VuZSgpKSx0aGlzLnBoeXNpY3NJbXBvc3Rvci5waHlzaWNzQm9keX0saS5wcm90b3R5cGUuZ2V0UGh5c2ljc0ltcG9zdG9yPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucGh5c2ljc0ltcG9zdG9yfSxpLnByb3RvdHlwZS5nZXRQaHlzaWNzTWFzcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLnBoeXNpY3NJbXBvc3Rvci5nZXRQYXJhbShcIm1hc3NcIil9LGkucHJvdG90eXBlLmdldFBoeXNpY3NGcmljdGlvbj1mdW5jdGlvbigpe3JldHVybiB0aGlzLnBoeXNpY3NJbXBvc3Rvci5nZXRQYXJhbShcImZyaWN0aW9uXCIpfSxpLnByb3RvdHlwZS5nZXRQaHlzaWNzUmVzdGl0dXRpb249ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5waHlzaWNzSW1wb3N0b3IuZ2V0UGFyYW0oXCJyZXNpdHV0aW9uXCIpfSxpLnByb3RvdHlwZS5nZXRQb3NpdGlvbkluQ2FtZXJhU3BhY2U9ZnVuY3Rpb24odCl7cmV0dXJuIHR8fCh0PXRoaXMuZ2V0U2NlbmUoKS5hY3RpdmVDYW1lcmEpLGUuVmVjdG9yMy5UcmFuc2Zvcm1Db29yZGluYXRlcyh0aGlzLmFic29sdXRlUG9zaXRpb24sdC5nZXRWaWV3TWF0cml4KCkpfSxpLnByb3RvdHlwZS5nZXREaXN0YW5jZVRvQ2FtZXJhPWZ1bmN0aW9uKGUpe3JldHVybiBlfHwoZT10aGlzLmdldFNjZW5lKCkuYWN0aXZlQ2FtZXJhKSx0aGlzLmFic29sdXRlUG9zaXRpb24uc3VidHJhY3QoZS5wb3NpdGlvbikubGVuZ3RoKCl9LGkucHJvdG90eXBlLmFwcGx5SW1wdWxzZT1mdW5jdGlvbihlLHQpe3RoaXMucGh5c2ljc0ltcG9zdG9yJiZ0aGlzLnBoeXNpY3NJbXBvc3Rvci5hcHBseUltcHVsc2UoZSx0KX0saS5wcm90b3R5cGUuc2V0UGh5c2ljc0xpbmtXaXRoPWZ1bmN0aW9uKHQsaSxyLG4pe3RoaXMucGh5c2ljc0ltcG9zdG9yJiZ0LnBoeXNpY3NJbXBvc3RvciYmdGhpcy5waHlzaWNzSW1wb3N0b3IuY3JlYXRlSm9pbnQodC5waHlzaWNzSW1wb3N0b3IsZS5QaHlzaWNzSm9pbnQuSGluZ2VKb2ludCx7bWFpblBpdm90OmksY29ubmVjdGVkUGl2b3Q6cixuYXRpdmVQYXJhbXM6bn0pfSxpLnByb3RvdHlwZS51cGRhdGVQaHlzaWNzQm9keVBvc2l0aW9uPWZ1bmN0aW9uKCl7ZS5Ub29scy5XYXJuKFwidXBkYXRlUGh5c2ljc0JvZHlQb3NpdGlvbigpIGlzIGRlcHJlY2F0ZWQsIHBsZWFzZSB1c2UgdXBkYXRlUGh5c2ljc0JvZHkoKVwiKSx0aGlzLnVwZGF0ZVBoeXNpY3NCb2R5KCl9LGkucHJvdG90eXBlLnVwZGF0ZVBoeXNpY3NCb2R5PWZ1bmN0aW9uKCl7fSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJjaGVja0NvbGxpc2lvbnNcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2NoZWNrQ29sbGlzaW9uc30sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX2NoZWNrQ29sbGlzaW9ucz1lLHRoaXMuZ2V0U2NlbmUoKS53b3JrZXJDb2xsaXNpb25zJiZ0aGlzLmdldFNjZW5lKCkuY29sbGlzaW9uQ29vcmRpbmF0b3Iub25NZXNoVXBkYXRlZCh0aGlzKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxpLnByb3RvdHlwZS5tb3ZlV2l0aENvbGxpc2lvbnM9ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5nZXRBYnNvbHV0ZVBvc2l0aW9uKCk7dC5zdWJ0cmFjdEZyb21GbG9hdHNUb1JlZigwLHRoaXMuZWxsaXBzb2lkLnksMCx0aGlzLl9vbGRQb3NpdGlvbkZvckNvbGxpc2lvbnMpLHRoaXMuX29sZFBvc2l0aW9uRm9yQ29sbGlzaW9ucy5hZGRJblBsYWNlKHRoaXMuZWxsaXBzb2lkT2Zmc2V0KSx0aGlzLl9jb2xsaWRlci5yYWRpdXM9dGhpcy5lbGxpcHNvaWQsdGhpcy5nZXRTY2VuZSgpLmNvbGxpc2lvbkNvb3JkaW5hdG9yLmdldE5ld1Bvc2l0aW9uKHRoaXMuX29sZFBvc2l0aW9uRm9yQ29sbGlzaW9ucyxlLHRoaXMuX2NvbGxpZGVyLDMsdGhpcyx0aGlzLl9vbkNvbGxpc2lvblBvc2l0aW9uQ2hhbmdlLHRoaXMudW5pcXVlSWQpfSxpLnByb3RvdHlwZS5jcmVhdGVPclVwZGF0ZVN1Ym1lc2hlc09jdHJlZT1mdW5jdGlvbih0LGkpe3ZvaWQgMD09PXQmJih0PTY0KSx2b2lkIDA9PT1pJiYoaT0yKSx0aGlzLl9zdWJtZXNoZXNPY3RyZWV8fCh0aGlzLl9zdWJtZXNoZXNPY3RyZWU9bmV3IGUuT2N0cmVlKGUuT2N0cmVlLkNyZWF0aW9uRnVuY0ZvclN1Yk1lc2hlcyx0LGkpKSx0aGlzLmNvbXB1dGVXb3JsZE1hdHJpeCghMCk7dmFyIHI9dGhpcy5nZXRCb3VuZGluZ0luZm8oKS5ib3VuZGluZ0JveDtyZXR1cm4gdGhpcy5fc3VibWVzaGVzT2N0cmVlLnVwZGF0ZShyLm1pbmltdW1Xb3JsZCxyLm1heGltdW1Xb3JsZCx0aGlzLnN1Yk1lc2hlcyksdGhpcy5fc3VibWVzaGVzT2N0cmVlfSxpLnByb3RvdHlwZS5fY29sbGlkZUZvclN1Yk1lc2g9ZnVuY3Rpb24odCxpLHIpe2lmKHRoaXMuX2dlbmVyYXRlUG9pbnRzQXJyYXkoKSwhdC5fbGFzdENvbGxpZGVyV29ybGRWZXJ0aWNlc3x8IXQuX2xhc3RDb2xsaWRlclRyYW5zZm9ybU1hdHJpeC5lcXVhbHMoaSkpe3QuX2xhc3RDb2xsaWRlclRyYW5zZm9ybU1hdHJpeD1pLmNsb25lKCksdC5fbGFzdENvbGxpZGVyV29ybGRWZXJ0aWNlcz1bXSx0Ll90cmlhbmdsZVBsYW5lcz1bXTtmb3IodmFyIG49dC52ZXJ0aWNlc1N0YXJ0LG89dC52ZXJ0aWNlc1N0YXJ0K3QudmVydGljZXNDb3VudCxzPW47bz5zO3MrKyl0Ll9sYXN0Q29sbGlkZXJXb3JsZFZlcnRpY2VzLnB1c2goZS5WZWN0b3IzLlRyYW5zZm9ybUNvb3JkaW5hdGVzKHRoaXMuX3Bvc2l0aW9uc1tzXSxpKSl9ci5fY29sbGlkZSh0Ll90cmlhbmdsZVBsYW5lcyx0Ll9sYXN0Q29sbGlkZXJXb3JsZFZlcnRpY2VzLHRoaXMuZ2V0SW5kaWNlcygpLHQuaW5kZXhTdGFydCx0LmluZGV4U3RhcnQrdC5pbmRleENvdW50LHQudmVydGljZXNTdGFydCwhIXQuZ2V0TWF0ZXJpYWwoKSksci5jb2xsaXNpb25Gb3VuZCYmKHIuY29sbGlkZWRNZXNoPXRoaXMpfSxpLnByb3RvdHlwZS5fcHJvY2Vzc0NvbGxpc2lvbnNGb3JTdWJNZXNoZXM9ZnVuY3Rpb24oZSx0KXt2YXIgaSxyO2lmKHRoaXMuX3N1Ym1lc2hlc09jdHJlZSYmdGhpcy51c2VPY3RyZWVGb3JDb2xsaXNpb25zKXt2YXIgbj1lLnZlbG9jaXR5V29ybGRMZW5ndGgrTWF0aC5tYXgoZS5yYWRpdXMueCxlLnJhZGl1cy55LGUucmFkaXVzLnopLG89dGhpcy5fc3VibWVzaGVzT2N0cmVlLmludGVyc2VjdHMoZS5iYXNlUG9pbnRXb3JsZCxuKTtyPW8ubGVuZ3RoLGk9by5kYXRhfWVsc2UgaT10aGlzLnN1Yk1lc2hlcyxyPWkubGVuZ3RoO2Zvcih2YXIgcz0wO3I+cztzKyspe3ZhciBhPWlbc107cj4xJiYhYS5fY2hlY2tDb2xsaXNpb24oZSl8fHRoaXMuX2NvbGxpZGVGb3JTdWJNZXNoKGEsdCxlKX19LGkucHJvdG90eXBlLl9jaGVja0NvbGxpc2lvbj1mdW5jdGlvbih0KXt0aGlzLl9ib3VuZGluZ0luZm8uX2NoZWNrQ29sbGlzaW9uKHQpJiYoZS5NYXRyaXguU2NhbGluZ1RvUmVmKDEvdC5yYWRpdXMueCwxL3QucmFkaXVzLnksMS90LnJhZGl1cy56LHRoaXMuX2NvbGxpc2lvbnNTY2FsaW5nTWF0cml4KSx0aGlzLndvcmxkTWF0cml4RnJvbUNhY2hlLm11bHRpcGx5VG9SZWYodGhpcy5fY29sbGlzaW9uc1NjYWxpbmdNYXRyaXgsdGhpcy5fY29sbGlzaW9uc1RyYW5zZm9ybU1hdHJpeCksdGhpcy5fcHJvY2Vzc0NvbGxpc2lvbnNGb3JTdWJNZXNoZXModCx0aGlzLl9jb2xsaXNpb25zVHJhbnNmb3JtTWF0cml4KSl9LGkucHJvdG90eXBlLl9nZW5lcmF0ZVBvaW50c0FycmF5PWZ1bmN0aW9uKCl7cmV0dXJuITF9LGkucHJvdG90eXBlLmludGVyc2VjdHM9ZnVuY3Rpb24odCxpKXt2YXIgcj1uZXcgZS5QaWNraW5nSW5mbztpZighKHRoaXMuc3ViTWVzaGVzJiZ0aGlzLl9ib3VuZGluZ0luZm8mJnQuaW50ZXJzZWN0c1NwaGVyZSh0aGlzLl9ib3VuZGluZ0luZm8uYm91bmRpbmdTcGhlcmUpJiZ0LmludGVyc2VjdHNCb3godGhpcy5fYm91bmRpbmdJbmZvLmJvdW5kaW5nQm94KSkpcmV0dXJuIHI7aWYoIXRoaXMuX2dlbmVyYXRlUG9pbnRzQXJyYXkoKSlyZXR1cm4gcjt2YXIgbixvLHM9bnVsbDtpZih0aGlzLl9zdWJtZXNoZXNPY3RyZWUmJnRoaXMudXNlT2N0cmVlRm9yUGlja2luZyl7dmFyIGE9ZS5SYXkuVHJhbnNmb3JtKHQsdGhpcy5nZXRXb3JsZE1hdHJpeCgpKSxoPXRoaXMuX3N1Ym1lc2hlc09jdHJlZS5pbnRlcnNlY3RzUmF5KGEpO289aC5sZW5ndGgsbj1oLmRhdGF9ZWxzZSBuPXRoaXMuc3ViTWVzaGVzLG89bi5sZW5ndGg7Zm9yKHZhciBjPTA7bz5jO2MrKyl7dmFyIGw9bltjXTtpZighKG8+MSl8fGwuY2FuSW50ZXJzZWN0cyh0KSl7dmFyIHU9bC5pbnRlcnNlY3RzKHQsdGhpcy5fcG9zaXRpb25zLHRoaXMuZ2V0SW5kaWNlcygpLGkpO2lmKHUmJihpfHwhc3x8dS5kaXN0YW5jZTxzLmRpc3RhbmNlKSYmKHM9dSxzLnN1Yk1lc2hJZD1jLGkpKWJyZWFrfX1pZihzKXt2YXIgZj10aGlzLmdldFdvcmxkTWF0cml4KCksZD1lLlZlY3RvcjMuVHJhbnNmb3JtQ29vcmRpbmF0ZXModC5vcmlnaW4sZikscD10LmRpcmVjdGlvbi5jbG9uZSgpO3A9cC5zY2FsZShzLmRpc3RhbmNlKTt2YXIgXz1lLlZlY3RvcjMuVHJhbnNmb3JtTm9ybWFsKHAsZiksbT1kLmFkZChfKTtyZXR1cm4gci5oaXQ9ITAsci5kaXN0YW5jZT1lLlZlY3RvcjMuRGlzdGFuY2UoZCxtKSxyLnBpY2tlZFBvaW50PW0sci5waWNrZWRNZXNoPXRoaXMsci5idT1zLmJ1LHIuYnY9cy5idixyLmZhY2VJZD1zLmZhY2VJZCxyLnN1Yk1lc2hJZD1zLnN1Yk1lc2hJZCxyfXJldHVybiByfSxpLnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbihlLHQsaSl7cmV0dXJuIG51bGx9LGkucHJvdG90eXBlLnJlbGVhc2VTdWJNZXNoZXM9ZnVuY3Rpb24oKXtpZih0aGlzLnN1Yk1lc2hlcylmb3IoO3RoaXMuc3ViTWVzaGVzLmxlbmd0aDspdGhpcy5zdWJNZXNoZXNbMF0uZGlzcG9zZSgpO2Vsc2UgdGhpcy5zdWJNZXNoZXM9bmV3IEFycmF5fSxpLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKGUpe3ZhciBpLHI9dGhpcztmb3IodGhpcy5hY3Rpb25NYW5hZ2VyJiYodGhpcy5hY3Rpb25NYW5hZ2VyLmRpc3Bvc2UoKSx0aGlzLmFjdGlvbk1hbmFnZXI9bnVsbCksdGhpcy5za2VsZXRvbj1udWxsLHRoaXMuZ2V0U2NlbmUoKS5zdG9wQW5pbWF0aW9uKHRoaXMpLHRoaXMucGh5c2ljc0ltcG9zdG9yJiZ0aGlzLnBoeXNpY3NJbXBvc3Rvci5kaXNwb3NlKCksaT0wO2k8dGhpcy5faW50ZXJzZWN0aW9uc0luUHJvZ3Jlc3MubGVuZ3RoO2krKyl7dmFyIG49dGhpcy5faW50ZXJzZWN0aW9uc0luUHJvZ3Jlc3NbaV0sbz1uLl9pbnRlcnNlY3Rpb25zSW5Qcm9ncmVzcy5pbmRleE9mKHRoaXMpO24uX2ludGVyc2VjdGlvbnNJblByb2dyZXNzLnNwbGljZShvLDEpfXRoaXMuX2ludGVyc2VjdGlvbnNJblByb2dyZXNzPVtdO3ZhciBzPXRoaXMuZ2V0U2NlbmUoKS5saWdodHM7aWYocy5mb3JFYWNoKGZ1bmN0aW9uKGUpe3ZhciB0PWUuaW5jbHVkZWRPbmx5TWVzaGVzLmluZGV4T2Yocik7LTEhPT10JiZlLmluY2x1ZGVkT25seU1lc2hlcy5zcGxpY2UodCwxKSx0PWUuZXhjbHVkZWRNZXNoZXMuaW5kZXhPZihyKSwtMSE9PXQmJmUuZXhjbHVkZWRNZXNoZXMuc3BsaWNlKHQsMSl9KSx0aGlzLl9lZGdlc1JlbmRlcmVyJiYodGhpcy5fZWRnZXNSZW5kZXJlci5kaXNwb3NlKCksdGhpcy5fZWRnZXNSZW5kZXJlcj1udWxsKSx0aGlzLnJlbGVhc2VTdWJNZXNoZXMoKSx0aGlzLmdldFNjZW5lKCkucmVtb3ZlTWVzaCh0aGlzKSxlKXt2YXIgYT10aGlzLmdldENoaWxkTWVzaGVzKCEwKTtmb3IoaT0wO2k8YS5sZW5ndGg7aSsrKXt2YXIgaD1hW2ldO2gucGFyZW50PW51bGwsaC5jb21wdXRlV29ybGRNYXRyaXgoITApfX1lbHNle2ZvcihpPTA7aTx0aGlzLmdldFNjZW5lKCkucGFydGljbGVTeXN0ZW1zLmxlbmd0aDtpKyspdGhpcy5nZXRTY2VuZSgpLnBhcnRpY2xlU3lzdGVtc1tpXS5lbWl0dGVyPT09dGhpcyYmKHRoaXMuZ2V0U2NlbmUoKS5wYXJ0aWNsZVN5c3RlbXNbaV0uZGlzcG9zZSgpLGktLSk7dmFyIGM9dGhpcy5nZXREZXNjZW5kYW50cyghMCk7Zm9yKGk9MDtpPGMubGVuZ3RoO2krKyljW2ldLmRpc3Bvc2UoKX10LnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5vbkFmdGVyV29ybGRNYXRyaXhVcGRhdGVPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbkNvbGxpZGVPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbkNvbGxpc2lvblBvc2l0aW9uQ2hhbmdlT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMuX2lzRGlzcG9zZWQ9ITAsdGhpcy5vbkRpc3Bvc2VPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzKSx0aGlzLm9uRGlzcG9zZU9ic2VydmFibGUuY2xlYXIoKX0saS5fQklMTEJPQVJETU9ERV9OT05FPTAsaS5fQklMTEJPQVJETU9ERV9YPTEsaS5fQklMTEJPQVJETU9ERV9ZPTIsaS5fQklMTEJPQVJETU9ERV9aPTQsaS5fQklMTEJPQVJETU9ERV9BTEw9NyxpfShlLk5vZGUpO2UuQWJzdHJhY3RNZXNoPXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGkoaSxyKXt0LmNhbGwodGhpcyxpLHIpLHRoaXMuZGlmZnVzZT1uZXcgZS5Db2xvcjMoMSwxLDEpLHRoaXMuc3BlY3VsYXI9bmV3IGUuQ29sb3IzKDEsMSwxKSx0aGlzLmludGVuc2l0eT0xLHRoaXMucmFuZ2U9TnVtYmVyLk1BWF9WQUxVRSx0aGlzLmluY2x1ZGVPbmx5V2l0aExheWVyTWFzaz0wLHRoaXMuaW5jbHVkZWRPbmx5TWVzaGVzPW5ldyBBcnJheSx0aGlzLmV4Y2x1ZGVkTWVzaGVzPW5ldyBBcnJheSx0aGlzLmV4Y2x1ZGVXaXRoTGF5ZXJNYXNrPTAsdGhpcy5yYWRpdXM9MWUtNSx0aGlzLl9leGNsdWRlZE1lc2hlc0lkcz1uZXcgQXJyYXksdGhpcy5faW5jbHVkZWRPbmx5TWVzaGVzSWRzPW5ldyBBcnJheSxyLmFkZExpZ2h0KHRoaXMpfXJldHVybiBfX2V4dGVuZHMoaSx0KSxpLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbihlKXt2YXIgdD1cIk5hbWU6IFwiK3RoaXMubmFtZTtpZih0Kz1cIiwgdHlwZTogXCIrW1wiUG9pbnRcIixcIkRpcmVjdGlvbmFsXCIsXCJTcG90XCIsXCJIZW1pc3BoZXJpY1wiXVt0aGlzLmdldFR5cGVJRCgpXSx0aGlzLmFuaW1hdGlvbnMpZm9yKHZhciBpPTA7aTx0aGlzLmFuaW1hdGlvbnMubGVuZ3RoO2krKyl0Kz1cIiwgYW5pbWF0aW9uWzBdOiBcIit0aGlzLmFuaW1hdGlvbnNbaV0udG9TdHJpbmcoZSk7cmV0dXJuIHR9LGkucHJvdG90eXBlLmdldFNoYWRvd0dlbmVyYXRvcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9zaGFkb3dHZW5lcmF0b3J9LGkucHJvdG90eXBlLmdldEFic29sdXRlUG9zaXRpb249ZnVuY3Rpb24oKXtyZXR1cm4gZS5WZWN0b3IzLlplcm8oKX0saS5wcm90b3R5cGUudHJhbnNmZXJUb0VmZmVjdD1mdW5jdGlvbihlLHQsaSl7fSxpLnByb3RvdHlwZS5fZ2V0V29ybGRNYXRyaXg9ZnVuY3Rpb24oKXtyZXR1cm4gZS5NYXRyaXguSWRlbnRpdHkoKX0saS5wcm90b3R5cGUuY2FuQWZmZWN0TWVzaD1mdW5jdGlvbihlKXtyZXR1cm4gZT90aGlzLmluY2x1ZGVkT25seU1lc2hlcy5sZW5ndGg+MCYmLTE9PT10aGlzLmluY2x1ZGVkT25seU1lc2hlcy5pbmRleE9mKGUpPyExOnRoaXMuZXhjbHVkZWRNZXNoZXMubGVuZ3RoPjAmJi0xIT09dGhpcy5leGNsdWRlZE1lc2hlcy5pbmRleE9mKGUpPyExOjAhPT10aGlzLmluY2x1ZGVPbmx5V2l0aExheWVyTWFzayYmMD09PSh0aGlzLmluY2x1ZGVPbmx5V2l0aExheWVyTWFzayZlLmxheWVyTWFzayk/ITE6ISgwIT09dGhpcy5leGNsdWRlV2l0aExheWVyTWFzayYmdGhpcy5leGNsdWRlV2l0aExheWVyTWFzayZlLmxheWVyTWFzayk6ITB9LGkucHJvdG90eXBlLmdldFdvcmxkTWF0cml4PWZ1bmN0aW9uKCl7dGhpcy5fY3VycmVudFJlbmRlcklkPXRoaXMuZ2V0U2NlbmUoKS5nZXRSZW5kZXJJZCgpO3ZhciB0PXRoaXMuX2dldFdvcmxkTWF0cml4KCk7cmV0dXJuIHRoaXMucGFyZW50JiZ0aGlzLnBhcmVudC5nZXRXb3JsZE1hdHJpeD8odGhpcy5fcGFyZW50ZWRXb3JsZE1hdHJpeHx8KHRoaXMuX3BhcmVudGVkV29ybGRNYXRyaXg9ZS5NYXRyaXguSWRlbnRpdHkoKSksdC5tdWx0aXBseVRvUmVmKHRoaXMucGFyZW50LmdldFdvcmxkTWF0cml4KCksdGhpcy5fcGFyZW50ZWRXb3JsZE1hdHJpeCksdGhpcy5fbWFya1N5bmNlZFdpdGhQYXJlbnQoKSx0aGlzLl9wYXJlbnRlZFdvcmxkTWF0cml4KTp0fSxpLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7dGhpcy5fc2hhZG93R2VuZXJhdG9yJiYodGhpcy5fc2hhZG93R2VuZXJhdG9yLmRpc3Bvc2UoKSx0aGlzLl9zaGFkb3dHZW5lcmF0b3I9bnVsbCksdGhpcy5nZXRTY2VuZSgpLnN0b3BBbmltYXRpb24odGhpcyksdGhpcy5nZXRTY2VuZSgpLnJlbW92ZUxpZ2h0KHRoaXMpLHQucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKX0saS5wcm90b3R5cGUuZ2V0VHlwZUlEPWZ1bmN0aW9uKCl7cmV0dXJuIDB9LGkucHJvdG90eXBlLmNsb25lPWZ1bmN0aW9uKHQpe3JldHVybiBlLlNlcmlhbGl6YXRpb25IZWxwZXIuQ2xvbmUoaS5HZXRDb25zdHJ1Y3RvckZyb21OYW1lKHRoaXMuZ2V0VHlwZUlEKCksdCx0aGlzLmdldFNjZW5lKCkpLHRoaXMpfSxpLnByb3RvdHlwZS5zZXJpYWxpemU9ZnVuY3Rpb24oKXt2YXIgdD1lLlNlcmlhbGl6YXRpb25IZWxwZXIuU2VyaWFsaXplKHRoaXMpO3JldHVybiB0LnR5cGU9dGhpcy5nZXRUeXBlSUQoKSx0aGlzLnBhcmVudCYmKHQucGFyZW50SWQ9dGhpcy5wYXJlbnQuaWQpLHRoaXMuZXhjbHVkZWRNZXNoZXMubGVuZ3RoPjAmJih0LmV4Y2x1ZGVkTWVzaGVzSWRzPVtdLHRoaXMuZXhjbHVkZWRNZXNoZXMuZm9yRWFjaChmdW5jdGlvbihlKXt0LmV4Y2x1ZGVkTWVzaGVzSWRzLnB1c2goZS5pZCl9KSksdGhpcy5pbmNsdWRlZE9ubHlNZXNoZXMubGVuZ3RoPjAmJih0LmluY2x1ZGVkT25seU1lc2hlc0lkcz1bXSx0aGlzLmluY2x1ZGVkT25seU1lc2hlcy5mb3JFYWNoKGZ1bmN0aW9uKGUpe3QuaW5jbHVkZWRPbmx5TWVzaGVzSWRzLnB1c2goZS5pZCl9KSksZS5BbmltYXRpb24uQXBwZW5kU2VyaWFsaXplZEFuaW1hdGlvbnModGhpcyx0KSx0LnJhbmdlcz10aGlzLnNlcmlhbGl6ZUFuaW1hdGlvblJhbmdlcygpLHR9LGkuR2V0Q29uc3RydWN0b3JGcm9tTmFtZT1mdW5jdGlvbih0LGkscil7c3dpdGNoKHQpe2Nhc2UgMDpyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGUuUG9pbnRMaWdodChpLGUuVmVjdG9yMy5aZXJvKCkscil9O2Nhc2UgMTpyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGUuRGlyZWN0aW9uYWxMaWdodChpLGUuVmVjdG9yMy5aZXJvKCkscil9O2Nhc2UgMjpyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGUuU3BvdExpZ2h0KGksZS5WZWN0b3IzLlplcm8oKSxlLlZlY3RvcjMuWmVybygpLDAsMCxyKX07Y2FzZSAzOnJldHVybiBmdW5jdGlvbigpe3JldHVybiBuZXcgZS5IZW1pc3BoZXJpY0xpZ2h0KGksZS5WZWN0b3IzLlplcm8oKSxyKX19fSxpLlBhcnNlPWZ1bmN0aW9uKHQscil7dmFyIG49ZS5TZXJpYWxpemF0aW9uSGVscGVyLlBhcnNlKGkuR2V0Q29uc3RydWN0b3JGcm9tTmFtZSh0LnR5cGUsdC5uYW1lLHIpLHQscik7aWYodC5leGNsdWRlZE1lc2hlc0lkcyYmKG4uX2V4Y2x1ZGVkTWVzaGVzSWRzPXQuZXhjbHVkZWRNZXNoZXNJZHMpLHQuaW5jbHVkZWRPbmx5TWVzaGVzSWRzJiYobi5faW5jbHVkZWRPbmx5TWVzaGVzSWRzPXQuaW5jbHVkZWRPbmx5TWVzaGVzSWRzKSx0LnBhcmVudElkJiYobi5fd2FpdGluZ1BhcmVudElkPXQucGFyZW50SWQpLHQuYW5pbWF0aW9ucyl7Zm9yKHZhciBvPTA7bzx0LmFuaW1hdGlvbnMubGVuZ3RoO28rKyl7dmFyIHM9dC5hbmltYXRpb25zW29dO24uYW5pbWF0aW9ucy5wdXNoKGUuQW5pbWF0aW9uLlBhcnNlKHMpKX1lLk5vZGUuUGFyc2VBbmltYXRpb25SYW5nZXMobix0LHIpfXJldHVybiB0LmF1dG9BbmltYXRlJiZyLmJlZ2luQW5pbWF0aW9uKG4sdC5hdXRvQW5pbWF0ZUZyb20sdC5hdXRvQW5pbWF0ZVRvLHQuYXV0b0FuaW1hdGVMb29wLHQuYXV0b0FuaW1hdGVTcGVlZHx8MSksbn0sX19kZWNvcmF0ZShbZS5zZXJpYWxpemVBc0NvbG9yMygpXSxpLnByb3RvdHlwZSxcImRpZmZ1c2VcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplQXNDb2xvcjMoKV0saS5wcm90b3R5cGUsXCJzcGVjdWxhclwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0saS5wcm90b3R5cGUsXCJpbnRlbnNpdHlcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLGkucHJvdG90eXBlLFwicmFuZ2VcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLGkucHJvdG90eXBlLFwiaW5jbHVkZU9ubHlXaXRoTGF5ZXJNYXNrXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSxpLnByb3RvdHlwZSxcImV4Y2x1ZGVXaXRoTGF5ZXJNYXNrXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSxpLnByb3RvdHlwZSxcInJhZGl1c1wiLHZvaWQgMCksaX0oZS5Ob2RlKTtlLkxpZ2h0PXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGkoZSxpLHIpe3QuY2FsbCh0aGlzLGUsciksdGhpcy5wb3NpdGlvbj1pfXJldHVybiBfX2V4dGVuZHMoaSx0KSxpLnByb3RvdHlwZS5nZXRBYnNvbHV0ZVBvc2l0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudHJhbnNmb3JtZWRQb3NpdGlvbj90aGlzLnRyYW5zZm9ybWVkUG9zaXRpb246dGhpcy5wb3NpdGlvbn0saS5wcm90b3R5cGUuY29tcHV0ZVRyYW5zZm9ybWVkUG9zaXRpb249ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wYXJlbnQmJnRoaXMucGFyZW50LmdldFdvcmxkTWF0cml4Pyh0aGlzLnRyYW5zZm9ybWVkUG9zaXRpb258fCh0aGlzLnRyYW5zZm9ybWVkUG9zaXRpb249ZS5WZWN0b3IzLlplcm8oKSksZS5WZWN0b3IzLlRyYW5zZm9ybUNvb3JkaW5hdGVzVG9SZWYodGhpcy5wb3NpdGlvbix0aGlzLnBhcmVudC5nZXRXb3JsZE1hdHJpeCgpLHRoaXMudHJhbnNmb3JtZWRQb3NpdGlvbiksITApOiExfSxpLnByb3RvdHlwZS50cmFuc2ZlclRvRWZmZWN0PWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMucGFyZW50JiZ0aGlzLnBhcmVudC5nZXRXb3JsZE1hdHJpeD8odGhpcy5jb21wdXRlVHJhbnNmb3JtZWRQb3NpdGlvbigpLHZvaWQgZS5zZXRGbG9hdDQodCx0aGlzLnRyYW5zZm9ybWVkUG9zaXRpb24ueCx0aGlzLnRyYW5zZm9ybWVkUG9zaXRpb24ueSx0aGlzLnRyYW5zZm9ybWVkUG9zaXRpb24ueiwwKSk6dm9pZCBlLnNldEZsb2F0NCh0LHRoaXMucG9zaXRpb24ueCx0aGlzLnBvc2l0aW9uLnksdGhpcy5wb3NpdGlvbi56LDApfSxpLnByb3RvdHlwZS5uZWVkQ3ViZT1mdW5jdGlvbigpe3JldHVybiEwfSxpLnByb3RvdHlwZS5zdXBwb3J0c1ZTTT1mdW5jdGlvbigpe3JldHVybiExfSxpLnByb3RvdHlwZS5uZWVkUmVmcmVzaFBlckZyYW1lPWZ1bmN0aW9uKCl7cmV0dXJuITF9LGkucHJvdG90eXBlLmdldFNoYWRvd0RpcmVjdGlvbj1mdW5jdGlvbih0KXtzd2l0Y2godCl7Y2FzZSAwOnJldHVybiBuZXcgZS5WZWN0b3IzKDEsMCwwKTtjYXNlIDE6cmV0dXJuIG5ldyBlLlZlY3RvcjMoLTEsMCwwKTtjYXNlIDI6cmV0dXJuIG5ldyBlLlZlY3RvcjMoMCwtMSwwKTtjYXNlIDM6cmV0dXJuIG5ldyBlLlZlY3RvcjMoMCwxLDApO2Nhc2UgNDpyZXR1cm4gbmV3IGUuVmVjdG9yMygwLDAsMSk7Y2FzZSA1OnJldHVybiBuZXcgZS5WZWN0b3IzKDAsMCwtMSl9cmV0dXJuIGUuVmVjdG9yMy5aZXJvKCl9LGkucHJvdG90eXBlLnNldFNoYWRvd1Byb2plY3Rpb25NYXRyaXg9ZnVuY3Rpb24odCxpLHIpe3ZhciBuPXRoaXMuZ2V0U2NlbmUoKS5hY3RpdmVDYW1lcmE7ZS5NYXRyaXguUGVyc3BlY3RpdmVGb3ZMSFRvUmVmKE1hdGguUEkvMiwxLG4ubWluWixuLm1heFosdCl9LGkucHJvdG90eXBlLl9nZXRXb3JsZE1hdHJpeD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl93b3JsZE1hdHJpeHx8KHRoaXMuX3dvcmxkTWF0cml4PWUuTWF0cml4LklkZW50aXR5KCkpLGUuTWF0cml4LlRyYW5zbGF0aW9uVG9SZWYodGhpcy5wb3NpdGlvbi54LHRoaXMucG9zaXRpb24ueSx0aGlzLnBvc2l0aW9uLnosdGhpcy5fd29ybGRNYXRyaXgpLHRoaXMuX3dvcmxkTWF0cml4fSxpLnByb3RvdHlwZS5nZXRUeXBlSUQ9ZnVuY3Rpb24oKXtyZXR1cm4gMH0sX19kZWNvcmF0ZShbZS5zZXJpYWxpemVBc1ZlY3RvcjMoKV0saS5wcm90b3R5cGUsXCJwb3NpdGlvblwiLHZvaWQgMCksaX0oZS5MaWdodCk7ZS5Qb2ludExpZ2h0PXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGkoZSxpLHIsbixvLHMpe3QuY2FsbCh0aGlzLGUscyksdGhpcy5wb3NpdGlvbj1pLHRoaXMuZGlyZWN0aW9uPXIsdGhpcy5hbmdsZT1uLHRoaXMuZXhwb25lbnQ9b31yZXR1cm4gX19leHRlbmRzKGksdCksaS5wcm90b3R5cGUuZ2V0QWJzb2x1dGVQb3NpdGlvbj1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRyYW5zZm9ybWVkUG9zaXRpb24/dGhpcy50cmFuc2Zvcm1lZFBvc2l0aW9uOnRoaXMucG9zaXRpb259LGkucHJvdG90eXBlLnNldFNoYWRvd1Byb2plY3Rpb25NYXRyaXg9ZnVuY3Rpb24odCxpLHIpe3ZhciBuPXRoaXMuZ2V0U2NlbmUoKS5hY3RpdmVDYW1lcmE7ZS5NYXRyaXguUGVyc3BlY3RpdmVGb3ZMSFRvUmVmKHRoaXMuYW5nbGUsMSxuLm1pblosbi5tYXhaLHQpfSxpLnByb3RvdHlwZS5uZWVkQ3ViZT1mdW5jdGlvbigpe3JldHVybiExfSxpLnByb3RvdHlwZS5zdXBwb3J0c1ZTTT1mdW5jdGlvbigpe3JldHVybiEwfSxpLnByb3RvdHlwZS5uZWVkUmVmcmVzaFBlckZyYW1lPWZ1bmN0aW9uKCl7cmV0dXJuITF9LGkucHJvdG90eXBlLmdldFNoYWRvd0RpcmVjdGlvbj1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5kaXJlY3Rpb259LGkucHJvdG90eXBlLnNldERpcmVjdGlvblRvVGFyZ2V0PWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmRpcmVjdGlvbj1lLlZlY3RvcjMuTm9ybWFsaXplKHQuc3VidHJhY3QodGhpcy5wb3NpdGlvbikpLHRoaXMuZGlyZWN0aW9ufSxpLnByb3RvdHlwZS5jb21wdXRlVHJhbnNmb3JtZWRQb3NpdGlvbj1mdW5jdGlvbigpe3JldHVybiB0aGlzLnBhcmVudCYmdGhpcy5wYXJlbnQuZ2V0V29ybGRNYXRyaXg/KHRoaXMudHJhbnNmb3JtZWRQb3NpdGlvbnx8KHRoaXMudHJhbnNmb3JtZWRQb3NpdGlvbj1lLlZlY3RvcjMuWmVybygpKSxlLlZlY3RvcjMuVHJhbnNmb3JtQ29vcmRpbmF0ZXNUb1JlZih0aGlzLnBvc2l0aW9uLHRoaXMucGFyZW50LmdldFdvcmxkTWF0cml4KCksdGhpcy50cmFuc2Zvcm1lZFBvc2l0aW9uKSwhMCk6ITF9LGkucHJvdG90eXBlLnRyYW5zZmVyVG9FZmZlY3Q9ZnVuY3Rpb24odCxpLHIpe3ZhciBuO3RoaXMucGFyZW50JiZ0aGlzLnBhcmVudC5nZXRXb3JsZE1hdHJpeD8odGhpcy5fdHJhbnNmb3JtZWREaXJlY3Rpb258fCh0aGlzLl90cmFuc2Zvcm1lZERpcmVjdGlvbj1lLlZlY3RvcjMuWmVybygpKSx0aGlzLmNvbXB1dGVUcmFuc2Zvcm1lZFBvc2l0aW9uKCksZS5WZWN0b3IzLlRyYW5zZm9ybU5vcm1hbFRvUmVmKHRoaXMuZGlyZWN0aW9uLHRoaXMucGFyZW50LmdldFdvcmxkTWF0cml4KCksdGhpcy5fdHJhbnNmb3JtZWREaXJlY3Rpb24pLHQuc2V0RmxvYXQ0KGksdGhpcy50cmFuc2Zvcm1lZFBvc2l0aW9uLngsdGhpcy50cmFuc2Zvcm1lZFBvc2l0aW9uLnksdGhpcy50cmFuc2Zvcm1lZFBvc2l0aW9uLnosdGhpcy5leHBvbmVudCksbj1lLlZlY3RvcjMuTm9ybWFsaXplKHRoaXMuX3RyYW5zZm9ybWVkRGlyZWN0aW9uKSk6KHQuc2V0RmxvYXQ0KGksdGhpcy5wb3NpdGlvbi54LHRoaXMucG9zaXRpb24ueSx0aGlzLnBvc2l0aW9uLnosdGhpcy5leHBvbmVudCksbj1lLlZlY3RvcjMuTm9ybWFsaXplKHRoaXMuZGlyZWN0aW9uKSksdC5zZXRGbG9hdDQocixuLngsbi55LG4ueixNYXRoLmNvcyguNSp0aGlzLmFuZ2xlKSl9LGkucHJvdG90eXBlLl9nZXRXb3JsZE1hdHJpeD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl93b3JsZE1hdHJpeHx8KHRoaXMuX3dvcmxkTWF0cml4PWUuTWF0cml4LklkZW50aXR5KCkpLGUuTWF0cml4LlRyYW5zbGF0aW9uVG9SZWYodGhpcy5wb3NpdGlvbi54LHRoaXMucG9zaXRpb24ueSx0aGlzLnBvc2l0aW9uLnosdGhpcy5fd29ybGRNYXRyaXgpLHRoaXMuX3dvcmxkTWF0cml4fSxpLnByb3RvdHlwZS5nZXRUeXBlSUQ9ZnVuY3Rpb24oKXtyZXR1cm4gMn0sX19kZWNvcmF0ZShbZS5zZXJpYWxpemVBc1ZlY3RvcjMoKV0saS5wcm90b3R5cGUsXCJwb3NpdGlvblwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemVBc1ZlY3RvcjMoKV0saS5wcm90b3R5cGUsXCJkaXJlY3Rpb25cIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLGkucHJvdG90eXBlLFwiYW5nbGVcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLGkucHJvdG90eXBlLFwiZXhwb25lbnRcIix2b2lkIDApLGl9KGUuTGlnaHQpO2UuU3BvdExpZ2h0PXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGkoaSxyLG4pe3QuY2FsbCh0aGlzLGksbiksdGhpcy5ncm91bmRDb2xvcj1uZXcgZS5Db2xvcjMoMCwwLDApLHRoaXMuZGlyZWN0aW9uPXJ9cmV0dXJuIF9fZXh0ZW5kcyhpLHQpLGkucHJvdG90eXBlLnNldERpcmVjdGlvblRvVGFyZ2V0PWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmRpcmVjdGlvbj1lLlZlY3RvcjMuTm9ybWFsaXplKHQuc3VidHJhY3QoZS5WZWN0b3IzLlplcm8oKSkpLHRoaXMuZGlyZWN0aW9uO1xufSxpLnByb3RvdHlwZS5nZXRTaGFkb3dHZW5lcmF0b3I9ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbH0saS5wcm90b3R5cGUudHJhbnNmZXJUb0VmZmVjdD1mdW5jdGlvbih0LGkscil7dmFyIG49ZS5WZWN0b3IzLk5vcm1hbGl6ZSh0aGlzLmRpcmVjdGlvbik7dC5zZXRGbG9hdDQoaSxuLngsbi55LG4ueiwwKSx0LnNldENvbG9yMyhyLHRoaXMuZ3JvdW5kQ29sb3Iuc2NhbGUodGhpcy5pbnRlbnNpdHkpKX0saS5wcm90b3R5cGUuX2dldFdvcmxkTWF0cml4PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3dvcmxkTWF0cml4fHwodGhpcy5fd29ybGRNYXRyaXg9ZS5NYXRyaXguSWRlbnRpdHkoKSksdGhpcy5fd29ybGRNYXRyaXh9LGkucHJvdG90eXBlLmdldFR5cGVJRD1mdW5jdGlvbigpe3JldHVybiAzfSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZUFzQ29sb3IzKCldLGkucHJvdG90eXBlLFwiZ3JvdW5kQ29sb3JcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplQXNWZWN0b3IzKCldLGkucHJvdG90eXBlLFwiZGlyZWN0aW9uXCIsdm9pZCAwKSxpfShlLkxpZ2h0KTtlLkhlbWlzcGhlcmljTGlnaHQ9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gaShlLGkscil7dC5jYWxsKHRoaXMsZSxyKSx0aGlzLnNoYWRvd09ydGhvU2NhbGU9LjUsdGhpcy5hdXRvVXBkYXRlRXh0ZW5kcz0hMCx0aGlzLl9vcnRob0xlZnQ9TnVtYmVyLk1BWF9WQUxVRSx0aGlzLl9vcnRob1JpZ2h0PU51bWJlci5NSU5fVkFMVUUsdGhpcy5fb3J0aG9Ub3A9TnVtYmVyLk1JTl9WQUxVRSx0aGlzLl9vcnRob0JvdHRvbT1OdW1iZXIuTUFYX1ZBTFVFLHRoaXMucG9zaXRpb249aS5zY2FsZSgtMSksdGhpcy5kaXJlY3Rpb249aX1yZXR1cm4gX19leHRlbmRzKGksdCksaS5wcm90b3R5cGUuZ2V0QWJzb2x1dGVQb3NpdGlvbj1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRyYW5zZm9ybWVkUG9zaXRpb24/dGhpcy50cmFuc2Zvcm1lZFBvc2l0aW9uOnRoaXMucG9zaXRpb259LGkucHJvdG90eXBlLnNldERpcmVjdGlvblRvVGFyZ2V0PWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmRpcmVjdGlvbj1lLlZlY3RvcjMuTm9ybWFsaXplKHQuc3VidHJhY3QodGhpcy5wb3NpdGlvbikpLHRoaXMuZGlyZWN0aW9ufSxpLnByb3RvdHlwZS5zZXRTaGFkb3dQcm9qZWN0aW9uTWF0cml4PWZ1bmN0aW9uKHQsaSxyKXt2YXIgbj10aGlzLmdldFNjZW5lKCkuYWN0aXZlQ2FtZXJhO2lmKHRoaXMuYXV0b1VwZGF0ZUV4dGVuZHN8fHRoaXMuX29ydGhvTGVmdD09PU51bWJlci5NQVhfVkFMVUUpe3ZhciBvPWUuVmVjdG9yMy5aZXJvKCk7dGhpcy5fb3J0aG9MZWZ0PU51bWJlci5NQVhfVkFMVUUsdGhpcy5fb3J0aG9SaWdodD1OdW1iZXIuTUlOX1ZBTFVFLHRoaXMuX29ydGhvVG9wPU51bWJlci5NSU5fVkFMVUUsdGhpcy5fb3J0aG9Cb3R0b209TnVtYmVyLk1BWF9WQUxVRTtmb3IodmFyIHM9MDtzPHIubGVuZ3RoO3MrKyl7dmFyIGE9cltzXTtpZihhKXt2YXIgaD1hLmdldEJvdW5kaW5nSW5mbygpO2lmKGgpZm9yKHZhciBjPWguYm91bmRpbmdCb3gsbD0wO2w8Yy52ZWN0b3JzV29ybGQubGVuZ3RoO2wrKyllLlZlY3RvcjMuVHJhbnNmb3JtQ29vcmRpbmF0ZXNUb1JlZihjLnZlY3RvcnNXb3JsZFtsXSxpLG8pLG8ueDx0aGlzLl9vcnRob0xlZnQmJih0aGlzLl9vcnRob0xlZnQ9by54KSxvLnk8dGhpcy5fb3J0aG9Cb3R0b20mJih0aGlzLl9vcnRob0JvdHRvbT1vLnkpLG8ueD50aGlzLl9vcnRob1JpZ2h0JiYodGhpcy5fb3J0aG9SaWdodD1vLngpLG8ueT50aGlzLl9vcnRob1RvcCYmKHRoaXMuX29ydGhvVG9wPW8ueSl9fX12YXIgdT10aGlzLl9vcnRob1JpZ2h0LXRoaXMuX29ydGhvTGVmdCxmPXRoaXMuX29ydGhvVG9wLXRoaXMuX29ydGhvQm90dG9tO2UuTWF0cml4Lk9ydGhvT2ZmQ2VudGVyTEhUb1JlZih0aGlzLl9vcnRob0xlZnQtdSp0aGlzLnNoYWRvd09ydGhvU2NhbGUsdGhpcy5fb3J0aG9SaWdodCt1KnRoaXMuc2hhZG93T3J0aG9TY2FsZSx0aGlzLl9vcnRob0JvdHRvbS1mKnRoaXMuc2hhZG93T3J0aG9TY2FsZSx0aGlzLl9vcnRob1RvcCtmKnRoaXMuc2hhZG93T3J0aG9TY2FsZSwtbi5tYXhaLG4ubWF4Wix0KX0saS5wcm90b3R5cGUuc3VwcG9ydHNWU009ZnVuY3Rpb24oKXtyZXR1cm4hMH0saS5wcm90b3R5cGUubmVlZFJlZnJlc2hQZXJGcmFtZT1mdW5jdGlvbigpe3JldHVybiEwfSxpLnByb3RvdHlwZS5uZWVkQ3ViZT1mdW5jdGlvbigpe3JldHVybiExfSxpLnByb3RvdHlwZS5nZXRTaGFkb3dEaXJlY3Rpb249ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuZGlyZWN0aW9ufSxpLnByb3RvdHlwZS5jb21wdXRlVHJhbnNmb3JtZWRQb3NpdGlvbj1mdW5jdGlvbigpe3JldHVybiB0aGlzLnBhcmVudCYmdGhpcy5wYXJlbnQuZ2V0V29ybGRNYXRyaXg/KHRoaXMudHJhbnNmb3JtZWRQb3NpdGlvbnx8KHRoaXMudHJhbnNmb3JtZWRQb3NpdGlvbj1lLlZlY3RvcjMuWmVybygpKSxlLlZlY3RvcjMuVHJhbnNmb3JtQ29vcmRpbmF0ZXNUb1JlZih0aGlzLnBvc2l0aW9uLHRoaXMucGFyZW50LmdldFdvcmxkTWF0cml4KCksdGhpcy50cmFuc2Zvcm1lZFBvc2l0aW9uKSwhMCk6ITF9LGkucHJvdG90eXBlLnRyYW5zZmVyVG9FZmZlY3Q9ZnVuY3Rpb24odCxpKXtyZXR1cm4gdGhpcy5wYXJlbnQmJnRoaXMucGFyZW50LmdldFdvcmxkTWF0cml4Pyh0aGlzLl90cmFuc2Zvcm1lZERpcmVjdGlvbnx8KHRoaXMuX3RyYW5zZm9ybWVkRGlyZWN0aW9uPWUuVmVjdG9yMy5aZXJvKCkpLGUuVmVjdG9yMy5UcmFuc2Zvcm1Ob3JtYWxUb1JlZih0aGlzLmRpcmVjdGlvbix0aGlzLnBhcmVudC5nZXRXb3JsZE1hdHJpeCgpLHRoaXMuX3RyYW5zZm9ybWVkRGlyZWN0aW9uKSx2b2lkIHQuc2V0RmxvYXQ0KGksdGhpcy5fdHJhbnNmb3JtZWREaXJlY3Rpb24ueCx0aGlzLl90cmFuc2Zvcm1lZERpcmVjdGlvbi55LHRoaXMuX3RyYW5zZm9ybWVkRGlyZWN0aW9uLnosMSkpOnZvaWQgdC5zZXRGbG9hdDQoaSx0aGlzLmRpcmVjdGlvbi54LHRoaXMuZGlyZWN0aW9uLnksdGhpcy5kaXJlY3Rpb24ueiwxKX0saS5wcm90b3R5cGUuX2dldFdvcmxkTWF0cml4PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3dvcmxkTWF0cml4fHwodGhpcy5fd29ybGRNYXRyaXg9ZS5NYXRyaXguSWRlbnRpdHkoKSksZS5NYXRyaXguVHJhbnNsYXRpb25Ub1JlZih0aGlzLnBvc2l0aW9uLngsdGhpcy5wb3NpdGlvbi55LHRoaXMucG9zaXRpb24ueix0aGlzLl93b3JsZE1hdHJpeCksdGhpcy5fd29ybGRNYXRyaXh9LGkucHJvdG90eXBlLmdldFR5cGVJRD1mdW5jdGlvbigpe3JldHVybiAxfSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZUFzVmVjdG9yMygpXSxpLnByb3RvdHlwZSxcInBvc2l0aW9uXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZUFzVmVjdG9yMygpXSxpLnByb3RvdHlwZSxcImRpcmVjdGlvblwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0saS5wcm90b3R5cGUsXCJzaGFkb3dPcnRob1NjYWxlXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSxpLnByb3RvdHlwZSxcImF1dG9VcGRhdGVFeHRlbmRzXCIsdm9pZCAwKSxpfShlLkxpZ2h0KTtlLkRpcmVjdGlvbmFsTGlnaHQ9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KGkscil7dmFyIG49dGhpczt0aGlzLl9maWx0ZXI9dC5GSUxURVJfTk9ORSx0aGlzLmJsdXJTY2FsZT0yLHRoaXMuX2JsdXJCb3hPZmZzZXQ9MCx0aGlzLl9iaWFzPTVlLTUsdGhpcy5fbGlnaHREaXJlY3Rpb249ZS5WZWN0b3IzLlplcm8oKSx0aGlzLmZvcmNlQmFja0ZhY2VzT25seT0hMSx0aGlzLl9kYXJrbmVzcz0wLHRoaXMuX3RyYW5zcGFyZW5jeVNoYWRvdz0hMSx0aGlzLl92aWV3TWF0cml4PWUuTWF0cml4Llplcm8oKSx0aGlzLl9wcm9qZWN0aW9uTWF0cml4PWUuTWF0cml4Llplcm8oKSx0aGlzLl90cmFuc2Zvcm1NYXRyaXg9ZS5NYXRyaXguWmVybygpLHRoaXMuX3dvcmxkVmlld1Byb2plY3Rpb249ZS5NYXRyaXguWmVybygpLHRoaXMuX2N1cnJlbnRGYWNlSW5kZXg9MCx0aGlzLl9jdXJyZW50RmFjZUluZGV4Q2FjaGU9MCx0aGlzLl9saWdodD1yLHRoaXMuX3NjZW5lPXIuZ2V0U2NlbmUoKSx0aGlzLl9tYXBTaXplPWksci5fc2hhZG93R2VuZXJhdG9yPXRoaXMsdGhpcy5fc2hhZG93TWFwPW5ldyBlLlJlbmRlclRhcmdldFRleHR1cmUoci5uYW1lK1wiX3NoYWRvd01hcFwiLGksdGhpcy5fc2NlbmUsITEsITAsZS5FbmdpbmUuVEVYVFVSRVRZUEVfVU5TSUdORURfSU5ULHIubmVlZEN1YmUoKSksdGhpcy5fc2hhZG93TWFwLndyYXBVPWUuVGV4dHVyZS5DTEFNUF9BRERSRVNTTU9ERSx0aGlzLl9zaGFkb3dNYXAud3JhcFY9ZS5UZXh0dXJlLkNMQU1QX0FERFJFU1NNT0RFLHRoaXMuX3NoYWRvd01hcC5hbmlzb3Ryb3BpY0ZpbHRlcmluZ0xldmVsPTEsdGhpcy5fc2hhZG93TWFwLnVwZGF0ZVNhbXBsaW5nTW9kZShlLlRleHR1cmUuTkVBUkVTVF9TQU1QTElOR01PREUpLHRoaXMuX3NoYWRvd01hcC5yZW5kZXJQYXJ0aWNsZXM9ITEsdGhpcy5fc2hhZG93TWFwLm9uQmVmb3JlUmVuZGVyT2JzZXJ2YWJsZS5hZGQoZnVuY3Rpb24oZSl7bi5fY3VycmVudEZhY2VJbmRleD1lfSksdGhpcy5fc2hhZG93TWFwLm9uQWZ0ZXJVbmJpbmRPYnNlcnZhYmxlLmFkZChmdW5jdGlvbigpe24udXNlQmx1clZhcmlhbmNlU2hhZG93TWFwJiYobi5fc2hhZG93TWFwMnx8KG4uX3NoYWRvd01hcDI9bmV3IGUuUmVuZGVyVGFyZ2V0VGV4dHVyZShyLm5hbWUrXCJfc2hhZG93TWFwXCIsaSxuLl9zY2VuZSwhMSksbi5fc2hhZG93TWFwMi53cmFwVT1lLlRleHR1cmUuQ0xBTVBfQUREUkVTU01PREUsbi5fc2hhZG93TWFwMi53cmFwVj1lLlRleHR1cmUuQ0xBTVBfQUREUkVTU01PREUsbi5fc2hhZG93TWFwMi51cGRhdGVTYW1wbGluZ01vZGUoZS5UZXh0dXJlLlRSSUxJTkVBUl9TQU1QTElOR01PREUpLG4uX2Rvd25TYW1wbGVQb3N0cHJvY2Vzcz1uZXcgZS5QYXNzUG9zdFByb2Nlc3MoXCJkb3duU2NhbGVcIiwxL24uYmx1clNjYWxlLG51bGwsZS5UZXh0dXJlLkJJTElORUFSX1NBTVBMSU5HTU9ERSxuLl9zY2VuZS5nZXRFbmdpbmUoKSksbi5fZG93blNhbXBsZVBvc3Rwcm9jZXNzLm9uQXBwbHlPYnNlcnZhYmxlLmFkZChmdW5jdGlvbihlKXtlLnNldFRleHR1cmUoXCJ0ZXh0dXJlU2FtcGxlclwiLG4uX3NoYWRvd01hcCl9KSxuLmJsdXJCb3hPZmZzZXQ9MSksbi5fc2NlbmUucG9zdFByb2Nlc3NNYW5hZ2VyLmRpcmVjdFJlbmRlcihbbi5fZG93blNhbXBsZVBvc3Rwcm9jZXNzLG4uX2JveEJsdXJQb3N0cHJvY2Vzc10sbi5fc2hhZG93TWFwMi5nZXRJbnRlcm5hbFRleHR1cmUoKSkpfSk7dmFyIG89ZnVuY3Rpb24odCl7dmFyIGk9dC5nZXRSZW5kZXJpbmdNZXNoKCkscj1uLl9zY2VuZSxvPXIuZ2V0RW5naW5lKCk7by5zZXRTdGF0ZSh0LmdldE1hdGVyaWFsKCkuYmFja0ZhY2VDdWxsaW5nKTt2YXIgcz1pLl9nZXRJbnN0YW5jZXNSZW5kZXJMaXN0KHQuX2lkKTtpZighcy5tdXN0UmV0dXJuKXt2YXIgYT1udWxsIT09by5nZXRDYXBzKCkuaW5zdGFuY2VkQXJyYXlzJiZudWxsIT09cy52aXNpYmxlSW5zdGFuY2VzW3QuX2lkXSYmdm9pZCAwIT09cy52aXNpYmxlSW5zdGFuY2VzW3QuX2lkXTtpZihuLmlzUmVhZHkodCxhKSl7by5lbmFibGVFZmZlY3Qobi5fZWZmZWN0KSxpLl9iaW5kKHQsbi5fZWZmZWN0LGUuTWF0ZXJpYWwuVHJpYW5nbGVGaWxsTW9kZSk7dmFyIGg9dC5nZXRNYXRlcmlhbCgpO2lmKG4uX2VmZmVjdC5zZXRNYXRyaXgoXCJ2aWV3UHJvamVjdGlvblwiLG4uZ2V0VHJhbnNmb3JtTWF0cml4KCkpLG4uX2VmZmVjdC5zZXRWZWN0b3IzKFwibGlnaHRQb3NpdGlvblwiLG4uZ2V0TGlnaHQoKS5wb3NpdGlvbiksbi5nZXRMaWdodCgpLm5lZWRDdWJlKCkmJm4uX2VmZmVjdC5zZXRGbG9hdDIoXCJkZXB0aFZhbHVlc1wiLHIuYWN0aXZlQ2FtZXJhLm1pblosci5hY3RpdmVDYW1lcmEubWF4WiksaCYmaC5uZWVkQWxwaGFUZXN0aW5nKCkpe3ZhciBjPWguZ2V0QWxwaGFUZXN0VGV4dHVyZSgpO24uX2VmZmVjdC5zZXRUZXh0dXJlKFwiZGlmZnVzZVNhbXBsZXJcIixjKSxuLl9lZmZlY3Quc2V0TWF0cml4KFwiZGlmZnVzZU1hdHJpeFwiLGMuZ2V0VGV4dHVyZU1hdHJpeCgpKX1pLnVzZUJvbmVzJiZpLmNvbXB1dGVCb25lc1VzaW5nU2hhZGVycyYmbi5fZWZmZWN0LnNldE1hdHJpY2VzKFwibUJvbmVzXCIsaS5za2VsZXRvbi5nZXRUcmFuc2Zvcm1NYXRyaWNlcyhpKSksbi5mb3JjZUJhY2tGYWNlc09ubHkmJm8uc2V0U3RhdGUoITAsMCwhMSwhMCksaS5fcHJvY2Vzc1JlbmRlcmluZyh0LG4uX2VmZmVjdCxlLk1hdGVyaWFsLlRyaWFuZ2xlRmlsbE1vZGUscyxhLGZ1bmN0aW9uKGUsdCl7cmV0dXJuIG4uX2VmZmVjdC5zZXRNYXRyaXgoXCJ3b3JsZFwiLHQpfSksbi5mb3JjZUJhY2tGYWNlc09ubHkmJm8uc2V0U3RhdGUoITAsMCwhMSwhMSl9ZWxzZSBuLl9zaGFkb3dNYXAucmVzZXRSZWZyZXNoQ291bnRlcigpfX07dGhpcy5fc2hhZG93TWFwLmN1c3RvbVJlbmRlckZ1bmN0aW9uPWZ1bmN0aW9uKGUsdCxpKXt2YXIgcjtmb3Iocj0wO3I8ZS5sZW5ndGg7cisrKW8oZS5kYXRhW3JdKTtmb3Iocj0wO3I8dC5sZW5ndGg7cisrKW8odC5kYXRhW3JdKTtpZihuLl90cmFuc3BhcmVuY3lTaGFkb3cpZm9yKHI9MDtyPGkubGVuZ3RoO3IrKylvKGkuZGF0YVtyXSl9LHRoaXMuX3NoYWRvd01hcC5vbkNsZWFyT2JzZXJ2YWJsZS5hZGQoZnVuY3Rpb24odCl7bi51c2VCbHVyVmFyaWFuY2VTaGFkb3dNYXB8fG4udXNlVmFyaWFuY2VTaGFkb3dNYXA/dC5jbGVhcihuZXcgZS5Db2xvcjQoMCwwLDAsMCksITAsITApOnQuY2xlYXIobmV3IGUuQ29sb3I0KDEsMSwxLDEpLCEwLCEwKX0pfXJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIkZJTFRFUl9OT05FXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0Ll9GSUxURVJfTk9ORX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIkZJTFRFUl9WQVJJQU5DRVNIQURPV01BUFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdC5fRklMVEVSX1ZBUklBTkNFU0hBRE9XTUFQfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiRklMVEVSX1BPSVNTT05TQU1QTElOR1wiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdC5fRklMVEVSX1BPSVNTT05TQU1QTElOR30sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIkZJTFRFUl9CTFVSVkFSSUFOQ0VTSEFET1dNQVBcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHQuX0ZJTFRFUl9CTFVSVkFSSUFOQ0VTSEFET1dNQVB9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwiYmlhc1wiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fYmlhc30sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX2JpYXM9ZX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJibHVyQm94T2Zmc2V0XCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9ibHVyQm94T2Zmc2V0fSxzZXQ6ZnVuY3Rpb24odCl7dmFyIGk9dGhpczt0aGlzLl9ibHVyQm94T2Zmc2V0IT09dCYmKHRoaXMuX2JsdXJCb3hPZmZzZXQ9dCx0aGlzLl9ib3hCbHVyUG9zdHByb2Nlc3MmJnRoaXMuX2JveEJsdXJQb3N0cHJvY2Vzcy5kaXNwb3NlKCksdGhpcy5fYm94Qmx1clBvc3Rwcm9jZXNzPW5ldyBlLlBvc3RQcm9jZXNzKFwiRGVwdGhCb3hCbHVyXCIsXCJkZXB0aEJveEJsdXJcIixbXCJzY3JlZW5TaXplXCIsXCJib3hPZmZzZXRcIl0sW10sMS90aGlzLmJsdXJTY2FsZSxudWxsLGUuVGV4dHVyZS5CSUxJTkVBUl9TQU1QTElOR01PREUsdGhpcy5fc2NlbmUuZ2V0RW5naW5lKCksITEsXCIjZGVmaW5lIE9GRlNFVCBcIit0KSx0aGlzLl9ib3hCbHVyUG9zdHByb2Nlc3Mub25BcHBseU9ic2VydmFibGUuYWRkKGZ1bmN0aW9uKGUpe2Uuc2V0RmxvYXQyKFwic2NyZWVuU2l6ZVwiLGkuX21hcFNpemUvaS5ibHVyU2NhbGUsaS5fbWFwU2l6ZS9pLmJsdXJTY2FsZSl9KSl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwiZmlsdGVyXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9maWx0ZXJ9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9maWx0ZXIhPT10JiYodGhpcy5fZmlsdGVyPXQsdGhpcy51c2VWYXJpYW5jZVNoYWRvd01hcHx8dGhpcy51c2VCbHVyVmFyaWFuY2VTaGFkb3dNYXB8fHRoaXMudXNlUG9pc3NvblNhbXBsaW5nPyh0aGlzLl9zaGFkb3dNYXAuYW5pc290cm9waWNGaWx0ZXJpbmdMZXZlbD0xNix0aGlzLl9zaGFkb3dNYXAudXBkYXRlU2FtcGxpbmdNb2RlKGUuVGV4dHVyZS5CSUxJTkVBUl9TQU1QTElOR01PREUpKToodGhpcy5fc2hhZG93TWFwLmFuaXNvdHJvcGljRmlsdGVyaW5nTGV2ZWw9MSx0aGlzLl9zaGFkb3dNYXAudXBkYXRlU2FtcGxpbmdNb2RlKGUuVGV4dHVyZS5ORUFSRVNUX1NBTVBMSU5HTU9ERSkpKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJ1c2VWYXJpYW5jZVNoYWRvd01hcFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5maWx0ZXI9PT10LkZJTFRFUl9WQVJJQU5DRVNIQURPV01BUCYmdGhpcy5fbGlnaHQuc3VwcG9ydHNWU00oKX0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuZmlsdGVyPWU/dC5GSUxURVJfVkFSSUFOQ0VTSEFET1dNQVA6dC5GSUxURVJfTk9ORX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJ1c2VQb2lzc29uU2FtcGxpbmdcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZmlsdGVyPT09dC5GSUxURVJfUE9JU1NPTlNBTVBMSU5HfHwhdGhpcy5fbGlnaHQuc3VwcG9ydHNWU00oKSYmKHRoaXMuZmlsdGVyPT09dC5GSUxURVJfVkFSSUFOQ0VTSEFET1dNQVB8fHRoaXMuZmlsdGVyPT09dC5GSUxURVJfQkxVUlZBUklBTkNFU0hBRE9XTUFQKX0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuZmlsdGVyPWU/dC5GSUxURVJfUE9JU1NPTlNBTVBMSU5HOnQuRklMVEVSX05PTkV9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwidXNlQmx1clZhcmlhbmNlU2hhZG93TWFwXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmZpbHRlcj09PXQuRklMVEVSX0JMVVJWQVJJQU5DRVNIQURPV01BUCYmdGhpcy5fbGlnaHQuc3VwcG9ydHNWU00oKX0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuZmlsdGVyPWU/dC5GSUxURVJfQkxVUlZBUklBTkNFU0hBRE9XTUFQOnQuRklMVEVSX05PTkV9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksdC5wcm90b3R5cGUuaXNSZWFkeT1mdW5jdGlvbih0LGkpe3ZhciByPVtdOyh0aGlzLnVzZVZhcmlhbmNlU2hhZG93TWFwfHx0aGlzLnVzZUJsdXJWYXJpYW5jZVNoYWRvd01hcCkmJnIucHVzaChcIiNkZWZpbmUgVlNNXCIpLHRoaXMuZ2V0TGlnaHQoKS5uZWVkQ3ViZSgpJiZyLnB1c2goXCIjZGVmaW5lIENVQkVNQVBcIik7dmFyIG49W2UuVmVydGV4QnVmZmVyLlBvc2l0aW9uS2luZF0sbz10LmdldE1lc2goKSxzPXQuZ2V0TWF0ZXJpYWwoKTtzJiZzLm5lZWRBbHBoYVRlc3RpbmcoKSYmKHIucHVzaChcIiNkZWZpbmUgQUxQSEFURVNUXCIpLG8uaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGUuVmVydGV4QnVmZmVyLlVWS2luZCkmJihuLnB1c2goZS5WZXJ0ZXhCdWZmZXIuVVZLaW5kKSxyLnB1c2goXCIjZGVmaW5lIFVWMVwiKSksby5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZS5WZXJ0ZXhCdWZmZXIuVVYyS2luZCkmJihuLnB1c2goZS5WZXJ0ZXhCdWZmZXIuVVYyS2luZCksci5wdXNoKFwiI2RlZmluZSBVVjJcIikpKSxvLnVzZUJvbmVzJiZvLmNvbXB1dGVCb25lc1VzaW5nU2hhZGVycz8obi5wdXNoKGUuVmVydGV4QnVmZmVyLk1hdHJpY2VzSW5kaWNlc0tpbmQpLG4ucHVzaChlLlZlcnRleEJ1ZmZlci5NYXRyaWNlc1dlaWdodHNLaW5kKSxvLm51bUJvbmVJbmZsdWVuY2Vycz40JiYobi5wdXNoKGUuVmVydGV4QnVmZmVyLk1hdHJpY2VzSW5kaWNlc0V4dHJhS2luZCksbi5wdXNoKGUuVmVydGV4QnVmZmVyLk1hdHJpY2VzV2VpZ2h0c0V4dHJhS2luZCkpLHIucHVzaChcIiNkZWZpbmUgTlVNX0JPTkVfSU5GTFVFTkNFUlMgXCIrby5udW1Cb25lSW5mbHVlbmNlcnMpLHIucHVzaChcIiNkZWZpbmUgQm9uZXNQZXJNZXNoIFwiKyhvLnNrZWxldG9uLmJvbmVzLmxlbmd0aCsxKSkpOnIucHVzaChcIiNkZWZpbmUgTlVNX0JPTkVfSU5GTFVFTkNFUlMgMFwiKSxpJiYoci5wdXNoKFwiI2RlZmluZSBJTlNUQU5DRVNcIiksbi5wdXNoKFwid29ybGQwXCIpLG4ucHVzaChcIndvcmxkMVwiKSxuLnB1c2goXCJ3b3JsZDJcIiksbi5wdXNoKFwid29ybGQzXCIpKTt2YXIgYT1yLmpvaW4oXCJcXG5cIik7cmV0dXJuIHRoaXMuX2NhY2hlZERlZmluZXMhPT1hJiYodGhpcy5fY2FjaGVkRGVmaW5lcz1hLHRoaXMuX2VmZmVjdD10aGlzLl9zY2VuZS5nZXRFbmdpbmUoKS5jcmVhdGVFZmZlY3QoXCJzaGFkb3dNYXBcIixuLFtcIndvcmxkXCIsXCJtQm9uZXNcIixcInZpZXdQcm9qZWN0aW9uXCIsXCJkaWZmdXNlTWF0cml4XCIsXCJsaWdodFBvc2l0aW9uXCIsXCJkZXB0aFZhbHVlc1wiXSxbXCJkaWZmdXNlU2FtcGxlclwiXSxhKSksdGhpcy5fZWZmZWN0LmlzUmVhZHkoKX0sdC5wcm90b3R5cGUuZ2V0U2hhZG93TWFwPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3NoYWRvd01hcH0sdC5wcm90b3R5cGUuZ2V0U2hhZG93TWFwRm9yUmVuZGVyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3NoYWRvd01hcDI/dGhpcy5fc2hhZG93TWFwMjp0aGlzLl9zaGFkb3dNYXB9LHQucHJvdG90eXBlLmdldExpZ2h0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2xpZ2h0fSx0LnByb3RvdHlwZS5nZXRUcmFuc2Zvcm1NYXRyaXg9ZnVuY3Rpb24oKXt2YXIgdD10aGlzLl9zY2VuZTtpZih0aGlzLl9jdXJyZW50UmVuZGVySUQ9PT10LmdldFJlbmRlcklkKCkmJnRoaXMuX2N1cnJlbnRGYWNlSW5kZXhDYWNoZT09PXRoaXMuX2N1cnJlbnRGYWNlSW5kZXgpcmV0dXJuIHRoaXMuX3RyYW5zZm9ybU1hdHJpeDt0aGlzLl9jdXJyZW50UmVuZGVySUQ9dC5nZXRSZW5kZXJJZCgpLHRoaXMuX2N1cnJlbnRGYWNlSW5kZXhDYWNoZT10aGlzLl9jdXJyZW50RmFjZUluZGV4O3ZhciBpPXRoaXMuX2xpZ2h0LnBvc2l0aW9uO3JldHVybiBlLlZlY3RvcjMuTm9ybWFsaXplVG9SZWYodGhpcy5fbGlnaHQuZ2V0U2hhZG93RGlyZWN0aW9uKHRoaXMuX2N1cnJlbnRGYWNlSW5kZXgpLHRoaXMuX2xpZ2h0RGlyZWN0aW9uKSwxPT09TWF0aC5hYnMoZS5WZWN0b3IzLkRvdCh0aGlzLl9saWdodERpcmVjdGlvbixlLlZlY3RvcjMuVXAoKSkpJiYodGhpcy5fbGlnaHREaXJlY3Rpb24uej0xZS0xMyksdGhpcy5fbGlnaHQuY29tcHV0ZVRyYW5zZm9ybWVkUG9zaXRpb24oKSYmKGk9dGhpcy5fbGlnaHQudHJhbnNmb3JtZWRQb3NpdGlvbiksIXRoaXMuX2xpZ2h0Lm5lZWRSZWZyZXNoUGVyRnJhbWUoKSYmdGhpcy5fY2FjaGVkUG9zaXRpb24mJnRoaXMuX2NhY2hlZERpcmVjdGlvbiYmaS5lcXVhbHModGhpcy5fY2FjaGVkUG9zaXRpb24pJiZ0aGlzLl9saWdodERpcmVjdGlvbi5lcXVhbHModGhpcy5fY2FjaGVkRGlyZWN0aW9uKXx8KHRoaXMuX2NhY2hlZFBvc2l0aW9uPWkuY2xvbmUoKSx0aGlzLl9jYWNoZWREaXJlY3Rpb249dGhpcy5fbGlnaHREaXJlY3Rpb24uY2xvbmUoKSxlLk1hdHJpeC5Mb29rQXRMSFRvUmVmKGksaS5hZGQodGhpcy5fbGlnaHREaXJlY3Rpb24pLGUuVmVjdG9yMy5VcCgpLHRoaXMuX3ZpZXdNYXRyaXgpLHRoaXMuX2xpZ2h0LnNldFNoYWRvd1Byb2plY3Rpb25NYXRyaXgodGhpcy5fcHJvamVjdGlvbk1hdHJpeCx0aGlzLl92aWV3TWF0cml4LHRoaXMuZ2V0U2hhZG93TWFwKCkucmVuZGVyTGlzdCksdGhpcy5fdmlld01hdHJpeC5tdWx0aXBseVRvUmVmKHRoaXMuX3Byb2plY3Rpb25NYXRyaXgsdGhpcy5fdHJhbnNmb3JtTWF0cml4KSksdGhpcy5fdHJhbnNmb3JtTWF0cml4fSx0LnByb3RvdHlwZS5nZXREYXJrbmVzcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9kYXJrbmVzc30sdC5wcm90b3R5cGUuc2V0RGFya25lc3M9ZnVuY3Rpb24oZSl7ZT49MT90aGlzLl9kYXJrbmVzcz0xOjA+PWU/dGhpcy5fZGFya25lc3M9MDp0aGlzLl9kYXJrbmVzcz1lfSx0LnByb3RvdHlwZS5zZXRUcmFuc3BhcmVuY3lTaGFkb3c9ZnVuY3Rpb24oZSl7dGhpcy5fdHJhbnNwYXJlbmN5U2hhZG93PWV9LHQucHJvdG90eXBlLl9wYWNrSGFsZj1mdW5jdGlvbih0KXt2YXIgaT0yNTUqdCxyPWktTWF0aC5mbG9vcihpKTtyZXR1cm4gbmV3IGUuVmVjdG9yMih0LXIvMjU1LHIpfSx0LnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7dGhpcy5fc2hhZG93TWFwLmRpc3Bvc2UoKSx0aGlzLl9zaGFkb3dNYXAyJiZ0aGlzLl9zaGFkb3dNYXAyLmRpc3Bvc2UoKSx0aGlzLl9kb3duU2FtcGxlUG9zdHByb2Nlc3MmJnRoaXMuX2Rvd25TYW1wbGVQb3N0cHJvY2Vzcy5kaXNwb3NlKCksdGhpcy5fYm94Qmx1clBvc3Rwcm9jZXNzJiZ0aGlzLl9ib3hCbHVyUG9zdHByb2Nlc3MuZGlzcG9zZSgpfSx0LnByb3RvdHlwZS5zZXJpYWxpemU9ZnVuY3Rpb24oKXt2YXIgZT17fTtlLmxpZ2h0SWQ9dGhpcy5fbGlnaHQuaWQsZS5tYXBTaXplPXRoaXMuZ2V0U2hhZG93TWFwKCkuZ2V0UmVuZGVyU2l6ZSgpLGUudXNlVmFyaWFuY2VTaGFkb3dNYXA9dGhpcy51c2VWYXJpYW5jZVNoYWRvd01hcCxlLnVzZVBvaXNzb25TYW1wbGluZz10aGlzLnVzZVBvaXNzb25TYW1wbGluZyxlLmZvcmNlQmFja0ZhY2VzT25seT10aGlzLmZvcmNlQmFja0ZhY2VzT25seSxlLnJlbmRlckxpc3Q9W107Zm9yKHZhciB0PTA7dDx0aGlzLmdldFNoYWRvd01hcCgpLnJlbmRlckxpc3QubGVuZ3RoO3QrKyl7dmFyIGk9dGhpcy5nZXRTaGFkb3dNYXAoKS5yZW5kZXJMaXN0W3RdO2UucmVuZGVyTGlzdC5wdXNoKGkuaWQpfXJldHVybiBlfSx0LlBhcnNlPWZ1bmN0aW9uKGUsaSl7Zm9yKHZhciByPWkuZ2V0TGlnaHRCeUlEKGUubGlnaHRJZCksbj1uZXcgdChlLm1hcFNpemUsciksbz0wO288ZS5yZW5kZXJMaXN0Lmxlbmd0aDtvKyspe3ZhciBzPWkuZ2V0TWVzaGVzQnlJRChlLnJlbmRlckxpc3Rbb10pO3MuZm9yRWFjaChmdW5jdGlvbihlKXtuLmdldFNoYWRvd01hcCgpLnJlbmRlckxpc3QucHVzaChlKX0pfXJldHVybiBlLnVzZVBvaXNzb25TYW1wbGluZz9uLnVzZVBvaXNzb25TYW1wbGluZz0hMDplLnVzZVZhcmlhbmNlU2hhZG93TWFwP24udXNlVmFyaWFuY2VTaGFkb3dNYXA9ITA6ZS51c2VCbHVyVmFyaWFuY2VTaGFkb3dNYXAmJihuLnVzZUJsdXJWYXJpYW5jZVNoYWRvd01hcD0hMCxlLmJsdXJTY2FsZSYmKG4uYmx1clNjYWxlPWUuYmx1clNjYWxlKSxlLmJsdXJCb3hPZmZzZXQmJihuLmJsdXJCb3hPZmZzZXQ9ZS5ibHVyQm94T2Zmc2V0KSksdm9pZCAwIT09ZS5iaWFzJiYobi5iaWFzPWUuYmlhcyksbi5mb3JjZUJhY2tGYWNlc09ubHk9ZS5mb3JjZUJhY2tGYWNlc09ubHksbn0sdC5fRklMVEVSX05PTkU9MCx0Ll9GSUxURVJfVkFSSUFOQ0VTSEFET1dNQVA9MSx0Ll9GSUxURVJfUE9JU1NPTlNBTVBMSU5HPTIsdC5fRklMVEVSX0JMVVJWQVJJQU5DRVNIQURPV01BUD0zLHR9KCk7ZS5TaGFkb3dHZW5lcmF0b3I9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oZSx0LGkscil7cmV0dXJuIGUueD5pLngrcj8hMTppLngtcj50Lng/ITE6ZS55PmkueStyPyExOmkueS1yPnQueT8hMTplLno+aS56K3I/ITE6IShpLnotcj50LnopfSxpPWZ1bmN0aW9uKGUsdCxpLHIpe3ZhciBuPXQqdC00KmUqaSxvPXtyb290OjAsZm91bmQ6ITF9O2lmKDA+bilyZXR1cm4gbzt2YXIgcz1NYXRoLnNxcnQobiksYT0oLXQtcykvKDIqZSksaD0oLXQrcykvKDIqZSk7aWYoYT5oKXt2YXIgYz1oO2g9YSxhPWN9cmV0dXJuIGE+MCYmcj5hPyhvLnJvb3Q9YSxvLmZvdW5kPSEwLG8pOmg+MCYmcj5oPyhvLnJvb3Q9aCxvLmZvdW5kPSEwLG8pOm99LHI9ZnVuY3Rpb24oKXtmdW5jdGlvbiByKCl7dGhpcy5yYWRpdXM9bmV3IGUuVmVjdG9yMygxLDEsMSksdGhpcy5yZXRyeT0wLHRoaXMuYmFzZVBvaW50V29ybGQ9ZS5WZWN0b3IzLlplcm8oKSx0aGlzLnZlbG9jaXR5V29ybGQ9ZS5WZWN0b3IzLlplcm8oKSx0aGlzLm5vcm1hbGl6ZWRWZWxvY2l0eT1lLlZlY3RvcjMuWmVybygpLHRoaXMuX2NvbGxpc2lvblBvaW50PWUuVmVjdG9yMy5aZXJvKCksdGhpcy5fcGxhbmVJbnRlcnNlY3Rpb25Qb2ludD1lLlZlY3RvcjMuWmVybygpLHRoaXMuX3RlbXBWZWN0b3I9ZS5WZWN0b3IzLlplcm8oKSx0aGlzLl90ZW1wVmVjdG9yMj1lLlZlY3RvcjMuWmVybygpLHRoaXMuX3RlbXBWZWN0b3IzPWUuVmVjdG9yMy5aZXJvKCksdGhpcy5fdGVtcFZlY3RvcjQ9ZS5WZWN0b3IzLlplcm8oKSx0aGlzLl9lZGdlPWUuVmVjdG9yMy5aZXJvKCksdGhpcy5fYmFzZVRvVmVydGV4PWUuVmVjdG9yMy5aZXJvKCksdGhpcy5fZGVzdGluYXRpb25Qb2ludD1lLlZlY3RvcjMuWmVybygpLHRoaXMuX3NsaWRlUGxhbmVOb3JtYWw9ZS5WZWN0b3IzLlplcm8oKSx0aGlzLl9kaXNwbGFjZW1lbnRWZWN0b3I9ZS5WZWN0b3IzLlplcm8oKX1yZXR1cm4gci5wcm90b3R5cGUuX2luaXRpYWxpemU9ZnVuY3Rpb24odCxpLHIpe3RoaXMudmVsb2NpdHk9aSxlLlZlY3RvcjMuTm9ybWFsaXplVG9SZWYoaSx0aGlzLm5vcm1hbGl6ZWRWZWxvY2l0eSksdGhpcy5iYXNlUG9pbnQ9dCx0Lm11bHRpcGx5VG9SZWYodGhpcy5yYWRpdXMsdGhpcy5iYXNlUG9pbnRXb3JsZCksaS5tdWx0aXBseVRvUmVmKHRoaXMucmFkaXVzLHRoaXMudmVsb2NpdHlXb3JsZCksdGhpcy52ZWxvY2l0eVdvcmxkTGVuZ3RoPXRoaXMudmVsb2NpdHlXb3JsZC5sZW5ndGgoKSx0aGlzLmVwc2lsb249cix0aGlzLmNvbGxpc2lvbkZvdW5kPSExfSxyLnByb3RvdHlwZS5fY2hlY2tQb2ludEluVHJpYW5nbGU9ZnVuY3Rpb24odCxpLHIsbixvKXtpLnN1YnRyYWN0VG9SZWYodCx0aGlzLl90ZW1wVmVjdG9yKSxyLnN1YnRyYWN0VG9SZWYodCx0aGlzLl90ZW1wVmVjdG9yMiksZS5WZWN0b3IzLkNyb3NzVG9SZWYodGhpcy5fdGVtcFZlY3Rvcix0aGlzLl90ZW1wVmVjdG9yMix0aGlzLl90ZW1wVmVjdG9yNCk7dmFyIHM9ZS5WZWN0b3IzLkRvdCh0aGlzLl90ZW1wVmVjdG9yNCxvKTtyZXR1cm4gMD5zPyExOihuLnN1YnRyYWN0VG9SZWYodCx0aGlzLl90ZW1wVmVjdG9yMyksZS5WZWN0b3IzLkNyb3NzVG9SZWYodGhpcy5fdGVtcFZlY3RvcjIsdGhpcy5fdGVtcFZlY3RvcjMsdGhpcy5fdGVtcFZlY3RvcjQpLHM9ZS5WZWN0b3IzLkRvdCh0aGlzLl90ZW1wVmVjdG9yNCxvKSwwPnM/ITE6KGUuVmVjdG9yMy5Dcm9zc1RvUmVmKHRoaXMuX3RlbXBWZWN0b3IzLHRoaXMuX3RlbXBWZWN0b3IsdGhpcy5fdGVtcFZlY3RvcjQpLHM9ZS5WZWN0b3IzLkRvdCh0aGlzLl90ZW1wVmVjdG9yNCxvKSxzPj0wKSl9LHIucHJvdG90eXBlLl9jYW5Eb0NvbGxpc2lvbj1mdW5jdGlvbihpLHIsbixvKXt2YXIgcz1lLlZlY3RvcjMuRGlzdGFuY2UodGhpcy5iYXNlUG9pbnRXb3JsZCxpKSxhPU1hdGgubWF4KHRoaXMucmFkaXVzLngsdGhpcy5yYWRpdXMueSx0aGlzLnJhZGl1cy56KTtyZXR1cm4gcz50aGlzLnZlbG9jaXR5V29ybGRMZW5ndGgrYStyPyExOiEhdChuLG8sdGhpcy5iYXNlUG9pbnRXb3JsZCx0aGlzLnZlbG9jaXR5V29ybGRMZW5ndGgrYSl9LHIucHJvdG90eXBlLl90ZXN0VHJpYW5nbGU9ZnVuY3Rpb24odCxyLG4sbyxzLGEpe3ZhciBoLGM9ITE7cnx8KHI9W10pLHJbdF18fChyW3RdPW5ldyBlLlBsYW5lKDAsMCwwLDApLHJbdF0uY29weUZyb21Qb2ludHMobixvLHMpKTt2YXIgbD1yW3RdO2lmKGF8fGwuaXNGcm9udEZhY2luZ1RvKHRoaXMubm9ybWFsaXplZFZlbG9jaXR5LDApKXt2YXIgdT1sLnNpZ25lZERpc3RhbmNlVG8odGhpcy5iYXNlUG9pbnQpLGY9ZS5WZWN0b3IzLkRvdChsLm5vcm1hbCx0aGlzLnZlbG9jaXR5KTtpZigwPT1mKXtpZihNYXRoLmFicyh1KT49MSlyZXR1cm47Yz0hMCxoPTB9ZWxzZXtoPSgtMS11KS9mO3ZhciBkPSgxLXUpL2Y7aWYoaD5kKXt2YXIgcD1kO2Q9aCxoPXB9aWYoaD4xfHwwPmQpcmV0dXJuOzA+aCYmKGg9MCksaD4xJiYoaD0xKX10aGlzLl9jb2xsaXNpb25Qb2ludC5jb3B5RnJvbUZsb2F0cygwLDAsMCk7dmFyIF89ITEsbT0xO2lmKGN8fCh0aGlzLmJhc2VQb2ludC5zdWJ0cmFjdFRvUmVmKGwubm9ybWFsLHRoaXMuX3BsYW5lSW50ZXJzZWN0aW9uUG9pbnQpLHRoaXMudmVsb2NpdHkuc2NhbGVUb1JlZihoLHRoaXMuX3RlbXBWZWN0b3IpLHRoaXMuX3BsYW5lSW50ZXJzZWN0aW9uUG9pbnQuYWRkSW5QbGFjZSh0aGlzLl90ZW1wVmVjdG9yKSx0aGlzLl9jaGVja1BvaW50SW5UcmlhbmdsZSh0aGlzLl9wbGFuZUludGVyc2VjdGlvblBvaW50LG4sbyxzLGwubm9ybWFsKSYmKF89ITAsbT1oLHRoaXMuX2NvbGxpc2lvblBvaW50LmNvcHlGcm9tKHRoaXMuX3BsYW5lSW50ZXJzZWN0aW9uUG9pbnQpKSksIV8pe3ZhciBnPXRoaXMudmVsb2NpdHkubGVuZ3RoU3F1YXJlZCgpLHY9Zzt0aGlzLmJhc2VQb2ludC5zdWJ0cmFjdFRvUmVmKG4sdGhpcy5fdGVtcFZlY3Rvcik7dmFyIHk9MiplLlZlY3RvcjMuRG90KHRoaXMudmVsb2NpdHksdGhpcy5fdGVtcFZlY3RvcikseD10aGlzLl90ZW1wVmVjdG9yLmxlbmd0aFNxdWFyZWQoKS0xLGI9aSh2LHkseCxtKTtiLmZvdW5kJiYobT1iLnJvb3QsXz0hMCx0aGlzLl9jb2xsaXNpb25Qb2ludC5jb3B5RnJvbShuKSksdGhpcy5iYXNlUG9pbnQuc3VidHJhY3RUb1JlZihvLHRoaXMuX3RlbXBWZWN0b3IpLHk9MiplLlZlY3RvcjMuRG90KHRoaXMudmVsb2NpdHksdGhpcy5fdGVtcFZlY3RvcikseD10aGlzLl90ZW1wVmVjdG9yLmxlbmd0aFNxdWFyZWQoKS0xLGI9aSh2LHkseCxtKSxiLmZvdW5kJiYobT1iLnJvb3QsXz0hMCx0aGlzLl9jb2xsaXNpb25Qb2ludC5jb3B5RnJvbShvKSksdGhpcy5iYXNlUG9pbnQuc3VidHJhY3RUb1JlZihzLHRoaXMuX3RlbXBWZWN0b3IpLHk9MiplLlZlY3RvcjMuRG90KHRoaXMudmVsb2NpdHksdGhpcy5fdGVtcFZlY3RvcikseD10aGlzLl90ZW1wVmVjdG9yLmxlbmd0aFNxdWFyZWQoKS0xLGI9aSh2LHkseCxtKSxiLmZvdW5kJiYobT1iLnJvb3QsXz0hMCx0aGlzLl9jb2xsaXNpb25Qb2ludC5jb3B5RnJvbShzKSksby5zdWJ0cmFjdFRvUmVmKG4sdGhpcy5fZWRnZSksbi5zdWJ0cmFjdFRvUmVmKHRoaXMuYmFzZVBvaW50LHRoaXMuX2Jhc2VUb1ZlcnRleCk7dmFyIFA9dGhpcy5fZWRnZS5sZW5ndGhTcXVhcmVkKCksQT1lLlZlY3RvcjMuRG90KHRoaXMuX2VkZ2UsdGhpcy52ZWxvY2l0eSksVD1lLlZlY3RvcjMuRG90KHRoaXMuX2VkZ2UsdGhpcy5fYmFzZVRvVmVydGV4KTtpZih2PVAqLWcrQSpBLHk9UCooMiplLlZlY3RvcjMuRG90KHRoaXMudmVsb2NpdHksdGhpcy5fYmFzZVRvVmVydGV4KSktMipBKlQseD1QKigxLXRoaXMuX2Jhc2VUb1ZlcnRleC5sZW5ndGhTcXVhcmVkKCkpK1QqVCxiPWkodix5LHgsbSksYi5mb3VuZCl7dmFyIEU9KEEqYi5yb290LVQpL1A7RT49MCYmMT49RSYmKG09Yi5yb290LF89ITAsdGhpcy5fZWRnZS5zY2FsZUluUGxhY2UoRSksbi5hZGRUb1JlZih0aGlzLl9lZGdlLHRoaXMuX2NvbGxpc2lvblBvaW50KSl9cy5zdWJ0cmFjdFRvUmVmKG8sdGhpcy5fZWRnZSksby5zdWJ0cmFjdFRvUmVmKHRoaXMuYmFzZVBvaW50LHRoaXMuX2Jhc2VUb1ZlcnRleCksUD10aGlzLl9lZGdlLmxlbmd0aFNxdWFyZWQoKSxBPWUuVmVjdG9yMy5Eb3QodGhpcy5fZWRnZSx0aGlzLnZlbG9jaXR5KSxUPWUuVmVjdG9yMy5Eb3QodGhpcy5fZWRnZSx0aGlzLl9iYXNlVG9WZXJ0ZXgpLHY9UCotZytBKkEseT1QKigyKmUuVmVjdG9yMy5Eb3QodGhpcy52ZWxvY2l0eSx0aGlzLl9iYXNlVG9WZXJ0ZXgpKS0yKkEqVCx4PVAqKDEtdGhpcy5fYmFzZVRvVmVydGV4Lmxlbmd0aFNxdWFyZWQoKSkrVCpULGI9aSh2LHkseCxtKSxiLmZvdW5kJiYoRT0oQSpiLnJvb3QtVCkvUCxFPj0wJiYxPj1FJiYobT1iLnJvb3QsXz0hMCx0aGlzLl9lZGdlLnNjYWxlSW5QbGFjZShFKSxvLmFkZFRvUmVmKHRoaXMuX2VkZ2UsdGhpcy5fY29sbGlzaW9uUG9pbnQpKSksbi5zdWJ0cmFjdFRvUmVmKHMsdGhpcy5fZWRnZSkscy5zdWJ0cmFjdFRvUmVmKHRoaXMuYmFzZVBvaW50LHRoaXMuX2Jhc2VUb1ZlcnRleCksUD10aGlzLl9lZGdlLmxlbmd0aFNxdWFyZWQoKSxBPWUuVmVjdG9yMy5Eb3QodGhpcy5fZWRnZSx0aGlzLnZlbG9jaXR5KSxUPWUuVmVjdG9yMy5Eb3QodGhpcy5fZWRnZSx0aGlzLl9iYXNlVG9WZXJ0ZXgpLHY9UCotZytBKkEseT1QKigyKmUuVmVjdG9yMy5Eb3QodGhpcy52ZWxvY2l0eSx0aGlzLl9iYXNlVG9WZXJ0ZXgpKS0yKkEqVCx4PVAqKDEtdGhpcy5fYmFzZVRvVmVydGV4Lmxlbmd0aFNxdWFyZWQoKSkrVCpULGI9aSh2LHkseCxtKSxiLmZvdW5kJiYoRT0oQSpiLnJvb3QtVCkvUCxFPj0wJiYxPj1FJiYobT1iLnJvb3QsXz0hMCx0aGlzLl9lZGdlLnNjYWxlSW5QbGFjZShFKSxzLmFkZFRvUmVmKHRoaXMuX2VkZ2UsdGhpcy5fY29sbGlzaW9uUG9pbnQpKSl9aWYoXyl7dmFyIEM9bSp0aGlzLnZlbG9jaXR5Lmxlbmd0aCgpOyghdGhpcy5jb2xsaXNpb25Gb3VuZHx8Qzx0aGlzLm5lYXJlc3REaXN0YW5jZSkmJih0aGlzLmludGVyc2VjdGlvblBvaW50P3RoaXMuaW50ZXJzZWN0aW9uUG9pbnQuY29weUZyb20odGhpcy5fY29sbGlzaW9uUG9pbnQpOnRoaXMuaW50ZXJzZWN0aW9uUG9pbnQ9dGhpcy5fY29sbGlzaW9uUG9pbnQuY2xvbmUoKSx0aGlzLm5lYXJlc3REaXN0YW5jZT1DLHRoaXMuY29sbGlzaW9uRm91bmQ9ITApfX19LHIucHJvdG90eXBlLl9jb2xsaWRlPWZ1bmN0aW9uKGUsdCxpLHIsbixvLHMpe2Zvcih2YXIgYT1yO24+YTthKz0zKXt2YXIgaD10W2lbYV0tb10sYz10W2lbYSsxXS1vXSxsPXRbaVthKzJdLW9dO3RoaXMuX3Rlc3RUcmlhbmdsZShhLGUsbCxjLGgscyl9fSxyLnByb3RvdHlwZS5fZ2V0UmVzcG9uc2U9ZnVuY3Rpb24odCxpKXt0LmFkZFRvUmVmKGksdGhpcy5fZGVzdGluYXRpb25Qb2ludCksaS5zY2FsZUluUGxhY2UodGhpcy5uZWFyZXN0RGlzdGFuY2UvaS5sZW5ndGgoKSksdGhpcy5iYXNlUG9pbnQuYWRkVG9SZWYoaSx0KSx0LnN1YnRyYWN0VG9SZWYodGhpcy5pbnRlcnNlY3Rpb25Qb2ludCx0aGlzLl9zbGlkZVBsYW5lTm9ybWFsKSx0aGlzLl9zbGlkZVBsYW5lTm9ybWFsLm5vcm1hbGl6ZSgpLHRoaXMuX3NsaWRlUGxhbmVOb3JtYWwuc2NhbGVUb1JlZih0aGlzLmVwc2lsb24sdGhpcy5fZGlzcGxhY2VtZW50VmVjdG9yKSx0LmFkZEluUGxhY2UodGhpcy5fZGlzcGxhY2VtZW50VmVjdG9yKSx0aGlzLmludGVyc2VjdGlvblBvaW50LmFkZEluUGxhY2UodGhpcy5fZGlzcGxhY2VtZW50VmVjdG9yKSx0aGlzLl9zbGlkZVBsYW5lTm9ybWFsLnNjYWxlSW5QbGFjZShlLlBsYW5lLlNpZ25lZERpc3RhbmNlVG9QbGFuZUZyb21Qb3NpdGlvbkFuZE5vcm1hbCh0aGlzLmludGVyc2VjdGlvblBvaW50LHRoaXMuX3NsaWRlUGxhbmVOb3JtYWwsdGhpcy5fZGVzdGluYXRpb25Qb2ludCkpLHRoaXMuX2Rlc3RpbmF0aW9uUG9pbnQuc3VidHJhY3RJblBsYWNlKHRoaXMuX3NsaWRlUGxhbmVOb3JtYWwpLHRoaXMuX2Rlc3RpbmF0aW9uUG9pbnQuc3VidHJhY3RUb1JlZih0aGlzLmludGVyc2VjdGlvblBvaW50LGkpfSxyfSgpO2UuQ29sbGlkZXI9cn0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7ZS5Db2xsaXNpb25Xb3JrZXI9XCJcIixmdW5jdGlvbihlKXtlW2UuSU5JVD0wXT1cIklOSVRcIixlW2UuVVBEQVRFPTFdPVwiVVBEQVRFXCIsZVtlLkNPTExJREU9Ml09XCJDT0xMSURFXCJ9KGUuV29ya2VyVGFza1R5cGV8fChlLldvcmtlclRhc2tUeXBlPXt9KSk7dmFyIHQ9ZS5Xb3JrZXJUYXNrVHlwZTshZnVuY3Rpb24oZSl7ZVtlLlNVQ0NFU1M9MF09XCJTVUNDRVNTXCIsZVtlLlVOS05PV05fRVJST1I9MV09XCJVTktOT1dOX0VSUk9SXCJ9KGUuV29ya2VyUmVwbHlUeXBlfHwoZS5Xb3JrZXJSZXBseVR5cGU9e30pKTt2YXIgaT1lLldvcmtlclJlcGx5VHlwZSxyPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gcigpe3ZhciBuPXRoaXM7dGhpcy5fc2NhbGVkUG9zaXRpb249ZS5WZWN0b3IzLlplcm8oKSx0aGlzLl9zY2FsZWRWZWxvY2l0eT1lLlZlY3RvcjMuWmVybygpLHRoaXMub25NZXNoVXBkYXRlZD1mdW5jdGlvbihlKXtuLl9hZGRVcGRhdGVNZXNoZXNMaXN0W2UudW5pcXVlSWRdPXIuU2VyaWFsaXplTWVzaChlKX0sdGhpcy5vbkdlb21ldHJ5VXBkYXRlZD1mdW5jdGlvbihlKXtuLl9hZGRVcGRhdGVHZW9tZXRyaWVzTGlzdFtlLmlkXT1yLlNlcmlhbGl6ZUdlb21ldHJ5KGUpfSx0aGlzLl9hZnRlclJlbmRlcj1mdW5jdGlvbigpe2lmKG4uX2luaXQmJiEoMD09bi5fdG9SZW1vdmVHZW9tZXRyeUFycmF5Lmxlbmd0aCYmMD09bi5fdG9SZW1vdmVNZXNoZXNBcnJheS5sZW5ndGgmJjA9PU9iamVjdC5rZXlzKG4uX2FkZFVwZGF0ZUdlb21ldHJpZXNMaXN0KS5sZW5ndGgmJjA9PU9iamVjdC5rZXlzKG4uX2FkZFVwZGF0ZU1lc2hlc0xpc3QpLmxlbmd0aHx8bi5fcnVubmluZ1VwZGF0ZWQ+NCkpeysrbi5fcnVubmluZ1VwZGF0ZWQ7dmFyIGU9e3VwZGF0ZWRNZXNoZXM6bi5fYWRkVXBkYXRlTWVzaGVzTGlzdCx1cGRhdGVkR2VvbWV0cmllczpuLl9hZGRVcGRhdGVHZW9tZXRyaWVzTGlzdCxyZW1vdmVkR2VvbWV0cmllczpuLl90b1JlbW92ZUdlb21ldHJ5QXJyYXkscmVtb3ZlZE1lc2hlczpuLl90b1JlbW92ZU1lc2hlc0FycmF5fSxpPXtwYXlsb2FkOmUsdGFza1R5cGU6dC5VUERBVEV9LHI9W107Zm9yKHZhciBvIGluIGUudXBkYXRlZEdlb21ldHJpZXMpZS51cGRhdGVkR2VvbWV0cmllcy5oYXNPd25Qcm9wZXJ0eShvKSYmKHIucHVzaChpLnBheWxvYWQudXBkYXRlZEdlb21ldHJpZXNbb10uaW5kaWNlcy5idWZmZXIpLHIucHVzaChpLnBheWxvYWQudXBkYXRlZEdlb21ldHJpZXNbb10ubm9ybWFscy5idWZmZXIpLHIucHVzaChpLnBheWxvYWQudXBkYXRlZEdlb21ldHJpZXNbb10ucG9zaXRpb25zLmJ1ZmZlcikpO24uX3dvcmtlci5wb3N0TWVzc2FnZShpLHIpLG4uX2FkZFVwZGF0ZU1lc2hlc0xpc3Q9e30sbi5fYWRkVXBkYXRlR2VvbWV0cmllc0xpc3Q9e30sbi5fdG9SZW1vdmVHZW9tZXRyeUFycmF5PVtdLG4uX3RvUmVtb3ZlTWVzaGVzQXJyYXk9W119fSx0aGlzLl9vbk1lc3NhZ2VGcm9tV29ya2VyPWZ1bmN0aW9uKHIpe3ZhciBvPXIuZGF0YTtpZihvLmVycm9yIT1pLlNVQ0NFU1MpcmV0dXJuIHZvaWQgZS5Ub29scy5XYXJuKFwiZXJyb3IgcmV0dXJuZWQgZnJvbSB3b3JrZXIhXCIpO3N3aXRjaChvLnRhc2tUeXBlKXtjYXNlIHQuSU5JVDpuLl9pbml0PSEwLG4uX3NjZW5lLm1lc2hlcy5mb3JFYWNoKGZ1bmN0aW9uKGUpe24ub25NZXNoQWRkZWQoZSl9KSxuLl9zY2VuZS5nZXRHZW9tZXRyaWVzKCkuZm9yRWFjaChmdW5jdGlvbihlKXtuLm9uR2VvbWV0cnlBZGRlZChlKX0pO2JyZWFrO2Nhc2UgdC5VUERBVEU6bi5fcnVubmluZ1VwZGF0ZWQtLTticmVhaztjYXNlIHQuQ09MTElERTpuLl9ydW5uaW5nQ29sbGlzaW9uVGFzaz0hMTt2YXIgcz1vLnBheWxvYWQ7aWYoIW4uX2NvbGxpc2lvbnNDYWxsYmFja0FycmF5W3MuY29sbGlzaW9uSWRdKXJldHVybjtuLl9jb2xsaXNpb25zQ2FsbGJhY2tBcnJheVtzLmNvbGxpc2lvbklkXShzLmNvbGxpc2lvbklkLGUuVmVjdG9yMy5Gcm9tQXJyYXkocy5uZXdQb3NpdGlvbiksbi5fc2NlbmUuZ2V0TWVzaEJ5VW5pcXVlSUQocy5jb2xsaWRlZE1lc2hVbmlxdWVJZCkpLG4uX2NvbGxpc2lvbnNDYWxsYmFja0FycmF5W3MuY29sbGlzaW9uSWRdPXZvaWQgMH19LHRoaXMuX2NvbGxpc2lvbnNDYWxsYmFja0FycmF5PVtdLHRoaXMuX2luaXQ9ITEsdGhpcy5fcnVubmluZ1VwZGF0ZWQ9MCx0aGlzLl9ydW5uaW5nQ29sbGlzaW9uVGFzaz0hMSx0aGlzLl9hZGRVcGRhdGVNZXNoZXNMaXN0PXt9LHRoaXMuX2FkZFVwZGF0ZUdlb21ldHJpZXNMaXN0PXt9LHRoaXMuX3RvUmVtb3ZlR2VvbWV0cnlBcnJheT1bXSx0aGlzLl90b1JlbW92ZU1lc2hlc0FycmF5PVtdfXJldHVybiByLnByb3RvdHlwZS5nZXROZXdQb3NpdGlvbj1mdW5jdGlvbihlLGkscixuLG8scyxhKXtpZih0aGlzLl9pbml0JiYhdGhpcy5fY29sbGlzaW9uc0NhbGxiYWNrQXJyYXlbYV0mJiF0aGlzLl9jb2xsaXNpb25zQ2FsbGJhY2tBcnJheVthKzFlNV0pe2UuZGl2aWRlVG9SZWYoci5yYWRpdXMsdGhpcy5fc2NhbGVkUG9zaXRpb24pLGkuZGl2aWRlVG9SZWYoci5yYWRpdXMsdGhpcy5fc2NhbGVkVmVsb2NpdHkpLHRoaXMuX2NvbGxpc2lvbnNDYWxsYmFja0FycmF5W2FdPXM7dmFyIGg9e2NvbGxpZGVyOntwb3NpdGlvbjp0aGlzLl9zY2FsZWRQb3NpdGlvbi5hc0FycmF5KCksdmVsb2NpdHk6dGhpcy5fc2NhbGVkVmVsb2NpdHkuYXNBcnJheSgpLHJhZGl1czpyLnJhZGl1cy5hc0FycmF5KCl9LGNvbGxpc2lvbklkOmEsZXhjbHVkZWRNZXNoVW5pcXVlSWQ6bz9vLnVuaXF1ZUlkOm51bGwsbWF4aW11bVJldHJ5Om59LGM9e3BheWxvYWQ6aCx0YXNrVHlwZTp0LkNPTExJREV9O3RoaXMuX3dvcmtlci5wb3N0TWVzc2FnZShjKX19LHIucHJvdG90eXBlLmluaXQ9ZnVuY3Rpb24oaSl7dGhpcy5fc2NlbmU9aSx0aGlzLl9zY2VuZS5yZWdpc3RlckFmdGVyUmVuZGVyKHRoaXMuX2FmdGVyUmVuZGVyKTt2YXIgcj1lLldvcmtlckluY2x1ZGVkP2UuRW5naW5lLkNvZGVSZXBvc2l0b3J5K1wiQ29sbGlzaW9ucy9iYWJ5bG9uLmNvbGxpc2lvbldvcmtlci5qc1wiOlVSTC5jcmVhdGVPYmplY3RVUkwobmV3IEJsb2IoW2UuQ29sbGlzaW9uV29ya2VyXSx7dHlwZTpcImFwcGxpY2F0aW9uL2phdmFzY3JpcHRcIn0pKTt0aGlzLl93b3JrZXI9bmV3IFdvcmtlcihyKSx0aGlzLl93b3JrZXIub25tZXNzYWdlPXRoaXMuX29uTWVzc2FnZUZyb21Xb3JrZXI7dmFyIG49e3BheWxvYWQ6e30sdGFza1R5cGU6dC5JTklUfTt0aGlzLl93b3JrZXIucG9zdE1lc3NhZ2Uobil9LHIucHJvdG90eXBlLmRlc3Ryb3k9ZnVuY3Rpb24oKXt0aGlzLl9zY2VuZS51bnJlZ2lzdGVyQWZ0ZXJSZW5kZXIodGhpcy5fYWZ0ZXJSZW5kZXIpLHRoaXMuX3dvcmtlci50ZXJtaW5hdGUoKX0sci5wcm90b3R5cGUub25NZXNoQWRkZWQ9ZnVuY3Rpb24oZSl7ZS5yZWdpc3RlckFmdGVyV29ybGRNYXRyaXhVcGRhdGUodGhpcy5vbk1lc2hVcGRhdGVkKSx0aGlzLm9uTWVzaFVwZGF0ZWQoZSl9LHIucHJvdG90eXBlLm9uTWVzaFJlbW92ZWQ9ZnVuY3Rpb24oZSl7dGhpcy5fdG9SZW1vdmVNZXNoZXNBcnJheS5wdXNoKGUudW5pcXVlSWQpfSxyLnByb3RvdHlwZS5vbkdlb21ldHJ5QWRkZWQ9ZnVuY3Rpb24oZSl7ZS5vbkdlb21ldHJ5VXBkYXRlZD10aGlzLm9uR2VvbWV0cnlVcGRhdGVkLHRoaXMub25HZW9tZXRyeVVwZGF0ZWQoZSl9LHIucHJvdG90eXBlLm9uR2VvbWV0cnlEZWxldGVkPWZ1bmN0aW9uKGUpe3RoaXMuX3RvUmVtb3ZlR2VvbWV0cnlBcnJheS5wdXNoKGUuaWQpfSxyLlNlcmlhbGl6ZU1lc2g9ZnVuY3Rpb24odCl7dmFyIGk9W107dC5zdWJNZXNoZXMmJihpPXQuc3ViTWVzaGVzLm1hcChmdW5jdGlvbihlLHQpe3JldHVybntwb3NpdGlvbjp0LHZlcnRpY2VzU3RhcnQ6ZS52ZXJ0aWNlc1N0YXJ0LHZlcnRpY2VzQ291bnQ6ZS52ZXJ0aWNlc0NvdW50LGluZGV4U3RhcnQ6ZS5pbmRleFN0YXJ0LGluZGV4Q291bnQ6ZS5pbmRleENvdW50LGhhc01hdGVyaWFsOiEhZS5nZXRNYXRlcmlhbCgpLHNwaGVyZUNlbnRlcjplLmdldEJvdW5kaW5nSW5mbygpLmJvdW5kaW5nU3BoZXJlLmNlbnRlcldvcmxkLmFzQXJyYXkoKSxzcGhlcmVSYWRpdXM6ZS5nZXRCb3VuZGluZ0luZm8oKS5ib3VuZGluZ1NwaGVyZS5yYWRpdXNXb3JsZCxib3hNaW5pbXVtOmUuZ2V0Qm91bmRpbmdJbmZvKCkuYm91bmRpbmdCb3gubWluaW11bVdvcmxkLmFzQXJyYXkoKSxib3hNYXhpbXVtOmUuZ2V0Qm91bmRpbmdJbmZvKCkuYm91bmRpbmdCb3gubWF4aW11bVdvcmxkLmFzQXJyYXkoKX19KSk7dmFyIHI9bnVsbDtyZXR1cm4gdCBpbnN0YW5jZW9mIGUuTWVzaD9yPXQuZ2VvbWV0cnk/dC5nZW9tZXRyeS5pZDpudWxsOnQgaW5zdGFuY2VvZiBlLkluc3RhbmNlZE1lc2gmJihyPXQuc291cmNlTWVzaCYmdC5zb3VyY2VNZXNoLmdlb21ldHJ5P3Quc291cmNlTWVzaC5nZW9tZXRyeS5pZDpudWxsKSx7dW5pcXVlSWQ6dC51bmlxdWVJZCxpZDp0LmlkLG5hbWU6dC5uYW1lLGdlb21ldHJ5SWQ6cixzcGhlcmVDZW50ZXI6dC5nZXRCb3VuZGluZ0luZm8oKS5ib3VuZGluZ1NwaGVyZS5jZW50ZXJXb3JsZC5hc0FycmF5KCksc3BoZXJlUmFkaXVzOnQuZ2V0Qm91bmRpbmdJbmZvKCkuYm91bmRpbmdTcGhlcmUucmFkaXVzV29ybGQsYm94TWluaW11bTp0LmdldEJvdW5kaW5nSW5mbygpLmJvdW5kaW5nQm94Lm1pbmltdW1Xb3JsZC5hc0FycmF5KCksYm94TWF4aW11bTp0LmdldEJvdW5kaW5nSW5mbygpLmJvdW5kaW5nQm94Lm1heGltdW1Xb3JsZC5hc0FycmF5KCksd29ybGRNYXRyaXhGcm9tQ2FjaGU6dC53b3JsZE1hdHJpeEZyb21DYWNoZS5hc0FycmF5KCksc3ViTWVzaGVzOmksY2hlY2tDb2xsaXNpb25zOnQuY2hlY2tDb2xsaXNpb25zfX0sci5TZXJpYWxpemVHZW9tZXRyeT1mdW5jdGlvbih0KXtyZXR1cm57aWQ6dC5pZCxwb3NpdGlvbnM6bmV3IEZsb2F0MzJBcnJheSh0LmdldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5Qb3NpdGlvbktpbmQpfHxbXSksbm9ybWFsczpuZXcgRmxvYXQzMkFycmF5KHQuZ2V0VmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLk5vcm1hbEtpbmQpfHxbXSksaW5kaWNlczpuZXcgSW50MzJBcnJheSh0LmdldEluZGljZXMoKXx8W10pfX0scn0oKTtlLkNvbGxpc2lvbkNvb3JkaW5hdG9yV29ya2VyPXI7dmFyIG49ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KCl7dGhpcy5fc2NhbGVkUG9zaXRpb249ZS5WZWN0b3IzLlplcm8oKSx0aGlzLl9zY2FsZWRWZWxvY2l0eT1lLlZlY3RvcjMuWmVybygpLHRoaXMuX2ZpbmFsUG9zaXRpb249ZS5WZWN0b3IzLlplcm8oKX1yZXR1cm4gdC5wcm90b3R5cGUuZ2V0TmV3UG9zaXRpb249ZnVuY3Rpb24oZSx0LGkscixuLG8scyl7ZS5kaXZpZGVUb1JlZihpLnJhZGl1cyx0aGlzLl9zY2FsZWRQb3NpdGlvbiksdC5kaXZpZGVUb1JlZihpLnJhZGl1cyx0aGlzLl9zY2FsZWRWZWxvY2l0eSksaS5jb2xsaWRlZE1lc2g9bnVsbCxpLnJldHJ5PTAsaS5pbml0aWFsVmVsb2NpdHk9dGhpcy5fc2NhbGVkVmVsb2NpdHksaS5pbml0aWFsUG9zaXRpb249dGhpcy5fc2NhbGVkUG9zaXRpb24sdGhpcy5fY29sbGlkZVdpdGhXb3JsZCh0aGlzLl9zY2FsZWRQb3NpdGlvbix0aGlzLl9zY2FsZWRWZWxvY2l0eSxpLHIsdGhpcy5fZmluYWxQb3NpdGlvbixuKSx0aGlzLl9maW5hbFBvc2l0aW9uLm11bHRpcGx5SW5QbGFjZShpLnJhZGl1cyksbyhzLHRoaXMuX2ZpbmFsUG9zaXRpb24saS5jb2xsaWRlZE1lc2gpfSx0LnByb3RvdHlwZS5pbml0PWZ1bmN0aW9uKGUpe3RoaXMuX3NjZW5lPWV9LHQucHJvdG90eXBlLmRlc3Ryb3k9ZnVuY3Rpb24oKXt9LHQucHJvdG90eXBlLm9uTWVzaEFkZGVkPWZ1bmN0aW9uKGUpe30sdC5wcm90b3R5cGUub25NZXNoVXBkYXRlZD1mdW5jdGlvbihlKXt9LHQucHJvdG90eXBlLm9uTWVzaFJlbW92ZWQ9ZnVuY3Rpb24oZSl7fSx0LnByb3RvdHlwZS5vbkdlb21ldHJ5QWRkZWQ9ZnVuY3Rpb24oZSl7fSx0LnByb3RvdHlwZS5vbkdlb21ldHJ5VXBkYXRlZD1mdW5jdGlvbihlKXt9LHQucHJvdG90eXBlLm9uR2VvbWV0cnlEZWxldGVkPWZ1bmN0aW9uKGUpe30sdC5wcm90b3R5cGUuX2NvbGxpZGVXaXRoV29ybGQ9ZnVuY3Rpb24odCxpLHIsbixvLHMpe3ZvaWQgMD09PXMmJihzPW51bGwpO3ZhciBhPTEwKmUuRW5naW5lLkNvbGxpc2lvbnNFcHNpbG9uO2lmKHIucmV0cnk+PW4pcmV0dXJuIHZvaWQgby5jb3B5RnJvbSh0KTtyLl9pbml0aWFsaXplKHQsaSxhKTtmb3IodmFyIGg9MDtoPHRoaXMuX3NjZW5lLm1lc2hlcy5sZW5ndGg7aCsrKXt2YXIgYz10aGlzLl9zY2VuZS5tZXNoZXNbaF07Yy5pc0VuYWJsZWQoKSYmYy5jaGVja0NvbGxpc2lvbnMmJmMuc3ViTWVzaGVzJiZjIT09cyYmYy5fY2hlY2tDb2xsaXNpb24ocil9cmV0dXJuIHIuY29sbGlzaW9uRm91bmQ/KDA9PT1pLngmJjA9PT1pLnkmJjA9PT1pLnp8fHIuX2dldFJlc3BvbnNlKHQsaSksaS5sZW5ndGgoKTw9YT92b2lkIG8uY29weUZyb20odCk6KHIucmV0cnkrKyx2b2lkIHRoaXMuX2NvbGxpZGVXaXRoV29ybGQodCxpLHIsbixvLHMpKSk6dm9pZCB0LmFkZFRvUmVmKGksbyl9LHR9KCk7ZS5Db2xsaXNpb25Db29yZGluYXRvckxlZ2FjeT1ufShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbih0KXtmdW5jdGlvbiBpKHIsbixvKXt0LmNhbGwodGhpcyxyLG8pLHRoaXMudXBWZWN0b3I9ZS5WZWN0b3IzLlVwKCksdGhpcy5vcnRob0xlZnQ9bnVsbCx0aGlzLm9ydGhvUmlnaHQ9bnVsbCx0aGlzLm9ydGhvQm90dG9tPW51bGwsdGhpcy5vcnRob1RvcD1udWxsLHRoaXMuZm92PS44LHRoaXMubWluWj0xLHRoaXMubWF4Wj0xZTQsdGhpcy5pbmVydGlhPS45LHRoaXMubW9kZT1pLlBFUlNQRUNUSVZFX0NBTUVSQSx0aGlzLmlzSW50ZXJtZWRpYXRlPSExLHRoaXMudmlld3BvcnQ9bmV3IGUuVmlld3BvcnQoMCwwLDEsMSksdGhpcy5sYXllck1hc2s9MjY4NDM1NDU1LHRoaXMuZm92TW9kZT1pLkZPVk1PREVfVkVSVElDQUxfRklYRUQsdGhpcy5jYW1lcmFSaWdNb2RlPWkuUklHX01PREVfTk9ORSx0aGlzLl9yaWdDYW1lcmFzPW5ldyBBcnJheSx0aGlzLl9jb21wdXRlZFZpZXdNYXRyaXg9ZS5NYXRyaXguSWRlbnRpdHkoKSx0aGlzLl9wcm9qZWN0aW9uTWF0cml4PW5ldyBlLk1hdHJpeCx0aGlzLl9wb3N0UHJvY2Vzc2VzPW5ldyBBcnJheSx0aGlzLl9hY3RpdmVNZXNoZXM9bmV3IGUuU21hcnRBcnJheSgyNTYpLHRoaXMuX2dsb2JhbFBvc2l0aW9uPWUuVmVjdG9yMy5aZXJvKCksby5hZGRDYW1lcmEodGhpcyksby5hY3RpdmVDYW1lcmF8fChvLmFjdGl2ZUNhbWVyYT10aGlzKSx0aGlzLnBvc2l0aW9uPW59cmV0dXJuIF9fZXh0ZW5kcyhpLHQpLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLFwiUEVSU1BFQ1RJVkVfQ0FNRVJBXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBpLl9QRVJTUEVDVElWRV9DQU1FUkF9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGksXCJPUlRIT0dSQVBISUNfQ0FNRVJBXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBpLl9PUlRIT0dSQVBISUNfQ0FNRVJBfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLFwiRk9WTU9ERV9WRVJUSUNBTF9GSVhFRFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gaS5fRk9WTU9ERV9WRVJUSUNBTF9GSVhFRH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaSxcIkZPVk1PREVfSE9SSVpPTlRBTF9GSVhFRFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gaS5fRk9WTU9ERV9IT1JJWk9OVEFMX0ZJWEVEfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLFwiUklHX01PREVfTk9ORVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gaS5fUklHX01PREVfTk9ORX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaSxcIlJJR19NT0RFX1NURVJFT1NDT1BJQ19BTkFHTFlQSFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gaS5fUklHX01PREVfU1RFUkVPU0NPUElDX0FOQUdMWVBIfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLFwiUklHX01PREVfU1RFUkVPU0NPUElDX1NJREVCWVNJREVfUEFSQUxMRUxcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGkuX1JJR19NT0RFX1NURVJFT1NDT1BJQ19TSURFQllTSURFX1BBUkFMTEVMfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLFwiUklHX01PREVfU1RFUkVPU0NPUElDX1NJREVCWVNJREVfQ1JPU1NFWUVEXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBpLl9SSUdfTU9ERV9TVEVSRU9TQ09QSUNfU0lERUJZU0lERV9DUk9TU0VZRUR9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGksXCJSSUdfTU9ERV9TVEVSRU9TQ09QSUNfT1ZFUlVOREVSXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBpLl9SSUdfTU9ERV9TVEVSRU9TQ09QSUNfT1ZFUlVOREVSfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLFwiUklHX01PREVfVlJcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGkuX1JJR19NT0RFX1ZSfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLGkucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKGUpe3ZhciB0PVwiTmFtZTogXCIrdGhpcy5uYW1lO2lmKHQrPVwiLCB0eXBlOiBcIit0aGlzLmdldFR5cGVOYW1lKCksdGhpcy5hbmltYXRpb25zKWZvcih2YXIgaT0wO2k8dGhpcy5hbmltYXRpb25zLmxlbmd0aDtpKyspdCs9XCIsIGFuaW1hdGlvblswXTogXCIrdGhpcy5hbmltYXRpb25zW2ldLnRvU3RyaW5nKGUpO3JldHVybiB0fSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJnbG9iYWxQb3NpdGlvblwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZ2xvYmFsUG9zaXRpb259LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksaS5wcm90b3R5cGUuZ2V0QWN0aXZlTWVzaGVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2FjdGl2ZU1lc2hlc30saS5wcm90b3R5cGUuaXNBY3RpdmVNZXNoPWZ1bmN0aW9uKGUpe3JldHVybi0xIT09dGhpcy5fYWN0aXZlTWVzaGVzLmluZGV4T2YoZSl9LGkucHJvdG90eXBlLl9pbml0Q2FjaGU9ZnVuY3Rpb24oKXt0LnByb3RvdHlwZS5faW5pdENhY2hlLmNhbGwodGhpcyksdGhpcy5fY2FjaGUucG9zaXRpb249bmV3IGUuVmVjdG9yMyhOdW1iZXIuTUFYX1ZBTFVFLE51bWJlci5NQVhfVkFMVUUsTnVtYmVyLk1BWF9WQUxVRSksdGhpcy5fY2FjaGUudXBWZWN0b3I9bmV3IGUuVmVjdG9yMyhOdW1iZXIuTUFYX1ZBTFVFLE51bWJlci5NQVhfVkFMVUUsTnVtYmVyLk1BWF9WQUxVRSksdGhpcy5fY2FjaGUubW9kZT12b2lkIDAsdGhpcy5fY2FjaGUubWluWj12b2lkIDAsdGhpcy5fY2FjaGUubWF4Wj12b2lkIDAsdGhpcy5fY2FjaGUuZm92PXZvaWQgMCx0aGlzLl9jYWNoZS5hc3BlY3RSYXRpbz12b2lkIDAsdGhpcy5fY2FjaGUub3J0aG9MZWZ0PXZvaWQgMCx0aGlzLl9jYWNoZS5vcnRob1JpZ2h0PXZvaWQgMCx0aGlzLl9jYWNoZS5vcnRob0JvdHRvbT12b2lkIDAsdGhpcy5fY2FjaGUub3J0aG9Ub3A9dm9pZCAwLHRoaXMuX2NhY2hlLnJlbmRlcldpZHRoPXZvaWQgMCx0aGlzLl9jYWNoZS5yZW5kZXJIZWlnaHQ9dm9pZCAwfSxpLnByb3RvdHlwZS5fdXBkYXRlQ2FjaGU9ZnVuY3Rpb24oZSl7ZXx8dC5wcm90b3R5cGUuX3VwZGF0ZUNhY2hlLmNhbGwodGhpcyk7dmFyIGk9dGhpcy5nZXRFbmdpbmUoKTt0aGlzLl9jYWNoZS5wb3NpdGlvbi5jb3B5RnJvbSh0aGlzLnBvc2l0aW9uKSx0aGlzLl9jYWNoZS51cFZlY3Rvci5jb3B5RnJvbSh0aGlzLnVwVmVjdG9yKSx0aGlzLl9jYWNoZS5tb2RlPXRoaXMubW9kZSx0aGlzLl9jYWNoZS5taW5aPXRoaXMubWluWix0aGlzLl9jYWNoZS5tYXhaPXRoaXMubWF4Wix0aGlzLl9jYWNoZS5mb3Y9dGhpcy5mb3YsdGhpcy5fY2FjaGUuYXNwZWN0UmF0aW89aS5nZXRBc3BlY3RSYXRpbyh0aGlzKSx0aGlzLl9jYWNoZS5vcnRob0xlZnQ9dGhpcy5vcnRob0xlZnQsdGhpcy5fY2FjaGUub3J0aG9SaWdodD10aGlzLm9ydGhvUmlnaHQsdGhpcy5fY2FjaGUub3J0aG9Cb3R0b209dGhpcy5vcnRob0JvdHRvbSx0aGlzLl9jYWNoZS5vcnRob1RvcD10aGlzLm9ydGhvVG9wLHRoaXMuX2NhY2hlLnJlbmRlcldpZHRoPWkuZ2V0UmVuZGVyV2lkdGgoKSx0aGlzLl9jYWNoZS5yZW5kZXJIZWlnaHQ9aS5nZXRSZW5kZXJIZWlnaHQoKX0saS5wcm90b3R5cGUuX3VwZGF0ZUZyb21TY2VuZT1mdW5jdGlvbigpe3RoaXMudXBkYXRlQ2FjaGUoKSx0aGlzLl91cGRhdGUoKX0saS5wcm90b3R5cGUuX2lzU3luY2hyb25pemVkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lzU3luY2hyb25pemVkVmlld01hdHJpeCgpJiZ0aGlzLl9pc1N5bmNocm9uaXplZFByb2plY3Rpb25NYXRyaXgoKX0saS5wcm90b3R5cGUuX2lzU3luY2hyb25pemVkVmlld01hdHJpeD1mdW5jdGlvbigpe3JldHVybiB0LnByb3RvdHlwZS5faXNTeW5jaHJvbml6ZWQuY2FsbCh0aGlzKT90aGlzLl9jYWNoZS5wb3NpdGlvbi5lcXVhbHModGhpcy5wb3NpdGlvbikmJnRoaXMuX2NhY2hlLnVwVmVjdG9yLmVxdWFscyh0aGlzLnVwVmVjdG9yKSYmdGhpcy5pc1N5bmNocm9uaXplZFdpdGhQYXJlbnQoKTohMX0saS5wcm90b3R5cGUuX2lzU3luY2hyb25pemVkUHJvamVjdGlvbk1hdHJpeD1mdW5jdGlvbigpe3ZhciBlPXRoaXMuX2NhY2hlLm1vZGU9PT10aGlzLm1vZGUmJnRoaXMuX2NhY2hlLm1pblo9PT10aGlzLm1pblomJnRoaXMuX2NhY2hlLm1heFo9PT10aGlzLm1heFo7aWYoIWUpcmV0dXJuITE7dmFyIHQ9dGhpcy5nZXRFbmdpbmUoKTtyZXR1cm4gZT10aGlzLm1vZGU9PT1pLlBFUlNQRUNUSVZFX0NBTUVSQT90aGlzLl9jYWNoZS5mb3Y9PT10aGlzLmZvdiYmdGhpcy5fY2FjaGUuYXNwZWN0UmF0aW89PT10LmdldEFzcGVjdFJhdGlvKHRoaXMpOnRoaXMuX2NhY2hlLm9ydGhvTGVmdD09PXRoaXMub3J0aG9MZWZ0JiZ0aGlzLl9jYWNoZS5vcnRob1JpZ2h0PT09dGhpcy5vcnRob1JpZ2h0JiZ0aGlzLl9jYWNoZS5vcnRob0JvdHRvbT09PXRoaXMub3J0aG9Cb3R0b20mJnRoaXMuX2NhY2hlLm9ydGhvVG9wPT09dGhpcy5vcnRob1RvcCYmdGhpcy5fY2FjaGUucmVuZGVyV2lkdGg9PT10LmdldFJlbmRlcldpZHRoKCkmJnRoaXMuX2NhY2hlLnJlbmRlckhlaWdodD09PXQuZ2V0UmVuZGVySGVpZ2h0KCl9LGkucHJvdG90eXBlLmF0dGFjaENvbnRyb2w9ZnVuY3Rpb24oZSx0KXt9LGkucHJvdG90eXBlLmRldGFjaENvbnRyb2w9ZnVuY3Rpb24oZSl7fSxpLnByb3RvdHlwZS5fdXBkYXRlPWZ1bmN0aW9uKCl7dGhpcy5jYW1lcmFSaWdNb2RlIT09aS5SSUdfTU9ERV9OT05FJiZ0aGlzLl91cGRhdGVSaWdDYW1lcmFzKCksdGhpcy5fY2hlY2tJbnB1dHMoKX0saS5wcm90b3R5cGUuX2NoZWNrSW5wdXRzPWZ1bmN0aW9uKCl7fSxpLnByb3RvdHlwZS5fY2FzY2FkZVBvc3RQcm9jZXNzZXNUb1JpZ0NhbXM9ZnVuY3Rpb24oKXt0aGlzLl9wb3N0UHJvY2Vzc2VzLmxlbmd0aD4wJiZ0aGlzLl9wb3N0UHJvY2Vzc2VzWzBdLm1hcmtUZXh0dXJlRGlydHkoKTtmb3IodmFyIHQ9MCxpPXRoaXMuX3JpZ0NhbWVyYXMubGVuZ3RoO2k+dDt0Kyspe3ZhciByPXRoaXMuX3JpZ0NhbWVyYXNbdF0sbj1yLl9yaWdQb3N0UHJvY2VzcztpZihuKXt2YXIgbz1uIGluc3RhbmNlb2YgZS5QYXNzUG9zdFByb2Nlc3M7byYmKHIuaXNJbnRlcm1lZGlhdGU9MD09PXRoaXMuX3Bvc3RQcm9jZXNzZXMubGVuZ3RoKSxyLl9wb3N0UHJvY2Vzc2VzPXRoaXMuX3Bvc3RQcm9jZXNzZXMuc2xpY2UoMCkuY29uY2F0KG4pLG4ubWFya1RleHR1cmVEaXJ0eSgpfWVsc2Ugci5fcG9zdFByb2Nlc3Nlcz10aGlzLl9wb3N0UHJvY2Vzc2VzLnNsaWNlKDApfX0saS5wcm90b3R5cGUuYXR0YWNoUG9zdFByb2Nlc3M9ZnVuY3Rpb24odCxpKXtyZXR1cm4gdm9pZCAwPT09aSYmKGk9bnVsbCksIXQuaXNSZXVzYWJsZSgpJiZ0aGlzLl9wb3N0UHJvY2Vzc2VzLmluZGV4T2YodCk+LTE/KGUuVG9vbHMuRXJyb3IoXCJZb3UncmUgdHJ5aW5nIHRvIHJldXNlIGEgcG9zdCBwcm9jZXNzIG5vdCBkZWZpbmVkIGFzIHJldXNhYmxlLlwiKSxcbjApOihudWxsPT1pfHwwPmk/dGhpcy5fcG9zdFByb2Nlc3Nlcy5wdXNoKHQpOnRoaXMuX3Bvc3RQcm9jZXNzZXMuc3BsaWNlKGksMCx0KSx0aGlzLl9jYXNjYWRlUG9zdFByb2Nlc3Nlc1RvUmlnQ2FtcygpLHRoaXMuX3Bvc3RQcm9jZXNzZXMuaW5kZXhPZih0KSl9LGkucHJvdG90eXBlLmRldGFjaFBvc3RQcm9jZXNzPWZ1bmN0aW9uKGUsdCl7dm9pZCAwPT09dCYmKHQ9bnVsbCk7dmFyIGkscixuPVtdO2lmKHQpZm9yKHQ9dCBpbnN0YW5jZW9mIEFycmF5P3Q6W3RdLGk9dC5sZW5ndGgtMTtpPj0wO2ktLSl0aGlzLl9wb3N0UHJvY2Vzc2VzW3RbaV1dPT09ZT90aGlzLl9wb3N0UHJvY2Vzc2VzLnNwbGljZShyLDEpOm4ucHVzaChpKTtlbHNle3ZhciBvPXRoaXMuX3Bvc3RQcm9jZXNzZXMuaW5kZXhPZihlKTstMSE9PW8mJnRoaXMuX3Bvc3RQcm9jZXNzZXMuc3BsaWNlKG8sMSl9cmV0dXJuIHRoaXMuX2Nhc2NhZGVQb3N0UHJvY2Vzc2VzVG9SaWdDYW1zKCksbn0saS5wcm90b3R5cGUuZ2V0V29ybGRNYXRyaXg9ZnVuY3Rpb24oKXt0aGlzLl93b3JsZE1hdHJpeHx8KHRoaXMuX3dvcmxkTWF0cml4PWUuTWF0cml4LklkZW50aXR5KCkpO3ZhciB0PXRoaXMuZ2V0Vmlld01hdHJpeCgpO3JldHVybiB0LmludmVydFRvUmVmKHRoaXMuX3dvcmxkTWF0cml4KSx0aGlzLl93b3JsZE1hdHJpeH0saS5wcm90b3R5cGUuX2dldFZpZXdNYXRyaXg9ZnVuY3Rpb24oKXtyZXR1cm4gZS5NYXRyaXguSWRlbnRpdHkoKX0saS5wcm90b3R5cGUuZ2V0Vmlld01hdHJpeD1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fY29tcHV0ZWRWaWV3TWF0cml4PXRoaXMuX2NvbXB1dGVWaWV3TWF0cml4KHQpLCF0JiZ0aGlzLl9pc1N5bmNocm9uaXplZFZpZXdNYXRyaXgoKT90aGlzLl9jb21wdXRlZFZpZXdNYXRyaXg6KHRoaXMucGFyZW50JiZ0aGlzLnBhcmVudC5nZXRXb3JsZE1hdHJpeD8odGhpcy5fd29ybGRNYXRyaXh8fCh0aGlzLl93b3JsZE1hdHJpeD1lLk1hdHJpeC5JZGVudGl0eSgpKSx0aGlzLl9jb21wdXRlZFZpZXdNYXRyaXguaW52ZXJ0VG9SZWYodGhpcy5fd29ybGRNYXRyaXgpLHRoaXMuX3dvcmxkTWF0cml4Lm11bHRpcGx5VG9SZWYodGhpcy5wYXJlbnQuZ2V0V29ybGRNYXRyaXgoKSx0aGlzLl9jb21wdXRlZFZpZXdNYXRyaXgpLHRoaXMuX2dsb2JhbFBvc2l0aW9uLmNvcHlGcm9tRmxvYXRzKHRoaXMuX2NvbXB1dGVkVmlld01hdHJpeC5tWzEyXSx0aGlzLl9jb21wdXRlZFZpZXdNYXRyaXgubVsxM10sdGhpcy5fY29tcHV0ZWRWaWV3TWF0cml4Lm1bMTRdKSx0aGlzLl9jb21wdXRlZFZpZXdNYXRyaXguaW52ZXJ0KCksdGhpcy5fbWFya1N5bmNlZFdpdGhQYXJlbnQoKSk6dGhpcy5fZ2xvYmFsUG9zaXRpb24uY29weUZyb20odGhpcy5wb3NpdGlvbiksdGhpcy5fY3VycmVudFJlbmRlcklkPXRoaXMuZ2V0U2NlbmUoKS5nZXRSZW5kZXJJZCgpLHRoaXMuX2NvbXB1dGVkVmlld01hdHJpeCl9LGkucHJvdG90eXBlLl9jb21wdXRlVmlld01hdHJpeD1mdW5jdGlvbihlKXtyZXR1cm4hZSYmdGhpcy5faXNTeW5jaHJvbml6ZWRWaWV3TWF0cml4KCk/dGhpcy5fY29tcHV0ZWRWaWV3TWF0cml4Oih0aGlzLl9jb21wdXRlZFZpZXdNYXRyaXg9dGhpcy5fZ2V0Vmlld01hdHJpeCgpLHRoaXMuX2N1cnJlbnRSZW5kZXJJZD10aGlzLmdldFNjZW5lKCkuZ2V0UmVuZGVySWQoKSx0aGlzLl9jb21wdXRlZFZpZXdNYXRyaXgpfSxpLnByb3RvdHlwZS5nZXRQcm9qZWN0aW9uTWF0cml4PWZ1bmN0aW9uKHQpe2lmKCF0JiZ0aGlzLl9pc1N5bmNocm9uaXplZFByb2plY3Rpb25NYXRyaXgoKSlyZXR1cm4gdGhpcy5fcHJvamVjdGlvbk1hdHJpeDt2YXIgcj10aGlzLmdldEVuZ2luZSgpO2lmKHRoaXMubW9kZT09PWkuUEVSU1BFQ1RJVkVfQ0FNRVJBKXJldHVybiB0aGlzLm1pblo8PTAmJih0aGlzLm1pblo9LjEpLGUuTWF0cml4LlBlcnNwZWN0aXZlRm92TEhUb1JlZih0aGlzLmZvdixyLmdldEFzcGVjdFJhdGlvKHRoaXMpLHRoaXMubWluWix0aGlzLm1heFosdGhpcy5fcHJvamVjdGlvbk1hdHJpeCx0aGlzLmZvdk1vZGU9PT1pLkZPVk1PREVfVkVSVElDQUxfRklYRUQpLHRoaXMuX3Byb2plY3Rpb25NYXRyaXg7dmFyIG49ci5nZXRSZW5kZXJXaWR0aCgpLzIsbz1yLmdldFJlbmRlckhlaWdodCgpLzI7cmV0dXJuIGUuTWF0cml4Lk9ydGhvT2ZmQ2VudGVyTEhUb1JlZih0aGlzLm9ydGhvTGVmdHx8LW4sdGhpcy5vcnRob1JpZ2h0fHxuLHRoaXMub3J0aG9Cb3R0b218fC1vLHRoaXMub3J0aG9Ub3B8fG8sdGhpcy5taW5aLHRoaXMubWF4Wix0aGlzLl9wcm9qZWN0aW9uTWF0cml4KSx0aGlzLl9wcm9qZWN0aW9uTWF0cml4fSxpLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7Zm9yKHRoaXMuZ2V0U2NlbmUoKS5zdG9wQW5pbWF0aW9uKHRoaXMpLHRoaXMuZ2V0U2NlbmUoKS5yZW1vdmVDYW1lcmEodGhpcyk7dGhpcy5fcmlnQ2FtZXJhcy5sZW5ndGg+MDspdGhpcy5fcmlnQ2FtZXJhcy5wb3AoKS5kaXNwb3NlKCk7Zm9yKHZhciBlPTA7ZTx0aGlzLl9wb3N0UHJvY2Vzc2VzLmxlbmd0aDsrK2UpdGhpcy5fcG9zdFByb2Nlc3Nlc1tlXS5kaXNwb3NlKHRoaXMpO3QucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKX0saS5wcm90b3R5cGUuc2V0Q2FtZXJhUmlnTW9kZT1mdW5jdGlvbih0LHIpe2Zvcig7dGhpcy5fcmlnQ2FtZXJhcy5sZW5ndGg+MDspdGhpcy5fcmlnQ2FtZXJhcy5wb3AoKS5kaXNwb3NlKCk7c3dpdGNoKHRoaXMuY2FtZXJhUmlnTW9kZT10LHRoaXMuX2NhbWVyYVJpZ1BhcmFtcz17fSx0aGlzLl9jYW1lcmFSaWdQYXJhbXMuaW50ZXJheGlhbERpc3RhbmNlPXIuaW50ZXJheGlhbERpc3RhbmNlfHwuMDYzNyx0aGlzLl9jYW1lcmFSaWdQYXJhbXMuc3RlcmVvSGFsZkFuZ2xlPWUuVG9vbHMuVG9SYWRpYW5zKHRoaXMuX2NhbWVyYVJpZ1BhcmFtcy5pbnRlcmF4aWFsRGlzdGFuY2UvLjA2MzcpLHRoaXMuY2FtZXJhUmlnTW9kZSE9PWkuUklHX01PREVfTk9ORSYmKHRoaXMuX3JpZ0NhbWVyYXMucHVzaCh0aGlzLmNyZWF0ZVJpZ0NhbWVyYSh0aGlzLm5hbWUrXCJfTFwiLDApKSx0aGlzLl9yaWdDYW1lcmFzLnB1c2godGhpcy5jcmVhdGVSaWdDYW1lcmEodGhpcy5uYW1lK1wiX1JcIiwxKSkpLHRoaXMuY2FtZXJhUmlnTW9kZSl7Y2FzZSBpLlJJR19NT0RFX1NURVJFT1NDT1BJQ19BTkFHTFlQSDp0aGlzLl9yaWdDYW1lcmFzWzBdLl9yaWdQb3N0UHJvY2Vzcz1uZXcgZS5QYXNzUG9zdFByb2Nlc3ModGhpcy5uYW1lK1wiX3Bhc3N0aHJ1XCIsMSx0aGlzLl9yaWdDYW1lcmFzWzBdKSx0aGlzLl9yaWdDYW1lcmFzWzFdLl9yaWdQb3N0UHJvY2Vzcz1uZXcgZS5BbmFnbHlwaFBvc3RQcm9jZXNzKHRoaXMubmFtZStcIl9hbmFnbHlwaFwiLDEsdGhpcy5fcmlnQ2FtZXJhcyk7YnJlYWs7Y2FzZSBpLlJJR19NT0RFX1NURVJFT1NDT1BJQ19TSURFQllTSURFX1BBUkFMTEVMOmNhc2UgaS5SSUdfTU9ERV9TVEVSRU9TQ09QSUNfU0lERUJZU0lERV9DUk9TU0VZRUQ6Y2FzZSBpLlJJR19NT0RFX1NURVJFT1NDT1BJQ19PVkVSVU5ERVI6dmFyIG49dGhpcy5jYW1lcmFSaWdNb2RlPT09aS5SSUdfTU9ERV9TVEVSRU9TQ09QSUNfU0lERUJZU0lERV9QQVJBTExFTHx8dGhpcy5jYW1lcmFSaWdNb2RlPT09aS5SSUdfTU9ERV9TVEVSRU9TQ09QSUNfU0lERUJZU0lERV9DUk9TU0VZRUQ7dGhpcy5fcmlnQ2FtZXJhc1swXS5fcmlnUG9zdFByb2Nlc3M9bmV3IGUuUGFzc1Bvc3RQcm9jZXNzKHRoaXMubmFtZStcIl9wYXNzdGhydVwiLDEsdGhpcy5fcmlnQ2FtZXJhc1swXSksdGhpcy5fcmlnQ2FtZXJhc1sxXS5fcmlnUG9zdFByb2Nlc3M9bmV3IGUuU3RlcmVvc2NvcGljSW50ZXJsYWNlUG9zdFByb2Nlc3ModGhpcy5uYW1lK1wiX3N0ZXJlb0ludGVybGFjZVwiLHRoaXMuX3JpZ0NhbWVyYXMsbik7YnJlYWs7Y2FzZSBpLlJJR19NT0RFX1ZSOnZhciBvPXIudnJDYW1lcmFNZXRyaWNzfHxlLlZSQ2FtZXJhTWV0cmljcy5HZXREZWZhdWx0KCk7dGhpcy5fcmlnQ2FtZXJhc1swXS5fY2FtZXJhUmlnUGFyYW1zLnZyTWV0cmljcz1vLHRoaXMuX3JpZ0NhbWVyYXNbMF0udmlld3BvcnQ9bmV3IGUuVmlld3BvcnQoMCwwLC41LDEpLHRoaXMuX3JpZ0NhbWVyYXNbMF0uX2NhbWVyYVJpZ1BhcmFtcy52cldvcmtNYXRyaXg9bmV3IGUuTWF0cml4LHRoaXMuX3JpZ0NhbWVyYXNbMF0uX2NhbWVyYVJpZ1BhcmFtcy52ckhNYXRyaXg9by5sZWZ0SE1hdHJpeCx0aGlzLl9yaWdDYW1lcmFzWzBdLl9jYW1lcmFSaWdQYXJhbXMudnJQcmVWaWV3TWF0cml4PW8ubGVmdFByZVZpZXdNYXRyaXgsdGhpcy5fcmlnQ2FtZXJhc1swXS5nZXRQcm9qZWN0aW9uTWF0cml4PXRoaXMuX3JpZ0NhbWVyYXNbMF0uX2dldFZSUHJvamVjdGlvbk1hdHJpeCx0aGlzLl9yaWdDYW1lcmFzWzFdLl9jYW1lcmFSaWdQYXJhbXMudnJNZXRyaWNzPW8sdGhpcy5fcmlnQ2FtZXJhc1sxXS52aWV3cG9ydD1uZXcgZS5WaWV3cG9ydCguNSwwLC41LDEpLHRoaXMuX3JpZ0NhbWVyYXNbMV0uX2NhbWVyYVJpZ1BhcmFtcy52cldvcmtNYXRyaXg9bmV3IGUuTWF0cml4LHRoaXMuX3JpZ0NhbWVyYXNbMV0uX2NhbWVyYVJpZ1BhcmFtcy52ckhNYXRyaXg9by5yaWdodEhNYXRyaXgsdGhpcy5fcmlnQ2FtZXJhc1sxXS5fY2FtZXJhUmlnUGFyYW1zLnZyUHJlVmlld01hdHJpeD1vLnJpZ2h0UHJlVmlld01hdHJpeCx0aGlzLl9yaWdDYW1lcmFzWzFdLmdldFByb2plY3Rpb25NYXRyaXg9dGhpcy5fcmlnQ2FtZXJhc1sxXS5fZ2V0VlJQcm9qZWN0aW9uTWF0cml4LG8uY29tcGVuc2F0ZURpc3RvcnRpb24mJih0aGlzLl9yaWdDYW1lcmFzWzBdLl9yaWdQb3N0UHJvY2Vzcz1uZXcgZS5WUkRpc3RvcnRpb25Db3JyZWN0aW9uUG9zdFByb2Nlc3MoXCJWUl9EaXN0b3J0X0NvbXBlbnNhdGlvbl9MZWZ0XCIsdGhpcy5fcmlnQ2FtZXJhc1swXSwhMSxvKSx0aGlzLl9yaWdDYW1lcmFzWzFdLl9yaWdQb3N0UHJvY2Vzcz1uZXcgZS5WUkRpc3RvcnRpb25Db3JyZWN0aW9uUG9zdFByb2Nlc3MoXCJWUl9EaXN0b3J0X0NvbXBlbnNhdGlvbl9SaWdodFwiLHRoaXMuX3JpZ0NhbWVyYXNbMV0sITAsbykpfXRoaXMuX2Nhc2NhZGVQb3N0UHJvY2Vzc2VzVG9SaWdDYW1zKCksdGhpcy5fdXBkYXRlKCl9LGkucHJvdG90eXBlLl9nZXRWUlByb2plY3Rpb25NYXRyaXg9ZnVuY3Rpb24oKXtyZXR1cm4gZS5NYXRyaXguUGVyc3BlY3RpdmVGb3ZMSFRvUmVmKHRoaXMuX2NhbWVyYVJpZ1BhcmFtcy52ck1ldHJpY3MuYXNwZWN0UmF0aW9Gb3YsdGhpcy5fY2FtZXJhUmlnUGFyYW1zLnZyTWV0cmljcy5hc3BlY3RSYXRpbyx0aGlzLm1pblosdGhpcy5tYXhaLHRoaXMuX2NhbWVyYVJpZ1BhcmFtcy52cldvcmtNYXRyaXgpLHRoaXMuX2NhbWVyYVJpZ1BhcmFtcy52cldvcmtNYXRyaXgubXVsdGlwbHlUb1JlZih0aGlzLl9jYW1lcmFSaWdQYXJhbXMudnJITWF0cml4LHRoaXMuX3Byb2plY3Rpb25NYXRyaXgpLHRoaXMuX3Byb2plY3Rpb25NYXRyaXh9LGkucHJvdG90eXBlLnNldENhbWVyYVJpZ1BhcmFtZXRlcj1mdW5jdGlvbih0LGkpe3RoaXMuX2NhbWVyYVJpZ1BhcmFtc3x8KHRoaXMuX2NhbWVyYVJpZ1BhcmFtcz17fSksdGhpcy5fY2FtZXJhUmlnUGFyYW1zW3RdPWksXCJpbnRlcmF4aWFsRGlzdGFuY2VcIj09PXQmJih0aGlzLl9jYW1lcmFSaWdQYXJhbXMuc3RlcmVvSGFsZkFuZ2xlPWUuVG9vbHMuVG9SYWRpYW5zKGkvLjA2MzcpKX0saS5wcm90b3R5cGUuY3JlYXRlUmlnQ2FtZXJhPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIG51bGx9LGkucHJvdG90eXBlLl91cGRhdGVSaWdDYW1lcmFzPWZ1bmN0aW9uKCl7Zm9yKHZhciBlPTA7ZTx0aGlzLl9yaWdDYW1lcmFzLmxlbmd0aDtlKyspdGhpcy5fcmlnQ2FtZXJhc1tlXS5taW5aPXRoaXMubWluWix0aGlzLl9yaWdDYW1lcmFzW2VdLm1heFo9dGhpcy5tYXhaLHRoaXMuX3JpZ0NhbWVyYXNbZV0uZm92PXRoaXMuZm92O3RoaXMuY2FtZXJhUmlnTW9kZT09PWkuUklHX01PREVfU1RFUkVPU0NPUElDX0FOQUdMWVBIJiYodGhpcy5fcmlnQ2FtZXJhc1swXS52aWV3cG9ydD10aGlzLl9yaWdDYW1lcmFzWzFdLnZpZXdwb3J0PXRoaXMudmlld3BvcnQpfSxpLnByb3RvdHlwZS5fc2V0dXBJbnB1dHM9ZnVuY3Rpb24oKXt9LGkucHJvdG90eXBlLnNlcmlhbGl6ZT1mdW5jdGlvbigpe3ZhciB0PWUuU2VyaWFsaXphdGlvbkhlbHBlci5TZXJpYWxpemUodGhpcyk7cmV0dXJuIHQudHlwZT10aGlzLmdldFR5cGVOYW1lKCksdGhpcy5wYXJlbnQmJih0LnBhcmVudElkPXRoaXMucGFyZW50LmlkKSx0aGlzLmlucHV0cyYmdGhpcy5pbnB1dHMuc2VyaWFsaXplKHQpLGUuQW5pbWF0aW9uLkFwcGVuZFNlcmlhbGl6ZWRBbmltYXRpb25zKHRoaXMsdCksdC5yYW5nZXM9dGhpcy5zZXJpYWxpemVBbmltYXRpb25SYW5nZXMoKSx0fSxpLnByb3RvdHlwZS5nZXRUeXBlTmFtZT1mdW5jdGlvbigpe3JldHVyblwiQ2FtZXJhXCJ9LGkucHJvdG90eXBlLmNsb25lPWZ1bmN0aW9uKHQpe3JldHVybiBlLlNlcmlhbGl6YXRpb25IZWxwZXIuQ2xvbmUoaS5HZXRDb25zdHJ1Y3RvckZyb21OYW1lKHRoaXMuZ2V0VHlwZU5hbWUoKSx0LHRoaXMuZ2V0U2NlbmUoKSx0aGlzLmludGVyYXhpYWxEaXN0YW5jZSx0aGlzLmlzU3RlcmVvc2NvcGljU2lkZUJ5U2lkZSksdGhpcyl9LGkuR2V0Q29uc3RydWN0b3JGcm9tTmFtZT1mdW5jdGlvbih0LGkscixuLG8pe3N3aXRjaCh2b2lkIDA9PT1uJiYobj0wKSx2b2lkIDA9PT1vJiYobz0hMCksdCl7Y2FzZVwiQXJjUm90YXRlQ2FtZXJhXCI6cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBlLkFyY1JvdGF0ZUNhbWVyYShpLDAsMCwxLGUuVmVjdG9yMy5aZXJvKCkscil9O2Nhc2VcIkRldmljZU9yaWVudGF0aW9uQ2FtZXJhXCI6cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBlLkRldmljZU9yaWVudGF0aW9uQ2FtZXJhKGksZS5WZWN0b3IzLlplcm8oKSxyKX07Y2FzZVwiRm9sbG93Q2FtZXJhXCI6cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBlLkZvbGxvd0NhbWVyYShpLGUuVmVjdG9yMy5aZXJvKCkscil9O2Nhc2VcIkFyY0ZvbGxvd0NhbWVyYVwiOnJldHVybiBmdW5jdGlvbigpe3JldHVybiBuZXcgZS5BcmNGb2xsb3dDYW1lcmEoaSwwLDAsMSxudWxsLHIpfTtjYXNlXCJHYW1lcGFkQ2FtZXJhXCI6cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBlLkdhbWVwYWRDYW1lcmEoaSxlLlZlY3RvcjMuWmVybygpLHIpfTtjYXNlXCJUb3VjaENhbWVyYVwiOnJldHVybiBmdW5jdGlvbigpe3JldHVybiBuZXcgZS5Ub3VjaENhbWVyYShpLGUuVmVjdG9yMy5aZXJvKCkscil9O2Nhc2VcIlZpcnR1YWxKb3lzdGlja3NDYW1lcmFcIjpyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGUuVmlydHVhbEpveXN0aWNrc0NhbWVyYShpLGUuVmVjdG9yMy5aZXJvKCkscil9O2Nhc2VcIldlYlZSRnJlZUNhbWVyYVwiOnJldHVybiBmdW5jdGlvbigpe3JldHVybiBuZXcgZS5XZWJWUkZyZWVDYW1lcmEoaSxlLlZlY3RvcjMuWmVybygpLHIpfTtjYXNlXCJWUkRldmljZU9yaWVudGF0aW9uRnJlZUNhbWVyYVwiOnJldHVybiBmdW5jdGlvbigpe3JldHVybiBuZXcgZS5WUkRldmljZU9yaWVudGF0aW9uRnJlZUNhbWVyYShpLGUuVmVjdG9yMy5aZXJvKCkscil9O2Nhc2VcIkFuYWdseXBoQXJjUm90YXRlQ2FtZXJhXCI6cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBlLkFuYWdseXBoQXJjUm90YXRlQ2FtZXJhKGksMCwwLDEsZS5WZWN0b3IzLlplcm8oKSxuLHIpfTtjYXNlXCJBbmFnbHlwaEZyZWVDYW1lcmFcIjpyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGUuQW5hZ2x5cGhGcmVlQ2FtZXJhKGksZS5WZWN0b3IzLlplcm8oKSxuLHIpfTtjYXNlXCJBbmFnbHlwaEdhbWVwYWRDYW1lcmFcIjpyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGUuQW5hZ2x5cGhHYW1lcGFkQ2FtZXJhKGksZS5WZWN0b3IzLlplcm8oKSxuLHIpfTtjYXNlXCJBbmFnbHlwaFVuaXZlcnNhbENhbWVyYVwiOnJldHVybiBmdW5jdGlvbigpe3JldHVybiBuZXcgZS5BbmFnbHlwaFVuaXZlcnNhbENhbWVyYShpLGUuVmVjdG9yMy5aZXJvKCksbixyKX07Y2FzZVwiU3RlcmVvc2NvcGljQXJjUm90YXRlQ2FtZXJhXCI6cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBlLlN0ZXJlb3Njb3BpY0FyY1JvdGF0ZUNhbWVyYShpLDAsMCwxLGUuVmVjdG9yMy5aZXJvKCksbixvLHIpfTtjYXNlXCJTdGVyZW9zY29waWNGcmVlQ2FtZXJhXCI6cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBlLlN0ZXJlb3Njb3BpY0ZyZWVDYW1lcmEoaSxlLlZlY3RvcjMuWmVybygpLG4sbyxyKX07Y2FzZVwiU3RlcmVvc2NvcGljR2FtZXBhZENhbWVyYVwiOnJldHVybiBmdW5jdGlvbigpe3JldHVybiBuZXcgZS5TdGVyZW9zY29waWNHYW1lcGFkQ2FtZXJhKGksZS5WZWN0b3IzLlplcm8oKSxuLG8scil9O2Nhc2VcIlN0ZXJlb3Njb3BpY1VuaXZlcnNhbENhbWVyYVwiOnJldHVybiBmdW5jdGlvbigpe3JldHVybiBuZXcgZS5TdGVyZW9zY29waWNVbml2ZXJzYWxDYW1lcmEoaSxlLlZlY3RvcjMuWmVybygpLG4sbyxyKX07Y2FzZVwiRnJlZUNhbWVyYVwiOnJldHVybiBmdW5jdGlvbigpe3JldHVybiBuZXcgZS5Vbml2ZXJzYWxDYW1lcmEoaSxlLlZlY3RvcjMuWmVybygpLHIpfTtkZWZhdWx0OnJldHVybiBmdW5jdGlvbigpe3JldHVybiBuZXcgZS5Vbml2ZXJzYWxDYW1lcmEoaSxlLlZlY3RvcjMuWmVybygpLHIpfX19LGkuUGFyc2U9ZnVuY3Rpb24odCxyKXt2YXIgbj10LnR5cGUsbz1pLkdldENvbnN0cnVjdG9yRnJvbU5hbWUobix0Lm5hbWUscix0LmludGVyYXhpYWxfZGlzdGFuY2UsdC5pc1N0ZXJlb3Njb3BpY1NpZGVCeVNpZGUpLHM9ZS5TZXJpYWxpemF0aW9uSGVscGVyLlBhcnNlKG8sdCxyKTtpZih0LnBhcmVudElkJiYocy5fd2FpdGluZ1BhcmVudElkPXQucGFyZW50SWQpLHMuaW5wdXRzJiYocy5pbnB1dHMucGFyc2UodCkscy5fc2V0dXBJbnB1dHMoKSksdC50YXJnZXQmJnMuc2V0VGFyZ2V0JiZzLnNldFRhcmdldChlLlZlY3RvcjMuRnJvbUFycmF5KHQudGFyZ2V0KSksdC5jYW1lcmFSaWdNb2RlKXt2YXIgYT10LmludGVyYXhpYWxfZGlzdGFuY2U/e2ludGVyYXhpYWxEaXN0YW5jZTp0LmludGVyYXhpYWxfZGlzdGFuY2V9Ont9O3Muc2V0Q2FtZXJhUmlnTW9kZSh0LmNhbWVyYVJpZ01vZGUsYSl9aWYodC5hbmltYXRpb25zKXtmb3IodmFyIGg9MDtoPHQuYW5pbWF0aW9ucy5sZW5ndGg7aCsrKXt2YXIgYz10LmFuaW1hdGlvbnNbaF07cy5hbmltYXRpb25zLnB1c2goZS5BbmltYXRpb24uUGFyc2UoYykpfWUuTm9kZS5QYXJzZUFuaW1hdGlvblJhbmdlcyhzLHQscil9cmV0dXJuIHQuYXV0b0FuaW1hdGUmJnIuYmVnaW5BbmltYXRpb24ocyx0LmF1dG9BbmltYXRlRnJvbSx0LmF1dG9BbmltYXRlVG8sdC5hdXRvQW5pbWF0ZUxvb3AsdC5hdXRvQW5pbWF0ZVNwZWVkfHwxKSxzfSxpLl9QRVJTUEVDVElWRV9DQU1FUkE9MCxpLl9PUlRIT0dSQVBISUNfQ0FNRVJBPTEsaS5fRk9WTU9ERV9WRVJUSUNBTF9GSVhFRD0wLGkuX0ZPVk1PREVfSE9SSVpPTlRBTF9GSVhFRD0xLGkuX1JJR19NT0RFX05PTkU9MCxpLl9SSUdfTU9ERV9TVEVSRU9TQ09QSUNfQU5BR0xZUEg9MTAsaS5fUklHX01PREVfU1RFUkVPU0NPUElDX1NJREVCWVNJREVfUEFSQUxMRUw9MTEsaS5fUklHX01PREVfU1RFUkVPU0NPUElDX1NJREVCWVNJREVfQ1JPU1NFWUVEPTEyLGkuX1JJR19NT0RFX1NURVJFT1NDT1BJQ19PVkVSVU5ERVI9MTMsaS5fUklHX01PREVfVlI9MjAsaS5Gb3JjZUF0dGFjaENvbnRyb2xUb0Fsd2F5c1ByZXZlbnREZWZhdWx0PSExLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplQXNWZWN0b3IzKCldLGkucHJvdG90eXBlLFwicG9zaXRpb25cIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplQXNWZWN0b3IzKCldLGkucHJvdG90eXBlLFwidXBWZWN0b3JcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLGkucHJvdG90eXBlLFwib3J0aG9MZWZ0XCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSxpLnByb3RvdHlwZSxcIm9ydGhvUmlnaHRcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLGkucHJvdG90eXBlLFwib3J0aG9Cb3R0b21cIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLGkucHJvdG90eXBlLFwib3J0aG9Ub3BcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLGkucHJvdG90eXBlLFwiZm92XCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSxpLnByb3RvdHlwZSxcIm1pblpcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLGkucHJvdG90eXBlLFwibWF4WlwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0saS5wcm90b3R5cGUsXCJpbmVydGlhXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSxpLnByb3RvdHlwZSxcIm1vZGVcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLGkucHJvdG90eXBlLFwibGF5ZXJNYXNrXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSxpLnByb3RvdHlwZSxcImZvdk1vZGVcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLGkucHJvdG90eXBlLFwiY2FtZXJhUmlnTW9kZVwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0saS5wcm90b3R5cGUsXCJpbnRlcmF4aWFsRGlzdGFuY2VcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLGkucHJvdG90eXBlLFwiaXNTdGVyZW9zY29waWNTaWRlQnlTaWRlXCIsdm9pZCAwKSxpfShlLk5vZGUpO2UuQ2FtZXJhPXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe2UuQ2FtZXJhSW5wdXRUeXBlcz17fTt2YXIgdD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoZSl7dGhpcy5hdHRhY2hlZD17fSx0aGlzLmNhbWVyYT1lLHRoaXMuY2hlY2tJbnB1dHM9ZnVuY3Rpb24oKXt9fXJldHVybiB0LnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24odCl7dmFyIGk9dC5nZXRTaW1wbGVOYW1lKCk7cmV0dXJuIHRoaXMuYXR0YWNoZWRbaV0/dm9pZCBlLlRvb2xzLldhcm4oXCJjYW1lcmEgaW5wdXQgb2YgdHlwZSBcIitpK1wiIGFscmVhZHkgZXhpc3RzIG9uIGNhbWVyYVwiKToodGhpcy5hdHRhY2hlZFtpXT10LHQuY2FtZXJhPXRoaXMuY2FtZXJhLHQuY2hlY2tJbnB1dHMmJih0aGlzLmNoZWNrSW5wdXRzPXRoaXMuX2FkZENoZWNrSW5wdXRzKHQuY2hlY2tJbnB1dHMuYmluZCh0KSkpLHZvaWQodGhpcy5hdHRhY2hlZEVsZW1lbnQmJnQuYXR0YWNoQ29udHJvbCh0aGlzLmF0dGFjaGVkRWxlbWVudCkpKX0sdC5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKGUpe2Zvcih2YXIgdCBpbiB0aGlzLmF0dGFjaGVkKXt2YXIgaT10aGlzLmF0dGFjaGVkW3RdO2k9PT1lJiYoaS5kZXRhY2hDb250cm9sKHRoaXMuYXR0YWNoZWRFbGVtZW50KSxkZWxldGUgdGhpcy5hdHRhY2hlZFt0XSx0aGlzLnJlYnVpbGRJbnB1dENoZWNrKCkpfX0sdC5wcm90b3R5cGUucmVtb3ZlQnlUeXBlPWZ1bmN0aW9uKGUpe2Zvcih2YXIgdCBpbiB0aGlzLmF0dGFjaGVkKXt2YXIgaT10aGlzLmF0dGFjaGVkW3RdO2kuZ2V0VHlwZU5hbWUoKT09PWUmJihpLmRldGFjaENvbnRyb2wodGhpcy5hdHRhY2hlZEVsZW1lbnQpLGRlbGV0ZSB0aGlzLmF0dGFjaGVkW3RdLHRoaXMucmVidWlsZElucHV0Q2hlY2soKSl9fSx0LnByb3RvdHlwZS5fYWRkQ2hlY2tJbnB1dHM9ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5jaGVja0lucHV0cztyZXR1cm4gZnVuY3Rpb24oKXt0KCksZSgpfX0sdC5wcm90b3R5cGUuYXR0YWNoSW5wdXQ9ZnVuY3Rpb24oZSl7ZS5hdHRhY2hDb250cm9sKHRoaXMuYXR0YWNoZWRFbGVtZW50LHRoaXMubm9QcmV2ZW50RGVmYXVsdCl9LHQucHJvdG90eXBlLmF0dGFjaEVsZW1lbnQ9ZnVuY3Rpb24odCxpKXtpZighdGhpcy5hdHRhY2hlZEVsZW1lbnQpe2k9ZS5DYW1lcmEuRm9yY2VBdHRhY2hDb250cm9sVG9BbHdheXNQcmV2ZW50RGVmYXVsdD8hMTppLHRoaXMuYXR0YWNoZWRFbGVtZW50PXQsdGhpcy5ub1ByZXZlbnREZWZhdWx0PWk7Zm9yKHZhciByIGluIHRoaXMuYXR0YWNoZWQpe3RoaXMuYXR0YWNoZWRbcl07dGhpcy5hdHRhY2hlZFtyXS5hdHRhY2hDb250cm9sKHQsaSl9fX0sdC5wcm90b3R5cGUuZGV0YWNoRWxlbWVudD1mdW5jdGlvbihlKXtpZih0aGlzLmF0dGFjaGVkRWxlbWVudD09PWUpe2Zvcih2YXIgdCBpbiB0aGlzLmF0dGFjaGVkKXt0aGlzLmF0dGFjaGVkW3RdO3RoaXMuYXR0YWNoZWRbdF0uZGV0YWNoQ29udHJvbChlKX10aGlzLmF0dGFjaGVkRWxlbWVudD1udWxsfX0sdC5wcm90b3R5cGUucmVidWlsZElucHV0Q2hlY2s9ZnVuY3Rpb24oKXt0aGlzLmNoZWNrSW5wdXRzPWZ1bmN0aW9uKCl7fTtmb3IodmFyIGUgaW4gdGhpcy5hdHRhY2hlZCl7dmFyIHQ9dGhpcy5hdHRhY2hlZFtlXTt0LmNoZWNrSW5wdXRzJiYodGhpcy5jaGVja0lucHV0cz10aGlzLl9hZGRDaGVja0lucHV0cyh0LmNoZWNrSW5wdXRzLmJpbmQodCkpKX19LHQucHJvdG90eXBlLmNsZWFyPWZ1bmN0aW9uKCl7dGhpcy5hdHRhY2hlZEVsZW1lbnQmJnRoaXMuZGV0YWNoRWxlbWVudCh0aGlzLmF0dGFjaGVkRWxlbWVudCksdGhpcy5hdHRhY2hlZD17fSx0aGlzLmF0dGFjaGVkRWxlbWVudD1udWxsLHRoaXMuY2hlY2tJbnB1dHM9ZnVuY3Rpb24oKXt9fSx0LnByb3RvdHlwZS5zZXJpYWxpemU9ZnVuY3Rpb24odCl7dmFyIGk9e307Zm9yKHZhciByIGluIHRoaXMuYXR0YWNoZWQpe3ZhciBuPXRoaXMuYXR0YWNoZWRbcl0sbz1lLlNlcmlhbGl6YXRpb25IZWxwZXIuU2VyaWFsaXplKG4pO2lbbi5nZXRUeXBlTmFtZSgpXT1vfXQuaW5wdXRzbWdyPWl9LHQucHJvdG90eXBlLnBhcnNlPWZ1bmN0aW9uKHQpe3ZhciBpPXQuaW5wdXRzbWdyO2lmKGkpe3RoaXMuY2xlYXIoKTtmb3IodmFyIHIgaW4gaSl7dmFyIG49ZS5DYW1lcmFJbnB1dFR5cGVzW3JdO2lmKG4pe3ZhciBvPWlbcl0scz1lLlNlcmlhbGl6YXRpb25IZWxwZXIuUGFyc2UoZnVuY3Rpb24oKXtyZXR1cm4gbmV3IG59LG8sbnVsbCk7dGhpcy5hZGQocyl9fX1lbHNlIGZvcih2YXIgciBpbiB0aGlzLmF0dGFjaGVkKXt2YXIgbj1lLkNhbWVyYUlucHV0VHlwZXNbdGhpcy5hdHRhY2hlZFtyXS5nZXRUeXBlTmFtZSgpXTtpZihuKXt2YXIgcz1lLlNlcmlhbGl6YXRpb25IZWxwZXIuUGFyc2UoZnVuY3Rpb24oKXtyZXR1cm4gbmV3IG59LHQsbnVsbCk7dGhpcy5yZW1vdmUodGhpcy5hdHRhY2hlZFtyXSksdGhpcy5hZGQocyl9fX0sdH0oKTtlLkNhbWVyYUlucHV0c01hbmFnZXI9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KGUpe3ZvaWQgMD09PWUmJihlPSEwKSx0aGlzLnRvdWNoRW5hYmxlZD1lLHRoaXMuYW5ndWxhclNlbnNpYmlsaXR5PTJlM31yZXR1cm4gdC5wcm90b3R5cGUuYXR0YWNoQ29udHJvbD1mdW5jdGlvbih0LGkpe3ZhciByPXRoaXM7aWYoIXRoaXMuX3BvaW50ZXJJbnB1dCl7dmFyIG49dGhpcy5jYW1lcmEsbz10aGlzLmNhbWVyYS5nZXRFbmdpbmUoKTt0aGlzLl9wb2ludGVySW5wdXQ9ZnVuY3Rpb24odCxzKXt2YXIgYT10LmV2ZW50O2lmKHIudG91Y2hFbmFibGVkfHxcInRvdWNoXCIhPT1hLnBvaW50ZXJUeXBlKWlmKHQudHlwZT09PWUuUG9pbnRlckV2ZW50VHlwZXMuUE9JTlRFUkRPV04pe3RyeXthLnNyY0VsZW1lbnQuc2V0UG9pbnRlckNhcHR1cmUoYS5wb2ludGVySWQpfWNhdGNoKGgpe31yLnByZXZpb3VzUG9zaXRpb249e3g6YS5jbGllbnRYLHk6YS5jbGllbnRZfSxpfHxhLnByZXZlbnREZWZhdWx0KCl9ZWxzZSBpZih0LnR5cGU9PT1lLlBvaW50ZXJFdmVudFR5cGVzLlBPSU5URVJVUCl7dHJ5e2Euc3JjRWxlbWVudC5yZWxlYXNlUG9pbnRlckNhcHR1cmUoYS5wb2ludGVySWQpfWNhdGNoKGgpe31yLnByZXZpb3VzUG9zaXRpb249bnVsbCxpfHxhLnByZXZlbnREZWZhdWx0KCl9ZWxzZSBpZih0LnR5cGU9PT1lLlBvaW50ZXJFdmVudFR5cGVzLlBPSU5URVJNT1ZFKXtpZighci5wcmV2aW91c1Bvc2l0aW9uJiYhby5pc1BvaW50ZXJMb2NrKXJldHVybjt2YXIgYyxsO28uaXNQb2ludGVyTG9jaz8oYz1hLm1vdmVtZW50WHx8YS5tb3pNb3ZlbWVudFh8fGEud2Via2l0TW92ZW1lbnRYfHxhLm1zTW92ZW1lbnRYfHwwLGw9YS5tb3ZlbWVudFl8fGEubW96TW92ZW1lbnRZfHxhLndlYmtpdE1vdmVtZW50WXx8YS5tc01vdmVtZW50WXx8MCk6KGM9YS5jbGllbnRYLXIucHJldmlvdXNQb3NpdGlvbi54LGw9YS5jbGllbnRZLXIucHJldmlvdXNQb3NpdGlvbi55KSxuLmNhbWVyYVJvdGF0aW9uLnkrPWMvci5hbmd1bGFyU2Vuc2liaWxpdHksbi5jYW1lcmFSb3RhdGlvbi54Kz1sL3IuYW5ndWxhclNlbnNpYmlsaXR5LHIucHJldmlvdXNQb3NpdGlvbj17eDphLmNsaWVudFgseTphLmNsaWVudFl9LGl8fGEucHJldmVudERlZmF1bHQoKX19fXRoaXMuX29ic2VydmVyPXRoaXMuY2FtZXJhLmdldFNjZW5lKCkub25Qb2ludGVyT2JzZXJ2YWJsZS5hZGQodGhpcy5fcG9pbnRlcklucHV0LGUuUG9pbnRlckV2ZW50VHlwZXMuUE9JTlRFUkRPV058ZS5Qb2ludGVyRXZlbnRUeXBlcy5QT0lOVEVSVVB8ZS5Qb2ludGVyRXZlbnRUeXBlcy5QT0lOVEVSTU9WRSl9LHQucHJvdG90eXBlLmRldGFjaENvbnRyb2w9ZnVuY3Rpb24oZSl7dGhpcy5fb2JzZXJ2ZXImJmUmJih0aGlzLmNhbWVyYS5nZXRTY2VuZSgpLm9uUG9pbnRlck9ic2VydmFibGUucmVtb3ZlKHRoaXMuX29ic2VydmVyKSx0aGlzLl9vYnNlcnZlcj1udWxsLHRoaXMucHJldmlvdXNQb3NpdGlvbj1udWxsKX0sdC5wcm90b3R5cGUuZ2V0VHlwZU5hbWU9ZnVuY3Rpb24oKXtyZXR1cm5cIkZyZWVDYW1lcmFNb3VzZUlucHV0XCJ9LHQucHJvdG90eXBlLmdldFNpbXBsZU5hbWU9ZnVuY3Rpb24oKXtyZXR1cm5cIm1vdXNlXCJ9LF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHQucHJvdG90eXBlLFwiYW5ndWxhclNlbnNpYmlsaXR5XCIsdm9pZCAwKSx0fSgpO2UuRnJlZUNhbWVyYU1vdXNlSW5wdXQ9dCxlLkNhbWVyYUlucHV0VHlwZXMuRnJlZUNhbWVyYU1vdXNlSW5wdXQ9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KCl7dGhpcy5fa2V5cz1bXSx0aGlzLmtleXNVcD1bMzhdLHRoaXMua2V5c0Rvd249WzQwXSx0aGlzLmtleXNMZWZ0PVszN10sdGhpcy5rZXlzUmlnaHQ9WzM5XX1yZXR1cm4gdC5wcm90b3R5cGUuYXR0YWNoQ29udHJvbD1mdW5jdGlvbih0LGkpe3ZhciByPXRoaXM7dGhpcy5fb25LZXlEb3dufHwodGhpcy5fb25LZXlEb3duPWZ1bmN0aW9uKGUpe2lmKC0xIT09ci5rZXlzVXAuaW5kZXhPZihlLmtleUNvZGUpfHwtMSE9PXIua2V5c0Rvd24uaW5kZXhPZihlLmtleUNvZGUpfHwtMSE9PXIua2V5c0xlZnQuaW5kZXhPZihlLmtleUNvZGUpfHwtMSE9PXIua2V5c1JpZ2h0LmluZGV4T2YoZS5rZXlDb2RlKSl7dmFyIHQ9ci5fa2V5cy5pbmRleE9mKGUua2V5Q29kZSk7LTE9PT10JiZyLl9rZXlzLnB1c2goZS5rZXlDb2RlKSxpfHxlLnByZXZlbnREZWZhdWx0KCl9fSx0aGlzLl9vbktleVVwPWZ1bmN0aW9uKGUpe2lmKC0xIT09ci5rZXlzVXAuaW5kZXhPZihlLmtleUNvZGUpfHwtMSE9PXIua2V5c0Rvd24uaW5kZXhPZihlLmtleUNvZGUpfHwtMSE9PXIua2V5c0xlZnQuaW5kZXhPZihlLmtleUNvZGUpfHwtMSE9PXIua2V5c1JpZ2h0LmluZGV4T2YoZS5rZXlDb2RlKSl7dmFyIHQ9ci5fa2V5cy5pbmRleE9mKGUua2V5Q29kZSk7dD49MCYmci5fa2V5cy5zcGxpY2UodCwxKSxpfHxlLnByZXZlbnREZWZhdWx0KCl9fSxlLlRvb2xzLlJlZ2lzdGVyVG9wUm9vdEV2ZW50cyhbe25hbWU6XCJrZXlkb3duXCIsaGFuZGxlcjp0aGlzLl9vbktleURvd259LHtuYW1lOlwia2V5dXBcIixoYW5kbGVyOnRoaXMuX29uS2V5VXB9LHtuYW1lOlwiYmx1clwiLGhhbmRsZXI6dGhpcy5fb25Mb3N0Rm9jdXN9XSkpfSx0LnByb3RvdHlwZS5kZXRhY2hDb250cm9sPWZ1bmN0aW9uKHQpe3RoaXMuX29uS2V5RG93biYmKGUuVG9vbHMuVW5yZWdpc3RlclRvcFJvb3RFdmVudHMoW3tuYW1lOlwia2V5ZG93blwiLGhhbmRsZXI6dGhpcy5fb25LZXlEb3dufSx7bmFtZTpcImtleXVwXCIsaGFuZGxlcjp0aGlzLl9vbktleVVwfSx7bmFtZTpcImJsdXJcIixoYW5kbGVyOnRoaXMuX29uTG9zdEZvY3VzfV0pLHRoaXMuX2tleXM9W10sdGhpcy5fb25LZXlEb3duPW51bGwsdGhpcy5fb25LZXlVcD1udWxsKX0sdC5wcm90b3R5cGUuY2hlY2tJbnB1dHM9ZnVuY3Rpb24oKXtpZih0aGlzLl9vbktleURvd24pZm9yKHZhciB0PXRoaXMuY2FtZXJhLGk9MDtpPHRoaXMuX2tleXMubGVuZ3RoO2krKyl7dmFyIHI9dGhpcy5fa2V5c1tpXSxuPXQuX2NvbXB1dGVMb2NhbENhbWVyYVNwZWVkKCk7LTEhPT10aGlzLmtleXNMZWZ0LmluZGV4T2Yocik/dC5fbG9jYWxEaXJlY3Rpb24uY29weUZyb21GbG9hdHMoLW4sMCwwKTotMSE9PXRoaXMua2V5c1VwLmluZGV4T2Yocik/dC5fbG9jYWxEaXJlY3Rpb24uY29weUZyb21GbG9hdHMoMCwwLG4pOi0xIT09dGhpcy5rZXlzUmlnaHQuaW5kZXhPZihyKT90Ll9sb2NhbERpcmVjdGlvbi5jb3B5RnJvbUZsb2F0cyhuLDAsMCk6LTEhPT10aGlzLmtleXNEb3duLmluZGV4T2YocikmJnQuX2xvY2FsRGlyZWN0aW9uLmNvcHlGcm9tRmxvYXRzKDAsMCwtbiksdC5nZXRWaWV3TWF0cml4KCkuaW52ZXJ0VG9SZWYodC5fY2FtZXJhVHJhbnNmb3JtTWF0cml4KSxlLlZlY3RvcjMuVHJhbnNmb3JtTm9ybWFsVG9SZWYodC5fbG9jYWxEaXJlY3Rpb24sdC5fY2FtZXJhVHJhbnNmb3JtTWF0cml4LHQuX3RyYW5zZm9ybWVkRGlyZWN0aW9uKSx0LmNhbWVyYURpcmVjdGlvbi5hZGRJblBsYWNlKHQuX3RyYW5zZm9ybWVkRGlyZWN0aW9uKX19LHQucHJvdG90eXBlLmdldFR5cGVOYW1lPWZ1bmN0aW9uKCl7cmV0dXJuXCJGcmVlQ2FtZXJhS2V5Ym9hcmRNb3ZlSW5wdXRcIn0sdC5wcm90b3R5cGUuX29uTG9zdEZvY3VzPWZ1bmN0aW9uKGUpe3RoaXMuX2tleXM9W119LHQucHJvdG90eXBlLmdldFNpbXBsZU5hbWU9ZnVuY3Rpb24oKXtyZXR1cm5cImtleWJvYXJkXCJ9LF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHQucHJvdG90eXBlLFwia2V5c1VwXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSx0LnByb3RvdHlwZSxcImtleXNEb3duXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSx0LnByb3RvdHlwZSxcImtleXNMZWZ0XCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSx0LnByb3RvdHlwZSxcImtleXNSaWdodFwiLHZvaWQgMCksdH0oKTtlLkZyZWVDYW1lcmFLZXlib2FyZE1vdmVJbnB1dD10LGUuQ2FtZXJhSW5wdXRUeXBlcy5GcmVlQ2FtZXJhS2V5Ym9hcmRNb3ZlSW5wdXQ9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KCl7dGhpcy5fb2Zmc2V0WD1udWxsLHRoaXMuX29mZnNldFk9bnVsbCx0aGlzLl9wb2ludGVyQ291bnQ9MCx0aGlzLl9wb2ludGVyUHJlc3NlZD1bXSx0aGlzLnRvdWNoQW5ndWxhclNlbnNpYmlsaXR5PTJlNSx0aGlzLnRvdWNoTW92ZVNlbnNpYmlsaXR5PTI1MH1yZXR1cm4gdC5wcm90b3R5cGUuYXR0YWNoQ29udHJvbD1mdW5jdGlvbih0LGkpe3ZhciByLG49dGhpczt2b2lkIDA9PT10aGlzLl9wb2ludGVySW5wdXQmJih0aGlzLl9vbkxvc3RGb2N1cz1mdW5jdGlvbihlKXtuLl9vZmZzZXRYPW51bGwsbi5fb2Zmc2V0WT1udWxsfSx0aGlzLl9wb2ludGVySW5wdXQ9ZnVuY3Rpb24odCxvKXt2YXIgcz10LmV2ZW50O2lmKFwibW91c2VcIiE9PXMucG9pbnRlclR5cGUpaWYodC50eXBlPT09ZS5Qb2ludGVyRXZlbnRUeXBlcy5QT0lOVEVSRE9XTil7aWYoaXx8cy5wcmV2ZW50RGVmYXVsdCgpLG4uX3BvaW50ZXJQcmVzc2VkLnB1c2gocy5wb2ludGVySWQpLDEhPT1uLl9wb2ludGVyUHJlc3NlZC5sZW5ndGgpcmV0dXJuO3I9e3g6cy5jbGllbnRYLHk6cy5jbGllbnRZfX1lbHNlIGlmKHQudHlwZT09PWUuUG9pbnRlckV2ZW50VHlwZXMuUE9JTlRFUlVQKXtpfHxzLnByZXZlbnREZWZhdWx0KCk7dmFyIGE9bi5fcG9pbnRlclByZXNzZWQuaW5kZXhPZihzLnBvaW50ZXJJZCk7aWYoLTE9PT1hKXJldHVybjtpZihuLl9wb2ludGVyUHJlc3NlZC5zcGxpY2UoYSwxKSwwIT1hKXJldHVybjtyPW51bGwsbi5fb2Zmc2V0WD1udWxsLG4uX29mZnNldFk9bnVsbH1lbHNlIGlmKHQudHlwZT09PWUuUG9pbnRlckV2ZW50VHlwZXMuUE9JTlRFUk1PVkUpe2lmKGl8fHMucHJldmVudERlZmF1bHQoKSwhcilyZXR1cm47dmFyIGE9bi5fcG9pbnRlclByZXNzZWQuaW5kZXhPZihzLnBvaW50ZXJJZCk7aWYoMCE9YSlyZXR1cm47bi5fb2Zmc2V0WD1zLmNsaWVudFgtci54LG4uX29mZnNldFk9LShzLmNsaWVudFktci55KX19KSx0aGlzLl9vYnNlcnZlcj10aGlzLmNhbWVyYS5nZXRTY2VuZSgpLm9uUG9pbnRlck9ic2VydmFibGUuYWRkKHRoaXMuX3BvaW50ZXJJbnB1dCxlLlBvaW50ZXJFdmVudFR5cGVzLlBPSU5URVJET1dOfGUuUG9pbnRlckV2ZW50VHlwZXMuUE9JTlRFUlVQfGUuUG9pbnRlckV2ZW50VHlwZXMuUE9JTlRFUk1PVkUpLHQuYWRkRXZlbnRMaXN0ZW5lcihcImJsdXJcIix0aGlzLl9vbkxvc3RGb2N1cyl9LHQucHJvdG90eXBlLmRldGFjaENvbnRyb2w9ZnVuY3Rpb24oZSl7dGhpcy5fcG9pbnRlcklucHV0JiZlJiYodGhpcy5jYW1lcmEuZ2V0U2NlbmUoKS5vblBvaW50ZXJPYnNlcnZhYmxlLnJlbW92ZSh0aGlzLl9vYnNlcnZlciksdGhpcy5fb2JzZXJ2ZXI9bnVsbCxlLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJibHVyXCIsdGhpcy5fb25Mb3N0Rm9jdXMpLHRoaXMuX29uTG9zdEZvY3VzPW51bGwsdGhpcy5fcG9pbnRlclByZXNzZWQ9W10sdGhpcy5fb2Zmc2V0WD1udWxsLHRoaXMuX29mZnNldFk9bnVsbCx0aGlzLl9wb2ludGVyQ291bnQ9MCl9LHQucHJvdG90eXBlLmNoZWNrSW5wdXRzPWZ1bmN0aW9uKCl7aWYodGhpcy5fb2Zmc2V0WCl7dmFyIHQ9dGhpcy5jYW1lcmE7aWYodC5jYW1lcmFSb3RhdGlvbi55Kz10aGlzLl9vZmZzZXRYL3RoaXMudG91Y2hBbmd1bGFyU2Vuc2liaWxpdHksdGhpcy5fcG9pbnRlclByZXNzZWQubGVuZ3RoPjEpdC5jYW1lcmFSb3RhdGlvbi54Kz0tdGhpcy5fb2Zmc2V0WS90aGlzLnRvdWNoQW5ndWxhclNlbnNpYmlsaXR5O2Vsc2V7dmFyIGk9dC5fY29tcHV0ZUxvY2FsQ2FtZXJhU3BlZWQoKSxyPW5ldyBlLlZlY3RvcjMoMCwwLGkqdGhpcy5fb2Zmc2V0WS90aGlzLnRvdWNoTW92ZVNlbnNpYmlsaXR5KTtlLk1hdHJpeC5Sb3RhdGlvbllhd1BpdGNoUm9sbFRvUmVmKHQucm90YXRpb24ueSx0LnJvdGF0aW9uLngsMCx0Ll9jYW1lcmFSb3RhdGlvbk1hdHJpeCksdC5jYW1lcmFEaXJlY3Rpb24uYWRkSW5QbGFjZShlLlZlY3RvcjMuVHJhbnNmb3JtQ29vcmRpbmF0ZXMocix0Ll9jYW1lcmFSb3RhdGlvbk1hdHJpeCkpfX19LHQucHJvdG90eXBlLmdldFR5cGVOYW1lPWZ1bmN0aW9uKCl7cmV0dXJuXCJGcmVlQ2FtZXJhVG91Y2hJbnB1dFwifSx0LnByb3RvdHlwZS5nZXRTaW1wbGVOYW1lPWZ1bmN0aW9uKCl7cmV0dXJuXCJ0b3VjaFwifSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSx0LnByb3RvdHlwZSxcInRvdWNoQW5ndWxhclNlbnNpYmlsaXR5XCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSx0LnByb3RvdHlwZSxcInRvdWNoTW92ZVNlbnNpYmlsaXR5XCIsdm9pZCAwKSx0fSgpO2UuRnJlZUNhbWVyYVRvdWNoSW5wdXQ9dCxlLkNhbWVyYUlucHV0VHlwZXMuRnJlZUNhbWVyYVRvdWNoSW5wdXQ9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KCl7dmFyIHQ9dGhpczt0aGlzLl9zY3JlZW5PcmllbnRhdGlvbkFuZ2xlPTAsdGhpcy5fc2NyZWVuUXVhdGVybmlvbj1uZXcgZS5RdWF0ZXJuaW9uLHRoaXMuX2FscGhhPTAsdGhpcy5fYmV0YT0wLHRoaXMuX2dhbW1hPTAsdGhpcy5fb3JpZW50YXRpb25DaGFuZ2VkPWZ1bmN0aW9uKCl7dC5fc2NyZWVuT3JpZW50YXRpb25BbmdsZT12b2lkIDAhPT13aW5kb3cub3JpZW50YXRpb24/K3dpbmRvdy5vcmllbnRhdGlvbjp3aW5kb3cuc2NyZWVuLm9yaWVudGF0aW9uJiZ3aW5kb3cuc2NyZWVuLm9yaWVudGF0aW9uLmFuZ2xlP3dpbmRvdy5zY3JlZW4ub3JpZW50YXRpb24uYW5nbGU6MCx0Ll9zY3JlZW5PcmllbnRhdGlvbkFuZ2xlPS1lLlRvb2xzLlRvUmFkaWFucyh0Ll9zY3JlZW5PcmllbnRhdGlvbkFuZ2xlLzIpLHQuX3NjcmVlblF1YXRlcm5pb24uY29weUZyb21GbG9hdHMoMCxNYXRoLnNpbih0Ll9zY3JlZW5PcmllbnRhdGlvbkFuZ2xlKSwwLE1hdGguY29zKHQuX3NjcmVlbk9yaWVudGF0aW9uQW5nbGUpKX0sdGhpcy5fZGV2aWNlT3JpZW50YXRpb249ZnVuY3Rpb24oZSl7dC5fYWxwaGE9ZS5hbHBoYSx0Ll9iZXRhPWUuYmV0YSx0Ll9nYW1tYT1lLmdhbW1hfSx0aGlzLl9jb25zdGFudFRyYW5mb3JtPW5ldyBlLlF1YXRlcm5pb24oLU1hdGguc3FydCguNSksMCwwLE1hdGguc3FydCguNSkpLHRoaXMuX29yaWVudGF0aW9uQ2hhbmdlZCgpfXJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJjYW1lcmFcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2NhbWVyYX0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX2NhbWVyYT10LHRoaXMuX2NhbWVyYS5yb3RhdGlvblF1YXRlcm5pb258fCh0aGlzLl9jYW1lcmEucm90YXRpb25RdWF0ZXJuaW9uPW5ldyBlLlF1YXRlcm5pb24pfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLHQucHJvdG90eXBlLmF0dGFjaENvbnRyb2w9ZnVuY3Rpb24oZSx0KXt3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm9yaWVudGF0aW9uY2hhbmdlXCIsdGhpcy5fb3JpZW50YXRpb25DaGFuZ2VkKSx3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImRldmljZW9yaWVudGF0aW9uXCIsdGhpcy5fZGV2aWNlT3JpZW50YXRpb24pfSx0LnByb3RvdHlwZS5kZXRhY2hDb250cm9sPWZ1bmN0aW9uKGUpe3dpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwib3JpZW50YXRpb25jaGFuZ2VcIix0aGlzLl9vcmllbnRhdGlvbkNoYW5nZWQpLHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwiZGV2aWNlb3JpZW50YXRpb25cIix0aGlzLl9kZXZpY2VPcmllbnRhdGlvbil9LHQucHJvdG90eXBlLmNoZWNrSW5wdXRzPWZ1bmN0aW9uKCl7ZS5RdWF0ZXJuaW9uLlJvdGF0aW9uWWF3UGl0Y2hSb2xsVG9SZWYoZS5Ub29scy5Ub1JhZGlhbnModGhpcy5fYWxwaGEpLGUuVG9vbHMuVG9SYWRpYW5zKHRoaXMuX2JldGEpLC1lLlRvb2xzLlRvUmFkaWFucyh0aGlzLl9nYW1tYSksdGhpcy5jYW1lcmEucm90YXRpb25RdWF0ZXJuaW9uKSx0aGlzLl9jYW1lcmEucm90YXRpb25RdWF0ZXJuaW9uLm11bHRpcGx5SW5QbGFjZSh0aGlzLl9zY3JlZW5RdWF0ZXJuaW9uKSx0aGlzLl9jYW1lcmEucm90YXRpb25RdWF0ZXJuaW9uLm11bHRpcGx5SW5QbGFjZSh0aGlzLl9jb25zdGFudFRyYW5mb3JtKSx0aGlzLl9jYW1lcmEucm90YXRpb25RdWF0ZXJuaW9uLnoqPS0xLHRoaXMuX2NhbWVyYS5yb3RhdGlvblF1YXRlcm5pb24udyo9LTF9LHQucHJvdG90eXBlLmdldFR5cGVOYW1lPWZ1bmN0aW9uKCl7cmV0dXJuXCJGcmVlQ2FtZXJhRGV2aWNlT3JpZW50YXRpb25JbnB1dFwifSx0LnByb3RvdHlwZS5nZXRTaW1wbGVOYW1lPWZ1bmN0aW9uKCl7cmV0dXJuXCJkZXZpY2VPcmllbnRhdGlvblwifSx0fSgpO2UuRnJlZUNhbWVyYURldmljZU9yaWVudGF0aW9uSW5wdXQ9dCxlLkNhbWVyYUlucHV0VHlwZXMuRnJlZUNhbWVyYURldmljZU9yaWVudGF0aW9uSW5wdXQ9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7dGhpcy5hbHBoYUNvcnJlY3Rpb249MSx0aGlzLmJldGFDb3JyZWN0aW9uPTEsdGhpcy5nYW1tYUNvcnJlY3Rpb249MSx0aGlzLl9hbHBoYT0wLHRoaXMuX2JldGE9MCx0aGlzLl9nYW1tYT0wLHRoaXMuX2RpcnR5PSExLHRoaXMuX2RldmljZU9yaWVudGF0aW9uSGFuZGxlcj10aGlzLl9vbk9yaWVudGF0aW9uRXZlbnQuYmluZCh0aGlzKX1yZXR1cm4gZS5wcm90b3R5cGUuYXR0YWNoQ29udHJvbD1mdW5jdGlvbihlLHQpe3dpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwiZGV2aWNlb3JpZW50YXRpb25cIix0aGlzLl9kZXZpY2VPcmllbnRhdGlvbkhhbmRsZXIpfSxlLnByb3RvdHlwZS5fb25PcmllbnRhdGlvbkV2ZW50PWZ1bmN0aW9uKGUpe3RoaXMuY2FtZXJhO3RoaXMuX2FscGhhPWUuYWxwaGEsdGhpcy5fYmV0YT1lLmJldGEsdGhpcy5fZ2FtbWE9ZS5nYW1tYSx0aGlzLl9kaXJ0eT0hMH0sZS5wcm90b3R5cGUuY2hlY2tJbnB1dHM9ZnVuY3Rpb24oKXtpZih0aGlzLl9kaXJ0eSl7dGhpcy5fZGlydHk9ITE7dmFyIGU9dGhpcy5fZ2FtbWE7ZT0wPmU/OTArZToyNzAtZSx0aGlzLmNhbWVyYS5yb3RhdGlvbi54PXRoaXMuZ2FtbWFDb3JyZWN0aW9uKmUvMTgwKk1hdGguUEksdGhpcy5jYW1lcmEucm90YXRpb24ueT10aGlzLmFscGhhQ29ycmVjdGlvbiotdGhpcy5fYWxwaGEvMTgwKk1hdGguUEksdGhpcy5jYW1lcmEucm90YXRpb24uej10aGlzLmJldGFDb3JyZWN0aW9uKnRoaXMuX2JldGEvMTgwKk1hdGguUEl9fSxlLnByb3RvdHlwZS5kZXRhY2hDb250cm9sPWZ1bmN0aW9uKGUpe3dpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwiZGV2aWNlb3JpZW50YXRpb25cIix0aGlzLl9kZXZpY2VPcmllbnRhdGlvbkhhbmRsZXIpfSxlLnByb3RvdHlwZS5nZXRUeXBlTmFtZT1mdW5jdGlvbigpe3JldHVyblwiRnJlZUNhbWVyYVZSRGV2aWNlT3JpZW50YXRpb25JbnB1dFwifSxlLnByb3RvdHlwZS5nZXRTaW1wbGVOYW1lPWZ1bmN0aW9uKCl7cmV0dXJuXCJWUkRldmljZU9yaWVudGF0aW9uXCJ9LGV9KCk7ZS5GcmVlQ2FtZXJhVlJEZXZpY2VPcmllbnRhdGlvbklucHV0PXQsZS5DYW1lcmFJbnB1dFR5cGVzLkZyZWVDYW1lcmFWUkRldmljZU9yaWVudGF0aW9uSW5wdXQ9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KCl7dGhpcy5nYW1lcGFkQW5ndWxhclNlbnNpYmlsaXR5PTIwMCx0aGlzLmdhbWVwYWRNb3ZlU2Vuc2liaWxpdHk9NDB9cmV0dXJuIHQucHJvdG90eXBlLmF0dGFjaENvbnRyb2w9ZnVuY3Rpb24odCxpKXt2YXIgcj10aGlzO3RoaXMuX2dhbWVwYWRzPW5ldyBlLkdhbWVwYWRzKGZ1bmN0aW9uKGUpe3IuX29uTmV3R2FtZUNvbm5lY3RlZChlKX0pfSx0LnByb3RvdHlwZS5kZXRhY2hDb250cm9sPWZ1bmN0aW9uKGUpe3RoaXMuX2dhbWVwYWRzJiZ0aGlzLl9nYW1lcGFkcy5kaXNwb3NlKCksdGhpcy5nYW1lcGFkPW51bGx9LHQucHJvdG90eXBlLmNoZWNrSW5wdXRzPWZ1bmN0aW9uKCl7aWYodGhpcy5nYW1lcGFkKXt2YXIgdD10aGlzLmNhbWVyYSxpPXRoaXMuZ2FtZXBhZC5sZWZ0U3RpY2sscj1pLngvdGhpcy5nYW1lcGFkTW92ZVNlbnNpYmlsaXR5LG49aS55L3RoaXMuZ2FtZXBhZE1vdmVTZW5zaWJpbGl0eTtpLng9TWF0aC5hYnMocik+LjAwNT8wK3I6MCxpLnk9TWF0aC5hYnMobik+LjAwNT8wK246MDt2YXIgbz10aGlzLmdhbWVwYWQucmlnaHRTdGljayxzPW8ueC90aGlzLmdhbWVwYWRBbmd1bGFyU2Vuc2liaWxpdHksYT1vLnkvdGhpcy5nYW1lcGFkQW5ndWxhclNlbnNpYmlsaXR5O28ueD1NYXRoLmFicyhzKT4uMDAxPzArczowLG8ueT1NYXRoLmFicyhhKT4uMDAxPzArYTowO3ZhciBoPWUuTWF0cml4LlJvdGF0aW9uWWF3UGl0Y2hSb2xsKHQucm90YXRpb24ueSx0LnJvdGF0aW9uLngsMCksYz01MCp0Ll9jb21wdXRlTG9jYWxDYW1lcmFTcGVlZCgpLGw9ZS5WZWN0b3IzLlRyYW5zZm9ybUNvb3JkaW5hdGVzKG5ldyBlLlZlY3RvcjMoaS54KmMsMCwtaS55KmMpLGgpO3QuY2FtZXJhRGlyZWN0aW9uPXQuY2FtZXJhRGlyZWN0aW9uLmFkZChsKSx0LmNhbWVyYVJvdGF0aW9uPXQuY2FtZXJhUm90YXRpb24uYWRkKG5ldyBlLlZlY3RvcjIoby55LG8ueCkpfX0sdC5wcm90b3R5cGUuX29uTmV3R2FtZUNvbm5lY3RlZD1mdW5jdGlvbihlKXswPT09ZS5pbmRleCYmKHRoaXMuZ2FtZXBhZD1lKX0sdC5wcm90b3R5cGUuZ2V0VHlwZU5hbWU9ZnVuY3Rpb24oKXtyZXR1cm5cIkZyZWVDYW1lcmFHYW1lcGFkSW5wdXRcIn0sdC5wcm90b3R5cGUuZ2V0U2ltcGxlTmFtZT1mdW5jdGlvbigpe3JldHVyblwiZ2FtZXBhZFwifSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSx0LnByb3RvdHlwZSxcImdhbWVwYWRBbmd1bGFyU2Vuc2liaWxpdHlcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHQucHJvdG90eXBlLFwiZ2FtZXBhZE1vdmVTZW5zaWJpbGl0eVwiLHZvaWQgMCksdH0oKTtlLkZyZWVDYW1lcmFHYW1lcGFkSW5wdXQ9dCxlLkNhbWVyYUlucHV0VHlwZXMuRnJlZUNhbWVyYUdhbWVwYWRJbnB1dD10fShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoKXt0aGlzLl9rZXlzPVtdLHRoaXMua2V5c1VwPVszOF0sdGhpcy5rZXlzRG93bj1bNDBdLHRoaXMua2V5c0xlZnQ9WzM3XSx0aGlzLmtleXNSaWdodD1bMzldfXJldHVybiB0LnByb3RvdHlwZS5hdHRhY2hDb250cm9sPWZ1bmN0aW9uKHQsaSl7dmFyIHI9dGhpczt0aGlzLl9vbktleURvd249ZnVuY3Rpb24oZSl7aWYoLTEhPT1yLmtleXNVcC5pbmRleE9mKGUua2V5Q29kZSl8fC0xIT09ci5rZXlzRG93bi5pbmRleE9mKGUua2V5Q29kZSl8fC0xIT09ci5rZXlzTGVmdC5pbmRleE9mKGUua2V5Q29kZSl8fC0xIT09ci5rZXlzUmlnaHQuaW5kZXhPZihlLmtleUNvZGUpKXt2YXIgdD1yLl9rZXlzLmluZGV4T2YoZS5rZXlDb2RlKTstMT09PXQmJnIuX2tleXMucHVzaChlLmtleUNvZGUpLGUucHJldmVudERlZmF1bHQmJihpfHxlLnByZXZlbnREZWZhdWx0KCkpfX0sdGhpcy5fb25LZXlVcD1mdW5jdGlvbihlKXtpZigtMSE9PXIua2V5c1VwLmluZGV4T2YoZS5rZXlDb2RlKXx8LTEhPT1yLmtleXNEb3duLmluZGV4T2YoZS5rZXlDb2RlKXx8LTEhPT1yLmtleXNMZWZ0LmluZGV4T2YoZS5rZXlDb2RlKXx8LTEhPT1yLmtleXNSaWdodC5pbmRleE9mKGUua2V5Q29kZSkpe3ZhciB0PXIuX2tleXMuaW5kZXhPZihlLmtleUNvZGUpO3Q+PTAmJnIuX2tleXMuc3BsaWNlKHQsMSksZS5wcmV2ZW50RGVmYXVsdCYmKGl8fGUucHJldmVudERlZmF1bHQoKSl9fSx0aGlzLl9vbkxvc3RGb2N1cz1mdW5jdGlvbigpe3IuX2tleXM9W119LGUuVG9vbHMuUmVnaXN0ZXJUb3BSb290RXZlbnRzKFt7bmFtZTpcImtleWRvd25cIixoYW5kbGVyOnRoaXMuX29uS2V5RG93bn0se25hbWU6XCJrZXl1cFwiLGhhbmRsZXI6dGhpcy5fb25LZXlVcH0se25hbWU6XCJibHVyXCIsaGFuZGxlcjp0aGlzLl9vbkxvc3RGb2N1c31dKX0sdC5wcm90b3R5cGUuZGV0YWNoQ29udHJvbD1mdW5jdGlvbih0KXtlLlRvb2xzLlVucmVnaXN0ZXJUb3BSb290RXZlbnRzKFt7bmFtZTpcImtleWRvd25cIixoYW5kbGVyOnRoaXMuX29uS2V5RG93bn0se25hbWU6XCJrZXl1cFwiLGhhbmRsZXI6dGhpcy5fb25LZXlVcH0se25hbWU6XCJibHVyXCIsaGFuZGxlcjp0aGlzLl9vbkxvc3RGb2N1c31dKSx0aGlzLl9rZXlzPVtdLHRoaXMuX29uS2V5RG93bj1udWxsLHRoaXMuX29uS2V5VXA9bnVsbCx0aGlzLl9vbkxvc3RGb2N1cz1udWxsfSx0LnByb3RvdHlwZS5jaGVja0lucHV0cz1mdW5jdGlvbigpe2lmKHRoaXMuX29uS2V5RG93bilmb3IodmFyIGU9dGhpcy5jYW1lcmEsdD0wO3Q8dGhpcy5fa2V5cy5sZW5ndGg7dCsrKXt2YXIgaT10aGlzLl9rZXlzW3RdOy0xIT09dGhpcy5rZXlzTGVmdC5pbmRleE9mKGkpP2UuaW5lcnRpYWxBbHBoYU9mZnNldC09LjAxOi0xIT09dGhpcy5rZXlzVXAuaW5kZXhPZihpKT9lLmluZXJ0aWFsQmV0YU9mZnNldC09LjAxOi0xIT09dGhpcy5rZXlzUmlnaHQuaW5kZXhPZihpKT9lLmluZXJ0aWFsQWxwaGFPZmZzZXQrPS4wMTotMSE9PXRoaXMua2V5c0Rvd24uaW5kZXhPZihpKSYmKGUuaW5lcnRpYWxCZXRhT2Zmc2V0Kz0uMDEpfX0sdC5wcm90b3R5cGUuZ2V0VHlwZU5hbWU9ZnVuY3Rpb24oKXtyZXR1cm5cIkFyY1JvdGF0ZUNhbWVyYUtleWJvYXJkTW92ZUlucHV0XCJ9LHQucHJvdG90eXBlLmdldFNpbXBsZU5hbWU9ZnVuY3Rpb24oKXtyZXR1cm5cImtleWJvYXJkXCJ9LF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHQucHJvdG90eXBlLFwia2V5c1VwXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSx0LnByb3RvdHlwZSxcImtleXNEb3duXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSx0LnByb3RvdHlwZSxcImtleXNMZWZ0XCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSx0LnByb3RvdHlwZSxcImtleXNSaWdodFwiLHZvaWQgMCksdH0oKTtlLkFyY1JvdGF0ZUNhbWVyYUtleWJvYXJkTW92ZUlucHV0PXQsZS5DYW1lcmFJbnB1dFR5cGVzLkFyY1JvdGF0ZUNhbWVyYUtleWJvYXJkTW92ZUlucHV0PXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCgpe3RoaXMud2hlZWxQcmVjaXNpb249M31yZXR1cm4gdC5wcm90b3R5cGUuYXR0YWNoQ29udHJvbD1mdW5jdGlvbih0LGkpe3ZhciByPXRoaXM7dGhpcy5fd2hlZWw9ZnVuY3Rpb24odCxuKXtpZih0LnR5cGU9PT1lLlBvaW50ZXJFdmVudFR5cGVzLlBPSU5URVJXSEVFTCl7dmFyIG89dC5ldmVudCxzPTA7by53aGVlbERlbHRhP3M9by53aGVlbERlbHRhLyg0MCpyLndoZWVsUHJlY2lzaW9uKTpvLmRldGFpbCYmKHM9LW8uZGV0YWlsL3Iud2hlZWxQcmVjaXNpb24pLHMmJihyLmNhbWVyYS5pbmVydGlhbFJhZGl1c09mZnNldCs9cyksby5wcmV2ZW50RGVmYXVsdCYmKGl8fG8ucHJldmVudERlZmF1bHQoKSl9fSx0aGlzLl9vYnNlcnZlcj10aGlzLmNhbWVyYS5nZXRTY2VuZSgpLm9uUG9pbnRlck9ic2VydmFibGUuYWRkKHRoaXMuX3doZWVsLGUuUG9pbnRlckV2ZW50VHlwZXMuUE9JTlRFUldIRUVMKX0sdC5wcm90b3R5cGUuZGV0YWNoQ29udHJvbD1mdW5jdGlvbihlKXt0aGlzLl9vYnNlcnZlciYmZSYmKHRoaXMuY2FtZXJhLmdldFNjZW5lKCkub25Qb2ludGVyT2JzZXJ2YWJsZS5yZW1vdmUodGhpcy5fb2JzZXJ2ZXIpLHRoaXMuX29ic2VydmVyPW51bGwsdGhpcy5fd2hlZWw9bnVsbCl9LHQucHJvdG90eXBlLmdldFR5cGVOYW1lPWZ1bmN0aW9uKCl7cmV0dXJuXCJBcmNSb3RhdGVDYW1lcmFNb3VzZVdoZWVsSW5wdXRcIn0sdC5wcm90b3R5cGUuZ2V0U2ltcGxlTmFtZT1mdW5jdGlvbigpe3JldHVyblwibW91c2V3aGVlbFwifSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSx0LnByb3RvdHlwZSxcIndoZWVsUHJlY2lzaW9uXCIsdm9pZCAwKSx0fSgpO2UuQXJjUm90YXRlQ2FtZXJhTW91c2VXaGVlbElucHV0PXQsZS5DYW1lcmFJbnB1dFR5cGVzLkFyY1JvdGF0ZUNhbWVyYU1vdXNlV2hlZWxJbnB1dD10fShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD0oZS5Ub29scy5HZXRQb2ludGVyUHJlZml4KCksZnVuY3Rpb24oKXtmdW5jdGlvbiB0KCl7dGhpcy5hbmd1bGFyU2Vuc2liaWxpdHlYPTFlMyx0aGlzLmFuZ3VsYXJTZW5zaWJpbGl0eVk9MWUzLHRoaXMucGluY2hQcmVjaXNpb249Nix0aGlzLnBhbm5pbmdTZW5zaWJpbGl0eT01MCx0aGlzLl9pc1JpZ2h0Q2xpY2s9ITEsdGhpcy5faXNDdHJsUHVzaGVkPSExLHRoaXMucGluY2hJbndhcmRzPSEwfXJldHVybiB0LnByb3RvdHlwZS5hdHRhY2hDb250cm9sPWZ1bmN0aW9uKHQsaSl7dmFyIHIsbixvLHM9dGhpcyxhPXRoaXMuY2FtZXJhLmdldEVuZ2luZSgpLGg9MDt0aGlzLl9wb2ludGVySW5wdXQ9ZnVuY3Rpb24odCxhKXt2YXIgYz10LmV2ZW50O2lmKHQudHlwZT09PWUuUG9pbnRlckV2ZW50VHlwZXMuUE9JTlRFUkRPV04pe3RyeXtjLnNyY0VsZW1lbnQuc2V0UG9pbnRlckNhcHR1cmUoYy5wb2ludGVySWQpfWNhdGNoKGwpe31zLl9pc1JpZ2h0Q2xpY2s9Mj09PWMuYnV0dG9uLHI9e3g6Yy5jbGllbnRYLHk6Yy5jbGllbnRZLHBvaW50ZXJJZDpjLnBvaW50ZXJJZCx0eXBlOmMucG9pbnRlclR5cGV9LHZvaWQgMD09PW4/bj1yOnZvaWQgMD09PW8mJihvPXIpLGl8fGMucHJldmVudERlZmF1bHQoKX1lbHNlIGlmKHQudHlwZT09PWUuUG9pbnRlckV2ZW50VHlwZXMuUE9JTlRFUlVQKXt0cnl7Yy5zcmNFbGVtZW50LnJlbGVhc2VQb2ludGVyQ2FwdHVyZShjLnBvaW50ZXJJZCl9Y2F0Y2gobCl7fXI9bnVsbCxoPTAsbj1vPXZvaWQgMCxpfHxjLnByZXZlbnREZWZhdWx0KCl9ZWxzZSBpZih0LnR5cGU9PT1lLlBvaW50ZXJFdmVudFR5cGVzLlBPSU5URVJNT1ZFKWlmKGl8fGMucHJldmVudERlZmF1bHQoKSxuJiZ2b2lkIDA9PT1vKXtpZigwIT09cy5wYW5uaW5nU2Vuc2liaWxpdHkmJihzLl9pc0N0cmxQdXNoZWQmJnMuY2FtZXJhLl91c2VDdHJsRm9yUGFubmluZ3x8IXMuY2FtZXJhLl91c2VDdHJsRm9yUGFubmluZyYmcy5faXNSaWdodENsaWNrKSlzLmNhbWVyYS5pbmVydGlhbFBhbm5pbmdYKz0tKGMuY2xpZW50WC1yLngpL3MucGFubmluZ1NlbnNpYmlsaXR5LHMuY2FtZXJhLmluZXJ0aWFsUGFubmluZ1krPShjLmNsaWVudFktci55KS9zLnBhbm5pbmdTZW5zaWJpbGl0eTtlbHNle3ZhciB1PWMuY2xpZW50WC1yLngsZj1jLmNsaWVudFktci55O3MuY2FtZXJhLmluZXJ0aWFsQWxwaGFPZmZzZXQtPXUvcy5hbmd1bGFyU2Vuc2liaWxpdHlYLHMuY2FtZXJhLmluZXJ0aWFsQmV0YU9mZnNldC09Zi9zLmFuZ3VsYXJTZW5zaWJpbGl0eVl9ci54PWMuY2xpZW50WCxyLnk9Yy5jbGllbnRZfWVsc2UgaWYobiYmbyl7dmFyIGQ9bi5wb2ludGVySWQ9PT1jLnBvaW50ZXJJZD9uOm87ZC54PWMuY2xpZW50WCxkLnk9Yy5jbGllbnRZO3ZhciBwPXMucGluY2hJbndhcmRzPzE6LTEsXz1uLngtby54LG09bi55LW8ueSxnPV8qXyttKm07aWYoMD09PWgpcmV0dXJuIHZvaWQoaD1nKTtnIT09aCYmKHMuY2FtZXJhLmluZXJ0aWFsUmFkaXVzT2Zmc2V0Kz0oZy1oKS8ocy5waW5jaFByZWNpc2lvbiooKHMuYW5ndWxhclNlbnNpYmlsaXR5WCtzLmFuZ3VsYXJTZW5zaWJpbGl0eVkpLzIpKnApLGg9Zyl9fSx0aGlzLl9vYnNlcnZlcj10aGlzLmNhbWVyYS5nZXRTY2VuZSgpLm9uUG9pbnRlck9ic2VydmFibGUuYWRkKHRoaXMuX3BvaW50ZXJJbnB1dCxlLlBvaW50ZXJFdmVudFR5cGVzLlBPSU5URVJET1dOfGUuUG9pbnRlckV2ZW50VHlwZXMuUE9JTlRFUlVQfGUuUG9pbnRlckV2ZW50VHlwZXMuUE9JTlRFUk1PVkUpLHRoaXMuX29uQ29udGV4dE1lbnU9ZnVuY3Rpb24oZSl7ZS5wcmV2ZW50RGVmYXVsdCgpfSx0aGlzLmNhbWVyYS5fdXNlQ3RybEZvclBhbm5pbmd8fHQuYWRkRXZlbnRMaXN0ZW5lcihcImNvbnRleHRtZW51XCIsdGhpcy5fb25Db250ZXh0TWVudSwhMSksdGhpcy5fb25Mb3N0Rm9jdXM9ZnVuY3Rpb24oKXtuPW89dm9pZCAwLGg9MCxyPW51bGx9LHRoaXMuX29uS2V5RG93bj1mdW5jdGlvbihlKXtzLl9pc0N0cmxQdXNoZWQ9ZS5jdHJsS2V5fSx0aGlzLl9vbktleVVwPWZ1bmN0aW9uKGUpe3MuX2lzQ3RybFB1c2hlZD1lLmN0cmxLZXl9LHRoaXMuX29uTW91c2VNb3ZlPWZ1bmN0aW9uKGUpe2lmKGEuaXNQb2ludGVyTG9jayl7dmFyIHQ9ZS5tb3ZlbWVudFh8fGUubW96TW92ZW1lbnRYfHxlLndlYmtpdE1vdmVtZW50WHx8ZS5tc01vdmVtZW50WHx8MCxyPWUubW92ZW1lbnRZfHxlLm1vek1vdmVtZW50WXx8ZS53ZWJraXRNb3ZlbWVudFl8fGUubXNNb3ZlbWVudFl8fDA7cy5jYW1lcmEuaW5lcnRpYWxBbHBoYU9mZnNldC09dC9zLmFuZ3VsYXJTZW5zaWJpbGl0eVgscy5jYW1lcmEuaW5lcnRpYWxCZXRhT2Zmc2V0LT1yL3MuYW5ndWxhclNlbnNpYmlsaXR5WSxpfHxlLnByZXZlbnREZWZhdWx0KCl9fSx0aGlzLl9vbkdlc3R1cmVTdGFydD1mdW5jdGlvbihlKXt2b2lkIDAhPT13aW5kb3cuTVNHZXN0dXJlJiYocy5fTVNHZXN0dXJlSGFuZGxlcnx8KHMuX01TR2VzdHVyZUhhbmRsZXI9bmV3IE1TR2VzdHVyZSxzLl9NU0dlc3R1cmVIYW5kbGVyLnRhcmdldD10KSxzLl9NU0dlc3R1cmVIYW5kbGVyLmFkZFBvaW50ZXIoZS5wb2ludGVySWQpKX0sdGhpcy5fb25HZXN0dXJlPWZ1bmN0aW9uKGUpe3MuY2FtZXJhLnJhZGl1cyo9ZS5zY2FsZSxlLnByZXZlbnREZWZhdWx0JiYoaXx8KGUuc3RvcFByb3BhZ2F0aW9uKCksZS5wcmV2ZW50RGVmYXVsdCgpKSl9LHQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLHRoaXMuX29uTW91c2VNb3ZlLCExKSx0LmFkZEV2ZW50TGlzdGVuZXIoXCJNU1BvaW50ZXJEb3duXCIsdGhpcy5fb25HZXN0dXJlU3RhcnQsITEpLHQuYWRkRXZlbnRMaXN0ZW5lcihcIk1TR2VzdHVyZUNoYW5nZVwiLHRoaXMuX29uR2VzdHVyZSwhMSksZS5Ub29scy5SZWdpc3RlclRvcFJvb3RFdmVudHMoW3tuYW1lOlwia2V5ZG93blwiLGhhbmRsZXI6dGhpcy5fb25LZXlEb3dufSx7bmFtZTpcImtleXVwXCIsaGFuZGxlcjp0aGlzLl9vbktleVVwfSx7bmFtZTpcImJsdXJcIixoYW5kbGVyOnRoaXMuX29uTG9zdEZvY3VzfV0pfSx0LnByb3RvdHlwZS5kZXRhY2hDb250cm9sPWZ1bmN0aW9uKHQpe3QmJnRoaXMuX29ic2VydmVyJiYodGhpcy5jYW1lcmEuZ2V0U2NlbmUoKS5vblBvaW50ZXJPYnNlcnZhYmxlLnJlbW92ZSh0aGlzLl9vYnNlcnZlciksdGhpcy5fb2JzZXJ2ZXI9bnVsbCx0LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjb250ZXh0bWVudVwiLHRoaXMuX29uQ29udGV4dE1lbnUpLHQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLHRoaXMuX29uTW91c2VNb3ZlKSx0LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJNU1BvaW50ZXJEb3duXCIsdGhpcy5fb25HZXN0dXJlU3RhcnQpLHQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIk1TR2VzdHVyZUNoYW5nZVwiLHRoaXMuX29uR2VzdHVyZSksdGhpcy5faXNSaWdodENsaWNrPSExLHRoaXMuX2lzQ3RybFB1c2hlZD0hMSx0aGlzLnBpbmNoSW53YXJkcz0hMCx0aGlzLl9vbktleURvd249bnVsbCx0aGlzLl9vbktleVVwPW51bGwsdGhpcy5fb25Nb3VzZU1vdmU9bnVsbCx0aGlzLl9vbkdlc3R1cmVTdGFydD1udWxsLHRoaXMuX29uR2VzdHVyZT1udWxsLHRoaXMuX01TR2VzdHVyZUhhbmRsZXI9bnVsbCx0aGlzLl9vbkxvc3RGb2N1cz1udWxsLHRoaXMuX29uQ29udGV4dE1lbnU9bnVsbCksZS5Ub29scy5VbnJlZ2lzdGVyVG9wUm9vdEV2ZW50cyhbe25hbWU6XCJrZXlkb3duXCIsaGFuZGxlcjp0aGlzLl9vbktleURvd259LHtuYW1lOlwia2V5dXBcIixoYW5kbGVyOnRoaXMuX29uS2V5VXB9LHtuYW1lOlwiYmx1clwiLGhhbmRsZXI6dGhpcy5fb25Mb3N0Rm9jdXN9XSl9LHQucHJvdG90eXBlLmdldFR5cGVOYW1lPWZ1bmN0aW9uKCl7cmV0dXJuXCJBcmNSb3RhdGVDYW1lcmFQb2ludGVyc0lucHV0XCJ9LHQucHJvdG90eXBlLmdldFNpbXBsZU5hbWU9ZnVuY3Rpb24oKXtyZXR1cm5cInBvaW50ZXJzXCJ9LF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHQucHJvdG90eXBlLFwiYW5ndWxhclNlbnNpYmlsaXR5WFwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0sdC5wcm90b3R5cGUsXCJhbmd1bGFyU2Vuc2liaWxpdHlZXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSx0LnByb3RvdHlwZSxcInBpbmNoUHJlY2lzaW9uXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSx0LnByb3RvdHlwZSxcInBhbm5pbmdTZW5zaWJpbGl0eVwiLHZvaWQgMCksdH0oKSk7ZS5BcmNSb3RhdGVDYW1lcmFQb2ludGVyc0lucHV0PXQsZS5DYW1lcmFJbnB1dFR5cGVzLkFyY1JvdGF0ZUNhbWVyYVBvaW50ZXJzSW5wdXQ9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KCl7dGhpcy5nYW1lcGFkUm90YXRpb25TZW5zaWJpbGl0eT04MCx0aGlzLmdhbWVwYWRNb3ZlU2Vuc2liaWxpdHk9NDB9cmV0dXJuIHQucHJvdG90eXBlLmF0dGFjaENvbnRyb2w9ZnVuY3Rpb24odCxpKXt2YXIgcj10aGlzO3RoaXMuX2dhbWVwYWRzPW5ldyBlLkdhbWVwYWRzKGZ1bmN0aW9uKGUpe3IuX29uTmV3R2FtZUNvbm5lY3RlZChlKX0pfSx0LnByb3RvdHlwZS5kZXRhY2hDb250cm9sPWZ1bmN0aW9uKGUpe3RoaXMuX2dhbWVwYWRzJiZ0aGlzLl9nYW1lcGFkcy5kaXNwb3NlKCksXG50aGlzLmdhbWVwYWQ9bnVsbH0sdC5wcm90b3R5cGUuY2hlY2tJbnB1dHM9ZnVuY3Rpb24oKXtpZih0aGlzLmdhbWVwYWQpe3ZhciBlPXRoaXMuY2FtZXJhLHQ9dGhpcy5nYW1lcGFkLnJpZ2h0U3RpY2s7aWYoMCE9dC54KXt2YXIgaT10LngvdGhpcy5nYW1lcGFkUm90YXRpb25TZW5zaWJpbGl0eTswIT1pJiZNYXRoLmFicyhpKT4uMDA1JiYoZS5pbmVydGlhbEFscGhhT2Zmc2V0Kz1pKX1pZigwIT10Lnkpe3ZhciByPXQueS90aGlzLmdhbWVwYWRSb3RhdGlvblNlbnNpYmlsaXR5OzAhPXImJk1hdGguYWJzKHIpPi4wMDUmJihlLmluZXJ0aWFsQmV0YU9mZnNldCs9cil9dmFyIG49dGhpcy5nYW1lcGFkLmxlZnRTdGljaztpZigwIT1uLnkpe3ZhciBvPW4ueS90aGlzLmdhbWVwYWRNb3ZlU2Vuc2liaWxpdHk7MCE9byYmTWF0aC5hYnMobyk+LjAwNSYmKHRoaXMuY2FtZXJhLmluZXJ0aWFsUmFkaXVzT2Zmc2V0LT1vKX19fSx0LnByb3RvdHlwZS5fb25OZXdHYW1lQ29ubmVjdGVkPWZ1bmN0aW9uKGUpezA9PT1lLmluZGV4JiYodGhpcy5nYW1lcGFkPWUpfSx0LnByb3RvdHlwZS5nZXRUeXBlTmFtZT1mdW5jdGlvbigpe3JldHVyblwiQXJjUm90YXRlQ2FtZXJhR2FtZXBhZElucHV0XCJ9LHQucHJvdG90eXBlLmdldFNpbXBsZU5hbWU9ZnVuY3Rpb24oKXtyZXR1cm5cImdhbWVwYWRcIn0sX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0sdC5wcm90b3R5cGUsXCJnYW1lcGFkUm90YXRpb25TZW5zaWJpbGl0eVwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0sdC5wcm90b3R5cGUsXCJnYW1lcGFkTW92ZVNlbnNpYmlsaXR5XCIsdm9pZCAwKSx0fSgpO2UuQXJjUm90YXRlQ2FtZXJhR2FtZXBhZElucHV0PXQsZS5DYW1lcmFJbnB1dFR5cGVzLkFyY1JvdGF0ZUNhbWVyYUdhbWVwYWRJbnB1dD10fShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoKXt0aGlzLmFscGhhQ29ycmVjdGlvbj0xLHRoaXMuYmV0YUNvcnJlY3Rpb249MSx0aGlzLmdhbW1hQ29ycmVjdGlvbj0xLHRoaXMuX2FscGhhPTAsdGhpcy5fYmV0YT0wLHRoaXMuX2dhbW1hPTAsdGhpcy5fZGlydHk9ITEsdGhpcy5fZGV2aWNlT3JpZW50YXRpb25IYW5kbGVyPXRoaXMuX29uT3JpZW50YXRpb25FdmVudC5iaW5kKHRoaXMpfXJldHVybiBlLnByb3RvdHlwZS5hdHRhY2hDb250cm9sPWZ1bmN0aW9uKGUsdCl7dGhpcy5jYW1lcmEuYXR0YWNoQ29udHJvbChlLHQpLHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwiZGV2aWNlb3JpZW50YXRpb25cIix0aGlzLl9kZXZpY2VPcmllbnRhdGlvbkhhbmRsZXIpfSxlLnByb3RvdHlwZS5fb25PcmllbnRhdGlvbkV2ZW50PWZ1bmN0aW9uKGUpe3RoaXMuY2FtZXJhO3RoaXMuX2FscGhhPTB8K2UuYWxwaGEsdGhpcy5fYmV0YT0wfCtlLmJldGEsdGhpcy5fZ2FtbWE9MHwrZS5nYW1tYSx0aGlzLl9kaXJ0eT0hMH0sZS5wcm90b3R5cGUuY2hlY2tJbnB1dHM9ZnVuY3Rpb24oKXt0aGlzLl9kaXJ0eSYmKHRoaXMuX2RpcnR5PSExLHRoaXMuX2dhbW1hPDAmJih0aGlzLl9nYW1tYT0xODArdGhpcy5fZ2FtbWEpLHRoaXMuY2FtZXJhLmFscGhhPS10aGlzLl9hbHBoYS8xODAqTWF0aC5QSSVNYXRoLlBJKjIsdGhpcy5jYW1lcmEuYmV0YT10aGlzLl9nYW1tYS8xODAqTWF0aC5QSSl9LGUucHJvdG90eXBlLmRldGFjaENvbnRyb2w9ZnVuY3Rpb24oZSl7d2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJkZXZpY2VvcmllbnRhdGlvblwiLHRoaXMuX2RldmljZU9yaWVudGF0aW9uSGFuZGxlcil9LGUucHJvdG90eXBlLmdldFR5cGVOYW1lPWZ1bmN0aW9uKCl7cmV0dXJuXCJBcmNSb3RhdGVDYW1lcmFWUkRldmljZU9yaWVudGF0aW9uSW5wdXRcIn0sZS5wcm90b3R5cGUuZ2V0U2ltcGxlTmFtZT1mdW5jdGlvbigpe3JldHVyblwiVlJEZXZpY2VPcmllbnRhdGlvblwifSxlfSgpO2UuQXJjUm90YXRlQ2FtZXJhVlJEZXZpY2VPcmllbnRhdGlvbklucHV0PXQsZS5DYW1lcmFJbnB1dFR5cGVzLkFyY1JvdGF0ZUNhbWVyYVZSRGV2aWNlT3JpZW50YXRpb25JbnB1dD10fShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbih0KXtmdW5jdGlvbiBpKGkscixuKXt0LmNhbGwodGhpcyxpLHIsbiksdGhpcy5jYW1lcmFEaXJlY3Rpb249bmV3IGUuVmVjdG9yMygwLDAsMCksdGhpcy5jYW1lcmFSb3RhdGlvbj1uZXcgZS5WZWN0b3IyKDAsMCksdGhpcy5yb3RhdGlvbj1uZXcgZS5WZWN0b3IzKDAsMCwwKSx0aGlzLnNwZWVkPTIsdGhpcy5ub1JvdGF0aW9uQ29uc3RyYWludD0hMSx0aGlzLmxvY2tlZFRhcmdldD1udWxsLHRoaXMuX2N1cnJlbnRUYXJnZXQ9ZS5WZWN0b3IzLlplcm8oKSx0aGlzLl92aWV3TWF0cml4PWUuTWF0cml4Llplcm8oKSx0aGlzLl9jYW1NYXRyaXg9ZS5NYXRyaXguWmVybygpLHRoaXMuX2NhbWVyYVRyYW5zZm9ybU1hdHJpeD1lLk1hdHJpeC5aZXJvKCksdGhpcy5fY2FtZXJhUm90YXRpb25NYXRyaXg9ZS5NYXRyaXguWmVybygpLHRoaXMuX3JlZmVyZW5jZVBvaW50PW5ldyBlLlZlY3RvcjMoMCwwLDEpLHRoaXMuX2RlZmF1bHRVcFZlY3Rvcj1uZXcgZS5WZWN0b3IzKDAsMSwwKSx0aGlzLl90cmFuc2Zvcm1lZFJlZmVyZW5jZVBvaW50PWUuVmVjdG9yMy5aZXJvKCksdGhpcy5fbG9va0F0VGVtcD1lLk1hdHJpeC5aZXJvKCksdGhpcy5fdGVtcE1hdHJpeD1lLk1hdHJpeC5aZXJvKCl9cmV0dXJuIF9fZXh0ZW5kcyhpLHQpLGkucHJvdG90eXBlLmdldEZyb250UG9zaXRpb249ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5nZXRUYXJnZXQoKS5zdWJ0cmFjdCh0aGlzLnBvc2l0aW9uKTtyZXR1cm4gdC5ub3JtYWxpemUoKSx0LnNjYWxlSW5QbGFjZShlKSx0aGlzLmdsb2JhbFBvc2l0aW9uLmFkZCh0KX0saS5wcm90b3R5cGUuX2dldExvY2tlZFRhcmdldFBvc2l0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubG9ja2VkVGFyZ2V0P3RoaXMubG9ja2VkVGFyZ2V0LnBvc2l0aW9ufHx0aGlzLmxvY2tlZFRhcmdldDpudWxsfSxpLnByb3RvdHlwZS5faW5pdENhY2hlPWZ1bmN0aW9uKCl7dC5wcm90b3R5cGUuX2luaXRDYWNoZS5jYWxsKHRoaXMpLHRoaXMuX2NhY2hlLmxvY2tlZFRhcmdldD1uZXcgZS5WZWN0b3IzKE51bWJlci5NQVhfVkFMVUUsTnVtYmVyLk1BWF9WQUxVRSxOdW1iZXIuTUFYX1ZBTFVFKSx0aGlzLl9jYWNoZS5yb3RhdGlvbj1uZXcgZS5WZWN0b3IzKE51bWJlci5NQVhfVkFMVUUsTnVtYmVyLk1BWF9WQUxVRSxOdW1iZXIuTUFYX1ZBTFVFKSx0aGlzLl9jYWNoZS5yb3RhdGlvblF1YXRlcm5pb249bmV3IGUuUXVhdGVybmlvbihOdW1iZXIuTUFYX1ZBTFVFLE51bWJlci5NQVhfVkFMVUUsTnVtYmVyLk1BWF9WQUxVRSxOdW1iZXIuTUFYX1ZBTFVFKX0saS5wcm90b3R5cGUuX3VwZGF0ZUNhY2hlPWZ1bmN0aW9uKGUpe2V8fHQucHJvdG90eXBlLl91cGRhdGVDYWNoZS5jYWxsKHRoaXMpO3ZhciBpPXRoaXMuX2dldExvY2tlZFRhcmdldFBvc2l0aW9uKCk7aT90aGlzLl9jYWNoZS5sb2NrZWRUYXJnZXQ/dGhpcy5fY2FjaGUubG9ja2VkVGFyZ2V0LmNvcHlGcm9tKGkpOnRoaXMuX2NhY2hlLmxvY2tlZFRhcmdldD1pLmNsb25lKCk6dGhpcy5fY2FjaGUubG9ja2VkVGFyZ2V0PW51bGwsdGhpcy5fY2FjaGUucm90YXRpb24uY29weUZyb20odGhpcy5yb3RhdGlvbiksdGhpcy5yb3RhdGlvblF1YXRlcm5pb24mJnRoaXMuX2NhY2hlLnJvdGF0aW9uUXVhdGVybmlvbi5jb3B5RnJvbSh0aGlzLnJvdGF0aW9uUXVhdGVybmlvbil9LGkucHJvdG90eXBlLl9pc1N5bmNocm9uaXplZFZpZXdNYXRyaXg9ZnVuY3Rpb24oKXtpZighdC5wcm90b3R5cGUuX2lzU3luY2hyb25pemVkVmlld01hdHJpeC5jYWxsKHRoaXMpKXJldHVybiExO3ZhciBlPXRoaXMuX2dldExvY2tlZFRhcmdldFBvc2l0aW9uKCk7cmV0dXJuKHRoaXMuX2NhY2hlLmxvY2tlZFRhcmdldD90aGlzLl9jYWNoZS5sb2NrZWRUYXJnZXQuZXF1YWxzKGUpOiFlKSYmKHRoaXMucm90YXRpb25RdWF0ZXJuaW9uP3RoaXMucm90YXRpb25RdWF0ZXJuaW9uLmVxdWFscyh0aGlzLl9jYWNoZS5yb3RhdGlvblF1YXRlcm5pb24pOnRoaXMuX2NhY2hlLnJvdGF0aW9uLmVxdWFscyh0aGlzLnJvdGF0aW9uKSl9LGkucHJvdG90eXBlLl9jb21wdXRlTG9jYWxDYW1lcmFTcGVlZD1mdW5jdGlvbigpe3ZhciBlPXRoaXMuZ2V0RW5naW5lKCk7cmV0dXJuIHRoaXMuc3BlZWQqKGUuZ2V0RGVsdGFUaW1lKCkvKDEwKmUuZ2V0RnBzKCkpKX0saS5wcm90b3R5cGUuc2V0VGFyZ2V0PWZ1bmN0aW9uKHQpe3RoaXMudXBWZWN0b3Iubm9ybWFsaXplKCksZS5NYXRyaXguTG9va0F0TEhUb1JlZih0aGlzLnBvc2l0aW9uLHQsdGhpcy5fZGVmYXVsdFVwVmVjdG9yLHRoaXMuX2NhbU1hdHJpeCksdGhpcy5fY2FtTWF0cml4LmludmVydCgpLHRoaXMucm90YXRpb24ueD1NYXRoLmF0YW4odGhpcy5fY2FtTWF0cml4Lm1bNl0vdGhpcy5fY2FtTWF0cml4Lm1bMTBdKTt2YXIgaT10LnN1YnRyYWN0KHRoaXMucG9zaXRpb24pO2kueD49MD90aGlzLnJvdGF0aW9uLnk9LU1hdGguYXRhbihpLnovaS54KStNYXRoLlBJLzI6dGhpcy5yb3RhdGlvbi55PS1NYXRoLmF0YW4oaS56L2kueCktTWF0aC5QSS8yLHRoaXMucm90YXRpb24uej0wLGlzTmFOKHRoaXMucm90YXRpb24ueCkmJih0aGlzLnJvdGF0aW9uLng9MCksaXNOYU4odGhpcy5yb3RhdGlvbi55KSYmKHRoaXMucm90YXRpb24ueT0wKSxpc05hTih0aGlzLnJvdGF0aW9uLnopJiYodGhpcy5yb3RhdGlvbi56PTApLHRoaXMucm90YXRpb25RdWF0ZXJuaW9uJiZlLlF1YXRlcm5pb24uUm90YXRpb25ZYXdQaXRjaFJvbGxUb1JlZih0aGlzLnJvdGF0aW9uLnksdGhpcy5yb3RhdGlvbi54LHRoaXMucm90YXRpb24ueix0aGlzLnJvdGF0aW9uUXVhdGVybmlvbil9LGkucHJvdG90eXBlLmdldFRhcmdldD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9jdXJyZW50VGFyZ2V0fSxpLnByb3RvdHlwZS5fZGVjaWRlSWZOZWVkc1RvTW92ZT1mdW5jdGlvbigpe3JldHVybiBNYXRoLmFicyh0aGlzLmNhbWVyYURpcmVjdGlvbi54KT4wfHxNYXRoLmFicyh0aGlzLmNhbWVyYURpcmVjdGlvbi55KT4wfHxNYXRoLmFicyh0aGlzLmNhbWVyYURpcmVjdGlvbi56KT4wfSxpLnByb3RvdHlwZS5fdXBkYXRlUG9zaXRpb249ZnVuY3Rpb24oKXt0aGlzLnBvc2l0aW9uLmFkZEluUGxhY2UodGhpcy5jYW1lcmFEaXJlY3Rpb24pfSxpLnByb3RvdHlwZS5fY2hlY2tJbnB1dHM9ZnVuY3Rpb24oKXt2YXIgaT10aGlzLl9kZWNpZGVJZk5lZWRzVG9Nb3ZlKCkscj1NYXRoLmFicyh0aGlzLmNhbWVyYVJvdGF0aW9uLngpPjB8fE1hdGguYWJzKHRoaXMuY2FtZXJhUm90YXRpb24ueSk+MDtpZihpJiZ0aGlzLl91cGRhdGVQb3NpdGlvbigpLHImJih0aGlzLnJvdGF0aW9uLngrPXRoaXMuY2FtZXJhUm90YXRpb24ueCx0aGlzLnJvdGF0aW9uLnkrPXRoaXMuY2FtZXJhUm90YXRpb24ueSwhdGhpcy5ub1JvdGF0aW9uQ29uc3RyYWludCkpe3ZhciBuPU1hdGguUEkvMiouOTU7dGhpcy5yb3RhdGlvbi54Pm4mJih0aGlzLnJvdGF0aW9uLng9biksdGhpcy5yb3RhdGlvbi54PC1uJiYodGhpcy5yb3RhdGlvbi54PS1uKX1pJiYoTWF0aC5hYnModGhpcy5jYW1lcmFEaXJlY3Rpb24ueCk8ZS5FcHNpbG9uJiYodGhpcy5jYW1lcmFEaXJlY3Rpb24ueD0wKSxNYXRoLmFicyh0aGlzLmNhbWVyYURpcmVjdGlvbi55KTxlLkVwc2lsb24mJih0aGlzLmNhbWVyYURpcmVjdGlvbi55PTApLE1hdGguYWJzKHRoaXMuY2FtZXJhRGlyZWN0aW9uLnopPGUuRXBzaWxvbiYmKHRoaXMuY2FtZXJhRGlyZWN0aW9uLno9MCksdGhpcy5jYW1lcmFEaXJlY3Rpb24uc2NhbGVJblBsYWNlKHRoaXMuaW5lcnRpYSkpLHImJihNYXRoLmFicyh0aGlzLmNhbWVyYVJvdGF0aW9uLngpPGUuRXBzaWxvbiYmKHRoaXMuY2FtZXJhUm90YXRpb24ueD0wKSxNYXRoLmFicyh0aGlzLmNhbWVyYVJvdGF0aW9uLnkpPGUuRXBzaWxvbiYmKHRoaXMuY2FtZXJhUm90YXRpb24ueT0wKSx0aGlzLmNhbWVyYVJvdGF0aW9uLnNjYWxlSW5QbGFjZSh0aGlzLmluZXJ0aWEpKSx0LnByb3RvdHlwZS5fY2hlY2tJbnB1dHMuY2FsbCh0aGlzKX0saS5wcm90b3R5cGUuX3VwZGF0ZUNhbWVyYVJvdGF0aW9uTWF0cml4PWZ1bmN0aW9uKCl7dGhpcy5yb3RhdGlvblF1YXRlcm5pb24/KHRoaXMucm90YXRpb25RdWF0ZXJuaW9uLnRvUm90YXRpb25NYXRyaXgodGhpcy5fY2FtZXJhUm90YXRpb25NYXRyaXgpLGUuVmVjdG9yMy5UcmFuc2Zvcm1Ob3JtYWxUb1JlZih0aGlzLl9kZWZhdWx0VXBWZWN0b3IsdGhpcy5fY2FtZXJhUm90YXRpb25NYXRyaXgsdGhpcy51cFZlY3RvcikpOmUuTWF0cml4LlJvdGF0aW9uWWF3UGl0Y2hSb2xsVG9SZWYodGhpcy5yb3RhdGlvbi55LHRoaXMucm90YXRpb24ueCx0aGlzLnJvdGF0aW9uLnosdGhpcy5fY2FtZXJhUm90YXRpb25NYXRyaXgpfSxpLnByb3RvdHlwZS5fZ2V0Vmlld01hdHJpeD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmxvY2tlZFRhcmdldD90aGlzLl9jdXJyZW50VGFyZ2V0LmNvcHlGcm9tKHRoaXMuX2dldExvY2tlZFRhcmdldFBvc2l0aW9uKCkpOih0aGlzLl91cGRhdGVDYW1lcmFSb3RhdGlvbk1hdHJpeCgpLGUuVmVjdG9yMy5UcmFuc2Zvcm1Db29yZGluYXRlc1RvUmVmKHRoaXMuX3JlZmVyZW5jZVBvaW50LHRoaXMuX2NhbWVyYVJvdGF0aW9uTWF0cml4LHRoaXMuX3RyYW5zZm9ybWVkUmVmZXJlbmNlUG9pbnQpLHRoaXMucG9zaXRpb24uYWRkVG9SZWYodGhpcy5fdHJhbnNmb3JtZWRSZWZlcmVuY2VQb2ludCx0aGlzLl9jdXJyZW50VGFyZ2V0KSksZS5NYXRyaXguTG9va0F0TEhUb1JlZih0aGlzLnBvc2l0aW9uLHRoaXMuX2N1cnJlbnRUYXJnZXQsdGhpcy51cFZlY3Rvcix0aGlzLl92aWV3TWF0cml4KSx0aGlzLl92aWV3TWF0cml4fSxpLnByb3RvdHlwZS5jcmVhdGVSaWdDYW1lcmE9ZnVuY3Rpb24odCxyKXtpZih0aGlzLmNhbWVyYVJpZ01vZGUhPT1lLkNhbWVyYS5SSUdfTU9ERV9OT05FKXt2YXIgbj1uZXcgaSh0LHRoaXMucG9zaXRpb24uY2xvbmUoKSx0aGlzLmdldFNjZW5lKCkpO3JldHVybiB0aGlzLmNhbWVyYVJpZ01vZGU9PT1lLkNhbWVyYS5SSUdfTU9ERV9WUiYmKHRoaXMucm90YXRpb25RdWF0ZXJuaW9ufHwodGhpcy5yb3RhdGlvblF1YXRlcm5pb249bmV3IGUuUXVhdGVybmlvbiksbi5fY2FtZXJhUmlnUGFyYW1zPXt9LG4ucm90YXRpb25RdWF0ZXJuaW9uPW5ldyBlLlF1YXRlcm5pb24pLG59cmV0dXJuIG51bGx9LGkucHJvdG90eXBlLl91cGRhdGVSaWdDYW1lcmFzPWZ1bmN0aW9uKCl7dmFyIGk9dGhpcy5fcmlnQ2FtZXJhc1swXSxyPXRoaXMuX3JpZ0NhbWVyYXNbMV07c3dpdGNoKHRoaXMuY2FtZXJhUmlnTW9kZSl7Y2FzZSBlLkNhbWVyYS5SSUdfTU9ERV9TVEVSRU9TQ09QSUNfQU5BR0xZUEg6Y2FzZSBlLkNhbWVyYS5SSUdfTU9ERV9TVEVSRU9TQ09QSUNfU0lERUJZU0lERV9QQVJBTExFTDpjYXNlIGUuQ2FtZXJhLlJJR19NT0RFX1NURVJFT1NDT1BJQ19TSURFQllTSURFX0NST1NTRVlFRDpjYXNlIGUuQ2FtZXJhLlJJR19NT0RFX1NURVJFT1NDT1BJQ19PVkVSVU5ERVI6dmFyIG49dGhpcy5jYW1lcmFSaWdNb2RlPT09ZS5DYW1lcmEuUklHX01PREVfU1RFUkVPU0NPUElDX1NJREVCWVNJREVfQ1JPU1NFWUVEPzE6LTEsbz10aGlzLmNhbWVyYVJpZ01vZGU9PT1lLkNhbWVyYS5SSUdfTU9ERV9TVEVSRU9TQ09QSUNfU0lERUJZU0lERV9DUk9TU0VZRUQ/LTE6MTt0aGlzLl9nZXRSaWdDYW1Qb3NpdGlvbih0aGlzLl9jYW1lcmFSaWdQYXJhbXMuc3RlcmVvSGFsZkFuZ2xlKm4saS5wb3NpdGlvbiksdGhpcy5fZ2V0UmlnQ2FtUG9zaXRpb24odGhpcy5fY2FtZXJhUmlnUGFyYW1zLnN0ZXJlb0hhbGZBbmdsZSpvLHIucG9zaXRpb24pLGkuc2V0VGFyZ2V0KHRoaXMuZ2V0VGFyZ2V0KCkpLHIuc2V0VGFyZ2V0KHRoaXMuZ2V0VGFyZ2V0KCkpO2JyZWFrO2Nhc2UgZS5DYW1lcmEuUklHX01PREVfVlI6aS5yb3RhdGlvblF1YXRlcm5pb24uY29weUZyb20odGhpcy5yb3RhdGlvblF1YXRlcm5pb24pLHIucm90YXRpb25RdWF0ZXJuaW9uLmNvcHlGcm9tKHRoaXMucm90YXRpb25RdWF0ZXJuaW9uKSxpLnBvc2l0aW9uLmNvcHlGcm9tKHRoaXMucG9zaXRpb24pLHIucG9zaXRpb24uY29weUZyb20odGhpcy5wb3NpdGlvbil9dC5wcm90b3R5cGUuX3VwZGF0ZVJpZ0NhbWVyYXMuY2FsbCh0aGlzKX0saS5wcm90b3R5cGUuX2dldFJpZ0NhbVBvc2l0aW9uPWZ1bmN0aW9uKHQsaSl7dGhpcy5fcmlnQ2FtVHJhbnNmb3JtTWF0cml4fHwodGhpcy5fcmlnQ2FtVHJhbnNmb3JtTWF0cml4PW5ldyBlLk1hdHJpeCk7dmFyIHI9dGhpcy5nZXRUYXJnZXQoKTtlLk1hdHJpeC5UcmFuc2xhdGlvbigtci54LC1yLnksLXIueikubXVsdGlwbHlUb1JlZihlLk1hdHJpeC5Sb3RhdGlvblkodCksdGhpcy5fcmlnQ2FtVHJhbnNmb3JtTWF0cml4KSx0aGlzLl9yaWdDYW1UcmFuc2Zvcm1NYXRyaXg9dGhpcy5fcmlnQ2FtVHJhbnNmb3JtTWF0cml4Lm11bHRpcGx5KGUuTWF0cml4LlRyYW5zbGF0aW9uKHIueCxyLnksci56KSksZS5WZWN0b3IzLlRyYW5zZm9ybUNvb3JkaW5hdGVzVG9SZWYodGhpcy5wb3NpdGlvbix0aGlzLl9yaWdDYW1UcmFuc2Zvcm1NYXRyaXgsaSl9LGkucHJvdG90eXBlLmdldFR5cGVOYW1lPWZ1bmN0aW9uKCl7cmV0dXJuXCJUYXJnZXRDYW1lcmFcIn0sX19kZWNvcmF0ZShbZS5zZXJpYWxpemVBc1ZlY3RvcjMoKV0saS5wcm90b3R5cGUsXCJyb3RhdGlvblwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0saS5wcm90b3R5cGUsXCJzcGVlZFwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemVBc01lc2hSZWZlcmVuY2UoXCJsb2NrZWRUYXJnZXRJZFwiKV0saS5wcm90b3R5cGUsXCJsb2NrZWRUYXJnZXRcIix2b2lkIDApLGl9KGUuQ2FtZXJhKTtlLlRhcmdldENhbWVyYT10fShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbih0KXtmdW5jdGlvbiBpKGkscixuKXt2YXIgbz10aGlzO3QuY2FsbCh0aGlzLGkscixuKSx0aGlzLmVsbGlwc29pZD1uZXcgZS5WZWN0b3IzKC41LDEsLjUpLHRoaXMuY2hlY2tDb2xsaXNpb25zPSExLHRoaXMuYXBwbHlHcmF2aXR5PSExLHRoaXMuX2NvbGxpZGVyPW5ldyBlLkNvbGxpZGVyLHRoaXMuX25lZWRNb3ZlRm9yR3Jhdml0eT0hMSx0aGlzLl9vbGRQb3NpdGlvbj1lLlZlY3RvcjMuWmVybygpLHRoaXMuX2RpZmZQb3NpdGlvbj1lLlZlY3RvcjMuWmVybygpLHRoaXMuX25ld1Bvc2l0aW9uPWUuVmVjdG9yMy5aZXJvKCksdGhpcy5fb25Db2xsaXNpb25Qb3NpdGlvbkNoYW5nZT1mdW5jdGlvbih0LGkscil7dm9pZCAwPT09ciYmKHI9bnVsbCksby5nZXRTY2VuZSgpLndvcmtlckNvbGxpc2lvbnMmJmkubXVsdGlwbHlJblBsYWNlKG8uX2NvbGxpZGVyLnJhZGl1cyk7dmFyIG49ZnVuY3Rpb24odCl7by5fbmV3UG9zaXRpb24uY29weUZyb20odCksby5fbmV3UG9zaXRpb24uc3VidHJhY3RUb1JlZihvLl9vbGRQb3NpdGlvbixvLl9kaWZmUG9zaXRpb24pO28ucG9zaXRpb24uY2xvbmUoKTtvLl9kaWZmUG9zaXRpb24ubGVuZ3RoKCk+ZS5FbmdpbmUuQ29sbGlzaW9uc0Vwc2lsb24mJihvLnBvc2l0aW9uLmFkZEluUGxhY2Uoby5fZGlmZlBvc2l0aW9uKSxvLm9uQ29sbGlkZSYmciYmby5vbkNvbGxpZGUocikpfTtuKGkpfSx0aGlzLmlucHV0cz1uZXcgZS5GcmVlQ2FtZXJhSW5wdXRzTWFuYWdlcih0aGlzKSx0aGlzLmlucHV0cy5hZGRLZXlib2FyZCgpLmFkZE1vdXNlKCl9cmV0dXJuIF9fZXh0ZW5kcyhpLHQpLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcImFuZ3VsYXJTZW5zaWJpbGl0eVwiLHtnZXQ6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLmlucHV0cy5hdHRhY2hlZC5tb3VzZTtyZXR1cm4gZT9lLmFuZ3VsYXJTZW5zaWJpbGl0eTp2b2lkIDB9LHNldDpmdW5jdGlvbihlKXt2YXIgdD10aGlzLmlucHV0cy5hdHRhY2hlZC5tb3VzZTt0JiYodC5hbmd1bGFyU2Vuc2liaWxpdHk9ZSl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGkucHJvdG90eXBlLFwia2V5c1VwXCIse2dldDpmdW5jdGlvbigpe3ZhciBlPXRoaXMuaW5wdXRzLmF0dGFjaGVkLmtleWJvYXJkO3JldHVybiBlP2Uua2V5c1VwOnZvaWQgMH0sc2V0OmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuaW5wdXRzLmF0dGFjaGVkLmtleWJvYXJkO3QmJih0LmtleXNVcD1lKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJrZXlzRG93blwiLHtnZXQ6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLmlucHV0cy5hdHRhY2hlZC5rZXlib2FyZDtyZXR1cm4gZT9lLmtleXNEb3duOnZvaWQgMH0sc2V0OmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuaW5wdXRzLmF0dGFjaGVkLmtleWJvYXJkO3QmJih0LmtleXNEb3duPWUpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcImtleXNMZWZ0XCIse2dldDpmdW5jdGlvbigpe3ZhciBlPXRoaXMuaW5wdXRzLmF0dGFjaGVkLmtleWJvYXJkO3JldHVybiBlP2Uua2V5c0xlZnQ6dm9pZCAwfSxzZXQ6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5pbnB1dHMuYXR0YWNoZWQua2V5Ym9hcmQ7dCYmKHQua2V5c0xlZnQ9ZSl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGkucHJvdG90eXBlLFwia2V5c1JpZ2h0XCIse2dldDpmdW5jdGlvbigpe3ZhciBlPXRoaXMuaW5wdXRzLmF0dGFjaGVkLmtleWJvYXJkO3JldHVybiBlP2Uua2V5c1JpZ2h0OnZvaWQgMH0sc2V0OmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuaW5wdXRzLmF0dGFjaGVkLmtleWJvYXJkO3QmJih0LmtleXNSaWdodD1lKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxpLnByb3RvdHlwZS5hdHRhY2hDb250cm9sPWZ1bmN0aW9uKGUsdCl7dGhpcy5pbnB1dHMuYXR0YWNoRWxlbWVudChlLHQpfSxpLnByb3RvdHlwZS5kZXRhY2hDb250cm9sPWZ1bmN0aW9uKHQpe3RoaXMuaW5wdXRzLmRldGFjaEVsZW1lbnQodCksdGhpcy5jYW1lcmFEaXJlY3Rpb249bmV3IGUuVmVjdG9yMygwLDAsMCksdGhpcy5jYW1lcmFSb3RhdGlvbj1uZXcgZS5WZWN0b3IyKDAsMCl9LGkucHJvdG90eXBlLl9jb2xsaWRlV2l0aFdvcmxkPWZ1bmN0aW9uKHQpe3ZhciBpO2k9dGhpcy5wYXJlbnQ/ZS5WZWN0b3IzLlRyYW5zZm9ybUNvb3JkaW5hdGVzKHRoaXMucG9zaXRpb24sdGhpcy5wYXJlbnQuZ2V0V29ybGRNYXRyaXgoKSk6dGhpcy5wb3NpdGlvbixpLnN1YnRyYWN0RnJvbUZsb2F0c1RvUmVmKDAsdGhpcy5lbGxpcHNvaWQueSwwLHRoaXMuX29sZFBvc2l0aW9uKSx0aGlzLl9jb2xsaWRlci5yYWRpdXM9dGhpcy5lbGxpcHNvaWQ7dmFyIHI9dDt0aGlzLmFwcGx5R3Jhdml0eSYmKHI9dC5hZGQodGhpcy5nZXRTY2VuZSgpLmdyYXZpdHkpKSx0aGlzLmdldFNjZW5lKCkuY29sbGlzaW9uQ29vcmRpbmF0b3IuZ2V0TmV3UG9zaXRpb24odGhpcy5fb2xkUG9zaXRpb24scix0aGlzLl9jb2xsaWRlciwzLG51bGwsdGhpcy5fb25Db2xsaXNpb25Qb3NpdGlvbkNoYW5nZSx0aGlzLnVuaXF1ZUlkKX0saS5wcm90b3R5cGUuX2NoZWNrSW5wdXRzPWZ1bmN0aW9uKCl7dGhpcy5fbG9jYWxEaXJlY3Rpb258fCh0aGlzLl9sb2NhbERpcmVjdGlvbj1lLlZlY3RvcjMuWmVybygpLHRoaXMuX3RyYW5zZm9ybWVkRGlyZWN0aW9uPWUuVmVjdG9yMy5aZXJvKCkpLHRoaXMuaW5wdXRzLmNoZWNrSW5wdXRzKCksdC5wcm90b3R5cGUuX2NoZWNrSW5wdXRzLmNhbGwodGhpcyl9LGkucHJvdG90eXBlLl9kZWNpZGVJZk5lZWRzVG9Nb3ZlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX25lZWRNb3ZlRm9yR3Jhdml0eXx8TWF0aC5hYnModGhpcy5jYW1lcmFEaXJlY3Rpb24ueCk+MHx8TWF0aC5hYnModGhpcy5jYW1lcmFEaXJlY3Rpb24ueSk+MHx8TWF0aC5hYnModGhpcy5jYW1lcmFEaXJlY3Rpb24ueik+MH0saS5wcm90b3R5cGUuX3VwZGF0ZVBvc2l0aW9uPWZ1bmN0aW9uKCl7dGhpcy5jaGVja0NvbGxpc2lvbnMmJnRoaXMuZ2V0U2NlbmUoKS5jb2xsaXNpb25zRW5hYmxlZD90aGlzLl9jb2xsaWRlV2l0aFdvcmxkKHRoaXMuY2FtZXJhRGlyZWN0aW9uKTp0aGlzLnBvc2l0aW9uLmFkZEluUGxhY2UodGhpcy5jYW1lcmFEaXJlY3Rpb24pfSxpLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7dGhpcy5pbnB1dHMuY2xlYXIoKSx0LnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyl9LGkucHJvdG90eXBlLmdldFR5cGVOYW1lPWZ1bmN0aW9uKCl7cmV0dXJuXCJGcmVlQ2FtZXJhXCJ9LF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplQXNWZWN0b3IzKCldLGkucHJvdG90eXBlLFwiZWxsaXBzb2lkXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSxpLnByb3RvdHlwZSxcImNoZWNrQ29sbGlzaW9uc1wiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0saS5wcm90b3R5cGUsXCJhcHBseUdyYXZpdHlcIix2b2lkIDApLGl9KGUuVGFyZ2V0Q2FtZXJhKTtlLkZyZWVDYW1lcmE9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gaShlKXt0LmNhbGwodGhpcyxlKX1yZXR1cm4gX19leHRlbmRzKGksdCksaS5wcm90b3R5cGUuYWRkS2V5Ym9hcmQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hZGQobmV3IGUuRnJlZUNhbWVyYUtleWJvYXJkTW92ZUlucHV0KSx0aGlzfSxpLnByb3RvdHlwZS5hZGRNb3VzZT1mdW5jdGlvbih0KXtyZXR1cm4gdm9pZCAwPT09dCYmKHQ9ITApLHRoaXMuYWRkKG5ldyBlLkZyZWVDYW1lcmFNb3VzZUlucHV0KHQpKSx0aGlzfSxpLnByb3RvdHlwZS5hZGRHYW1lcGFkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYWRkKG5ldyBlLkZyZWVDYW1lcmFHYW1lcGFkSW5wdXQpLHRoaXN9LGkucHJvdG90eXBlLmFkZERldmljZU9yaWVudGF0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYWRkKG5ldyBlLkZyZWVDYW1lcmFEZXZpY2VPcmllbnRhdGlvbklucHV0KSx0aGlzfSxpLnByb3RvdHlwZS5hZGRWUkRldmljZU9yaWVudGF0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYWRkKG5ldyBlLkZyZWVDYW1lcmFWUkRldmljZU9yaWVudGF0aW9uSW5wdXQpLHRoaXN9LGkucHJvdG90eXBlLmFkZFRvdWNoPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYWRkKG5ldyBlLkZyZWVDYW1lcmFUb3VjaElucHV0KSx0aGlzfSxpLnByb3RvdHlwZS5hZGRWaXJ0dWFsSm95c3RpY2s9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hZGQobmV3IGUuRnJlZUNhbWVyYVZpcnR1YWxKb3lzdGlja0lucHV0KSx0aGlzfSxpfShlLkNhbWVyYUlucHV0c01hbmFnZXIpO2UuRnJlZUNhbWVyYUlucHV0c01hbmFnZXI9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gaShlLGkscixuKXt0LmNhbGwodGhpcyxlLGksciksdGhpcy5yYWRpdXM9MTIsdGhpcy5yb3RhdGlvbk9mZnNldD0wLHRoaXMuaGVpZ2h0T2Zmc2V0PTQsdGhpcy5jYW1lcmFBY2NlbGVyYXRpb249LjA1LHRoaXMubWF4Q2FtZXJhU3BlZWQ9MjAsdGhpcy50YXJnZXQ9bn1yZXR1cm4gX19leHRlbmRzKGksdCksaS5wcm90b3R5cGUuZ2V0UmFkaWFucz1mdW5jdGlvbihlKXtyZXR1cm4gZSpNYXRoLlBJLzE4MH0saS5wcm90b3R5cGUuZm9sbG93PWZ1bmN0aW9uKHQpe2lmKHQpe3ZhciBpO2lmKHQucm90YXRpb25RdWF0ZXJuaW9uKXt2YXIgcj1uZXcgZS5NYXRyaXg7dC5yb3RhdGlvblF1YXRlcm5pb24udG9Sb3RhdGlvbk1hdHJpeChyKSxpPU1hdGguYXRhbjIoci5tWzhdLHIubVsxMF0pfWVsc2UgaT10LnJvdGF0aW9uLnk7dmFyIG49dGhpcy5nZXRSYWRpYW5zKHRoaXMucm90YXRpb25PZmZzZXQpK2ksbz10LnBvc2l0aW9uLngrTWF0aC5zaW4obikqdGhpcy5yYWRpdXMscz10LnBvc2l0aW9uLnorTWF0aC5jb3MobikqdGhpcy5yYWRpdXMsYT1vLXRoaXMucG9zaXRpb24ueCxoPXQucG9zaXRpb24ueSt0aGlzLmhlaWdodE9mZnNldC10aGlzLnBvc2l0aW9uLnksYz1zLXRoaXMucG9zaXRpb24ueixsPWEqdGhpcy5jYW1lcmFBY2NlbGVyYXRpb24qMix1PWgqdGhpcy5jYW1lcmFBY2NlbGVyYXRpb24sZj1jKnRoaXMuY2FtZXJhQWNjZWxlcmF0aW9uKjI7KGw+dGhpcy5tYXhDYW1lcmFTcGVlZHx8bDwtdGhpcy5tYXhDYW1lcmFTcGVlZCkmJihsPTE+bD8tdGhpcy5tYXhDYW1lcmFTcGVlZDp0aGlzLm1heENhbWVyYVNwZWVkKSwodT50aGlzLm1heENhbWVyYVNwZWVkfHx1PC10aGlzLm1heENhbWVyYVNwZWVkKSYmKHU9MT51Py10aGlzLm1heENhbWVyYVNwZWVkOnRoaXMubWF4Q2FtZXJhU3BlZWQpLChmPnRoaXMubWF4Q2FtZXJhU3BlZWR8fGY8LXRoaXMubWF4Q2FtZXJhU3BlZWQpJiYoZj0xPmY/LXRoaXMubWF4Q2FtZXJhU3BlZWQ6dGhpcy5tYXhDYW1lcmFTcGVlZCksdGhpcy5wb3NpdGlvbj1uZXcgZS5WZWN0b3IzKHRoaXMucG9zaXRpb24ueCtsLHRoaXMucG9zaXRpb24ueSt1LHRoaXMucG9zaXRpb24ueitmKSx0aGlzLnNldFRhcmdldCh0LnBvc2l0aW9uKX19LGkucHJvdG90eXBlLl9jaGVja0lucHV0cz1mdW5jdGlvbigpe3QucHJvdG90eXBlLl9jaGVja0lucHV0cy5jYWxsKHRoaXMpLHRoaXMuZm9sbG93KHRoaXMudGFyZ2V0KX0saS5wcm90b3R5cGUuZ2V0VHlwZU5hbWU9ZnVuY3Rpb24oKXtyZXR1cm5cIkZvbGxvd0NhbWVyYVwifSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSxpLnByb3RvdHlwZSxcInJhZGl1c1wiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0saS5wcm90b3R5cGUsXCJyb3RhdGlvbk9mZnNldFwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0saS5wcm90b3R5cGUsXCJoZWlnaHRPZmZzZXRcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLGkucHJvdG90eXBlLFwiY2FtZXJhQWNjZWxlcmF0aW9uXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSxpLnByb3RvdHlwZSxcIm1heENhbWVyYVNwZWVkXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZUFzTWVzaFJlZmVyZW5jZShcImxvY2tlZFRhcmdldElkXCIpXSxpLnByb3RvdHlwZSxcInRhcmdldFwiLHZvaWQgMCksaX0oZS5UYXJnZXRDYW1lcmEpO2UuRm9sbG93Q2FtZXJhPXQ7dmFyIGk9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gaShpLHIsbixvLHMsYSl7dC5jYWxsKHRoaXMsaSxlLlZlY3RvcjMuWmVybygpLGEpLHRoaXMuYWxwaGE9cix0aGlzLmJldGE9bix0aGlzLnJhZGl1cz1vLHRoaXMudGFyZ2V0PXMsdGhpcy5fY2FydGVzaWFuQ29vcmRpbmF0ZXM9ZS5WZWN0b3IzLlplcm8oKSx0aGlzLmZvbGxvdygpfXJldHVybiBfX2V4dGVuZHMoaSx0KSxpLnByb3RvdHlwZS5mb2xsb3c9ZnVuY3Rpb24oKXt0aGlzLl9jYXJ0ZXNpYW5Db29yZGluYXRlcy54PXRoaXMucmFkaXVzKk1hdGguY29zKHRoaXMuYWxwaGEpKk1hdGguY29zKHRoaXMuYmV0YSksdGhpcy5fY2FydGVzaWFuQ29vcmRpbmF0ZXMueT10aGlzLnJhZGl1cypNYXRoLnNpbih0aGlzLmJldGEpLHRoaXMuX2NhcnRlc2lhbkNvb3JkaW5hdGVzLno9dGhpcy5yYWRpdXMqTWF0aC5zaW4odGhpcy5hbHBoYSkqTWF0aC5jb3ModGhpcy5iZXRhKSx0aGlzLnBvc2l0aW9uPXRoaXMudGFyZ2V0LnBvc2l0aW9uLmFkZCh0aGlzLl9jYXJ0ZXNpYW5Db29yZGluYXRlcyksdGhpcy5zZXRUYXJnZXQodGhpcy50YXJnZXQucG9zaXRpb24pfSxpLnByb3RvdHlwZS5fY2hlY2tJbnB1dHM9ZnVuY3Rpb24oKXt0LnByb3RvdHlwZS5fY2hlY2tJbnB1dHMuY2FsbCh0aGlzKSx0aGlzLmZvbGxvdygpfSxpLnByb3RvdHlwZS5nZXRUeXBlTmFtZT1mdW5jdGlvbigpe3JldHVyblwiQXJjRm9sbG93Q2FtZXJhXCJ9LGl9KGUuVGFyZ2V0Q2FtZXJhKTtlLkFyY0ZvbGxvd0NhbWVyYT1pfShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbihlKXtmdW5jdGlvbiB0KHQsaSxyKXtlLmNhbGwodGhpcyx0LGksciksdGhpcy5pbnB1dHMuYWRkVG91Y2goKSx0aGlzLl9zZXR1cElucHV0cygpfXJldHVybiBfX2V4dGVuZHModCxlKSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJ0b3VjaEFuZ3VsYXJTZW5zaWJpbGl0eVwiLHtnZXQ6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLmlucHV0cy5hdHRhY2hlZC50b3VjaDtyZXR1cm4gZT9lLnRvdWNoQW5ndWxhclNlbnNpYmlsaXR5OnZvaWQgMH0sc2V0OmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuaW5wdXRzLmF0dGFjaGVkLnRvdWNoO3QmJih0LnRvdWNoQW5ndWxhclNlbnNpYmlsaXR5PWUpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcInRvdWNoTW92ZVNlbnNpYmlsaXR5XCIse2dldDpmdW5jdGlvbigpe3ZhciBlPXRoaXMuaW5wdXRzLmF0dGFjaGVkLnRvdWNoO3JldHVybiBlP2UudG91Y2hNb3ZlU2Vuc2liaWxpdHk6dm9pZCAwfSxzZXQ6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5pbnB1dHMuYXR0YWNoZWQudG91Y2g7dCYmKHQudG91Y2hNb3ZlU2Vuc2liaWxpdHk9ZSl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksdC5wcm90b3R5cGUuZ2V0VHlwZU5hbWU9ZnVuY3Rpb24oKXtyZXR1cm5cIlRvdWNoQ2FtZXJhXCJ9LHQucHJvdG90eXBlLl9zZXR1cElucHV0cz1mdW5jdGlvbigpe3ZhciBlPXRoaXMuaW5wdXRzLmF0dGFjaGVkLm1vdXNlO2UmJihlLnRvdWNoRW5hYmxlZD0hMSl9LHR9KGUuRnJlZUNhbWVyYSk7ZS5Ub3VjaENhbWVyYT10fShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbih0KXtmdW5jdGlvbiBpKGkscixuLG8scyxhKXt2YXIgaD10aGlzO3QuY2FsbCh0aGlzLGksZS5WZWN0b3IzLlplcm8oKSxhKSx0aGlzLmluZXJ0aWFsQWxwaGFPZmZzZXQ9MCx0aGlzLmluZXJ0aWFsQmV0YU9mZnNldD0wLHRoaXMuaW5lcnRpYWxSYWRpdXNPZmZzZXQ9MCx0aGlzLmxvd2VyQWxwaGFMaW1pdD1udWxsLHRoaXMudXBwZXJBbHBoYUxpbWl0PW51bGwsdGhpcy5sb3dlckJldGFMaW1pdD0uMDEsdGhpcy51cHBlckJldGFMaW1pdD1NYXRoLlBJLHRoaXMubG93ZXJSYWRpdXNMaW1pdD1udWxsLHRoaXMudXBwZXJSYWRpdXNMaW1pdD1udWxsLHRoaXMuaW5lcnRpYWxQYW5uaW5nWD0wLHRoaXMuaW5lcnRpYWxQYW5uaW5nWT0wLHRoaXMuem9vbU9uRmFjdG9yPTEsdGhpcy50YXJnZXRTY3JlZW5PZmZzZXQ9ZS5WZWN0b3IyLlplcm8oKSx0aGlzLmFsbG93VXBzaWRlRG93bj0hMCx0aGlzLl92aWV3TWF0cml4PW5ldyBlLk1hdHJpeCx0aGlzLnBhbm5pbmdBeGlzPW5ldyBlLlZlY3RvcjMoMSwxLDApLHRoaXMuY2hlY2tDb2xsaXNpb25zPSExLHRoaXMuY29sbGlzaW9uUmFkaXVzPW5ldyBlLlZlY3RvcjMoLjUsLjUsLjUpLHRoaXMuX2NvbGxpZGVyPW5ldyBlLkNvbGxpZGVyLHRoaXMuX3ByZXZpb3VzUG9zaXRpb249ZS5WZWN0b3IzLlplcm8oKSx0aGlzLl9jb2xsaXNpb25WZWxvY2l0eT1lLlZlY3RvcjMuWmVybygpLHRoaXMuX25ld1Bvc2l0aW9uPWUuVmVjdG9yMy5aZXJvKCksdGhpcy5fb25Db2xsaXNpb25Qb3NpdGlvbkNoYW5nZT1mdW5jdGlvbih0LGkscil7dm9pZCAwPT09ciYmKHI9bnVsbCksaC5nZXRTY2VuZSgpLndvcmtlckNvbGxpc2lvbnMmJmguY2hlY2tDb2xsaXNpb25zJiZpLm11bHRpcGx5SW5QbGFjZShoLl9jb2xsaWRlci5yYWRpdXMpLHI/KGguc2V0UG9zaXRpb24oaSksaC5vbkNvbGxpZGUmJmgub25Db2xsaWRlKHIpKTpoLl9wcmV2aW91c1Bvc2l0aW9uLmNvcHlGcm9tKGgucG9zaXRpb24pO3ZhciBuPU1hdGguY29zKGguYWxwaGEpLG89TWF0aC5zaW4oaC5hbHBoYSkscz1NYXRoLmNvcyhoLmJldGEpLGE9TWF0aC5zaW4oaC5iZXRhKTswPT09YSYmKGE9MWUtNCk7dmFyIGM9aC5fZ2V0VGFyZ2V0UG9zaXRpb24oKTtjLmFkZFRvUmVmKG5ldyBlLlZlY3RvcjMoaC5yYWRpdXMqbiphLGgucmFkaXVzKnMsaC5yYWRpdXMqbyphKSxoLl9uZXdQb3NpdGlvbiksaC5wb3NpdGlvbi5jb3B5RnJvbShoLl9uZXdQb3NpdGlvbik7dmFyIGw9aC51cFZlY3RvcjtoLmFsbG93VXBzaWRlRG93biYmaC5iZXRhPDAmJihsPWwuY2xvbmUoKSxsPWwubmVnYXRlKCkpLGUuTWF0cml4Lkxvb2tBdExIVG9SZWYoaC5wb3NpdGlvbixjLGwsaC5fdmlld01hdHJpeCksaC5fdmlld01hdHJpeC5tWzEyXSs9aC50YXJnZXRTY3JlZW5PZmZzZXQueCxoLl92aWV3TWF0cml4Lm1bMTNdKz1oLnRhcmdldFNjcmVlbk9mZnNldC55LGguX2NvbGxpc2lvblRyaWdnZXJlZD0hMX0scz90aGlzLnRhcmdldD1zOnRoaXMudGFyZ2V0PWUuVmVjdG9yMy5aZXJvKCksdGhpcy5hbHBoYT1yLHRoaXMuYmV0YT1uLHRoaXMucmFkaXVzPW8sdGhpcy5nZXRWaWV3TWF0cml4KCksdGhpcy5pbnB1dHM9bmV3IGUuQXJjUm90YXRlQ2FtZXJhSW5wdXRzTWFuYWdlcih0aGlzKSx0aGlzLmlucHV0cy5hZGRLZXlib2FyZCgpLmFkZE1vdXNlV2hlZWwoKS5hZGRQb2ludGVycygpLmFkZEdhbWVwYWQoKX1yZXR1cm4gX19leHRlbmRzKGksdCksT2JqZWN0LmRlZmluZVByb3BlcnR5KGkucHJvdG90eXBlLFwiYW5ndWxhclNlbnNpYmlsaXR5WFwiLHtnZXQ6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLmlucHV0cy5hdHRhY2hlZC5wb2ludGVycztyZXR1cm4gZT9lLmFuZ3VsYXJTZW5zaWJpbGl0eVg6dm9pZCAwfSxzZXQ6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5pbnB1dHMuYXR0YWNoZWQucG9pbnRlcnM7dCYmKHQuYW5ndWxhclNlbnNpYmlsaXR5WD1lKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJhbmd1bGFyU2Vuc2liaWxpdHlZXCIse2dldDpmdW5jdGlvbigpe3ZhciBlPXRoaXMuaW5wdXRzLmF0dGFjaGVkLnBvaW50ZXJzO3JldHVybiBlP2UuYW5ndWxhclNlbnNpYmlsaXR5WTp2b2lkIDB9LHNldDpmdW5jdGlvbihlKXt2YXIgdD10aGlzLmlucHV0cy5hdHRhY2hlZC5wb2ludGVyczt0JiYodC5hbmd1bGFyU2Vuc2liaWxpdHlZPWUpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcInBpbmNoUHJlY2lzaW9uXCIse2dldDpmdW5jdGlvbigpe3ZhciBlPXRoaXMuaW5wdXRzLmF0dGFjaGVkLnBvaW50ZXJzO3JldHVybiBlP2UucGluY2hQcmVjaXNpb246dm9pZCAwfSxzZXQ6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5pbnB1dHMuYXR0YWNoZWQucG9pbnRlcnM7dCYmKHQucGluY2hQcmVjaXNpb249ZSl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGkucHJvdG90eXBlLFwicGFubmluZ1NlbnNpYmlsaXR5XCIse2dldDpmdW5jdGlvbigpe3ZhciBlPXRoaXMuaW5wdXRzLmF0dGFjaGVkLnBvaW50ZXJzO3JldHVybiBlP2UucGFubmluZ1NlbnNpYmlsaXR5OnZvaWQgMH0sc2V0OmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuaW5wdXRzLmF0dGFjaGVkLnBvaW50ZXJzO3QmJih0LnBhbm5pbmdTZW5zaWJpbGl0eT1lKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJrZXlzVXBcIix7Z2V0OmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5pbnB1dHMuYXR0YWNoZWQua2V5Ym9hcmQ7cmV0dXJuIGU/ZS5rZXlzVXA6dm9pZCAwfSxzZXQ6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5pbnB1dHMuYXR0YWNoZWQua2V5Ym9hcmQ7dCYmKHQua2V5c1VwPWUpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcImtleXNEb3duXCIse2dldDpmdW5jdGlvbigpe3ZhciBlPXRoaXMuaW5wdXRzLmF0dGFjaGVkLmtleWJvYXJkO3JldHVybiBlP2Uua2V5c0Rvd246dm9pZCAwfSxzZXQ6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5pbnB1dHMuYXR0YWNoZWQua2V5Ym9hcmQ7dCYmKHQua2V5c0Rvd249ZSl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGkucHJvdG90eXBlLFwia2V5c0xlZnRcIix7Z2V0OmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5pbnB1dHMuYXR0YWNoZWQua2V5Ym9hcmQ7cmV0dXJuIGU/ZS5rZXlzTGVmdDp2b2lkIDB9LHNldDpmdW5jdGlvbihlKXt2YXIgdD10aGlzLmlucHV0cy5hdHRhY2hlZC5rZXlib2FyZDt0JiYodC5rZXlzTGVmdD1lKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJrZXlzUmlnaHRcIix7Z2V0OmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5pbnB1dHMuYXR0YWNoZWQua2V5Ym9hcmQ7cmV0dXJuIGU/ZS5rZXlzUmlnaHQ6dm9pZCAwfSxzZXQ6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5pbnB1dHMuYXR0YWNoZWQua2V5Ym9hcmQ7dCYmKHQua2V5c1JpZ2h0PWUpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcIndoZWVsUHJlY2lzaW9uXCIse2dldDpmdW5jdGlvbigpe3ZhciBlPXRoaXMuaW5wdXRzLmF0dGFjaGVkLm1vdXNld2hlZWw7cmV0dXJuIGU/ZS53aGVlbFByZWNpc2lvbjp2b2lkIDB9LHNldDpmdW5jdGlvbihlKXt2YXIgdD10aGlzLmlucHV0cy5hdHRhY2hlZC5tb3VzZXdoZWVsO3QmJih0LndoZWVsUHJlY2lzaW9uPWUpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLGkucHJvdG90eXBlLl9pbml0Q2FjaGU9ZnVuY3Rpb24oKXt0LnByb3RvdHlwZS5faW5pdENhY2hlLmNhbGwodGhpcyksdGhpcy5fY2FjaGUudGFyZ2V0PW5ldyBlLlZlY3RvcjMoTnVtYmVyLk1BWF9WQUxVRSxOdW1iZXIuTUFYX1ZBTFVFLE51bWJlci5NQVhfVkFMVUUpLHRoaXMuX2NhY2hlLmFscGhhPXZvaWQgMCx0aGlzLl9jYWNoZS5iZXRhPXZvaWQgMCx0aGlzLl9jYWNoZS5yYWRpdXM9dm9pZCAwLHRoaXMuX2NhY2hlLnRhcmdldFNjcmVlbk9mZnNldD1lLlZlY3RvcjIuWmVybygpfSxpLnByb3RvdHlwZS5fdXBkYXRlQ2FjaGU9ZnVuY3Rpb24oZSl7ZXx8dC5wcm90b3R5cGUuX3VwZGF0ZUNhY2hlLmNhbGwodGhpcyksdGhpcy5fY2FjaGUudGFyZ2V0LmNvcHlGcm9tKHRoaXMuX2dldFRhcmdldFBvc2l0aW9uKCkpLHRoaXMuX2NhY2hlLmFscGhhPXRoaXMuYWxwaGEsdGhpcy5fY2FjaGUuYmV0YT10aGlzLmJldGEsdGhpcy5fY2FjaGUucmFkaXVzPXRoaXMucmFkaXVzLHRoaXMuX2NhY2hlLnRhcmdldFNjcmVlbk9mZnNldC5jb3B5RnJvbSh0aGlzLnRhcmdldFNjcmVlbk9mZnNldCl9LGkucHJvdG90eXBlLl9nZXRUYXJnZXRQb3NpdGlvbj1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRhcmdldC5nZXRBYnNvbHV0ZVBvc2l0aW9uP3RoaXMudGFyZ2V0LmdldEFic29sdXRlUG9zaXRpb24oKTp0aGlzLnRhcmdldH0saS5wcm90b3R5cGUuX2lzU3luY2hyb25pemVkVmlld01hdHJpeD1mdW5jdGlvbigpe3JldHVybiB0LnByb3RvdHlwZS5faXNTeW5jaHJvbml6ZWRWaWV3TWF0cml4LmNhbGwodGhpcyk/dGhpcy5fY2FjaGUudGFyZ2V0LmVxdWFscyh0aGlzLnRhcmdldCkmJnRoaXMuX2NhY2hlLmFscGhhPT09dGhpcy5hbHBoYSYmdGhpcy5fY2FjaGUuYmV0YT09PXRoaXMuYmV0YSYmdGhpcy5fY2FjaGUucmFkaXVzPT09dGhpcy5yYWRpdXMmJnRoaXMuX2NhY2hlLnRhcmdldFNjcmVlbk9mZnNldC5lcXVhbHModGhpcy50YXJnZXRTY3JlZW5PZmZzZXQpOiExfSxpLnByb3RvdHlwZS5hdHRhY2hDb250cm9sPWZ1bmN0aW9uKGUsdCxpKXt2YXIgcj10aGlzO3ZvaWQgMD09PWkmJihpPSEwKSx0aGlzLl91c2VDdHJsRm9yUGFubmluZz1pLHRoaXMuaW5wdXRzLmF0dGFjaEVsZW1lbnQoZSx0KSx0aGlzLl9yZXNldD1mdW5jdGlvbigpe3IuaW5lcnRpYWxBbHBoYU9mZnNldD0wLHIuaW5lcnRpYWxCZXRhT2Zmc2V0PTAsci5pbmVydGlhbFJhZGl1c09mZnNldD0wfX0saS5wcm90b3R5cGUuZGV0YWNoQ29udHJvbD1mdW5jdGlvbihlKXt0aGlzLmlucHV0cy5kZXRhY2hFbGVtZW50KGUpLHRoaXMuX3Jlc2V0JiZ0aGlzLl9yZXNldCgpfSxpLnByb3RvdHlwZS5fY2hlY2tJbnB1dHM9ZnVuY3Rpb24oKXt0aGlzLl9jb2xsaXNpb25UcmlnZ2VyZWR8fCh0aGlzLmlucHV0cy5jaGVja0lucHV0cygpLDA9PT10aGlzLmluZXJ0aWFsQWxwaGFPZmZzZXQmJjA9PT10aGlzLmluZXJ0aWFsQmV0YU9mZnNldCYmMD09PXRoaXMuaW5lcnRpYWxSYWRpdXNPZmZzZXR8fCh0aGlzLmFscGhhKz10aGlzLmJldGE8PTA/LXRoaXMuaW5lcnRpYWxBbHBoYU9mZnNldDp0aGlzLmluZXJ0aWFsQWxwaGFPZmZzZXQsdGhpcy5iZXRhKz10aGlzLmluZXJ0aWFsQmV0YU9mZnNldCx0aGlzLnJhZGl1cy09dGhpcy5pbmVydGlhbFJhZGl1c09mZnNldCx0aGlzLmluZXJ0aWFsQWxwaGFPZmZzZXQqPXRoaXMuaW5lcnRpYSx0aGlzLmluZXJ0aWFsQmV0YU9mZnNldCo9dGhpcy5pbmVydGlhLHRoaXMuaW5lcnRpYWxSYWRpdXNPZmZzZXQqPXRoaXMuaW5lcnRpYSxNYXRoLmFicyh0aGlzLmluZXJ0aWFsQWxwaGFPZmZzZXQpPGUuRXBzaWxvbiYmKHRoaXMuaW5lcnRpYWxBbHBoYU9mZnNldD0wKSxNYXRoLmFicyh0aGlzLmluZXJ0aWFsQmV0YU9mZnNldCk8ZS5FcHNpbG9uJiYodGhpcy5pbmVydGlhbEJldGFPZmZzZXQ9MCksTWF0aC5hYnModGhpcy5pbmVydGlhbFJhZGl1c09mZnNldCk8ZS5FcHNpbG9uJiYodGhpcy5pbmVydGlhbFJhZGl1c09mZnNldD0wKSksMD09PXRoaXMuaW5lcnRpYWxQYW5uaW5nWCYmMD09PXRoaXMuaW5lcnRpYWxQYW5uaW5nWXx8KHRoaXMuX2xvY2FsRGlyZWN0aW9ufHwodGhpcy5fbG9jYWxEaXJlY3Rpb249ZS5WZWN0b3IzLlplcm8oKSx0aGlzLl90cmFuc2Zvcm1lZERpcmVjdGlvbj1lLlZlY3RvcjMuWmVybygpKSx0aGlzLmluZXJ0aWFsUGFubmluZ1gqPXRoaXMuaW5lcnRpYSx0aGlzLmluZXJ0aWFsUGFubmluZ1kqPXRoaXMuaW5lcnRpYSxNYXRoLmFicyh0aGlzLmluZXJ0aWFsUGFubmluZ1gpPGUuRXBzaWxvbiYmKHRoaXMuaW5lcnRpYWxQYW5uaW5nWD0wKSxNYXRoLmFicyh0aGlzLmluZXJ0aWFsUGFubmluZ1kpPGUuRXBzaWxvbiYmKHRoaXMuaW5lcnRpYWxQYW5uaW5nWT0wKSx0aGlzLl9sb2NhbERpcmVjdGlvbi5jb3B5RnJvbUZsb2F0cyh0aGlzLmluZXJ0aWFsUGFubmluZ1gsdGhpcy5pbmVydGlhbFBhbm5pbmdZLHRoaXMuaW5lcnRpYWxQYW5uaW5nWSksdGhpcy5fbG9jYWxEaXJlY3Rpb24ubXVsdGlwbHlJblBsYWNlKHRoaXMucGFubmluZ0F4aXMpLHRoaXMuX3ZpZXdNYXRyaXguaW52ZXJ0VG9SZWYodGhpcy5fY2FtZXJhVHJhbnNmb3JtTWF0cml4KSxlLlZlY3RvcjMuVHJhbnNmb3JtTm9ybWFsVG9SZWYodGhpcy5fbG9jYWxEaXJlY3Rpb24sdGhpcy5fY2FtZXJhVHJhbnNmb3JtTWF0cml4LHRoaXMuX3RyYW5zZm9ybWVkRGlyZWN0aW9uKSx0aGlzLnBhbm5pbmdBeGlzLnl8fCh0aGlzLl90cmFuc2Zvcm1lZERpcmVjdGlvbi55PTApLHRoaXMudGFyZ2V0LmdldEFic29sdXRlUG9zaXRpb258fHRoaXMudGFyZ2V0LmFkZEluUGxhY2UodGhpcy5fdHJhbnNmb3JtZWREaXJlY3Rpb24pKSx0aGlzLl9jaGVja0xpbWl0cygpLHQucHJvdG90eXBlLl9jaGVja0lucHV0cy5jYWxsKHRoaXMpKX0saS5wcm90b3R5cGUuX2NoZWNrTGltaXRzPWZ1bmN0aW9uKCl7bnVsbD09PXRoaXMubG93ZXJCZXRhTGltaXR8fHZvaWQgMD09PXRoaXMubG93ZXJCZXRhTGltaXQ/dGhpcy5hbGxvd1Vwc2lkZURvd24mJnRoaXMuYmV0YT5NYXRoLlBJJiYodGhpcy5iZXRhPXRoaXMuYmV0YS0yKk1hdGguUEkpOnRoaXMuYmV0YTx0aGlzLmxvd2VyQmV0YUxpbWl0JiYodGhpcy5iZXRhPXRoaXMubG93ZXJCZXRhTGltaXQpLG51bGw9PT10aGlzLnVwcGVyQmV0YUxpbWl0fHx2b2lkIDA9PT10aGlzLnVwcGVyQmV0YUxpbWl0P3RoaXMuYWxsb3dVcHNpZGVEb3duJiZ0aGlzLmJldGE8LU1hdGguUEkmJih0aGlzLmJldGE9dGhpcy5iZXRhKzIqTWF0aC5QSSk6dGhpcy5iZXRhPnRoaXMudXBwZXJCZXRhTGltaXQmJih0aGlzLmJldGE9dGhpcy51cHBlckJldGFMaW1pdCksdGhpcy5sb3dlckFscGhhTGltaXQmJnRoaXMuYWxwaGE8dGhpcy5sb3dlckFscGhhTGltaXQmJih0aGlzLmFscGhhPXRoaXMubG93ZXJBbHBoYUxpbWl0KSx0aGlzLnVwcGVyQWxwaGFMaW1pdCYmdGhpcy5hbHBoYT50aGlzLnVwcGVyQWxwaGFMaW1pdCYmKHRoaXMuYWxwaGE9dGhpcy51cHBlckFscGhhTGltaXQpLHRoaXMubG93ZXJSYWRpdXNMaW1pdCYmdGhpcy5yYWRpdXM8dGhpcy5sb3dlclJhZGl1c0xpbWl0JiYodGhpcy5yYWRpdXM9dGhpcy5sb3dlclJhZGl1c0xpbWl0KSx0aGlzLnVwcGVyUmFkaXVzTGltaXQmJnRoaXMucmFkaXVzPnRoaXMudXBwZXJSYWRpdXNMaW1pdCYmKHRoaXMucmFkaXVzPXRoaXMudXBwZXJSYWRpdXNMaW1pdCl9LGkucHJvdG90eXBlLnJlYnVpbGRBbmdsZXNBbmRSYWRpdXM9ZnVuY3Rpb24oKXt2YXIgZT10aGlzLnBvc2l0aW9uLnN1YnRyYWN0KHRoaXMuX2dldFRhcmdldFBvc2l0aW9uKCkpO3RoaXMucmFkaXVzPWUubGVuZ3RoKCksdGhpcy5hbHBoYT1NYXRoLmFjb3MoZS54L01hdGguc3FydChNYXRoLnBvdyhlLngsMikrTWF0aC5wb3coZS56LDIpKSksZS56PDAmJih0aGlzLmFscGhhPTIqTWF0aC5QSS10aGlzLmFscGhhKSx0aGlzLmJldGE9TWF0aC5hY29zKGUueS90aGlzLnJhZGl1cyksdGhpcy5fY2hlY2tMaW1pdHMoKX0saS5wcm90b3R5cGUuc2V0UG9zaXRpb249ZnVuY3Rpb24oZSl7dGhpcy5wb3NpdGlvbi5lcXVhbHMoZSl8fCh0aGlzLnBvc2l0aW9uPWUsdGhpcy5yZWJ1aWxkQW5nbGVzQW5kUmFkaXVzKCkpfSxpLnByb3RvdHlwZS5zZXRUYXJnZXQ9ZnVuY3Rpb24oZSl7dGhpcy5fZ2V0VGFyZ2V0UG9zaXRpb24oKS5lcXVhbHMoZSl8fCh0aGlzLnRhcmdldD1lLHRoaXMucmVidWlsZEFuZ2xlc0FuZFJhZGl1cygpKX0saS5wcm90b3R5cGUuX2dldFZpZXdNYXRyaXg9ZnVuY3Rpb24oKXt2YXIgdD1NYXRoLmNvcyh0aGlzLmFscGhhKSxpPU1hdGguc2luKHRoaXMuYWxwaGEpLHI9TWF0aC5jb3ModGhpcy5iZXRhKSxuPU1hdGguc2luKHRoaXMuYmV0YSk7MD09PW4mJihuPTFlLTQpO3ZhciBvPXRoaXMuX2dldFRhcmdldFBvc2l0aW9uKCk7aWYoby5hZGRUb1JlZihuZXcgZS5WZWN0b3IzKHRoaXMucmFkaXVzKnQqbix0aGlzLnJhZGl1cypyLHRoaXMucmFkaXVzKmkqbiksdGhpcy5fbmV3UG9zaXRpb24pLHRoaXMuZ2V0U2NlbmUoKS5jb2xsaXNpb25zRW5hYmxlZCYmdGhpcy5jaGVja0NvbGxpc2lvbnMpdGhpcy5fY29sbGlkZXIucmFkaXVzPXRoaXMuY29sbGlzaW9uUmFkaXVzLHRoaXMuX25ld1Bvc2l0aW9uLnN1YnRyYWN0VG9SZWYodGhpcy5wb3NpdGlvbix0aGlzLl9jb2xsaXNpb25WZWxvY2l0eSksdGhpcy5fY29sbGlzaW9uVHJpZ2dlcmVkPSEwLHRoaXMuZ2V0U2NlbmUoKS5jb2xsaXNpb25Db29yZGluYXRvci5nZXROZXdQb3NpdGlvbih0aGlzLnBvc2l0aW9uLHRoaXMuX2NvbGxpc2lvblZlbG9jaXR5LHRoaXMuX2NvbGxpZGVyLDMsbnVsbCx0aGlzLl9vbkNvbGxpc2lvblBvc2l0aW9uQ2hhbmdlLHRoaXMudW5pcXVlSWQpO2Vsc2V7dGhpcy5wb3NpdGlvbi5jb3B5RnJvbSh0aGlzLl9uZXdQb3NpdGlvbik7dmFyIHM9dGhpcy51cFZlY3Rvcjt0aGlzLmFsbG93VXBzaWRlRG93biYmdGhpcy5iZXRhPDAmJihzPXMuY2xvbmUoKSxzPXMubmVnYXRlKCkpLGUuTWF0cml4Lkxvb2tBdExIVG9SZWYodGhpcy5wb3NpdGlvbixvLHMsdGhpcy5fdmlld01hdHJpeCksdGhpcy5fdmlld01hdHJpeC5tWzEyXSs9dGhpcy50YXJnZXRTY3JlZW5PZmZzZXQueCx0aGlzLl92aWV3TWF0cml4Lm1bMTNdKz10aGlzLnRhcmdldFNjcmVlbk9mZnNldC55fXJldHVybiB0aGlzLl92aWV3TWF0cml4fSxpLnByb3RvdHlwZS56b29tT249ZnVuY3Rpb24odCxpKXt2b2lkIDA9PT1pJiYoaT0hMSksdD10fHx0aGlzLmdldFNjZW5lKCkubWVzaGVzO3ZhciByPWUuTWVzaC5NaW5NYXgodCksbj1lLlZlY3RvcjMuRGlzdGFuY2Uoci5taW4sci5tYXgpO3RoaXMucmFkaXVzPW4qdGhpcy56b29tT25GYWN0b3IsdGhpcy5mb2N1c09uKHttaW46ci5taW4sbWF4OnIubWF4LGRpc3RhbmNlOm59LGkpfSxpLnByb3RvdHlwZS5mb2N1c09uPWZ1bmN0aW9uKHQsaSl7dm9pZCAwPT09aSYmKGk9ITEpO3ZhciByLG47dm9pZCAwPT09dC5taW4/KHI9dHx8dGhpcy5nZXRTY2VuZSgpLm1lc2hlcyxyPWUuTWVzaC5NaW5NYXgociksbj1lLlZlY3RvcjMuRGlzdGFuY2Uoci5taW4sci5tYXgpKToocj10LG49dC5kaXN0YW5jZSksdGhpcy50YXJnZXQ9ZS5NZXNoLkNlbnRlcihyKSxpfHwodGhpcy5tYXhaPTIqbil9LGkucHJvdG90eXBlLmNyZWF0ZVJpZ0NhbWVyYT1mdW5jdGlvbih0LHIpe3ZhciBuO3N3aXRjaCh0aGlzLmNhbWVyYVJpZ01vZGUpe2Nhc2UgZS5DYW1lcmEuUklHX01PREVfU1RFUkVPU0NPUElDX0FOQUdMWVBIOmNhc2UgZS5DYW1lcmEuUklHX01PREVfU1RFUkVPU0NPUElDX1NJREVCWVNJREVfUEFSQUxMRUw6Y2FzZSBlLkNhbWVyYS5SSUdfTU9ERV9TVEVSRU9TQ09QSUNfT1ZFUlVOREVSOmNhc2UgZS5DYW1lcmEuUklHX01PREVfVlI6bj10aGlzLl9jYW1lcmFSaWdQYXJhbXMuc3RlcmVvSGFsZkFuZ2xlKigwPT09cj8xOi0xKTticmVhaztjYXNlIGUuQ2FtZXJhLlJJR19NT0RFX1NURVJFT1NDT1BJQ19TSURFQllTSURFX0NST1NTRVlFRDpuPXRoaXMuX2NhbWVyYVJpZ1BhcmFtcy5zdGVyZW9IYWxmQW5nbGUqKDA9PT1yPy0xOjEpfXZhciBvPW5ldyBpKHQsdGhpcy5hbHBoYStuLHRoaXMuYmV0YSx0aGlzLnJhZGl1cyx0aGlzLnRhcmdldCx0aGlzLmdldFNjZW5lKCkpO3JldHVybiBvLl9jYW1lcmFSaWdQYXJhbXM9e30sb30saS5wcm90b3R5cGUuX3VwZGF0ZVJpZ0NhbWVyYXM9ZnVuY3Rpb24oKXt2YXIgaT10aGlzLl9yaWdDYW1lcmFzWzBdLHI9dGhpcy5fcmlnQ2FtZXJhc1sxXTtzd2l0Y2goaS5iZXRhPXIuYmV0YT10aGlzLmJldGEsaS5yYWRpdXM9ci5yYWRpdXM9dGhpcy5yYWRpdXMsdGhpcy5jYW1lcmFSaWdNb2RlKXtjYXNlIGUuQ2FtZXJhLlJJR19NT0RFX1NURVJFT1NDT1BJQ19BTkFHTFlQSDpjYXNlIGUuQ2FtZXJhLlJJR19NT0RFX1NURVJFT1NDT1BJQ19TSURFQllTSURFX1BBUkFMTEVMOmNhc2UgZS5DYW1lcmEuUklHX01PREVfU1RFUkVPU0NPUElDX09WRVJVTkRFUjpjYXNlIGUuQ2FtZXJhLlJJR19NT0RFX1ZSOmkuYWxwaGE9dGhpcy5hbHBoYS10aGlzLl9jYW1lcmFSaWdQYXJhbXMuc3RlcmVvSGFsZkFuZ2xlLHIuYWxwaGE9dGhpcy5hbHBoYSt0aGlzLl9jYW1lcmFSaWdQYXJhbXMuc3RlcmVvSGFsZkFuZ2xlO2JyZWFrO2Nhc2UgZS5DYW1lcmEuUklHX01PREVfU1RFUkVPU0NPUElDX1NJREVCWVNJREVfQ1JPU1NFWUVEOmkuYWxwaGE9dGhpcy5hbHBoYSt0aGlzLl9jYW1lcmFSaWdQYXJhbXMuc3RlcmVvSGFsZkFuZ2xlLHIuYWxwaGE9dGhpcy5hbHBoYS10aGlzLl9jYW1lcmFSaWdQYXJhbXMuc3RlcmVvSGFsZkFuZ2xlfXQucHJvdG90eXBlLl91cGRhdGVSaWdDYW1lcmFzLmNhbGwodGhpcyl9LGkucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXt0aGlzLmlucHV0cy5jbGVhcigpLHQucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKX0saS5wcm90b3R5cGUuZ2V0VHlwZU5hbWU9ZnVuY3Rpb24oKXtyZXR1cm5cIkFyY1JvdGF0ZUNhbWVyYVwifSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSxpLnByb3RvdHlwZSxcImFscGhhXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSxpLnByb3RvdHlwZSxcImJldGFcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLGkucHJvdG90eXBlLFwicmFkaXVzXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZUFzVmVjdG9yMygpXSxpLnByb3RvdHlwZSxcInRhcmdldFwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0saS5wcm90b3R5cGUsXCJpbmVydGlhbEFscGhhT2Zmc2V0XCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSxpLnByb3RvdHlwZSxcImluZXJ0aWFsQmV0YU9mZnNldFwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0saS5wcm90b3R5cGUsXCJpbmVydGlhbFJhZGl1c09mZnNldFwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0saS5wcm90b3R5cGUsXCJsb3dlckFscGhhTGltaXRcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLGkucHJvdG90eXBlLFwidXBwZXJBbHBoYUxpbWl0XCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSxpLnByb3RvdHlwZSxcImxvd2VyQmV0YUxpbWl0XCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSxpLnByb3RvdHlwZSxcInVwcGVyQmV0YUxpbWl0XCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSxpLnByb3RvdHlwZSxcImxvd2VyUmFkaXVzTGltaXRcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLGkucHJvdG90eXBlLFwidXBwZXJSYWRpdXNMaW1pdFwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0saS5wcm90b3R5cGUsXCJpbmVydGlhbFBhbm5pbmdYXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSxpLnByb3RvdHlwZSxcImluZXJ0aWFsUGFubmluZ1lcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLGkucHJvdG90eXBlLFwiem9vbU9uRmFjdG9yXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSxpLnByb3RvdHlwZSxcImFsbG93VXBzaWRlRG93blwiLHZvaWQgMCksaX0oZS5UYXJnZXRDYW1lcmEpO2UuQXJjUm90YXRlQ2FtZXJhPXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGkoZSl7dC5jYWxsKHRoaXMsZSl9cmV0dXJuIF9fZXh0ZW5kcyhpLHQpLGkucHJvdG90eXBlLmFkZE1vdXNlV2hlZWw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hZGQobmV3IGUuQXJjUm90YXRlQ2FtZXJhTW91c2VXaGVlbElucHV0KSx0aGlzfSxpLnByb3RvdHlwZS5hZGRQb2ludGVycz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmFkZChuZXcgZS5BcmNSb3RhdGVDYW1lcmFQb2ludGVyc0lucHV0KSx0aGlzfSxpLnByb3RvdHlwZS5hZGRLZXlib2FyZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmFkZChuZXcgZS5BcmNSb3RhdGVDYW1lcmFLZXlib2FyZE1vdmVJbnB1dCksdGhpc30saS5wcm90b3R5cGUuYWRkR2FtZXBhZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmFkZChuZXcgZS5BcmNSb3RhdGVDYW1lcmFHYW1lcGFkSW5wdXQpLHRoaXN9LGkucHJvdG90eXBlLmFkZFZSRGV2aWNlT3JpZW50YXRpb249ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hZGQobmV3IGUuQXJjUm90YXRlQ2FtZXJhVlJEZXZpY2VPcmllbnRhdGlvbklucHV0KSx0aGlzfSxpfShlLkNhbWVyYUlucHV0c01hbmFnZXIpO2UuQXJjUm90YXRlQ2FtZXJhSW5wdXRzTWFuYWdlcj10fShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoZSl7dGhpcy5fcmVuZGVyaW5nR3JvdXBzPW5ldyBBcnJheSx0aGlzLl9zY2VuZT1lfXJldHVybiB0LnByb3RvdHlwZS5fcmVuZGVyUGFydGljbGVzPWZ1bmN0aW9uKHQsaSl7aWYoMCE9PXRoaXMuX3NjZW5lLl9hY3RpdmVQYXJ0aWNsZVN5c3RlbXMubGVuZ3RoKXtmb3IodmFyIHI9dGhpcy5fc2NlbmUuYWN0aXZlQ2FtZXJhLG49ZS5Ub29scy5Ob3csbz0wO288dGhpcy5fc2NlbmUuX2FjdGl2ZVBhcnRpY2xlU3lzdGVtcy5sZW5ndGg7bysrKXt2YXIgcz10aGlzLl9zY2VuZS5fYWN0aXZlUGFydGljbGVTeXN0ZW1zLmRhdGFbb107cy5yZW5kZXJpbmdHcm91cElkPT09dCYmMCE9PShyLmxheWVyTWFzayZzLmxheWVyTWFzaykmJih0aGlzLl9jbGVhckRlcHRoQnVmZmVyKCkscy5lbWl0dGVyLnBvc2l0aW9uJiZpJiYtMT09PWkuaW5kZXhPZihzLmVtaXR0ZXIpfHwodGhpcy5fc2NlbmUuX2FjdGl2ZVBhcnRpY2xlcys9cy5yZW5kZXIoKSkpfXRoaXMuX3NjZW5lLl9wYXJ0aWNsZXNEdXJhdGlvbis9ZS5Ub29scy5Ob3ctbn19LHQucHJvdG90eXBlLl9yZW5kZXJTcHJpdGVzPWZ1bmN0aW9uKHQpe2lmKHRoaXMuX3NjZW5lLnNwcml0ZXNFbmFibGVkJiYwIT09dGhpcy5fc2NlbmUuc3ByaXRlTWFuYWdlcnMubGVuZ3RoKXtmb3IodmFyIGk9dGhpcy5fc2NlbmUuYWN0aXZlQ2FtZXJhLHI9ZS5Ub29scy5Ob3csbj0wO248dGhpcy5fc2NlbmUuc3ByaXRlTWFuYWdlcnMubGVuZ3RoO24rKyl7dmFyIG89dGhpcy5fc2NlbmUuc3ByaXRlTWFuYWdlcnNbbl07by5yZW5kZXJpbmdHcm91cElkPT09dCYmMCE9PShpLmxheWVyTWFzayZvLmxheWVyTWFzaykmJih0aGlzLl9jbGVhckRlcHRoQnVmZmVyKCksby5yZW5kZXIoKSl9dGhpcy5fc2NlbmUuX3Nwcml0ZXNEdXJhdGlvbis9ZS5Ub29scy5Ob3ctcn19LHQucHJvdG90eXBlLl9jbGVhckRlcHRoQnVmZmVyPWZ1bmN0aW9uKCl7dGhpcy5fZGVwdGhCdWZmZXJBbHJlYWR5Q2xlYW5lZHx8KHRoaXMuX3NjZW5lLmdldEVuZ2luZSgpLmNsZWFyKDAsITEsITApLHRoaXMuX2RlcHRoQnVmZmVyQWxyZWFkeUNsZWFuZWQ9ITApfSx0LnByb3RvdHlwZS5fcmVuZGVyU3ByaXRlc0FuZFBhcnRpY2xlcz1mdW5jdGlvbigpe3RoaXMuX2N1cnJlbnRSZW5kZXJTcHJpdGVzJiZ0aGlzLl9yZW5kZXJTcHJpdGVzKHRoaXMuX2N1cnJlbnRJbmRleCksdGhpcy5fY3VycmVudFJlbmRlclBhcnRpY2xlcyYmdGhpcy5fcmVuZGVyUGFydGljbGVzKHRoaXMuX2N1cnJlbnRJbmRleCx0aGlzLl9jdXJyZW50QWN0aXZlTWVzaGVzKX0sdC5wcm90b3R5cGUucmVuZGVyPWZ1bmN0aW9uKGUsaSxyLG4pe3RoaXMuX2N1cnJlbnRBY3RpdmVNZXNoZXM9aSx0aGlzLl9jdXJyZW50UmVuZGVyUGFydGljbGVzPXIsdGhpcy5fY3VycmVudFJlbmRlclNwcml0ZXM9bjtmb3IodmFyIG89MDtvPHQuTUFYX1JFTkRFUklOR0dST1VQUztvKyspe3RoaXMuX2RlcHRoQnVmZmVyQWxyZWFkeUNsZWFuZWQ9MD09bzt2YXIgcz10aGlzLl9yZW5kZXJpbmdHcm91cHNbb10sYT0hMTt0aGlzLl9jdXJyZW50SW5kZXg9byxzPyh0aGlzLl9jbGVhckRlcHRoQnVmZmVyKCkscy5vbkJlZm9yZVRyYW5zcGFyZW50UmVuZGVyaW5nfHwocy5vbkJlZm9yZVRyYW5zcGFyZW50UmVuZGVyaW5nPXRoaXMuX3JlbmRlclNwcml0ZXNBbmRQYXJ0aWNsZXMuYmluZCh0aGlzKSkscy5yZW5kZXIoZSl8fCh0aGlzLl9yZW5kZXJpbmdHcm91cHMuc3BsaWNlKG8sMSksYT0hMCx0aGlzLl9yZW5kZXJTcHJpdGVzQW5kUGFydGljbGVzKCkpKTp0aGlzLl9yZW5kZXJTcHJpdGVzQW5kUGFydGljbGVzKCksYSYmby0tfX0sdC5wcm90b3R5cGUucmVzZXQ9ZnVuY3Rpb24oKXt0aGlzLl9yZW5kZXJpbmdHcm91cHMuZm9yRWFjaChmdW5jdGlvbihlLHQsaSl7ZSYmZS5wcmVwYXJlKCl9KX0sdC5wcm90b3R5cGUuZGlzcGF0Y2g9ZnVuY3Rpb24odCl7dmFyIGk9dC5nZXRNZXNoKCkscj1pLnJlbmRlcmluZ0dyb3VwSWR8fDA7dGhpcy5fcmVuZGVyaW5nR3JvdXBzW3JdfHwodGhpcy5fcmVuZGVyaW5nR3JvdXBzW3JdPW5ldyBlLlJlbmRlcmluZ0dyb3VwKHIsdGhpcy5fc2NlbmUpKSx0aGlzLl9yZW5kZXJpbmdHcm91cHNbcl0uZGlzcGF0Y2godCl9LHQuTUFYX1JFTkRFUklOR0dST1VQUz00LHR9KCk7ZS5SZW5kZXJpbmdNYW5hZ2VyPXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGkpe3RoaXMuaW5kZXg9dCx0aGlzLl9vcGFxdWVTdWJNZXNoZXM9bmV3IGUuU21hcnRBcnJheSgyNTYpLHRoaXMuX3RyYW5zcGFyZW50U3ViTWVzaGVzPW5ldyBlLlNtYXJ0QXJyYXkoMjU2KSx0aGlzLl9hbHBoYVRlc3RTdWJNZXNoZXM9bmV3IGUuU21hcnRBcnJheSgyNTYpLHRoaXMuX3NjZW5lPWl9cmV0dXJuIHQucHJvdG90eXBlLnJlbmRlcj1mdW5jdGlvbih0KXtcbmlmKHQpcmV0dXJuIHQodGhpcy5fb3BhcXVlU3ViTWVzaGVzLHRoaXMuX2FscGhhVGVzdFN1Yk1lc2hlcyx0aGlzLl90cmFuc3BhcmVudFN1Yk1lc2hlcyksITA7aWYoMD09PXRoaXMuX29wYXF1ZVN1Yk1lc2hlcy5sZW5ndGgmJjA9PT10aGlzLl9hbHBoYVRlc3RTdWJNZXNoZXMubGVuZ3RoJiYwPT09dGhpcy5fdHJhbnNwYXJlbnRTdWJNZXNoZXMubGVuZ3RoKXJldHVybiB0aGlzLm9uQmVmb3JlVHJhbnNwYXJlbnRSZW5kZXJpbmcmJnRoaXMub25CZWZvcmVUcmFuc3BhcmVudFJlbmRlcmluZygpLCExO3ZhciBpLHIsbj10aGlzLl9zY2VuZS5nZXRFbmdpbmUoKTtmb3IoaT0wO2k8dGhpcy5fb3BhcXVlU3ViTWVzaGVzLmxlbmd0aDtpKyspcj10aGlzLl9vcGFxdWVTdWJNZXNoZXMuZGF0YVtpXSxyLnJlbmRlcighMSk7Zm9yKG4uc2V0QWxwaGFUZXN0aW5nKCEwKSxpPTA7aTx0aGlzLl9hbHBoYVRlc3RTdWJNZXNoZXMubGVuZ3RoO2krKylyPXRoaXMuX2FscGhhVGVzdFN1Yk1lc2hlcy5kYXRhW2ldLHIucmVuZGVyKCExKTtpZihuLnNldEFscGhhVGVzdGluZyghMSksdGhpcy5vbkJlZm9yZVRyYW5zcGFyZW50UmVuZGVyaW5nJiZ0aGlzLm9uQmVmb3JlVHJhbnNwYXJlbnRSZW5kZXJpbmcoKSx0aGlzLl90cmFuc3BhcmVudFN1Yk1lc2hlcy5sZW5ndGgpe2ZvcihpPTA7aTx0aGlzLl90cmFuc3BhcmVudFN1Yk1lc2hlcy5sZW5ndGg7aSsrKXI9dGhpcy5fdHJhbnNwYXJlbnRTdWJNZXNoZXMuZGF0YVtpXSxyLl9hbHBoYUluZGV4PXIuZ2V0TWVzaCgpLmFscGhhSW5kZXgsci5fZGlzdGFuY2VUb0NhbWVyYT1yLmdldEJvdW5kaW5nSW5mbygpLmJvdW5kaW5nU3BoZXJlLmNlbnRlcldvcmxkLnN1YnRyYWN0KHRoaXMuX3NjZW5lLmFjdGl2ZUNhbWVyYS5nbG9iYWxQb3NpdGlvbikubGVuZ3RoKCk7dmFyIG89dGhpcy5fdHJhbnNwYXJlbnRTdWJNZXNoZXMuZGF0YS5zbGljZSgwLHRoaXMuX3RyYW5zcGFyZW50U3ViTWVzaGVzLmxlbmd0aCk7Zm9yKG8uc29ydChmdW5jdGlvbihlLHQpe3JldHVybiBlLl9hbHBoYUluZGV4PnQuX2FscGhhSW5kZXg/MTplLl9hbHBoYUluZGV4PHQuX2FscGhhSW5kZXg/LTE6ZS5fZGlzdGFuY2VUb0NhbWVyYTx0Ll9kaXN0YW5jZVRvQ2FtZXJhPzE6ZS5fZGlzdGFuY2VUb0NhbWVyYT50Ll9kaXN0YW5jZVRvQ2FtZXJhPy0xOjB9KSxpPTA7aTxvLmxlbmd0aDtpKyspcj1vW2ldLHIucmVuZGVyKCEwKTtuLnNldEFscGhhTW9kZShlLkVuZ2luZS5BTFBIQV9ESVNBQkxFKX1yZXR1cm4hMH0sdC5wcm90b3R5cGUucHJlcGFyZT1mdW5jdGlvbigpe3RoaXMuX29wYXF1ZVN1Yk1lc2hlcy5yZXNldCgpLHRoaXMuX3RyYW5zcGFyZW50U3ViTWVzaGVzLnJlc2V0KCksdGhpcy5fYWxwaGFUZXN0U3ViTWVzaGVzLnJlc2V0KCl9LHQucHJvdG90eXBlLmRpc3BhdGNoPWZ1bmN0aW9uKGUpe3ZhciB0PWUuZ2V0TWF0ZXJpYWwoKSxpPWUuZ2V0TWVzaCgpO3QubmVlZEFscGhhQmxlbmRpbmcoKXx8aS52aXNpYmlsaXR5PDF8fGkuaGFzVmVydGV4QWxwaGE/dGhpcy5fdHJhbnNwYXJlbnRTdWJNZXNoZXMucHVzaChlKTp0Lm5lZWRBbHBoYVRlc3RpbmcoKT90aGlzLl9hbHBoYVRlc3RTdWJNZXNoZXMucHVzaChlKTp0aGlzLl9vcGFxdWVTdWJNZXNoZXMucHVzaChlKX0sdH0oKTtlLlJlbmRlcmluZ0dyb3VwPXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSgpe31yZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsXCJQT0lOVEVSRE9XTlwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gZS5fUE9JTlRFUkRPV059LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsXCJQT0lOVEVSVVBcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGUuX1BPSU5URVJVUH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZSxcIlBPSU5URVJNT1ZFXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBlLl9QT0lOVEVSTU9WRX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZSxcIlBPSU5URVJXSEVFTFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gZS5fUE9JTlRFUldIRUVMfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLFwiUE9JTlRFUlBJQ0tcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGUuX1BPSU5URVJQSUNLfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLGUuX1BPSU5URVJET1dOPTEsZS5fUE9JTlRFUlVQPTIsZS5fUE9JTlRFUk1PVkU9NCxlLl9QT0lOVEVSV0hFRUw9OCxlLl9QT0lOVEVSUElDSz0xNixlfSgpO2UuUG9pbnRlckV2ZW50VHlwZXM9dDt2YXIgaT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSx0KXt0aGlzLnR5cGU9ZSx0aGlzLmV2ZW50PXR9cmV0dXJuIGV9KCk7ZS5Qb2ludGVySW5mb0Jhc2U9aTt2YXIgcj1mdW5jdGlvbih0KXtmdW5jdGlvbiBpKGkscixuLG8pe3QuY2FsbCh0aGlzLGksciksdGhpcy5za2lwT25Qb2ludGVyT2JzZXJ2YWJsZT0hMSx0aGlzLmxvY2FsUG9zaXRpb249bmV3IGUuVmVjdG9yMihuLG8pfXJldHVybiBfX2V4dGVuZHMoaSx0KSxpfShpKTtlLlBvaW50ZXJJbmZvUHJlPXI7dmFyIG49ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdCh0LGkscil7ZS5jYWxsKHRoaXMsdCxpKSx0aGlzLnBpY2tJbmZvPXJ9cmV0dXJuIF9fZXh0ZW5kcyh0LGUpLHR9KGkpO2UuUG9pbnRlckluZm89bjt2YXIgbz1mdW5jdGlvbigpe2Z1bmN0aW9uIGkodCl7dGhpcy5hdXRvQ2xlYXI9ITAsdGhpcy5jbGVhckNvbG9yPW5ldyBlLkNvbG9yMyguMiwuMiwuMyksdGhpcy5hbWJpZW50Q29sb3I9bmV3IGUuQ29sb3IzKDAsMCwwKSx0aGlzLmZvcmNlV2lyZWZyYW1lPSExLHRoaXMuZm9yY2VQb2ludHNDbG91ZD0hMSx0aGlzLmZvcmNlU2hvd0JvdW5kaW5nQm94ZXM9ITEsdGhpcy5hbmltYXRpb25zRW5hYmxlZD0hMCx0aGlzLmNvbnN0YW50bHlVcGRhdGVNZXNoVW5kZXJQb2ludGVyPSExLHRoaXMub25EaXNwb3NlT2JzZXJ2YWJsZT1uZXcgZS5PYnNlcnZhYmxlLHRoaXMub25CZWZvcmVSZW5kZXJPYnNlcnZhYmxlPW5ldyBlLk9ic2VydmFibGUsdGhpcy5vbkFmdGVyUmVuZGVyT2JzZXJ2YWJsZT1uZXcgZS5PYnNlcnZhYmxlLHRoaXMub25SZWFkeU9ic2VydmFibGU9bmV3IGUuT2JzZXJ2YWJsZSx0aGlzLm9uQmVmb3JlQ2FtZXJhUmVuZGVyT2JzZXJ2YWJsZT1uZXcgZS5PYnNlcnZhYmxlLHRoaXMub25BZnRlckNhbWVyYVJlbmRlck9ic2VydmFibGU9bmV3IGUuT2JzZXJ2YWJsZSx0aGlzLm9uTmV3Q2FtZXJhQWRkZWRPYnNlcnZhYmxlPW5ldyBlLk9ic2VydmFibGUsdGhpcy5vbkNhbWVyYVJlbW92ZWRPYnNlcnZhYmxlPW5ldyBlLk9ic2VydmFibGUsdGhpcy5vbk5ld0xpZ2h0QWRkZWRPYnNlcnZhYmxlPW5ldyBlLk9ic2VydmFibGUsdGhpcy5vbkxpZ2h0UmVtb3ZlZE9ic2VydmFibGU9bmV3IGUuT2JzZXJ2YWJsZSx0aGlzLm9uTmV3R2VvbWV0cnlBZGRlZE9ic2VydmFibGU9bmV3IGUuT2JzZXJ2YWJsZSx0aGlzLm9uR2VvbWV0cnlSZW1vdmVkT2JzZXJ2YWJsZT1uZXcgZS5PYnNlcnZhYmxlLHRoaXMub25OZXdNZXNoQWRkZWRPYnNlcnZhYmxlPW5ldyBlLk9ic2VydmFibGUsdGhpcy5vbk1lc2hSZW1vdmVkT2JzZXJ2YWJsZT1uZXcgZS5PYnNlcnZhYmxlLHRoaXMuYW5pbWF0aW9ucz1bXSx0aGlzLm9uUHJlUG9pbnRlck9ic2VydmFibGU9bmV3IGUuT2JzZXJ2YWJsZSx0aGlzLm9uUG9pbnRlck9ic2VydmFibGU9bmV3IGUuT2JzZXJ2YWJsZSx0aGlzLmNhbWVyYVRvVXNlRm9yUG9pbnRlcnM9bnVsbCx0aGlzLl9zdGFydGluZ1BvaW50ZXJQb3NpdGlvbj1uZXcgZS5WZWN0b3IyKDAsMCksdGhpcy5fc3RhcnRpbmdQb2ludGVyVGltZT0wLHRoaXMuZm9nRW5hYmxlZD0hMCx0aGlzLmZvZ01vZGU9aS5GT0dNT0RFX05PTkUsdGhpcy5mb2dDb2xvcj1uZXcgZS5Db2xvcjMoLjIsLjIsLjMpLHRoaXMuZm9nRGVuc2l0eT0uMSx0aGlzLmZvZ1N0YXJ0PTAsdGhpcy5mb2dFbmQ9MWUzLHRoaXMuc2hhZG93c0VuYWJsZWQ9ITAsdGhpcy5saWdodHNFbmFibGVkPSEwLHRoaXMubGlnaHRzPW5ldyBBcnJheSx0aGlzLmNhbWVyYXM9bmV3IEFycmF5LHRoaXMuYWN0aXZlQ2FtZXJhcz1uZXcgQXJyYXksdGhpcy5tZXNoZXM9bmV3IEFycmF5LHRoaXMuX2dlb21ldHJpZXM9bmV3IEFycmF5LHRoaXMubWF0ZXJpYWxzPW5ldyBBcnJheSx0aGlzLm11bHRpTWF0ZXJpYWxzPW5ldyBBcnJheSx0aGlzLmRlZmF1bHRNYXRlcmlhbD1uZXcgZS5TdGFuZGFyZE1hdGVyaWFsKFwiZGVmYXVsdCBtYXRlcmlhbFwiLHRoaXMpLHRoaXMudGV4dHVyZXNFbmFibGVkPSEwLHRoaXMudGV4dHVyZXM9bmV3IEFycmF5LHRoaXMucGFydGljbGVzRW5hYmxlZD0hMCx0aGlzLnBhcnRpY2xlU3lzdGVtcz1uZXcgQXJyYXksdGhpcy5zcHJpdGVzRW5hYmxlZD0hMCx0aGlzLnNwcml0ZU1hbmFnZXJzPW5ldyBBcnJheSx0aGlzLmxheWVycz1uZXcgQXJyYXksdGhpcy5za2VsZXRvbnNFbmFibGVkPSEwLHRoaXMuc2tlbGV0b25zPW5ldyBBcnJheSx0aGlzLmxlbnNGbGFyZXNFbmFibGVkPSEwLHRoaXMubGVuc0ZsYXJlU3lzdGVtcz1uZXcgQXJyYXksdGhpcy5jb2xsaXNpb25zRW5hYmxlZD0hMCx0aGlzLmdyYXZpdHk9bmV3IGUuVmVjdG9yMygwLC05LjgwNywwKSx0aGlzLnBvc3RQcm9jZXNzZXNFbmFibGVkPSEwLHRoaXMucmVuZGVyVGFyZ2V0c0VuYWJsZWQ9ITAsdGhpcy5kdW1wTmV4dFJlbmRlclRhcmdldHM9ITEsdGhpcy5jdXN0b21SZW5kZXJUYXJnZXRzPW5ldyBBcnJheSx0aGlzLmltcG9ydGVkTWVzaGVzRmlsZXM9bmV3IEFycmF5LHRoaXMucHJvYmVzRW5hYmxlZD0hMCx0aGlzLnJlZmxlY3Rpb25Qcm9iZXM9bmV3IEFycmF5LHRoaXMuX2FjdGlvbk1hbmFnZXJzPW5ldyBBcnJheSx0aGlzLl9tZXNoZXNGb3JJbnRlcnNlY3Rpb25zPW5ldyBlLlNtYXJ0QXJyYXkoMjU2KSx0aGlzLnByb2NlZHVyYWxUZXh0dXJlc0VuYWJsZWQ9ITAsdGhpcy5fcHJvY2VkdXJhbFRleHR1cmVzPW5ldyBBcnJheSx0aGlzLnNvdW5kVHJhY2tzPW5ldyBBcnJheSx0aGlzLl9hdWRpb0VuYWJsZWQ9ITAsdGhpcy5faGVhZHBob25lPSExLHRoaXMuX3RvdGFsVmVydGljZXM9MCx0aGlzLl9hY3RpdmVJbmRpY2VzPTAsdGhpcy5fYWN0aXZlUGFydGljbGVzPTAsdGhpcy5fbGFzdEZyYW1lRHVyYXRpb249MCx0aGlzLl9ldmFsdWF0ZUFjdGl2ZU1lc2hlc0R1cmF0aW9uPTAsdGhpcy5fcmVuZGVyVGFyZ2V0c0R1cmF0aW9uPTAsdGhpcy5fcGFydGljbGVzRHVyYXRpb249MCx0aGlzLl9yZW5kZXJEdXJhdGlvbj0wLHRoaXMuX3Nwcml0ZXNEdXJhdGlvbj0wLHRoaXMuX2FuaW1hdGlvblJhdGlvPTAsdGhpcy5fcmVuZGVySWQ9MCx0aGlzLl9leGVjdXRlV2hlblJlYWR5VGltZW91dElkPS0xLHRoaXMuX2ludGVybWVkaWF0ZVJlbmRlcmluZz0hMSx0aGlzLl90b0JlRGlzcG9zZWQ9bmV3IGUuU21hcnRBcnJheSgyNTYpLHRoaXMuX3BlbmRpbmdEYXRhPVtdLHRoaXMuX2FjdGl2ZU1lc2hlcz1uZXcgZS5TbWFydEFycmF5KDI1NiksdGhpcy5fcHJvY2Vzc2VkTWF0ZXJpYWxzPW5ldyBlLlNtYXJ0QXJyYXkoMjU2KSx0aGlzLl9yZW5kZXJUYXJnZXRzPW5ldyBlLlNtYXJ0QXJyYXkoMjU2KSx0aGlzLl9hY3RpdmVQYXJ0aWNsZVN5c3RlbXM9bmV3IGUuU21hcnRBcnJheSgyNTYpLHRoaXMuX2FjdGl2ZVNrZWxldG9ucz1uZXcgZS5TbWFydEFycmF5KDMyKSx0aGlzLl9zb2Z0d2FyZVNraW5uZWRNZXNoZXM9bmV3IGUuU21hcnRBcnJheSgzMiksdGhpcy5fYWN0aXZlQm9uZXM9MCx0aGlzLl9hY3RpdmVBbmltYXRhYmxlcz1uZXcgQXJyYXksdGhpcy5fdHJhbnNmb3JtTWF0cml4PWUuTWF0cml4Llplcm8oKSx0aGlzLl9lZGdlc1JlbmRlcmVycz1uZXcgZS5TbWFydEFycmF5KDE2KSx0aGlzLl91bmlxdWVJZENvdW50ZXI9MCx0aGlzLl9lbmdpbmU9dCx0LnNjZW5lcy5wdXNoKHRoaXMpLHRoaXMuX3JlbmRlcmluZ01hbmFnZXI9bmV3IGUuUmVuZGVyaW5nTWFuYWdlcih0aGlzKSx0aGlzLnBvc3RQcm9jZXNzTWFuYWdlcj1uZXcgZS5Qb3N0UHJvY2Vzc01hbmFnZXIodGhpcyksdGhpcy5wb3N0UHJvY2Vzc1JlbmRlclBpcGVsaW5lTWFuYWdlcj1uZXcgZS5Qb3N0UHJvY2Vzc1JlbmRlclBpcGVsaW5lTWFuYWdlcix0aGlzLl9ib3VuZGluZ0JveFJlbmRlcmVyPW5ldyBlLkJvdW5kaW5nQm94UmVuZGVyZXIodGhpcyksZS5PdXRsaW5lUmVuZGVyZXImJih0aGlzLl9vdXRsaW5lUmVuZGVyZXI9bmV3IGUuT3V0bGluZVJlbmRlcmVyKHRoaXMpKSx0aGlzLmF0dGFjaENvbnRyb2woKSxlLlNvdW5kVHJhY2smJih0aGlzLm1haW5Tb3VuZFRyYWNrPW5ldyBlLlNvdW5kVHJhY2sodGhpcyx7bWFpblRyYWNrOiEwfSkpLGUuU2ltcGxpZmljYXRpb25RdWV1ZSYmKHRoaXMuc2ltcGxpZmljYXRpb25RdWV1ZT1uZXcgZS5TaW1wbGlmaWNhdGlvblF1ZXVlKSx0aGlzLndvcmtlckNvbGxpc2lvbnM9ITF9cmV0dXJuIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLFwiRk9HTU9ERV9OT05FXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBpLl9GT0dNT0RFX05PTkV9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGksXCJGT0dNT0RFX0VYUFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gaS5fRk9HTU9ERV9FWFB9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGksXCJGT0dNT0RFX0VYUDJcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGkuX0ZPR01PREVfRVhQMn0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaSxcIkZPR01PREVfTElORUFSXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBpLl9GT0dNT0RFX0xJTkVBUn0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJvbkRpc3Bvc2VcIix7c2V0OmZ1bmN0aW9uKGUpe3RoaXMuX29uRGlzcG9zZU9ic2VydmVyJiZ0aGlzLm9uRGlzcG9zZU9ic2VydmFibGUucmVtb3ZlKHRoaXMuX29uRGlzcG9zZU9ic2VydmVyKSx0aGlzLl9vbkRpc3Bvc2VPYnNlcnZlcj10aGlzLm9uRGlzcG9zZU9ic2VydmFibGUuYWRkKGUpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcImJlZm9yZVJlbmRlclwiLHtzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fb25CZWZvcmVSZW5kZXJPYnNlcnZlciYmdGhpcy5vbkJlZm9yZVJlbmRlck9ic2VydmFibGUucmVtb3ZlKHRoaXMuX29uQmVmb3JlUmVuZGVyT2JzZXJ2ZXIpLHRoaXMuX29uQmVmb3JlUmVuZGVyT2JzZXJ2ZXI9dGhpcy5vbkJlZm9yZVJlbmRlck9ic2VydmFibGUuYWRkKGUpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcImFmdGVyUmVuZGVyXCIse3NldDpmdW5jdGlvbihlKXt0aGlzLl9vbkFmdGVyUmVuZGVyT2JzZXJ2ZXImJnRoaXMub25BZnRlclJlbmRlck9ic2VydmFibGUucmVtb3ZlKHRoaXMuX29uQWZ0ZXJSZW5kZXJPYnNlcnZlciksdGhpcy5fb25BZnRlclJlbmRlck9ic2VydmVyPXRoaXMub25BZnRlclJlbmRlck9ic2VydmFibGUuYWRkKGUpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcImJlZm9yZUNhbWVyYVJlbmRlclwiLHtzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fb25CZWZvcmVDYW1lcmFSZW5kZXJPYnNlcnZlciYmdGhpcy5vbkJlZm9yZUNhbWVyYVJlbmRlck9ic2VydmFibGUucmVtb3ZlKHRoaXMuX29uQmVmb3JlQ2FtZXJhUmVuZGVyT2JzZXJ2ZXIpLHRoaXMuX29uQmVmb3JlQ2FtZXJhUmVuZGVyT2JzZXJ2ZXI9dGhpcy5vbkJlZm9yZUNhbWVyYVJlbmRlck9ic2VydmFibGUuYWRkKGUpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcImFmdGVyQ2FtZXJhUmVuZGVyXCIse3NldDpmdW5jdGlvbihlKXt0aGlzLl9vbkFmdGVyQ2FtZXJhUmVuZGVyT2JzZXJ2ZXImJnRoaXMub25BZnRlckNhbWVyYVJlbmRlck9ic2VydmFibGUucmVtb3ZlKHRoaXMuX29uQWZ0ZXJDYW1lcmFSZW5kZXJPYnNlcnZlciksdGhpcy5fb25BZnRlckNhbWVyYVJlbmRlck9ic2VydmVyPXRoaXMub25BZnRlckNhbWVyYVJlbmRlck9ic2VydmFibGUuYWRkKGUpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcInVuVHJhbnNsYXRlZFBvaW50ZXJcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBlLlZlY3RvcjIodGhpcy5fdW5UcmFuc2xhdGVkUG9pbnRlclgsdGhpcy5fdW5UcmFuc2xhdGVkUG9pbnRlclkpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcImRlYnVnTGF5ZXJcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2RlYnVnTGF5ZXJ8fCh0aGlzLl9kZWJ1Z0xheWVyPW5ldyBlLkRlYnVnTGF5ZXIodGhpcykpLHRoaXMuX2RlYnVnTGF5ZXJ9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGkucHJvdG90eXBlLFwid29ya2VyQ29sbGlzaW9uc1wiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fd29ya2VyQ29sbGlzaW9uc30sc2V0OmZ1bmN0aW9uKHQpe3Q9dCYmISFXb3JrZXIsdGhpcy5fd29ya2VyQ29sbGlzaW9ucz10LHRoaXMuY29sbGlzaW9uQ29vcmRpbmF0b3ImJnRoaXMuY29sbGlzaW9uQ29vcmRpbmF0b3IuZGVzdHJveSgpLHRoaXMuY29sbGlzaW9uQ29vcmRpbmF0b3I9dD9uZXcgZS5Db2xsaXNpb25Db29yZGluYXRvcldvcmtlcjpuZXcgZS5Db2xsaXNpb25Db29yZGluYXRvckxlZ2FjeSx0aGlzLmNvbGxpc2lvbkNvb3JkaW5hdG9yLmluaXQodGhpcyl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGkucHJvdG90eXBlLFwiU2VsZWN0aW9uT2N0cmVlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9zZWxlY3Rpb25PY3RyZWV9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGkucHJvdG90eXBlLFwibWVzaFVuZGVyUG9pbnRlclwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcG9pbnRlck92ZXJNZXNofSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcInBvaW50ZXJYXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9wb2ludGVyWH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJwb2ludGVyWVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcG9pbnRlcll9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksaS5wcm90b3R5cGUuZ2V0Q2FjaGVkTWF0ZXJpYWw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fY2FjaGVkTWF0ZXJpYWx9LGkucHJvdG90eXBlLmdldEJvdW5kaW5nQm94UmVuZGVyZXI9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fYm91bmRpbmdCb3hSZW5kZXJlcn0saS5wcm90b3R5cGUuZ2V0T3V0bGluZVJlbmRlcmVyPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX291dGxpbmVSZW5kZXJlcn0saS5wcm90b3R5cGUuZ2V0RW5naW5lPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2VuZ2luZX0saS5wcm90b3R5cGUuZ2V0VG90YWxWZXJ0aWNlcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLl90b3RhbFZlcnRpY2VzfSxpLnByb3RvdHlwZS5nZXRBY3RpdmVJbmRpY2VzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2FjdGl2ZUluZGljZXN9LGkucHJvdG90eXBlLmdldEFjdGl2ZVBhcnRpY2xlcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9hY3RpdmVQYXJ0aWNsZXN9LGkucHJvdG90eXBlLmdldEFjdGl2ZUJvbmVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2FjdGl2ZUJvbmVzfSxpLnByb3RvdHlwZS5nZXRMYXN0RnJhbWVEdXJhdGlvbj1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9sYXN0RnJhbWVEdXJhdGlvbn0saS5wcm90b3R5cGUuZ2V0RXZhbHVhdGVBY3RpdmVNZXNoZXNEdXJhdGlvbj1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9ldmFsdWF0ZUFjdGl2ZU1lc2hlc0R1cmF0aW9ufSxpLnByb3RvdHlwZS5nZXRBY3RpdmVNZXNoZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fYWN0aXZlTWVzaGVzfSxpLnByb3RvdHlwZS5nZXRSZW5kZXJUYXJnZXRzRHVyYXRpb249ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcmVuZGVyVGFyZ2V0c0R1cmF0aW9ufSxpLnByb3RvdHlwZS5nZXRSZW5kZXJEdXJhdGlvbj1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9yZW5kZXJEdXJhdGlvbn0saS5wcm90b3R5cGUuZ2V0UGFydGljbGVzRHVyYXRpb249ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcGFydGljbGVzRHVyYXRpb259LGkucHJvdG90eXBlLmdldFNwcml0ZXNEdXJhdGlvbj1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9zcHJpdGVzRHVyYXRpb259LGkucHJvdG90eXBlLmdldEFuaW1hdGlvblJhdGlvPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2FuaW1hdGlvblJhdGlvfSxpLnByb3RvdHlwZS5nZXRSZW5kZXJJZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9yZW5kZXJJZH0saS5wcm90b3R5cGUuaW5jcmVtZW50UmVuZGVySWQ9ZnVuY3Rpb24oKXt0aGlzLl9yZW5kZXJJZCsrfSxpLnByb3RvdHlwZS5fdXBkYXRlUG9pbnRlclBvc2l0aW9uPWZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuX2VuZ2luZS5nZXRSZW5kZXJpbmdDYW52YXNDbGllbnRSZWN0KCk7dGhpcy5fcG9pbnRlclg9ZS5jbGllbnRYLXQubGVmdCx0aGlzLl9wb2ludGVyWT1lLmNsaWVudFktdC50b3AsdGhpcy5fdW5UcmFuc2xhdGVkUG9pbnRlclg9dGhpcy5fcG9pbnRlclgsdGhpcy5fdW5UcmFuc2xhdGVkUG9pbnRlclk9dGhpcy5fcG9pbnRlclksdGhpcy5jYW1lcmFUb1VzZUZvclBvaW50ZXJzJiYodGhpcy5fcG9pbnRlclg9dGhpcy5fcG9pbnRlclgtdGhpcy5jYW1lcmFUb1VzZUZvclBvaW50ZXJzLnZpZXdwb3J0LngqdGhpcy5fZW5naW5lLmdldFJlbmRlcldpZHRoKCksdGhpcy5fcG9pbnRlclk9dGhpcy5fcG9pbnRlclktdGhpcy5jYW1lcmFUb1VzZUZvclBvaW50ZXJzLnZpZXdwb3J0LnkqdGhpcy5fZW5naW5lLmdldFJlbmRlckhlaWdodCgpKX0saS5wcm90b3R5cGUuYXR0YWNoQ29udHJvbD1mdW5jdGlvbihpLG8scyl7dmFyIGE9dGhpczt2b2lkIDA9PT1pJiYoaT0hMCksdm9pZCAwPT09byYmKG89ITApLHZvaWQgMD09PXMmJihzPSEwKTt2YXIgaD1mdW5jdGlvbihlKXtyZXR1cm4gZS5pc1BpY2thYmxlJiZlLmFjdGlvbk1hbmFnZXImJmUuYWN0aW9uTWFuYWdlci5oYXNQb2ludGVyVHJpZ2dlcnN9O3RoaXMuX29uUG9pbnRlck1vdmU9ZnVuY3Rpb24oZSl7aWYoYS5fdXBkYXRlUG9pbnRlclBvc2l0aW9uKGUpLGEub25QcmVQb2ludGVyT2JzZXJ2YWJsZS5oYXNPYnNlcnZlcnMoKSl7dmFyIGk9XCJtb3VzZXdoZWVsXCI9PT1lLnR5cGV8fFwiRE9NTW91c2VTY3JvbGxcIj09PWUudHlwZT90LlBPSU5URVJXSEVFTDp0LlBPSU5URVJNT1ZFLG89bmV3IHIoaSxlLGEuX3VuVHJhbnNsYXRlZFBvaW50ZXJYLGEuX3VuVHJhbnNsYXRlZFBvaW50ZXJZKTtpZihhLm9uUHJlUG9pbnRlck9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKG8saSksby5za2lwT25Qb2ludGVyT2JzZXJ2YWJsZSlyZXR1cm59aWYoYS5jYW1lcmFUb1VzZUZvclBvaW50ZXJzfHxhLmFjdGl2ZUNhbWVyYSl7dmFyIHM9YS5fZW5naW5lLmdldFJlbmRlcmluZ0NhbnZhcygpO2EucG9pbnRlck1vdmVQcmVkaWNhdGV8fChhLnBvaW50ZXJNb3ZlUHJlZGljYXRlPWZ1bmN0aW9uKGUpe3JldHVybiBlLmlzUGlja2FibGUmJmUuaXNWaXNpYmxlJiZlLmlzUmVhZHkoKSYmKGEuY29uc3RhbnRseVVwZGF0ZU1lc2hVbmRlclBvaW50ZXJ8fG51bGwhPT1lLmFjdGlvbk1hbmFnZXImJnZvaWQgMCE9PWUuYWN0aW9uTWFuYWdlcil9KTt2YXIgYz1hLnBpY2soYS5fdW5UcmFuc2xhdGVkUG9pbnRlclgsYS5fdW5UcmFuc2xhdGVkUG9pbnRlclksYS5wb2ludGVyTW92ZVByZWRpY2F0ZSwhMSxhLmNhbWVyYVRvVXNlRm9yUG9pbnRlcnMpO2lmKGMuaGl0JiZjLnBpY2tlZE1lc2g/KGEuc2V0UG9pbnRlck92ZXJTcHJpdGUobnVsbCksYS5zZXRQb2ludGVyT3Zlck1lc2goYy5waWNrZWRNZXNoKSxhLl9wb2ludGVyT3Zlck1lc2guYWN0aW9uTWFuYWdlciYmYS5fcG9pbnRlck92ZXJNZXNoLmFjdGlvbk1hbmFnZXIuaGFzUG9pbnRlclRyaWdnZXJzP3Muc3R5bGUuY3Vyc29yPVwicG9pbnRlclwiOnMuc3R5bGUuY3Vyc29yPVwiXCIpOihhLnNldFBvaW50ZXJPdmVyTWVzaChudWxsKSxjPWEucGlja1Nwcml0ZShhLl91blRyYW5zbGF0ZWRQb2ludGVyWCxhLl91blRyYW5zbGF0ZWRQb2ludGVyWSxoLCExLGEuY2FtZXJhVG9Vc2VGb3JQb2ludGVycyksYy5oaXQmJmMucGlja2VkU3ByaXRlPyhzLnN0eWxlLmN1cnNvcj1cInBvaW50ZXJcIixhLnNldFBvaW50ZXJPdmVyU3ByaXRlKGMucGlja2VkU3ByaXRlKSk6KGEuc2V0UG9pbnRlck92ZXJTcHJpdGUobnVsbCkscy5zdHlsZS5jdXJzb3I9XCJcIikpLGEub25Qb2ludGVyTW92ZSYmYS5vblBvaW50ZXJNb3ZlKGUsYyksYS5vblBvaW50ZXJPYnNlcnZhYmxlLmhhc09ic2VydmVycygpKXt2YXIgaT1cIm1vdXNld2hlZWxcIj09PWUudHlwZXx8XCJET01Nb3VzZVNjcm9sbFwiPT09ZS50eXBlP3QuUE9JTlRFUldIRUVMOnQuUE9JTlRFUk1PVkUsbz1uZXcgbihpLGUsYyk7YS5vblBvaW50ZXJPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhvLGkpfX19LHRoaXMuX29uUG9pbnRlckRvd249ZnVuY3Rpb24oaSl7aWYoYS5fdXBkYXRlUG9pbnRlclBvc2l0aW9uKGkpLGEub25QcmVQb2ludGVyT2JzZXJ2YWJsZS5oYXNPYnNlcnZlcnMoKSl7dmFyIG89dC5QT0lOVEVSRE9XTixzPW5ldyByKG8saSxhLl91blRyYW5zbGF0ZWRQb2ludGVyWCxhLl91blRyYW5zbGF0ZWRQb2ludGVyWSk7aWYoYS5vblByZVBvaW50ZXJPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhzLG8pLHMuc2tpcE9uUG9pbnRlck9ic2VydmFibGUpcmV0dXJufWlmKGEuY2FtZXJhVG9Vc2VGb3JQb2ludGVyc3x8YS5hY3RpdmVDYW1lcmEpe2EuX3N0YXJ0aW5nUG9pbnRlclBvc2l0aW9uLng9YS5fcG9pbnRlclgsYS5fc3RhcnRpbmdQb2ludGVyUG9zaXRpb24ueT1hLl9wb2ludGVyWSxhLl9zdGFydGluZ1BvaW50ZXJUaW1lPShuZXcgRGF0ZSkuZ2V0VGltZSgpLGEucG9pbnRlckRvd25QcmVkaWNhdGV8fChhLnBvaW50ZXJEb3duUHJlZGljYXRlPWZ1bmN0aW9uKGUpe3JldHVybiBlLmlzUGlja2FibGUmJmUuaXNWaXNpYmxlJiZlLmlzUmVhZHkoKSYmKCFlLmFjdGlvbk1hbmFnZXJ8fGUuYWN0aW9uTWFuYWdlci5oYXNQb2ludGVyVHJpZ2dlcnMpfSksYS5fcGlja2VkRG93bk1lc2g9bnVsbDt2YXIgYz1hLnBpY2soYS5fdW5UcmFuc2xhdGVkUG9pbnRlclgsYS5fdW5UcmFuc2xhdGVkUG9pbnRlclksYS5wb2ludGVyRG93blByZWRpY2F0ZSwhMSxhLmNhbWVyYVRvVXNlRm9yUG9pbnRlcnMpO2lmKGMuaGl0JiZjLnBpY2tlZE1lc2gmJmMucGlja2VkTWVzaC5hY3Rpb25NYW5hZ2VyKXtpZihhLl9waWNrZWREb3duTWVzaD1jLnBpY2tlZE1lc2gsYy5waWNrZWRNZXNoLmFjdGlvbk1hbmFnZXIuaGFzUGlja1RyaWdnZXJzKXtzd2l0Y2goaS5idXR0b24pe2Nhc2UgMDpjLnBpY2tlZE1lc2guYWN0aW9uTWFuYWdlci5wcm9jZXNzVHJpZ2dlcihlLkFjdGlvbk1hbmFnZXIuT25MZWZ0UGlja1RyaWdnZXIsZS5BY3Rpb25FdmVudC5DcmVhdGVOZXcoYy5waWNrZWRNZXNoLGkpKTticmVhaztjYXNlIDE6Yy5waWNrZWRNZXNoLmFjdGlvbk1hbmFnZXIucHJvY2Vzc1RyaWdnZXIoZS5BY3Rpb25NYW5hZ2VyLk9uQ2VudGVyUGlja1RyaWdnZXIsZS5BY3Rpb25FdmVudC5DcmVhdGVOZXcoYy5waWNrZWRNZXNoLGkpKTticmVhaztjYXNlIDI6Yy5waWNrZWRNZXNoLmFjdGlvbk1hbmFnZXIucHJvY2Vzc1RyaWdnZXIoZS5BY3Rpb25NYW5hZ2VyLk9uUmlnaHRQaWNrVHJpZ2dlcixlLkFjdGlvbkV2ZW50LkNyZWF0ZU5ldyhjLnBpY2tlZE1lc2gsaSkpfWMucGlja2VkTWVzaC5hY3Rpb25NYW5hZ2VyLnByb2Nlc3NUcmlnZ2VyKGUuQWN0aW9uTWFuYWdlci5PblBpY2tEb3duVHJpZ2dlcixlLkFjdGlvbkV2ZW50LkNyZWF0ZU5ldyhjLnBpY2tlZE1lc2gsaSkpfWlmKGMucGlja2VkTWVzaC5hY3Rpb25NYW5hZ2VyLmhhc1NwZWNpZmljVHJpZ2dlcihlLkFjdGlvbk1hbmFnZXIuT25Mb25nUHJlc3NUcmlnZ2VyKSl7dmFyIGw9YTt3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbigpe3ZhciB0PWwucGljayhsLl91blRyYW5zbGF0ZWRQb2ludGVyWCxsLl91blRyYW5zbGF0ZWRQb2ludGVyWSxmdW5jdGlvbih0KXtyZXR1cm4gdC5pc1BpY2thYmxlJiZ0LmlzVmlzaWJsZSYmdC5pc1JlYWR5KCkmJnQuYWN0aW9uTWFuYWdlciYmdC5hY3Rpb25NYW5hZ2VyLmhhc1NwZWNpZmljVHJpZ2dlcihlLkFjdGlvbk1hbmFnZXIuT25Mb25nUHJlc3NUcmlnZ2VyKX0sITEsbC5jYW1lcmFUb1VzZUZvclBvaW50ZXJzKTt0LmhpdCYmdC5waWNrZWRNZXNoJiZ0LnBpY2tlZE1lc2guYWN0aW9uTWFuYWdlciYmMCE9PWwuX3N0YXJ0aW5nUG9pbnRlclRpbWUmJihuZXcgRGF0ZSkuZ2V0VGltZSgpLWwuX3N0YXJ0aW5nUG9pbnRlclRpbWU+ZS5BY3Rpb25NYW5hZ2VyLkxvbmdQcmVzc0RlbGF5JiZNYXRoLmFicyhsLl9zdGFydGluZ1BvaW50ZXJQb3NpdGlvbi54LWwuX3BvaW50ZXJYKTxlLkFjdGlvbk1hbmFnZXIuRHJhZ01vdmVtZW50VGhyZXNob2xkJiZNYXRoLmFicyhsLl9zdGFydGluZ1BvaW50ZXJQb3NpdGlvbi55LWwuX3BvaW50ZXJZKTxlLkFjdGlvbk1hbmFnZXIuRHJhZ01vdmVtZW50VGhyZXNob2xkJiYobC5fc3RhcnRpbmdQb2ludGVyVGltZT0wLHQucGlja2VkTWVzaC5hY3Rpb25NYW5hZ2VyLnByb2Nlc3NUcmlnZ2VyKGUuQWN0aW9uTWFuYWdlci5PbkxvbmdQcmVzc1RyaWdnZXIsZS5BY3Rpb25FdmVudC5DcmVhdGVOZXcodC5waWNrZWRNZXNoLGkpKSl9LGUuQWN0aW9uTWFuYWdlci5Mb25nUHJlc3NEZWxheSl9fWlmKGEub25Qb2ludGVyRG93biYmYS5vblBvaW50ZXJEb3duKGksYyksYS5vblBvaW50ZXJPYnNlcnZhYmxlLmhhc09ic2VydmVycygpKXt2YXIgbz10LlBPSU5URVJET1dOLHM9bmV3IG4obyxpLGMpO2Eub25Qb2ludGVyT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMocyxvKX1pZihhLl9waWNrZWREb3duU3ByaXRlPW51bGwsYS5zcHJpdGVNYW5hZ2Vycy5sZW5ndGg+MCYmKGM9YS5waWNrU3ByaXRlKGEuX3VuVHJhbnNsYXRlZFBvaW50ZXJYLGEuX3VuVHJhbnNsYXRlZFBvaW50ZXJZLGgsITEsYS5jYW1lcmFUb1VzZUZvclBvaW50ZXJzKSxjLmhpdCYmYy5waWNrZWRTcHJpdGUmJmMucGlja2VkU3ByaXRlLmFjdGlvbk1hbmFnZXIpKXtzd2l0Y2goYS5fcGlja2VkRG93blNwcml0ZT1jLnBpY2tlZFNwcml0ZSxpLmJ1dHRvbil7Y2FzZSAwOmMucGlja2VkU3ByaXRlLmFjdGlvbk1hbmFnZXIucHJvY2Vzc1RyaWdnZXIoZS5BY3Rpb25NYW5hZ2VyLk9uTGVmdFBpY2tUcmlnZ2VyLGUuQWN0aW9uRXZlbnQuQ3JlYXRlTmV3RnJvbVNwcml0ZShjLnBpY2tlZFNwcml0ZSxhLGkpKTticmVhaztjYXNlIDE6Yy5waWNrZWRTcHJpdGUuYWN0aW9uTWFuYWdlci5wcm9jZXNzVHJpZ2dlcihlLkFjdGlvbk1hbmFnZXIuT25DZW50ZXJQaWNrVHJpZ2dlcixlLkFjdGlvbkV2ZW50LkNyZWF0ZU5ld0Zyb21TcHJpdGUoYy5waWNrZWRTcHJpdGUsYSxpKSk7YnJlYWs7Y2FzZSAyOmMucGlja2VkU3ByaXRlLmFjdGlvbk1hbmFnZXIucHJvY2Vzc1RyaWdnZXIoZS5BY3Rpb25NYW5hZ2VyLk9uUmlnaHRQaWNrVHJpZ2dlcixlLkFjdGlvbkV2ZW50LkNyZWF0ZU5ld0Zyb21TcHJpdGUoYy5waWNrZWRTcHJpdGUsYSxpKSl9Yy5waWNrZWRTcHJpdGUuYWN0aW9uTWFuYWdlci5wcm9jZXNzVHJpZ2dlcihlLkFjdGlvbk1hbmFnZXIuT25QaWNrRG93blRyaWdnZXIsZS5BY3Rpb25FdmVudC5DcmVhdGVOZXdGcm9tU3ByaXRlKGMucGlja2VkU3ByaXRlLGEsaSkpfX19LHRoaXMuX29uUG9pbnRlclVwPWZ1bmN0aW9uKGkpe2lmKGEuX3VwZGF0ZVBvaW50ZXJQb3NpdGlvbihpKSxhLm9uUHJlUG9pbnRlck9ic2VydmFibGUuaGFzT2JzZXJ2ZXJzKCkpe3ZhciBvPXQuUE9JTlRFUlVQLHM9bmV3IHIobyxpLGEuX3VuVHJhbnNsYXRlZFBvaW50ZXJYLGEuX3VuVHJhbnNsYXRlZFBvaW50ZXJZKTtpZihhLm9uUHJlUG9pbnRlck9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHMsbykscy5za2lwT25Qb2ludGVyT2JzZXJ2YWJsZSlyZXR1cm59aWYoYS5jYW1lcmFUb1VzZUZvclBvaW50ZXJzfHxhLmFjdGl2ZUNhbWVyYSl7YS5wb2ludGVyVXBQcmVkaWNhdGV8fChhLnBvaW50ZXJVcFByZWRpY2F0ZT1mdW5jdGlvbih0KXtyZXR1cm4gdC5pc1BpY2thYmxlJiZ0LmlzVmlzaWJsZSYmdC5pc1JlYWR5KCkmJighdC5hY3Rpb25NYW5hZ2VyfHx0LmFjdGlvbk1hbmFnZXIuaGFzUGlja1RyaWdnZXJzfHx0LmFjdGlvbk1hbmFnZXIuaGFzU3BlY2lmaWNUcmlnZ2VyKGUuQWN0aW9uTWFuYWdlci5PbkxvbmdQcmVzc1RyaWdnZXIpKX0pO3ZhciBjPWEucGljayhhLl91blRyYW5zbGF0ZWRQb2ludGVyWCxhLl91blRyYW5zbGF0ZWRQb2ludGVyWSxhLnBvaW50ZXJVcFByZWRpY2F0ZSwhMSxhLmNhbWVyYVRvVXNlRm9yUG9pbnRlcnMpO2lmKGMuaGl0JiZjLnBpY2tlZE1lc2gpe2lmKG51bGwhPWEuX3BpY2tlZERvd25NZXNoJiZjLnBpY2tlZE1lc2g9PWEuX3BpY2tlZERvd25NZXNoJiYoYS5vblBvaW50ZXJQaWNrJiZhLm9uUG9pbnRlclBpY2soaSxjKSxhLm9uUG9pbnRlck9ic2VydmFibGUuaGFzT2JzZXJ2ZXJzKCkpKXt2YXIgbz10LlBPSU5URVJQSUNLLHM9bmV3IG4obyxpLGMpO2Eub25Qb2ludGVyT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMocyxvKX1jLnBpY2tlZE1lc2guYWN0aW9uTWFuYWdlciYmKGMucGlja2VkTWVzaC5hY3Rpb25NYW5hZ2VyLnByb2Nlc3NUcmlnZ2VyKGUuQWN0aW9uTWFuYWdlci5PblBpY2tVcFRyaWdnZXIsZS5BY3Rpb25FdmVudC5DcmVhdGVOZXcoYy5waWNrZWRNZXNoLGkpKSxNYXRoLmFicyhhLl9zdGFydGluZ1BvaW50ZXJQb3NpdGlvbi54LWEuX3BvaW50ZXJYKTxlLkFjdGlvbk1hbmFnZXIuRHJhZ01vdmVtZW50VGhyZXNob2xkJiZNYXRoLmFicyhhLl9zdGFydGluZ1BvaW50ZXJQb3NpdGlvbi55LWEuX3BvaW50ZXJZKTxlLkFjdGlvbk1hbmFnZXIuRHJhZ01vdmVtZW50VGhyZXNob2xkJiZjLnBpY2tlZE1lc2guYWN0aW9uTWFuYWdlci5wcm9jZXNzVHJpZ2dlcihlLkFjdGlvbk1hbmFnZXIuT25QaWNrVHJpZ2dlcixlLkFjdGlvbkV2ZW50LkNyZWF0ZU5ldyhjLnBpY2tlZE1lc2gsaSkpKX1pZihhLl9waWNrZWREb3duTWVzaCYmYS5fcGlja2VkRG93bk1lc2ghPT1jLnBpY2tlZE1lc2gmJmEuX3BpY2tlZERvd25NZXNoLmFjdGlvbk1hbmFnZXIucHJvY2Vzc1RyaWdnZXIoZS5BY3Rpb25NYW5hZ2VyLk9uUGlja091dFRyaWdnZXIsZS5BY3Rpb25FdmVudC5DcmVhdGVOZXcoYS5fcGlja2VkRG93bk1lc2gsaSkpLGEub25Qb2ludGVyVXAmJmEub25Qb2ludGVyVXAoaSxjKSxhLm9uUG9pbnRlck9ic2VydmFibGUuaGFzT2JzZXJ2ZXJzKCkpe3ZhciBvPXQuUE9JTlRFUlVQLHM9bmV3IG4obyxpLGMpO2Eub25Qb2ludGVyT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMocyxvKX1hLl9zdGFydGluZ1BvaW50ZXJUaW1lPTAsYS5zcHJpdGVNYW5hZ2Vycy5sZW5ndGg+MCYmKGM9YS5waWNrU3ByaXRlKGEuX3VuVHJhbnNsYXRlZFBvaW50ZXJYLGEuX3VuVHJhbnNsYXRlZFBvaW50ZXJZLGgsITEsYS5jYW1lcmFUb1VzZUZvclBvaW50ZXJzKSxjLmhpdCYmYy5waWNrZWRTcHJpdGUmJmMucGlja2VkU3ByaXRlLmFjdGlvbk1hbmFnZXImJihjLnBpY2tlZFNwcml0ZS5hY3Rpb25NYW5hZ2VyLnByb2Nlc3NUcmlnZ2VyKGUuQWN0aW9uTWFuYWdlci5PblBpY2tVcFRyaWdnZXIsZS5BY3Rpb25FdmVudC5DcmVhdGVOZXdGcm9tU3ByaXRlKGMucGlja2VkU3ByaXRlLGEsaSkpLE1hdGguYWJzKGEuX3N0YXJ0aW5nUG9pbnRlclBvc2l0aW9uLngtYS5fcG9pbnRlclgpPGUuQWN0aW9uTWFuYWdlci5EcmFnTW92ZW1lbnRUaHJlc2hvbGQmJk1hdGguYWJzKGEuX3N0YXJ0aW5nUG9pbnRlclBvc2l0aW9uLnktYS5fcG9pbnRlclkpPGUuQWN0aW9uTWFuYWdlci5EcmFnTW92ZW1lbnRUaHJlc2hvbGQmJmMucGlja2VkU3ByaXRlLmFjdGlvbk1hbmFnZXIucHJvY2Vzc1RyaWdnZXIoZS5BY3Rpb25NYW5hZ2VyLk9uUGlja1RyaWdnZXIsZS5BY3Rpb25FdmVudC5DcmVhdGVOZXdGcm9tU3ByaXRlKGMucGlja2VkU3ByaXRlLGEsaSkpKSxhLl9waWNrZWREb3duU3ByaXRlJiZhLl9waWNrZWREb3duU3ByaXRlIT09Yy5waWNrZWRTcHJpdGUmJmEuX3BpY2tlZERvd25TcHJpdGUuYWN0aW9uTWFuYWdlci5wcm9jZXNzVHJpZ2dlcihlLkFjdGlvbk1hbmFnZXIuT25QaWNrT3V0VHJpZ2dlcixlLkFjdGlvbkV2ZW50LkNyZWF0ZU5ld0Zyb21TcHJpdGUoYS5fcGlja2VkRG93blNwcml0ZSxhLGkpKSl9fSx0aGlzLl9vbktleURvd249ZnVuY3Rpb24odCl7YS5hY3Rpb25NYW5hZ2VyJiZhLmFjdGlvbk1hbmFnZXIucHJvY2Vzc1RyaWdnZXIoZS5BY3Rpb25NYW5hZ2VyLk9uS2V5RG93blRyaWdnZXIsZS5BY3Rpb25FdmVudC5DcmVhdGVOZXdGcm9tU2NlbmUoYSx0KSl9LHRoaXMuX29uS2V5VXA9ZnVuY3Rpb24odCl7YS5hY3Rpb25NYW5hZ2VyJiZhLmFjdGlvbk1hbmFnZXIucHJvY2Vzc1RyaWdnZXIoZS5BY3Rpb25NYW5hZ2VyLk9uS2V5VXBUcmlnZ2VyLGUuQWN0aW9uRXZlbnQuQ3JlYXRlTmV3RnJvbVNjZW5lKGEsdCkpfTt2YXIgYz1lLlRvb2xzLkdldFBvaW50ZXJQcmVmaXgoKTtzJiYodGhpcy5fZW5naW5lLmdldFJlbmRlcmluZ0NhbnZhcygpLmFkZEV2ZW50TGlzdGVuZXIoYytcIm1vdmVcIix0aGlzLl9vblBvaW50ZXJNb3ZlLCExKSx0aGlzLl9lbmdpbmUuZ2V0UmVuZGVyaW5nQ2FudmFzKCkuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNld2hlZWxcIix0aGlzLl9vblBvaW50ZXJNb3ZlLCExKSx0aGlzLl9lbmdpbmUuZ2V0UmVuZGVyaW5nQ2FudmFzKCkuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTU1vdXNlU2Nyb2xsXCIsdGhpcy5fb25Qb2ludGVyTW92ZSwhMSkpLG8mJnRoaXMuX2VuZ2luZS5nZXRSZW5kZXJpbmdDYW52YXMoKS5hZGRFdmVudExpc3RlbmVyKGMrXCJkb3duXCIsdGhpcy5fb25Qb2ludGVyRG93biwhMSksaSYmdGhpcy5fZW5naW5lLmdldFJlbmRlcmluZ0NhbnZhcygpLmFkZEV2ZW50TGlzdGVuZXIoYytcInVwXCIsdGhpcy5fb25Qb2ludGVyVXAsITEpLGUuVG9vbHMuUmVnaXN0ZXJUb3BSb290RXZlbnRzKFt7bmFtZTpcImtleWRvd25cIixoYW5kbGVyOnRoaXMuX29uS2V5RG93bn0se25hbWU6XCJrZXl1cFwiLGhhbmRsZXI6dGhpcy5fb25LZXlVcH1dKX0saS5wcm90b3R5cGUuZGV0YWNoQ29udHJvbD1mdW5jdGlvbigpe3ZhciB0PWUuVG9vbHMuR2V0UG9pbnRlclByZWZpeCgpO3RoaXMuX2VuZ2luZS5nZXRSZW5kZXJpbmdDYW52YXMoKS5yZW1vdmVFdmVudExpc3RlbmVyKHQrXCJtb3ZlXCIsdGhpcy5fb25Qb2ludGVyTW92ZSksdGhpcy5fZW5naW5lLmdldFJlbmRlcmluZ0NhbnZhcygpLnJlbW92ZUV2ZW50TGlzdGVuZXIodCtcImRvd25cIix0aGlzLl9vblBvaW50ZXJEb3duKSx0aGlzLl9lbmdpbmUuZ2V0UmVuZGVyaW5nQ2FudmFzKCkucmVtb3ZlRXZlbnRMaXN0ZW5lcih0K1widXBcIix0aGlzLl9vblBvaW50ZXJVcCksdGhpcy5fZW5naW5lLmdldFJlbmRlcmluZ0NhbnZhcygpLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZXdoZWVsXCIsdGhpcy5fb25Qb2ludGVyTW92ZSksdGhpcy5fZW5naW5lLmdldFJlbmRlcmluZ0NhbnZhcygpLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJET01Nb3VzZVNjcm9sbFwiLHRoaXMuX29uUG9pbnRlck1vdmUpLGUuVG9vbHMuVW5yZWdpc3RlclRvcFJvb3RFdmVudHMoW3tuYW1lOlwia2V5ZG93blwiLGhhbmRsZXI6dGhpcy5fb25LZXlEb3dufSx7bmFtZTpcImtleXVwXCIsaGFuZGxlcjp0aGlzLl9vbktleVVwfV0pfSxpLnByb3RvdHlwZS5pc1JlYWR5PWZ1bmN0aW9uKCl7aWYodGhpcy5fcGVuZGluZ0RhdGEubGVuZ3RoPjApcmV0dXJuITE7dmFyIHQ7Zm9yKHQ9MDt0PHRoaXMuX2dlb21ldHJpZXMubGVuZ3RoO3QrKyl7dmFyIGk9dGhpcy5fZ2VvbWV0cmllc1t0XTtpZihpLmRlbGF5TG9hZFN0YXRlPT09ZS5FbmdpbmUuREVMQVlMT0FEU1RBVEVfTE9BRElORylyZXR1cm4hMX1mb3IodD0wO3Q8dGhpcy5tZXNoZXMubGVuZ3RoO3QrKyl7dmFyIHI9dGhpcy5tZXNoZXNbdF07aWYoIXIuaXNSZWFkeSgpKXJldHVybiExO3ZhciBuPXIubWF0ZXJpYWw7aWYobiYmIW4uaXNSZWFkeShyKSlyZXR1cm4hMX1yZXR1cm4hMH0saS5wcm90b3R5cGUucmVzZXRDYWNoZWRNYXRlcmlhbD1mdW5jdGlvbigpe3RoaXMuX2NhY2hlZE1hdGVyaWFsPW51bGx9LGkucHJvdG90eXBlLnJlZ2lzdGVyQmVmb3JlUmVuZGVyPWZ1bmN0aW9uKGUpe3RoaXMub25CZWZvcmVSZW5kZXJPYnNlcnZhYmxlLmFkZChlKX0saS5wcm90b3R5cGUudW5yZWdpc3RlckJlZm9yZVJlbmRlcj1mdW5jdGlvbihlKXt0aGlzLm9uQmVmb3JlUmVuZGVyT2JzZXJ2YWJsZS5yZW1vdmVDYWxsYmFjayhlKX0saS5wcm90b3R5cGUucmVnaXN0ZXJBZnRlclJlbmRlcj1mdW5jdGlvbihlKXt0aGlzLm9uQWZ0ZXJSZW5kZXJPYnNlcnZhYmxlLmFkZChlKX0saS5wcm90b3R5cGUudW5yZWdpc3RlckFmdGVyUmVuZGVyPWZ1bmN0aW9uKGUpe3RoaXMub25BZnRlclJlbmRlck9ic2VydmFibGUucmVtb3ZlQ2FsbGJhY2soZSl9LGkucHJvdG90eXBlLl9hZGRQZW5kaW5nRGF0YT1mdW5jdGlvbihlKXt0aGlzLl9wZW5kaW5nRGF0YS5wdXNoKGUpfSxpLnByb3RvdHlwZS5fcmVtb3ZlUGVuZGluZ0RhdGE9ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5fcGVuZGluZ0RhdGEuaW5kZXhPZihlKTstMSE9PXQmJnRoaXMuX3BlbmRpbmdEYXRhLnNwbGljZSh0LDEpfSxpLnByb3RvdHlwZS5nZXRXYWl0aW5nSXRlbXNDb3VudD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9wZW5kaW5nRGF0YS5sZW5ndGh9LGkucHJvdG90eXBlLmV4ZWN1dGVXaGVuUmVhZHk9ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpczt0aGlzLm9uUmVhZHlPYnNlcnZhYmxlLmFkZChlKSwtMT09PXRoaXMuX2V4ZWN1dGVXaGVuUmVhZHlUaW1lb3V0SWQmJih0aGlzLl9leGVjdXRlV2hlblJlYWR5VGltZW91dElkPXNldFRpbWVvdXQoZnVuY3Rpb24oKXt0Ll9jaGVja0lzUmVhZHkoKX0sMTUwKSl9LGkucHJvdG90eXBlLl9jaGVja0lzUmVhZHk9ZnVuY3Rpb24oKXt2YXIgZT10aGlzO3JldHVybiB0aGlzLmlzUmVhZHkoKT8odGhpcy5vblJlYWR5T2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcyksdGhpcy5vblJlYWR5T2JzZXJ2YWJsZS5jbGVhcigpLHZvaWQodGhpcy5fZXhlY3V0ZVdoZW5SZWFkeVRpbWVvdXRJZD0tMSkpOnZvaWQodGhpcy5fZXhlY3V0ZVdoZW5SZWFkeVRpbWVvdXRJZD1zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7ZS5fY2hlY2tJc1JlYWR5KCl9LDE1MCkpfSxpLnByb3RvdHlwZS5iZWdpbkFuaW1hdGlvbj1mdW5jdGlvbih0LGkscixuLG8scyxhKXtpZih2b2lkIDA9PT1vJiYobz0xKSx0aGlzLnN0b3BBbmltYXRpb24odCksYXx8KGE9bmV3IGUuQW5pbWF0YWJsZSh0aGlzLHQsaSxyLG4sbyxzKSksdC5hbmltYXRpb25zJiZhLmFwcGVuZEFuaW1hdGlvbnModCx0LmFuaW1hdGlvbnMpLHQuZ2V0QW5pbWF0YWJsZXMpZm9yKHZhciBoPXQuZ2V0QW5pbWF0YWJsZXMoKSxjPTA7YzxoLmxlbmd0aDtjKyspdGhpcy5iZWdpbkFuaW1hdGlvbihoW2NdLGkscixuLG8scyxhKTtyZXR1cm4gYS5yZXNldCgpLGF9LGkucHJvdG90eXBlLmJlZ2luRGlyZWN0QW5pbWF0aW9uPWZ1bmN0aW9uKHQsaSxyLG4sbyxzLGEpe3ZvaWQgMD09PXMmJihzPTEpO3ZhciBoPW5ldyBlLkFuaW1hdGFibGUodGhpcyx0LHIsbixvLHMsYSxpKTtyZXR1cm4gaH0saS5wcm90b3R5cGUuZ2V0QW5pbWF0YWJsZUJ5VGFyZ2V0PWZ1bmN0aW9uKGUpe2Zvcih2YXIgdD0wO3Q8dGhpcy5fYWN0aXZlQW5pbWF0YWJsZXMubGVuZ3RoO3QrKylpZih0aGlzLl9hY3RpdmVBbmltYXRhYmxlc1t0XS50YXJnZXQ9PT1lKXJldHVybiB0aGlzLl9hY3RpdmVBbmltYXRhYmxlc1t0XTtyZXR1cm4gbnVsbH0sT2JqZWN0LmRlZmluZVByb3BlcnR5KGkucHJvdG90eXBlLFwiQW5pbWF0YWJsZXNcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2FjdGl2ZUFuaW1hdGFibGVzfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLGkucHJvdG90eXBlLnN0b3BBbmltYXRpb249ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5nZXRBbmltYXRhYmxlQnlUYXJnZXQoZSk7dCYmdC5zdG9wKCl9LGkucHJvdG90eXBlLl9hbmltYXRlPWZ1bmN0aW9uKCl7aWYodGhpcy5hbmltYXRpb25zRW5hYmxlZCYmMCE9PXRoaXMuX2FjdGl2ZUFuaW1hdGFibGVzLmxlbmd0aCl7aWYoIXRoaXMuX2FuaW1hdGlvblN0YXJ0RGF0ZSl7aWYodGhpcy5fcGVuZGluZ0RhdGEubGVuZ3RoPjApcmV0dXJuO3RoaXMuX2FuaW1hdGlvblN0YXJ0RGF0ZT1lLlRvb2xzLk5vd31mb3IodmFyIHQ9ZS5Ub29scy5Ob3csaT10LXRoaXMuX2FuaW1hdGlvblN0YXJ0RGF0ZSxyPTA7cjx0aGlzLl9hY3RpdmVBbmltYXRhYmxlcy5sZW5ndGg7cisrKXRoaXMuX2FjdGl2ZUFuaW1hdGFibGVzW3JdLl9hbmltYXRlKGkpfX0saS5wcm90b3R5cGUuZ2V0Vmlld01hdHJpeD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl92aWV3TWF0cml4fSxpLnByb3RvdHlwZS5nZXRQcm9qZWN0aW9uTWF0cml4PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3Byb2plY3Rpb25NYXRyaXh9LGkucHJvdG90eXBlLmdldFRyYW5zZm9ybU1hdHJpeD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl90cmFuc2Zvcm1NYXRyaXh9LGkucHJvdG90eXBlLnNldFRyYW5zZm9ybU1hdHJpeD1mdW5jdGlvbihlLHQpe3RoaXMuX3ZpZXdNYXRyaXg9ZSx0aGlzLl9wcm9qZWN0aW9uTWF0cml4PXQsdGhpcy5fdmlld01hdHJpeC5tdWx0aXBseVRvUmVmKHRoaXMuX3Byb2plY3Rpb25NYXRyaXgsdGhpcy5fdHJhbnNmb3JtTWF0cml4KX0saS5wcm90b3R5cGUuYWRkTWVzaD1mdW5jdGlvbihlKXtlLnVuaXF1ZUlkPXRoaXMuX3VuaXF1ZUlkQ291bnRlcisrO3RoaXMubWVzaGVzLnB1c2goZSk7dGhpcy5jb2xsaXNpb25Db29yZGluYXRvci5vbk1lc2hBZGRlZChlKSx0aGlzLm9uTmV3TWVzaEFkZGVkT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMoZSl9LGkucHJvdG90eXBlLnJlbW92ZU1lc2g9ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5tZXNoZXMuaW5kZXhPZihlKTtyZXR1cm4tMSE9PXQmJnRoaXMubWVzaGVzLnNwbGljZSh0LDEpLHRoaXMuY29sbGlzaW9uQ29vcmRpbmF0b3Iub25NZXNoUmVtb3ZlZChlKSx0aGlzLm9uTWVzaFJlbW92ZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhlKSx0fSxpLnByb3RvdHlwZS5yZW1vdmVTa2VsZXRvbj1mdW5jdGlvbihlKXt2YXIgdD10aGlzLnNrZWxldG9ucy5pbmRleE9mKGUpO3JldHVybi0xIT09dCYmdGhpcy5za2VsZXRvbnMuc3BsaWNlKHQsMSksdH0saS5wcm90b3R5cGUucmVtb3ZlTGlnaHQ9ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5saWdodHMuaW5kZXhPZihlKTtyZXR1cm4tMSE9PXQmJnRoaXMubGlnaHRzLnNwbGljZSh0LDEpLHRoaXMub25MaWdodFJlbW92ZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhlKSx0fSxpLnByb3RvdHlwZS5yZW1vdmVDYW1lcmE9ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5jYW1lcmFzLmluZGV4T2YoZSk7LTEhPT10JiZ0aGlzLmNhbWVyYXMuc3BsaWNlKHQsMSk7dmFyIGk9dGhpcy5hY3RpdmVDYW1lcmFzLmluZGV4T2YoZSk7cmV0dXJuLTEhPT1pJiZ0aGlzLmFjdGl2ZUNhbWVyYXMuc3BsaWNlKGksMSksdGhpcy5hY3RpdmVDYW1lcmE9PT1lJiYodGhpcy5jYW1lcmFzLmxlbmd0aD4wP3RoaXMuYWN0aXZlQ2FtZXJhPXRoaXMuY2FtZXJhc1swXTp0aGlzLmFjdGl2ZUNhbWVyYT1udWxsKSx0aGlzLm9uQ2FtZXJhUmVtb3ZlZE9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKGUpLHR9LGkucHJvdG90eXBlLmFkZExpZ2h0PWZ1bmN0aW9uKGUpe2UudW5pcXVlSWQ9dGhpcy5fdW5pcXVlSWRDb3VudGVyKys7dGhpcy5saWdodHMucHVzaChlKTt0aGlzLm9uTmV3TGlnaHRBZGRlZE9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKGUpfSxpLnByb3RvdHlwZS5hZGRDYW1lcmE9ZnVuY3Rpb24oZSl7ZS51bmlxdWVJZD10aGlzLl91bmlxdWVJZENvdW50ZXIrKzt0aGlzLmNhbWVyYXMucHVzaChlKTt0aGlzLm9uTmV3Q2FtZXJhQWRkZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhlKX0saS5wcm90b3R5cGUuc3dpdGhBY3RpdmVDYW1lcmE9ZnVuY3Rpb24oZSx0KXt2b2lkIDA9PT10JiYodD0hMCk7dmFyIGk9dGhpcy5fZW5naW5lLmdldFJlbmRlcmluZ0NhbnZhcygpO3RoaXMuYWN0aXZlQ2FtZXJhLmRldGFjaENvbnRyb2woaSksdGhpcy5hY3RpdmVDYW1lcmE9ZSx0JiZlLmF0dGFjaENvbnRyb2woaSl9LGkucHJvdG90eXBlLnNldEFjdGl2ZUNhbWVyYUJ5SUQ9ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5nZXRDYW1lcmFCeUlEKGUpO3JldHVybiB0Pyh0aGlzLmFjdGl2ZUNhbWVyYT10LHQpOm51bGx9LGkucHJvdG90eXBlLnNldEFjdGl2ZUNhbWVyYUJ5TmFtZT1mdW5jdGlvbihlKXt2YXIgdD10aGlzLmdldENhbWVyYUJ5TmFtZShlKTtyZXR1cm4gdD8odGhpcy5hY3RpdmVDYW1lcmE9dCx0KTpudWxsfSxpLnByb3RvdHlwZS5nZXRNYXRlcmlhbEJ5SUQ9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PTA7dDx0aGlzLm1hdGVyaWFscy5sZW5ndGg7dCsrKWlmKHRoaXMubWF0ZXJpYWxzW3RdLmlkPT09ZSlyZXR1cm4gdGhpcy5tYXRlcmlhbHNbdF07cmV0dXJuIG51bGx9LGkucHJvdG90eXBlLmdldE1hdGVyaWFsQnlOYW1lPWZ1bmN0aW9uKGUpe2Zvcih2YXIgdD0wO3Q8dGhpcy5tYXRlcmlhbHMubGVuZ3RoO3QrKylpZih0aGlzLm1hdGVyaWFsc1t0XS5uYW1lPT09ZSlyZXR1cm4gdGhpcy5tYXRlcmlhbHNbdF07cmV0dXJuIG51bGx9LGkucHJvdG90eXBlLmdldExlbnNGbGFyZVN5c3RlbUJ5TmFtZT1mdW5jdGlvbihlKXtmb3IodmFyIHQ9MDt0PHRoaXMubGVuc0ZsYXJlU3lzdGVtcy5sZW5ndGg7dCsrKWlmKHRoaXMubGVuc0ZsYXJlU3lzdGVtc1t0XS5uYW1lPT09ZSlyZXR1cm4gdGhpcy5sZW5zRmxhcmVTeXN0ZW1zW3RdO3JldHVybiBudWxsfSxpLnByb3RvdHlwZS5nZXRMZW5zRmxhcmVTeXN0ZW1CeUlEPWZ1bmN0aW9uKGUpe2Zvcih2YXIgdD0wO3Q8dGhpcy5sZW5zRmxhcmVTeXN0ZW1zLmxlbmd0aDt0KyspaWYodGhpcy5sZW5zRmxhcmVTeXN0ZW1zW3RdLmlkPT09ZSlyZXR1cm4gdGhpcy5sZW5zRmxhcmVTeXN0ZW1zW3RdO3JldHVybiBudWxsfSxpLnByb3RvdHlwZS5nZXRDYW1lcmFCeUlEPWZ1bmN0aW9uKGUpe2Zvcih2YXIgdD0wO3Q8dGhpcy5jYW1lcmFzLmxlbmd0aDt0KyspaWYodGhpcy5jYW1lcmFzW3RdLmlkPT09ZSlyZXR1cm4gdGhpcy5jYW1lcmFzW3RdO3JldHVybiBudWxsfSxpLnByb3RvdHlwZS5nZXRDYW1lcmFCeVVuaXF1ZUlEPWZ1bmN0aW9uKGUpe2Zvcih2YXIgdD0wO3Q8dGhpcy5jYW1lcmFzLmxlbmd0aDt0KyspaWYodGhpcy5jYW1lcmFzW3RdLnVuaXF1ZUlkPT09ZSlyZXR1cm4gdGhpcy5jYW1lcmFzW3RdO3JldHVybiBudWxsfSxpLnByb3RvdHlwZS5nZXRDYW1lcmFCeU5hbWU9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PTA7dDx0aGlzLmNhbWVyYXMubGVuZ3RoO3QrKylpZih0aGlzLmNhbWVyYXNbdF0ubmFtZT09PWUpcmV0dXJuIHRoaXMuY2FtZXJhc1t0XTtyZXR1cm4gbnVsbH0saS5wcm90b3R5cGUuZ2V0Qm9uZUJ5SUQ9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PTA7dDx0aGlzLnNrZWxldG9ucy5sZW5ndGg7dCsrKWZvcih2YXIgaT10aGlzLnNrZWxldG9uc1t0XSxyPTA7cjxpLmJvbmVzLmxlbmd0aDtyKyspaWYoaS5ib25lc1tyXS5pZD09PWUpcmV0dXJuIGkuYm9uZXNbcl07cmV0dXJuIG51bGx9LGkucHJvdG90eXBlLmdldEJvbmVCeU5hbWU9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PTA7dDx0aGlzLnNrZWxldG9ucy5sZW5ndGg7dCsrKWZvcih2YXIgaT10aGlzLnNrZWxldG9uc1t0XSxyPTA7cjxpLmJvbmVzLmxlbmd0aDtyKyspaWYoaS5ib25lc1tyXS5uYW1lPT09ZSlyZXR1cm4gaS5ib25lc1tyXTtyZXR1cm4gbnVsbH0saS5wcm90b3R5cGUuZ2V0TGlnaHRCeU5hbWU9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PTA7dDx0aGlzLmxpZ2h0cy5sZW5ndGg7dCsrKWlmKHRoaXMubGlnaHRzW3RdLm5hbWU9PT1lKXJldHVybiB0aGlzLmxpZ2h0c1t0XTtyZXR1cm4gbnVsbH0saS5wcm90b3R5cGUuZ2V0TGlnaHRCeUlEPWZ1bmN0aW9uKGUpe2Zvcih2YXIgdD0wO3Q8dGhpcy5saWdodHMubGVuZ3RoO3QrKylpZih0aGlzLmxpZ2h0c1t0XS5pZD09PWUpcmV0dXJuIHRoaXMubGlnaHRzW3RdO3JldHVybiBudWxsfSxpLnByb3RvdHlwZS5nZXRMaWdodEJ5VW5pcXVlSUQ9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PTA7dDx0aGlzLmxpZ2h0cy5sZW5ndGg7dCsrKWlmKHRoaXMubGlnaHRzW3RdLnVuaXF1ZUlkPT09ZSlyZXR1cm4gdGhpcy5saWdodHNbdF07cmV0dXJuIG51bGx9LGkucHJvdG90eXBlLmdldFBhcnRpY2xlU3lzdGVtQnlJRD1mdW5jdGlvbihlKXtmb3IodmFyIHQ9MDt0PHRoaXMucGFydGljbGVTeXN0ZW1zLmxlbmd0aDt0KyspaWYodGhpcy5wYXJ0aWNsZVN5c3RlbXNbdF0uaWQ9PT1lKXJldHVybiB0aGlzLnBhcnRpY2xlU3lzdGVtc1t0XTtyZXR1cm4gbnVsbH0saS5wcm90b3R5cGUuZ2V0R2VvbWV0cnlCeUlEPWZ1bmN0aW9uKGUpe2Zvcih2YXIgdD0wO3Q8dGhpcy5fZ2VvbWV0cmllcy5sZW5ndGg7dCsrKWlmKHRoaXMuX2dlb21ldHJpZXNbdF0uaWQ9PT1lKXJldHVybiB0aGlzLl9nZW9tZXRyaWVzW3RdO3JldHVybiBudWxsfSxpLnByb3RvdHlwZS5wdXNoR2VvbWV0cnk9ZnVuY3Rpb24oZSx0KXtyZXR1cm4hdCYmdGhpcy5nZXRHZW9tZXRyeUJ5SUQoZS5pZCk/ITE6KHRoaXMuX2dlb21ldHJpZXMucHVzaChlKSx0aGlzLmNvbGxpc2lvbkNvb3JkaW5hdG9yLm9uR2VvbWV0cnlBZGRlZChlKSx0aGlzLm9uTmV3R2VvbWV0cnlBZGRlZE9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKGUpLCEwKX0saS5wcm90b3R5cGUucmVtb3ZlR2VvbWV0cnk9ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5fZ2VvbWV0cmllcy5pbmRleE9mKGUpO3JldHVybiB0Pi0xPyh0aGlzLl9nZW9tZXRyaWVzLnNwbGljZSh0LDEpLHRoaXMuY29sbGlzaW9uQ29vcmRpbmF0b3Iub25HZW9tZXRyeURlbGV0ZWQoZSksdGhpcy5vbkdlb21ldHJ5UmVtb3ZlZE9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKGUpLCEwKTohMX0saS5wcm90b3R5cGUuZ2V0R2VvbWV0cmllcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9nZW9tZXRyaWVzfSxpLnByb3RvdHlwZS5nZXRNZXNoQnlJRD1mdW5jdGlvbihlKXtmb3IodmFyIHQ9MDt0PHRoaXMubWVzaGVzLmxlbmd0aDt0KyspaWYodGhpcy5tZXNoZXNbdF0uaWQ9PT1lKXJldHVybiB0aGlzLm1lc2hlc1t0XTtyZXR1cm4gbnVsbH0saS5wcm90b3R5cGUuZ2V0TWVzaGVzQnlJRD1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5tZXNoZXMuZmlsdGVyKGZ1bmN0aW9uKHQpe3JldHVybiB0LmlkPT09ZX0pfSxpLnByb3RvdHlwZS5nZXRNZXNoQnlVbmlxdWVJRD1mdW5jdGlvbihlKXtmb3IodmFyIHQ9MDt0PHRoaXMubWVzaGVzLmxlbmd0aDt0KyspaWYodGhpcy5tZXNoZXNbdF0udW5pcXVlSWQ9PT1lKXJldHVybiB0aGlzLm1lc2hlc1t0XTtyZXR1cm4gbnVsbH0saS5wcm90b3R5cGUuZ2V0TGFzdE1lc2hCeUlEPWZ1bmN0aW9uKGUpe2Zvcih2YXIgdD10aGlzLm1lc2hlcy5sZW5ndGgtMTt0Pj0wO3QtLSlpZih0aGlzLm1lc2hlc1t0XS5pZD09PWUpcmV0dXJuIHRoaXMubWVzaGVzW3RdO3JldHVybiBudWxsfSxpLnByb3RvdHlwZS5nZXRMYXN0RW50cnlCeUlEPWZ1bmN0aW9uKGUpe3ZhciB0O2Zvcih0PXRoaXMubWVzaGVzLmxlbmd0aC0xO3Q+PTA7dC0tKWlmKHRoaXMubWVzaGVzW3RdLmlkPT09ZSlyZXR1cm4gdGhpcy5tZXNoZXNbdF07Zm9yKHQ9dGhpcy5jYW1lcmFzLmxlbmd0aC0xO3Q+PTA7dC0tKWlmKHRoaXMuY2FtZXJhc1t0XS5pZD09PWUpcmV0dXJuIHRoaXMuY2FtZXJhc1t0XTtmb3IodD10aGlzLmxpZ2h0cy5sZW5ndGgtMTt0Pj0wO3QtLSlpZih0aGlzLmxpZ2h0c1t0XS5pZD09PWUpcmV0dXJuIHRoaXMubGlnaHRzW3RdO3JldHVybiBudWxsfSxpLnByb3RvdHlwZS5nZXROb2RlQnlJRD1mdW5jdGlvbihlKXt2YXIgdD10aGlzLmdldE1lc2hCeUlEKGUpO2lmKHQpcmV0dXJuIHQ7dmFyIGk9dGhpcy5nZXRMaWdodEJ5SUQoZSk7aWYoaSlyZXR1cm4gaTt2YXIgcj10aGlzLmdldENhbWVyYUJ5SUQoZSk7aWYocilyZXR1cm4gcjt2YXIgbj10aGlzLmdldEJvbmVCeUlEKGUpO3JldHVybiBufSxpLnByb3RvdHlwZS5nZXROb2RlQnlOYW1lPWZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuZ2V0TWVzaEJ5TmFtZShlKTtpZih0KXJldHVybiB0O3ZhciBpPXRoaXMuZ2V0TGlnaHRCeU5hbWUoZSk7aWYoaSlyZXR1cm4gaTt2YXIgcj10aGlzLmdldENhbWVyYUJ5TmFtZShlKTtpZihyKXJldHVybiByO3ZhciBuPXRoaXMuZ2V0Qm9uZUJ5TmFtZShlKTtyZXR1cm4gbn0saS5wcm90b3R5cGUuZ2V0TWVzaEJ5TmFtZT1mdW5jdGlvbihlKXtmb3IodmFyIHQ9MDt0PHRoaXMubWVzaGVzLmxlbmd0aDt0KyspaWYodGhpcy5tZXNoZXNbdF0ubmFtZT09PWUpcmV0dXJuIHRoaXMubWVzaGVzW3RdO3JldHVybiBudWxsfSxpLnByb3RvdHlwZS5nZXRTb3VuZEJ5TmFtZT1mdW5jdGlvbih0KXt2YXIgaTtpZihlLkF1ZGlvRW5naW5lKXtmb3IoaT0wO2k8dGhpcy5tYWluU291bmRUcmFjay5zb3VuZENvbGxlY3Rpb24ubGVuZ3RoO2krKylpZih0aGlzLm1haW5Tb3VuZFRyYWNrLnNvdW5kQ29sbGVjdGlvbltpXS5uYW1lPT09dClyZXR1cm4gdGhpcy5tYWluU291bmRUcmFjay5zb3VuZENvbGxlY3Rpb25baV07Zm9yKHZhciByPTA7cjx0aGlzLnNvdW5kVHJhY2tzLmxlbmd0aDtyKyspZm9yKGk9MDtpPHRoaXMuc291bmRUcmFja3Nbcl0uc291bmRDb2xsZWN0aW9uLmxlbmd0aDtpKyspaWYodGhpcy5zb3VuZFRyYWNrc1tyXS5zb3VuZENvbGxlY3Rpb25baV0ubmFtZT09PXQpcmV0dXJuIHRoaXMuc291bmRUcmFja3Nbcl0uc291bmRDb2xsZWN0aW9uW2ldfXJldHVybiBudWxsfSxpLnByb3RvdHlwZS5nZXRMYXN0U2tlbGV0b25CeUlEPWZ1bmN0aW9uKGUpe2Zvcih2YXIgdD10aGlzLnNrZWxldG9ucy5sZW5ndGgtMTt0Pj0wO3QtLSlpZih0aGlzLnNrZWxldG9uc1t0XS5pZD09PWUpcmV0dXJuIHRoaXMuc2tlbGV0b25zW3RdO3JldHVybiBudWxsfSxpLnByb3RvdHlwZS5nZXRTa2VsZXRvbkJ5SWQ9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PTA7dDx0aGlzLnNrZWxldG9ucy5sZW5ndGg7dCsrKWlmKHRoaXMuc2tlbGV0b25zW3RdLmlkPT09ZSlyZXR1cm4gdGhpcy5za2VsZXRvbnNbdF07cmV0dXJuIG51bGx9LGkucHJvdG90eXBlLmdldFNrZWxldG9uQnlOYW1lPWZ1bmN0aW9uKGUpe2Zvcih2YXIgdD0wO3Q8dGhpcy5za2VsZXRvbnMubGVuZ3RoO3QrKylpZih0aGlzLnNrZWxldG9uc1t0XS5uYW1lPT09ZSlyZXR1cm4gdGhpcy5za2VsZXRvbnNbdF07cmV0dXJuIG51bGx9LGkucHJvdG90eXBlLmlzQWN0aXZlTWVzaD1mdW5jdGlvbihlKXtyZXR1cm4tMSE9PXRoaXMuX2FjdGl2ZU1lc2hlcy5pbmRleE9mKGUpfSxpLnByb3RvdHlwZS5fZXZhbHVhdGVTdWJNZXNoPWZ1bmN0aW9uKGUsdCl7aWYodC5hbHdheXNTZWxlY3RBc0FjdGl2ZU1lc2h8fDE9PT10LnN1Yk1lc2hlcy5sZW5ndGh8fGUuaXNJbkZydXN0dW0odGhpcy5fZnJ1c3R1bVBsYW5lcykpe3ZhciBpPWUuZ2V0TWF0ZXJpYWwoKTt0LnNob3dTdWJNZXNoZXNCb3VuZGluZ0JveCYmdGhpcy5fYm91bmRpbmdCb3hSZW5kZXJlci5yZW5kZXJMaXN0LnB1c2goZS5nZXRCb3VuZGluZ0luZm8oKS5ib3VuZGluZ0JveCksaSYmKGkuZ2V0UmVuZGVyVGFyZ2V0VGV4dHVyZXMmJi0xPT09dGhpcy5fcHJvY2Vzc2VkTWF0ZXJpYWxzLmluZGV4T2YoaSkmJih0aGlzLl9wcm9jZXNzZWRNYXRlcmlhbHMucHVzaChpKSx0aGlzLl9yZW5kZXJUYXJnZXRzLmNvbmNhdFdpdGhOb0R1cGxpY2F0ZShpLmdldFJlbmRlclRhcmdldFRleHR1cmVzKCkpKSx0aGlzLl9hY3RpdmVJbmRpY2VzKz1lLmluZGV4Q291bnQsdGhpcy5fcmVuZGVyaW5nTWFuYWdlci5kaXNwYXRjaChlKSl9fSxpLnByb3RvdHlwZS5faXNJbkludGVybWVkaWF0ZVJlbmRlcmluZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9pbnRlcm1lZGlhdGVSZW5kZXJpbmd9LGkucHJvdG90eXBlLl9ldmFsdWF0ZUFjdGl2ZU1lc2hlcz1mdW5jdGlvbigpe3RoaXMuYWN0aXZlQ2FtZXJhLl9hY3RpdmVNZXNoZXMucmVzZXQoKSx0aGlzLl9hY3RpdmVNZXNoZXMucmVzZXQoKSx0aGlzLl9yZW5kZXJpbmdNYW5hZ2VyLnJlc2V0KCksdGhpcy5fcHJvY2Vzc2VkTWF0ZXJpYWxzLnJlc2V0KCksdGhpcy5fYWN0aXZlUGFydGljbGVTeXN0ZW1zLnJlc2V0KCksdGhpcy5fYWN0aXZlU2tlbGV0b25zLnJlc2V0KCksdGhpcy5fc29mdHdhcmVTa2lubmVkTWVzaGVzLnJlc2V0KCksdGhpcy5fYm91bmRpbmdCb3hSZW5kZXJlci5yZXNldCgpLHRoaXMuX2VkZ2VzUmVuZGVyZXJzLnJlc2V0KCksdGhpcy5fZnJ1c3R1bVBsYW5lcz9lLkZydXN0dW0uR2V0UGxhbmVzVG9SZWYodGhpcy5fdHJhbnNmb3JtTWF0cml4LHRoaXMuX2ZydXN0dW1QbGFuZXMpOnRoaXMuX2ZydXN0dW1QbGFuZXM9ZS5GcnVzdHVtLkdldFBsYW5lcyh0aGlzLl90cmFuc2Zvcm1NYXRyaXgpO3ZhciB0LGk7aWYodGhpcy5fc2VsZWN0aW9uT2N0cmVlKXt2YXIgcj10aGlzLl9zZWxlY3Rpb25PY3RyZWUuc2VsZWN0KHRoaXMuX2ZydXN0dW1QbGFuZXMpO3Q9ci5kYXRhLGk9ci5sZW5ndGh9ZWxzZSBpPXRoaXMubWVzaGVzLmxlbmd0aCx0PXRoaXMubWVzaGVzO2Zvcih2YXIgbj0wO2k+bjtuKyspe3ZhciBvPXRbbl07aWYoIW8uaXNCbG9ja2VkJiYodGhpcy5fdG90YWxWZXJ0aWNlcys9by5nZXRUb3RhbFZlcnRpY2VzKCksby5pc1JlYWR5KCkmJm8uaXNFbmFibGVkKCkpKXtvLmNvbXB1dGVXb3JsZE1hdHJpeCgpLG8uYWN0aW9uTWFuYWdlciYmby5hY3Rpb25NYW5hZ2VyLmhhc1NwZWNpZmljVHJpZ2dlcnMoW2UuQWN0aW9uTWFuYWdlci5PbkludGVyc2VjdGlvbkVudGVyVHJpZ2dlcixlLkFjdGlvbk1hbmFnZXIuT25JbnRlcnNlY3Rpb25FeGl0VHJpZ2dlcl0pJiZ0aGlzLl9tZXNoZXNGb3JJbnRlcnNlY3Rpb25zLnB1c2hOb0R1cGxpY2F0ZShvKTt2YXIgcz1vLmdldExPRCh0aGlzLmFjdGl2ZUNhbWVyYSk7cyYmKG8uX3ByZUFjdGl2YXRlKCksKG8uYWx3YXlzU2VsZWN0QXNBY3RpdmVNZXNofHxvLmlzVmlzaWJsZSYmby52aXNpYmlsaXR5PjAmJjAhPT0oby5sYXllck1hc2smdGhpcy5hY3RpdmVDYW1lcmEubGF5ZXJNYXNrKSYmby5pc0luRnJ1c3R1bSh0aGlzLl9mcnVzdHVtUGxhbmVzKSkmJih0aGlzLl9hY3RpdmVNZXNoZXMucHVzaChvKSx0aGlzLmFjdGl2ZUNhbWVyYS5fYWN0aXZlTWVzaGVzLnB1c2gobyksby5fYWN0aXZhdGUodGhpcy5fcmVuZGVySWQpLHRoaXMuX2FjdGl2ZU1lc2gocykpKX19dmFyIGE9ZS5Ub29scy5Ob3c7aWYodGhpcy5wYXJ0aWNsZXNFbmFibGVkKXtlLlRvb2xzLlN0YXJ0UGVyZm9ybWFuY2VDb3VudGVyKFwiUGFydGljbGVzXCIsdGhpcy5wYXJ0aWNsZVN5c3RlbXMubGVuZ3RoPjApO2Zvcih2YXIgaD0wO2g8dGhpcy5wYXJ0aWNsZVN5c3RlbXMubGVuZ3RoO2grKyl7dmFyIGM9dGhpcy5wYXJ0aWNsZVN5c3RlbXNbaF07Yy5pc1N0YXJ0ZWQoKSYmKCFjLmVtaXR0ZXIucG9zaXRpb258fGMuZW1pdHRlciYmYy5lbWl0dGVyLmlzRW5hYmxlZCgpKSYmKHRoaXMuX2FjdGl2ZVBhcnRpY2xlU3lzdGVtcy5wdXNoKGMpLFxuYy5hbmltYXRlKCkpfWUuVG9vbHMuRW5kUGVyZm9ybWFuY2VDb3VudGVyKFwiUGFydGljbGVzXCIsdGhpcy5wYXJ0aWNsZVN5c3RlbXMubGVuZ3RoPjApfXRoaXMuX3BhcnRpY2xlc0R1cmF0aW9uKz1lLlRvb2xzLk5vdy1hfSxpLnByb3RvdHlwZS5fYWN0aXZlTWVzaD1mdW5jdGlvbihlKXtpZihlLnNrZWxldG9uJiZ0aGlzLnNrZWxldG9uc0VuYWJsZWQmJih0aGlzLl9hY3RpdmVTa2VsZXRvbnMucHVzaE5vRHVwbGljYXRlKGUuc2tlbGV0b24pJiZlLnNrZWxldG9uLnByZXBhcmUoKSxlLmNvbXB1dGVCb25lc1VzaW5nU2hhZGVyc3x8dGhpcy5fc29mdHdhcmVTa2lubmVkTWVzaGVzLnB1c2hOb0R1cGxpY2F0ZShlKSksKGUuc2hvd0JvdW5kaW5nQm94fHx0aGlzLmZvcmNlU2hvd0JvdW5kaW5nQm94ZXMpJiZ0aGlzLl9ib3VuZGluZ0JveFJlbmRlcmVyLnJlbmRlckxpc3QucHVzaChlLmdldEJvdW5kaW5nSW5mbygpLmJvdW5kaW5nQm94KSxlLl9lZGdlc1JlbmRlcmVyJiZ0aGlzLl9lZGdlc1JlbmRlcmVycy5wdXNoKGUuX2VkZ2VzUmVuZGVyZXIpLGUmJmUuc3ViTWVzaGVzKXt2YXIgdCxpO2lmKGUuX3N1Ym1lc2hlc09jdHJlZSYmZS51c2VPY3RyZWVGb3JSZW5kZXJpbmdTZWxlY3Rpb24pe3ZhciByPWUuX3N1Ym1lc2hlc09jdHJlZS5zZWxlY3QodGhpcy5fZnJ1c3R1bVBsYW5lcyk7dD1yLmxlbmd0aCxpPXIuZGF0YX1lbHNlIGk9ZS5zdWJNZXNoZXMsdD1pLmxlbmd0aDtmb3IodmFyIG49MDt0Pm47bisrKXt2YXIgbz1pW25dO3RoaXMuX2V2YWx1YXRlU3ViTWVzaChvLGUpfX19LGkucHJvdG90eXBlLnVwZGF0ZVRyYW5zZm9ybU1hdHJpeD1mdW5jdGlvbihlKXt0aGlzLnNldFRyYW5zZm9ybU1hdHJpeCh0aGlzLmFjdGl2ZUNhbWVyYS5nZXRWaWV3TWF0cml4KCksdGhpcy5hY3RpdmVDYW1lcmEuZ2V0UHJvamVjdGlvbk1hdHJpeChlKSl9LGkucHJvdG90eXBlLl9yZW5kZXJGb3JDYW1lcmE9ZnVuY3Rpb24odCl7dmFyIGk9dGhpcy5fZW5naW5lO2lmKHRoaXMuYWN0aXZlQ2FtZXJhPXQsIXRoaXMuYWN0aXZlQ2FtZXJhKXRocm93IG5ldyBFcnJvcihcIkFjdGl2ZSBjYW1lcmEgbm90IHNldFwiKTtlLlRvb2xzLlN0YXJ0UGVyZm9ybWFuY2VDb3VudGVyKFwiUmVuZGVyaW5nIGNhbWVyYSBcIit0aGlzLmFjdGl2ZUNhbWVyYS5uYW1lKSxpLnNldFZpZXdwb3J0KHRoaXMuYWN0aXZlQ2FtZXJhLnZpZXdwb3J0KSx0aGlzLnJlc2V0Q2FjaGVkTWF0ZXJpYWwoKSx0aGlzLl9yZW5kZXJJZCsrLHRoaXMudXBkYXRlVHJhbnNmb3JtTWF0cml4KCksdGhpcy5vbkJlZm9yZUNhbWVyYVJlbmRlck9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMuYWN0aXZlQ2FtZXJhKTt2YXIgcj1lLlRvb2xzLk5vdztlLlRvb2xzLlN0YXJ0UGVyZm9ybWFuY2VDb3VudGVyKFwiQWN0aXZlIG1lc2hlcyBldmFsdWF0aW9uXCIpLHRoaXMuX2V2YWx1YXRlQWN0aXZlTWVzaGVzKCksdGhpcy5fZXZhbHVhdGVBY3RpdmVNZXNoZXNEdXJhdGlvbis9ZS5Ub29scy5Ob3ctcixlLlRvb2xzLkVuZFBlcmZvcm1hbmNlQ291bnRlcihcIkFjdGl2ZSBtZXNoZXMgZXZhbHVhdGlvblwiKTtmb3IodmFyIG49MDtuPHRoaXMuX3NvZnR3YXJlU2tpbm5lZE1lc2hlcy5sZW5ndGg7bisrKXt2YXIgbz10aGlzLl9zb2Z0d2FyZVNraW5uZWRNZXNoZXMuZGF0YVtuXTtvLmFwcGx5U2tlbGV0b24oby5za2VsZXRvbil9dmFyIHM9ZS5Ub29scy5Ob3c7aWYodGhpcy5yZW5kZXJUYXJnZXRzRW5hYmxlZCYmdGhpcy5fcmVuZGVyVGFyZ2V0cy5sZW5ndGg+MCl7dGhpcy5faW50ZXJtZWRpYXRlUmVuZGVyaW5nPSEwLGUuVG9vbHMuU3RhcnRQZXJmb3JtYW5jZUNvdW50ZXIoXCJSZW5kZXIgdGFyZ2V0c1wiLHRoaXMuX3JlbmRlclRhcmdldHMubGVuZ3RoPjApO2Zvcih2YXIgYT0wO2E8dGhpcy5fcmVuZGVyVGFyZ2V0cy5sZW5ndGg7YSsrKXt2YXIgaD10aGlzLl9yZW5kZXJUYXJnZXRzLmRhdGFbYV07aWYoaC5fc2hvdWxkUmVuZGVyKCkpe3RoaXMuX3JlbmRlcklkKys7dmFyIGM9aC5hY3RpdmVDYW1lcmEmJmguYWN0aXZlQ2FtZXJhIT09dGhpcy5hY3RpdmVDYW1lcmE7aC5yZW5kZXIoYyx0aGlzLmR1bXBOZXh0UmVuZGVyVGFyZ2V0cyl9fWUuVG9vbHMuRW5kUGVyZm9ybWFuY2VDb3VudGVyKFwiUmVuZGVyIHRhcmdldHNcIix0aGlzLl9yZW5kZXJUYXJnZXRzLmxlbmd0aD4wKSx0aGlzLl9pbnRlcm1lZGlhdGVSZW5kZXJpbmc9ITEsdGhpcy5fcmVuZGVySWQrKyxpLnJlc3RvcmVEZWZhdWx0RnJhbWVidWZmZXIoKX10aGlzLl9yZW5kZXJUYXJnZXRzRHVyYXRpb24rPWUuVG9vbHMuTm93LXMsdGhpcy5wb3N0UHJvY2Vzc01hbmFnZXIuX3ByZXBhcmVGcmFtZSgpO3ZhciBsLHUsZj1lLlRvb2xzLk5vdztpZih0aGlzLmxheWVycy5sZW5ndGgpe2ZvcihpLnNldERlcHRoQnVmZmVyKCExKSxsPTA7bDx0aGlzLmxheWVycy5sZW5ndGg7bCsrKXU9dGhpcy5sYXllcnNbbF0sdS5pc0JhY2tncm91bmQmJnUucmVuZGVyKCk7aS5zZXREZXB0aEJ1ZmZlcighMCl9ZS5Ub29scy5TdGFydFBlcmZvcm1hbmNlQ291bnRlcihcIk1haW4gcmVuZGVyXCIpLHRoaXMuX3JlbmRlcmluZ01hbmFnZXIucmVuZGVyKG51bGwsbnVsbCwhMCwhMCksZS5Ub29scy5FbmRQZXJmb3JtYW5jZUNvdW50ZXIoXCJNYWluIHJlbmRlclwiKSx0aGlzLl9ib3VuZGluZ0JveFJlbmRlcmVyLnJlbmRlcigpO2Zvcih2YXIgZD0wO2Q8dGhpcy5fZWRnZXNSZW5kZXJlcnMubGVuZ3RoO2QrKyl0aGlzLl9lZGdlc1JlbmRlcmVycy5kYXRhW2RdLnJlbmRlcigpO2lmKHRoaXMubGVuc0ZsYXJlc0VuYWJsZWQpe2UuVG9vbHMuU3RhcnRQZXJmb3JtYW5jZUNvdW50ZXIoXCJMZW5zIGZsYXJlc1wiLHRoaXMubGVuc0ZsYXJlU3lzdGVtcy5sZW5ndGg+MCk7Zm9yKHZhciBwPTA7cDx0aGlzLmxlbnNGbGFyZVN5c3RlbXMubGVuZ3RoO3ArKyl7dmFyIF89dGhpcy5sZW5zRmxhcmVTeXN0ZW1zW3BdOzAhPT0odC5sYXllck1hc2smXy5sYXllck1hc2spJiZfLnJlbmRlcigpfWUuVG9vbHMuRW5kUGVyZm9ybWFuY2VDb3VudGVyKFwiTGVucyBmbGFyZXNcIix0aGlzLmxlbnNGbGFyZVN5c3RlbXMubGVuZ3RoPjApfWlmKHRoaXMubGF5ZXJzLmxlbmd0aCl7Zm9yKGkuc2V0RGVwdGhCdWZmZXIoITEpLGw9MDtsPHRoaXMubGF5ZXJzLmxlbmd0aDtsKyspdT10aGlzLmxheWVyc1tsXSx1LmlzQmFja2dyb3VuZHx8dS5yZW5kZXIoKTtpLnNldERlcHRoQnVmZmVyKCEwKX10aGlzLl9yZW5kZXJEdXJhdGlvbis9ZS5Ub29scy5Ob3ctZix0aGlzLnBvc3RQcm9jZXNzTWFuYWdlci5fZmluYWxpemVGcmFtZSh0LmlzSW50ZXJtZWRpYXRlKSx0aGlzLmFjdGl2ZUNhbWVyYS5fdXBkYXRlRnJvbVNjZW5lKCksdGhpcy5fcmVuZGVyVGFyZ2V0cy5yZXNldCgpLHRoaXMub25BZnRlckNhbWVyYVJlbmRlck9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMuYWN0aXZlQ2FtZXJhKSxlLlRvb2xzLkVuZFBlcmZvcm1hbmNlQ291bnRlcihcIlJlbmRlcmluZyBjYW1lcmEgXCIrdGhpcy5hY3RpdmVDYW1lcmEubmFtZSl9LGkucHJvdG90eXBlLl9wcm9jZXNzU3ViQ2FtZXJhcz1mdW5jdGlvbih0KXtpZih0LmNhbWVyYVJpZ01vZGU9PT1lLkNhbWVyYS5SSUdfTU9ERV9OT05FKXJldHVybiB2b2lkIHRoaXMuX3JlbmRlckZvckNhbWVyYSh0KTtmb3IodmFyIGk9MDtpPHQuX3JpZ0NhbWVyYXMubGVuZ3RoO2krKyl0aGlzLl9yZW5kZXJGb3JDYW1lcmEodC5fcmlnQ2FtZXJhc1tpXSk7dGhpcy5hY3RpdmVDYW1lcmE9dCx0aGlzLnNldFRyYW5zZm9ybU1hdHJpeCh0aGlzLmFjdGl2ZUNhbWVyYS5nZXRWaWV3TWF0cml4KCksdGhpcy5hY3RpdmVDYW1lcmEuZ2V0UHJvamVjdGlvbk1hdHJpeCgpKSx0aGlzLmFjdGl2ZUNhbWVyYS5fdXBkYXRlRnJvbVNjZW5lKCl9LGkucHJvdG90eXBlLl9jaGVja0ludGVyc2VjdGlvbnM9ZnVuY3Rpb24oKXtmb3IodmFyIHQ9MDt0PHRoaXMuX21lc2hlc0ZvckludGVyc2VjdGlvbnMubGVuZ3RoO3QrKylmb3IodmFyIGk9dGhpcy5fbWVzaGVzRm9ySW50ZXJzZWN0aW9ucy5kYXRhW3RdLHI9MDtyPGkuYWN0aW9uTWFuYWdlci5hY3Rpb25zLmxlbmd0aDtyKyspe3ZhciBuPWkuYWN0aW9uTWFuYWdlci5hY3Rpb25zW3JdO2lmKG4udHJpZ2dlcj09PWUuQWN0aW9uTWFuYWdlci5PbkludGVyc2VjdGlvbkVudGVyVHJpZ2dlcnx8bi50cmlnZ2VyPT09ZS5BY3Rpb25NYW5hZ2VyLk9uSW50ZXJzZWN0aW9uRXhpdFRyaWdnZXIpe3ZhciBvPW4uZ2V0VHJpZ2dlclBhcmFtZXRlcigpLHM9byBpbnN0YW5jZW9mIGUuQWJzdHJhY3RNZXNoP286by5tZXNoLGE9cy5pbnRlcnNlY3RzTWVzaChpLG8udXNlUHJlY2lzZUludGVyc2VjdGlvbiksaD1pLl9pbnRlcnNlY3Rpb25zSW5Qcm9ncmVzcy5pbmRleE9mKHMpO2EmJi0xPT09aD9uLnRyaWdnZXI9PT1lLkFjdGlvbk1hbmFnZXIuT25JbnRlcnNlY3Rpb25FbnRlclRyaWdnZXI/KG4uX2V4ZWN1dGVDdXJyZW50KGUuQWN0aW9uRXZlbnQuQ3JlYXRlTmV3KGksbnVsbCxzKSksaS5faW50ZXJzZWN0aW9uc0luUHJvZ3Jlc3MucHVzaChzKSk6bi50cmlnZ2VyPT09ZS5BY3Rpb25NYW5hZ2VyLk9uSW50ZXJzZWN0aW9uRXhpdFRyaWdnZXImJmkuX2ludGVyc2VjdGlvbnNJblByb2dyZXNzLnB1c2gocyk6IWEmJmg+LTEmJihuLnRyaWdnZXI9PT1lLkFjdGlvbk1hbmFnZXIuT25JbnRlcnNlY3Rpb25FeGl0VHJpZ2dlciYmbi5fZXhlY3V0ZUN1cnJlbnQoZS5BY3Rpb25FdmVudC5DcmVhdGVOZXcoaSxudWxsLHMpKSxpLmFjdGlvbk1hbmFnZXIuaGFzU3BlY2lmaWNUcmlnZ2VyKGUuQWN0aW9uTWFuYWdlci5PbkludGVyc2VjdGlvbkV4aXRUcmlnZ2VyKSYmbi50cmlnZ2VyIT09ZS5BY3Rpb25NYW5hZ2VyLk9uSW50ZXJzZWN0aW9uRXhpdFRyaWdnZXJ8fGkuX2ludGVyc2VjdGlvbnNJblByb2dyZXNzLnNwbGljZShoLDEpKX19fSxpLnByb3RvdHlwZS5yZW5kZXI9ZnVuY3Rpb24oKXt2YXIgdD1lLlRvb2xzLk5vdzt0aGlzLl9wYXJ0aWNsZXNEdXJhdGlvbj0wLHRoaXMuX3Nwcml0ZXNEdXJhdGlvbj0wLHRoaXMuX2FjdGl2ZVBhcnRpY2xlcz0wLHRoaXMuX3JlbmRlckR1cmF0aW9uPTAsdGhpcy5fcmVuZGVyVGFyZ2V0c0R1cmF0aW9uPTAsdGhpcy5fZXZhbHVhdGVBY3RpdmVNZXNoZXNEdXJhdGlvbj0wLHRoaXMuX3RvdGFsVmVydGljZXM9MCx0aGlzLl9hY3RpdmVJbmRpY2VzPTAsdGhpcy5fYWN0aXZlQm9uZXM9MCx0aGlzLmdldEVuZ2luZSgpLnJlc2V0RHJhd0NhbGxzKCksdGhpcy5fbWVzaGVzRm9ySW50ZXJzZWN0aW9ucy5yZXNldCgpLHRoaXMucmVzZXRDYWNoZWRNYXRlcmlhbCgpLGUuVG9vbHMuU3RhcnRQZXJmb3JtYW5jZUNvdW50ZXIoXCJTY2VuZSByZW5kZXJpbmdcIiksdGhpcy5hY3Rpb25NYW5hZ2VyJiZ0aGlzLmFjdGlvbk1hbmFnZXIucHJvY2Vzc1RyaWdnZXIoZS5BY3Rpb25NYW5hZ2VyLk9uRXZlcnlGcmFtZVRyaWdnZXIsbnVsbCksdGhpcy5zaW1wbGlmaWNhdGlvblF1ZXVlJiYhdGhpcy5zaW1wbGlmaWNhdGlvblF1ZXVlLnJ1bm5pbmcmJnRoaXMuc2ltcGxpZmljYXRpb25RdWV1ZS5leGVjdXRlTmV4dCgpO3ZhciByPU1hdGgubWF4KGkuTWluRGVsdGFUaW1lLE1hdGgubWluKHRoaXMuX2VuZ2luZS5nZXREZWx0YVRpbWUoKSxpLk1heERlbHRhVGltZSkpO3RoaXMuX2FuaW1hdGlvblJhdGlvPS4wNipyLHRoaXMuX2FuaW1hdGUoKSx0aGlzLl9waHlzaWNzRW5naW5lJiYoZS5Ub29scy5TdGFydFBlcmZvcm1hbmNlQ291bnRlcihcIlBoeXNpY3NcIiksdGhpcy5fcGh5c2ljc0VuZ2luZS5fc3RlcChyLzFlMyksZS5Ub29scy5FbmRQZXJmb3JtYW5jZUNvdW50ZXIoXCJQaHlzaWNzXCIpKSx0aGlzLm9uQmVmb3JlUmVuZGVyT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcyk7dmFyIG49ZS5Ub29scy5Ob3csbz10aGlzLmdldEVuZ2luZSgpLHM9dGhpcy5hY3RpdmVDYW1lcmE7aWYodGhpcy5yZW5kZXJUYXJnZXRzRW5hYmxlZCl7ZS5Ub29scy5TdGFydFBlcmZvcm1hbmNlQ291bnRlcihcIkN1c3RvbSByZW5kZXIgdGFyZ2V0c1wiLHRoaXMuY3VzdG9tUmVuZGVyVGFyZ2V0cy5sZW5ndGg+MCk7Zm9yKHZhciBhPTA7YTx0aGlzLmN1c3RvbVJlbmRlclRhcmdldHMubGVuZ3RoO2ErKyl7dmFyIGg9dGhpcy5jdXN0b21SZW5kZXJUYXJnZXRzW2FdO2lmKGguX3Nob3VsZFJlbmRlcigpKXtpZih0aGlzLl9yZW5kZXJJZCsrLHRoaXMuYWN0aXZlQ2FtZXJhPWguYWN0aXZlQ2FtZXJhfHx0aGlzLmFjdGl2ZUNhbWVyYSwhdGhpcy5hY3RpdmVDYW1lcmEpdGhyb3cgbmV3IEVycm9yKFwiQWN0aXZlIGNhbWVyYSBub3Qgc2V0XCIpO28uc2V0Vmlld3BvcnQodGhpcy5hY3RpdmVDYW1lcmEudmlld3BvcnQpLHRoaXMudXBkYXRlVHJhbnNmb3JtTWF0cml4KCksaC5yZW5kZXIocyE9PXRoaXMuYWN0aXZlQ2FtZXJhLHRoaXMuZHVtcE5leHRSZW5kZXJUYXJnZXRzKX19ZS5Ub29scy5FbmRQZXJmb3JtYW5jZUNvdW50ZXIoXCJDdXN0b20gcmVuZGVyIHRhcmdldHNcIix0aGlzLmN1c3RvbVJlbmRlclRhcmdldHMubGVuZ3RoPjApLHRoaXMuX3JlbmRlcklkKyt9aWYodGhpcy5jdXN0b21SZW5kZXJUYXJnZXRzLmxlbmd0aD4wJiZvLnJlc3RvcmVEZWZhdWx0RnJhbWVidWZmZXIoKSx0aGlzLl9yZW5kZXJUYXJnZXRzRHVyYXRpb24rPWUuVG9vbHMuTm93LW4sdGhpcy5hY3RpdmVDYW1lcmE9cyx0aGlzLnByb2NlZHVyYWxUZXh0dXJlc0VuYWJsZWQpe2UuVG9vbHMuU3RhcnRQZXJmb3JtYW5jZUNvdW50ZXIoXCJQcm9jZWR1cmFsIHRleHR1cmVzXCIsdGhpcy5fcHJvY2VkdXJhbFRleHR1cmVzLmxlbmd0aD4wKTtmb3IodmFyIGM9MDtjPHRoaXMuX3Byb2NlZHVyYWxUZXh0dXJlcy5sZW5ndGg7YysrKXt2YXIgbD10aGlzLl9wcm9jZWR1cmFsVGV4dHVyZXNbY107bC5fc2hvdWxkUmVuZGVyKCkmJmwucmVuZGVyKCl9ZS5Ub29scy5FbmRQZXJmb3JtYW5jZUNvdW50ZXIoXCJQcm9jZWR1cmFsIHRleHR1cmVzXCIsdGhpcy5fcHJvY2VkdXJhbFRleHR1cmVzLmxlbmd0aD4wKX1pZih0aGlzLl9lbmdpbmUuY2xlYXIodGhpcy5jbGVhckNvbG9yLHRoaXMuYXV0b0NsZWFyfHx0aGlzLmZvcmNlV2lyZWZyYW1lfHx0aGlzLmZvcmNlUG9pbnRzQ2xvdWQsITApLHRoaXMuc2hhZG93c0VuYWJsZWQpZm9yKHZhciB1PTA7dTx0aGlzLmxpZ2h0cy5sZW5ndGg7dSsrKXt2YXIgZj10aGlzLmxpZ2h0c1t1XSxkPWYuZ2V0U2hhZG93R2VuZXJhdG9yKCk7Zi5pc0VuYWJsZWQoKSYmZCYmLTEhPT1kLmdldFNoYWRvd01hcCgpLmdldFNjZW5lKCkudGV4dHVyZXMuaW5kZXhPZihkLmdldFNoYWRvd01hcCgpKSYmdGhpcy5fcmVuZGVyVGFyZ2V0cy5wdXNoKGQuZ2V0U2hhZG93TWFwKCkpfWlmKHRoaXMuX2RlcHRoUmVuZGVyZXImJnRoaXMuX3JlbmRlclRhcmdldHMucHVzaCh0aGlzLl9kZXB0aFJlbmRlcmVyLmdldERlcHRoTWFwKCkpLHRoaXMucG9zdFByb2Nlc3NSZW5kZXJQaXBlbGluZU1hbmFnZXIudXBkYXRlKCksdGhpcy5hY3RpdmVDYW1lcmFzLmxlbmd0aD4wKWZvcih2YXIgcD10aGlzLl9yZW5kZXJJZCxfPTA7Xzx0aGlzLmFjdGl2ZUNhbWVyYXMubGVuZ3RoO18rKyl0aGlzLl9yZW5kZXJJZD1wLF8+MCYmdGhpcy5fZW5naW5lLmNsZWFyKDAsITEsITApLHRoaXMuX3Byb2Nlc3NTdWJDYW1lcmFzKHRoaXMuYWN0aXZlQ2FtZXJhc1tfXSk7ZWxzZXtpZighdGhpcy5hY3RpdmVDYW1lcmEpdGhyb3cgbmV3IEVycm9yKFwiTm8gY2FtZXJhIGRlZmluZWRcIik7dGhpcy5fcHJvY2Vzc1N1YkNhbWVyYXModGhpcy5hY3RpdmVDYW1lcmEpfXRoaXMuX2NoZWNrSW50ZXJzZWN0aW9ucygpLGUuQXVkaW9FbmdpbmUmJnRoaXMuX3VwZGF0ZUF1ZGlvUGFyYW1ldGVycygpLHRoaXMuYWZ0ZXJSZW5kZXImJnRoaXMuYWZ0ZXJSZW5kZXIoKSx0aGlzLm9uQWZ0ZXJSZW5kZXJPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzKTtmb3IodmFyIG09MDttPHRoaXMuX3RvQmVEaXNwb3NlZC5sZW5ndGg7bSsrKXRoaXMuX3RvQmVEaXNwb3NlZC5kYXRhW21dLmRpc3Bvc2UoKSx0aGlzLl90b0JlRGlzcG9zZWRbbV09bnVsbDt0aGlzLl90b0JlRGlzcG9zZWQucmVzZXQoKSx0aGlzLmR1bXBOZXh0UmVuZGVyVGFyZ2V0cyYmKHRoaXMuZHVtcE5leHRSZW5kZXJUYXJnZXRzPSExKSxlLlRvb2xzLkVuZFBlcmZvcm1hbmNlQ291bnRlcihcIlNjZW5lIHJlbmRlcmluZ1wiKSx0aGlzLl9sYXN0RnJhbWVEdXJhdGlvbj1lLlRvb2xzLk5vdy10fSxpLnByb3RvdHlwZS5fdXBkYXRlQXVkaW9QYXJhbWV0ZXJzPWZ1bmN0aW9uKCl7aWYodGhpcy5hdWRpb0VuYWJsZWQmJigwIT09dGhpcy5tYWluU291bmRUcmFjay5zb3VuZENvbGxlY3Rpb24ubGVuZ3RofHwxIT09dGhpcy5zb3VuZFRyYWNrcy5sZW5ndGgpKXt2YXIgdCxpPWUuRW5naW5lLmF1ZGlvRW5naW5lO2lmKHQ9dGhpcy5hY3RpdmVDYW1lcmFzLmxlbmd0aD4wP3RoaXMuYWN0aXZlQ2FtZXJhc1swXTp0aGlzLmFjdGl2ZUNhbWVyYSx0JiZpLmNhblVzZVdlYkF1ZGlvKXtpLmF1ZGlvQ29udGV4dC5saXN0ZW5lci5zZXRQb3NpdGlvbih0LnBvc2l0aW9uLngsdC5wb3NpdGlvbi55LHQucG9zaXRpb24ueik7dmFyIHI9ZS5NYXRyaXguSW52ZXJ0KHQuZ2V0Vmlld01hdHJpeCgpKSxuPWUuVmVjdG9yMy5UcmFuc2Zvcm1Ob3JtYWwobmV3IGUuVmVjdG9yMygwLDAsLTEpLHIpO24ubm9ybWFsaXplKCksaS5hdWRpb0NvbnRleHQubGlzdGVuZXIuc2V0T3JpZW50YXRpb24obi54LG4ueSxuLnosMCwxLDApO3ZhciBvO2ZvcihvPTA7bzx0aGlzLm1haW5Tb3VuZFRyYWNrLnNvdW5kQ29sbGVjdGlvbi5sZW5ndGg7bysrKXt2YXIgcz10aGlzLm1haW5Tb3VuZFRyYWNrLnNvdW5kQ29sbGVjdGlvbltvXTtzLnVzZUN1c3RvbUF0dGVudWF0aW9uJiZzLnVwZGF0ZURpc3RhbmNlRnJvbUxpc3RlbmVyKCl9Zm9yKG89MDtvPHRoaXMuc291bmRUcmFja3MubGVuZ3RoO28rKylmb3IodmFyIGE9MDthPHRoaXMuc291bmRUcmFja3Nbb10uc291bmRDb2xsZWN0aW9uLmxlbmd0aDthKyspcz10aGlzLnNvdW5kVHJhY2tzW29dLnNvdW5kQ29sbGVjdGlvblthXSxzLnVzZUN1c3RvbUF0dGVudWF0aW9uJiZzLnVwZGF0ZURpc3RhbmNlRnJvbUxpc3RlbmVyKCl9fX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KGkucHJvdG90eXBlLFwiYXVkaW9FbmFibGVkXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9hdWRpb0VuYWJsZWR9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9hdWRpb0VuYWJsZWQ9dCxlLkF1ZGlvRW5naW5lJiYodGhpcy5fYXVkaW9FbmFibGVkP3RoaXMuX2VuYWJsZUF1ZGlvKCk6dGhpcy5fZGlzYWJsZUF1ZGlvKCkpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLGkucHJvdG90eXBlLl9kaXNhYmxlQXVkaW89ZnVuY3Rpb24oKXt2YXIgZTtmb3IoZT0wO2U8dGhpcy5tYWluU291bmRUcmFjay5zb3VuZENvbGxlY3Rpb24ubGVuZ3RoO2UrKyl0aGlzLm1haW5Tb3VuZFRyYWNrLnNvdW5kQ29sbGVjdGlvbltlXS5wYXVzZSgpO2ZvcihlPTA7ZTx0aGlzLnNvdW5kVHJhY2tzLmxlbmd0aDtlKyspZm9yKHZhciB0PTA7dDx0aGlzLnNvdW5kVHJhY2tzW2VdLnNvdW5kQ29sbGVjdGlvbi5sZW5ndGg7dCsrKXRoaXMuc291bmRUcmFja3NbZV0uc291bmRDb2xsZWN0aW9uW3RdLnBhdXNlKCl9LGkucHJvdG90eXBlLl9lbmFibGVBdWRpbz1mdW5jdGlvbigpe3ZhciBlO2ZvcihlPTA7ZTx0aGlzLm1haW5Tb3VuZFRyYWNrLnNvdW5kQ29sbGVjdGlvbi5sZW5ndGg7ZSsrKXRoaXMubWFpblNvdW5kVHJhY2suc291bmRDb2xsZWN0aW9uW2VdLmlzUGF1c2VkJiZ0aGlzLm1haW5Tb3VuZFRyYWNrLnNvdW5kQ29sbGVjdGlvbltlXS5wbGF5KCk7Zm9yKGU9MDtlPHRoaXMuc291bmRUcmFja3MubGVuZ3RoO2UrKylmb3IodmFyIHQ9MDt0PHRoaXMuc291bmRUcmFja3NbZV0uc291bmRDb2xsZWN0aW9uLmxlbmd0aDt0KyspdGhpcy5zb3VuZFRyYWNrc1tlXS5zb3VuZENvbGxlY3Rpb25bdF0uaXNQYXVzZWQmJnRoaXMuc291bmRUcmFja3NbZV0uc291bmRDb2xsZWN0aW9uW3RdLnBsYXkoKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KGkucHJvdG90eXBlLFwiaGVhZHBob25lXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9oZWFkcGhvbmV9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9oZWFkcGhvbmU9dCxlLkF1ZGlvRW5naW5lJiYodGhpcy5faGVhZHBob25lP3RoaXMuX3N3aXRjaEF1ZGlvTW9kZUZvckhlYWRwaG9uZXMoKTp0aGlzLl9zd2l0Y2hBdWRpb01vZGVGb3JOb3JtYWxTcGVha2VycygpKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxpLnByb3RvdHlwZS5fc3dpdGNoQXVkaW9Nb2RlRm9ySGVhZHBob25lcz1mdW5jdGlvbigpe3RoaXMubWFpblNvdW5kVHJhY2suc3dpdGNoUGFubmluZ01vZGVsVG9IUlRGKCk7Zm9yKHZhciBlPTA7ZTx0aGlzLnNvdW5kVHJhY2tzLmxlbmd0aDtlKyspdGhpcy5zb3VuZFRyYWNrc1tlXS5zd2l0Y2hQYW5uaW5nTW9kZWxUb0hSVEYoKX0saS5wcm90b3R5cGUuX3N3aXRjaEF1ZGlvTW9kZUZvck5vcm1hbFNwZWFrZXJzPWZ1bmN0aW9uKCl7dGhpcy5tYWluU291bmRUcmFjay5zd2l0Y2hQYW5uaW5nTW9kZWxUb0VxdWFsUG93ZXIoKTtmb3IodmFyIGU9MDtlPHRoaXMuc291bmRUcmFja3MubGVuZ3RoO2UrKyl0aGlzLnNvdW5kVHJhY2tzW2VdLnN3aXRjaFBhbm5pbmdNb2RlbFRvRXF1YWxQb3dlcigpfSxpLnByb3RvdHlwZS5lbmFibGVEZXB0aFJlbmRlcmVyPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2RlcHRoUmVuZGVyZXI/dGhpcy5fZGVwdGhSZW5kZXJlcjoodGhpcy5fZGVwdGhSZW5kZXJlcj1uZXcgZS5EZXB0aFJlbmRlcmVyKHRoaXMpLHRoaXMuX2RlcHRoUmVuZGVyZXIpfSxpLnByb3RvdHlwZS5kaXNhYmxlRGVwdGhSZW5kZXJlcj1mdW5jdGlvbigpe3RoaXMuX2RlcHRoUmVuZGVyZXImJih0aGlzLl9kZXB0aFJlbmRlcmVyLmRpc3Bvc2UoKSx0aGlzLl9kZXB0aFJlbmRlcmVyPW51bGwpfSxpLnByb3RvdHlwZS5mcmVlemVNYXRlcmlhbHM9ZnVuY3Rpb24oKXtmb3IodmFyIGU9MDtlPHRoaXMubWF0ZXJpYWxzLmxlbmd0aDtlKyspdGhpcy5tYXRlcmlhbHNbZV0uZnJlZXplKCl9LGkucHJvdG90eXBlLnVuZnJlZXplTWF0ZXJpYWxzPWZ1bmN0aW9uKCl7Zm9yKHZhciBlPTA7ZTx0aGlzLm1hdGVyaWFscy5sZW5ndGg7ZSsrKXRoaXMubWF0ZXJpYWxzW2VdLnVuZnJlZXplKCl9LGkucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXt0aGlzLmJlZm9yZVJlbmRlcj1udWxsLHRoaXMuYWZ0ZXJSZW5kZXI9bnVsbCx0aGlzLnNrZWxldG9ucz1bXSx0aGlzLl9ib3VuZGluZ0JveFJlbmRlcmVyLmRpc3Bvc2UoKSx0aGlzLl9kZXB0aFJlbmRlcmVyJiZ0aGlzLl9kZXB0aFJlbmRlcmVyLmRpc3Bvc2UoKSx0aGlzLl9kZWJ1Z0xheWVyJiZ0aGlzLl9kZWJ1Z0xheWVyLmhpZGUoKSx0aGlzLm9uRGlzcG9zZU9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpLHRoaXMub25EaXNwb3NlT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25CZWZvcmVSZW5kZXJPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbkFmdGVyUmVuZGVyT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMuZGV0YWNoQ29udHJvbCgpLGUuQXVkaW9FbmdpbmUmJnRoaXMuZGlzcG9zZVNvdW5kcygpO3ZhciB0LGk9dGhpcy5fZW5naW5lLmdldFJlbmRlcmluZ0NhbnZhcygpO2Zvcih0PTA7dDx0aGlzLmNhbWVyYXMubGVuZ3RoO3QrKyl0aGlzLmNhbWVyYXNbdF0uZGV0YWNoQ29udHJvbChpKTtmb3IoO3RoaXMubGlnaHRzLmxlbmd0aDspdGhpcy5saWdodHNbMF0uZGlzcG9zZSgpO2Zvcig7dGhpcy5tZXNoZXMubGVuZ3RoOyl0aGlzLm1lc2hlc1swXS5kaXNwb3NlKCEwKTtmb3IoO3RoaXMuY2FtZXJhcy5sZW5ndGg7KXRoaXMuY2FtZXJhc1swXS5kaXNwb3NlKCk7Zm9yKDt0aGlzLm1hdGVyaWFscy5sZW5ndGg7KXRoaXMubWF0ZXJpYWxzWzBdLmRpc3Bvc2UoKTtmb3IoO3RoaXMucGFydGljbGVTeXN0ZW1zLmxlbmd0aDspdGhpcy5wYXJ0aWNsZVN5c3RlbXNbMF0uZGlzcG9zZSgpO2Zvcig7dGhpcy5zcHJpdGVNYW5hZ2Vycy5sZW5ndGg7KXRoaXMuc3ByaXRlTWFuYWdlcnNbMF0uZGlzcG9zZSgpO2Zvcig7dGhpcy5sYXllcnMubGVuZ3RoOyl0aGlzLmxheWVyc1swXS5kaXNwb3NlKCk7Zm9yKDt0aGlzLnRleHR1cmVzLmxlbmd0aDspdGhpcy50ZXh0dXJlc1swXS5kaXNwb3NlKCk7dGhpcy5wb3N0UHJvY2Vzc01hbmFnZXIuZGlzcG9zZSgpLHRoaXMuX3BoeXNpY3NFbmdpbmUmJnRoaXMuZGlzYWJsZVBoeXNpY3NFbmdpbmUoKSx0PXRoaXMuX2VuZ2luZS5zY2VuZXMuaW5kZXhPZih0aGlzKSx0Pi0xJiZ0aGlzLl9lbmdpbmUuc2NlbmVzLnNwbGljZSh0LDEpLHRoaXMuX2VuZ2luZS53aXBlQ2FjaGVzKCl9LGkucHJvdG90eXBlLmRpc3Bvc2VTb3VuZHM9ZnVuY3Rpb24oKXt0aGlzLm1haW5Tb3VuZFRyYWNrLmRpc3Bvc2UoKTtmb3IodmFyIGU9MDtlPHRoaXMuc291bmRUcmFja3MubGVuZ3RoO2UrKyl0aGlzLnNvdW5kVHJhY2tzW2VdLmRpc3Bvc2UoKX0saS5wcm90b3R5cGUuZ2V0V29ybGRFeHRlbmRzPWZ1bmN0aW9uKCl7Zm9yKHZhciB0PW5ldyBlLlZlY3RvcjMoTnVtYmVyLk1BWF9WQUxVRSxOdW1iZXIuTUFYX1ZBTFVFLE51bWJlci5NQVhfVkFMVUUpLGk9bmV3IGUuVmVjdG9yMygtTnVtYmVyLk1BWF9WQUxVRSwtTnVtYmVyLk1BWF9WQUxVRSwtTnVtYmVyLk1BWF9WQUxVRSkscj0wO3I8dGhpcy5tZXNoZXMubGVuZ3RoO3IrKyl7dmFyIG49dGhpcy5tZXNoZXNbcl07bi5jb21wdXRlV29ybGRNYXRyaXgoITApO3ZhciBvPW4uZ2V0Qm91bmRpbmdJbmZvKCkuYm91bmRpbmdCb3gubWluaW11bVdvcmxkLHM9bi5nZXRCb3VuZGluZ0luZm8oKS5ib3VuZGluZ0JveC5tYXhpbXVtV29ybGQ7ZS5Ub29scy5DaGVja0V4dGVuZHMobyx0LGkpLGUuVG9vbHMuQ2hlY2tFeHRlbmRzKHMsdCxpKX1yZXR1cm57bWluOnQsbWF4Oml9fSxpLnByb3RvdHlwZS5jcmVhdGVPclVwZGF0ZVNlbGVjdGlvbk9jdHJlZT1mdW5jdGlvbih0LGkpe3ZvaWQgMD09PXQmJih0PTY0KSx2b2lkIDA9PT1pJiYoaT0yKSx0aGlzLl9zZWxlY3Rpb25PY3RyZWV8fCh0aGlzLl9zZWxlY3Rpb25PY3RyZWU9bmV3IGUuT2N0cmVlKGUuT2N0cmVlLkNyZWF0aW9uRnVuY0Zvck1lc2hlcyx0LGkpKTt2YXIgcj10aGlzLmdldFdvcmxkRXh0ZW5kcygpO3JldHVybiB0aGlzLl9zZWxlY3Rpb25PY3RyZWUudXBkYXRlKHIubWluLHIubWF4LHRoaXMubWVzaGVzKSx0aGlzLl9zZWxlY3Rpb25PY3RyZWV9LGkucHJvdG90eXBlLmNyZWF0ZVBpY2tpbmdSYXk9ZnVuY3Rpb24odCxpLHIsbixvKXt2b2lkIDA9PT1vJiYobz0hMSk7dmFyIHM9dGhpcy5fZW5naW5lO2lmKCFuKXtpZighdGhpcy5hY3RpdmVDYW1lcmEpdGhyb3cgbmV3IEVycm9yKFwiQWN0aXZlIGNhbWVyYSBub3Qgc2V0XCIpO249dGhpcy5hY3RpdmVDYW1lcmF9dmFyIGE9bi52aWV3cG9ydCxoPWEudG9HbG9iYWwocy5nZXRSZW5kZXJXaWR0aCgpLHMuZ2V0UmVuZGVySGVpZ2h0KCkpO3JldHVybiB0PXQvdGhpcy5fZW5naW5lLmdldEhhcmR3YXJlU2NhbGluZ0xldmVsKCktaC54LGk9aS90aGlzLl9lbmdpbmUuZ2V0SGFyZHdhcmVTY2FsaW5nTGV2ZWwoKS0odGhpcy5fZW5naW5lLmdldFJlbmRlckhlaWdodCgpLWgueS1oLmhlaWdodCksZS5SYXkuQ3JlYXRlTmV3KHQsaSxoLndpZHRoLGguaGVpZ2h0LHI/cjplLk1hdHJpeC5JZGVudGl0eSgpLG8/ZS5NYXRyaXguSWRlbnRpdHkoKTpuLmdldFZpZXdNYXRyaXgoKSxuLmdldFByb2plY3Rpb25NYXRyaXgoKSl9LGkucHJvdG90eXBlLmNyZWF0ZVBpY2tpbmdSYXlJbkNhbWVyYVNwYWNlPWZ1bmN0aW9uKHQsaSxyKXt2YXIgbj10aGlzLl9lbmdpbmU7aWYoIXIpe2lmKCF0aGlzLmFjdGl2ZUNhbWVyYSl0aHJvdyBuZXcgRXJyb3IoXCJBY3RpdmUgY2FtZXJhIG5vdCBzZXRcIik7cj10aGlzLmFjdGl2ZUNhbWVyYX12YXIgbz1yLnZpZXdwb3J0LHM9by50b0dsb2JhbChuLmdldFJlbmRlcldpZHRoKCksbi5nZXRSZW5kZXJIZWlnaHQoKSksYT1lLk1hdHJpeC5JZGVudGl0eSgpO3JldHVybiB0PXQvdGhpcy5fZW5naW5lLmdldEhhcmR3YXJlU2NhbGluZ0xldmVsKCktcy54LGk9aS90aGlzLl9lbmdpbmUuZ2V0SGFyZHdhcmVTY2FsaW5nTGV2ZWwoKS0odGhpcy5fZW5naW5lLmdldFJlbmRlckhlaWdodCgpLXMueS1zLmhlaWdodCksZS5SYXkuQ3JlYXRlTmV3KHQsaSxzLndpZHRoLHMuaGVpZ2h0LGEsYSxyLmdldFByb2plY3Rpb25NYXRyaXgoKSl9LGkucHJvdG90eXBlLl9pbnRlcm5hbFBpY2s9ZnVuY3Rpb24odCxpLHIpe2Zvcih2YXIgbj1udWxsLG89MDtvPHRoaXMubWVzaGVzLmxlbmd0aDtvKyspe3ZhciBzPXRoaXMubWVzaGVzW29dO2lmKGkpe2lmKCFpKHMpKWNvbnRpbnVlfWVsc2UgaWYoIXMuaXNFbmFibGVkKCl8fCFzLmlzVmlzaWJsZXx8IXMuaXNQaWNrYWJsZSljb250aW51ZTt2YXIgYT1zLmdldFdvcmxkTWF0cml4KCksaD10KGEpLGM9cy5pbnRlcnNlY3RzKGgscik7aWYoYyYmYy5oaXQmJihyfHxudWxsPT1ufHwhKGMuZGlzdGFuY2U+PW4uZGlzdGFuY2UpKSYmKG49YyxyKSlicmVha31yZXR1cm4gbnx8bmV3IGUuUGlja2luZ0luZm99LGkucHJvdG90eXBlLl9pbnRlcm5hbFBpY2tTcHJpdGVzPWZ1bmN0aW9uKHQsaSxyLG4pe3ZhciBvPW51bGw7aWYobj1ufHx0aGlzLmFjdGl2ZUNhbWVyYSx0aGlzLnNwcml0ZU1hbmFnZXJzLmxlbmd0aD4wKWZvcih2YXIgcz0wO3M8dGhpcy5zcHJpdGVNYW5hZ2Vycy5sZW5ndGg7cysrKXt2YXIgYT10aGlzLnNwcml0ZU1hbmFnZXJzW3NdO2lmKGEuaXNQaWNrYWJsZSl7dmFyIGg9YS5pbnRlcnNlY3RzKHQsbixpLHIpO2lmKGgmJmguaGl0JiYocnx8bnVsbD09b3x8IShoLmRpc3RhbmNlPj1vLmRpc3RhbmNlKSkmJihvPWgscikpYnJlYWt9fXJldHVybiBvfHxuZXcgZS5QaWNraW5nSW5mb30saS5wcm90b3R5cGUucGljaz1mdW5jdGlvbihlLHQsaSxyLG4pe3ZhciBvPXRoaXM7cmV0dXJuIHRoaXMuX2ludGVybmFsUGljayhmdW5jdGlvbihpKXtyZXR1cm4gby5jcmVhdGVQaWNraW5nUmF5KGUsdCxpLG4pfSxpLHIpfSxpLnByb3RvdHlwZS5waWNrU3ByaXRlPWZ1bmN0aW9uKGUsdCxpLHIsbil7cmV0dXJuIHRoaXMuX2ludGVybmFsUGlja1Nwcml0ZXModGhpcy5jcmVhdGVQaWNraW5nUmF5SW5DYW1lcmFTcGFjZShlLHQsbiksaSxyLG4pfSxpLnByb3RvdHlwZS5waWNrV2l0aFJheT1mdW5jdGlvbih0LGkscil7dmFyIG49dGhpcztyZXR1cm4gdGhpcy5faW50ZXJuYWxQaWNrKGZ1bmN0aW9uKGkpe3JldHVybiBuLl9waWNrV2l0aFJheUludmVyc2VNYXRyaXh8fChuLl9waWNrV2l0aFJheUludmVyc2VNYXRyaXg9ZS5NYXRyaXguSWRlbnRpdHkoKSksaS5pbnZlcnRUb1JlZihuLl9waWNrV2l0aFJheUludmVyc2VNYXRyaXgpLGUuUmF5LlRyYW5zZm9ybSh0LG4uX3BpY2tXaXRoUmF5SW52ZXJzZU1hdHJpeCl9LGkscil9LGkucHJvdG90eXBlLnNldFBvaW50ZXJPdmVyTWVzaD1mdW5jdGlvbih0KXt0aGlzLl9wb2ludGVyT3Zlck1lc2ghPT10JiYodGhpcy5fcG9pbnRlck92ZXJNZXNoJiZ0aGlzLl9wb2ludGVyT3Zlck1lc2guYWN0aW9uTWFuYWdlciYmdGhpcy5fcG9pbnRlck92ZXJNZXNoLmFjdGlvbk1hbmFnZXIucHJvY2Vzc1RyaWdnZXIoZS5BY3Rpb25NYW5hZ2VyLk9uUG9pbnRlck91dFRyaWdnZXIsZS5BY3Rpb25FdmVudC5DcmVhdGVOZXcodGhpcy5fcG9pbnRlck92ZXJNZXNoKSksdGhpcy5fcG9pbnRlck92ZXJNZXNoPXQsdGhpcy5fcG9pbnRlck92ZXJNZXNoJiZ0aGlzLl9wb2ludGVyT3Zlck1lc2guYWN0aW9uTWFuYWdlciYmdGhpcy5fcG9pbnRlck92ZXJNZXNoLmFjdGlvbk1hbmFnZXIucHJvY2Vzc1RyaWdnZXIoZS5BY3Rpb25NYW5hZ2VyLk9uUG9pbnRlck92ZXJUcmlnZ2VyLGUuQWN0aW9uRXZlbnQuQ3JlYXRlTmV3KHRoaXMuX3BvaW50ZXJPdmVyTWVzaCkpKX0saS5wcm90b3R5cGUuZ2V0UG9pbnRlck92ZXJNZXNoPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3BvaW50ZXJPdmVyTWVzaH0saS5wcm90b3R5cGUuc2V0UG9pbnRlck92ZXJTcHJpdGU9ZnVuY3Rpb24odCl7dGhpcy5fcG9pbnRlck92ZXJTcHJpdGUhPT10JiYodGhpcy5fcG9pbnRlck92ZXJTcHJpdGUmJnRoaXMuX3BvaW50ZXJPdmVyU3ByaXRlLmFjdGlvbk1hbmFnZXImJnRoaXMuX3BvaW50ZXJPdmVyU3ByaXRlLmFjdGlvbk1hbmFnZXIucHJvY2Vzc1RyaWdnZXIoZS5BY3Rpb25NYW5hZ2VyLk9uUG9pbnRlck91dFRyaWdnZXIsZS5BY3Rpb25FdmVudC5DcmVhdGVOZXdGcm9tU3ByaXRlKHRoaXMuX3BvaW50ZXJPdmVyU3ByaXRlLHRoaXMpKSx0aGlzLl9wb2ludGVyT3ZlclNwcml0ZT10LHRoaXMuX3BvaW50ZXJPdmVyU3ByaXRlJiZ0aGlzLl9wb2ludGVyT3ZlclNwcml0ZS5hY3Rpb25NYW5hZ2VyJiZ0aGlzLl9wb2ludGVyT3ZlclNwcml0ZS5hY3Rpb25NYW5hZ2VyLnByb2Nlc3NUcmlnZ2VyKGUuQWN0aW9uTWFuYWdlci5PblBvaW50ZXJPdmVyVHJpZ2dlcixlLkFjdGlvbkV2ZW50LkNyZWF0ZU5ld0Zyb21TcHJpdGUodGhpcy5fcG9pbnRlck92ZXJTcHJpdGUsdGhpcykpKX0saS5wcm90b3R5cGUuZ2V0UG9pbnRlck92ZXJTcHJpdGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcG9pbnRlck92ZXJTcHJpdGV9LGkucHJvdG90eXBlLmdldFBoeXNpY3NFbmdpbmU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcGh5c2ljc0VuZ2luZX0saS5wcm90b3R5cGUuZW5hYmxlUGh5c2ljcz1mdW5jdGlvbih0LGkpe2lmKHRoaXMuX3BoeXNpY3NFbmdpbmUpcmV0dXJuITA7dHJ5e3JldHVybiB0aGlzLl9waHlzaWNzRW5naW5lPW5ldyBlLlBoeXNpY3NFbmdpbmUodCxpKSwhMH1jYXRjaChyKXtyZXR1cm4gZS5Ub29scy5FcnJvcihyLm1lc3NhZ2UpLCExfX0saS5wcm90b3R5cGUuZGlzYWJsZVBoeXNpY3NFbmdpbmU9ZnVuY3Rpb24oKXt0aGlzLl9waHlzaWNzRW5naW5lJiYodGhpcy5fcGh5c2ljc0VuZ2luZS5kaXNwb3NlKCksdGhpcy5fcGh5c2ljc0VuZ2luZT12b2lkIDApfSxpLnByb3RvdHlwZS5pc1BoeXNpY3NFbmFibGVkPWZ1bmN0aW9uKCl7cmV0dXJuIHZvaWQgMCE9PXRoaXMuX3BoeXNpY3NFbmdpbmV9LGkucHJvdG90eXBlLnNldEdyYXZpdHk9ZnVuY3Rpb24odCl7ZS5Ub29scy5XYXJuKFwiRGVwcmVjYXRlZCwgcGxlYXNlIHVzZSAnc2NlbmUuZ2V0UGh5c2ljc0VuZ2luZSgpLnNldEdyYXZpdHkoKSdcIiksdGhpcy5fcGh5c2ljc0VuZ2luZSYmdGhpcy5fcGh5c2ljc0VuZ2luZS5zZXRHcmF2aXR5KHQpfSxpLnByb3RvdHlwZS5jcmVhdGVDb21wb3VuZEltcG9zdG9yPWZ1bmN0aW9uKHQsaSl7ZS5Ub29scy5XYXJuKFwiU2NlbmUuY3JlYXRlQ29tcG91bmRJbXBvc3RvciBpcyBkZXByZWNhdGVkLiBQbGVhc2UgdXNlIFBoeXNpY3NJbXBvc3RvciBwYXJlbnQvY2hpbGRcIiksdC5wYXJ0cyYmKGk9dCx0PXQucGFydHMpO3ZhciByPXRbMF0ubWVzaDtyLnBoeXNpY3NJbXBvc3Rvcj1uZXcgZS5QaHlzaWNzSW1wb3N0b3Iocix0WzBdLmltcG9zdG9yLGksdGhpcyk7Zm9yKHZhciBuPTE7bjx0Lmxlbmd0aDtuKyspe3ZhciBvPXRbbl0ubWVzaDtvLnBhcmVudCE9PXImJihvLnBvc2l0aW9uPW8ucG9zaXRpb24uc3VidHJhY3Qoci5wb3NpdGlvbiksby5wYXJlbnQ9ciksby5waHlzaWNzSW1wb3N0b3I9bmV3IGUuUGh5c2ljc0ltcG9zdG9yKG8sdFtuXS5pbXBvc3RvcixpLHRoaXMpfXIucGh5c2ljc0ltcG9zdG9yLmZvcmNlVXBkYXRlKCl9LGkucHJvdG90eXBlLmRlbGV0ZUNvbXBvdW5kSW1wb3N0b3I9ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5wYXJ0c1swXS5tZXNoO3QucGh5c2ljc0ltcG9zdG9yLmRpc3Bvc2UoKSx0LnBoeXNpY3NJbXBvc3Rvcj1udWxsfSxpLnByb3RvdHlwZS5jcmVhdGVEZWZhdWx0Q2FtZXJhT3JMaWdodD1mdW5jdGlvbigpe2lmKDA9PT10aGlzLmxpZ2h0cy5sZW5ndGgmJm5ldyBlLkhlbWlzcGhlcmljTGlnaHQoXCJkZWZhdWx0IGxpZ2h0XCIsZS5WZWN0b3IzLlVwKCksdGhpcyksIXRoaXMuYWN0aXZlQ2FtZXJhKXt2YXIgdD1uZXcgZS5GcmVlQ2FtZXJhKFwiZGVmYXVsdCBjYW1lcmFcIixlLlZlY3RvcjMuWmVybygpLHRoaXMpLGk9dGhpcy5nZXRXb3JsZEV4dGVuZHMoKSxyPWkubWluLmFkZChpLm1heC5zdWJ0cmFjdChpLm1pbikuc2NhbGUoLjUpKTt0LnBvc2l0aW9uPW5ldyBlLlZlY3RvcjMoci54LHIueSxpLm1pbi56LShpLm1heC56LWkubWluLnopKSx0LnNldFRhcmdldChyKSx0aGlzLmFjdGl2ZUNhbWVyYT10fX0saS5wcm90b3R5cGUuX2dldEJ5VGFncz1mdW5jdGlvbih0LGkscil7aWYodm9pZCAwPT09aSlyZXR1cm4gdDt2YXIgbj1bXTtyPXJ8fGZ1bmN0aW9uKGUpe307Zm9yKHZhciBvIGluIHQpe3ZhciBzPXRbb107ZS5UYWdzLk1hdGNoZXNRdWVyeShzLGkpJiYobi5wdXNoKHMpLHIocykpfXJldHVybiBufSxpLnByb3RvdHlwZS5nZXRNZXNoZXNCeVRhZ3M9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5fZ2V0QnlUYWdzKHRoaXMubWVzaGVzLGUsdCl9LGkucHJvdG90eXBlLmdldENhbWVyYXNCeVRhZ3M9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5fZ2V0QnlUYWdzKHRoaXMuY2FtZXJhcyxlLHQpfSxpLnByb3RvdHlwZS5nZXRMaWdodHNCeVRhZ3M9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5fZ2V0QnlUYWdzKHRoaXMubGlnaHRzLGUsdCl9LGkucHJvdG90eXBlLmdldE1hdGVyaWFsQnlUYWdzPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuX2dldEJ5VGFncyh0aGlzLm1hdGVyaWFscyxlLHQpLmNvbmNhdCh0aGlzLl9nZXRCeVRhZ3ModGhpcy5tdWx0aU1hdGVyaWFscyxlLHQpKX0saS5fRk9HTU9ERV9OT05FPTAsaS5fRk9HTU9ERV9FWFA9MSxpLl9GT0dNT0RFX0VYUDI9MixpLl9GT0dNT0RFX0xJTkVBUj0zLGkuTWluRGVsdGFUaW1lPTEsaS5NYXhEZWx0YVRpbWU9MWUzLGl9KCk7ZS5TY2VuZT1vfShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCxpLHIsbixvLHMpe3QgaW5zdGFuY2VvZiBlLk1lc2g/dGhpcy5fZW5naW5lPXQuZ2V0U2NlbmUoKS5nZXRFbmdpbmUoKTp0aGlzLl9lbmdpbmU9dCx0aGlzLl91cGRhdGFibGU9cix0aGlzLl9kYXRhPWksdGhpcy5fc3RyaWRlU2l6ZT1uLG98fHRoaXMuY3JlYXRlKCksdGhpcy5faW5zdGFuY2VkPXN9cmV0dXJuIHQucHJvdG90eXBlLmNyZWF0ZVZlcnRleEJ1ZmZlcj1mdW5jdGlvbih0LGkscixuKXtyZXR1cm4gbmV3IGUuVmVydGV4QnVmZmVyKHRoaXMuX2VuZ2luZSx0aGlzLHQsdGhpcy5fdXBkYXRhYmxlLCEwLG4/bjp0aGlzLl9zdHJpZGVTaXplLHRoaXMuX2luc3RhbmNlZCxpLHIpfSx0LnByb3RvdHlwZS5pc1VwZGF0YWJsZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLl91cGRhdGFibGV9LHQucHJvdG90eXBlLmdldERhdGE9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZGF0YX0sdC5wcm90b3R5cGUuZ2V0QnVmZmVyPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2J1ZmZlcn0sdC5wcm90b3R5cGUuZ2V0U3RyaWRlU2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9zdHJpZGVTaXplfSx0LnByb3RvdHlwZS5nZXRJc0luc3RhbmNlZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9pbnN0YW5jZWR9LHQucHJvdG90eXBlLmNyZWF0ZT1mdW5jdGlvbihlKXshZSYmdGhpcy5fYnVmZmVyfHwoZT1lfHx0aGlzLl9kYXRhLHRoaXMuX2J1ZmZlcj90aGlzLl91cGRhdGFibGUmJih0aGlzLl9lbmdpbmUudXBkYXRlRHluYW1pY1ZlcnRleEJ1ZmZlcih0aGlzLl9idWZmZXIsZSksdGhpcy5fZGF0YT1lKTp0aGlzLl91cGRhdGFibGU/KHRoaXMuX2J1ZmZlcj10aGlzLl9lbmdpbmUuY3JlYXRlRHluYW1pY1ZlcnRleEJ1ZmZlcihlKSx0aGlzLl9kYXRhPWUpOnRoaXMuX2J1ZmZlcj10aGlzLl9lbmdpbmUuY3JlYXRlVmVydGV4QnVmZmVyKGUpKX0sdC5wcm90b3R5cGUudXBkYXRlPWZ1bmN0aW9uKGUpe3RoaXMuY3JlYXRlKGUpfSx0LnByb3RvdHlwZS51cGRhdGVEaXJlY3RseT1mdW5jdGlvbihlLHQsaSl7dGhpcy5fYnVmZmVyJiZ0aGlzLl91cGRhdGFibGUmJih0aGlzLl9lbmdpbmUudXBkYXRlRHluYW1pY1ZlcnRleEJ1ZmZlcih0aGlzLl9idWZmZXIsZSx0LGk/aSp0aGlzLmdldFN0cmlkZVNpemUoKTp2b2lkIDApLHRoaXMuX2RhdGE9bnVsbCl9LHQucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXt0aGlzLl9idWZmZXImJnRoaXMuX2VuZ2luZS5fcmVsZWFzZUJ1ZmZlcih0aGlzLl9idWZmZXIpJiYodGhpcy5fYnVmZmVyPW51bGwpfSx0fSgpO2UuQnVmZmVyPXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdChpLHIsbixvLHMsYSxoLGMsbCl7aWYoIWEpc3dpdGNoKG4pe2Nhc2UgdC5Qb3NpdGlvbktpbmQ6YT0zO2JyZWFrO2Nhc2UgdC5Ob3JtYWxLaW5kOmE9MzticmVhaztjYXNlIHQuVVZLaW5kOmNhc2UgdC5VVjJLaW5kOmNhc2UgdC5VVjNLaW5kOmNhc2UgdC5VVjRLaW5kOmNhc2UgdC5VVjVLaW5kOmNhc2UgdC5VVjZLaW5kOmE9MjticmVhaztjYXNlIHQuQ29sb3JLaW5kOmE9NDticmVhaztjYXNlIHQuTWF0cmljZXNJbmRpY2VzS2luZDpjYXNlIHQuTWF0cmljZXNJbmRpY2VzRXh0cmFLaW5kOmE9NDticmVhaztjYXNlIHQuTWF0cmljZXNXZWlnaHRzS2luZDpjYXNlIHQuTWF0cmljZXNXZWlnaHRzRXh0cmFLaW5kOmE9NH1yIGluc3RhbmNlb2YgZS5CdWZmZXI/KGF8fChhPXIuZ2V0U3RyaWRlU2l6ZSgpKSx0aGlzLl9idWZmZXI9cix0aGlzLl9vd25zQnVmZmVyPSExKToodGhpcy5fYnVmZmVyPW5ldyBlLkJ1ZmZlcihpLHIsbyxhLHMsaCksdGhpcy5fb3duc0J1ZmZlcj0hMCksdGhpcy5fc3RyaWRlPWEsdGhpcy5fb2Zmc2V0PWM/YzowLHRoaXMuX3NpemU9bD9sOmEsdGhpcy5fa2luZD1ufXJldHVybiB0LnByb3RvdHlwZS5nZXRLaW5kPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2tpbmR9LHQucHJvdG90eXBlLmlzVXBkYXRhYmxlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2J1ZmZlci5pc1VwZGF0YWJsZSgpfSx0LnByb3RvdHlwZS5nZXREYXRhPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2J1ZmZlci5nZXREYXRhKCl9LHQucHJvdG90eXBlLmdldEJ1ZmZlcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9idWZmZXIuZ2V0QnVmZmVyKCl9LHQucHJvdG90eXBlLmdldFN0cmlkZVNpemU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc3RyaWRlfSx0LnByb3RvdHlwZS5nZXRPZmZzZXQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fb2Zmc2V0fSx0LnByb3RvdHlwZS5nZXRTaXplPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3NpemV9LHQucHJvdG90eXBlLmdldElzSW5zdGFuY2VkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2J1ZmZlci5nZXRJc0luc3RhbmNlZCgpfSx0LnByb3RvdHlwZS5jcmVhdGU9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2J1ZmZlci5jcmVhdGUoZSl9LHQucHJvdG90eXBlLnVwZGF0ZT1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fYnVmZmVyLnVwZGF0ZShlKX0sdC5wcm90b3R5cGUudXBkYXRlRGlyZWN0bHk9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5fYnVmZmVyLnVwZGF0ZURpcmVjdGx5KGUsdCl9LHQucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXt0aGlzLl9vd25zQnVmZmVyJiZ0aGlzLl9idWZmZXIuZGlzcG9zZSgpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIlBvc2l0aW9uS2luZFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdC5fUG9zaXRpb25LaW5kfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiTm9ybWFsS2luZFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdC5fTm9ybWFsS2luZH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIlVWS2luZFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdC5fVVZLaW5kfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiVVYyS2luZFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdC5fVVYyS2luZH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIlVWM0tpbmRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHQuX1VWM0tpbmR9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJVVjRLaW5kXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0Ll9VVjRLaW5kfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiVVY1S2luZFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdC5fVVY1S2luZH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIlVWNktpbmRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHQuX1VWNktpbmR9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJDb2xvcktpbmRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHQuX0NvbG9yS2luZH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIk1hdHJpY2VzSW5kaWNlc0tpbmRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHQuX01hdHJpY2VzSW5kaWNlc0tpbmR9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJNYXRyaWNlc1dlaWdodHNLaW5kXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0Ll9NYXRyaWNlc1dlaWdodHNLaW5kfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiTWF0cmljZXNJbmRpY2VzRXh0cmFLaW5kXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0Ll9NYXRyaWNlc0luZGljZXNFeHRyYUtpbmR9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJNYXRyaWNlc1dlaWdodHNFeHRyYUtpbmRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHQuX01hdHJpY2VzV2VpZ2h0c0V4dHJhS2luZH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSx0Ll9Qb3NpdGlvbktpbmQ9XCJwb3NpdGlvblwiLHQuX05vcm1hbEtpbmQ9XCJub3JtYWxcIix0Ll9VVktpbmQ9XCJ1dlwiLHQuX1VWMktpbmQ9XCJ1djJcIix0Ll9VVjNLaW5kPVwidXYzXCIsdC5fVVY0S2luZD1cInV2NFwiLHQuX1VWNUtpbmQ9XCJ1djVcIix0Ll9VVjZLaW5kPVwidXY2XCIsdC5fQ29sb3JLaW5kPVwiY29sb3JcIix0Ll9NYXRyaWNlc0luZGljZXNLaW5kPVwibWF0cmljZXNJbmRpY2VzXCIsdC5fTWF0cmljZXNXZWlnaHRzS2luZD1cIm1hdHJpY2VzV2VpZ2h0c1wiLHQuX01hdHJpY2VzSW5kaWNlc0V4dHJhS2luZD1cIm1hdHJpY2VzSW5kaWNlc0V4dHJhXCIsdC5fTWF0cmljZXNXZWlnaHRzRXh0cmFLaW5kPVwibWF0cmljZXNXZWlnaHRzRXh0cmFcIix0fSgpO2UuVmVydGV4QnVmZmVyPXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGkoZSxpKXt0LmNhbGwodGhpcyxlLGkuZ2V0U2NlbmUoKSksaS5pbnN0YW5jZXMucHVzaCh0aGlzKSx0aGlzLl9zb3VyY2VNZXNoPWksdGhpcy5wb3NpdGlvbi5jb3B5RnJvbShpLnBvc2l0aW9uKSx0aGlzLnJvdGF0aW9uLmNvcHlGcm9tKGkucm90YXRpb24pLHRoaXMuc2NhbGluZy5jb3B5RnJvbShpLnNjYWxpbmcpLGkucm90YXRpb25RdWF0ZXJuaW9uJiYodGhpcy5yb3RhdGlvblF1YXRlcm5pb249aS5yb3RhdGlvblF1YXRlcm5pb24uY2xvbmUoKSksdGhpcy5pbmZpbml0ZURpc3RhbmNlPWkuaW5maW5pdGVEaXN0YW5jZSx0aGlzLnNldFBpdm90TWF0cml4KGkuZ2V0UGl2b3RNYXRyaXgoKSksdGhpcy5yZWZyZXNoQm91bmRpbmdJbmZvKCksdGhpcy5fc3luY1N1Yk1lc2hlcygpfXJldHVybiBfX2V4dGVuZHMoaSx0KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJyZWNlaXZlU2hhZG93c1wiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc291cmNlTWVzaC5yZWNlaXZlU2hhZG93c30sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJtYXRlcmlhbFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc291cmNlTWVzaC5tYXRlcmlhbH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJ2aXNpYmlsaXR5XCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9zb3VyY2VNZXNoLnZpc2liaWxpdHl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGkucHJvdG90eXBlLFwic2tlbGV0b25cIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3NvdXJjZU1lc2guc2tlbGV0b259LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGkucHJvdG90eXBlLFwicmVuZGVyaW5nR3JvdXBJZFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc291cmNlTWVzaC5yZW5kZXJpbmdHcm91cElkfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLGkucHJvdG90eXBlLmdldFRvdGFsVmVydGljZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc291cmNlTWVzaC5nZXRUb3RhbFZlcnRpY2VzKCl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcInNvdXJjZU1lc2hcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3NvdXJjZU1lc2h9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksaS5wcm90b3R5cGUuZ2V0VmVydGljZXNEYXRhPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuX3NvdXJjZU1lc2guZ2V0VmVydGljZXNEYXRhKGUsdCl9LGkucHJvdG90eXBlLmlzVmVydGljZXNEYXRhUHJlc2VudD1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fc291cmNlTWVzaC5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZSl9LGkucHJvdG90eXBlLmdldEluZGljZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc291cmNlTWVzaC5nZXRJbmRpY2VzKCl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcIl9wb3NpdGlvbnNcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3NvdXJjZU1lc2guX3Bvc2l0aW9uc30sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxpLnByb3RvdHlwZS5yZWZyZXNoQm91bmRpbmdJbmZvPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5fc291cmNlTWVzaC5nZXRCb3VuZGluZ0luZm8oKTt0aGlzLl9ib3VuZGluZ0luZm89bmV3IGUuQm91bmRpbmdJbmZvKHQubWluaW11bS5jbG9uZSgpLHQubWF4aW11bS5jbG9uZSgpKSx0aGlzLl91cGRhdGVCb3VuZGluZ0luZm8oKX0saS5wcm90b3R5cGUuX3ByZUFjdGl2YXRlPWZ1bmN0aW9uKCl7dGhpcy5fY3VycmVudExPRCYmdGhpcy5fY3VycmVudExPRC5fcHJlQWN0aXZhdGUoKX0saS5wcm90b3R5cGUuX2FjdGl2YXRlPWZ1bmN0aW9uKGUpe3RoaXMuX2N1cnJlbnRMT0QmJnRoaXMuX2N1cnJlbnRMT0QuX3JlZ2lzdGVySW5zdGFuY2VGb3JSZW5kZXJJZCh0aGlzLGUpfSxpLnByb3RvdHlwZS5nZXRMT0Q9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2N1cnJlbnRMT0Q9dGhpcy5zb3VyY2VNZXNoLmdldExPRCh0aGlzLmdldFNjZW5lKCkuYWN0aXZlQ2FtZXJhLHRoaXMuZ2V0Qm91bmRpbmdJbmZvKCkuYm91bmRpbmdTcGhlcmUpLHRoaXMuX2N1cnJlbnRMT0Q9PT10aGlzLnNvdXJjZU1lc2g/dGhpczp0aGlzLl9jdXJyZW50TE9EfSxpLnByb3RvdHlwZS5fc3luY1N1Yk1lc2hlcz1mdW5jdGlvbigpe2lmKHRoaXMucmVsZWFzZVN1Yk1lc2hlcygpLHRoaXMuX3NvdXJjZU1lc2guc3ViTWVzaGVzKWZvcih2YXIgZT0wO2U8dGhpcy5fc291cmNlTWVzaC5zdWJNZXNoZXMubGVuZ3RoO2UrKyl0aGlzLl9zb3VyY2VNZXNoLnN1Yk1lc2hlc1tlXS5jbG9uZSh0aGlzLHRoaXMuX3NvdXJjZU1lc2gpfSxpLnByb3RvdHlwZS5fZ2VuZXJhdGVQb2ludHNBcnJheT1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9zb3VyY2VNZXNoLl9nZW5lcmF0ZVBvaW50c0FycmF5KCl9LGkucHJvdG90eXBlLmNsb25lPWZ1bmN0aW9uKHQsaSxyKXt2YXIgbj10aGlzLl9zb3VyY2VNZXNoLmNyZWF0ZUluc3RhbmNlKHQpO2lmKGUuVG9vbHMuRGVlcENvcHkodGhpcyxuLFtcIm5hbWVcIixcInN1Yk1lc2hlc1wiXSxbXSksdGhpcy5yZWZyZXNoQm91bmRpbmdJbmZvKCksaSYmKG4ucGFyZW50PWkpLCFyKWZvcih2YXIgbz0wO288dGhpcy5nZXRTY2VuZSgpLm1lc2hlcy5sZW5ndGg7bysrKXt2YXIgcz10aGlzLmdldFNjZW5lKCkubWVzaGVzW29dO3MucGFyZW50PT09dGhpcyYmcy5jbG9uZShzLm5hbWUsbil9cmV0dXJuIG4uY29tcHV0ZVdvcmxkTWF0cml4KCEwKSxufSxpLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKGUpe3ZhciBpPXRoaXMuX3NvdXJjZU1lc2guaW5zdGFuY2VzLmluZGV4T2YodGhpcyk7dGhpcy5fc291cmNlTWVzaC5pbnN0YW5jZXMuc3BsaWNlKGksMSksdC5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMsZSl9LGl9KGUuQWJzdHJhY3RNZXNoKTtlLkluc3RhbmNlZE1lc2g9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7dGhpcy5tdXN0UmV0dXJuPSExLHRoaXMudmlzaWJsZUluc3RhbmNlcz1uZXcgQXJyYXksdGhpcy5yZW5kZXJTZWxmPW5ldyBBcnJheX1yZXR1cm4gZX0oKTtlLl9JbnN0YW5jZXNCYXRjaD10O3ZhciBpPWZ1bmN0aW9uKGkpe2Z1bmN0aW9uIHIobixvLHMsYSxoLGMpe2lmKHZvaWQgMD09PXMmJihzPW51bGwpLHZvaWQgMD09PWMmJihjPSEwKSxpLmNhbGwodGhpcyxuLG8pLHRoaXMub25CZWZvcmVSZW5kZXJPYnNlcnZhYmxlPW5ldyBlLk9ic2VydmFibGUsdGhpcy5vbkFmdGVyUmVuZGVyT2JzZXJ2YWJsZT1uZXcgZS5PYnNlcnZhYmxlLHRoaXMub25CZWZvcmVEcmF3T2JzZXJ2YWJsZT1uZXcgZS5PYnNlcnZhYmxlLHRoaXMuZGVsYXlMb2FkU3RhdGU9ZS5FbmdpbmUuREVMQVlMT0FEU1RBVEVfTk9ORSx0aGlzLmluc3RhbmNlcz1uZXcgQXJyYXksdGhpcy5fTE9ETGV2ZWxzPW5ldyBBcnJheSx0aGlzLl92aXNpYmxlSW5zdGFuY2VzPXt9LHRoaXMuX3JlbmRlcklkRm9ySW5zdGFuY2VzPW5ldyBBcnJheSx0aGlzLl9iYXRjaENhY2hlPW5ldyB0LHRoaXMuX2luc3RhbmNlc0J1ZmZlclNpemU9MjA0OCx0aGlzLl9zaWRlT3JpZW50YXRpb249ci5fREVGQVVMVFNJREUsdGhpcy5fYXJlTm9ybWFsc0Zyb3plbj0hMSxhKXthLl9nZW9tZXRyeSYmYS5fZ2VvbWV0cnkuYXBwbHlUb01lc2godGhpcyksZS5Ub29scy5EZWVwQ29weShhLHRoaXMsW1wibmFtZVwiLFwibWF0ZXJpYWxcIixcInNrZWxldG9uXCIsXCJpbnN0YW5jZXNcIl0sW1wiX3Bvc2VNYXRyaXhcIl0pLHRoaXMuc2V0UGl2b3RNYXRyaXgoYS5nZXRQaXZvdE1hdHJpeCgpKSx0aGlzLmlkPW4rXCIuXCIrYS5pZCx0aGlzLm1hdGVyaWFsPWEubWF0ZXJpYWw7dmFyIGw7aWYoIWgpZm9yKGw9MDtsPG8ubWVzaGVzLmxlbmd0aDtsKyspe3ZhciB1PW8ubWVzaGVzW2xdO2lmKHUucGFyZW50PT09YSl7dS5jbG9uZShuK1wiLlwiK3UubmFtZSx0aGlzLGgpfX12YXIgZj10aGlzLmdldFNjZW5lKCkuZ2V0UGh5c2ljc0VuZ2luZSgpO2lmKGMmJmYpe3ZhciBkPWYuZ2V0SW1wb3N0b3JGb3JQaHlzaWNzT2JqZWN0KGEpO2QmJih0aGlzLnBoeXNpY3NJbXBvc3Rvcj1kLmNsb25lKHRoaXMpKX1mb3IobD0wO2w8by5wYXJ0aWNsZVN5c3RlbXMubGVuZ3RoO2wrKyl7dmFyIHA9by5wYXJ0aWNsZVN5c3RlbXNbbF07cC5lbWl0dGVyPT09YSYmcC5jbG9uZShwLm5hbWUsdGhpcyl9dGhpcy5jb21wdXRlV29ybGRNYXRyaXgoITApfW51bGwhPT1zJiYodGhpcy5wYXJlbnQ9cyl9cmV0dXJuIF9fZXh0ZW5kcyhyLGkpLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLFwiRlJPTlRTSURFXCIse2dldDpmdW5jdGlvbigpe3JldHVybiByLl9GUk9OVFNJREV9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHIsXCJCQUNLU0lERVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gci5fQkFDS1NJREV9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHIsXCJET1VCTEVTSURFXCIse2dldDpmdW5jdGlvbigpe3JldHVybiByLl9ET1VCTEVTSURFfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLFwiREVGQVVMVFNJREVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHIuX0RFRkFVTFRTSURFfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLFwiTk9fQ0FQXCIse2dldDpmdW5jdGlvbigpe3JldHVybiByLl9OT19DQVB9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHIsXCJDQVBfU1RBUlRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHIuX0NBUF9TVEFSVH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocixcIkNBUF9FTkRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHIuX0NBUF9FTkR9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHIsXCJDQVBfQUxMXCIse2dldDpmdW5jdGlvbigpe3JldHVybiByLl9DQVBfQUxMfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLnByb3RvdHlwZSxcIm9uQmVmb3JlRHJhd1wiLHtzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fb25CZWZvcmVEcmF3T2JzZXJ2ZXImJnRoaXMub25CZWZvcmVEcmF3T2JzZXJ2YWJsZS5yZW1vdmUodGhpcy5fb25CZWZvcmVEcmF3T2JzZXJ2ZXIpLHRoaXMuX29uQmVmb3JlRHJhd09ic2VydmVyPXRoaXMub25CZWZvcmVEcmF3T2JzZXJ2YWJsZS5hZGQoZSl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksci5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24odCl7dmFyIHI9aS5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0aGlzLHQpO2lmKHIrPVwiLCBuIHZlcnRpY2VzOiBcIit0aGlzLmdldFRvdGFsVmVydGljZXMoKSxyKz1cIiwgcGFyZW50OiBcIisodGhpcy5fd2FpdGluZ1BhcmVudElkP3RoaXMuX3dhaXRpbmdQYXJlbnRJZDp0aGlzLnBhcmVudD90aGlzLnBhcmVudC5uYW1lOlwiTk9ORVwiKSx0aGlzLmFuaW1hdGlvbnMpZm9yKHZhciBuPTA7bjx0aGlzLmFuaW1hdGlvbnMubGVuZ3RoO24rKylyKz1cIiwgYW5pbWF0aW9uWzBdOiBcIit0aGlzLmFuaW1hdGlvbnNbbl0udG9TdHJpbmcodCk7cmV0dXJuIHQmJihyKz1cIiwgZmxhdCBzaGFkaW5nOiBcIisodGhpcy5fZ2VvbWV0cnk/dGhpcy5nZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuUG9zaXRpb25LaW5kKS5sZW5ndGgvMz09PXRoaXMuZ2V0SW5kaWNlcygpLmxlbmd0aD9cIllFU1wiOlwiTk9cIjpcIlVOS05PV05cIikpLHJ9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLnByb3RvdHlwZSxcImhhc0xPRExldmVsc1wiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fTE9ETGV2ZWxzLmxlbmd0aD4wfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLHIucHJvdG90eXBlLl9zb3J0TE9ETGV2ZWxzPWZ1bmN0aW9uKCl7dGhpcy5fTE9ETGV2ZWxzLnNvcnQoZnVuY3Rpb24oZSx0KXtyZXR1cm4gZS5kaXN0YW5jZTx0LmRpc3RhbmNlPzE6ZS5kaXN0YW5jZT50LmRpc3RhbmNlPy0xOjB9KX0sci5wcm90b3R5cGUuYWRkTE9ETGV2ZWw9ZnVuY3Rpb24odCxpKXtpZihpJiZpLl9tYXN0ZXJNZXNoKXJldHVybiBlLlRvb2xzLldhcm4oXCJZb3UgY2Fubm90IHVzZSBhIG1lc2ggYXMgTE9EIGxldmVsIHR3aWNlXCIpLHRoaXM7dmFyIHI9bmV3IGUuSW50ZXJuYWxzLk1lc2hMT0RMZXZlbCh0LGkpO3JldHVybiB0aGlzLl9MT0RMZXZlbHMucHVzaChyKSxpJiYoaS5fbWFzdGVyTWVzaD10aGlzKSx0aGlzLl9zb3J0TE9ETGV2ZWxzKCksdGhpc30sci5wcm90b3R5cGUuZ2V0TE9ETGV2ZWxBdERpc3RhbmNlPWZ1bmN0aW9uKGUpe2Zvcih2YXIgdD0wO3Q8dGhpcy5fTE9ETGV2ZWxzLmxlbmd0aDt0Kyspe3ZhciBpPXRoaXMuX0xPRExldmVsc1t0XTtpZihpLmRpc3RhbmNlPT09ZSlyZXR1cm4gaS5tZXNofXJldHVybiBudWxsfSxyLnByb3RvdHlwZS5yZW1vdmVMT0RMZXZlbD1mdW5jdGlvbihlKXtmb3IodmFyIHQ9MDt0PHRoaXMuX0xPRExldmVscy5sZW5ndGg7dCsrKXRoaXMuX0xPRExldmVsc1t0XS5tZXNoPT09ZSYmKHRoaXMuX0xPRExldmVscy5zcGxpY2UodCwxKSxlJiYoZS5fbWFzdGVyTWVzaD1udWxsKSk7cmV0dXJuIHRoaXMuX3NvcnRMT0RMZXZlbHMoKSx0aGlzfSxyLnByb3RvdHlwZS5nZXRMT0Q9ZnVuY3Rpb24oZSx0KXtpZighdGhpcy5fTE9ETGV2ZWxzfHwwPT09dGhpcy5fTE9ETGV2ZWxzLmxlbmd0aClyZXR1cm4gdGhpczt2YXIgaT0odD90OnRoaXMuZ2V0Qm91bmRpbmdJbmZvKCkuYm91bmRpbmdTcGhlcmUpLmNlbnRlcldvcmxkLnN1YnRyYWN0KGUuZ2xvYmFsUG9zaXRpb24pLmxlbmd0aCgpO2lmKHRoaXMuX0xPRExldmVsc1t0aGlzLl9MT0RMZXZlbHMubGVuZ3RoLTFdLmRpc3RhbmNlPmkpcmV0dXJuIHRoaXMub25MT0RMZXZlbFNlbGVjdGlvbiYmdGhpcy5vbkxPRExldmVsU2VsZWN0aW9uKGksdGhpcyx0aGlzLl9MT0RMZXZlbHNbdGhpcy5fTE9ETGV2ZWxzLmxlbmd0aC0xXS5tZXNoKSx0aGlzO2Zvcih2YXIgcj0wO3I8dGhpcy5fTE9ETGV2ZWxzLmxlbmd0aDtyKyspe3ZhciBuPXRoaXMuX0xPRExldmVsc1tyXTtpZihuLmRpc3RhbmNlPGkpcmV0dXJuIG4ubWVzaCYmKG4ubWVzaC5fcHJlQWN0aXZhdGUoKSxuLm1lc2guX3VwZGF0ZVN1Yk1lc2hlc0JvdW5kaW5nSW5mbyh0aGlzLndvcmxkTWF0cml4RnJvbUNhY2hlKSksdGhpcy5vbkxPRExldmVsU2VsZWN0aW9uJiZ0aGlzLm9uTE9ETGV2ZWxTZWxlY3Rpb24oaSx0aGlzLG4ubWVzaCksbi5tZXNofXJldHVybiB0aGlzLm9uTE9ETGV2ZWxTZWxlY3Rpb24mJnRoaXMub25MT0RMZXZlbFNlbGVjdGlvbihpLHRoaXMsdGhpcyksdGhpc30sT2JqZWN0LmRlZmluZVByb3BlcnR5KHIucHJvdG90eXBlLFwiZ2VvbWV0cnlcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2dlb21ldHJ5fSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLHIucHJvdG90eXBlLmdldFRvdGFsVmVydGljZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZ2VvbWV0cnk/dGhpcy5fZ2VvbWV0cnkuZ2V0VG90YWxWZXJ0aWNlcygpOjB9LHIucHJvdG90eXBlLmdldFZlcnRpY2VzRGF0YT1mdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLl9nZW9tZXRyeT90aGlzLl9nZW9tZXRyeS5nZXRWZXJ0aWNlc0RhdGEoZSx0KTpudWxsfSxyLnByb3RvdHlwZS5nZXRWZXJ0ZXhCdWZmZXI9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2dlb21ldHJ5P3RoaXMuX2dlb21ldHJ5LmdldFZlcnRleEJ1ZmZlcihlKTp2b2lkIDB9LHIucHJvdG90eXBlLmlzVmVydGljZXNEYXRhUHJlc2VudD1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fZ2VvbWV0cnk/dGhpcy5fZ2VvbWV0cnkuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGUpOnRoaXMuX2RlbGF5SW5mbz8tMSE9PXRoaXMuX2RlbGF5SW5mby5pbmRleE9mKGUpOiExfSxyLnByb3RvdHlwZS5nZXRWZXJ0aWNlc0RhdGFLaW5kcz1mdW5jdGlvbigpe2lmKCF0aGlzLl9nZW9tZXRyeSl7dmFyIGU9W107aWYodGhpcy5fZGVsYXlJbmZvKWZvcih2YXIgdCBpbiB0aGlzLl9kZWxheUluZm8pZS5wdXNoKHQpO3JldHVybiBlfXJldHVybiB0aGlzLl9nZW9tZXRyeS5nZXRWZXJ0aWNlc0RhdGFLaW5kcygpfSxyLnByb3RvdHlwZS5nZXRUb3RhbEluZGljZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZ2VvbWV0cnk/dGhpcy5fZ2VvbWV0cnkuZ2V0VG90YWxJbmRpY2VzKCk6MH0sci5wcm90b3R5cGUuZ2V0SW5kaWNlcz1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fZ2VvbWV0cnk/dGhpcy5fZ2VvbWV0cnkuZ2V0SW5kaWNlcyhlKTpbXX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KHIucHJvdG90eXBlLFwiaXNCbG9ja2VkXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBudWxsIT09dGhpcy5fbWFzdGVyTWVzaCYmdm9pZCAwIT09dGhpcy5fbWFzdGVyTWVzaDtcbn0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxyLnByb3RvdHlwZS5pc1JlYWR5PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGVsYXlMb2FkU3RhdGU9PT1lLkVuZ2luZS5ERUxBWUxPQURTVEFURV9MT0FESU5HPyExOmkucHJvdG90eXBlLmlzUmVhZHkuY2FsbCh0aGlzKX0sci5wcm90b3R5cGUuaXNEaXNwb3NlZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9pc0Rpc3Bvc2VkfSxPYmplY3QuZGVmaW5lUHJvcGVydHkoci5wcm90b3R5cGUsXCJzaWRlT3JpZW50YXRpb25cIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3NpZGVPcmllbnRhdGlvbn0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX3NpZGVPcmllbnRhdGlvbj1lfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLnByb3RvdHlwZSxcImFyZU5vcm1hbHNGcm96ZW5cIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2FyZU5vcm1hbHNGcm96ZW59LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksci5wcm90b3R5cGUuZnJlZXplTm9ybWFscz1mdW5jdGlvbigpe3RoaXMuX2FyZU5vcm1hbHNGcm96ZW49ITB9LHIucHJvdG90eXBlLnVuZnJlZXplTm9ybWFscz1mdW5jdGlvbigpe3RoaXMuX2FyZU5vcm1hbHNGcm96ZW49ITF9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLnByb3RvdHlwZSxcIm92ZXJyaWRlbkluc3RhbmNlQ291bnRcIix7c2V0OmZ1bmN0aW9uKGUpe3RoaXMuX292ZXJyaWRlbkluc3RhbmNlQ291bnQ9ZX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxyLnByb3RvdHlwZS5fcHJlQWN0aXZhdGU9ZnVuY3Rpb24oKXt2YXIgZT10aGlzLmdldFNjZW5lKCkuZ2V0UmVuZGVySWQoKTt0aGlzLl9wcmVBY3RpdmF0ZUlkIT09ZSYmKHRoaXMuX3ByZUFjdGl2YXRlSWQ9ZSx0aGlzLl92aXNpYmxlSW5zdGFuY2VzPW51bGwpfSxyLnByb3RvdHlwZS5fcHJlQWN0aXZhdGVGb3JJbnRlcm1lZGlhdGVSZW5kZXJpbmc9ZnVuY3Rpb24oZSl7dGhpcy5fdmlzaWJsZUluc3RhbmNlcyYmKHRoaXMuX3Zpc2libGVJbnN0YW5jZXMuaW50ZXJtZWRpYXRlRGVmYXVsdFJlbmRlcklkPWUpfSxyLnByb3RvdHlwZS5fcmVnaXN0ZXJJbnN0YW5jZUZvclJlbmRlcklkPWZ1bmN0aW9uKGUsdCl7dGhpcy5fdmlzaWJsZUluc3RhbmNlc3x8KHRoaXMuX3Zpc2libGVJbnN0YW5jZXM9e30sdGhpcy5fdmlzaWJsZUluc3RhbmNlcy5kZWZhdWx0UmVuZGVySWQ9dCx0aGlzLl92aXNpYmxlSW5zdGFuY2VzLnNlbGZEZWZhdWx0UmVuZGVySWQ9dGhpcy5fcmVuZGVySWQpLHRoaXMuX3Zpc2libGVJbnN0YW5jZXNbdF18fCh0aGlzLl92aXNpYmxlSW5zdGFuY2VzW3RdPW5ldyBBcnJheSksdGhpcy5fdmlzaWJsZUluc3RhbmNlc1t0XS5wdXNoKGUpfSxyLnByb3RvdHlwZS5yZWZyZXNoQm91bmRpbmdJbmZvPWZ1bmN0aW9uKCl7aWYoIXRoaXMuX2JvdW5kaW5nSW5mby5pc0xvY2tlZCl7dmFyIHQ9dGhpcy5nZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuUG9zaXRpb25LaW5kKTtpZih0KXt2YXIgaT1lLlRvb2xzLkV4dHJhY3RNaW5BbmRNYXgodCwwLHRoaXMuZ2V0VG90YWxWZXJ0aWNlcygpKTt0aGlzLl9ib3VuZGluZ0luZm89bmV3IGUuQm91bmRpbmdJbmZvKGkubWluaW11bSxpLm1heGltdW0pfWlmKHRoaXMuc3ViTWVzaGVzKWZvcih2YXIgcj0wO3I8dGhpcy5zdWJNZXNoZXMubGVuZ3RoO3IrKyl0aGlzLnN1Yk1lc2hlc1tyXS5yZWZyZXNoQm91bmRpbmdJbmZvKCk7dGhpcy5fdXBkYXRlQm91bmRpbmdJbmZvKCl9fSxyLnByb3RvdHlwZS5fY3JlYXRlR2xvYmFsU3ViTWVzaD1mdW5jdGlvbigpe3ZhciB0PXRoaXMuZ2V0VG90YWxWZXJ0aWNlcygpO3JldHVybiB0JiZ0aGlzLmdldEluZGljZXMoKT8odGhpcy5yZWxlYXNlU3ViTWVzaGVzKCksbmV3IGUuU3ViTWVzaCgwLDAsdCwwLHRoaXMuZ2V0VG90YWxJbmRpY2VzKCksdGhpcykpOm51bGx9LHIucHJvdG90eXBlLnN1YmRpdmlkZT1mdW5jdGlvbih0KXtpZighKDE+dCkpe2Zvcih2YXIgaT10aGlzLmdldFRvdGFsSW5kaWNlcygpLHI9aS90fDAsbj0wO3IlMyE9PTA7KXIrKzt0aGlzLnJlbGVhc2VTdWJNZXNoZXMoKTtmb3IodmFyIG89MDt0Pm8mJiEobj49aSk7bysrKWUuU3ViTWVzaC5DcmVhdGVGcm9tSW5kaWNlcygwLG4sTWF0aC5taW4ocixpLW4pLHRoaXMpLG4rPXI7dGhpcy5zeW5jaHJvbml6ZUluc3RhbmNlcygpfX0sci5wcm90b3R5cGUuc2V0VmVydGljZXNEYXRhPWZ1bmN0aW9uKHQsaSxyLG4pe2lmKHRoaXMuX2dlb21ldHJ5KXRoaXMuX2dlb21ldHJ5LnNldFZlcnRpY2VzRGF0YSh0LGkscixuKTtlbHNle3ZhciBvPW5ldyBlLlZlcnRleERhdGE7by5zZXQoaSx0KTt2YXIgcz10aGlzLmdldFNjZW5lKCk7bmV3IGUuR2VvbWV0cnkoZS5HZW9tZXRyeS5SYW5kb21JZCgpLHMsbyxyLHRoaXMpfX0sci5wcm90b3R5cGUuc2V0VmVydGljZXNCdWZmZXI9ZnVuY3Rpb24odCl7aWYoIXRoaXMuX2dlb21ldHJ5KXt2YXIgaT10aGlzLmdldFNjZW5lKCk7bmV3IGUuR2VvbWV0cnkoZS5HZW9tZXRyeS5SYW5kb21JZCgpLGkpLmFwcGx5VG9NZXNoKHRoaXMpfXRoaXMuX2dlb21ldHJ5LnNldFZlcnRpY2VzQnVmZmVyKHQpfSxyLnByb3RvdHlwZS51cGRhdGVWZXJ0aWNlc0RhdGE9ZnVuY3Rpb24oZSx0LGkscil7dGhpcy5fZ2VvbWV0cnkmJihyPyh0aGlzLm1ha2VHZW9tZXRyeVVuaXF1ZSgpLHRoaXMudXBkYXRlVmVydGljZXNEYXRhKGUsdCxpLCExKSk6dGhpcy5fZ2VvbWV0cnkudXBkYXRlVmVydGljZXNEYXRhKGUsdCxpKSl9LHIucHJvdG90eXBlLnVwZGF0ZVZlcnRpY2VzRGF0YURpcmVjdGx5PWZ1bmN0aW9uKHQsaSxyLG4pe2UuVG9vbHMuV2FybihcIk1lc2gudXBkYXRlVmVydGljZXNEYXRhRGlyZWN0bHkgZGVwcmVjYXRlZCBzaW5jZSAyLjMuXCIpLHRoaXMuX2dlb21ldHJ5JiYobj8odGhpcy5tYWtlR2VvbWV0cnlVbmlxdWUoKSx0aGlzLnVwZGF0ZVZlcnRpY2VzRGF0YURpcmVjdGx5KHQsaSxyLCExKSk6dGhpcy5fZ2VvbWV0cnkudXBkYXRlVmVydGljZXNEYXRhRGlyZWN0bHkodCxpLHIpKX0sci5wcm90b3R5cGUudXBkYXRlTWVzaFBvc2l0aW9ucz1mdW5jdGlvbih0LGkpe3ZvaWQgMD09PWkmJihpPSEwKTt2YXIgcj10aGlzLmdldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5Qb3NpdGlvbktpbmQpO2lmKHQociksdGhpcy51cGRhdGVWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuUG9zaXRpb25LaW5kLHIsITEsITEpLGkpe3ZhciBuPXRoaXMuZ2V0SW5kaWNlcygpLG89dGhpcy5nZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuTm9ybWFsS2luZCk7ZS5WZXJ0ZXhEYXRhLkNvbXB1dGVOb3JtYWxzKHIsbixvKSx0aGlzLnVwZGF0ZVZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5Ob3JtYWxLaW5kLG8sITEsITEpfX0sci5wcm90b3R5cGUubWFrZUdlb21ldHJ5VW5pcXVlPWZ1bmN0aW9uKCl7aWYodGhpcy5fZ2VvbWV0cnkpe3ZhciB0PXRoaXMuX2dlb21ldHJ5LmNvcHkoZS5HZW9tZXRyeS5SYW5kb21JZCgpKTt0LmFwcGx5VG9NZXNoKHRoaXMpfX0sci5wcm90b3R5cGUuc2V0SW5kaWNlcz1mdW5jdGlvbih0LGkpe2lmKHRoaXMuX2dlb21ldHJ5KXRoaXMuX2dlb21ldHJ5LnNldEluZGljZXModCxpKTtlbHNle3ZhciByPW5ldyBlLlZlcnRleERhdGE7ci5pbmRpY2VzPXQ7dmFyIG49dGhpcy5nZXRTY2VuZSgpO25ldyBlLkdlb21ldHJ5KGUuR2VvbWV0cnkuUmFuZG9tSWQoKSxuLHIsITEsdGhpcyl9fSxyLnByb3RvdHlwZS50b0xlZnRIYW5kZWQ9ZnVuY3Rpb24oKXt0aGlzLl9nZW9tZXRyeSYmdGhpcy5fZ2VvbWV0cnkudG9MZWZ0SGFuZGVkKCl9LHIucHJvdG90eXBlLl9iaW5kPWZ1bmN0aW9uKHQsaSxyKXt2YXIgbixvPXRoaXMuZ2V0U2NlbmUoKS5nZXRFbmdpbmUoKTtpZih0aGlzLl91bkluZGV4ZWQpbj1udWxsO2Vsc2Ugc3dpdGNoKHIpe2Nhc2UgZS5NYXRlcmlhbC5Qb2ludEZpbGxNb2RlOm49bnVsbDticmVhaztjYXNlIGUuTWF0ZXJpYWwuV2lyZUZyYW1lRmlsbE1vZGU6bj10LmdldExpbmVzSW5kZXhCdWZmZXIodGhpcy5nZXRJbmRpY2VzKCksbyk7YnJlYWs7ZGVmYXVsdDpjYXNlIGUuTWF0ZXJpYWwuVHJpYW5nbGVGaWxsTW9kZTpuPXRoaXMuX3VuSW5kZXhlZD9udWxsOnRoaXMuX2dlb21ldHJ5LmdldEluZGV4QnVmZmVyKCl9by5iaW5kQnVmZmVycyh0aGlzLl9nZW9tZXRyeS5nZXRWZXJ0ZXhCdWZmZXJzKCksbixpKX0sci5wcm90b3R5cGUuX2RyYXc9ZnVuY3Rpb24odCxpLHIpe2lmKHRoaXMuX2dlb21ldHJ5JiZ0aGlzLl9nZW9tZXRyeS5nZXRWZXJ0ZXhCdWZmZXJzKCkmJnRoaXMuX2dlb21ldHJ5LmdldEluZGV4QnVmZmVyKCkpe3RoaXMub25CZWZvcmVEcmF3T2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcyk7dmFyIG49dGhpcy5nZXRTY2VuZSgpLmdldEVuZ2luZSgpO3N3aXRjaChpKXtjYXNlIGUuTWF0ZXJpYWwuUG9pbnRGaWxsTW9kZTpuLmRyYXdQb2ludENsb3Vkcyh0LnZlcnRpY2VzU3RhcnQsdC52ZXJ0aWNlc0NvdW50LHIpO2JyZWFrO2Nhc2UgZS5NYXRlcmlhbC5XaXJlRnJhbWVGaWxsTW9kZTp0aGlzLl91bkluZGV4ZWQ/bi5kcmF3VW5JbmRleGVkKCExLHQudmVydGljZXNTdGFydCx0LnZlcnRpY2VzQ291bnQscik6bi5kcmF3KCExLDAscj4wP3QubGluZXNJbmRleENvdW50LzI6dC5saW5lc0luZGV4Q291bnQscik7YnJlYWs7ZGVmYXVsdDp0aGlzLl91bkluZGV4ZWQ/bi5kcmF3VW5JbmRleGVkKCEwLHQudmVydGljZXNTdGFydCx0LnZlcnRpY2VzQ291bnQscik6bi5kcmF3KCEwLHQuaW5kZXhTdGFydCx0LmluZGV4Q291bnQscil9fX0sci5wcm90b3R5cGUucmVnaXN0ZXJCZWZvcmVSZW5kZXI9ZnVuY3Rpb24oZSl7dGhpcy5vbkJlZm9yZVJlbmRlck9ic2VydmFibGUuYWRkKGUpfSxyLnByb3RvdHlwZS51bnJlZ2lzdGVyQmVmb3JlUmVuZGVyPWZ1bmN0aW9uKGUpe3RoaXMub25CZWZvcmVSZW5kZXJPYnNlcnZhYmxlLnJlbW92ZUNhbGxiYWNrKGUpfSxyLnByb3RvdHlwZS5yZWdpc3RlckFmdGVyUmVuZGVyPWZ1bmN0aW9uKGUpe3RoaXMub25BZnRlclJlbmRlck9ic2VydmFibGUuYWRkKGUpfSxyLnByb3RvdHlwZS51bnJlZ2lzdGVyQWZ0ZXJSZW5kZXI9ZnVuY3Rpb24oZSl7dGhpcy5vbkFmdGVyUmVuZGVyT2JzZXJ2YWJsZS5yZW1vdmVDYWxsYmFjayhlKX0sci5wcm90b3R5cGUuX2dldEluc3RhbmNlc1JlbmRlckxpc3Q9ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5nZXRTY2VuZSgpO2lmKHRoaXMuX2JhdGNoQ2FjaGUubXVzdFJldHVybj0hMSx0aGlzLl9iYXRjaENhY2hlLnJlbmRlclNlbGZbZV09dGhpcy5pc0VuYWJsZWQoKSYmdGhpcy5pc1Zpc2libGUsdGhpcy5fYmF0Y2hDYWNoZS52aXNpYmxlSW5zdGFuY2VzW2VdPW51bGwsdGhpcy5fdmlzaWJsZUluc3RhbmNlcyl7dmFyIGk9dC5nZXRSZW5kZXJJZCgpLHI9dC5faXNJbkludGVybWVkaWF0ZVJlbmRlcmluZygpP3RoaXMuX3Zpc2libGVJbnN0YW5jZXMuaW50ZXJtZWRpYXRlRGVmYXVsdFJlbmRlcklkOnRoaXMuX3Zpc2libGVJbnN0YW5jZXMuZGVmYXVsdFJlbmRlcklkO3RoaXMuX2JhdGNoQ2FjaGUudmlzaWJsZUluc3RhbmNlc1tlXT10aGlzLl92aXNpYmxlSW5zdGFuY2VzW2ldO3ZhciBuPXRoaXMuX3JlbmRlcklkO2lmKCF0aGlzLl9iYXRjaENhY2hlLnZpc2libGVJbnN0YW5jZXNbZV0mJnImJih0aGlzLl9iYXRjaENhY2hlLnZpc2libGVJbnN0YW5jZXNbZV09dGhpcy5fdmlzaWJsZUluc3RhbmNlc1tyXSxpPU1hdGgubWF4KHIsaSksbj1NYXRoLm1heCh0aGlzLl92aXNpYmxlSW5zdGFuY2VzLnNlbGZEZWZhdWx0UmVuZGVySWQsaSkpLHRoaXMuX2JhdGNoQ2FjaGUudmlzaWJsZUluc3RhbmNlc1tlXSYmdGhpcy5fYmF0Y2hDYWNoZS52aXNpYmxlSW5zdGFuY2VzW2VdLmxlbmd0aCl7aWYodGhpcy5fcmVuZGVySWRGb3JJbnN0YW5jZXNbZV09PT1pKXJldHVybiB0aGlzLl9iYXRjaENhY2hlLm11c3RSZXR1cm49ITAsdGhpcy5fYmF0Y2hDYWNoZTtpIT09biYmKHRoaXMuX2JhdGNoQ2FjaGUucmVuZGVyU2VsZltlXT0hMSl9dGhpcy5fcmVuZGVySWRGb3JJbnN0YW5jZXNbZV09aX1yZXR1cm4gdGhpcy5fYmF0Y2hDYWNoZX0sci5wcm90b3R5cGUuX3JlbmRlcldpdGhJbnN0YW5jZXM9ZnVuY3Rpb24odCxpLHIsbixvKXtmb3IodmFyIHM9ci52aXNpYmxlSW5zdGFuY2VzW3QuX2lkXSxhPXMubGVuZ3RoKzEsaD0xNiphKjQsYz10aGlzLl9pbnN0YW5jZXNCdWZmZXJTaXplLGw9dGhpcy5faW5zdGFuY2VzQnVmZmVyO3RoaXMuX2luc3RhbmNlc0J1ZmZlclNpemU8aDspdGhpcy5faW5zdGFuY2VzQnVmZmVyU2l6ZSo9Mjt0aGlzLl9pbnN0YW5jZXNEYXRhJiZjPT10aGlzLl9pbnN0YW5jZXNCdWZmZXJTaXplfHwodGhpcy5faW5zdGFuY2VzRGF0YT1uZXcgRmxvYXQzMkFycmF5KHRoaXMuX2luc3RhbmNlc0J1ZmZlclNpemUvNCkpO3ZhciB1PTAsZj0wLGQ9dGhpcy5nZXRXb3JsZE1hdHJpeCgpO2lmKHIucmVuZGVyU2VsZlt0Ll9pZF0mJihkLmNvcHlUb0FycmF5KHRoaXMuX2luc3RhbmNlc0RhdGEsdSksdSs9MTYsZisrKSxzKWZvcih2YXIgcD0wO3A8cy5sZW5ndGg7cCsrKXt2YXIgXz1zW3BdO18uZ2V0V29ybGRNYXRyaXgoKS5jb3B5VG9BcnJheSh0aGlzLl9pbnN0YW5jZXNEYXRhLHUpLHUrPTE2LGYrK31sJiZjPT10aGlzLl9pbnN0YW5jZXNCdWZmZXJTaXplP2wudXBkYXRlRGlyZWN0bHkodGhpcy5faW5zdGFuY2VzRGF0YSwwLGYpOihsJiZsLmRpc3Bvc2UoKSxsPW5ldyBlLkJ1ZmZlcihvLHRoaXMuX2luc3RhbmNlc0RhdGEsITAsMTYsITEsITApLHRoaXMuX2luc3RhbmNlc0J1ZmZlcj1sLHRoaXMuc2V0VmVydGljZXNCdWZmZXIobC5jcmVhdGVWZXJ0ZXhCdWZmZXIoXCJ3b3JsZDBcIiwwLDQpKSx0aGlzLnNldFZlcnRpY2VzQnVmZmVyKGwuY3JlYXRlVmVydGV4QnVmZmVyKFwid29ybGQxXCIsNCw0KSksdGhpcy5zZXRWZXJ0aWNlc0J1ZmZlcihsLmNyZWF0ZVZlcnRleEJ1ZmZlcihcIndvcmxkMlwiLDgsNCkpLHRoaXMuc2V0VmVydGljZXNCdWZmZXIobC5jcmVhdGVWZXJ0ZXhCdWZmZXIoXCJ3b3JsZDNcIiwxMiw0KSkpLG8uYmluZEJ1ZmZlcnModGhpcy5nZW9tZXRyeS5nZXRWZXJ0ZXhCdWZmZXJzKCksdGhpcy5nZW9tZXRyeS5nZXRJbmRleEJ1ZmZlcigpLG4pLHRoaXMuX2RyYXcodCxpLGYpLG8udW5iaW5kSW5zdGFuY2VBdHRyaWJ1dGVzKCl9LHIucHJvdG90eXBlLl9wcm9jZXNzUmVuZGVyaW5nPWZ1bmN0aW9uKGUsdCxpLHIsbixvKXt2YXIgcz10aGlzLmdldFNjZW5lKCksYT1zLmdldEVuZ2luZSgpO2lmKG4pdGhpcy5fcmVuZGVyV2l0aEluc3RhbmNlcyhlLGkscix0LGEpO2Vsc2UgaWYoci5yZW5kZXJTZWxmW2UuX2lkXSYmKG8mJm8oITEsdGhpcy5nZXRXb3JsZE1hdHJpeCgpKSx0aGlzLl9kcmF3KGUsaSx0aGlzLl9vdmVycmlkZW5JbnN0YW5jZUNvdW50KSksci52aXNpYmxlSW5zdGFuY2VzW2UuX2lkXSlmb3IodmFyIGg9MDtoPHIudmlzaWJsZUluc3RhbmNlc1tlLl9pZF0ubGVuZ3RoO2grKyl7dmFyIGM9ci52aXNpYmxlSW5zdGFuY2VzW2UuX2lkXVtoXSxsPWMuZ2V0V29ybGRNYXRyaXgoKTtvJiZvKCEwLGwpLHRoaXMuX2RyYXcoZSxpKX19LHIucHJvdG90eXBlLnJlbmRlcj1mdW5jdGlvbih0LGkpe3ZhciByPXRoaXMuZ2V0U2NlbmUoKSxuPXRoaXMuX2dldEluc3RhbmNlc1JlbmRlckxpc3QodC5faWQpO2lmKCFuLm11c3RSZXR1cm4mJnRoaXMuX2dlb21ldHJ5JiZ0aGlzLl9nZW9tZXRyeS5nZXRWZXJ0ZXhCdWZmZXJzKCkmJnRoaXMuX2dlb21ldHJ5LmdldEluZGV4QnVmZmVyKCkpe3RoaXMub25CZWZvcmVSZW5kZXJPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzKTt2YXIgbz1yLmdldEVuZ2luZSgpLHM9bnVsbCE9PW8uZ2V0Q2FwcygpLmluc3RhbmNlZEFycmF5cyYmbnVsbCE9PW4udmlzaWJsZUluc3RhbmNlc1t0Ll9pZF0mJnZvaWQgMCE9PW4udmlzaWJsZUluc3RhbmNlc1t0Ll9pZF0sYT10LmdldE1hdGVyaWFsKCk7aWYoYSYmYS5pc1JlYWR5KHRoaXMscykpe3ZhciBoPW8uZ2V0RGVwdGhXcml0ZSgpO3RoaXMucmVuZGVyT3V0bGluZSYmKG8uc2V0RGVwdGhXcml0ZSghMSksci5nZXRPdXRsaW5lUmVuZGVyZXIoKS5yZW5kZXIodCxuKSxvLnNldERlcHRoV3JpdGUoaCkpLGEuX3ByZUJpbmQoKTt2YXIgYz1hLmdldEVmZmVjdCgpLGw9ci5mb3JjZVBvaW50c0Nsb3VkP2UuTWF0ZXJpYWwuUG9pbnRGaWxsTW9kZTpyLmZvcmNlV2lyZWZyYW1lP2UuTWF0ZXJpYWwuV2lyZUZyYW1lRmlsbE1vZGU6YS5maWxsTW9kZTt0aGlzLl9iaW5kKHQsYyxsKTt2YXIgdT10aGlzLmdldFdvcmxkTWF0cml4KCk7aWYoYS5iaW5kKHUsdGhpcyksaSYmby5zZXRBbHBoYU1vZGUoYS5hbHBoYU1vZGUpLHRoaXMuX3Byb2Nlc3NSZW5kZXJpbmcodCxjLGwsbixzLGZ1bmN0aW9uKGUsdCl7ZSYmYS5iaW5kT25seVdvcmxkTWF0cml4KHQpfSksYS51bmJpbmQoKSx0aGlzLnJlbmRlck91dGxpbmUmJmgmJihvLnNldERlcHRoV3JpdGUoITApLG8uc2V0Q29sb3JXcml0ZSghMSksci5nZXRPdXRsaW5lUmVuZGVyZXIoKS5yZW5kZXIodCxuKSxvLnNldENvbG9yV3JpdGUoITApKSx0aGlzLnJlbmRlck92ZXJsYXkpe3ZhciBmPW8uZ2V0QWxwaGFNb2RlKCk7by5zZXRBbHBoYU1vZGUoZS5FbmdpbmUuQUxQSEFfQ09NQklORSksci5nZXRPdXRsaW5lUmVuZGVyZXIoKS5yZW5kZXIodCxuLCEwKSxvLnNldEFscGhhTW9kZShmKX10aGlzLm9uQWZ0ZXJSZW5kZXJPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzKX19fSxyLnByb3RvdHlwZS5nZXRFbWl0dGVkUGFydGljbGVTeXN0ZW1zPWZ1bmN0aW9uKCl7Zm9yKHZhciBlPW5ldyBBcnJheSx0PTA7dDx0aGlzLmdldFNjZW5lKCkucGFydGljbGVTeXN0ZW1zLmxlbmd0aDt0Kyspe3ZhciBpPXRoaXMuZ2V0U2NlbmUoKS5wYXJ0aWNsZVN5c3RlbXNbdF07aS5lbWl0dGVyPT09dGhpcyYmZS5wdXNoKGkpfXJldHVybiBlfSxyLnByb3RvdHlwZS5nZXRIaWVyYXJjaHlFbWl0dGVkUGFydGljbGVTeXN0ZW1zPWZ1bmN0aW9uKCl7dmFyIGU9bmV3IEFycmF5LHQ9dGhpcy5nZXREZXNjZW5kYW50cygpO3QucHVzaCh0aGlzKTtmb3IodmFyIGk9MDtpPHRoaXMuZ2V0U2NlbmUoKS5wYXJ0aWNsZVN5c3RlbXMubGVuZ3RoO2krKyl7dmFyIHI9dGhpcy5nZXRTY2VuZSgpLnBhcnRpY2xlU3lzdGVtc1tpXTstMSE9PXQuaW5kZXhPZihyLmVtaXR0ZXIpJiZlLnB1c2gocil9cmV0dXJuIGV9LHIucHJvdG90eXBlLl9jaGVja0RlbGF5U3RhdGU9ZnVuY3Rpb24oKXt2YXIgdD10aGlzLGk9dGhpcyxyPXRoaXMuZ2V0U2NlbmUoKTtpZih0aGlzLl9nZW9tZXRyeSl0aGlzLl9nZW9tZXRyeS5sb2FkKHIpO2Vsc2UgaWYoaS5kZWxheUxvYWRTdGF0ZT09PWUuRW5naW5lLkRFTEFZTE9BRFNUQVRFX05PVExPQURFRCl7aS5kZWxheUxvYWRTdGF0ZT1lLkVuZ2luZS5ERUxBWUxPQURTVEFURV9MT0FESU5HLHIuX2FkZFBlbmRpbmdEYXRhKGkpO3ZhciBuPS0xIT09dGhpcy5kZWxheUxvYWRpbmdGaWxlLmluZGV4T2YoXCIuYmFieWxvbmJpbmFyeW1lc2hkYXRhXCIpO2UuVG9vbHMuTG9hZEZpbGUodGhpcy5kZWxheUxvYWRpbmdGaWxlLGZ1bmN0aW9uKGkpe2kgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcj90Ll9kZWxheUxvYWRpbmdGdW5jdGlvbihpLHQpOnQuX2RlbGF5TG9hZGluZ0Z1bmN0aW9uKEpTT04ucGFyc2UoaSksdCksdC5kZWxheUxvYWRTdGF0ZT1lLkVuZ2luZS5ERUxBWUxPQURTVEFURV9MT0FERUQsci5fcmVtb3ZlUGVuZGluZ0RhdGEodCl9LGZ1bmN0aW9uKCl7fSxyLmRhdGFiYXNlLG4pfX0sci5wcm90b3R5cGUuaXNJbkZydXN0dW09ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuZGVsYXlMb2FkU3RhdGU9PT1lLkVuZ2luZS5ERUxBWUxPQURTVEFURV9MT0FESU5HPyExOmkucHJvdG90eXBlLmlzSW5GcnVzdHVtLmNhbGwodGhpcyx0KT8odGhpcy5fY2hlY2tEZWxheVN0YXRlKCksITApOiExfSxyLnByb3RvdHlwZS5zZXRNYXRlcmlhbEJ5SUQ9ZnVuY3Rpb24oZSl7dmFyIHQsaT10aGlzLmdldFNjZW5lKCkubWF0ZXJpYWxzO2Zvcih0PTA7dDxpLmxlbmd0aDt0KyspaWYoaVt0XS5pZD09PWUpcmV0dXJuIHZvaWQodGhpcy5tYXRlcmlhbD1pW3RdKTt2YXIgcj10aGlzLmdldFNjZW5lKCkubXVsdGlNYXRlcmlhbHM7Zm9yKHQ9MDt0PHIubGVuZ3RoO3QrKylpZihyW3RdLmlkPT09ZSlyZXR1cm4gdm9pZCh0aGlzLm1hdGVyaWFsPXJbdF0pfSxyLnByb3RvdHlwZS5nZXRBbmltYXRhYmxlcz1mdW5jdGlvbigpe3ZhciBlPVtdO3JldHVybiB0aGlzLm1hdGVyaWFsJiZlLnB1c2godGhpcy5tYXRlcmlhbCksdGhpcy5za2VsZXRvbiYmZS5wdXNoKHRoaXMuc2tlbGV0b24pLGV9LHIucHJvdG90eXBlLmJha2VUcmFuc2Zvcm1JbnRvVmVydGljZXM9ZnVuY3Rpb24odCl7aWYodGhpcy5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZS5WZXJ0ZXhCdWZmZXIuUG9zaXRpb25LaW5kKSl7dmFyIGk9dGhpcy5zdWJNZXNoZXMuc3BsaWNlKDApO3RoaXMuX3Jlc2V0UG9pbnRzQXJyYXlDYWNoZSgpO3ZhciByLG49dGhpcy5nZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuUG9zaXRpb25LaW5kKSxvPVtdO2ZvcihyPTA7cjxuLmxlbmd0aDtyKz0zKWUuVmVjdG9yMy5UcmFuc2Zvcm1Db29yZGluYXRlcyhlLlZlY3RvcjMuRnJvbUFycmF5KG4sciksdCkudG9BcnJheShvLHIpO2lmKHRoaXMuc2V0VmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLlBvc2l0aW9uS2luZCxvLHRoaXMuZ2V0VmVydGV4QnVmZmVyKGUuVmVydGV4QnVmZmVyLlBvc2l0aW9uS2luZCkuaXNVcGRhdGFibGUoKSksdGhpcy5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZS5WZXJ0ZXhCdWZmZXIuTm9ybWFsS2luZCkpe2ZvcihuPXRoaXMuZ2V0VmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLk5vcm1hbEtpbmQpLG89W10scj0wO3I8bi5sZW5ndGg7cis9MyllLlZlY3RvcjMuVHJhbnNmb3JtTm9ybWFsKGUuVmVjdG9yMy5Gcm9tQXJyYXkobixyKSx0KS5ub3JtYWxpemUoKS50b0FycmF5KG8scik7dGhpcy5zZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuTm9ybWFsS2luZCxvLHRoaXMuZ2V0VmVydGV4QnVmZmVyKGUuVmVydGV4QnVmZmVyLk5vcm1hbEtpbmQpLmlzVXBkYXRhYmxlKCkpLHQubVswXSp0Lm1bNV0qdC5tWzEwXTwwJiZ0aGlzLmZsaXBGYWNlcygpLHRoaXMucmVsZWFzZVN1Yk1lc2hlcygpLHRoaXMuc3ViTWVzaGVzPWl9fX0sci5wcm90b3R5cGUuYmFrZUN1cnJlbnRUcmFuc2Zvcm1JbnRvVmVydGljZXM9ZnVuY3Rpb24oKXt0aGlzLmJha2VUcmFuc2Zvcm1JbnRvVmVydGljZXModGhpcy5jb21wdXRlV29ybGRNYXRyaXgoITApKSx0aGlzLnNjYWxpbmcuY29weUZyb21GbG9hdHMoMSwxLDEpLHRoaXMucG9zaXRpb24uY29weUZyb21GbG9hdHMoMCwwLDApLHRoaXMucm90YXRpb24uY29weUZyb21GbG9hdHMoMCwwLDApLHRoaXMucm90YXRpb25RdWF0ZXJuaW9uJiYodGhpcy5yb3RhdGlvblF1YXRlcm5pb249ZS5RdWF0ZXJuaW9uLklkZW50aXR5KCkpLHRoaXMuX3dvcmxkTWF0cml4PWUuTWF0cml4LklkZW50aXR5KCl9LHIucHJvdG90eXBlLl9yZXNldFBvaW50c0FycmF5Q2FjaGU9ZnVuY3Rpb24oKXt0aGlzLl9wb3NpdGlvbnM9bnVsbH0sci5wcm90b3R5cGUuX2dlbmVyYXRlUG9pbnRzQXJyYXk9ZnVuY3Rpb24oKXtpZih0aGlzLl9wb3NpdGlvbnMpcmV0dXJuITA7dGhpcy5fcG9zaXRpb25zPVtdO3ZhciB0PXRoaXMuZ2V0VmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLlBvc2l0aW9uS2luZCk7aWYoIXQpcmV0dXJuITE7Zm9yKHZhciBpPTA7aTx0Lmxlbmd0aDtpKz0zKXRoaXMuX3Bvc2l0aW9ucy5wdXNoKGUuVmVjdG9yMy5Gcm9tQXJyYXkodCxpKSk7cmV0dXJuITB9LHIucHJvdG90eXBlLmNsb25lPWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiB2b2lkIDA9PT1uJiYobj0hMCksbmV3IHIoZSx0aGlzLmdldFNjZW5lKCksdCx0aGlzLGksbil9LHIucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oZSl7Zm9yKHRoaXMuX2dlb21ldHJ5JiZ0aGlzLl9nZW9tZXRyeS5yZWxlYXNlRm9yTWVzaCh0aGlzLCEwKSx0aGlzLl9pbnN0YW5jZXNCdWZmZXImJih0aGlzLl9pbnN0YW5jZXNCdWZmZXIuZGlzcG9zZSgpLHRoaXMuX2luc3RhbmNlc0J1ZmZlcj1udWxsKTt0aGlzLmluc3RhbmNlcy5sZW5ndGg7KXRoaXMuaW5zdGFuY2VzWzBdLmRpc3Bvc2UoKTtpLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyxlKX0sci5wcm90b3R5cGUuYXBwbHlEaXNwbGFjZW1lbnRNYXA9ZnVuY3Rpb24odCxpLHIsbil7dmFyIG89dGhpcyxzPXRoaXMuZ2V0U2NlbmUoKSxhPWZ1bmN0aW9uKGUpe3ZhciB0PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIikscz10LmdldENvbnRleHQoXCIyZFwiKSxhPWUud2lkdGgsaD1lLmhlaWdodDt0LndpZHRoPWEsdC5oZWlnaHQ9aCxzLmRyYXdJbWFnZShlLDAsMCk7dmFyIGM9cy5nZXRJbWFnZURhdGEoMCwwLGEsaCkuZGF0YTtvLmFwcGx5RGlzcGxhY2VtZW50TWFwRnJvbUJ1ZmZlcihjLGEsaCxpLHIpLG4mJm4obyl9O2UuVG9vbHMuTG9hZEltYWdlKHQsYSxmdW5jdGlvbigpe30scy5kYXRhYmFzZSl9LHIucHJvdG90eXBlLmFwcGx5RGlzcGxhY2VtZW50TWFwRnJvbUJ1ZmZlcj1mdW5jdGlvbih0LGkscixuLG8pe2lmKCF0aGlzLmlzVmVydGljZXNEYXRhUHJlc2VudChlLlZlcnRleEJ1ZmZlci5Qb3NpdGlvbktpbmQpfHwhdGhpcy5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZS5WZXJ0ZXhCdWZmZXIuTm9ybWFsS2luZCl8fCF0aGlzLmlzVmVydGljZXNEYXRhUHJlc2VudChlLlZlcnRleEJ1ZmZlci5VVktpbmQpKXJldHVybiB2b2lkIGUuVG9vbHMuV2FybihcIkNhbm5vdCBjYWxsIGFwcGx5RGlzcGxhY2VtZW50TWFwOiBHaXZlbiBtZXNoIGlzIG5vdCBjb21wbGV0ZS4gUG9zaXRpb24sIE5vcm1hbCBvciBVViBhcmUgbWlzc2luZ1wiKTtmb3IodmFyIHM9dGhpcy5nZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuUG9zaXRpb25LaW5kKSxhPXRoaXMuZ2V0VmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLk5vcm1hbEtpbmQpLGg9dGhpcy5nZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuVVZLaW5kKSxjPWUuVmVjdG9yMy5aZXJvKCksbD1lLlZlY3RvcjMuWmVybygpLHU9ZS5WZWN0b3IyLlplcm8oKSxmPTA7ZjxzLmxlbmd0aDtmKz0zKXtlLlZlY3RvcjMuRnJvbUFycmF5VG9SZWYocyxmLGMpLGUuVmVjdG9yMy5Gcm9tQXJyYXlUb1JlZihhLGYsbCksZS5WZWN0b3IyLkZyb21BcnJheVRvUmVmKGgsZi8zKjIsdSk7dmFyIGQ9TWF0aC5hYnModS54KSppJWl8MCxwPU1hdGguYWJzKHUueSkqciVyfDAsXz00KihkK3AqaSksbT10W19dLzI1NSxnPXRbXysxXS8yNTUsdj10W18rMl0vMjU1LHk9LjMqbSsuNTkqZysuMTEqdjtsLm5vcm1hbGl6ZSgpLGwuc2NhbGVJblBsYWNlKG4rKG8tbikqeSksYz1jLmFkZChsKSxjLnRvQXJyYXkocyxmKX1lLlZlcnRleERhdGEuQ29tcHV0ZU5vcm1hbHMocyx0aGlzLmdldEluZGljZXMoKSxhKSx0aGlzLnVwZGF0ZVZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5Qb3NpdGlvbktpbmQscyksdGhpcy51cGRhdGVWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuTm9ybWFsS2luZCxhKX0sci5wcm90b3R5cGUuY29udmVydFRvRmxhdFNoYWRlZE1lc2g9ZnVuY3Rpb24oKXt2YXIgdCxpLHI9dGhpcy5nZXRWZXJ0aWNlc0RhdGFLaW5kcygpLG49W10sbz1bXSxzPVtdLGE9ITE7Zm9yKHQ9MDt0PHIubGVuZ3RoO3QrKyl7aT1yW3RdO3ZhciBoPXRoaXMuZ2V0VmVydGV4QnVmZmVyKGkpO2khPT1lLlZlcnRleEJ1ZmZlci5Ob3JtYWxLaW5kPyhuW2ldPWgsb1tpXT1uW2ldLmdldERhdGEoKSxzW2ldPVtdKTooYT1oLmlzVXBkYXRhYmxlKCksci5zcGxpY2UodCwxKSx0LS0pfXZhciBjLGw9dGhpcy5zdWJNZXNoZXMuc2xpY2UoMCksdT10aGlzLmdldEluZGljZXMoKSxmPXRoaXMuZ2V0VG90YWxJbmRpY2VzKCk7Zm9yKGM9MDtmPmM7YysrKXt2YXIgZD11W2NdO2Zvcih0PTA7dDxyLmxlbmd0aDt0Kyspe2k9clt0XTtmb3IodmFyIHA9bltpXS5nZXRTdHJpZGVTaXplKCksXz0wO3A+XztfKyspc1tpXS5wdXNoKG9baV1bZCpwK19dKX19dmFyIG09W10sZz1zW2UuVmVydGV4QnVmZmVyLlBvc2l0aW9uS2luZF07Zm9yKGM9MDtmPmM7Yys9Myl7dVtjXT1jLHVbYysxXT1jKzEsdVtjKzJdPWMrMjtmb3IodmFyIHY9ZS5WZWN0b3IzLkZyb21BcnJheShnLDMqYykseT1lLlZlY3RvcjMuRnJvbUFycmF5KGcsMyooYysxKSkseD1lLlZlY3RvcjMuRnJvbUFycmF5KGcsMyooYysyKSksYj12LnN1YnRyYWN0KHkpLFA9eC5zdWJ0cmFjdCh5KSxBPWUuVmVjdG9yMy5Ob3JtYWxpemUoZS5WZWN0b3IzLkNyb3NzKGIsUCkpLFQ9MDszPlQ7VCsrKW0ucHVzaChBLngpLG0ucHVzaChBLnkpLG0ucHVzaChBLnopfWZvcih0aGlzLnNldEluZGljZXModSksdGhpcy5zZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuTm9ybWFsS2luZCxtLGEpLHQ9MDt0PHIubGVuZ3RoO3QrKylpPXJbdF0sdGhpcy5zZXRWZXJ0aWNlc0RhdGEoaSxzW2ldLG5baV0uaXNVcGRhdGFibGUoKSk7dGhpcy5yZWxlYXNlU3ViTWVzaGVzKCk7Zm9yKHZhciBFPTA7RTxsLmxlbmd0aDtFKyspe3ZhciBDPWxbRV07bmV3IGUuU3ViTWVzaChDLm1hdGVyaWFsSW5kZXgsQy5pbmRleFN0YXJ0LEMuaW5kZXhDb3VudCxDLmluZGV4U3RhcnQsQy5pbmRleENvdW50LHRoaXMpfXRoaXMuc3luY2hyb25pemVJbnN0YW5jZXMoKX0sci5wcm90b3R5cGUuY29udmVydFRvVW5JbmRleGVkTWVzaD1mdW5jdGlvbigpe3ZhciB0LGkscj10aGlzLmdldFZlcnRpY2VzRGF0YUtpbmRzKCksbj1bXSxvPVtdLHM9W107Zm9yKHQ9MDt0PHIubGVuZ3RoO3QrKyl7aT1yW3RdO3ZhciBhPXRoaXMuZ2V0VmVydGV4QnVmZmVyKGkpO25baV09YSxvW2ldPW5baV0uZ2V0RGF0YSgpLHNbaV09W119dmFyIGgsYz10aGlzLnN1Yk1lc2hlcy5zbGljZSgwKSxsPXRoaXMuZ2V0SW5kaWNlcygpLHU9dGhpcy5nZXRUb3RhbEluZGljZXMoKTtmb3IoaD0wO3U+aDtoKyspe3ZhciBmPWxbaF07Zm9yKHQ9MDt0PHIubGVuZ3RoO3QrKyl7aT1yW3RdO2Zvcih2YXIgZD1uW2ldLmdldFN0cmlkZVNpemUoKSxwPTA7ZD5wO3ArKylzW2ldLnB1c2gob1tpXVtmKmQrcF0pfX1mb3IoaD0wO3U+aDtoKz0zKWxbaF09aCxsW2grMV09aCsxLGxbaCsyXT1oKzI7Zm9yKHRoaXMuc2V0SW5kaWNlcyhsKSx0PTA7dDxyLmxlbmd0aDt0KyspaT1yW3RdLHRoaXMuc2V0VmVydGljZXNEYXRhKGksc1tpXSxuW2ldLmlzVXBkYXRhYmxlKCkpO3RoaXMucmVsZWFzZVN1Yk1lc2hlcygpO2Zvcih2YXIgXz0wO188Yy5sZW5ndGg7XysrKXt2YXIgbT1jW19dO25ldyBlLlN1Yk1lc2gobS5tYXRlcmlhbEluZGV4LG0uaW5kZXhTdGFydCxtLmluZGV4Q291bnQsbS5pbmRleFN0YXJ0LG0uaW5kZXhDb3VudCx0aGlzKX10aGlzLl91bkluZGV4ZWQ9ITAsdGhpcy5zeW5jaHJvbml6ZUluc3RhbmNlcygpfSxyLnByb3RvdHlwZS5mbGlwRmFjZXM9ZnVuY3Rpb24odCl7dm9pZCAwPT09dCYmKHQ9ITEpO3ZhciBpLHI9ZS5WZXJ0ZXhEYXRhLkV4dHJhY3RGcm9tTWVzaCh0aGlzKTtpZih0JiZ0aGlzLmlzVmVydGljZXNEYXRhUHJlc2VudChlLlZlcnRleEJ1ZmZlci5Ob3JtYWxLaW5kKSlmb3IoaT0wO2k8ci5ub3JtYWxzLmxlbmd0aDtpKyspci5ub3JtYWxzW2ldKj0tMTt2YXIgbjtmb3IoaT0wO2k8ci5pbmRpY2VzLmxlbmd0aDtpKz0zKW49ci5pbmRpY2VzW2krMV0sci5pbmRpY2VzW2krMV09ci5pbmRpY2VzW2krMl0sci5pbmRpY2VzW2krMl09bjtyLmFwcGx5VG9NZXNoKHRoaXMpfSxyLnByb3RvdHlwZS5jcmVhdGVJbnN0YW5jZT1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUuSW5zdGFuY2VkTWVzaCh0LHRoaXMpfSxyLnByb3RvdHlwZS5zeW5jaHJvbml6ZUluc3RhbmNlcz1mdW5jdGlvbigpe2Zvcih2YXIgZT0wO2U8dGhpcy5pbnN0YW5jZXMubGVuZ3RoO2UrKyl7dmFyIHQ9dGhpcy5pbnN0YW5jZXNbZV07dC5fc3luY1N1Yk1lc2hlcygpfX0sci5wcm90b3R5cGUuc2ltcGxpZnk9ZnVuY3Rpb24odCxpLHIsbil7dm9pZCAwPT09aSYmKGk9ITApLHZvaWQgMD09PXImJihyPWUuU2ltcGxpZmljYXRpb25UeXBlLlFVQURSQVRJQyksdGhpcy5nZXRTY2VuZSgpLnNpbXBsaWZpY2F0aW9uUXVldWUuYWRkVGFzayh7c2V0dGluZ3M6dCxwYXJhbGxlbFByb2Nlc3Npbmc6aSxtZXNoOnRoaXMsc2ltcGxpZmljYXRpb25UeXBlOnIsc3VjY2Vzc0NhbGxiYWNrOm59KX0sci5wcm90b3R5cGUub3B0aW1pemVJbmRpY2VzPWZ1bmN0aW9uKHQpe2Zvcih2YXIgaT10aGlzLHI9dGhpcy5nZXRJbmRpY2VzKCksbj10aGlzLmdldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5Qb3NpdGlvbktpbmQpLG89W10scz0wO3M8bi5sZW5ndGg7cys9MylvLnB1c2goZS5WZWN0b3IzLkZyb21BcnJheShuLHMpKTt2YXIgYT1bXTtlLkFzeW5jTG9vcC5TeW5jQXN5bmNGb3JMb29wKG8ubGVuZ3RoLDQwLGZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1vLmxlbmd0aC0xLWUsaT1vW3RdLHI9MDt0PnI7KytyKXt2YXIgbj1vW3JdO2lmKGkuZXF1YWxzKG4pKXthW3RdPXI7YnJlYWt9fX0sZnVuY3Rpb24oKXtmb3IodmFyIGU9MDtlPHIubGVuZ3RoOysrZSlyW2VdPWFbcltlXV18fHJbZV07dmFyIG49aS5zdWJNZXNoZXMuc2xpY2UoMCk7aS5zZXRJbmRpY2VzKHIpLGkuc3ViTWVzaGVzPW4sdCYmdChpKX0pfSxyLlBhcnNlPWZ1bmN0aW9uKHQsaSxuKXt2YXIgbz1uZXcgcih0Lm5hbWUsaSk7aWYoby5pZD10LmlkLGUuVGFncy5BZGRUYWdzVG8obyx0LnRhZ3MpLG8ucG9zaXRpb249ZS5WZWN0b3IzLkZyb21BcnJheSh0LnBvc2l0aW9uKSx0LnJvdGF0aW9uUXVhdGVybmlvbj9vLnJvdGF0aW9uUXVhdGVybmlvbj1lLlF1YXRlcm5pb24uRnJvbUFycmF5KHQucm90YXRpb25RdWF0ZXJuaW9uKTp0LnJvdGF0aW9uJiYoby5yb3RhdGlvbj1lLlZlY3RvcjMuRnJvbUFycmF5KHQucm90YXRpb24pKSxvLnNjYWxpbmc9ZS5WZWN0b3IzLkZyb21BcnJheSh0LnNjYWxpbmcpLHQubG9jYWxNYXRyaXg/by5zZXRQaXZvdE1hdHJpeChlLk1hdHJpeC5Gcm9tQXJyYXkodC5sb2NhbE1hdHJpeCkpOnQucGl2b3RNYXRyaXgmJm8uc2V0UGl2b3RNYXRyaXgoZS5NYXRyaXguRnJvbUFycmF5KHQucGl2b3RNYXRyaXgpKSxvLnNldEVuYWJsZWQodC5pc0VuYWJsZWQpLG8uaXNWaXNpYmxlPXQuaXNWaXNpYmxlLG8uaW5maW5pdGVEaXN0YW5jZT10LmluZmluaXRlRGlzdGFuY2Usby5zaG93Qm91bmRpbmdCb3g9dC5zaG93Qm91bmRpbmdCb3gsby5zaG93U3ViTWVzaGVzQm91bmRpbmdCb3g9dC5zaG93U3ViTWVzaGVzQm91bmRpbmdCb3gsdm9pZCAwIT09dC5hcHBseUZvZyYmKG8uYXBwbHlGb2c9dC5hcHBseUZvZyksdm9pZCAwIT09dC5waWNrYWJsZSYmKG8uaXNQaWNrYWJsZT10LnBpY2thYmxlKSx2b2lkIDAhPT10LmFscGhhSW5kZXgmJihvLmFscGhhSW5kZXg9dC5hbHBoYUluZGV4KSxvLnJlY2VpdmVTaGFkb3dzPXQucmVjZWl2ZVNoYWRvd3Msby5iaWxsYm9hcmRNb2RlPXQuYmlsbGJvYXJkTW9kZSx2b2lkIDAhPT10LnZpc2liaWxpdHkmJihvLnZpc2liaWxpdHk9dC52aXNpYmlsaXR5KSxvLmNoZWNrQ29sbGlzaW9ucz10LmNoZWNrQ29sbGlzaW9ucyxvLl9zaG91bGRHZW5lcmF0ZUZsYXRTaGFkaW5nPXQudXNlRmxhdFNoYWRpbmcsdC5mcmVlemVXb3JsZE1hdHJpeCYmKG8uX3dhaXRpbmdGcmVlemVXb3JsZE1hdHJpeD10LmZyZWV6ZVdvcmxkTWF0cml4KSx0LnBhcmVudElkJiYoby5fd2FpdGluZ1BhcmVudElkPXQucGFyZW50SWQpLHZvaWQgMCE9PXQuYWN0aW9ucyYmKG8uX3dhaXRpbmdBY3Rpb25zPXQuYWN0aW9ucyksby5oYXNWZXJ0ZXhBbHBoYT10Lmhhc1ZlcnRleEFscGhhLHQuZGVsYXlMb2FkaW5nRmlsZT8oby5kZWxheUxvYWRTdGF0ZT1lLkVuZ2luZS5ERUxBWUxPQURTVEFURV9OT1RMT0FERUQsby5kZWxheUxvYWRpbmdGaWxlPW4rdC5kZWxheUxvYWRpbmdGaWxlLG8uX2JvdW5kaW5nSW5mbz1uZXcgZS5Cb3VuZGluZ0luZm8oZS5WZWN0b3IzLkZyb21BcnJheSh0LmJvdW5kaW5nQm94TWluaW11bSksZS5WZWN0b3IzLkZyb21BcnJheSh0LmJvdW5kaW5nQm94TWF4aW11bSkpLHQuX2JpbmFyeUluZm8mJihvLl9iaW5hcnlJbmZvPXQuX2JpbmFyeUluZm8pLG8uX2RlbGF5SW5mbz1bXSx0Lmhhc1VWcyYmby5fZGVsYXlJbmZvLnB1c2goZS5WZXJ0ZXhCdWZmZXIuVVZLaW5kKSx0Lmhhc1VWczImJm8uX2RlbGF5SW5mby5wdXNoKGUuVmVydGV4QnVmZmVyLlVWMktpbmQpLHQuaGFzVVZzMyYmby5fZGVsYXlJbmZvLnB1c2goZS5WZXJ0ZXhCdWZmZXIuVVYzS2luZCksdC5oYXNVVnM0JiZvLl9kZWxheUluZm8ucHVzaChlLlZlcnRleEJ1ZmZlci5VVjRLaW5kKSx0Lmhhc1VWczUmJm8uX2RlbGF5SW5mby5wdXNoKGUuVmVydGV4QnVmZmVyLlVWNUtpbmQpLHQuaGFzVVZzNiYmby5fZGVsYXlJbmZvLnB1c2goZS5WZXJ0ZXhCdWZmZXIuVVY2S2luZCksdC5oYXNDb2xvcnMmJm8uX2RlbGF5SW5mby5wdXNoKGUuVmVydGV4QnVmZmVyLkNvbG9yS2luZCksdC5oYXNNYXRyaWNlc0luZGljZXMmJm8uX2RlbGF5SW5mby5wdXNoKGUuVmVydGV4QnVmZmVyLk1hdHJpY2VzSW5kaWNlc0tpbmQpLHQuaGFzTWF0cmljZXNXZWlnaHRzJiZvLl9kZWxheUluZm8ucHVzaChlLlZlcnRleEJ1ZmZlci5NYXRyaWNlc1dlaWdodHNLaW5kKSxvLl9kZWxheUxvYWRpbmdGdW5jdGlvbj1lLkdlb21ldHJ5LkltcG9ydEdlb21ldHJ5LGUuU2NlbmVMb2FkZXIuRm9yY2VGdWxsU2NlbmVMb2FkaW5nRm9ySW5jcmVtZW50YWwmJm8uX2NoZWNrRGVsYXlTdGF0ZSgpKTplLkdlb21ldHJ5LkltcG9ydEdlb21ldHJ5KHQsbyksdC5tYXRlcmlhbElkP28uc2V0TWF0ZXJpYWxCeUlEKHQubWF0ZXJpYWxJZCk6by5tYXRlcmlhbD1udWxsLHQuc2tlbGV0b25JZD4tMSYmKG8uc2tlbGV0b249aS5nZXRMYXN0U2tlbGV0b25CeUlEKHQuc2tlbGV0b25JZCksdC5udW1Cb25lSW5mbHVlbmNlcnMmJihvLm51bUJvbmVJbmZsdWVuY2Vycz10Lm51bUJvbmVJbmZsdWVuY2VycykpLHQuYW5pbWF0aW9ucyl7Zm9yKHZhciBzPTA7czx0LmFuaW1hdGlvbnMubGVuZ3RoO3MrKyl7dmFyIGE9dC5hbmltYXRpb25zW3NdO28uYW5pbWF0aW9ucy5wdXNoKGUuQW5pbWF0aW9uLlBhcnNlKGEpKX1lLk5vZGUuUGFyc2VBbmltYXRpb25SYW5nZXMobyx0LGkpfWlmKHQuYXV0b0FuaW1hdGUmJmkuYmVnaW5BbmltYXRpb24obyx0LmF1dG9BbmltYXRlRnJvbSx0LmF1dG9BbmltYXRlVG8sdC5hdXRvQW5pbWF0ZUxvb3AsdC5hdXRvQW5pbWF0ZVNwZWVkfHwxKSx0LmxheWVyTWFzayYmIWlzTmFOKHQubGF5ZXJNYXNrKT9vLmxheWVyTWFzaz1NYXRoLmFicyhwYXJzZUludCh0LmxheWVyTWFzaykpOm8ubGF5ZXJNYXNrPTI2ODQzNTQ1NSx0LnBoeXNpY3NJbXBvc3RvciYmKG8ucGh5c2ljc0ltcG9zdG9yPW5ldyBlLlBoeXNpY3NJbXBvc3RvcihvLHQucGh5c2ljc0ltcG9zdG9yLHttYXNzOnQucGh5c2ljc01hc3MsZnJpY3Rpb246dC5waHlzaWNzRnJpY3Rpb24scmVzdGl0dXRpb246dC5waHlzaWNzUmVzdGl0dXRpb259LGkpKSx0Lmluc3RhbmNlcylmb3IodmFyIGg9MDtoPHQuaW5zdGFuY2VzLmxlbmd0aDtoKyspe3ZhciBjPXQuaW5zdGFuY2VzW2hdLGw9by5jcmVhdGVJbnN0YW5jZShjLm5hbWUpO2lmKGUuVGFncy5BZGRUYWdzVG8obCxjLnRhZ3MpLGwucG9zaXRpb249ZS5WZWN0b3IzLkZyb21BcnJheShjLnBvc2l0aW9uKSxjLnJvdGF0aW9uUXVhdGVybmlvbj9sLnJvdGF0aW9uUXVhdGVybmlvbj1lLlF1YXRlcm5pb24uRnJvbUFycmF5KGMucm90YXRpb25RdWF0ZXJuaW9uKTpjLnJvdGF0aW9uJiYobC5yb3RhdGlvbj1lLlZlY3RvcjMuRnJvbUFycmF5KGMucm90YXRpb24pKSxsLnNjYWxpbmc9ZS5WZWN0b3IzLkZyb21BcnJheShjLnNjYWxpbmcpLGwuY2hlY2tDb2xsaXNpb25zPW8uY2hlY2tDb2xsaXNpb25zLHQuYW5pbWF0aW9ucyl7Zm9yKHM9MDtzPHQuYW5pbWF0aW9ucy5sZW5ndGg7cysrKWE9dC5hbmltYXRpb25zW3NdLGwuYW5pbWF0aW9ucy5wdXNoKGUuQW5pbWF0aW9uLlBhcnNlKGEpKTtlLk5vZGUuUGFyc2VBbmltYXRpb25SYW5nZXMobCx0LGkpfX1yZXR1cm4gb30sci5DcmVhdGVSaWJib249ZnVuY3Rpb24odCxpLHIsbixvLHMsYSxoLGMpe3JldHVybiBlLk1lc2hCdWlsZGVyLkNyZWF0ZVJpYmJvbih0LHtwYXRoQXJyYXk6aSxjbG9zZUFycmF5OnIsY2xvc2VQYXRoOm4sb2Zmc2V0Om8sdXBkYXRhYmxlOmEsc2lkZU9yaWVudGF0aW9uOmgsaW5zdGFuY2U6Y30scyl9LHIuQ3JlYXRlRGlzYz1mdW5jdGlvbih0LGkscixuLG8scyl7dmFyIGE9e3JhZGl1czppLHRlc3NlbGxhdGlvbjpyLHNpZGVPcmllbnRhdGlvbjpzLHVwZGF0YWJsZTpvfTtyZXR1cm4gZS5NZXNoQnVpbGRlci5DcmVhdGVEaXNjKHQsYSxuKX0sci5DcmVhdGVCb3g9ZnVuY3Rpb24odCxpLHIsbixvKXt2YXIgcz17c2l6ZTppLHNpZGVPcmllbnRhdGlvbjpvLHVwZGF0YWJsZTpufTtyZXR1cm4gZS5NZXNoQnVpbGRlci5DcmVhdGVCb3godCxzLHIpfSxyLkNyZWF0ZVNwaGVyZT1mdW5jdGlvbih0LGkscixuLG8scyl7dmFyIGE9e3NlZ21lbnRzOmksZGlhbWV0ZXJYOnIsZGlhbWV0ZXJZOnIsZGlhbWV0ZXJaOnIsc2lkZU9yaWVudGF0aW9uOnMsdXBkYXRhYmxlOm99O3JldHVybiBlLk1lc2hCdWlsZGVyLkNyZWF0ZVNwaGVyZSh0LGEsbil9LHIuQ3JlYXRlQ3lsaW5kZXI9ZnVuY3Rpb24odCxpLG4sbyxzLGEsaCxjLGwpe3ZvaWQgMCE9PWgmJmggaW5zdGFuY2VvZiBlLlNjZW5lfHwodm9pZCAwIT09aCYmKGw9Y3x8ci5ERUZBVUxUU0lERSxjPWgpLGg9YSxhPTEpO3ZhciB1PXtoZWlnaHQ6aSxkaWFtZXRlclRvcDpuLGRpYW1ldGVyQm90dG9tOm8sdGVzc2VsbGF0aW9uOnMsc3ViZGl2aXNpb25zOmEsc2lkZU9yaWVudGF0aW9uOmwsdXBkYXRhYmxlOmN9O3JldHVybiBlLk1lc2hCdWlsZGVyLkNyZWF0ZUN5bGluZGVyKHQsdSxoKX0sci5DcmVhdGVUb3J1cz1mdW5jdGlvbih0LGkscixuLG8scyxhKXt2YXIgaD17ZGlhbWV0ZXI6aSx0aGlja25lc3M6cix0ZXNzZWxsYXRpb246bixzaWRlT3JpZW50YXRpb246YSx1cGRhdGFibGU6c307cmV0dXJuIGUuTWVzaEJ1aWxkZXIuQ3JlYXRlVG9ydXModCxoLG8pfSxyLkNyZWF0ZVRvcnVzS25vdD1mdW5jdGlvbih0LGkscixuLG8scyxhLGgsYyxsKXt2YXIgdT17cmFkaXVzOmksdHViZTpyLHJhZGlhbFNlZ21lbnRzOm4sdHVidWxhclNlZ21lbnRzOm8scDpzLHE6YSxzaWRlT3JpZW50YXRpb246bCx1cGRhdGFibGU6Y307cmV0dXJuIGUuTWVzaEJ1aWxkZXIuQ3JlYXRlVG9ydXNLbm90KHQsdSxoKX0sci5DcmVhdGVMaW5lcz1mdW5jdGlvbih0LGkscixuLG8pe3ZhciBzPXtwb2ludHM6aSx1cGRhdGFibGU6bixpbnN0YW5jZTpvfTtyZXR1cm4gZS5NZXNoQnVpbGRlci5DcmVhdGVMaW5lcyh0LHMscil9LHIuQ3JlYXRlRGFzaGVkTGluZXM9ZnVuY3Rpb24odCxpLHIsbixvLHMsYSxoKXt2YXIgYz17cG9pbnRzOmksZGFzaFNpemU6cixnYXBTaXplOm4sZGFzaE5iOm8sdXBkYXRhYmxlOmF9O3JldHVybiBlLk1lc2hCdWlsZGVyLkNyZWF0ZURhc2hlZExpbmVzKHQsYyxzKX0sci5FeHRydWRlU2hhcGU9ZnVuY3Rpb24odCxpLG4sbyxzLGEsaCxjLGwsdSl7dmFyIGY9e3NoYXBlOmkscGF0aDpuLHNjYWxlOm8scm90YXRpb246cyxjYXA6MD09PWE/MDphfHxyLk5PX0NBUCxzaWRlT3JpZW50YXRpb246bCxpbnN0YW5jZTp1LHVwZGF0YWJsZTpjfTtyZXR1cm4gZS5NZXNoQnVpbGRlci5FeHRydWRlU2hhcGUodCxmLGgpfSxyLkV4dHJ1ZGVTaGFwZUN1c3RvbT1mdW5jdGlvbih0LGksbixvLHMsYSxoLGMsbCx1LGYsZCl7dmFyIHA9e3NoYXBlOmkscGF0aDpuLHNjYWxlRnVuY3Rpb246byxyb3RhdGlvbkZ1bmN0aW9uOnMscmliYm9uQ2xvc2VBcnJheTphLHJpYmJvbkNsb3NlUGF0aDpoLGNhcDowPT09Yz8wOmN8fHIuTk9fQ0FQLHNpZGVPcmllbnRhdGlvbjpmLGluc3RhbmNlOmQsdXBkYXRhYmxlOnV9O3JldHVybiBlLk1lc2hCdWlsZGVyLkV4dHJ1ZGVTaGFwZUN1c3RvbSh0LHAsbCl9LHIuQ3JlYXRlTGF0aGU9ZnVuY3Rpb24odCxpLHIsbixvLHMsYSl7dmFyIGg9e3NoYXBlOmkscmFkaXVzOnIsdGVzc2VsbGF0aW9uOm4sc2lkZU9yaWVudGF0aW9uOmEsdXBkYXRhYmxlOnN9O3JldHVybiBlLk1lc2hCdWlsZGVyLkNyZWF0ZUxhdGhlKHQsaCxvKX0sci5DcmVhdGVQbGFuZT1mdW5jdGlvbih0LGkscixuLG8pe3ZhciBzPXtzaXplOmksd2lkdGg6aSxoZWlnaHQ6aSxzaWRlT3JpZW50YXRpb246byx1cGRhdGFibGU6bn07cmV0dXJuIGUuTWVzaEJ1aWxkZXIuQ3JlYXRlUGxhbmUodCxzLHIpfSxyLkNyZWF0ZUdyb3VuZD1mdW5jdGlvbih0LGkscixuLG8scyl7dmFyIGE9e3dpZHRoOmksaGVpZ2h0OnIsc3ViZGl2aXNpb25zOm4sdXBkYXRhYmxlOnN9O3JldHVybiBlLk1lc2hCdWlsZGVyLkNyZWF0ZUdyb3VuZCh0LGEsbyl9LHIuQ3JlYXRlVGlsZWRHcm91bmQ9ZnVuY3Rpb24odCxpLHIsbixvLHMsYSxoLGMpe3ZhciBsPXt4bWluOmksem1pbjpyLHhtYXg6bix6bWF4Om8sc3ViZGl2aXNpb25zOnMscHJlY2lzaW9uOmEsdXBkYXRhYmxlOmN9O3JldHVybiBlLk1lc2hCdWlsZGVyLkNyZWF0ZVRpbGVkR3JvdW5kKHQsbCxoKX0sci5DcmVhdGVHcm91bmRGcm9tSGVpZ2h0TWFwPWZ1bmN0aW9uKHQsaSxyLG4sbyxzLGEsaCxjLGwpe3ZhciB1PXt3aWR0aDpyLGhlaWdodDpuLHN1YmRpdmlzaW9uczpvLG1pbkhlaWdodDpzLG1heEhlaWdodDphLHVwZGF0YWJsZTpjLG9uUmVhZHk6bH07cmV0dXJuIGUuTWVzaEJ1aWxkZXIuQ3JlYXRlR3JvdW5kRnJvbUhlaWdodE1hcCh0LGksdSxoKX0sci5DcmVhdGVUdWJlPWZ1bmN0aW9uKHQsaSxyLG4sbyxzLGEsaCxjLGwpe3ZhciB1PXtwYXRoOmkscmFkaXVzOnIsdGVzc2VsbGF0aW9uOm4scmFkaXVzRnVuY3Rpb246byxhcmM6MSxjYXA6cyx1cGRhdGFibGU6aCxzaWRlT3JpZW50YXRpb246YyxpbnN0YW5jZTpsfTtyZXR1cm4gZS5NZXNoQnVpbGRlci5DcmVhdGVUdWJlKHQsdSxhKX0sci5DcmVhdGVQb2x5aGVkcm9uPWZ1bmN0aW9uKHQsaSxyKXtyZXR1cm4gZS5NZXNoQnVpbGRlci5DcmVhdGVQb2x5aGVkcm9uKHQsaSxyKX0sci5DcmVhdGVJY29TcGhlcmU9ZnVuY3Rpb24odCxpLHIpe3JldHVybiBlLk1lc2hCdWlsZGVyLkNyZWF0ZUljb1NwaGVyZSh0LGkscil9LHIuQ3JlYXRlRGVjYWw9ZnVuY3Rpb24odCxpLHIsbixvLHMpe3ZhciBhPXtwb3NpdGlvbjpyLG5vcm1hbDpuLHNpemU6byxhbmdsZTpzfTtyZXR1cm4gZS5NZXNoQnVpbGRlci5DcmVhdGVEZWNhbCh0LGksYSl9LHIucHJvdG90eXBlLnNldFBvc2l0aW9uc0ZvckNQVVNraW5uaW5nPWZ1bmN0aW9uKCl7dmFyIHQ7cmV0dXJuIHRoaXMuX3NvdXJjZVBvc2l0aW9uc3x8KHQ9dGhpcy5nZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuUG9zaXRpb25LaW5kKSx0aGlzLl9zb3VyY2VQb3NpdGlvbnM9bmV3IEZsb2F0MzJBcnJheSh0KSx0aGlzLmdldFZlcnRleEJ1ZmZlcihlLlZlcnRleEJ1ZmZlci5Qb3NpdGlvbktpbmQpLmlzVXBkYXRhYmxlKCl8fHRoaXMuc2V0VmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLlBvc2l0aW9uS2luZCx0LCEwKSksdGhpcy5fc291cmNlUG9zaXRpb25zfSxyLnByb3RvdHlwZS5zZXROb3JtYWxzRm9yQ1BVU2tpbm5pbmc9ZnVuY3Rpb24oKXt2YXIgdDtyZXR1cm4gdGhpcy5fc291cmNlTm9ybWFsc3x8KHQ9dGhpcy5nZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuTm9ybWFsS2luZCksdGhpcy5fc291cmNlTm9ybWFscz1uZXcgRmxvYXQzMkFycmF5KHQpLHRoaXMuZ2V0VmVydGV4QnVmZmVyKGUuVmVydGV4QnVmZmVyLk5vcm1hbEtpbmQpLmlzVXBkYXRhYmxlKCl8fHRoaXMuc2V0VmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLk5vcm1hbEtpbmQsdCwhMCkpLHRoaXMuX3NvdXJjZU5vcm1hbHN9LHIucHJvdG90eXBlLmFwcGx5U2tlbGV0b249ZnVuY3Rpb24odCl7aWYodGhpcy5nZW9tZXRyeSYmdGhpcy5nZW9tZXRyeS5fc29mdHdhcmVTa2lubmluZ1JlbmRlcklkIT10aGlzLmdldFNjZW5lKCkuZ2V0UmVuZGVySWQoKSl7aWYodGhpcy5nZW9tZXRyeS5fc29mdHdhcmVTa2lubmluZ1JlbmRlcklkPXRoaXMuZ2V0U2NlbmUoKS5nZXRSZW5kZXJJZCgpLCF0aGlzLmlzVmVydGljZXNEYXRhUHJlc2VudChlLlZlcnRleEJ1ZmZlci5Qb3NpdGlvbktpbmQpKXJldHVybiB0aGlzO2lmKCF0aGlzLmlzVmVydGljZXNEYXRhUHJlc2VudChlLlZlcnRleEJ1ZmZlci5Ob3JtYWxLaW5kKSlyZXR1cm4gdGhpcztpZighdGhpcy5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZS5WZXJ0ZXhCdWZmZXIuTWF0cmljZXNJbmRpY2VzS2luZCkpcmV0dXJuIHRoaXM7aWYoIXRoaXMuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGUuVmVydGV4QnVmZmVyLk1hdHJpY2VzV2VpZ2h0c0tpbmQpKXJldHVybiB0aGlzO3RoaXMuX3NvdXJjZVBvc2l0aW9uc3x8dGhpcy5zZXRQb3NpdGlvbnNGb3JDUFVTa2lubmluZygpLHRoaXMuX3NvdXJjZU5vcm1hbHN8fHRoaXMuc2V0Tm9ybWFsc0ZvckNQVVNraW5uaW5nKCk7dmFyIGk9dGhpcy5nZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuUG9zaXRpb25LaW5kKTtpIGluc3RhbmNlb2YgRmxvYXQzMkFycmF5fHwoaT1uZXcgRmxvYXQzMkFycmF5KGkpKTt2YXIgcj10aGlzLmdldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5Ob3JtYWxLaW5kKTtyIGluc3RhbmNlb2YgRmxvYXQzMkFycmF5fHwocj1uZXcgRmxvYXQzMkFycmF5KHIpKTtmb3IodmFyIG4sbz10aGlzLmdldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5NYXRyaWNlc0luZGljZXNLaW5kKSxzPXRoaXMuZ2V0VmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLk1hdHJpY2VzV2VpZ2h0c0tpbmQpLGE9dGhpcy5udW1Cb25lSW5mbHVlbmNlcnM+NCxoPWE/dGhpcy5nZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuTWF0cmljZXNJbmRpY2VzRXh0cmFLaW5kKTpudWxsLGM9YT90aGlzLmdldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5NYXRyaWNlc1dlaWdodHNFeHRyYUtpbmQpOm51bGwsbD10LmdldFRyYW5zZm9ybU1hdHJpY2VzKHRoaXMpLHU9ZS5WZWN0b3IzLlplcm8oKSxmPW5ldyBlLk1hdHJpeCxkPW5ldyBlLk1hdHJpeCxwPTAsXz0wO188aS5sZW5ndGg7Xys9MyxwKz00KXt2YXIgbTtmb3Iobj0wOzQ+biYmKG09c1twK25dLG0+MCk7bisrKWUuTWF0cml4LkZyb21GbG9hdDMyQXJyYXlUb1JlZlNjYWxlZChsLDE2Km9bcCtuXSxtLGQpLGYuYWRkVG9TZWxmKGQpO2lmKGEpZm9yKG49MDs0Pm4mJihtPWNbcCtuXSxtPjApO24rKyllLk1hdHJpeC5Gcm9tRmxvYXQzMkFycmF5VG9SZWZTY2FsZWQobCwxNipoW3Arbl0sbSxkKSxmLmFkZFRvU2VsZihkKTtlLlZlY3RvcjMuVHJhbnNmb3JtQ29vcmRpbmF0ZXNGcm9tRmxvYXRzVG9SZWYodGhpcy5fc291cmNlUG9zaXRpb25zW19dLHRoaXMuX3NvdXJjZVBvc2l0aW9uc1tfKzFdLHRoaXMuX3NvdXJjZVBvc2l0aW9uc1tfKzJdLGYsdSksdS50b0FycmF5KGksXyksZS5WZWN0b3IzLlRyYW5zZm9ybU5vcm1hbEZyb21GbG9hdHNUb1JlZih0aGlzLl9zb3VyY2VOb3JtYWxzW19dLHRoaXMuX3NvdXJjZU5vcm1hbHNbXysxXSx0aGlzLl9zb3VyY2VOb3JtYWxzW18rMl0sZix1KSx1LnRvQXJyYXkocixfKSxmLnJlc2V0KCl9cmV0dXJuIHRoaXMudXBkYXRlVmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLlBvc2l0aW9uS2luZCxpKSx0aGlzLnVwZGF0ZVZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5Ob3JtYWxLaW5kLHIpLHRoaXN9fSxyLk1pbk1heD1mdW5jdGlvbihlKXt2YXIgdD1udWxsLGk9bnVsbDtmb3IodmFyIHIgaW4gZSl7dmFyIG49ZVtyXSxvPW4uZ2V0Qm91bmRpbmdJbmZvKCkuYm91bmRpbmdCb3g7dD8odC5NaW5pbWl6ZUluUGxhY2Uoby5taW5pbXVtV29ybGQpLGkuTWF4aW1pemVJblBsYWNlKG8ubWF4aW11bVdvcmxkKSk6KHQ9by5taW5pbXVtV29ybGQsaT1vLm1heGltdW1Xb3JsZCl9cmV0dXJue21pbjp0LG1heDppfX0sci5DZW50ZXI9ZnVuY3Rpb24odCl7dmFyIGk9dm9pZCAwIT09dC5taW4/dDpyLk1pbk1heCh0KTtyZXR1cm4gZS5WZWN0b3IzLkNlbnRlcihpLm1pbixpLm1heCl9LHIuTWVyZ2VNZXNoZXM9ZnVuY3Rpb24odCxpLG4sbyl7dm9pZCAwPT09aSYmKGk9ITApO3ZhciBzO2lmKCFuKXt2YXIgYT0wO2ZvcihzPTA7czx0Lmxlbmd0aDtzKyspaWYodFtzXSYmKGErPXRbc10uZ2V0VG90YWxWZXJ0aWNlcygpLGE+NjU1MzYpKXJldHVybiBlLlRvb2xzLldhcm4oXCJDYW5ub3QgbWVyZ2UgbWVzaGVzIGJlY2F1c2UgcmVzdWx0aW5nIG1lc2ggd2lsbCBoYXZlIG1vcmUgdGhhbiA2NTUzNiB2ZXJ0aWNlcy4gUGxlYXNlIHVzZSBhbGxvdzMyQml0c0luZGljZXMgPSB0cnVlIHRvIHVzZSAzMiBiaXRzIGluZGljZXNcIiksbnVsbH12YXIgaCxjLGw7Zm9yKHM9MDtzPHQubGVuZ3RoO3MrKyl0W3NdJiYodFtzXS5jb21wdXRlV29ybGRNYXRyaXgoITApLGM9ZS5WZXJ0ZXhEYXRhLkV4dHJhY3RGcm9tTWVzaCh0W3NdLCEwKSxjLnRyYW5zZm9ybSh0W3NdLmdldFdvcmxkTWF0cml4KCkpLGg/aC5tZXJnZShjKTooaD1jLGw9dFtzXSkpO2lmKG98fChvPW5ldyByKGwubmFtZStcIl9tZXJnZWRcIixsLmdldFNjZW5lKCkpKSxoLmFwcGx5VG9NZXNoKG8pLG8ubWF0ZXJpYWw9bC5tYXRlcmlhbCxvLmNoZWNrQ29sbGlzaW9ucz1sLmNoZWNrQ29sbGlzaW9ucyxpKWZvcihzPTA7czx0Lmxlbmd0aDtzKyspdFtzXSYmdFtzXS5kaXNwb3NlKCk7cmV0dXJuIG99LHIuX0ZST05UU0lERT0wLHIuX0JBQ0tTSURFPTEsci5fRE9VQkxFU0lERT0yLHIuX0RFRkFVTFRTSURFPTAsci5fTk9fQ0FQPTAsci5fQ0FQX1NUQVJUPTEsci5fQ0FQX0VORD0yLHIuX0NBUF9BTEw9MyxyfShlLkFic3RyYWN0TWVzaCk7ZS5NZXNoPWl9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdChlLHQsaSxyLG4sbyxzLGEpe3ZvaWQgMD09PWEmJihhPSEwKSx0aGlzLm1hdGVyaWFsSW5kZXg9ZSx0aGlzLnZlcnRpY2VzU3RhcnQ9dCx0aGlzLnZlcnRpY2VzQ291bnQ9aSx0aGlzLmluZGV4U3RhcnQ9cix0aGlzLmluZGV4Q291bnQ9bix0aGlzLl9yZW5kZXJJZD0wLHRoaXMuX21lc2g9byx0aGlzLl9yZW5kZXJpbmdNZXNoPXN8fG8sby5zdWJNZXNoZXMucHVzaCh0aGlzKSx0aGlzLl90cmlhbmdsZVBsYW5lcz1bXSx0aGlzLl9pZD1vLnN1Yk1lc2hlcy5sZW5ndGgtMSxhJiYodGhpcy5yZWZyZXNoQm91bmRpbmdJbmZvKCksby5jb21wdXRlV29ybGRNYXRyaXgoITApKX1yZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwiSXNHbG9iYWxcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIDA9PT10aGlzLnZlcnRpY2VzU3RhcnQmJnRoaXMudmVydGljZXNDb3VudD09dGhpcy5fbWVzaC5nZXRUb3RhbFZlcnRpY2VzKCl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksdC5wcm90b3R5cGUuZ2V0Qm91bmRpbmdJbmZvPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuSXNHbG9iYWw/dGhpcy5fbWVzaC5nZXRCb3VuZGluZ0luZm8oKTp0aGlzLl9ib3VuZGluZ0luZm99LHQucHJvdG90eXBlLmdldE1lc2g9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fbWVzaH0sdC5wcm90b3R5cGUuZ2V0UmVuZGVyaW5nTWVzaD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9yZW5kZXJpbmdNZXNofSx0LnByb3RvdHlwZS5nZXRNYXRlcmlhbD1mdW5jdGlvbigpe3ZhciB0PXRoaXMuX3JlbmRlcmluZ01lc2gubWF0ZXJpYWw7aWYodCYmdCBpbnN0YW5jZW9mIGUuTXVsdGlNYXRlcmlhbCl7dmFyIGk9dDtyZXR1cm4gaS5nZXRTdWJNYXRlcmlhbCh0aGlzLm1hdGVyaWFsSW5kZXgpfXJldHVybiB0P3Q6dGhpcy5fbWVzaC5nZXRTY2VuZSgpLmRlZmF1bHRNYXRlcmlhbH0sdC5wcm90b3R5cGUucmVmcmVzaEJvdW5kaW5nSW5mbz1mdW5jdGlvbigpe2lmKHRoaXMuX2xhc3RDb2xsaWRlcldvcmxkVmVydGljZXM9bnVsbCwhdGhpcy5Jc0dsb2JhbCl7dmFyIHQ9dGhpcy5fcmVuZGVyaW5nTWVzaC5nZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuUG9zaXRpb25LaW5kKTtpZighdClyZXR1cm4gdm9pZCh0aGlzLl9ib3VuZGluZ0luZm89dGhpcy5fbWVzaC5fYm91bmRpbmdJbmZvKTt2YXIgaSxyPXRoaXMuX3JlbmRlcmluZ01lc2guZ2V0SW5kaWNlcygpO2k9MD09PXRoaXMuaW5kZXhTdGFydCYmdGhpcy5pbmRleENvdW50PT09ci5sZW5ndGg/e21pbmltdW06dGhpcy5fcmVuZGVyaW5nTWVzaC5nZXRCb3VuZGluZ0luZm8oKS5taW5pbXVtLmNsb25lKCksbWF4aW11bTp0aGlzLl9yZW5kZXJpbmdNZXNoLmdldEJvdW5kaW5nSW5mbygpLm1heGltdW0uY2xvbmUoKX06ZS5Ub29scy5FeHRyYWN0TWluQW5kTWF4SW5kZXhlZCh0LHIsdGhpcy5pbmRleFN0YXJ0LHRoaXMuaW5kZXhDb3VudCx0aGlzLl9yZW5kZXJpbmdNZXNoLmdlb21ldHJ5LmJvdW5kaW5nQmlhcyksdGhpcy5fYm91bmRpbmdJbmZvPW5ldyBlLkJvdW5kaW5nSW5mbyhpLm1pbmltdW0saS5tYXhpbXVtKX19LHQucHJvdG90eXBlLl9jaGVja0NvbGxpc2lvbj1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5nZXRCb3VuZGluZ0luZm8oKS5fY2hlY2tDb2xsaXNpb24oZSl9LHQucHJvdG90eXBlLnVwZGF0ZUJvdW5kaW5nSW5mbz1mdW5jdGlvbihlKXt0aGlzLmdldEJvdW5kaW5nSW5mbygpfHx0aGlzLnJlZnJlc2hCb3VuZGluZ0luZm8oKSx0aGlzLmdldEJvdW5kaW5nSW5mbygpLnVwZGF0ZShlKX0sdC5wcm90b3R5cGUuaXNJbkZydXN0dW09ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuZ2V0Qm91bmRpbmdJbmZvKCkuaXNJbkZydXN0dW0oZSl9LHQucHJvdG90eXBlLnJlbmRlcj1mdW5jdGlvbihlKXt0aGlzLl9yZW5kZXJpbmdNZXNoLnJlbmRlcih0aGlzLGUpfSx0LnByb3RvdHlwZS5nZXRMaW5lc0luZGV4QnVmZmVyPWZ1bmN0aW9uKGUsdCl7aWYoIXRoaXMuX2xpbmVzSW5kZXhCdWZmZXIpe2Zvcih2YXIgaT1bXSxyPXRoaXMuaW5kZXhTdGFydDtyPHRoaXMuaW5kZXhTdGFydCt0aGlzLmluZGV4Q291bnQ7cis9MylpLnB1c2goZVtyXSxlW3IrMV0sZVtyKzFdLGVbcisyXSxlW3IrMl0sZVtyXSk7dGhpcy5fbGluZXNJbmRleEJ1ZmZlcj10LmNyZWF0ZUluZGV4QnVmZmVyKGkpLHRoaXMubGluZXNJbmRleENvdW50PWkubGVuZ3RofXJldHVybiB0aGlzLl9saW5lc0luZGV4QnVmZmVyfSx0LnByb3RvdHlwZS5jYW5JbnRlcnNlY3RzPWZ1bmN0aW9uKGUpe3JldHVybiBlLmludGVyc2VjdHNCb3godGhpcy5nZXRCb3VuZGluZ0luZm8oKS5ib3VuZGluZ0JveCl9LHQucHJvdG90eXBlLmludGVyc2VjdHM9ZnVuY3Rpb24odCxpLHIsbil7dmFyIG89bnVsbDtpZih0aGlzLl9tZXNoIGluc3RhbmNlb2YgZS5MaW5lc01lc2gpZm9yKHZhciBzPXRoaXMuX21lc2gsYT10aGlzLmluZGV4U3RhcnQ7YTx0aGlzLmluZGV4U3RhcnQrdGhpcy5pbmRleENvdW50O2ErPTIpe3ZhciBoPWlbclthXV0sYz1pW3JbYSsxXV0sbD10LmludGVyc2VjdGlvblNlZ21lbnQoaCxjLHMuaW50ZXJzZWN0aW9uVGhyZXNob2xkKTtpZighKDA+bCkmJihufHwhb3x8bDxvLmRpc3RhbmNlKSYmKG89bmV3IGUuSW50ZXJzZWN0aW9uSW5mbyhudWxsLG51bGwsbCksbikpYnJlYWt9ZWxzZSBmb3IodmFyIGE9dGhpcy5pbmRleFN0YXJ0O2E8dGhpcy5pbmRleFN0YXJ0K3RoaXMuaW5kZXhDb3VudDthKz0zKXt2YXIgaD1pW3JbYV1dLGM9aVtyW2ErMV1dLHU9aVtyW2ErMl1dLGY9dC5pbnRlcnNlY3RzVHJpYW5nbGUoaCxjLHUpO2lmKGYpe2lmKGYuZGlzdGFuY2U8MCljb250aW51ZTtpZigobnx8IW98fGYuZGlzdGFuY2U8by5kaXN0YW5jZSkmJihvPWYsby5mYWNlSWQ9YS8zLG4pKWJyZWFrfX1yZXR1cm4gb30sdC5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oaSxyKXt2YXIgbj1uZXcgdCh0aGlzLm1hdGVyaWFsSW5kZXgsdGhpcy52ZXJ0aWNlc1N0YXJ0LHRoaXMudmVydGljZXNDb3VudCx0aGlzLmluZGV4U3RhcnQsdGhpcy5pbmRleENvdW50LGksciwhMSk7cmV0dXJuIHRoaXMuSXNHbG9iYWx8fChuLl9ib3VuZGluZ0luZm89bmV3IGUuQm91bmRpbmdJbmZvKHRoaXMuZ2V0Qm91bmRpbmdJbmZvKCkubWluaW11bSx0aGlzLmdldEJvdW5kaW5nSW5mbygpLm1heGltdW0pKSxufSx0LnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7dGhpcy5fbGluZXNJbmRleEJ1ZmZlciYmKHRoaXMuX21lc2guZ2V0U2NlbmUoKS5nZXRFbmdpbmUoKS5fcmVsZWFzZUJ1ZmZlcih0aGlzLl9saW5lc0luZGV4QnVmZmVyKSx0aGlzLl9saW5lc0luZGV4QnVmZmVyPW51bGwpO3ZhciBlPXRoaXMuX21lc2guc3ViTWVzaGVzLmluZGV4T2YodGhpcyk7dGhpcy5fbWVzaC5zdWJNZXNoZXMuc3BsaWNlKGUsMSl9LHQuQ3JlYXRlRnJvbUluZGljZXM9ZnVuY3Rpb24oZSxpLHIsbixvKXt2YXIgcz1OdW1iZXIuTUFYX1ZBTFVFLGE9LU51bWJlci5NQVhfVkFMVUU7bz1vfHxuO2Zvcih2YXIgaD1vLmdldEluZGljZXMoKSxjPWk7aStyPmM7YysrKXt2YXIgbD1oW2NdO3M+bCYmKHM9bCksbD5hJiYoYT1sKX1yZXR1cm4gbmV3IHQoZSxzLGEtcysxLGkscixuLG8pfSx0fSgpO2UuU3ViTWVzaD10fShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoKXt9cmV0dXJuIHQuQ3JlYXRlQm94PWZ1bmN0aW9uKHQsaSxyKXt2YXIgbj1uZXcgZS5NZXNoKHQsciksbz1lLlZlcnRleERhdGEuQ3JlYXRlQm94KGkpO3JldHVybiBvLmFwcGx5VG9NZXNoKG4saS51cGRhdGFibGUpLG59LHQuQ3JlYXRlU3BoZXJlPWZ1bmN0aW9uKHQsaSxyKXt2YXIgbj1uZXcgZS5NZXNoKHQsciksbz1lLlZlcnRleERhdGEuQ3JlYXRlU3BoZXJlKGkpO3JldHVybiBvLmFwcGx5VG9NZXNoKG4saS51cGRhdGFibGUpLG59LHQuQ3JlYXRlRGlzYz1mdW5jdGlvbih0LGkscil7dmFyIG49bmV3IGUuTWVzaCh0LHIpLG89ZS5WZXJ0ZXhEYXRhLkNyZWF0ZURpc2MoaSk7cmV0dXJuIG8uYXBwbHlUb01lc2gobixpLnVwZGF0YWJsZSksbn0sdC5DcmVhdGVJY29TcGhlcmU9ZnVuY3Rpb24odCxpLHIpe3ZhciBuPW5ldyBlLk1lc2godCxyKSxvPWUuVmVydGV4RGF0YS5DcmVhdGVJY29TcGhlcmUoaSk7cmV0dXJuIG8uYXBwbHlUb01lc2gobixpLnVwZGF0YWJsZSksbn0sdC5DcmVhdGVSaWJib249ZnVuY3Rpb24odCxpLHIpe3ZhciBuPWkucGF0aEFycmF5LG89aS5jbG9zZUFycmF5LHM9aS5jbG9zZVBhdGgsYT0oaS5vZmZzZXQsaS5zaWRlT3JpZW50YXRpb24pLGg9aS5pbnN0YW5jZSxjPWkudXBkYXRhYmxlO2lmKGgpe3ZhciBsPWZ1bmN0aW9uKHQpe2Zvcih2YXIgaT1uWzBdLmxlbmd0aCxyPTAsbz1oLnNpZGVPcmllbnRhdGlvbj09PWUuTWVzaC5ET1VCTEVTSURFPzI6MSxzPTE7bz49cztzKyspZm9yKHZhciBhPTA7YTxuLmxlbmd0aDthKyspe3ZhciBjPW5bYV0sbD1jLmxlbmd0aDtpPWw+aT9pOmw7Zm9yKHZhciB1PTA7aT51Oyl0W3JdPWNbdV0ueCx0W3IrMV09Y1t1XS55LHRbcisyXT1jW3VdLnosdSsrLHIrPTM7aC5fY2xvc2VQYXRoJiYodFtyXT1jWzBdLngsdFtyKzFdPWNbMF0ueSx0W3IrMl09Y1swXS56LHIrPTMpfX0sdT1oLmdldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5Qb3NpdGlvbktpbmQpO2lmKGwodSksaC51cGRhdGVWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuUG9zaXRpb25LaW5kLHUsITEsITEpLCFoLmFyZU5vcm1hbHNGcm96ZW4pe3ZhciBmPWguZ2V0SW5kaWNlcygpLGQ9aC5nZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuTm9ybWFsS2luZCk7aWYoZS5WZXJ0ZXhEYXRhLkNvbXB1dGVOb3JtYWxzKHUsZixkKSxoLl9jbG9zZVBhdGgpZm9yKHZhciBwPTAsXz0wLG09MDttPG4ubGVuZ3RoO20rKylwPTMqaC5faWR4W21dLF89bSsxPG4ubGVuZ3RoPzMqKGguX2lkeFttKzFdLTEpOmQubGVuZ3RoLTMsZFtwXT0uNSooZFtwXStkW19dKSxkW3ArMV09LjUqKGRbcCsxXStkW18rMV0pLGRbcCsyXT0uNSooZFtwKzJdK2RbXysyXSksZFtfXT1kW3BdLGRbXysxXT1kW3ArMV0sZFtfKzJdPWRbcCsyXTtoLnVwZGF0ZVZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5Ob3JtYWxLaW5kLGQsITEsITEpO1xufXJldHVybiBofXZhciBnPW5ldyBlLk1lc2godCxyKTtnLnNpZGVPcmllbnRhdGlvbj1hO3ZhciB2PWUuVmVydGV4RGF0YS5DcmVhdGVSaWJib24oaSk7cmV0dXJuIHMmJihnLl9pZHg9di5faWR4KSxnLl9jbG9zZVBhdGg9cyxnLl9jbG9zZUFycmF5PW8sdi5hcHBseVRvTWVzaChnLGMpLGd9LHQuQ3JlYXRlQ3lsaW5kZXI9ZnVuY3Rpb24odCxpLHIpe3ZhciBuPW5ldyBlLk1lc2godCxyKSxvPWUuVmVydGV4RGF0YS5DcmVhdGVDeWxpbmRlcihpKTtyZXR1cm4gby5hcHBseVRvTWVzaChuLGkudXBkYXRhYmxlKSxufSx0LkNyZWF0ZVRvcnVzPWZ1bmN0aW9uKHQsaSxyKXt2YXIgbj1uZXcgZS5NZXNoKHQsciksbz1lLlZlcnRleERhdGEuQ3JlYXRlVG9ydXMoaSk7cmV0dXJuIG8uYXBwbHlUb01lc2gobixpLnVwZGF0YWJsZSksbn0sdC5DcmVhdGVUb3J1c0tub3Q9ZnVuY3Rpb24odCxpLHIpe3ZhciBuPW5ldyBlLk1lc2godCxyKSxvPWUuVmVydGV4RGF0YS5DcmVhdGVUb3J1c0tub3QoaSk7cmV0dXJuIG8uYXBwbHlUb01lc2gobixpLnVwZGF0YWJsZSksbn0sdC5DcmVhdGVMaW5lU3lzdGVtPWZ1bmN0aW9uKHQsaSxyKXt2YXIgbj1pLmluc3RhbmNlLG89aS5saW5lcztpZihuKXt2YXIgcz1mdW5jdGlvbihlKXtmb3IodmFyIHQ9MCxpPTA7aTxvLmxlbmd0aDtpKyspZm9yKHZhciByPW9baV0sbj0wO248ci5sZW5ndGg7bisrKWVbdF09cltuXS54LGVbdCsxXT1yW25dLnksZVt0KzJdPXJbbl0ueix0Kz0zfTtyZXR1cm4gbi51cGRhdGVNZXNoUG9zaXRpb25zKHMsITEpLG59dmFyIGE9bmV3IGUuTGluZXNNZXNoKHQsciksaD1lLlZlcnRleERhdGEuQ3JlYXRlTGluZVN5c3RlbShpKTtyZXR1cm4gaC5hcHBseVRvTWVzaChhLGkudXBkYXRhYmxlKSxhfSx0LkNyZWF0ZUxpbmVzPWZ1bmN0aW9uKGUsaSxyKXt2YXIgbj10LkNyZWF0ZUxpbmVTeXN0ZW0oZSx7bGluZXM6W2kucG9pbnRzXSx1cGRhdGFibGU6aS51cGRhdGFibGUsaW5zdGFuY2U6aS5pbnN0YW5jZX0scik7cmV0dXJuIG59LHQuQ3JlYXRlRGFzaGVkTGluZXM9ZnVuY3Rpb24odCxpLHIpe3ZhciBuPWkucG9pbnRzLG89aS5pbnN0YW5jZSxzPWkuZ2FwU2l6ZSxhPShpLmRhc2hOYixpLmRhc2hTaXplKTtpZihvKXt2YXIgaD1mdW5jdGlvbih0KXt2YXIgaT1lLlZlY3RvcjMuWmVybygpLHI9dC5sZW5ndGgvNixzPTAsYT0wLGg9MCxjPTAsbD0wLHU9MCxmPTAsZD0wO2ZvcihmPTA7ZjxuLmxlbmd0aC0xO2YrKyluW2YrMV0uc3VidHJhY3RUb1JlZihuW2ZdLGkpLHMrPWkubGVuZ3RoKCk7Zm9yKGg9cy9yLGM9by5kYXNoU2l6ZSpoLyhvLmRhc2hTaXplK28uZ2FwU2l6ZSksZj0wO2Y8bi5sZW5ndGgtMTtmKyspZm9yKG5bZisxXS5zdWJ0cmFjdFRvUmVmKG5bZl0saSksYT1NYXRoLmZsb29yKGkubGVuZ3RoKCkvaCksaS5ub3JtYWxpemUoKSxkPTA7YT5kJiZ1PHQubGVuZ3RoOylsPWgqZCx0W3VdPW5bZl0ueCtsKmkueCx0W3UrMV09bltmXS55K2wqaS55LHRbdSsyXT1uW2ZdLnorbCppLnosdFt1KzNdPW5bZl0ueCsobCtjKSppLngsdFt1KzRdPW5bZl0ueSsobCtjKSppLnksdFt1KzVdPW5bZl0ueisobCtjKSppLnosdSs9NixkKys7Zm9yKDt1PHQubGVuZ3RoOyl0W3VdPW5bZl0ueCx0W3UrMV09bltmXS55LHRbdSsyXT1uW2ZdLnosdSs9M307cmV0dXJuIG8udXBkYXRlTWVzaFBvc2l0aW9ucyhoLCExKSxvfXZhciBjPW5ldyBlLkxpbmVzTWVzaCh0LHIpLGw9ZS5WZXJ0ZXhEYXRhLkNyZWF0ZURhc2hlZExpbmVzKGkpO3JldHVybiBsLmFwcGx5VG9NZXNoKGMsaS51cGRhdGFibGUpLGMuZGFzaFNpemU9YSxjLmdhcFNpemU9cyxjfSx0LkV4dHJ1ZGVTaGFwZT1mdW5jdGlvbihpLHIsbil7dmFyIG89ci5wYXRoLHM9ci5zaGFwZSxhPXIuc2NhbGV8fDEsaD1yLnJvdGF0aW9ufHwwLGM9MD09PXIuY2FwPzA6ci5jYXB8fGUuTWVzaC5OT19DQVAsbD1yLnVwZGF0YWJsZSx1PTA9PT1yLnNpZGVPcmllbnRhdGlvbj8wOnIuc2lkZU9yaWVudGF0aW9ufHxlLk1lc2guREVGQVVMVFNJREUsZj1yLmluc3RhbmNlO3JldHVybiB0Ll9FeHRydWRlU2hhcGVHZW5lcmljKGkscyxvLGEsaCxudWxsLG51bGwsITEsITEsYywhMSxuLGwsdSxmKX0sdC5FeHRydWRlU2hhcGVDdXN0b209ZnVuY3Rpb24oaSxyLG4pe3ZhciBvPXIucGF0aCxzPXIuc2hhcGUsYT1yLnNjYWxlRnVuY3Rpb258fGZ1bmN0aW9uKCl7cmV0dXJuIDF9LGg9ci5yb3RhdGlvbkZ1bmN0aW9ufHxmdW5jdGlvbigpe3JldHVybiAwfSxjPXIucmliYm9uQ2xvc2VBcnJheXx8ITEsbD1yLnJpYmJvbkNsb3NlUGF0aHx8ITEsdT0wPT09ci5jYXA/MDpyLmNhcHx8ZS5NZXNoLk5PX0NBUCxmPXIudXBkYXRhYmxlLGQ9MD09PXIuc2lkZU9yaWVudGF0aW9uPzA6ci5zaWRlT3JpZW50YXRpb258fGUuTWVzaC5ERUZBVUxUU0lERSxwPXIuaW5zdGFuY2U7cmV0dXJuIHQuX0V4dHJ1ZGVTaGFwZUdlbmVyaWMoaSxzLG8sbnVsbCxudWxsLGEsaCxjLGwsdSwhMCxuLGYsZCxwKX0sdC5DcmVhdGVMYXRoZT1mdW5jdGlvbihpLHIsbil7dmFyIG8scz1yLmFyYzw9MHx8ci5hcmM+MT8xOnIuYXJjfHwxLGE9dm9pZCAwPT09ci5jbG9zZWQ/ITA6ci5jbG9zZWQsaD1yLnNoYXBlLGM9ci5yYWRpdXN8fDEsbD1yLnRlc3NlbGxhdGlvbnx8NjQsdT1yLnVwZGF0YWJsZSxmPTA9PT1yLnNpZGVPcmllbnRhdGlvbj8wOnIuc2lkZU9yaWVudGF0aW9ufHxlLk1lc2guREVGQVVMVFNJREUsZD1yLmNhcHx8ZS5NZXNoLk5PX0NBUCxwPTIqTWF0aC5QSSxfPW5ldyBBcnJheSxtPTAsZz0wLHY9cC9sKnMseT1uZXcgQXJyYXk7Zm9yKG09MDtsPj1tO20rKyl7dmFyIHk9W107Zm9yKGQhPWUuTWVzaC5DQVBfU1RBUlQmJmQhPWUuTWVzaC5DQVBfQUxMfHwoeS5wdXNoKG5ldyBlLlZlY3RvcjMoMCxoWzBdLnksMCkpLHkucHVzaChuZXcgZS5WZWN0b3IzKE1hdGguY29zKG0qdikqaFswXS54KmMsaFswXS55LE1hdGguc2luKG0qdikqaFswXS54KmMpKSksZz0wO2c8aC5sZW5ndGg7ZysrKW89bmV3IGUuVmVjdG9yMyhNYXRoLmNvcyhtKnYpKmhbZ10ueCpjLGhbZ10ueSxNYXRoLnNpbihtKnYpKmhbZ10ueCpjKSx5LnB1c2gobyk7ZCE9ZS5NZXNoLkNBUF9FTkQmJmQhPWUuTWVzaC5DQVBfQUxMfHwoeS5wdXNoKG5ldyBlLlZlY3RvcjMoTWF0aC5jb3MobSp2KSpoW2gubGVuZ3RoLTFdLngqYyxoW2gubGVuZ3RoLTFdLnksTWF0aC5zaW4obSp2KSpoW2gubGVuZ3RoLTFdLngqYykpLHkucHVzaChuZXcgZS5WZWN0b3IzKDAsaFtoLmxlbmd0aC0xXS55LDApKSksXy5wdXNoKHkpfXZhciB4PXQuQ3JlYXRlUmliYm9uKGkse3BhdGhBcnJheTpfLGNsb3NlQXJyYXk6YSxzaWRlT3JpZW50YXRpb246Zix1cGRhdGFibGU6dX0sbik7cmV0dXJuIHh9LHQuQ3JlYXRlUGxhbmU9ZnVuY3Rpb24odCxpLHIpe3ZhciBuPW5ldyBlLk1lc2godCxyKSxvPWUuVmVydGV4RGF0YS5DcmVhdGVQbGFuZShpKTtpZihvLmFwcGx5VG9NZXNoKG4saS51cGRhdGFibGUpLGkuc291cmNlUGxhbmUpe24udHJhbnNsYXRlKGkuc291cmNlUGxhbmUubm9ybWFsLGkuc291cmNlUGxhbmUuZCk7dmFyIHM9TWF0aC5hY29zKGUuVmVjdG9yMy5Eb3QoaS5zb3VyY2VQbGFuZS5ub3JtYWwsZS5BeGlzLlopKSxhPWUuVmVjdG9yMy5Dcm9zcyhlLkF4aXMuWixpLnNvdXJjZVBsYW5lLm5vcm1hbCk7bi5yb3RhdGUoYSxzKX1yZXR1cm4gbn0sdC5DcmVhdGVHcm91bmQ9ZnVuY3Rpb24odCxpLHIpe3ZhciBuPW5ldyBlLkdyb3VuZE1lc2godCxyKTtuLl9zZXRSZWFkeSghMSksbi5fc3ViZGl2aXNpb25zPWkuc3ViZGl2aXNpb25zfHwxLG4uX3dpZHRoPWkud2lkdGh8fDEsbi5faGVpZ2h0PWkuaGVpZ2h0fHwxLG4uX21heFg9bi5fd2lkdGgvMixuLl9tYXhaPW4uX2hlaWdodC8yLG4uX21pblg9LW4uX21heFgsbi5fbWluWj0tbi5fbWF4Wjt2YXIgbz1lLlZlcnRleERhdGEuQ3JlYXRlR3JvdW5kKGkpO3JldHVybiBvLmFwcGx5VG9NZXNoKG4saS51cGRhdGFibGUpLG4uX3NldFJlYWR5KCEwKSxufSx0LkNyZWF0ZVRpbGVkR3JvdW5kPWZ1bmN0aW9uKHQsaSxyKXt2YXIgbj1uZXcgZS5NZXNoKHQsciksbz1lLlZlcnRleERhdGEuQ3JlYXRlVGlsZWRHcm91bmQoaSk7cmV0dXJuIG8uYXBwbHlUb01lc2gobixpLnVwZGF0YWJsZSksbn0sdC5DcmVhdGVHcm91bmRGcm9tSGVpZ2h0TWFwPWZ1bmN0aW9uKHQsaSxyLG4pe3ZhciBvPXIud2lkdGh8fDEwLHM9ci5oZWlnaHR8fDEwLGE9ci5zdWJkaXZpc2lvbnN8fDEsaD1yLm1pbkhlaWdodCxjPXIubWF4SGVpZ2h0fHwxMCxsPXIudXBkYXRhYmxlLHU9ci5vblJlYWR5LGY9bmV3IGUuR3JvdW5kTWVzaCh0LG4pO2YuX3N1YmRpdmlzaW9ucz1hLGYuX3dpZHRoPW8sZi5faGVpZ2h0PXMsZi5fbWF4WD1mLl93aWR0aC8yLGYuX21heFo9Zi5faGVpZ2h0LzIsZi5fbWluWD0tZi5fbWF4WCxmLl9taW5aPS1mLl9tYXhaLGYuX3NldFJlYWR5KCExKTt2YXIgZD1mdW5jdGlvbih0KXt2YXIgaT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpLHI9aS5nZXRDb250ZXh0KFwiMmRcIiksbj10LndpZHRoLGQ9dC5oZWlnaHQ7aS53aWR0aD1uLGkuaGVpZ2h0PWQsci5kcmF3SW1hZ2UodCwwLDApO3ZhciBwPXIuZ2V0SW1hZ2VEYXRhKDAsMCxuLGQpLmRhdGEsXz1lLlZlcnRleERhdGEuQ3JlYXRlR3JvdW5kRnJvbUhlaWdodE1hcCh7d2lkdGg6byxoZWlnaHQ6cyxzdWJkaXZpc2lvbnM6YSxtaW5IZWlnaHQ6aCxtYXhIZWlnaHQ6YyxidWZmZXI6cCxidWZmZXJXaWR0aDpuLGJ1ZmZlckhlaWdodDpkfSk7Xy5hcHBseVRvTWVzaChmLGwpLGYuX3NldFJlYWR5KCEwKSx1JiZ1KGYpfTtyZXR1cm4gZS5Ub29scy5Mb2FkSW1hZ2UoaSxkLGZ1bmN0aW9uKCl7fSxuLmRhdGFiYXNlKSxmfSx0LkNyZWF0ZVR1YmU9ZnVuY3Rpb24oaSxyLG4pe3ZhciBvPXIucGF0aCxzPXIucmFkaXVzfHwxLGE9ci50ZXNzZWxsYXRpb258fDY0LGg9ci5yYWRpdXNGdW5jdGlvbixjPXIuY2FwfHxlLk1lc2guTk9fQ0FQLGw9ci51cGRhdGFibGUsdT1yLnNpZGVPcmllbnRhdGlvbnx8ZS5NZXNoLkRFRkFVTFRTSURFLGY9ci5pbnN0YW5jZTtyLmFyYz1yLmFyYzw9MHx8ci5hcmM+MT8xOnIuYXJjfHwxO3ZhciBkLHAsXz1mdW5jdGlvbih0LGkscixuLG8scyxhLGgpe2Zvcih2YXIgYyxsLHUsZixkPWkuZ2V0VGFuZ2VudHMoKSxwPWkuZ2V0Tm9ybWFscygpLF89aS5nZXREaXN0YW5jZXMoKSxtPTIqTWF0aC5QSSxnPW0vbypoLHY9ZnVuY3Rpb24oKXtyZXR1cm4gbn0seT1zfHx2LHg9ZS5UbXAuTWF0cml4WzBdLGI9YT09PWUuTWVzaC5fTk9fQ0FQfHxhPT09ZS5NZXNoLkNBUF9FTkQ/MDoyLFA9MDtQPHQubGVuZ3RoO1ArKyl7bD15KFAsX1tQXSksYz1BcnJheSgpLHU9cFtQXTtmb3IodmFyIEE9MDtvPkE7QSsrKWUuTWF0cml4LlJvdGF0aW9uQXhpc1RvUmVmKGRbUF0sZypBLHgpLGY9Y1tBXT9jW0FdOmUuVmVjdG9yMy5aZXJvKCksZS5WZWN0b3IzLlRyYW5zZm9ybUNvb3JkaW5hdGVzVG9SZWYodSx4LGYpLGYuc2NhbGVJblBsYWNlKGwpLmFkZEluUGxhY2UodFtQXSksY1tBXT1mO3JbYl09YyxiKyt9dmFyIFQ9ZnVuY3Rpb24oZSxpKXtmb3IodmFyIHI9QXJyYXkoKSxuPTA7ZT5uO24rKylyLnB1c2godFtpXSk7cmV0dXJuIHJ9O3N3aXRjaChhKXtjYXNlIGUuTWVzaC5OT19DQVA6YnJlYWs7Y2FzZSBlLk1lc2guQ0FQX1NUQVJUOnJbMF09VChvLDApLHJbMV09clsyXS5zbGljZSgwKTticmVhaztjYXNlIGUuTWVzaC5DQVBfRU5EOnJbYl09cltiLTFdLnNsaWNlKDApLHJbYisxXT1UKG8sdC5sZW5ndGgtMSk7YnJlYWs7Y2FzZSBlLk1lc2guQ0FQX0FMTDpyWzBdPVQobywwKSxyWzFdPXJbMl0uc2xpY2UoMCkscltiXT1yW2ItMV0uc2xpY2UoMCkscltiKzFdPVQobyx0Lmxlbmd0aC0xKX1yZXR1cm4gcn07aWYoZil7dmFyIG09ci5hcmN8fGYuYXJjO3JldHVybiBkPWYucGF0aDNELnVwZGF0ZShvKSxwPV8obyxkLGYucGF0aEFycmF5LHMsZi50ZXNzZWxsYXRpb24saCxmLmNhcCxtKSxmPXQuQ3JlYXRlUmliYm9uKG51bGwse3BhdGhBcnJheTpwLGluc3RhbmNlOmZ9KSxmLnBhdGgzRD1kLGYucGF0aEFycmF5PXAsZi5hcmM9bSxmfWQ9bmV3IGUuUGF0aDNEKG8pO3ZhciBnPW5ldyBBcnJheTtjPTA+Y3x8Yz4zPzA6YyxwPV8obyxkLGcscyxhLGgsYyxyLmFyYyk7dmFyIHY9dC5DcmVhdGVSaWJib24oaSx7cGF0aEFycmF5OnAsY2xvc2VQYXRoOiEwLGNsb3NlQXJyYXk6ITEsdXBkYXRhYmxlOmwsc2lkZU9yaWVudGF0aW9uOnV9LG4pO3JldHVybiB2LnBhdGhBcnJheT1wLHYucGF0aDNEPWQsdi50ZXNzZWxsYXRpb249YSx2LmNhcD1jLHYuYXJjPXIuYXJjLHZ9LHQuQ3JlYXRlUG9seWhlZHJvbj1mdW5jdGlvbih0LGkscil7dmFyIG49bmV3IGUuTWVzaCh0LHIpLG89ZS5WZXJ0ZXhEYXRhLkNyZWF0ZVBvbHloZWRyb24oaSk7cmV0dXJuIG8uYXBwbHlUb01lc2gobixpLnVwZGF0YWJsZSksbn0sdC5DcmVhdGVEZWNhbD1mdW5jdGlvbih0LGkscil7dmFyIG49aS5nZXRJbmRpY2VzKCksbz1pLmdldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5Qb3NpdGlvbktpbmQpLHM9aS5nZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuTm9ybWFsS2luZCksYT1yLnBvc2l0aW9ufHxlLlZlY3RvcjMuWmVybygpLGg9ci5ub3JtYWx8fGUuVmVjdG9yMy5VcCgpLGM9ci5zaXplfHxuZXcgZS5WZWN0b3IzKDEsMSwxKSxsPXIuYW5nbGV8fDA7aWYoIWgpe3ZhciB1PW5ldyBlLlZlY3RvcjMoMCwwLDEpLGY9aS5nZXRTY2VuZSgpLmFjdGl2ZUNhbWVyYSxkPWUuVmVjdG9yMy5UcmFuc2Zvcm1Db29yZGluYXRlcyh1LGYuZ2V0V29ybGRNYXRyaXgoKSk7aD1mLmdsb2JhbFBvc2l0aW9uLnN1YnRyYWN0KGQpfXZhciBwPS1NYXRoLmF0YW4yKGgueixoLngpLU1hdGguUEkvMixfPU1hdGguc3FydChoLngqaC54K2gueipoLnopLG09TWF0aC5hdGFuMihoLnksXyksZz1lLk1hdHJpeC5Sb3RhdGlvbllhd1BpdGNoUm9sbChwLG0sbCkubXVsdGlwbHkoZS5NYXRyaXguVHJhbnNsYXRpb24oYS54LGEueSxhLnopKSx2PWUuTWF0cml4LkludmVydChnKSx5PWkuZ2V0V29ybGRNYXRyaXgoKSx4PXkubXVsdGlwbHkodiksYj1uZXcgZS5WZXJ0ZXhEYXRhO2IuaW5kaWNlcz1bXSxiLnBvc2l0aW9ucz1bXSxiLm5vcm1hbHM9W10sYi51dnM9W107Zm9yKHZhciBQPTAsQT1mdW5jdGlvbih0KXt2YXIgaT1uW3RdLHI9bmV3IGUuUG9zaXRpb25Ob3JtYWxWZXJ0ZXg7cmV0dXJuIHIucG9zaXRpb249bmV3IGUuVmVjdG9yMyhvWzMqaV0sb1szKmkrMV0sb1szKmkrMl0pLHIucG9zaXRpb249ZS5WZWN0b3IzLlRyYW5zZm9ybUNvb3JkaW5hdGVzKHIucG9zaXRpb24seCksci5ub3JtYWw9bmV3IGUuVmVjdG9yMyhzWzMqaV0sc1szKmkrMV0sc1szKmkrMl0pLHJ9LFQ9ZnVuY3Rpb24odCxpKXtpZigwPT09dC5sZW5ndGgpcmV0dXJuIHQ7Zm9yKHZhciByPS41Kk1hdGguYWJzKGUuVmVjdG9yMy5Eb3QoYyxpKSksbj1mdW5jdGlvbih0LG4pe3ZhciBvPWUuVmVjdG9yMy5HZXRDbGlwRmFjdG9yKHQucG9zaXRpb24sbi5wb3NpdGlvbixpLHIpO3JldHVybiBuZXcgZS5Qb3NpdGlvbk5vcm1hbFZlcnRleChlLlZlY3RvcjMuTGVycCh0LnBvc2l0aW9uLG4ucG9zaXRpb24sbyksZS5WZWN0b3IzLkxlcnAodC5ub3JtYWwsbi5ub3JtYWwsbykpfSxvPW5ldyBBcnJheSxzPTA7czx0Lmxlbmd0aDtzKz0zKXt2YXIgYSxoLGwsdSxmLGQscCxfPTAsbT1lLlZlY3RvcjMuRG90KHRbc10ucG9zaXRpb24saSktcixnPWUuVmVjdG9yMy5Eb3QodFtzKzFdLnBvc2l0aW9uLGkpLXIsdj1lLlZlY3RvcjMuRG90KHRbcysyXS5wb3NpdGlvbixpKS1yO3N3aXRjaChhPW0+MCxoPWc+MCxsPXY+MCxfPShhPzE6MCkrKGg/MTowKSsobD8xOjApKXtjYXNlIDA6by5wdXNoKHRbc10pLG8ucHVzaCh0W3MrMV0pLG8ucHVzaCh0W3MrMl0pO2JyZWFrO2Nhc2UgMTppZihhJiYodT10W3MrMV0sZj10W3MrMl0sZD1uKHRbc10sdSkscD1uKHRbc10sZikpLGgpe3U9dFtzXSxmPXRbcysyXSxkPW4odFtzKzFdLHUpLHA9bih0W3MrMV0sZiksby5wdXNoKGQpLG8ucHVzaChmLmNsb25lKCkpLG8ucHVzaCh1LmNsb25lKCkpLG8ucHVzaChmLmNsb25lKCkpLG8ucHVzaChkLmNsb25lKCkpLG8ucHVzaChwKTticmVha31sJiYodT10W3NdLGY9dFtzKzFdLGQ9bih0W3MrMl0sdSkscD1uKHRbcysyXSxmKSksby5wdXNoKHUuY2xvbmUoKSksby5wdXNoKGYuY2xvbmUoKSksby5wdXNoKGQpLG8ucHVzaChwKSxvLnB1c2goZC5jbG9uZSgpKSxvLnB1c2goZi5jbG9uZSgpKTticmVhaztjYXNlIDI6YXx8KHU9dFtzXS5jbG9uZSgpLGY9bih1LHRbcysxXSksZD1uKHUsdFtzKzJdKSxvLnB1c2godSksby5wdXNoKGYpLG8ucHVzaChkKSksaHx8KHU9dFtzKzFdLmNsb25lKCksZj1uKHUsdFtzKzJdKSxkPW4odSx0W3NdKSxvLnB1c2godSksby5wdXNoKGYpLG8ucHVzaChkKSksbHx8KHU9dFtzKzJdLmNsb25lKCksZj1uKHUsdFtzXSksZD1uKHUsdFtzKzFdKSxvLnB1c2godSksby5wdXNoKGYpLG8ucHVzaChkKSk7YnJlYWs7Y2FzZSAzOn19cmV0dXJuIG99LEU9MDtFPG4ubGVuZ3RoO0UrPTMpe3ZhciBDPW5ldyBBcnJheTtpZihDLnB1c2goQShFKSksQy5wdXNoKEEoRSsxKSksQy5wdXNoKEEoRSsyKSksQz1UKEMsbmV3IGUuVmVjdG9yMygxLDAsMCkpLEM9VChDLG5ldyBlLlZlY3RvcjMoLTEsMCwwKSksQz1UKEMsbmV3IGUuVmVjdG9yMygwLDEsMCkpLEM9VChDLG5ldyBlLlZlY3RvcjMoMCwtMSwwKSksQz1UKEMsbmV3IGUuVmVjdG9yMygwLDAsMSkpLEM9VChDLG5ldyBlLlZlY3RvcjMoMCwwLC0xKSksMCE9PUMubGVuZ3RoKWZvcih2YXIgUz0wO1M8Qy5sZW5ndGg7UysrKXt2YXIgTT1DW1NdO2IuaW5kaWNlcy5wdXNoKFApLE0ucG9zaXRpb24udG9BcnJheShiLnBvc2l0aW9ucywzKlApLE0ubm9ybWFsLnRvQXJyYXkoYi5ub3JtYWxzLDMqUCksYi51dnMucHVzaCguNStNLnBvc2l0aW9uLngvYy54KSxiLnV2cy5wdXNoKC41K00ucG9zaXRpb24ueS9jLnkpLFArK319dmFyIEk9bmV3IGUuTWVzaCh0LGkuZ2V0U2NlbmUoKSk7cmV0dXJuIGIuYXBwbHlUb01lc2goSSksSS5wb3NpdGlvbj1hLmNsb25lKCksSS5yb3RhdGlvbj1uZXcgZS5WZWN0b3IzKG0scCxsKSxJfSx0Ll9FeHRydWRlU2hhcGVHZW5lcmljPWZ1bmN0aW9uKHQsaSxyLG4sbyxzLGEsaCxjLGwsdSxmLGQscCxfKXt2YXIgbSxnLHY9ZnVuY3Rpb24odCxpLHIsbixvLHMsYSxoLGMsbCl7Zm9yKHZhciB1PXIuZ2V0VGFuZ2VudHMoKSxmPXIuZ2V0Tm9ybWFscygpLGQ9ci5nZXRCaW5vcm1hbHMoKSxwPXIuZ2V0RGlzdGFuY2VzKCksXz0wLG09ZnVuY3Rpb24oKXtyZXR1cm4gb30sZz1mdW5jdGlvbigpe3JldHVybiBzfSx2PWw/aDpnLHk9bD9hOm0seD1jPT09ZS5NZXNoLk5PX0NBUHx8Yz09PWUuTWVzaC5DQVBfRU5EPzA6MixiPWUuVG1wLk1hdHJpeFswXSxQPTA7UDxpLmxlbmd0aDtQKyspe2Zvcih2YXIgQT1uZXcgQXJyYXksVD12KFAscFtQXSksRT15KFAscFtQXSksQz0wO0M8dC5sZW5ndGg7QysrKXtlLk1hdHJpeC5Sb3RhdGlvbkF4aXNUb1JlZih1W1BdLF8sYik7dmFyIFM9dVtQXS5zY2FsZSh0W0NdLnopLmFkZChmW1BdLnNjYWxlKHRbQ10ueCkpLmFkZChkW1BdLnNjYWxlKHRbQ10ueSkpLE09QVtDXT9BW0NdOmUuVmVjdG9yMy5aZXJvKCk7ZS5WZWN0b3IzLlRyYW5zZm9ybUNvb3JkaW5hdGVzVG9SZWYoUyxiLE0pLE0uc2NhbGVJblBsYWNlKEUpLmFkZEluUGxhY2UoaVtQXSksQVtDXT1NfW5beF09QSxfKz1ULHgrK312YXIgST1mdW5jdGlvbih0KXt2YXIgaSxyPUFycmF5KCksbj1lLlZlY3RvcjMuWmVybygpO2ZvcihpPTA7aTx0Lmxlbmd0aDtpKyspbi5hZGRJblBsYWNlKHRbaV0pO2ZvcihuLnNjYWxlSW5QbGFjZSgxL3QubGVuZ3RoKSxpPTA7aTx0Lmxlbmd0aDtpKyspci5wdXNoKG4pO3JldHVybiByfTtzd2l0Y2goYyl7Y2FzZSBlLk1lc2guTk9fQ0FQOmJyZWFrO2Nhc2UgZS5NZXNoLkNBUF9TVEFSVDpuWzBdPUkoblsyXSksblsxXT1uWzJdLnNsaWNlKDApO2JyZWFrO2Nhc2UgZS5NZXNoLkNBUF9FTkQ6blt4XT1uW3gtMV0sblt4KzFdPUkoblt4LTFdKTticmVhaztjYXNlIGUuTWVzaC5DQVBfQUxMOm5bMF09SShuWzJdKSxuWzFdPW5bMl0uc2xpY2UoMCksblt4XT1uW3gtMV0sblt4KzFdPUkoblt4LTFdKX1yZXR1cm4gbn07aWYoXylyZXR1cm4gbT1fLnBhdGgzRC51cGRhdGUociksZz12KGkscixfLnBhdGgzRCxfLnBhdGhBcnJheSxuLG8scyxhLF8uY2FwLHUpLF89ZS5NZXNoLkNyZWF0ZVJpYmJvbihudWxsLGcsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsXyk7bT1uZXcgZS5QYXRoM0Qocik7dmFyIHk9bmV3IEFycmF5O2w9MD5sfHxsPjM/MDpsLGc9dihpLHIsbSx5LG4sbyxzLGEsbCx1KTt2YXIgeD1lLk1lc2guQ3JlYXRlUmliYm9uKHQsZyxoLGMsMCxmLGQscCk7cmV0dXJuIHgucGF0aEFycmF5PWcseC5wYXRoM0Q9bSx4LmNhcD1sLHh9LHR9KCk7ZS5NZXNoQnVpbGRlcj10fShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCl7dGhpcy5oYXNBbHBoYT0hMSx0aGlzLmdldEFscGhhRnJvbVJHQj0hMSx0aGlzLmxldmVsPTEsdGhpcy5jb29yZGluYXRlc0luZGV4PTAsdGhpcy5jb29yZGluYXRlc01vZGU9ZS5UZXh0dXJlLkVYUExJQ0lUX01PREUsdGhpcy53cmFwVT1lLlRleHR1cmUuV1JBUF9BRERSRVNTTU9ERSx0aGlzLndyYXBWPWUuVGV4dHVyZS5XUkFQX0FERFJFU1NNT0RFLHRoaXMuYW5pc290cm9waWNGaWx0ZXJpbmdMZXZlbD00LHRoaXMuaXNDdWJlPSExLHRoaXMuaXNSZW5kZXJUYXJnZXQ9ITEsdGhpcy5hbmltYXRpb25zPW5ldyBBcnJheSx0aGlzLm9uRGlzcG9zZU9ic2VydmFibGU9bmV3IGUuT2JzZXJ2YWJsZSx0aGlzLmRlbGF5TG9hZFN0YXRlPWUuRW5naW5lLkRFTEFZTE9BRFNUQVRFX05PTkUsdGhpcy5fc2NlbmU9dCx0aGlzLl9zY2VuZS50ZXh0dXJlcy5wdXNoKHRoaXMpfXJldHVybiB0LnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLm5hbWV9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcIm9uRGlzcG9zZVwiLHtzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fb25EaXNwb3NlT2JzZXJ2ZXImJnRoaXMub25EaXNwb3NlT2JzZXJ2YWJsZS5yZW1vdmUodGhpcy5fb25EaXNwb3NlT2JzZXJ2ZXIpLHRoaXMuX29uRGlzcG9zZU9ic2VydmVyPXRoaXMub25EaXNwb3NlT2JzZXJ2YWJsZS5hZGQoZSl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksdC5wcm90b3R5cGUuZ2V0U2NlbmU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc2NlbmV9LHQucHJvdG90eXBlLmdldFRleHR1cmVNYXRyaXg9ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbH0sdC5wcm90b3R5cGUuZ2V0UmVmbGVjdGlvblRleHR1cmVNYXRyaXg9ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbH0sdC5wcm90b3R5cGUuZ2V0SW50ZXJuYWxUZXh0dXJlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3RleHR1cmV9LHQucHJvdG90eXBlLmlzUmVhZHk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kZWxheUxvYWRTdGF0ZT09PWUuRW5naW5lLkRFTEFZTE9BRFNUQVRFX05PVExPQURFRD8hMDp0aGlzLl90ZXh0dXJlP3RoaXMuX3RleHR1cmUuaXNSZWFkeTohMX0sdC5wcm90b3R5cGUuZ2V0U2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLl90ZXh0dXJlLl93aWR0aD97d2lkdGg6dGhpcy5fdGV4dHVyZS5fd2lkdGgsaGVpZ2h0OnRoaXMuX3RleHR1cmUuX2hlaWdodH06dGhpcy5fdGV4dHVyZS5fc2l6ZT97d2lkdGg6dGhpcy5fdGV4dHVyZS5fc2l6ZSxoZWlnaHQ6dGhpcy5fdGV4dHVyZS5fc2l6ZX06e3dpZHRoOjAsaGVpZ2h0OjB9fSx0LnByb3RvdHlwZS5nZXRCYXNlU2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmlzUmVhZHkoKSYmdGhpcy5fdGV4dHVyZT90aGlzLl90ZXh0dXJlLl9zaXplP3t3aWR0aDp0aGlzLl90ZXh0dXJlLl9zaXplLGhlaWdodDp0aGlzLl90ZXh0dXJlLl9zaXplfTp7d2lkdGg6dGhpcy5fdGV4dHVyZS5fYmFzZVdpZHRoLGhlaWdodDp0aGlzLl90ZXh0dXJlLl9iYXNlSGVpZ2h0fTp7d2lkdGg6MCxoZWlnaHQ6MH19LHQucHJvdG90eXBlLnNjYWxlPWZ1bmN0aW9uKGUpe30sT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwiY2FuUmVzY2FsZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4hMX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSx0LnByb3RvdHlwZS5fcmVtb3ZlRnJvbUNhY2hlPWZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBpPXRoaXMuX3NjZW5lLmdldEVuZ2luZSgpLmdldExvYWRlZFRleHR1cmVzQ2FjaGUoKSxyPTA7cjxpLmxlbmd0aDtyKyspe3ZhciBuPWlbcl07aWYobi51cmw9PT1lJiZuLm5vTWlwbWFwPT09dClyZXR1cm4gdm9pZCBpLnNwbGljZShyLDEpfX0sdC5wcm90b3R5cGUuX2dldEZyb21DYWNoZT1mdW5jdGlvbihlLHQsaSl7Zm9yKHZhciByPXRoaXMuX3NjZW5lLmdldEVuZ2luZSgpLmdldExvYWRlZFRleHR1cmVzQ2FjaGUoKSxuPTA7bjxyLmxlbmd0aDtuKyspe3ZhciBvPXJbbl07aWYoby51cmw9PT1lJiZvLm5vTWlwbWFwPT09dCYmKCFpfHxpPT09by5zYW1wbGluZ01vZGUpKXJldHVybiBvLnJlZmVyZW5jZXMrKyxvfXJldHVybiBudWxsfSx0LnByb3RvdHlwZS5kZWxheUxvYWQ9ZnVuY3Rpb24oKXt9LHQucHJvdG90eXBlLmNsb25lPWZ1bmN0aW9uKCl7cmV0dXJuIG51bGx9LHQucHJvdG90eXBlLnJlbGVhc2VJbnRlcm5hbFRleHR1cmU9ZnVuY3Rpb24oKXt0aGlzLl90ZXh0dXJlJiYodGhpcy5fc2NlbmUuZ2V0RW5naW5lKCkucmVsZWFzZUludGVybmFsVGV4dHVyZSh0aGlzLl90ZXh0dXJlKSxkZWxldGUgdGhpcy5fdGV4dHVyZSl9LHQucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXt0aGlzLmdldFNjZW5lKCkuc3RvcEFuaW1hdGlvbih0aGlzKTt2YXIgZT10aGlzLl9zY2VuZS50ZXh0dXJlcy5pbmRleE9mKHRoaXMpO2U+PTAmJnRoaXMuX3NjZW5lLnRleHR1cmVzLnNwbGljZShlLDEpLHZvaWQgMCE9PXRoaXMuX3RleHR1cmUmJih0aGlzLnJlbGVhc2VJbnRlcm5hbFRleHR1cmUoKSx0aGlzLm9uRGlzcG9zZU9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpLHRoaXMub25EaXNwb3NlT2JzZXJ2YWJsZS5jbGVhcigpKX0sdC5wcm90b3R5cGUuc2VyaWFsaXplPWZ1bmN0aW9uKCl7aWYoIXRoaXMubmFtZSlyZXR1cm4gbnVsbDt2YXIgdD1lLlNlcmlhbGl6YXRpb25IZWxwZXIuU2VyaWFsaXplKHRoaXMpO3JldHVybiBlLkFuaW1hdGlvbi5BcHBlbmRTZXJpYWxpemVkQW5pbWF0aW9ucyh0aGlzLHQpLHR9LF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHQucHJvdG90eXBlLFwibmFtZVwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0sdC5wcm90b3R5cGUsXCJoYXNBbHBoYVwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0sdC5wcm90b3R5cGUsXCJnZXRBbHBoYUZyb21SR0JcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHQucHJvdG90eXBlLFwibGV2ZWxcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHQucHJvdG90eXBlLFwiY29vcmRpbmF0ZXNJbmRleFwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0sdC5wcm90b3R5cGUsXCJjb29yZGluYXRlc01vZGVcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHQucHJvdG90eXBlLFwid3JhcFVcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHQucHJvdG90eXBlLFwid3JhcFZcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHQucHJvdG90eXBlLFwiYW5pc290cm9waWNGaWx0ZXJpbmdMZXZlbFwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0sdC5wcm90b3R5cGUsXCJpc0N1YmVcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHQucHJvdG90eXBlLFwiaXNSZW5kZXJUYXJnZXRcIix2b2lkIDApLHR9KCk7ZS5CYXNlVGV4dHVyZT10fShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbih0KXtmdW5jdGlvbiBpKHIsbixvLHMsYSxoLGMsbCx1KXt2b2lkIDA9PT1hJiYoYT1pLlRSSUxJTkVBUl9TQU1QTElOR01PREUpLHZvaWQgMD09PWgmJihoPW51bGwpLHZvaWQgMD09PWMmJihjPW51bGwpLHZvaWQgMD09PWwmJihsPW51bGwpLHZvaWQgMD09PXUmJih1PSExKSx0LmNhbGwodGhpcyxuKSx0aGlzLnVPZmZzZXQ9MCx0aGlzLnZPZmZzZXQ9MCx0aGlzLnVTY2FsZT0xLHRoaXMudlNjYWxlPTEsdGhpcy51QW5nPTAsdGhpcy52QW5nPTAsdGhpcy53QW5nPTAsdGhpcy5uYW1lPXIsdGhpcy51cmw9cix0aGlzLl9ub01pcG1hcD1vLHRoaXMuX2ludmVydFk9cyx0aGlzLl9zYW1wbGluZ01vZGU9YSx0aGlzLl9idWZmZXI9bCx0aGlzLl9kZWxldGVCdWZmZXI9dSxyJiYodGhpcy5fdGV4dHVyZT10aGlzLl9nZXRGcm9tQ2FjaGUocixvLGEpLHRoaXMuX3RleHR1cmU/ZS5Ub29scy5TZXRJbW1lZGlhdGUoZnVuY3Rpb24oKXtoJiZoKCl9KTpuLnVzZURlbGF5ZWRUZXh0dXJlTG9hZGluZz8odGhpcy5kZWxheUxvYWRTdGF0ZT1lLkVuZ2luZS5ERUxBWUxPQURTVEFURV9OT1RMT0FERUQsdGhpcy5fZGVsYXllZE9uTG9hZD1oLHRoaXMuX2RlbGF5ZWRPbkVycm9yPWMpOih0aGlzLl90ZXh0dXJlPW4uZ2V0RW5naW5lKCkuY3JlYXRlVGV4dHVyZShyLG8scyxuLHRoaXMuX3NhbXBsaW5nTW9kZSxoLGMsdGhpcy5fYnVmZmVyKSx1JiZkZWxldGUgdGhpcy5fYnVmZmVyKSl9cmV0dXJuIF9fZXh0ZW5kcyhpLHQpLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcIm5vTWlwbWFwXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9ub01pcG1hcH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxpLnByb3RvdHlwZS5kZWxheUxvYWQ9ZnVuY3Rpb24oKXt0aGlzLmRlbGF5TG9hZFN0YXRlPT09ZS5FbmdpbmUuREVMQVlMT0FEU1RBVEVfTk9UTE9BREVEJiYodGhpcy5kZWxheUxvYWRTdGF0ZT1lLkVuZ2luZS5ERUxBWUxPQURTVEFURV9MT0FERUQsdGhpcy5fdGV4dHVyZT10aGlzLl9nZXRGcm9tQ2FjaGUodGhpcy51cmwsdGhpcy5fbm9NaXBtYXAsdGhpcy5fc2FtcGxpbmdNb2RlKSx0aGlzLl90ZXh0dXJlfHwodGhpcy5fdGV4dHVyZT10aGlzLmdldFNjZW5lKCkuZ2V0RW5naW5lKCkuY3JlYXRlVGV4dHVyZSh0aGlzLnVybCx0aGlzLl9ub01pcG1hcCx0aGlzLl9pbnZlcnRZLHRoaXMuZ2V0U2NlbmUoKSx0aGlzLl9zYW1wbGluZ01vZGUsdGhpcy5fZGVsYXllZE9uTG9hZCx0aGlzLl9kZWxheWVkT25FcnJvcix0aGlzLl9idWZmZXIpLHRoaXMuX2RlbGV0ZUJ1ZmZlciYmZGVsZXRlIHRoaXMuX2J1ZmZlcikpfSxpLnByb3RvdHlwZS51cGRhdGVTYW1wbGluZ01vZGU9ZnVuY3Rpb24oZSl7dGhpcy5fdGV4dHVyZSYmKHRoaXMuX3NhbXBsaW5nTW9kZT1lLHRoaXMuZ2V0U2NlbmUoKS5nZXRFbmdpbmUoKS51cGRhdGVUZXh0dXJlU2FtcGxpbmdNb2RlKGUsdGhpcy5fdGV4dHVyZSkpfSxpLnByb3RvdHlwZS5fcHJlcGFyZVJvd0ZvclRleHR1cmVHZW5lcmF0aW9uPWZ1bmN0aW9uKHQsaSxyLG4pe3QqPXRoaXMudVNjYWxlLGkqPXRoaXMudlNjYWxlLHQtPS41KnRoaXMudVNjYWxlLGktPS41KnRoaXMudlNjYWxlLHItPS41LGUuVmVjdG9yMy5UcmFuc2Zvcm1Db29yZGluYXRlc0Zyb21GbG9hdHNUb1JlZih0LGkscix0aGlzLl9yb3dHZW5lcmF0aW9uTWF0cml4LG4pLG4ueCs9LjUqdGhpcy51U2NhbGUrdGhpcy51T2Zmc2V0LG4ueSs9LjUqdGhpcy52U2NhbGUrdGhpcy52T2Zmc2V0LG4ueis9LjV9LGkucHJvdG90eXBlLmdldFRleHR1cmVNYXRyaXg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy51T2Zmc2V0PT09dGhpcy5fY2FjaGVkVU9mZnNldCYmdGhpcy52T2Zmc2V0PT09dGhpcy5fY2FjaGVkVk9mZnNldCYmdGhpcy51U2NhbGU9PT10aGlzLl9jYWNoZWRVU2NhbGUmJnRoaXMudlNjYWxlPT09dGhpcy5fY2FjaGVkVlNjYWxlJiZ0aGlzLnVBbmc9PT10aGlzLl9jYWNoZWRVQW5nJiZ0aGlzLnZBbmc9PT10aGlzLl9jYWNoZWRWQW5nJiZ0aGlzLndBbmc9PT10aGlzLl9jYWNoZWRXQW5nP3RoaXMuX2NhY2hlZFRleHR1cmVNYXRyaXg6KHRoaXMuX2NhY2hlZFVPZmZzZXQ9dGhpcy51T2Zmc2V0LHRoaXMuX2NhY2hlZFZPZmZzZXQ9dGhpcy52T2Zmc2V0LHRoaXMuX2NhY2hlZFVTY2FsZT10aGlzLnVTY2FsZSx0aGlzLl9jYWNoZWRWU2NhbGU9dGhpcy52U2NhbGUsdGhpcy5fY2FjaGVkVUFuZz10aGlzLnVBbmcsdGhpcy5fY2FjaGVkVkFuZz10aGlzLnZBbmcsdGhpcy5fY2FjaGVkV0FuZz10aGlzLndBbmcsdGhpcy5fY2FjaGVkVGV4dHVyZU1hdHJpeHx8KHRoaXMuX2NhY2hlZFRleHR1cmVNYXRyaXg9ZS5NYXRyaXguWmVybygpLHRoaXMuX3Jvd0dlbmVyYXRpb25NYXRyaXg9bmV3IGUuTWF0cml4LHRoaXMuX3QwPWUuVmVjdG9yMy5aZXJvKCksdGhpcy5fdDE9ZS5WZWN0b3IzLlplcm8oKSx0aGlzLl90Mj1lLlZlY3RvcjMuWmVybygpKSxlLk1hdHJpeC5Sb3RhdGlvbllhd1BpdGNoUm9sbFRvUmVmKHRoaXMudkFuZyx0aGlzLnVBbmcsdGhpcy53QW5nLHRoaXMuX3Jvd0dlbmVyYXRpb25NYXRyaXgpLHRoaXMuX3ByZXBhcmVSb3dGb3JUZXh0dXJlR2VuZXJhdGlvbigwLDAsMCx0aGlzLl90MCksdGhpcy5fcHJlcGFyZVJvd0ZvclRleHR1cmVHZW5lcmF0aW9uKDEsMCwwLHRoaXMuX3QxKSx0aGlzLl9wcmVwYXJlUm93Rm9yVGV4dHVyZUdlbmVyYXRpb24oMCwxLDAsdGhpcy5fdDIpLHRoaXMuX3QxLnN1YnRyYWN0SW5QbGFjZSh0aGlzLl90MCksdGhpcy5fdDIuc3VidHJhY3RJblBsYWNlKHRoaXMuX3QwKSxlLk1hdHJpeC5JZGVudGl0eVRvUmVmKHRoaXMuX2NhY2hlZFRleHR1cmVNYXRyaXgpLHRoaXMuX2NhY2hlZFRleHR1cmVNYXRyaXgubVswXT10aGlzLl90MS54LHRoaXMuX2NhY2hlZFRleHR1cmVNYXRyaXgubVsxXT10aGlzLl90MS55LHRoaXMuX2NhY2hlZFRleHR1cmVNYXRyaXgubVsyXT10aGlzLl90MS56LHRoaXMuX2NhY2hlZFRleHR1cmVNYXRyaXgubVs0XT10aGlzLl90Mi54LHRoaXMuX2NhY2hlZFRleHR1cmVNYXRyaXgubVs1XT10aGlzLl90Mi55LHRoaXMuX2NhY2hlZFRleHR1cmVNYXRyaXgubVs2XT10aGlzLl90Mi56LHRoaXMuX2NhY2hlZFRleHR1cmVNYXRyaXgubVs4XT10aGlzLl90MC54LHRoaXMuX2NhY2hlZFRleHR1cmVNYXRyaXgubVs5XT10aGlzLl90MC55LHRoaXMuX2NhY2hlZFRleHR1cmVNYXRyaXgubVsxMF09dGhpcy5fdDAueix0aGlzLl9jYWNoZWRUZXh0dXJlTWF0cml4KX0saS5wcm90b3R5cGUuZ2V0UmVmbGVjdGlvblRleHR1cmVNYXRyaXg9ZnVuY3Rpb24oKXtpZih0aGlzLnVPZmZzZXQ9PT10aGlzLl9jYWNoZWRVT2Zmc2V0JiZ0aGlzLnZPZmZzZXQ9PT10aGlzLl9jYWNoZWRWT2Zmc2V0JiZ0aGlzLnVTY2FsZT09PXRoaXMuX2NhY2hlZFVTY2FsZSYmdGhpcy52U2NhbGU9PT10aGlzLl9jYWNoZWRWU2NhbGUmJnRoaXMuY29vcmRpbmF0ZXNNb2RlPT09dGhpcy5fY2FjaGVkQ29vcmRpbmF0ZXNNb2RlKXJldHVybiB0aGlzLl9jYWNoZWRUZXh0dXJlTWF0cml4O3N3aXRjaCh0aGlzLl9jYWNoZWRUZXh0dXJlTWF0cml4fHwodGhpcy5fY2FjaGVkVGV4dHVyZU1hdHJpeD1lLk1hdHJpeC5aZXJvKCksdGhpcy5fcHJvamVjdGlvbk1vZGVNYXRyaXg9ZS5NYXRyaXguWmVybygpKSx0aGlzLl9jYWNoZWRDb29yZGluYXRlc01vZGU9dGhpcy5jb29yZGluYXRlc01vZGUsdGhpcy5jb29yZGluYXRlc01vZGUpe2Nhc2UgaS5QTEFOQVJfTU9ERTplLk1hdHJpeC5JZGVudGl0eVRvUmVmKHRoaXMuX2NhY2hlZFRleHR1cmVNYXRyaXgpLHRoaXMuX2NhY2hlZFRleHR1cmVNYXRyaXhbMF09dGhpcy51U2NhbGUsdGhpcy5fY2FjaGVkVGV4dHVyZU1hdHJpeFs1XT10aGlzLnZTY2FsZSx0aGlzLl9jYWNoZWRUZXh0dXJlTWF0cml4WzEyXT10aGlzLnVPZmZzZXQsdGhpcy5fY2FjaGVkVGV4dHVyZU1hdHJpeFsxM109dGhpcy52T2Zmc2V0O2JyZWFrO2Nhc2UgaS5QUk9KRUNUSU9OX01PREU6ZS5NYXRyaXguSWRlbnRpdHlUb1JlZih0aGlzLl9wcm9qZWN0aW9uTW9kZU1hdHJpeCksdGhpcy5fcHJvamVjdGlvbk1vZGVNYXRyaXgubVswXT0uNSx0aGlzLl9wcm9qZWN0aW9uTW9kZU1hdHJpeC5tWzVdPS0uNSx0aGlzLl9wcm9qZWN0aW9uTW9kZU1hdHJpeC5tWzEwXT0wLHRoaXMuX3Byb2plY3Rpb25Nb2RlTWF0cml4Lm1bMTJdPS41LHRoaXMuX3Byb2plY3Rpb25Nb2RlTWF0cml4Lm1bMTNdPS41LHRoaXMuX3Byb2plY3Rpb25Nb2RlTWF0cml4Lm1bMTRdPTEsdGhpcy5fcHJvamVjdGlvbk1vZGVNYXRyaXgubVsxNV09MSx0aGlzLmdldFNjZW5lKCkuZ2V0UHJvamVjdGlvbk1hdHJpeCgpLm11bHRpcGx5VG9SZWYodGhpcy5fcHJvamVjdGlvbk1vZGVNYXRyaXgsdGhpcy5fY2FjaGVkVGV4dHVyZU1hdHJpeCk7YnJlYWs7ZGVmYXVsdDplLk1hdHJpeC5JZGVudGl0eVRvUmVmKHRoaXMuX2NhY2hlZFRleHR1cmVNYXRyaXgpfXJldHVybiB0aGlzLl9jYWNoZWRUZXh0dXJlTWF0cml4fSxpLnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbigpe3ZhciB0PXRoaXM7cmV0dXJuIGUuU2VyaWFsaXphdGlvbkhlbHBlci5DbG9uZShmdW5jdGlvbigpe3JldHVybiBuZXcgaSh0Ll90ZXh0dXJlLnVybCx0LmdldFNjZW5lKCksdC5fbm9NaXBtYXAsdC5faW52ZXJ0WSx0Ll9zYW1wbGluZ01vZGUpfSx0aGlzKX0saS5DcmVhdGVGcm9tQmFzZTY0U3RyaW5nPWZ1bmN0aW9uKGUsdCxyLG4sbyxzLGEsaCl7cmV0dXJuIHZvaWQgMD09PXMmJihzPWkuVFJJTElORUFSX1NBTVBMSU5HTU9ERSksdm9pZCAwPT09YSYmKGE9bnVsbCksdm9pZCAwPT09aCYmKGg9bnVsbCksbmV3IGkoXCJkYXRhOlwiK3QscixuLG8scyxhLGgsZSl9LGkuUGFyc2U9ZnVuY3Rpb24odCxyLG4pe2lmKHQuaXNDdWJlKXJldHVybiBlLkN1YmVUZXh0dXJlLlBhcnNlKHQscixuKTtpZighdC5uYW1lJiYhdC5pc1JlbmRlclRhcmdldClyZXR1cm4gbnVsbDt2YXIgbz1lLlNlcmlhbGl6YXRpb25IZWxwZXIuUGFyc2UoZnVuY3Rpb24oKXtpZih0Lm1pcnJvclBsYW5lKXt2YXIgbz1uZXcgZS5NaXJyb3JUZXh0dXJlKHQubmFtZSx0LnJlbmRlclRhcmdldFNpemUscik7cmV0dXJuIG8uX3dhaXRpbmdSZW5kZXJMaXN0PXQucmVuZGVyTGlzdCxvLm1pcnJvclBsYW5lPWUuUGxhbmUuRnJvbUFycmF5KHQubWlycm9yUGxhbmUpLG99aWYodC5pc1JlbmRlclRhcmdldCl7dmFyIHM9bmV3IGUuUmVuZGVyVGFyZ2V0VGV4dHVyZSh0Lm5hbWUsdC5yZW5kZXJUYXJnZXRTaXplLHIpO3JldHVybiBzLl93YWl0aW5nUmVuZGVyTGlzdD10LnJlbmRlckxpc3Qsc312YXIgYTtyZXR1cm4gYT10LmJhc2U2NFN0cmluZz9pLkNyZWF0ZUZyb21CYXNlNjRTdHJpbmcodC5iYXNlNjRTdHJpbmcsdC5uYW1lLHIpOm5ldyBpKG4rdC5uYW1lLHIpfSx0LHIpO2lmKHQuYW5pbWF0aW9ucylmb3IodmFyIHM9MDtzPHQuYW5pbWF0aW9ucy5sZW5ndGg7cysrKXt2YXIgYT10LmFuaW1hdGlvbnNbc107by5hbmltYXRpb25zLnB1c2goZS5BbmltYXRpb24uUGFyc2UoYSkpfXJldHVybiBvfSxpLk5FQVJFU1RfU0FNUExJTkdNT0RFPTEsaS5CSUxJTkVBUl9TQU1QTElOR01PREU9MixpLlRSSUxJTkVBUl9TQU1QTElOR01PREU9MyxpLkVYUExJQ0lUX01PREU9MCxpLlNQSEVSSUNBTF9NT0RFPTEsaS5QTEFOQVJfTU9ERT0yLGkuQ1VCSUNfTU9ERT0zLGkuUFJPSkVDVElPTl9NT0RFPTQsaS5TS1lCT1hfTU9ERT01LGkuSU5WQ1VCSUNfTU9ERT02LGkuRVFVSVJFQ1RBTkdVTEFSX01PREU9NyxpLkZJWEVEX0VRVUlSRUNUQU5HVUxBUl9NT0RFPTgsaS5DTEFNUF9BRERSRVNTTU9ERT0wLGkuV1JBUF9BRERSRVNTTU9ERT0xLGkuTUlSUk9SX0FERFJFU1NNT0RFPTIsX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0saS5wcm90b3R5cGUsXCJ1cmxcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLGkucHJvdG90eXBlLFwidU9mZnNldFwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0saS5wcm90b3R5cGUsXCJ2T2Zmc2V0XCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSxpLnByb3RvdHlwZSxcInVTY2FsZVwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0saS5wcm90b3R5cGUsXCJ2U2NhbGVcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLGkucHJvdG90eXBlLFwidUFuZ1wiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0saS5wcm90b3R5cGUsXCJ2QW5nXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSxpLnByb3RvdHlwZSxcIndBbmdcIix2b2lkIDApLGl9KGUuQmFzZVRleHR1cmUpO2UuVGV4dHVyZT10fShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbih0KXtmdW5jdGlvbiBpKGkscixuLG8scyl7aWYodC5jYWxsKHRoaXMsciksdGhpcy5jb29yZGluYXRlc01vZGU9ZS5UZXh0dXJlLkNVQklDX01PREUsdGhpcy5uYW1lPWksdGhpcy51cmw9aSx0aGlzLl9ub01pcG1hcD1vLHRoaXMuaGFzQWxwaGE9ITEsaXx8cyl7aWYodGhpcy5fdGV4dHVyZT10aGlzLl9nZXRGcm9tQ2FjaGUoaSxvKSwhcyl7bnx8KG49W1wiX3B4LmpwZ1wiLFwiX3B5LmpwZ1wiLFwiX3B6LmpwZ1wiLFwiX254LmpwZ1wiLFwiX255LmpwZ1wiLFwiX256LmpwZ1wiXSkscz1bXTtmb3IodmFyIGE9MDthPG4ubGVuZ3RoO2ErKylzLnB1c2goaStuW2FdKTt0aGlzLl9leHRlbnNpb25zPW59dGhpcy5fZmlsZXM9cyx0aGlzLl90ZXh0dXJlfHwoci51c2VEZWxheWVkVGV4dHVyZUxvYWRpbmc/dGhpcy5kZWxheUxvYWRTdGF0ZT1lLkVuZ2luZS5ERUxBWUxPQURTVEFURV9OT1RMT0FERUQ6dGhpcy5fdGV4dHVyZT1yLmdldEVuZ2luZSgpLmNyZWF0ZUN1YmVUZXh0dXJlKGkscixzLG8pKSx0aGlzLmlzQ3ViZT0hMCx0aGlzLl90ZXh0dXJlTWF0cml4PWUuTWF0cml4LklkZW50aXR5KCl9fXJldHVybiBfX2V4dGVuZHMoaSx0KSxpLkNyZWF0ZUZyb21JbWFnZXM9ZnVuY3Rpb24oZSx0LHIpe3JldHVybiBuZXcgaShcIlwiLHQsbnVsbCxyLGUpfSxpLnByb3RvdHlwZS5kZWxheUxvYWQ9ZnVuY3Rpb24oKXt0aGlzLmRlbGF5TG9hZFN0YXRlPT09ZS5FbmdpbmUuREVMQVlMT0FEU1RBVEVfTk9UTE9BREVEJiYodGhpcy5kZWxheUxvYWRTdGF0ZT1lLkVuZ2luZS5ERUxBWUxPQURTVEFURV9MT0FERUQsdGhpcy5fdGV4dHVyZT10aGlzLl9nZXRGcm9tQ2FjaGUodGhpcy51cmwsdGhpcy5fbm9NaXBtYXApLHRoaXMuX3RleHR1cmV8fCh0aGlzLl90ZXh0dXJlPXRoaXMuZ2V0U2NlbmUoKS5nZXRFbmdpbmUoKS5jcmVhdGVDdWJlVGV4dHVyZSh0aGlzLnVybCx0aGlzLmdldFNjZW5lKCksdGhpcy5fZXh0ZW5zaW9ucykpKX0saS5wcm90b3R5cGUuZ2V0UmVmbGVjdGlvblRleHR1cmVNYXRyaXg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fdGV4dHVyZU1hdHJpeH0saS5QYXJzZT1mdW5jdGlvbih0LGkscil7dmFyIG49ZS5TZXJpYWxpemF0aW9uSGVscGVyLlBhcnNlKGZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBlLkN1YmVUZXh0dXJlKHIrdC5uYW1lLGksdC5leHRlbnNpb25zKX0sdCxpKTtpZih0LmFuaW1hdGlvbnMpZm9yKHZhciBvPTA7bzx0LmFuaW1hdGlvbnMubGVuZ3RoO28rKyl7dmFyIHM9dC5hbmltYXRpb25zW29dO24uYW5pbWF0aW9ucy5wdXNoKGUuQW5pbWF0aW9uLlBhcnNlKHMpKX1yZXR1cm4gbn0saS5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oKXt2YXIgdD10aGlzO3JldHVybiBlLlNlcmlhbGl6YXRpb25IZWxwZXIuQ2xvbmUoZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGkodC51cmwsdC5nZXRTY2VuZSgpLHQuX2V4dGVuc2lvbnMsdC5fbm9NaXBtYXAsdC5fZmlsZXMpfSx0aGlzKX0saX0oZS5CYXNlVGV4dHVyZSk7ZS5DdWJlVGV4dHVyZT10fShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbih0KXtmdW5jdGlvbiBpKGkscixuLG8scyxhLGgsYyl7dm9pZCAwPT09cyYmKHM9ITApLHZvaWQgMD09PWEmJihhPWUuRW5naW5lLlRFWFRVUkVUWVBFX1VOU0lHTkVEX0lOVCksdm9pZCAwPT09aCYmKGg9ITEpLHZvaWQgMD09PWMmJihjPWUuVGV4dHVyZS5UUklMSU5FQVJfU0FNUExJTkdNT0RFKSx0LmNhbGwodGhpcyxudWxsLG4sIW8pLHRoaXMuaXNDdWJlPWgsdGhpcy5yZW5kZXJMaXN0PW5ldyBBcnJheSx0aGlzLnJlbmRlclBhcnRpY2xlcz0hMCx0aGlzLnJlbmRlclNwcml0ZXM9ITEsdGhpcy5jb29yZGluYXRlc01vZGU9ZS5UZXh0dXJlLlBST0pFQ1RJT05fTU9ERSx0aGlzLm9uQWZ0ZXJVbmJpbmRPYnNlcnZhYmxlPW5ldyBlLk9ic2VydmFibGUsdGhpcy5vbkJlZm9yZVJlbmRlck9ic2VydmFibGU9bmV3IGUuT2JzZXJ2YWJsZSx0aGlzLm9uQWZ0ZXJSZW5kZXJPYnNlcnZhYmxlPW5ldyBlLk9ic2VydmFibGUsdGhpcy5vbkNsZWFyT2JzZXJ2YWJsZT1uZXcgZS5PYnNlcnZhYmxlLHRoaXMuX2N1cnJlbnRSZWZyZXNoSWQ9LTEsdGhpcy5fcmVmcmVzaFJhdGU9MSx0aGlzLm5hbWU9aSx0aGlzLmlzUmVuZGVyVGFyZ2V0PSEwLHRoaXMuX3NpemU9cix0aGlzLl9nZW5lcmF0ZU1pcE1hcHM9byx0aGlzLl9kb05vdENoYW5nZUFzcGVjdFJhdGlvPXMsYz09PWUuVGV4dHVyZS5ORUFSRVNUX1NBTVBMSU5HTU9ERSYmKHRoaXMud3JhcFU9ZS5UZXh0dXJlLkNMQU1QX0FERFJFU1NNT0RFLHRoaXMud3JhcFY9ZS5UZXh0dXJlLkNMQU1QX0FERFJFU1NNT0RFKSxoPyh0aGlzLl90ZXh0dXJlPW4uZ2V0RW5naW5lKCkuY3JlYXRlUmVuZGVyVGFyZ2V0Q3ViZVRleHR1cmUocix7Z2VuZXJhdGVNaXBNYXBzOm8sc2FtcGxpbmdNb2RlOmN9KSx0aGlzLmNvb3JkaW5hdGVzTW9kZT1lLlRleHR1cmUuSU5WQ1VCSUNfTU9ERSx0aGlzLl90ZXh0dXJlTWF0cml4PWUuTWF0cml4LklkZW50aXR5KCkpOnRoaXMuX3RleHR1cmU9bi5nZXRFbmdpbmUoKS5jcmVhdGVSZW5kZXJUYXJnZXRUZXh0dXJlKHIse2dlbmVyYXRlTWlwTWFwczpvLHR5cGU6YSxzYW1wbGluZ01vZGU6Y30pLHRoaXMuX3JlbmRlcmluZ01hbmFnZXI9bmV3IGUuUmVuZGVyaW5nTWFuYWdlcihuKX1yZXR1cm4gX19leHRlbmRzKGksdCksT2JqZWN0LmRlZmluZVByb3BlcnR5KGksXCJSRUZSRVNIUkFURV9SRU5ERVJfT05DRVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gaS5fUkVGUkVTSFJBVEVfUkVOREVSX09OQ0V9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGksXCJSRUZSRVNIUkFURV9SRU5ERVJfT05FVkVSWUZSQU1FXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBpLl9SRUZSRVNIUkFURV9SRU5ERVJfT05FVkVSWUZSQU1FfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLFwiUkVGUkVTSFJBVEVfUkVOREVSX09ORVZFUllUV09GUkFNRVNcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGkuX1JFRlJFU0hSQVRFX1JFTkRFUl9PTkVWRVJZVFdPRlJBTUVTfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcIm9uQWZ0ZXJVbmJpbmRcIix7c2V0OmZ1bmN0aW9uKGUpe3RoaXMuX29uQWZ0ZXJVbmJpbmRPYnNlcnZlciYmdGhpcy5vbkFmdGVyVW5iaW5kT2JzZXJ2YWJsZS5yZW1vdmUodGhpcy5fb25BZnRlclVuYmluZE9ic2VydmVyKSx0aGlzLl9vbkFmdGVyVW5iaW5kT2JzZXJ2ZXI9dGhpcy5vbkFmdGVyVW5iaW5kT2JzZXJ2YWJsZS5hZGQoZSl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGkucHJvdG90eXBlLFwib25CZWZvcmVSZW5kZXJcIix7c2V0OmZ1bmN0aW9uKGUpe3RoaXMuX29uQmVmb3JlUmVuZGVyT2JzZXJ2ZXImJnRoaXMub25CZWZvcmVSZW5kZXJPYnNlcnZhYmxlLnJlbW92ZSh0aGlzLl9vbkJlZm9yZVJlbmRlck9ic2VydmVyKSx0aGlzLl9vbkJlZm9yZVJlbmRlck9ic2VydmVyPXRoaXMub25CZWZvcmVSZW5kZXJPYnNlcnZhYmxlLmFkZChlKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJvbkFmdGVyUmVuZGVyXCIse3NldDpmdW5jdGlvbihlKXt0aGlzLl9vbkFmdGVyUmVuZGVyT2JzZXJ2ZXImJnRoaXMub25BZnRlclJlbmRlck9ic2VydmFibGUucmVtb3ZlKHRoaXMuX29uQWZ0ZXJSZW5kZXJPYnNlcnZlciksdGhpcy5fb25BZnRlclJlbmRlck9ic2VydmVyPXRoaXMub25BZnRlclJlbmRlck9ic2VydmFibGUuYWRkKGUpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcIm9uQ2xlYXJcIix7c2V0OmZ1bmN0aW9uKGUpe3RoaXMuX29uQ2xlYXJPYnNlcnZlciYmdGhpcy5vbkNsZWFyT2JzZXJ2YWJsZS5yZW1vdmUodGhpcy5fb25DbGVhck9ic2VydmVyKSx0aGlzLl9vbkNsZWFyT2JzZXJ2ZXI9dGhpcy5vbkNsZWFyT2JzZXJ2YWJsZS5hZGQoZSl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksaS5wcm90b3R5cGUucmVzZXRSZWZyZXNoQ291bnRlcj1mdW5jdGlvbigpe3RoaXMuX2N1cnJlbnRSZWZyZXNoSWQ9LTF9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcInJlZnJlc2hSYXRlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9yZWZyZXNoUmF0ZX0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX3JlZnJlc2hSYXRlPWUsdGhpcy5yZXNldFJlZnJlc2hDb3VudGVyKCl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksaS5wcm90b3R5cGUuX3Nob3VsZFJlbmRlcj1mdW5jdGlvbigpe3JldHVybi0xPT09dGhpcy5fY3VycmVudFJlZnJlc2hJZD8odGhpcy5fY3VycmVudFJlZnJlc2hJZD0xLCEwKTp0aGlzLnJlZnJlc2hSYXRlPT09dGhpcy5fY3VycmVudFJlZnJlc2hJZD8odGhpcy5fY3VycmVudFJlZnJlc2hJZD0xLCEwKToodGhpcy5fY3VycmVudFJlZnJlc2hJZCsrLCExKX0saS5wcm90b3R5cGUuaXNSZWFkeT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmdldFNjZW5lKCkucmVuZGVyVGFyZ2V0c0VuYWJsZWQ/dC5wcm90b3R5cGUuaXNSZWFkeS5jYWxsKHRoaXMpOiExfSxpLnByb3RvdHlwZS5nZXRSZW5kZXJTaXplPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3NpemV9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcImNhblJlc2NhbGVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuITB9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksaS5wcm90b3R5cGUuc2NhbGU9ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5fc2l6ZSplO3RoaXMucmVzaXplKHQsdGhpcy5fZ2VuZXJhdGVNaXBNYXBzKX0saS5wcm90b3R5cGUuZ2V0UmVmbGVjdGlvblRleHR1cmVNYXRyaXg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pc0N1YmU/dGhpcy5fdGV4dHVyZU1hdHJpeDp0LnByb3RvdHlwZS5nZXRSZWZsZWN0aW9uVGV4dHVyZU1hdHJpeC5jYWxsKHRoaXMpfSxpLnByb3RvdHlwZS5yZXNpemU9ZnVuY3Rpb24oZSx0KXt0aGlzLnJlbGVhc2VJbnRlcm5hbFRleHR1cmUoKSx0aGlzLmlzQ3ViZT90aGlzLl90ZXh0dXJlPXRoaXMuZ2V0U2NlbmUoKS5nZXRFbmdpbmUoKS5jcmVhdGVSZW5kZXJUYXJnZXRDdWJlVGV4dHVyZShlKTp0aGlzLl90ZXh0dXJlPXRoaXMuZ2V0U2NlbmUoKS5nZXRFbmdpbmUoKS5jcmVhdGVSZW5kZXJUYXJnZXRUZXh0dXJlKGUsdCl9LGkucHJvdG90eXBlLnJlbmRlcj1mdW5jdGlvbihlLHQpe3ZhciBpPXRoaXMuZ2V0U2NlbmUoKTtpZih2b2lkIDAhPT10aGlzLnVzZUNhbWVyYVBvc3RQcm9jZXNzZXMmJihlPXRoaXMudXNlQ2FtZXJhUG9zdFByb2Nlc3NlcyksdGhpcy5hY3RpdmVDYW1lcmEmJnRoaXMuYWN0aXZlQ2FtZXJhIT09aS5hY3RpdmVDYW1lcmEmJmkuc2V0VHJhbnNmb3JtTWF0cml4KHRoaXMuYWN0aXZlQ2FtZXJhLmdldFZpZXdNYXRyaXgoKSx0aGlzLmFjdGl2ZUNhbWVyYS5nZXRQcm9qZWN0aW9uTWF0cml4KCEwKSksdGhpcy5fd2FpdGluZ1JlbmRlckxpc3Qpe3RoaXMucmVuZGVyTGlzdD1bXTtmb3IodmFyIHI9MDtyPHRoaXMuX3dhaXRpbmdSZW5kZXJMaXN0Lmxlbmd0aDtyKyspe3ZhciBuPXRoaXMuX3dhaXRpbmdSZW5kZXJMaXN0W3JdO3RoaXMucmVuZGVyTGlzdC5wdXNoKGkuZ2V0TWVzaEJ5SUQobikpfWRlbGV0ZSB0aGlzLl93YWl0aW5nUmVuZGVyTGlzdH1pZih0aGlzLnJlbmRlckxpc3RQcmVkaWNhdGUpe3RoaXMucmVuZGVyTGlzdC5zcGxpY2UoMCk7Zm9yKHZhciBvPXRoaXMuZ2V0U2NlbmUoKS5tZXNoZXMscj0wO3I8by5sZW5ndGg7cisrKXt2YXIgcz1vW3JdO3RoaXMucmVuZGVyTGlzdFByZWRpY2F0ZShzKSYmdGhpcy5yZW5kZXJMaXN0LnB1c2gocyl9fWlmKCF0aGlzLnJlbmRlckxpc3R8fDAhPT10aGlzLnJlbmRlckxpc3QubGVuZ3RoKXt0aGlzLl9yZW5kZXJpbmdNYW5hZ2VyLnJlc2V0KCk7Zm9yKHZhciBhPXRoaXMucmVuZGVyTGlzdD90aGlzLnJlbmRlckxpc3Q6aS5nZXRBY3RpdmVNZXNoZXMoKS5kYXRhLGg9aS5nZXRSZW5kZXJJZCgpLGM9MDtjPGEubGVuZ3RoO2MrKyl7dmFyIHM9YVtjXTtpZihzKXtpZighcy5pc1JlYWR5KCkpe3RoaXMucmVzZXRSZWZyZXNoQ291bnRlcigpO2NvbnRpbnVlfWlmKHMuX3ByZUFjdGl2YXRlRm9ySW50ZXJtZWRpYXRlUmVuZGVyaW5nKGgpLHMuaXNFbmFibGVkKCkmJnMuaXNWaXNpYmxlJiZzLnN1Yk1lc2hlcyYmMCE9PShzLmxheWVyTWFzayZpLmFjdGl2ZUNhbWVyYS5sYXllck1hc2spKXtzLl9hY3RpdmF0ZShoKTtmb3IodmFyIGw9MDtsPHMuc3ViTWVzaGVzLmxlbmd0aDtsKyspe3ZhciB1PXMuc3ViTWVzaGVzW2xdO2kuX2FjdGl2ZUluZGljZXMrPXUuaW5kZXhDb3VudCx0aGlzLl9yZW5kZXJpbmdNYW5hZ2VyLmRpc3BhdGNoKHUpfX19fWlmKHRoaXMuaXNDdWJlKWZvcih2YXIgZj0wOzY+ZjtmKyspdGhpcy5yZW5kZXJUb1RhcmdldChmLGEsZSx0KSxpLmluY3JlbWVudFJlbmRlcklkKCksaS5yZXNldENhY2hlZE1hdGVyaWFsKCk7ZWxzZSB0aGlzLnJlbmRlclRvVGFyZ2V0KDAsYSxlLHQpO3RoaXMub25BZnRlclVuYmluZE9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpLHRoaXMuYWN0aXZlQ2FtZXJhJiZ0aGlzLmFjdGl2ZUNhbWVyYSE9PWkuYWN0aXZlQ2FtZXJhJiZpLnNldFRyYW5zZm9ybU1hdHJpeChpLmFjdGl2ZUNhbWVyYS5nZXRWaWV3TWF0cml4KCksaS5hY3RpdmVDYW1lcmEuZ2V0UHJvamVjdGlvbk1hdHJpeCghMCkpLGkucmVzZXRDYWNoZWRNYXRlcmlhbCgpfX0saS5wcm90b3R5cGUucmVuZGVyVG9UYXJnZXQ9ZnVuY3Rpb24odCxpLHIsbil7dmFyIG89dGhpcy5nZXRTY2VuZSgpLHM9by5nZXRFbmdpbmUoKTtyJiZvLnBvc3RQcm9jZXNzTWFuYWdlci5fcHJlcGFyZUZyYW1lKHRoaXMuX3RleHR1cmUpfHwodGhpcy5pc0N1YmU/cy5iaW5kRnJhbWVidWZmZXIodGhpcy5fdGV4dHVyZSx0KTpzLmJpbmRGcmFtZWJ1ZmZlcih0aGlzLl90ZXh0dXJlKSksdGhpcy5vbkJlZm9yZVJlbmRlck9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHQpLHRoaXMub25DbGVhck9ic2VydmFibGUuaGFzT2JzZXJ2ZXJzKCk/dGhpcy5vbkNsZWFyT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMocyk6cy5jbGVhcihvLmNsZWFyQ29sb3IsITAsITApLHRoaXMuX2RvTm90Q2hhbmdlQXNwZWN0UmF0aW98fG8udXBkYXRlVHJhbnNmb3JtTWF0cml4KCEwKSx0aGlzLl9yZW5kZXJpbmdNYW5hZ2VyLnJlbmRlcih0aGlzLmN1c3RvbVJlbmRlckZ1bmN0aW9uLGksdGhpcy5yZW5kZXJQYXJ0aWNsZXMsdGhpcy5yZW5kZXJTcHJpdGVzKSxyJiZvLnBvc3RQcm9jZXNzTWFuYWdlci5fZmluYWxpemVGcmFtZSghMSx0aGlzLl90ZXh0dXJlLHQpLHRoaXMuX2RvTm90Q2hhbmdlQXNwZWN0UmF0aW98fG8udXBkYXRlVHJhbnNmb3JtTWF0cml4KCEwKSx0aGlzLm9uQWZ0ZXJSZW5kZXJPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0KSxuJiZlLlRvb2xzLkR1bXBGcmFtZWJ1ZmZlcih0aGlzLl9zaXplLHRoaXMuX3NpemUscyksdGhpcy5pc0N1YmUmJjUhPT10fHwodGhpcy5pc0N1YmUmJjU9PT10JiZzLmdlbmVyYXRlTWlwTWFwc0ZvckN1YmVtYXAodGhpcy5fdGV4dHVyZSkscy51bkJpbmRGcmFtZWJ1ZmZlcih0aGlzLl90ZXh0dXJlLHRoaXMuaXNDdWJlKSl9LGkucHJvdG90eXBlLmNsb25lPWZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5nZXRTaXplKCksdD1uZXcgaSh0aGlzLm5hbWUsZS53aWR0aCx0aGlzLmdldFNjZW5lKCksdGhpcy5fZ2VuZXJhdGVNaXBNYXBzKTtyZXR1cm4gdC5oYXNBbHBoYT10aGlzLmhhc0FscGhhLHQubGV2ZWw9dGhpcy5sZXZlbCx0LmNvb3JkaW5hdGVzTW9kZT10aGlzLmNvb3JkaW5hdGVzTW9kZSx0LnJlbmRlckxpc3Q9dGhpcy5yZW5kZXJMaXN0LnNsaWNlKDApLHR9LGkucHJvdG90eXBlLnNlcmlhbGl6ZT1mdW5jdGlvbigpe2lmKCF0aGlzLm5hbWUpcmV0dXJuIG51bGw7dmFyIGU9dC5wcm90b3R5cGUuc2VyaWFsaXplLmNhbGwodGhpcyk7ZS5yZW5kZXJUYXJnZXRTaXplPXRoaXMuZ2V0UmVuZGVyU2l6ZSgpLGUucmVuZGVyTGlzdD1bXTtmb3IodmFyIGk9MDtpPHRoaXMucmVuZGVyTGlzdC5sZW5ndGg7aSsrKWUucmVuZGVyTGlzdC5wdXNoKHRoaXMucmVuZGVyTGlzdFtpXS5pZCk7cmV0dXJuIGV9LGkuX1JFRlJFU0hSQVRFX1JFTkRFUl9PTkNFPTAsaS5fUkVGUkVTSFJBVEVfUkVOREVSX09ORVZFUllGUkFNRT0xLGkuX1JFRlJFU0hSQVRFX1JFTkRFUl9PTkVWRVJZVFdPRlJBTUVTPTIsaX0oZS5UZXh0dXJlKTtlLlJlbmRlclRhcmdldFRleHR1cmU9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gaShpLHIsbixvLHMsYSxoKXt2b2lkIDA9PT1hJiYoYT0hMCksdm9pZCAwPT09aCYmKGg9ITEpLHQuY2FsbCh0aGlzLG51bGwsbywhYSksdGhpcy5pc0N1YmU9aCx0aGlzLmlzRW5hYmxlZD0hMCx0aGlzLl9jdXJyZW50UmVmcmVzaElkPS0xLHRoaXMuX3JlZnJlc2hSYXRlPTEsdGhpcy5fdmVydGV4QnVmZmVycz17fSx0aGlzLl91bmlmb3Jtcz1uZXcgQXJyYXksdGhpcy5fc2FtcGxlcnM9bmV3IEFycmF5LHRoaXMuX3RleHR1cmVzPW5ldyBBcnJheSx0aGlzLl9mbG9hdHM9bmV3IEFycmF5LHRoaXMuX2Zsb2F0c0FycmF5cz17fSx0aGlzLl9jb2xvcnMzPW5ldyBBcnJheSx0aGlzLl9jb2xvcnM0PW5ldyBBcnJheSx0aGlzLl92ZWN0b3JzMj1uZXcgQXJyYXksdGhpcy5fdmVjdG9yczM9bmV3IEFycmF5LHRoaXMuX21hdHJpY2VzPW5ldyBBcnJheSx0aGlzLl9mYWxsYmFja1RleHR1cmVVc2VkPSExLG8uX3Byb2NlZHVyYWxUZXh0dXJlcy5wdXNoKHRoaXMpLHRoaXMubmFtZT1pLHRoaXMuaXNSZW5kZXJUYXJnZXQ9ITAsdGhpcy5fc2l6ZT1yLHRoaXMuX2dlbmVyYXRlTWlwTWFwcz1hLHRoaXMuc2V0RnJhZ21lbnQobiksdGhpcy5fZmFsbGJhY2tUZXh0dXJlPXM7dmFyIGM9by5nZXRFbmdpbmUoKTtoPyh0aGlzLl90ZXh0dXJlPWMuY3JlYXRlUmVuZGVyVGFyZ2V0Q3ViZVRleHR1cmUocix7Z2VuZXJhdGVNaXBNYXBzOmF9KSx0aGlzLnNldEZsb2F0KFwiZmFjZVwiLDApKTp0aGlzLl90ZXh0dXJlPWMuY3JlYXRlUmVuZGVyVGFyZ2V0VGV4dHVyZShyLGEpO3ZhciBsPVtdO2wucHVzaCgxLDEpLGwucHVzaCgtMSwxKSxsLnB1c2goLTEsLTEpLGwucHVzaCgxLC0xKSx0aGlzLl92ZXJ0ZXhCdWZmZXJzW2UuVmVydGV4QnVmZmVyLlBvc2l0aW9uS2luZF09bmV3IGUuVmVydGV4QnVmZmVyKGMsbCxlLlZlcnRleEJ1ZmZlci5Qb3NpdGlvbktpbmQsITEsITEsMik7dmFyIHU9W107dS5wdXNoKDApLHUucHVzaCgxKSx1LnB1c2goMiksdS5wdXNoKDApLHUucHVzaCgyKSx1LnB1c2goMyksdGhpcy5faW5kZXhCdWZmZXI9Yy5jcmVhdGVJbmRleEJ1ZmZlcih1KX1yZXR1cm4gX19leHRlbmRzKGksdCksaS5wcm90b3R5cGUucmVzZXQ9ZnVuY3Rpb24oKXtpZih2b2lkIDAhPT10aGlzLl9lZmZlY3Qpe3ZhciBlPXRoaXMuZ2V0U2NlbmUoKS5nZXRFbmdpbmUoKTtlLl9yZWxlYXNlRWZmZWN0KHRoaXMuX2VmZmVjdCl9fSxpLnByb3RvdHlwZS5pc1JlYWR5PWZ1bmN0aW9uKCl7dmFyIHQsaT10aGlzLHI9dGhpcy5nZXRTY2VuZSgpLmdldEVuZ2luZSgpO3JldHVybiB0aGlzLl9mcmFnbWVudD90aGlzLl9mYWxsYmFja1RleHR1cmVVc2VkPyEwOih0PXZvaWQgMCE9PXRoaXMuX2ZyYWdtZW50LmZyYWdtZW50RWxlbWVudD97dmVydGV4OlwicHJvY2VkdXJhbFwiLGZyYWdtZW50RWxlbWVudDp0aGlzLl9mcmFnbWVudC5mcmFnbWVudEVsZW1lbnR9Ont2ZXJ0ZXg6XCJwcm9jZWR1cmFsXCIsZnJhZ21lbnQ6dGhpcy5fZnJhZ21lbnR9LHRoaXMuX2VmZmVjdD1yLmNyZWF0ZUVmZmVjdCh0LFtlLlZlcnRleEJ1ZmZlci5Qb3NpdGlvbktpbmRdLHRoaXMuX3VuaWZvcm1zLHRoaXMuX3NhbXBsZXJzLFwiXCIsbnVsbCxudWxsLGZ1bmN0aW9uKCl7aS5yZWxlYXNlSW50ZXJuYWxUZXh0dXJlKCksaS5fZmFsbGJhY2tUZXh0dXJlJiYoaS5fdGV4dHVyZT1pLl9mYWxsYmFja1RleHR1cmUuX3RleHR1cmUsaS5fdGV4dHVyZS5yZWZlcmVuY2VzKyspLGkuX2ZhbGxiYWNrVGV4dHVyZVVzZWQ9ITB9KSx0aGlzLl9lZmZlY3QuaXNSZWFkeSgpKTohMX0saS5wcm90b3R5cGUucmVzZXRSZWZyZXNoQ291bnRlcj1mdW5jdGlvbigpe3RoaXMuX2N1cnJlbnRSZWZyZXNoSWQ9LTF9LGkucHJvdG90eXBlLnNldEZyYWdtZW50PWZ1bmN0aW9uKGUpe3RoaXMuX2ZyYWdtZW50PWV9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcInJlZnJlc2hSYXRlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9yZWZyZXNoUmF0ZX0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX3JlZnJlc2hSYXRlPWUsdGhpcy5yZXNldFJlZnJlc2hDb3VudGVyKCl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksaS5wcm90b3R5cGUuX3Nob3VsZFJlbmRlcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmlzRW5hYmxlZCYmdGhpcy5pc1JlYWR5KCkmJnRoaXMuX3RleHR1cmU/dGhpcy5fZmFsbGJhY2tUZXh0dXJlVXNlZD8hMTotMT09PXRoaXMuX2N1cnJlbnRSZWZyZXNoSWQ/KHRoaXMuX2N1cnJlbnRSZWZyZXNoSWQ9MSwhMCk6dGhpcy5yZWZyZXNoUmF0ZT09PXRoaXMuX2N1cnJlbnRSZWZyZXNoSWQ/KHRoaXMuX2N1cnJlbnRSZWZyZXNoSWQ9MSwhMCk6KHRoaXMuX2N1cnJlbnRSZWZyZXNoSWQrKywhMSk6ITF9LGkucHJvdG90eXBlLmdldFJlbmRlclNpemU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc2l6ZX0saS5wcm90b3R5cGUucmVzaXplPWZ1bmN0aW9uKGUsdCl7dGhpcy5fZmFsbGJhY2tUZXh0dXJlVXNlZHx8KHRoaXMucmVsZWFzZUludGVybmFsVGV4dHVyZSgpLHRoaXMuX3RleHR1cmU9dGhpcy5nZXRTY2VuZSgpLmdldEVuZ2luZSgpLmNyZWF0ZVJlbmRlclRhcmdldFRleHR1cmUoZSx0KSl9LGkucHJvdG90eXBlLl9jaGVja1VuaWZvcm09ZnVuY3Rpb24oZSl7LTE9PT10aGlzLl91bmlmb3Jtcy5pbmRleE9mKGUpJiZ0aGlzLl91bmlmb3Jtcy5wdXNoKGUpfSxpLnByb3RvdHlwZS5zZXRUZXh0dXJlPWZ1bmN0aW9uKGUsdCl7cmV0dXJuLTE9PT10aGlzLl9zYW1wbGVycy5pbmRleE9mKGUpJiZ0aGlzLl9zYW1wbGVycy5wdXNoKGUpLHRoaXMuX3RleHR1cmVzW2VdPXQsdGhpc30saS5wcm90b3R5cGUuc2V0RmxvYXQ9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5fY2hlY2tVbmlmb3JtKGUpLHRoaXMuX2Zsb2F0c1tlXT10LHRoaXN9LGkucHJvdG90eXBlLnNldEZsb2F0cz1mdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLl9jaGVja1VuaWZvcm0oZSksdGhpcy5fZmxvYXRzQXJyYXlzW2VdPXQsdGhpc30saS5wcm90b3R5cGUuc2V0Q29sb3IzPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuX2NoZWNrVW5pZm9ybShlKSx0aGlzLl9jb2xvcnMzW2VdPXQsdGhpc30saS5wcm90b3R5cGUuc2V0Q29sb3I0PWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuX2NoZWNrVW5pZm9ybShlKSx0aGlzLl9jb2xvcnM0W2VdPXQsdGhpc30saS5wcm90b3R5cGUuc2V0VmVjdG9yMj1mdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLl9jaGVja1VuaWZvcm0oZSksXG50aGlzLl92ZWN0b3JzMltlXT10LHRoaXN9LGkucHJvdG90eXBlLnNldFZlY3RvcjM9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5fY2hlY2tVbmlmb3JtKGUpLHRoaXMuX3ZlY3RvcnMzW2VdPXQsdGhpc30saS5wcm90b3R5cGUuc2V0TWF0cml4PWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuX2NoZWNrVW5pZm9ybShlKSx0aGlzLl9tYXRyaWNlc1tlXT10LHRoaXN9LGkucHJvdG90eXBlLnJlbmRlcj1mdW5jdGlvbihlKXt2YXIgdD10aGlzLmdldFNjZW5lKCksaT10LmdldEVuZ2luZSgpO2kuZW5hYmxlRWZmZWN0KHRoaXMuX2VmZmVjdCksaS5zZXRTdGF0ZSghMSk7Zm9yKHZhciByIGluIHRoaXMuX3RleHR1cmVzKXRoaXMuX2VmZmVjdC5zZXRUZXh0dXJlKHIsdGhpcy5fdGV4dHVyZXNbcl0pO2ZvcihyIGluIHRoaXMuX2Zsb2F0cyl0aGlzLl9lZmZlY3Quc2V0RmxvYXQocix0aGlzLl9mbG9hdHNbcl0pO2ZvcihyIGluIHRoaXMuX2Zsb2F0c0FycmF5cyl0aGlzLl9lZmZlY3Quc2V0QXJyYXkocix0aGlzLl9mbG9hdHNBcnJheXNbcl0pO2ZvcihyIGluIHRoaXMuX2NvbG9yczMpdGhpcy5fZWZmZWN0LnNldENvbG9yMyhyLHRoaXMuX2NvbG9yczNbcl0pO2ZvcihyIGluIHRoaXMuX2NvbG9yczQpe3ZhciBuPXRoaXMuX2NvbG9yczRbcl07dGhpcy5fZWZmZWN0LnNldEZsb2F0NChyLG4ucixuLmcsbi5iLG4uYSl9Zm9yKHIgaW4gdGhpcy5fdmVjdG9yczIpdGhpcy5fZWZmZWN0LnNldFZlY3RvcjIocix0aGlzLl92ZWN0b3JzMltyXSk7Zm9yKHIgaW4gdGhpcy5fdmVjdG9yczMpdGhpcy5fZWZmZWN0LnNldFZlY3RvcjMocix0aGlzLl92ZWN0b3JzM1tyXSk7Zm9yKHIgaW4gdGhpcy5fbWF0cmljZXMpdGhpcy5fZWZmZWN0LnNldE1hdHJpeChyLHRoaXMuX21hdHJpY2VzW3JdKTtpZihpLmJpbmRCdWZmZXJzKHRoaXMuX3ZlcnRleEJ1ZmZlcnMsdGhpcy5faW5kZXhCdWZmZXIsdGhpcy5fZWZmZWN0KSx0aGlzLmlzQ3ViZSlmb3IodmFyIG89MDs2Pm87bysrKWkuYmluZEZyYW1lYnVmZmVyKHRoaXMuX3RleHR1cmUsbyksdGhpcy5fZWZmZWN0LnNldEZsb2F0KFwiZmFjZVwiLG8pLGkuY2xlYXIodC5jbGVhckNvbG9yLCEwLCEwKSxpLmRyYXcoITAsMCw2KSw1PT09byYmaS5nZW5lcmF0ZU1pcE1hcHNGb3JDdWJlbWFwKHRoaXMuX3RleHR1cmUpO2Vsc2UgaS5iaW5kRnJhbWVidWZmZXIodGhpcy5fdGV4dHVyZSksaS5jbGVhcih0LmNsZWFyQ29sb3IsITAsITApLGkuZHJhdyghMCwwLDYpO2kudW5CaW5kRnJhbWVidWZmZXIodGhpcy5fdGV4dHVyZSx0aGlzLmlzQ3ViZSksdGhpcy5vbkdlbmVyYXRlZCYmdGhpcy5vbkdlbmVyYXRlZCgpfSxpLnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbigpe3ZhciBlPXRoaXMuZ2V0U2l6ZSgpLHQ9bmV3IGkodGhpcy5uYW1lLGUud2lkdGgsdGhpcy5fZnJhZ21lbnQsdGhpcy5nZXRTY2VuZSgpLHRoaXMuX2ZhbGxiYWNrVGV4dHVyZSx0aGlzLl9nZW5lcmF0ZU1pcE1hcHMpO3JldHVybiB0Lmhhc0FscGhhPXRoaXMuaGFzQWxwaGEsdC5sZXZlbD10aGlzLmxldmVsLHQuY29vcmRpbmF0ZXNNb2RlPXRoaXMuY29vcmRpbmF0ZXNNb2RlLHR9LGkucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXt2YXIgaT10aGlzLmdldFNjZW5lKCkuX3Byb2NlZHVyYWxUZXh0dXJlcy5pbmRleE9mKHRoaXMpO2k+PTAmJnRoaXMuZ2V0U2NlbmUoKS5fcHJvY2VkdXJhbFRleHR1cmVzLnNwbGljZShpLDEpO3ZhciByPXRoaXMuX3ZlcnRleEJ1ZmZlcnNbZS5WZXJ0ZXhCdWZmZXIuUG9zaXRpb25LaW5kXTtyJiYoci5kaXNwb3NlKCksdGhpcy5fdmVydGV4QnVmZmVyc1tlLlZlcnRleEJ1ZmZlci5Qb3NpdGlvbktpbmRdPW51bGwpLHRoaXMuX2luZGV4QnVmZmVyJiZ0aGlzLmdldFNjZW5lKCkuZ2V0RW5naW5lKCkuX3JlbGVhc2VCdWZmZXIodGhpcy5faW5kZXhCdWZmZXIpJiYodGhpcy5faW5kZXhCdWZmZXI9bnVsbCksdC5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpfSxpfShlLlRleHR1cmUpO2UuUHJvY2VkdXJhbFRleHR1cmU9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gaShpLHIsbixvKXt2YXIgcz10aGlzO3QuY2FsbCh0aGlzLGkscixuLG8sITApLHRoaXMubWlycm9yUGxhbmU9bmV3IGUuUGxhbmUoMCwxLDAsMSksdGhpcy5fdHJhbnNmb3JtTWF0cml4PWUuTWF0cml4Llplcm8oKSx0aGlzLl9taXJyb3JNYXRyaXg9ZS5NYXRyaXguWmVybygpLHRoaXMub25CZWZvcmVSZW5kZXJPYnNlcnZhYmxlLmFkZChmdW5jdGlvbigpe2UuTWF0cml4LlJlZmxlY3Rpb25Ub1JlZihzLm1pcnJvclBsYW5lLHMuX21pcnJvck1hdHJpeCkscy5fc2F2ZWRWaWV3TWF0cml4PW4uZ2V0Vmlld01hdHJpeCgpLHMuX21pcnJvck1hdHJpeC5tdWx0aXBseVRvUmVmKHMuX3NhdmVkVmlld01hdHJpeCxzLl90cmFuc2Zvcm1NYXRyaXgpLG4uc2V0VHJhbnNmb3JtTWF0cml4KHMuX3RyYW5zZm9ybU1hdHJpeCxuLmdldFByb2plY3Rpb25NYXRyaXgoKSksbi5jbGlwUGxhbmU9cy5taXJyb3JQbGFuZSxuLmdldEVuZ2luZSgpLmN1bGxCYWNrRmFjZXM9ITEsbi5fbWlycm9yZWRDYW1lcmFQb3NpdGlvbj1lLlZlY3RvcjMuVHJhbnNmb3JtQ29vcmRpbmF0ZXMobi5hY3RpdmVDYW1lcmEucG9zaXRpb24scy5fbWlycm9yTWF0cml4KX0pLHRoaXMub25BZnRlclJlbmRlck9ic2VydmFibGUuYWRkKGZ1bmN0aW9uKCl7bi5zZXRUcmFuc2Zvcm1NYXRyaXgocy5fc2F2ZWRWaWV3TWF0cml4LG4uZ2V0UHJvamVjdGlvbk1hdHJpeCgpKSxuLmdldEVuZ2luZSgpLmN1bGxCYWNrRmFjZXM9ITAsbi5fbWlycm9yZWRDYW1lcmFQb3NpdGlvbj1udWxsLGRlbGV0ZSBuLmNsaXBQbGFuZX0pfXJldHVybiBfX2V4dGVuZHMoaSx0KSxpLnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbigpe3ZhciBlPXRoaXMuZ2V0U2l6ZSgpLHQ9bmV3IGkodGhpcy5uYW1lLGUud2lkdGgsdGhpcy5nZXRTY2VuZSgpLHRoaXMuX2dlbmVyYXRlTWlwTWFwcyk7cmV0dXJuIHQuaGFzQWxwaGE9dGhpcy5oYXNBbHBoYSx0LmxldmVsPXRoaXMubGV2ZWwsdC5taXJyb3JQbGFuZT10aGlzLm1pcnJvclBsYW5lLmNsb25lKCksdC5yZW5kZXJMaXN0PXRoaXMucmVuZGVyTGlzdC5zbGljZSgwKSx0fSxpLnByb3RvdHlwZS5zZXJpYWxpemU9ZnVuY3Rpb24oKXtpZighdGhpcy5uYW1lKXJldHVybiBudWxsO3ZhciBlPXQucHJvdG90eXBlLnNlcmlhbGl6ZS5jYWxsKHRoaXMpO3JldHVybiBlLm1pcnJvclBsYW5lPXRoaXMubWlycm9yUGxhbmUuYXNBcnJheSgpLGV9LGl9KGUuUmVuZGVyVGFyZ2V0VGV4dHVyZSk7ZS5NaXJyb3JUZXh0dXJlPXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGkoaSxyLG4sbyl7dmFyIHM9dGhpczt0LmNhbGwodGhpcyxpLHIsbixvLCEwKSx0aGlzLnJlZnJhY3Rpb25QbGFuZT1uZXcgZS5QbGFuZSgwLDEsMCwxKSx0aGlzLmRlcHRoPTIsdGhpcy5vbkJlZm9yZVJlbmRlck9ic2VydmFibGUuYWRkKGZ1bmN0aW9uKCl7bi5jbGlwUGxhbmU9cy5yZWZyYWN0aW9uUGxhbmV9KSx0aGlzLm9uQWZ0ZXJSZW5kZXJPYnNlcnZhYmxlLmFkZChmdW5jdGlvbigpe2RlbGV0ZSBuLmNsaXBQbGFuZX0pfXJldHVybiBfX2V4dGVuZHMoaSx0KSxpLnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbigpe3ZhciBlPXRoaXMuZ2V0U2l6ZSgpLHQ9bmV3IGkodGhpcy5uYW1lLGUud2lkdGgsdGhpcy5nZXRTY2VuZSgpLHRoaXMuX2dlbmVyYXRlTWlwTWFwcyk7cmV0dXJuIHQuaGFzQWxwaGE9dGhpcy5oYXNBbHBoYSx0LmxldmVsPXRoaXMubGV2ZWwsdC5yZWZyYWN0aW9uUGxhbmU9dGhpcy5yZWZyYWN0aW9uUGxhbmUuY2xvbmUoKSx0LnJlbmRlckxpc3Q9dGhpcy5yZW5kZXJMaXN0LnNsaWNlKDApLHQuZGVwdGg9dGhpcy5kZXB0aCx0fSxpLnByb3RvdHlwZS5zZXJpYWxpemU9ZnVuY3Rpb24oKXtpZighdGhpcy5uYW1lKXJldHVybiBudWxsO3ZhciBlPXQucHJvdG90eXBlLnNlcmlhbGl6ZS5jYWxsKHRoaXMpO3JldHVybiBlLm1pcnJvclBsYW5lPXRoaXMucmVmcmFjdGlvblBsYW5lLmFzQXJyYXkoKSxlLmRlcHRoPXRoaXMuZGVwdGgsZX0saX0oZS5SZW5kZXJUYXJnZXRUZXh0dXJlKTtlLlJlZnJhY3Rpb25UZXh0dXJlPXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGkoaSxyLG4sbyxzKXt2b2lkIDA9PT1zJiYocz1lLlRleHR1cmUuVFJJTElORUFSX1NBTVBMSU5HTU9ERSksdC5jYWxsKHRoaXMsbnVsbCxuLCFvKSx0aGlzLm5hbWU9aSx0aGlzLndyYXBVPWUuVGV4dHVyZS5DTEFNUF9BRERSRVNTTU9ERSx0aGlzLndyYXBWPWUuVGV4dHVyZS5DTEFNUF9BRERSRVNTTU9ERSx0aGlzLl9nZW5lcmF0ZU1pcE1hcHM9byxyLmdldENvbnRleHQ/KHRoaXMuX2NhbnZhcz1yLHRoaXMuX3RleHR1cmU9bi5nZXRFbmdpbmUoKS5jcmVhdGVEeW5hbWljVGV4dHVyZShyLndpZHRoLHIuaGVpZ2h0LG8scykpOih0aGlzLl9jYW52YXM9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKSxyLndpZHRoP3RoaXMuX3RleHR1cmU9bi5nZXRFbmdpbmUoKS5jcmVhdGVEeW5hbWljVGV4dHVyZShyLndpZHRoLHIuaGVpZ2h0LG8scyk6dGhpcy5fdGV4dHVyZT1uLmdldEVuZ2luZSgpLmNyZWF0ZUR5bmFtaWNUZXh0dXJlKHIscixvLHMpKTt2YXIgYT10aGlzLmdldFNpemUoKTt0aGlzLl9jYW52YXMud2lkdGg9YS53aWR0aCx0aGlzLl9jYW52YXMuaGVpZ2h0PWEuaGVpZ2h0LHRoaXMuX2NvbnRleHQ9dGhpcy5fY2FudmFzLmdldENvbnRleHQoXCIyZFwiKX1yZXR1cm4gX19leHRlbmRzKGksdCksT2JqZWN0LmRlZmluZVByb3BlcnR5KGkucHJvdG90eXBlLFwiY2FuUmVzY2FsZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4hMH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxpLnByb3RvdHlwZS5zY2FsZT1mdW5jdGlvbihlKXt2YXIgdD10aGlzLmdldFNpemUoKTt0LndpZHRoKj1lLHQuaGVpZ2h0Kj1lLHRoaXMuX2NhbnZhcy53aWR0aD10LndpZHRoLHRoaXMuX2NhbnZhcy5oZWlnaHQ9dC5oZWlnaHQsdGhpcy5yZWxlYXNlSW50ZXJuYWxUZXh0dXJlKCksdGhpcy5fdGV4dHVyZT10aGlzLmdldFNjZW5lKCkuZ2V0RW5naW5lKCkuY3JlYXRlRHluYW1pY1RleHR1cmUodC53aWR0aCx0LmhlaWdodCx0aGlzLl9nZW5lcmF0ZU1pcE1hcHMsdGhpcy5fc2FtcGxpbmdNb2RlKX0saS5wcm90b3R5cGUuZ2V0Q29udGV4dD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9jb250ZXh0fSxpLnByb3RvdHlwZS5jbGVhcj1mdW5jdGlvbigpe3ZhciBlPXRoaXMuZ2V0U2l6ZSgpO3RoaXMuX2NvbnRleHQuZmlsbFJlY3QoMCwwLGUud2lkdGgsZS5oZWlnaHQpfSxpLnByb3RvdHlwZS51cGRhdGU9ZnVuY3Rpb24oZSl7dGhpcy5nZXRTY2VuZSgpLmdldEVuZ2luZSgpLnVwZGF0ZUR5bmFtaWNUZXh0dXJlKHRoaXMuX3RleHR1cmUsdGhpcy5fY2FudmFzLHZvaWQgMD09PWU/ITA6ZSl9LGkucHJvdG90eXBlLmRyYXdUZXh0PWZ1bmN0aW9uKGUsdCxpLHIsbixvLHMsYSl7dm9pZCAwPT09YSYmKGE9ITApO3ZhciBoPXRoaXMuZ2V0U2l6ZSgpO2lmKG8mJih0aGlzLl9jb250ZXh0LmZpbGxTdHlsZT1vLHRoaXMuX2NvbnRleHQuZmlsbFJlY3QoMCwwLGgud2lkdGgsaC5oZWlnaHQpKSx0aGlzLl9jb250ZXh0LmZvbnQ9cixudWxsPT09dCl7dmFyIGM9dGhpcy5fY29udGV4dC5tZWFzdXJlVGV4dChlKTt0PShoLndpZHRoLWMud2lkdGgpLzJ9dGhpcy5fY29udGV4dC5maWxsU3R5bGU9bix0aGlzLl9jb250ZXh0LmZpbGxUZXh0KGUsdCxpKSxhJiZ0aGlzLnVwZGF0ZShzKX0saS5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oKXt2YXIgZT10aGlzLmdldFNpemUoKSx0PW5ldyBpKHRoaXMubmFtZSxlLHRoaXMuZ2V0U2NlbmUoKSx0aGlzLl9nZW5lcmF0ZU1pcE1hcHMpO3JldHVybiB0Lmhhc0FscGhhPXRoaXMuaGFzQWxwaGEsdC5sZXZlbD10aGlzLmxldmVsLHQud3JhcFU9dGhpcy53cmFwVSx0LndyYXBWPXRoaXMud3JhcFYsdH0saX0oZS5UZXh0dXJlKTtlLkR5bmFtaWNUZXh0dXJlPXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGkoaSxyLG4sbyxzLGEpe3ZhciBoPXRoaXM7dm9pZCAwPT09byYmKG89ITEpLHZvaWQgMD09PXMmJihzPSExKSx2b2lkIDA9PT1hJiYoYT1lLlRleHR1cmUuVFJJTElORUFSX1NBTVBMSU5HTU9ERSksdC5jYWxsKHRoaXMsbnVsbCxuLCFvLHMpLHRoaXMuX2F1dG9MYXVuY2g9ITA7dmFyIGM7dGhpcy5uYW1lPWksciBpbnN0YW5jZW9mIEhUTUxWaWRlb0VsZW1lbnQ/dGhpcy52aWRlbz1yOihjPXIsdGhpcy52aWRlbz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidmlkZW9cIiksdGhpcy52aWRlby5hdXRvcGxheT0hMSx0aGlzLnZpZGVvLmxvb3A9ITApLHRoaXMuX2dlbmVyYXRlTWlwTWFwcz1vLHRoaXMuX3NhbXBsaW5nTW9kZT1hLGUuVG9vbHMuSXNFeHBvbmVudE9mVHdvKHRoaXMudmlkZW8udmlkZW9XaWR0aCkmJmUuVG9vbHMuSXNFeHBvbmVudE9mVHdvKHRoaXMudmlkZW8udmlkZW9IZWlnaHQpPyh0aGlzLndyYXBVPWUuVGV4dHVyZS5XUkFQX0FERFJFU1NNT0RFLHRoaXMud3JhcFY9ZS5UZXh0dXJlLldSQVBfQUREUkVTU01PREUpOih0aGlzLndyYXBVPWUuVGV4dHVyZS5DTEFNUF9BRERSRVNTTU9ERSx0aGlzLndyYXBWPWUuVGV4dHVyZS5DTEFNUF9BRERSRVNTTU9ERSx0aGlzLl9nZW5lcmF0ZU1pcE1hcHM9ITEpLGM/KHRoaXMudmlkZW8uYWRkRXZlbnRMaXN0ZW5lcihcImNhbnBsYXl0aHJvdWdoXCIsZnVuY3Rpb24oKXtoLl9jcmVhdGVUZXh0dXJlKCl9KSxjLmZvckVhY2goZnVuY3Rpb24oZSl7dmFyIHQ9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNvdXJjZVwiKTt0LnNyYz1lLGgudmlkZW8uYXBwZW5kQ2hpbGQodCl9KSk6dGhpcy5fY3JlYXRlVGV4dHVyZSgpLHRoaXMuX2xhc3RVcGRhdGU9ZS5Ub29scy5Ob3d9cmV0dXJuIF9fZXh0ZW5kcyhpLHQpLGkucHJvdG90eXBlLl9jcmVhdGVUZXh0dXJlPWZ1bmN0aW9uKCl7dGhpcy5fdGV4dHVyZT10aGlzLmdldFNjZW5lKCkuZ2V0RW5naW5lKCkuY3JlYXRlRHluYW1pY1RleHR1cmUodGhpcy52aWRlby52aWRlb1dpZHRoLHRoaXMudmlkZW8udmlkZW9IZWlnaHQsdGhpcy5fZ2VuZXJhdGVNaXBNYXBzLHRoaXMuX3NhbXBsaW5nTW9kZSksdGhpcy5fdGV4dHVyZS5pc1JlYWR5PSEwfSxpLnByb3RvdHlwZS51cGRhdGU9ZnVuY3Rpb24oKXt0aGlzLl9hdXRvTGF1bmNoJiYodGhpcy5fYXV0b0xhdW5jaD0hMSx0aGlzLnZpZGVvLnBsYXkoKSk7dmFyIHQ9ZS5Ub29scy5Ob3c7cmV0dXJuIHQtdGhpcy5fbGFzdFVwZGF0ZTwxNXx8dGhpcy52aWRlby5yZWFkeVN0YXRlIT09dGhpcy52aWRlby5IQVZFX0VOT1VHSF9EQVRBPyExOih0aGlzLl9sYXN0VXBkYXRlPXQsdGhpcy5nZXRTY2VuZSgpLmdldEVuZ2luZSgpLnVwZGF0ZVZpZGVvVGV4dHVyZSh0aGlzLl90ZXh0dXJlLHRoaXMudmlkZW8sdGhpcy5faW52ZXJ0WSksITApfSxpfShlLlRleHR1cmUpO2UuVmlkZW9UZXh0dXJlPXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGkoZSxpLHIsbixvLHMpe3QuY2FsbCh0aGlzLGUscixudWxsLG4sbyxzKSx0aGlzLl9hbmltYXRlPSEwLHRoaXMuX3RpbWU9MCx0aGlzLl90ZXh0dXJlUGF0aD1pLHRoaXMubG9hZEpzb24oaSksdGhpcy5yZWZyZXNoUmF0ZT0xfXJldHVybiBfX2V4dGVuZHMoaSx0KSxpLnByb3RvdHlwZS5sb2FkSnNvbj1mdW5jdGlvbih0KXtmdW5jdGlvbiBpKCl7ZS5Ub29scy5Mb2coXCJObyBjb25maWcgZmlsZSBmb3VuZCBpbiBcIit0K1wiIHRyeWluZyB0byB1c2UgU2hhZGVyc1N0b3JlIG9yIERPTSBlbGVtZW50XCIpO3RyeXtuLnNldEZyYWdtZW50KG4uX3RleHR1cmVQYXRoKX1jYXRjaChpKXtlLlRvb2xzLkVycm9yKFwiTm8ganNvbiBvciBTaGFkZXJTdG9yZSBvciBET00gZWxlbWVudCBmb3VuZCBmb3IgQ3VzdG9tUHJvY2VkdXJhbFRleHR1cmVcIil9fXZhciByPXRoaXMsbj10aGlzLG89dCtcIi9jb25maWcuanNvblwiLHM9bmV3IFhNTEh0dHBSZXF1ZXN0O3Mub3BlbihcIkdFVFwiLG8sITApLHMuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIixmdW5jdGlvbigpe2lmKDIwMD09PXMuc3RhdHVzfHxlLlRvb2xzLlZhbGlkYXRlWEhSRGF0YShzLDEpKXRyeXtyLl9jb25maWc9SlNPTi5wYXJzZShzLnJlc3BvbnNlKSxyLnVwZGF0ZVNoYWRlclVuaWZvcm1zKCksci51cGRhdGVUZXh0dXJlcygpLHIuc2V0RnJhZ21lbnQoci5fdGV4dHVyZVBhdGgrXCIvY3VzdG9tXCIpLHIuX2FuaW1hdGU9ci5fY29uZmlnLmFuaW1hdGUsci5yZWZyZXNoUmF0ZT1yLl9jb25maWcucmVmcmVzaHJhdGV9Y2F0Y2godCl7aSgpfWVsc2UgaSgpfSwhMSkscy5hZGRFdmVudExpc3RlbmVyKFwiZXJyb3JcIixmdW5jdGlvbigpe2koKX0sITEpO3RyeXtzLnNlbmQoKX1jYXRjaChhKXtlLlRvb2xzLkVycm9yKFwiQ3VzdG9tUHJvY2VkdXJhbFRleHR1cmU6IEVycm9yIG9uIFhIUiBzZW5kIHJlcXVlc3QuXCIpfX0saS5wcm90b3R5cGUuaXNSZWFkeT1mdW5jdGlvbigpe2lmKCF0LnByb3RvdHlwZS5pc1JlYWR5LmNhbGwodGhpcykpcmV0dXJuITE7Zm9yKHZhciBlIGluIHRoaXMuX3RleHR1cmVzKXt2YXIgaT10aGlzLl90ZXh0dXJlc1tlXTtpZighaS5pc1JlYWR5KCkpcmV0dXJuITF9cmV0dXJuITB9LGkucHJvdG90eXBlLnJlbmRlcj1mdW5jdGlvbihlKXt0aGlzLl9hbmltYXRlJiYodGhpcy5fdGltZSs9LjAzKnRoaXMuZ2V0U2NlbmUoKS5nZXRBbmltYXRpb25SYXRpbygpLHRoaXMudXBkYXRlU2hhZGVyVW5pZm9ybXMoKSksdC5wcm90b3R5cGUucmVuZGVyLmNhbGwodGhpcyxlKX0saS5wcm90b3R5cGUudXBkYXRlVGV4dHVyZXM9ZnVuY3Rpb24oKXtmb3IodmFyIHQ9MDt0PHRoaXMuX2NvbmZpZy5zYW1wbGVyMkRzLmxlbmd0aDt0KyspdGhpcy5zZXRUZXh0dXJlKHRoaXMuX2NvbmZpZy5zYW1wbGVyMkRzW3RdLnNhbXBsZTJEbmFtZSxuZXcgZS5UZXh0dXJlKHRoaXMuX3RleHR1cmVQYXRoK1wiL1wiK3RoaXMuX2NvbmZpZy5zYW1wbGVyMkRzW3RdLnRleHR1cmVSZWxhdGl2ZVVybCx0aGlzLmdldFNjZW5lKCkpKX0saS5wcm90b3R5cGUudXBkYXRlU2hhZGVyVW5pZm9ybXM9ZnVuY3Rpb24oKXtpZih0aGlzLl9jb25maWcpZm9yKHZhciB0PTA7dDx0aGlzLl9jb25maWcudW5pZm9ybXMubGVuZ3RoO3QrKyl7dmFyIGk9dGhpcy5fY29uZmlnLnVuaWZvcm1zW3RdO3N3aXRjaChpLnR5cGUpe2Nhc2VcImZsb2F0XCI6dGhpcy5zZXRGbG9hdChpLm5hbWUsaS52YWx1ZSk7YnJlYWs7Y2FzZVwiY29sb3IzXCI6dGhpcy5zZXRDb2xvcjMoaS5uYW1lLG5ldyBlLkNvbG9yMyhpLnIsaS5nLGkuYikpO2JyZWFrO2Nhc2VcImNvbG9yNFwiOnRoaXMuc2V0Q29sb3I0KGkubmFtZSxuZXcgZS5Db2xvcjQoaS5yLGkuZyxpLmIsaS5hKSk7YnJlYWs7Y2FzZVwidmVjdG9yMlwiOnRoaXMuc2V0VmVjdG9yMihpLm5hbWUsbmV3IGUuVmVjdG9yMihpLngsaS55KSk7YnJlYWs7Y2FzZVwidmVjdG9yM1wiOnRoaXMuc2V0VmVjdG9yMyhpLm5hbWUsbmV3IGUuVmVjdG9yMyhpLngsaS55LGkueikpfX10aGlzLnNldEZsb2F0KFwidGltZVwiLHRoaXMuX3RpbWUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJhbmltYXRlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9hbmltYXRlfSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fYW5pbWF0ZT1lfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLGl9KGUuUHJvY2VkdXJhbFRleHR1cmUpO2UuQ3VzdG9tUHJvY2VkdXJhbFRleHR1cmU9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KCl7dGhpcy5fZGVmaW5lcz17fSx0aGlzLl9jdXJyZW50UmFuaz0zMix0aGlzLl9tYXhSYW5rPS0xfXJldHVybiB0LnByb3RvdHlwZS5hZGRGYWxsYmFjaz1mdW5jdGlvbihlLHQpe3RoaXMuX2RlZmluZXNbZV18fChlPHRoaXMuX2N1cnJlbnRSYW5rJiYodGhpcy5fY3VycmVudFJhbms9ZSksZT50aGlzLl9tYXhSYW5rJiYodGhpcy5fbWF4UmFuaz1lKSx0aGlzLl9kZWZpbmVzW2VdPW5ldyBBcnJheSksdGhpcy5fZGVmaW5lc1tlXS5wdXNoKHQpfSx0LnByb3RvdHlwZS5hZGRDUFVTa2lubmluZ0ZhbGxiYWNrPWZ1bmN0aW9uKGUsdCl7dGhpcy5fbWVzaFJhbms9ZSx0aGlzLl9tZXNoPXQsZT50aGlzLl9tYXhSYW5rJiYodGhpcy5fbWF4UmFuaz1lKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwiaXNNb3JlRmFsbGJhY2tzXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9jdXJyZW50UmFuazw9dGhpcy5fbWF4UmFua30sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSx0LnByb3RvdHlwZS5yZWR1Y2U9ZnVuY3Rpb24odCl7Zm9yKHZhciBpPXRoaXMuX2RlZmluZXNbdGhpcy5fY3VycmVudFJhbmtdLHI9MDtyPGkubGVuZ3RoO3IrKyl0PXQucmVwbGFjZShcIiNkZWZpbmUgXCIraVtyXSxcIlwiKTtyZXR1cm4gdGhpcy5fbWVzaCYmdGhpcy5fY3VycmVudFJhbms9PT10aGlzLl9tZXNoUmFuayYmKHRoaXMuX21lc2guY29tcHV0ZUJvbmVzVXNpbmdTaGFkZXJzPSExLHQ9dC5yZXBsYWNlKFwiI2RlZmluZSBOVU1fQk9ORV9JTkZMVUVOQ0VSUyBcIit0aGlzLl9tZXNoLm51bUJvbmVJbmZsdWVuY2VycyxcIiNkZWZpbmUgTlVNX0JPTkVfSU5GTFVFTkNFUlMgMFwiKSxlLlRvb2xzLkxvZyhcIkZhbGxpbmcgYmFjayB0byBDUFUgc2tpbm5pbmcgZm9yIFwiK3RoaXMuX21lc2gubmFtZSkpLHRoaXMuX2N1cnJlbnRSYW5rKyssdH0sdH0oKTtlLkVmZmVjdEZhbGxiYWNrcz10O3ZhciBpPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdChlLHQsaSxyLG4sbyxzLGEsaCxjKXt2YXIgbD10aGlzO3RoaXMuX2lzUmVhZHk9ITEsdGhpcy5fY29tcGlsYXRpb25FcnJvcj1cIlwiLHRoaXMuX3ZhbHVlQ2FjaGU9W10sdGhpcy5fZW5naW5lPW4sdGhpcy5uYW1lPWUsdGhpcy5kZWZpbmVzPW8sdGhpcy5fdW5pZm9ybXNOYW1lcz1pLmNvbmNhdChyKSx0aGlzLl9zYW1wbGVycz1yLHRoaXMuX2F0dHJpYnV0ZXNOYW1lcz10LHRoaXMub25FcnJvcj1oLHRoaXMub25Db21waWxlZD1hLHRoaXMuX2luZGV4UGFyYW1ldGVycz1jO3ZhciB1LGY7ZS52ZXJ0ZXhFbGVtZW50Pyh1PWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGUudmVydGV4RWxlbWVudCksdXx8KHU9ZS52ZXJ0ZXhFbGVtZW50KSk6dT1lLnZlcnRleHx8ZSxlLmZyYWdtZW50RWxlbWVudD8oZj1kb2N1bWVudC5nZXRFbGVtZW50QnlJZChlLmZyYWdtZW50RWxlbWVudCksZnx8KGY9ZS5mcmFnbWVudEVsZW1lbnQpKTpmPWUuZnJhZ21lbnR8fGUsdGhpcy5fbG9hZFZlcnRleFNoYWRlcih1LGZ1bmN0aW9uKGUpe2wuX3Byb2Nlc3NJbmNsdWRlcyhlLGZ1bmN0aW9uKGUpe2wuX2xvYWRGcmFnbWVudFNoYWRlcihmLGZ1bmN0aW9uKGkpe2wuX3Byb2Nlc3NJbmNsdWRlcyhpLGZ1bmN0aW9uKGkpe2wuX3ByZXBhcmVFZmZlY3QoZSxpLHQsbyxzKX0pfSl9KX0pfXJldHVybiB0LnByb3RvdHlwZS5pc1JlYWR5PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lzUmVhZHl9LHQucHJvdG90eXBlLmdldFByb2dyYW09ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcHJvZ3JhbX0sdC5wcm90b3R5cGUuZ2V0QXR0cmlidXRlc05hbWVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2F0dHJpYnV0ZXNOYW1lc30sdC5wcm90b3R5cGUuZ2V0QXR0cmlidXRlTG9jYXRpb249ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2F0dHJpYnV0ZXNbZV19LHQucHJvdG90eXBlLmdldEF0dHJpYnV0ZUxvY2F0aW9uQnlOYW1lPWZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuX2F0dHJpYnV0ZXNOYW1lcy5pbmRleE9mKGUpO3JldHVybiB0aGlzLl9hdHRyaWJ1dGVzW3RdfSx0LnByb3RvdHlwZS5nZXRBdHRyaWJ1dGVzQ291bnQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fYXR0cmlidXRlcy5sZW5ndGh9LHQucHJvdG90eXBlLmdldFVuaWZvcm1JbmRleD1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fdW5pZm9ybXNOYW1lcy5pbmRleE9mKGUpfSx0LnByb3RvdHlwZS5nZXRVbmlmb3JtPWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl91bmlmb3Jtc1t0aGlzLl91bmlmb3Jtc05hbWVzLmluZGV4T2YoZSldfSx0LnByb3RvdHlwZS5nZXRTYW1wbGVycz1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9zYW1wbGVyc30sdC5wcm90b3R5cGUuZ2V0Q29tcGlsYXRpb25FcnJvcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9jb21waWxhdGlvbkVycm9yfSx0LnByb3RvdHlwZS5fbG9hZFZlcnRleFNoYWRlcj1mdW5jdGlvbihpLHIpe2lmKGkgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCl7dmFyIG49ZS5Ub29scy5HZXRET01UZXh0Q29udGVudChpKTtyZXR1cm4gdm9pZCByKG4pfWlmKHQuU2hhZGVyc1N0b3JlW2krXCJWZXJ0ZXhTaGFkZXJcIl0pcmV0dXJuIHZvaWQgcih0LlNoYWRlcnNTdG9yZVtpK1wiVmVydGV4U2hhZGVyXCJdKTt2YXIgbztvPVwiLlwiPT09aVswXXx8XCIvXCI9PT1pWzBdfHxpLmluZGV4T2YoXCJodHRwXCIpPi0xP2k6ZS5FbmdpbmUuU2hhZGVyc1JlcG9zaXRvcnkraSxlLlRvb2xzLkxvYWRGaWxlKG8rXCIudmVydGV4LmZ4XCIscil9LHQucHJvdG90eXBlLl9sb2FkRnJhZ21lbnRTaGFkZXI9ZnVuY3Rpb24oaSxyKXtpZihpIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpe3ZhciBuPWUuVG9vbHMuR2V0RE9NVGV4dENvbnRlbnQoaSk7cmV0dXJuIHZvaWQgcihuKX1pZih0LlNoYWRlcnNTdG9yZVtpK1wiUGl4ZWxTaGFkZXJcIl0pcmV0dXJuIHZvaWQgcih0LlNoYWRlcnNTdG9yZVtpK1wiUGl4ZWxTaGFkZXJcIl0pO2lmKHQuU2hhZGVyc1N0b3JlW2krXCJGcmFnbWVudFNoYWRlclwiXSlyZXR1cm4gdm9pZCByKHQuU2hhZGVyc1N0b3JlW2krXCJGcmFnbWVudFNoYWRlclwiXSk7dmFyIG87bz1cIi5cIj09PWlbMF18fFwiL1wiPT09aVswXXx8aS5pbmRleE9mKFwiaHR0cFwiKT4tMT9pOmUuRW5naW5lLlNoYWRlcnNSZXBvc2l0b3J5K2ksZS5Ub29scy5Mb2FkRmlsZShvK1wiLmZyYWdtZW50LmZ4XCIscil9LHQucHJvdG90eXBlLl9kdW1wU2hhZGVyc05hbWU9ZnVuY3Rpb24oKXt0aGlzLm5hbWUudmVydGV4RWxlbWVudD8oZS5Ub29scy5FcnJvcihcIlZlcnRleCBzaGFkZXI6XCIrdGhpcy5uYW1lLnZlcnRleEVsZW1lbnQpLGUuVG9vbHMuRXJyb3IoXCJGcmFnbWVudCBzaGFkZXI6XCIrdGhpcy5uYW1lLmZyYWdtZW50RWxlbWVudCkpOnRoaXMubmFtZS52ZXJ0ZXg/KGUuVG9vbHMuRXJyb3IoXCJWZXJ0ZXggc2hhZGVyOlwiK3RoaXMubmFtZS52ZXJ0ZXgpLGUuVG9vbHMuRXJyb3IoXCJGcmFnbWVudCBzaGFkZXI6XCIrdGhpcy5uYW1lLmZyYWdtZW50KSk6KGUuVG9vbHMuRXJyb3IoXCJWZXJ0ZXggc2hhZGVyOlwiK3RoaXMubmFtZSksZS5Ub29scy5FcnJvcihcIkZyYWdtZW50IHNoYWRlcjpcIit0aGlzLm5hbWUpKX0sdC5wcm90b3R5cGUuX3Byb2Nlc3NJbmNsdWRlcz1mdW5jdGlvbihpLHIpe2Zvcih2YXIgbj10aGlzLG89LyNpbmNsdWRlPCguKyk+KFxcKCguKilcXCkpKihcXFsoLiopXFxdKSovZyxzPW8uZXhlYyhpKSxhPW5ldyBTdHJpbmcoaSk7bnVsbCE9czspe3ZhciBoPXNbMV07aWYoIXQuSW5jbHVkZXNTaGFkZXJzU3RvcmVbaF0pe3ZhciBjPWUuRW5naW5lLlNoYWRlcnNSZXBvc2l0b3J5K1wiU2hhZGVyc0luY2x1ZGUvXCIraCtcIi5meFwiO3JldHVybiB2b2lkIGUuVG9vbHMuTG9hZEZpbGUoYyxmdW5jdGlvbihlKXt0LkluY2x1ZGVzU2hhZGVyc1N0b3JlW2hdPWUsbi5fcHJvY2Vzc0luY2x1ZGVzKGEscil9KX12YXIgbD10LkluY2x1ZGVzU2hhZGVyc1N0b3JlW2hdO2lmKHNbMl0pZm9yKHZhciB1PXNbM10uc3BsaXQoXCIsXCIpLGY9MDtmPHUubGVuZ3RoO2YrPTIpe3ZhciBkPW5ldyBSZWdFeHAodVtmXSxcImdcIikscD11W2YrMV07bD1sLnJlcGxhY2UoZCxwKX1pZihzWzRdKXt2YXIgXz1zWzVdO2lmKC0xIT09Xy5pbmRleE9mKFwiLi5cIikpe3ZhciBtPV8uc3BsaXQoXCIuLlwiKSxnPXBhcnNlSW50KG1bMF0pLHY9cGFyc2VJbnQobVsxXSkseT1sLnNsaWNlKDApO2w9XCJcIixpc05hTih2KSYmKHY9dGhpcy5faW5kZXhQYXJhbWV0ZXJzW21bMV1dKTtmb3IodmFyIHg9Zzt2Pj14O3grKylsKz15LnJlcGxhY2UoL1xce1hcXH0vZyx4KStcIlxcblwifWVsc2UgbD1sLnJlcGxhY2UoL1xce1hcXH0vZyxfKX1hPWEucmVwbGFjZShzWzBdLGwpLHM9by5leGVjKGkpfXIoYSl9LHQucHJvdG90eXBlLl9wcm9jZXNzUHJlY2lzaW9uPWZ1bmN0aW9uKGUpe3JldHVybi0xPT09ZS5pbmRleE9mKFwicHJlY2lzaW9uIGhpZ2hwIGZsb2F0XCIpP2U9dGhpcy5fZW5naW5lLmdldENhcHMoKS5oaWdoUHJlY2lzaW9uU2hhZGVyU3VwcG9ydGVkP1wicHJlY2lzaW9uIGhpZ2hwIGZsb2F0O1xcblwiK2U6XCJwcmVjaXNpb24gbWVkaXVtcCBmbG9hdDtcXG5cIitlOnRoaXMuX2VuZ2luZS5nZXRDYXBzKCkuaGlnaFByZWNpc2lvblNoYWRlclN1cHBvcnRlZHx8KGU9ZS5yZXBsYWNlKFwicHJlY2lzaW9uIGhpZ2hwIGZsb2F0XCIsXCJwcmVjaXNpb24gbWVkaXVtcCBmbG9hdFwiKSksZX0sdC5wcm90b3R5cGUuX3ByZXBhcmVFZmZlY3Q9ZnVuY3Rpb24odCxpLHIsbixvKXt0cnl7dmFyIHM9dGhpcy5fZW5naW5lO3Q9dGhpcy5fcHJvY2Vzc1ByZWNpc2lvbih0KSxpPXRoaXMuX3Byb2Nlc3NQcmVjaXNpb24oaSksdGhpcy5fcHJvZ3JhbT1zLmNyZWF0ZVNoYWRlclByb2dyYW0odCxpLG4pLHRoaXMuX3VuaWZvcm1zPXMuZ2V0VW5pZm9ybXModGhpcy5fcHJvZ3JhbSx0aGlzLl91bmlmb3Jtc05hbWVzKSx0aGlzLl9hdHRyaWJ1dGVzPXMuZ2V0QXR0cmlidXRlcyh0aGlzLl9wcm9ncmFtLHIpO2Zvcih2YXIgYT0wO2E8dGhpcy5fc2FtcGxlcnMubGVuZ3RoO2ErKyl7dmFyIGg9dGhpcy5nZXRVbmlmb3JtKHRoaXMuX3NhbXBsZXJzW2FdKTtudWxsPT1oJiYodGhpcy5fc2FtcGxlcnMuc3BsaWNlKGEsMSksYS0tKX1zLmJpbmRTYW1wbGVycyh0aGlzKSx0aGlzLl9pc1JlYWR5PSEwLHRoaXMub25Db21waWxlZCYmdGhpcy5vbkNvbXBpbGVkKHRoaXMpfWNhdGNoKGMpe2lmKC0xIT09Yy5tZXNzYWdlLmluZGV4T2YoXCJoaWdocFwiKSlyZXR1cm4gdD10LnJlcGxhY2UoXCJwcmVjaXNpb24gaGlnaHAgZmxvYXRcIixcInByZWNpc2lvbiBtZWRpdW1wIGZsb2F0XCIpLGk9aS5yZXBsYWNlKFwicHJlY2lzaW9uIGhpZ2hwIGZsb2F0XCIsXCJwcmVjaXNpb24gbWVkaXVtcCBmbG9hdFwiKSx2b2lkIHRoaXMuX3ByZXBhcmVFZmZlY3QodCxpLHIsbixvKTtvJiZvLmlzTW9yZUZhbGxiYWNrcz8oZS5Ub29scy5FcnJvcihcIlVuYWJsZSB0byBjb21waWxlIGVmZmVjdCB3aXRoIGN1cnJlbnQgZGVmaW5lcy4gVHJ5aW5nIG5leHQgZmFsbGJhY2suXCIpLHRoaXMuX2R1bXBTaGFkZXJzTmFtZSgpLG49by5yZWR1Y2UobiksdGhpcy5fcHJlcGFyZUVmZmVjdCh0LGkscixuLG8pKTooZS5Ub29scy5FcnJvcihcIlVuYWJsZSB0byBjb21waWxlIGVmZmVjdDogXCIpLHRoaXMuX2R1bXBTaGFkZXJzTmFtZSgpLGUuVG9vbHMuRXJyb3IoXCJEZWZpbmVzOiBcIituKSxlLlRvb2xzLkVycm9yKFwiRXJyb3I6IFwiK2MubWVzc2FnZSksdGhpcy5fY29tcGlsYXRpb25FcnJvcj1jLm1lc3NhZ2UsdGhpcy5vbkVycm9yJiZ0aGlzLm9uRXJyb3IodGhpcyx0aGlzLl9jb21waWxhdGlvbkVycm9yKSl9fSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJpc1N1cHBvcnRlZFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm5cIlwiPT09dGhpcy5fY29tcGlsYXRpb25FcnJvcn0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSx0LnByb3RvdHlwZS5fYmluZFRleHR1cmU9ZnVuY3Rpb24oZSx0KXt0aGlzLl9lbmdpbmUuX2JpbmRUZXh0dXJlKHRoaXMuX3NhbXBsZXJzLmluZGV4T2YoZSksdCl9LHQucHJvdG90eXBlLnNldFRleHR1cmU9ZnVuY3Rpb24oZSx0KXt0aGlzLl9lbmdpbmUuc2V0VGV4dHVyZSh0aGlzLl9zYW1wbGVycy5pbmRleE9mKGUpLHQpfSx0LnByb3RvdHlwZS5zZXRUZXh0dXJlRnJvbVBvc3RQcm9jZXNzPWZ1bmN0aW9uKGUsdCl7dGhpcy5fZW5naW5lLnNldFRleHR1cmVGcm9tUG9zdFByb2Nlc3ModGhpcy5fc2FtcGxlcnMuaW5kZXhPZihlKSx0KX0sdC5wcm90b3R5cGUuX2NhY2hlTWF0cml4PWZ1bmN0aW9uKHQsaSl7dGhpcy5fdmFsdWVDYWNoZVt0XXx8KHRoaXMuX3ZhbHVlQ2FjaGVbdF09bmV3IGUuTWF0cml4KTtmb3IodmFyIHI9MDsxNj5yO3IrKyl0aGlzLl92YWx1ZUNhY2hlW3RdLm1bcl09aS5tW3JdfSx0LnByb3RvdHlwZS5fY2FjaGVGbG9hdDI9ZnVuY3Rpb24oZSx0LGkpe3JldHVybiB0aGlzLl92YWx1ZUNhY2hlW2VdPyh0aGlzLl92YWx1ZUNhY2hlW2VdWzBdPXQsdm9pZCh0aGlzLl92YWx1ZUNhY2hlW2VdWzFdPWkpKTp2b2lkKHRoaXMuX3ZhbHVlQ2FjaGVbZV09W3QsaV0pfSx0LnByb3RvdHlwZS5fY2FjaGVGbG9hdDM9ZnVuY3Rpb24oZSx0LGkscil7cmV0dXJuIHRoaXMuX3ZhbHVlQ2FjaGVbZV0/KHRoaXMuX3ZhbHVlQ2FjaGVbZV1bMF09dCx0aGlzLl92YWx1ZUNhY2hlW2VdWzFdPWksdm9pZCh0aGlzLl92YWx1ZUNhY2hlW2VdWzJdPXIpKTp2b2lkKHRoaXMuX3ZhbHVlQ2FjaGVbZV09W3QsaSxyXSl9LHQucHJvdG90eXBlLl9jYWNoZUZsb2F0ND1mdW5jdGlvbihlLHQsaSxyLG4pe3JldHVybiB0aGlzLl92YWx1ZUNhY2hlW2VdPyh0aGlzLl92YWx1ZUNhY2hlW2VdWzBdPXQsdGhpcy5fdmFsdWVDYWNoZVtlXVsxXT1pLHRoaXMuX3ZhbHVlQ2FjaGVbZV1bMl09cix2b2lkKHRoaXMuX3ZhbHVlQ2FjaGVbZV1bM109bikpOnZvaWQodGhpcy5fdmFsdWVDYWNoZVtlXT1bdCxpLHIsbl0pfSx0LnByb3RvdHlwZS5zZXRBcnJheT1mdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLl9lbmdpbmUuc2V0QXJyYXkodGhpcy5nZXRVbmlmb3JtKGUpLHQpLHRoaXN9LHQucHJvdG90eXBlLnNldEFycmF5Mj1mdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLl9lbmdpbmUuc2V0QXJyYXkyKHRoaXMuZ2V0VW5pZm9ybShlKSx0KSx0aGlzfSx0LnByb3RvdHlwZS5zZXRBcnJheTM9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5fZW5naW5lLnNldEFycmF5Myh0aGlzLmdldFVuaWZvcm0oZSksdCksdGhpc30sdC5wcm90b3R5cGUuc2V0QXJyYXk0PWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuX2VuZ2luZS5zZXRBcnJheTQodGhpcy5nZXRVbmlmb3JtKGUpLHQpLHRoaXN9LHQucHJvdG90eXBlLnNldE1hdHJpY2VzPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuX2VuZ2luZS5zZXRNYXRyaWNlcyh0aGlzLmdldFVuaWZvcm0oZSksdCksdGhpc30sdC5wcm90b3R5cGUuc2V0TWF0cml4PWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuX2VuZ2luZS5zZXRNYXRyaXgodGhpcy5nZXRVbmlmb3JtKGUpLHQpLHRoaXN9LHQucHJvdG90eXBlLnNldE1hdHJpeDN4Mz1mdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLl9lbmdpbmUuc2V0TWF0cml4M3gzKHRoaXMuZ2V0VW5pZm9ybShlKSx0KSx0aGlzfSx0LnByb3RvdHlwZS5zZXRNYXRyaXgyeDI9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5fZW5naW5lLnNldE1hdHJpeDJ4Mih0aGlzLmdldFVuaWZvcm0oZSksdCksdGhpc30sdC5wcm90b3R5cGUuc2V0RmxvYXQ9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5fdmFsdWVDYWNoZVtlXSYmdGhpcy5fdmFsdWVDYWNoZVtlXT09PXQ/dGhpczoodGhpcy5fdmFsdWVDYWNoZVtlXT10LHRoaXMuX2VuZ2luZS5zZXRGbG9hdCh0aGlzLmdldFVuaWZvcm0oZSksdCksdGhpcyl9LHQucHJvdG90eXBlLnNldEJvb2w9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5fdmFsdWVDYWNoZVtlXSYmdGhpcy5fdmFsdWVDYWNoZVtlXT09PXQ/dGhpczoodGhpcy5fdmFsdWVDYWNoZVtlXT10LHRoaXMuX2VuZ2luZS5zZXRCb29sKHRoaXMuZ2V0VW5pZm9ybShlKSx0PzE6MCksdGhpcyl9LHQucHJvdG90eXBlLnNldFZlY3RvcjI9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5fdmFsdWVDYWNoZVtlXSYmdGhpcy5fdmFsdWVDYWNoZVtlXVswXT09PXQueCYmdGhpcy5fdmFsdWVDYWNoZVtlXVsxXT09PXQueT90aGlzOih0aGlzLl9jYWNoZUZsb2F0MihlLHQueCx0LnkpLHRoaXMuX2VuZ2luZS5zZXRGbG9hdDIodGhpcy5nZXRVbmlmb3JtKGUpLHQueCx0LnkpLHRoaXMpfSx0LnByb3RvdHlwZS5zZXRGbG9hdDI9ZnVuY3Rpb24oZSx0LGkpe3JldHVybiB0aGlzLl92YWx1ZUNhY2hlW2VdJiZ0aGlzLl92YWx1ZUNhY2hlW2VdWzBdPT09dCYmdGhpcy5fdmFsdWVDYWNoZVtlXVsxXT09PWk/dGhpczoodGhpcy5fY2FjaGVGbG9hdDIoZSx0LGkpLHRoaXMuX2VuZ2luZS5zZXRGbG9hdDIodGhpcy5nZXRVbmlmb3JtKGUpLHQsaSksdGhpcyl9LHQucHJvdG90eXBlLnNldFZlY3RvcjM9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5fdmFsdWVDYWNoZVtlXSYmdGhpcy5fdmFsdWVDYWNoZVtlXVswXT09PXQueCYmdGhpcy5fdmFsdWVDYWNoZVtlXVsxXT09PXQueSYmdGhpcy5fdmFsdWVDYWNoZVtlXVsyXT09PXQuej90aGlzOih0aGlzLl9jYWNoZUZsb2F0MyhlLHQueCx0LnksdC56KSx0aGlzLl9lbmdpbmUuc2V0RmxvYXQzKHRoaXMuZ2V0VW5pZm9ybShlKSx0LngsdC55LHQueiksdGhpcyl9LHQucHJvdG90eXBlLnNldEZsb2F0Mz1mdW5jdGlvbihlLHQsaSxyKXtyZXR1cm4gdGhpcy5fdmFsdWVDYWNoZVtlXSYmdGhpcy5fdmFsdWVDYWNoZVtlXVswXT09PXQmJnRoaXMuX3ZhbHVlQ2FjaGVbZV1bMV09PT1pJiZ0aGlzLl92YWx1ZUNhY2hlW2VdWzJdPT09cj90aGlzOih0aGlzLl9jYWNoZUZsb2F0MyhlLHQsaSxyKSx0aGlzLl9lbmdpbmUuc2V0RmxvYXQzKHRoaXMuZ2V0VW5pZm9ybShlKSx0LGksciksdGhpcyl9LHQucHJvdG90eXBlLnNldFZlY3RvcjQ9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5fdmFsdWVDYWNoZVtlXSYmdGhpcy5fdmFsdWVDYWNoZVtlXVswXT09PXQueCYmdGhpcy5fdmFsdWVDYWNoZVtlXVsxXT09PXQueSYmdGhpcy5fdmFsdWVDYWNoZVtlXVsyXT09PXQueiYmdGhpcy5fdmFsdWVDYWNoZVtlXVszXT09PXQudz90aGlzOih0aGlzLl9jYWNoZUZsb2F0NChlLHQueCx0LnksdC56LHQudyksdGhpcy5fZW5naW5lLnNldEZsb2F0NCh0aGlzLmdldFVuaWZvcm0oZSksdC54LHQueSx0LnosdC53KSx0aGlzKX0sdC5wcm90b3R5cGUuc2V0RmxvYXQ0PWZ1bmN0aW9uKGUsdCxpLHIsbil7cmV0dXJuIHRoaXMuX3ZhbHVlQ2FjaGVbZV0mJnRoaXMuX3ZhbHVlQ2FjaGVbZV1bMF09PT10JiZ0aGlzLl92YWx1ZUNhY2hlW2VdWzFdPT09aSYmdGhpcy5fdmFsdWVDYWNoZVtlXVsyXT09PXImJnRoaXMuX3ZhbHVlQ2FjaGVbZV1bM109PT1uP3RoaXM6KHRoaXMuX2NhY2hlRmxvYXQ0KGUsdCxpLHIsbiksdGhpcy5fZW5naW5lLnNldEZsb2F0NCh0aGlzLmdldFVuaWZvcm0oZSksdCxpLHIsbiksdGhpcyl9LHQucHJvdG90eXBlLnNldENvbG9yMz1mdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLl92YWx1ZUNhY2hlW2VdJiZ0aGlzLl92YWx1ZUNhY2hlW2VdWzBdPT09dC5yJiZ0aGlzLl92YWx1ZUNhY2hlW2VdWzFdPT09dC5nJiZ0aGlzLl92YWx1ZUNhY2hlW2VdWzJdPT09dC5iP3RoaXM6KHRoaXMuX2NhY2hlRmxvYXQzKGUsdC5yLHQuZyx0LmIpLHRoaXMuX2VuZ2luZS5zZXRDb2xvcjModGhpcy5nZXRVbmlmb3JtKGUpLHQpLHRoaXMpfSx0LnByb3RvdHlwZS5zZXRDb2xvcjQ9ZnVuY3Rpb24oZSx0LGkpe3JldHVybiB0aGlzLl92YWx1ZUNhY2hlW2VdJiZ0aGlzLl92YWx1ZUNhY2hlW2VdWzBdPT09dC5yJiZ0aGlzLl92YWx1ZUNhY2hlW2VdWzFdPT09dC5nJiZ0aGlzLl92YWx1ZUNhY2hlW2VdWzJdPT09dC5iJiZ0aGlzLl92YWx1ZUNhY2hlW2VdWzNdPT09aT90aGlzOih0aGlzLl9jYWNoZUZsb2F0NChlLHQucix0LmcsdC5iLGkpLHRoaXMuX2VuZ2luZS5zZXRDb2xvcjQodGhpcy5nZXRVbmlmb3JtKGUpLHQsaSksdGhpcyl9LHQuU2hhZGVyc1N0b3JlPXt9LHQuSW5jbHVkZXNTaGFkZXJzU3RvcmU9e30sdH0oKTtlLkVmZmVjdD1pfShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoKXt9cmV0dXJuIHQuUHJlcGFyZURlZmluZXNGb3JMaWdodHM9ZnVuY3Rpb24odCxpLHIsbil7dm9pZCAwPT09biYmKG49NCk7Zm9yKHZhciBvPTAscz0hMSxhPSExLGg9MDtoPHQubGlnaHRzLmxlbmd0aDtoKyspe3ZhciBjPXQubGlnaHRzW2hdO2lmKGMuaXNFbmFibGVkKCkpe2lmKGMuX2V4Y2x1ZGVkTWVzaGVzSWRzLmxlbmd0aD4wKXtmb3IodmFyIGw9MDtsPGMuX2V4Y2x1ZGVkTWVzaGVzSWRzLmxlbmd0aDtsKyspe3ZhciB1PXQuZ2V0TWVzaEJ5SUQoYy5fZXhjbHVkZWRNZXNoZXNJZHNbbF0pO3UmJmMuZXhjbHVkZWRNZXNoZXMucHVzaCh1KX1jLl9leGNsdWRlZE1lc2hlc0lkcz1bXX1pZihjLl9pbmNsdWRlZE9ubHlNZXNoZXNJZHMubGVuZ3RoPjApe2Zvcih2YXIgZj0wO2Y8Yy5faW5jbHVkZWRPbmx5TWVzaGVzSWRzLmxlbmd0aDtmKyspe3ZhciBkPXQuZ2V0TWVzaEJ5SUQoYy5faW5jbHVkZWRPbmx5TWVzaGVzSWRzW2ZdKTtkJiZjLmluY2x1ZGVkT25seU1lc2hlcy5wdXNoKGQpfWMuX2luY2x1ZGVkT25seU1lc2hlc0lkcz1bXX1pZihjLmNhbkFmZmVjdE1lc2goaSkpe3M9ITAsdm9pZCAwPT09cltcIkxJR0hUXCIrb10mJihhPSEwKSxyW1wiTElHSFRcIitvXT0hMDt2YXIgcDtpZihwPWMgaW5zdGFuY2VvZiBlLlNwb3RMaWdodD9cIlNQT1RMSUdIVFwiK286YyBpbnN0YW5jZW9mIGUuSGVtaXNwaGVyaWNMaWdodD9cIkhFTUlMSUdIVFwiK286YyBpbnN0YW5jZW9mIGUuUG9pbnRMaWdodD9cIlBPSU5UTElHSFRcIitvOlwiRElSTElHSFRcIitvLHZvaWQgMD09PXJbcF0mJihhPSEwKSxyW3BdPSEwLGMuc3BlY3VsYXIuZXF1YWxzRmxvYXRzKDAsMCwwKXx8dm9pZCAwPT09ci5TUEVDVUxBUlRFUk18fChyLlNQRUNVTEFSVEVSTT0hMCksdC5zaGFkb3dzRW5hYmxlZCl7dmFyIF89Yy5nZXRTaGFkb3dHZW5lcmF0b3IoKTtpJiZpLnJlY2VpdmVTaGFkb3dzJiZfJiYodm9pZCAwPT09cltcIlNIQURPV1wiK29dJiYoYT0hMCkscltcIlNIQURPV1wiK29dPSEwLHIuU0hBRE9XUz0hMCwoXy51c2VWYXJpYW5jZVNoYWRvd01hcHx8Xy51c2VCbHVyVmFyaWFuY2VTaGFkb3dNYXApJiYodm9pZCAwPT09cltcIlNIQURPV1ZTTVwiK29dJiYoYT0hMCkscltcIlNIQURPV1ZTTVwiK29dPSEwKSxfLnVzZVBvaXNzb25TYW1wbGluZyYmKHZvaWQgMD09PXJbXCJTSEFET1dQQ0ZcIitvXSYmKGE9ITApLHJbXCJTSEFET1dQQ0ZcIitvXT0hMCkpfWlmKG8rKyxvPT09bilicmVha319fXJldHVybiBhJiZyLnJlYnVpbGQoKSxzfSx0LlByZXBhcmVVbmlmb3Jtc0FuZFNhbXBsZXJzTGlzdD1mdW5jdGlvbihlLHQsaSxyKXt2b2lkIDA9PT1yJiYocj00KTtmb3IodmFyIG49MDtyPm4mJmlbXCJMSUdIVFwiK25dO24rKyllLnB1c2goXCJ2TGlnaHREYXRhXCIrbixcInZMaWdodERpZmZ1c2VcIituLFwidkxpZ2h0U3BlY3VsYXJcIituLFwidkxpZ2h0RGlyZWN0aW9uXCIrbixcInZMaWdodEdyb3VuZFwiK24sXCJsaWdodE1hdHJpeFwiK24sXCJzaGFkb3dzSW5mb1wiK24pLHQucHVzaChcInNoYWRvd1NhbXBsZXJcIituKX0sdC5IYW5kbGVGYWxsYmFja3NGb3JTaGFkb3dzPWZ1bmN0aW9uKGUsdCxpKXt2b2lkIDA9PT1pJiYoaT00KTtmb3IodmFyIHI9MDtpPnImJmVbXCJMSUdIVFwiK3JdO3IrKylyPjAmJnQuYWRkRmFsbGJhY2socixcIkxJR0hUXCIrciksZVtcIlNIQURPV1wiK3JdJiZ0LmFkZEZhbGxiYWNrKDAsXCJTSEFET1dcIityKSxlW1wiU0hBRE9XUENGXCIrcl0mJnQuYWRkRmFsbGJhY2soMCxcIlNIQURPV1BDRlwiK3IpLGVbXCJTSEFET1dWU01cIityXSYmdC5hZGRGYWxsYmFjaygwLFwiU0hBRE9XVlNNXCIrcil9LHQuUHJlcGFyZUF0dHJpYnV0ZXNGb3JCb25lcz1mdW5jdGlvbih0LGkscixuKXtyLk5VTV9CT05FX0lORkxVRU5DRVJTPjAmJihuLmFkZENQVVNraW5uaW5nRmFsbGJhY2soMCxpKSx0LnB1c2goZS5WZXJ0ZXhCdWZmZXIuTWF0cmljZXNJbmRpY2VzS2luZCksdC5wdXNoKGUuVmVydGV4QnVmZmVyLk1hdHJpY2VzV2VpZ2h0c0tpbmQpLHIuTlVNX0JPTkVfSU5GTFVFTkNFUlM+NCYmKHQucHVzaChlLlZlcnRleEJ1ZmZlci5NYXRyaWNlc0luZGljZXNFeHRyYUtpbmQpLHQucHVzaChlLlZlcnRleEJ1ZmZlci5NYXRyaWNlc1dlaWdodHNFeHRyYUtpbmQpKSl9LHQuUHJlcGFyZUF0dHJpYnV0ZXNGb3JJbnN0YW5jZXM9ZnVuY3Rpb24oZSx0KXt0LklOU1RBTkNFUyYmKGUucHVzaChcIndvcmxkMFwiKSxlLnB1c2goXCJ3b3JsZDFcIiksZS5wdXNoKFwid29ybGQyXCIpLGUucHVzaChcIndvcmxkM1wiKSl9LHQuQmluZExpZ2h0U2hhZG93PWZ1bmN0aW9uKGUsdCxpLHIsbixvKXt2YXIgcz1lLmdldFNoYWRvd0dlbmVyYXRvcigpO3JldHVybiBpLnJlY2VpdmVTaGFkb3dzJiZzJiYoZS5uZWVkQ3ViZSgpP298fChvPSEwLG4uc2V0RmxvYXQyKFwiZGVwdGhWYWx1ZXNcIix0LmFjdGl2ZUNhbWVyYS5taW5aLHQuYWN0aXZlQ2FtZXJhLm1heFopKTpuLnNldE1hdHJpeChcImxpZ2h0TWF0cml4XCIrcixzLmdldFRyYW5zZm9ybU1hdHJpeCgpKSxuLnNldFRleHR1cmUoXCJzaGFkb3dTYW1wbGVyXCIrcixzLmdldFNoYWRvd01hcEZvclJlbmRlcmluZygpKSxuLnNldEZsb2F0MyhcInNoYWRvd3NJbmZvXCIrcixzLmdldERhcmtuZXNzKCkscy5ibHVyU2NhbGUvcy5nZXRTaGFkb3dNYXAoKS5nZXRTaXplKCkud2lkdGgscy5iaWFzKSksb30sdC5CaW5kTGlnaHRQcm9wZXJ0aWVzPWZ1bmN0aW9uKHQsaSxyKXt0IGluc3RhbmNlb2YgZS5Qb2ludExpZ2h0P3QudHJhbnNmZXJUb0VmZmVjdChpLFwidkxpZ2h0RGF0YVwiK3IpOnQgaW5zdGFuY2VvZiBlLkRpcmVjdGlvbmFsTGlnaHQ/dC50cmFuc2ZlclRvRWZmZWN0KGksXCJ2TGlnaHREYXRhXCIrcik6dCBpbnN0YW5jZW9mIGUuU3BvdExpZ2h0P3QudHJhbnNmZXJUb0VmZmVjdChpLFwidkxpZ2h0RGF0YVwiK3IsXCJ2TGlnaHREaXJlY3Rpb25cIityKTp0IGluc3RhbmNlb2YgZS5IZW1pc3BoZXJpY0xpZ2h0JiZ0LnRyYW5zZmVyVG9FZmZlY3QoaSxcInZMaWdodERhdGFcIityLFwidkxpZ2h0R3JvdW5kXCIrcil9LHQuQmluZExpZ2h0cz1mdW5jdGlvbihpLHIsbixvLHMpe3ZvaWQgMD09PXMmJihzPTQpO2Zvcih2YXIgYT0wLGg9ITEsYz0wO2M8aS5saWdodHMubGVuZ3RoO2MrKyl7dmFyIGw9aS5saWdodHNbY107aWYobC5pc0VuYWJsZWQoKSYmbC5jYW5BZmZlY3RNZXNoKHIpJiYodC5CaW5kTGlnaHRQcm9wZXJ0aWVzKGwsbixhKSxsLmRpZmZ1c2Uuc2NhbGVUb1JlZihsLmludGVuc2l0eSxlLlRtcC5Db2xvcjNbMF0pLG4uc2V0Q29sb3I0KFwidkxpZ2h0RGlmZnVzZVwiK2EsZS5UbXAuQ29sb3IzWzBdLGwucmFuZ2UpLG8uU1BFQ1VMQVJURVJNJiYobC5zcGVjdWxhci5zY2FsZVRvUmVmKGwuaW50ZW5zaXR5LGUuVG1wLkNvbG9yM1sxXSksbi5zZXRDb2xvcjMoXCJ2TGlnaHRTcGVjdWxhclwiK2EsZS5UbXAuQ29sb3IzWzFdKSksaS5zaGFkb3dzRW5hYmxlZCYmKGg9dGhpcy5CaW5kTGlnaHRTaGFkb3cobCxpLHIsYSxuLGgpKSxhKyssYT09PXMpKWJyZWFrfX0sdC5CaW5kRm9nUGFyYW1ldGVycz1mdW5jdGlvbih0LGkscil7dC5mb2dFbmFibGVkJiZpLmFwcGx5Rm9nJiZ0LmZvZ01vZGUhPT1lLlNjZW5lLkZPR01PREVfTk9ORSYmKHIuc2V0RmxvYXQ0KFwidkZvZ0luZm9zXCIsdC5mb2dNb2RlLHQuZm9nU3RhcnQsdC5mb2dFbmQsdC5mb2dEZW5zaXR5KSxyLnNldENvbG9yMyhcInZGb2dDb2xvclwiLHQuZm9nQ29sb3IpKX0sdC5CaW5kQm9uZXNQYXJhbWV0ZXJzPWZ1bmN0aW9uKGUsdCl7ZSYmZS51c2VCb25lcyYmZS5jb21wdXRlQm9uZXNVc2luZ1NoYWRlcnMmJnQuc2V0TWF0cmljZXMoXCJtQm9uZXNcIixlLnNrZWxldG9uLmdldFRyYW5zZm9ybU1hdHJpY2VzKGUpKX0sdC5CaW5kTG9nRGVwdGg9ZnVuY3Rpb24oZSx0LGkpe2UuTE9HQVJJVEhNSUNERVBUSCYmdC5zZXRGbG9hdChcImxvZ2FyaXRobWljRGVwdGhDb25zdGFudFwiLDIvKE1hdGgubG9nKGkuYWN0aXZlQ2FtZXJhLm1heForMSkvTWF0aC5MTjIpKX0sdC5CaW5kQ2xpcFBsYW5lPWZ1bmN0aW9uKGUsdCl7aWYodC5jbGlwUGxhbmUpe3ZhciBpPXQuY2xpcFBsYW5lO2Uuc2V0RmxvYXQ0KFwidkNsaXBQbGFuZVwiLGkubm9ybWFsLngsaS5ub3JtYWwueSxpLm5vcm1hbC56LGkuZCl9fSx0fSgpO2UuTWF0ZXJpYWxIZWxwZXI9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KCl7dGhpcy5pc0VuYWJsZWQ9ITAsdGhpcy5sZWZ0Q29sb3I9ZS5Db2xvcjMuV2hpdGUoKSx0aGlzLnJpZ2h0Q29sb3I9ZS5Db2xvcjMuQmxhY2soKSx0aGlzLmJpYXM9MCx0aGlzLnBvd2VyPTF9cmV0dXJuIHQucHJvdG90eXBlLmNsb25lPWZ1bmN0aW9uKCl7dmFyIGk9bmV3IHQ7cmV0dXJuIGUuVG9vbHMuRGVlcENvcHkodGhpcyxpKSxuZXcgdH0sdC5wcm90b3R5cGUuc2VyaWFsaXplPWZ1bmN0aW9uKCl7dmFyIGU9e307cmV0dXJuIGUuaXNFbmFibGVkPXRoaXMuaXNFbmFibGVkLGUubGVmdENvbG9yPXRoaXMubGVmdENvbG9yLGUucmlnaHRDb2xvcj10aGlzLnJpZ2h0Q29sb3IsZS5iaWFzPXRoaXMuYmlhcyxlLnBvd2VyPXRoaXMucG93ZXIsZX0sdC5QYXJzZT1mdW5jdGlvbihpKXt2YXIgcj1uZXcgdDtyZXR1cm4gci5pc0VuYWJsZWQ9aS5pc0VuYWJsZWQsci5sZWZ0Q29sb3I9ZS5Db2xvcjMuRnJvbUFycmF5KGkubGVmdENvbG9yKSxyLnJpZ2h0Q29sb3I9ZS5Db2xvcjMuRnJvbUFycmF5KGkucmlnaHRDb2xvciksci5iaWFzPWkuYmlhcyxyLnBvd2VyPWkucG93ZXJ8fDEscn0sdH0oKTtlLkZyZXNuZWxQYXJhbWV0ZXJzPXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSgpe31yZXR1cm4gZS5wcm90b3R5cGUucmVidWlsZD1mdW5jdGlvbigpe3RoaXMuX2tleXMmJmRlbGV0ZSB0aGlzLl9rZXlzLHRoaXMuX2tleXM9T2JqZWN0LmtleXModGhpcyl9LGUucHJvdG90eXBlLmlzRXF1YWw9ZnVuY3Rpb24oZSl7aWYodGhpcy5fa2V5cy5sZW5ndGghPT1lLl9rZXlzLmxlbmd0aClyZXR1cm4hMTtmb3IodmFyIHQ9MDt0PHRoaXMuX2tleXMubGVuZ3RoO3QrKyl7dmFyIGk9dGhpcy5fa2V5c1t0XTtpZih0aGlzW2ldIT09ZVtpXSlyZXR1cm4hMX1yZXR1cm4hMH0sZS5wcm90b3R5cGUuY2xvbmVUbz1mdW5jdGlvbihlKXt0aGlzLl9rZXlzLmxlbmd0aCE9PWUuX2tleXMubGVuZ3RoJiYoZS5fa2V5cz10aGlzLl9rZXlzLnNsaWNlKDApKTtmb3IodmFyIHQ9MDt0PHRoaXMuX2tleXMubGVuZ3RoO3QrKyl7dmFyIGk9dGhpcy5fa2V5c1t0XTtlW2ldPXRoaXNbaV19fSxlLnByb3RvdHlwZS5yZXNldD1mdW5jdGlvbigpe2Zvcih2YXIgZT0wO2U8dGhpcy5fa2V5cy5sZW5ndGg7ZSsrKXt2YXIgdD10aGlzLl9rZXlzW2VdO1wibnVtYmVyXCI9PXR5cGVvZiB0aGlzW3RdP3RoaXNbdF09MDp0aGlzW3RdPSExfX0sZS5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtmb3IodmFyIGU9XCJcIix0PTA7dDx0aGlzLl9rZXlzLmxlbmd0aDt0Kyspe3ZhciBpPXRoaXMuX2tleXNbdF07XCJudW1iZXJcIj09dHlwZW9mIHRoaXNbaV0/ZSs9XCIjZGVmaW5lIFwiK2krXCIgXCIrdGhpc1tpXStcIlxcblwiOnRoaXNbaV0mJihlKz1cIiNkZWZpbmUgXCIraStcIlxcblwiKX1yZXR1cm4gZX0sZX0oKTtlLk1hdGVyaWFsRGVmaW5lcz10O3ZhciBpPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdChpLHIsbil7dGhpcy5uYW1lPWksdGhpcy5jaGVja1JlYWR5T25FdmVyeUNhbGw9ITEsdGhpcy5jaGVja1JlYWR5T25seU9uY2U9ITEsdGhpcy5zdGF0ZT1cIlwiLHRoaXMuYWxwaGE9MSx0aGlzLmJhY2tGYWNlQ3VsbGluZz0hMCx0aGlzLnNpZGVPcmllbnRhdGlvbj10LkNvdW50ZXJDbG9ja1dpc2VTaWRlT3JpZW50YXRpb24sdGhpcy5vbkRpc3Bvc2VPYnNlcnZhYmxlPW5ldyBlLk9ic2VydmFibGUsdGhpcy5vbkJpbmRPYnNlcnZhYmxlPW5ldyBlLk9ic2VydmFibGUsdGhpcy5hbHBoYU1vZGU9ZS5FbmdpbmUuQUxQSEFfQ09NQklORSx0aGlzLmRpc2FibGVEZXB0aFdyaXRlPSExLHRoaXMuZm9nRW5hYmxlZD0hMCx0aGlzLnBvaW50U2l6ZT0xLHRoaXMuek9mZnNldD0wLHRoaXMuX3dhc1ByZXZpb3VzbHlSZWFkeT0hMSx0aGlzLl9maWxsTW9kZT10LlRyaWFuZ2xlRmlsbE1vZGUsdGhpcy5pZD1pLHRoaXMuX3NjZW5lPXIsbnx8ci5tYXRlcmlhbHMucHVzaCh0aGlzKX1yZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJUcmlhbmdsZUZpbGxNb2RlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0Ll9UcmlhbmdsZUZpbGxNb2RlfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiV2lyZUZyYW1lRmlsbE1vZGVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHQuX1dpcmVGcmFtZUZpbGxNb2RlfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiUG9pbnRGaWxsTW9kZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdC5fUG9pbnRGaWxsTW9kZX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIkNsb2NrV2lzZVNpZGVPcmllbnRhdGlvblwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdC5fQ2xvY2tXaXNlU2lkZU9yaWVudGF0aW9ufSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiQ291bnRlckNsb2NrV2lzZVNpZGVPcmllbnRhdGlvblwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdC5fQ291bnRlckNsb2NrV2lzZVNpZGVPcmllbnRhdGlvbn0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJvbkRpc3Bvc2VcIix7c2V0OmZ1bmN0aW9uKGUpe3RoaXMuX29uRGlzcG9zZU9ic2VydmVyJiZ0aGlzLm9uRGlzcG9zZU9ic2VydmFibGUucmVtb3ZlKHRoaXMuX29uRGlzcG9zZU9ic2VydmVyKSx0aGlzLl9vbkRpc3Bvc2VPYnNlcnZlcj10aGlzLm9uRGlzcG9zZU9ic2VydmFibGUuYWRkKGUpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcIm9uQmluZFwiLHtzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fb25CaW5kT2JzZXJ2ZXImJnRoaXMub25CaW5kT2JzZXJ2YWJsZS5yZW1vdmUodGhpcy5fb25CaW5kT2JzZXJ2ZXIpLHRoaXMuX29uQmluZE9ic2VydmVyPXRoaXMub25CaW5kT2JzZXJ2YWJsZS5hZGQoZSl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwid2lyZWZyYW1lXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9maWxsTW9kZT09PXQuV2lyZUZyYW1lRmlsbE1vZGV9LHNldDpmdW5jdGlvbihlKXt0aGlzLl9maWxsTW9kZT1lP3QuV2lyZUZyYW1lRmlsbE1vZGU6dC5UcmlhbmdsZUZpbGxNb2RlfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcInBvaW50c0Nsb3VkXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9maWxsTW9kZT09PXQuUG9pbnRGaWxsTW9kZX0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX2ZpbGxNb2RlPWU/dC5Qb2ludEZpbGxNb2RlOnQuVHJpYW5nbGVGaWxsTW9kZX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJmaWxsTW9kZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZmlsbE1vZGV9LHNldDpmdW5jdGlvbihlKXt0aGlzLl9maWxsTW9kZT1lfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLHQucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKGUpe3ZhciB0PVwiTmFtZTogXCIrdGhpcy5uYW1lO3JldHVybiB0fSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJpc0Zyb3plblwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jaGVja1JlYWR5T25seU9uY2V9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksdC5wcm90b3R5cGUuZnJlZXplPWZ1bmN0aW9uKCl7dGhpcy5jaGVja1JlYWR5T25seU9uY2U9ITB9LHQucHJvdG90eXBlLnVuZnJlZXplPWZ1bmN0aW9uKCl7dGhpcy5jaGVja1JlYWR5T25seU9uY2U9ITF9LHQucHJvdG90eXBlLmlzUmVhZHk9ZnVuY3Rpb24oZSx0KXtyZXR1cm4hMH0sdC5wcm90b3R5cGUuZ2V0RWZmZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2VmZmVjdH0sdC5wcm90b3R5cGUuZ2V0U2NlbmU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc2NlbmV9LHQucHJvdG90eXBlLm5lZWRBbHBoYUJsZW5kaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYWxwaGE8MX0sdC5wcm90b3R5cGUubmVlZEFscGhhVGVzdGluZz1mdW5jdGlvbigpe3JldHVybiExfSx0LnByb3RvdHlwZS5nZXRBbHBoYVRlc3RUZXh0dXJlPWZ1bmN0aW9uKCl7cmV0dXJuIG51bGx9LHQucHJvdG90eXBlLm1hcmtEaXJ0eT1mdW5jdGlvbigpe3RoaXMuX3dhc1ByZXZpb3VzbHlSZWFkeT0hMX0sdC5wcm90b3R5cGUuX3ByZUJpbmQ9ZnVuY3Rpb24oKXt2YXIgZT10aGlzLl9zY2VuZS5nZXRFbmdpbmUoKTtlLmVuYWJsZUVmZmVjdCh0aGlzLl9lZmZlY3QpLGUuc2V0U3RhdGUodGhpcy5iYWNrRmFjZUN1bGxpbmcsdGhpcy56T2Zmc2V0LCExLHRoaXMuc2lkZU9yaWVudGF0aW9uPT09dC5DbG9ja1dpc2VTaWRlT3JpZW50YXRpb24pfSx0LnByb3RvdHlwZS5iaW5kPWZ1bmN0aW9uKGUsdCl7aWYodGhpcy5fc2NlbmUuX2NhY2hlZE1hdGVyaWFsPXRoaXMsdGhpcy5vbkJpbmRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0KSx0aGlzLmRpc2FibGVEZXB0aFdyaXRlKXt2YXIgaT10aGlzLl9zY2VuZS5nZXRFbmdpbmUoKTt0aGlzLl9jYWNoZWREZXB0aFdyaXRlU3RhdGU9aS5nZXREZXB0aFdyaXRlKCksaS5zZXREZXB0aFdyaXRlKCExKX19LHQucHJvdG90eXBlLmJpbmRPbmx5V29ybGRNYXRyaXg9ZnVuY3Rpb24oZSl7fSx0LnByb3RvdHlwZS51bmJpbmQ9ZnVuY3Rpb24oKXtpZih0aGlzLmRpc2FibGVEZXB0aFdyaXRlKXt2YXIgZT10aGlzLl9zY2VuZS5nZXRFbmdpbmUoKTtlLnNldERlcHRoV3JpdGUodGhpcy5fY2FjaGVkRGVwdGhXcml0ZVN0YXRlKX19LHQucHJvdG90eXBlLmNsb25lPWZ1bmN0aW9uKGUpe3JldHVybiBudWxsfSx0LnByb3RvdHlwZS5nZXRCaW5kZWRNZXNoZXM9ZnVuY3Rpb24oKXtmb3IodmFyIGU9bmV3IEFycmF5LHQ9MDt0PHRoaXMuX3NjZW5lLm1lc2hlcy5sZW5ndGg7dCsrKXt2YXIgaT10aGlzLl9zY2VuZS5tZXNoZXNbdF07aS5tYXRlcmlhbD09PXRoaXMmJmUucHVzaChpKX1yZXR1cm4gZX0sdC5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbihlLHQpe3RoaXMuZ2V0U2NlbmUoKS5zdG9wQW5pbWF0aW9uKHRoaXMpO3ZhciBpPXRoaXMuX3NjZW5lLm1hdGVyaWFscy5pbmRleE9mKHRoaXMpO2ZvcihpPj0wJiZ0aGlzLl9zY2VuZS5tYXRlcmlhbHMuc3BsaWNlKGksMSksZSYmdGhpcy5fZWZmZWN0JiYodGhpcy5fc2NlbmUuZ2V0RW5naW5lKCkuX3JlbGVhc2VFZmZlY3QodGhpcy5fZWZmZWN0KSx0aGlzLl9lZmZlY3Q9bnVsbCksaT0wO2k8dGhpcy5fc2NlbmUubWVzaGVzLmxlbmd0aDtpKyspe3ZhciByPXRoaXMuX3NjZW5lLm1lc2hlc1tpXTtyLm1hdGVyaWFsPT09dGhpcyYmKHIubWF0ZXJpYWw9bnVsbCl9dGhpcy5vbkRpc3Bvc2VPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzKSx0aGlzLm9uRGlzcG9zZU9ic2VydmFibGUuY2xlYXIoKSx0aGlzLm9uQmluZE9ic2VydmFibGUuY2xlYXIoKX0sdC5wcm90b3R5cGUuc2VyaWFsaXplPWZ1bmN0aW9uKCl7cmV0dXJuIGUuU2VyaWFsaXphdGlvbkhlbHBlci5TZXJpYWxpemUodGhpcyl9LHQuUGFyc2VNdWx0aU1hdGVyaWFsPWZ1bmN0aW9uKHQsaSl7dmFyIHI9bmV3IGUuTXVsdGlNYXRlcmlhbCh0Lm5hbWUsaSk7ci5pZD10LmlkLGUuVGFncy5BZGRUYWdzVG8ocix0LnRhZ3MpO2Zvcih2YXIgbj0wO248dC5tYXRlcmlhbHMubGVuZ3RoO24rKyl7dmFyIG89dC5tYXRlcmlhbHNbbl07bz9yLnN1Yk1hdGVyaWFscy5wdXNoKGkuZ2V0TWF0ZXJpYWxCeUlEKG8pKTpyLnN1Yk1hdGVyaWFscy5wdXNoKG51bGwpfXJldHVybiByfSx0LlBhcnNlPWZ1bmN0aW9uKHQsaSxyKXtpZighdC5jdXN0b21UeXBlKXJldHVybiBlLlN0YW5kYXJkTWF0ZXJpYWwuUGFyc2UodCxpLHIpO3ZhciBuPWUuVG9vbHMuSW5zdGFudGlhdGUodC5jdXN0b21UeXBlKTtyZXR1cm4gbi5QYXJzZSh0LGkscil9LHQuX1RyaWFuZ2xlRmlsbE1vZGU9MCx0Ll9XaXJlRnJhbWVGaWxsTW9kZT0xLHQuX1BvaW50RmlsbE1vZGU9Mix0Ll9DbG9ja1dpc2VTaWRlT3JpZW50YXRpb249MCx0Ll9Db3VudGVyQ2xvY2tXaXNlU2lkZU9yaWVudGF0aW9uPTEsX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0sdC5wcm90b3R5cGUsXCJpZFwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0sdC5wcm90b3R5cGUsXCJjaGVja1JlYWR5T25FdmVyeUNhbGxcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHQucHJvdG90eXBlLFwiY2hlY2tSZWFkeU9ubHlPbmNlXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSx0LnByb3RvdHlwZSxcInN0YXRlXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSx0LnByb3RvdHlwZSxcImFscGhhXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSx0LnByb3RvdHlwZSxcImJhY2tGYWNlQ3VsbGluZ1wiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0sdC5wcm90b3R5cGUsXCJzaWRlT3JpZW50YXRpb25cIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHQucHJvdG90eXBlLFwiYWxwaGFNb2RlXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSx0LnByb3RvdHlwZSxcImRpc2FibGVEZXB0aFdyaXRlXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSx0LnByb3RvdHlwZSxcImZvZ0VuYWJsZWRcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHQucHJvdG90eXBlLFwicG9pbnRTaXplXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSx0LnByb3RvdHlwZSxcInpPZmZzZXRcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHQucHJvdG90eXBlLFwid2lyZWZyYW1lXCIsbnVsbCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0sdC5wcm90b3R5cGUsXCJwb2ludHNDbG91ZFwiLG51bGwpLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHQucHJvdG90eXBlLFwiZmlsbE1vZGVcIixudWxsKSx0fSgpO2UuTWF0ZXJpYWw9aX0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdCgpe2UuY2FsbCh0aGlzKSx0aGlzLkRJRkZVU0U9ITEsdGhpcy5BTUJJRU5UPSExLHRoaXMuT1BBQ0lUWT0hMSx0aGlzLk9QQUNJVFlSR0I9ITEsdGhpcy5SRUZMRUNUSU9OPSExLHRoaXMuRU1JU1NJVkU9ITEsdGhpcy5TUEVDVUxBUj0hMSx0aGlzLkJVTVA9ITEsdGhpcy5QQVJBTExBWD0hMSx0aGlzLlBBUkFMTEFYT0NDTFVTSU9OPSExLHRoaXMuU1BFQ1VMQVJPVkVSQUxQSEE9ITEsdGhpcy5DTElQUExBTkU9ITEsdGhpcy5BTFBIQVRFU1Q9ITEsdGhpcy5BTFBIQUZST01ESUZGVVNFPSExLHRoaXMuUE9JTlRTSVpFPSExLHRoaXMuRk9HPSExLHRoaXMuU1BFQ1VMQVJURVJNPSExLHRoaXMuRElGRlVTRUZSRVNORUw9ITEsdGhpcy5PUEFDSVRZRlJFU05FTD0hMSx0aGlzLlJFRkxFQ1RJT05GUkVTTkVMPSExLHRoaXMuUkVGUkFDVElPTkZSRVNORUw9ITEsdGhpcy5FTUlTU0lWRUZSRVNORUw9ITEsdGhpcy5GUkVTTkVMPSExLHRoaXMuTk9STUFMPSExLHRoaXMuVVYxPSExLHRoaXMuVVYyPSExLHRoaXMuVkVSVEVYQ09MT1I9ITEsdGhpcy5WRVJURVhBTFBIQT0hMSx0aGlzLk5VTV9CT05FX0lORkxVRU5DRVJTPTAsdGhpcy5Cb25lc1Blck1lc2g9MCx0aGlzLklOU1RBTkNFUz0hMSx0aGlzLkdMT1NTSU5FU1M9ITEsXG50aGlzLlJPVUdITkVTUz0hMSx0aGlzLkVNSVNTSVZFQVNJTExVTUlOQVRJT049ITEsdGhpcy5MSU5LRU1JU1NJVkVXSVRIRElGRlVTRT0hMSx0aGlzLlJFRkxFQ1RJT05GUkVTTkVMRlJPTVNQRUNVTEFSPSExLHRoaXMuTElHSFRNQVA9ITEsdGhpcy5VU0VMSUdIVE1BUEFTU0hBRE9XTUFQPSExLHRoaXMuUkVGTEVDVElPTk1BUF8zRD0hMSx0aGlzLlJFRkxFQ1RJT05NQVBfU1BIRVJJQ0FMPSExLHRoaXMuUkVGTEVDVElPTk1BUF9QTEFOQVI9ITEsdGhpcy5SRUZMRUNUSU9OTUFQX0NVQklDPSExLHRoaXMuUkVGTEVDVElPTk1BUF9QUk9KRUNUSU9OPSExLHRoaXMuUkVGTEVDVElPTk1BUF9TS1lCT1g9ITEsdGhpcy5SRUZMRUNUSU9OTUFQX0VYUExJQ0lUPSExLHRoaXMuUkVGTEVDVElPTk1BUF9FUVVJUkVDVEFOR1VMQVI9ITEsdGhpcy5SRUZMRUNUSU9OTUFQX0VRVUlSRUNUQU5HVUxBUl9GSVhFRD0hMSx0aGlzLklOVkVSVENVQklDTUFQPSExLHRoaXMuTE9HQVJJVEhNSUNERVBUSD0hMSx0aGlzLlJFRlJBQ1RJT049ITEsdGhpcy5SRUZSQUNUSU9OTUFQXzNEPSExLHRoaXMuUkVGTEVDVElPTk9WRVJBTFBIQT0hMSx0aGlzLklOVkVSVE5PUk1BTE1BUFg9ITEsdGhpcy5JTlZFUlROT1JNQUxNQVBZPSExLHRoaXMucmVidWlsZCgpfXJldHVybiBfX2V4dGVuZHModCxlKSx0fShlLk1hdGVyaWFsRGVmaW5lcyksaT1mdW5jdGlvbihpKXtmdW5jdGlvbiByKHIsbil7dmFyIG89dGhpcztpLmNhbGwodGhpcyxyLG4pLHRoaXMuYW1iaWVudENvbG9yPW5ldyBlLkNvbG9yMygwLDAsMCksdGhpcy5kaWZmdXNlQ29sb3I9bmV3IGUuQ29sb3IzKDEsMSwxKSx0aGlzLnNwZWN1bGFyQ29sb3I9bmV3IGUuQ29sb3IzKDEsMSwxKSx0aGlzLmVtaXNzaXZlQ29sb3I9bmV3IGUuQ29sb3IzKDAsMCwwKSx0aGlzLnNwZWN1bGFyUG93ZXI9NjQsdGhpcy51c2VBbHBoYUZyb21EaWZmdXNlVGV4dHVyZT0hMSx0aGlzLnVzZUVtaXNzaXZlQXNJbGx1bWluYXRpb249ITEsdGhpcy5saW5rRW1pc3NpdmVXaXRoRGlmZnVzZT0hMSx0aGlzLnVzZVJlZmxlY3Rpb25GcmVzbmVsRnJvbVNwZWN1bGFyPSExLHRoaXMudXNlU3BlY3VsYXJPdmVyQWxwaGE9ITEsdGhpcy51c2VSZWZsZWN0aW9uT3ZlckFscGhhPSExLHRoaXMuZGlzYWJsZUxpZ2h0aW5nPSExLHRoaXMudXNlUGFyYWxsYXg9ITEsdGhpcy51c2VQYXJhbGxheE9jY2x1c2lvbj0hMSx0aGlzLnBhcmFsbGF4U2NhbGVCaWFzPS4wNSx0aGlzLnJvdWdobmVzcz0wLHRoaXMuaW5kZXhPZlJlZnJhY3Rpb249Ljk4LHRoaXMuaW52ZXJ0UmVmcmFjdGlvblk9ITAsdGhpcy51c2VMaWdodG1hcEFzU2hhZG93bWFwPSExLHRoaXMudXNlR2xvc3NpbmVzc0Zyb21TcGVjdWxhck1hcEFscGhhPSExLHRoaXMubWF4U2ltdWx0YW5lb3VzTGlnaHRzPTQsdGhpcy5pbnZlcnROb3JtYWxNYXBYPSExLHRoaXMuaW52ZXJ0Tm9ybWFsTWFwWT0hMSx0aGlzLl9yZW5kZXJUYXJnZXRzPW5ldyBlLlNtYXJ0QXJyYXkoMTYpLHRoaXMuX3dvcmxkVmlld1Byb2plY3Rpb25NYXRyaXg9ZS5NYXRyaXguWmVybygpLHRoaXMuX2dsb2JhbEFtYmllbnRDb2xvcj1uZXcgZS5Db2xvcjMoMCwwLDApLHRoaXMuX2RlZmluZXM9bmV3IHQsdGhpcy5fY2FjaGVkRGVmaW5lcz1uZXcgdCx0aGlzLl9jYWNoZWREZWZpbmVzLkJvbmVzUGVyTWVzaD0tMSx0aGlzLmdldFJlbmRlclRhcmdldFRleHR1cmVzPWZ1bmN0aW9uKCl7cmV0dXJuIG8uX3JlbmRlclRhcmdldHMucmVzZXQoKSxvLnJlZmxlY3Rpb25UZXh0dXJlJiZvLnJlZmxlY3Rpb25UZXh0dXJlLmlzUmVuZGVyVGFyZ2V0JiZvLl9yZW5kZXJUYXJnZXRzLnB1c2goby5yZWZsZWN0aW9uVGV4dHVyZSksby5yZWZyYWN0aW9uVGV4dHVyZSYmby5yZWZyYWN0aW9uVGV4dHVyZS5pc1JlbmRlclRhcmdldCYmby5fcmVuZGVyVGFyZ2V0cy5wdXNoKG8ucmVmcmFjdGlvblRleHR1cmUpLG8uX3JlbmRlclRhcmdldHN9fXJldHVybiBfX2V4dGVuZHMocixpKSxPYmplY3QuZGVmaW5lUHJvcGVydHkoci5wcm90b3R5cGUsXCJ1c2VMb2dhcml0aG1pY0RlcHRoXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl91c2VMb2dhcml0aG1pY0RlcHRofSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fdXNlTG9nYXJpdGhtaWNEZXB0aD1lJiZ0aGlzLmdldFNjZW5lKCkuZ2V0RW5naW5lKCkuZ2V0Q2FwcygpLmZyYWdtZW50RGVwdGhTdXBwb3J0ZWR9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksci5wcm90b3R5cGUubmVlZEFscGhhQmxlbmRpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hbHBoYTwxfHxudWxsIT10aGlzLm9wYWNpdHlUZXh0dXJlfHx0aGlzLl9zaG91bGRVc2VBbHBoYUZyb21EaWZmdXNlVGV4dHVyZSgpfHx0aGlzLm9wYWNpdHlGcmVzbmVsUGFyYW1ldGVycyYmdGhpcy5vcGFjaXR5RnJlc25lbFBhcmFtZXRlcnMuaXNFbmFibGVkfSxyLnByb3RvdHlwZS5uZWVkQWxwaGFUZXN0aW5nPWZ1bmN0aW9uKCl7cmV0dXJuIG51bGwhPXRoaXMuZGlmZnVzZVRleHR1cmUmJnRoaXMuZGlmZnVzZVRleHR1cmUuaGFzQWxwaGF9LHIucHJvdG90eXBlLl9zaG91bGRVc2VBbHBoYUZyb21EaWZmdXNlVGV4dHVyZT1mdW5jdGlvbigpe3JldHVybiBudWxsIT10aGlzLmRpZmZ1c2VUZXh0dXJlJiZ0aGlzLmRpZmZ1c2VUZXh0dXJlLmhhc0FscGhhJiZ0aGlzLnVzZUFscGhhRnJvbURpZmZ1c2VUZXh0dXJlfSxyLnByb3RvdHlwZS5nZXRBbHBoYVRlc3RUZXh0dXJlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGlmZnVzZVRleHR1cmV9LHIucHJvdG90eXBlLl9jaGVja0NhY2hlPWZ1bmN0aW9uKGUsdCxpKXtyZXR1cm4gdD90aGlzLl9kZWZpbmVzLklOU1RBTkNFUyE9PWk/ITE6ISghdC5fbWF0ZXJpYWxEZWZpbmVzfHwhdC5fbWF0ZXJpYWxEZWZpbmVzLmlzRXF1YWwodGhpcy5fZGVmaW5lcykpOiEwfSxyLnByb3RvdHlwZS5pc1JlYWR5PWZ1bmN0aW9uKGksbil7aWYodGhpcy5pc0Zyb3plbiYmdGhpcy5fd2FzUHJldmlvdXNseVJlYWR5KXJldHVybiEwO3ZhciBvPXRoaXMuZ2V0U2NlbmUoKTtpZighdGhpcy5jaGVja1JlYWR5T25FdmVyeUNhbGwmJnRoaXMuX3JlbmRlcklkPT09by5nZXRSZW5kZXJJZCgpJiZ0aGlzLl9jaGVja0NhY2hlKG8saSxuKSlyZXR1cm4hMDt2YXIgcz1vLmdldEVuZ2luZSgpLGE9ITEsaD0hMTtpZih0aGlzLl9kZWZpbmVzLnJlc2V0KCksby50ZXh0dXJlc0VuYWJsZWQpe2lmKHRoaXMuZGlmZnVzZVRleHR1cmUmJnIuRGlmZnVzZVRleHR1cmVFbmFibGVkKXtpZighdGhpcy5kaWZmdXNlVGV4dHVyZS5pc1JlYWR5KCkpcmV0dXJuITE7aD0hMCx0aGlzLl9kZWZpbmVzLkRJRkZVU0U9ITB9aWYodGhpcy5hbWJpZW50VGV4dHVyZSYmci5BbWJpZW50VGV4dHVyZUVuYWJsZWQpe2lmKCF0aGlzLmFtYmllbnRUZXh0dXJlLmlzUmVhZHkoKSlyZXR1cm4hMTtoPSEwLHRoaXMuX2RlZmluZXMuQU1CSUVOVD0hMH1pZih0aGlzLm9wYWNpdHlUZXh0dXJlJiZyLk9wYWNpdHlUZXh0dXJlRW5hYmxlZCl7aWYoIXRoaXMub3BhY2l0eVRleHR1cmUuaXNSZWFkeSgpKXJldHVybiExO2g9ITAsdGhpcy5fZGVmaW5lcy5PUEFDSVRZPSEwLHRoaXMub3BhY2l0eVRleHR1cmUuZ2V0QWxwaGFGcm9tUkdCJiYodGhpcy5fZGVmaW5lcy5PUEFDSVRZUkdCPSEwKX1pZih0aGlzLnJlZmxlY3Rpb25UZXh0dXJlJiZyLlJlZmxlY3Rpb25UZXh0dXJlRW5hYmxlZCl7aWYoIXRoaXMucmVmbGVjdGlvblRleHR1cmUuaXNSZWFkeSgpKXJldHVybiExO3N3aXRjaChhPSEwLHRoaXMuX2RlZmluZXMuUkVGTEVDVElPTj0hMCx0aGlzLnJvdWdobmVzcz4wJiYodGhpcy5fZGVmaW5lcy5ST1VHSE5FU1M9ITApLHRoaXMudXNlUmVmbGVjdGlvbk92ZXJBbHBoYSYmKHRoaXMuX2RlZmluZXMuUkVGTEVDVElPTk9WRVJBTFBIQT0hMCksdGhpcy5yZWZsZWN0aW9uVGV4dHVyZS5jb29yZGluYXRlc01vZGU9PT1lLlRleHR1cmUuSU5WQ1VCSUNfTU9ERSYmKHRoaXMuX2RlZmluZXMuSU5WRVJUQ1VCSUNNQVA9ITApLHRoaXMuX2RlZmluZXMuUkVGTEVDVElPTk1BUF8zRD10aGlzLnJlZmxlY3Rpb25UZXh0dXJlLmlzQ3ViZSx0aGlzLnJlZmxlY3Rpb25UZXh0dXJlLmNvb3JkaW5hdGVzTW9kZSl7Y2FzZSBlLlRleHR1cmUuQ1VCSUNfTU9ERTpjYXNlIGUuVGV4dHVyZS5JTlZDVUJJQ19NT0RFOnRoaXMuX2RlZmluZXMuUkVGTEVDVElPTk1BUF9DVUJJQz0hMDticmVhaztjYXNlIGUuVGV4dHVyZS5FWFBMSUNJVF9NT0RFOnRoaXMuX2RlZmluZXMuUkVGTEVDVElPTk1BUF9FWFBMSUNJVD0hMDticmVhaztjYXNlIGUuVGV4dHVyZS5QTEFOQVJfTU9ERTp0aGlzLl9kZWZpbmVzLlJFRkxFQ1RJT05NQVBfUExBTkFSPSEwO2JyZWFrO2Nhc2UgZS5UZXh0dXJlLlBST0pFQ1RJT05fTU9ERTp0aGlzLl9kZWZpbmVzLlJFRkxFQ1RJT05NQVBfUFJPSkVDVElPTj0hMDticmVhaztjYXNlIGUuVGV4dHVyZS5TS1lCT1hfTU9ERTp0aGlzLl9kZWZpbmVzLlJFRkxFQ1RJT05NQVBfU0tZQk9YPSEwO2JyZWFrO2Nhc2UgZS5UZXh0dXJlLlNQSEVSSUNBTF9NT0RFOnRoaXMuX2RlZmluZXMuUkVGTEVDVElPTk1BUF9TUEhFUklDQUw9ITA7YnJlYWs7Y2FzZSBlLlRleHR1cmUuRVFVSVJFQ1RBTkdVTEFSX01PREU6dGhpcy5fZGVmaW5lcy5SRUZMRUNUSU9OTUFQX0VRVUlSRUNUQU5HVUxBUj0hMDticmVhaztjYXNlIGUuVGV4dHVyZS5GSVhFRF9FUVVJUkVDVEFOR1VMQVJfTU9ERTp0aGlzLl9kZWZpbmVzLlJFRkxFQ1RJT05NQVBfRVFVSVJFQ1RBTkdVTEFSX0ZJWEVEPSEwfX1pZih0aGlzLmVtaXNzaXZlVGV4dHVyZSYmci5FbWlzc2l2ZVRleHR1cmVFbmFibGVkKXtpZighdGhpcy5lbWlzc2l2ZVRleHR1cmUuaXNSZWFkeSgpKXJldHVybiExO2g9ITAsdGhpcy5fZGVmaW5lcy5FTUlTU0lWRT0hMH1pZih0aGlzLmxpZ2h0bWFwVGV4dHVyZSYmci5MaWdodG1hcFRleHR1cmVFbmFibGVkKXtpZighdGhpcy5saWdodG1hcFRleHR1cmUuaXNSZWFkeSgpKXJldHVybiExO2g9ITAsdGhpcy5fZGVmaW5lcy5MSUdIVE1BUD0hMCx0aGlzLl9kZWZpbmVzLlVTRUxJR0hUTUFQQVNTSEFET1dNQVA9dGhpcy51c2VMaWdodG1hcEFzU2hhZG93bWFwfWlmKHRoaXMuc3BlY3VsYXJUZXh0dXJlJiZyLlNwZWN1bGFyVGV4dHVyZUVuYWJsZWQpe2lmKCF0aGlzLnNwZWN1bGFyVGV4dHVyZS5pc1JlYWR5KCkpcmV0dXJuITE7aD0hMCx0aGlzLl9kZWZpbmVzLlNQRUNVTEFSPSEwLHRoaXMuX2RlZmluZXMuR0xPU1NJTkVTUz10aGlzLnVzZUdsb3NzaW5lc3NGcm9tU3BlY3VsYXJNYXBBbHBoYX1pZihvLmdldEVuZ2luZSgpLmdldENhcHMoKS5zdGFuZGFyZERlcml2YXRpdmVzJiZ0aGlzLmJ1bXBUZXh0dXJlJiZyLkJ1bXBUZXh0dXJlRW5hYmxlZCl7aWYoIXRoaXMuYnVtcFRleHR1cmUuaXNSZWFkeSgpKXJldHVybiExO2g9ITAsdGhpcy5fZGVmaW5lcy5CVU1QPSEwLHRoaXMudXNlUGFyYWxsYXgmJih0aGlzLl9kZWZpbmVzLlBBUkFMTEFYPSEwLHRoaXMudXNlUGFyYWxsYXhPY2NsdXNpb24mJih0aGlzLl9kZWZpbmVzLlBBUkFMTEFYT0NDTFVTSU9OPSEwKSksdGhpcy5pbnZlcnROb3JtYWxNYXBYJiYodGhpcy5fZGVmaW5lcy5JTlZFUlROT1JNQUxNQVBYPSEwKSx0aGlzLmludmVydE5vcm1hbE1hcFkmJih0aGlzLl9kZWZpbmVzLklOVkVSVE5PUk1BTE1BUFk9ITApfWlmKHRoaXMucmVmcmFjdGlvblRleHR1cmUmJnIuUmVmcmFjdGlvblRleHR1cmVFbmFibGVkKXtpZighdGhpcy5yZWZyYWN0aW9uVGV4dHVyZS5pc1JlYWR5KCkpcmV0dXJuITE7aD0hMCx0aGlzLl9kZWZpbmVzLlJFRlJBQ1RJT049ITAsdGhpcy5fZGVmaW5lcy5SRUZSQUNUSU9OTUFQXzNEPXRoaXMucmVmcmFjdGlvblRleHR1cmUuaXNDdWJlfX1pZihvLmNsaXBQbGFuZSYmKHRoaXMuX2RlZmluZXMuQ0xJUFBMQU5FPSEwKSxzLmdldEFscGhhVGVzdGluZygpJiYodGhpcy5fZGVmaW5lcy5BTFBIQVRFU1Q9ITApLHRoaXMuX3Nob3VsZFVzZUFscGhhRnJvbURpZmZ1c2VUZXh0dXJlKCkmJih0aGlzLl9kZWZpbmVzLkFMUEhBRlJPTURJRkZVU0U9ITApLHRoaXMudXNlRW1pc3NpdmVBc0lsbHVtaW5hdGlvbiYmKHRoaXMuX2RlZmluZXMuRU1JU1NJVkVBU0lMTFVNSU5BVElPTj0hMCksdGhpcy5saW5rRW1pc3NpdmVXaXRoRGlmZnVzZSYmKHRoaXMuX2RlZmluZXMuTElOS0VNSVNTSVZFV0lUSERJRkZVU0U9ITApLHRoaXMudXNlTG9nYXJpdGhtaWNEZXB0aCYmKHRoaXMuX2RlZmluZXMuTE9HQVJJVEhNSUNERVBUSD0hMCksKHRoaXMucG9pbnRzQ2xvdWR8fG8uZm9yY2VQb2ludHNDbG91ZCkmJih0aGlzLl9kZWZpbmVzLlBPSU5UU0laRT0hMCksby5mb2dFbmFibGVkJiZpJiZpLmFwcGx5Rm9nJiZvLmZvZ01vZGUhPT1lLlNjZW5lLkZPR01PREVfTk9ORSYmdGhpcy5mb2dFbmFibGVkJiYodGhpcy5fZGVmaW5lcy5GT0c9ITApLG8ubGlnaHRzRW5hYmxlZCYmIXRoaXMuZGlzYWJsZUxpZ2h0aW5nJiYoYT1lLk1hdGVyaWFsSGVscGVyLlByZXBhcmVEZWZpbmVzRm9yTGlnaHRzKG8saSx0aGlzLl9kZWZpbmVzLHRoaXMubWF4U2ltdWx0YW5lb3VzTGlnaHRzKSksci5GcmVzbmVsRW5hYmxlZCYmKHRoaXMuZGlmZnVzZUZyZXNuZWxQYXJhbWV0ZXJzJiZ0aGlzLmRpZmZ1c2VGcmVzbmVsUGFyYW1ldGVycy5pc0VuYWJsZWR8fHRoaXMub3BhY2l0eUZyZXNuZWxQYXJhbWV0ZXJzJiZ0aGlzLm9wYWNpdHlGcmVzbmVsUGFyYW1ldGVycy5pc0VuYWJsZWR8fHRoaXMuZW1pc3NpdmVGcmVzbmVsUGFyYW1ldGVycyYmdGhpcy5lbWlzc2l2ZUZyZXNuZWxQYXJhbWV0ZXJzLmlzRW5hYmxlZHx8dGhpcy5yZWZyYWN0aW9uRnJlc25lbFBhcmFtZXRlcnMmJnRoaXMucmVmcmFjdGlvbkZyZXNuZWxQYXJhbWV0ZXJzLmlzRW5hYmxlZHx8dGhpcy5yZWZsZWN0aW9uRnJlc25lbFBhcmFtZXRlcnMmJnRoaXMucmVmbGVjdGlvbkZyZXNuZWxQYXJhbWV0ZXJzLmlzRW5hYmxlZCkmJih0aGlzLmRpZmZ1c2VGcmVzbmVsUGFyYW1ldGVycyYmdGhpcy5kaWZmdXNlRnJlc25lbFBhcmFtZXRlcnMuaXNFbmFibGVkJiYodGhpcy5fZGVmaW5lcy5ESUZGVVNFRlJFU05FTD0hMCksdGhpcy5vcGFjaXR5RnJlc25lbFBhcmFtZXRlcnMmJnRoaXMub3BhY2l0eUZyZXNuZWxQYXJhbWV0ZXJzLmlzRW5hYmxlZCYmKHRoaXMuX2RlZmluZXMuT1BBQ0lUWUZSRVNORUw9ITApLHRoaXMucmVmbGVjdGlvbkZyZXNuZWxQYXJhbWV0ZXJzJiZ0aGlzLnJlZmxlY3Rpb25GcmVzbmVsUGFyYW1ldGVycy5pc0VuYWJsZWQmJih0aGlzLl9kZWZpbmVzLlJFRkxFQ1RJT05GUkVTTkVMPSEwLHRoaXMudXNlUmVmbGVjdGlvbkZyZXNuZWxGcm9tU3BlY3VsYXImJih0aGlzLl9kZWZpbmVzLlJFRkxFQ1RJT05GUkVTTkVMRlJPTVNQRUNVTEFSPSEwKSksdGhpcy5yZWZyYWN0aW9uRnJlc25lbFBhcmFtZXRlcnMmJnRoaXMucmVmcmFjdGlvbkZyZXNuZWxQYXJhbWV0ZXJzLmlzRW5hYmxlZCYmKHRoaXMuX2RlZmluZXMuUkVGUkFDVElPTkZSRVNORUw9ITApLHRoaXMuZW1pc3NpdmVGcmVzbmVsUGFyYW1ldGVycyYmdGhpcy5lbWlzc2l2ZUZyZXNuZWxQYXJhbWV0ZXJzLmlzRW5hYmxlZCYmKHRoaXMuX2RlZmluZXMuRU1JU1NJVkVGUkVTTkVMPSEwKSxhPSEwLHRoaXMuX2RlZmluZXMuRlJFU05FTD0hMCksdGhpcy5fZGVmaW5lcy5TUEVDVUxBUlRFUk0mJnRoaXMudXNlU3BlY3VsYXJPdmVyQWxwaGEmJih0aGlzLl9kZWZpbmVzLlNQRUNVTEFST1ZFUkFMUEhBPSEwKSxpJiYoYSYmaS5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZS5WZXJ0ZXhCdWZmZXIuTm9ybWFsS2luZCkmJih0aGlzLl9kZWZpbmVzLk5PUk1BTD0hMCksaCYmKGkuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGUuVmVydGV4QnVmZmVyLlVWS2luZCkmJih0aGlzLl9kZWZpbmVzLlVWMT0hMCksaS5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZS5WZXJ0ZXhCdWZmZXIuVVYyS2luZCkmJih0aGlzLl9kZWZpbmVzLlVWMj0hMCkpLGkudXNlVmVydGV4Q29sb3JzJiZpLmlzVmVydGljZXNEYXRhUHJlc2VudChlLlZlcnRleEJ1ZmZlci5Db2xvcktpbmQpJiYodGhpcy5fZGVmaW5lcy5WRVJURVhDT0xPUj0hMCxpLmhhc1ZlcnRleEFscGhhJiYodGhpcy5fZGVmaW5lcy5WRVJURVhBTFBIQT0hMCkpLGkudXNlQm9uZXMmJmkuY29tcHV0ZUJvbmVzVXNpbmdTaGFkZXJzJiYodGhpcy5fZGVmaW5lcy5OVU1fQk9ORV9JTkZMVUVOQ0VSUz1pLm51bUJvbmVJbmZsdWVuY2Vycyx0aGlzLl9kZWZpbmVzLkJvbmVzUGVyTWVzaD1pLnNrZWxldG9uLmJvbmVzLmxlbmd0aCsxKSxuJiYodGhpcy5fZGVmaW5lcy5JTlNUQU5DRVM9ITApKSwhdGhpcy5fZGVmaW5lcy5pc0VxdWFsKHRoaXMuX2NhY2hlZERlZmluZXMpKXt0aGlzLl9kZWZpbmVzLmNsb25lVG8odGhpcy5fY2FjaGVkRGVmaW5lcyksby5yZXNldENhY2hlZE1hdGVyaWFsKCk7dmFyIGM9bmV3IGUuRWZmZWN0RmFsbGJhY2tzO3RoaXMuX2RlZmluZXMuUkVGTEVDVElPTiYmYy5hZGRGYWxsYmFjaygwLFwiUkVGTEVDVElPTlwiKSx0aGlzLl9kZWZpbmVzLlNQRUNVTEFSJiZjLmFkZEZhbGxiYWNrKDAsXCJTUEVDVUxBUlwiKSx0aGlzLl9kZWZpbmVzLkJVTVAmJmMuYWRkRmFsbGJhY2soMCxcIkJVTVBcIiksdGhpcy5fZGVmaW5lcy5QQVJBTExBWCYmYy5hZGRGYWxsYmFjaygxLFwiUEFSQUxMQVhcIiksdGhpcy5fZGVmaW5lcy5QQVJBTExBWE9DQ0xVU0lPTiYmYy5hZGRGYWxsYmFjaygwLFwiUEFSQUxMQVhPQ0NMVVNJT05cIiksdGhpcy5fZGVmaW5lcy5TUEVDVUxBUk9WRVJBTFBIQSYmYy5hZGRGYWxsYmFjaygwLFwiU1BFQ1VMQVJPVkVSQUxQSEFcIiksdGhpcy5fZGVmaW5lcy5GT0cmJmMuYWRkRmFsbGJhY2soMSxcIkZPR1wiKSx0aGlzLl9kZWZpbmVzLlBPSU5UU0laRSYmYy5hZGRGYWxsYmFjaygwLFwiUE9JTlRTSVpFXCIpLHRoaXMuX2RlZmluZXMuTE9HQVJJVEhNSUNERVBUSCYmYy5hZGRGYWxsYmFjaygwLFwiTE9HQVJJVEhNSUNERVBUSFwiKSxlLk1hdGVyaWFsSGVscGVyLkhhbmRsZUZhbGxiYWNrc0ZvclNoYWRvd3ModGhpcy5fZGVmaW5lcyxjLHRoaXMubWF4U2ltdWx0YW5lb3VzTGlnaHRzKSx0aGlzLl9kZWZpbmVzLlNQRUNVTEFSVEVSTSYmYy5hZGRGYWxsYmFjaygwLFwiU1BFQ1VMQVJURVJNXCIpLHRoaXMuX2RlZmluZXMuRElGRlVTRUZSRVNORUwmJmMuYWRkRmFsbGJhY2soMSxcIkRJRkZVU0VGUkVTTkVMXCIpLHRoaXMuX2RlZmluZXMuT1BBQ0lUWUZSRVNORUwmJmMuYWRkRmFsbGJhY2soMixcIk9QQUNJVFlGUkVTTkVMXCIpLHRoaXMuX2RlZmluZXMuUkVGTEVDVElPTkZSRVNORUwmJmMuYWRkRmFsbGJhY2soMyxcIlJFRkxFQ1RJT05GUkVTTkVMXCIpLHRoaXMuX2RlZmluZXMuRU1JU1NJVkVGUkVTTkVMJiZjLmFkZEZhbGxiYWNrKDQsXCJFTUlTU0lWRUZSRVNORUxcIiksdGhpcy5fZGVmaW5lcy5GUkVTTkVMJiZjLmFkZEZhbGxiYWNrKDQsXCJGUkVTTkVMXCIpO3ZhciBsPVtlLlZlcnRleEJ1ZmZlci5Qb3NpdGlvbktpbmRdO3RoaXMuX2RlZmluZXMuTk9STUFMJiZsLnB1c2goZS5WZXJ0ZXhCdWZmZXIuTm9ybWFsS2luZCksdGhpcy5fZGVmaW5lcy5VVjEmJmwucHVzaChlLlZlcnRleEJ1ZmZlci5VVktpbmQpLHRoaXMuX2RlZmluZXMuVVYyJiZsLnB1c2goZS5WZXJ0ZXhCdWZmZXIuVVYyS2luZCksdGhpcy5fZGVmaW5lcy5WRVJURVhDT0xPUiYmbC5wdXNoKGUuVmVydGV4QnVmZmVyLkNvbG9yS2luZCksZS5NYXRlcmlhbEhlbHBlci5QcmVwYXJlQXR0cmlidXRlc0ZvckJvbmVzKGwsaSx0aGlzLl9kZWZpbmVzLGMpLGUuTWF0ZXJpYWxIZWxwZXIuUHJlcGFyZUF0dHJpYnV0ZXNGb3JJbnN0YW5jZXMobCx0aGlzLl9kZWZpbmVzKTt2YXIgdT1cImRlZmF1bHRcIjtvLmdldEVuZ2luZSgpLmdldENhcHMoKS5zdGFuZGFyZERlcml2YXRpdmVzfHwodT1cImxlZ2FjeWRlZmF1bHRcIik7dmFyIGY9dGhpcy5fZGVmaW5lcy50b1N0cmluZygpLGQ9W1wid29ybGRcIixcInZpZXdcIixcInZpZXdQcm9qZWN0aW9uXCIsXCJ2RXllUG9zaXRpb25cIixcInZMaWdodHNUeXBlXCIsXCJ2QW1iaWVudENvbG9yXCIsXCJ2RGlmZnVzZUNvbG9yXCIsXCJ2U3BlY3VsYXJDb2xvclwiLFwidkVtaXNzaXZlQ29sb3JcIixcInZGb2dJbmZvc1wiLFwidkZvZ0NvbG9yXCIsXCJwb2ludFNpemVcIixcInZEaWZmdXNlSW5mb3NcIixcInZBbWJpZW50SW5mb3NcIixcInZPcGFjaXR5SW5mb3NcIixcInZSZWZsZWN0aW9uSW5mb3NcIixcInZFbWlzc2l2ZUluZm9zXCIsXCJ2U3BlY3VsYXJJbmZvc1wiLFwidkJ1bXBJbmZvc1wiLFwidkxpZ2h0bWFwSW5mb3NcIixcInZSZWZyYWN0aW9uSW5mb3NcIixcIm1Cb25lc1wiLFwidkNsaXBQbGFuZVwiLFwiZGlmZnVzZU1hdHJpeFwiLFwiYW1iaWVudE1hdHJpeFwiLFwib3BhY2l0eU1hdHJpeFwiLFwicmVmbGVjdGlvbk1hdHJpeFwiLFwiZW1pc3NpdmVNYXRyaXhcIixcInNwZWN1bGFyTWF0cml4XCIsXCJidW1wTWF0cml4XCIsXCJsaWdodG1hcE1hdHJpeFwiLFwicmVmcmFjdGlvbk1hdHJpeFwiLFwiZGVwdGhWYWx1ZXNcIixcImRpZmZ1c2VMZWZ0Q29sb3JcIixcImRpZmZ1c2VSaWdodENvbG9yXCIsXCJvcGFjaXR5UGFydHNcIixcInJlZmxlY3Rpb25MZWZ0Q29sb3JcIixcInJlZmxlY3Rpb25SaWdodENvbG9yXCIsXCJlbWlzc2l2ZUxlZnRDb2xvclwiLFwiZW1pc3NpdmVSaWdodENvbG9yXCIsXCJyZWZyYWN0aW9uTGVmdENvbG9yXCIsXCJyZWZyYWN0aW9uUmlnaHRDb2xvclwiLFwibG9nYXJpdGhtaWNEZXB0aENvbnN0YW50XCJdLHA9W1wiZGlmZnVzZVNhbXBsZXJcIixcImFtYmllbnRTYW1wbGVyXCIsXCJvcGFjaXR5U2FtcGxlclwiLFwicmVmbGVjdGlvbkN1YmVTYW1wbGVyXCIsXCJyZWZsZWN0aW9uMkRTYW1wbGVyXCIsXCJlbWlzc2l2ZVNhbXBsZXJcIixcInNwZWN1bGFyU2FtcGxlclwiLFwiYnVtcFNhbXBsZXJcIixcImxpZ2h0bWFwU2FtcGxlclwiLFwicmVmcmFjdGlvbkN1YmVTYW1wbGVyXCIsXCJyZWZyYWN0aW9uMkRTYW1wbGVyXCJdO2UuTWF0ZXJpYWxIZWxwZXIuUHJlcGFyZVVuaWZvcm1zQW5kU2FtcGxlcnNMaXN0KGQscCx0aGlzLl9kZWZpbmVzLHRoaXMubWF4U2ltdWx0YW5lb3VzTGlnaHRzKSx0aGlzLl9lZmZlY3Q9by5nZXRFbmdpbmUoKS5jcmVhdGVFZmZlY3QodSxsLGQscCxmLGMsdGhpcy5vbkNvbXBpbGVkLHRoaXMub25FcnJvcix7bWF4U2ltdWx0YW5lb3VzTGlnaHRzOnRoaXMubWF4U2ltdWx0YW5lb3VzTGlnaHRzLTF9KX1yZXR1cm4gdGhpcy5fZWZmZWN0LmlzUmVhZHkoKT8odGhpcy5fcmVuZGVySWQ9by5nZXRSZW5kZXJJZCgpLHRoaXMuX3dhc1ByZXZpb3VzbHlSZWFkeT0hMCxpJiYoaS5fbWF0ZXJpYWxEZWZpbmVzfHwoaS5fbWF0ZXJpYWxEZWZpbmVzPW5ldyB0KSx0aGlzLl9kZWZpbmVzLmNsb25lVG8oaS5fbWF0ZXJpYWxEZWZpbmVzKSksITApOiExfSxyLnByb3RvdHlwZS51bmJpbmQ9ZnVuY3Rpb24oKXt0aGlzLnJlZmxlY3Rpb25UZXh0dXJlJiZ0aGlzLnJlZmxlY3Rpb25UZXh0dXJlLmlzUmVuZGVyVGFyZ2V0JiZ0aGlzLl9lZmZlY3Quc2V0VGV4dHVyZShcInJlZmxlY3Rpb24yRFNhbXBsZXJcIixudWxsKSx0aGlzLnJlZnJhY3Rpb25UZXh0dXJlJiZ0aGlzLnJlZnJhY3Rpb25UZXh0dXJlLmlzUmVuZGVyVGFyZ2V0JiZ0aGlzLl9lZmZlY3Quc2V0VGV4dHVyZShcInJlZnJhY3Rpb24yRFNhbXBsZXJcIixudWxsKSxpLnByb3RvdHlwZS51bmJpbmQuY2FsbCh0aGlzKX0sci5wcm90b3R5cGUuYmluZE9ubHlXb3JsZE1hdHJpeD1mdW5jdGlvbihlKXt0aGlzLl9lZmZlY3Quc2V0TWF0cml4KFwid29ybGRcIixlKX0sci5wcm90b3R5cGUuYmluZD1mdW5jdGlvbih0LG4pe3ZhciBvPXRoaXMuZ2V0U2NlbmUoKTtpZih0aGlzLmJpbmRPbmx5V29ybGRNYXRyaXgodCksZS5NYXRlcmlhbEhlbHBlci5CaW5kQm9uZXNQYXJhbWV0ZXJzKG4sdGhpcy5fZWZmZWN0KSxvLmdldENhY2hlZE1hdGVyaWFsKCkhPT10aGlzKXtpZih0aGlzLl9lZmZlY3Quc2V0TWF0cml4KFwidmlld1Byb2plY3Rpb25cIixvLmdldFRyYW5zZm9ybU1hdHJpeCgpKSxyLkZyZXNuZWxFbmFibGVkJiYodGhpcy5kaWZmdXNlRnJlc25lbFBhcmFtZXRlcnMmJnRoaXMuZGlmZnVzZUZyZXNuZWxQYXJhbWV0ZXJzLmlzRW5hYmxlZCYmKHRoaXMuX2VmZmVjdC5zZXRDb2xvcjQoXCJkaWZmdXNlTGVmdENvbG9yXCIsdGhpcy5kaWZmdXNlRnJlc25lbFBhcmFtZXRlcnMubGVmdENvbG9yLHRoaXMuZGlmZnVzZUZyZXNuZWxQYXJhbWV0ZXJzLnBvd2VyKSx0aGlzLl9lZmZlY3Quc2V0Q29sb3I0KFwiZGlmZnVzZVJpZ2h0Q29sb3JcIix0aGlzLmRpZmZ1c2VGcmVzbmVsUGFyYW1ldGVycy5yaWdodENvbG9yLHRoaXMuZGlmZnVzZUZyZXNuZWxQYXJhbWV0ZXJzLmJpYXMpKSx0aGlzLm9wYWNpdHlGcmVzbmVsUGFyYW1ldGVycyYmdGhpcy5vcGFjaXR5RnJlc25lbFBhcmFtZXRlcnMuaXNFbmFibGVkJiZ0aGlzLl9lZmZlY3Quc2V0Q29sb3I0KFwib3BhY2l0eVBhcnRzXCIsbmV3IGUuQ29sb3IzKHRoaXMub3BhY2l0eUZyZXNuZWxQYXJhbWV0ZXJzLmxlZnRDb2xvci50b0x1bWluYW5jZSgpLHRoaXMub3BhY2l0eUZyZXNuZWxQYXJhbWV0ZXJzLnJpZ2h0Q29sb3IudG9MdW1pbmFuY2UoKSx0aGlzLm9wYWNpdHlGcmVzbmVsUGFyYW1ldGVycy5iaWFzKSx0aGlzLm9wYWNpdHlGcmVzbmVsUGFyYW1ldGVycy5wb3dlciksdGhpcy5yZWZsZWN0aW9uRnJlc25lbFBhcmFtZXRlcnMmJnRoaXMucmVmbGVjdGlvbkZyZXNuZWxQYXJhbWV0ZXJzLmlzRW5hYmxlZCYmKHRoaXMuX2VmZmVjdC5zZXRDb2xvcjQoXCJyZWZsZWN0aW9uTGVmdENvbG9yXCIsdGhpcy5yZWZsZWN0aW9uRnJlc25lbFBhcmFtZXRlcnMubGVmdENvbG9yLHRoaXMucmVmbGVjdGlvbkZyZXNuZWxQYXJhbWV0ZXJzLnBvd2VyKSx0aGlzLl9lZmZlY3Quc2V0Q29sb3I0KFwicmVmbGVjdGlvblJpZ2h0Q29sb3JcIix0aGlzLnJlZmxlY3Rpb25GcmVzbmVsUGFyYW1ldGVycy5yaWdodENvbG9yLHRoaXMucmVmbGVjdGlvbkZyZXNuZWxQYXJhbWV0ZXJzLmJpYXMpKSx0aGlzLnJlZnJhY3Rpb25GcmVzbmVsUGFyYW1ldGVycyYmdGhpcy5yZWZyYWN0aW9uRnJlc25lbFBhcmFtZXRlcnMuaXNFbmFibGVkJiYodGhpcy5fZWZmZWN0LnNldENvbG9yNChcInJlZnJhY3Rpb25MZWZ0Q29sb3JcIix0aGlzLnJlZnJhY3Rpb25GcmVzbmVsUGFyYW1ldGVycy5sZWZ0Q29sb3IsdGhpcy5yZWZyYWN0aW9uRnJlc25lbFBhcmFtZXRlcnMucG93ZXIpLHRoaXMuX2VmZmVjdC5zZXRDb2xvcjQoXCJyZWZyYWN0aW9uUmlnaHRDb2xvclwiLHRoaXMucmVmcmFjdGlvbkZyZXNuZWxQYXJhbWV0ZXJzLnJpZ2h0Q29sb3IsdGhpcy5yZWZyYWN0aW9uRnJlc25lbFBhcmFtZXRlcnMuYmlhcykpLHRoaXMuZW1pc3NpdmVGcmVzbmVsUGFyYW1ldGVycyYmdGhpcy5lbWlzc2l2ZUZyZXNuZWxQYXJhbWV0ZXJzLmlzRW5hYmxlZCYmKHRoaXMuX2VmZmVjdC5zZXRDb2xvcjQoXCJlbWlzc2l2ZUxlZnRDb2xvclwiLHRoaXMuZW1pc3NpdmVGcmVzbmVsUGFyYW1ldGVycy5sZWZ0Q29sb3IsdGhpcy5lbWlzc2l2ZUZyZXNuZWxQYXJhbWV0ZXJzLnBvd2VyKSx0aGlzLl9lZmZlY3Quc2V0Q29sb3I0KFwiZW1pc3NpdmVSaWdodENvbG9yXCIsdGhpcy5lbWlzc2l2ZUZyZXNuZWxQYXJhbWV0ZXJzLnJpZ2h0Q29sb3IsdGhpcy5lbWlzc2l2ZUZyZXNuZWxQYXJhbWV0ZXJzLmJpYXMpKSksby50ZXh0dXJlc0VuYWJsZWQmJih0aGlzLmRpZmZ1c2VUZXh0dXJlJiZyLkRpZmZ1c2VUZXh0dXJlRW5hYmxlZCYmKHRoaXMuX2VmZmVjdC5zZXRUZXh0dXJlKFwiZGlmZnVzZVNhbXBsZXJcIix0aGlzLmRpZmZ1c2VUZXh0dXJlKSx0aGlzLl9lZmZlY3Quc2V0RmxvYXQyKFwidkRpZmZ1c2VJbmZvc1wiLHRoaXMuZGlmZnVzZVRleHR1cmUuY29vcmRpbmF0ZXNJbmRleCx0aGlzLmRpZmZ1c2VUZXh0dXJlLmxldmVsKSx0aGlzLl9lZmZlY3Quc2V0TWF0cml4KFwiZGlmZnVzZU1hdHJpeFwiLHRoaXMuZGlmZnVzZVRleHR1cmUuZ2V0VGV4dHVyZU1hdHJpeCgpKSksdGhpcy5hbWJpZW50VGV4dHVyZSYmci5BbWJpZW50VGV4dHVyZUVuYWJsZWQmJih0aGlzLl9lZmZlY3Quc2V0VGV4dHVyZShcImFtYmllbnRTYW1wbGVyXCIsdGhpcy5hbWJpZW50VGV4dHVyZSksdGhpcy5fZWZmZWN0LnNldEZsb2F0MihcInZBbWJpZW50SW5mb3NcIix0aGlzLmFtYmllbnRUZXh0dXJlLmNvb3JkaW5hdGVzSW5kZXgsdGhpcy5hbWJpZW50VGV4dHVyZS5sZXZlbCksdGhpcy5fZWZmZWN0LnNldE1hdHJpeChcImFtYmllbnRNYXRyaXhcIix0aGlzLmFtYmllbnRUZXh0dXJlLmdldFRleHR1cmVNYXRyaXgoKSkpLHRoaXMub3BhY2l0eVRleHR1cmUmJnIuT3BhY2l0eVRleHR1cmVFbmFibGVkJiYodGhpcy5fZWZmZWN0LnNldFRleHR1cmUoXCJvcGFjaXR5U2FtcGxlclwiLHRoaXMub3BhY2l0eVRleHR1cmUpLHRoaXMuX2VmZmVjdC5zZXRGbG9hdDIoXCJ2T3BhY2l0eUluZm9zXCIsdGhpcy5vcGFjaXR5VGV4dHVyZS5jb29yZGluYXRlc0luZGV4LHRoaXMub3BhY2l0eVRleHR1cmUubGV2ZWwpLHRoaXMuX2VmZmVjdC5zZXRNYXRyaXgoXCJvcGFjaXR5TWF0cml4XCIsdGhpcy5vcGFjaXR5VGV4dHVyZS5nZXRUZXh0dXJlTWF0cml4KCkpKSx0aGlzLnJlZmxlY3Rpb25UZXh0dXJlJiZyLlJlZmxlY3Rpb25UZXh0dXJlRW5hYmxlZCYmKHRoaXMucmVmbGVjdGlvblRleHR1cmUuaXNDdWJlP3RoaXMuX2VmZmVjdC5zZXRUZXh0dXJlKFwicmVmbGVjdGlvbkN1YmVTYW1wbGVyXCIsdGhpcy5yZWZsZWN0aW9uVGV4dHVyZSk6dGhpcy5fZWZmZWN0LnNldFRleHR1cmUoXCJyZWZsZWN0aW9uMkRTYW1wbGVyXCIsdGhpcy5yZWZsZWN0aW9uVGV4dHVyZSksdGhpcy5fZWZmZWN0LnNldE1hdHJpeChcInJlZmxlY3Rpb25NYXRyaXhcIix0aGlzLnJlZmxlY3Rpb25UZXh0dXJlLmdldFJlZmxlY3Rpb25UZXh0dXJlTWF0cml4KCkpLHRoaXMuX2VmZmVjdC5zZXRGbG9hdDIoXCJ2UmVmbGVjdGlvbkluZm9zXCIsdGhpcy5yZWZsZWN0aW9uVGV4dHVyZS5sZXZlbCx0aGlzLnJvdWdobmVzcykpLHRoaXMuZW1pc3NpdmVUZXh0dXJlJiZyLkVtaXNzaXZlVGV4dHVyZUVuYWJsZWQmJih0aGlzLl9lZmZlY3Quc2V0VGV4dHVyZShcImVtaXNzaXZlU2FtcGxlclwiLHRoaXMuZW1pc3NpdmVUZXh0dXJlKSx0aGlzLl9lZmZlY3Quc2V0RmxvYXQyKFwidkVtaXNzaXZlSW5mb3NcIix0aGlzLmVtaXNzaXZlVGV4dHVyZS5jb29yZGluYXRlc0luZGV4LHRoaXMuZW1pc3NpdmVUZXh0dXJlLmxldmVsKSx0aGlzLl9lZmZlY3Quc2V0TWF0cml4KFwiZW1pc3NpdmVNYXRyaXhcIix0aGlzLmVtaXNzaXZlVGV4dHVyZS5nZXRUZXh0dXJlTWF0cml4KCkpKSx0aGlzLmxpZ2h0bWFwVGV4dHVyZSYmci5MaWdodG1hcFRleHR1cmVFbmFibGVkJiYodGhpcy5fZWZmZWN0LnNldFRleHR1cmUoXCJsaWdodG1hcFNhbXBsZXJcIix0aGlzLmxpZ2h0bWFwVGV4dHVyZSksdGhpcy5fZWZmZWN0LnNldEZsb2F0MihcInZMaWdodG1hcEluZm9zXCIsdGhpcy5saWdodG1hcFRleHR1cmUuY29vcmRpbmF0ZXNJbmRleCx0aGlzLmxpZ2h0bWFwVGV4dHVyZS5sZXZlbCksdGhpcy5fZWZmZWN0LnNldE1hdHJpeChcImxpZ2h0bWFwTWF0cml4XCIsdGhpcy5saWdodG1hcFRleHR1cmUuZ2V0VGV4dHVyZU1hdHJpeCgpKSksdGhpcy5zcGVjdWxhclRleHR1cmUmJnIuU3BlY3VsYXJUZXh0dXJlRW5hYmxlZCYmKHRoaXMuX2VmZmVjdC5zZXRUZXh0dXJlKFwic3BlY3VsYXJTYW1wbGVyXCIsdGhpcy5zcGVjdWxhclRleHR1cmUpLHRoaXMuX2VmZmVjdC5zZXRGbG9hdDIoXCJ2U3BlY3VsYXJJbmZvc1wiLHRoaXMuc3BlY3VsYXJUZXh0dXJlLmNvb3JkaW5hdGVzSW5kZXgsdGhpcy5zcGVjdWxhclRleHR1cmUubGV2ZWwpLHRoaXMuX2VmZmVjdC5zZXRNYXRyaXgoXCJzcGVjdWxhck1hdHJpeFwiLHRoaXMuc3BlY3VsYXJUZXh0dXJlLmdldFRleHR1cmVNYXRyaXgoKSkpLHRoaXMuYnVtcFRleHR1cmUmJm8uZ2V0RW5naW5lKCkuZ2V0Q2FwcygpLnN0YW5kYXJkRGVyaXZhdGl2ZXMmJnIuQnVtcFRleHR1cmVFbmFibGVkJiYodGhpcy5fZWZmZWN0LnNldFRleHR1cmUoXCJidW1wU2FtcGxlclwiLHRoaXMuYnVtcFRleHR1cmUpLHRoaXMuX2VmZmVjdC5zZXRGbG9hdDMoXCJ2QnVtcEluZm9zXCIsdGhpcy5idW1wVGV4dHVyZS5jb29yZGluYXRlc0luZGV4LDEvdGhpcy5idW1wVGV4dHVyZS5sZXZlbCx0aGlzLnBhcmFsbGF4U2NhbGVCaWFzKSx0aGlzLl9lZmZlY3Quc2V0TWF0cml4KFwiYnVtcE1hdHJpeFwiLHRoaXMuYnVtcFRleHR1cmUuZ2V0VGV4dHVyZU1hdHJpeCgpKSksdGhpcy5yZWZyYWN0aW9uVGV4dHVyZSYmci5SZWZyYWN0aW9uVGV4dHVyZUVuYWJsZWQpKXt2YXIgcz0xO3RoaXMucmVmcmFjdGlvblRleHR1cmUuaXNDdWJlP3RoaXMuX2VmZmVjdC5zZXRUZXh0dXJlKFwicmVmcmFjdGlvbkN1YmVTYW1wbGVyXCIsdGhpcy5yZWZyYWN0aW9uVGV4dHVyZSk6KHRoaXMuX2VmZmVjdC5zZXRUZXh0dXJlKFwicmVmcmFjdGlvbjJEU2FtcGxlclwiLHRoaXMucmVmcmFjdGlvblRleHR1cmUpLHRoaXMuX2VmZmVjdC5zZXRNYXRyaXgoXCJyZWZyYWN0aW9uTWF0cml4XCIsdGhpcy5yZWZyYWN0aW9uVGV4dHVyZS5nZXRSZWZsZWN0aW9uVGV4dHVyZU1hdHJpeCgpKSx0aGlzLnJlZnJhY3Rpb25UZXh0dXJlLmRlcHRoJiYocz10aGlzLnJlZnJhY3Rpb25UZXh0dXJlLmRlcHRoKSksdGhpcy5fZWZmZWN0LnNldEZsb2F0NChcInZSZWZyYWN0aW9uSW5mb3NcIix0aGlzLnJlZnJhY3Rpb25UZXh0dXJlLmxldmVsLHRoaXMuaW5kZXhPZlJlZnJhY3Rpb24scyx0aGlzLmludmVydFJlZnJhY3Rpb25ZPy0xOjEpfWUuTWF0ZXJpYWxIZWxwZXIuQmluZENsaXBQbGFuZSh0aGlzLl9lZmZlY3QsbyksdGhpcy5wb2ludHNDbG91ZCYmdGhpcy5fZWZmZWN0LnNldEZsb2F0KFwicG9pbnRTaXplXCIsdGhpcy5wb2ludFNpemUpLG8uYW1iaWVudENvbG9yLm11bHRpcGx5VG9SZWYodGhpcy5hbWJpZW50Q29sb3IsdGhpcy5fZ2xvYmFsQW1iaWVudENvbG9yKSx0aGlzLl9lZmZlY3Quc2V0VmVjdG9yMyhcInZFeWVQb3NpdGlvblwiLG8uX21pcnJvcmVkQ2FtZXJhUG9zaXRpb24/by5fbWlycm9yZWRDYW1lcmFQb3NpdGlvbjpvLmFjdGl2ZUNhbWVyYS5wb3NpdGlvbiksdGhpcy5fZWZmZWN0LnNldENvbG9yMyhcInZBbWJpZW50Q29sb3JcIix0aGlzLl9nbG9iYWxBbWJpZW50Q29sb3IpLHRoaXMuX2RlZmluZXMuU1BFQ1VMQVJURVJNJiZ0aGlzLl9lZmZlY3Quc2V0Q29sb3I0KFwidlNwZWN1bGFyQ29sb3JcIix0aGlzLnNwZWN1bGFyQ29sb3IsdGhpcy5zcGVjdWxhclBvd2VyKSx0aGlzLl9lZmZlY3Quc2V0Q29sb3IzKFwidkVtaXNzaXZlQ29sb3JcIix0aGlzLmVtaXNzaXZlQ29sb3IpfW8uZ2V0Q2FjaGVkTWF0ZXJpYWwoKT09PXRoaXMmJnRoaXMuaXNGcm96ZW58fCh0aGlzLl9lZmZlY3Quc2V0Q29sb3I0KFwidkRpZmZ1c2VDb2xvclwiLHRoaXMuZGlmZnVzZUNvbG9yLHRoaXMuYWxwaGEqbi52aXNpYmlsaXR5KSxvLmxpZ2h0c0VuYWJsZWQmJiF0aGlzLmRpc2FibGVMaWdodGluZyYmZS5NYXRlcmlhbEhlbHBlci5CaW5kTGlnaHRzKG8sbix0aGlzLl9lZmZlY3QsdGhpcy5fZGVmaW5lcyx0aGlzLm1heFNpbXVsdGFuZW91c0xpZ2h0cyksKG8uZm9nRW5hYmxlZCYmbi5hcHBseUZvZyYmby5mb2dNb2RlIT09ZS5TY2VuZS5GT0dNT0RFX05PTkV8fHRoaXMucmVmbGVjdGlvblRleHR1cmV8fHRoaXMucmVmcmFjdGlvblRleHR1cmUpJiZ0aGlzLl9lZmZlY3Quc2V0TWF0cml4KFwidmlld1wiLG8uZ2V0Vmlld01hdHJpeCgpKSxlLk1hdGVyaWFsSGVscGVyLkJpbmRGb2dQYXJhbWV0ZXJzKG8sbix0aGlzLl9lZmZlY3QpLGUuTWF0ZXJpYWxIZWxwZXIuQmluZExvZ0RlcHRoKHRoaXMuX2RlZmluZXMsdGhpcy5fZWZmZWN0LG8pKSxpLnByb3RvdHlwZS5iaW5kLmNhbGwodGhpcyx0LG4pfSxyLnByb3RvdHlwZS5nZXRBbmltYXRhYmxlcz1mdW5jdGlvbigpe3ZhciBlPVtdO3JldHVybiB0aGlzLmRpZmZ1c2VUZXh0dXJlJiZ0aGlzLmRpZmZ1c2VUZXh0dXJlLmFuaW1hdGlvbnMmJnRoaXMuZGlmZnVzZVRleHR1cmUuYW5pbWF0aW9ucy5sZW5ndGg+MCYmZS5wdXNoKHRoaXMuZGlmZnVzZVRleHR1cmUpLHRoaXMuYW1iaWVudFRleHR1cmUmJnRoaXMuYW1iaWVudFRleHR1cmUuYW5pbWF0aW9ucyYmdGhpcy5hbWJpZW50VGV4dHVyZS5hbmltYXRpb25zLmxlbmd0aD4wJiZlLnB1c2godGhpcy5hbWJpZW50VGV4dHVyZSksdGhpcy5vcGFjaXR5VGV4dHVyZSYmdGhpcy5vcGFjaXR5VGV4dHVyZS5hbmltYXRpb25zJiZ0aGlzLm9wYWNpdHlUZXh0dXJlLmFuaW1hdGlvbnMubGVuZ3RoPjAmJmUucHVzaCh0aGlzLm9wYWNpdHlUZXh0dXJlKSx0aGlzLnJlZmxlY3Rpb25UZXh0dXJlJiZ0aGlzLnJlZmxlY3Rpb25UZXh0dXJlLmFuaW1hdGlvbnMmJnRoaXMucmVmbGVjdGlvblRleHR1cmUuYW5pbWF0aW9ucy5sZW5ndGg+MCYmZS5wdXNoKHRoaXMucmVmbGVjdGlvblRleHR1cmUpLHRoaXMuZW1pc3NpdmVUZXh0dXJlJiZ0aGlzLmVtaXNzaXZlVGV4dHVyZS5hbmltYXRpb25zJiZ0aGlzLmVtaXNzaXZlVGV4dHVyZS5hbmltYXRpb25zLmxlbmd0aD4wJiZlLnB1c2godGhpcy5lbWlzc2l2ZVRleHR1cmUpLHRoaXMuc3BlY3VsYXJUZXh0dXJlJiZ0aGlzLnNwZWN1bGFyVGV4dHVyZS5hbmltYXRpb25zJiZ0aGlzLnNwZWN1bGFyVGV4dHVyZS5hbmltYXRpb25zLmxlbmd0aD4wJiZlLnB1c2godGhpcy5zcGVjdWxhclRleHR1cmUpLHRoaXMuYnVtcFRleHR1cmUmJnRoaXMuYnVtcFRleHR1cmUuYW5pbWF0aW9ucyYmdGhpcy5idW1wVGV4dHVyZS5hbmltYXRpb25zLmxlbmd0aD4wJiZlLnB1c2godGhpcy5idW1wVGV4dHVyZSksdGhpcy5saWdodG1hcFRleHR1cmUmJnRoaXMubGlnaHRtYXBUZXh0dXJlLmFuaW1hdGlvbnMmJnRoaXMubGlnaHRtYXBUZXh0dXJlLmFuaW1hdGlvbnMubGVuZ3RoPjAmJmUucHVzaCh0aGlzLmxpZ2h0bWFwVGV4dHVyZSksdGhpcy5yZWZyYWN0aW9uVGV4dHVyZSYmdGhpcy5yZWZyYWN0aW9uVGV4dHVyZS5hbmltYXRpb25zJiZ0aGlzLnJlZnJhY3Rpb25UZXh0dXJlLmFuaW1hdGlvbnMubGVuZ3RoPjAmJmUucHVzaCh0aGlzLnJlZnJhY3Rpb25UZXh0dXJlKSxlfSxyLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKGUsdCl7dCYmKHRoaXMuZGlmZnVzZVRleHR1cmUmJnRoaXMuZGlmZnVzZVRleHR1cmUuZGlzcG9zZSgpLHRoaXMuYW1iaWVudFRleHR1cmUmJnRoaXMuYW1iaWVudFRleHR1cmUuZGlzcG9zZSgpLHRoaXMub3BhY2l0eVRleHR1cmUmJnRoaXMub3BhY2l0eVRleHR1cmUuZGlzcG9zZSgpLHRoaXMucmVmbGVjdGlvblRleHR1cmUmJnRoaXMucmVmbGVjdGlvblRleHR1cmUuZGlzcG9zZSgpLHRoaXMuZW1pc3NpdmVUZXh0dXJlJiZ0aGlzLmVtaXNzaXZlVGV4dHVyZS5kaXNwb3NlKCksdGhpcy5zcGVjdWxhclRleHR1cmUmJnRoaXMuc3BlY3VsYXJUZXh0dXJlLmRpc3Bvc2UoKSx0aGlzLmJ1bXBUZXh0dXJlJiZ0aGlzLmJ1bXBUZXh0dXJlLmRpc3Bvc2UoKSx0aGlzLmxpZ2h0bWFwVGV4dHVyZSYmdGhpcy5saWdodG1hcFRleHR1cmUuZGlzcG9zZSgpLHRoaXMucmVmcmFjdGlvblRleHR1cmUmJnRoaXMucmVmcmFjdGlvblRleHR1cmUuZGlzcG9zZSgpKSxpLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyxlLHQpfSxyLnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbih0KXt2YXIgaT10aGlzO3JldHVybiBlLlNlcmlhbGl6YXRpb25IZWxwZXIuQ2xvbmUoZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHIodCxpLmdldFNjZW5lKCkpfSx0aGlzKX0sci5wcm90b3R5cGUuc2VyaWFsaXplPWZ1bmN0aW9uKCl7cmV0dXJuIGUuU2VyaWFsaXphdGlvbkhlbHBlci5TZXJpYWxpemUodGhpcyl9LHIuUGFyc2U9ZnVuY3Rpb24odCxpLG4pe3JldHVybiBlLlNlcmlhbGl6YXRpb25IZWxwZXIuUGFyc2UoZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHIodC5uYW1lLGkpfSx0LGksbil9LHIuRGlmZnVzZVRleHR1cmVFbmFibGVkPSEwLHIuQW1iaWVudFRleHR1cmVFbmFibGVkPSEwLHIuT3BhY2l0eVRleHR1cmVFbmFibGVkPSEwLHIuUmVmbGVjdGlvblRleHR1cmVFbmFibGVkPSEwLHIuRW1pc3NpdmVUZXh0dXJlRW5hYmxlZD0hMCxyLlNwZWN1bGFyVGV4dHVyZUVuYWJsZWQ9ITAsci5CdW1wVGV4dHVyZUVuYWJsZWQ9ITAsci5GcmVzbmVsRW5hYmxlZD0hMCxyLkxpZ2h0bWFwVGV4dHVyZUVuYWJsZWQ9ITAsci5SZWZyYWN0aW9uVGV4dHVyZUVuYWJsZWQ9ITAsX19kZWNvcmF0ZShbZS5zZXJpYWxpemVBc1RleHR1cmUoKV0sci5wcm90b3R5cGUsXCJkaWZmdXNlVGV4dHVyZVwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemVBc1RleHR1cmUoKV0sci5wcm90b3R5cGUsXCJhbWJpZW50VGV4dHVyZVwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemVBc1RleHR1cmUoKV0sci5wcm90b3R5cGUsXCJvcGFjaXR5VGV4dHVyZVwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemVBc1RleHR1cmUoKV0sci5wcm90b3R5cGUsXCJyZWZsZWN0aW9uVGV4dHVyZVwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemVBc1RleHR1cmUoKV0sci5wcm90b3R5cGUsXCJlbWlzc2l2ZVRleHR1cmVcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplQXNUZXh0dXJlKCldLHIucHJvdG90eXBlLFwic3BlY3VsYXJUZXh0dXJlXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZUFzVGV4dHVyZSgpXSxyLnByb3RvdHlwZSxcImJ1bXBUZXh0dXJlXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZUFzVGV4dHVyZSgpXSxyLnByb3RvdHlwZSxcImxpZ2h0bWFwVGV4dHVyZVwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemVBc1RleHR1cmUoKV0sci5wcm90b3R5cGUsXCJyZWZyYWN0aW9uVGV4dHVyZVwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemVBc0NvbG9yMyhcImFtYmllbnRcIildLHIucHJvdG90eXBlLFwiYW1iaWVudENvbG9yXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZUFzQ29sb3IzKFwiZGlmZnVzZVwiKV0sci5wcm90b3R5cGUsXCJkaWZmdXNlQ29sb3JcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplQXNDb2xvcjMoXCJzcGVjdWxhclwiKV0sci5wcm90b3R5cGUsXCJzcGVjdWxhckNvbG9yXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZUFzQ29sb3IzKFwiZW1pc3NpdmVcIildLHIucHJvdG90eXBlLFwiZW1pc3NpdmVDb2xvclwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0sci5wcm90b3R5cGUsXCJzcGVjdWxhclBvd2VyXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSxyLnByb3RvdHlwZSxcInVzZUFscGhhRnJvbURpZmZ1c2VUZXh0dXJlXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSxyLnByb3RvdHlwZSxcInVzZUVtaXNzaXZlQXNJbGx1bWluYXRpb25cIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHIucHJvdG90eXBlLFwibGlua0VtaXNzaXZlV2l0aERpZmZ1c2VcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHIucHJvdG90eXBlLFwidXNlUmVmbGVjdGlvbkZyZXNuZWxGcm9tU3BlY3VsYXJcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHIucHJvdG90eXBlLFwidXNlU3BlY3VsYXJPdmVyQWxwaGFcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHIucHJvdG90eXBlLFwidXNlUmVmbGVjdGlvbk92ZXJBbHBoYVwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0sci5wcm90b3R5cGUsXCJkaXNhYmxlTGlnaHRpbmdcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHIucHJvdG90eXBlLFwidXNlUGFyYWxsYXhcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHIucHJvdG90eXBlLFwidXNlUGFyYWxsYXhPY2NsdXNpb25cIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHIucHJvdG90eXBlLFwicGFyYWxsYXhTY2FsZUJpYXNcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHIucHJvdG90eXBlLFwicm91Z2huZXNzXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSxyLnByb3RvdHlwZSxcImluZGV4T2ZSZWZyYWN0aW9uXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSxyLnByb3RvdHlwZSxcImludmVydFJlZnJhY3Rpb25ZXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSxyLnByb3RvdHlwZSxcInVzZUxpZ2h0bWFwQXNTaGFkb3dtYXBcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplQXNGcmVzbmVsUGFyYW1ldGVycygpXSxyLnByb3RvdHlwZSxcImRpZmZ1c2VGcmVzbmVsUGFyYW1ldGVyc1wiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemVBc0ZyZXNuZWxQYXJhbWV0ZXJzKCldLHIucHJvdG90eXBlLFwib3BhY2l0eUZyZXNuZWxQYXJhbWV0ZXJzXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZUFzRnJlc25lbFBhcmFtZXRlcnMoKV0sci5wcm90b3R5cGUsXCJyZWZsZWN0aW9uRnJlc25lbFBhcmFtZXRlcnNcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplQXNGcmVzbmVsUGFyYW1ldGVycygpXSxyLnByb3RvdHlwZSxcInJlZnJhY3Rpb25GcmVzbmVsUGFyYW1ldGVyc1wiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemVBc0ZyZXNuZWxQYXJhbWV0ZXJzKCldLHIucHJvdG90eXBlLFwiZW1pc3NpdmVGcmVzbmVsUGFyYW1ldGVyc1wiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0sci5wcm90b3R5cGUsXCJ1c2VHbG9zc2luZXNzRnJvbVNwZWN1bGFyTWFwQWxwaGFcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHIucHJvdG90eXBlLFwibWF4U2ltdWx0YW5lb3VzTGlnaHRzXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSxyLnByb3RvdHlwZSxcImludmVydE5vcm1hbE1hcFhcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHIucHJvdG90eXBlLFwiaW52ZXJ0Tm9ybWFsTWFwWVwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0sci5wcm90b3R5cGUsXCJ1c2VMb2dhcml0aG1pY0RlcHRoXCIsbnVsbCkscn0oZS5NYXRlcmlhbCk7ZS5TdGFuZGFyZE1hdGVyaWFsPWl9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGkoZSxpKXt0LmNhbGwodGhpcyxlLGksITApLHRoaXMuc3ViTWF0ZXJpYWxzPW5ldyBBcnJheSxpLm11bHRpTWF0ZXJpYWxzLnB1c2godGhpcyl9cmV0dXJuIF9fZXh0ZW5kcyhpLHQpLGkucHJvdG90eXBlLmdldFN1Yk1hdGVyaWFsPWZ1bmN0aW9uKGUpe3JldHVybiAwPmV8fGU+PXRoaXMuc3ViTWF0ZXJpYWxzLmxlbmd0aD90aGlzLmdldFNjZW5lKCkuZGVmYXVsdE1hdGVyaWFsOnRoaXMuc3ViTWF0ZXJpYWxzW2VdfSxpLnByb3RvdHlwZS5pc1JlYWR5PWZ1bmN0aW9uKGUpe2Zvcih2YXIgdD0wO3Q8dGhpcy5zdWJNYXRlcmlhbHMubGVuZ3RoO3QrKyl7dmFyIGk9dGhpcy5zdWJNYXRlcmlhbHNbdF07aWYoaSYmIXRoaXMuc3ViTWF0ZXJpYWxzW3RdLmlzUmVhZHkoZSkpcmV0dXJuITF9cmV0dXJuITB9LGkucHJvdG90eXBlLmNsb25lPWZ1bmN0aW9uKGUsdCl7Zm9yKHZhciByPW5ldyBpKGUsdGhpcy5nZXRTY2VuZSgpKSxuPTA7bjx0aGlzLnN1Yk1hdGVyaWFscy5sZW5ndGg7bisrKXt2YXIgbz1udWxsO289dD90aGlzLnN1Yk1hdGVyaWFsc1tuXS5jbG9uZShlK1wiLVwiK3RoaXMuc3ViTWF0ZXJpYWxzW25dLm5hbWUpOnRoaXMuc3ViTWF0ZXJpYWxzW25dLHIuc3ViTWF0ZXJpYWxzLnB1c2gobyl9cmV0dXJuIHJ9LGkucHJvdG90eXBlLnNlcmlhbGl6ZT1mdW5jdGlvbigpe3ZhciB0PXt9O3QubmFtZT10aGlzLm5hbWUsdC5pZD10aGlzLmlkLHQudGFncz1lLlRhZ3MuR2V0VGFncyh0aGlzKSx0Lm1hdGVyaWFscz1bXTtmb3IodmFyIGk9MDtpPHRoaXMuc3ViTWF0ZXJpYWxzLmxlbmd0aDtpKyspe3ZhciByPXRoaXMuc3ViTWF0ZXJpYWxzW2ldO3I/dC5tYXRlcmlhbHMucHVzaChyLmlkKTp0Lm1hdGVyaWFscy5wdXNoKG51bGwpfXJldHVybiB0fSxpfShlLk1hdGVyaWFsKTtlLk11bHRpTWF0ZXJpYWw9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KCl7fXJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIk5PX0xPR0dJTkdcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIDB9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJNSU5JTUFMX0xPR0dJTkdcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIDF9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJTVU1NQVJZX0xPR0dJTkdcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIDJ9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJERVRBSUxFRF9MT0dHSU5HXCIse2dldDpmdW5jdGlvbigpe3JldHVybiAzfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiRm9yY2VGdWxsU2NlbmVMb2FkaW5nRm9ySW5jcmVtZW50YWxcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHQuX0ZvcmNlRnVsbFNjZW5lTG9hZGluZ0ZvckluY3JlbWVudGFsfSxzZXQ6ZnVuY3Rpb24oZSl7dC5fRm9yY2VGdWxsU2NlbmVMb2FkaW5nRm9ySW5jcmVtZW50YWw9ZX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIlNob3dMb2FkaW5nU2NyZWVuXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0Ll9TaG93TG9hZGluZ1NjcmVlbn0sc2V0OmZ1bmN0aW9uKGUpe3QuX1Nob3dMb2FkaW5nU2NyZWVuPWV9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJsb2dnaW5nTGV2ZWxcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHQuX2xvZ2dpbmdMZXZlbH0sc2V0OmZ1bmN0aW9uKGUpe3QuX2xvZ2dpbmdMZXZlbD1lfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLHQuX2dldFBsdWdpbkZvckZpbGVuYW1lPWZ1bmN0aW9uKGUpe3ZhciB0PWUubGFzdEluZGV4T2YoXCIuXCIpLGk9ZS5pbmRleE9mKFwiP1wiKTstMT09PWkmJihpPWUubGVuZ3RoKTtmb3IodmFyIHI9ZS5zdWJzdHJpbmcodCxpKS50b0xvd2VyQ2FzZSgpLG49MDtuPHRoaXMuX3JlZ2lzdGVyZWRQbHVnaW5zLmxlbmd0aDtuKyspe3ZhciBvPXRoaXMuX3JlZ2lzdGVyZWRQbHVnaW5zW25dO2lmKC0xIT09by5leHRlbnNpb25zLmluZGV4T2YocikpcmV0dXJuIG99cmV0dXJuIHRoaXMuX3JlZ2lzdGVyZWRQbHVnaW5zWzBdfSx0LkdldFBsdWdpbkZvckV4dGVuc2lvbj1mdW5jdGlvbihlKXtmb3IodmFyIHQ9MDt0PHRoaXMuX3JlZ2lzdGVyZWRQbHVnaW5zLmxlbmd0aDt0Kyspe3ZhciBpPXRoaXMuX3JlZ2lzdGVyZWRQbHVnaW5zW3RdO2lmKC0xIT09aS5leHRlbnNpb25zLmluZGV4T2YoZSkpcmV0dXJuIGl9cmV0dXJuIG51bGx9LHQuUmVnaXN0ZXJQbHVnaW49ZnVuY3Rpb24oZSl7ZS5leHRlbnNpb25zPWUuZXh0ZW5zaW9ucy50b0xvd2VyQ2FzZSgpLHQuX3JlZ2lzdGVyZWRQbHVnaW5zLnB1c2goZSl9LHQuSW1wb3J0TWVzaD1mdW5jdGlvbihpLHIsbixvLHMsYSxoKXtpZihuLnN1YnN0ciYmXCIvXCI9PT1uLnN1YnN0cigwLDEpKXJldHVybiB2b2lkIGUuVG9vbHMuRXJyb3IoXCJXcm9uZyBzY2VuZUZpbGVuYW1lIHBhcmFtZXRlclwiKTtpZihuLnN1YnN0ciYmXCIvXCI9PT1uLnN1YnN0cigwLDEpKXJldHVybiB2b2lkIGUuVG9vbHMuRXJyb3IoXCJXcm9uZyBzY2VuZUZpbGVuYW1lIHBhcmFtZXRlclwiKTt2YXIgYz17fTtvLl9hZGRQZW5kaW5nRGF0YShjKTt2YXIgbD1mdW5jdGlvbihsKXtvLmRhdGFiYXNlPXU7dmFyIGY9dC5fZ2V0UGx1Z2luRm9yRmlsZW5hbWUobiksZD1mdW5jdGlvbihlKXt2YXIgdD1bXSxhPVtdLGw9W107dHJ5e2lmKGYuaW1wb3J0TWVzaCl7dmFyIHU9ZjtpZighdS5pbXBvcnRNZXNoKGksbyxlLHIsdCxhLGwpKXJldHVybiBoJiZoKG8sXCJVbmFibGUgdG8gaW1wb3J0IG1lc2hlcyBmcm9tIFwiK3Irbiksdm9pZCBvLl9yZW1vdmVQZW5kaW5nRGF0YShjKTtzJiYoby5pbXBvcnRlZE1lc2hlc0ZpbGVzLnB1c2gocituKSxzKHQsYSxsKSxvLl9yZW1vdmVQZW5kaW5nRGF0YShjKSl9ZWxzZXt2YXIgZD1mO2QuaW1wb3J0TWVzaEFzeW5jKGksbyxlLHIsZnVuY3Rpb24oZSx0LGkpe3MmJihvLmltcG9ydGVkTWVzaGVzRmlsZXMucHVzaChyK24pLHMoZSx0LGkpLG8uX3JlbW92ZVBlbmRpbmdEYXRhKGMpKX0sZnVuY3Rpb24oKXtoJiZoKG8sXCJVbmFibGUgdG8gaW1wb3J0IG1lc2hlcyBmcm9tIFwiK3Irbiksby5fcmVtb3ZlUGVuZGluZ0RhdGEoYyl9KX19Y2F0Y2gocCl7aCYmaChvLFwiVW5hYmxlIHRvIGltcG9ydCBtZXNoZXMgZnJvbSBcIityK24scCksby5fcmVtb3ZlUGVuZGluZ0RhdGEoYyl9fTtyZXR1cm4gbi5zdWJzdHImJlwiZGF0YTpcIj09PW4uc3Vic3RyKDAsNSk/dm9pZCBkKG4uc3Vic3RyKDUpKTp2b2lkIGUuVG9vbHMuTG9hZEZpbGUocituLGZ1bmN0aW9uKGUpe2QoZSl9LGEsdSl9O2lmKCFvLmdldEVuZ2luZSgpLmVuYWJsZU9mZmxpbmVTdXBwb3J0fHxuLnN1YnN0ciYmXCJkYXRhOlwiPT09bi5zdWJzdHIoMCw1KSlsKCEwKTtlbHNlIHZhciB1PW5ldyBlLkRhdGFiYXNlKHIrbixsKX0sdC5Mb2FkPWZ1bmN0aW9uKGkscixuLG8scyxhKXt0LkFwcGVuZChpLHIsbmV3IGUuU2NlbmUobiksbyxzLGEpfSx0LkFwcGVuZD1mdW5jdGlvbihpLHIsbixvLHMsYSl7aWYoci5zdWJzdHImJlwiL1wiPT09ci5zdWJzdHIoMCwxKSlyZXR1cm4gdm9pZCBlLlRvb2xzLkVycm9yKFwiV3Jvbmcgc2NlbmVGaWxlbmFtZSBwYXJhbWV0ZXJcIik7dmFyIGgsYz10aGlzLl9nZXRQbHVnaW5Gb3JGaWxlbmFtZShyLm5hbWV8fHIpLGw9e307bi5fYWRkUGVuZGluZ0RhdGEobCksdC5TaG93TG9hZGluZ1NjcmVlbiYmbi5nZXRFbmdpbmUoKS5kaXNwbGF5TG9hZGluZ1VJKCk7dmFyIHU9ZnVuY3Rpb24oZSl7aWYobi5kYXRhYmFzZT1oLGMubG9hZCl7dmFyIHI9YztpZighci5sb2FkKG4sZSxpKSlyZXR1cm4gYSYmYShuKSxuLl9yZW1vdmVQZW5kaW5nRGF0YShsKSx2b2lkIG4uZ2V0RW5naW5lKCkuaGlkZUxvYWRpbmdVSSgpO28mJm8obiksbi5fcmVtb3ZlUGVuZGluZ0RhdGEobCl9ZWxzZXt2YXIgcz1jO3MubG9hZEFzeW5jKG4sZSxpLGZ1bmN0aW9uKCl7byYmbyhuKX0sZnVuY3Rpb24oKXthJiZhKG4pLG4uX3JlbW92ZVBlbmRpbmdEYXRhKGwpLG4uZ2V0RW5naW5lKCkuaGlkZUxvYWRpbmdVSSgpfSl9dC5TaG93TG9hZGluZ1NjcmVlbiYmbi5leGVjdXRlV2hlblJlYWR5KGZ1bmN0aW9uKCl7bi5nZXRFbmdpbmUoKS5oaWRlTG9hZGluZ1VJKCl9KX0sZj1mdW5jdGlvbih0KXtlLlRvb2xzLkxvYWRGaWxlKGkrcix1LHMsaCl9O3JldHVybiByLnN1YnN0ciYmXCJkYXRhOlwiPT09ci5zdWJzdHIoMCw1KT92b2lkIHUoci5zdWJzdHIoNSkpOnZvaWQoLTE9PT1pLmluZGV4T2YoXCJmaWxlOlwiKT9uLmdldEVuZ2luZSgpLmVuYWJsZU9mZmxpbmVTdXBwb3J0P2g9bmV3IGUuRGF0YWJhc2UoaStyLGYpOmYoITApOmUuVG9vbHMuUmVhZEZpbGUocix1LHMpKX0sdC5fRm9yY2VGdWxsU2NlbmVMb2FkaW5nRm9ySW5jcmVtZW50YWw9ITEsdC5fU2hvd0xvYWRpbmdTY3JlZW49ITAsdC5fbG9nZ2luZ0xldmVsPXQuTk9fTE9HR0lORyx0Ll9yZWdpc3RlcmVkUGx1Z2lucz1uZXcgQXJyYXksdH0oKTtlLlNjZW5lTG9hZGVyPXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0OyFmdW5jdGlvbih0KXt2YXIgaT1mdW5jdGlvbih0LGkscixuKXtmb3IodmFyIG89MCxzPWkubWF0ZXJpYWxzLmxlbmd0aDtzPm87bysrKXt2YXIgYT1pLm1hdGVyaWFsc1tvXTtpZihhLmlkPT09dClyZXR1cm4gZS5NYXRlcmlhbC5QYXJzZShhLHIsbil9cmV0dXJuIG51bGx9LHI9ZnVuY3Rpb24oZSx0LGkpe3Q9dCBpbnN0YW5jZW9mIEFycmF5P3Q6W3RdO2Zvcih2YXIgciBpbiB0KWlmKGUubmFtZT09PXRbcl0pcmV0dXJuIGkucHVzaChlLmlkKSwhMDtyZXR1cm4gZS5wYXJlbnRJZCYmLTEhPT1pLmluZGV4T2YoZS5wYXJlbnRJZCk/KGkucHVzaChlLmlkKSwhMCk6ITF9LG49ZnVuY3Rpb24oZSx0KXtyZXR1cm4gZStcIiBvZiBcIisodD90LmZpbGUrXCIgZnJvbSBcIit0Lm5hbWUrXCIgdmVyc2lvbjogXCIrdC52ZXJzaW9uK1wiLCBleHBvcnRlciB2ZXJzaW9uOiBcIit0LmV4cG9ydGVyX3ZlcnNpb246XCJ1bmtub3duXCIpfTtlLlNjZW5lTG9hZGVyLlJlZ2lzdGVyUGx1Z2luKHtleHRlbnNpb25zOlwiLmJhYnlsb25cIixpbXBvcnRNZXNoOmZ1bmN0aW9uKHQsbyxzLGEsaCxjLGwpe3ZhciB1PVwiaW1wb3J0TWVzaCBoYXMgZmFpbGVkIEpTT04gcGFyc2VcIjt0cnl7dmFyIGY9SlNPTi5wYXJzZShzKTt1PVwiXCI7dmFyIGQscCxfPWUuU2NlbmVMb2FkZXIubG9nZ2luZ0xldmVsPT09ZS5TY2VuZUxvYWRlci5ERVRBSUxFRF9MT0dHSU5HLG09W10sZz1bXSx2PVtdO2ZvcihkPTAscD1mLm1lc2hlcy5sZW5ndGg7cD5kO2QrKyl7dmFyIHk9Zi5tZXNoZXNbZF07aWYoIXR8fHIoeSx0LHYpKXtpZih0IGluc3RhbmNlb2YgQXJyYXkmJmRlbGV0ZSB0W3QuaW5kZXhPZih5Lm5hbWUpXSx5Lmdlb21ldHJ5SWQmJmYuZ2VvbWV0cmllcyl7dmFyIHg9ITE7W1wiYm94ZXNcIixcInNwaGVyZXNcIixcImN5bGluZGVyc1wiLFwidG9ydXNlc1wiLFwiZ3JvdW5kc1wiLFwicGxhbmVzXCIsXCJ0b3J1c0tub3RzXCIsXCJ2ZXJ0ZXhEYXRhXCJdLmZvckVhY2goZnVuY3Rpb24odCl7IXgmJmYuZ2VvbWV0cmllc1t0XSYmZi5nZW9tZXRyaWVzW3RdaW5zdGFuY2VvZiBBcnJheSYmZi5nZW9tZXRyaWVzW3RdLmZvckVhY2goZnVuY3Rpb24oaSl7aWYoaS5pZD09PXkuZ2VvbWV0cnlJZCl7c3dpdGNoKHQpe2Nhc2VcImJveGVzXCI6ZS5HZW9tZXRyeS5QcmltaXRpdmVzLkJveC5QYXJzZShpLG8pO2JyZWFrO2Nhc2VcInNwaGVyZXNcIjplLkdlb21ldHJ5LlByaW1pdGl2ZXMuU3BoZXJlLlBhcnNlKGksbyk7YnJlYWs7Y2FzZVwiY3lsaW5kZXJzXCI6ZS5HZW9tZXRyeS5QcmltaXRpdmVzLkN5bGluZGVyLlBhcnNlKGksbyk7YnJlYWs7Y2FzZVwidG9ydXNlc1wiOmUuR2VvbWV0cnkuUHJpbWl0aXZlcy5Ub3J1cy5QYXJzZShpLG8pO2JyZWFrO2Nhc2VcImdyb3VuZHNcIjplLkdlb21ldHJ5LlByaW1pdGl2ZXMuR3JvdW5kLlBhcnNlKGksbyk7YnJlYWs7Y2FzZVwicGxhbmVzXCI6ZS5HZW9tZXRyeS5QcmltaXRpdmVzLlBsYW5lLlBhcnNlKGksbyk7YnJlYWs7Y2FzZVwidG9ydXNLbm90c1wiOmUuR2VvbWV0cnkuUHJpbWl0aXZlcy5Ub3J1c0tub3QuUGFyc2UoaSxvKTticmVhaztjYXNlXCJ2ZXJ0ZXhEYXRhXCI6ZS5HZW9tZXRyeS5QYXJzZShpLG8sYSl9eD0hMH19KX0pLHh8fGUuVG9vbHMuV2FybihcIkdlb21ldHJ5IG5vdCBmb3VuZCBmb3IgbWVzaCBcIit5LmlkKX1pZih5Lm1hdGVyaWFsSWQpe3ZhciBiPS0xIT09Zy5pbmRleE9mKHkubWF0ZXJpYWxJZCk7aWYoIWImJmYubXVsdGlNYXRlcmlhbHMpZm9yKHZhciBQPTAsQT1mLm11bHRpTWF0ZXJpYWxzLmxlbmd0aDtBPlA7UCsrKXt2YXIgVD1mLm11bHRpTWF0ZXJpYWxzW1BdO2lmKFQuaWQ9PT15Lm1hdGVyaWFsSWQpe2Zvcih2YXIgRT0wLEM9VC5tYXRlcmlhbHMubGVuZ3RoO0M+RTtFKyspe3ZhciBTPVQubWF0ZXJpYWxzW0VdO2cucHVzaChTKTt2YXIgTT1pKFMsZixvLGEpO3UrPVwiXFxuXHRNYXRlcmlhbCBcIitNLnRvU3RyaW5nKF8pfWcucHVzaChULmlkKTt2YXIgST1lLk1hdGVyaWFsLlBhcnNlTXVsdGlNYXRlcmlhbChULG8pO2I9ITAsdSs9XCJcXG5cdE11bHRpLU1hdGVyaWFsIFwiK0kudG9TdHJpbmcoXyk7YnJlYWt9fWlmKCFiKXtnLnB1c2goeS5tYXRlcmlhbElkKTt2YXIgTT1pKHkubWF0ZXJpYWxJZCxmLG8sYSk7TT91Kz1cIlxcblx0TWF0ZXJpYWwgXCIrTS50b1N0cmluZyhfKTplLlRvb2xzLldhcm4oXCJNYXRlcmlhbCBub3QgZm91bmQgZm9yIG1lc2ggXCIreS5pZCl9fWlmKHkuc2tlbGV0b25JZD4tMSYmby5za2VsZXRvbnMpe3ZhciBEPW0uaW5kZXhPZih5LnNrZWxldG9uSWQpPi0xO2lmKCFEKWZvcih2YXIgUj0wLE89Zi5za2VsZXRvbnMubGVuZ3RoO08+UjtSKyspe3ZhciB3PWYuc2tlbGV0b25zW1JdO2lmKHcuaWQ9PT15LnNrZWxldG9uSWQpe3ZhciBMPWUuU2tlbGV0b24uUGFyc2UodyxvKTtsLnB1c2goTCksbS5wdXNoKHcuaWQpLHUrPVwiXFxuXHRTa2VsZXRvbiBcIitMLnRvU3RyaW5nKF8pfX19dmFyIEI9ZS5NZXNoLlBhcnNlKHksbyxhKTtoLnB1c2goQiksdSs9XCJcXG5cdE1lc2ggXCIrQi50b1N0cmluZyhfKX19dmFyIFY7Zm9yKGQ9MCxwPW8ubWVzaGVzLmxlbmd0aDtwPmQ7ZCsrKVY9by5tZXNoZXNbZF0sVi5fd2FpdGluZ1BhcmVudElkJiYoVi5wYXJlbnQ9by5nZXRMYXN0RW50cnlCeUlEKFYuX3dhaXRpbmdQYXJlbnRJZCksVi5fd2FpdGluZ1BhcmVudElkPXZvaWQgMCk7Zm9yKGQ9MCxwPW8ubWVzaGVzLmxlbmd0aDtwPmQ7ZCsrKVY9by5tZXNoZXNbZF0sVi5fd2FpdGluZ0ZyZWV6ZVdvcmxkTWF0cml4PyhWLmZyZWV6ZVdvcmxkTWF0cml4KCksVi5fd2FpdGluZ0ZyZWV6ZVdvcmxkTWF0cml4PXZvaWQgMCk6Vi5jb21wdXRlV29ybGRNYXRyaXgoITApO2lmKGYucGFydGljbGVTeXN0ZW1zKWZvcihkPTAscD1mLnBhcnRpY2xlU3lzdGVtcy5sZW5ndGg7cD5kO2QrKyl7dmFyIEY9Zi5wYXJ0aWNsZVN5c3RlbXNbZF07LTEhPT12LmluZGV4T2YoRi5lbWl0dGVySWQpJiZjLnB1c2goZS5QYXJ0aWNsZVN5c3RlbS5QYXJzZShGLG8sYSkpfXJldHVybiEwfWNhdGNoKE4pe3Rocm93IGUuVG9vbHMuTG9nKG4oXCJpbXBvcnRNZXNoXCIsZi5wcm9kdWNlcikrdSksdT1udWxsLE59ZmluYWxseXtudWxsIT09dSYmZS5TY2VuZUxvYWRlci5sb2dnaW5nTGV2ZWwhPT1lLlNjZW5lTG9hZGVyLk5PX0xPR0dJTkcmJmUuVG9vbHMuTG9nKG4oXCJpbXBvcnRNZXNoXCIsZi5wcm9kdWNlcikrKGUuU2NlbmVMb2FkZXIubG9nZ2luZ0xldmVsIT09ZS5TY2VuZUxvYWRlci5NSU5JTUFMX0xPR0dJTkc/dTpcIlwiKSl9fSxsb2FkOmZ1bmN0aW9uKHQsaSxyKXt2YXIgbz1cImltcG9ydFNjZW5lIGhhcyBmYWlsZWQgSlNPTiBwYXJzZVwiO3RyeXt2YXIgcz1KU09OLnBhcnNlKGkpO289XCJcIjt2YXIgYT1lLlNjZW5lTG9hZGVyLmxvZ2dpbmdMZXZlbD09PWUuU2NlbmVMb2FkZXIuREVUQUlMRURfTE9HR0lORztpZih0LnVzZURlbGF5ZWRUZXh0dXJlTG9hZGluZz1zLnVzZURlbGF5ZWRUZXh0dXJlTG9hZGluZyYmIWUuU2NlbmVMb2FkZXIuRm9yY2VGdWxsU2NlbmVMb2FkaW5nRm9ySW5jcmVtZW50YWwsdC5hdXRvQ2xlYXI9cy5hdXRvQ2xlYXIsdC5jbGVhckNvbG9yPWUuQ29sb3I0LkZyb21BcnJheShzLmNsZWFyQ29sb3IpLHQuYW1iaWVudENvbG9yPWUuQ29sb3IzLkZyb21BcnJheShzLmFtYmllbnRDb2xvcikscy5ncmF2aXR5JiYodC5ncmF2aXR5PWUuVmVjdG9yMy5Gcm9tQXJyYXkocy5ncmF2aXR5KSkscy5mb2dNb2RlJiYwIT09cy5mb2dNb2RlKXN3aXRjaCh0LmZvZ01vZGU9cy5mb2dNb2RlLHQuZm9nQ29sb3I9ZS5Db2xvcjMuRnJvbUFycmF5KHMuZm9nQ29sb3IpLHQuZm9nU3RhcnQ9cy5mb2dTdGFydCx0LmZvZ0VuZD1zLmZvZ0VuZCx0LmZvZ0RlbnNpdHk9cy5mb2dEZW5zaXR5LG8rPVwiXHRGb2cgbW9kZSBmb3Igc2NlbmU6ICBcIix0LmZvZ01vZGUpe2Nhc2UgMTpvKz1cImV4cFxcblwiO2JyZWFrO2Nhc2UgMjpvKz1cImV4cDJcXG5cIjticmVhaztjYXNlIDM6bys9XCJsaW5lYXJcXG5cIn1pZihzLnBoeXNpY3NFbmFibGVkKXt2YXIgaDtcImNhbm5vblwiPT09cy5waHlzaWNzRW5naW5lP2g9bmV3IGUuQ2Fubm9uSlNQbHVnaW46XCJvaW1vXCI9PT1zLnBoeXNpY3NFbmdpbmUmJihoPW5ldyBlLk9pbW9KU1BsdWdpbiksbz1cIlx0UGh5c2ljcyBlbmdpbmUgXCIrKHMucGh5c2ljc0VuZ2luZT9zLnBoeXNpY3NFbmdpbmU6XCJvaW1vXCIpK1wiIGVuYWJsZWRcXG5cIjt2YXIgYz1zLnBoeXNpY3NHcmF2aXR5P2UuVmVjdG9yMy5Gcm9tQXJyYXkocy5waHlzaWNzR3Jhdml0eSk6bnVsbDt0LmVuYWJsZVBoeXNpY3MoYyxoKX12b2lkIDAhPXMuY29sbGlzaW9uc0VuYWJsZWQmJih0LmNvbGxpc2lvbnNFbmFibGVkPXMuY29sbGlzaW9uc0VuYWJsZWQpLHQud29ya2VyQ29sbGlzaW9ucz0hIXMud29ya2VyQ29sbGlzaW9uczt2YXIgbCx1O2ZvcihsPTAsdT1zLmxpZ2h0cy5sZW5ndGg7dT5sO2wrKyl7dmFyIGY9cy5saWdodHNbbF0sZD1lLkxpZ2h0LlBhcnNlKGYsdCk7bys9MD09PWw/XCJcXG5cdExpZ2h0czpcIjpcIlwiLG8rPVwiXFxuXHRcdFwiK2QudG9TdHJpbmcoYSl9aWYocy5hbmltYXRpb25zKWZvcihsPTAsdT1zLmFuaW1hdGlvbnMubGVuZ3RoO3U+bDtsKyspe3ZhciBwPXMuYW5pbWF0aW9uc1tsXSxfPWUuQW5pbWF0aW9uLlBhcnNlKHApO1xudC5hbmltYXRpb25zLnB1c2goXyksbys9MD09PWw/XCJcXG5cdEFuaW1hdGlvbnM6XCI6XCJcIixvKz1cIlxcblx0XHRcIitfLnRvU3RyaW5nKGEpfWlmKHMuYXV0b0FuaW1hdGUmJnQuYmVnaW5BbmltYXRpb24odCxzLmF1dG9BbmltYXRlRnJvbSxzLmF1dG9BbmltYXRlVG8scy5hdXRvQW5pbWF0ZUxvb3Ascy5hdXRvQW5pbWF0ZVNwZWVkfHwxKSxzLm1hdGVyaWFscylmb3IobD0wLHU9cy5tYXRlcmlhbHMubGVuZ3RoO3U+bDtsKyspe3ZhciBtPXMubWF0ZXJpYWxzW2xdLGc9ZS5NYXRlcmlhbC5QYXJzZShtLHQscik7bys9MD09PWw/XCJcXG5cdE1hdGVyaWFsczpcIjpcIlwiLG8rPVwiXFxuXHRcdFwiK2cudG9TdHJpbmcoYSl9aWYocy5tdWx0aU1hdGVyaWFscylmb3IobD0wLHU9cy5tdWx0aU1hdGVyaWFscy5sZW5ndGg7dT5sO2wrKyl7dmFyIHY9cy5tdWx0aU1hdGVyaWFsc1tsXSx5PWUuTWF0ZXJpYWwuUGFyc2VNdWx0aU1hdGVyaWFsKHYsdCk7bys9MD09PWw/XCJcXG5cdE11bHRpTWF0ZXJpYWxzOlwiOlwiXCIsbys9XCJcXG5cdFx0XCIreS50b1N0cmluZyhhKX1pZihzLnNrZWxldG9ucylmb3IobD0wLHU9cy5za2VsZXRvbnMubGVuZ3RoO3U+bDtsKyspe3ZhciB4PXMuc2tlbGV0b25zW2xdLGI9ZS5Ta2VsZXRvbi5QYXJzZSh4LHQpO28rPTA9PT1sP1wiXFxuXHRTa2VsZXRvbnM6XCI6XCJcIixvKz1cIlxcblx0XHRcIitiLnRvU3RyaW5nKGEpfXZhciBQPXMuZ2VvbWV0cmllcztpZihQKXt2YXIgQT1QLmJveGVzO2lmKEEpZm9yKGw9MCx1PUEubGVuZ3RoO3U+bDtsKyspe3ZhciBUPUFbbF07ZS5HZW9tZXRyeS5QcmltaXRpdmVzLkJveC5QYXJzZShULHQpfXZhciBFPVAuc3BoZXJlcztpZihFKWZvcihsPTAsdT1FLmxlbmd0aDt1Pmw7bCsrKXt2YXIgQz1FW2xdO2UuR2VvbWV0cnkuUHJpbWl0aXZlcy5TcGhlcmUuUGFyc2UoQyx0KX12YXIgUz1QLmN5bGluZGVycztpZihTKWZvcihsPTAsdT1TLmxlbmd0aDt1Pmw7bCsrKXt2YXIgTT1TW2xdO2UuR2VvbWV0cnkuUHJpbWl0aXZlcy5DeWxpbmRlci5QYXJzZShNLHQpfXZhciBJPVAudG9ydXNlcztpZihJKWZvcihsPTAsdT1JLmxlbmd0aDt1Pmw7bCsrKXt2YXIgRD1JW2xdO2UuR2VvbWV0cnkuUHJpbWl0aXZlcy5Ub3J1cy5QYXJzZShELHQpfXZhciBSPVAuZ3JvdW5kcztpZihSKWZvcihsPTAsdT1SLmxlbmd0aDt1Pmw7bCsrKXt2YXIgTz1SW2xdO2UuR2VvbWV0cnkuUHJpbWl0aXZlcy5Hcm91bmQuUGFyc2UoTyx0KX12YXIgdz1QLnBsYW5lcztpZih3KWZvcihsPTAsdT13Lmxlbmd0aDt1Pmw7bCsrKXt2YXIgTD13W2xdO2UuR2VvbWV0cnkuUHJpbWl0aXZlcy5QbGFuZS5QYXJzZShMLHQpfXZhciBCPVAudG9ydXNLbm90cztpZihCKWZvcihsPTAsdT1CLmxlbmd0aDt1Pmw7bCsrKXt2YXIgVj1CW2xdO2UuR2VvbWV0cnkuUHJpbWl0aXZlcy5Ub3J1c0tub3QuUGFyc2UoVix0KX12YXIgRj1QLnZlcnRleERhdGE7aWYoRilmb3IobD0wLHU9Ri5sZW5ndGg7dT5sO2wrKyl7dmFyIE49RltsXTtlLkdlb21ldHJ5LlBhcnNlKE4sdCxyKX19Zm9yKGw9MCx1PXMubWVzaGVzLmxlbmd0aDt1Pmw7bCsrKXt2YXIgej1zLm1lc2hlc1tsXSxrPWUuTWVzaC5QYXJzZSh6LHQscik7bys9MD09PWw/XCJcXG5cdE1lc2hlczpcIjpcIlwiLG8rPVwiXFxuXHRcdFwiK2sudG9TdHJpbmcoYSl9Zm9yKGw9MCx1PXMuY2FtZXJhcy5sZW5ndGg7dT5sO2wrKyl7dmFyIFU9cy5jYW1lcmFzW2xdLEc9ZS5DYW1lcmEuUGFyc2UoVSx0KTtvKz0wPT09bD9cIlxcblx0Q2FtZXJhczpcIjpcIlwiLG8rPVwiXFxuXHRcdFwiK0cudG9TdHJpbmcoYSl9Zm9yKHMuYWN0aXZlQ2FtZXJhSUQmJnQuc2V0QWN0aXZlQ2FtZXJhQnlJRChzLmFjdGl2ZUNhbWVyYUlEKSxsPTAsdT10LmNhbWVyYXMubGVuZ3RoO3U+bDtsKyspe3ZhciBHPXQuY2FtZXJhc1tsXTtHLl93YWl0aW5nUGFyZW50SWQmJihHLnBhcmVudD10LmdldExhc3RFbnRyeUJ5SUQoRy5fd2FpdGluZ1BhcmVudElkKSxHLl93YWl0aW5nUGFyZW50SWQ9dm9pZCAwKX1mb3IobD0wLHU9dC5saWdodHMubGVuZ3RoO3U+bDtsKyspe3ZhciBkPXQubGlnaHRzW2xdO2QuX3dhaXRpbmdQYXJlbnRJZCYmKGQucGFyZW50PXQuZ2V0TGFzdEVudHJ5QnlJRChkLl93YWl0aW5nUGFyZW50SWQpLGQuX3dhaXRpbmdQYXJlbnRJZD12b2lkIDApfXZhciBXLFk9W107aWYoZS5BdWRpb0VuZ2luZSYmcy5zb3VuZHMpZm9yKGw9MCx1PXMuc291bmRzLmxlbmd0aDt1Pmw7bCsrKXt2YXIgSD1zLnNvdW5kc1tsXTtpZihlLkVuZ2luZS5hdWRpb0VuZ2luZS5jYW5Vc2VXZWJBdWRpbylILnVybHx8KEgudXJsPUgubmFtZSksWVtILnVybF0/ZS5Tb3VuZC5QYXJzZShILHQscixZW0gudXJsXSk6KFc9ZS5Tb3VuZC5QYXJzZShILHQsciksWVtILnVybF09Vyk7ZWxzZXtuZXcgZS5Tb3VuZChILm5hbWUsbnVsbCx0KX19Zm9yKFk9W10sbD0wLHU9dC5tZXNoZXMubGVuZ3RoO3U+bDtsKyspe3ZhciBrPXQubWVzaGVzW2xdO2suX3dhaXRpbmdQYXJlbnRJZCYmKGsucGFyZW50PXQuZ2V0TGFzdEVudHJ5QnlJRChrLl93YWl0aW5nUGFyZW50SWQpLGsuX3dhaXRpbmdQYXJlbnRJZD12b2lkIDApLGsuX3dhaXRpbmdBY3Rpb25zJiYoZS5BY3Rpb25NYW5hZ2VyLlBhcnNlKGsuX3dhaXRpbmdBY3Rpb25zLGssdCksay5fd2FpdGluZ0FjdGlvbnM9dm9pZCAwKX1mb3IobD0wLHU9dC5tZXNoZXMubGVuZ3RoO3U+bDtsKyspe3ZhciBqPXQubWVzaGVzW2xdO2ouX3dhaXRpbmdGcmVlemVXb3JsZE1hdHJpeD8oai5mcmVlemVXb3JsZE1hdHJpeCgpLGouX3dhaXRpbmdGcmVlemVXb3JsZE1hdHJpeD12b2lkIDApOmouY29tcHV0ZVdvcmxkTWF0cml4KCEwKX1pZihzLnBhcnRpY2xlU3lzdGVtcylmb3IobD0wLHU9cy5wYXJ0aWNsZVN5c3RlbXMubGVuZ3RoO3U+bDtsKyspe3ZhciBYPXMucGFydGljbGVTeXN0ZW1zW2xdO2UuUGFydGljbGVTeXN0ZW0uUGFyc2UoWCx0LHIpfWlmKHMubGVuc0ZsYXJlU3lzdGVtcylmb3IobD0wLHU9cy5sZW5zRmxhcmVTeXN0ZW1zLmxlbmd0aDt1Pmw7bCsrKXt2YXIgSz1zLmxlbnNGbGFyZVN5c3RlbXNbbF07ZS5MZW5zRmxhcmVTeXN0ZW0uUGFyc2UoSyx0LHIpfWlmKHMuc2hhZG93R2VuZXJhdG9ycylmb3IobD0wLHU9cy5zaGFkb3dHZW5lcmF0b3JzLmxlbmd0aDt1Pmw7bCsrKXt2YXIgWj1zLnNoYWRvd0dlbmVyYXRvcnNbbF07ZS5TaGFkb3dHZW5lcmF0b3IuUGFyc2UoWix0KX1yZXR1cm4gcy5hY3Rpb25zJiZlLkFjdGlvbk1hbmFnZXIuUGFyc2Uocy5hY3Rpb25zLG51bGwsdCksITB9Y2F0Y2gocSl7dGhyb3cgZS5Ub29scy5Mb2cobihcImltcG9ydFNjZW5lXCIscy5wcm9kdWNlcikrbyksbz1udWxsLHF9ZmluYWxseXtudWxsIT09byYmZS5TY2VuZUxvYWRlci5sb2dnaW5nTGV2ZWwhPT1lLlNjZW5lTG9hZGVyLk5PX0xPR0dJTkcmJmUuVG9vbHMuTG9nKG4oXCJpbXBvcnRTY2VuZVwiLHMucHJvZHVjZXIpKyhlLlNjZW5lTG9hZGVyLmxvZ2dpbmdMZXZlbCE9PWUuU2NlbmVMb2FkZXIuTUlOSU1BTF9MT0dHSU5HP286XCJcIikpfX19KX0odD1lLkludGVybmFsc3x8KGUuSW50ZXJuYWxzPXt9KSl9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGkscixuLG8scyxhKXt2b2lkIDA9PT1hJiYoYT1lLlRleHR1cmUuVFJJTElORUFSX1NBTVBMSU5HTU9ERSksdGhpcy5uYW1lPXQsdGhpcy5jZWxsU2l6ZT1uLHRoaXMuc3ByaXRlcz1uZXcgQXJyYXksdGhpcy5yZW5kZXJpbmdHcm91cElkPTAsdGhpcy5sYXllck1hc2s9MjY4NDM1NDU1LHRoaXMuZm9nRW5hYmxlZD0hMCx0aGlzLmlzUGlja2FibGU9ITEsdGhpcy5vbkRpc3Bvc2VPYnNlcnZhYmxlPW5ldyBlLk9ic2VydmFibGUsdGhpcy5fdmVydGV4QnVmZmVycz17fSx0aGlzLl9jYXBhY2l0eT1yLHRoaXMuX3Nwcml0ZVRleHR1cmU9bmV3IGUuVGV4dHVyZShpLG8sITAsITEsYSksdGhpcy5fc3ByaXRlVGV4dHVyZS53cmFwVT1lLlRleHR1cmUuQ0xBTVBfQUREUkVTU01PREUsdGhpcy5fc3ByaXRlVGV4dHVyZS53cmFwVj1lLlRleHR1cmUuQ0xBTVBfQUREUkVTU01PREUsdGhpcy5fZXBzaWxvbj12b2lkIDA9PT1zPy4wMTpzLHRoaXMuX3NjZW5lPW8sdGhpcy5fc2NlbmUuc3ByaXRlTWFuYWdlcnMucHVzaCh0aGlzKTtmb3IodmFyIGg9W10sYz0wLGw9MDtyPmw7bCsrKWgucHVzaChjKSxoLnB1c2goYysxKSxoLnB1c2goYysyKSxoLnB1c2goYyksaC5wdXNoKGMrMiksaC5wdXNoKGMrMyksYys9NDt0aGlzLl9pbmRleEJ1ZmZlcj1vLmdldEVuZ2luZSgpLmNyZWF0ZUluZGV4QnVmZmVyKGgpLHRoaXMuX3ZlcnRleERhdGE9bmV3IEZsb2F0MzJBcnJheSgxNipyKjQpLHRoaXMuX2J1ZmZlcj1uZXcgZS5CdWZmZXIoby5nZXRFbmdpbmUoKSx0aGlzLl92ZXJ0ZXhEYXRhLCEwLDE2KTt2YXIgdT10aGlzLl9idWZmZXIuY3JlYXRlVmVydGV4QnVmZmVyKGUuVmVydGV4QnVmZmVyLlBvc2l0aW9uS2luZCwwLDQpLGY9dGhpcy5fYnVmZmVyLmNyZWF0ZVZlcnRleEJ1ZmZlcihcIm9wdGlvbnNcIiw0LDQpLGQ9dGhpcy5fYnVmZmVyLmNyZWF0ZVZlcnRleEJ1ZmZlcihcImNlbGxJbmZvXCIsOCw0KSxwPXRoaXMuX2J1ZmZlci5jcmVhdGVWZXJ0ZXhCdWZmZXIoZS5WZXJ0ZXhCdWZmZXIuQ29sb3JLaW5kLDEyLDQpO3RoaXMuX3ZlcnRleEJ1ZmZlcnNbZS5WZXJ0ZXhCdWZmZXIuUG9zaXRpb25LaW5kXT11LHRoaXMuX3ZlcnRleEJ1ZmZlcnMub3B0aW9ucz1mLHRoaXMuX3ZlcnRleEJ1ZmZlcnMuY2VsbEluZm89ZCx0aGlzLl92ZXJ0ZXhCdWZmZXJzW2UuVmVydGV4QnVmZmVyLkNvbG9yS2luZF09cCx0aGlzLl9lZmZlY3RCYXNlPXRoaXMuX3NjZW5lLmdldEVuZ2luZSgpLmNyZWF0ZUVmZmVjdChcInNwcml0ZXNcIixbZS5WZXJ0ZXhCdWZmZXIuUG9zaXRpb25LaW5kLFwib3B0aW9uc1wiLFwiY2VsbEluZm9cIixlLlZlcnRleEJ1ZmZlci5Db2xvcktpbmRdLFtcInZpZXdcIixcInByb2plY3Rpb25cIixcInRleHR1cmVJbmZvc1wiLFwiYWxwaGFUZXN0XCJdLFtcImRpZmZ1c2VTYW1wbGVyXCJdLFwiXCIpLHRoaXMuX2VmZmVjdEZvZz10aGlzLl9zY2VuZS5nZXRFbmdpbmUoKS5jcmVhdGVFZmZlY3QoXCJzcHJpdGVzXCIsW2UuVmVydGV4QnVmZmVyLlBvc2l0aW9uS2luZCxcIm9wdGlvbnNcIixcImNlbGxJbmZvXCIsZS5WZXJ0ZXhCdWZmZXIuQ29sb3JLaW5kXSxbXCJ2aWV3XCIsXCJwcm9qZWN0aW9uXCIsXCJ0ZXh0dXJlSW5mb3NcIixcImFscGhhVGVzdFwiLFwidkZvZ0luZm9zXCIsXCJ2Rm9nQ29sb3JcIl0sW1wiZGlmZnVzZVNhbXBsZXJcIl0sXCIjZGVmaW5lIEZPR1wiKX1yZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwib25EaXNwb3NlXCIse3NldDpmdW5jdGlvbihlKXt0aGlzLl9vbkRpc3Bvc2VPYnNlcnZlciYmdGhpcy5vbkRpc3Bvc2VPYnNlcnZhYmxlLnJlbW92ZSh0aGlzLl9vbkRpc3Bvc2VPYnNlcnZlciksdGhpcy5fb25EaXNwb3NlT2JzZXJ2ZXI9dGhpcy5vbkRpc3Bvc2VPYnNlcnZhYmxlLmFkZChlKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJ0ZXh0dXJlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9zcHJpdGVUZXh0dXJlfSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fc3ByaXRlVGV4dHVyZT1lfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLHQucHJvdG90eXBlLl9hcHBlbmRTcHJpdGVWZXJ0ZXg9ZnVuY3Rpb24oZSx0LGkscixuKXt2YXIgbz0xNiplOzA9PT1pP2k9dGhpcy5fZXBzaWxvbjoxPT09aSYmKGk9MS10aGlzLl9lcHNpbG9uKSwwPT09cj9yPXRoaXMuX2Vwc2lsb246MT09PXImJihyPTEtdGhpcy5fZXBzaWxvbiksdGhpcy5fdmVydGV4RGF0YVtvXT10LnBvc2l0aW9uLngsdGhpcy5fdmVydGV4RGF0YVtvKzFdPXQucG9zaXRpb24ueSx0aGlzLl92ZXJ0ZXhEYXRhW28rMl09dC5wb3NpdGlvbi56LHRoaXMuX3ZlcnRleERhdGFbbyszXT10LmFuZ2xlLHRoaXMuX3ZlcnRleERhdGFbbys0XT10LndpZHRoLHRoaXMuX3ZlcnRleERhdGFbbys1XT10LmhlaWdodCx0aGlzLl92ZXJ0ZXhEYXRhW28rNl09aSx0aGlzLl92ZXJ0ZXhEYXRhW28rN109cix0aGlzLl92ZXJ0ZXhEYXRhW28rOF09dC5pbnZlcnRVPzE6MCx0aGlzLl92ZXJ0ZXhEYXRhW28rOV09dC5pbnZlcnRWPzE6MDt2YXIgcz10LmNlbGxJbmRleC9uPj4wO3RoaXMuX3ZlcnRleERhdGFbbysxMF09dC5jZWxsSW5kZXgtcypuLHRoaXMuX3ZlcnRleERhdGFbbysxMV09cyx0aGlzLl92ZXJ0ZXhEYXRhW28rMTJdPXQuY29sb3Iucix0aGlzLl92ZXJ0ZXhEYXRhW28rMTNdPXQuY29sb3IuZyx0aGlzLl92ZXJ0ZXhEYXRhW28rMTRdPXQuY29sb3IuYix0aGlzLl92ZXJ0ZXhEYXRhW28rMTVdPXQuY29sb3IuYX0sdC5wcm90b3R5cGUuaW50ZXJzZWN0cz1mdW5jdGlvbih0LGkscixuKXtmb3IodmFyIG8scz1NYXRoLm1pbih0aGlzLl9jYXBhY2l0eSx0aGlzLnNwcml0ZXMubGVuZ3RoKSxhPWUuVmVjdG9yMy5aZXJvKCksaD1lLlZlY3RvcjMuWmVybygpLGM9TnVtYmVyLk1BWF9WQUxVRSxsPWUuVmVjdG9yMy5aZXJvKCksdT1pLmdldFZpZXdNYXRyaXgoKSxmPTA7cz5mO2YrKyl7dmFyIGQ9dGhpcy5zcHJpdGVzW2ZdO2lmKGQpe2lmKHIpe2lmKCFyKGQpKWNvbnRpbnVlfWVsc2UgaWYoIWQuaXNQaWNrYWJsZSljb250aW51ZTtpZihlLlZlY3RvcjMuVHJhbnNmb3JtQ29vcmRpbmF0ZXNUb1JlZihkLnBvc2l0aW9uLHUsbCksYS5jb3B5RnJvbUZsb2F0cyhsLngtZC53aWR0aC8yLGwueS1kLmhlaWdodC8yLGwueiksaC5jb3B5RnJvbUZsb2F0cyhsLngrZC53aWR0aC8yLGwueStkLmhlaWdodC8yLGwueiksdC5pbnRlcnNlY3RzQm94TWluTWF4KGEsaCkpe3ZhciBwPWUuVmVjdG9yMy5EaXN0YW5jZShsLHQub3JpZ2luKTtpZihjPnAmJihjPXAsbz1kLG4pKWJyZWFrfX19aWYobyl7dmFyIF89bmV3IGUuUGlja2luZ0luZm87cmV0dXJuIF8uaGl0PSEwLF8ucGlja2VkU3ByaXRlPW8sXy5kaXN0YW5jZT1jLF99cmV0dXJuIG51bGx9LHQucHJvdG90eXBlLnJlbmRlcj1mdW5jdGlvbigpe2lmKHRoaXMuX2VmZmVjdEJhc2UuaXNSZWFkeSgpJiZ0aGlzLl9lZmZlY3RGb2cuaXNSZWFkeSgpJiZ0aGlzLl9zcHJpdGVUZXh0dXJlJiZ0aGlzLl9zcHJpdGVUZXh0dXJlLmlzUmVhZHkoKSl7Zm9yKHZhciB0PXRoaXMuX3NjZW5lLmdldEVuZ2luZSgpLGk9dGhpcy5fc3ByaXRlVGV4dHVyZS5nZXRCYXNlU2l6ZSgpLHI9dC5nZXREZWx0YVRpbWUoKSxuPU1hdGgubWluKHRoaXMuX2NhcGFjaXR5LHRoaXMuc3ByaXRlcy5sZW5ndGgpLG89aS53aWR0aC90aGlzLmNlbGxTaXplLHM9MCxhPTA7bj5hO2ErKyl7dmFyIGg9dGhpcy5zcHJpdGVzW2FdO2gmJihoLl9hbmltYXRlKHIpLHRoaXMuX2FwcGVuZFNwcml0ZVZlcnRleChzKyssaCwwLDAsbyksdGhpcy5fYXBwZW5kU3ByaXRlVmVydGV4KHMrKyxoLDEsMCxvKSx0aGlzLl9hcHBlbmRTcHJpdGVWZXJ0ZXgocysrLGgsMSwxLG8pLHRoaXMuX2FwcGVuZFNwcml0ZVZlcnRleChzKyssaCwwLDEsbykpfXRoaXMuX2J1ZmZlci51cGRhdGUodGhpcy5fdmVydGV4RGF0YSk7dmFyIGM9dGhpcy5fZWZmZWN0QmFzZTt0aGlzLl9zY2VuZS5mb2dFbmFibGVkJiZ0aGlzLl9zY2VuZS5mb2dNb2RlIT09ZS5TY2VuZS5GT0dNT0RFX05PTkUmJnRoaXMuZm9nRW5hYmxlZCYmKGM9dGhpcy5fZWZmZWN0Rm9nKSx0LmVuYWJsZUVmZmVjdChjKTt2YXIgbD10aGlzLl9zY2VuZS5nZXRWaWV3TWF0cml4KCk7Yy5zZXRUZXh0dXJlKFwiZGlmZnVzZVNhbXBsZXJcIix0aGlzLl9zcHJpdGVUZXh0dXJlKSxjLnNldE1hdHJpeChcInZpZXdcIixsKSxjLnNldE1hdHJpeChcInByb2plY3Rpb25cIix0aGlzLl9zY2VuZS5nZXRQcm9qZWN0aW9uTWF0cml4KCkpLGMuc2V0RmxvYXQyKFwidGV4dHVyZUluZm9zXCIsdGhpcy5jZWxsU2l6ZS9pLndpZHRoLHRoaXMuY2VsbFNpemUvaS5oZWlnaHQpLHRoaXMuX3NjZW5lLmZvZ0VuYWJsZWQmJnRoaXMuX3NjZW5lLmZvZ01vZGUhPT1lLlNjZW5lLkZPR01PREVfTk9ORSYmdGhpcy5mb2dFbmFibGVkJiYoYy5zZXRGbG9hdDQoXCJ2Rm9nSW5mb3NcIix0aGlzLl9zY2VuZS5mb2dNb2RlLHRoaXMuX3NjZW5lLmZvZ1N0YXJ0LHRoaXMuX3NjZW5lLmZvZ0VuZCx0aGlzLl9zY2VuZS5mb2dEZW5zaXR5KSxjLnNldENvbG9yMyhcInZGb2dDb2xvclwiLHRoaXMuX3NjZW5lLmZvZ0NvbG9yKSksdC5iaW5kQnVmZmVycyh0aGlzLl92ZXJ0ZXhCdWZmZXJzLHRoaXMuX2luZGV4QnVmZmVyLGMpLHQuc2V0RGVwdGhGdW5jdGlvblRvTGVzc09yRXF1YWwoKSxjLnNldEJvb2woXCJhbHBoYVRlc3RcIiwhMCksdC5zZXRDb2xvcldyaXRlKCExKSx0LmRyYXcoITAsMCw2Km4pLHQuc2V0Q29sb3JXcml0ZSghMCksYy5zZXRCb29sKFwiYWxwaGFUZXN0XCIsITEpLHQuc2V0QWxwaGFNb2RlKGUuRW5naW5lLkFMUEhBX0NPTUJJTkUpLHQuZHJhdyghMCwwLDYqbiksdC5zZXRBbHBoYU1vZGUoZS5FbmdpbmUuQUxQSEFfRElTQUJMRSl9fSx0LnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7dGhpcy5fYnVmZmVyJiYodGhpcy5fYnVmZmVyLmRpc3Bvc2UoKSx0aGlzLl9idWZmZXI9bnVsbCksdGhpcy5faW5kZXhCdWZmZXImJih0aGlzLl9zY2VuZS5nZXRFbmdpbmUoKS5fcmVsZWFzZUJ1ZmZlcih0aGlzLl9pbmRleEJ1ZmZlciksdGhpcy5faW5kZXhCdWZmZXI9bnVsbCksdGhpcy5fc3ByaXRlVGV4dHVyZSYmKHRoaXMuX3Nwcml0ZVRleHR1cmUuZGlzcG9zZSgpLHRoaXMuX3Nwcml0ZVRleHR1cmU9bnVsbCk7dmFyIGU9dGhpcy5fc2NlbmUuc3ByaXRlTWFuYWdlcnMuaW5kZXhPZih0aGlzKTt0aGlzLl9zY2VuZS5zcHJpdGVNYW5hZ2Vycy5zcGxpY2UoZSwxKSx0aGlzLm9uRGlzcG9zZU9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpLHRoaXMub25EaXNwb3NlT2JzZXJ2YWJsZS5jbGVhcigpfSx0fSgpO2UuU3ByaXRlTWFuYWdlcj10fShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCxpKXt0aGlzLm5hbWU9dCx0aGlzLmNvbG9yPW5ldyBlLkNvbG9yNCgxLDEsMSwxKSx0aGlzLndpZHRoPTEsdGhpcy5oZWlnaHQ9MSx0aGlzLmFuZ2xlPTAsdGhpcy5jZWxsSW5kZXg9MCx0aGlzLmludmVydFU9MCx0aGlzLmludmVydFY9MCx0aGlzLmFuaW1hdGlvbnM9bmV3IEFycmF5LHRoaXMuaXNQaWNrYWJsZT0hMSx0aGlzLl9hbmltYXRpb25TdGFydGVkPSExLHRoaXMuX2xvb3BBbmltYXRpb249ITEsdGhpcy5fZnJvbUluZGV4PTAsdGhpcy5fdG9JbmRleD0wLHRoaXMuX2RlbGF5PTAsdGhpcy5fZGlyZWN0aW9uPTEsdGhpcy5fZnJhbWVDb3VudD0wLHRoaXMuX3RpbWU9MCx0aGlzLl9tYW5hZ2VyPWksdGhpcy5fbWFuYWdlci5zcHJpdGVzLnB1c2godGhpcyksdGhpcy5wb3NpdGlvbj1lLlZlY3RvcjMuWmVybygpfXJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJzaXplXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLndpZHRofSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy53aWR0aD1lLHRoaXMuaGVpZ2h0PWV9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksdC5wcm90b3R5cGUucGxheUFuaW1hdGlvbj1mdW5jdGlvbihlLHQsaSxyKXt0aGlzLl9mcm9tSW5kZXg9ZSx0aGlzLl90b0luZGV4PXQsdGhpcy5fbG9vcEFuaW1hdGlvbj1pLHRoaXMuX2RlbGF5PXIsdGhpcy5fYW5pbWF0aW9uU3RhcnRlZD0hMCx0aGlzLl9kaXJlY3Rpb249dD5lPzE6LTEsdGhpcy5jZWxsSW5kZXg9ZSx0aGlzLl90aW1lPTB9LHQucHJvdG90eXBlLnN0b3BBbmltYXRpb249ZnVuY3Rpb24oKXt0aGlzLl9hbmltYXRpb25TdGFydGVkPSExfSx0LnByb3RvdHlwZS5fYW5pbWF0ZT1mdW5jdGlvbihlKXt0aGlzLl9hbmltYXRpb25TdGFydGVkJiYodGhpcy5fdGltZSs9ZSx0aGlzLl90aW1lPnRoaXMuX2RlbGF5JiYodGhpcy5fdGltZT10aGlzLl90aW1lJXRoaXMuX2RlbGF5LHRoaXMuY2VsbEluZGV4Kz10aGlzLl9kaXJlY3Rpb24sdGhpcy5jZWxsSW5kZXg9PXRoaXMuX3RvSW5kZXgmJih0aGlzLl9sb29wQW5pbWF0aW9uP3RoaXMuY2VsbEluZGV4PXRoaXMuX2Zyb21JbmRleDoodGhpcy5fYW5pbWF0aW9uU3RhcnRlZD0hMSx0aGlzLmRpc3Bvc2VXaGVuRmluaXNoZWRBbmltYXRpbmcmJnRoaXMuZGlzcG9zZSgpKSkpKX0sdC5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe2Zvcih2YXIgZT0wO2U8dGhpcy5fbWFuYWdlci5zcHJpdGVzLmxlbmd0aDtlKyspdGhpcy5fbWFuYWdlci5zcHJpdGVzW2VdPT10aGlzJiZ0aGlzLl9tYW5hZ2VyLnNwcml0ZXMuc3BsaWNlKGUsMSl9LHR9KCk7ZS5TcHJpdGU9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQsaSxyLG4sbyl7dGhpcy5uYW1lPXQsdGhpcy5zY2FsZT1uZXcgZS5WZWN0b3IyKDEsMSksdGhpcy5vZmZzZXQ9bmV3IGUuVmVjdG9yMigwLDApLHRoaXMuYWxwaGFCbGVuZGluZ01vZGU9ZS5FbmdpbmUuQUxQSEFfQ09NQklORSx0aGlzLl92ZXJ0ZXhCdWZmZXJzPXt9LHRoaXMub25EaXNwb3NlT2JzZXJ2YWJsZT1uZXcgZS5PYnNlcnZhYmxlLHRoaXMub25CZWZvcmVSZW5kZXJPYnNlcnZhYmxlPW5ldyBlLk9ic2VydmFibGUsdGhpcy5vbkFmdGVyUmVuZGVyT2JzZXJ2YWJsZT1uZXcgZS5PYnNlcnZhYmxlLHRoaXMudGV4dHVyZT1pP25ldyBlLlRleHR1cmUoaSxyLCEwKTpudWxsLHRoaXMuaXNCYWNrZ3JvdW5kPXZvaWQgMD09PW4/ITA6bix0aGlzLmNvbG9yPXZvaWQgMD09PW8/bmV3IGUuQ29sb3I0KDEsMSwxLDEpOm8sdGhpcy5fc2NlbmU9cix0aGlzLl9zY2VuZS5sYXllcnMucHVzaCh0aGlzKTt2YXIgcz1yLmdldEVuZ2luZSgpLGE9W107YS5wdXNoKDEsMSksYS5wdXNoKC0xLDEpLGEucHVzaCgtMSwtMSksYS5wdXNoKDEsLTEpO3ZhciBoPW5ldyBlLlZlcnRleEJ1ZmZlcihzLGEsZS5WZXJ0ZXhCdWZmZXIuUG9zaXRpb25LaW5kLCExLCExLDIpO3RoaXMuX3ZlcnRleEJ1ZmZlcnNbZS5WZXJ0ZXhCdWZmZXIuUG9zaXRpb25LaW5kXT1oO3ZhciBjPVtdO2MucHVzaCgwKSxjLnB1c2goMSksYy5wdXNoKDIpLGMucHVzaCgwKSxjLnB1c2goMiksYy5wdXNoKDMpLHRoaXMuX2luZGV4QnVmZmVyPXMuY3JlYXRlSW5kZXhCdWZmZXIoYyksdGhpcy5fZWZmZWN0PXMuY3JlYXRlRWZmZWN0KFwibGF5ZXJcIixbZS5WZXJ0ZXhCdWZmZXIuUG9zaXRpb25LaW5kXSxbXCJ0ZXh0dXJlTWF0cml4XCIsXCJjb2xvclwiLFwic2NhbGVcIixcIm9mZnNldFwiXSxbXCJ0ZXh0dXJlU2FtcGxlclwiXSxcIlwiKSx0aGlzLl9hbHBoYVRlc3RFZmZlY3Q9cy5jcmVhdGVFZmZlY3QoXCJsYXllclwiLFtlLlZlcnRleEJ1ZmZlci5Qb3NpdGlvbktpbmRdLFtcInRleHR1cmVNYXRyaXhcIixcImNvbG9yXCIsXCJzY2FsZVwiLFwib2Zmc2V0XCJdLFtcInRleHR1cmVTYW1wbGVyXCJdLFwiI2RlZmluZSBBTFBIQVRFU1RcIil9cmV0dXJuIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcIm9uRGlzcG9zZVwiLHtzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fb25EaXNwb3NlT2JzZXJ2ZXImJnRoaXMub25EaXNwb3NlT2JzZXJ2YWJsZS5yZW1vdmUodGhpcy5fb25EaXNwb3NlT2JzZXJ2ZXIpLHRoaXMuX29uRGlzcG9zZU9ic2VydmVyPXRoaXMub25EaXNwb3NlT2JzZXJ2YWJsZS5hZGQoZSl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwib25CZWZvcmVSZW5kZXJcIix7c2V0OmZ1bmN0aW9uKGUpe3RoaXMuX29uQmVmb3JlUmVuZGVyT2JzZXJ2ZXImJnRoaXMub25CZWZvcmVSZW5kZXJPYnNlcnZhYmxlLnJlbW92ZSh0aGlzLl9vbkJlZm9yZVJlbmRlck9ic2VydmVyKSx0aGlzLl9vbkJlZm9yZVJlbmRlck9ic2VydmVyPXRoaXMub25CZWZvcmVSZW5kZXJPYnNlcnZhYmxlLmFkZChlKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJvbkFmdGVyUmVuZGVyXCIse3NldDpmdW5jdGlvbihlKXt0aGlzLl9vbkFmdGVyUmVuZGVyT2JzZXJ2ZXImJnRoaXMub25BZnRlclJlbmRlck9ic2VydmFibGUucmVtb3ZlKHRoaXMuX29uQWZ0ZXJSZW5kZXJPYnNlcnZlciksdGhpcy5fb25BZnRlclJlbmRlck9ic2VydmVyPXRoaXMub25BZnRlclJlbmRlck9ic2VydmFibGUuYWRkKGUpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLHQucHJvdG90eXBlLnJlbmRlcj1mdW5jdGlvbigpe3ZhciB0PXRoaXMuYWxwaGFUZXN0P3RoaXMuX2FscGhhVGVzdEVmZmVjdDp0aGlzLl9lZmZlY3Q7aWYodC5pc1JlYWR5KCkmJnRoaXMudGV4dHVyZSYmdGhpcy50ZXh0dXJlLmlzUmVhZHkoKSl7dmFyIGk9dGhpcy5fc2NlbmUuZ2V0RW5naW5lKCk7dGhpcy5vbkJlZm9yZVJlbmRlck9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpLGkuZW5hYmxlRWZmZWN0KHQpLGkuc2V0U3RhdGUoITEpLHQuc2V0VGV4dHVyZShcInRleHR1cmVTYW1wbGVyXCIsdGhpcy50ZXh0dXJlKSx0LnNldE1hdHJpeChcInRleHR1cmVNYXRyaXhcIix0aGlzLnRleHR1cmUuZ2V0VGV4dHVyZU1hdHJpeCgpKSx0LnNldEZsb2F0NChcImNvbG9yXCIsdGhpcy5jb2xvci5yLHRoaXMuY29sb3IuZyx0aGlzLmNvbG9yLmIsdGhpcy5jb2xvci5hKSx0LnNldFZlY3RvcjIoXCJvZmZzZXRcIix0aGlzLm9mZnNldCksdC5zZXRWZWN0b3IyKFwic2NhbGVcIix0aGlzLnNjYWxlKSxpLmJpbmRCdWZmZXJzKHRoaXMuX3ZlcnRleEJ1ZmZlcnMsdGhpcy5faW5kZXhCdWZmZXIsdCksdGhpcy5fYWxwaGFUZXN0RWZmZWN0P2kuZHJhdyghMCwwLDYpOihpLnNldEFscGhhTW9kZSh0aGlzLmFscGhhQmxlbmRpbmdNb2RlKSxpLmRyYXcoITAsMCw2KSxpLnNldEFscGhhTW9kZShlLkVuZ2luZS5BTFBIQV9ESVNBQkxFKSksdGhpcy5vbkFmdGVyUmVuZGVyT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcyl9fSx0LnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5fdmVydGV4QnVmZmVyc1tlLlZlcnRleEJ1ZmZlci5Qb3NpdGlvbktpbmRdO3QmJih0LmRpc3Bvc2UoKSx0aGlzLl92ZXJ0ZXhCdWZmZXJzW2UuVmVydGV4QnVmZmVyLlBvc2l0aW9uS2luZF09bnVsbCksdGhpcy5faW5kZXhCdWZmZXImJih0aGlzLl9zY2VuZS5nZXRFbmdpbmUoKS5fcmVsZWFzZUJ1ZmZlcih0aGlzLl9pbmRleEJ1ZmZlciksdGhpcy5faW5kZXhCdWZmZXI9bnVsbCksdGhpcy50ZXh0dXJlJiYodGhpcy50ZXh0dXJlLmRpc3Bvc2UoKSx0aGlzLnRleHR1cmU9bnVsbCk7dmFyIGk9dGhpcy5fc2NlbmUubGF5ZXJzLmluZGV4T2YodGhpcyk7dGhpcy5fc2NlbmUubGF5ZXJzLnNwbGljZShpLDEpLHRoaXMub25EaXNwb3NlT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcyksdGhpcy5vbkRpc3Bvc2VPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbkFmdGVyUmVuZGVyT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25CZWZvcmVSZW5kZXJPYnNlcnZhYmxlLmNsZWFyKCl9LHR9KCk7ZS5MYXllcj10fShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoKXt0aGlzLnBvc2l0aW9uPWUuVmVjdG9yMy5aZXJvKCksdGhpcy5kaXJlY3Rpb249ZS5WZWN0b3IzLlplcm8oKSx0aGlzLmNvbG9yPW5ldyBlLkNvbG9yNCgwLDAsMCwwKSx0aGlzLmNvbG9yU3RlcD1uZXcgZS5Db2xvcjQoMCwwLDAsMCksdGhpcy5saWZlVGltZT0xLHRoaXMuYWdlPTAsdGhpcy5zaXplPTAsdGhpcy5hbmdsZT0wLHRoaXMuYW5ndWxhclNwZWVkPTB9cmV0dXJuIHQucHJvdG90eXBlLmNvcHlUbz1mdW5jdGlvbihlKXtlLnBvc2l0aW9uLmNvcHlGcm9tKHRoaXMucG9zaXRpb24pLGUuZGlyZWN0aW9uLmNvcHlGcm9tKHRoaXMuZGlyZWN0aW9uKSxlLmNvbG9yLmNvcHlGcm9tKHRoaXMuY29sb3IpLGUuY29sb3JTdGVwLmNvcHlGcm9tKHRoaXMuY29sb3JTdGVwKSxlLmxpZmVUaW1lPXRoaXMubGlmZVRpbWUsZS5hZ2U9dGhpcy5hZ2UsZS5zaXplPXRoaXMuc2l6ZSxlLmFuZ2xlPXRoaXMuYW5nbGUsZS5hbmd1bGFyU3BlZWQ9dGhpcy5hbmd1bGFyU3BlZWR9LHR9KCk7ZS5QYXJ0aWNsZT10fShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbihlLHQpe2lmKGU9PT10KXJldHVybiBlO3ZhciBpPU1hdGgucmFuZG9tKCk7cmV0dXJuIGkqKHQtZSkrZX0saT1mdW5jdGlvbigpe2Z1bmN0aW9uIGkocixuLG8scyl7dmFyIGE9dGhpczt0aGlzLm5hbWU9cix0aGlzLmFuaW1hdGlvbnM9W10sdGhpcy5yZW5kZXJpbmdHcm91cElkPTAsdGhpcy5lbWl0dGVyPW51bGwsdGhpcy5lbWl0UmF0ZT0xMCx0aGlzLm1hbnVhbEVtaXRDb3VudD0tMSx0aGlzLnVwZGF0ZVNwZWVkPS4wMSx0aGlzLnRhcmdldFN0b3BEdXJhdGlvbj0wLHRoaXMuZGlzcG9zZU9uU3RvcD0hMSx0aGlzLm1pbkVtaXRQb3dlcj0xLHRoaXMubWF4RW1pdFBvd2VyPTEsdGhpcy5taW5MaWZlVGltZT0xLHRoaXMubWF4TGlmZVRpbWU9MSx0aGlzLm1pblNpemU9MSx0aGlzLm1heFNpemU9MSx0aGlzLm1pbkFuZ3VsYXJTcGVlZD0wLHRoaXMubWF4QW5ndWxhclNwZWVkPTAsdGhpcy5sYXllck1hc2s9MjY4NDM1NDU1LHRoaXMub25EaXNwb3NlT2JzZXJ2YWJsZT1uZXcgZS5PYnNlcnZhYmxlLHRoaXMuYmxlbmRNb2RlPWkuQkxFTkRNT0RFX09ORU9ORSx0aGlzLmZvcmNlRGVwdGhXcml0ZT0hMSx0aGlzLmdyYXZpdHk9ZS5WZWN0b3IzLlplcm8oKSx0aGlzLmRpcmVjdGlvbjE9bmV3IGUuVmVjdG9yMygwLDEsMCksdGhpcy5kaXJlY3Rpb24yPW5ldyBlLlZlY3RvcjMoMCwxLDApLHRoaXMubWluRW1pdEJveD1uZXcgZS5WZWN0b3IzKC0uNSwtLjUsLS41KSx0aGlzLm1heEVtaXRCb3g9bmV3IGUuVmVjdG9yMyguNSwuNSwuNSksdGhpcy5jb2xvcjE9bmV3IGUuQ29sb3I0KDEsMSwxLDEpLHRoaXMuY29sb3IyPW5ldyBlLkNvbG9yNCgxLDEsMSwxKSx0aGlzLmNvbG9yRGVhZD1uZXcgZS5Db2xvcjQoMCwwLDAsMSksdGhpcy50ZXh0dXJlTWFzaz1uZXcgZS5Db2xvcjQoMSwxLDEsMSksdGhpcy5wYXJ0aWNsZXM9bmV3IEFycmF5LHRoaXMuX3N0b2NrUGFydGljbGVzPW5ldyBBcnJheSx0aGlzLl9uZXdQYXJ0c0V4Y2Vzcz0wLHRoaXMuX3ZlcnRleEJ1ZmZlcnM9e30sdGhpcy5fc2NhbGVkQ29sb3JTdGVwPW5ldyBlLkNvbG9yNCgwLDAsMCwwKSx0aGlzLl9jb2xvckRpZmY9bmV3IGUuQ29sb3I0KDAsMCwwLDApLHRoaXMuX3NjYWxlZERpcmVjdGlvbj1lLlZlY3RvcjMuWmVybygpLHRoaXMuX3NjYWxlZEdyYXZpdHk9ZS5WZWN0b3IzLlplcm8oKSx0aGlzLl9jdXJyZW50UmVuZGVySWQ9LTEsdGhpcy5fc3RhcnRlZD0hMSx0aGlzLl9zdG9wcGVkPSExLHRoaXMuX2FjdHVhbEZyYW1lPTAsdGhpcy5pZD1yLHRoaXMuX2NhcGFjaXR5PW4sdGhpcy5fc2NlbmU9byx0aGlzLl9jdXN0b21FZmZlY3Q9cyxvLnBhcnRpY2xlU3lzdGVtcy5wdXNoKHRoaXMpO2Zvcih2YXIgaD1bXSxjPTAsbD0wO24+bDtsKyspaC5wdXNoKGMpLGgucHVzaChjKzEpLGgucHVzaChjKzIpLGgucHVzaChjKSxoLnB1c2goYysyKSxoLnB1c2goYyszKSxjKz00O3RoaXMuX2luZGV4QnVmZmVyPW8uZ2V0RW5naW5lKCkuY3JlYXRlSW5kZXhCdWZmZXIoaCksdGhpcy5fdmVydGV4RGF0YT1uZXcgRmxvYXQzMkFycmF5KDExKm4qNCksdGhpcy5fdmVydGV4QnVmZmVyPW5ldyBlLkJ1ZmZlcihvLmdldEVuZ2luZSgpLHRoaXMuX3ZlcnRleERhdGEsITAsMTEpO3ZhciB1PXRoaXMuX3ZlcnRleEJ1ZmZlci5jcmVhdGVWZXJ0ZXhCdWZmZXIoZS5WZXJ0ZXhCdWZmZXIuUG9zaXRpb25LaW5kLDAsMyksZj10aGlzLl92ZXJ0ZXhCdWZmZXIuY3JlYXRlVmVydGV4QnVmZmVyKGUuVmVydGV4QnVmZmVyLkNvbG9yS2luZCwzLDQpLGQ9dGhpcy5fdmVydGV4QnVmZmVyLmNyZWF0ZVZlcnRleEJ1ZmZlcihcIm9wdGlvbnNcIiw3LDQpO3RoaXMuX3ZlcnRleEJ1ZmZlcnNbZS5WZXJ0ZXhCdWZmZXIuUG9zaXRpb25LaW5kXT11LHRoaXMuX3ZlcnRleEJ1ZmZlcnNbZS5WZXJ0ZXhCdWZmZXIuQ29sb3JLaW5kXT1mLHRoaXMuX3ZlcnRleEJ1ZmZlcnMub3B0aW9ucz1kLHRoaXMuc3RhcnREaXJlY3Rpb25GdW5jdGlvbj1mdW5jdGlvbihpLHIsbixvKXt2YXIgcz10KGEuZGlyZWN0aW9uMS54LGEuZGlyZWN0aW9uMi54KSxoPXQoYS5kaXJlY3Rpb24xLnksYS5kaXJlY3Rpb24yLnkpLGM9dChhLmRpcmVjdGlvbjEueixhLmRpcmVjdGlvbjIueik7ZS5WZWN0b3IzLlRyYW5zZm9ybU5vcm1hbEZyb21GbG9hdHNUb1JlZihzKmksaCppLGMqaSxyLG4pfSx0aGlzLnN0YXJ0UG9zaXRpb25GdW5jdGlvbj1mdW5jdGlvbihpLHIsbil7dmFyIG89dChhLm1pbkVtaXRCb3gueCxhLm1heEVtaXRCb3gueCkscz10KGEubWluRW1pdEJveC55LGEubWF4RW1pdEJveC55KSxoPXQoYS5taW5FbWl0Qm94LnosYS5tYXhFbWl0Qm94LnopO2UuVmVjdG9yMy5UcmFuc2Zvcm1Db29yZGluYXRlc0Zyb21GbG9hdHNUb1JlZihvLHMsaCxpLHIpfSx0aGlzLnVwZGF0ZUZ1bmN0aW9uPWZ1bmN0aW9uKGUpe2Zvcih2YXIgdD0wO3Q8ZS5sZW5ndGg7dCsrKXt2YXIgaT1lW3RdO2kuYWdlKz1hLl9zY2FsZWRVcGRhdGVTcGVlZCxpLmFnZT49aS5saWZlVGltZT8oYS5yZWN5Y2xlUGFydGljbGUoaSksdC0tKTooaS5jb2xvclN0ZXAuc2NhbGVUb1JlZihhLl9zY2FsZWRVcGRhdGVTcGVlZCxhLl9zY2FsZWRDb2xvclN0ZXApLGkuY29sb3IuYWRkSW5QbGFjZShhLl9zY2FsZWRDb2xvclN0ZXApLGkuY29sb3IuYTwwJiYoaS5jb2xvci5hPTApLGkuYW5nbGUrPWkuYW5ndWxhclNwZWVkKmEuX3NjYWxlZFVwZGF0ZVNwZWVkLGkuZGlyZWN0aW9uLnNjYWxlVG9SZWYoYS5fc2NhbGVkVXBkYXRlU3BlZWQsYS5fc2NhbGVkRGlyZWN0aW9uKSxpLnBvc2l0aW9uLmFkZEluUGxhY2UoYS5fc2NhbGVkRGlyZWN0aW9uKSxhLmdyYXZpdHkuc2NhbGVUb1JlZihhLl9zY2FsZWRVcGRhdGVTcGVlZCxhLl9zY2FsZWRHcmF2aXR5KSxpLmRpcmVjdGlvbi5hZGRJblBsYWNlKGEuX3NjYWxlZEdyYXZpdHkpKX19fXJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJvbkRpc3Bvc2VcIix7c2V0OmZ1bmN0aW9uKGUpe3RoaXMuX29uRGlzcG9zZU9ic2VydmVyJiZ0aGlzLm9uRGlzcG9zZU9ic2VydmFibGUucmVtb3ZlKHRoaXMuX29uRGlzcG9zZU9ic2VydmVyKSx0aGlzLl9vbkRpc3Bvc2VPYnNlcnZlcj10aGlzLm9uRGlzcG9zZU9ic2VydmFibGUuYWRkKGUpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLGkucHJvdG90eXBlLnJlY3ljbGVQYXJ0aWNsZT1mdW5jdGlvbihlKXt2YXIgdD10aGlzLnBhcnRpY2xlcy5wb3AoKTt0IT09ZSYmKHQuY29weVRvKGUpLHRoaXMuX3N0b2NrUGFydGljbGVzLnB1c2godCkpfSxpLnByb3RvdHlwZS5nZXRDYXBhY2l0eT1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9jYXBhY2l0eX0saS5wcm90b3R5cGUuaXNBbGl2ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9hbGl2ZX0saS5wcm90b3R5cGUuaXNTdGFydGVkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3N0YXJ0ZWR9LGkucHJvdG90eXBlLnN0YXJ0PWZ1bmN0aW9uKCl7dGhpcy5fc3RhcnRlZD0hMCx0aGlzLl9zdG9wcGVkPSExLHRoaXMuX2FjdHVhbEZyYW1lPTB9LGkucHJvdG90eXBlLnN0b3A9ZnVuY3Rpb24oKXt0aGlzLl9zdG9wcGVkPSEwfSxpLnByb3RvdHlwZS5fYXBwZW5kUGFydGljbGVWZXJ0ZXg9ZnVuY3Rpb24oZSx0LGkscil7dmFyIG49MTEqZTt0aGlzLl92ZXJ0ZXhEYXRhW25dPXQucG9zaXRpb24ueCx0aGlzLl92ZXJ0ZXhEYXRhW24rMV09dC5wb3NpdGlvbi55LHRoaXMuX3ZlcnRleERhdGFbbisyXT10LnBvc2l0aW9uLnosdGhpcy5fdmVydGV4RGF0YVtuKzNdPXQuY29sb3Iucix0aGlzLl92ZXJ0ZXhEYXRhW24rNF09dC5jb2xvci5nLHRoaXMuX3ZlcnRleERhdGFbbis1XT10LmNvbG9yLmIsdGhpcy5fdmVydGV4RGF0YVtuKzZdPXQuY29sb3IuYSx0aGlzLl92ZXJ0ZXhEYXRhW24rN109dC5hbmdsZSx0aGlzLl92ZXJ0ZXhEYXRhW24rOF09dC5zaXplLHRoaXMuX3ZlcnRleERhdGFbbis5XT1pLHRoaXMuX3ZlcnRleERhdGFbbisxMF09cn0saS5wcm90b3R5cGUuX3VwZGF0ZT1mdW5jdGlvbihpKXt0aGlzLl9hbGl2ZT10aGlzLnBhcnRpY2xlcy5sZW5ndGg+MCx0aGlzLnVwZGF0ZUZ1bmN0aW9uKHRoaXMucGFydGljbGVzKTt2YXIgcjtyPXRoaXMuZW1pdHRlci5wb3NpdGlvbj90aGlzLmVtaXR0ZXIuZ2V0V29ybGRNYXRyaXgoKTplLk1hdHJpeC5UcmFuc2xhdGlvbih0aGlzLmVtaXR0ZXIueCx0aGlzLmVtaXR0ZXIueSx0aGlzLmVtaXR0ZXIueik7Zm9yKHZhciBuLG89MDtpPm8mJnRoaXMucGFydGljbGVzLmxlbmd0aCE9PXRoaXMuX2NhcGFjaXR5O28rKyl7MCE9PXRoaXMuX3N0b2NrUGFydGljbGVzLmxlbmd0aD8obj10aGlzLl9zdG9ja1BhcnRpY2xlcy5wb3AoKSxuLmFnZT0wKTpuPW5ldyBlLlBhcnRpY2xlLHRoaXMucGFydGljbGVzLnB1c2gobik7dmFyIHM9dCh0aGlzLm1pbkVtaXRQb3dlcix0aGlzLm1heEVtaXRQb3dlcik7dGhpcy5zdGFydERpcmVjdGlvbkZ1bmN0aW9uKHMscixuLmRpcmVjdGlvbixuKSxuLmxpZmVUaW1lPXQodGhpcy5taW5MaWZlVGltZSx0aGlzLm1heExpZmVUaW1lKSxuLnNpemU9dCh0aGlzLm1pblNpemUsdGhpcy5tYXhTaXplKSxuLmFuZ3VsYXJTcGVlZD10KHRoaXMubWluQW5ndWxhclNwZWVkLHRoaXMubWF4QW5ndWxhclNwZWVkKSx0aGlzLnN0YXJ0UG9zaXRpb25GdW5jdGlvbihyLG4ucG9zaXRpb24sbik7dmFyIGE9dCgwLDEpO2UuQ29sb3I0LkxlcnBUb1JlZih0aGlzLmNvbG9yMSx0aGlzLmNvbG9yMixhLG4uY29sb3IpLHRoaXMuY29sb3JEZWFkLnN1YnRyYWN0VG9SZWYobi5jb2xvcix0aGlzLl9jb2xvckRpZmYpLHRoaXMuX2NvbG9yRGlmZi5zY2FsZVRvUmVmKDEvbi5saWZlVGltZSxuLmNvbG9yU3RlcCl9fSxpLnByb3RvdHlwZS5fZ2V0RWZmZWN0PWZ1bmN0aW9uKCl7aWYodGhpcy5fY3VzdG9tRWZmZWN0KXJldHVybiB0aGlzLl9jdXN0b21FZmZlY3Q7dmFyIHQ9W107dGhpcy5fc2NlbmUuY2xpcFBsYW5lJiZ0LnB1c2goXCIjZGVmaW5lIENMSVBQTEFORVwiKTt2YXIgaT10LmpvaW4oXCJcXG5cIik7cmV0dXJuIHRoaXMuX2NhY2hlZERlZmluZXMhPT1pJiYodGhpcy5fY2FjaGVkRGVmaW5lcz1pLHRoaXMuX2VmZmVjdD10aGlzLl9zY2VuZS5nZXRFbmdpbmUoKS5jcmVhdGVFZmZlY3QoXCJwYXJ0aWNsZXNcIixbZS5WZXJ0ZXhCdWZmZXIuUG9zaXRpb25LaW5kLGUuVmVydGV4QnVmZmVyLkNvbG9yS2luZCxcIm9wdGlvbnNcIl0sW1wiaW52Vmlld1wiLFwidmlld1wiLFwicHJvamVjdGlvblwiLFwidkNsaXBQbGFuZVwiLFwidGV4dHVyZU1hc2tcIl0sW1wiZGlmZnVzZVNhbXBsZXJcIl0saSkpLHRoaXMuX2VmZmVjdH0saS5wcm90b3R5cGUuYW5pbWF0ZT1mdW5jdGlvbigpe2lmKHRoaXMuX3N0YXJ0ZWQpe3ZhciBlPXRoaXMuX2dldEVmZmVjdCgpO2lmKHRoaXMuZW1pdHRlciYmZS5pc1JlYWR5KCkmJnRoaXMucGFydGljbGVUZXh0dXJlJiZ0aGlzLnBhcnRpY2xlVGV4dHVyZS5pc1JlYWR5KCkmJnRoaXMuX2N1cnJlbnRSZW5kZXJJZCE9PXRoaXMuX3NjZW5lLmdldFJlbmRlcklkKCkpe3RoaXMuX2N1cnJlbnRSZW5kZXJJZD10aGlzLl9zY2VuZS5nZXRSZW5kZXJJZCgpLHRoaXMuX3NjYWxlZFVwZGF0ZVNwZWVkPXRoaXMudXBkYXRlU3BlZWQqdGhpcy5fc2NlbmUuZ2V0QW5pbWF0aW9uUmF0aW8oKTt2YXIgdDt0aGlzLm1hbnVhbEVtaXRDb3VudD4tMT8odD10aGlzLm1hbnVhbEVtaXRDb3VudCx0aGlzLl9uZXdQYXJ0c0V4Y2Vzcz0wLHRoaXMubWFudWFsRW1pdENvdW50PTApOih0PXRoaXMuZW1pdFJhdGUqdGhpcy5fc2NhbGVkVXBkYXRlU3BlZWQ+PjAsdGhpcy5fbmV3UGFydHNFeGNlc3MrPXRoaXMuZW1pdFJhdGUqdGhpcy5fc2NhbGVkVXBkYXRlU3BlZWQtdCksdGhpcy5fbmV3UGFydHNFeGNlc3M+MSYmKHQrPXRoaXMuX25ld1BhcnRzRXhjZXNzPj4wLHRoaXMuX25ld1BhcnRzRXhjZXNzLT10aGlzLl9uZXdQYXJ0c0V4Y2Vzcz4+MCksdGhpcy5fYWxpdmU9ITEsdGhpcy5fc3RvcHBlZD90PTA6KHRoaXMuX2FjdHVhbEZyYW1lKz10aGlzLl9zY2FsZWRVcGRhdGVTcGVlZCx0aGlzLnRhcmdldFN0b3BEdXJhdGlvbiYmdGhpcy5fYWN0dWFsRnJhbWU+PXRoaXMudGFyZ2V0U3RvcER1cmF0aW9uJiZ0aGlzLnN0b3AoKSksdGhpcy5fdXBkYXRlKHQpLHRoaXMuX3N0b3BwZWQmJih0aGlzLl9hbGl2ZXx8KHRoaXMuX3N0YXJ0ZWQ9ITEsdGhpcy5kaXNwb3NlT25TdG9wJiZ0aGlzLl9zY2VuZS5fdG9CZURpc3Bvc2VkLnB1c2godGhpcykpKTtmb3IodmFyIGk9MCxyPTA7cjx0aGlzLnBhcnRpY2xlcy5sZW5ndGg7cisrKXt2YXIgbj10aGlzLnBhcnRpY2xlc1tyXTt0aGlzLl9hcHBlbmRQYXJ0aWNsZVZlcnRleChpKyssbiwwLDApLHRoaXMuX2FwcGVuZFBhcnRpY2xlVmVydGV4KGkrKyxuLDEsMCksdGhpcy5fYXBwZW5kUGFydGljbGVWZXJ0ZXgoaSsrLG4sMSwxKSx0aGlzLl9hcHBlbmRQYXJ0aWNsZVZlcnRleChpKyssbiwwLDEpfXRoaXMuX3ZlcnRleEJ1ZmZlci51cGRhdGUodGhpcy5fdmVydGV4RGF0YSl9fX0saS5wcm90b3R5cGUucmVuZGVyPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5fZ2V0RWZmZWN0KCk7aWYoISh0aGlzLmVtaXR0ZXImJnQuaXNSZWFkeSgpJiZ0aGlzLnBhcnRpY2xlVGV4dHVyZSYmdGhpcy5wYXJ0aWNsZVRleHR1cmUuaXNSZWFkeSgpJiZ0aGlzLnBhcnRpY2xlcy5sZW5ndGgpKXJldHVybiAwO3ZhciByPXRoaXMuX3NjZW5lLmdldEVuZ2luZSgpO3IuZW5hYmxlRWZmZWN0KHQpLHIuc2V0U3RhdGUoITEpO3ZhciBuPXRoaXMuX3NjZW5lLmdldFZpZXdNYXRyaXgoKTtpZih0LnNldFRleHR1cmUoXCJkaWZmdXNlU2FtcGxlclwiLHRoaXMucGFydGljbGVUZXh0dXJlKSx0LnNldE1hdHJpeChcInZpZXdcIixuKSx0LnNldE1hdHJpeChcInByb2plY3Rpb25cIix0aGlzLl9zY2VuZS5nZXRQcm9qZWN0aW9uTWF0cml4KCkpLHQuc2V0RmxvYXQ0KFwidGV4dHVyZU1hc2tcIix0aGlzLnRleHR1cmVNYXNrLnIsdGhpcy50ZXh0dXJlTWFzay5nLHRoaXMudGV4dHVyZU1hc2suYix0aGlzLnRleHR1cmVNYXNrLmEpLHRoaXMuX3NjZW5lLmNsaXBQbGFuZSl7dmFyIG89dGhpcy5fc2NlbmUuY2xpcFBsYW5lLHM9bi5jbG9uZSgpO3MuaW52ZXJ0KCksdC5zZXRNYXRyaXgoXCJpbnZWaWV3XCIscyksdC5zZXRGbG9hdDQoXCJ2Q2xpcFBsYW5lXCIsby5ub3JtYWwueCxvLm5vcm1hbC55LG8ubm9ybWFsLnosby5kKX1yZXR1cm4gci5iaW5kQnVmZmVycyh0aGlzLl92ZXJ0ZXhCdWZmZXJzLHRoaXMuX2luZGV4QnVmZmVyLHQpLHRoaXMuYmxlbmRNb2RlPT09aS5CTEVORE1PREVfT05FT05FP3Iuc2V0QWxwaGFNb2RlKGUuRW5naW5lLkFMUEhBX09ORU9ORSk6ci5zZXRBbHBoYU1vZGUoZS5FbmdpbmUuQUxQSEFfQ09NQklORSksdGhpcy5mb3JjZURlcHRoV3JpdGUmJnIuc2V0RGVwdGhXcml0ZSghMCksci5kcmF3KCEwLDAsNip0aGlzLnBhcnRpY2xlcy5sZW5ndGgpLHIuc2V0QWxwaGFNb2RlKGUuRW5naW5lLkFMUEhBX0RJU0FCTEUpLHRoaXMucGFydGljbGVzLmxlbmd0aH0saS5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3RoaXMuX3ZlcnRleEJ1ZmZlciYmKHRoaXMuX3ZlcnRleEJ1ZmZlci5kaXNwb3NlKCksdGhpcy5fdmVydGV4QnVmZmVyPW51bGwpLHRoaXMuX2luZGV4QnVmZmVyJiYodGhpcy5fc2NlbmUuZ2V0RW5naW5lKCkuX3JlbGVhc2VCdWZmZXIodGhpcy5faW5kZXhCdWZmZXIpLHRoaXMuX2luZGV4QnVmZmVyPW51bGwpLHRoaXMucGFydGljbGVUZXh0dXJlJiYodGhpcy5wYXJ0aWNsZVRleHR1cmUuZGlzcG9zZSgpLHRoaXMucGFydGljbGVUZXh0dXJlPW51bGwpO3ZhciBlPXRoaXMuX3NjZW5lLnBhcnRpY2xlU3lzdGVtcy5pbmRleE9mKHRoaXMpO3RoaXMuX3NjZW5lLnBhcnRpY2xlU3lzdGVtcy5zcGxpY2UoZSwxKSx0aGlzLm9uRGlzcG9zZU9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpLHRoaXMub25EaXNwb3NlT2JzZXJ2YWJsZS5jbGVhcigpfSxpLnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbih0LHIpe3ZhciBuPW5ldyBpKHQsdGhpcy5fY2FwYWNpdHksdGhpcy5fc2NlbmUpO3JldHVybiBlLlRvb2xzLkRlZXBDb3B5KHRoaXMsbixbXCJwYXJ0aWNsZXNcIl0pLHZvaWQgMD09PXImJihyPXRoaXMuZW1pdHRlciksbi5lbWl0dGVyPXIsdGhpcy5wYXJ0aWNsZVRleHR1cmUmJihuLnBhcnRpY2xlVGV4dHVyZT1uZXcgZS5UZXh0dXJlKHRoaXMucGFydGljbGVUZXh0dXJlLnVybCx0aGlzLl9zY2VuZSkpLG4uc3RhcnQoKSxufSxpLnByb3RvdHlwZS5zZXJpYWxpemU9ZnVuY3Rpb24oKXt2YXIgdD17fTtyZXR1cm4gdC5uYW1lPXRoaXMubmFtZSx0LmlkPXRoaXMuaWQsdGhpcy5lbWl0dGVyLnBvc2l0aW9uP3QuZW1pdHRlcklkPXRoaXMuZW1pdHRlci5pZDp0LmVtaXR0ZXI9dGhpcy5lbWl0dGVyLmFzQXJyYXkoKSx0LmNhcGFjaXR5PXRoaXMuZ2V0Q2FwYWNpdHkoKSx0aGlzLnBhcnRpY2xlVGV4dHVyZSYmKHQudGV4dHVyZU5hbWU9dGhpcy5wYXJ0aWNsZVRleHR1cmUubmFtZSksZS5BbmltYXRpb24uQXBwZW5kU2VyaWFsaXplZEFuaW1hdGlvbnModGhpcyx0KSx0Lm1pbkFuZ3VsYXJTcGVlZD10aGlzLm1pbkFuZ3VsYXJTcGVlZCx0Lm1heEFuZ3VsYXJTcGVlZD10aGlzLm1heEFuZ3VsYXJTcGVlZCx0Lm1pblNpemU9dGhpcy5taW5TaXplLHQubWF4U2l6ZT10aGlzLm1heFNpemUsdC5taW5FbWl0UG93ZXI9dGhpcy5taW5FbWl0UG93ZXIsdC5tYXhFbWl0UG93ZXI9dGhpcy5tYXhFbWl0UG93ZXIsdC5taW5MaWZlVGltZT10aGlzLm1pbkxpZmVUaW1lLHQubWF4TGlmZVRpbWU9dGhpcy5tYXhMaWZlVGltZSx0LmVtaXRSYXRlPXRoaXMuZW1pdFJhdGUsdC5taW5FbWl0Qm94PXRoaXMubWluRW1pdEJveC5hc0FycmF5KCksdC5tYXhFbWl0Qm94PXRoaXMubWF4RW1pdEJveC5hc0FycmF5KCksdC5ncmF2aXR5PXRoaXMuZ3Jhdml0eS5hc0FycmF5KCksdC5kaXJlY3Rpb24xPXRoaXMuZGlyZWN0aW9uMS5hc0FycmF5KCksdC5kaXJlY3Rpb24yPXRoaXMuZGlyZWN0aW9uMi5hc0FycmF5KCksdC5jb2xvcjE9dGhpcy5jb2xvcjEuYXNBcnJheSgpLHQuY29sb3IyPXRoaXMuY29sb3IyLmFzQXJyYXkoKSx0LmNvbG9yRGVhZD10aGlzLmNvbG9yRGVhZC5hc0FycmF5KCksdC51cGRhdGVTcGVlZD10aGlzLnVwZGF0ZVNwZWVkLHQudGFyZ2V0U3RvcER1cmF0aW9uPXRoaXMudGFyZ2V0U3RvcER1cmF0aW9uLHQudGV4dHVyZU1hc2s9dGhpcy50ZXh0dXJlTWFzay5hc0FycmF5KCksdC5ibGVuZE1vZGU9dGhpcy5ibGVuZE1vZGUsdH0saS5QYXJzZT1mdW5jdGlvbih0LHIsbil7dmFyIG89dC5uYW1lLHM9bmV3IGkobyx0LmNhcGFjaXR5LHIpO2lmKHQuaWQmJihzLmlkPXQuaWQpLHQudGV4dHVyZU5hbWUmJihzLnBhcnRpY2xlVGV4dHVyZT1uZXcgZS5UZXh0dXJlKG4rdC50ZXh0dXJlTmFtZSxyKSxzLnBhcnRpY2xlVGV4dHVyZS5uYW1lPXQudGV4dHVyZU5hbWUpLHQuZW1pdHRlcklkP3MuZW1pdHRlcj1yLmdldExhc3RNZXNoQnlJRCh0LmVtaXR0ZXJJZCk6cy5lbWl0dGVyPWUuVmVjdG9yMy5Gcm9tQXJyYXkodC5lbWl0dGVyKSx0LmFuaW1hdGlvbnMpZm9yKHZhciBhPTA7YTx0LmFuaW1hdGlvbnMubGVuZ3RoO2ErKyl7dmFyIGg9dC5hbmltYXRpb25zW2FdO3MuYW5pbWF0aW9ucy5wdXNoKGUuQW5pbWF0aW9uLlBhcnNlKGgpKX1yZXR1cm4gdC5hdXRvQW5pbWF0ZSYmci5iZWdpbkFuaW1hdGlvbihzLHQuYXV0b0FuaW1hdGVGcm9tLHQuYXV0b0FuaW1hdGVUbyx0LmF1dG9BbmltYXRlTG9vcCx0LmF1dG9BbmltYXRlU3BlZWR8fDEpLHMubWluQW5ndWxhclNwZWVkPXQubWluQW5ndWxhclNwZWVkLHMubWF4QW5ndWxhclNwZWVkPXQubWF4QW5ndWxhclNwZWVkLHMubWluU2l6ZT10Lm1pblNpemUscy5tYXhTaXplPXQubWF4U2l6ZSxzLm1pbkxpZmVUaW1lPXQubWluTGlmZVRpbWUscy5tYXhMaWZlVGltZT10Lm1heExpZmVUaW1lLHMubWluRW1pdFBvd2VyPXQubWluRW1pdFBvd2VyLHMubWF4RW1pdFBvd2VyPXQubWF4RW1pdFBvd2VyLHMuZW1pdFJhdGU9dC5lbWl0UmF0ZSxzLm1pbkVtaXRCb3g9ZS5WZWN0b3IzLkZyb21BcnJheSh0Lm1pbkVtaXRCb3gpLHMubWF4RW1pdEJveD1lLlZlY3RvcjMuRnJvbUFycmF5KHQubWF4RW1pdEJveCkscy5ncmF2aXR5PWUuVmVjdG9yMy5Gcm9tQXJyYXkodC5ncmF2aXR5KSxzLmRpcmVjdGlvbjE9ZS5WZWN0b3IzLkZyb21BcnJheSh0LmRpcmVjdGlvbjEpLHMuZGlyZWN0aW9uMj1lLlZlY3RvcjMuRnJvbUFycmF5KHQuZGlyZWN0aW9uMikscy5jb2xvcjE9ZS5Db2xvcjQuRnJvbUFycmF5KHQuY29sb3IxKSxzLmNvbG9yMj1lLkNvbG9yNC5Gcm9tQXJyYXkodC5jb2xvcjIpLHMuY29sb3JEZWFkPWUuQ29sb3I0LkZyb21BcnJheSh0LmNvbG9yRGVhZCkscy51cGRhdGVTcGVlZD10LnVwZGF0ZVNwZWVkLHMudGFyZ2V0U3RvcER1cmF0aW9uPXQudGFyZ2V0U3RvcER1cmF0aW9uLHMudGV4dHVyZU1hc2s9ZS5Db2xvcjQuRnJvbUFycmF5KHQudGV4dHVyZU1hc2spLHMuYmxlbmRNb2RlPXQuYmxlbmRNb2RlLHQucHJldmVudEF1dG9TdGFydHx8cy5zdGFydCgpLHN9LGkuQkxFTkRNT0RFX09ORU9ORT0wLGkuQkxFTkRNT0RFX1NUQU5EQVJEPTEsaX0oKTtlLlBhcnRpY2xlU3lzdGVtPWl9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlLHQsaSl7dGhpcy5uYW1lPWUsdGhpcy5mcm9tPXQsdGhpcy50bz1pfXJldHVybiBlLnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbigpe3JldHVybiBuZXcgZSh0aGlzLm5hbWUsdGhpcy5mcm9tLHRoaXMudG8pfSxlfSgpO2UuQW5pbWF0aW9uUmFuZ2U9dDt2YXIgaT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSx0LGkpe3RoaXMuZnJhbWU9ZSx0aGlzLmFjdGlvbj10LHRoaXMub25seU9uY2U9aSx0aGlzLmlzRG9uZT0hMX1yZXR1cm4gZX0oKTtlLkFuaW1hdGlvbkV2ZW50PWk7dmFyIHI9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KGUpe3RoaXMucGF0aD1lLHRoaXMuX29uY2hhbmdlPW5ldyBBcnJheSx0aGlzLnZhbHVlPTAsdGhpcy5hbmltYXRpb25zPW5ldyBBcnJheX1yZXR1cm4gdC5wcm90b3R5cGUuZ2V0UG9pbnQ9ZnVuY3Rpb24oKXt2YXIgdD10aGlzLnBhdGguZ2V0UG9pbnRBdExlbmd0aFBvc2l0aW9uKHRoaXMudmFsdWUpO3JldHVybiBuZXcgZS5WZWN0b3IzKHQueCwwLHQueSl9LHQucHJvdG90eXBlLm1vdmVBaGVhZD1mdW5jdGlvbihlKXtyZXR1cm4gdm9pZCAwPT09ZSYmKGU9LjAwMiksdGhpcy5tb3ZlKGUpLHRoaXN9LHQucHJvdG90eXBlLm1vdmVCYWNrPWZ1bmN0aW9uKGUpe3JldHVybiB2b2lkIDA9PT1lJiYoZT0uMDAyKSx0aGlzLm1vdmUoLWUpLHRoaXN9LHQucHJvdG90eXBlLm1vdmU9ZnVuY3Rpb24oZSl7aWYoTWF0aC5hYnMoZSk+MSl0aHJvd1wic3RlcCBzaXplIHNob3VsZCBiZSBsZXNzIHRoYW4gMS5cIjtyZXR1cm4gdGhpcy52YWx1ZSs9ZSx0aGlzLmVuc3VyZUxpbWl0cygpLHRoaXMucmFpc2VPbkNoYW5nZSgpLHRoaXN9LHQucHJvdG90eXBlLmVuc3VyZUxpbWl0cz1mdW5jdGlvbigpe2Zvcig7dGhpcy52YWx1ZT4xOyl0aGlzLnZhbHVlLT0xO2Zvcig7dGhpcy52YWx1ZTwwOyl0aGlzLnZhbHVlKz0xO3JldHVybiB0aGlzfSx0LnByb3RvdHlwZS5tYXJrQXNEaXJ0eT1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5lbnN1cmVMaW1pdHMoKSx0aGlzLnJhaXNlT25DaGFuZ2UoKSx0aGlzfSx0LnByb3RvdHlwZS5yYWlzZU9uQ2hhbmdlPWZ1bmN0aW9uKCl7dmFyIGU9dGhpcztyZXR1cm4gdGhpcy5fb25jaGFuZ2UuZm9yRWFjaChmdW5jdGlvbih0KXtyZXR1cm4gdChlKX0pLHRoaXN9LHQucHJvdG90eXBlLm9uY2hhbmdlPWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9vbmNoYW5nZS5wdXNoKGUpLHRoaXN9LHR9KCk7ZS5QYXRoQ3Vyc29yPXI7dmFyIG49ZnVuY3Rpb24oKXtmdW5jdGlvbiBpKGUsdCxyLG4sbyxzKXt0aGlzLm5hbWU9ZSx0aGlzLnRhcmdldFByb3BlcnR5PXQsdGhpcy5mcmFtZVBlclNlY29uZD1yLHRoaXMuZGF0YVR5cGU9bix0aGlzLmxvb3BNb2RlPW8sdGhpcy5lbmFibGVCbGVuZGluZz1zLHRoaXMuX29mZnNldHNDYWNoZT17fSx0aGlzLl9oaWdoTGltaXRzQ2FjaGU9e30sdGhpcy5fc3RvcHBlZD0hMSx0aGlzLl9ibGVuZGluZ0ZhY3Rvcj0wLHRoaXMuX2V2ZW50cz1uZXcgQXJyYXksdGhpcy5hbGxvd01hdHJpY2VzSW50ZXJwb2xhdGlvbj0hMSx0aGlzLmJsZW5kaW5nU3BlZWQ9LjAxLHRoaXMuX3Jhbmdlcz17fSx0aGlzLnRhcmdldFByb3BlcnR5UGF0aD10LnNwbGl0KFwiLlwiKSx0aGlzLmRhdGFUeXBlPW4sdGhpcy5sb29wTW9kZT12b2lkIDA9PT1vP2kuQU5JTUFUSU9OTE9PUE1PREVfQ1lDTEU6b31yZXR1cm4gaS5fUHJlcGFyZUFuaW1hdGlvbj1mdW5jdGlvbih0LHIsbixvLHMsYSxoLGMpe3ZhciBsPXZvaWQgMDtpZighaXNOYU4ocGFyc2VGbG9hdChzKSkmJmlzRmluaXRlKHMpP2w9aS5BTklNQVRJT05UWVBFX0ZMT0FUOnMgaW5zdGFuY2VvZiBlLlF1YXRlcm5pb24/bD1pLkFOSU1BVElPTlRZUEVfUVVBVEVSTklPTjpzIGluc3RhbmNlb2YgZS5WZWN0b3IzP2w9aS5BTklNQVRJT05UWVBFX1ZFQ1RPUjM6cyBpbnN0YW5jZW9mIGUuVmVjdG9yMj9sPWkuQU5JTUFUSU9OVFlQRV9WRUNUT1IyOnMgaW5zdGFuY2VvZiBlLkNvbG9yMz9sPWkuQU5JTUFUSU9OVFlQRV9DT0xPUjM6cyBpbnN0YW5jZW9mIGUuU2l6ZSYmKGw9aS5BTklNQVRJT05UWVBFX1NJWkUpLHZvaWQgMD09bClyZXR1cm4gbnVsbDt2YXIgdT1uZXcgaSh0LHIsbixsLGgpLGY9W107cmV0dXJuIGYucHVzaCh7ZnJhbWU6MCx2YWx1ZTpzfSksZi5wdXNoKHtmcmFtZTpvLHZhbHVlOmF9KSx1LnNldEtleXMoZiksdm9pZCAwIT09YyYmdS5zZXRFYXNpbmdGdW5jdGlvbihjKSx1fSxpLkNyZWF0ZUFuZFN0YXJ0QW5pbWF0aW9uPWZ1bmN0aW9uKGUsdCxyLG4sbyxzLGEsaCxjLGwpe3ZhciB1PWkuX1ByZXBhcmVBbmltYXRpb24oZSxyLG4sbyxzLGEsaCxjKTtyZXR1cm4gdC5nZXRTY2VuZSgpLmJlZ2luRGlyZWN0QW5pbWF0aW9uKHQsW3VdLDAsbywxPT09dS5sb29wTW9kZSwxLGwpfSxpLkNyZWF0ZU1lcmdlQW5kU3RhcnRBbmltYXRpb249ZnVuY3Rpb24oZSx0LHIsbixvLHMsYSxoLGMsbCl7dmFyIHU9aS5fUHJlcGFyZUFuaW1hdGlvbihlLHIsbixvLHMsYSxoLGMpO3JldHVybiB0LmFuaW1hdGlvbnMucHVzaCh1KSx0LmdldFNjZW5lKCkuYmVnaW5BbmltYXRpb24odCwwLG8sMT09PXUubG9vcE1vZGUsMSxsKX0saS5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oZSl7dmFyIHQ9XCJOYW1lOiBcIit0aGlzLm5hbWUrXCIsIHByb3BlcnR5OiBcIit0aGlzLnRhcmdldFByb3BlcnR5O2lmKHQrPVwiLCBkYXRhdHlwZTogXCIrW1wiRmxvYXRcIixcIlZlY3RvcjNcIixcIlF1YXRlcm5pb25cIixcIk1hdHJpeFwiLFwiQ29sb3IzXCIsXCJWZWN0b3IyXCJdW3RoaXMuZGF0YVR5cGVdLHQrPVwiLCBuS2V5czogXCIrKHRoaXMuX2tleXM/dGhpcy5fa2V5cy5sZW5ndGg6XCJub25lXCIpLHQrPVwiLCBuUmFuZ2VzOiBcIisodGhpcy5fcmFuZ2VzP09iamVjdC5rZXlzKHRoaXMuX3JhbmdlcykubGVuZ3RoOlwibm9uZVwiKSxlKXt0Kz1cIiwgUmFuZ2VzOiB7XCI7dmFyIGk9ITA7Zm9yKHZhciByIGluIHRoaXMuX3JhbmdlcylpJiYodCs9XCIsIFwiLGk9ITEpLHQrPXI7dCs9XCJ9XCJ9cmV0dXJuIHR9LGkucHJvdG90eXBlLmFkZEV2ZW50PWZ1bmN0aW9uKGUpe3RoaXMuX2V2ZW50cy5wdXNoKGUpfSxpLnByb3RvdHlwZS5yZW1vdmVFdmVudHM9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PTA7dDx0aGlzLl9ldmVudHMubGVuZ3RoO3QrKyl0aGlzLl9ldmVudHNbdF0uZnJhbWU9PT1lJiYodGhpcy5fZXZlbnRzLnNwbGljZSh0LDEpLHQtLSl9LGkucHJvdG90eXBlLmNyZWF0ZVJhbmdlPWZ1bmN0aW9uKGUsaSxyKXt0aGlzLl9yYW5nZXNbZV18fCh0aGlzLl9yYW5nZXNbZV09bmV3IHQoZSxpLHIpKX0saS5wcm90b3R5cGUuZGVsZXRlUmFuZ2U9ZnVuY3Rpb24oZSx0KXtpZih2b2lkIDA9PT10JiYodD0hMCksdGhpcy5fcmFuZ2VzW2VdKXtpZih0KWZvcih2YXIgaT10aGlzLl9yYW5nZXNbZV0uZnJvbSxyPXRoaXMuX3Jhbmdlc1tlXS50byxuPXRoaXMuX2tleXMubGVuZ3RoLTE7bj49MDtuLS0pdGhpcy5fa2V5c1tuXS5mcmFtZT49aSYmdGhpcy5fa2V5c1tuXS5mcmFtZTw9ciYmdGhpcy5fa2V5cy5zcGxpY2UobiwxKTt0aGlzLl9yYW5nZXNbZV09dm9pZCAwfX0saS5wcm90b3R5cGUuZ2V0UmFuZ2U9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX3Jhbmdlc1tlXX0saS5wcm90b3R5cGUucmVzZXQ9ZnVuY3Rpb24oKXt0aGlzLl9vZmZzZXRzQ2FjaGU9e30sdGhpcy5faGlnaExpbWl0c0NhY2hlPXt9LHRoaXMuY3VycmVudEZyYW1lPTAsdGhpcy5fYmxlbmRpbmdGYWN0b3I9MCx0aGlzLl9vcmlnaW5hbEJsZW5kVmFsdWU9bnVsbH0saS5wcm90b3R5cGUuaXNTdG9wcGVkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3N0b3BwZWR9LGkucHJvdG90eXBlLmdldEtleXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fa2V5c30saS5wcm90b3R5cGUuZ2V0SGlnaGVzdEZyYW1lPWZ1bmN0aW9uKCl7Zm9yKHZhciBlPTAsdD0wLGk9dGhpcy5fa2V5cy5sZW5ndGg7aT50O3QrKyllPHRoaXMuX2tleXNbdF0uZnJhbWUmJihlPXRoaXMuX2tleXNbdF0uZnJhbWUpO3JldHVybiBlfSxpLnByb3RvdHlwZS5nZXRFYXNpbmdGdW5jdGlvbj1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9lYXNpbmdGdW5jdGlvbn0saS5wcm90b3R5cGUuc2V0RWFzaW5nRnVuY3Rpb249ZnVuY3Rpb24oZSl7dGhpcy5fZWFzaW5nRnVuY3Rpb249ZX0saS5wcm90b3R5cGUuZmxvYXRJbnRlcnBvbGF0ZUZ1bmN0aW9uPWZ1bmN0aW9uKGUsdCxpKXtyZXR1cm4gZSsodC1lKSppfSxpLnByb3RvdHlwZS5xdWF0ZXJuaW9uSW50ZXJwb2xhdGVGdW5jdGlvbj1mdW5jdGlvbih0LGkscil7cmV0dXJuIGUuUXVhdGVybmlvbi5TbGVycCh0LGkscil9LGkucHJvdG90eXBlLnZlY3RvcjNJbnRlcnBvbGF0ZUZ1bmN0aW9uPWZ1bmN0aW9uKHQsaSxyKXtyZXR1cm4gZS5WZWN0b3IzLkxlcnAodCxpLHIpfSxpLnByb3RvdHlwZS52ZWN0b3IySW50ZXJwb2xhdGVGdW5jdGlvbj1mdW5jdGlvbih0LGkscil7cmV0dXJuIGUuVmVjdG9yMi5MZXJwKHQsaSxyKX0saS5wcm90b3R5cGUuc2l6ZUludGVycG9sYXRlRnVuY3Rpb249ZnVuY3Rpb24odCxpLHIpe3JldHVybiBlLlNpemUuTGVycCh0LGkscil9LGkucHJvdG90eXBlLmNvbG9yM0ludGVycG9sYXRlRnVuY3Rpb249ZnVuY3Rpb24odCxpLHIpe3JldHVybiBlLkNvbG9yMy5MZXJwKHQsaSxyKX0saS5wcm90b3R5cGUubWF0cml4SW50ZXJwb2xhdGVGdW5jdGlvbj1mdW5jdGlvbih0LGkscil7cmV0dXJuIGUuTWF0cml4LkxlcnAodCxpLHIpfSxpLnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbigpe3ZhciBlPW5ldyBpKHRoaXMubmFtZSx0aGlzLnRhcmdldFByb3BlcnR5UGF0aC5qb2luKFwiLlwiKSx0aGlzLmZyYW1lUGVyU2Vjb25kLHRoaXMuZGF0YVR5cGUsdGhpcy5sb29wTW9kZSk7aWYodGhpcy5fa2V5cyYmZS5zZXRLZXlzKHRoaXMuX2tleXMpLHRoaXMuX3Jhbmdlcyl7ZS5fcmFuZ2VzPXt9O2Zvcih2YXIgdCBpbiB0aGlzLl9yYW5nZXMpZS5fcmFuZ2VzW3RdPXRoaXMuX3Jhbmdlc1t0XS5jbG9uZSgpfXJldHVybiBlfSxpLnByb3RvdHlwZS5zZXRLZXlzPWZ1bmN0aW9uKGUpe3RoaXMuX2tleXM9ZS5zbGljZSgwKSx0aGlzLl9vZmZzZXRzQ2FjaGU9e30sdGhpcy5faGlnaExpbWl0c0NhY2hlPXt9fSxpLnByb3RvdHlwZS5fZ2V0S2V5VmFsdWU9ZnVuY3Rpb24oZSl7cmV0dXJuXCJmdW5jdGlvblwiPT10eXBlb2YgZT9lKCk6ZX0saS5wcm90b3R5cGUuX2ludGVycG9sYXRlPWZ1bmN0aW9uKGUsdCxyLG4sbyl7aWYocj09PWkuQU5JTUFUSU9OTE9PUE1PREVfQ09OU1RBTlQmJnQ+MClyZXR1cm4gby5jbG9uZT9vLmNsb25lKCk6bzt0aGlzLmN1cnJlbnRGcmFtZT1lO3ZhciBzPU1hdGgubWF4KDAsTWF0aC5taW4odGhpcy5fa2V5cy5sZW5ndGgtMSxNYXRoLmZsb29yKHRoaXMuX2tleXMubGVuZ3RoKihlLXRoaXMuX2tleXNbMF0uZnJhbWUpLyh0aGlzLl9rZXlzW3RoaXMuX2tleXMubGVuZ3RoLTFdLmZyYW1lLXRoaXMuX2tleXNbMF0uZnJhbWUpKS0xKSk7aWYodGhpcy5fa2V5c1tzXS5mcmFtZT49ZSlmb3IoO3MtMT49MCYmdGhpcy5fa2V5c1tzXS5mcmFtZT49ZTspcy0tO2Zvcih2YXIgYT1zO2E8dGhpcy5fa2V5cy5sZW5ndGg7YSsrKWlmKHRoaXMuX2tleXNbYSsxXS5mcmFtZT49ZSl7dmFyIGg9dGhpcy5fZ2V0S2V5VmFsdWUodGhpcy5fa2V5c1thXS52YWx1ZSksYz10aGlzLl9nZXRLZXlWYWx1ZSh0aGlzLl9rZXlzW2ErMV0udmFsdWUpLGw9KGUtdGhpcy5fa2V5c1thXS5mcmFtZSkvKHRoaXMuX2tleXNbYSsxXS5mcmFtZS10aGlzLl9rZXlzW2FdLmZyYW1lKTtzd2l0Y2gobnVsbCE9dGhpcy5fZWFzaW5nRnVuY3Rpb24mJihsPXRoaXMuX2Vhc2luZ0Z1bmN0aW9uLmVhc2UobCkpLHRoaXMuZGF0YVR5cGUpe2Nhc2UgaS5BTklNQVRJT05UWVBFX0ZMT0FUOnN3aXRjaChyKXtjYXNlIGkuQU5JTUFUSU9OTE9PUE1PREVfQ1lDTEU6Y2FzZSBpLkFOSU1BVElPTkxPT1BNT0RFX0NPTlNUQU5UOnJldHVybiB0aGlzLmZsb2F0SW50ZXJwb2xhdGVGdW5jdGlvbihoLGMsbCk7Y2FzZSBpLkFOSU1BVElPTkxPT1BNT0RFX1JFTEFUSVZFOnJldHVybiBuKnQrdGhpcy5mbG9hdEludGVycG9sYXRlRnVuY3Rpb24oaCxjLGwpfWJyZWFrO2Nhc2UgaS5BTklNQVRJT05UWVBFX1FVQVRFUk5JT046dmFyIHU9bnVsbDtzd2l0Y2gocil7Y2FzZSBpLkFOSU1BVElPTkxPT1BNT0RFX0NZQ0xFOmNhc2UgaS5BTklNQVRJT05MT09QTU9ERV9DT05TVEFOVDp1PXRoaXMucXVhdGVybmlvbkludGVycG9sYXRlRnVuY3Rpb24oaCxjLGwpO2JyZWFrO2Nhc2UgaS5BTklNQVRJT05MT09QTU9ERV9SRUxBVElWRTp1PXRoaXMucXVhdGVybmlvbkludGVycG9sYXRlRnVuY3Rpb24oaCxjLGwpLmFkZChuLnNjYWxlKHQpKX1yZXR1cm4gdTtjYXNlIGkuQU5JTUFUSU9OVFlQRV9WRUNUT1IzOnN3aXRjaChyKXtjYXNlIGkuQU5JTUFUSU9OTE9PUE1PREVfQ1lDTEU6Y2FzZSBpLkFOSU1BVElPTkxPT1BNT0RFX0NPTlNUQU5UOnJldHVybiB0aGlzLnZlY3RvcjNJbnRlcnBvbGF0ZUZ1bmN0aW9uKGgsYyxsKTtjYXNlIGkuQU5JTUFUSU9OTE9PUE1PREVfUkVMQVRJVkU6cmV0dXJuIHRoaXMudmVjdG9yM0ludGVycG9sYXRlRnVuY3Rpb24oaCxjLGwpLmFkZChuLnNjYWxlKHQpKX1jYXNlIGkuQU5JTUFUSU9OVFlQRV9WRUNUT1IyOnN3aXRjaChyKXtjYXNlIGkuQU5JTUFUSU9OTE9PUE1PREVfQ1lDTEU6Y2FzZSBpLkFOSU1BVElPTkxPT1BNT0RFX0NPTlNUQU5UOnJldHVybiB0aGlzLnZlY3RvcjJJbnRlcnBvbGF0ZUZ1bmN0aW9uKGgsYyxsKTtjYXNlIGkuQU5JTUFUSU9OTE9PUE1PREVfUkVMQVRJVkU6cmV0dXJuIHRoaXMudmVjdG9yMkludGVycG9sYXRlRnVuY3Rpb24oaCxjLGwpLmFkZChuLnNjYWxlKHQpKX1jYXNlIGkuQU5JTUFUSU9OVFlQRV9TSVpFOnN3aXRjaChyKXtjYXNlIGkuQU5JTUFUSU9OTE9PUE1PREVfQ1lDTEU6Y2FzZSBpLkFOSU1BVElPTkxPT1BNT0RFX0NPTlNUQU5UOnJldHVybiB0aGlzLnNpemVJbnRlcnBvbGF0ZUZ1bmN0aW9uKGgsYyxsKTtjYXNlIGkuQU5JTUFUSU9OTE9PUE1PREVfUkVMQVRJVkU6cmV0dXJuIHRoaXMuc2l6ZUludGVycG9sYXRlRnVuY3Rpb24oaCxjLGwpLmFkZChuLnNjYWxlKHQpKX1jYXNlIGkuQU5JTUFUSU9OVFlQRV9DT0xPUjM6c3dpdGNoKHIpe2Nhc2UgaS5BTklNQVRJT05MT09QTU9ERV9DWUNMRTpjYXNlIGkuQU5JTUFUSU9OTE9PUE1PREVfQ09OU1RBTlQ6cmV0dXJuIHRoaXMuY29sb3IzSW50ZXJwb2xhdGVGdW5jdGlvbihoLGMsbCk7Y2FzZSBpLkFOSU1BVElPTkxPT1BNT0RFX1JFTEFUSVZFOnJldHVybiB0aGlzLmNvbG9yM0ludGVycG9sYXRlRnVuY3Rpb24oaCxjLGwpLmFkZChuLnNjYWxlKHQpKX1jYXNlIGkuQU5JTUFUSU9OVFlQRV9NQVRSSVg6c3dpdGNoKHIpe2Nhc2UgaS5BTklNQVRJT05MT09QTU9ERV9DWUNMRTpjYXNlIGkuQU5JTUFUSU9OTE9PUE1PREVfQ09OU1RBTlQ6XG5pZih0aGlzLmFsbG93TWF0cmljZXNJbnRlcnBvbGF0aW9uKXJldHVybiB0aGlzLm1hdHJpeEludGVycG9sYXRlRnVuY3Rpb24oaCxjLGwpO2Nhc2UgaS5BTklNQVRJT05MT09QTU9ERV9SRUxBVElWRTpyZXR1cm4gaH19YnJlYWt9cmV0dXJuIHRoaXMuX2dldEtleVZhbHVlKHRoaXMuX2tleXNbdGhpcy5fa2V5cy5sZW5ndGgtMV0udmFsdWUpfSxpLnByb3RvdHlwZS5zZXRWYWx1ZT1mdW5jdGlvbih0LGkpe3ZvaWQgMD09PWkmJihpPSExKTt2YXIgcixuO2lmKHRoaXMudGFyZ2V0UHJvcGVydHlQYXRoLmxlbmd0aD4xKXtmb3IodmFyIG89dGhpcy5fdGFyZ2V0W3RoaXMudGFyZ2V0UHJvcGVydHlQYXRoWzBdXSxzPTE7czx0aGlzLnRhcmdldFByb3BlcnR5UGF0aC5sZW5ndGgtMTtzKyspbz1vW3RoaXMudGFyZ2V0UHJvcGVydHlQYXRoW3NdXTtyPXRoaXMudGFyZ2V0UHJvcGVydHlQYXRoW3RoaXMudGFyZ2V0UHJvcGVydHlQYXRoLmxlbmd0aC0xXSxuPW99ZWxzZSByPXRoaXMudGFyZ2V0UHJvcGVydHlQYXRoWzBdLG49dGhpcy5fdGFyZ2V0O3RoaXMuZW5hYmxlQmxlbmRpbmcmJnRoaXMuX2JsZW5kaW5nRmFjdG9yPD0xPyh0aGlzLl9vcmlnaW5hbEJsZW5kVmFsdWV8fChuW3JdLmNsb25lP3RoaXMuX29yaWdpbmFsQmxlbmRWYWx1ZT1uW3JdLmNsb25lKCk6dGhpcy5fb3JpZ2luYWxCbGVuZFZhbHVlPW5bcl0pLHRoaXMuX29yaWdpbmFsQmxlbmRWYWx1ZS5wcm90b3R5cGU/dGhpcy5fb3JpZ2luYWxCbGVuZFZhbHVlLnByb3RvdHlwZS5MZXJwP25bcl09dGhpcy5fb3JpZ2luYWxCbGVuZFZhbHVlLmNvbnN0cnV0b3IucHJvdG90eXBlLkxlcnAodCx0aGlzLl9vcmlnaW5hbEJsZW5kVmFsdWUsdGhpcy5fYmxlbmRpbmdGYWN0b3IpOm5bcl09dDp0aGlzLl9vcmlnaW5hbEJsZW5kVmFsdWUubT9uW3JdPWUuTWF0cml4LkxlcnAodGhpcy5fb3JpZ2luYWxCbGVuZFZhbHVlLHQsdGhpcy5fYmxlbmRpbmdGYWN0b3IpOm5bcl09dGhpcy5fb3JpZ2luYWxCbGVuZFZhbHVlKigxLXRoaXMuX2JsZW5kaW5nRmFjdG9yKSt0aGlzLl9ibGVuZGluZ0ZhY3Rvcip0LHRoaXMuX2JsZW5kaW5nRmFjdG9yKz10aGlzLmJsZW5kaW5nU3BlZWQpOm5bcl09dCx0aGlzLl90YXJnZXQubWFya0FzRGlydHkmJnRoaXMuX3RhcmdldC5tYXJrQXNEaXJ0eSh0aGlzLnRhcmdldFByb3BlcnR5KX0saS5wcm90b3R5cGUuZ29Ub0ZyYW1lPWZ1bmN0aW9uKGUpe2U8dGhpcy5fa2V5c1swXS5mcmFtZT9lPXRoaXMuX2tleXNbMF0uZnJhbWU6ZT50aGlzLl9rZXlzW3RoaXMuX2tleXMubGVuZ3RoLTFdLmZyYW1lJiYoZT10aGlzLl9rZXlzW3RoaXMuX2tleXMubGVuZ3RoLTFdLmZyYW1lKTt2YXIgdD10aGlzLl9pbnRlcnBvbGF0ZShlLDAsdGhpcy5sb29wTW9kZSk7dGhpcy5zZXRWYWx1ZSh0KX0saS5wcm90b3R5cGUuYW5pbWF0ZT1mdW5jdGlvbih0LHIsbixvLHMsYSl7aWYodm9pZCAwPT09YSYmKGE9ITEpLCF0aGlzLnRhcmdldFByb3BlcnR5UGF0aHx8dGhpcy50YXJnZXRQcm9wZXJ0eVBhdGgubGVuZ3RoPDEpcmV0dXJuIHRoaXMuX3N0b3BwZWQ9ITAsITE7dmFyIGg9ITA7aWYoMCE9PXRoaXMuX2tleXNbMF0uZnJhbWUpe3ZhciBjPXtmcmFtZTowLHZhbHVlOnRoaXMuX2tleXNbMF0udmFsdWV9O3RoaXMuX2tleXMuc3BsaWNlKDAsMCxjKX0ocjx0aGlzLl9rZXlzWzBdLmZyYW1lfHxyPnRoaXMuX2tleXNbdGhpcy5fa2V5cy5sZW5ndGgtMV0uZnJhbWUpJiYocj10aGlzLl9rZXlzWzBdLmZyYW1lKSwobjx0aGlzLl9rZXlzWzBdLmZyYW1lfHxuPnRoaXMuX2tleXNbdGhpcy5fa2V5cy5sZW5ndGgtMV0uZnJhbWUpJiYobj10aGlzLl9rZXlzW3RoaXMuX2tleXMubGVuZ3RoLTFdLmZyYW1lKTt2YXIgbCx1PW4tcixmPXQqKHRoaXMuZnJhbWVQZXJTZWNvbmQqcykvMWUzLGQ9MDtpZihmPnUmJiFvKWg9ITEsZD10aGlzLl9nZXRLZXlWYWx1ZSh0aGlzLl9rZXlzW3RoaXMuX2tleXMubGVuZ3RoLTFdLnZhbHVlKTtlbHNlIGlmKHRoaXMubG9vcE1vZGUhPT1pLkFOSU1BVElPTkxPT1BNT0RFX0NZQ0xFKXt2YXIgcD1uLnRvU3RyaW5nKCkrci50b1N0cmluZygpO2lmKCF0aGlzLl9vZmZzZXRzQ2FjaGVbcF0pe3ZhciBfPXRoaXMuX2ludGVycG9sYXRlKHIsMCxpLkFOSU1BVElPTkxPT1BNT0RFX0NZQ0xFKSxtPXRoaXMuX2ludGVycG9sYXRlKG4sMCxpLkFOSU1BVElPTkxPT1BNT0RFX0NZQ0xFKTtzd2l0Y2godGhpcy5kYXRhVHlwZSl7Y2FzZSBpLkFOSU1BVElPTlRZUEVfRkxPQVQ6dGhpcy5fb2Zmc2V0c0NhY2hlW3BdPW0tXzticmVhaztjYXNlIGkuQU5JTUFUSU9OVFlQRV9RVUFURVJOSU9OOnRoaXMuX29mZnNldHNDYWNoZVtwXT1tLnN1YnRyYWN0KF8pO2JyZWFrO2Nhc2UgaS5BTklNQVRJT05UWVBFX1ZFQ1RPUjM6dGhpcy5fb2Zmc2V0c0NhY2hlW3BdPW0uc3VidHJhY3QoXyk7Y2FzZSBpLkFOSU1BVElPTlRZUEVfVkVDVE9SMjp0aGlzLl9vZmZzZXRzQ2FjaGVbcF09bS5zdWJ0cmFjdChfKTtjYXNlIGkuQU5JTUFUSU9OVFlQRV9TSVpFOnRoaXMuX29mZnNldHNDYWNoZVtwXT1tLnN1YnRyYWN0KF8pO2Nhc2UgaS5BTklNQVRJT05UWVBFX0NPTE9SMzp0aGlzLl9vZmZzZXRzQ2FjaGVbcF09bS5zdWJ0cmFjdChfKX10aGlzLl9oaWdoTGltaXRzQ2FjaGVbcF09bX1kPXRoaXMuX2hpZ2hMaW1pdHNDYWNoZVtwXSxsPXRoaXMuX29mZnNldHNDYWNoZVtwXX1pZih2b2lkIDA9PT1sKXN3aXRjaCh0aGlzLmRhdGFUeXBlKXtjYXNlIGkuQU5JTUFUSU9OVFlQRV9GTE9BVDpsPTA7YnJlYWs7Y2FzZSBpLkFOSU1BVElPTlRZUEVfUVVBVEVSTklPTjpsPW5ldyBlLlF1YXRlcm5pb24oMCwwLDAsMCk7YnJlYWs7Y2FzZSBpLkFOSU1BVElPTlRZUEVfVkVDVE9SMzpsPWUuVmVjdG9yMy5aZXJvKCk7YnJlYWs7Y2FzZSBpLkFOSU1BVElPTlRZUEVfVkVDVE9SMjpsPWUuVmVjdG9yMi5aZXJvKCk7YnJlYWs7Y2FzZSBpLkFOSU1BVElPTlRZUEVfU0laRTpsPWUuU2l6ZS5aZXJvKCk7YnJlYWs7Y2FzZSBpLkFOSU1BVElPTlRZUEVfQ09MT1IzOmw9ZS5Db2xvcjMuQmxhY2soKX12YXIgZz1mL3U+PjAsdj1oP3IrZiV1Om4seT10aGlzLl9pbnRlcnBvbGF0ZSh2LGcsdGhpcy5sb29wTW9kZSxsLGQpO3RoaXMuc2V0VmFsdWUoeSk7Zm9yKHZhciB4PTA7eDx0aGlzLl9ldmVudHMubGVuZ3RoO3grKylpZih2Pj10aGlzLl9ldmVudHNbeF0uZnJhbWUpe3ZhciBiPXRoaXMuX2V2ZW50c1t4XTtiLmlzRG9uZXx8KGIub25seU9uY2UmJih0aGlzLl9ldmVudHMuc3BsaWNlKHgsMSkseC0tKSxiLmlzRG9uZT0hMCxiLmFjdGlvbigpKX1lbHNlIHRoaXMuX2V2ZW50c1t4XS5pc0RvbmUmJiF0aGlzLl9ldmVudHNbeF0ub25seU9uY2UmJih0aGlzLl9ldmVudHNbeF0uaXNEb25lPSExKTtyZXR1cm4gaHx8KHRoaXMuX3N0b3BwZWQ9ITApLGh9LGkucHJvdG90eXBlLnNlcmlhbGl6ZT1mdW5jdGlvbigpe3ZhciBlPXt9O2UubmFtZT10aGlzLm5hbWUsZS5wcm9wZXJ0eT10aGlzLnRhcmdldFByb3BlcnR5LGUuZnJhbWVQZXJTZWNvbmQ9dGhpcy5mcmFtZVBlclNlY29uZCxlLmRhdGFUeXBlPXRoaXMuZGF0YVR5cGUsZS5sb29wQmVoYXZpb3I9dGhpcy5sb29wTW9kZTt2YXIgdD10aGlzLmRhdGFUeXBlO2Uua2V5cz1bXTtmb3IodmFyIHI9dGhpcy5nZXRLZXlzKCksbj0wO248ci5sZW5ndGg7bisrKXt2YXIgbz1yW25dLHM9e307c3dpdGNoKHMuZnJhbWU9by5mcmFtZSx0KXtjYXNlIGkuQU5JTUFUSU9OVFlQRV9GTE9BVDpzLnZhbHVlcz1bby52YWx1ZV07YnJlYWs7Y2FzZSBpLkFOSU1BVElPTlRZUEVfUVVBVEVSTklPTjpjYXNlIGkuQU5JTUFUSU9OVFlQRV9NQVRSSVg6Y2FzZSBpLkFOSU1BVElPTlRZUEVfVkVDVE9SMzpjYXNlIGkuQU5JTUFUSU9OVFlQRV9DT0xPUjM6cy52YWx1ZXM9by52YWx1ZS5hc0FycmF5KCl9ZS5rZXlzLnB1c2gocyl9ZS5yYW5nZXM9W107Zm9yKHZhciBhIGluIHRoaXMuX3Jhbmdlcyl7dmFyIGg9e307aC5uYW1lPWEsaC5mcm9tPXRoaXMuX3Jhbmdlc1thXS5mcm9tLGgudG89dGhpcy5fcmFuZ2VzW2FdLnRvLGUucmFuZ2VzLnB1c2goaCl9cmV0dXJuIGV9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLFwiQU5JTUFUSU9OVFlQRV9GTE9BVFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gaS5fQU5JTUFUSU9OVFlQRV9GTE9BVH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaSxcIkFOSU1BVElPTlRZUEVfVkVDVE9SM1wiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gaS5fQU5JTUFUSU9OVFlQRV9WRUNUT1IzfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLFwiQU5JTUFUSU9OVFlQRV9WRUNUT1IyXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBpLl9BTklNQVRJT05UWVBFX1ZFQ1RPUjJ9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGksXCJBTklNQVRJT05UWVBFX1NJWkVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGkuX0FOSU1BVElPTlRZUEVfU0laRX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaSxcIkFOSU1BVElPTlRZUEVfUVVBVEVSTklPTlwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gaS5fQU5JTUFUSU9OVFlQRV9RVUFURVJOSU9OfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLFwiQU5JTUFUSU9OVFlQRV9NQVRSSVhcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGkuX0FOSU1BVElPTlRZUEVfTUFUUklYfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLFwiQU5JTUFUSU9OVFlQRV9DT0xPUjNcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGkuX0FOSU1BVElPTlRZUEVfQ09MT1IzfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLFwiQU5JTUFUSU9OTE9PUE1PREVfUkVMQVRJVkVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGkuX0FOSU1BVElPTkxPT1BNT0RFX1JFTEFUSVZFfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLFwiQU5JTUFUSU9OTE9PUE1PREVfQ1lDTEVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGkuX0FOSU1BVElPTkxPT1BNT0RFX0NZQ0xFfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLFwiQU5JTUFUSU9OTE9PUE1PREVfQ09OU1RBTlRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGkuX0FOSU1BVElPTkxPT1BNT0RFX0NPTlNUQU5UfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLGkuUGFyc2U9ZnVuY3Rpb24odCl7dmFyIHIsbixvPW5ldyBpKHQubmFtZSx0LnByb3BlcnR5LHQuZnJhbWVQZXJTZWNvbmQsdC5kYXRhVHlwZSx0Lmxvb3BCZWhhdmlvcikscz10LmRhdGFUeXBlLGE9W107Zm9yKG49MDtuPHQua2V5cy5sZW5ndGg7bisrKXt2YXIgaD10LmtleXNbbl07c3dpdGNoKHMpe2Nhc2UgaS5BTklNQVRJT05UWVBFX0ZMT0FUOnI9aC52YWx1ZXNbMF07YnJlYWs7Y2FzZSBpLkFOSU1BVElPTlRZUEVfUVVBVEVSTklPTjpyPWUuUXVhdGVybmlvbi5Gcm9tQXJyYXkoaC52YWx1ZXMpO2JyZWFrO2Nhc2UgaS5BTklNQVRJT05UWVBFX01BVFJJWDpyPWUuTWF0cml4LkZyb21BcnJheShoLnZhbHVlcyk7YnJlYWs7Y2FzZSBpLkFOSU1BVElPTlRZUEVfQ09MT1IzOnI9ZS5Db2xvcjMuRnJvbUFycmF5KGgudmFsdWVzKTticmVhaztjYXNlIGkuQU5JTUFUSU9OVFlQRV9WRUNUT1IzOmRlZmF1bHQ6cj1lLlZlY3RvcjMuRnJvbUFycmF5KGgudmFsdWVzKX1hLnB1c2goe2ZyYW1lOmguZnJhbWUsdmFsdWU6cn0pfWlmKG8uc2V0S2V5cyhhKSx0LnJhbmdlcylmb3Iobj0wO248dC5yYW5nZXMubGVuZ3RoO24rKylyPXQucmFuZ2VzW25dLG8uY3JlYXRlUmFuZ2Uoci5uYW1lLHIuZnJvbSxyLnRvKTtyZXR1cm4gb30saS5BcHBlbmRTZXJpYWxpemVkQW5pbWF0aW9ucz1mdW5jdGlvbihlLHQpe2lmKGUuYW5pbWF0aW9ucyl7dC5hbmltYXRpb25zPVtdO2Zvcih2YXIgaT0wO2k8ZS5hbmltYXRpb25zLmxlbmd0aDtpKyspe3ZhciByPWUuYW5pbWF0aW9uc1tpXTt0LmFuaW1hdGlvbnMucHVzaChyLnNlcmlhbGl6ZSgpKX19fSxpLl9BTklNQVRJT05UWVBFX0ZMT0FUPTAsaS5fQU5JTUFUSU9OVFlQRV9WRUNUT1IzPTEsaS5fQU5JTUFUSU9OVFlQRV9RVUFURVJOSU9OPTIsaS5fQU5JTUFUSU9OVFlQRV9NQVRSSVg9MyxpLl9BTklNQVRJT05UWVBFX0NPTE9SMz00LGkuX0FOSU1BVElPTlRZUEVfVkVDVE9SMj01LGkuX0FOSU1BVElPTlRZUEVfU0laRT02LGkuX0FOSU1BVElPTkxPT1BNT0RFX1JFTEFUSVZFPTAsaS5fQU5JTUFUSU9OTE9PUE1PREVfQ1lDTEU9MSxpLl9BTklNQVRJT05MT09QTU9ERV9DT05TVEFOVD0yLGl9KCk7ZS5BbmltYXRpb249bn0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUsdCxpLHIsbixvLHMsYSl7dm9pZCAwPT09aSYmKGk9MCksdm9pZCAwPT09ciYmKHI9MTAwKSx2b2lkIDA9PT1uJiYobj0hMSksdm9pZCAwPT09byYmKG89MSksdGhpcy50YXJnZXQ9dCx0aGlzLmZyb21GcmFtZT1pLHRoaXMudG9GcmFtZT1yLHRoaXMubG9vcEFuaW1hdGlvbj1uLHRoaXMuc3BlZWRSYXRpbz1vLHRoaXMub25BbmltYXRpb25FbmQ9cyx0aGlzLl9hbmltYXRpb25zPW5ldyBBcnJheSx0aGlzLl9wYXVzZWQ9ITEsdGhpcy5hbmltYXRpb25TdGFydGVkPSExLGEmJnRoaXMuYXBwZW5kQW5pbWF0aW9ucyh0LGEpLHRoaXMuX3NjZW5lPWUsZS5fYWN0aXZlQW5pbWF0YWJsZXMucHVzaCh0aGlzKX1yZXR1cm4gZS5wcm90b3R5cGUuZ2V0QW5pbWF0aW9ucz1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9hbmltYXRpb25zfSxlLnByb3RvdHlwZS5hcHBlbmRBbmltYXRpb25zPWZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBpPTA7aTx0Lmxlbmd0aDtpKyspe3ZhciByPXRbaV07ci5fdGFyZ2V0PWUsdGhpcy5fYW5pbWF0aW9ucy5wdXNoKHIpfX0sZS5wcm90b3R5cGUuZ2V0QW5pbWF0aW9uQnlUYXJnZXRQcm9wZXJ0eT1mdW5jdGlvbihlKXtmb3IodmFyIHQ9dGhpcy5fYW5pbWF0aW9ucyxpPTA7aTx0Lmxlbmd0aDtpKyspaWYodFtpXS50YXJnZXRQcm9wZXJ0eT09PWUpcmV0dXJuIHRbaV07cmV0dXJuIG51bGx9LGUucHJvdG90eXBlLnJlc2V0PWZ1bmN0aW9uKCl7Zm9yKHZhciBlPXRoaXMuX2FuaW1hdGlvbnMsdD0wO3Q8ZS5sZW5ndGg7dCsrKWVbdF0ucmVzZXQoKTt0aGlzLl9sb2NhbERlbGF5T2Zmc2V0PW51bGwsdGhpcy5fcGF1c2VkRGVsYXk9bnVsbH0sZS5wcm90b3R5cGUuZW5hYmxlQmxlbmRpbmc9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PXRoaXMuX2FuaW1hdGlvbnMsaT0wO2k8dC5sZW5ndGg7aSsrKXRbaV0uZW5hYmxlQmxlbmRpbmc9ITAsdFtpXS5ibGVuZGluZ1NwZWVkPWV9LGUucHJvdG90eXBlLmRpc2FibGVCbGVuZGluZz1mdW5jdGlvbigpe2Zvcih2YXIgZT10aGlzLl9hbmltYXRpb25zLHQ9MDt0PGUubGVuZ3RoO3QrKyllW3RdLmVuYWJsZUJsZW5kaW5nPSExfSxlLnByb3RvdHlwZS5nb1RvRnJhbWU9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PXRoaXMuX2FuaW1hdGlvbnMsaT0wO2k8dC5sZW5ndGg7aSsrKXRbaV0uZ29Ub0ZyYW1lKGUpfSxlLnByb3RvdHlwZS5wYXVzZT1mdW5jdGlvbigpe3RoaXMuX3BhdXNlZHx8KHRoaXMuX3BhdXNlZD0hMCl9LGUucHJvdG90eXBlLnJlc3RhcnQ9ZnVuY3Rpb24oKXt0aGlzLl9wYXVzZWQ9ITF9LGUucHJvdG90eXBlLnN0b3A9ZnVuY3Rpb24oKXt2YXIgZT10aGlzLl9zY2VuZS5fYWN0aXZlQW5pbWF0YWJsZXMuaW5kZXhPZih0aGlzKTtpZihlPi0xKXt0aGlzLl9zY2VuZS5fYWN0aXZlQW5pbWF0YWJsZXMuc3BsaWNlKGUsMSk7Zm9yKHZhciB0PXRoaXMuX2FuaW1hdGlvbnMsZT0wO2U8dC5sZW5ndGg7ZSsrKXRbZV0ucmVzZXQoKTt0aGlzLm9uQW5pbWF0aW9uRW5kJiZ0aGlzLm9uQW5pbWF0aW9uRW5kKCl9fSxlLnByb3RvdHlwZS5fYW5pbWF0ZT1mdW5jdGlvbihlKXtpZih0aGlzLl9wYXVzZWQpcmV0dXJuIHRoaXMuYW5pbWF0aW9uU3RhcnRlZD0hMSx0aGlzLl9wYXVzZWREZWxheXx8KHRoaXMuX3BhdXNlZERlbGF5PWUpLCEwO3RoaXMuX2xvY2FsRGVsYXlPZmZzZXQ/dGhpcy5fcGF1c2VkRGVsYXkmJih0aGlzLl9sb2NhbERlbGF5T2Zmc2V0Kz1lLXRoaXMuX3BhdXNlZERlbGF5LHRoaXMuX3BhdXNlZERlbGF5PW51bGwpOnRoaXMuX2xvY2FsRGVsYXlPZmZzZXQ9ZTt2YXIgdCxpPSExLHI9dGhpcy5fYW5pbWF0aW9ucztmb3IodD0wO3Q8ci5sZW5ndGg7dCsrKXt2YXIgbj1yW3RdLG89bi5hbmltYXRlKGUtdGhpcy5fbG9jYWxEZWxheU9mZnNldCx0aGlzLmZyb21GcmFtZSx0aGlzLnRvRnJhbWUsdGhpcy5sb29wQW5pbWF0aW9uLHRoaXMuc3BlZWRSYXRpbyk7aT1pfHxvfXJldHVybiB0aGlzLmFuaW1hdGlvblN0YXJ0ZWQ9aSxpfHwodD10aGlzLl9zY2VuZS5fYWN0aXZlQW5pbWF0YWJsZXMuaW5kZXhPZih0aGlzKSx0aGlzLl9zY2VuZS5fYWN0aXZlQW5pbWF0YWJsZXMuc3BsaWNlKHQsMSkpLCFpJiZ0aGlzLm9uQW5pbWF0aW9uRW5kJiYodGhpcy5vbkFuaW1hdGlvbkVuZCgpLHRoaXMub25BbmltYXRpb25FbmQ9bnVsbCksaX0sZX0oKTtlLkFuaW1hdGFibGU9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7dGhpcy5fZWFzaW5nTW9kZT1lLkVBU0lOR01PREVfRUFTRUlOfXJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkoZSxcIkVBU0lOR01PREVfRUFTRUlOXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBlLl9FQVNJTkdNT0RFX0VBU0VJTn0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZSxcIkVBU0lOR01PREVfRUFTRU9VVFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gZS5fRUFTSU5HTU9ERV9FQVNFT1VUfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLFwiRUFTSU5HTU9ERV9FQVNFSU5PVVRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGUuX0VBU0lOR01PREVfRUFTRUlOT1VUfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLGUucHJvdG90eXBlLnNldEVhc2luZ01vZGU9ZnVuY3Rpb24oZSl7dmFyIHQ9TWF0aC5taW4oTWF0aC5tYXgoZSwwKSwyKTt0aGlzLl9lYXNpbmdNb2RlPXR9LGUucHJvdG90eXBlLmdldEVhc2luZ01vZGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZWFzaW5nTW9kZX0sZS5wcm90b3R5cGUuZWFzZUluQ29yZT1mdW5jdGlvbihlKXt0aHJvdyBuZXcgRXJyb3IoXCJZb3UgbXVzdCBpbXBsZW1lbnQgdGhpcyBtZXRob2RcIil9LGUucHJvdG90eXBlLmVhc2U9ZnVuY3Rpb24odCl7c3dpdGNoKHRoaXMuX2Vhc2luZ01vZGUpe2Nhc2UgZS5FQVNJTkdNT0RFX0VBU0VJTjpyZXR1cm4gdGhpcy5lYXNlSW5Db3JlKHQpO2Nhc2UgZS5FQVNJTkdNT0RFX0VBU0VPVVQ6cmV0dXJuIDEtdGhpcy5lYXNlSW5Db3JlKDEtdCl9cmV0dXJuIHQ+PS41Py41KigxLXRoaXMuZWFzZUluQ29yZSgyKigxLXQpKSkrLjU6LjUqdGhpcy5lYXNlSW5Db3JlKDIqdCl9LGUuX0VBU0lOR01PREVfRUFTRUlOPTAsZS5fRUFTSU5HTU9ERV9FQVNFT1VUPTEsZS5fRUFTSU5HTU9ERV9FQVNFSU5PVVQ9MixlfSgpO2UuRWFzaW5nRnVuY3Rpb249dDt2YXIgaT1mdW5jdGlvbihlKXtmdW5jdGlvbiB0KCl7ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9cmV0dXJuIF9fZXh0ZW5kcyh0LGUpLHQucHJvdG90eXBlLmVhc2VJbkNvcmU9ZnVuY3Rpb24oZSl7cmV0dXJuIGU9TWF0aC5tYXgoMCxNYXRoLm1pbigxLGUpKSwxLU1hdGguc3FydCgxLWUqZSl9LHR9KHQpO2UuQ2lyY2xlRWFzZT1pO3ZhciByPWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQodCl7dm9pZCAwPT09dCYmKHQ9MSksZS5jYWxsKHRoaXMpLHRoaXMuYW1wbGl0dWRlPXR9cmV0dXJuIF9fZXh0ZW5kcyh0LGUpLHQucHJvdG90eXBlLmVhc2VJbkNvcmU9ZnVuY3Rpb24oZSl7dmFyIHQ9TWF0aC5tYXgoMCx0aGlzLmFtcGxpdHVkZSk7cmV0dXJuIE1hdGgucG93KGUsMyktZSp0Kk1hdGguc2luKDMuMTQxNTkyNjUzNTg5NzkzKmUpfSx0fSh0KTtlLkJhY2tFYXNlPXI7dmFyIG49ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdCh0LGkpe3ZvaWQgMD09PXQmJih0PTMpLHZvaWQgMD09PWkmJihpPTIpLGUuY2FsbCh0aGlzKSx0aGlzLmJvdW5jZXM9dCx0aGlzLmJvdW5jaW5lc3M9aX1yZXR1cm4gX19leHRlbmRzKHQsZSksdC5wcm90b3R5cGUuZWFzZUluQ29yZT1mdW5jdGlvbihlKXt2YXIgdD1NYXRoLm1heCgwLHRoaXMuYm91bmNlcyksaT10aGlzLmJvdW5jaW5lc3M7MT49aSYmKGk9MS4wMDEpO3ZhciByPU1hdGgucG93KGksdCksbj0xLWksbz0oMS1yKS9uKy41KnIscz1lKm8sYT1NYXRoLmxvZygtcyooMS1pKSsxKS9NYXRoLmxvZyhpKSxoPU1hdGguZmxvb3IoYSksYz1oKzEsbD0oMS1NYXRoLnBvdyhpLGgpKS8obipvKSx1PSgxLU1hdGgucG93KGksYykpLyhuKm8pLGY9LjUqKGwrdSksZD1lLWYscD1mLWw7cmV0dXJuLU1hdGgucG93KDEvaSx0LWgpLyhwKnApKihkLXApKihkK3ApfSx0fSh0KTtlLkJvdW5jZUVhc2U9bjt2YXIgbz1mdW5jdGlvbihlKXtmdW5jdGlvbiB0KCl7ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9cmV0dXJuIF9fZXh0ZW5kcyh0LGUpLHQucHJvdG90eXBlLmVhc2VJbkNvcmU9ZnVuY3Rpb24oZSl7cmV0dXJuIGUqZSplfSx0fSh0KTtlLkN1YmljRWFzZT1vO3ZhciBzPWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQodCxpKXt2b2lkIDA9PT10JiYodD0zKSx2b2lkIDA9PT1pJiYoaT0zKSxlLmNhbGwodGhpcyksdGhpcy5vc2NpbGxhdGlvbnM9dCx0aGlzLnNwcmluZ2luZXNzPWl9cmV0dXJuIF9fZXh0ZW5kcyh0LGUpLHQucHJvdG90eXBlLmVhc2VJbkNvcmU9ZnVuY3Rpb24oZSl7dmFyIHQsaT1NYXRoLm1heCgwLHRoaXMub3NjaWxsYXRpb25zKSxyPU1hdGgubWF4KDAsdGhpcy5zcHJpbmdpbmVzcyk7cmV0dXJuIHQ9MD09cj9lOihNYXRoLmV4cChyKmUpLTEpLyhNYXRoLmV4cChyKS0xKSx0Kk1hdGguc2luKCg2LjI4MzE4NTMwNzE3OTU4NippKzEuNTcwNzk2MzI2Nzk0ODk2NikqZSl9LHR9KHQpO2UuRWxhc3RpY0Vhc2U9czt2YXIgYT1mdW5jdGlvbihlKXtmdW5jdGlvbiB0KHQpe3ZvaWQgMD09PXQmJih0PTIpLGUuY2FsbCh0aGlzKSx0aGlzLmV4cG9uZW50PXR9cmV0dXJuIF9fZXh0ZW5kcyh0LGUpLHQucHJvdG90eXBlLmVhc2VJbkNvcmU9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuZXhwb25lbnQ8PTA/ZTooTWF0aC5leHAodGhpcy5leHBvbmVudCplKS0xKS8oTWF0aC5leHAodGhpcy5leHBvbmVudCktMSl9LHR9KHQpO2UuRXhwb25lbnRpYWxFYXNlPWE7dmFyIGg9ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdCh0KXt2b2lkIDA9PT10JiYodD0yKSxlLmNhbGwodGhpcyksdGhpcy5wb3dlcj10fXJldHVybiBfX2V4dGVuZHModCxlKSx0LnByb3RvdHlwZS5lYXNlSW5Db3JlPWZ1bmN0aW9uKGUpe3ZhciB0PU1hdGgubWF4KDAsdGhpcy5wb3dlcik7cmV0dXJuIE1hdGgucG93KGUsdCl9LHR9KHQpO2UuUG93ZXJFYXNlPWg7dmFyIGM9ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdCgpe2UuYXBwbHkodGhpcyxhcmd1bWVudHMpfXJldHVybiBfX2V4dGVuZHModCxlKSx0LnByb3RvdHlwZS5lYXNlSW5Db3JlPWZ1bmN0aW9uKGUpe3JldHVybiBlKmV9LHR9KHQpO2UuUXVhZHJhdGljRWFzZT1jO3ZhciBsPWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQoKXtlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX1yZXR1cm4gX19leHRlbmRzKHQsZSksdC5wcm90b3R5cGUuZWFzZUluQ29yZT1mdW5jdGlvbihlKXtyZXR1cm4gZSplKmUqZX0sdH0odCk7ZS5RdWFydGljRWFzZT1sO3ZhciB1PWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQoKXtlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX1yZXR1cm4gX19leHRlbmRzKHQsZSksdC5wcm90b3R5cGUuZWFzZUluQ29yZT1mdW5jdGlvbihlKXtyZXR1cm4gZSplKmUqZSplfSx0fSh0KTtlLlF1aW50aWNFYXNlPXU7dmFyIGY9ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdCgpe2UuYXBwbHkodGhpcyxhcmd1bWVudHMpfXJldHVybiBfX2V4dGVuZHModCxlKSx0LnByb3RvdHlwZS5lYXNlSW5Db3JlPWZ1bmN0aW9uKGUpe3JldHVybiAxLU1hdGguc2luKDEuNTcwNzk2MzI2Nzk0ODk2NiooMS1lKSl9LHR9KHQpO2UuU2luZUVhc2U9Zjt2YXIgZD1mdW5jdGlvbih0KXtmdW5jdGlvbiBpKGUsaSxyLG4pe3ZvaWQgMD09PWUmJihlPTApLHZvaWQgMD09PWkmJihpPTApLHZvaWQgMD09PXImJihyPTEpLHZvaWQgMD09PW4mJihuPTEpLHQuY2FsbCh0aGlzKSx0aGlzLngxPWUsdGhpcy55MT1pLHRoaXMueDI9cix0aGlzLnkyPW59cmV0dXJuIF9fZXh0ZW5kcyhpLHQpLGkucHJvdG90eXBlLmVhc2VJbkNvcmU9ZnVuY3Rpb24odCl7cmV0dXJuIGUuQmV6aWVyQ3VydmUuaW50ZXJwb2xhdGUodCx0aGlzLngxLHRoaXMueTEsdGhpcy54Mix0aGlzLnkyKX0saX0odCk7ZS5CZXppZXJDdXJ2ZUVhc2U9ZH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gaShpLHIsbixvLHMpe3QuY2FsbCh0aGlzLGksci5nZXRTY2VuZSgpKSx0aGlzLm5hbWU9aSx0aGlzLmNoaWxkcmVuPW5ldyBBcnJheSx0aGlzLmFuaW1hdGlvbnM9bmV3IEFycmF5LHRoaXMuX3dvcmxkVHJhbnNmb3JtPW5ldyBlLk1hdHJpeCx0aGlzLl9hYnNvbHV0ZVRyYW5zZm9ybT1uZXcgZS5NYXRyaXgsdGhpcy5faW52ZXJ0ZWRBYnNvbHV0ZVRyYW5zZm9ybT1uZXcgZS5NYXRyaXgsdGhpcy5fc2tlbGV0b249cix0aGlzLl9tYXRyaXg9byx0aGlzLl9iYXNlTWF0cml4PW8sdGhpcy5fcmVzdFBvc2U9cz9zOm8uY2xvbmUoKSxyLmJvbmVzLnB1c2godGhpcyksbj8odGhpcy5fcGFyZW50PW4sbi5jaGlsZHJlbi5wdXNoKHRoaXMpKTp0aGlzLl9wYXJlbnQ9bnVsbCx0aGlzLl91cGRhdGVEaWZmZXJlbmNlTWF0cml4KCl9cmV0dXJuIF9fZXh0ZW5kcyhpLHQpLGkucHJvdG90eXBlLmdldFBhcmVudD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9wYXJlbnR9LGkucHJvdG90eXBlLmdldExvY2FsTWF0cml4PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX21hdHJpeH0saS5wcm90b3R5cGUuZ2V0QmFzZU1hdHJpeD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9iYXNlTWF0cml4fSxpLnByb3RvdHlwZS5nZXRSZXN0UG9zZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9yZXN0UG9zZX0saS5wcm90b3R5cGUucmV0dXJuVG9SZXN0PWZ1bmN0aW9uKCl7dGhpcy51cGRhdGVNYXRyaXgodGhpcy5fcmVzdFBvc2UuY2xvbmUoKSl9LGkucHJvdG90eXBlLmdldFdvcmxkTWF0cml4PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3dvcmxkVHJhbnNmb3JtfSxpLnByb3RvdHlwZS5nZXRJbnZlcnRlZEFic29sdXRlVHJhbnNmb3JtPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2ludmVydGVkQWJzb2x1dGVUcmFuc2Zvcm19LGkucHJvdG90eXBlLmdldEFic29sdXRlVHJhbnNmb3JtPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2Fic29sdXRlVHJhbnNmb3JtfSxpLnByb3RvdHlwZS51cGRhdGVNYXRyaXg9ZnVuY3Rpb24oZSl7dGhpcy5fYmFzZU1hdHJpeD1lLmNsb25lKCksdGhpcy5fbWF0cml4PWUuY2xvbmUoKSx0aGlzLl9za2VsZXRvbi5fbWFya0FzRGlydHkoKSx0aGlzLl91cGRhdGVEaWZmZXJlbmNlTWF0cml4KCl9LGkucHJvdG90eXBlLl91cGRhdGVEaWZmZXJlbmNlTWF0cml4PWZ1bmN0aW9uKGUpe2V8fChlPXRoaXMuX2Jhc2VNYXRyaXgpLHRoaXMuX3BhcmVudD9lLm11bHRpcGx5VG9SZWYodGhpcy5fcGFyZW50Ll9hYnNvbHV0ZVRyYW5zZm9ybSx0aGlzLl9hYnNvbHV0ZVRyYW5zZm9ybSk6dGhpcy5fYWJzb2x1dGVUcmFuc2Zvcm0uY29weUZyb20oZSksdGhpcy5fYWJzb2x1dGVUcmFuc2Zvcm0uaW52ZXJ0VG9SZWYodGhpcy5faW52ZXJ0ZWRBYnNvbHV0ZVRyYW5zZm9ybSk7Zm9yKHZhciB0PTA7dDx0aGlzLmNoaWxkcmVuLmxlbmd0aDt0KyspdGhpcy5jaGlsZHJlblt0XS5fdXBkYXRlRGlmZmVyZW5jZU1hdHJpeCgpfSxpLnByb3RvdHlwZS5tYXJrQXNEaXJ0eT1mdW5jdGlvbigpe3RoaXMuX2N1cnJlbnRSZW5kZXJJZCsrLHRoaXMuX3NrZWxldG9uLl9tYXJrQXNEaXJ0eSgpfSxpLnByb3RvdHlwZS5jb3B5QW5pbWF0aW9uUmFuZ2U9ZnVuY3Rpb24odCxpLHIsbixvKXt2b2lkIDA9PT1uJiYobj0hMSksdm9pZCAwPT09byYmKG89bnVsbCksMD09PXRoaXMuYW5pbWF0aW9ucy5sZW5ndGgmJih0aGlzLmFuaW1hdGlvbnMucHVzaChuZXcgZS5BbmltYXRpb24odGhpcy5uYW1lLFwiX21hdHJpeFwiLHQuYW5pbWF0aW9uc1swXS5mcmFtZVBlclNlY29uZCxlLkFuaW1hdGlvbi5BTklNQVRJT05UWVBFX01BVFJJWCwwKSksdGhpcy5hbmltYXRpb25zWzBdLnNldEtleXMoW10pKTt2YXIgcz10LmFuaW1hdGlvbnNbMF0uZ2V0UmFuZ2UoaSk7aWYoIXMpcmV0dXJuITE7Zm9yKHZhciBhLGgsYyxsPXMuZnJvbSx1PXMudG8sZj10LmFuaW1hdGlvbnNbMF0uZ2V0S2V5cygpLGQ9dC5sZW5ndGgscD10LmdldFBhcmVudCgpLF89dGhpcy5nZXRQYXJlbnQoKSxtPW4mJnAmJmQmJnRoaXMubGVuZ3RoJiZkIT09dGhpcy5sZW5ndGgsZz1tP18ubGVuZ3RoL3AubGVuZ3RoOm51bGwsdj1uJiYhXyYmbyYmKDEhPT1vLnh8fDEhPT1vLnl8fDEhPT1vLnopLHk9dGhpcy5hbmltYXRpb25zWzBdLmdldEtleXMoKSx4PTAsYj1mLmxlbmd0aDtiPng7eCsrKWE9Zlt4XSxhLmZyYW1lPj1sJiZhLmZyYW1lPD11JiYobj8oYz1hLnZhbHVlLmNsb25lKCksbT8oaD1jLmdldFRyYW5zbGF0aW9uKCksYy5zZXRUcmFuc2xhdGlvbihoLnNjYWxlSW5QbGFjZShnKSkpOnY/KGg9Yy5nZXRUcmFuc2xhdGlvbigpLGMuc2V0VHJhbnNsYXRpb24oaC5tdWx0aXBseUluUGxhY2UobykpKTpjPWEudmFsdWUpOmM9YS52YWx1ZSx5LnB1c2goe2ZyYW1lOmEuZnJhbWUrcix2YWx1ZTpjfSkpO3JldHVybiB0aGlzLmFuaW1hdGlvbnNbMF0uY3JlYXRlUmFuZ2UoaSxsK3IsdStyKSwhMH0saX0oZS5Ob2RlKTtlLkJvbmU9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQsaSxyKXt0aGlzLm5hbWU9dCx0aGlzLmlkPWksdGhpcy5ib25lcz1uZXcgQXJyYXksdGhpcy5uZWVkSW5pdGlhbFNraW5NYXRyaXg9ITEsdGhpcy5faXNEaXJ0eT0hMCx0aGlzLl9tZXNoZXNXaXRoUG9zZU1hdHJpeD1uZXcgQXJyYXksdGhpcy5faWRlbnRpdHk9ZS5NYXRyaXguSWRlbnRpdHkoKSx0aGlzLl9yYW5nZXM9e30sdGhpcy5ib25lcz1bXSx0aGlzLl9zY2VuZT1yLHIuc2tlbGV0b25zLnB1c2godGhpcyksdGhpcy5faXNEaXJ0eT0hMH1yZXR1cm4gdC5wcm90b3R5cGUuZ2V0VHJhbnNmb3JtTWF0cmljZXM9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMubmVlZEluaXRpYWxTa2luTWF0cml4JiZlLl9ib25lc1RyYW5zZm9ybU1hdHJpY2VzP2UuX2JvbmVzVHJhbnNmb3JtTWF0cmljZXM6dGhpcy5fdHJhbnNmb3JtTWF0cmljZXN9LHQucHJvdG90eXBlLmdldFNjZW5lPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3NjZW5lfSx0LnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbihlKXt2YXIgdD1cIk5hbWU6IFwiK3RoaXMubmFtZStcIiwgbkJvbmVzOiBcIit0aGlzLmJvbmVzLmxlbmd0aDtpZih0Kz1cIiwgbkFuaW1hdGlvblJhbmdlczogXCIrKHRoaXMuX3Jhbmdlcz9PYmplY3Qua2V5cyh0aGlzLl9yYW5nZXMpLmxlbmd0aDpcIm5vbmVcIiksZSl7dCs9XCIsIFJhbmdlczoge1wiO3ZhciBpPSEwO2Zvcih2YXIgciBpbiB0aGlzLl9yYW5nZXMpaSYmKHQrPVwiLCBcIixpPSExKSx0Kz1yO3QrPVwifVwifXJldHVybiB0fSx0LnByb3RvdHlwZS5nZXRCb25lSW5kZXhCeU5hbWU9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PTAsaT10aGlzLmJvbmVzLmxlbmd0aDtpPnQ7dCsrKWlmKHRoaXMuYm9uZXNbdF0ubmFtZT09PWUpcmV0dXJuIHQ7cmV0dXJuLTF9LHQucHJvdG90eXBlLmNyZWF0ZUFuaW1hdGlvblJhbmdlPWZ1bmN0aW9uKHQsaSxyKXtpZighdGhpcy5fcmFuZ2VzW3RdKXt0aGlzLl9yYW5nZXNbdF09bmV3IGUuQW5pbWF0aW9uUmFuZ2UodCxpLHIpO2Zvcih2YXIgbj0wLG89dGhpcy5ib25lcy5sZW5ndGg7bz5uO24rKyl0aGlzLmJvbmVzW25dLmFuaW1hdGlvbnNbMF0mJnRoaXMuYm9uZXNbbl0uYW5pbWF0aW9uc1swXS5jcmVhdGVSYW5nZSh0LGkscil9fSx0LnByb3RvdHlwZS5kZWxldGVBbmltYXRpb25SYW5nZT1mdW5jdGlvbihlLHQpe3ZvaWQgMD09PXQmJih0PSEwKTtmb3IodmFyIGk9MCxyPXRoaXMuYm9uZXMubGVuZ3RoO3I+aTtpKyspdGhpcy5ib25lc1tpXS5hbmltYXRpb25zWzBdJiZ0aGlzLmJvbmVzW2ldLmFuaW1hdGlvbnNbMF0uZGVsZXRlUmFuZ2UoZSx0KTt0aGlzLl9yYW5nZXNbZV09dm9pZCAwfSx0LnByb3RvdHlwZS5nZXRBbmltYXRpb25SYW5nZT1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fcmFuZ2VzW2VdfSx0LnByb3RvdHlwZS5nZXRBbmltYXRpb25SYW5nZXM9ZnVuY3Rpb24oKXt2YXIgZSx0PVtdLGk9MDtmb3IoZSBpbiB0aGlzLl9yYW5nZXMpdFtpXT10aGlzLl9yYW5nZXNbZV0saSsrO3JldHVybiB0fSx0LnByb3RvdHlwZS5jb3B5QW5pbWF0aW9uUmFuZ2U9ZnVuY3Rpb24odCxpLHIpe2lmKHZvaWQgMD09PXImJihyPSExKSx0aGlzLl9yYW5nZXNbaV18fCF0LmdldEFuaW1hdGlvblJhbmdlKGkpKXJldHVybiExO3ZhciBuLG8scz0hMCxhPXRoaXMuX2dldEhpZ2hlc3RBbmltYXRpb25GcmFtZSgpKzEsaD17fSxjPXQuYm9uZXM7Zm9yKG89MCxuPWMubGVuZ3RoO24+bztvKyspaFtjW29dLm5hbWVdPWNbb107dGhpcy5ib25lcy5sZW5ndGghPT1jLmxlbmd0aCYmKGUuVG9vbHMuV2FybihcImNvcHlBbmltYXRpb25SYW5nZTogdGhpcyByaWcgaGFzIFwiK3RoaXMuYm9uZXMubGVuZ3RoK1wiIGJvbmVzLCB3aGlsZSBzb3VyY2UgYXMgXCIrYy5sZW5ndGgpLHM9ITEpO3ZhciBsPXImJnRoaXMuZGltZW5zaW9uc0F0UmVzdCYmdC5kaW1lbnNpb25zQXRSZXN0P3RoaXMuZGltZW5zaW9uc0F0UmVzdC5kaXZpZGUodC5kaW1lbnNpb25zQXRSZXN0KTpudWxsO2ZvcihvPTAsbj10aGlzLmJvbmVzLmxlbmd0aDtuPm87bysrKXt2YXIgdT10aGlzLmJvbmVzW29dLm5hbWUsZj1oW3VdO2Y/cz1zJiZ0aGlzLmJvbmVzW29dLmNvcHlBbmltYXRpb25SYW5nZShmLGksYSxyLGwpOihlLlRvb2xzLldhcm4oXCJjb3B5QW5pbWF0aW9uUmFuZ2U6IG5vdCBzYW1lIHJpZywgbWlzc2luZyBzb3VyY2UgYm9uZSBcIit1KSxzPSExKX12YXIgZD10LmdldEFuaW1hdGlvblJhbmdlKGkpO3JldHVybiB0aGlzLl9yYW5nZXNbaV09bmV3IGUuQW5pbWF0aW9uUmFuZ2UoaSxkLmZyb20rYSxkLnRvK2EpLHN9LHQucHJvdG90eXBlLnJldHVyblRvUmVzdD1mdW5jdGlvbigpe2Zvcih2YXIgZT0wO2U8dGhpcy5ib25lcy5sZW5ndGg7ZSsrKXRoaXMuYm9uZXNbZV0ucmV0dXJuVG9SZXN0KCl9LHQucHJvdG90eXBlLl9nZXRIaWdoZXN0QW5pbWF0aW9uRnJhbWU9ZnVuY3Rpb24oKXtmb3IodmFyIGU9MCx0PTAsaT10aGlzLmJvbmVzLmxlbmd0aDtpPnQ7dCsrKWlmKHRoaXMuYm9uZXNbdF0uYW5pbWF0aW9uc1swXSl7dmFyIHI9dGhpcy5ib25lc1t0XS5hbmltYXRpb25zWzBdLmdldEhpZ2hlc3RGcmFtZSgpO3I+ZSYmKGU9cil9cmV0dXJuIGV9LHQucHJvdG90eXBlLmJlZ2luQW5pbWF0aW9uPWZ1bmN0aW9uKGUsdCxpLHIpe3ZhciBuPXRoaXMuZ2V0QW5pbWF0aW9uUmFuZ2UoZSk7cmV0dXJuIG4/dGhpcy5fc2NlbmUuYmVnaW5BbmltYXRpb24odGhpcyxuLmZyb20sbi50byx0LGkscik6bnVsbH0sdC5wcm90b3R5cGUuX21hcmtBc0RpcnR5PWZ1bmN0aW9uKCl7dGhpcy5faXNEaXJ0eT0hMH0sdC5wcm90b3R5cGUuX3JlZ2lzdGVyTWVzaFdpdGhQb3NlTWF0cml4PWZ1bmN0aW9uKGUpe3RoaXMuX21lc2hlc1dpdGhQb3NlTWF0cml4LnB1c2goZSl9LHQucHJvdG90eXBlLl91bnJlZ2lzdGVyTWVzaFdpdGhQb3NlTWF0cml4PWZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuX21lc2hlc1dpdGhQb3NlTWF0cml4LmluZGV4T2YoZSk7dD4tMSYmdGhpcy5fbWVzaGVzV2l0aFBvc2VNYXRyaXguc3BsaWNlKHQsMSl9LHQucHJvdG90eXBlLl9jb21wdXRlVHJhbnNmb3JtTWF0cmljZXM9ZnVuY3Rpb24oZSx0KXtmb3IodmFyIGk9MDtpPHRoaXMuYm9uZXMubGVuZ3RoO2krKyl7dmFyIHI9dGhpcy5ib25lc1tpXSxuPXIuZ2V0UGFyZW50KCk7bj9yLmdldExvY2FsTWF0cml4KCkubXVsdGlwbHlUb1JlZihuLmdldFdvcmxkTWF0cml4KCksci5nZXRXb3JsZE1hdHJpeCgpKTp0P3IuZ2V0TG9jYWxNYXRyaXgoKS5tdWx0aXBseVRvUmVmKHQsci5nZXRXb3JsZE1hdHJpeCgpKTpyLmdldFdvcmxkTWF0cml4KCkuY29weUZyb20oci5nZXRMb2NhbE1hdHJpeCgpKSxyLmdldEludmVydGVkQWJzb2x1dGVUcmFuc2Zvcm0oKS5tdWx0aXBseVRvQXJyYXkoci5nZXRXb3JsZE1hdHJpeCgpLGUsMTYqaSl9dGhpcy5faWRlbnRpdHkuY29weVRvQXJyYXkoZSwxNip0aGlzLmJvbmVzLmxlbmd0aCl9LHQucHJvdG90eXBlLnByZXBhcmU9ZnVuY3Rpb24oKXtpZih0aGlzLl9pc0RpcnR5KXtpZih0aGlzLm5lZWRJbml0aWFsU2tpbk1hdHJpeClmb3IodmFyIHQ9MDt0PHRoaXMuX21lc2hlc1dpdGhQb3NlTWF0cml4Lmxlbmd0aDt0Kyspe3ZhciBpPXRoaXMuX21lc2hlc1dpdGhQb3NlTWF0cml4W3RdO2kuX2JvbmVzVHJhbnNmb3JtTWF0cmljZXMmJmkuX2JvbmVzVHJhbnNmb3JtTWF0cmljZXMubGVuZ3RoPT09MTYqKHRoaXMuYm9uZXMubGVuZ3RoKzEpfHwoaS5fYm9uZXNUcmFuc2Zvcm1NYXRyaWNlcz1uZXcgRmxvYXQzMkFycmF5KDE2Kih0aGlzLmJvbmVzLmxlbmd0aCsxKSkpO2Zvcih2YXIgcj1pLmdldFBvc2VNYXRyaXgoKSxuPTA7bjx0aGlzLmJvbmVzLmxlbmd0aDtuKyspe3ZhciBvPXRoaXMuYm9uZXNbbl07aWYoIW8uZ2V0UGFyZW50KCkpe3ZhciBzPW8uZ2V0QmFzZU1hdHJpeCgpO3MubXVsdGlwbHlUb1JlZihyLGUuVG1wLk1hdHJpeFswXSksby5fdXBkYXRlRGlmZmVyZW5jZU1hdHJpeChlLlRtcC5NYXRyaXhbMF0pfX10aGlzLl9jb21wdXRlVHJhbnNmb3JtTWF0cmljZXMoaS5fYm9uZXNUcmFuc2Zvcm1NYXRyaWNlcyxyKX1lbHNlIHRoaXMuX3RyYW5zZm9ybU1hdHJpY2VzJiZ0aGlzLl90cmFuc2Zvcm1NYXRyaWNlcy5sZW5ndGg9PT0xNioodGhpcy5ib25lcy5sZW5ndGgrMSl8fCh0aGlzLl90cmFuc2Zvcm1NYXRyaWNlcz1uZXcgRmxvYXQzMkFycmF5KDE2Kih0aGlzLmJvbmVzLmxlbmd0aCsxKSkpLHRoaXMuX2NvbXB1dGVUcmFuc2Zvcm1NYXRyaWNlcyh0aGlzLl90cmFuc2Zvcm1NYXRyaWNlcyxudWxsKTt0aGlzLl9pc0RpcnR5PSExLHRoaXMuX3NjZW5lLl9hY3RpdmVCb25lcys9dGhpcy5ib25lcy5sZW5ndGh9fSx0LnByb3RvdHlwZS5nZXRBbmltYXRhYmxlcz1mdW5jdGlvbigpe2lmKCF0aGlzLl9hbmltYXRhYmxlc3x8dGhpcy5fYW5pbWF0YWJsZXMubGVuZ3RoIT09dGhpcy5ib25lcy5sZW5ndGgpe3RoaXMuX2FuaW1hdGFibGVzPVtdO2Zvcih2YXIgZT0wO2U8dGhpcy5ib25lcy5sZW5ndGg7ZSsrKXRoaXMuX2FuaW1hdGFibGVzLnB1c2godGhpcy5ib25lc1tlXSl9cmV0dXJuIHRoaXMuX2FuaW1hdGFibGVzfSx0LnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbihpLHIpe3ZhciBuPW5ldyB0KGkscnx8aSx0aGlzLl9zY2VuZSk7bi5uZWVkSW5pdGlhbFNraW5NYXRyaXg9dGhpcy5uZWVkSW5pdGlhbFNraW5NYXRyaXg7Zm9yKHZhciBvPTA7bzx0aGlzLmJvbmVzLmxlbmd0aDtvKyspe3ZhciBzPXRoaXMuYm9uZXNbb10sYT1udWxsO2lmKHMuZ2V0UGFyZW50KCkpe3ZhciBoPXRoaXMuYm9uZXMuaW5kZXhPZihzLmdldFBhcmVudCgpKTthPW4uYm9uZXNbaF19dmFyIGM9bmV3IGUuQm9uZShzLm5hbWUsbixhLHMuZ2V0QmFzZU1hdHJpeCgpLmNsb25lKCkscy5nZXRSZXN0UG9zZSgpLmNsb25lKCkpO2UuVG9vbHMuRGVlcENvcHkocy5hbmltYXRpb25zLGMuYW5pbWF0aW9ucyl9aWYodGhpcy5fcmFuZ2VzKXtuLl9yYW5nZXM9e307Zm9yKHZhciBsIGluIHRoaXMuX3JhbmdlcyluLl9yYW5nZXNbbF09dGhpcy5fcmFuZ2VzW2xdLmNsb25lKCl9cmV0dXJuIHRoaXMuX2lzRGlydHk9ITAsbn0sdC5wcm90b3R5cGUuZW5hYmxlQmxlbmRpbmc9ZnVuY3Rpb24oZSl7dm9pZCAwPT09ZSYmKGU9LjAxKSx0aGlzLmJvbmVzLmZvckVhY2goZnVuY3Rpb24odCl7dC5hbmltYXRpb25zLmZvckVhY2goZnVuY3Rpb24odCl7dC5lbmFibGVCbGVuZGluZz0hMCx0LmJsZW5kaW5nU3BlZWQ9ZX0pfSl9LHQucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXt0aGlzLl9tZXNoZXNXaXRoUG9zZU1hdHJpeD1bXSx0aGlzLmdldFNjZW5lKCkuc3RvcEFuaW1hdGlvbih0aGlzKSx0aGlzLmdldFNjZW5lKCkucmVtb3ZlU2tlbGV0b24odGhpcyl9LHQucHJvdG90eXBlLnNlcmlhbGl6ZT1mdW5jdGlvbigpe3ZhciBlPXt9O2UubmFtZT10aGlzLm5hbWUsZS5pZD10aGlzLmlkLGUuZGltZW5zaW9uc0F0UmVzdD10aGlzLmRpbWVuc2lvbnNBdFJlc3QsZS5ib25lcz1bXSxlLm5lZWRJbml0aWFsU2tpbk1hdHJpeD10aGlzLm5lZWRJbml0aWFsU2tpbk1hdHJpeDtmb3IodmFyIHQ9MDt0PHRoaXMuYm9uZXMubGVuZ3RoO3QrKyl7dmFyIGk9dGhpcy5ib25lc1t0XSxyPXtwYXJlbnRCb25lSW5kZXg6aS5nZXRQYXJlbnQoKT90aGlzLmJvbmVzLmluZGV4T2YoaS5nZXRQYXJlbnQoKSk6LTEsbmFtZTppLm5hbWUsbWF0cml4OmkuZ2V0TG9jYWxNYXRyaXgoKS50b0FycmF5KCkscmVzdDppLmdldFJlc3RQb3NlKCkudG9BcnJheSgpfTtlLmJvbmVzLnB1c2gociksaS5sZW5ndGgmJihyLmxlbmd0aD1pLmxlbmd0aCksaS5hbmltYXRpb25zJiZpLmFuaW1hdGlvbnMubGVuZ3RoPjAmJihyLmFuaW1hdGlvbj1pLmFuaW1hdGlvbnNbMF0uc2VyaWFsaXplKCkpLGUucmFuZ2VzPVtdO2Zvcih2YXIgbiBpbiB0aGlzLl9yYW5nZXMpe3ZhciBvPXt9O28ubmFtZT1uLG8uZnJvbT10aGlzLl9yYW5nZXNbbl0uZnJvbSxvLnRvPXRoaXMuX3Jhbmdlc1tuXS50byxlLnJhbmdlcy5wdXNoKG8pfX1yZXR1cm4gZX0sdC5QYXJzZT1mdW5jdGlvbihpLHIpe3ZhciBuPW5ldyB0KGkubmFtZSxpLmlkLHIpO2kuZGltZW5zaW9uc0F0UmVzdCYmKG4uZGltZW5zaW9uc0F0UmVzdD1lLlZlY3RvcjMuRnJvbUFycmF5KGkuZGltZW5zaW9uc0F0UmVzdCkpLG4ubmVlZEluaXRpYWxTa2luTWF0cml4PWkubmVlZEluaXRpYWxTa2luTWF0cml4O3ZhciBvO2ZvcihvPTA7bzxpLmJvbmVzLmxlbmd0aDtvKyspe3ZhciBzPWkuYm9uZXNbb10sYT1udWxsO3MucGFyZW50Qm9uZUluZGV4Pi0xJiYoYT1uLmJvbmVzW3MucGFyZW50Qm9uZUluZGV4XSk7dmFyIGg9cy5yZXN0P2UuTWF0cml4LkZyb21BcnJheShzLnJlc3QpOm51bGwsYz1uZXcgZS5Cb25lKHMubmFtZSxuLGEsZS5NYXRyaXguRnJvbUFycmF5KHMubWF0cml4KSxoKTtzLmxlbmd0aCYmKGMubGVuZ3RoPXMubGVuZ3RoKSxzLmFuaW1hdGlvbiYmYy5hbmltYXRpb25zLnB1c2goZS5BbmltYXRpb24uUGFyc2Uocy5hbmltYXRpb24pKX1pZihpLnJhbmdlcylmb3Iobz0wO288aS5yYW5nZXMubGVuZ3RoO28rKyl7dmFyIGw9aS5yYW5nZXNbb107bi5jcmVhdGVBbmltYXRpb25SYW5nZShsLm5hbWUsbC5mcm9tLGwudG8pfXJldHVybiBufSx0fSgpO2UuU2tlbGV0b249dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQsaSxyLG4sbyxzLGEsaCxjLGwsdSl7dm9pZCAwPT09YSYmKGE9ZS5UZXh0dXJlLk5FQVJFU1RfU0FNUExJTkdNT0RFKSx2b2lkIDA9PT11JiYodT1lLkVuZ2luZS5URVhUVVJFVFlQRV9VTlNJR05FRF9JTlQpLHRoaXMubmFtZT10LHRoaXMud2lkdGg9LTEsdGhpcy5oZWlnaHQ9LTEsdGhpcy5lbmFibGVQaXhlbFBlcmZlY3RNb2RlPSExLHRoaXMuX3JldXNhYmxlPSExLHRoaXMuX3RleHR1cmVzPW5ldyBlLlNtYXJ0QXJyYXkoMiksdGhpcy5fY3VycmVudFJlbmRlclRleHR1cmVJbmQ9MCx0aGlzLl9zY2FsZVJhdGlvPW5ldyBlLlZlY3RvcjIoMSwxKSx0aGlzLm9uQWN0aXZhdGVPYnNlcnZhYmxlPW5ldyBlLk9ic2VydmFibGUsdGhpcy5vblNpemVDaGFuZ2VkT2JzZXJ2YWJsZT1uZXcgZS5PYnNlcnZhYmxlLHRoaXMub25BcHBseU9ic2VydmFibGU9bmV3IGUuT2JzZXJ2YWJsZSx0aGlzLm9uQmVmb3JlUmVuZGVyT2JzZXJ2YWJsZT1uZXcgZS5PYnNlcnZhYmxlLHRoaXMub25BZnRlclJlbmRlck9ic2VydmFibGU9bmV3IGUuT2JzZXJ2YWJsZSxudWxsIT1zPyh0aGlzLl9jYW1lcmE9cyx0aGlzLl9zY2VuZT1zLmdldFNjZW5lKCkscy5hdHRhY2hQb3N0UHJvY2Vzcyh0aGlzKSx0aGlzLl9lbmdpbmU9dGhpcy5fc2NlbmUuZ2V0RW5naW5lKCkpOnRoaXMuX2VuZ2luZT1oLHRoaXMuX29wdGlvbnM9byx0aGlzLnJlbmRlclRhcmdldFNhbXBsaW5nTW9kZT1hP2E6ZS5UZXh0dXJlLk5FQVJFU1RfU0FNUExJTkdNT0RFLHRoaXMuX3JldXNhYmxlPWN8fCExLHRoaXMuX3RleHR1cmVUeXBlPXUsdGhpcy5fc2FtcGxlcnM9bnx8W10sdGhpcy5fc2FtcGxlcnMucHVzaChcInRleHR1cmVTYW1wbGVyXCIpLHRoaXMuX2ZyYWdtZW50VXJsPWksdGhpcy5fcGFyYW1ldGVycz1yfHxbXSx0aGlzLl9wYXJhbWV0ZXJzLnB1c2goXCJzY2FsZVwiKSx0aGlzLnVwZGF0ZUVmZmVjdChsKX1yZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwib25BY3RpdmF0ZVwiLHtzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fb25BY3RpdmF0ZU9ic2VydmVyJiZ0aGlzLm9uQWN0aXZhdGVPYnNlcnZhYmxlLnJlbW92ZSh0aGlzLl9vbkFjdGl2YXRlT2JzZXJ2ZXIpLHRoaXMuX29uQWN0aXZhdGVPYnNlcnZlcj10aGlzLm9uQWN0aXZhdGVPYnNlcnZhYmxlLmFkZChlKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJvblNpemVDaGFuZ2VkXCIse3NldDpmdW5jdGlvbihlKXt0aGlzLl9vblNpemVDaGFuZ2VkT2JzZXJ2ZXImJnRoaXMub25TaXplQ2hhbmdlZE9ic2VydmFibGUucmVtb3ZlKHRoaXMuX29uU2l6ZUNoYW5nZWRPYnNlcnZlciksdGhpcy5fb25TaXplQ2hhbmdlZE9ic2VydmVyPXRoaXMub25TaXplQ2hhbmdlZE9ic2VydmFibGUuYWRkKGUpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcIm9uQXBwbHlcIix7c2V0OmZ1bmN0aW9uKGUpe3RoaXMuX29uQXBwbHlPYnNlcnZlciYmdGhpcy5vbkFwcGx5T2JzZXJ2YWJsZS5yZW1vdmUodGhpcy5fb25BcHBseU9ic2VydmVyKSx0aGlzLl9vbkFwcGx5T2JzZXJ2ZXI9dGhpcy5vbkFwcGx5T2JzZXJ2YWJsZS5hZGQoZSl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwib25CZWZvcmVSZW5kZXJcIix7c2V0OmZ1bmN0aW9uKGUpe3RoaXMuX29uQmVmb3JlUmVuZGVyT2JzZXJ2ZXImJnRoaXMub25CZWZvcmVSZW5kZXJPYnNlcnZhYmxlLnJlbW92ZSh0aGlzLl9vbkJlZm9yZVJlbmRlck9ic2VydmVyKSx0aGlzLl9vbkJlZm9yZVJlbmRlck9ic2VydmVyPXRoaXMub25CZWZvcmVSZW5kZXJPYnNlcnZhYmxlLmFkZChlKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJvbkFmdGVyUmVuZGVyXCIse3NldDpmdW5jdGlvbihlKXt0aGlzLl9vbkFmdGVyUmVuZGVyT2JzZXJ2ZXImJnRoaXMub25BZnRlclJlbmRlck9ic2VydmFibGUucmVtb3ZlKHRoaXMuX29uQWZ0ZXJSZW5kZXJPYnNlcnZlciksdGhpcy5fb25BZnRlclJlbmRlck9ic2VydmVyPXRoaXMub25BZnRlclJlbmRlck9ic2VydmFibGUuYWRkKGUpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLHQucHJvdG90eXBlLnVwZGF0ZUVmZmVjdD1mdW5jdGlvbihlKXt0aGlzLl9lZmZlY3Q9dGhpcy5fZW5naW5lLmNyZWF0ZUVmZmVjdCh7dmVydGV4OlwicG9zdHByb2Nlc3NcIixmcmFnbWVudDp0aGlzLl9mcmFnbWVudFVybH0sW1wicG9zaXRpb25cIl0sdGhpcy5fcGFyYW1ldGVycyx0aGlzLl9zYW1wbGVycyx2b2lkIDAhPT1lP2U6XCJcIil9LHQucHJvdG90eXBlLmlzUmV1c2FibGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcmV1c2FibGV9LHQucHJvdG90eXBlLm1hcmtUZXh0dXJlRGlydHk9ZnVuY3Rpb24oKXt0aGlzLndpZHRoPS0xfSx0LnByb3RvdHlwZS5hY3RpdmF0ZT1mdW5jdGlvbih0LGkpe3Q9dHx8dGhpcy5fY2FtZXJhO3ZhciByPXQuZ2V0U2NlbmUoKSxuPXQuZ2V0RW5naW5lKCkuZ2V0Q2FwcygpLm1heFRleHR1cmVTaXplLG89KGk/aS5fd2lkdGg6dGhpcy5fZW5naW5lLmdldFJlbmRlcmluZ0NhbnZhcygpLndpZHRoKSp0aGlzLl9vcHRpb25zfDAscz0oaT9pLl9oZWlnaHQ6dGhpcy5fZW5naW5lLmdldFJlbmRlcmluZ0NhbnZhcygpLmhlaWdodCkqdGhpcy5fb3B0aW9uc3wwLGE9dGhpcy5fb3B0aW9ucy53aWR0aHx8byxoPXRoaXMuX29wdGlvbnMuaGVpZ2h0fHxzO2lmKHRoaXMucmVuZGVyVGFyZ2V0U2FtcGxpbmdNb2RlIT09ZS5UZXh0dXJlLk5FQVJFU1RfU0FNUExJTkdNT0RFJiYodGhpcy5fb3B0aW9ucy53aWR0aHx8KGE9ZS5Ub29scy5HZXRFeHBvbmVudE9mVHdvKGEsbikpLHRoaXMuX29wdGlvbnMuaGVpZ2h0fHwoaD1lLlRvb2xzLkdldEV4cG9uZW50T2ZUd28oaCxuKSkpLHRoaXMud2lkdGghPT1hfHx0aGlzLmhlaWdodCE9PWgpe2lmKHRoaXMuX3RleHR1cmVzLmxlbmd0aD4wKXtmb3IodmFyIGM9MDtjPHRoaXMuX3RleHR1cmVzLmxlbmd0aDtjKyspdGhpcy5fZW5naW5lLl9yZWxlYXNlVGV4dHVyZSh0aGlzLl90ZXh0dXJlcy5kYXRhW2NdKTt0aGlzLl90ZXh0dXJlcy5yZXNldCgpfXRoaXMud2lkdGg9YSx0aGlzLmhlaWdodD1oLHRoaXMuX3RleHR1cmVzLnB1c2godGhpcy5fZW5naW5lLmNyZWF0ZVJlbmRlclRhcmdldFRleHR1cmUoe3dpZHRoOnRoaXMud2lkdGgsaGVpZ2h0OnRoaXMuaGVpZ2h0fSx7Z2VuZXJhdGVNaXBNYXBzOiExLGdlbmVyYXRlRGVwdGhCdWZmZXI6MD09PXQuX3Bvc3RQcm9jZXNzZXMuaW5kZXhPZih0aGlzKSxzYW1wbGluZ01vZGU6dGhpcy5yZW5kZXJUYXJnZXRTYW1wbGluZ01vZGUsdHlwZTp0aGlzLl90ZXh0dXJlVHlwZX0pKSx0aGlzLl9yZXVzYWJsZSYmdGhpcy5fdGV4dHVyZXMucHVzaCh0aGlzLl9lbmdpbmUuY3JlYXRlUmVuZGVyVGFyZ2V0VGV4dHVyZSh7d2lkdGg6dGhpcy53aWR0aCxoZWlnaHQ6dGhpcy5oZWlnaHR9LHtnZW5lcmF0ZU1pcE1hcHM6ITEsZ2VuZXJhdGVEZXB0aEJ1ZmZlcjowPT09dC5fcG9zdFByb2Nlc3Nlcy5pbmRleE9mKHRoaXMpLHNhbXBsaW5nTW9kZTp0aGlzLnJlbmRlclRhcmdldFNhbXBsaW5nTW9kZSx0eXBlOnRoaXMuX3RleHR1cmVUeXBlfSkpLHRoaXMub25TaXplQ2hhbmdlZE9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpfXRoaXMuZW5hYmxlUGl4ZWxQZXJmZWN0TW9kZT8odGhpcy5fc2NhbGVSYXRpby5jb3B5RnJvbUZsb2F0cyhvL2Escy9oKSx0aGlzLl9lbmdpbmUuYmluZEZyYW1lYnVmZmVyKHRoaXMuX3RleHR1cmVzLmRhdGFbdGhpcy5fY3VycmVudFJlbmRlclRleHR1cmVJbmRdLDAsbyxzKSk6KHRoaXMuX3NjYWxlUmF0aW8uY29weUZyb21GbG9hdHMoMSwxKSx0aGlzLl9lbmdpbmUuYmluZEZyYW1lYnVmZmVyKHRoaXMuX3RleHR1cmVzLmRhdGFbdGhpcy5fY3VycmVudFJlbmRlclRleHR1cmVJbmRdKSksdGhpcy5vbkFjdGl2YXRlT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModCksdGhpcy5jbGVhckNvbG9yP3RoaXMuX2VuZ2luZS5jbGVhcih0aGlzLmNsZWFyQ29sb3IsITAsITApOnRoaXMuX2VuZ2luZS5jbGVhcihyLmNsZWFyQ29sb3Isci5hdXRvQ2xlYXJ8fHIuZm9yY2VXaXJlZnJhbWUsITApLHRoaXMuX3JldXNhYmxlJiYodGhpcy5fY3VycmVudFJlbmRlclRleHR1cmVJbmQ9KHRoaXMuX2N1cnJlbnRSZW5kZXJUZXh0dXJlSW5kKzEpJTIpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJpc1N1cHBvcnRlZFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZWZmZWN0LmlzU3VwcG9ydGVkfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLHQucHJvdG90eXBlLmFwcGx5PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2VmZmVjdC5pc1JlYWR5KCk/KHRoaXMuX2VuZ2luZS5lbmFibGVFZmZlY3QodGhpcy5fZWZmZWN0KSx0aGlzLl9lbmdpbmUuc2V0U3RhdGUoITEpLHRoaXMuX2VuZ2luZS5zZXRBbHBoYU1vZGUoZS5FbmdpbmUuQUxQSEFfRElTQUJMRSksdGhpcy5fZW5naW5lLnNldERlcHRoQnVmZmVyKCExKSx0aGlzLl9lbmdpbmUuc2V0RGVwdGhXcml0ZSghMSksdGhpcy5fZWZmZWN0Ll9iaW5kVGV4dHVyZShcInRleHR1cmVTYW1wbGVyXCIsdGhpcy5fdGV4dHVyZXMuZGF0YVt0aGlzLl9jdXJyZW50UmVuZGVyVGV4dHVyZUluZF0pLHRoaXMuX2VmZmVjdC5zZXRWZWN0b3IyKFwic2NhbGVcIix0aGlzLl9zY2FsZVJhdGlvKSx0aGlzLm9uQXBwbHlPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzLl9lZmZlY3QpLHRoaXMuX2VmZmVjdCk6bnVsbH0sdC5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbihlKXtpZihlPWV8fHRoaXMuX2NhbWVyYSx0aGlzLl90ZXh0dXJlcy5sZW5ndGg+MCl7Zm9yKHZhciB0PTA7dDx0aGlzLl90ZXh0dXJlcy5sZW5ndGg7dCsrKXRoaXMuX2VuZ2luZS5fcmVsZWFzZVRleHR1cmUodGhpcy5fdGV4dHVyZXMuZGF0YVt0XSk7dGhpcy5fdGV4dHVyZXMucmVzZXQoKX1pZihlKXtlLmRldGFjaFBvc3RQcm9jZXNzKHRoaXMpO3ZhciBpPWUuX3Bvc3RQcm9jZXNzZXMuaW5kZXhPZih0aGlzKTswPT09aSYmZS5fcG9zdFByb2Nlc3Nlcy5sZW5ndGg+MCYmdGhpcy5fY2FtZXJhLl9wb3N0UHJvY2Vzc2VzWzBdLm1hcmtUZXh0dXJlRGlydHkoKSx0aGlzLm9uQWN0aXZhdGVPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbkFmdGVyUmVuZGVyT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25BcHBseU9ic2VydmFibGUuY2xlYXIoKSx0aGlzLm9uQmVmb3JlUmVuZGVyT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25TaXplQ2hhbmdlZE9ic2VydmFibGUuY2xlYXIoKX19LHR9KCk7ZS5Qb3N0UHJvY2Vzcz10fShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoZSl7dGhpcy5fdmVydGV4QnVmZmVycz17fSx0aGlzLl9zY2VuZT1lfXJldHVybiB0LnByb3RvdHlwZS5fcHJlcGFyZUJ1ZmZlcnM9ZnVuY3Rpb24oKXtpZighdGhpcy5fdmVydGV4QnVmZmVyc1tlLlZlcnRleEJ1ZmZlci5Qb3NpdGlvbktpbmRdKXt2YXIgdD1bXTt0LnB1c2goMSwxKSx0LnB1c2goLTEsMSksdC5wdXNoKC0xLC0xKSx0LnB1c2goMSwtMSksdGhpcy5fdmVydGV4QnVmZmVyc1tlLlZlcnRleEJ1ZmZlci5Qb3NpdGlvbktpbmRdPW5ldyBlLlZlcnRleEJ1ZmZlcih0aGlzLl9zY2VuZS5nZXRFbmdpbmUoKSx0LGUuVmVydGV4QnVmZmVyLlBvc2l0aW9uS2luZCwhMSwhMSwyKTt2YXIgaT1bXTtpLnB1c2goMCksaS5wdXNoKDEpLGkucHVzaCgyKSxpLnB1c2goMCksaS5wdXNoKDIpLGkucHVzaCgzKSx0aGlzLl9pbmRleEJ1ZmZlcj10aGlzLl9zY2VuZS5nZXRFbmdpbmUoKS5jcmVhdGVJbmRleEJ1ZmZlcihpKX19LHQucHJvdG90eXBlLl9wcmVwYXJlRnJhbWU9ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5fc2NlbmUuYWN0aXZlQ2FtZXJhLl9wb3N0UHJvY2Vzc2VzO3JldHVybiAwIT09dC5sZW5ndGgmJnRoaXMuX3NjZW5lLnBvc3RQcm9jZXNzZXNFbmFibGVkPyh0WzBdLmFjdGl2YXRlKHRoaXMuX3NjZW5lLmFjdGl2ZUNhbWVyYSxlKSwhMCk6ITF9LHQucHJvdG90eXBlLmRpcmVjdFJlbmRlcj1mdW5jdGlvbihlLHQpe2Zvcih2YXIgaT10aGlzLl9zY2VuZS5nZXRFbmdpbmUoKSxyPTA7cjxlLmxlbmd0aDtyKyspe3I8ZS5sZW5ndGgtMT9lW3IrMV0uYWN0aXZhdGUodGhpcy5fc2NlbmUuYWN0aXZlQ2FtZXJhLHQpOnQ/aS5iaW5kRnJhbWVidWZmZXIodCk6aS5yZXN0b3JlRGVmYXVsdEZyYW1lYnVmZmVyKCk7dmFyIG49ZVtyXSxvPW4uYXBwbHkoKTtvJiYobi5vbkJlZm9yZVJlbmRlck9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKG8pLHRoaXMuX3ByZXBhcmVCdWZmZXJzKCksaS5iaW5kQnVmZmVycyh0aGlzLl92ZXJ0ZXhCdWZmZXJzLHRoaXMuX2luZGV4QnVmZmVyLG8pLGkuZHJhdyghMCwwLDYpLG4ub25BZnRlclJlbmRlck9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKG8pKX1pLnNldERlcHRoQnVmZmVyKCEwKSxpLnNldERlcHRoV3JpdGUoITApfSx0LnByb3RvdHlwZS5fZmluYWxpemVGcmFtZT1mdW5jdGlvbihlLHQsaSxyKXtpZihyPXJ8fHRoaXMuX3NjZW5lLmFjdGl2ZUNhbWVyYS5fcG9zdFByb2Nlc3NlcywwIT09ci5sZW5ndGgmJnRoaXMuX3NjZW5lLnBvc3RQcm9jZXNzZXNFbmFibGVkKXtmb3IodmFyIG49dGhpcy5fc2NlbmUuZ2V0RW5naW5lKCksbz0wLHM9ci5sZW5ndGg7cz5vJiYocy0xPm8/cltvKzFdLmFjdGl2YXRlKHRoaXMuX3NjZW5lLmFjdGl2ZUNhbWVyYSx0KTp0P24uYmluZEZyYW1lYnVmZmVyKHQsaSk6bi5yZXN0b3JlRGVmYXVsdEZyYW1lYnVmZmVyKCksIWUpO28rKyl7dmFyIGE9cltvXSxoPWEuYXBwbHkoKTtoJiYoYS5vbkJlZm9yZVJlbmRlck9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKGgpLHRoaXMuX3ByZXBhcmVCdWZmZXJzKCksbi5iaW5kQnVmZmVycyh0aGlzLl92ZXJ0ZXhCdWZmZXJzLHRoaXMuX2luZGV4QnVmZmVyLGgpLG4uZHJhdyghMCwwLDYpLGEub25BZnRlclJlbmRlck9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKGgpKX1uLnNldERlcHRoQnVmZmVyKCEwKSxuLnNldERlcHRoV3JpdGUoITApfX0sdC5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3ZhciB0PXRoaXMuX3ZlcnRleEJ1ZmZlcnNbZS5WZXJ0ZXhCdWZmZXIuUG9zaXRpb25LaW5kXTt0JiYodC5kaXNwb3NlKCksdGhpcy5fdmVydGV4QnVmZmVyc1tlLlZlcnRleEJ1ZmZlci5Qb3NpdGlvbktpbmRdPW51bGwpLHRoaXMuX2luZGV4QnVmZmVyJiYodGhpcy5fc2NlbmUuZ2V0RW5naW5lKCkuX3JlbGVhc2VCdWZmZXIodGhpcy5faW5kZXhCdWZmZXIpLHRoaXMuX2luZGV4QnVmZmVyPW51bGwpfSx0fSgpO2UuUG9zdFByb2Nlc3NNYW5hZ2VyPXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQodCxpLHIsbixvLHMpe2UuY2FsbCh0aGlzLHQsXCJwYXNzXCIsbnVsbCxudWxsLGkscixuLG8scyl9cmV0dXJuIF9fZXh0ZW5kcyh0LGUpLHR9KGUuUG9zdFByb2Nlc3MpO2UuUGFzc1Bvc3RQcm9jZXNzPXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlLHQpe3RoaXMudHlwZT1lLHRoaXMuam9pbnREYXRhPXQsdC5uYXRpdmVQYXJhbXM9dC5uYXRpdmVQYXJhbXN8fHt9fXJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkoZS5wcm90b3R5cGUsXCJwaHlzaWNzSm9pbnRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3BoeXNpY3NKb2ludH0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX3BoeXNpY3NKb2ludCx0aGlzLl9waHlzaWNzSm9pbnQ9ZX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZS5wcm90b3R5cGUsXCJwaHlzaWNzUGx1Z2luXCIse3NldDpmdW5jdGlvbihlKXt0aGlzLl9waHlzaWNzUGx1Z2luPWV9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksZS5wcm90b3R5cGUuZXhlY3V0ZU5hdGl2ZUZ1bmN0aW9uPWZ1bmN0aW9uKGUpe2UodGhpcy5fcGh5c2ljc1BsdWdpbi53b3JsZCx0aGlzLl9waHlzaWNzSm9pbnQpfSxlLkRpc3RhbmNlSm9pbnQ9MCxlLkhpbmdlSm9pbnQ9MSxlLkJhbGxBbmRTb2NrZXRKb2ludD0yLGUuV2hlZWxKb2ludD0zLGUuU2xpZGVySm9pbnQ9NCxlLlByaXNtYXRpY0pvaW50PTUsZS5Vbml2ZXJzYWxKb2ludD02LGUuSGluZ2UySm9pbnQ9ZS5XaGVlbEpvaW50LGUuUG9pbnRUb1BvaW50Sm9pbnQ9OCxlLlNwcmluZ0pvaW50PTksZS5Mb2NrSm9pbnQ9MTAsZX0oKTtlLlBoeXNpY3NKb2ludD10O3ZhciBpPWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIGkoaSl7ZS5jYWxsKHRoaXMsdC5EaXN0YW5jZUpvaW50LGkpfXJldHVybiBfX2V4dGVuZHMoaSxlKSxpLnByb3RvdHlwZS51cGRhdGVEaXN0YW5jZT1mdW5jdGlvbihlLHQpe3RoaXMuX3BoeXNpY3NQbHVnaW4udXBkYXRlRGlzdGFuY2VKb2ludCh0aGlzLGUsdCl9LGl9KHQpO2UuRGlzdGFuY2VKb2ludD1pO3ZhciByPWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQodCxpKXtlLmNhbGwodGhpcyx0LGkpfXJldHVybiBfX2V4dGVuZHModCxlKSx0LnByb3RvdHlwZS5zZXRNb3Rvcj1mdW5jdGlvbihlLHQpe3RoaXMuX3BoeXNpY3NQbHVnaW4uc2V0TW90b3IodGhpcyxlLHQpfSx0LnByb3RvdHlwZS5zZXRMaW1pdD1mdW5jdGlvbihlLHQpe3RoaXMuX3BoeXNpY3NQbHVnaW4uc2V0TGltaXQodGhpcyxlLHQpfSx0fSh0KTtlLk1vdG9yRW5hYmxlZEpvaW50PXI7dmFyIG49ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gaShpKXtlLmNhbGwodGhpcyx0LkhpbmdlSm9pbnQsaSl9cmV0dXJuIF9fZXh0ZW5kcyhpLGUpLGkucHJvdG90eXBlLnNldE1vdG9yPWZ1bmN0aW9uKGUsdCl7dGhpcy5fcGh5c2ljc1BsdWdpbi5zZXRNb3Rvcih0aGlzLGUsdCl9LGkucHJvdG90eXBlLnNldExpbWl0PWZ1bmN0aW9uKGUsdCl7dGhpcy5fcGh5c2ljc1BsdWdpbi5zZXRMaW1pdCh0aGlzLGUsdCl9LGl9KHIpO2UuSGluZ2VKb2ludD1uO3ZhciBvPWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIGkoaSl7ZS5jYWxsKHRoaXMsdC5IaW5nZTJKb2ludCxpKX1yZXR1cm4gX19leHRlbmRzKGksZSksaS5wcm90b3R5cGUuc2V0TW90b3I9ZnVuY3Rpb24oZSx0LGkpe3ZvaWQgMD09PWkmJihpPTApLHRoaXMuX3BoeXNpY3NQbHVnaW4uc2V0TW90b3IodGhpcyxlLHQsaSl9LGkucHJvdG90eXBlLnNldExpbWl0PWZ1bmN0aW9uKGUsdCxpKXt2b2lkIDA9PT1pJiYoaT0wKSx0aGlzLl9waHlzaWNzUGx1Z2luLnNldExpbWl0KHRoaXMsZSx0LGkpfSxpfShyKTtlLkhpbmdlMkpvaW50PW99KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGkscixuKXt2YXIgbz10aGlzO3JldHVybiB2b2lkIDA9PT1yJiYocj17bWFzczowfSksdGhpcy5vYmplY3Q9dCx0aGlzLnR5cGU9aSx0aGlzLl9vcHRpb25zPXIsdGhpcy5fc2NlbmU9bix0aGlzLl9ib2R5VXBkYXRlUmVxdWlyZWQ9ITEsdGhpcy5fb25CZWZvcmVQaHlzaWNzU3RlcENhbGxiYWNrcz1uZXcgQXJyYXksdGhpcy5fb25BZnRlclBoeXNpY3NTdGVwQ2FsbGJhY2tzPW5ldyBBcnJheSx0aGlzLl9vblBoeXNpY3NDb2xsaWRlQ2FsbGJhY2tzPVtdLHRoaXMuX2RlbHRhUG9zaXRpb249ZS5WZWN0b3IzLlplcm8oKSx0aGlzLl90bXBQb3NpdGlvbldpdGhEZWx0YT1lLlZlY3RvcjMuWmVybygpLHRoaXMuX3RtcFJvdGF0aW9uV2l0aERlbHRhPW5ldyBlLlF1YXRlcm5pb24sdGhpcy5iZWZvcmVTdGVwPWZ1bmN0aW9uKCl7by5vYmplY3QucG9zaXRpb24uc3VidHJhY3RUb1JlZihvLl9kZWx0YVBvc2l0aW9uLG8uX3RtcFBvc2l0aW9uV2l0aERlbHRhKSxvLl9kZWx0YVJvdGF0aW9uQ29uanVnYXRlZD9vLm9iamVjdC5yb3RhdGlvblF1YXRlcm5pb24ubXVsdGlwbHlUb1JlZihvLl9kZWx0YVJvdGF0aW9uQ29uanVnYXRlZCxvLl90bXBSb3RhdGlvbldpdGhEZWx0YSk6by5fdG1wUm90YXRpb25XaXRoRGVsdGEuY29weUZyb20oby5vYmplY3Qucm90YXRpb25RdWF0ZXJuaW9uKSxvLl9waHlzaWNzRW5naW5lLmdldFBoeXNpY3NQbHVnaW4oKS5zZXRQaHlzaWNzQm9keVRyYW5zZm9ybWF0aW9uKG8sby5fdG1wUG9zaXRpb25XaXRoRGVsdGEsby5fdG1wUm90YXRpb25XaXRoRGVsdGEpLFxuby5fb25CZWZvcmVQaHlzaWNzU3RlcENhbGxiYWNrcy5mb3JFYWNoKGZ1bmN0aW9uKGUpe2Uobyl9KX0sdGhpcy5hZnRlclN0ZXA9ZnVuY3Rpb24oKXtvLl9vbkFmdGVyUGh5c2ljc1N0ZXBDYWxsYmFja3MuZm9yRWFjaChmdW5jdGlvbihlKXtlKG8pfSksby5fcGh5c2ljc0VuZ2luZS5nZXRQaHlzaWNzUGx1Z2luKCkuc2V0VHJhbnNmb3JtYXRpb25Gcm9tUGh5c2ljc0JvZHkobyksby5vYmplY3QucG9zaXRpb24uYWRkSW5QbGFjZShvLl9kZWx0YVBvc2l0aW9uKSxvLl9kZWx0YVJvdGF0aW9uJiZvLm9iamVjdC5yb3RhdGlvblF1YXRlcm5pb24ubXVsdGlwbHlJblBsYWNlKG8uX2RlbHRhUm90YXRpb24pfSx0aGlzLm9uQ29sbGlkZT1mdW5jdGlvbihlKXtpZihvLl9vblBoeXNpY3NDb2xsaWRlQ2FsbGJhY2tzLmxlbmd0aCl7dmFyIHQ9by5fcGh5c2ljc0VuZ2luZS5nZXRJbXBvc3RvcldpdGhQaHlzaWNzQm9keShlLmJvZHkpO3QmJm8uX29uUGh5c2ljc0NvbGxpZGVDYWxsYmFja3MuZmlsdGVyKGZ1bmN0aW9uKGUpe3JldHVybi0xIT09ZS5vdGhlckltcG9zdG9ycy5pbmRleE9mKHQpfSkuZm9yRWFjaChmdW5jdGlvbihlKXtlLmNhbGxiYWNrKG8sdCl9KX19LHRoaXMub2JqZWN0PyghdGhpcy5fc2NlbmUmJnQuZ2V0U2NlbmUmJih0aGlzLl9zY2VuZT10LmdldFNjZW5lKCkpLHRoaXMuX3BoeXNpY3NFbmdpbmU9dGhpcy5fc2NlbmUuZ2V0UGh5c2ljc0VuZ2luZSgpLHZvaWQodGhpcy5fcGh5c2ljc0VuZ2luZT8odGhpcy5vYmplY3Qucm90YXRpb25RdWF0ZXJuaW9ufHwodGhpcy5vYmplY3Qucm90YXRpb24/dGhpcy5vYmplY3Qucm90YXRpb25RdWF0ZXJuaW9uPWUuUXVhdGVybmlvbi5Sb3RhdGlvbllhd1BpdGNoUm9sbCh0aGlzLm9iamVjdC5yb3RhdGlvbi55LHRoaXMub2JqZWN0LnJvdGF0aW9uLngsdGhpcy5vYmplY3Qucm90YXRpb24ueik6dGhpcy5vYmplY3Qucm90YXRpb25RdWF0ZXJuaW9uPW5ldyBlLlF1YXRlcm5pb24pLHRoaXMuX29wdGlvbnMubWFzcz12b2lkIDA9PT1yLm1hc3M/MDpyLm1hc3MsdGhpcy5fb3B0aW9ucy5mcmljdGlvbj12b2lkIDA9PT1yLmZyaWN0aW9uPy4yOnIuZnJpY3Rpb24sdGhpcy5fb3B0aW9ucy5yZXN0aXR1dGlvbj12b2lkIDA9PT1yLnJlc3RpdHV0aW9uPy4yOnIucmVzdGl0dXRpb24sdGhpcy5fam9pbnRzPVtdLHRoaXMub2JqZWN0LnBhcmVudHx8dGhpcy5faW5pdCgpKTplLlRvb2xzLkVycm9yKFwiUGh5c2ljcyBub3QgZW5hYmxlZC4gUGxlYXNlIHVzZSBzY2VuZS5lbmFibGVQaHlzaWNzKC4uLikgYmVmb3JlIGNyZWF0aW5nIGltcG9zdG9ycy5cIikpKTp2b2lkIGUuVG9vbHMuRXJyb3IoXCJObyBvYmplY3Qgd2FzIHByb3ZpZGVkLiBBIHBoeXNpY3Mgb2JqZWN0IGlzIG9ibGlnYXRvcnlcIil9cmV0dXJuIHQucHJvdG90eXBlLl9pbml0PWZ1bmN0aW9uKCl7dGhpcy5fcGh5c2ljc0VuZ2luZS5yZW1vdmVJbXBvc3Rvcih0aGlzKSx0aGlzLnBoeXNpY3NCb2R5PW51bGwsdGhpcy5fcGFyZW50PXRoaXMuX3BhcmVudHx8dGhpcy5fZ2V0UGh5c2ljc1BhcmVudCgpLHRoaXMucGFyZW50fHx0aGlzLl9waHlzaWNzRW5naW5lLmFkZEltcG9zdG9yKHRoaXMpfSx0LnByb3RvdHlwZS5fZ2V0UGh5c2ljc1BhcmVudD1mdW5jdGlvbigpe2lmKHRoaXMub2JqZWN0LnBhcmVudCBpbnN0YW5jZW9mIGUuQWJzdHJhY3RNZXNoKXt2YXIgdD10aGlzLm9iamVjdC5wYXJlbnQ7cmV0dXJuIHQucGh5c2ljc0ltcG9zdG9yfX0sdC5wcm90b3R5cGUuaXNCb2R5SW5pdFJlcXVpcmVkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2JvZHlVcGRhdGVSZXF1aXJlZHx8IXRoaXMuX3BoeXNpY3NCb2R5JiYhdGhpcy5fcGFyZW50fSx0LnByb3RvdHlwZS5zZXRTY2FsaW5nVXBkYXRlZD1mdW5jdGlvbihlKXt0aGlzLmZvcmNlVXBkYXRlKCl9LHQucHJvdG90eXBlLmZvcmNlVXBkYXRlPWZ1bmN0aW9uKCl7dGhpcy5faW5pdCgpLHRoaXMucGFyZW50JiZ0aGlzLnBhcmVudC5mb3JjZVVwZGF0ZSgpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJwaHlzaWNzQm9keVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcGFyZW50P3RoaXMuX3BhcmVudC5waHlzaWNzQm9keTp0aGlzLl9waHlzaWNzQm9keX0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX3BoeXNpY3NCb2R5JiZ0aGlzLl9waHlzaWNzRW5naW5lLmdldFBoeXNpY3NQbHVnaW4oKS5yZW1vdmVQaHlzaWNzQm9keSh0aGlzKSx0aGlzLl9waHlzaWNzQm9keT1lLHRoaXMucmVzZXRVcGRhdGVGbGFncygpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcInBhcmVudFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcGFyZW50fSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLHQucHJvdG90eXBlLnJlc2V0VXBkYXRlRmxhZ3M9ZnVuY3Rpb24oKXt0aGlzLl9ib2R5VXBkYXRlUmVxdWlyZWQ9ITF9LHQucHJvdG90eXBlLmdldE9iamVjdEV4dGVuZFNpemU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vYmplY3QuZ2V0Qm91bmRpbmdJbmZvPyh0aGlzLm9iamVjdC5jb21wdXRlV29ybGRNYXRyaXgmJnRoaXMub2JqZWN0LmNvbXB1dGVXb3JsZE1hdHJpeCghMCksdGhpcy5vYmplY3QuZ2V0Qm91bmRpbmdJbmZvKCkuYm91bmRpbmdCb3guZXh0ZW5kU2l6ZS5zY2FsZSgyKS5tdWx0aXBseSh0aGlzLm9iamVjdC5zY2FsaW5nKSk6dC5ERUZBVUxUX09CSkVDVF9TSVpFfSx0LnByb3RvdHlwZS5nZXRPYmplY3RDZW50ZXI9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vYmplY3QuZ2V0Qm91bmRpbmdJbmZvP3RoaXMub2JqZWN0LmdldEJvdW5kaW5nSW5mbygpLmJvdW5kaW5nQm94LmNlbnRlcjp0aGlzLm9iamVjdC5wb3NpdGlvbn0sdC5wcm90b3R5cGUuZ2V0UGFyYW09ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX29wdGlvbnNbZV19LHQucHJvdG90eXBlLnNldFBhcmFtPWZ1bmN0aW9uKGUsdCl7dGhpcy5fb3B0aW9uc1tlXT10LHRoaXMuX2JvZHlVcGRhdGVSZXF1aXJlZD0hMH0sdC5wcm90b3R5cGUuc2V0TWFzcz1mdW5jdGlvbihlKXt0aGlzLmdldFBhcmFtKFwibWFzc1wiKSE9PWUmJnRoaXMuc2V0UGFyYW0oXCJtYXNzXCIsZSksdGhpcy5fcGh5c2ljc0VuZ2luZS5nZXRQaHlzaWNzUGx1Z2luKCkuc2V0Qm9keU1hc3ModGhpcyxlKX0sdC5wcm90b3R5cGUuZ2V0TGluZWFyVmVsb2NpdHk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcGh5c2ljc0VuZ2luZS5nZXRQaHlzaWNzUGx1Z2luKCkuZ2V0TGluZWFyVmVsb2NpdHkodGhpcyl9LHQucHJvdG90eXBlLnNldExpbmVhclZlbG9jaXR5PWZ1bmN0aW9uKGUpe3RoaXMuX3BoeXNpY3NFbmdpbmUuZ2V0UGh5c2ljc1BsdWdpbigpLnNldExpbmVhclZlbG9jaXR5KHRoaXMsZSl9LHQucHJvdG90eXBlLmdldEFuZ3VsYXJWZWxvY2l0eT1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9waHlzaWNzRW5naW5lLmdldFBoeXNpY3NQbHVnaW4oKS5nZXRBbmd1bGFyVmVsb2NpdHkodGhpcyl9LHQucHJvdG90eXBlLnNldEFuZ3VsYXJWZWxvY2l0eT1mdW5jdGlvbihlKXt0aGlzLl9waHlzaWNzRW5naW5lLmdldFBoeXNpY3NQbHVnaW4oKS5zZXRBbmd1bGFyVmVsb2NpdHkodGhpcyxlKX0sdC5wcm90b3R5cGUuZXhlY3V0ZU5hdGl2ZUZ1bmN0aW9uPWZ1bmN0aW9uKGUpe2UodGhpcy5fcGh5c2ljc0VuZ2luZS5nZXRQaHlzaWNzUGx1Z2luKCkud29ybGQsdGhpcy5waHlzaWNzQm9keSl9LHQucHJvdG90eXBlLnJlZ2lzdGVyQmVmb3JlUGh5c2ljc1N0ZXA9ZnVuY3Rpb24oZSl7dGhpcy5fb25CZWZvcmVQaHlzaWNzU3RlcENhbGxiYWNrcy5wdXNoKGUpfSx0LnByb3RvdHlwZS51bnJlZ2lzdGVyQmVmb3JlUGh5c2ljc1N0ZXA9ZnVuY3Rpb24odCl7dmFyIGk9dGhpcy5fb25CZWZvcmVQaHlzaWNzU3RlcENhbGxiYWNrcy5pbmRleE9mKHQpO2k+LTE/dGhpcy5fb25CZWZvcmVQaHlzaWNzU3RlcENhbGxiYWNrcy5zcGxpY2UoaSwxKTplLlRvb2xzLldhcm4oXCJGdW5jdGlvbiB0byByZW1vdmUgd2FzIG5vdCBmb3VuZFwiKX0sdC5wcm90b3R5cGUucmVnaXN0ZXJBZnRlclBoeXNpY3NTdGVwPWZ1bmN0aW9uKGUpe3RoaXMuX29uQWZ0ZXJQaHlzaWNzU3RlcENhbGxiYWNrcy5wdXNoKGUpfSx0LnByb3RvdHlwZS51bnJlZ2lzdGVyQWZ0ZXJQaHlzaWNzU3RlcD1mdW5jdGlvbih0KXt2YXIgaT10aGlzLl9vbkFmdGVyUGh5c2ljc1N0ZXBDYWxsYmFja3MuaW5kZXhPZih0KTtpPi0xP3RoaXMuX29uQWZ0ZXJQaHlzaWNzU3RlcENhbGxiYWNrcy5zcGxpY2UoaSwxKTplLlRvb2xzLldhcm4oXCJGdW5jdGlvbiB0byByZW1vdmUgd2FzIG5vdCBmb3VuZFwiKX0sdC5wcm90b3R5cGUucmVnaXN0ZXJPblBoeXNpY3NDb2xsaWRlPWZ1bmN0aW9uKGUsdCl7dmFyIGk9ZSBpbnN0YW5jZW9mIEFycmF5P2U6W2VdO3RoaXMuX29uUGh5c2ljc0NvbGxpZGVDYWxsYmFja3MucHVzaCh7Y2FsbGJhY2s6dCxvdGhlckltcG9zdG9yczppfSl9LHQucHJvdG90eXBlLnVucmVnaXN0ZXJPblBoeXNpY3NDb2xsaWRlPWZ1bmN0aW9uKHQsaSl7dmFyIHI9dCBpbnN0YW5jZW9mIEFycmF5P3Q6W3RdLG49dGhpcy5fb25QaHlzaWNzQ29sbGlkZUNhbGxiYWNrcy5pbmRleE9mKHtjYWxsYmFjazppLG90aGVySW1wb3N0b3JzOnJ9KTtuPi0xP3RoaXMuX29uUGh5c2ljc0NvbGxpZGVDYWxsYmFja3Muc3BsaWNlKG4sMSk6ZS5Ub29scy5XYXJuKFwiRnVuY3Rpb24gdG8gcmVtb3ZlIHdhcyBub3QgZm91bmRcIil9LHQucHJvdG90eXBlLmFwcGx5Rm9yY2U9ZnVuY3Rpb24oZSx0KXt0aGlzLl9waHlzaWNzRW5naW5lLmdldFBoeXNpY3NQbHVnaW4oKS5hcHBseUZvcmNlKHRoaXMsZSx0KX0sdC5wcm90b3R5cGUuYXBwbHlJbXB1bHNlPWZ1bmN0aW9uKGUsdCl7dGhpcy5fcGh5c2ljc0VuZ2luZS5nZXRQaHlzaWNzUGx1Z2luKCkuYXBwbHlJbXB1bHNlKHRoaXMsZSx0KX0sdC5wcm90b3R5cGUuY3JlYXRlSm9pbnQ9ZnVuY3Rpb24odCxpLHIpe3ZhciBuPW5ldyBlLlBoeXNpY3NKb2ludChpLHIpO3RoaXMuYWRkSm9pbnQodCxuKX0sdC5wcm90b3R5cGUuYWRkSm9pbnQ9ZnVuY3Rpb24oZSx0KXt0aGlzLl9qb2ludHMucHVzaCh7b3RoZXJJbXBvc3RvcjplLGpvaW50OnR9KSx0aGlzLl9waHlzaWNzRW5naW5lLmFkZEpvaW50KHRoaXMsZSx0KX0sdC5wcm90b3R5cGUuc2xlZXA9ZnVuY3Rpb24oKXt0aGlzLl9waHlzaWNzRW5naW5lLmdldFBoeXNpY3NQbHVnaW4oKS5zbGVlcEJvZHkodGhpcyl9LHQucHJvdG90eXBlLndha2VVcD1mdW5jdGlvbigpe3RoaXMuX3BoeXNpY3NFbmdpbmUuZ2V0UGh5c2ljc1BsdWdpbigpLndha2VVcEJvZHkodGhpcyl9LHQucHJvdG90eXBlLmNsb25lPWZ1bmN0aW9uKGUpe3JldHVybiBlP25ldyB0KGUsdGhpcy50eXBlLHRoaXMuX29wdGlvbnMsdGhpcy5fc2NlbmUpOm51bGx9LHQucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXt2YXIgZT10aGlzO3RoaXMuX3BoeXNpY3NFbmdpbmUmJih0aGlzLl9qb2ludHMuZm9yRWFjaChmdW5jdGlvbih0KXtlLl9waHlzaWNzRW5naW5lLnJlbW92ZUpvaW50KGUsdC5vdGhlckltcG9zdG9yLHQuam9pbnQpfSksdGhpcy5fcGh5c2ljc0VuZ2luZS5yZW1vdmVJbXBvc3Rvcih0aGlzKSx0aGlzLnBhcmVudCYmdGhpcy5wYXJlbnQuZm9yY2VVcGRhdGUoKSl9LHQucHJvdG90eXBlLnNldERlbHRhUG9zaXRpb249ZnVuY3Rpb24oZSl7dGhpcy5fZGVsdGFQb3NpdGlvbi5jb3B5RnJvbShlKX0sdC5wcm90b3R5cGUuc2V0RGVsdGFSb3RhdGlvbj1mdW5jdGlvbih0KXt0aGlzLl9kZWx0YVJvdGF0aW9ufHwodGhpcy5fZGVsdGFSb3RhdGlvbj1uZXcgZS5RdWF0ZXJuaW9uKSx0aGlzLl9kZWx0YVJvdGF0aW9uLmNvcHlGcm9tKHQpLHRoaXMuX2RlbHRhUm90YXRpb25Db25qdWdhdGVkPXRoaXMuX2RlbHRhUm90YXRpb24uY29uanVnYXRlKCl9LHQuREVGQVVMVF9PQkpFQ1RfU0laRT1uZXcgZS5WZWN0b3IzKDEsMSwxKSx0Lk5vSW1wb3N0b3I9MCx0LlNwaGVyZUltcG9zdG9yPTEsdC5Cb3hJbXBvc3Rvcj0yLHQuUGxhbmVJbXBvc3Rvcj0zLHQuTWVzaEltcG9zdG9yPTQsdC5DeWxpbmRlckltcG9zdG9yPTcsdC5QYXJ0aWNsZUltcG9zdG9yPTgsdC5IZWlnaHRtYXBJbXBvc3Rvcj05LHR9KCk7ZS5QaHlzaWNzSW1wb3N0b3I9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQsaSl7aWYodm9pZCAwPT09aSYmKGk9bmV3IGUuQ2Fubm9uSlNQbHVnaW4pLHRoaXMuX3BoeXNpY3NQbHVnaW49aSx0aGlzLl9pbXBvc3RvcnM9W10sdGhpcy5fam9pbnRzPVtdLCF0aGlzLl9waHlzaWNzUGx1Z2luLmlzU3VwcG9ydGVkKCkpdGhyb3cgbmV3IEVycm9yKFwiUGh5c2ljcyBFbmdpbmUgXCIrdGhpcy5fcGh5c2ljc1BsdWdpbi5uYW1lK1wiIGNhbm5vdCBiZSBmb3VuZC4gUGxlYXNlIG1ha2Ugc3VyZSBpdCBpcyBpbmNsdWRlZC5cIik7dD10fHxuZXcgZS5WZWN0b3IzKDAsLTkuODA3LDApLHRoaXMuc2V0R3Jhdml0eSh0KSx0aGlzLnNldFRpbWVTdGVwKCl9cmV0dXJuIHQucHJvdG90eXBlLnNldEdyYXZpdHk9ZnVuY3Rpb24oZSl7dGhpcy5ncmF2aXR5PWUsdGhpcy5fcGh5c2ljc1BsdWdpbi5zZXRHcmF2aXR5KHRoaXMuZ3Jhdml0eSl9LHQucHJvdG90eXBlLnNldFRpbWVTdGVwPWZ1bmN0aW9uKGUpe3ZvaWQgMD09PWUmJihlPTEvNjApLHRoaXMuX3BoeXNpY3NQbHVnaW4uc2V0VGltZVN0ZXAoZSl9LHQucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXt0aGlzLl9pbXBvc3RvcnMuZm9yRWFjaChmdW5jdGlvbihlKXtlLmRpc3Bvc2UoKX0pLHRoaXMuX3BoeXNpY3NQbHVnaW4uZGlzcG9zZSgpfSx0LnByb3RvdHlwZS5nZXRQaHlzaWNzUGx1Z2luTmFtZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9waHlzaWNzUGx1Z2luLm5hbWV9LHQucHJvdG90eXBlLmFkZEltcG9zdG9yPWZ1bmN0aW9uKGUpe2UudW5pcXVlSWQ9dGhpcy5faW1wb3N0b3JzLnB1c2goZSksZS5wYXJlbnR8fHRoaXMuX3BoeXNpY3NQbHVnaW4uZ2VuZXJhdGVQaHlzaWNzQm9keShlKX0sdC5wcm90b3R5cGUucmVtb3ZlSW1wb3N0b3I9ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5faW1wb3N0b3JzLmluZGV4T2YoZSk7aWYodD4tMSl7dmFyIGk9dGhpcy5faW1wb3N0b3JzLnNwbGljZSh0LDEpO2kubGVuZ3RoJiYoaVswXS5waHlzaWNzQm9keT1udWxsKX19LHQucHJvdG90eXBlLmFkZEpvaW50PWZ1bmN0aW9uKGUsdCxpKXt2YXIgcj17bWFpbkltcG9zdG9yOmUsY29ubmVjdGVkSW1wb3N0b3I6dCxqb2ludDppfTtpLnBoeXNpY3NQbHVnaW49dGhpcy5fcGh5c2ljc1BsdWdpbix0aGlzLl9qb2ludHMucHVzaChyKSx0aGlzLl9waHlzaWNzUGx1Z2luLmdlbmVyYXRlSm9pbnQocil9LHQucHJvdG90eXBlLnJlbW92ZUpvaW50PWZ1bmN0aW9uKGUsdCxpKXt2YXIgcj10aGlzLl9qb2ludHMuZmlsdGVyKGZ1bmN0aW9uKHIpe3JldHVybiByLmNvbm5lY3RlZEltcG9zdG9yPT09dCYmci5qb2ludD09PWkmJnIubWFpbkltcG9zdG9yPT09ZX0pO3IubGVuZ3RoJiZ0aGlzLl9waHlzaWNzUGx1Z2luLnJlbW92ZUpvaW50KHJbMF0pfSx0LnByb3RvdHlwZS5fc3RlcD1mdW5jdGlvbihlKXt2YXIgdD10aGlzO3RoaXMuX2ltcG9zdG9ycy5mb3JFYWNoKGZ1bmN0aW9uKGUpe2UuaXNCb2R5SW5pdFJlcXVpcmVkKCkmJnQuX3BoeXNpY3NQbHVnaW4uZ2VuZXJhdGVQaHlzaWNzQm9keShlKX0pLGU+LjE/ZT0uMTowPj1lJiYoZT0xLzYwKSx0aGlzLl9waHlzaWNzUGx1Z2luLmV4ZWN1dGVTdGVwKGUsdGhpcy5faW1wb3N0b3JzKX0sdC5wcm90b3R5cGUuZ2V0UGh5c2ljc1BsdWdpbj1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9waHlzaWNzUGx1Z2lufSx0LnByb3RvdHlwZS5nZXRJbXBvc3RvckZvclBoeXNpY3NPYmplY3Q9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PTA7dDx0aGlzLl9pbXBvc3RvcnMubGVuZ3RoOysrdClpZih0aGlzLl9pbXBvc3RvcnNbdF0ub2JqZWN0PT09ZSlyZXR1cm4gdGhpcy5faW1wb3N0b3JzW3RdfSx0LnByb3RvdHlwZS5nZXRJbXBvc3RvcldpdGhQaHlzaWNzQm9keT1mdW5jdGlvbihlKXtmb3IodmFyIHQ9MDt0PHRoaXMuX2ltcG9zdG9ycy5sZW5ndGg7Kyt0KWlmKHRoaXMuX2ltcG9zdG9yc1t0XS5waHlzaWNzQm9keT09PWUpcmV0dXJuIHRoaXMuX2ltcG9zdG9yc1t0XX0sdC5Ob0ltcG9zdG9yPWUuUGh5c2ljc0ltcG9zdG9yLk5vSW1wb3N0b3IsdC5TcGhlcmVJbXBvc3Rvcj1lLlBoeXNpY3NJbXBvc3Rvci5TcGhlcmVJbXBvc3Rvcix0LkJveEltcG9zdG9yPWUuUGh5c2ljc0ltcG9zdG9yLkJveEltcG9zdG9yLHQuUGxhbmVJbXBvc3Rvcj1lLlBoeXNpY3NJbXBvc3Rvci5QbGFuZUltcG9zdG9yLHQuTWVzaEltcG9zdG9yPWUuUGh5c2ljc0ltcG9zdG9yLk1lc2hJbXBvc3Rvcix0LkN5bGluZGVySW1wb3N0b3I9ZS5QaHlzaWNzSW1wb3N0b3IuQ3lsaW5kZXJJbXBvc3Rvcix0LkhlaWdodG1hcEltcG9zdG9yPWUuUGh5c2ljc0ltcG9zdG9yLkhlaWdodG1hcEltcG9zdG9yLHQuQ2Fwc3VsZUltcG9zdG9yPS0xLHQuQ29uZUltcG9zdG9yPS0xLHQuQ29udmV4SHVsbEltcG9zdG9yPS0xLHQuRXBzaWxvbj0uMDAxLHR9KCk7ZS5QaHlzaWNzRW5naW5lPXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCgpe31yZXR1cm4gdC5wcm90b3R5cGUuc2V0PWZ1bmN0aW9uKHQsaSl7c3dpdGNoKGkpe2Nhc2UgZS5WZXJ0ZXhCdWZmZXIuUG9zaXRpb25LaW5kOnRoaXMucG9zaXRpb25zPXQ7YnJlYWs7Y2FzZSBlLlZlcnRleEJ1ZmZlci5Ob3JtYWxLaW5kOnRoaXMubm9ybWFscz10O2JyZWFrO2Nhc2UgZS5WZXJ0ZXhCdWZmZXIuVVZLaW5kOnRoaXMudXZzPXQ7YnJlYWs7Y2FzZSBlLlZlcnRleEJ1ZmZlci5VVjJLaW5kOnRoaXMudXZzMj10O2JyZWFrO2Nhc2UgZS5WZXJ0ZXhCdWZmZXIuVVYzS2luZDp0aGlzLnV2czM9dDticmVhaztjYXNlIGUuVmVydGV4QnVmZmVyLlVWNEtpbmQ6dGhpcy51dnM0PXQ7YnJlYWs7Y2FzZSBlLlZlcnRleEJ1ZmZlci5VVjVLaW5kOnRoaXMudXZzNT10O2JyZWFrO2Nhc2UgZS5WZXJ0ZXhCdWZmZXIuVVY2S2luZDp0aGlzLnV2czY9dDticmVhaztjYXNlIGUuVmVydGV4QnVmZmVyLkNvbG9yS2luZDp0aGlzLmNvbG9ycz10O2JyZWFrO2Nhc2UgZS5WZXJ0ZXhCdWZmZXIuTWF0cmljZXNJbmRpY2VzS2luZDp0aGlzLm1hdHJpY2VzSW5kaWNlcz10O2JyZWFrO2Nhc2UgZS5WZXJ0ZXhCdWZmZXIuTWF0cmljZXNXZWlnaHRzS2luZDp0aGlzLm1hdHJpY2VzV2VpZ2h0cz10O2JyZWFrO2Nhc2UgZS5WZXJ0ZXhCdWZmZXIuTWF0cmljZXNJbmRpY2VzRXh0cmFLaW5kOnRoaXMubWF0cmljZXNJbmRpY2VzRXh0cmE9dDticmVhaztjYXNlIGUuVmVydGV4QnVmZmVyLk1hdHJpY2VzV2VpZ2h0c0V4dHJhS2luZDp0aGlzLm1hdHJpY2VzV2VpZ2h0c0V4dHJhPXR9fSx0LnByb3RvdHlwZS5hcHBseVRvTWVzaD1mdW5jdGlvbihlLHQpe3RoaXMuX2FwcGx5VG8oZSx0KX0sdC5wcm90b3R5cGUuYXBwbHlUb0dlb21ldHJ5PWZ1bmN0aW9uKGUsdCl7dGhpcy5fYXBwbHlUbyhlLHQpfSx0LnByb3RvdHlwZS51cGRhdGVNZXNoPWZ1bmN0aW9uKGUsdCxpKXt0aGlzLl91cGRhdGUoZSl9LHQucHJvdG90eXBlLnVwZGF0ZUdlb21ldHJ5PWZ1bmN0aW9uKGUsdCxpKXt0aGlzLl91cGRhdGUoZSl9LHQucHJvdG90eXBlLl9hcHBseVRvPWZ1bmN0aW9uKHQsaSl7dGhpcy5wb3NpdGlvbnMmJnQuc2V0VmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLlBvc2l0aW9uS2luZCx0aGlzLnBvc2l0aW9ucyxpKSx0aGlzLm5vcm1hbHMmJnQuc2V0VmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLk5vcm1hbEtpbmQsdGhpcy5ub3JtYWxzLGkpLHRoaXMudXZzJiZ0LnNldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5VVktpbmQsdGhpcy51dnMsaSksdGhpcy51dnMyJiZ0LnNldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5VVjJLaW5kLHRoaXMudXZzMixpKSx0aGlzLnV2czMmJnQuc2V0VmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLlVWM0tpbmQsdGhpcy51dnMzLGkpLHRoaXMudXZzNCYmdC5zZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuVVY0S2luZCx0aGlzLnV2czQsaSksdGhpcy51dnM1JiZ0LnNldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5VVjVLaW5kLHRoaXMudXZzNSxpKSx0aGlzLnV2czYmJnQuc2V0VmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLlVWNktpbmQsdGhpcy51dnM2LGkpLHRoaXMuY29sb3JzJiZ0LnNldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5Db2xvcktpbmQsdGhpcy5jb2xvcnMsaSksdGhpcy5tYXRyaWNlc0luZGljZXMmJnQuc2V0VmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLk1hdHJpY2VzSW5kaWNlc0tpbmQsdGhpcy5tYXRyaWNlc0luZGljZXMsaSksdGhpcy5tYXRyaWNlc1dlaWdodHMmJnQuc2V0VmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLk1hdHJpY2VzV2VpZ2h0c0tpbmQsdGhpcy5tYXRyaWNlc1dlaWdodHMsaSksdGhpcy5tYXRyaWNlc0luZGljZXNFeHRyYSYmdC5zZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuTWF0cmljZXNJbmRpY2VzRXh0cmFLaW5kLHRoaXMubWF0cmljZXNJbmRpY2VzRXh0cmEsaSksdGhpcy5tYXRyaWNlc1dlaWdodHNFeHRyYSYmdC5zZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuTWF0cmljZXNXZWlnaHRzRXh0cmFLaW5kLHRoaXMubWF0cmljZXNXZWlnaHRzRXh0cmEsaSksdGhpcy5pbmRpY2VzJiZ0LnNldEluZGljZXModGhpcy5pbmRpY2VzKX0sdC5wcm90b3R5cGUuX3VwZGF0ZT1mdW5jdGlvbih0LGkscil7dGhpcy5wb3NpdGlvbnMmJnQudXBkYXRlVmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLlBvc2l0aW9uS2luZCx0aGlzLnBvc2l0aW9ucyxpLHIpLHRoaXMubm9ybWFscyYmdC51cGRhdGVWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuTm9ybWFsS2luZCx0aGlzLm5vcm1hbHMsaSxyKSx0aGlzLnV2cyYmdC51cGRhdGVWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuVVZLaW5kLHRoaXMudXZzLGksciksdGhpcy51dnMyJiZ0LnVwZGF0ZVZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5VVjJLaW5kLHRoaXMudXZzMixpLHIpLHRoaXMudXZzMyYmdC51cGRhdGVWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuVVYzS2luZCx0aGlzLnV2czMsaSxyKSx0aGlzLnV2czQmJnQudXBkYXRlVmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLlVWNEtpbmQsdGhpcy51dnM0LGksciksdGhpcy51dnM1JiZ0LnVwZGF0ZVZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5VVjVLaW5kLHRoaXMudXZzNSxpLHIpLHRoaXMudXZzNiYmdC51cGRhdGVWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuVVY2S2luZCx0aGlzLnV2czYsaSxyKSx0aGlzLmNvbG9ycyYmdC51cGRhdGVWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuQ29sb3JLaW5kLHRoaXMuY29sb3JzLGksciksdGhpcy5tYXRyaWNlc0luZGljZXMmJnQudXBkYXRlVmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLk1hdHJpY2VzSW5kaWNlc0tpbmQsdGhpcy5tYXRyaWNlc0luZGljZXMsaSxyKSx0aGlzLm1hdHJpY2VzV2VpZ2h0cyYmdC51cGRhdGVWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuTWF0cmljZXNXZWlnaHRzS2luZCx0aGlzLm1hdHJpY2VzV2VpZ2h0cyxpLHIpLHRoaXMubWF0cmljZXNJbmRpY2VzRXh0cmEmJnQudXBkYXRlVmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLk1hdHJpY2VzSW5kaWNlc0V4dHJhS2luZCx0aGlzLm1hdHJpY2VzSW5kaWNlc0V4dHJhLGksciksdGhpcy5tYXRyaWNlc1dlaWdodHNFeHRyYSYmdC51cGRhdGVWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuTWF0cmljZXNXZWlnaHRzRXh0cmFLaW5kLHRoaXMubWF0cmljZXNXZWlnaHRzRXh0cmEsaSxyKSx0aGlzLmluZGljZXMmJnQuc2V0SW5kaWNlcyh0aGlzLmluZGljZXMpfSx0LnByb3RvdHlwZS50cmFuc2Zvcm09ZnVuY3Rpb24odCl7dmFyIGkscj1lLlZlY3RvcjMuWmVybygpO2lmKHRoaXMucG9zaXRpb25zKXt2YXIgbj1lLlZlY3RvcjMuWmVybygpO2ZvcihpPTA7aTx0aGlzLnBvc2l0aW9ucy5sZW5ndGg7aSs9MyllLlZlY3RvcjMuRnJvbUFycmF5VG9SZWYodGhpcy5wb3NpdGlvbnMsaSxuKSxlLlZlY3RvcjMuVHJhbnNmb3JtQ29vcmRpbmF0ZXNUb1JlZihuLHQsciksdGhpcy5wb3NpdGlvbnNbaV09ci54LHRoaXMucG9zaXRpb25zW2krMV09ci55LHRoaXMucG9zaXRpb25zW2krMl09ci56fWlmKHRoaXMubm9ybWFscyl7dmFyIG89ZS5WZWN0b3IzLlplcm8oKTtmb3IoaT0wO2k8dGhpcy5ub3JtYWxzLmxlbmd0aDtpKz0zKWUuVmVjdG9yMy5Gcm9tQXJyYXlUb1JlZih0aGlzLm5vcm1hbHMsaSxvKSxlLlZlY3RvcjMuVHJhbnNmb3JtTm9ybWFsVG9SZWYobyx0LHIpLHRoaXMubm9ybWFsc1tpXT1yLngsdGhpcy5ub3JtYWxzW2krMV09ci55LHRoaXMubm9ybWFsc1tpKzJdPXIuen19LHQucHJvdG90eXBlLm1lcmdlPWZ1bmN0aW9uKGUpe2lmKGUuaW5kaWNlcyl7dGhpcy5pbmRpY2VzfHwodGhpcy5pbmRpY2VzPVtdKTtmb3IodmFyIHQ9dGhpcy5wb3NpdGlvbnM/dGhpcy5wb3NpdGlvbnMubGVuZ3RoLzM6MCxpPTA7aTxlLmluZGljZXMubGVuZ3RoO2krKyl0aGlzLmluZGljZXMucHVzaChlLmluZGljZXNbaV0rdCl9dGhpcy5wb3NpdGlvbnM9dGhpcy5fbWVyZ2VFbGVtZW50KHRoaXMucG9zaXRpb25zLGUucG9zaXRpb25zKSx0aGlzLm5vcm1hbHM9dGhpcy5fbWVyZ2VFbGVtZW50KHRoaXMubm9ybWFscyxlLm5vcm1hbHMpLHRoaXMudXZzPXRoaXMuX21lcmdlRWxlbWVudCh0aGlzLnV2cyxlLnV2cyksdGhpcy51dnMyPXRoaXMuX21lcmdlRWxlbWVudCh0aGlzLnV2czIsZS51dnMyKSx0aGlzLnV2czM9dGhpcy5fbWVyZ2VFbGVtZW50KHRoaXMudXZzMyxlLnV2czMpLHRoaXMudXZzND10aGlzLl9tZXJnZUVsZW1lbnQodGhpcy51dnM0LGUudXZzNCksdGhpcy51dnM1PXRoaXMuX21lcmdlRWxlbWVudCh0aGlzLnV2czUsZS51dnM1KSx0aGlzLnV2czY9dGhpcy5fbWVyZ2VFbGVtZW50KHRoaXMudXZzNixlLnV2czYpLHRoaXMuY29sb3JzPXRoaXMuX21lcmdlRWxlbWVudCh0aGlzLmNvbG9ycyxlLmNvbG9ycyksdGhpcy5tYXRyaWNlc0luZGljZXM9dGhpcy5fbWVyZ2VFbGVtZW50KHRoaXMubWF0cmljZXNJbmRpY2VzLGUubWF0cmljZXNJbmRpY2VzKSx0aGlzLm1hdHJpY2VzV2VpZ2h0cz10aGlzLl9tZXJnZUVsZW1lbnQodGhpcy5tYXRyaWNlc1dlaWdodHMsZS5tYXRyaWNlc1dlaWdodHMpLHRoaXMubWF0cmljZXNJbmRpY2VzRXh0cmE9dGhpcy5fbWVyZ2VFbGVtZW50KHRoaXMubWF0cmljZXNJbmRpY2VzRXh0cmEsZS5tYXRyaWNlc0luZGljZXNFeHRyYSksdGhpcy5tYXRyaWNlc1dlaWdodHNFeHRyYT10aGlzLl9tZXJnZUVsZW1lbnQodGhpcy5tYXRyaWNlc1dlaWdodHNFeHRyYSxlLm1hdHJpY2VzV2VpZ2h0c0V4dHJhKX0sdC5wcm90b3R5cGUuX21lcmdlRWxlbWVudD1mdW5jdGlvbihlLHQpe2lmKCF0KXJldHVybiBlO2lmKCFlKXJldHVybiB0O3ZhciBpPXQubGVuZ3RoK2UubGVuZ3RoLHI9ZSBpbnN0YW5jZW9mIEZsb2F0MzJBcnJheSxuPXQgaW5zdGFuY2VvZiBGbG9hdDMyQXJyYXk7aWYocil7dmFyIG89bmV3IEZsb2F0MzJBcnJheShpKTtyZXR1cm4gby5zZXQoZSksby5zZXQodCxlLmxlbmd0aCksb31pZihuKXtmb3IodmFyIHM9ZS5zbGljZSgwKSxhPTAsaT10Lmxlbmd0aDtpPmE7YSsrKXMucHVzaCh0W2FdKTtyZXR1cm4gc31yZXR1cm4gZS5jb25jYXQodCl9LHQucHJvdG90eXBlLnNlcmlhbGl6ZT1mdW5jdGlvbigpe3ZhciBlPXRoaXMuc2VyaWFsaXplKCk7cmV0dXJuIHRoaXMucG9zaXRpb25zJiYoZS5wb3NpdGlvbnM9dGhpcy5wb3NpdGlvbnMpLHRoaXMubm9ybWFscyYmKGUubm9ybWFscz10aGlzLm5vcm1hbHMpLHRoaXMudXZzJiYoZS51dnM9dGhpcy51dnMpLHRoaXMudXZzMiYmKGUudXZzMj10aGlzLnV2czIpLHRoaXMudXZzMyYmKGUudXZzMz10aGlzLnV2czMpLHRoaXMudXZzNCYmKGUudXZzND10aGlzLnV2czQpLHRoaXMudXZzNSYmKGUudXZzNT10aGlzLnV2czUpLHRoaXMudXZzNiYmKGUudXZzNj10aGlzLnV2czYpLHRoaXMuY29sb3JzJiYoZS5jb2xvcnM9dGhpcy5jb2xvcnMpLHRoaXMubWF0cmljZXNJbmRpY2VzJiYoZS5tYXRyaWNlc0luZGljZXM9dGhpcy5tYXRyaWNlc0luZGljZXMsZS5tYXRyaWNlc0luZGljZXMuX2lzRXhwYW5kZWQ9ITApLHRoaXMubWF0cmljZXNXZWlnaHRzJiYoZS5tYXRyaWNlc1dlaWdodHM9dGhpcy5tYXRyaWNlc1dlaWdodHMpLHRoaXMubWF0cmljZXNJbmRpY2VzRXh0cmEmJihlLm1hdHJpY2VzSW5kaWNlc0V4dHJhPXRoaXMubWF0cmljZXNJbmRpY2VzRXh0cmEsZS5tYXRyaWNlc0luZGljZXNFeHRyYS5faXNFeHBhbmRlZD0hMCksdGhpcy5tYXRyaWNlc1dlaWdodHNFeHRyYSYmKGUubWF0cmljZXNXZWlnaHRzRXh0cmE9dGhpcy5tYXRyaWNlc1dlaWdodHNFeHRyYSksZS5pbmRpY2VzPXRoaXMuaW5kaWNlcyxlfSx0LkV4dHJhY3RGcm9tTWVzaD1mdW5jdGlvbihlLGkpe3JldHVybiB0Ll9FeHRyYWN0RnJvbShlLGkpfSx0LkV4dHJhY3RGcm9tR2VvbWV0cnk9ZnVuY3Rpb24oZSxpKXtyZXR1cm4gdC5fRXh0cmFjdEZyb20oZSxpKX0sdC5fRXh0cmFjdEZyb209ZnVuY3Rpb24oaSxyKXt2YXIgbj1uZXcgdDtyZXR1cm4gaS5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZS5WZXJ0ZXhCdWZmZXIuUG9zaXRpb25LaW5kKSYmKG4ucG9zaXRpb25zPWkuZ2V0VmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLlBvc2l0aW9uS2luZCxyKSksaS5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZS5WZXJ0ZXhCdWZmZXIuTm9ybWFsS2luZCkmJihuLm5vcm1hbHM9aS5nZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuTm9ybWFsS2luZCxyKSksaS5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZS5WZXJ0ZXhCdWZmZXIuVVZLaW5kKSYmKG4udXZzPWkuZ2V0VmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLlVWS2luZCxyKSksaS5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZS5WZXJ0ZXhCdWZmZXIuVVYyS2luZCkmJihuLnV2czI9aS5nZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuVVYyS2luZCxyKSksaS5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZS5WZXJ0ZXhCdWZmZXIuVVYzS2luZCkmJihuLnV2czM9aS5nZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuVVYzS2luZCxyKSksaS5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZS5WZXJ0ZXhCdWZmZXIuVVY0S2luZCkmJihuLnV2czQ9aS5nZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuVVY0S2luZCxyKSksaS5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZS5WZXJ0ZXhCdWZmZXIuVVY1S2luZCkmJihuLnV2czU9aS5nZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuVVY1S2luZCxyKSksaS5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZS5WZXJ0ZXhCdWZmZXIuVVY2S2luZCkmJihuLnV2czY9aS5nZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuVVY2S2luZCxyKSksaS5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZS5WZXJ0ZXhCdWZmZXIuQ29sb3JLaW5kKSYmKG4uY29sb3JzPWkuZ2V0VmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLkNvbG9yS2luZCxyKSksaS5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZS5WZXJ0ZXhCdWZmZXIuTWF0cmljZXNJbmRpY2VzS2luZCkmJihuLm1hdHJpY2VzSW5kaWNlcz1pLmdldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5NYXRyaWNlc0luZGljZXNLaW5kLHIpKSxpLmlzVmVydGljZXNEYXRhUHJlc2VudChlLlZlcnRleEJ1ZmZlci5NYXRyaWNlc1dlaWdodHNLaW5kKSYmKG4ubWF0cmljZXNXZWlnaHRzPWkuZ2V0VmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLk1hdHJpY2VzV2VpZ2h0c0tpbmQscikpLGkuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGUuVmVydGV4QnVmZmVyLk1hdHJpY2VzSW5kaWNlc0V4dHJhS2luZCkmJihuLm1hdHJpY2VzSW5kaWNlc0V4dHJhPWkuZ2V0VmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLk1hdHJpY2VzSW5kaWNlc0V4dHJhS2luZCxyKSksaS5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZS5WZXJ0ZXhCdWZmZXIuTWF0cmljZXNXZWlnaHRzRXh0cmFLaW5kKSYmKG4ubWF0cmljZXNXZWlnaHRzRXh0cmE9aS5nZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuTWF0cmljZXNXZWlnaHRzRXh0cmFLaW5kLHIpKSxuLmluZGljZXM9aS5nZXRJbmRpY2VzKHIpLG59LHQuQ3JlYXRlUmliYm9uPWZ1bmN0aW9uKGkpe3ZhciByPWkucGF0aEFycmF5LG49aS5jbG9zZUFycmF5fHwhMSxvPWkuY2xvc2VQYXRofHwhMSxzPU1hdGguZmxvb3IoclswXS5sZW5ndGgvMiksYT1pLm9mZnNldHx8czthPWE+cz9zOk1hdGguZmxvb3IoYSk7dmFyIGgsYyxsLHUsZj0wPT09aS5zaWRlT3JpZW50YXRpb24/MDppLnNpZGVPcmllbnRhdGlvbnx8ZS5NZXNoLkRFRkFVTFRTSURFLGQ9W10scD1bXSxfPVtdLG09W10sZz1bXSx2PVtdLHk9W10seD1bXSxiPVtdLFA9W107aWYoci5sZW5ndGg8Mil7dmFyIEE9W10sVD1bXTtmb3IobD0wO2w8clswXS5sZW5ndGgtYTtsKyspQS5wdXNoKHJbMF1bbF0pLFQucHVzaChyWzBdW2wrYV0pO3I9W0EsVF19dmFyIEUsQyxTPTAsTT1vPzE6MDtoPXJbMF0ubGVuZ3RoO3ZhciBJLEQ7Zm9yKGM9MDtjPHIubGVuZ3RoO2MrKyl7Zm9yKHlbY109MCxnW2NdPVswXSxFPXJbY10sQz1FLmxlbmd0aCxoPUM+aD9oOkMsdT0wO0M+dTspZC5wdXNoKEVbdV0ueCxFW3VdLnksRVt1XS56KSx1PjAmJihJPUVbdV0uc3VidHJhY3QoRVt1LTFdKS5sZW5ndGgoKSxEPUkreVtjXSxnW2NdLnB1c2goRCkseVtjXT1EKSx1Kys7byYmKHUtLSxkLnB1c2goRVswXS54LEVbMF0ueSxFWzBdLnopLEk9RVt1XS5zdWJ0cmFjdChFWzBdKS5sZW5ndGgoKSxEPUkreVtjXSxnW2NdLnB1c2goRCkseVtjXT1EKSxiW2NdPUMrTSxQW2NdPVMsUys9QytNfXZhciBSLE8sdyxMO2ZvcihsPTA7aCtNPmw7bCsrKXtmb3IoeFtsXT0wLHZbbF09WzBdLGM9MDtjPHIubGVuZ3RoLTE7YysrKVI9cltjXSxPPXJbYysxXSxsPT09aD8odz1SWzBdLEw9T1swXSk6KHc9UltsXSxMPU9bbF0pLEk9TC5zdWJ0cmFjdCh3KS5sZW5ndGgoKSxEPUkreFtsXSx2W2xdLnB1c2goRCkseFtsXT1EO24mJihSPXJbY10sTz1yWzBdLGw9PT1oJiYoTD1PWzBdKSxJPUwuc3VidHJhY3QodykubGVuZ3RoKCksRD1JK3hbbF0seFtsXT1EKX12YXIgQixWO2ZvcihjPTA7YzxyLmxlbmd0aDtjKyspZm9yKGw9MDtoK00+bDtsKyspQj1nW2NdW2xdL3lbY10sVj12W2xdW2NdL3hbbF0sbS5wdXNoKEIsVik7Yz0wO2Zvcih2YXIgRj0wLE49YltjXS0xLHo9YltjKzFdLTEsaz16Pk4/Tjp6LFU9UFsxXS1QWzBdLEc9bj9iLmxlbmd0aDpiLmxlbmd0aC0xO2s+PUYmJkc+YzspcC5wdXNoKEYsRitVLEYrMSkscC5wdXNoKEYrVSsxLEYrMSxGK1UpLEYrPTEsRj09PWsmJihjKyssYz09PWIubGVuZ3RoLTE/KFU9UFswXS1QW2NdLE49YltjXS0xLHo9YlswXS0xKTooVT1QW2MrMV0tUFtjXSxOPWJbY10tMSx6PWJbYysxXS0xKSxGPVBbY10saz16Pk4/TitGOnorRik7aWYodC5Db21wdXRlTm9ybWFscyhkLHAsXyksbyl7dmFyIFc9MCxZPTA7Zm9yKGM9MDtjPHIubGVuZ3RoO2MrKylXPTMqUFtjXSxZPWMrMTxyLmxlbmd0aD8zKihQW2MrMV0tMSk6Xy5sZW5ndGgtMyxfW1ddPS41KihfW1ddK19bWV0pLF9bVysxXT0uNSooX1tXKzFdK19bWSsxXSksX1tXKzJdPS41KihfW1crMl0rX1tZKzJdKSxfW1ldPV9bV10sX1tZKzFdPV9bVysxXSxfW1krMl09X1tXKzJdfXQuX0NvbXB1dGVTaWRlcyhmLGQscCxfLG0pO3ZhciBIPW5ldyB0O3JldHVybiBILmluZGljZXM9cCxILnBvc2l0aW9ucz1kLEgubm9ybWFscz1fLEgudXZzPW0sbyYmKEguX2lkeD1QKSxIfSx0LkNyZWF0ZUJveD1mdW5jdGlvbihpKXtmb3IodmFyIHI9W25ldyBlLlZlY3RvcjMoMCwwLDEpLG5ldyBlLlZlY3RvcjMoMCwwLC0xKSxuZXcgZS5WZWN0b3IzKDEsMCwwKSxuZXcgZS5WZWN0b3IzKC0xLDAsMCksbmV3IGUuVmVjdG9yMygwLDEsMCksbmV3IGUuVmVjdG9yMygwLC0xLDApXSxuPVtdLG89W10scz1bXSxhPVtdLGg9aS53aWR0aHx8aS5zaXplfHwxLGM9aS5oZWlnaHR8fGkuc2l6ZXx8MSxsPWkuZGVwdGh8fGkuc2l6ZXx8MSx1PTA9PT1pLnNpZGVPcmllbnRhdGlvbj8wOmkuc2lkZU9yaWVudGF0aW9ufHxlLk1lc2guREVGQVVMVFNJREUsZj1pLmZhY2VVVnx8bmV3IEFycmF5KDYpLGQ9aS5mYWNlQ29sb3JzLHA9W10sXz0wOzY+XztfKyspdm9pZCAwPT09ZltfXSYmKGZbX109bmV3IGUuVmVjdG9yNCgwLDAsMSwxKSksZCYmdm9pZCAwPT09ZFtfXSYmKGRbX109bmV3IGUuQ29sb3I0KDEsMSwxLDEpKTtmb3IodmFyIG09bmV3IGUuVmVjdG9yMyhoLzIsYy8yLGwvMiksZz0wO2c8ci5sZW5ndGg7ZysrKXt2YXIgdj1yW2ddLHk9bmV3IGUuVmVjdG9yMyh2Lnksdi56LHYueCkseD1lLlZlY3RvcjMuQ3Jvc3Modix5KSxiPW8ubGVuZ3RoLzM7bi5wdXNoKGIpLG4ucHVzaChiKzEpLG4ucHVzaChiKzIpLG4ucHVzaChiKSxuLnB1c2goYisyKSxuLnB1c2goYiszKTt2YXIgUD12LnN1YnRyYWN0KHkpLnN1YnRyYWN0KHgpLm11bHRpcGx5KG0pO28ucHVzaChQLngsUC55LFAueikscy5wdXNoKHYueCx2Lnksdi56KSxhLnB1c2goZltnXS56LGZbZ10udyksZCYmcC5wdXNoKGRbZ10ucixkW2ddLmcsZFtnXS5iLGRbZ10uYSksUD12LnN1YnRyYWN0KHkpLmFkZCh4KS5tdWx0aXBseShtKSxvLnB1c2goUC54LFAueSxQLnopLHMucHVzaCh2Lngsdi55LHYueiksYS5wdXNoKGZbZ10ueCxmW2ddLncpLGQmJnAucHVzaChkW2ddLnIsZFtnXS5nLGRbZ10uYixkW2ddLmEpLFA9di5hZGQoeSkuYWRkKHgpLm11bHRpcGx5KG0pLG8ucHVzaChQLngsUC55LFAueikscy5wdXNoKHYueCx2Lnksdi56KSxhLnB1c2goZltnXS54LGZbZ10ueSksZCYmcC5wdXNoKGRbZ10ucixkW2ddLmcsZFtnXS5iLGRbZ10uYSksUD12LmFkZCh5KS5zdWJ0cmFjdCh4KS5tdWx0aXBseShtKSxvLnB1c2goUC54LFAueSxQLnopLHMucHVzaCh2Lngsdi55LHYueiksYS5wdXNoKGZbZ10ueixmW2ddLnkpLGQmJnAucHVzaChkW2ddLnIsZFtnXS5nLGRbZ10uYixkW2ddLmEpfXQuX0NvbXB1dGVTaWRlcyh1LG8sbixzLGEpO3ZhciBBPW5ldyB0O2lmKEEuaW5kaWNlcz1uLEEucG9zaXRpb25zPW8sQS5ub3JtYWxzPXMsQS51dnM9YSxkKXt2YXIgVD11PT09ZS5NZXNoLkRPVUJMRVNJREU/cC5jb25jYXQocCk6cDtBLmNvbG9ycz1UfXJldHVybiBBfSx0LkNyZWF0ZVNwaGVyZT1mdW5jdGlvbihpKXtmb3IodmFyIHI9aS5zZWdtZW50c3x8MzIsbj1pLmRpYW1ldGVyWHx8aS5kaWFtZXRlcnx8MSxvPWkuZGlhbWV0ZXJZfHxpLmRpYW1ldGVyfHwxLHM9aS5kaWFtZXRlclp8fGkuZGlhbWV0ZXJ8fDEsYT1pLmFyYzw9MHx8aS5hcmM+MT8xOmkuYXJjfHwxLGg9aS5zbGljZTw9MD8xOmkuc2xpY2V8fDEsYz0wPT09aS5zaWRlT3JpZW50YXRpb24/MDppLnNpZGVPcmllbnRhdGlvbnx8ZS5NZXNoLkRFRkFVTFRTSURFLGw9bmV3IGUuVmVjdG9yMyhuLzIsby8yLHMvMiksdT0yK3IsZj0yKnUsZD1bXSxwPVtdLF89W10sbT1bXSxnPTA7dT49ZztnKyspe2Zvcih2YXIgdj1nL3UseT12Kk1hdGguUEkqaCx4PTA7Zj49eDt4Kyspe3ZhciBiPXgvZixQPWIqTWF0aC5QSSoyKmEsQT1lLk1hdHJpeC5Sb3RhdGlvblooLXkpLFQ9ZS5NYXRyaXguUm90YXRpb25ZKFApLEU9ZS5WZWN0b3IzLlRyYW5zZm9ybUNvb3JkaW5hdGVzKGUuVmVjdG9yMy5VcCgpLEEpLEM9ZS5WZWN0b3IzLlRyYW5zZm9ybUNvb3JkaW5hdGVzKEUsVCksUz1DLm11bHRpcGx5KGwpLE09Qy5kaXZpZGUobCkubm9ybWFsaXplKCk7cC5wdXNoKFMueCxTLnksUy56KSxfLnB1c2goTS54LE0ueSxNLnopLG0ucHVzaChiLHYpfWlmKGc+MClmb3IodmFyIEk9cC5sZW5ndGgvMyxEPUktMiooZisxKTtJPkQrZisyO0QrKylkLnB1c2goRCksZC5wdXNoKEQrMSksZC5wdXNoKEQrZisxKSxkLnB1c2goRCtmKzEpLGQucHVzaChEKzEpLGQucHVzaChEK2YrMil9dC5fQ29tcHV0ZVNpZGVzKGMscCxkLF8sbSk7dmFyIFI9bmV3IHQ7cmV0dXJuIFIuaW5kaWNlcz1kLFIucG9zaXRpb25zPXAsUi5ub3JtYWxzPV8sUi51dnM9bSxSfSx0LkNyZWF0ZUN5bGluZGVyPWZ1bmN0aW9uKGkpe3ZhciByLG49aS5oZWlnaHR8fDIsbz0wPT09aS5kaWFtZXRlclRvcD8wOmkuZGlhbWV0ZXJUb3B8fGkuZGlhbWV0ZXJ8fDEscz1pLmRpYW1ldGVyQm90dG9tfHxpLmRpYW1ldGVyfHwxLGE9aS50ZXNzZWxsYXRpb258fDI0LGg9aS5zdWJkaXZpc2lvbnN8fDEsYz1pLmhhc1JpbmdzLGw9aS5lbmNsb3NlLHU9aS5hcmM8PTB8fGkuYXJjPjE/MTppLmFyY3x8MSxmPTA9PT1pLnNpZGVPcmllbnRhdGlvbj8wOmkuc2lkZU9yaWVudGF0aW9ufHxlLk1lc2guREVGQVVMVFNJREUsZD1pLmZhY2VVVnx8bmV3IEFycmF5KDMpLHA9aS5mYWNlQ29sb3JzLF89MSE9PXUmJmw/MjowLG09Yz9oOjEsZz0yKygxK18pKm07Zm9yKHI9MDtnPnI7cisrKXAmJnZvaWQgMD09PXBbcl0mJihwW3JdPW5ldyBlLkNvbG9yNCgxLDEsMSwxKSk7Zm9yKHI9MDtnPnI7cisrKWQmJnZvaWQgMD09PWRbcl0mJihkW3JdPW5ldyBlLlZlY3RvcjQoMCwwLDEsMSkpO3ZhciB2LHkseCxiLFAsQSxUPVtdLEU9W10sQz1bXSxTPVtdLE09W10sST0yKk1hdGguUEkqdS9hLEQ9KHMtbykvMi9uLFI9ZS5WZWN0b3IzLlplcm8oKSxPPWUuVmVjdG9yMy5aZXJvKCksdz1lLlZlY3RvcjMuWmVybygpLEw9ZS5WZWN0b3IzLlplcm8oKSxCPWUuVmVjdG9yMy5aZXJvKCksVj1lLkF4aXMuWSxGPTEsTj0xLHo9MCxrPTA7Zm9yKGI9MDtoPj1iO2IrKylmb3IoeT1iL2gseD0oeSooby1zKStzKS8yLEY9YyYmMCE9PWImJmIhPT1oPzI6MSxBPTA7Rj5BO0ErKyl7Zm9yKGMmJihOKz1BKSxsJiYoTis9MipBKSxQPTA7YT49UDtQKyspdj1QKkksUi54PU1hdGguY29zKC12KSp4LFIueT0tbi8yK3kqbixSLno9TWF0aC5zaW4oLXYpKngsMD09PW8mJmI9PT1oPyhPLng9Q1tDLmxlbmd0aC0zKihhKzEpXSxPLnk9Q1tDLmxlbmd0aC0zKihhKzEpKzFdLE8uej1DW0MubGVuZ3RoLTMqKGErMSkrMl0pOihPLng9Ui54LE8uej1SLnosTy55PU1hdGguc3FydChPLngqTy54K08ueipPLnopKkQsTy5ub3JtYWxpemUoKSksMD09PVAmJih3LmNvcHlGcm9tKFIpLEwuY29weUZyb20oTykpLEUucHVzaChSLngsUi55LFIueiksQy5wdXNoKE8ueCxPLnksTy56KSxrPWM/eiE9PU4/ZFtOXS55OmRbTl0udzpkW05dLnkrKGRbTl0udy1kW05dLnkpKnksUy5wdXNoKGRbTl0ueCsoZFtOXS56LWRbTl0ueCkqUC9hLGspLHAmJk0ucHVzaChwW05dLnIscFtOXS5nLHBbTl0uYixwW05dLmEpOzEhPT11JiZsJiYoRS5wdXNoKFIueCxSLnksUi56KSxFLnB1c2goMCxSLnksMCksRS5wdXNoKDAsUi55LDApLEUucHVzaCh3Lngsdy55LHcueiksZS5WZWN0b3IzLkNyb3NzVG9SZWYoVixPLEIpLEIubm9ybWFsaXplKCksQy5wdXNoKEIueCxCLnksQi56LEIueCxCLnksQi56KSxlLlZlY3RvcjMuQ3Jvc3NUb1JlZihMLFYsQiksQi5ub3JtYWxpemUoKSxDLnB1c2goQi54LEIueSxCLnosQi54LEIueSxCLnopLGs9Yz96IT09Tj9kW04rMV0ueTpkW04rMV0udzpkW04rMV0ueSsoZFtOKzFdLnctZFtOKzFdLnkpKnksUy5wdXNoKGRbTisxXS54LGspLFMucHVzaChkW04rMV0ueixrKSxrPWM/eiE9PU4/ZFtOKzJdLnk6ZFtOKzJdLnc6ZFtOKzJdLnkrKGRbTisyXS53LWRbTisyXS55KSp5LFMucHVzaChkW04rMl0ueCxrKSxTLnB1c2goZFtOKzJdLnosaykscCYmKE0ucHVzaChwW04rMV0ucixwW04rMV0uZyxwW04rMV0uYixwW04rMV0uYSksTS5wdXNoKHBbTisxXS5yLHBbTisxXS5nLHBbTisxXS5iLHBbTisxXS5hKSxNLnB1c2gocFtOKzJdLnIscFtOKzJdLmcscFtOKzJdLmIscFtOKzJdLmEpLE0ucHVzaChwW04rMl0ucixwW04rMl0uZyxwW04rMl0uYixwW04rMl0uYSkpKSx6IT09TiYmKHo9Til9dmFyIE4sVT0xIT09dSYmbD9hKzQ6YTtmb3IoYj0wLE49MDtoPk47TisrKXtmb3IoUD0wO2E+UDtQKyspe3ZhciBHPWIqKFUrMSkrUCxXPShiKzEpKihVKzEpK1AsWT1iKihVKzEpKyhQKzEpLEg9KGIrMSkqKFUrMSkrKFArMSk7VC5wdXNoKEcsVyxZKSxULnB1c2goSCxZLFcpfTEhPT11JiZsJiYoVC5wdXNoKEcrMixXKzIsWSsyKSxULnB1c2goSCsyLFkrMixXKzIpLFQucHVzaChHKzQsVys0LFkrNCksVC5wdXNoKEgrNCxZKzQsVys0KSksYj1jP2IrMjpiKzF9dmFyIGo9ZnVuY3Rpb24odCl7dmFyIGk9dD9vLzI6cy8yO2lmKDAhPT1pKXt2YXIgcixoLGMsbCxmPXQ/ZFtnLTFdOmRbMF07cCYmKGw9dD9wW2ctMV06cFswXSk7dmFyIF89RS5sZW5ndGgvMyxtPXQ/bi8yOi1uLzIsdj1uZXcgZS5WZWN0b3IzKDAsbSwwKTtFLnB1c2godi54LHYueSx2LnopLEMucHVzaCgwLHQ/MTotMSwwKSxTLnB1c2goZi54Ky41KihmLnotZi54KSxmLnkrLjUqKGYudy1mLnkpKSxwJiZNLnB1c2gobC5yLGwuZyxsLmIsbC5hKTt2YXIgeT1uZXcgZS5WZWN0b3IyKC41LC41KTtmb3IoYz0wO2E+PWM7YysrKXtyPTIqTWF0aC5QSSpjKnUvYTt2YXIgeD1NYXRoLmNvcygtciksYj1NYXRoLnNpbigtcik7aD1uZXcgZS5WZWN0b3IzKHgqaSxtLGIqaSk7dmFyIFA9bmV3IGUuVmVjdG9yMih4KnkueCsuNSxiKnkueSsuNSk7RS5wdXNoKGgueCxoLnksaC56KSxDLnB1c2goMCx0PzE6LTEsMCksUy5wdXNoKGYueCsoZi56LWYueCkqUC54LGYueSsoZi53LWYueSkqUC55KSxwJiZNLnB1c2gobC5yLGwuZyxsLmIsbC5hKX1mb3IoYz0wO2E+YztjKyspdD8oVC5wdXNoKF8pLFQucHVzaChfKyhjKzIpKSxULnB1c2goXysoYysxKSkpOihULnB1c2goXyksVC5wdXNoKF8rKGMrMSkpLFQucHVzaChfKyhjKzIpKSl9fTtqKCExKSxqKCEwKSx0Ll9Db21wdXRlU2lkZXMoZixFLFQsQyxTKTt2YXIgWD1uZXcgdDtyZXR1cm4gWC5pbmRpY2VzPVQsWC5wb3NpdGlvbnM9RSxYLm5vcm1hbHM9QyxYLnV2cz1TLHAmJihYLmNvbG9ycz1NKSxYfSx0LkNyZWF0ZVRvcnVzPWZ1bmN0aW9uKGkpe2Zvcih2YXIgcj1bXSxuPVtdLG89W10scz1bXSxhPWkuZGlhbWV0ZXJ8fDEsaD1pLnRoaWNrbmVzc3x8LjUsYz1pLnRlc3NlbGxhdGlvbnx8MTYsbD0wPT09aS5zaWRlT3JpZW50YXRpb24/MDppLnNpZGVPcmllbnRhdGlvbnx8ZS5NZXNoLkRFRkFVTFRTSURFLHU9YysxLGY9MDtjPj1mO2YrKylmb3IodmFyIGQ9Zi9jLHA9ZipNYXRoLlBJKjIvYy1NYXRoLlBJLzIsXz1lLk1hdHJpeC5UcmFuc2xhdGlvbihhLzIsMCwwKS5tdWx0aXBseShlLk1hdHJpeC5Sb3RhdGlvblkocCkpLG09MDtjPj1tO20rKyl7dmFyIGc9MS1tL2Msdj1tKk1hdGguUEkqMi9jK01hdGguUEkseT1NYXRoLmNvcyh2KSx4PU1hdGguc2luKHYpLGI9bmV3IGUuVmVjdG9yMyh5LHgsMCksUD1iLnNjYWxlKGgvMiksQT1uZXcgZS5WZWN0b3IyKGQsZyk7UD1lLlZlY3RvcjMuVHJhbnNmb3JtQ29vcmRpbmF0ZXMoUCxfKSxiPWUuVmVjdG9yMy5UcmFuc2Zvcm1Ob3JtYWwoYixfKSxuLnB1c2goUC54LFAueSxQLnopLG8ucHVzaChiLngsYi55LGIueikscy5wdXNoKEEueCxBLnkpO3ZhciBUPShmKzEpJXUsRT0obSsxKSV1O3IucHVzaChmKnUrbSksci5wdXNoKGYqdStFKSxyLnB1c2goVCp1K20pLHIucHVzaChmKnUrRSksci5wdXNoKFQqdStFKSxyLnB1c2goVCp1K20pfXQuX0NvbXB1dGVTaWRlcyhsLG4scixvLHMpO3ZhciBDPW5ldyB0O3JldHVybiBDLmluZGljZXM9cixDLnBvc2l0aW9ucz1uLEMubm9ybWFscz1vLEMudXZzPXMsQ30sdC5DcmVhdGVMaW5lU3lzdGVtPWZ1bmN0aW9uKGUpe2Zvcih2YXIgaT1bXSxyPVtdLG49ZS5saW5lcyxvPTAscz0wO3M8bi5sZW5ndGg7cysrKWZvcih2YXIgYT1uW3NdLGg9MDtoPGEubGVuZ3RoO2grKylyLnB1c2goYVtoXS54LGFbaF0ueSxhW2hdLnopLGg+MCYmKGkucHVzaChvLTEpLGkucHVzaChvKSksbysrO3ZhciBjPW5ldyB0O3JldHVybiBjLmluZGljZXM9aSxjLnBvc2l0aW9ucz1yLGN9LHQuQ3JlYXRlRGFzaGVkTGluZXM9ZnVuY3Rpb24oaSl7dmFyIHI9aS5kYXNoU2l6ZXx8MyxuPWkuZ2FwU2l6ZXx8MSxvPWkuZGFzaE5ifHwyMDAscz1pLnBvaW50cyxhPW5ldyBBcnJheSxoPW5ldyBBcnJheSxjPWUuVmVjdG9yMy5aZXJvKCksbD0wLHU9MCxmPTAsZD0wLHA9MCxfPTAsbT0wO2ZvcihtPTA7bTxzLmxlbmd0aC0xO20rKylzW20rMV0uc3VidHJhY3RUb1JlZihzW21dLGMpLGwrPWMubGVuZ3RoKCk7Zm9yKGY9bC9vLGQ9cipmLyhyK24pLG09MDttPHMubGVuZ3RoLTE7bSsrKXtzW20rMV0uc3VidHJhY3RUb1JlZihzW21dLGMpLHU9TWF0aC5mbG9vcihjLmxlbmd0aCgpL2YpLGMubm9ybWFsaXplKCk7Zm9yKHZhciBnPTA7dT5nO2crKylwPWYqZyxhLnB1c2goc1ttXS54K3AqYy54LHNbbV0ueStwKmMueSxzW21dLnorcCpjLnopLGEucHVzaChzW21dLngrKHArZCkqYy54LHNbbV0ueSsocCtkKSpjLnksc1ttXS56KyhwK2QpKmMueiksaC5wdXNoKF8sXysxKSxfKz0yfXZhciB2PW5ldyB0O3JldHVybiB2LnBvc2l0aW9ucz1hLHYuaW5kaWNlcz1oLHZ9LHQuQ3JlYXRlR3JvdW5kPWZ1bmN0aW9uKGkpe3ZhciByLG4sbz1bXSxzPVtdLGE9W10saD1bXSxjPWkud2lkdGh8fDEsbD1pLmhlaWdodHx8MSx1PWkuc3ViZGl2aXNpb25zfHwxO2ZvcihyPTA7dT49cjtyKyspZm9yKG49MDt1Pj1uO24rKyl7dmFyIGY9bmV3IGUuVmVjdG9yMyhuKmMvdS1jLzIsMCwodS1yKSpsL3UtbC8yKSxkPW5ldyBlLlZlY3RvcjMoMCwxLDApO3MucHVzaChmLngsZi55LGYueiksYS5wdXNoKGQueCxkLnksZC56KSxoLnB1c2gobi91LDEtci91KX1mb3Iocj0wO3U+cjtyKyspZm9yKG49MDt1Pm47bisrKW8ucHVzaChuKzErKHIrMSkqKHUrMSkpLG8ucHVzaChuKzErcioodSsxKSksby5wdXNoKG4rcioodSsxKSksby5wdXNoKG4rKHIrMSkqKHUrMSkpLG8ucHVzaChuKzErKHIrMSkqKHUrMSkpLG8ucHVzaChuK3IqKHUrMSkpO3ZhciBwPW5ldyB0O3JldHVybiBwLmluZGljZXM9byxwLnBvc2l0aW9ucz1zLHAubm9ybWFscz1hLHAudXZzPWgscH0sdC5DcmVhdGVUaWxlZEdyb3VuZD1mdW5jdGlvbihpKXtmdW5jdGlvbiByKHQsaSxyLHMpe3ZhciBhPV8ubGVuZ3RoLzMsaD1kLncrMTtmb3Iobj0wO248ZC5oO24rKylmb3Iobz0wO288ZC53O28rKyl7dmFyIGM9W2ErbytuKmgsYSsobysxKStuKmgsYSsobysxKSsobisxKSpoLGErbysobisxKSpoXTtwLnB1c2goY1sxXSkscC5wdXNoKGNbMl0pLHAucHVzaChjWzNdKSxwLnB1c2goY1swXSkscC5wdXNoKGNbMV0pLHAucHVzaChjWzNdKX12YXIgbD1lLlZlY3RvcjMuWmVybygpLHU9bmV3IGUuVmVjdG9yMygwLDEsMCk7Zm9yKG49MDtuPD1kLmg7bisrKWZvcihsLno9bioocy1pKS9kLmgraSxvPTA7bzw9ZC53O28rKylsLng9byooci10KS9kLncrdCxsLnk9MCxfLnB1c2gobC54LGwueSxsLnopLG0ucHVzaCh1LngsdS55LHUueiksZy5wdXNoKG8vZC53LG4vZC5oKX12YXIgbixvLHMsYSxoPWkueG1pbixjPWkuem1pbixsPWkueG1heCx1PWkuem1heCxmPWkuc3ViZGl2aXNpb25zfHx7dzoxLGg6MX0sZD1pLnByZWNpc2lvbnx8e3c6MSxoOjF9LHA9W10sXz1bXSxtPVtdLGc9W107Zi5oPWYudzwxPzE6Zi5oLGYudz1mLnc8MT8xOmYudyxkLnc9ZC53PDE/MTpkLncsZC5oPWQuaDwxPzE6ZC5oO3ZhciB2PXt3OihsLWgpL2YudyxoOih1LWMpL2YuaH07Zm9yKHM9MDtzPGYuaDtzKyspZm9yKGE9MDthPGYudzthKyspcihoK2Eqdi53LGMrcyp2LmgsaCsoYSsxKSp2LncsYysocysxKSp2LmgpO3ZhciB5PW5ldyB0O3JldHVybiB5LmluZGljZXM9cCx5LnBvc2l0aW9ucz1fLHkubm9ybWFscz1tLHkudXZzPWcseX0sdC5DcmVhdGVHcm91bmRGcm9tSGVpZ2h0TWFwPWZ1bmN0aW9uKGkpe3ZhciByLG4sbz1bXSxzPVtdLGE9W10saD1bXTtmb3Iocj0wO3I8PWkuc3ViZGl2aXNpb25zO3IrKylmb3Iobj0wO248PWkuc3ViZGl2aXNpb25zO24rKyl7dmFyIGM9bmV3IGUuVmVjdG9yMyhuKmkud2lkdGgvaS5zdWJkaXZpc2lvbnMtaS53aWR0aC8yLDAsKGkuc3ViZGl2aXNpb25zLXIpKmkuaGVpZ2h0L2kuc3ViZGl2aXNpb25zLWkuaGVpZ2h0LzIpLGw9KGMueCtpLndpZHRoLzIpL2kud2lkdGgqKGkuYnVmZmVyV2lkdGgtMSl8MCx1PSgxLShjLnoraS5oZWlnaHQvMikvaS5oZWlnaHQpKihpLmJ1ZmZlckhlaWdodC0xKXwwLGY9NCoobCt1KmkuYnVmZmVyV2lkdGgpLGQ9aS5idWZmZXJbZl0vMjU1LHA9aS5idWZmZXJbZisxXS8yNTUsXz1pLmJ1ZmZlcltmKzJdLzI1NSxtPS4zKmQrLjU5KnArLjExKl87Yy55PWkubWluSGVpZ2h0KyhpLm1heEhlaWdodC1pLm1pbkhlaWdodCkqbSxzLnB1c2goYy54LGMueSxjLnopLGEucHVzaCgwLDAsMCksaC5wdXNoKG4vaS5zdWJkaXZpc2lvbnMsMS1yL2kuc3ViZGl2aXNpb25zKX1mb3Iocj0wO3I8aS5zdWJkaXZpc2lvbnM7cisrKWZvcihuPTA7bjxpLnN1YmRpdmlzaW9ucztuKyspby5wdXNoKG4rMSsocisxKSooaS5zdWJkaXZpc2lvbnMrMSkpLG8ucHVzaChuKzErciooaS5zdWJkaXZpc2lvbnMrMSkpLG8ucHVzaChuK3IqKGkuc3ViZGl2aXNpb25zKzEpKSxvLnB1c2gobisocisxKSooaS5zdWJkaXZpc2lvbnMrMSkpLG8ucHVzaChuKzErKHIrMSkqKGkuc3ViZGl2aXNpb25zKzEpKSxvLnB1c2gobityKihpLnN1YmRpdmlzaW9ucysxKSk7dC5Db21wdXRlTm9ybWFscyhzLG8sYSk7dmFyIGc9bmV3IHQ7cmV0dXJuIGcuaW5kaWNlcz1vLGcucG9zaXRpb25zPXMsZy5ub3JtYWxzPWEsZy51dnM9aCxnfSx0LkNyZWF0ZVBsYW5lPWZ1bmN0aW9uKGkpe3ZhciByPVtdLG49W10sbz1bXSxzPVtdLGE9aS53aWR0aHx8aS5zaXplfHwxLGg9aS5oZWlnaHR8fGkuc2l6ZXx8MSxjPTA9PT1pLnNpZGVPcmllbnRhdGlvbj8wOmkuc2lkZU9yaWVudGF0aW9ufHxlLk1lc2guREVGQVVMVFNJREUsbD1hLzIsdT1oLzI7bi5wdXNoKC1sLC11LDApLG8ucHVzaCgwLDAsLTEpLHMucHVzaCgwLDApLG4ucHVzaChsLC11LDApLG8ucHVzaCgwLDAsLTEpLHMucHVzaCgxLDApLG4ucHVzaChsLHUsMCksby5wdXNoKDAsMCwtMSkscy5wdXNoKDEsMSksbi5wdXNoKC1sLHUsMCksby5wdXNoKDAsMCwtMSkscy5wdXNoKDAsMSksci5wdXNoKDApLHIucHVzaCgxKSxyLnB1c2goMiksci5wdXNoKDApLHIucHVzaCgyKSxyLnB1c2goMyksdC5fQ29tcHV0ZVNpZGVzKGMsbixyLG8scyk7dmFyIGY9bmV3IHQ7cmV0dXJuIGYuaW5kaWNlcz1yLGYucG9zaXRpb25zPW4sZi5ub3JtYWxzPW8sZi51dnM9cyxmfSx0LkNyZWF0ZURpc2M9ZnVuY3Rpb24oaSl7dmFyIHI9W10sbj1bXSxvPVtdLHM9W10sYT1pLnJhZGl1c3x8LjUsaD1pLnRlc3NlbGxhdGlvbnx8NjQsYz1pLmFyYzw9MHx8aS5hcmM+MT8xOmkuYXJjfHwxLGw9MD09PWkuc2lkZU9yaWVudGF0aW9uPzA6aS5zaWRlT3JpZW50YXRpb258fGUuTWVzaC5ERUZBVUxUU0lERTtyLnB1c2goMCwwLDApLHMucHVzaCguNSwuNSk7Zm9yKHZhciB1PTIqTWF0aC5QSSpjLGY9dS9oLGQ9MDt1PmQ7ZCs9Zil7dmFyIHA9TWF0aC5jb3MoZCksXz1NYXRoLnNpbihkKSxtPShwKzEpLzIsZz0oMS1fKS8yO3IucHVzaChhKnAsYSpfLDApLHMucHVzaChtLGcpfTE9PT1jJiYoci5wdXNoKHJbM10scls0XSxyWzVdKSxzLnB1c2goc1syXSxzWzNdKSk7Zm9yKHZhciB2PXIubGVuZ3RoLzMseT0xO3YtMT55O3krKyluLnB1c2goeSsxLDAseSk7dC5Db21wdXRlTm9ybWFscyhyLG4sbyksdC5fQ29tcHV0ZVNpZGVzKGwscixuLG8scyk7dmFyIHg9bmV3IHQ7cmV0dXJuIHguaW5kaWNlcz1uLHgucG9zaXRpb25zPXIseC5ub3JtYWxzPW8seC51dnM9cyx4fSx0LkNyZWF0ZUljb1NwaGVyZT1mdW5jdGlvbihpKXt2YXIgcixuPWkuc2lkZU9yaWVudGF0aW9ufHxlLk1lc2guREVGQVVMVFNJREUsbz1pLnJhZGl1c3x8MSxzPXZvaWQgMD09PWkuZmxhdD8hMDppLmZsYXQsYT1pLnN1YmRpdmlzaW9uc3x8NCxoPWkucmFkaXVzWHx8byxjPWkucmFkaXVzWXx8byxsPWkucmFkaXVzWnx8byx1PSgxK01hdGguc3FydCg1KSkvMixmPVstMSx1LC0wLDEsdSwwLC0xLC11LDAsMSwtdSwwLDAsLTEsLXUsMCwxLC11LDAsLTEsdSwwLDEsdSx1LDAsMSx1LDAsLTEsLXUsMCwxLC11LDAsLTFdLGQ9WzAsMTEsNSwwLDUsMSwwLDEsNywwLDcsMTAsMTIsMjIsMjMsMSw1LDIwLDUsMTEsNCwyMywyMiwxMywyMiwxOCw2LDcsMSw4LDE0LDIxLDQsMTQsNCwyLDE2LDEzLDYsMTUsNiwxOSwzLDgsOSw0LDIxLDUsMTMsMTcsMjMsNiwxMywyMiwxOSw2LDE4LDksOCwxXSxwPVswLDEsMiwzLDQsNSw2LDcsOCw5LDEwLDExLDAsMiwzLDMsMyw0LDcsOCw5LDksMTAsMTFdLF89WzUsMSwzLDEsNiw0LDAsMCw1LDMsNCwyLDIsMiw0LDAsMiwwLDEsMSw2LDAsNiwyLDAsNCwzLDMsNCw0LDMsMSw0LDIsNCw0LDAsMiwxLDEsMiwyLDMsMywxLDMsMiw0XSxtPTEzOC8xMDI0LGc9MjM5LzEwMjQsdj02MC8xMDI0LHk9MjYvMTAyNCx4PS00MC8xMDI0LGI9MjAvMTAyNCxQPVswLDAsMCwwLDEsMCwwLDEsMSwwLDAsMCwxLDEsMCwwLDEsMSwxLDBdLEE9W10sVD1bXSxFPVtdLEM9W10sUz0wLE09bmV3IEFycmF5KDMpLEk9bmV3IEFycmF5KDMpO2ZvcihyPTA7Mz5yO3IrKylNW3JdPWUuVmVjdG9yMy5aZXJvKCksSVtyXT1lLlZlY3RvcjIuWmVybygpO2Zvcih2YXIgRD0wOzIwPkQ7RCsrKXtmb3Iocj0wOzM+cjtyKyspe3ZhciBSPWRbMypEK3JdO01bcl0uY29weUZyb21GbG9hdHMoZlszKnBbUl1dLGZbMypwW1JdKzFdLGZbMypwW1JdKzJdKSxNW3JdLm5vcm1hbGl6ZSgpLnNjYWxlSW5QbGFjZShvKSxJW3JdLmNvcHlGcm9tRmxvYXRzKF9bMipSXSptK3YrUFtEXSp4LF9bMipSKzFdKmcreStQW0RdKmIpfWZvcih2YXIgTz1mdW5jdGlvbih0LGkscixuKXt2YXIgbz1lLlZlY3RvcjMuTGVycChNWzBdLE1bMl0saS9hKSx1PWUuVmVjdG9yMy5MZXJwKE1bMV0sTVsyXSxpL2EpLGY9YT09PWk/TVsyXTplLlZlY3RvcjMuTGVycChvLHUsdC8oYS1pKSk7Zi5ub3JtYWxpemUoKTt2YXIgZDtpZihzKXt2YXIgcD1lLlZlY3RvcjMuTGVycChNWzBdLE1bMl0sbi9hKSxfPWUuVmVjdG9yMy5MZXJwKE1bMV0sTVsyXSxuL2EpO2Q9ZS5WZWN0b3IzLkxlcnAocCxfLHIvKGEtbikpfWVsc2UgZD1uZXcgZS5WZWN0b3IzKGYueCxmLnksZi56KTtkLngvPWgsZC55Lz1jLGQuei89bCxkLm5vcm1hbGl6ZSgpO3ZhciBtPWUuVmVjdG9yMi5MZXJwKElbMF0sSVsyXSxpL2EpLGc9ZS5WZWN0b3IyLkxlcnAoSVsxXSxJWzJdLGkvYSksdj1hPT09aT9JWzJdOmUuVmVjdG9yMi5MZXJwKG0sZyx0LyhhLWkpKTtULnB1c2goZi54KmgsZi55KmMsZi56KmwpLEUucHVzaChkLngsZC55LGQueiksQy5wdXNoKHYueCx2LnkpLEEucHVzaChTKSxTKyt9LHc9MDthPnc7dysrKWZvcih2YXIgTD0wO2E+TCt3O0wrKylPKEwsdyxMKzEvMyx3KzEvMyksTyhMKzEsdyxMKzEvMyx3KzEvMyksTyhMLHcrMSxMKzEvMyx3KzEvMyksYT5MK3crMSYmKE8oTCsxLHcsTCsyLzMsdysyLzMpLE8oTCsxLHcrMSxMKzIvMyx3KzIvMyksTyhMLHcrMSxMKzIvMyx3KzIvMykpfXQuX0NvbXB1dGVTaWRlcyhuLFQsQSxFLEMpO3ZhciBCPW5ldyB0O3JldHVybiBCLmluZGljZXM9QSxCLnBvc2l0aW9ucz1ULEIubm9ybWFscz1FLEIudXZzPUMsQn0sdC5DcmVhdGVQb2x5aGVkcm9uPWZ1bmN0aW9uKGkpe3ZhciByPVtdO3JbMF09e3ZlcnRleDpbWzAsMCwxLjczMjA1MV0sWzEuNjMyOTkzLDAsLS41NzczNTAzXSxbLS44MTY0OTY2LDEuNDE0MjE0LC0uNTc3MzUwM10sWy0uODE2NDk2NiwtMS40MTQyMTQsLS41NzczNTAzXV0sZmFjZTpbWzAsMSwyXSxbMCwyLDNdLFswLDMsMV0sWzEsMywyXV19LHJbMV09e3ZlcnRleDpbWzAsMCwxLjQxNDIxNF0sWzEuNDE0MjE0LDAsMF0sWzAsMS40MTQyMTQsMF0sWy0xLjQxNDIxNCwwLDBdLFswLC0xLjQxNDIxNCwwXSxbMCwwLC0xLjQxNDIxNF1dLGZhY2U6W1swLDEsMl0sWzAsMiwzXSxbMCwzLDRdLFswLDQsMV0sWzEsNCw1XSxbMSw1LDJdLFsyLDUsM10sWzMsNSw0XV19LHJbMl09e3ZlcnRleDpbWzAsMCwxLjA3MDQ2Nl0sWy43MTM2NDQyLDAsLjc5Nzg3ODRdLFstLjM1NjgyMjEsLjYxODAzNCwuNzk3ODc4NF0sWy0uMzU2ODIyMSwtLjYxODAzNCwuNzk3ODc4NF0sWy43OTc4Nzg0LC42MTgwMzQsLjM1NjgyMjFdLFsuNzk3ODc4NCwtLjYxODAzNCwuMzU2ODIyMV0sWy0uOTM0MTcyNCwuMzgxOTY2LC4zNTY4MjIxXSxbLjEzNjI5MzksMSwuMzU2ODIyMV0sWy4xMzYyOTM5LC0xLC4zNTY4MjIxXSxbLS45MzQxNzI0LC0uMzgxOTY2LC4zNTY4MjIxXSxbLjkzNDE3MjQsLjM4MTk2NiwtLjM1NjgyMjFdLFsuOTM0MTcyNCwtLjM4MTk2NiwtLjM1NjgyMjFdLFstLjc5Nzg3ODQsLjYxODAzNCwtLjM1NjgyMjFdLFstLjEzNjI5MzksMSwtLjM1NjgyMjFdLFstLjEzNjI5MzksLTEsLS4zNTY4MjIxXSxbLS43OTc4Nzg0LC0uNjE4MDM0LC0uMzU2ODIyMV0sWy4zNTY4MjIxLC42MTgwMzQsLS43OTc4Nzg0XSxbLjM1NjgyMjEsLS42MTgwMzQsLS43OTc4Nzg0XSxbLS43MTM2NDQyLDAsLS43OTc4Nzg0XSxbMCwwLC0xLjA3MDQ2Nl1dLGZhY2U6W1swLDEsNCw3LDJdLFswLDIsNiw5LDNdLFswLDMsOCw1LDFdLFsxLDUsMTEsMTAsNF0sWzIsNywxMywxMiw2XSxbMyw5LDE1LDE0LDhdLFs0LDEwLDE2LDEzLDddLFs1LDgsMTQsMTcsMTFdLFs2LDEyLDE4LDE1LDldLFsxMCwxMSwxNywxOSwxNl0sWzEyLDEzLDE2LDE5LDE4XSxbMTQsMTUsMTgsMTksMTddXX0sclszXT17dmVydGV4OltbMCwwLDEuMTc1NTcxXSxbMS4wNTE0NjIsMCwuNTI1NzMxMV0sWy4zMjQ5MTk3LDEsLjUyNTczMTFdLFstLjg1MDY1MDgsLjYxODAzNCwuNTI1NzMxMV0sWy0uODUwNjUwOCwtLjYxODAzNCwuNTI1NzMxMV0sWy4zMjQ5MTk3LC0xLC41MjU3MzExXSxbLjg1MDY1MDgsLjYxODAzNCwtLjUyNTczMTFdLFsuODUwNjUwOCwtLjYxODAzNCwtLjUyNTczMTFdLFstLjMyNDkxOTcsMSwtLjUyNTczMTFdLFstMS4wNTE0NjIsMCwtLjUyNTczMTFdLFstLjMyNDkxOTcsLTEsLS41MjU3MzExXSxbMCwwLC0xLjE3NTU3MV1dLGZhY2U6W1swLDEsMl0sWzAsMiwzXSxbMCwzLDRdLFswLDQsNV0sWzAsNSwxXSxbMSw1LDddLFsxLDcsNl0sWzEsNiwyXSxbMiw2LDhdLFsyLDgsM10sWzMsOCw5XSxbMyw5LDRdLFs0LDksMTBdLFs0LDEwLDVdLFs1LDEwLDddLFs2LDcsMTFdLFs2LDExLDhdLFs3LDEwLDExXSxbOCwxMSw5XSxbOSwxMSwxMF1dfSxyWzRdPXt2ZXJ0ZXg6W1swLDAsMS4wNzA3MjJdLFsuNzE0ODEzNSwwLC43OTcxNzUyXSxbLS4xMDQ2ODIsLjcwNzEwNjgsLjc5NzE3NTJdLFstLjY4NDE1MjgsLjIwNzEwNjgsLjc5NzE3NTJdLFstLjEwNDY4MiwtLjcwNzEwNjgsLjc5NzE3NTJdLFsuNjEwMTMxNSwuNzA3MTA2OCwuNTIzNjI3OV0sWzEuMDQxNTYsLjIwNzEwNjgsLjEzNjc3MzZdLFsuNjEwMTMxNSwtLjcwNzEwNjgsLjUyMzYyNzldLFstLjM1NzQwNjcsMSwuMTM2NzczNl0sWy0uNzg4ODM0OCwtLjUsLjUyMzYyNzldLFstLjkzNjg3NzYsLjUsLjEzNjc3MzZdLFstLjM1NzQwNjcsLTEsLjEzNjc3MzZdLFsuMzU3NDA2NywxLC0uMTM2NzczNl0sWy45MzY4Nzc2LC0uNSwtLjEzNjc3MzZdLFsuNzg4ODM0OCwuNSwtLjUyMzYyNzldLFsuMzU3NDA2NywtMSwtLjEzNjc3MzZdLFstLjYxMDEzMTUsLjcwNzEwNjgsLS41MjM2Mjc5XSxbLTEuMDQxNTYsLS4yMDcxMDY4LC0uMTM2NzczNl0sWy0uNjEwMTMxNSwtLjcwNzEwNjgsLS41MjM2Mjc5XSxbLjEwNDY4MiwuNzA3MTA2OCwtLjc5NzE3NTJdLFsuNjg0MTUyOCwtLjIwNzEwNjgsLS43OTcxNzUyXSxbLjEwNDY4MiwtLjcwNzEwNjgsLS43OTcxNzUyXSxbLS43MTQ4MTM1LDAsLS43OTcxNzUyXSxbMCwwLC0xLjA3MDcyMl1dLGZhY2U6W1swLDIsM10sWzEsNiw1XSxbNCw5LDExXSxbNywxNSwxM10sWzgsMTYsMTBdLFsxMiwxNCwxOV0sWzE3LDIyLDE4XSxbMjAsMjEsMjNdLFswLDEsNSwyXSxbMCwzLDksNF0sWzAsNCw3LDFdLFsxLDcsMTMsNl0sWzIsNSwxMiw4XSxbMiw4LDEwLDNdLFszLDEwLDE3LDldLFs0LDExLDE1LDddLFs1LDYsMTQsMTJdLFs2LDEzLDIwLDE0XSxbOCwxMiwxOSwxNl0sWzksMTcsMTgsMTFdLFsxMCwxNiwyMiwxN10sWzExLDE4LDIxLDE1XSxbMTMsMTUsMjEsMjBdLFsxNCwyMCwyMywxOV0sWzE2LDE5LDIzLDIyXSxbMTgsMjIsMjMsMjFdXVxufSxyWzVdPXt2ZXJ0ZXg6W1swLDAsMS4zMjI4NzZdLFsxLjMwOTMwNywwLC4xODg5ODIyXSxbLS45ODE5ODA1LC44NjYwMjU0LC4xODg5ODIyXSxbLjE2MzY2MzQsLTEuMjk5MDM4LC4xODg5ODIyXSxbLjMyNzMyNjgsLjg2NjAyNTQsLS45NDQ5MTEyXSxbLS44MTgzMTcxLC0uNDMzMDEyNywtLjk0NDkxMTJdXSxmYWNlOltbMCwzLDFdLFsyLDQsNV0sWzAsMSw0LDJdLFswLDIsNSwzXSxbMSwzLDUsNF1dfSxyWzZdPXt2ZXJ0ZXg6W1swLDAsMS4xNTk5NTNdLFsxLjAxMzQ2NCwwLC41NjQyNTQyXSxbLS4zNTAxNDMxLC45NTEwNTY1LC41NjQyNTQyXSxbLS43NzE1MjA4LC0uNjU3MTYzOSwuNTY0MjU0Ml0sWy42NjMzMjA2LC45NTEwNTY1LC0uMDMxNDQ0ODFdLFsuODY4Mjk3OSwtLjY1NzE2MzksLS4zOTk2MDcxXSxbLTEuMTIxNjY0LC4yOTM4OTI2LC0uMDMxNDQ0ODFdLFstLjIzNDg4MzEsLTEuMDYzMzE0LC0uMzk5NjA3MV0sWy41MTgxNTQ4LC4yOTM4OTI2LC0uOTk1MzA2MV0sWy0uNTg1MDI2MiwtLjExMjI1NywtLjk5NTMwNjFdXSxmYWNlOltbMCwxLDQsMl0sWzAsMiw2LDNdLFsxLDUsOCw0XSxbMyw2LDksN10sWzUsNyw5LDhdLFswLDMsNyw1LDFdLFsyLDQsOCw5LDZdXX0scls3XT17dmVydGV4OltbMCwwLDEuMTE4MDM0XSxbLjg5NDQyNzIsMCwuNjcwODIwNF0sWy0uMjIzNjA2OCwuODY2MDI1NCwuNjcwODIwNF0sWy0uNzgyNjIzOCwtLjQzMzAxMjcsLjY3MDgyMDRdLFsuNjcwODIwNCwuODY2MDI1NCwuMjIzNjA2OF0sWzEuMDA2MjMxLC0uNDMzMDEyNywtLjIyMzYwNjhdLFstMS4wMDYyMzEsLjQzMzAxMjcsLjIyMzYwNjhdLFstLjY3MDgyMDQsLS44NjYwMjU0LC0uMjIzNjA2OF0sWy43ODI2MjM4LC40MzMwMTI3LC0uNjcwODIwNF0sWy4yMjM2MDY4LC0uODY2MDI1NCwtLjY3MDgyMDRdLFstLjg5NDQyNzIsMCwtLjY3MDgyMDRdLFswLDAsLTEuMTE4MDM0XV0sZmFjZTpbWzAsMSw0LDJdLFswLDIsNiwzXSxbMSw1LDgsNF0sWzMsNiwxMCw3XSxbNSw5LDExLDhdLFs3LDEwLDExLDldLFswLDMsNyw5LDUsMV0sWzIsNCw4LDExLDEwLDZdXX0scls4XT17dmVydGV4OltbLS43Mjk2NjUsLjY3MDEyMSwuMzE5MTU1XSxbLS42NTUyMzUsLS4yOTIxMywtLjc1NDA5Nl0sWy0uMDkzOTIyLC0uNjA3MTIzLC41Mzc4MThdLFsuNzAyMTk2LC41OTU2OTEsLjQ4NTE4N10sWy43NzY2MjYsLS4zNjY1NiwtLjU4ODA2NF1dLGZhY2U6W1sxLDQsMl0sWzAsMSwyXSxbMywwLDJdLFs0LDMsMl0sWzQsMSwwLDNdXX0scls5XT17dmVydGV4OltbLS44Njg4NDksLS4xMDAwNDEsLjYxMjU3XSxbLS4zMjk0NTgsLjk3NjA5OSwuMjgwNzhdLFstLjI2NjI5LC0uMDEzNzk2LC0uNDc3NjU0XSxbLS4xMzM5MiwtMS4wMzQxMTUsLjIyOTgyOV0sWy43Mzg4MzQsLjcwNzExNywtLjMwNzAxOF0sWy44NTk2ODMsLS41MzUyNjQsLS4zMzg1MDhdXSxmYWNlOltbMywwLDJdLFs1LDMsMl0sWzQsNSwyXSxbMSw0LDJdLFswLDEsMl0sWzAsMyw1LDQsMV1dfSxyWzEwXT17dmVydGV4OltbLS42MTAzODksLjI0Mzk3NSwuNTMxMjEzXSxbLS4xODc4MTIsLS40ODc5NSwtLjY2NDAxNl0sWy0uMTg3ODEyLC45NzU5LC0uNjY0MDE2XSxbLjE4NzgxMiwtLjk3NTksLjY2NDAxNl0sWy43OTgyMDEsLjI0Mzk3NSwuMTMyODAzXV0sZmFjZTpbWzEsMywwXSxbMyw0LDBdLFszLDEsNF0sWzAsMiwxXSxbMCw0LDJdLFsyLDQsMV1dfSxyWzExXT17dmVydGV4OltbLTEuMDI4Nzc4LC4zOTIwMjcsLS4wNDg3ODZdLFstLjY0MDUwMywtLjY0NjE2MSwuNjIxODM3XSxbLS4xMjUxNjIsLS4zOTU2NjMsLS41NDAwNTldLFsuMDA0NjgzLC44ODg0NDcsLS42NTE5ODhdLFsuMTI1MTYxLC4zOTU2NjMsLjU0MDA1OV0sWy42MzI5MjUsLS43OTEzNzYsLjQzMzEwMl0sWzEuMDMxNjcyLC4xNTcwNjMsLS4zNTQxNjVdXSxmYWNlOltbMywyLDBdLFsyLDEsMF0sWzIsNSwxXSxbMCw0LDNdLFswLDEsNF0sWzQsMSw1XSxbMiwzLDZdLFszLDQsNl0sWzUsMiw2XSxbNCw1LDZdXX0sclsxMl09e3ZlcnRleDpbWy0uNjY5ODY3LC4zMzQ5MzMsLS41Mjk1NzZdLFstLjY2OTg2NywuMzM0OTMzLC41Mjk1NzddLFstLjQwNDMsMS4yMTI5MDEsMF0sWy0uMzM0OTMzLC0uNjY5ODY3LC0uNTI5NTc2XSxbLS4zMzQ5MzMsLS42Njk4NjcsLjUyOTU3N10sWy4zMzQ5MzMsLjY2OTg2NywtLjUyOTU3Nl0sWy4zMzQ5MzMsLjY2OTg2NywuNTI5NTc3XSxbLjQwNDMsLTEuMjEyOTAxLDBdLFsuNjY5ODY3LC0uMzM0OTMzLC0uNTI5NTc2XSxbLjY2OTg2NywtLjMzNDkzMywuNTI5NTc3XV0sZmFjZTpbWzgsOSw3XSxbNiw1LDJdLFszLDgsN10sWzUsMCwyXSxbNCwzLDddLFswLDEsMl0sWzksNCw3XSxbMSw2LDJdLFs5LDgsNSw2XSxbOCwzLDAsNV0sWzMsNCwxLDBdLFs0LDksNiwxXV19LHJbMTNdPXt2ZXJ0ZXg6W1stLjkzMTgzNiwuMjE5OTc2LC0uMjY0NjMyXSxbLS42MzY3MDYsLjMxODM1MywuNjkyODE2XSxbLS42MTM0ODMsLS43MzUwODMsLS4yNjQ2MzJdLFstLjMyNjU0NSwuOTc5NjM0LDBdLFstLjMxODM1MywtLjYzNjcwNiwuNjkyODE2XSxbLS4xNTkxNzYsLjQ3NzUyOSwtLjg1NjM2OF0sWy4xNTkxNzYsLS40Nzc1MjksLS44NTYzNjhdLFsuMzE4MzUzLC42MzY3MDYsLjY5MjgxNl0sWy4zMjY1NDUsLS45Nzk2MzQsMF0sWy42MTM0ODIsLjczNTA4MiwtLjI2NDYzMl0sWy42MzY3MDYsLS4zMTgzNTMsLjY5MjgxNl0sWy45MzE4MzUsLS4yMTk5NzcsLS4yNjQ2MzJdXSxmYWNlOltbMTEsMTAsOF0sWzcsOSwzXSxbNiwxMSw4XSxbOSw1LDNdLFsyLDYsOF0sWzUsMCwzXSxbNCwyLDhdLFswLDEsM10sWzEwLDQsOF0sWzEsNywzXSxbMTAsMTEsOSw3XSxbMTEsNiw1LDldLFs2LDIsMCw1XSxbMiw0LDEsMF0sWzQsMTAsNywxXV19LHJbMTRdPXt2ZXJ0ZXg6W1stLjkzNDY1LC4zMDA0NTksLS4yNzExODVdLFstLjgzODY4OSwtLjI2MDIxOSwtLjUxNjAxN10sWy0uNzExMzE5LC43MTc1OTEsLjEyODM1OV0sWy0uNzEwMzM0LC0uMTU2OTIyLC4wODA5NDZdLFstLjU5OTc5OSwuNTU2MDAzLC0uNzI1MTQ4XSxbLS41MDM4MzgsLS4wMDQ2NzUsLS45Njk5ODFdLFstLjQ4NzAwNCwuMjYwMjEsLjQ4MDQ5XSxbLS40NjAwODksLS43NTAyODIsLS41MTI2MjJdLFstLjM3NjQ2OCwuOTczMTM1LC0uMzI1NjA1XSxbLS4zMzE3MzUsLS42NDY5ODUsLjA4NDM0Ml0sWy0uMjU0MDAxLC44MzE4NDcsLjUzMDAwMV0sWy0uMTI1MjM5LC0uNDk0NzM4LC0uOTY2NTg2XSxbLjAyOTYyMiwuMDI3OTQ5LC43MzA4MTddLFsuMDU2NTM2LC0uOTgyNTQzLC0uMjYyMjk1XSxbLjA4MDg1LDEuMDg3MzkxLC4wNzYwMzddLFsuMTI1NTgzLC0uNTMyNzI5LC40ODU5ODRdLFsuMjYyNjI1LC41OTk1ODYsLjc4MDMyOF0sWy4zOTEzODcsLS43MjY5OTksLS43MTYyNTldLFsuNTEzODU0LC0uODY4Mjg3LC4xMzkzNDddLFsuNTk3NDc1LC44NTUxMywuMzI2MzY0XSxbLjY0MTIyNCwuMTA5NTIzLC43ODM3MjNdLFsuNzM3MTg1LC0uNDUxMTU1LC41Mzg4OTFdLFsuODQ4NzA1LC0uNjEyNzQyLC0uMzE0NjE2XSxbLjk3NjA3NSwuMzY1MDY3LC4zMjk3Nl0sWzEuMDcyMDM2LC0uMTk1NjEsLjA4NDkyN11dLGZhY2U6W1sxNSwxOCwyMV0sWzEyLDIwLDE2XSxbNiwxMCwyXSxbMywwLDFdLFs5LDcsMTNdLFsyLDgsNCwwXSxbMCw0LDUsMV0sWzEsNSwxMSw3XSxbNywxMSwxNywxM10sWzEzLDE3LDIyLDE4XSxbMTgsMjIsMjQsMjFdLFsyMSwyNCwyMywyMF0sWzIwLDIzLDE5LDE2XSxbMTYsMTksMTQsMTBdLFsxMCwxNCw4LDJdLFsxNSw5LDEzLDE4XSxbMTIsMTUsMjEsMjBdLFs2LDEyLDE2LDEwXSxbMyw2LDIsMF0sWzksMywxLDddLFs5LDE1LDEyLDYsM10sWzIyLDE3LDExLDUsNCw4LDE0LDE5LDIzLDI0XV19O3ZhciBuLG8scyxhLGgsYyxsPWkudHlwZTwwfHxpLnR5cGU+PXIubGVuZ3RoPzA6aS50eXBlfHwwLHU9aS5zaXplLGY9aS5zaXplWHx8dXx8MSxkPWkuc2l6ZVl8fHV8fDEscD1pLnNpemVafHx1fHwxLF89aS5jdXN0b218fHJbbF0sbT1fLmZhY2UubGVuZ3RoLGc9aS5mYWNlVVZ8fG5ldyBBcnJheShtKSx2PWkuZmFjZUNvbG9ycyx5PXZvaWQgMD09PWkuZmxhdD8hMDppLmZsYXQseD0wPT09aS5zaWRlT3JpZW50YXRpb24/MDppLnNpZGVPcmllbnRhdGlvbnx8ZS5NZXNoLkRFRkFVTFRTSURFLGI9W10sUD1bXSxBPVtdLFQ9W10sRT1bXSxDPTAsUz0wLE09W10sST0wLEQ9MDtpZih5KWZvcihEPTA7bT5EO0QrKyl2JiZ2b2lkIDA9PT12W0RdJiYodltEXT1uZXcgZS5Db2xvcjQoMSwxLDEsMSkpLGcmJnZvaWQgMD09PWdbRF0mJihnW0RdPW5ldyBlLlZlY3RvcjQoMCwwLDEsMSkpO2lmKHkpZm9yKEQ9MDttPkQ7RCsrKXt2YXIgUj1fLmZhY2VbRF0ubGVuZ3RoO2ZvcihzPTIqTWF0aC5QSS9SLGE9LjUqTWF0aC50YW4ocy8yKSxoPS41LEk9MDtSPkk7SSsrKWIucHVzaChfLnZlcnRleFtfLmZhY2VbRF1bSV1dWzBdKmYsXy52ZXJ0ZXhbXy5mYWNlW0RdW0ldXVsxXSpkLF8udmVydGV4W18uZmFjZVtEXVtJXV1bMl0qcCksTS5wdXNoKEMpLEMrKyxuPWdbRF0ueCsoZ1tEXS56LWdbRF0ueCkqKC41K2EpLG89Z1tEXS55KyhnW0RdLnctZ1tEXS55KSooaC0uNSksVC5wdXNoKG4sbyksYz1hKk1hdGguY29zKHMpLWgqTWF0aC5zaW4ocyksaD1hKk1hdGguc2luKHMpK2gqTWF0aC5jb3MocyksYT1jLHYmJkUucHVzaCh2W0RdLnIsdltEXS5nLHZbRF0uYix2W0RdLmEpO2ZvcihJPTA7Ui0yPkk7SSsrKVAucHVzaChNWzArU10sTVtJKzIrU10sTVtJKzErU10pO1MrPVJ9ZWxzZXtmb3IoST0wO0k8Xy52ZXJ0ZXgubGVuZ3RoO0krKyliLnB1c2goXy52ZXJ0ZXhbSV1bMF0qZixfLnZlcnRleFtJXVsxXSpkLF8udmVydGV4W0ldWzJdKnApLFQucHVzaCgwLDApO2ZvcihEPTA7bT5EO0QrKylmb3IoST0wO0k8Xy5mYWNlW0RdLmxlbmd0aC0yO0krKylQLnB1c2goXy5mYWNlW0RdWzBdLF8uZmFjZVtEXVtJKzJdLF8uZmFjZVtEXVtJKzFdKX10LkNvbXB1dGVOb3JtYWxzKGIsUCxBKSx0Ll9Db21wdXRlU2lkZXMoeCxiLFAsQSxUKTt2YXIgTz1uZXcgdDtyZXR1cm4gTy5wb3NpdGlvbnM9YixPLmluZGljZXM9UCxPLm5vcm1hbHM9QSxPLnV2cz1ULHYmJnkmJihPLmNvbG9ycz1FKSxPfSx0LkNyZWF0ZVRvcnVzS25vdD1mdW5jdGlvbihpKXt2YXIgcixuLG89W10scz1bXSxhPVtdLGg9W10sYz1pLnJhZGl1c3x8MixsPWkudHViZXx8LjUsdT1pLnJhZGlhbFNlZ21lbnRzfHwzMixmPWkudHVidWxhclNlZ21lbnRzfHwzMixkPWkucHx8MixwPWkucXx8MyxfPTA9PT1pLnNpZGVPcmllbnRhdGlvbj8wOmkuc2lkZU9yaWVudGF0aW9ufHxlLk1lc2guREVGQVVMVFNJREUsbT1mdW5jdGlvbih0KXt2YXIgaT1NYXRoLmNvcyh0KSxyPU1hdGguc2luKHQpLG49cC9kKnQsbz1NYXRoLmNvcyhuKSxzPWMqKDIrbykqLjUqaSxhPWMqKDIrbykqciouNSxoPWMqTWF0aC5zaW4obikqLjU7cmV0dXJuIG5ldyBlLlZlY3RvcjMocyxhLGgpfTtmb3Iocj0wO3U+PXI7cisrKXt2YXIgZz1yJXUsdj1nL3UqMipkKk1hdGguUEkseT1tKHYpLHg9bSh2Ky4wMSksYj14LnN1YnRyYWN0KHkpLFA9eC5hZGQoeSksQT1lLlZlY3RvcjMuQ3Jvc3MoYixQKTtmb3IoUD1lLlZlY3RvcjMuQ3Jvc3MoQSxiKSxBLm5vcm1hbGl6ZSgpLFAubm9ybWFsaXplKCksbj0wO2Y+bjtuKyspe3ZhciBUPW4lZixFPVQvZioyKk1hdGguUEksQz0tbCpNYXRoLmNvcyhFKSxTPWwqTWF0aC5zaW4oRSk7cy5wdXNoKHkueCtDKlAueCtTKkEueCkscy5wdXNoKHkueStDKlAueStTKkEueSkscy5wdXNoKHkueitDKlAueitTKkEueiksaC5wdXNoKHIvdSksaC5wdXNoKG4vZil9fWZvcihyPTA7dT5yO3IrKylmb3Iobj0wO2Y+bjtuKyspe3ZhciBNPShuKzEpJWYsST1yKmYrbixEPShyKzEpKmYrbixSPShyKzEpKmYrTSxPPXIqZitNO28ucHVzaChPKSxvLnB1c2goRCksby5wdXNoKEkpLG8ucHVzaChPKSxvLnB1c2goUiksby5wdXNoKEQpfXQuQ29tcHV0ZU5vcm1hbHMocyxvLGEpLHQuX0NvbXB1dGVTaWRlcyhfLHMsbyxhLGgpO3ZhciB3PW5ldyB0O3JldHVybiB3LmluZGljZXM9byx3LnBvc2l0aW9ucz1zLHcubm9ybWFscz1hLHcudXZzPWgsd30sdC5Db21wdXRlTm9ybWFscz1mdW5jdGlvbihlLHQsaSl7dmFyIHI9MCxuPTAsbz0wLHM9MCxhPTAsaD0wLGM9MCxsPTAsdT0wLGY9MCxkPTAscD0wLF89MCxtPTA7Zm9yKHI9MDtyPGUubGVuZ3RoO3IrKylpW3JdPTA7dmFyIGc9dC5sZW5ndGgvMztmb3Iocj0wO2c+cjtyKyspcD10WzMqcl0sXz10WzMqcisxXSxtPXRbMypyKzJdLG49ZVszKnBdLWVbMypfXSxvPWVbMypwKzFdLWVbMypfKzFdLHM9ZVszKnArMl0tZVszKl8rMl0sYT1lWzMqbV0tZVszKl9dLGg9ZVszKm0rMV0tZVszKl8rMV0sYz1lWzMqbSsyXS1lWzMqXysyXSxsPW8qYy1zKmgsdT1zKmEtbipjLGY9bipoLW8qYSxkPU1hdGguc3FydChsKmwrdSp1K2YqZiksZD0wPT09ZD8xOmQsbC89ZCx1Lz1kLGYvPWQsaVszKnBdKz1sLGlbMypwKzFdKz11LGlbMypwKzJdKz1mLGlbMypfXSs9bCxpWzMqXysxXSs9dSxpWzMqXysyXSs9ZixpWzMqbV0rPWwsaVszKm0rMV0rPXUsaVszKm0rMl0rPWY7Zm9yKHI9MDtyPGkubGVuZ3RoLzM7cisrKWw9aVszKnJdLHU9aVszKnIrMV0sZj1pWzMqcisyXSxkPU1hdGguc3FydChsKmwrdSp1K2YqZiksZD0wPT09ZD8xOmQsbC89ZCx1Lz1kLGYvPWQsaVszKnJdPWwsaVszKnIrMV09dSxpWzMqcisyXT1mfSx0Ll9Db21wdXRlU2lkZXM9ZnVuY3Rpb24odCxpLHIsbixvKXt2YXIgcyxhLGg9ci5sZW5ndGgsYz1uLmxlbmd0aDtzd2l0Y2godD10fHxlLk1lc2guREVGQVVMVFNJREUpe2Nhc2UgZS5NZXNoLkZST05UU0lERTpicmVhaztjYXNlIGUuTWVzaC5CQUNLU0lERTp2YXIgbDtmb3Iocz0wO2g+cztzKz0zKWw9cltzXSxyW3NdPXJbcysyXSxyW3MrMl09bDtmb3IoYT0wO2M+YTthKyspblthXT0tblthXTticmVhaztjYXNlIGUuTWVzaC5ET1VCTEVTSURFOmZvcih2YXIgdT1pLmxlbmd0aCxmPXUvMyxkPTA7dT5kO2QrKylpW3UrZF09aVtkXTtmb3Iocz0wO2g+cztzKz0zKXJbcytoXT1yW3MrMl0rZixyW3MrMStoXT1yW3MrMV0rZixyW3MrMitoXT1yW3NdK2Y7Zm9yKGE9MDtjPmE7YSsrKW5bYythXT0tblthXTtmb3IodmFyIHA9by5sZW5ndGgsXz0wO3A+XztfKyspb1tfK3BdPW9bX119fSx0LkltcG9ydFZlcnRleERhdGE9ZnVuY3Rpb24oaSxyKXt2YXIgbj1uZXcgdCxvPWkucG9zaXRpb25zO28mJm4uc2V0KG8sZS5WZXJ0ZXhCdWZmZXIuUG9zaXRpb25LaW5kKTt2YXIgcz1pLm5vcm1hbHM7cyYmbi5zZXQocyxlLlZlcnRleEJ1ZmZlci5Ob3JtYWxLaW5kKTt2YXIgYT1pLnV2czthJiZuLnNldChhLGUuVmVydGV4QnVmZmVyLlVWS2luZCk7dmFyIGg9aS51djJzO2gmJm4uc2V0KGgsZS5WZXJ0ZXhCdWZmZXIuVVYyS2luZCk7dmFyIGM9aS51djNzO2MmJm4uc2V0KGMsZS5WZXJ0ZXhCdWZmZXIuVVYzS2luZCk7dmFyIGw9aS51djRzO2wmJm4uc2V0KGwsZS5WZXJ0ZXhCdWZmZXIuVVY0S2luZCk7dmFyIHU9aS51djVzO3UmJm4uc2V0KHUsZS5WZXJ0ZXhCdWZmZXIuVVY1S2luZCk7dmFyIGY9aS51djZzO2YmJm4uc2V0KGYsZS5WZXJ0ZXhCdWZmZXIuVVY2S2luZCk7dmFyIGQ9aS5jb2xvcnM7ZCYmbi5zZXQoZS5Db2xvcjQuQ2hlY2tDb2xvcnM0KGQsby5sZW5ndGgvMyksZS5WZXJ0ZXhCdWZmZXIuQ29sb3JLaW5kKTt2YXIgcD1pLm1hdHJpY2VzSW5kaWNlcztwJiZuLnNldChwLGUuVmVydGV4QnVmZmVyLk1hdHJpY2VzSW5kaWNlc0tpbmQpO3ZhciBfPWkubWF0cmljZXNXZWlnaHRzO18mJm4uc2V0KF8sZS5WZXJ0ZXhCdWZmZXIuTWF0cmljZXNXZWlnaHRzS2luZCk7dmFyIG09aS5pbmRpY2VzO20mJihuLmluZGljZXM9bSksci5zZXRBbGxWZXJ0aWNlc0RhdGEobixpLnVwZGF0YWJsZSl9LHR9KCk7ZS5WZXJ0ZXhEYXRhPXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCgpe31yZXR1cm4gdC5FbmFibGVGb3I9ZnVuY3Rpb24oZSl7ZS5fdGFncz1lLl90YWdzfHx7fSxlLmhhc1RhZ3M9ZnVuY3Rpb24oKXtyZXR1cm4gdC5IYXNUYWdzKGUpfSxlLmFkZFRhZ3M9ZnVuY3Rpb24oaSl7cmV0dXJuIHQuQWRkVGFnc1RvKGUsaSl9LGUucmVtb3ZlVGFncz1mdW5jdGlvbihpKXtyZXR1cm4gdC5SZW1vdmVUYWdzRnJvbShlLGkpfSxlLm1hdGNoZXNUYWdzUXVlcnk9ZnVuY3Rpb24oaSl7cmV0dXJuIHQuTWF0Y2hlc1F1ZXJ5KGUsaSl9fSx0LkRpc2FibGVGb3I9ZnVuY3Rpb24oZSl7ZGVsZXRlIGUuX3RhZ3MsZGVsZXRlIGUuaGFzVGFncyxkZWxldGUgZS5hZGRUYWdzLGRlbGV0ZSBlLnJlbW92ZVRhZ3MsZGVsZXRlIGUubWF0Y2hlc1RhZ3NRdWVyeX0sdC5IYXNUYWdzPWZ1bmN0aW9uKHQpe3JldHVybiB0Ll90YWdzPyFlLlRvb2xzLklzRW1wdHkodC5fdGFncyk6ITF9LHQuR2V0VGFncz1mdW5jdGlvbihlLHQpe2lmKHZvaWQgMD09PXQmJih0PSEwKSwhZS5fdGFncylyZXR1cm4gbnVsbDtpZih0KXt2YXIgaT1bXTtmb3IodmFyIHIgaW4gZS5fdGFncyllLl90YWdzLmhhc093blByb3BlcnR5KHIpJiZlLl90YWdzW3JdPT09ITAmJmkucHVzaChyKTtyZXR1cm4gaS5qb2luKFwiIFwiKX1yZXR1cm4gZS5fdGFnc30sdC5BZGRUYWdzVG89ZnVuY3Rpb24oZSxpKXtpZihpJiZcInN0cmluZ1wiPT10eXBlb2YgaSl7dmFyIHI9aS5zcGxpdChcIiBcIik7Zm9yKHZhciBuIGluIHIpdC5fQWRkVGFnVG8oZSxyW25dKX19LHQuX0FkZFRhZ1RvPWZ1bmN0aW9uKGUsaSl7aT1pLnRyaW0oKSxcIlwiIT09aSYmXCJ0cnVlXCIhPT1pJiZcImZhbHNlXCIhPT1pJiYoaS5tYXRjaCgvW1xcc10vKXx8aS5tYXRjaCgvXihbIV18KFt8XXxbJl0pezJ9KS8pfHwodC5FbmFibGVGb3IoZSksZS5fdGFnc1tpXT0hMCkpfSx0LlJlbW92ZVRhZ3NGcm9tPWZ1bmN0aW9uKGUsaSl7aWYodC5IYXNUYWdzKGUpKXt2YXIgcj1pLnNwbGl0KFwiIFwiKTtmb3IodmFyIG4gaW4gcil0Ll9SZW1vdmVUYWdGcm9tKGUscltuXSl9fSx0Ll9SZW1vdmVUYWdGcm9tPWZ1bmN0aW9uKGUsdCl7ZGVsZXRlIGUuX3RhZ3NbdF19LHQuTWF0Y2hlc1F1ZXJ5PWZ1bmN0aW9uKGkscil7cmV0dXJuIHZvaWQgMD09PXI/ITA6XCJcIj09PXI/dC5IYXNUYWdzKGkpOmUuSW50ZXJuYWxzLkFuZE9yTm90RXZhbHVhdG9yLkV2YWwocixmdW5jdGlvbihlKXtyZXR1cm4gdC5IYXNUYWdzKGkpJiZpLl90YWdzW2VdfSl9LHR9KCk7ZS5UYWdzPXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0OyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoKXt9cmV0dXJuIGUuRXZhbD1mdW5jdGlvbih0LGkpe3JldHVybiB0PXQubWF0Y2goL1xcKFteXFwoXFwpXSpcXCkvZyk/dC5yZXBsYWNlKC9cXChbXlxcKFxcKV0qXFwpL2csZnVuY3Rpb24odCl7cmV0dXJuIHQ9dC5zbGljZSgxLHQubGVuZ3RoLTEpLGUuX0hhbmRsZVBhcmVudGhlc2lzQ29udGVudCh0LGkpfSk6ZS5fSGFuZGxlUGFyZW50aGVzaXNDb250ZW50KHQsaSksXCJ0cnVlXCI9PT10PyEwOlwiZmFsc2VcIj09PXQ/ITE6ZS5FdmFsKHQsaSl9LGUuX0hhbmRsZVBhcmVudGhlc2lzQ29udGVudD1mdW5jdGlvbih0LGkpe2k9aXx8ZnVuY3Rpb24oZSl7cmV0dXJuXCJ0cnVlXCI9PT1lfTt2YXIgcixuPXQuc3BsaXQoXCJ8fFwiKTtmb3IodmFyIG8gaW4gbil7dmFyIHM9ZS5fU2ltcGxpZnlOZWdhdGlvbihuW29dLnRyaW0oKSksYT1zLnNwbGl0KFwiJiZcIik7aWYoYS5sZW5ndGg+MSlmb3IodmFyIGg9MDtoPGEubGVuZ3RoOysraCl7dmFyIGM9ZS5fU2ltcGxpZnlOZWdhdGlvbihhW2hdLnRyaW0oKSk7aWYocj1cInRydWVcIiE9PWMmJlwiZmFsc2VcIiE9PWM/XCIhXCI9PT1jWzBdPyFpKGMuc3Vic3RyaW5nKDEpKTppKGMpOlwidHJ1ZVwiPT09Yywhcil7cz1cImZhbHNlXCI7YnJlYWt9fWlmKHJ8fFwidHJ1ZVwiPT09cyl7cj0hMDticmVha31yPVwidHJ1ZVwiIT09cyYmXCJmYWxzZVwiIT09cz9cIiFcIj09PXNbMF0/IWkocy5zdWJzdHJpbmcoMSkpOmkocyk6XCJ0cnVlXCI9PT1zfXJldHVybiByP1widHJ1ZVwiOlwiZmFsc2VcIn0sZS5fU2ltcGxpZnlOZWdhdGlvbj1mdW5jdGlvbihlKXtyZXR1cm4gZT1lLnJlcGxhY2UoL15bXFxzIV0rLyxmdW5jdGlvbihlKXtyZXR1cm4gZT1lLnJlcGxhY2UoL1tcXHNdL2csZnVuY3Rpb24oKXtyZXR1cm5cIlwifSksZS5sZW5ndGglMj9cIiFcIjpcIlwifSksZT1lLnRyaW0oKSxcIiF0cnVlXCI9PT1lP2U9XCJmYWxzZVwiOlwiIWZhbHNlXCI9PT1lJiYoZT1cInRydWVcIiksZX0sZX0oKTtlLkFuZE9yTm90RXZhbHVhdG9yPXR9KHQ9ZS5JbnRlcm5hbHN8fChlLkludGVybmFscz17fSkpfShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCxpLHIsbixvLHMpe3RoaXMuX2VuYWJsZWQ9ITAsdGhpcy5fcmVmQ291bnQ9MCx0aGlzLl9uYW1lPWksdGhpcy5fcmVuZGVyVGV4dHVyZT1uZXcgZS5SZW5kZXJUYXJnZXRUZXh0dXJlKGkscix0KSx0aGlzLnNldFJlbmRlckxpc3QobiksdGhpcy5fcmVuZGVyVGV4dHVyZS5vbkJlZm9yZVJlbmRlck9ic2VydmFibGUuYWRkKG8pLHRoaXMuX3JlbmRlclRleHR1cmUub25BZnRlclJlbmRlck9ic2VydmFibGUuYWRkKHMpLHRoaXMuX3NjZW5lPXQsdGhpcy5fcmVuZGVyTGlzdD1ufXJldHVybiB0LnByb3RvdHlwZS5faW5jUmVmQ291bnQ9ZnVuY3Rpb24oKXtyZXR1cm4gMD09PXRoaXMuX3JlZkNvdW50JiZ0aGlzLl9zY2VuZS5jdXN0b21SZW5kZXJUYXJnZXRzLnB1c2godGhpcy5fcmVuZGVyVGV4dHVyZSksKyt0aGlzLl9yZWZDb3VudH0sdC5wcm90b3R5cGUuX2RlY1JlZkNvdW50PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3JlZkNvdW50LS0sdGhpcy5fcmVmQ291bnQ8PTAmJnRoaXMuX3NjZW5lLmN1c3RvbVJlbmRlclRhcmdldHMuc3BsaWNlKHRoaXMuX3NjZW5lLmN1c3RvbVJlbmRlclRhcmdldHMuaW5kZXhPZih0aGlzLl9yZW5kZXJUZXh0dXJlKSwxKSx0aGlzLl9yZWZDb3VudH0sdC5wcm90b3R5cGUuX3VwZGF0ZT1mdW5jdGlvbigpe3RoaXMuc2V0UmVuZGVyTGlzdCh0aGlzLl9yZW5kZXJMaXN0KX0sdC5wcm90b3R5cGUuc2V0UmVuZGVyTGlzdD1mdW5jdGlvbihlKXt0aGlzLl9yZW5kZXJUZXh0dXJlLnJlbmRlckxpc3Q9ZX0sdC5wcm90b3R5cGUuZ2V0UmVuZGVyVGV4dHVyZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9yZW5kZXJUZXh0dXJlfSx0fSgpO2UuUG9zdFByb2Nlc3NSZW5kZXJQYXNzPXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdChlLHQsaSxyKXt0aGlzLl9lbmdpbmU9ZSx0aGlzLl9uYW1lPXQsdGhpcy5fc2luZ2xlSW5zdGFuY2U9cnx8ITAsdGhpcy5fZ2V0UG9zdFByb2Nlc3M9aSx0aGlzLl9jYW1lcmFzPVtdLHRoaXMuX2luZGljZXNGb3JDYW1lcmE9W10sdGhpcy5fcG9zdFByb2Nlc3Nlcz17fSx0aGlzLl9yZW5kZXJQYXNzZXM9e30sdGhpcy5fcmVuZGVyRWZmZWN0QXNQYXNzZXM9e319cmV0dXJuIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcImlzU3VwcG9ydGVkXCIse2dldDpmdW5jdGlvbigpe2Zvcih2YXIgZSBpbiB0aGlzLl9wb3N0UHJvY2Vzc2VzKWlmKCF0aGlzLl9wb3N0UHJvY2Vzc2VzW2VdLmlzU3VwcG9ydGVkKXJldHVybiExO3JldHVybiEwfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLHQucHJvdG90eXBlLl91cGRhdGU9ZnVuY3Rpb24oKXtmb3IodmFyIGUgaW4gdGhpcy5fcmVuZGVyUGFzc2VzKXRoaXMuX3JlbmRlclBhc3Nlc1tlXS5fdXBkYXRlKCl9LHQucHJvdG90eXBlLmFkZFBhc3M9ZnVuY3Rpb24oZSl7dGhpcy5fcmVuZGVyUGFzc2VzW2UuX25hbWVdPWUsdGhpcy5fbGlua1BhcmFtZXRlcnMoKX0sdC5wcm90b3R5cGUucmVtb3ZlUGFzcz1mdW5jdGlvbihlKXtkZWxldGUgdGhpcy5fcmVuZGVyUGFzc2VzW2UuX25hbWVdLHRoaXMuX2xpbmtQYXJhbWV0ZXJzKCl9LHQucHJvdG90eXBlLmFkZFJlbmRlckVmZmVjdEFzUGFzcz1mdW5jdGlvbihlKXt0aGlzLl9yZW5kZXJFZmZlY3RBc1Bhc3Nlc1tlLl9uYW1lXT1lLHRoaXMuX2xpbmtQYXJhbWV0ZXJzKCl9LHQucHJvdG90eXBlLmdldFBhc3M9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0IGluIHRoaXMuX3JlbmRlclBhc3NlcylpZih0PT09ZSlyZXR1cm4gdGhpcy5fcmVuZGVyUGFzc2VzW2VdfSx0LnByb3RvdHlwZS5lbXB0eVBhc3Nlcz1mdW5jdGlvbigpe3RoaXMuX3JlbmRlclBhc3Nlcz17fSx0aGlzLl9saW5rUGFyYW1ldGVycygpfSx0LnByb3RvdHlwZS5fYXR0YWNoQ2FtZXJhcz1mdW5jdGlvbih0KXtmb3IodmFyIGkscj1lLlRvb2xzLk1ha2VBcnJheSh0fHx0aGlzLl9jYW1lcmFzKSxuPTA7bjxyLmxlbmd0aDtuKyspe3ZhciBvPXJbbl0scz1vLm5hbWU7aT10aGlzLl9zaW5nbGVJbnN0YW5jZT8wOnMsdGhpcy5fcG9zdFByb2Nlc3Nlc1tpXT10aGlzLl9wb3N0UHJvY2Vzc2VzW2ldfHx0aGlzLl9nZXRQb3N0UHJvY2VzcygpO3ZhciBhPW8uYXR0YWNoUG9zdFByb2Nlc3ModGhpcy5fcG9zdFByb2Nlc3Nlc1tpXSk7dGhpcy5faW5kaWNlc0ZvckNhbWVyYVtzXXx8KHRoaXMuX2luZGljZXNGb3JDYW1lcmFbc109W10pLHRoaXMuX2luZGljZXNGb3JDYW1lcmFbc10ucHVzaChhKSwtMT09PXRoaXMuX2NhbWVyYXMuaW5kZXhPZihvKSYmKHRoaXMuX2NhbWVyYXNbc109byk7Zm9yKHZhciBoIGluIHRoaXMuX3JlbmRlclBhc3Nlcyl0aGlzLl9yZW5kZXJQYXNzZXNbaF0uX2luY1JlZkNvdW50KCl9dGhpcy5fbGlua1BhcmFtZXRlcnMoKX0sdC5wcm90b3R5cGUuX2RldGFjaENhbWVyYXM9ZnVuY3Rpb24odCl7Zm9yKHZhciBpPWUuVG9vbHMuTWFrZUFycmF5KHR8fHRoaXMuX2NhbWVyYXMpLHI9MDtyPGkubGVuZ3RoO3IrKyl7dmFyIG49aVtyXSxvPW4ubmFtZTtuLmRldGFjaFBvc3RQcm9jZXNzKHRoaXMuX3Bvc3RQcm9jZXNzZXNbdGhpcy5fc2luZ2xlSW5zdGFuY2U/MDpvXSx0aGlzLl9pbmRpY2VzRm9yQ2FtZXJhW29dKTt2YXIgcz10aGlzLl9jYW1lcmFzLmluZGV4T2Yobyk7dGhpcy5faW5kaWNlc0ZvckNhbWVyYS5zcGxpY2UocywxKSx0aGlzLl9jYW1lcmFzLnNwbGljZShzLDEpO2Zvcih2YXIgYSBpbiB0aGlzLl9yZW5kZXJQYXNzZXMpdGhpcy5fcmVuZGVyUGFzc2VzW2FdLl9kZWNSZWZDb3VudCgpfX0sdC5wcm90b3R5cGUuX2VuYWJsZT1mdW5jdGlvbih0KXtmb3IodmFyIGk9ZS5Ub29scy5NYWtlQXJyYXkodHx8dGhpcy5fY2FtZXJhcykscj0wO3I8aS5sZW5ndGg7cisrKXtmb3IodmFyIG49aVtyXSxvPW4ubmFtZSxzPTA7czx0aGlzLl9pbmRpY2VzRm9yQ2FtZXJhW29dLmxlbmd0aDtzKyspdm9pZCAwPT09bi5fcG9zdFByb2Nlc3Nlc1t0aGlzLl9pbmRpY2VzRm9yQ2FtZXJhW29dW3NdXSYmdFtyXS5hdHRhY2hQb3N0UHJvY2Vzcyh0aGlzLl9wb3N0UHJvY2Vzc2VzW3RoaXMuX3NpbmdsZUluc3RhbmNlPzA6b10sdGhpcy5faW5kaWNlc0ZvckNhbWVyYVtvXVtzXSk7Zm9yKHZhciBhIGluIHRoaXMuX3JlbmRlclBhc3Nlcyl0aGlzLl9yZW5kZXJQYXNzZXNbYV0uX2luY1JlZkNvdW50KCl9fSx0LnByb3RvdHlwZS5fZGlzYWJsZT1mdW5jdGlvbih0KXtmb3IodmFyIGk9ZS5Ub29scy5NYWtlQXJyYXkodHx8dGhpcy5fY2FtZXJhcykscj0wO3I8aS5sZW5ndGg7cisrKXt2YXIgbj1pW3JdLG89bi5OYW1lO24uZGV0YWNoUG9zdFByb2Nlc3ModGhpcy5fcG9zdFByb2Nlc3Nlc1t0aGlzLl9zaW5nbGVJbnN0YW5jZT8wOm9dLHRoaXMuX2luZGljZXNGb3JDYW1lcmFbb10pO2Zvcih2YXIgcyBpbiB0aGlzLl9yZW5kZXJQYXNzZXMpdGhpcy5fcmVuZGVyUGFzc2VzW3NdLl9kZWNSZWZDb3VudCgpfX0sdC5wcm90b3R5cGUuZ2V0UG9zdFByb2Nlc3M9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX3NpbmdsZUluc3RhbmNlP3RoaXMuX3Bvc3RQcm9jZXNzZXNbMF06dGhpcy5fcG9zdFByb2Nlc3Nlc1tlLm5hbWVdfSx0LnByb3RvdHlwZS5fbGlua1BhcmFtZXRlcnM9ZnVuY3Rpb24oKXt2YXIgZT10aGlzO2Zvcih2YXIgdCBpbiB0aGlzLl9wb3N0UHJvY2Vzc2VzKXRoaXMuYXBwbHlQYXJhbWV0ZXJzJiZ0aGlzLmFwcGx5UGFyYW1ldGVycyh0aGlzLl9wb3N0UHJvY2Vzc2VzW3RdKSx0aGlzLl9wb3N0UHJvY2Vzc2VzW3RdLm9uQmVmb3JlUmVuZGVyT2JzZXJ2YWJsZS5hZGQoZnVuY3Rpb24odCl7ZS5fbGlua1RleHR1cmVzKHQpfSl9LHQucHJvdG90eXBlLl9saW5rVGV4dHVyZXM9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0IGluIHRoaXMuX3JlbmRlclBhc3NlcyllLnNldFRleHR1cmUodCx0aGlzLl9yZW5kZXJQYXNzZXNbdF0uZ2V0UmVuZGVyVGV4dHVyZSgpKTtmb3IodmFyIGkgaW4gdGhpcy5fcmVuZGVyRWZmZWN0QXNQYXNzZXMpZS5zZXRUZXh0dXJlRnJvbVBvc3RQcm9jZXNzKGkrXCJTYW1wbGVyXCIsdGhpcy5fcmVuZGVyRWZmZWN0QXNQYXNzZXNbaV0uZ2V0UG9zdFByb2Nlc3MoKSl9LHR9KCk7ZS5Qb3N0UHJvY2Vzc1JlbmRlckVmZmVjdD10fShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoZSx0KXt0aGlzLl9lbmdpbmU9ZSx0aGlzLl9uYW1lPXQsdGhpcy5fcmVuZGVyRWZmZWN0cz17fSx0aGlzLl9yZW5kZXJFZmZlY3RzRm9ySXNvbGF0ZWRQYXNzPXt9LHRoaXMuX2NhbWVyYXM9W119cmV0dXJuIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcImlzU3VwcG9ydGVkXCIse2dldDpmdW5jdGlvbigpe2Zvcih2YXIgZSBpbiB0aGlzLl9yZW5kZXJFZmZlY3RzKWlmKCF0aGlzLl9yZW5kZXJFZmZlY3RzW2VdLmlzU3VwcG9ydGVkKXJldHVybiExO3JldHVybiEwfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLHQucHJvdG90eXBlLmFkZEVmZmVjdD1mdW5jdGlvbihlKXt0aGlzLl9yZW5kZXJFZmZlY3RzW2UuX25hbWVdPWV9LHQucHJvdG90eXBlLl9lbmFibGVFZmZlY3Q9ZnVuY3Rpb24odCxpKXt2YXIgcj10aGlzLl9yZW5kZXJFZmZlY3RzW3RdO3ImJnIuX2VuYWJsZShlLlRvb2xzLk1ha2VBcnJheShpfHx0aGlzLl9jYW1lcmFzKSl9LHQucHJvdG90eXBlLl9kaXNhYmxlRWZmZWN0PWZ1bmN0aW9uKHQsaSl7dmFyIHI9dGhpcy5fcmVuZGVyRWZmZWN0c1t0XTtyJiZyLl9kaXNhYmxlKGUuVG9vbHMuTWFrZUFycmF5KGl8fHRoaXMuX2NhbWVyYXMpKX0sdC5wcm90b3R5cGUuX2F0dGFjaENhbWVyYXM9ZnVuY3Rpb24odCxpKXt2YXIgcixuPWUuVG9vbHMuTWFrZUFycmF5KHR8fHRoaXMuX2NhbWVyYXMpLG89W107Zm9yKHI9MDtyPG4ubGVuZ3RoO3IrKyl7dmFyIHM9bltyXSxhPXMubmFtZTstMT09PXRoaXMuX2NhbWVyYXMuaW5kZXhPZihzKT90aGlzLl9jYW1lcmFzW2FdPXM6aSYmby5wdXNoKHIpfWZvcihyPTA7cjxvLmxlbmd0aDtyKyspdC5zcGxpY2Uob1tyXSwxKTtmb3IodmFyIGggaW4gdGhpcy5fcmVuZGVyRWZmZWN0cyl0aGlzLl9yZW5kZXJFZmZlY3RzW2hdLl9hdHRhY2hDYW1lcmFzKG4pfSx0LnByb3RvdHlwZS5fZGV0YWNoQ2FtZXJhcz1mdW5jdGlvbih0KXt2YXIgaT1lLlRvb2xzLk1ha2VBcnJheSh0fHx0aGlzLl9jYW1lcmFzKTtmb3IodmFyIHIgaW4gdGhpcy5fcmVuZGVyRWZmZWN0cyl0aGlzLl9yZW5kZXJFZmZlY3RzW3JdLl9kZXRhY2hDYW1lcmFzKGkpO2Zvcih2YXIgbj0wO248aS5sZW5ndGg7bisrKXRoaXMuX2NhbWVyYXMuc3BsaWNlKHRoaXMuX2NhbWVyYXMuaW5kZXhPZihpW25dKSwxKX0sdC5wcm90b3R5cGUuX2VuYWJsZURpc3BsYXlPbmx5UGFzcz1mdW5jdGlvbihpLHIpe3ZhciBuLG89dGhpcyxzPWUuVG9vbHMuTWFrZUFycmF5KHJ8fHRoaXMuX2NhbWVyYXMpLGE9bnVsbDtmb3IobiBpbiB0aGlzLl9yZW5kZXJFZmZlY3RzKWlmKGE9dGhpcy5fcmVuZGVyRWZmZWN0c1tuXS5nZXRQYXNzKGkpLG51bGwhPWEpYnJlYWs7aWYobnVsbCE9PWEpe2ZvcihuIGluIHRoaXMuX3JlbmRlckVmZmVjdHMpdGhpcy5fcmVuZGVyRWZmZWN0c1tuXS5fZGlzYWJsZShzKTthLl9uYW1lPXQuUEFTU19TQU1QTEVSX05BTUU7Zm9yKHZhciBoPTA7aDxzLmxlbmd0aDtoKyspe3ZhciBjPXNbaF0sbD1jLm5hbWU7dGhpcy5fcmVuZGVyRWZmZWN0c0Zvcklzb2xhdGVkUGFzc1tsXT10aGlzLl9yZW5kZXJFZmZlY3RzRm9ySXNvbGF0ZWRQYXNzW2xdfHxuZXcgZS5Qb3N0UHJvY2Vzc1JlbmRlckVmZmVjdCh0aGlzLl9lbmdpbmUsdC5QQVNTX0VGRkVDVF9OQU1FLGZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBlLkRpc3BsYXlQYXNzUG9zdFByb2Nlc3ModC5QQVNTX0VGRkVDVF9OQU1FLDEsbnVsbCxudWxsLG8uX2VuZ2luZSwhMCl9KSx0aGlzLl9yZW5kZXJFZmZlY3RzRm9ySXNvbGF0ZWRQYXNzW2xdLmVtcHR5UGFzc2VzKCksdGhpcy5fcmVuZGVyRWZmZWN0c0Zvcklzb2xhdGVkUGFzc1tsXS5hZGRQYXNzKGEpLHRoaXMuX3JlbmRlckVmZmVjdHNGb3JJc29sYXRlZFBhc3NbbF0uX2F0dGFjaENhbWVyYXMoYyl9fX0sdC5wcm90b3R5cGUuX2Rpc2FibGVEaXNwbGF5T25seVBhc3M9ZnVuY3Rpb24oaSl7Zm9yKHZhciByPXRoaXMsbj1lLlRvb2xzLk1ha2VBcnJheShpfHx0aGlzLl9jYW1lcmFzKSxvPTA7bzxuLmxlbmd0aDtvKyspe3ZhciBzPW5bb10sYT1zLm5hbWU7dGhpcy5fcmVuZGVyRWZmZWN0c0Zvcklzb2xhdGVkUGFzc1thXT10aGlzLl9yZW5kZXJFZmZlY3RzRm9ySXNvbGF0ZWRQYXNzW2FdfHxuZXcgZS5Qb3N0UHJvY2Vzc1JlbmRlckVmZmVjdCh0aGlzLl9lbmdpbmUsdC5QQVNTX0VGRkVDVF9OQU1FLGZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBlLkRpc3BsYXlQYXNzUG9zdFByb2Nlc3ModC5QQVNTX0VGRkVDVF9OQU1FLDEsbnVsbCxudWxsLHIuX2VuZ2luZSwhMCl9KSx0aGlzLl9yZW5kZXJFZmZlY3RzRm9ySXNvbGF0ZWRQYXNzW2FdLl9kaXNhYmxlKHMpfWZvcih2YXIgaCBpbiB0aGlzLl9yZW5kZXJFZmZlY3RzKXRoaXMuX3JlbmRlckVmZmVjdHNbaF0uX2VuYWJsZShuKX0sdC5wcm90b3R5cGUuX3VwZGF0ZT1mdW5jdGlvbigpe2Zvcih2YXIgZSBpbiB0aGlzLl9yZW5kZXJFZmZlY3RzKXRoaXMuX3JlbmRlckVmZmVjdHNbZV0uX3VwZGF0ZSgpO2Zvcih2YXIgdD0wO3Q8dGhpcy5fY2FtZXJhcy5sZW5ndGg7dCsrKXt2YXIgaT10aGlzLl9jYW1lcmFzW3RdLm5hbWU7dGhpcy5fcmVuZGVyRWZmZWN0c0Zvcklzb2xhdGVkUGFzc1tpXSYmdGhpcy5fcmVuZGVyRWZmZWN0c0Zvcklzb2xhdGVkUGFzc1tpXS5fdXBkYXRlKCl9fSx0LnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7fSx0LlBBU1NfRUZGRUNUX05BTUU9XCJwYXNzRWZmZWN0XCIsdC5QQVNTX1NBTVBMRVJfTkFNRT1cInBhc3NTYW1wbGVyXCIsdH0oKTtlLlBvc3RQcm9jZXNzUmVuZGVyUGlwZWxpbmU9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7dGhpcy5fcmVuZGVyUGlwZWxpbmVzPXt9fXJldHVybiBlLnByb3RvdHlwZS5hZGRQaXBlbGluZT1mdW5jdGlvbihlKXt0aGlzLl9yZW5kZXJQaXBlbGluZXNbZS5fbmFtZV09ZX0sZS5wcm90b3R5cGUuYXR0YWNoQ2FtZXJhc1RvUmVuZGVyUGlwZWxpbmU9ZnVuY3Rpb24oZSx0LGkpe3ZhciByPXRoaXMuX3JlbmRlclBpcGVsaW5lc1tlXTtyJiZyLl9hdHRhY2hDYW1lcmFzKHQsaSl9LGUucHJvdG90eXBlLmRldGFjaENhbWVyYXNGcm9tUmVuZGVyUGlwZWxpbmU9ZnVuY3Rpb24oZSx0KXt2YXIgaT10aGlzLl9yZW5kZXJQaXBlbGluZXNbZV07aSYmaS5fZGV0YWNoQ2FtZXJhcyh0KX0sZS5wcm90b3R5cGUuZW5hYmxlRWZmZWN0SW5QaXBlbGluZT1mdW5jdGlvbihlLHQsaSl7dmFyIHI9dGhpcy5fcmVuZGVyUGlwZWxpbmVzW2VdO3ImJnIuX2VuYWJsZUVmZmVjdCh0LGkpfSxlLnByb3RvdHlwZS5kaXNhYmxlRWZmZWN0SW5QaXBlbGluZT1mdW5jdGlvbihlLHQsaSl7dmFyIHI9dGhpcy5fcmVuZGVyUGlwZWxpbmVzW2VdO3ImJnIuX2Rpc2FibGVFZmZlY3QodCxpKX0sZS5wcm90b3R5cGUuZW5hYmxlRGlzcGxheU9ubHlQYXNzSW5QaXBlbGluZT1mdW5jdGlvbihlLHQsaSl7dmFyIHI9dGhpcy5fcmVuZGVyUGlwZWxpbmVzW2VdO3ImJnIuX2VuYWJsZURpc3BsYXlPbmx5UGFzcyh0LGkpfSxlLnByb3RvdHlwZS5kaXNhYmxlRGlzcGxheU9ubHlQYXNzSW5QaXBlbGluZT1mdW5jdGlvbihlLHQpe3ZhciBpPXRoaXMuX3JlbmRlclBpcGVsaW5lc1tlXTtpJiZpLl9kaXNhYmxlRGlzcGxheU9ubHlQYXNzKHQpfSxlLnByb3RvdHlwZS51cGRhdGU9ZnVuY3Rpb24oKXtmb3IodmFyIGUgaW4gdGhpcy5fcmVuZGVyUGlwZWxpbmVzKXt2YXIgdD10aGlzLl9yZW5kZXJQaXBlbGluZXNbZV07dC5pc1N1cHBvcnRlZD90Ll91cGRhdGUoKToodC5kaXNwb3NlKCksZGVsZXRlIHRoaXMuX3JlbmRlclBpcGVsaW5lc1tlXSl9fSxlfSgpO2UuUG9zdFByb2Nlc3NSZW5kZXJQaXBlbGluZU1hbmFnZXI9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQpe3RoaXMuZnJvbnRDb2xvcj1uZXcgZS5Db2xvcjMoMSwxLDEpLHRoaXMuYmFja0NvbG9yPW5ldyBlLkNvbG9yMyguMSwuMSwuMSksdGhpcy5zaG93QmFja0xpbmVzPSEwLHRoaXMucmVuZGVyTGlzdD1uZXcgZS5TbWFydEFycmF5KDMyKSx0aGlzLl92ZXJ0ZXhCdWZmZXJzPXt9LHRoaXMuX3NjZW5lPXR9cmV0dXJuIHQucHJvdG90eXBlLl9wcmVwYXJlUmVzc291cmNlcz1mdW5jdGlvbigpe2lmKCF0aGlzLl9jb2xvclNoYWRlcil7dGhpcy5fY29sb3JTaGFkZXI9bmV3IGUuU2hhZGVyTWF0ZXJpYWwoXCJjb2xvclNoYWRlclwiLHRoaXMuX3NjZW5lLFwiY29sb3JcIix7YXR0cmlidXRlczpbZS5WZXJ0ZXhCdWZmZXIuUG9zaXRpb25LaW5kXSx1bmlmb3JtczpbXCJ3b3JsZFZpZXdQcm9qZWN0aW9uXCIsXCJjb2xvclwiXX0pO3ZhciB0PXRoaXMuX3NjZW5lLmdldEVuZ2luZSgpLGk9ZS5WZXJ0ZXhEYXRhLkNyZWF0ZUJveCgxKTt0aGlzLl92ZXJ0ZXhCdWZmZXJzW2UuVmVydGV4QnVmZmVyLlBvc2l0aW9uS2luZF09bmV3IGUuVmVydGV4QnVmZmVyKHQsaS5wb3NpdGlvbnMsZS5WZXJ0ZXhCdWZmZXIuUG9zaXRpb25LaW5kLCExKSx0aGlzLl9pbmRleEJ1ZmZlcj10LmNyZWF0ZUluZGV4QnVmZmVyKFswLDEsMSwyLDIsMywzLDAsNCw1LDUsNiw2LDcsNyw0LDAsNywxLDYsMiw1LDMsNF0pfX0sdC5wcm90b3R5cGUucmVzZXQ9ZnVuY3Rpb24oKXt0aGlzLnJlbmRlckxpc3QucmVzZXQoKX0sdC5wcm90b3R5cGUucmVuZGVyPWZ1bmN0aW9uKCl7aWYoMCE9PXRoaXMucmVuZGVyTGlzdC5sZW5ndGgmJih0aGlzLl9wcmVwYXJlUmVzc291cmNlcygpLHRoaXMuX2NvbG9yU2hhZGVyLmlzUmVhZHkoKSkpe3ZhciB0PXRoaXMuX3NjZW5lLmdldEVuZ2luZSgpO3Quc2V0RGVwdGhXcml0ZSghMSksdGhpcy5fY29sb3JTaGFkZXIuX3ByZUJpbmQoKTtmb3IodmFyIGk9MDtpPHRoaXMucmVuZGVyTGlzdC5sZW5ndGg7aSsrKXt2YXIgcj10aGlzLnJlbmRlckxpc3QuZGF0YVtpXSxuPXIubWluaW11bSxvPXIubWF4aW11bSxzPW8uc3VidHJhY3QobiksYT1uLmFkZChzLnNjYWxlKC41KSksaD1lLk1hdHJpeC5TY2FsaW5nKHMueCxzLnkscy56KS5tdWx0aXBseShlLk1hdHJpeC5UcmFuc2xhdGlvbihhLngsYS55LGEueikpLm11bHRpcGx5KHIuZ2V0V29ybGRNYXRyaXgoKSk7dC5iaW5kQnVmZmVycyh0aGlzLl92ZXJ0ZXhCdWZmZXJzLHRoaXMuX2luZGV4QnVmZmVyLHRoaXMuX2NvbG9yU2hhZGVyLmdldEVmZmVjdCgpKSx0aGlzLnNob3dCYWNrTGluZXMmJih0LnNldERlcHRoRnVuY3Rpb25Ub0dyZWF0ZXJPckVxdWFsKCksdGhpcy5fc2NlbmUucmVzZXRDYWNoZWRNYXRlcmlhbCgpLHRoaXMuX2NvbG9yU2hhZGVyLnNldENvbG9yNChcImNvbG9yXCIsdGhpcy5iYWNrQ29sb3IudG9Db2xvcjQoKSksdGhpcy5fY29sb3JTaGFkZXIuYmluZChoKSx0LmRyYXcoITEsMCwyNCkpLHQuc2V0RGVwdGhGdW5jdGlvblRvTGVzcygpLHRoaXMuX3NjZW5lLnJlc2V0Q2FjaGVkTWF0ZXJpYWwoKSx0aGlzLl9jb2xvclNoYWRlci5zZXRDb2xvcjQoXCJjb2xvclwiLHRoaXMuZnJvbnRDb2xvci50b0NvbG9yNCgpKSx0aGlzLl9jb2xvclNoYWRlci5iaW5kKGgpLHQuZHJhdyghMSwwLDI0KX10aGlzLl9jb2xvclNoYWRlci51bmJpbmQoKSx0LnNldERlcHRoRnVuY3Rpb25Ub0xlc3NPckVxdWFsKCksdC5zZXREZXB0aFdyaXRlKCEwKX19LHQucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXtpZih0aGlzLl9jb2xvclNoYWRlcil7dGhpcy5fY29sb3JTaGFkZXIuZGlzcG9zZSgpO3ZhciB0PXRoaXMuX3ZlcnRleEJ1ZmZlcnNbZS5WZXJ0ZXhCdWZmZXIuUG9zaXRpb25LaW5kXTt0JiYodC5kaXNwb3NlKCksdGhpcy5fdmVydGV4QnVmZmVyc1tlLlZlcnRleEJ1ZmZlci5Qb3NpdGlvbktpbmRdPW51bGwpLHRoaXMuX3NjZW5lLmdldEVuZ2luZSgpLl9yZWxlYXNlQnVmZmVyKHRoaXMuX2luZGV4QnVmZmVyKX19LHR9KCk7ZS5Cb3VuZGluZ0JveFJlbmRlcmVyPXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlKXt0aGlzLl9hY3Rpb25NYW5hZ2VyPWV9cmV0dXJuIGUucHJvdG90eXBlLmlzVmFsaWQ9ZnVuY3Rpb24oKXtyZXR1cm4hMH0sZS5wcm90b3R5cGUuX2dldFByb3BlcnR5PWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9hY3Rpb25NYW5hZ2VyLl9nZXRQcm9wZXJ0eShlKX0sZS5wcm90b3R5cGUuX2dldEVmZmVjdGl2ZVRhcmdldD1mdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLl9hY3Rpb25NYW5hZ2VyLl9nZXRFZmZlY3RpdmVUYXJnZXQoZSx0KX0sZS5wcm90b3R5cGUuc2VyaWFsaXplPWZ1bmN0aW9uKCl7fSxlLnByb3RvdHlwZS5fc2VyaWFsaXplPWZ1bmN0aW9uKGUpe3JldHVybnt0eXBlOjIsY2hpbGRyZW46W10sbmFtZTplLm5hbWUscHJvcGVydGllczplLnByb3BlcnRpZXN9fSxlfSgpO2UuQ29uZGl0aW9uPXQ7dmFyIGk9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gaShlLHIsbixvLHMpe3ZvaWQgMD09PXMmJihzPWkuSXNFcXVhbCksdC5jYWxsKHRoaXMsZSksdGhpcy5wcm9wZXJ0eVBhdGg9bix0aGlzLnZhbHVlPW8sdGhpcy5vcGVyYXRvcj1zLHRoaXMuX3RhcmdldD1yLHRoaXMuX2VmZmVjdGl2ZVRhcmdldD10aGlzLl9nZXRFZmZlY3RpdmVUYXJnZXQocix0aGlzLnByb3BlcnR5UGF0aCksdGhpcy5fcHJvcGVydHk9dGhpcy5fZ2V0UHJvcGVydHkodGhpcy5wcm9wZXJ0eVBhdGgpfXJldHVybiBfX2V4dGVuZHMoaSx0KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaSxcIklzRXF1YWxcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGkuX0lzRXF1YWx9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGksXCJJc0RpZmZlcmVudFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gaS5fSXNEaWZmZXJlbnR9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGksXCJJc0dyZWF0ZXJcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGkuX0lzR3JlYXRlcn0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaSxcIklzTGVzc2VyXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBpLl9Jc0xlc3Nlcn0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxpLnByb3RvdHlwZS5pc1ZhbGlkPWZ1bmN0aW9uKCl7c3dpdGNoKHRoaXMub3BlcmF0b3Ipe2Nhc2UgaS5Jc0dyZWF0ZXI6cmV0dXJuIHRoaXMuX2VmZmVjdGl2ZVRhcmdldFt0aGlzLl9wcm9wZXJ0eV0+dGhpcy52YWx1ZTtjYXNlIGkuSXNMZXNzZXI6cmV0dXJuIHRoaXMuX2VmZmVjdGl2ZVRhcmdldFt0aGlzLl9wcm9wZXJ0eV08dGhpcy52YWx1ZTtjYXNlIGkuSXNFcXVhbDpjYXNlIGkuSXNEaWZmZXJlbnQ6dmFyIGU7cmV0dXJuIGU9dGhpcy52YWx1ZS5lcXVhbHM/dGhpcy52YWx1ZS5lcXVhbHModGhpcy5fZWZmZWN0aXZlVGFyZ2V0W3RoaXMuX3Byb3BlcnR5XSk6dGhpcy52YWx1ZT09PXRoaXMuX2VmZmVjdGl2ZVRhcmdldFt0aGlzLl9wcm9wZXJ0eV0sdGhpcy5vcGVyYXRvcj09PWkuSXNFcXVhbD9lOiFlfXJldHVybiExfSxpLnByb3RvdHlwZS5zZXJpYWxpemU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc2VyaWFsaXplKHtuYW1lOlwiVmFsdWVDb25kaXRpb25cIixwcm9wZXJ0aWVzOltlLkFjdGlvbi5fR2V0VGFyZ2V0UHJvcGVydHkodGhpcy5fdGFyZ2V0KSx7bmFtZTpcInByb3BlcnR5UGF0aFwiLHZhbHVlOnRoaXMucHJvcGVydHlQYXRofSx7bmFtZTpcInZhbHVlXCIsdmFsdWU6ZS5BY3Rpb24uX1NlcmlhbGl6ZVZhbHVlQXNTdHJpbmcodGhpcy52YWx1ZSl9LHtuYW1lOlwib3BlcmF0b3JcIix2YWx1ZTppLkdldE9wZXJhdG9yTmFtZSh0aGlzLm9wZXJhdG9yKX1dfSl9LGkuR2V0T3BlcmF0b3JOYW1lPWZ1bmN0aW9uKGUpe3N3aXRjaChlKXtjYXNlIGkuX0lzRXF1YWw6cmV0dXJuXCJJc0VxdWFsXCI7Y2FzZSBpLl9Jc0RpZmZlcmVudDpyZXR1cm5cIklzRGlmZmVyZW50XCI7Y2FzZSBpLl9Jc0dyZWF0ZXI6cmV0dXJuXCJJc0dyZWF0ZXJcIjtjYXNlIGkuX0lzTGVzc2VyOnJldHVyblwiSXNMZXNzZXJcIjtkZWZhdWx0OnJldHVyblwiXCJ9fSxpLl9Jc0VxdWFsPTAsaS5fSXNEaWZmZXJlbnQ9MSxpLl9Jc0dyZWF0ZXI9MixpLl9Jc0xlc3Nlcj0zLGl9KHQpO2UuVmFsdWVDb25kaXRpb249aTt2YXIgcj1mdW5jdGlvbihlKXtmdW5jdGlvbiB0KHQsaSl7ZS5jYWxsKHRoaXMsdCksdGhpcy5wcmVkaWNhdGU9aX1yZXR1cm4gX19leHRlbmRzKHQsZSksdC5wcm90b3R5cGUuaXNWYWxpZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnByZWRpY2F0ZSgpfSx0fSh0KTtlLlByZWRpY2F0ZUNvbmRpdGlvbj1yO3ZhciBuPWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGkoZSxpLHIpe3QuY2FsbCh0aGlzLGUpLHRoaXMudmFsdWU9cix0aGlzLl90YXJnZXQ9aX1yZXR1cm4gX19leHRlbmRzKGksdCksaS5wcm90b3R5cGUuaXNWYWxpZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl90YXJnZXQuc3RhdGU9PT10aGlzLnZhbHVlfSxpLnByb3RvdHlwZS5zZXJpYWxpemU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc2VyaWFsaXplKHtuYW1lOlwiU3RhdGVDb25kaXRpb25cIixwcm9wZXJ0aWVzOltlLkFjdGlvbi5fR2V0VGFyZ2V0UHJvcGVydHkodGhpcy5fdGFyZ2V0KSx7bmFtZTpcInZhbHVlXCIsdmFsdWU6dGhpcy52YWx1ZX1dfSl9LGl9KHQpO2UuU3RhdGVDb25kaXRpb249bn0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KGUsdCl7dGhpcy50cmlnZ2VyT3B0aW9ucz1lLGUucGFyYW1ldGVyPyh0aGlzLnRyaWdnZXI9ZS50cmlnZ2VyLHRoaXMuX3RyaWdnZXJQYXJhbWV0ZXI9ZS5wYXJhbWV0ZXIpOnRoaXMudHJpZ2dlcj1lLHRoaXMuX25leHRBY3RpdmVBY3Rpb249dGhpcyx0aGlzLl9jb25kaXRpb249dH1yZXR1cm4gdC5wcm90b3R5cGUuX3ByZXBhcmU9ZnVuY3Rpb24oKXt9LHQucHJvdG90eXBlLmdldFRyaWdnZXJQYXJhbWV0ZXI9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fdHJpZ2dlclBhcmFtZXRlcn0sdC5wcm90b3R5cGUuX2V4ZWN1dGVDdXJyZW50PWZ1bmN0aW9uKGUpe2lmKHRoaXMuX25leHRBY3RpdmVBY3Rpb24uX2NvbmRpdGlvbil7dmFyIHQ9dGhpcy5fbmV4dEFjdGl2ZUFjdGlvbi5fY29uZGl0aW9uLGk9dGhpcy5fYWN0aW9uTWFuYWdlci5nZXRTY2VuZSgpLmdldFJlbmRlcklkKCk7aWYodC5fZXZhbHVhdGlvbklkPT09aSl7aWYoIXQuX2N1cnJlbnRSZXN1bHQpcmV0dXJufWVsc2V7aWYodC5fZXZhbHVhdGlvbklkPWksIXQuaXNWYWxpZCgpKXJldHVybiB2b2lkKHQuX2N1cnJlbnRSZXN1bHQ9ITEpO3QuX2N1cnJlbnRSZXN1bHQ9ITB9fXRoaXMuX25leHRBY3RpdmVBY3Rpb24uZXhlY3V0ZShlKSx0aGlzLnNraXBUb05leHRBY3RpdmVBY3Rpb24oKX0sdC5wcm90b3R5cGUuZXhlY3V0ZT1mdW5jdGlvbihlKXt9LHQucHJvdG90eXBlLnNraXBUb05leHRBY3RpdmVBY3Rpb249ZnVuY3Rpb24oKXt0aGlzLl9uZXh0QWN0aXZlQWN0aW9uLl9jaGlsZD8odGhpcy5fbmV4dEFjdGl2ZUFjdGlvbi5fY2hpbGQuX2FjdGlvbk1hbmFnZXJ8fCh0aGlzLl9uZXh0QWN0aXZlQWN0aW9uLl9jaGlsZC5fYWN0aW9uTWFuYWdlcj10aGlzLl9hY3Rpb25NYW5hZ2VyKSx0aGlzLl9uZXh0QWN0aXZlQWN0aW9uPXRoaXMuX25leHRBY3RpdmVBY3Rpb24uX2NoaWxkKTp0aGlzLl9uZXh0QWN0aXZlQWN0aW9uPXRoaXN9LHQucHJvdG90eXBlLnRoZW49ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2NoaWxkPWUsZS5fYWN0aW9uTWFuYWdlcj10aGlzLl9hY3Rpb25NYW5hZ2VyLGUuX3ByZXBhcmUoKSxlfSx0LnByb3RvdHlwZS5fZ2V0UHJvcGVydHk9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2FjdGlvbk1hbmFnZXIuX2dldFByb3BlcnR5KGUpfSx0LnByb3RvdHlwZS5fZ2V0RWZmZWN0aXZlVGFyZ2V0PWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuX2FjdGlvbk1hbmFnZXIuX2dldEVmZmVjdGl2ZVRhcmdldChlLHQpfSx0LnByb3RvdHlwZS5zZXJpYWxpemU9ZnVuY3Rpb24oZSl7fSx0LnByb3RvdHlwZS5fc2VyaWFsaXplPWZ1bmN0aW9uKGUsdCl7dmFyIGk9e3R5cGU6MSxjaGlsZHJlbjpbXSxuYW1lOmUubmFtZSxwcm9wZXJ0aWVzOmUucHJvcGVydGllc3x8W119O2lmKHRoaXMuX2NoaWxkJiZ0aGlzLl9jaGlsZC5zZXJpYWxpemUoaSksdGhpcy5fY29uZGl0aW9uKXt2YXIgcj10aGlzLl9jb25kaXRpb24uc2VyaWFsaXplKCk7cmV0dXJuIHIuY2hpbGRyZW4ucHVzaChpKSx0JiZ0LmNoaWxkcmVuLnB1c2gocikscn1yZXR1cm4gdCYmdC5jaGlsZHJlbi5wdXNoKGkpLGl9LHQuX1NlcmlhbGl6ZVZhbHVlQXNTdHJpbmc9ZnVuY3Rpb24odCl7cmV0dXJuXCJudW1iZXJcIj09dHlwZW9mIHQ/dC50b1N0cmluZygpOlwiYm9vbGVhblwiPT10eXBlb2YgdD90P1widHJ1ZVwiOlwiZmFsc2VcIjp0IGluc3RhbmNlb2YgZS5WZWN0b3IyP3QueCtcIiwgXCIrdC55OnQgaW5zdGFuY2VvZiBlLlZlY3RvcjM/dC54K1wiLCBcIit0LnkrXCIsIFwiK3Quejp0IGluc3RhbmNlb2YgZS5Db2xvcjM/dC5yK1wiLCBcIit0LmcrXCIsIFwiK3QuYjp0IGluc3RhbmNlb2YgZS5Db2xvcjQ/dC5yK1wiLCBcIit0LmcrXCIsIFwiK3QuYitcIiwgXCIrdC5hOnR9LHQuX0dldFRhcmdldFByb3BlcnR5PWZ1bmN0aW9uKHQpe3JldHVybntuYW1lOlwidGFyZ2V0XCIsdGFyZ2V0VHlwZTp0IGluc3RhbmNlb2YgZS5NZXNoP1wiTWVzaFByb3BlcnRpZXNcIjp0IGluc3RhbmNlb2YgZS5MaWdodD9cIkxpZ2h0UHJvcGVydGllc1wiOnQgaW5zdGFuY2VvZiBlLkNhbWVyYT9cIkNhbWVyYVByb3BlcnRpZXNcIjpcIlNjZW5lUHJvcGVydGllc1wiLHZhbHVlOnQgaW5zdGFuY2VvZiBlLlNjZW5lP1wiU2NlbmVcIjp0Lm5hbWV9fSx0fSgpO2UuQWN0aW9uPXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlLHQsaSxyLG4sbyl7dGhpcy5zb3VyY2U9ZSx0aGlzLnBvaW50ZXJYPXQsdGhpcy5wb2ludGVyWT1pLHRoaXMubWVzaFVuZGVyUG9pbnRlcj1yLHRoaXMuc291cmNlRXZlbnQ9bix0aGlzLmFkZGl0aW9uYWxEYXRhPW99cmV0dXJuIGUuQ3JlYXRlTmV3PWZ1bmN0aW9uKHQsaSxyKXt2YXIgbj10LmdldFNjZW5lKCk7cmV0dXJuIG5ldyBlKHQsbi5wb2ludGVyWCxuLnBvaW50ZXJZLG4ubWVzaFVuZGVyUG9pbnRlcixpLHIpfSxlLkNyZWF0ZU5ld0Zyb21TcHJpdGU9ZnVuY3Rpb24odCxpLHIsbil7cmV0dXJuIG5ldyBlKHQsaS5wb2ludGVyWCxpLnBvaW50ZXJZLGkubWVzaFVuZGVyUG9pbnRlcixyLG4pfSxlLkNyZWF0ZU5ld0Zyb21TY2VuZT1mdW5jdGlvbih0LGkpe3JldHVybiBuZXcgZShudWxsLHQucG9pbnRlclgsdC5wb2ludGVyWSx0Lm1lc2hVbmRlclBvaW50ZXIsaSl9LGUuQ3JlYXRlTmV3RnJvbVByaW1pdGl2ZT1mdW5jdGlvbih0LGkscixuKXtyZXR1cm4gbmV3IGUodCxpLngsaS55LG51bGwscixuKX0sZX0oKTtlLkFjdGlvbkV2ZW50PXQ7dmFyIGk9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KGUpe3RoaXMuYWN0aW9ucz1uZXcgQXJyYXksdGhpcy5fc2NlbmU9ZSxlLl9hY3Rpb25NYW5hZ2Vycy5wdXNoKHRoaXMpfXJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIk5vdGhpbmdUcmlnZ2VyXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0Ll9Ob3RoaW5nVHJpZ2dlcn0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIk9uUGlja1RyaWdnZXJcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHQuX09uUGlja1RyaWdnZXJ9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJPbkxlZnRQaWNrVHJpZ2dlclwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdC5fT25MZWZ0UGlja1RyaWdnZXJ9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJPblJpZ2h0UGlja1RyaWdnZXJcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHQuX09uUmlnaHRQaWNrVHJpZ2dlcn0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIk9uQ2VudGVyUGlja1RyaWdnZXJcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHQuX09uQ2VudGVyUGlja1RyaWdnZXJ9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJPblBpY2tEb3duVHJpZ2dlclwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdC5fT25QaWNrRG93blRyaWdnZXJ9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJPblBpY2tVcFRyaWdnZXJcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHQuX09uUGlja1VwVHJpZ2dlcn0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIk9uUGlja091dFRyaWdnZXJcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHQuX09uUGlja091dFRyaWdnZXJ9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJPbkxvbmdQcmVzc1RyaWdnZXJcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHQuX09uTG9uZ1ByZXNzVHJpZ2dlcn0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIk9uUG9pbnRlck92ZXJUcmlnZ2VyXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0Ll9PblBvaW50ZXJPdmVyVHJpZ2dlcn0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIk9uUG9pbnRlck91dFRyaWdnZXJcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHQuX09uUG9pbnRlck91dFRyaWdnZXJ9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJPbkV2ZXJ5RnJhbWVUcmlnZ2VyXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0Ll9PbkV2ZXJ5RnJhbWVUcmlnZ2VyfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiT25JbnRlcnNlY3Rpb25FbnRlclRyaWdnZXJcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHQuX09uSW50ZXJzZWN0aW9uRW50ZXJUcmlnZ2VyfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiT25JbnRlcnNlY3Rpb25FeGl0VHJpZ2dlclwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdC5fT25JbnRlcnNlY3Rpb25FeGl0VHJpZ2dlcn0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIk9uS2V5RG93blRyaWdnZXJcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHQuX09uS2V5RG93blRyaWdnZXJ9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJPbktleVVwVHJpZ2dlclwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdC5fT25LZXlVcFRyaWdnZXJ9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksdC5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3ZhciBlPXRoaXMuX3NjZW5lLl9hY3Rpb25NYW5hZ2Vycy5pbmRleE9mKHRoaXMpO2U+LTEmJnRoaXMuX3NjZW5lLl9hY3Rpb25NYW5hZ2Vycy5zcGxpY2UoZSwxKX0sdC5wcm90b3R5cGUuZ2V0U2NlbmU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc2NlbmV9LHQucHJvdG90eXBlLmhhc1NwZWNpZmljVHJpZ2dlcnM9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PTA7dDx0aGlzLmFjdGlvbnMubGVuZ3RoO3QrKyl7dmFyIGk9dGhpcy5hY3Rpb25zW3RdO2lmKGUuaW5kZXhPZihpLnRyaWdnZXIpPi0xKXJldHVybiEwfXJldHVybiExfSx0LnByb3RvdHlwZS5oYXNTcGVjaWZpY1RyaWdnZXI9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PTA7dDx0aGlzLmFjdGlvbnMubGVuZ3RoO3QrKyl7dmFyIGk9dGhpcy5hY3Rpb25zW3RdO2lmKGkudHJpZ2dlcj09PWUpcmV0dXJuITB9cmV0dXJuITF9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcImhhc1BvaW50ZXJUcmlnZ2Vyc1wiLHtnZXQ6ZnVuY3Rpb24oKXtmb3IodmFyIGU9MDtlPHRoaXMuYWN0aW9ucy5sZW5ndGg7ZSsrKXt2YXIgaT10aGlzLmFjdGlvbnNbZV07aWYoaS50cmlnZ2VyPj10Ll9PblBpY2tUcmlnZ2VyJiZpLnRyaWdnZXI8PXQuX09uUG9pbnRlck91dFRyaWdnZXIpcmV0dXJuITB9cmV0dXJuITF9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwiaGFzUGlja1RyaWdnZXJzXCIse2dldDpmdW5jdGlvbigpe2Zvcih2YXIgZT0wO2U8dGhpcy5hY3Rpb25zLmxlbmd0aDtlKyspe3ZhciBpPXRoaXMuYWN0aW9uc1tlXTtpZihpLnRyaWdnZXI+PXQuX09uUGlja1RyaWdnZXImJmkudHJpZ2dlcjw9dC5fT25QaWNrVXBUcmlnZ2VyKXJldHVybiEwfXJldHVybiExfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLHQucHJvdG90eXBlLnJlZ2lzdGVyQWN0aW9uPWZ1bmN0aW9uKGkpe3JldHVybiBpLnRyaWdnZXI9PT10Lk9uRXZlcnlGcmFtZVRyaWdnZXImJnRoaXMuZ2V0U2NlbmUoKS5hY3Rpb25NYW5hZ2VyIT09dGhpcz8oZS5Ub29scy5XYXJuKFwiT25FdmVyeUZyYW1lVHJpZ2dlciBjYW4gb25seSBiZSB1c2VkIHdpdGggc2NlbmUuYWN0aW9uTWFuYWdlclwiKSxudWxsKToodGhpcy5hY3Rpb25zLnB1c2goaSksaS5fYWN0aW9uTWFuYWdlcj10aGlzLGkuX3ByZXBhcmUoKSxpKX0sdC5wcm90b3R5cGUucHJvY2Vzc1RyaWdnZXI9ZnVuY3Rpb24oZSxpKXtmb3IodmFyIHI9MDtyPHRoaXMuYWN0aW9ucy5sZW5ndGg7cisrKXt2YXIgbj10aGlzLmFjdGlvbnNbcl07aWYobi50cmlnZ2VyPT09ZSl7aWYoZT09PXQuT25LZXlVcFRyaWdnZXJ8fGU9PT10Lk9uS2V5RG93blRyaWdnZXIpe3ZhciBvPW4uZ2V0VHJpZ2dlclBhcmFtZXRlcigpO2lmKG8pe3ZhciBzPWkuc291cmNlRXZlbnQuY2hhckNvZGU/aS5zb3VyY2VFdmVudC5jaGFyQ29kZTppLnNvdXJjZUV2ZW50LmtleUNvZGUsYT1TdHJpbmcuZnJvbUNoYXJDb2RlKHMpLnRvTG93ZXJDYXNlKCk7aWYoYSE9PW8udG9Mb3dlckNhc2UoKSljb250aW51ZX19bi5fZXhlY3V0ZUN1cnJlbnQoaSl9fX0sdC5wcm90b3R5cGUuX2dldEVmZmVjdGl2ZVRhcmdldD1mdW5jdGlvbihlLHQpe2Zvcih2YXIgaT10LnNwbGl0KFwiLlwiKSxyPTA7cjxpLmxlbmd0aC0xO3IrKyllPWVbaVtyXV07cmV0dXJuIGV9LHQucHJvdG90eXBlLl9nZXRQcm9wZXJ0eT1mdW5jdGlvbihlKXt2YXIgdD1lLnNwbGl0KFwiLlwiKTtyZXR1cm4gdFt0Lmxlbmd0aC0xXX0sdC5wcm90b3R5cGUuc2VyaWFsaXplPWZ1bmN0aW9uKGkpe2Zvcih2YXIgcj17Y2hpbGRyZW46W10sbmFtZTppLHR5cGU6Myxwcm9wZXJ0aWVzOltdfSxuPTA7bjx0aGlzLmFjdGlvbnMubGVuZ3RoO24rKyl7dmFyIG89e3R5cGU6MCxjaGlsZHJlbjpbXSxuYW1lOnQuR2V0VHJpZ2dlck5hbWUodGhpcy5hY3Rpb25zW25dLnRyaWdnZXIpLHByb3BlcnRpZXM6W119LHM9dGhpcy5hY3Rpb25zW25dLnRyaWdnZXJPcHRpb25zO3MmJlwibnVtYmVyXCIhPXR5cGVvZiBzJiYocy5wYXJhbWV0ZXIgaW5zdGFuY2VvZiBlLk5vZGU/by5wcm9wZXJ0aWVzLnB1c2goZS5BY3Rpb24uX0dldFRhcmdldFByb3BlcnR5KHMucGFyYW1ldGVyKSk6by5wcm9wZXJ0aWVzLnB1c2goe25hbWU6XCJwYXJhbWV0ZXJcIix0YXJnZXRUeXBlOm51bGwsdmFsdWU6cy5wYXJhbWV0ZXJ9KSksdGhpcy5hY3Rpb25zW25dLnNlcmlhbGl6ZShvKSxyLmNoaWxkcmVuLnB1c2gobyl9cmV0dXJuIHJ9LHQuUGFyc2U9ZnVuY3Rpb24oaSxyLG4pe3ZhciBvPW5ldyBlLkFjdGlvbk1hbmFnZXIobik7bnVsbD09PXI/bi5hY3Rpb25NYW5hZ2VyPW86ci5hY3Rpb25NYW5hZ2VyPW87Zm9yKHZhciBzPWZ1bmN0aW9uKHQsaSl7dmFyIHI9T2JqZWN0LmNyZWF0ZShlW3RdLnByb3RvdHlwZSk7cmV0dXJuIHIuY29uc3RydWN0b3IuYXBwbHkocixpKSxyfSxhPWZ1bmN0aW9uKHQsaSxyLG4pe2lmKG51bGw9PT1uKXt2YXIgbz1wYXJzZUZsb2F0KGkpO3JldHVyblwidHJ1ZVwiPT09aXx8XCJmYWxzZVwiPT09aT9cInRydWVcIj09PWk6aXNOYU4obyk/aTpvfWZvcih2YXIgcz1uLnNwbGl0KFwiLlwiKSxhPWkuc3BsaXQoXCIsXCIpLGg9MDtoPHMubGVuZ3RoO2grKylyPXJbc1toXV07aWYoXCJib29sZWFuXCI9PXR5cGVvZiByKXJldHVyblwidHJ1ZVwiPT09YVswXTtpZihcInN0cmluZ1wiPT10eXBlb2YgcilyZXR1cm4gYVswXTtmb3IodmFyIGM9bmV3IEFycmF5LGg9MDtoPGEubGVuZ3RoO2grKyljLnB1c2gocGFyc2VGbG9hdChhW2hdKSk7cmV0dXJuIHIgaW5zdGFuY2VvZiBlLlZlY3RvcjM/ZS5WZWN0b3IzLkZyb21BcnJheShjKTpyIGluc3RhbmNlb2YgZS5WZWN0b3I0P2UuVmVjdG9yNC5Gcm9tQXJyYXkoYyk6ciBpbnN0YW5jZW9mIGUuQ29sb3IzP2UuQ29sb3IzLkZyb21BcnJheShjKTpyIGluc3RhbmNlb2YgZS5Db2xvcjQ/ZS5Db2xvcjQuRnJvbUFycmF5KGMpOnBhcnNlRmxvYXQoYVswXSl9LGg9ZnVuY3Rpb24oaSxyLGMsbCx1KXtpZih2b2lkIDA9PT11JiYodT1udWxsKSwhaS5kZXRhY2hlZCl7dmFyIGY9bmV3IEFycmF5LGQ9bnVsbCxwPW51bGwsXz1pLmNvbWJpbmUmJmkuY29tYmluZS5sZW5ndGg+MDtpZigyPT09aS50eXBlP2YucHVzaChvKTpmLnB1c2gociksXyl7Zm9yKHZhciBtPW5ldyBBcnJheSxnPTA7ZzxpLmNvbWJpbmUubGVuZ3RoO2crKyloKGkuY29tYmluZVtnXSx0Lk5vdGhpbmdUcmlnZ2VyLGMsbCxtKTtmLnB1c2gobSl9ZWxzZSBmb3IodmFyIHY9MDt2PGkucHJvcGVydGllcy5sZW5ndGg7disrKXt2YXIgeT1pLnByb3BlcnRpZXNbdl0udmFsdWUseD1pLnByb3BlcnRpZXNbdl0ubmFtZSxiPWkucHJvcGVydGllc1t2XS50YXJnZXRUeXBlO1widGFyZ2V0XCI9PT14P3k9ZD1udWxsIT09YiYmXCJTY2VuZVByb3BlcnRpZXNcIj09PWI/bjpuLmdldE5vZGVCeU5hbWUoeSk6XCJwYXJlbnRcIj09PXg/eT1uLmdldE5vZGVCeU5hbWUoeSk6XCJzb3VuZFwiPT09eD95PW4uZ2V0U291bmRCeU5hbWUoeSk6XCJwcm9wZXJ0eVBhdGhcIiE9PXg/eT0yPT09aS50eXBlJiZcIm9wZXJhdG9yXCI9PT14P2UuVmFsdWVDb25kaXRpb25beV06YSh4LHksZCxcInZhbHVlXCI9PT14P3A6bnVsbCk6cD15LGYucHVzaCh5KX1pZihudWxsPT09dT9mLnB1c2goYyk6Zi5wdXNoKG51bGwpLFwiSW50ZXJwb2xhdGVWYWx1ZUFjdGlvblwiPT09aS5uYW1lKXt2YXIgUD1mW2YubGVuZ3RoLTJdO2ZbZi5sZW5ndGgtMV09UCxmW2YubGVuZ3RoLTJdPWN9dmFyIEE9cyhpLm5hbWUsZik7aWYoQSBpbnN0YW5jZW9mIGUuQ29uZGl0aW9uJiZudWxsIT09Yyl7dmFyIFQ9bmV3IGUuRG9Ob3RoaW5nQWN0aW9uKHIsYyk7bD9sLnRoZW4oVCk6by5yZWdpc3RlckFjdGlvbihUKSxsPVR9bnVsbD09PXU/QSBpbnN0YW5jZW9mIGUuQ29uZGl0aW9uPyhjPUEsQT1sKTooYz1udWxsLGw/bC50aGVuKEEpOm8ucmVnaXN0ZXJBY3Rpb24oQSkpOnUucHVzaChBKTtmb3IodmFyIHY9MDt2PGkuY2hpbGRyZW4ubGVuZ3RoO3YrKyloKGkuY2hpbGRyZW5bdl0scixjLEEsbnVsbCk7XG59fSxjPTA7YzxpLmNoaWxkcmVuLmxlbmd0aDtjKyspe3ZhciBsLHU9aS5jaGlsZHJlbltjXTtpZih1LnByb3BlcnRpZXMubGVuZ3RoPjApe3ZhciBmPXUucHJvcGVydGllc1swXS52YWx1ZSxkPW51bGw9PT11LnByb3BlcnRpZXNbMF0udGFyZ2V0VHlwZT9mOm4uZ2V0TWVzaEJ5TmFtZShmKTtsPXt0cmlnZ2VyOmUuQWN0aW9uTWFuYWdlclt1Lm5hbWVdLHBhcmFtZXRlcjpkfX1lbHNlIGw9ZS5BY3Rpb25NYW5hZ2VyW3UubmFtZV07Zm9yKHZhciBwPTA7cDx1LmNoaWxkcmVuLmxlbmd0aDtwKyspdS5kZXRhY2hlZHx8aCh1LmNoaWxkcmVuW3BdLGwsbnVsbCxudWxsKX19LHQuR2V0VHJpZ2dlck5hbWU9ZnVuY3Rpb24oZSl7c3dpdGNoKGUpe2Nhc2UgMDpyZXR1cm5cIk5vdGhpbmdUcmlnZ2VyXCI7Y2FzZSAxOnJldHVyblwiT25QaWNrVHJpZ2dlclwiO2Nhc2UgMjpyZXR1cm5cIk9uTGVmdFBpY2tUcmlnZ2VyXCI7Y2FzZSAzOnJldHVyblwiT25SaWdodFBpY2tUcmlnZ2VyXCI7Y2FzZSA0OnJldHVyblwiT25DZW50ZXJQaWNrVHJpZ2dlclwiO2Nhc2UgNTpyZXR1cm5cIk9uUGlja0Rvd25UcmlnZ2VyXCI7Y2FzZSA2OnJldHVyblwiT25QaWNrVXBUcmlnZ2VyXCI7Y2FzZSA3OnJldHVyblwiT25Mb25nUHJlc3NUcmlnZ2VyXCI7Y2FzZSA4OnJldHVyblwiT25Qb2ludGVyT3ZlclRyaWdnZXJcIjtjYXNlIDk6cmV0dXJuXCJPblBvaW50ZXJPdXRUcmlnZ2VyXCI7Y2FzZSAxMDpyZXR1cm5cIk9uRXZlcnlGcmFtZVRyaWdnZXJcIjtjYXNlIDExOnJldHVyblwiT25JbnRlcnNlY3Rpb25FbnRlclRyaWdnZXJcIjtjYXNlIDEyOnJldHVyblwiT25JbnRlcnNlY3Rpb25FeGl0VHJpZ2dlclwiO2Nhc2UgMTM6cmV0dXJuXCJPbktleURvd25UcmlnZ2VyXCI7Y2FzZSAxNDpyZXR1cm5cIk9uS2V5VXBUcmlnZ2VyXCI7Y2FzZSAxNTpyZXR1cm5cIk9uUGlja091dFRyaWdnZXJcIjtkZWZhdWx0OnJldHVyblwiXCJ9fSx0Ll9Ob3RoaW5nVHJpZ2dlcj0wLHQuX09uUGlja1RyaWdnZXI9MSx0Ll9PbkxlZnRQaWNrVHJpZ2dlcj0yLHQuX09uUmlnaHRQaWNrVHJpZ2dlcj0zLHQuX09uQ2VudGVyUGlja1RyaWdnZXI9NCx0Ll9PblBpY2tEb3duVHJpZ2dlcj01LHQuX09uUGlja1VwVHJpZ2dlcj02LHQuX09uTG9uZ1ByZXNzVHJpZ2dlcj03LHQuX09uUG9pbnRlck92ZXJUcmlnZ2VyPTgsdC5fT25Qb2ludGVyT3V0VHJpZ2dlcj05LHQuX09uRXZlcnlGcmFtZVRyaWdnZXI9MTAsdC5fT25JbnRlcnNlY3Rpb25FbnRlclRyaWdnZXI9MTEsdC5fT25JbnRlcnNlY3Rpb25FeGl0VHJpZ2dlcj0xMix0Ll9PbktleURvd25UcmlnZ2VyPTEzLHQuX09uS2V5VXBUcmlnZ2VyPTE0LHQuX09uUGlja091dFRyaWdnZXI9MTUsdC5EcmFnTW92ZW1lbnRUaHJlc2hvbGQ9MTAsdC5Mb25nUHJlc3NEZWxheT01MDAsdH0oKTtlLkFjdGlvbk1hbmFnZXI9aX0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gaShlLGkscixuLG8scyxhLGgpe3ZvaWQgMD09PW8mJihvPTFlMyksdC5jYWxsKHRoaXMsZSxzKSx0aGlzLnByb3BlcnR5UGF0aD1yLHRoaXMudmFsdWU9bix0aGlzLmR1cmF0aW9uPW8sdGhpcy5zdG9wT3RoZXJBbmltYXRpb25zPWEsdGhpcy5vbkludGVycG9sYXRpb25Eb25lPWgsdGhpcy5fdGFyZ2V0PXRoaXMuX2VmZmVjdGl2ZVRhcmdldD1pfXJldHVybiBfX2V4dGVuZHMoaSx0KSxpLnByb3RvdHlwZS5fcHJlcGFyZT1mdW5jdGlvbigpe3RoaXMuX2VmZmVjdGl2ZVRhcmdldD10aGlzLl9nZXRFZmZlY3RpdmVUYXJnZXQodGhpcy5fZWZmZWN0aXZlVGFyZ2V0LHRoaXMucHJvcGVydHlQYXRoKSx0aGlzLl9wcm9wZXJ0eT10aGlzLl9nZXRQcm9wZXJ0eSh0aGlzLnByb3BlcnR5UGF0aCl9LGkucHJvdG90eXBlLmV4ZWN1dGU9ZnVuY3Rpb24oKXt2YXIgdCxpPXRoaXMuX2FjdGlvbk1hbmFnZXIuZ2V0U2NlbmUoKSxyPVt7ZnJhbWU6MCx2YWx1ZTp0aGlzLl9lZmZlY3RpdmVUYXJnZXRbdGhpcy5fcHJvcGVydHldfSx7ZnJhbWU6MTAwLHZhbHVlOnRoaXMudmFsdWV9XTtpZihcIm51bWJlclwiPT10eXBlb2YgdGhpcy52YWx1ZSl0PWUuQW5pbWF0aW9uLkFOSU1BVElPTlRZUEVfRkxPQVQ7ZWxzZSBpZih0aGlzLnZhbHVlIGluc3RhbmNlb2YgZS5Db2xvcjMpdD1lLkFuaW1hdGlvbi5BTklNQVRJT05UWVBFX0NPTE9SMztlbHNlIGlmKHRoaXMudmFsdWUgaW5zdGFuY2VvZiBlLlZlY3RvcjMpdD1lLkFuaW1hdGlvbi5BTklNQVRJT05UWVBFX1ZFQ1RPUjM7ZWxzZSBpZih0aGlzLnZhbHVlIGluc3RhbmNlb2YgZS5NYXRyaXgpdD1lLkFuaW1hdGlvbi5BTklNQVRJT05UWVBFX01BVFJJWDtlbHNle2lmKCEodGhpcy52YWx1ZSBpbnN0YW5jZW9mIGUuUXVhdGVybmlvbikpcmV0dXJuIHZvaWQgZS5Ub29scy5XYXJuKFwiSW50ZXJwb2xhdGVWYWx1ZUFjdGlvbjogVW5zdXBwb3J0ZWQgdHlwZSAoXCIrdHlwZW9mIHRoaXMudmFsdWUrXCIpXCIpO3Q9ZS5BbmltYXRpb24uQU5JTUFUSU9OVFlQRV9RVUFURVJOSU9OfXZhciBuPW5ldyBlLkFuaW1hdGlvbihcIkludGVycG9sYXRlVmFsdWVBY3Rpb25cIix0aGlzLl9wcm9wZXJ0eSwxMDAqKDFlMy90aGlzLmR1cmF0aW9uKSx0LGUuQW5pbWF0aW9uLkFOSU1BVElPTkxPT1BNT0RFX0NPTlNUQU5UKTtuLnNldEtleXMociksdGhpcy5zdG9wT3RoZXJBbmltYXRpb25zJiZpLnN0b3BBbmltYXRpb24odGhpcy5fZWZmZWN0aXZlVGFyZ2V0KSxpLmJlZ2luRGlyZWN0QW5pbWF0aW9uKHRoaXMuX2VmZmVjdGl2ZVRhcmdldCxbbl0sMCwxMDAsITEsMSx0aGlzLm9uSW50ZXJwb2xhdGlvbkRvbmUpfSxpLnByb3RvdHlwZS5zZXJpYWxpemU9ZnVuY3Rpb24oaSl7cmV0dXJuIHQucHJvdG90eXBlLl9zZXJpYWxpemUuY2FsbCh0aGlzLHtuYW1lOlwiSW50ZXJwb2xhdGVWYWx1ZUFjdGlvblwiLHByb3BlcnRpZXM6W2UuQWN0aW9uLl9HZXRUYXJnZXRQcm9wZXJ0eSh0aGlzLl90YXJnZXQpLHtuYW1lOlwicHJvcGVydHlQYXRoXCIsdmFsdWU6dGhpcy5wcm9wZXJ0eVBhdGh9LHtuYW1lOlwidmFsdWVcIix2YWx1ZTplLkFjdGlvbi5fU2VyaWFsaXplVmFsdWVBc1N0cmluZyh0aGlzLnZhbHVlKX0se25hbWU6XCJkdXJhdGlvblwiLHZhbHVlOmUuQWN0aW9uLl9TZXJpYWxpemVWYWx1ZUFzU3RyaW5nKHRoaXMuZHVyYXRpb24pfSx7bmFtZTpcInN0b3BPdGhlckFuaW1hdGlvbnNcIix2YWx1ZTplLkFjdGlvbi5fU2VyaWFsaXplVmFsdWVBc1N0cmluZyh0aGlzLnN0b3BPdGhlckFuaW1hdGlvbnMpfHwhMX1dfSxpKX0saX0oZS5BY3Rpb24pO2UuSW50ZXJwb2xhdGVWYWx1ZUFjdGlvbj10fShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbih0KXtmdW5jdGlvbiBpKGUsaSxyLG4pe3QuY2FsbCh0aGlzLGUsbiksdGhpcy5wcm9wZXJ0eVBhdGg9cix0aGlzLl90YXJnZXQ9dGhpcy5fZWZmZWN0aXZlVGFyZ2V0PWl9cmV0dXJuIF9fZXh0ZW5kcyhpLHQpLGkucHJvdG90eXBlLl9wcmVwYXJlPWZ1bmN0aW9uKCl7dGhpcy5fZWZmZWN0aXZlVGFyZ2V0PXRoaXMuX2dldEVmZmVjdGl2ZVRhcmdldCh0aGlzLl9lZmZlY3RpdmVUYXJnZXQsdGhpcy5wcm9wZXJ0eVBhdGgpLHRoaXMuX3Byb3BlcnR5PXRoaXMuX2dldFByb3BlcnR5KHRoaXMucHJvcGVydHlQYXRoKX0saS5wcm90b3R5cGUuZXhlY3V0ZT1mdW5jdGlvbigpe3RoaXMuX2VmZmVjdGl2ZVRhcmdldFt0aGlzLl9wcm9wZXJ0eV09IXRoaXMuX2VmZmVjdGl2ZVRhcmdldFt0aGlzLl9wcm9wZXJ0eV19LGkucHJvdG90eXBlLnNlcmlhbGl6ZT1mdW5jdGlvbihpKXtyZXR1cm4gdC5wcm90b3R5cGUuX3NlcmlhbGl6ZS5jYWxsKHRoaXMse25hbWU6XCJTd2l0Y2hCb29sZWFuQWN0aW9uXCIscHJvcGVydGllczpbZS5BY3Rpb24uX0dldFRhcmdldFByb3BlcnR5KHRoaXMuX3RhcmdldCkse25hbWU6XCJwcm9wZXJ0eVBhdGhcIix2YWx1ZTp0aGlzLnByb3BlcnR5UGF0aH1dfSxpKX0saX0oZS5BY3Rpb24pO2UuU3dpdGNoQm9vbGVhbkFjdGlvbj10O3ZhciBpPWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGkoZSxpLHIsbil7dC5jYWxsKHRoaXMsZSxuKSx0aGlzLnZhbHVlPXIsdGhpcy5fdGFyZ2V0PWl9cmV0dXJuIF9fZXh0ZW5kcyhpLHQpLGkucHJvdG90eXBlLmV4ZWN1dGU9ZnVuY3Rpb24oKXt0aGlzLl90YXJnZXQuc3RhdGU9dGhpcy52YWx1ZX0saS5wcm90b3R5cGUuc2VyaWFsaXplPWZ1bmN0aW9uKGkpe3JldHVybiB0LnByb3RvdHlwZS5fc2VyaWFsaXplLmNhbGwodGhpcyx7bmFtZTpcIlNldFN0YXRlQWN0aW9uXCIscHJvcGVydGllczpbZS5BY3Rpb24uX0dldFRhcmdldFByb3BlcnR5KHRoaXMuX3RhcmdldCkse25hbWU6XCJ2YWx1ZVwiLHZhbHVlOnRoaXMudmFsdWV9XX0saSl9LGl9KGUuQWN0aW9uKTtlLlNldFN0YXRlQWN0aW9uPWk7dmFyIHI9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gaShlLGkscixuLG8pe3QuY2FsbCh0aGlzLGUsbyksdGhpcy5wcm9wZXJ0eVBhdGg9cix0aGlzLnZhbHVlPW4sdGhpcy5fdGFyZ2V0PXRoaXMuX2VmZmVjdGl2ZVRhcmdldD1pfXJldHVybiBfX2V4dGVuZHMoaSx0KSxpLnByb3RvdHlwZS5fcHJlcGFyZT1mdW5jdGlvbigpe3RoaXMuX2VmZmVjdGl2ZVRhcmdldD10aGlzLl9nZXRFZmZlY3RpdmVUYXJnZXQodGhpcy5fZWZmZWN0aXZlVGFyZ2V0LHRoaXMucHJvcGVydHlQYXRoKSx0aGlzLl9wcm9wZXJ0eT10aGlzLl9nZXRQcm9wZXJ0eSh0aGlzLnByb3BlcnR5UGF0aCl9LGkucHJvdG90eXBlLmV4ZWN1dGU9ZnVuY3Rpb24oKXt0aGlzLl9lZmZlY3RpdmVUYXJnZXRbdGhpcy5fcHJvcGVydHldPXRoaXMudmFsdWUsdGhpcy5fdGFyZ2V0Lm1hcmtBc0RpcnR5JiZ0aGlzLl90YXJnZXQubWFya0FzRGlydHkodGhpcy5fcHJvcGVydHkpfSxpLnByb3RvdHlwZS5zZXJpYWxpemU9ZnVuY3Rpb24oaSl7cmV0dXJuIHQucHJvdG90eXBlLl9zZXJpYWxpemUuY2FsbCh0aGlzLHtuYW1lOlwiU2V0VmFsdWVBY3Rpb25cIixwcm9wZXJ0aWVzOltlLkFjdGlvbi5fR2V0VGFyZ2V0UHJvcGVydHkodGhpcy5fdGFyZ2V0KSx7bmFtZTpcInByb3BlcnR5UGF0aFwiLHZhbHVlOnRoaXMucHJvcGVydHlQYXRofSx7bmFtZTpcInZhbHVlXCIsdmFsdWU6ZS5BY3Rpb24uX1NlcmlhbGl6ZVZhbHVlQXNTdHJpbmcodGhpcy52YWx1ZSl9XX0saSl9LGl9KGUuQWN0aW9uKTtlLlNldFZhbHVlQWN0aW9uPXI7dmFyIG49ZnVuY3Rpb24odCl7ZnVuY3Rpb24gaShlLGkscixuLG8pe3QuY2FsbCh0aGlzLGUsbyksdGhpcy5wcm9wZXJ0eVBhdGg9cix0aGlzLnZhbHVlPW4sdGhpcy5fdGFyZ2V0PXRoaXMuX2VmZmVjdGl2ZVRhcmdldD1pfXJldHVybiBfX2V4dGVuZHMoaSx0KSxpLnByb3RvdHlwZS5fcHJlcGFyZT1mdW5jdGlvbigpe3RoaXMuX2VmZmVjdGl2ZVRhcmdldD10aGlzLl9nZXRFZmZlY3RpdmVUYXJnZXQodGhpcy5fZWZmZWN0aXZlVGFyZ2V0LHRoaXMucHJvcGVydHlQYXRoKSx0aGlzLl9wcm9wZXJ0eT10aGlzLl9nZXRQcm9wZXJ0eSh0aGlzLnByb3BlcnR5UGF0aCksXCJudW1iZXJcIiE9dHlwZW9mIHRoaXMuX2VmZmVjdGl2ZVRhcmdldFt0aGlzLl9wcm9wZXJ0eV0mJmUuVG9vbHMuV2FybihcIldhcm5pbmc6IEluY3JlbWVudFZhbHVlQWN0aW9uIGNhbiBvbmx5IGJlIHVzZWQgd2l0aCBudW1iZXIgdmFsdWVzXCIpfSxpLnByb3RvdHlwZS5leGVjdXRlPWZ1bmN0aW9uKCl7dGhpcy5fZWZmZWN0aXZlVGFyZ2V0W3RoaXMuX3Byb3BlcnR5XSs9dGhpcy52YWx1ZSx0aGlzLl90YXJnZXQubWFya0FzRGlydHkmJnRoaXMuX3RhcmdldC5tYXJrQXNEaXJ0eSh0aGlzLl9wcm9wZXJ0eSl9LGkucHJvdG90eXBlLnNlcmlhbGl6ZT1mdW5jdGlvbihpKXtyZXR1cm4gdC5wcm90b3R5cGUuX3NlcmlhbGl6ZS5jYWxsKHRoaXMse25hbWU6XCJJbmNyZW1lbnRWYWx1ZUFjdGlvblwiLHByb3BlcnRpZXM6W2UuQWN0aW9uLl9HZXRUYXJnZXRQcm9wZXJ0eSh0aGlzLl90YXJnZXQpLHtuYW1lOlwicHJvcGVydHlQYXRoXCIsdmFsdWU6dGhpcy5wcm9wZXJ0eVBhdGh9LHtuYW1lOlwidmFsdWVcIix2YWx1ZTplLkFjdGlvbi5fU2VyaWFsaXplVmFsdWVBc1N0cmluZyh0aGlzLnZhbHVlKX1dfSxpKX0saX0oZS5BY3Rpb24pO2UuSW5jcmVtZW50VmFsdWVBY3Rpb249bjt2YXIgbz1mdW5jdGlvbih0KXtmdW5jdGlvbiBpKGUsaSxyLG4sbyxzKXt0LmNhbGwodGhpcyxlLHMpLHRoaXMuZnJvbT1yLHRoaXMudG89bix0aGlzLmxvb3A9byx0aGlzLl90YXJnZXQ9aX1yZXR1cm4gX19leHRlbmRzKGksdCksaS5wcm90b3R5cGUuX3ByZXBhcmU9ZnVuY3Rpb24oKXt9LGkucHJvdG90eXBlLmV4ZWN1dGU9ZnVuY3Rpb24oKXt2YXIgZT10aGlzLl9hY3Rpb25NYW5hZ2VyLmdldFNjZW5lKCk7ZS5iZWdpbkFuaW1hdGlvbih0aGlzLl90YXJnZXQsdGhpcy5mcm9tLHRoaXMudG8sdGhpcy5sb29wKX0saS5wcm90b3R5cGUuc2VyaWFsaXplPWZ1bmN0aW9uKGkpe3JldHVybiB0LnByb3RvdHlwZS5fc2VyaWFsaXplLmNhbGwodGhpcyx7bmFtZTpcIlBsYXlBbmltYXRpb25BY3Rpb25cIixwcm9wZXJ0aWVzOltlLkFjdGlvbi5fR2V0VGFyZ2V0UHJvcGVydHkodGhpcy5fdGFyZ2V0KSx7bmFtZTpcImZyb21cIix2YWx1ZTpTdHJpbmcodGhpcy5mcm9tKX0se25hbWU6XCJ0b1wiLHZhbHVlOlN0cmluZyh0aGlzLnRvKX0se25hbWU6XCJsb29wXCIsdmFsdWU6ZS5BY3Rpb24uX1NlcmlhbGl6ZVZhbHVlQXNTdHJpbmcodGhpcy5sb29wKXx8ITF9XX0saSl9LGl9KGUuQWN0aW9uKTtlLlBsYXlBbmltYXRpb25BY3Rpb249bzt2YXIgcz1mdW5jdGlvbih0KXtmdW5jdGlvbiBpKGUsaSxyKXt0LmNhbGwodGhpcyxlLHIpLHRoaXMuX3RhcmdldD1pfXJldHVybiBfX2V4dGVuZHMoaSx0KSxpLnByb3RvdHlwZS5fcHJlcGFyZT1mdW5jdGlvbigpe30saS5wcm90b3R5cGUuZXhlY3V0ZT1mdW5jdGlvbigpe3ZhciBlPXRoaXMuX2FjdGlvbk1hbmFnZXIuZ2V0U2NlbmUoKTtlLnN0b3BBbmltYXRpb24odGhpcy5fdGFyZ2V0KX0saS5wcm90b3R5cGUuc2VyaWFsaXplPWZ1bmN0aW9uKGkpe3JldHVybiB0LnByb3RvdHlwZS5fc2VyaWFsaXplLmNhbGwodGhpcyx7bmFtZTpcIlN0b3BBbmltYXRpb25BY3Rpb25cIixwcm9wZXJ0aWVzOltlLkFjdGlvbi5fR2V0VGFyZ2V0UHJvcGVydHkodGhpcy5fdGFyZ2V0KV19LGkpfSxpfShlLkFjdGlvbik7ZS5TdG9wQW5pbWF0aW9uQWN0aW9uPXM7dmFyIGE9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gaShpLHIpe3ZvaWQgMD09PWkmJihpPWUuQWN0aW9uTWFuYWdlci5Ob3RoaW5nVHJpZ2dlciksdC5jYWxsKHRoaXMsaSxyKX1yZXR1cm4gX19leHRlbmRzKGksdCksaS5wcm90b3R5cGUuZXhlY3V0ZT1mdW5jdGlvbigpe30saS5wcm90b3R5cGUuc2VyaWFsaXplPWZ1bmN0aW9uKGUpe3JldHVybiB0LnByb3RvdHlwZS5fc2VyaWFsaXplLmNhbGwodGhpcyx7bmFtZTpcIkRvTm90aGluZ0FjdGlvblwiLHByb3BlcnRpZXM6W119LGUpfSxpfShlLkFjdGlvbik7ZS5Eb05vdGhpbmdBY3Rpb249YTt2YXIgaD1mdW5jdGlvbihlKXtmdW5jdGlvbiB0KHQsaSxyKXtlLmNhbGwodGhpcyx0LHIpLHRoaXMuY2hpbGRyZW49aX1yZXR1cm4gX19leHRlbmRzKHQsZSksdC5wcm90b3R5cGUuX3ByZXBhcmU9ZnVuY3Rpb24oKXtmb3IodmFyIGU9MDtlPHRoaXMuY2hpbGRyZW4ubGVuZ3RoO2UrKyl0aGlzLmNoaWxkcmVuW2VdLl9hY3Rpb25NYW5hZ2VyPXRoaXMuX2FjdGlvbk1hbmFnZXIsdGhpcy5jaGlsZHJlbltlXS5fcHJlcGFyZSgpfSx0LnByb3RvdHlwZS5leGVjdXRlPWZ1bmN0aW9uKGUpe2Zvcih2YXIgdD0wO3Q8dGhpcy5jaGlsZHJlbi5sZW5ndGg7dCsrKXRoaXMuY2hpbGRyZW5bdF0uZXhlY3V0ZShlKX0sdC5wcm90b3R5cGUuc2VyaWFsaXplPWZ1bmN0aW9uKHQpe2Zvcih2YXIgaT1lLnByb3RvdHlwZS5fc2VyaWFsaXplLmNhbGwodGhpcyx7bmFtZTpcIkNvbWJpbmVBY3Rpb25cIixwcm9wZXJ0aWVzOltdLGNvbWJpbmU6W119LHQpLHI9MDtyPHRoaXMuY2hpbGRyZW4ubGVuZ3RoO3IrKylpLmNvbWJpbmUucHVzaCh0aGlzLmNoaWxkcmVuW3JdLnNlcmlhbGl6ZShudWxsKSk7cmV0dXJuIGl9LHR9KGUuQWN0aW9uKTtlLkNvbWJpbmVBY3Rpb249aDt2YXIgYz1mdW5jdGlvbihlKXtmdW5jdGlvbiB0KHQsaSxyKXtlLmNhbGwodGhpcyx0LHIpLHRoaXMuZnVuYz1pfXJldHVybiBfX2V4dGVuZHModCxlKSx0LnByb3RvdHlwZS5leGVjdXRlPWZ1bmN0aW9uKGUpe3RoaXMuZnVuYyhlKX0sdH0oZS5BY3Rpb24pO2UuRXhlY3V0ZUNvZGVBY3Rpb249Yzt2YXIgbD1mdW5jdGlvbih0KXtmdW5jdGlvbiBpKGUsaSxyLG4pe3QuY2FsbCh0aGlzLGUsbiksdGhpcy5fdGFyZ2V0PWksdGhpcy5fcGFyZW50PXJ9cmV0dXJuIF9fZXh0ZW5kcyhpLHQpLGkucHJvdG90eXBlLl9wcmVwYXJlPWZ1bmN0aW9uKCl7fSxpLnByb3RvdHlwZS5leGVjdXRlPWZ1bmN0aW9uKCl7aWYodGhpcy5fdGFyZ2V0LnBhcmVudCE9PXRoaXMuX3BhcmVudCl7dmFyIHQ9dGhpcy5fcGFyZW50LmdldFdvcmxkTWF0cml4KCkuY2xvbmUoKTt0LmludmVydCgpLHRoaXMuX3RhcmdldC5wb3NpdGlvbj1lLlZlY3RvcjMuVHJhbnNmb3JtQ29vcmRpbmF0ZXModGhpcy5fdGFyZ2V0LnBvc2l0aW9uLHQpLHRoaXMuX3RhcmdldC5wYXJlbnQ9dGhpcy5fcGFyZW50fX0saS5wcm90b3R5cGUuc2VyaWFsaXplPWZ1bmN0aW9uKGkpe3JldHVybiB0LnByb3RvdHlwZS5fc2VyaWFsaXplLmNhbGwodGhpcyx7bmFtZTpcIlNldFBhcmVudEFjdGlvblwiLHByb3BlcnRpZXM6W2UuQWN0aW9uLl9HZXRUYXJnZXRQcm9wZXJ0eSh0aGlzLl90YXJnZXQpLGUuQWN0aW9uLl9HZXRUYXJnZXRQcm9wZXJ0eSh0aGlzLl9wYXJlbnQpXX0saSl9LGl9KGUuQWN0aW9uKTtlLlNldFBhcmVudEFjdGlvbj1sO3ZhciB1PWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQodCxpLHIpe2UuY2FsbCh0aGlzLHQsciksdGhpcy5fc291bmQ9aX1yZXR1cm4gX19leHRlbmRzKHQsZSksdC5wcm90b3R5cGUuX3ByZXBhcmU9ZnVuY3Rpb24oKXt9LHQucHJvdG90eXBlLmV4ZWN1dGU9ZnVuY3Rpb24oKXt2b2lkIDAhPT10aGlzLl9zb3VuZCYmdGhpcy5fc291bmQucGxheSgpfSx0LnByb3RvdHlwZS5zZXJpYWxpemU9ZnVuY3Rpb24odCl7cmV0dXJuIGUucHJvdG90eXBlLl9zZXJpYWxpemUuY2FsbCh0aGlzLHtuYW1lOlwiUGxheVNvdW5kQWN0aW9uXCIscHJvcGVydGllczpbe25hbWU6XCJzb3VuZFwiLHZhbHVlOnRoaXMuX3NvdW5kLm5hbWV9XX0sdCl9LHR9KGUuQWN0aW9uKTtlLlBsYXlTb3VuZEFjdGlvbj11O3ZhciBmPWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQodCxpLHIpe2UuY2FsbCh0aGlzLHQsciksdGhpcy5fc291bmQ9aX1yZXR1cm4gX19leHRlbmRzKHQsZSksdC5wcm90b3R5cGUuX3ByZXBhcmU9ZnVuY3Rpb24oKXt9LHQucHJvdG90eXBlLmV4ZWN1dGU9ZnVuY3Rpb24oKXt2b2lkIDAhPT10aGlzLl9zb3VuZCYmdGhpcy5fc291bmQuc3RvcCgpfSx0LnByb3RvdHlwZS5zZXJpYWxpemU9ZnVuY3Rpb24odCl7cmV0dXJuIGUucHJvdG90eXBlLl9zZXJpYWxpemUuY2FsbCh0aGlzLHtuYW1lOlwiU3RvcFNvdW5kQWN0aW9uXCIscHJvcGVydGllczpbe25hbWU6XCJzb3VuZFwiLHZhbHVlOnRoaXMuX3NvdW5kLm5hbWV9XX0sdCl9LHR9KGUuQWN0aW9uKTtlLlN0b3BTb3VuZEFjdGlvbj1mfShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCxpLHIsbixvKXt0aGlzLmRlbGF5TG9hZFN0YXRlPWUuRW5naW5lLkRFTEFZTE9BRFNUQVRFX05PTkUsdGhpcy5fdG90YWxWZXJ0aWNlcz0wLHRoaXMuX2lzRGlzcG9zZWQ9ITEsdGhpcy5pZD10LHRoaXMuX2VuZ2luZT1pLmdldEVuZ2luZSgpLHRoaXMuX21lc2hlcz1bXSx0aGlzLl9zY2VuZT1pLHRoaXMuX3ZlcnRleEJ1ZmZlcnM9e30sdGhpcy5faW5kaWNlcz1bXSxyP3RoaXMuc2V0QWxsVmVydGljZXNEYXRhKHIsbik6KHRoaXMuX3RvdGFsVmVydGljZXM9MCx0aGlzLl9pbmRpY2VzPVtdKSxvJiYobyBpbnN0YW5jZW9mIGUuTGluZXNNZXNoJiYodGhpcy5ib3VuZGluZ0JpYXM9bmV3IGUuVmVjdG9yMigwLG8uaW50ZXJzZWN0aW9uVGhyZXNob2xkKSx0aGlzLnVwZGF0ZUV4dGVuZCgpKSx0aGlzLmFwcGx5VG9NZXNoKG8pLG8uY29tcHV0ZVdvcmxkTWF0cml4KCEwKSl9cmV0dXJuIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcImJvdW5kaW5nQmlhc1wiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fYm91bmRpbmdCaWFzfSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fYm91bmRpbmdCaWFzJiZ0aGlzLl9ib3VuZGluZ0JpYXMuZXF1YWxzKGUpfHwodGhpcy5fYm91bmRpbmdCaWFzPWUuY2xvbmUoKSx0aGlzLnVwZGF0ZUJvdW5kaW5nSW5mbyghMCxudWxsKSl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwiZXh0ZW5kXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9leHRlbmR9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksdC5wcm90b3R5cGUuZ2V0U2NlbmU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc2NlbmV9LHQucHJvdG90eXBlLmdldEVuZ2luZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9lbmdpbmV9LHQucHJvdG90eXBlLmlzUmVhZHk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kZWxheUxvYWRTdGF0ZT09PWUuRW5naW5lLkRFTEFZTE9BRFNUQVRFX0xPQURFRHx8dGhpcy5kZWxheUxvYWRTdGF0ZT09PWUuRW5naW5lLkRFTEFZTE9BRFNUQVRFX05PTkV9LHQucHJvdG90eXBlLnNldEFsbFZlcnRpY2VzRGF0YT1mdW5jdGlvbihlLHQpe2UuYXBwbHlUb0dlb21ldHJ5KHRoaXMsdCksdGhpcy5ub3RpZnlVcGRhdGUoKX0sdC5wcm90b3R5cGUuc2V0VmVydGljZXNEYXRhPWZ1bmN0aW9uKHQsaSxyLG4pe3ZhciBvPW5ldyBlLlZlcnRleEJ1ZmZlcih0aGlzLl9lbmdpbmUsaSx0LHIsMD09PXRoaXMuX21lc2hlcy5sZW5ndGgsbik7dGhpcy5zZXRWZXJ0aWNlc0J1ZmZlcihvKX0sdC5wcm90b3R5cGUuc2V0VmVydGljZXNCdWZmZXI9ZnVuY3Rpb24odCl7dmFyIGk9dC5nZXRLaW5kKCk7aWYodGhpcy5fdmVydGV4QnVmZmVyc1tpXSYmdGhpcy5fdmVydGV4QnVmZmVyc1tpXS5kaXNwb3NlKCksdGhpcy5fdmVydGV4QnVmZmVyc1tpXT10LGk9PT1lLlZlcnRleEJ1ZmZlci5Qb3NpdGlvbktpbmQpe3ZhciByPXQuZ2V0RGF0YSgpLG49dC5nZXRTdHJpZGVTaXplKCk7dGhpcy5fdG90YWxWZXJ0aWNlcz1yLmxlbmd0aC9uLHRoaXMudXBkYXRlRXh0ZW5kKHIsbik7Zm9yKHZhciBvPXRoaXMuX21lc2hlcyxzPW8ubGVuZ3RoLGE9MDtzPmE7YSsrKXt2YXIgaD1vW2FdO2guX3Jlc2V0UG9pbnRzQXJyYXlDYWNoZSgpLGguX2JvdW5kaW5nSW5mbz1uZXcgZS5Cb3VuZGluZ0luZm8odGhpcy5fZXh0ZW5kLm1pbmltdW0sdGhpcy5fZXh0ZW5kLm1heGltdW0pLGguX2NyZWF0ZUdsb2JhbFN1Yk1lc2goKSxoLmNvbXB1dGVXb3JsZE1hdHJpeCghMCl9fXRoaXMubm90aWZ5VXBkYXRlKGkpfSx0LnByb3RvdHlwZS51cGRhdGVWZXJ0aWNlc0RhdGFEaXJlY3RseT1mdW5jdGlvbihlLHQsaSl7dmFyIHI9dGhpcy5nZXRWZXJ0ZXhCdWZmZXIoZSk7ciYmKHIudXBkYXRlRGlyZWN0bHkodCxpKSx0aGlzLm5vdGlmeVVwZGF0ZShlKSl9LHQucHJvdG90eXBlLnVwZGF0ZVZlcnRpY2VzRGF0YT1mdW5jdGlvbih0LGkscil7dmFyIG49dGhpcy5nZXRWZXJ0ZXhCdWZmZXIodCk7aWYobil7aWYobi51cGRhdGUoaSksdD09PWUuVmVydGV4QnVmZmVyLlBvc2l0aW9uS2luZCl7dmFyIG89bi5nZXRTdHJpZGVTaXplKCk7dGhpcy5fdG90YWxWZXJ0aWNlcz1pLmxlbmd0aC9vLHRoaXMudXBkYXRlQm91bmRpbmdJbmZvKHIsaSl9dGhpcy5ub3RpZnlVcGRhdGUodCl9fSx0LnByb3RvdHlwZS51cGRhdGVCb3VuZGluZ0luZm89ZnVuY3Rpb24odCxpKXt0JiZ0aGlzLnVwZGF0ZUV4dGVuZChpKTtmb3IodmFyIHI9dGhpcy5fbWVzaGVzLG49ci5sZW5ndGgsbz0wO24+bztvKyspe3ZhciBzPXJbb107aWYocy5fcmVzZXRQb2ludHNBcnJheUNhY2hlKCksdCl7cy5fYm91bmRpbmdJbmZvPW5ldyBlLkJvdW5kaW5nSW5mbyh0aGlzLl9leHRlbmQubWluaW11bSx0aGlzLl9leHRlbmQubWF4aW11bSk7Zm9yKHZhciBhPTA7YTxzLnN1Yk1lc2hlcy5sZW5ndGg7YSsrKXt2YXIgaD1zLnN1Yk1lc2hlc1thXTtoLnJlZnJlc2hCb3VuZGluZ0luZm8oKX19fX0sdC5wcm90b3R5cGUuZ2V0VG90YWxWZXJ0aWNlcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmlzUmVhZHkoKT90aGlzLl90b3RhbFZlcnRpY2VzOjB9LHQucHJvdG90eXBlLmdldFZlcnRpY2VzRGF0YT1mdW5jdGlvbihlLHQpe3ZhciBpPXRoaXMuZ2V0VmVydGV4QnVmZmVyKGUpO2lmKCFpKXJldHVybiBudWxsO3ZhciByPWkuZ2V0RGF0YSgpO2lmKHQmJjEhPT10aGlzLl9tZXNoZXMubGVuZ3RoKXtmb3IodmFyIG49ci5sZW5ndGgsbz1bXSxzPTA7bj5zO3MrKylvLnB1c2gocltzXSk7cmV0dXJuIG99cmV0dXJuIHJ9LHQucHJvdG90eXBlLmdldFZlcnRleEJ1ZmZlcj1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5pc1JlYWR5KCk/dGhpcy5fdmVydGV4QnVmZmVyc1tlXTpudWxsfSx0LnByb3RvdHlwZS5nZXRWZXJ0ZXhCdWZmZXJzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaXNSZWFkeSgpP3RoaXMuX3ZlcnRleEJ1ZmZlcnM6bnVsbH0sdC5wcm90b3R5cGUuaXNWZXJ0aWNlc0RhdGFQcmVzZW50PWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl92ZXJ0ZXhCdWZmZXJzP3ZvaWQgMCE9PXRoaXMuX3ZlcnRleEJ1ZmZlcnNbZV06dGhpcy5fZGVsYXlJbmZvPy0xIT09dGhpcy5fZGVsYXlJbmZvLmluZGV4T2YoZSk6ITF9LHQucHJvdG90eXBlLmdldFZlcnRpY2VzRGF0YUtpbmRzPWZ1bmN0aW9uKCl7dmFyIGUsdD1bXTtpZighdGhpcy5fdmVydGV4QnVmZmVycyYmdGhpcy5fZGVsYXlJbmZvKWZvcihlIGluIHRoaXMuX2RlbGF5SW5mbyl0LnB1c2goZSk7ZWxzZSBmb3IoZSBpbiB0aGlzLl92ZXJ0ZXhCdWZmZXJzKXQucHVzaChlKTtyZXR1cm4gdH0sdC5wcm90b3R5cGUuc2V0SW5kaWNlcz1mdW5jdGlvbihlLHQpe3RoaXMuX2luZGV4QnVmZmVyJiZ0aGlzLl9lbmdpbmUuX3JlbGVhc2VCdWZmZXIodGhpcy5faW5kZXhCdWZmZXIpLHRoaXMuX2luZGljZXM9ZSwwIT09dGhpcy5fbWVzaGVzLmxlbmd0aCYmdGhpcy5faW5kaWNlcyYmKHRoaXMuX2luZGV4QnVmZmVyPXRoaXMuX2VuZ2luZS5jcmVhdGVJbmRleEJ1ZmZlcih0aGlzLl9pbmRpY2VzKSksdm9pZCAwIT09dCYmKHRoaXMuX3RvdGFsVmVydGljZXM9dCk7Zm9yKHZhciBpPXRoaXMuX21lc2hlcyxyPWkubGVuZ3RoLG49MDtyPm47bisrKWlbbl0uX2NyZWF0ZUdsb2JhbFN1Yk1lc2goKTt0aGlzLm5vdGlmeVVwZGF0ZSgpfSx0LnByb3RvdHlwZS5nZXRUb3RhbEluZGljZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pc1JlYWR5KCk/dGhpcy5faW5kaWNlcy5sZW5ndGg6MH0sdC5wcm90b3R5cGUuZ2V0SW5kaWNlcz1mdW5jdGlvbihlKXtpZighdGhpcy5pc1JlYWR5KCkpcmV0dXJuIG51bGw7dmFyIHQ9dGhpcy5faW5kaWNlcztpZihlJiYxIT09dGhpcy5fbWVzaGVzLmxlbmd0aCl7Zm9yKHZhciBpPXQubGVuZ3RoLHI9W10sbj0wO2k+bjtuKyspci5wdXNoKHRbbl0pO3JldHVybiByfXJldHVybiB0fSx0LnByb3RvdHlwZS5nZXRJbmRleEJ1ZmZlcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmlzUmVhZHkoKT90aGlzLl9pbmRleEJ1ZmZlcjpudWxsfSx0LnByb3RvdHlwZS5yZWxlYXNlRm9yTWVzaD1mdW5jdGlvbihlLHQpe3ZhciBpPXRoaXMuX21lc2hlcyxyPWkuaW5kZXhPZihlKTtpZigtMSE9PXIpe2Zvcih2YXIgbiBpbiB0aGlzLl92ZXJ0ZXhCdWZmZXJzKXRoaXMuX3ZlcnRleEJ1ZmZlcnNbbl0uZGlzcG9zZSgpO3RoaXMuX2luZGV4QnVmZmVyJiZ0aGlzLl9lbmdpbmUuX3JlbGVhc2VCdWZmZXIodGhpcy5faW5kZXhCdWZmZXIpJiYodGhpcy5faW5kZXhCdWZmZXI9bnVsbCksaS5zcGxpY2UociwxKSxlLl9nZW9tZXRyeT1udWxsLDA9PT1pLmxlbmd0aCYmdCYmdGhpcy5kaXNwb3NlKCl9fSx0LnByb3RvdHlwZS5hcHBseVRvTWVzaD1mdW5jdGlvbihlKXtpZihlLl9nZW9tZXRyeSE9PXRoaXMpe3ZhciB0PWUuX2dlb21ldHJ5O3QmJnQucmVsZWFzZUZvck1lc2goZSk7dmFyIGk9dGhpcy5fbWVzaGVzO2UuX2dlb21ldHJ5PXRoaXMsdGhpcy5fc2NlbmUucHVzaEdlb21ldHJ5KHRoaXMpLGkucHVzaChlKSx0aGlzLmlzUmVhZHkoKT90aGlzLl9hcHBseVRvTWVzaChlKTplLl9ib3VuZGluZ0luZm89dGhpcy5fYm91bmRpbmdJbmZvfX0sdC5wcm90b3R5cGUudXBkYXRlRXh0ZW5kPWZ1bmN0aW9uKHQsaSl7dm9pZCAwPT09dCYmKHQ9bnVsbCksdHx8KHQ9dGhpcy5fdmVydGV4QnVmZmVyc1tlLlZlcnRleEJ1ZmZlci5Qb3NpdGlvbktpbmRdLmdldERhdGEoKSksdGhpcy5fZXh0ZW5kPWUuVG9vbHMuRXh0cmFjdE1pbkFuZE1heCh0LDAsdGhpcy5fdG90YWxWZXJ0aWNlcyx0aGlzLmJvdW5kaW5nQmlhcyxpKX0sdC5wcm90b3R5cGUuX2FwcGx5VG9NZXNoPWZ1bmN0aW9uKHQpe3ZhciBpPXRoaXMuX21lc2hlcy5sZW5ndGg7Zm9yKHZhciByIGluIHRoaXMuX3ZlcnRleEJ1ZmZlcnMpMT09PWkmJnRoaXMuX3ZlcnRleEJ1ZmZlcnNbcl0uY3JlYXRlKCksdGhpcy5fdmVydGV4QnVmZmVyc1tyXS5nZXRCdWZmZXIoKS5yZWZlcmVuY2VzPWkscj09PWUuVmVydGV4QnVmZmVyLlBvc2l0aW9uS2luZCYmKHQuX3Jlc2V0UG9pbnRzQXJyYXlDYWNoZSgpLHRoaXMuX2V4dGVuZHx8dGhpcy51cGRhdGVFeHRlbmQodGhpcy5fdmVydGV4QnVmZmVyc1tyXS5nZXREYXRhKCkpLHQuX2JvdW5kaW5nSW5mbz1uZXcgZS5Cb3VuZGluZ0luZm8odGhpcy5fZXh0ZW5kLm1pbmltdW0sdGhpcy5fZXh0ZW5kLm1heGltdW0pLHQuX2NyZWF0ZUdsb2JhbFN1Yk1lc2goKSx0Ll91cGRhdGVCb3VuZGluZ0luZm8oKSk7MT09PWkmJnRoaXMuX2luZGljZXMmJnRoaXMuX2luZGljZXMubGVuZ3RoPjAmJih0aGlzLl9pbmRleEJ1ZmZlcj10aGlzLl9lbmdpbmUuY3JlYXRlSW5kZXhCdWZmZXIodGhpcy5faW5kaWNlcykpLHRoaXMuX2luZGV4QnVmZmVyJiYodGhpcy5faW5kZXhCdWZmZXIucmVmZXJlbmNlcz1pKX0sdC5wcm90b3R5cGUubm90aWZ5VXBkYXRlPWZ1bmN0aW9uKGUpe3RoaXMub25HZW9tZXRyeVVwZGF0ZWQmJnRoaXMub25HZW9tZXRyeVVwZGF0ZWQodGhpcyxlKX0sdC5wcm90b3R5cGUubG9hZD1mdW5jdGlvbih0LGkpe3ZhciByPXRoaXM7aWYodGhpcy5kZWxheUxvYWRTdGF0ZSE9PWUuRW5naW5lLkRFTEFZTE9BRFNUQVRFX0xPQURJTkcpe2lmKHRoaXMuaXNSZWFkeSgpKXJldHVybiB2b2lkKGkmJmkoKSk7dGhpcy5kZWxheUxvYWRTdGF0ZT1lLkVuZ2luZS5ERUxBWUxPQURTVEFURV9MT0FESU5HLHQuX2FkZFBlbmRpbmdEYXRhKHRoaXMpLGUuVG9vbHMuTG9hZEZpbGUodGhpcy5kZWxheUxvYWRpbmdGaWxlLGZ1bmN0aW9uKG4pe3IuX2RlbGF5TG9hZGluZ0Z1bmN0aW9uKEpTT04ucGFyc2Uobiksciksci5kZWxheUxvYWRTdGF0ZT1lLkVuZ2luZS5ERUxBWUxPQURTVEFURV9MT0FERUQsci5fZGVsYXlJbmZvPVtdLHQuX3JlbW92ZVBlbmRpbmdEYXRhKHIpO2Zvcih2YXIgbz1yLl9tZXNoZXMscz1vLmxlbmd0aCxhPTA7cz5hO2ErKylyLl9hcHBseVRvTWVzaChvW2FdKTtpJiZpKCl9LGZ1bmN0aW9uKCl7fSx0LmRhdGFiYXNlKX19LHQucHJvdG90eXBlLnRvTGVmdEhhbmRlZD1mdW5jdGlvbigpe3ZhciB0PXRoaXMuZ2V0SW5kaWNlcyghMSk7aWYobnVsbCE9dCYmdC5sZW5ndGg+MCl7Zm9yKHZhciBpPTA7aTx0Lmxlbmd0aDtpKz0zKXt2YXIgcj10W2krMF07dFtpKzBdPXRbaSsyXSx0W2krMl09cn10aGlzLnNldEluZGljZXModCl9dmFyIG49dGhpcy5nZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuUG9zaXRpb25LaW5kLCExKTtpZihudWxsIT1uJiZuLmxlbmd0aD4wKXtmb3IodmFyIGk9MDtpPG4ubGVuZ3RoO2krPTMpbltpKzJdPS1uW2krMl07dGhpcy5zZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuUG9zaXRpb25LaW5kLG4sITEpfXZhciBvPXRoaXMuZ2V0VmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLk5vcm1hbEtpbmQsITEpO2lmKG51bGwhPW8mJm8ubGVuZ3RoPjApe2Zvcih2YXIgaT0wO2k8by5sZW5ndGg7aSs9MylvW2krMl09LW9baSsyXTt0aGlzLnNldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5Ob3JtYWxLaW5kLG8sITEpfX0sdC5wcm90b3R5cGUuaXNEaXNwb3NlZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9pc0Rpc3Bvc2VkfSx0LnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7dmFyIHQsaT10aGlzLl9tZXNoZXMscj1pLmxlbmd0aDtmb3IodD0wO3I+dDt0KyspdGhpcy5yZWxlYXNlRm9yTWVzaChpW3RdKTt0aGlzLl9tZXNoZXM9W107Zm9yKHZhciBuIGluIHRoaXMuX3ZlcnRleEJ1ZmZlcnMpdGhpcy5fdmVydGV4QnVmZmVyc1tuXS5kaXNwb3NlKCk7dGhpcy5fdmVydGV4QnVmZmVycz17fSx0aGlzLl90b3RhbFZlcnRpY2VzPTAsdGhpcy5faW5kZXhCdWZmZXImJnRoaXMuX2VuZ2luZS5fcmVsZWFzZUJ1ZmZlcih0aGlzLl9pbmRleEJ1ZmZlciksdGhpcy5faW5kZXhCdWZmZXI9bnVsbCx0aGlzLl9pbmRpY2VzPVtdLHRoaXMuZGVsYXlMb2FkU3RhdGU9ZS5FbmdpbmUuREVMQVlMT0FEU1RBVEVfTk9ORSx0aGlzLmRlbGF5TG9hZGluZ0ZpbGU9bnVsbCx0aGlzLl9kZWxheUxvYWRpbmdGdW5jdGlvbj1udWxsLHRoaXMuX2RlbGF5SW5mbz1bXSx0aGlzLl9ib3VuZGluZ0luZm89bnVsbCx0aGlzLl9zY2VuZS5yZW1vdmVHZW9tZXRyeSh0aGlzKSx0aGlzLl9pc0Rpc3Bvc2VkPSEwfSx0LnByb3RvdHlwZS5jb3B5PWZ1bmN0aW9uKGkpe3ZhciByPW5ldyBlLlZlcnRleERhdGE7ci5pbmRpY2VzPVtdO2Zvcih2YXIgbj10aGlzLmdldEluZGljZXMoKSxvPTA7bzxuLmxlbmd0aDtvKyspci5pbmRpY2VzLnB1c2gobltvXSk7dmFyIHMsYT0hMSxoPSExO2ZvcihzIGluIHRoaXMuX3ZlcnRleEJ1ZmZlcnMpe3ZhciBjPXRoaXMuZ2V0VmVydGljZXNEYXRhKHMpO2MgaW5zdGFuY2VvZiBGbG9hdDMyQXJyYXk/ci5zZXQobmV3IEZsb2F0MzJBcnJheShjKSxzKTpyLnNldChjLnNsaWNlKDApLHMpLGh8fChhPXRoaXMuZ2V0VmVydGV4QnVmZmVyKHMpLmlzVXBkYXRhYmxlKCksaD0hYSl9dmFyIGw9bmV3IHQoaSx0aGlzLl9zY2VuZSxyLGEsbnVsbCk7bC5kZWxheUxvYWRTdGF0ZT10aGlzLmRlbGF5TG9hZFN0YXRlLGwuZGVsYXlMb2FkaW5nRmlsZT10aGlzLmRlbGF5TG9hZGluZ0ZpbGUsbC5fZGVsYXlMb2FkaW5nRnVuY3Rpb249dGhpcy5fZGVsYXlMb2FkaW5nRnVuY3Rpb247Zm9yKHMgaW4gdGhpcy5fZGVsYXlJbmZvKWwuX2RlbGF5SW5mbz1sLl9kZWxheUluZm98fFtdLGwuX2RlbGF5SW5mby5wdXNoKHMpO3JldHVybiBsLl9ib3VuZGluZ0luZm89bmV3IGUuQm91bmRpbmdJbmZvKHRoaXMuX2V4dGVuZC5taW5pbXVtLHRoaXMuX2V4dGVuZC5tYXhpbXVtKSxsfSx0LnByb3RvdHlwZS5zZXJpYWxpemU9ZnVuY3Rpb24oKXt2YXIgdD17fTtyZXR1cm4gdC5pZD10aGlzLmlkLGUuVGFncy5IYXNUYWdzKHRoaXMpJiYodC50YWdzPWUuVGFncy5HZXRUYWdzKHRoaXMpKSx0fSx0LnByb3RvdHlwZS5zZXJpYWxpemVWZXJ0aWNlRGF0YT1mdW5jdGlvbigpe3ZhciB0PXRoaXMuc2VyaWFsaXplKCk7cmV0dXJuIHRoaXMuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGUuVmVydGV4QnVmZmVyLlBvc2l0aW9uS2luZCkmJih0LnBvc2l0aW9ucz10aGlzLmdldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5Qb3NpdGlvbktpbmQpKSx0aGlzLmlzVmVydGljZXNEYXRhUHJlc2VudChlLlZlcnRleEJ1ZmZlci5Ob3JtYWxLaW5kKSYmKHQubm9ybWFscz10aGlzLmdldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5Ob3JtYWxLaW5kKSksdGhpcy5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZS5WZXJ0ZXhCdWZmZXIuVVZLaW5kKSYmKHQudXZzPXRoaXMuZ2V0VmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLlVWS2luZCkpLHRoaXMuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGUuVmVydGV4QnVmZmVyLlVWMktpbmQpJiYodC51dnMyPXRoaXMuZ2V0VmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLlVWMktpbmQpKSx0aGlzLmlzVmVydGljZXNEYXRhUHJlc2VudChlLlZlcnRleEJ1ZmZlci5VVjNLaW5kKSYmKHQudXZzMz10aGlzLmdldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5VVjNLaW5kKSksdGhpcy5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZS5WZXJ0ZXhCdWZmZXIuVVY0S2luZCkmJih0LnV2czQ9dGhpcy5nZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuVVY0S2luZCkpLHRoaXMuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGUuVmVydGV4QnVmZmVyLlVWNUtpbmQpJiYodC51dnM1PXRoaXMuZ2V0VmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLlVWNUtpbmQpKSx0aGlzLmlzVmVydGljZXNEYXRhUHJlc2VudChlLlZlcnRleEJ1ZmZlci5VVjZLaW5kKSYmKHQudXZzNj10aGlzLmdldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5VVjZLaW5kKSksdGhpcy5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZS5WZXJ0ZXhCdWZmZXIuQ29sb3JLaW5kKSYmKHQuY29sb3JzPXRoaXMuZ2V0VmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLkNvbG9yS2luZCkpLHRoaXMuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGUuVmVydGV4QnVmZmVyLk1hdHJpY2VzSW5kaWNlc0tpbmQpJiYodC5tYXRyaWNlc0luZGljZXM9dGhpcy5nZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuTWF0cmljZXNJbmRpY2VzS2luZCksdC5tYXRyaWNlc0luZGljZXMuX2lzRXhwYW5kZWQ9ITApLHRoaXMuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGUuVmVydGV4QnVmZmVyLk1hdHJpY2VzV2VpZ2h0c0tpbmQpJiYodC5tYXRyaWNlc1dlaWdodHM9dGhpcy5nZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuTWF0cmljZXNXZWlnaHRzS2luZCkpLHQuaW5kaWNlcz10aGlzLmdldEluZGljZXMoKSx0fSx0LkV4dHJhY3RGcm9tTWVzaD1mdW5jdGlvbihlLHQpe3ZhciBpPWUuX2dlb21ldHJ5O3JldHVybiBpP2kuY29weSh0KTpudWxsfSx0LlJhbmRvbUlkPWZ1bmN0aW9uKCl7cmV0dXJuXCJ4eHh4eHh4eC14eHh4LTR4eHgteXh4eC14eHh4eHh4eHh4eHhcIi5yZXBsYWNlKC9beHldL2csZnVuY3Rpb24oZSl7dmFyIHQ9MTYqTWF0aC5yYW5kb20oKXwwLGk9XCJ4XCI9PT1lP3Q6MyZ0fDg7cmV0dXJuIGkudG9TdHJpbmcoMTYpfSl9LHQuSW1wb3J0R2VvbWV0cnk9ZnVuY3Rpb24odCxpKXt2YXIgcj1pLmdldFNjZW5lKCksbj10Lmdlb21ldHJ5SWQ7aWYobil7dmFyIG89ci5nZXRHZW9tZXRyeUJ5SUQobik7byYmby5hcHBseVRvTWVzaChpKX1lbHNlIGlmKHQgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcil7dmFyIHM9aS5fYmluYXJ5SW5mbztpZihzLnBvc2l0aW9uc0F0dHJEZXNjJiZzLnBvc2l0aW9uc0F0dHJEZXNjLmNvdW50PjApe3ZhciBhPW5ldyBGbG9hdDMyQXJyYXkodCxzLnBvc2l0aW9uc0F0dHJEZXNjLm9mZnNldCxzLnBvc2l0aW9uc0F0dHJEZXNjLmNvdW50KTtpLnNldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5Qb3NpdGlvbktpbmQsYSwhMSl9aWYocy5ub3JtYWxzQXR0ckRlc2MmJnMubm9ybWFsc0F0dHJEZXNjLmNvdW50PjApe3ZhciBoPW5ldyBGbG9hdDMyQXJyYXkodCxzLm5vcm1hbHNBdHRyRGVzYy5vZmZzZXQscy5ub3JtYWxzQXR0ckRlc2MuY291bnQpO2kuc2V0VmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLk5vcm1hbEtpbmQsaCwhMSl9aWYocy51dnNBdHRyRGVzYyYmcy51dnNBdHRyRGVzYy5jb3VudD4wKXt2YXIgYz1uZXcgRmxvYXQzMkFycmF5KHQscy51dnNBdHRyRGVzYy5vZmZzZXQscy51dnNBdHRyRGVzYy5jb3VudCk7aS5zZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuVVZLaW5kLGMsITEpfWlmKHMudXZzMkF0dHJEZXNjJiZzLnV2czJBdHRyRGVzYy5jb3VudD4wKXt2YXIgbD1uZXcgRmxvYXQzMkFycmF5KHQscy51dnMyQXR0ckRlc2Mub2Zmc2V0LHMudXZzMkF0dHJEZXNjLmNvdW50KTtpLnNldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5VVjJLaW5kLGwsITEpfWlmKHMudXZzM0F0dHJEZXNjJiZzLnV2czNBdHRyRGVzYy5jb3VudD4wKXt2YXIgdT1uZXcgRmxvYXQzMkFycmF5KHQscy51dnMzQXR0ckRlc2Mub2Zmc2V0LHMudXZzM0F0dHJEZXNjLmNvdW50KTtpLnNldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5VVjNLaW5kLHUsITEpfWlmKHMudXZzNEF0dHJEZXNjJiZzLnV2czRBdHRyRGVzYy5jb3VudD4wKXt2YXIgZj1uZXcgRmxvYXQzMkFycmF5KHQscy51dnM0QXR0ckRlc2Mub2Zmc2V0LHMudXZzNEF0dHJEZXNjLmNvdW50KTtpLnNldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5VVjRLaW5kLGYsITEpfWlmKHMudXZzNUF0dHJEZXNjJiZzLnV2czVBdHRyRGVzYy5jb3VudD4wKXt2YXIgZD1uZXcgRmxvYXQzMkFycmF5KHQscy51dnM1QXR0ckRlc2Mub2Zmc2V0LHMudXZzNUF0dHJEZXNjLmNvdW50KTtpLnNldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5VVjVLaW5kLGQsITEpfWlmKHMudXZzNkF0dHJEZXNjJiZzLnV2czZBdHRyRGVzYy5jb3VudD4wKXt2YXIgcD1uZXcgRmxvYXQzMkFycmF5KHQscy51dnM2QXR0ckRlc2Mub2Zmc2V0LHMudXZzNkF0dHJEZXNjLmNvdW50KTtpLnNldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5VVjZLaW5kLHAsITEpfWlmKHMuY29sb3JzQXR0ckRlc2MmJnMuY29sb3JzQXR0ckRlc2MuY291bnQ+MCl7dmFyIF89bmV3IEZsb2F0MzJBcnJheSh0LHMuY29sb3JzQXR0ckRlc2Mub2Zmc2V0LHMuY29sb3JzQXR0ckRlc2MuY291bnQpO2kuc2V0VmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLkNvbG9yS2luZCxfLCExLHMuY29sb3JzQXR0ckRlc2Muc3RyaWRlKX1pZihzLm1hdHJpY2VzSW5kaWNlc0F0dHJEZXNjJiZzLm1hdHJpY2VzSW5kaWNlc0F0dHJEZXNjLmNvdW50PjApe3ZhciBtPW5ldyBJbnQzMkFycmF5KHQscy5tYXRyaWNlc0luZGljZXNBdHRyRGVzYy5vZmZzZXQscy5tYXRyaWNlc0luZGljZXNBdHRyRGVzYy5jb3VudCk7aS5zZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuTWF0cmljZXNJbmRpY2VzS2luZCxtLCExKX1pZihzLm1hdHJpY2VzV2VpZ2h0c0F0dHJEZXNjJiZzLm1hdHJpY2VzV2VpZ2h0c0F0dHJEZXNjLmNvdW50PjApe3ZhciBnPW5ldyBGbG9hdDMyQXJyYXkodCxzLm1hdHJpY2VzV2VpZ2h0c0F0dHJEZXNjLm9mZnNldCxzLm1hdHJpY2VzV2VpZ2h0c0F0dHJEZXNjLmNvdW50KTtpLnNldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5NYXRyaWNlc1dlaWdodHNLaW5kLGcsITEpfWlmKHMuaW5kaWNlc0F0dHJEZXNjJiZzLmluZGljZXNBdHRyRGVzYy5jb3VudD4wKXt2YXIgdj1uZXcgSW50MzJBcnJheSh0LHMuaW5kaWNlc0F0dHJEZXNjLm9mZnNldCxzLmluZGljZXNBdHRyRGVzYy5jb3VudCk7aS5zZXRJbmRpY2VzKHYpfWlmKHMuc3ViTWVzaGVzQXR0ckRlc2MmJnMuc3ViTWVzaGVzQXR0ckRlc2MuY291bnQ+MCl7dmFyIHk9bmV3IEludDMyQXJyYXkodCxzLnN1Yk1lc2hlc0F0dHJEZXNjLm9mZnNldCw1KnMuc3ViTWVzaGVzQXR0ckRlc2MuY291bnQpO2kuc3ViTWVzaGVzPVtdO2Zvcih2YXIgeD0wO3g8cy5zdWJNZXNoZXNBdHRyRGVzYy5jb3VudDt4Kyspe3ZhciBiPXlbNSp4KzBdLFA9eVs1KngrMV0sQT15WzUqeCsyXSxUPXlbNSp4KzNdLEU9eVs1KngrNF07bmV3IGUuU3ViTWVzaChiLFAsQSxULEUsaSl9fX1lbHNlIGlmKHQucG9zaXRpb25zJiZ0Lm5vcm1hbHMmJnQuaW5kaWNlcyl7aWYoaS5zZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuUG9zaXRpb25LaW5kLHQucG9zaXRpb25zLCExKSxpLnNldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5Ob3JtYWxLaW5kLHQubm9ybWFscywhMSksdC51dnMmJmkuc2V0VmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLlVWS2luZCx0LnV2cywhMSksdC51dnMyJiZpLnNldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5VVjJLaW5kLHQudXZzMiwhMSksdC51dnMzJiZpLnNldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5VVjNLaW5kLHQudXZzMywhMSksdC51dnM0JiZpLnNldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5VVjRLaW5kLHQudXZzNCwhMSksdC51dnM1JiZpLnNldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5VVjVLaW5kLHQudXZzNSwhMSksdC51dnM2JiZpLnNldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5VVjZLaW5kLHQudXZzNiwhMSksdC5jb2xvcnMmJmkuc2V0VmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLkNvbG9yS2luZCxlLkNvbG9yNC5DaGVja0NvbG9yczQodC5jb2xvcnMsdC5wb3NpdGlvbnMubGVuZ3RoLzMpLCExKSx0Lm1hdHJpY2VzSW5kaWNlcylpZih0Lm1hdHJpY2VzSW5kaWNlcy5faXNFeHBhbmRlZClkZWxldGUgdC5tYXRyaWNlc0luZGljZXMuX2lzRXhwYW5kZWQsaS5zZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuTWF0cmljZXNJbmRpY2VzS2luZCx0Lm1hdHJpY2VzSW5kaWNlcywhMSk7ZWxzZXtmb3IodmFyIEM9W10seD0wO3g8dC5tYXRyaWNlc0luZGljZXMubGVuZ3RoO3grKyl7dmFyIFM9dC5tYXRyaWNlc0luZGljZXNbeF07Qy5wdXNoKDI1NSZTKSxDLnB1c2goKDY1MjgwJlMpPj44KSxDLnB1c2goKDE2NzExNjgwJlMpPj4xNiksQy5wdXNoKFM+PjI0KX1pLnNldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5NYXRyaWNlc0luZGljZXNLaW5kLEMsITEpfWlmKHQubWF0cmljZXNJbmRpY2VzRXh0cmEpaWYodC5tYXRyaWNlc0luZGljZXNFeHRyYS5faXNFeHBhbmRlZClkZWxldGUgdC5tYXRyaWNlc0luZGljZXMuX2lzRXhwYW5kZWQsaS5zZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuTWF0cmljZXNJbmRpY2VzRXh0cmFLaW5kLHQubWF0cmljZXNJbmRpY2VzRXh0cmEsITEpO2Vsc2V7Zm9yKHZhciBDPVtdLHg9MDt4PHQubWF0cmljZXNJbmRpY2VzRXh0cmEubGVuZ3RoO3grKyl7dmFyIFM9dC5tYXRyaWNlc0luZGljZXNFeHRyYVt4XTtDLnB1c2goMjU1JlMpLEMucHVzaCgoNjUyODAmUyk+PjgpLEMucHVzaCgoMTY3MTE2ODAmUyk+PjE2KSxDLnB1c2goUz4+MjQpfWkuc2V0VmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLk1hdHJpY2VzSW5kaWNlc0V4dHJhS2luZCxDLCExKX10Lm1hdHJpY2VzV2VpZ2h0cyYmaS5zZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuTWF0cmljZXNXZWlnaHRzS2luZCx0Lm1hdHJpY2VzV2VpZ2h0cywhMSksdC5tYXRyaWNlc1dlaWdodHNFeHRyYSYmaS5zZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuTWF0cmljZXNXZWlnaHRzRXh0cmFLaW5kLHQubWF0cmljZXNXZWlnaHRzRXh0cmEsITEpLGkuc2V0SW5kaWNlcyh0LmluZGljZXMpfWlmKHQuc3ViTWVzaGVzKXtpLnN1Yk1lc2hlcz1bXTtmb3IodmFyIE09MDtNPHQuc3ViTWVzaGVzLmxlbmd0aDtNKyspe3ZhciBJPXQuc3ViTWVzaGVzW01dO25ldyBlLlN1Yk1lc2goSS5tYXRlcmlhbEluZGV4LEkudmVydGljZXNTdGFydCxJLnZlcnRpY2VzQ291bnQsSS5pbmRleFN0YXJ0LEkuaW5kZXhDb3VudCxpKX19aS5fc2hvdWxkR2VuZXJhdGVGbGF0U2hhZGluZyYmKGkuY29udmVydFRvRmxhdFNoYWRlZE1lc2goKSxkZWxldGUgaS5fc2hvdWxkR2VuZXJhdGVGbGF0U2hhZGluZyksaS5jb21wdXRlV29ybGRNYXRyaXgoITApLHIuX3NlbGVjdGlvbk9jdHJlZSYmci5fc2VsZWN0aW9uT2N0cmVlLmFkZE1lc2goaSl9LHQuUGFyc2U9ZnVuY3Rpb24oaSxyLG4pe2lmKHIuZ2V0R2VvbWV0cnlCeUlEKGkuaWQpKXJldHVybiBudWxsO3ZhciBvPW5ldyB0KGkuaWQscik7cmV0dXJuIGUuVGFncy5BZGRUYWdzVG8obyxpLnRhZ3MpLGkuZGVsYXlMb2FkaW5nRmlsZT8oby5kZWxheUxvYWRTdGF0ZT1lLkVuZ2luZS5ERUxBWUxPQURTVEFURV9OT1RMT0FERUQsby5kZWxheUxvYWRpbmdGaWxlPW4raS5kZWxheUxvYWRpbmdGaWxlLG8uX2JvdW5kaW5nSW5mbz1uZXcgZS5Cb3VuZGluZ0luZm8oZS5WZWN0b3IzLkZyb21BcnJheShpLmJvdW5kaW5nQm94TWluaW11bSksZS5WZWN0b3IzLkZyb21BcnJheShpLmJvdW5kaW5nQm94TWF4aW11bSkpLG8uX2RlbGF5SW5mbz1bXSxpLmhhc1VWcyYmby5fZGVsYXlJbmZvLnB1c2goZS5WZXJ0ZXhCdWZmZXIuVVZLaW5kKSxpLmhhc1VWczImJm8uX2RlbGF5SW5mby5wdXNoKGUuVmVydGV4QnVmZmVyLlVWMktpbmQpLGkuaGFzVVZzMyYmby5fZGVsYXlJbmZvLnB1c2goZS5WZXJ0ZXhCdWZmZXIuVVYzS2luZCksaS5oYXNVVnM0JiZvLl9kZWxheUluZm8ucHVzaChlLlZlcnRleEJ1ZmZlci5VVjRLaW5kKSxpLmhhc1VWczUmJm8uX2RlbGF5SW5mby5wdXNoKGUuVmVydGV4QnVmZmVyLlVWNUtpbmQpLGkuaGFzVVZzNiYmby5fZGVsYXlJbmZvLnB1c2goZS5WZXJ0ZXhCdWZmZXIuVVY2S2luZCksaS5oYXNDb2xvcnMmJm8uX2RlbGF5SW5mby5wdXNoKGUuVmVydGV4QnVmZmVyLkNvbG9yS2luZCksaS5oYXNNYXRyaWNlc0luZGljZXMmJm8uX2RlbGF5SW5mby5wdXNoKGUuVmVydGV4QnVmZmVyLk1hdHJpY2VzSW5kaWNlc0tpbmQpLGkuaGFzTWF0cmljZXNXZWlnaHRzJiZvLl9kZWxheUluZm8ucHVzaChlLlZlcnRleEJ1ZmZlci5NYXRyaWNlc1dlaWdodHNLaW5kKSxvLl9kZWxheUxvYWRpbmdGdW5jdGlvbj1lLlZlcnRleERhdGEuSW1wb3J0VmVydGV4RGF0YSk6ZS5WZXJ0ZXhEYXRhLkltcG9ydFZlcnRleERhdGEoaSxvKSxyLnB1c2hHZW9tZXRyeShvLCEwKSxvfSx0fSgpO2UuR2VvbWV0cnk9dDt2YXIgdDshZnVuY3Rpb24odCl7dmFyIGk7IWZ1bmN0aW9uKGkpe3ZhciByPWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQodCxpLHIsbil7ZS5jYWxsKHRoaXMsdCxpLG51bGwsITEsbiksdGhpcy5fY2FuQmVSZWdlbmVyYXRlZD1yLHRoaXMuX2JlaW5nUmVnZW5lcmF0ZWQ9ITAsdGhpcy5yZWdlbmVyYXRlKCksdGhpcy5fYmVpbmdSZWdlbmVyYXRlZD0hMX1yZXR1cm4gX19leHRlbmRzKHQsZSksdC5wcm90b3R5cGUuY2FuQmVSZWdlbmVyYXRlZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9jYW5CZVJlZ2VuZXJhdGVkfSx0LnByb3RvdHlwZS5yZWdlbmVyYXRlPWZ1bmN0aW9uKCl7dGhpcy5fY2FuQmVSZWdlbmVyYXRlZCYmKHRoaXMuX2JlaW5nUmVnZW5lcmF0ZWQ9ITAsdGhpcy5zZXRBbGxWZXJ0aWNlc0RhdGEodGhpcy5fcmVnZW5lcmF0ZVZlcnRleERhdGEoKSwhMSksdGhpcy5fYmVpbmdSZWdlbmVyYXRlZD0hMSl9LHQucHJvdG90eXBlLmFzTmV3R2VvbWV0cnk9ZnVuY3Rpb24odCl7cmV0dXJuIGUucHJvdG90eXBlLmNvcHkuY2FsbCh0aGlzLHQpfSx0LnByb3RvdHlwZS5zZXRBbGxWZXJ0aWNlc0RhdGE9ZnVuY3Rpb24odCxpKXt0aGlzLl9iZWluZ1JlZ2VuZXJhdGVkJiZlLnByb3RvdHlwZS5zZXRBbGxWZXJ0aWNlc0RhdGEuY2FsbCh0aGlzLHQsITEpfSx0LnByb3RvdHlwZS5zZXRWZXJ0aWNlc0RhdGE9ZnVuY3Rpb24odCxpLHIpe3RoaXMuX2JlaW5nUmVnZW5lcmF0ZWQmJmUucHJvdG90eXBlLnNldFZlcnRpY2VzRGF0YS5jYWxsKHRoaXMsdCxpLCExKX0sdC5wcm90b3R5cGUuX3JlZ2VuZXJhdGVWZXJ0ZXhEYXRhPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IEVycm9yKFwiQWJzdHJhY3QgbWV0aG9kXCIpfSx0LnByb3RvdHlwZS5jb3B5PWZ1bmN0aW9uKGUpe3Rocm93IG5ldyBFcnJvcihcIk11c3QgYmUgb3ZlcnJpZGVuIGluIHN1Yi1jbGFzc2VzLlwiKX0sdC5wcm90b3R5cGUuc2VyaWFsaXplPWZ1bmN0aW9uKCl7dmFyIHQ9ZS5wcm90b3R5cGUuc2VyaWFsaXplLmNhbGwodGhpcyk7cmV0dXJuIHQuY2FuQmVSZWdlbmVyYXRlZD10aGlzLmNhbkJlUmVnZW5lcmF0ZWQoKSx0fSx0fSh0KTtpLl9QcmltaXRpdmU9cjt2YXIgbj1mdW5jdGlvbih0KXtmdW5jdGlvbiBpKGkscixuLG8scyxhLGgsYyxsKXt2b2lkIDA9PT1sJiYobD1lLk1lc2guREVGQVVMVFNJREUpLHQuY2FsbCh0aGlzLGkscixoLGMpLHRoaXMucGF0aEFycmF5PW4sdGhpcy5jbG9zZUFycmF5PW8sdGhpcy5jbG9zZVBhdGg9cyx0aGlzLm9mZnNldD1hLHRoaXMuc2lkZT1sfXJldHVybiBfX2V4dGVuZHMoaSx0KSxpLnByb3RvdHlwZS5fcmVnZW5lcmF0ZVZlcnRleERhdGE9ZnVuY3Rpb24oKXtyZXR1cm4gZS5WZXJ0ZXhEYXRhLkNyZWF0ZVJpYmJvbih7cGF0aEFycmF5OnRoaXMucGF0aEFycmF5LGNsb3NlQXJyYXk6dGhpcy5jbG9zZUFycmF5LGNsb3NlUGF0aDp0aGlzLmNsb3NlUGF0aCxvZmZzZXQ6dGhpcy5vZmZzZXQsc2lkZU9yaWVudGF0aW9uOnRoaXMuc2lkZX0pfSxpLnByb3RvdHlwZS5jb3B5PWZ1bmN0aW9uKGUpe3JldHVybiBuZXcgaShlLHRoaXMuZ2V0U2NlbmUoKSx0aGlzLnBhdGhBcnJheSx0aGlzLmNsb3NlQXJyYXksdGhpcy5jbG9zZVBhdGgsdGhpcy5vZmZzZXQsdGhpcy5jYW5CZVJlZ2VuZXJhdGVkKCksbnVsbCx0aGlzLnNpZGUpfSxpfShyKTtpLlJpYmJvbj1uO3ZhciBvPWZ1bmN0aW9uKGkpe2Z1bmN0aW9uIHIodCxyLG4sbyxzLGEpe3ZvaWQgMD09PWEmJihhPWUuTWVzaC5ERUZBVUxUU0lERSksaS5jYWxsKHRoaXMsdCxyLG8scyksdGhpcy5zaXplPW4sdGhpcy5zaWRlPWF9cmV0dXJuIF9fZXh0ZW5kcyhyLGkpLHIucHJvdG90eXBlLl9yZWdlbmVyYXRlVmVydGV4RGF0YT1mdW5jdGlvbigpe3JldHVybiBlLlZlcnRleERhdGEuQ3JlYXRlQm94KHtzaXplOnRoaXMuc2l6ZSxzaWRlT3JpZW50YXRpb246dGhpcy5zaWRlfSl9LHIucHJvdG90eXBlLmNvcHk9ZnVuY3Rpb24oZSl7cmV0dXJuIG5ldyByKGUsdGhpcy5nZXRTY2VuZSgpLHRoaXMuc2l6ZSx0aGlzLmNhbkJlUmVnZW5lcmF0ZWQoKSxudWxsLHRoaXMuc2lkZSl9LHIucHJvdG90eXBlLnNlcmlhbGl6ZT1mdW5jdGlvbigpe3ZhciBlPWkucHJvdG90eXBlLnNlcmlhbGl6ZS5jYWxsKHRoaXMpO3JldHVybiBlLnNpemU9dGhpcy5zaXplLGV9LHIuUGFyc2U9ZnVuY3Rpb24oaSxyKXtpZihyLmdldEdlb21ldHJ5QnlJRChpLmlkKSlyZXR1cm4gbnVsbDt2YXIgbj1uZXcgdC5QcmltaXRpdmVzLkJveChpLmlkLHIsaS5zaXplLGkuY2FuQmVSZWdlbmVyYXRlZCxudWxsKTtyZXR1cm4gZS5UYWdzLkFkZFRhZ3NUbyhuLGkudGFncyksci5wdXNoR2VvbWV0cnkobiwhMCksbn0scn0ocik7aS5Cb3g9bzt2YXIgcz1mdW5jdGlvbihpKXtmdW5jdGlvbiByKHQscixuLG8scyxhLGgpe3ZvaWQgMD09PWgmJihoPWUuTWVzaC5ERUZBVUxUU0lERSksaS5jYWxsKHRoaXMsdCxyLHMsYSksdGhpcy5zZWdtZW50cz1uLHRoaXMuZGlhbWV0ZXI9byx0aGlzLnNpZGU9aH1yZXR1cm4gX19leHRlbmRzKHIsaSksci5wcm90b3R5cGUuX3JlZ2VuZXJhdGVWZXJ0ZXhEYXRhPWZ1bmN0aW9uKCl7cmV0dXJuIGUuVmVydGV4RGF0YS5DcmVhdGVTcGhlcmUoe3NlZ21lbnRzOnRoaXMuc2VnbWVudHMsZGlhbWV0ZXI6dGhpcy5kaWFtZXRlcixzaWRlT3JpZW50YXRpb246dGhpcy5zaWRlfSl9LHIucHJvdG90eXBlLmNvcHk9ZnVuY3Rpb24oZSl7cmV0dXJuIG5ldyByKGUsdGhpcy5nZXRTY2VuZSgpLHRoaXMuc2VnbWVudHMsdGhpcy5kaWFtZXRlcix0aGlzLmNhbkJlUmVnZW5lcmF0ZWQoKSxudWxsLHRoaXMuc2lkZSl9LHIucHJvdG90eXBlLnNlcmlhbGl6ZT1mdW5jdGlvbigpe3ZhciBlPWkucHJvdG90eXBlLnNlcmlhbGl6ZS5jYWxsKHRoaXMpO3JldHVybiBlLnNlZ21lbnRzPXRoaXMuc2VnbWVudHMsZS5kaWFtZXRlcj10aGlzLmRpYW1ldGVyLGV9LHIuUGFyc2U9ZnVuY3Rpb24oaSxyKXtpZihyLmdldEdlb21ldHJ5QnlJRChpLmlkKSlyZXR1cm4gbnVsbDt2YXIgbj1uZXcgdC5QcmltaXRpdmVzLlNwaGVyZShpLmlkLHIsaS5zZWdtZW50cyxpLmRpYW1ldGVyLGkuY2FuQmVSZWdlbmVyYXRlZCxudWxsKTtyZXR1cm4gZS5UYWdzLkFkZFRhZ3NUbyhuLGkudGFncyksci5wdXNoR2VvbWV0cnkobiwhMCksbn0scn0ocik7aS5TcGhlcmU9czt2YXIgYT1mdW5jdGlvbih0KXtmdW5jdGlvbiBpKGkscixuLG8scyxhLGgpe3ZvaWQgMD09PWgmJihoPWUuTWVzaC5ERUZBVUxUU0lERSksdC5jYWxsKHRoaXMsaSxyLHMsYSksdGhpcy5yYWRpdXM9bix0aGlzLnRlc3NlbGxhdGlvbj1vLHRoaXMuc2lkZT1ofXJldHVybiBfX2V4dGVuZHMoaSx0KSxpLnByb3RvdHlwZS5fcmVnZW5lcmF0ZVZlcnRleERhdGE9ZnVuY3Rpb24oKXtyZXR1cm4gZS5WZXJ0ZXhEYXRhLkNyZWF0ZURpc2Moe3JhZGl1czp0aGlzLnJhZGl1cyx0ZXNzZWxsYXRpb246dGhpcy50ZXNzZWxsYXRpb24sc2lkZU9yaWVudGF0aW9uOnRoaXMuc2lkZX0pfSxpLnByb3RvdHlwZS5jb3B5PWZ1bmN0aW9uKGUpe3JldHVybiBuZXcgaShlLHRoaXMuZ2V0U2NlbmUoKSx0aGlzLnJhZGl1cyx0aGlzLnRlc3NlbGxhdGlvbix0aGlzLmNhbkJlUmVnZW5lcmF0ZWQoKSxudWxsLHRoaXMuc2lkZSl9LGl9KHIpO2kuRGlzYz1hO3ZhciBoPWZ1bmN0aW9uKGkpe2Z1bmN0aW9uIHIodCxyLG4sbyxzLGEsaCxjLGwsdSl7dm9pZCAwPT09aCYmKGg9MSksdm9pZCAwPT09dSYmKHU9ZS5NZXNoLkRFRkFVTFRTSURFKSxpLmNhbGwodGhpcyx0LHIsYyxsKSx0aGlzLmhlaWdodD1uLHRoaXMuZGlhbWV0ZXJUb3A9byx0aGlzLmRpYW1ldGVyQm90dG9tPXMsdGhpcy50ZXNzZWxsYXRpb249YSx0aGlzLnN1YmRpdmlzaW9ucz1oLHRoaXMuc2lkZT11fXJldHVybiBfX2V4dGVuZHMocixpKSxyLnByb3RvdHlwZS5fcmVnZW5lcmF0ZVZlcnRleERhdGE9ZnVuY3Rpb24oKXtyZXR1cm4gZS5WZXJ0ZXhEYXRhLkNyZWF0ZUN5bGluZGVyKHtoZWlnaHQ6dGhpcy5oZWlnaHQsZGlhbWV0ZXJUb3A6dGhpcy5kaWFtZXRlclRvcCxkaWFtZXRlckJvdHRvbTp0aGlzLmRpYW1ldGVyQm90dG9tLHRlc3NlbGxhdGlvbjp0aGlzLnRlc3NlbGxhdGlvbixzdWJkaXZpc2lvbnM6dGhpcy5zdWJkaXZpc2lvbnMsc2lkZU9yaWVudGF0aW9uOnRoaXMuc2lkZX0pfSxyLnByb3RvdHlwZS5jb3B5PWZ1bmN0aW9uKGUpe3JldHVybiBuZXcgcihlLHRoaXMuZ2V0U2NlbmUoKSx0aGlzLmhlaWdodCx0aGlzLmRpYW1ldGVyVG9wLHRoaXMuZGlhbWV0ZXJCb3R0b20sdGhpcy50ZXNzZWxsYXRpb24sdGhpcy5zdWJkaXZpc2lvbnMsdGhpcy5jYW5CZVJlZ2VuZXJhdGVkKCksbnVsbCx0aGlzLnNpZGUpfSxyLnByb3RvdHlwZS5zZXJpYWxpemU9ZnVuY3Rpb24oKXt2YXIgZT1pLnByb3RvdHlwZS5zZXJpYWxpemUuY2FsbCh0aGlzKTtyZXR1cm4gZS5oZWlnaHQ9dGhpcy5oZWlnaHQsZS5kaWFtZXRlclRvcD10aGlzLmRpYW1ldGVyVG9wLGUuZGlhbWV0ZXJCb3R0b209dGhpcy5kaWFtZXRlckJvdHRvbSxlLnRlc3NlbGxhdGlvbj10aGlzLnRlc3NlbGxhdGlvbixlfSxyLlBhcnNlPWZ1bmN0aW9uKGkscil7aWYoci5nZXRHZW9tZXRyeUJ5SUQoaS5pZCkpcmV0dXJuIG51bGw7dmFyIG49bmV3IHQuUHJpbWl0aXZlcy5DeWxpbmRlcihpLmlkLHIsaS5oZWlnaHQsaS5kaWFtZXRlclRvcCxpLmRpYW1ldGVyQm90dG9tLGkudGVzc2VsbGF0aW9uLGkuc3ViZGl2aXNpb25zLGkuY2FuQmVSZWdlbmVyYXRlZCxudWxsKTtyZXR1cm4gZS5UYWdzLkFkZFRhZ3NUbyhuLGkudGFncyksci5wdXNoR2VvbWV0cnkobiwhMCksbn0scn0ocik7aS5DeWxpbmRlcj1oO3ZhciBjPWZ1bmN0aW9uKGkpe2Z1bmN0aW9uIHIodCxyLG4sbyxzLGEsaCxjKXt2b2lkIDA9PT1jJiYoYz1lLk1lc2guREVGQVVMVFNJREUpLGkuY2FsbCh0aGlzLHQscixhLGgpLHRoaXMuZGlhbWV0ZXI9bix0aGlzLnRoaWNrbmVzcz1vLHRoaXMudGVzc2VsbGF0aW9uPXMsdGhpcy5zaWRlPWN9cmV0dXJuIF9fZXh0ZW5kcyhyLGkpLHIucHJvdG90eXBlLl9yZWdlbmVyYXRlVmVydGV4RGF0YT1mdW5jdGlvbigpe3JldHVybiBlLlZlcnRleERhdGEuQ3JlYXRlVG9ydXMoe2RpYW1ldGVyOnRoaXMuZGlhbWV0ZXIsdGhpY2tuZXNzOnRoaXMudGhpY2tuZXNzLHRlc3NlbGxhdGlvbjp0aGlzLnRlc3NlbGxhdGlvbixzaWRlT3JpZW50YXRpb246dGhpcy5zaWRlfSl9LHIucHJvdG90eXBlLmNvcHk9ZnVuY3Rpb24oZSl7cmV0dXJuIG5ldyByKGUsdGhpcy5nZXRTY2VuZSgpLHRoaXMuZGlhbWV0ZXIsdGhpcy50aGlja25lc3MsdGhpcy50ZXNzZWxsYXRpb24sdGhpcy5jYW5CZVJlZ2VuZXJhdGVkKCksbnVsbCx0aGlzLnNpZGUpfSxyLnByb3RvdHlwZS5zZXJpYWxpemU9ZnVuY3Rpb24oKXt2YXIgZT1pLnByb3RvdHlwZS5zZXJpYWxpemUuY2FsbCh0aGlzKTtyZXR1cm4gZS5kaWFtZXRlcj10aGlzLmRpYW1ldGVyLGUudGhpY2tuZXNzPXRoaXMudGhpY2tuZXNzLGUudGVzc2VsbGF0aW9uPXRoaXMudGVzc2VsbGF0aW9uLGV9LHIuUGFyc2U9ZnVuY3Rpb24oaSxyKXtpZihyLmdldEdlb21ldHJ5QnlJRChpLmlkKSlyZXR1cm4gbnVsbDt2YXIgbj1uZXcgdC5QcmltaXRpdmVzLlRvcnVzKGkuaWQscixpLmRpYW1ldGVyLGkudGhpY2tuZXNzLGkudGVzc2VsbGF0aW9uLGkuY2FuQmVSZWdlbmVyYXRlZCxudWxsKTtyZXR1cm4gZS5UYWdzLkFkZFRhZ3NUbyhuLGkudGFncyksci5wdXNoR2VvbWV0cnkobiwhMCksbn0scn0ocik7aS5Ub3J1cz1jO3ZhciBsPWZ1bmN0aW9uKGkpe2Z1bmN0aW9uIHIoZSx0LHIsbixvLHMsYSl7aS5jYWxsKHRoaXMsZSx0LHMsYSksdGhpcy53aWR0aD1yLHRoaXMuaGVpZ2h0PW4sdGhpcy5zdWJkaXZpc2lvbnM9b31yZXR1cm4gX19leHRlbmRzKHIsaSksci5wcm90b3R5cGUuX3JlZ2VuZXJhdGVWZXJ0ZXhEYXRhPWZ1bmN0aW9uKCl7cmV0dXJuIGUuVmVydGV4RGF0YS5DcmVhdGVHcm91bmQoe3dpZHRoOnRoaXMud2lkdGgsaGVpZ2h0OnRoaXMuaGVpZ2h0LHN1YmRpdmlzaW9uczp0aGlzLnN1YmRpdmlzaW9uc30pfSxyLnByb3RvdHlwZS5jb3B5PWZ1bmN0aW9uKGUpe3JldHVybiBuZXcgcihlLHRoaXMuZ2V0U2NlbmUoKSx0aGlzLndpZHRoLHRoaXMuaGVpZ2h0LHRoaXMuc3ViZGl2aXNpb25zLHRoaXMuY2FuQmVSZWdlbmVyYXRlZCgpLG51bGwpfSxyLnByb3RvdHlwZS5zZXJpYWxpemU9ZnVuY3Rpb24oKXt2YXIgZT1pLnByb3RvdHlwZS5zZXJpYWxpemUuY2FsbCh0aGlzKTtyZXR1cm4gZS53aWR0aD10aGlzLndpZHRoLGUuaGVpZ2h0PXRoaXMuaGVpZ2h0LGUuc3ViZGl2aXNpb25zPXRoaXMuc3ViZGl2aXNpb25zLGV9LHIuUGFyc2U9ZnVuY3Rpb24oaSxyKXtpZihyLmdldEdlb21ldHJ5QnlJRChpLmlkKSlyZXR1cm4gbnVsbDt2YXIgbj1uZXcgdC5QcmltaXRpdmVzLkdyb3VuZChpLmlkLHIsaS53aWR0aCxpLmhlaWdodCxpLnN1YmRpdmlzaW9ucyxpLmNhbkJlUmVnZW5lcmF0ZWQsbnVsbCk7cmV0dXJuIGUuVGFncy5BZGRUYWdzVG8obixpLnRhZ3MpLHIucHVzaEdlb21ldHJ5KG4sITApLG59LHJ9KHIpO2kuR3JvdW5kPWw7dmFyIHU9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gaShlLGkscixuLG8scyxhLGgsYyxsKXt0LmNhbGwodGhpcyxlLGksYyxsKSx0aGlzLnhtaW49cix0aGlzLnptaW49bix0aGlzLnhtYXg9byx0aGlzLnptYXg9cyx0aGlzLnN1YmRpdmlzaW9ucz1hLHRoaXMucHJlY2lzaW9uPWh9cmV0dXJuIF9fZXh0ZW5kcyhpLHQpLGkucHJvdG90eXBlLl9yZWdlbmVyYXRlVmVydGV4RGF0YT1mdW5jdGlvbigpe3JldHVybiBlLlZlcnRleERhdGEuQ3JlYXRlVGlsZWRHcm91bmQoe3htaW46dGhpcy54bWluLHptaW46dGhpcy56bWluLHhtYXg6dGhpcy54bWF4LHptYXg6dGhpcy56bWF4LHN1YmRpdmlzaW9uczp0aGlzLnN1YmRpdmlzaW9ucyxwcmVjaXNpb246dGhpcy5wcmVjaXNpb259KX0saS5wcm90b3R5cGUuY29weT1mdW5jdGlvbihlKXtyZXR1cm4gbmV3IGkoZSx0aGlzLmdldFNjZW5lKCksdGhpcy54bWluLHRoaXMuem1pbix0aGlzLnhtYXgsdGhpcy56bWF4LHRoaXMuc3ViZGl2aXNpb25zLHRoaXMucHJlY2lzaW9uLHRoaXMuY2FuQmVSZWdlbmVyYXRlZCgpLG51bGwpfSxpfShyKTtpLlRpbGVkR3JvdW5kPXU7dmFyIGY9ZnVuY3Rpb24oaSl7ZnVuY3Rpb24gcih0LHIsbixvLHMsYSl7dm9pZCAwPT09YSYmKGE9ZS5NZXNoLkRFRkFVTFRTSURFKSxpLmNhbGwodGhpcyx0LHIsbyxzKSx0aGlzLnNpemU9bix0aGlzLnNpZGU9YX1yZXR1cm4gX19leHRlbmRzKHIsaSksci5wcm90b3R5cGUuX3JlZ2VuZXJhdGVWZXJ0ZXhEYXRhPWZ1bmN0aW9uKCl7cmV0dXJuIGUuVmVydGV4RGF0YS5DcmVhdGVQbGFuZSh7c2l6ZTp0aGlzLnNpemUsXG5zaWRlT3JpZW50YXRpb246dGhpcy5zaWRlfSl9LHIucHJvdG90eXBlLmNvcHk9ZnVuY3Rpb24oZSl7cmV0dXJuIG5ldyByKGUsdGhpcy5nZXRTY2VuZSgpLHRoaXMuc2l6ZSx0aGlzLmNhbkJlUmVnZW5lcmF0ZWQoKSxudWxsLHRoaXMuc2lkZSl9LHIucHJvdG90eXBlLnNlcmlhbGl6ZT1mdW5jdGlvbigpe3ZhciBlPWkucHJvdG90eXBlLnNlcmlhbGl6ZS5jYWxsKHRoaXMpO3JldHVybiBlLnNpemU9dGhpcy5zaXplLGV9LHIuUGFyc2U9ZnVuY3Rpb24oaSxyKXtpZihyLmdldEdlb21ldHJ5QnlJRChpLmlkKSlyZXR1cm4gbnVsbDt2YXIgbj1uZXcgdC5QcmltaXRpdmVzLlBsYW5lKGkuaWQscixpLnNpemUsaS5jYW5CZVJlZ2VuZXJhdGVkLG51bGwpO3JldHVybiBlLlRhZ3MuQWRkVGFnc1RvKG4saS50YWdzKSxyLnB1c2hHZW9tZXRyeShuLCEwKSxufSxyfShyKTtpLlBsYW5lPWY7dmFyIGQ9ZnVuY3Rpb24oaSl7ZnVuY3Rpb24gcih0LHIsbixvLHMsYSxoLGMsbCx1LGYpe3ZvaWQgMD09PWYmJihmPWUuTWVzaC5ERUZBVUxUU0lERSksaS5jYWxsKHRoaXMsdCxyLGwsdSksdGhpcy5yYWRpdXM9bix0aGlzLnR1YmU9byx0aGlzLnJhZGlhbFNlZ21lbnRzPXMsdGhpcy50dWJ1bGFyU2VnbWVudHM9YSx0aGlzLnA9aCx0aGlzLnE9Yyx0aGlzLnNpZGU9Zn1yZXR1cm4gX19leHRlbmRzKHIsaSksci5wcm90b3R5cGUuX3JlZ2VuZXJhdGVWZXJ0ZXhEYXRhPWZ1bmN0aW9uKCl7cmV0dXJuIGUuVmVydGV4RGF0YS5DcmVhdGVUb3J1c0tub3Qoe3JhZGl1czp0aGlzLnJhZGl1cyx0dWJlOnRoaXMudHViZSxyYWRpYWxTZWdtZW50czp0aGlzLnJhZGlhbFNlZ21lbnRzLHR1YnVsYXJTZWdtZW50czp0aGlzLnR1YnVsYXJTZWdtZW50cyxwOnRoaXMucCxxOnRoaXMucSxzaWRlT3JpZW50YXRpb246dGhpcy5zaWRlfSl9LHIucHJvdG90eXBlLmNvcHk9ZnVuY3Rpb24oZSl7cmV0dXJuIG5ldyByKGUsdGhpcy5nZXRTY2VuZSgpLHRoaXMucmFkaXVzLHRoaXMudHViZSx0aGlzLnJhZGlhbFNlZ21lbnRzLHRoaXMudHVidWxhclNlZ21lbnRzLHRoaXMucCx0aGlzLnEsdGhpcy5jYW5CZVJlZ2VuZXJhdGVkKCksbnVsbCx0aGlzLnNpZGUpfSxyLnByb3RvdHlwZS5zZXJpYWxpemU9ZnVuY3Rpb24oKXt2YXIgZT1pLnByb3RvdHlwZS5zZXJpYWxpemUuY2FsbCh0aGlzKTtyZXR1cm4gZS5yYWRpdXM9dGhpcy5yYWRpdXMsZS50dWJlPXRoaXMudHViZSxlLnJhZGlhbFNlZ21lbnRzPXRoaXMucmFkaWFsU2VnbWVudHMsZS50dWJ1bGFyU2VnbWVudHM9dGhpcy50dWJ1bGFyU2VnbWVudHMsZS5wPXRoaXMucCxlLnE9dGhpcy5xLGV9LHIuUGFyc2U9ZnVuY3Rpb24oaSxyKXtpZihyLmdldEdlb21ldHJ5QnlJRChpLmlkKSlyZXR1cm4gbnVsbDt2YXIgbj1uZXcgdC5QcmltaXRpdmVzLlRvcnVzS25vdChpLmlkLHIsaS5yYWRpdXMsaS50dWJlLGkucmFkaWFsU2VnbWVudHMsaS50dWJ1bGFyU2VnbWVudHMsaS5wLGkucSxpLmNhbkJlUmVnZW5lcmF0ZWQsbnVsbCk7cmV0dXJuIGUuVGFncy5BZGRUYWdzVG8obixpLnRhZ3MpLHIucHVzaEdlb21ldHJ5KG4sITApLG59LHJ9KHIpO2kuVG9ydXNLbm90PWR9KGk9dC5QcmltaXRpdmVzfHwodC5QcmltaXRpdmVzPXt9KSl9KHQ9ZS5HZW9tZXRyeXx8KGUuR2VvbWV0cnk9e30pKX0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gaShpLHIpe3QuY2FsbCh0aGlzLGksciksdGhpcy5nZW5lcmF0ZU9jdHJlZT0hMSx0aGlzLl93b3JsZEludmVyc2U9bmV3IGUuTWF0cml4fXJldHVybiBfX2V4dGVuZHMoaSx0KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJzdWJkaXZpc2lvbnNcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3N1YmRpdmlzaW9uc30sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxpLnByb3RvdHlwZS5vcHRpbWl6ZT1mdW5jdGlvbihlLHQpe3ZvaWQgMD09PXQmJih0PTMyKSx0aGlzLl9zdWJkaXZpc2lvbnM9ZSx0aGlzLnN1YmRpdmlkZSh0aGlzLl9zdWJkaXZpc2lvbnMpLHRoaXMuY3JlYXRlT3JVcGRhdGVTdWJtZXNoZXNPY3RyZWUodCl9LGkucHJvdG90eXBlLmdldEhlaWdodEF0Q29vcmRpbmF0ZXM9ZnVuY3Rpb24oZSx0KXtpZihlLT10aGlzLnBvc2l0aW9uLngsdC09dGhpcy5wb3NpdGlvbi56LGUvPXRoaXMuc2NhbGluZy54LHQvPXRoaXMuc2NhbGluZy56LGU8dGhpcy5fbWluWHx8ZT50aGlzLl9tYXhYfHx0PHRoaXMuX21pblp8fHQ+dGhpcy5fbWF4WilyZXR1cm4gdGhpcy5wb3NpdGlvbi55O3RoaXMuX2hlaWdodFF1YWRzJiYwIT10aGlzLl9oZWlnaHRRdWFkcy5sZW5ndGh8fCh0aGlzLl9pbml0SGVpZ2h0UXVhZHMoKSx0aGlzLl9jb21wdXRlSGVpZ2h0UXVhZHMoKSk7dmFyIGk9dGhpcy5fZ2V0RmFjZXRBdChlLHQpLHI9LShpLngqZStpLnoqdCtpLncpL2kueTtyZXR1cm4gcip0aGlzLnNjYWxpbmcueSt0aGlzLnBvc2l0aW9uLnl9LGkucHJvdG90eXBlLmdldE5vcm1hbEF0Q29vcmRpbmF0ZXM9ZnVuY3Rpb24odCxpKXt2YXIgcj1uZXcgZS5WZWN0b3IzKDAsMSwwKTtyZXR1cm4gdGhpcy5nZXROb3JtYWxBdENvb3JkaW5hdGVzVG9SZWYodCxpLHIpLHJ9LGkucHJvdG90eXBlLmdldE5vcm1hbEF0Q29vcmRpbmF0ZXNUb1JlZj1mdW5jdGlvbihlLHQsaSl7aWYoZS09dGhpcy5wb3NpdGlvbi54LHQtPXRoaXMucG9zaXRpb24ueixlLz10aGlzLnNjYWxpbmcueCx0Lz10aGlzLnNjYWxpbmcueiwhKGU8dGhpcy5fbWluWHx8ZT50aGlzLl9tYXhYfHx0PHRoaXMuX21pblp8fHQ+dGhpcy5fbWF4Wikpe3RoaXMuX2hlaWdodFF1YWRzJiYwIT10aGlzLl9oZWlnaHRRdWFkcy5sZW5ndGh8fCh0aGlzLl9pbml0SGVpZ2h0UXVhZHMoKSx0aGlzLl9jb21wdXRlSGVpZ2h0UXVhZHMoKSk7dmFyIHI9dGhpcy5fZ2V0RmFjZXRBdChlLHQpO2kueD1yLngsaS55PXIueSxpLno9ci56fX0saS5wcm90b3R5cGUudXBkYXRlQ29vcmRpbmF0ZUhlaWdodHM9ZnVuY3Rpb24oKXt0aGlzLl9oZWlnaHRRdWFkcyYmMCE9dGhpcy5faGVpZ2h0UXVhZHMubGVuZ3RofHx0aGlzLl9pbml0SGVpZ2h0UXVhZHMoKSx0aGlzLl9jb21wdXRlSGVpZ2h0UXVhZHMoKX0saS5wcm90b3R5cGUuX2dldEZhY2V0QXQ9ZnVuY3Rpb24oZSx0KXt2YXIgaSxyPU1hdGguZmxvb3IoKGUrdGhpcy5fbWF4WCkqdGhpcy5fc3ViZGl2aXNpb25zL3RoaXMuX3dpZHRoKSxuPU1hdGguZmxvb3IoLSh0K3RoaXMuX21heFopKnRoaXMuX3N1YmRpdmlzaW9ucy90aGlzLl9oZWlnaHQrdGhpcy5fc3ViZGl2aXNpb25zKSxvPXRoaXMuX2hlaWdodFF1YWRzW24qdGhpcy5fc3ViZGl2aXNpb25zK3JdO3JldHVybiBpPXQ8by5zbG9wZS54KmUrby5zbG9wZS55P28uZmFjZXQxOm8uZmFjZXQyfSxpLnByb3RvdHlwZS5faW5pdEhlaWdodFF1YWRzPWZ1bmN0aW9uKCl7dGhpcy5faGVpZ2h0UXVhZHM9bmV3IEFycmF5O2Zvcih2YXIgdD0wO3Q8dGhpcy5fc3ViZGl2aXNpb25zO3QrKylmb3IodmFyIGk9MDtpPHRoaXMuX3N1YmRpdmlzaW9ucztpKyspe3ZhciByPXtzbG9wZTplLlZlY3RvcjIuWmVybygpLGZhY2V0MTpuZXcgZS5WZWN0b3I0KDAsMCwwLDApLGZhY2V0MjpuZXcgZS5WZWN0b3I0KDAsMCwwLDApfTt0aGlzLl9oZWlnaHRRdWFkc1t0KnRoaXMuX3N1YmRpdmlzaW9ucytpXT1yfX0saS5wcm90b3R5cGUuX2NvbXB1dGVIZWlnaHRRdWFkcz1mdW5jdGlvbigpe2Zvcih2YXIgdD10aGlzLmdldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5Qb3NpdGlvbktpbmQpLGk9ZS5UbXAuVmVjdG9yM1swXSxyPWUuVG1wLlZlY3RvcjNbMV0sbj1lLlRtcC5WZWN0b3IzWzJdLG89ZS5UbXAuVmVjdG9yM1szXSxzPWUuVG1wLlZlY3RvcjNbNF0sYT1lLlRtcC5WZWN0b3IzWzVdLGg9ZS5UbXAuVmVjdG9yM1s2XSxjPWUuVG1wLlZlY3RvcjNbN10sbD1lLlRtcC5WZWN0b3IzWzhdLHU9MCxmPTAsZD0wLHA9MCxfPTAsbT0wLGc9MCx2PTA7djx0aGlzLl9zdWJkaXZpc2lvbnM7disrKWZvcih2YXIgeT0wO3k8dGhpcy5fc3ViZGl2aXNpb25zO3krKyl7dT0zKnksZj12Kih0aGlzLl9zdWJkaXZpc2lvbnMrMSkqMyxkPSh2KzEpKih0aGlzLl9zdWJkaXZpc2lvbnMrMSkqMyxpLng9dFtmK3VdLGkueT10W2YrdSsxXSxpLno9dFtmK3UrMl0sci54PXRbZit1KzNdLHIueT10W2YrdSs0XSxyLno9dFtmK3UrNV0sbi54PXRbZCt1XSxuLnk9dFtkK3UrMV0sbi56PXRbZCt1KzJdLG8ueD10W2QrdSszXSxvLnk9dFtkK3UrNF0sby56PXRbZCt1KzVdLHA9KG8uei1pLnopLyhvLngtaS54KSxfPWkuei1wKmkueCxyLnN1YnRyYWN0VG9SZWYoaSxzKSxuLnN1YnRyYWN0VG9SZWYoaSxhKSxvLnN1YnRyYWN0VG9SZWYoaSxoKSxlLlZlY3RvcjMuQ3Jvc3NUb1JlZihoLGEsYyksZS5WZWN0b3IzLkNyb3NzVG9SZWYocyxoLGwpLGMubm9ybWFsaXplKCksbC5ub3JtYWxpemUoKSxtPS0oYy54KmkueCtjLnkqaS55K2MueippLnopLGc9LShsLngqci54K2wueSpyLnkrbC56KnIueik7dmFyIHg9dGhpcy5faGVpZ2h0UXVhZHNbdip0aGlzLl9zdWJkaXZpc2lvbnMreV07eC5zbG9wZS5jb3B5RnJvbUZsb2F0cyhwLF8pLHguZmFjZXQxLmNvcHlGcm9tRmxvYXRzKGMueCxjLnksYy56LG0pLHguZmFjZXQyLmNvcHlGcm9tRmxvYXRzKGwueCxsLnksbC56LGcpfX0saX0oZS5NZXNoKTtlLkdyb3VuZE1lc2g9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gaShpLHIsbixvLHMpe3ZvaWQgMD09PW4mJihuPW51bGwpLHQuY2FsbCh0aGlzLGkscixuLG8scyksdGhpcy5jb2xvcj1uZXcgZS5Db2xvcjMoMSwxLDEpLHRoaXMuYWxwaGE9MSx0aGlzLl9wb3NpdGlvbkJ1ZmZlcj17fSxvJiYodGhpcy5jb2xvcj1vLmNvbG9yLmNsb25lKCksdGhpcy5hbHBoYT1vLmFscGhhKSx0aGlzLl9pbnRlcnNlY3Rpb25UaHJlc2hvbGQ9LjEsdGhpcy5fY29sb3JTaGFkZXI9bmV3IGUuU2hhZGVyTWF0ZXJpYWwoXCJjb2xvclNoYWRlclwiLHIsXCJjb2xvclwiLHthdHRyaWJ1dGVzOltlLlZlcnRleEJ1ZmZlci5Qb3NpdGlvbktpbmRdLHVuaWZvcm1zOltcIndvcmxkVmlld1Byb2plY3Rpb25cIixcImNvbG9yXCJdLG5lZWRBbHBoYUJsZW5kaW5nOiEwfSksdGhpcy5fcG9zaXRpb25CdWZmZXJbZS5WZXJ0ZXhCdWZmZXIuUG9zaXRpb25LaW5kXT1udWxsfXJldHVybiBfX2V4dGVuZHMoaSx0KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJpbnRlcnNlY3Rpb25UaHJlc2hvbGRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2ludGVyc2VjdGlvblRocmVzaG9sZH0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX2ludGVyc2VjdGlvblRocmVzaG9sZCE9PXQmJih0aGlzLl9pbnRlcnNlY3Rpb25UaHJlc2hvbGQ9dCx0aGlzLmdlb21ldHJ5JiYodGhpcy5nZW9tZXRyeS5ib3VuZGluZ0JpYXM9bmV3IGUuVmVjdG9yMigwLHQpKSl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGkucHJvdG90eXBlLFwibWF0ZXJpYWxcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2NvbG9yU2hhZGVyfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcImNoZWNrQ29sbGlzaW9uc1wiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4hMX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxpLnByb3RvdHlwZS5jcmVhdGVJbnN0YW5jZT1mdW5jdGlvbih0KXtyZXR1cm4gZS5Ub29scy5Mb2coXCJMaW5lc01lc2hlcyBkbyBub3Qgc3VwcG9ydCBjcmVhdGVJbnN0YW5jZS5cIiksbnVsbH0saS5wcm90b3R5cGUuX2JpbmQ9ZnVuY3Rpb24odCxpLHIpe3ZhciBuPXRoaXMuZ2V0U2NlbmUoKS5nZXRFbmdpbmUoKTt0aGlzLl9wb3NpdGlvbkJ1ZmZlcltlLlZlcnRleEJ1ZmZlci5Qb3NpdGlvbktpbmRdPXRoaXMuX2dlb21ldHJ5LmdldFZlcnRleEJ1ZmZlcihlLlZlcnRleEJ1ZmZlci5Qb3NpdGlvbktpbmQpLG4uYmluZEJ1ZmZlcnModGhpcy5fcG9zaXRpb25CdWZmZXIsdGhpcy5fZ2VvbWV0cnkuZ2V0SW5kZXhCdWZmZXIoKSx0aGlzLl9jb2xvclNoYWRlci5nZXRFZmZlY3QoKSksdGhpcy5fY29sb3JTaGFkZXIuc2V0Q29sb3I0KFwiY29sb3JcIix0aGlzLmNvbG9yLnRvQ29sb3I0KHRoaXMuYWxwaGEpKX0saS5wcm90b3R5cGUuX2RyYXc9ZnVuY3Rpb24oZSx0LGkpe2lmKHRoaXMuX2dlb21ldHJ5JiZ0aGlzLl9nZW9tZXRyeS5nZXRWZXJ0ZXhCdWZmZXJzKCkmJnRoaXMuX2dlb21ldHJ5LmdldEluZGV4QnVmZmVyKCkpe3ZhciByPXRoaXMuZ2V0U2NlbmUoKS5nZXRFbmdpbmUoKTtyLmRyYXcoITEsZS5pbmRleFN0YXJ0LGUuaW5kZXhDb3VudCl9fSxpLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKGUpe3RoaXMuX2NvbG9yU2hhZGVyLmRpc3Bvc2UoKSx0LnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyxlKX0saS5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oZSx0LHIpe3JldHVybiBuZXcgaShlLHRoaXMuZ2V0U2NlbmUoKSx0LHRoaXMscil9LGl9KGUuTWVzaCk7ZS5MaW5lc01lc2g9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUsdCxpKXt2YXIgcj10aGlzO3ZvaWQgMD09PXQmJih0PVwiXCIpLHZvaWQgMD09PWkmJihpPVwiYmxhY2tcIiksdGhpcy5fcmVuZGVyaW5nQ2FudmFzPWUsdGhpcy5fbG9hZGluZ1RleHQ9dCx0aGlzLl9sb2FkaW5nRGl2QmFja2dyb3VuZENvbG9yPWksdGhpcy5fcmVzaXplTG9hZGluZ1VJPWZ1bmN0aW9uKCl7dmFyIGU9ci5fcmVuZGVyaW5nQ2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO3IuX2xvYWRpbmdEaXYuc3R5bGUucG9zaXRpb249XCJhYnNvbHV0ZVwiLHIuX2xvYWRpbmdEaXYuc3R5bGUubGVmdD1lLmxlZnQrXCJweFwiLHIuX2xvYWRpbmdEaXYuc3R5bGUudG9wPWUudG9wK1wicHhcIixyLl9sb2FkaW5nRGl2LnN0eWxlLndpZHRoPWUud2lkdGgrXCJweFwiLHIuX2xvYWRpbmdEaXYuc3R5bGUuaGVpZ2h0PWUuaGVpZ2h0K1wicHhcIn19cmV0dXJuIGUucHJvdG90eXBlLmRpc3BsYXlMb2FkaW5nVUk9ZnVuY3Rpb24oKXt2YXIgZT10aGlzO2lmKCF0aGlzLl9sb2FkaW5nRGl2KXt0aGlzLl9sb2FkaW5nRGl2PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiksdGhpcy5fbG9hZGluZ0Rpdi5pZD1cImJhYnlsb25qc0xvYWRpbmdEaXZcIix0aGlzLl9sb2FkaW5nRGl2LnN0eWxlLm9wYWNpdHk9XCIwXCIsdGhpcy5fbG9hZGluZ0Rpdi5zdHlsZS50cmFuc2l0aW9uPVwib3BhY2l0eSAxLjVzIGVhc2VcIix0aGlzLl9sb2FkaW5nVGV4dERpdj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpLHRoaXMuX2xvYWRpbmdUZXh0RGl2LnN0eWxlLnBvc2l0aW9uPVwiYWJzb2x1dGVcIix0aGlzLl9sb2FkaW5nVGV4dERpdi5zdHlsZS5sZWZ0PVwiMFwiLHRoaXMuX2xvYWRpbmdUZXh0RGl2LnN0eWxlLnRvcD1cIjUwJVwiLHRoaXMuX2xvYWRpbmdUZXh0RGl2LnN0eWxlLm1hcmdpblRvcD1cIjgwcHhcIix0aGlzLl9sb2FkaW5nVGV4dERpdi5zdHlsZS53aWR0aD1cIjEwMCVcIix0aGlzLl9sb2FkaW5nVGV4dERpdi5zdHlsZS5oZWlnaHQ9XCIyMHB4XCIsdGhpcy5fbG9hZGluZ1RleHREaXYuc3R5bGUuZm9udEZhbWlseT1cIkFyaWFsXCIsdGhpcy5fbG9hZGluZ1RleHREaXYuc3R5bGUuZm9udFNpemU9XCIxNHB4XCIsdGhpcy5fbG9hZGluZ1RleHREaXYuc3R5bGUuY29sb3I9XCJ3aGl0ZVwiLHRoaXMuX2xvYWRpbmdUZXh0RGl2LnN0eWxlLnRleHRBbGlnbj1cImNlbnRlclwiLHRoaXMuX2xvYWRpbmdUZXh0RGl2LmlubmVySFRNTD1cIkxvYWRpbmdcIix0aGlzLl9sb2FkaW5nRGl2LmFwcGVuZENoaWxkKHRoaXMuX2xvYWRpbmdUZXh0RGl2KSx0aGlzLl9sb2FkaW5nVGV4dERpdi5pbm5lckhUTUw9dGhpcy5fbG9hZGluZ1RleHQ7dmFyIHQ9bmV3IEltYWdlO3Quc3JjPVwiZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFHUUFBQUJrQ0FZQUFBQnc0cFZVQUFBQUFYTlNSMElBcnM0YzZRQUFBQVJuUVUxQkFBQ3hqd3Y4WVFVQUFBQUpjRWhaY3dBQURzTUFBQTdEQWNkdnFHUUFBQUFZZEVWWWRGTnZablIzWVhKbEFIQmhhVzUwTG01bGRDQTBMakF1TTR6bWwxQUFBQVJiU1VSQlZIaGU3WjA5YUZOUkZNYzcxNmt1THJxNEZkeUxxNFdpNENBb1JRY1IwVUpCVUJkUml1TFNJWU1vNkNBNEZGMnNndzZDRkFkRlVPcFNRWWNXTzRoRDI2VVFDZlhySVFyeC9KSnp3MU9TV3EzTlBlTC9CNEZ5KzBqZy9ITys3ajN2cFVjSThiL1EzOSsvNDlpaGZXZFBIVDk0WWYvZTNTZTNiZDI2M2Y4bHVzMjE4VFBuNnZWNllhOFdpL016TlJObWoxOGl1c1g5VzFldm1QMS9FS05FSVZHNkNNYkc2RTNidCtmVCsrcEhoYThOb0hkVDcyYkxFOE5EZzd0R1U2NGdMTG5kVjRXYzRtOGovcFMrdnI0dEdCL0RUMTZ2M0Z5cjhkdkJlL2piaXQ4QkwwQUVTOUxYMWlQQXorQlIvaEZpTFZDeW5qOTVkUHpOeTZmdjNJWi9rNEwzOTQ4U3E3RnpZR0JnNHZMRkd4aXRhYnVPRkNiV05LR3JNbmJpVXVvMThLYVY2dElIdjZZdHZMOS9uT2dFMzFqQ2t0bXJZN2s2Ky96aEU0eVA0VmY3aGlOcWgvQldXRWw4bXpEb2w0cDIyTGY3Y0lkdmRVTUV2djBZMlM5ZkU1UzFoTHpwcVRzUGtpZXAvL2dGR1BuUjNZbDdHTDVwL3hZRkJyVHdNK2lYaW8zR3Fwd0RHTDVwL3hZTklYN1hHOFE2SUpSZ2RJemYxS0JCZ2FmSUk3b01pZGh5UXRWRmFNQTJCdDdpbDRodVFSaGFYcGhiY1IyZzRSWHFCektBR0hpQ0N3R0ZWVUFqL20vUlRSRGoyOWN2bjEwSTBQWjNMZ2hINWY0Q0wxRUZsUW1xcVhLM2pEREtGeG1oUTNZdDZvUXNlVVpHS21NblRwc09xYzhvMUY5a0JPTWpRbE9MZXFFZUl5T2M2SlY2allMSkQvK1h5SUZ2bnpkZ2w5YVhSUTVJMnFaREsxU3Bvc3BNcWFvcU9OL3daWkdEY2lMbk1NaVhSUzdJRjRoaHFNVE5UZGs3Q0Z1K0xITGhSN0JRcUJ2UERKVVVRcUNHdkNNQVRIVWdCbWhXTmdBcG1kT2RhOVlwTStWd1JZZnV5eUlYREs4aEJsaWxOZXJMSWhlTVpDS0d3bFVBeXJ1Nkdsd09nUFViUnhBRGRKOUZBQ2h4WFk4NjR2aXl5RVhxUHhoYzBNMlRBZkFiYXRTZFJ5SHRYeW1oQnlFZFJuRTNreStKbkhBSWhTQTBoNzRrY2tFVG1Ib1FiU2dHd0pyQ0lSTUVQU1JJQkNSSU1BaFphWWhhZ2dRaEpYVUpFb1JVOW1vZkt3aCtGMjJkTFJSZkVqbEpNN3c2S1F3Q29RcEJPS1R5SlpFVGptd1J4S3F0R1Y4U09Ta05PR2pLUFFwcEJFZ0REa0ZncHhkQlZHa0ZnYVlRUVhSSUZRU09iazBQNVpGSXBBWlJIWHNRMHIwaENsdUJXS2t1dlZiWUNrUWFDZEw1ZWhCU2N1ZEpQNHlZK3JMSVNkcHMxTkJERUpLWE1NbW9TZmdnV0M0WlFSUjE3b0ZZWHBoN2hTaXF1SUtRK2hKR1RYMUo1TVlTUEQvR1ZkTnpzZ0xCd1pWQ1Z5QVFBa0Ywb2hpSS9jMWZTNnROWHE5VWZFbmtodWRtSVFvbHNTK0ozSGgvVXRORHpRTGhqNDJWS0pGSW5xTHdGWWlVVTVUb0ErSGRmSTBKZXZVcFFVQUluK3ZTejJsSEl1VVYvZEpPSUhoT1kvSVdWV0dCSUhRdHpzODhzOXp5V0J1VGdjQkx6R09tZU5uZkYvUXNsU0RnTWVRVzg1aTNET1F4dWlweEFrQ3laOFNJbTRPbXArN01NbENCNTlqNnNLWmNNb000aUlFb2VJMko5QUt4ckZvYlp4MHY0dllJbnVIRlM0SjFHUVJDQUdhTEVZUVhmeU1NTDVYU1FnZ2hoQkJDQ0NIK2NYcDZ2Z05oS3BTS1gvWGRPQUFBQUFCSlJVNUVya0pnZ2c9PVwiLHQuc3R5bGUucG9zaXRpb249XCJhYnNvbHV0ZVwiLHQuc3R5bGUubGVmdD1cIjUwJVwiLHQuc3R5bGUudG9wPVwiNTAlXCIsdC5zdHlsZS5tYXJnaW5MZWZ0PVwiLTUwcHhcIix0LnN0eWxlLm1hcmdpblRvcD1cIi01MHB4XCIsdC5zdHlsZS50cmFuc2l0aW9uPVwidHJhbnNmb3JtIDEuMHMgZWFzZVwiLHQuc3R5bGUud2Via2l0VHJhbnNpdGlvbj1cIi13ZWJraXQtdHJhbnNmb3JtIDEuMHMgZWFzZVwiO3ZhciBpPTM2MCxyPWZ1bmN0aW9uKCl7aSs9MzYwLHQuc3R5bGUudHJhbnNmb3JtPVwicm90YXRlWihcIitpK1wiZGVnKVwiLHQuc3R5bGUud2Via2l0VHJhbnNmb3JtPVwicm90YXRlWihcIitpK1wiZGVnKVwifTt0LmFkZEV2ZW50TGlzdGVuZXIoXCJ0cmFuc2l0aW9uZW5kXCIsciksdC5hZGRFdmVudExpc3RlbmVyKFwid2Via2l0VHJhbnNpdGlvbkVuZFwiLHIpLHRoaXMuX2xvYWRpbmdEaXYuYXBwZW5kQ2hpbGQodCk7dmFyIG49bmV3IEltYWdlO24uc3JjPVwiZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFHUUFBQUJrQ0FZQUFBQnc0cFZVQUFBQUFYTlNSMElBcnM0YzZRQUFBQVJuUVUxQkFBQ3hqd3Y4WVFVQUFBQUpjRWhaY3dBQURzTUFBQTdEQWNkdnFHUUFBQUFZZEVWWWRGTnZablIzWVhKbEFIQmhhVzUwTG01bGRDQTBMakF1TTR6bWwxQUFBQVlKU1VSQlZIaGU3WnkvcXgxRkZNZmYvMkF2Mk52Ymk0V0ZpaUFFWS9PUTJJZ1FzYkNKUW9xa0NBZ3BGTFh5b1pVUkxmd0JJaUlwZ3FaSm9ZUVlsV2VsTnNJck5PeERKY3J6ZkhlK0c5N2RuVGw3NXU3ZXV6djd6Z2NXSHJsblptZk9tWFBtekkvTmp1TTRqdU00anVNNGp1TTRqdU00anVNNGp1TTRqdU00NWZQaWMwOC91SGY1L0N2ZmZIN2xuVDhQZnJ0eGRIUzBuM3ArL2ZIR2w1Kzg5L3BycjU1OTlpRVdkOGJnMHJrWEhvRnlxZWhLbmx4UXBqWVNESFRtOUpNUHNHckh5bE9QUFhvZnZJQ0tYTWNJR3RYZGYvNzZBWWJtNnh5Tlc5ZS9lQXRLQzdyYktMWG52SEh4NVNmNGF1YzRFazdPUWtGVTFEYXAvdnYzN2svd1NqYmxaQU5GaUZJR3p3OThoaGl6d3FCZ3MwNG1DQmRRUk5DSGlkb0FFdFkrbExJdnRTZG9HRmV5cWwyWkg1N0hCSDRzRTdPK28vcjlsKzgvWlhVbmk2OCsyanNIQlFROXFOUkdlUC90U3hkU1lRWC9yb1VjcEw0L2YzdnRNOVREK2pUcTkybjFMUTdqeEYxaGhHUHR3V0wzZ0djY3k4SnVTMXI4c1ZXQkdYTlZkU0tNWWpCR1BVSmpDem9vaUd1U3Bud2xubk9HUDJkaEhSU0xOZ3BIcDJvTUtJcmlLOFRtRzRRaC9yd1c4RDZwcHM5YjlpbStMRERpcFhPcU1WSnJBbmdCZmc5aTk4Z2V2V0tBKy9ubkNvZDNEcjVHZmFIYURnaWRWeW02SEtSakdJa3BxdGhjQVZLR3hOcUJJbWJFbzY2a2pDaWg4QU9wTm1rVW1iTXVVclI4a0VxaVU2RnZIWkxHQVBKNzFKQ1lTeWhpQnFtd0ZFMkdvRDZqTEdJZkRIdEc2RXpvVTRkSzIxUENxSVJNRUYwRkdSakZ6R0R0SWtYVkFkQVR2c3FmVDlDSjBKY09GZFlpRklzaU1scVl5MVlPRnBRbzJPZGRxQnR5RWFxOXkrZWZvVmg1b1BIb1JPakxLbjBqM0pJRTVLYThVcVpSdEdyTW5uZVg2eVZvZk9oRGg5NE1TYnpuVGNwcW1ET3QxdnlRek9nYUpBRjRGM0pCZklYZXNyTkVHV1dtaklYN1VCWjZqUkpiQk1MZy9EbUppS1VHVkhsZUlwblZOVGEramFremtBdmlKcUxoaTRNQzlYUUdCclplS0paRVNTckt5N2lrMFZHRldoUUJSRFRISUFDS1E1bDluQWp5NzVneWE0YTJ3K0poczBGSmRjMHhYL0d3VWJBcUZCa1ppN1FwSjJ3MTZXVWJqRnlLOU1KRjNLYW9FTTc0S2hWdExyUU9yc21SeGtiZEhFcW1TQy9jK0V1R25JRmtqVzdJaDJLcjRDQ01Jdk5HMmhycmdMcENqaUZsb29vWUNqeVlyekNSeXZoeUJ0aGtJUHVRdHNaR2RuYk1UZXp5RGlVNzFLVEM1enI3YVZzSGJzejJ0bGxyRWtTNVVId1UxdHExSGJ0UFc0VWJlQjBPN3h4OFI1RXNNSnFsK0JoZVVtSGprTlZtSVJQN0x1dG9NMytENE80dEc3dkNrTk85RVNaNGxMM0o2cktSTVB4NHFLYkQvQTBpY2Y4Q0c3dEM3a1RhaG5NVHdsZXVZU3JzUzdHYXRSQXZmWmgxdFRtNUJtbVFDZFo4YTBTZWZlMjh4VXJSQmttRkxLeThLVElLVURSWDBZMXhhZ1Bnd2JhSWRlRm5RVUxtS2FrM3h2d05Na1ZHZ29rL041WE5vZWhKdmVqUmxDRGw5ZXNjSTI4ZEpVMHRaKytuQlRKRTltRUY2NDd4NUVoYm80czVoRE9LRklVMFBkb2ZlQTVGNWsxcTYzeklXbVFxTkkvUDNadWJqRlRxS3hRM2p5akhBT1gwUmRsZ1ZPOWh6UkZwY3pSY2paM0dieHhwYzdRajYrNXBUWUYyT0ZYYXdOSSt5REdmMWsyTmN2T2x6QlFlRFEvdDd6RDdEc0VEcEoyeEFUWGFOdERXVVM0SXpQNERTMmxqYWpBVnU1N1NVa1l3MjQ1cHR4WnhBNUppWmFKMERzd3VkR24za1lVeTU0NDI2RWpvVDRkWmZZYmNjeEMybkk5MmNEa1pIUXI5NmpENEFHa01ES2VTeS9DT0JzUmU2VlRTS0ZONmlyTGVhQ2gzSXRlUWp0MUU1K291ZHNHL2IvMkRmWjVBcXNZbzh2TURLOUxCMUh6U3NMV3ZsR1RoZHhYdkM2K05zcXlQUFdQMHBNSU50YmRzYWpmVmVDNmYvR1orY2RBb2ZRb0IxZCtIZjl3YVk5OEk3K1JYV2FiM0x0NHpZa2pIdFRubE9MWEhZTXNDaDF6V2VRWWVodTF6Zk5QT09peXMvZDkxTEFLRUJTZ2g2TUpNYlNBODJBYUhvZkRnQUl3Ymd2VnZsTE5TMTFuTW9kTW00VVplcmdMSFpCWnJvZG1CdUEzbEJCMXRoZG9yU2prT21BVE1Ed2cvVUJRVnRnbHFReXg2ZmJFSitIM0lXSWFwallBakFmZUlnZUNNSGxkdWVKdkZhcURhQUhod2Y4cU5zRUVRMWlRYk9vVVVHSWJDTFJjOCtCdmZwNGp5ZDJGRWlqdU80emlPNHppTzR6aU80emlPNHppTzR6aU80emlPVXp3N08vOEQwUDdyY1ovR0Vib0FBQUFBU1VWT1JLNUNZSUk9XCIsbi5zdHlsZS5wb3NpdGlvbj1cImFic29sdXRlXCIsbi5zdHlsZS5sZWZ0PVwiNTAlXCIsbi5zdHlsZS50b3A9XCI1MCVcIixuLnN0eWxlLm1hcmdpbkxlZnQ9XCItNTBweFwiLG4uc3R5bGUubWFyZ2luVG9wPVwiLTUwcHhcIix0aGlzLl9sb2FkaW5nRGl2LmFwcGVuZENoaWxkKG4pLHRoaXMuX3Jlc2l6ZUxvYWRpbmdVSSgpLHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicmVzaXplXCIsdGhpcy5fcmVzaXplTG9hZGluZ1VJKSx0aGlzLl9sb2FkaW5nRGl2LnN0eWxlLmJhY2tncm91bmRDb2xvcj10aGlzLl9sb2FkaW5nRGl2QmFja2dyb3VuZENvbG9yLGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodGhpcy5fbG9hZGluZ0Rpdiksc2V0VGltZW91dChmdW5jdGlvbigpe2UuX2xvYWRpbmdEaXYuc3R5bGUub3BhY2l0eT1cIjFcIix0LnN0eWxlLnRyYW5zZm9ybT1cInJvdGF0ZVooMzYwZGVnKVwiLHQuc3R5bGUud2Via2l0VHJhbnNmb3JtPVwicm90YXRlWigzNjBkZWcpXCJ9LDApfX0sZS5wcm90b3R5cGUuaGlkZUxvYWRpbmdVST1mdW5jdGlvbigpe3ZhciBlPXRoaXM7aWYodGhpcy5fbG9hZGluZ0Rpdil7dmFyIHQ9ZnVuY3Rpb24oKXtlLl9sb2FkaW5nRGl2JiYoZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChlLl9sb2FkaW5nRGl2KSx3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInJlc2l6ZVwiLGUuX3Jlc2l6ZUxvYWRpbmdVSSksZS5fbG9hZGluZ0Rpdj1udWxsKX07dGhpcy5fbG9hZGluZ0Rpdi5zdHlsZS5vcGFjaXR5PVwiMFwiLHRoaXMuX2xvYWRpbmdEaXYuYWRkRXZlbnRMaXN0ZW5lcihcInRyYW5zaXRpb25lbmRcIix0KX19LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLnByb3RvdHlwZSxcImxvYWRpbmdVSVRleHRcIix7c2V0OmZ1bmN0aW9uKGUpe3RoaXMuX2xvYWRpbmdUZXh0PWUsdGhpcy5fbG9hZGluZ1RleHREaXYmJih0aGlzLl9sb2FkaW5nVGV4dERpdi5pbm5lckhUTUw9dGhpcy5fbG9hZGluZ1RleHQpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLnByb3RvdHlwZSxcImxvYWRpbmdVSUJhY2tncm91bmRDb2xvclwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fbG9hZGluZ0RpdkJhY2tncm91bmRDb2xvcn0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX2xvYWRpbmdEaXZCYWNrZ3JvdW5kQ29sb3I9ZSx0aGlzLl9sb2FkaW5nRGl2JiYodGhpcy5fbG9hZGluZ0Rpdi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3I9dGhpcy5fbG9hZGluZ0RpdkJhY2tncm91bmRDb2xvcil9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksZX0oKTtlLkRlZmF1bHRMb2FkaW5nU2NyZWVuPXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCgpe3RoaXMuX2F1ZGlvQ29udGV4dD1udWxsLHRoaXMuX2F1ZGlvQ29udGV4dEluaXRpYWxpemVkPSExLHRoaXMuY2FuVXNlV2ViQXVkaW89ITEsdGhpcy5XYXJuZWRXZWJBdWRpb1Vuc3VwcG9ydGVkPSExLHRoaXMudW5sb2NrZWQ9ITEsXCJ1bmRlZmluZWRcIj09dHlwZW9mIHdpbmRvdy5BdWRpb0NvbnRleHQmJlwidW5kZWZpbmVkXCI9PXR5cGVvZiB3aW5kb3cud2Via2l0QXVkaW9Db250ZXh0fHwod2luZG93LkF1ZGlvQ29udGV4dD13aW5kb3cuQXVkaW9Db250ZXh0fHx3aW5kb3cud2Via2l0QXVkaW9Db250ZXh0LHRoaXMuY2FuVXNlV2ViQXVkaW89ITApLC9pUGFkfGlQaG9uZXxpUG9kLy50ZXN0KG5hdmlnYXRvci5wbGF0Zm9ybSk/dGhpcy5fdW5sb2NraU9TYXVkaW8oKTp0aGlzLnVubG9ja2VkPSEwfXJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJhdWRpb0NvbnRleHRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2F1ZGlvQ29udGV4dEluaXRpYWxpemVkfHx0aGlzLl9pbml0aWFsaXplQXVkaW9Db250ZXh0KCksdGhpcy5fYXVkaW9Db250ZXh0fSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLHQucHJvdG90eXBlLl91bmxvY2tpT1NhdWRpbz1mdW5jdGlvbigpe3ZhciBlPXRoaXMsdD1mdW5jdGlvbigpe3ZhciBpPWUuYXVkaW9Db250ZXh0LmNyZWF0ZUJ1ZmZlcigxLDEsMjIwNTApLHI9ZS5hdWRpb0NvbnRleHQuY3JlYXRlQnVmZmVyU291cmNlKCk7ci5idWZmZXI9aSxyLmNvbm5lY3QoZS5hdWRpb0NvbnRleHQuZGVzdGluYXRpb24pLHIuc3RhcnQoMCksc2V0VGltZW91dChmdW5jdGlvbigpe3IucGxheWJhY2tTdGF0ZSE9PXIuUExBWUlOR19TVEFURSYmci5wbGF5YmFja1N0YXRlIT09ci5GSU5JU0hFRF9TVEFURXx8KGUudW5sb2NrZWQ9ITAsd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ0b3VjaGVuZFwiLHQsITEpLGUub25BdWRpb1VubG9ja2VkJiZlLm9uQXVkaW9VbmxvY2tlZCgpKX0sMCl9O3dpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hlbmRcIix0LCExKX0sdC5wcm90b3R5cGUuX2luaXRpYWxpemVBdWRpb0NvbnRleHQ9ZnVuY3Rpb24oKXt0cnl7dGhpcy5jYW5Vc2VXZWJBdWRpbyYmKHRoaXMuX2F1ZGlvQ29udGV4dD1uZXcgQXVkaW9Db250ZXh0LHRoaXMubWFzdGVyR2Fpbj10aGlzLl9hdWRpb0NvbnRleHQuY3JlYXRlR2FpbigpLHRoaXMubWFzdGVyR2Fpbi5nYWluLnZhbHVlPTEsdGhpcy5tYXN0ZXJHYWluLmNvbm5lY3QodGhpcy5fYXVkaW9Db250ZXh0LmRlc3RpbmF0aW9uKSx0aGlzLl9hdWRpb0NvbnRleHRJbml0aWFsaXplZD0hMCl9Y2F0Y2godCl7dGhpcy5jYW5Vc2VXZWJBdWRpbz0hMSxlLlRvb2xzLkVycm9yKFwiV2ViIEF1ZGlvOiBcIit0Lm1lc3NhZ2UpfX0sdC5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3RoaXMuY2FuVXNlV2ViQXVkaW8mJnRoaXMuX2F1ZGlvQ29udGV4dEluaXRpYWxpemVkJiYodGhpcy5fY29ubmVjdGVkQW5hbHlzZXImJih0aGlzLl9jb25uZWN0ZWRBbmFseXNlci5zdG9wRGVidWdDYW52YXMoKSx0aGlzLl9jb25uZWN0ZWRBbmFseXNlci5kaXNwb3NlKCksdGhpcy5tYXN0ZXJHYWluLmRpc2Nvbm5lY3QoKSx0aGlzLm1hc3RlckdhaW4uY29ubmVjdCh0aGlzLl9hdWRpb0NvbnRleHQuZGVzdGluYXRpb24pLHRoaXMuX2Nvbm5lY3RlZEFuYWx5c2VyPW51bGwpLHRoaXMubWFzdGVyR2Fpbi5nYWluLnZhbHVlPTEpLHRoaXMuV2FybmVkV2ViQXVkaW9VbnN1cHBvcnRlZD0hMX0sdC5wcm90b3R5cGUuZ2V0R2xvYmFsVm9sdW1lPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY2FuVXNlV2ViQXVkaW8mJnRoaXMuX2F1ZGlvQ29udGV4dEluaXRpYWxpemVkP3RoaXMubWFzdGVyR2Fpbi5nYWluLnZhbHVlOi0xfSx0LnByb3RvdHlwZS5zZXRHbG9iYWxWb2x1bWU9ZnVuY3Rpb24oZSl7dGhpcy5jYW5Vc2VXZWJBdWRpbyYmdGhpcy5fYXVkaW9Db250ZXh0SW5pdGlhbGl6ZWQmJih0aGlzLm1hc3RlckdhaW4uZ2Fpbi52YWx1ZT1lKX0sdC5wcm90b3R5cGUuY29ubmVjdFRvQW5hbHlzZXI9ZnVuY3Rpb24oZSl7dGhpcy5fY29ubmVjdGVkQW5hbHlzZXImJnRoaXMuX2Nvbm5lY3RlZEFuYWx5c2VyLnN0b3BEZWJ1Z0NhbnZhcygpLHRoaXMuY2FuVXNlV2ViQXVkaW8mJnRoaXMuX2F1ZGlvQ29udGV4dEluaXRpYWxpemVkJiYodGhpcy5fY29ubmVjdGVkQW5hbHlzZXI9ZSx0aGlzLm1hc3RlckdhaW4uZGlzY29ubmVjdCgpLHRoaXMuX2Nvbm5lY3RlZEFuYWx5c2VyLmNvbm5lY3RBdWRpb05vZGVzKHRoaXMubWFzdGVyR2Fpbix0aGlzLl9hdWRpb0NvbnRleHQuZGVzdGluYXRpb24pKX0sdH0oKTtlLkF1ZGlvRW5naW5lPXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGkscixuLG8pe3ZhciBzPXRoaXM7dGhpcy5hdXRvcGxheT0hMSx0aGlzLmxvb3A9ITEsdGhpcy51c2VDdXN0b21BdHRlbnVhdGlvbj0hMSx0aGlzLnNwYXRpYWxTb3VuZD0hMSx0aGlzLnJlZkRpc3RhbmNlPTEsdGhpcy5yb2xsb2ZmRmFjdG9yPTEsdGhpcy5tYXhEaXN0YW5jZT0xMDAsdGhpcy5kaXN0YW5jZU1vZGVsPVwibGluZWFyXCIsdGhpcy5fcGFubmluZ01vZGVsPVwiZXF1YWxwb3dlclwiLHRoaXMuX3BsYXliYWNrUmF0ZT0xLHRoaXMuX3N0cmVhbWluZz0hMSx0aGlzLl9zdGFydFRpbWU9MCx0aGlzLl9zdGFydE9mZnNldD0wLHRoaXMuX3Bvc2l0aW9uPWUuVmVjdG9yMy5aZXJvKCksdGhpcy5fbG9jYWxEaXJlY3Rpb249bmV3IGUuVmVjdG9yMygxLDAsMCksdGhpcy5fdm9sdW1lPTEsdGhpcy5faXNMb2FkZWQ9ITEsdGhpcy5faXNSZWFkeVRvUGxheT0hMSx0aGlzLmlzUGxheWluZz0hMSx0aGlzLmlzUGF1c2VkPSExLHRoaXMuX2lzRGlyZWN0aW9uYWw9ITEsdGhpcy5fY29uZUlubmVyQW5nbGU9MzYwLHRoaXMuX2NvbmVPdXRlckFuZ2xlPTM2MCx0aGlzLl9jb25lT3V0ZXJHYWluPTAsdGhpcy5faXNPdXRwdXRDb25uZWN0ZWQ9ITEsdGhpcy5uYW1lPXQsdGhpcy5fc2NlbmU9cix0aGlzLl9yZWFkeVRvUGxheUNhbGxiYWNrPW4sdGhpcy5fY3VzdG9tQXR0ZW51YXRpb25GdW5jdGlvbj1mdW5jdGlvbihlLHQsaSxyLG4pe3JldHVybiBpPnQ/ZSooMS10L2kpOjB9LG8mJih0aGlzLmF1dG9wbGF5PW8uYXV0b3BsYXl8fCExLHRoaXMubG9vcD1vLmxvb3B8fCExLHZvaWQgMCE9PW8udm9sdW1lJiYodGhpcy5fdm9sdW1lPW8udm9sdW1lKSx0aGlzLnNwYXRpYWxTb3VuZD1vLnNwYXRpYWxTb3VuZHx8ITEsdGhpcy5tYXhEaXN0YW5jZT1vLm1heERpc3RhbmNlfHwxMDAsdGhpcy51c2VDdXN0b21BdHRlbnVhdGlvbj1vLnVzZUN1c3RvbUF0dGVudWF0aW9ufHwhMSx0aGlzLnJvbGxvZmZGYWN0b3I9by5yb2xsb2ZmRmFjdG9yfHwxLHRoaXMucmVmRGlzdGFuY2U9by5yZWZEaXN0YW5jZXx8MSx0aGlzLmRpc3RhbmNlTW9kZWw9by5kaXN0YW5jZU1vZGVsfHxcImxpbmVhclwiLHRoaXMuX3BsYXliYWNrUmF0ZT1vLnBsYXliYWNrUmF0ZXx8MSx0aGlzLl9zdHJlYW1pbmc9by5zdHJlYW1pbmd8fCExKSxlLkVuZ2luZS5hdWRpb0VuZ2luZS5jYW5Vc2VXZWJBdWRpbz8odGhpcy5fc291bmRHYWluPWUuRW5naW5lLmF1ZGlvRW5naW5lLmF1ZGlvQ29udGV4dC5jcmVhdGVHYWluKCksdGhpcy5fc291bmRHYWluLmdhaW4udmFsdWU9dGhpcy5fdm9sdW1lLHRoaXMuX2lucHV0QXVkaW9Ob2RlPXRoaXMuX3NvdW5kR2Fpbix0aGlzLl9vdXB1dEF1ZGlvTm9kZT10aGlzLl9zb3VuZEdhaW4sdGhpcy5zcGF0aWFsU291bmQmJnRoaXMuX2NyZWF0ZVNwYXRpYWxQYXJhbWV0ZXJzKCksdGhpcy5fc2NlbmUubWFpblNvdW5kVHJhY2suQWRkU291bmQodGhpcyksaSYmKFwic3RyaW5nXCI9PXR5cGVvZiBpP3RoaXMuX3N0cmVhbWluZz8odGhpcy5faHRtbEF1ZGlvRWxlbWVudD1uZXcgQXVkaW8oaSksdGhpcy5faHRtbEF1ZGlvRWxlbWVudC5jb250cm9scz0hMSx0aGlzLl9odG1sQXVkaW9FbGVtZW50Lmxvb3A9dGhpcy5sb29wLHRoaXMuX2h0bWxBdWRpb0VsZW1lbnQuY3Jvc3NPcmlnaW49XCJhbm9ueW1vdXNcIix0aGlzLl9odG1sQXVkaW9FbGVtZW50LnByZWxvYWQ9XCJhdXRvXCIsdGhpcy5faHRtbEF1ZGlvRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2FucGxheXRocm91Z2hcIixmdW5jdGlvbigpe3MuX2lzUmVhZHlUb1BsYXk9ITAscy5hdXRvcGxheSYmcy5wbGF5KCkscy5fcmVhZHlUb1BsYXlDYWxsYmFjayYmcy5fcmVhZHlUb1BsYXlDYWxsYmFjaygpfSksZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0aGlzLl9odG1sQXVkaW9FbGVtZW50KSk6ZS5Ub29scy5Mb2FkRmlsZShpLGZ1bmN0aW9uKGUpe3MuX3NvdW5kTG9hZGVkKGUpfSxudWxsLHRoaXMuX3NjZW5lLmRhdGFiYXNlLCEwKTppIGluc3RhbmNlb2YgQXJyYXlCdWZmZXI/aS5ieXRlTGVuZ3RoPjAmJnRoaXMuX3NvdW5kTG9hZGVkKGkpOmUuVG9vbHMuRXJyb3IoXCJQYXJhbWV0ZXIgbXVzdCBiZSBhIFVSTCB0byB0aGUgc291bmQgb3IgYW4gQXJyYXlCdWZmZXIgb2YgdGhlIHNvdW5kLlwiKSkpOih0aGlzLl9zY2VuZS5tYWluU291bmRUcmFjay5BZGRTb3VuZCh0aGlzKSxlLkVuZ2luZS5hdWRpb0VuZ2luZS5XYXJuZWRXZWJBdWRpb1Vuc3VwcG9ydGVkfHwoZS5Ub29scy5FcnJvcihcIldlYiBBdWRpbyBpcyBub3Qgc3VwcG9ydGVkIGJ5IHlvdXIgYnJvd3Nlci5cIiksZS5FbmdpbmUuYXVkaW9FbmdpbmUuV2FybmVkV2ViQXVkaW9VbnN1cHBvcnRlZD0hMCksdGhpcy5fcmVhZHlUb1BsYXlDYWxsYmFjayYmd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKXtzLl9yZWFkeVRvUGxheUNhbGxiYWNrKCl9LDFlMykpfXJldHVybiB0LnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7ZS5FbmdpbmUuYXVkaW9FbmdpbmUuY2FuVXNlV2ViQXVkaW8mJnRoaXMuX2lzUmVhZHlUb1BsYXkmJih0aGlzLmlzUGxheWluZyYmdGhpcy5zdG9wKCksdGhpcy5faXNSZWFkeVRvUGxheT0hMSwtMT09PXRoaXMuc291bmRUcmFja0lkP3RoaXMuX3NjZW5lLm1haW5Tb3VuZFRyYWNrLlJlbW92ZVNvdW5kKHRoaXMpOnRoaXMuX3NjZW5lLnNvdW5kVHJhY2tzW3RoaXMuc291bmRUcmFja0lkXS5SZW1vdmVTb3VuZCh0aGlzKSx0aGlzLl9zb3VuZEdhaW4mJih0aGlzLl9zb3VuZEdhaW4uZGlzY29ubmVjdCgpLHRoaXMuX3NvdW5kR2Fpbj1udWxsKSx0aGlzLl9zb3VuZFBhbm5lciYmKHRoaXMuX3NvdW5kUGFubmVyLmRpc2Nvbm5lY3QoKSx0aGlzLl9zb3VuZFBhbm5lcj1udWxsKSx0aGlzLl9zb3VuZFNvdXJjZSYmKHRoaXMuX3NvdW5kU291cmNlLmRpc2Nvbm5lY3QoKSx0aGlzLl9zb3VuZFNvdXJjZT1udWxsKSx0aGlzLl9hdWRpb0J1ZmZlcj1udWxsLHRoaXMuX2h0bWxBdWRpb0VsZW1lbnQmJih0aGlzLl9odG1sQXVkaW9FbGVtZW50LnBhdXNlKCksdGhpcy5faHRtbEF1ZGlvRWxlbWVudC5zcmM9XCJcIixkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKHRoaXMuX2h0bWxBdWRpb0VsZW1lbnQpKSx0aGlzLl9jb25uZWN0ZWRNZXNoJiYodGhpcy5fY29ubmVjdGVkTWVzaC51bnJlZ2lzdGVyQWZ0ZXJXb3JsZE1hdHJpeFVwZGF0ZSh0aGlzLl9yZWdpc3RlckZ1bmMpLHRoaXMuX2Nvbm5lY3RlZE1lc2g9bnVsbCkpfSx0LnByb3RvdHlwZS5fc291bmRMb2FkZWQ9ZnVuY3Rpb24odCl7dmFyIGk9dGhpczt0aGlzLl9pc0xvYWRlZD0hMCxlLkVuZ2luZS5hdWRpb0VuZ2luZS5hdWRpb0NvbnRleHQuZGVjb2RlQXVkaW9EYXRhKHQsZnVuY3Rpb24oZSl7aS5fYXVkaW9CdWZmZXI9ZSxpLl9pc1JlYWR5VG9QbGF5PSEwLGkuYXV0b3BsYXkmJmkucGxheSgpLGkuX3JlYWR5VG9QbGF5Q2FsbGJhY2smJmkuX3JlYWR5VG9QbGF5Q2FsbGJhY2soKX0sZnVuY3Rpb24oKXtlLlRvb2xzLkVycm9yKFwiRXJyb3Igd2hpbGUgZGVjb2RpbmcgYXVkaW8gZGF0YSBmb3I6IFwiK2kubmFtZSl9KX0sdC5wcm90b3R5cGUuc2V0QXVkaW9CdWZmZXI9ZnVuY3Rpb24odCl7ZS5FbmdpbmUuYXVkaW9FbmdpbmUuY2FuVXNlV2ViQXVkaW8mJih0aGlzLl9hdWRpb0J1ZmZlcj10LHRoaXMuX2lzUmVhZHlUb1BsYXk9ITApfSx0LnByb3RvdHlwZS51cGRhdGVPcHRpb25zPWZ1bmN0aW9uKGUpe2UmJih0aGlzLmxvb3A9ZS5sb29wfHx0aGlzLmxvb3AsdGhpcy5tYXhEaXN0YW5jZT1lLm1heERpc3RhbmNlfHx0aGlzLm1heERpc3RhbmNlLHRoaXMudXNlQ3VzdG9tQXR0ZW51YXRpb249ZS51c2VDdXN0b21BdHRlbnVhdGlvbnx8dGhpcy51c2VDdXN0b21BdHRlbnVhdGlvbix0aGlzLnJvbGxvZmZGYWN0b3I9ZS5yb2xsb2ZmRmFjdG9yfHx0aGlzLnJvbGxvZmZGYWN0b3IsdGhpcy5yZWZEaXN0YW5jZT1lLnJlZkRpc3RhbmNlfHx0aGlzLnJlZkRpc3RhbmNlLHRoaXMuZGlzdGFuY2VNb2RlbD1lLmRpc3RhbmNlTW9kZWx8fHRoaXMuZGlzdGFuY2VNb2RlbCx0aGlzLl9wbGF5YmFja1JhdGU9ZS5wbGF5YmFja1JhdGV8fHRoaXMuX3BsYXliYWNrUmF0ZSx0aGlzLl91cGRhdGVTcGF0aWFsUGFyYW1ldGVycygpLHRoaXMuaXNQbGF5aW5nJiYodGhpcy5fc3RyZWFtaW5nP3RoaXMuX2h0bWxBdWRpb0VsZW1lbnQucGxheWJhY2tSYXRlPXRoaXMuX3BsYXliYWNrUmF0ZTp0aGlzLl9zb3VuZFNvdXJjZS5wbGF5YmFja1JhdGUudmFsdWU9dGhpcy5fcGxheWJhY2tSYXRlKSl9LHQucHJvdG90eXBlLl9jcmVhdGVTcGF0aWFsUGFyYW1ldGVycz1mdW5jdGlvbigpe2UuRW5naW5lLmF1ZGlvRW5naW5lLmNhblVzZVdlYkF1ZGlvJiYodGhpcy5fc2NlbmUuaGVhZHBob25lJiYodGhpcy5fcGFubmluZ01vZGVsPVwiSFJURlwiKSx0aGlzLl9zb3VuZFBhbm5lcj1lLkVuZ2luZS5hdWRpb0VuZ2luZS5hdWRpb0NvbnRleHQuY3JlYXRlUGFubmVyKCksdGhpcy5fdXBkYXRlU3BhdGlhbFBhcmFtZXRlcnMoKSx0aGlzLl9zb3VuZFBhbm5lci5jb25uZWN0KHRoaXMuX291cHV0QXVkaW9Ob2RlKSx0aGlzLl9pbnB1dEF1ZGlvTm9kZT10aGlzLl9zb3VuZFBhbm5lcil9LHQucHJvdG90eXBlLl91cGRhdGVTcGF0aWFsUGFyYW1ldGVycz1mdW5jdGlvbigpe3RoaXMuc3BhdGlhbFNvdW5kJiYodGhpcy51c2VDdXN0b21BdHRlbnVhdGlvbj8odGhpcy5fc291bmRQYW5uZXIuZGlzdGFuY2VNb2RlbD1cImxpbmVhclwiLHRoaXMuX3NvdW5kUGFubmVyLm1heERpc3RhbmNlPU51bWJlci5NQVhfVkFMVUUsdGhpcy5fc291bmRQYW5uZXIucmVmRGlzdGFuY2U9MSx0aGlzLl9zb3VuZFBhbm5lci5yb2xsb2ZmRmFjdG9yPTEsdGhpcy5fc291bmRQYW5uZXIucGFubmluZ01vZGVsPXRoaXMuX3Bhbm5pbmdNb2RlbCk6KHRoaXMuX3NvdW5kUGFubmVyLmRpc3RhbmNlTW9kZWw9dGhpcy5kaXN0YW5jZU1vZGVsLHRoaXMuX3NvdW5kUGFubmVyLm1heERpc3RhbmNlPXRoaXMubWF4RGlzdGFuY2UsdGhpcy5fc291bmRQYW5uZXIucmVmRGlzdGFuY2U9dGhpcy5yZWZEaXN0YW5jZSx0aGlzLl9zb3VuZFBhbm5lci5yb2xsb2ZmRmFjdG9yPXRoaXMucm9sbG9mZkZhY3Rvcix0aGlzLl9zb3VuZFBhbm5lci5wYW5uaW5nTW9kZWw9dGhpcy5fcGFubmluZ01vZGVsKSl9LHQucHJvdG90eXBlLnN3aXRjaFBhbm5pbmdNb2RlbFRvSFJURj1mdW5jdGlvbigpe3RoaXMuX3Bhbm5pbmdNb2RlbD1cIkhSVEZcIix0aGlzLl9zd2l0Y2hQYW5uaW5nTW9kZWwoKX0sdC5wcm90b3R5cGUuc3dpdGNoUGFubmluZ01vZGVsVG9FcXVhbFBvd2VyPWZ1bmN0aW9uKCl7dGhpcy5fcGFubmluZ01vZGVsPVwiZXF1YWxwb3dlclwiLHRoaXMuX3N3aXRjaFBhbm5pbmdNb2RlbCgpfSx0LnByb3RvdHlwZS5fc3dpdGNoUGFubmluZ01vZGVsPWZ1bmN0aW9uKCl7ZS5FbmdpbmUuYXVkaW9FbmdpbmUuY2FuVXNlV2ViQXVkaW8mJnRoaXMuc3BhdGlhbFNvdW5kJiYodGhpcy5fc291bmRQYW5uZXIucGFubmluZ01vZGVsPXRoaXMuX3Bhbm5pbmdNb2RlbCl9LHQucHJvdG90eXBlLmNvbm5lY3RUb1NvdW5kVHJhY2tBdWRpb05vZGU9ZnVuY3Rpb24odCl7ZS5FbmdpbmUuYXVkaW9FbmdpbmUuY2FuVXNlV2ViQXVkaW8mJih0aGlzLl9pc091dHB1dENvbm5lY3RlZCYmdGhpcy5fb3VwdXRBdWRpb05vZGUuZGlzY29ubmVjdCgpLHRoaXMuX291cHV0QXVkaW9Ob2RlLmNvbm5lY3QodCksdGhpcy5faXNPdXRwdXRDb25uZWN0ZWQ9ITApfSx0LnByb3RvdHlwZS5zZXREaXJlY3Rpb25hbENvbmU9ZnVuY3Rpb24odCxpLHIpe3JldHVybiB0Pmk/dm9pZCBlLlRvb2xzLkVycm9yKFwic2V0RGlyZWN0aW9uYWxDb25lKCk6IG91dGVyIGFuZ2xlIG9mIHRoZSBjb25lIG11c3QgYmUgc3VwZXJpb3Igb3IgZXF1YWwgdG8gdGhlIGlubmVyIGFuZ2xlLlwiKToodGhpcy5fY29uZUlubmVyQW5nbGU9dCx0aGlzLl9jb25lT3V0ZXJBbmdsZT1pLHRoaXMuX2NvbmVPdXRlckdhaW49cix0aGlzLl9pc0RpcmVjdGlvbmFsPSEwLHZvaWQodGhpcy5pc1BsYXlpbmcmJnRoaXMubG9vcCYmKHRoaXMuc3RvcCgpLHRoaXMucGxheSgpKSkpfSx0LnByb3RvdHlwZS5zZXRQb3NpdGlvbj1mdW5jdGlvbih0KXt0aGlzLl9wb3NpdGlvbj10LGUuRW5naW5lLmF1ZGlvRW5naW5lLmNhblVzZVdlYkF1ZGlvJiZ0aGlzLnNwYXRpYWxTb3VuZCYmdGhpcy5fc291bmRQYW5uZXIuc2V0UG9zaXRpb24odGhpcy5fcG9zaXRpb24ueCx0aGlzLl9wb3NpdGlvbi55LHRoaXMuX3Bvc2l0aW9uLnopfSx0LnByb3RvdHlwZS5zZXRMb2NhbERpcmVjdGlvblRvTWVzaD1mdW5jdGlvbih0KXt0aGlzLl9sb2NhbERpcmVjdGlvbj10LGUuRW5naW5lLmF1ZGlvRW5naW5lLmNhblVzZVdlYkF1ZGlvJiZ0aGlzLl9jb25uZWN0ZWRNZXNoJiZ0aGlzLmlzUGxheWluZyYmdGhpcy5fdXBkYXRlRGlyZWN0aW9uKCl9LHQucHJvdG90eXBlLl91cGRhdGVEaXJlY3Rpb249ZnVuY3Rpb24oKXt2YXIgdD10aGlzLl9jb25uZWN0ZWRNZXNoLmdldFdvcmxkTWF0cml4KCksaT1lLlZlY3RvcjMuVHJhbnNmb3JtTm9ybWFsKHRoaXMuX2xvY2FsRGlyZWN0aW9uLHQpO2kubm9ybWFsaXplKCksdGhpcy5fc291bmRQYW5uZXIuc2V0T3JpZW50YXRpb24oaS54LGkueSxpLnopfSx0LnByb3RvdHlwZS51cGRhdGVEaXN0YW5jZUZyb21MaXN0ZW5lcj1mdW5jdGlvbigpe2lmKGUuRW5naW5lLmF1ZGlvRW5naW5lLmNhblVzZVdlYkF1ZGlvJiZ0aGlzLl9jb25uZWN0ZWRNZXNoJiZ0aGlzLnVzZUN1c3RvbUF0dGVudWF0aW9uKXt2YXIgdD10aGlzLl9jb25uZWN0ZWRNZXNoLmdldERpc3RhbmNlVG9DYW1lcmEodGhpcy5fc2NlbmUuYWN0aXZlQ2FtZXJhKTt0aGlzLl9zb3VuZEdhaW4uZ2Fpbi52YWx1ZT10aGlzLl9jdXN0b21BdHRlbnVhdGlvbkZ1bmN0aW9uKHRoaXMuX3ZvbHVtZSx0LHRoaXMubWF4RGlzdGFuY2UsdGhpcy5yZWZEaXN0YW5jZSx0aGlzLnJvbGxvZmZGYWN0b3IpfX0sdC5wcm90b3R5cGUuc2V0QXR0ZW51YXRpb25GdW5jdGlvbj1mdW5jdGlvbihlKXt0aGlzLl9jdXN0b21BdHRlbnVhdGlvbkZ1bmN0aW9uPWV9LHQucHJvdG90eXBlLnBsYXk9ZnVuY3Rpb24odCl7dmFyIGk9dGhpcztpZih0aGlzLl9pc1JlYWR5VG9QbGF5JiZ0aGlzLl9zY2VuZS5hdWRpb0VuYWJsZWQpdHJ5e3RoaXMuX3N0YXJ0T2Zmc2V0PDAmJih0PS10aGlzLl9zdGFydE9mZnNldCx0aGlzLl9zdGFydE9mZnNldD0wKTt2YXIgcj10P2UuRW5naW5lLmF1ZGlvRW5naW5lLmF1ZGlvQ29udGV4dC5jdXJyZW50VGltZSt0OmUuRW5naW5lLmF1ZGlvRW5naW5lLmF1ZGlvQ29udGV4dC5jdXJyZW50VGltZTt0aGlzLl9zb3VuZFNvdXJjZSYmdGhpcy5fc3RyZWFtaW5nU291cmNlfHx0aGlzLnNwYXRpYWxTb3VuZCYmKHRoaXMuX3NvdW5kUGFubmVyLnNldFBvc2l0aW9uKHRoaXMuX3Bvc2l0aW9uLngsdGhpcy5fcG9zaXRpb24ueSx0aGlzLl9wb3NpdGlvbi56KSx0aGlzLl9pc0RpcmVjdGlvbmFsJiYodGhpcy5fc291bmRQYW5uZXIuY29uZUlubmVyQW5nbGU9dGhpcy5fY29uZUlubmVyQW5nbGUsdGhpcy5fc291bmRQYW5uZXIuY29uZU91dGVyQW5nbGU9dGhpcy5fY29uZU91dGVyQW5nbGUsdGhpcy5fc291bmRQYW5uZXIuY29uZU91dGVyR2Fpbj10aGlzLl9jb25lT3V0ZXJHYWluLHRoaXMuX2Nvbm5lY3RlZE1lc2g/dGhpcy5fdXBkYXRlRGlyZWN0aW9uKCk6dGhpcy5fc291bmRQYW5uZXIuc2V0T3JpZW50YXRpb24odGhpcy5fbG9jYWxEaXJlY3Rpb24ueCx0aGlzLl9sb2NhbERpcmVjdGlvbi55LHRoaXMuX2xvY2FsRGlyZWN0aW9uLnopKSksdGhpcy5fc3RyZWFtaW5nPyh0aGlzLl9zdHJlYW1pbmdTb3VyY2V8fCh0aGlzLl9zdHJlYW1pbmdTb3VyY2U9ZS5FbmdpbmUuYXVkaW9FbmdpbmUuYXVkaW9Db250ZXh0LmNyZWF0ZU1lZGlhRWxlbWVudFNvdXJjZSh0aGlzLl9odG1sQXVkaW9FbGVtZW50KSx0aGlzLl9odG1sQXVkaW9FbGVtZW50Lm9uZW5kZWQ9ZnVuY3Rpb24oKXtpLl9vbmVuZGVkKCl9LHRoaXMuX2h0bWxBdWRpb0VsZW1lbnQucGxheWJhY2tSYXRlPXRoaXMuX3BsYXliYWNrUmF0ZSksdGhpcy5fc3RyZWFtaW5nU291cmNlLmRpc2Nvbm5lY3QoKSx0aGlzLl9zdHJlYW1pbmdTb3VyY2UuY29ubmVjdCh0aGlzLl9pbnB1dEF1ZGlvTm9kZSksdGhpcy5faHRtbEF1ZGlvRWxlbWVudC5wbGF5KCkpOih0aGlzLl9zb3VuZFNvdXJjZT1lLkVuZ2luZS5hdWRpb0VuZ2luZS5hdWRpb0NvbnRleHQuY3JlYXRlQnVmZmVyU291cmNlKCksdGhpcy5fc291bmRTb3VyY2UuYnVmZmVyPXRoaXMuX2F1ZGlvQnVmZmVyLHRoaXMuX3NvdW5kU291cmNlLmNvbm5lY3QodGhpcy5faW5wdXRBdWRpb05vZGUpLHRoaXMuX3NvdW5kU291cmNlLmxvb3A9dGhpcy5sb29wLHRoaXMuX3NvdW5kU291cmNlLnBsYXliYWNrUmF0ZS52YWx1ZT10aGlzLl9wbGF5YmFja1JhdGUsdGhpcy5fc291bmRTb3VyY2Uub25lbmRlZD1mdW5jdGlvbigpe2kuX29uZW5kZWQoKX0sdGhpcy5fc291bmRTb3VyY2Uuc3RhcnQocix0aGlzLmlzUGF1c2VkP3RoaXMuX3N0YXJ0T2Zmc2V0JXRoaXMuX3NvdW5kU291cmNlLmJ1ZmZlci5kdXJhdGlvbjowKSksdGhpcy5fc3RhcnRUaW1lPXIsdGhpcy5pc1BsYXlpbmc9ITAsdGhpcy5pc1BhdXNlZD0hMX1jYXRjaChuKXtlLlRvb2xzLkVycm9yKFwiRXJyb3Igd2hpbGUgdHJ5aW5nIHRvIHBsYXkgYXVkaW86IFwiK3RoaXMubmFtZStcIiwgXCIrbi5tZXNzYWdlKX19LHQucHJvdG90eXBlLl9vbmVuZGVkPWZ1bmN0aW9uKCl7dGhpcy5pc1BsYXlpbmc9ITEsdGhpcy5vbmVuZGVkJiZ0aGlzLm9uZW5kZWQoKX0sdC5wcm90b3R5cGUuc3RvcD1mdW5jdGlvbih0KXtpZih0aGlzLmlzUGxheWluZyl7aWYodGhpcy5fc3RyZWFtaW5nKXRoaXMuX2h0bWxBdWRpb0VsZW1lbnQucGF1c2UoKSx0aGlzLl9odG1sQXVkaW9FbGVtZW50LmN1cnJlbnRUaW1lPjAmJih0aGlzLl9odG1sQXVkaW9FbGVtZW50LmN1cnJlbnRUaW1lPTApO2Vsc2V7dmFyIGk9dD9lLkVuZ2luZS5hdWRpb0VuZ2luZS5hdWRpb0NvbnRleHQuY3VycmVudFRpbWUrdDplLkVuZ2luZS5hdWRpb0VuZ2luZS5hdWRpb0NvbnRleHQuY3VycmVudFRpbWU7dGhpcy5fc291bmRTb3VyY2Uuc3RvcChpKSx0aGlzLl9zb3VuZFNvdXJjZS5vbmVuZGVkPW51bGwsdGhpcy5pc1BhdXNlZHx8KHRoaXMuX3N0YXJ0T2Zmc2V0PTApfXRoaXMuaXNQbGF5aW5nPSExfX0sdC5wcm90b3R5cGUucGF1c2U9ZnVuY3Rpb24oKXt0aGlzLmlzUGxheWluZyYmKHRoaXMuaXNQYXVzZWQ9ITAsdGhpcy5fc3RyZWFtaW5nP3RoaXMuX2h0bWxBdWRpb0VsZW1lbnQucGF1c2UoKToodGhpcy5zdG9wKDApLHRoaXMuX3N0YXJ0T2Zmc2V0Kz1lLkVuZ2luZS5hdWRpb0VuZ2luZS5hdWRpb0NvbnRleHQuY3VycmVudFRpbWUtdGhpcy5fc3RhcnRUaW1lKSl9LHQucHJvdG90eXBlLnNldFZvbHVtZT1mdW5jdGlvbih0LGkpe2UuRW5naW5lLmF1ZGlvRW5naW5lLmNhblVzZVdlYkF1ZGlvJiYoaT8odGhpcy5fc291bmRHYWluLmdhaW4uY2FuY2VsU2NoZWR1bGVkVmFsdWVzKGUuRW5naW5lLmF1ZGlvRW5naW5lLmF1ZGlvQ29udGV4dC5jdXJyZW50VGltZSksdGhpcy5fc291bmRHYWluLmdhaW4uc2V0VmFsdWVBdFRpbWUodGhpcy5fc291bmRHYWluLmdhaW4udmFsdWUsZS5FbmdpbmUuYXVkaW9FbmdpbmUuYXVkaW9Db250ZXh0LmN1cnJlbnRUaW1lKSx0aGlzLl9zb3VuZEdhaW4uZ2Fpbi5saW5lYXJSYW1wVG9WYWx1ZUF0VGltZSh0LGUuRW5naW5lLmF1ZGlvRW5naW5lLmF1ZGlvQ29udGV4dC5jdXJyZW50VGltZStpKSk6dGhpcy5fc291bmRHYWluLmdhaW4udmFsdWU9dCksdGhpcy5fdm9sdW1lPXR9LHQucHJvdG90eXBlLnNldFBsYXliYWNrUmF0ZT1mdW5jdGlvbihlKXt0aGlzLl9wbGF5YmFja1JhdGU9ZSx0aGlzLmlzUGxheWluZyYmKHRoaXMuX3N0cmVhbWluZz90aGlzLl9odG1sQXVkaW9FbGVtZW50LnBsYXliYWNrUmF0ZT10aGlzLl9wbGF5YmFja1JhdGU6dGhpcy5fc291bmRTb3VyY2UucGxheWJhY2tSYXRlLnZhbHVlPXRoaXMuX3BsYXliYWNrUmF0ZSl9LHQucHJvdG90eXBlLmdldFZvbHVtZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLl92b2x1bWV9LHQucHJvdG90eXBlLmF0dGFjaFRvTWVzaD1mdW5jdGlvbihlKXt2YXIgdD10aGlzO3RoaXMuX2Nvbm5lY3RlZE1lc2gmJih0aGlzLl9jb25uZWN0ZWRNZXNoLnVucmVnaXN0ZXJBZnRlcldvcmxkTWF0cml4VXBkYXRlKHRoaXMuX3JlZ2lzdGVyRnVuYyksdGhpcy5fcmVnaXN0ZXJGdW5jPW51bGwpLHRoaXMuX2Nvbm5lY3RlZE1lc2g9ZSx0aGlzLnNwYXRpYWxTb3VuZHx8KHRoaXMuc3BhdGlhbFNvdW5kPSEwLHRoaXMuX2NyZWF0ZVNwYXRpYWxQYXJhbWV0ZXJzKCksdGhpcy5pc1BsYXlpbmcmJnRoaXMubG9vcCYmKHRoaXMuc3RvcCgpLHRoaXMucGxheSgpKSksdGhpcy5fb25SZWdpc3RlckFmdGVyV29ybGRNYXRyaXhVcGRhdGUodGhpcy5fY29ubmVjdGVkTWVzaCksdGhpcy5fcmVnaXN0ZXJGdW5jPWZ1bmN0aW9uKGUpe3JldHVybiB0Ll9vblJlZ2lzdGVyQWZ0ZXJXb3JsZE1hdHJpeFVwZGF0ZShlKX0sZS5yZWdpc3RlckFmdGVyV29ybGRNYXRyaXhVcGRhdGUodGhpcy5fcmVnaXN0ZXJGdW5jKX0sdC5wcm90b3R5cGUuZGV0YWNoRnJvbU1lc2g9ZnVuY3Rpb24oKXt0aGlzLl9jb25uZWN0ZWRNZXNoJiYodGhpcy5fY29ubmVjdGVkTWVzaC51bnJlZ2lzdGVyQWZ0ZXJXb3JsZE1hdHJpeFVwZGF0ZSh0aGlzLl9yZWdpc3RlckZ1bmMpLHRoaXMuX3JlZ2lzdGVyRnVuYz1udWxsLHRoaXMuX2Nvbm5lY3RlZE1lc2g9bnVsbCl9LHQucHJvdG90eXBlLl9vblJlZ2lzdGVyQWZ0ZXJXb3JsZE1hdHJpeFVwZGF0ZT1mdW5jdGlvbih0KXt0aGlzLnNldFBvc2l0aW9uKHQuZ2V0Qm91bmRpbmdJbmZvKCkuYm91bmRpbmdTcGhlcmUuY2VudGVyV29ybGQpLGUuRW5naW5lLmF1ZGlvRW5naW5lLmNhblVzZVdlYkF1ZGlvJiZ0aGlzLl9pc0RpcmVjdGlvbmFsJiZ0aGlzLmlzUGxheWluZyYmdGhpcy5fdXBkYXRlRGlyZWN0aW9uKCl9LHQucHJvdG90eXBlLmNsb25lPWZ1bmN0aW9uKCl7dmFyIGU9dGhpcztpZih0aGlzLl9zdHJlYW1pbmcpcmV0dXJuIG51bGw7dmFyIGk9ZnVuY3Rpb24oKXtlLl9pc1JlYWR5VG9QbGF5PyhuLl9hdWRpb0J1ZmZlcj1lLmdldEF1ZGlvQnVmZmVyKCksbi5faXNSZWFkeVRvUGxheT0hMCxuLmF1dG9wbGF5JiZuLnBsYXkoKSk6d2luZG93LnNldFRpbWVvdXQoaSwzMDApfSxyPXthdXRvcGxheTp0aGlzLmF1dG9wbGF5LGxvb3A6dGhpcy5sb29wLHZvbHVtZTp0aGlzLl92b2x1bWUsc3BhdGlhbFNvdW5kOnRoaXMuc3BhdGlhbFNvdW5kLG1heERpc3RhbmNlOnRoaXMubWF4RGlzdGFuY2UsdXNlQ3VzdG9tQXR0ZW51YXRpb246dGhpcy51c2VDdXN0b21BdHRlbnVhdGlvbixyb2xsb2ZmRmFjdG9yOnRoaXMucm9sbG9mZkZhY3RvcixyZWZEaXN0YW5jZTp0aGlzLnJlZkRpc3RhbmNlLGRpc3RhbmNlTW9kZWw6dGhpcy5kaXN0YW5jZU1vZGVsfSxuPW5ldyB0KHRoaXMubmFtZStcIl9jbG9uZWRcIixuZXcgQXJyYXlCdWZmZXIoMCksdGhpcy5fc2NlbmUsbnVsbCxyKTtyZXR1cm4gdGhpcy51c2VDdXN0b21BdHRlbnVhdGlvbiYmbi5zZXRBdHRlbnVhdGlvbkZ1bmN0aW9uKHRoaXMuX2N1c3RvbUF0dGVudWF0aW9uRnVuY3Rpb24pLG4uc2V0UG9zaXRpb24odGhpcy5fcG9zaXRpb24pLG4uc2V0UGxheWJhY2tSYXRlKHRoaXMuX3BsYXliYWNrUmF0ZSksaSgpLG59LHQucHJvdG90eXBlLmdldEF1ZGlvQnVmZmVyPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2F1ZGlvQnVmZmVyfSx0LlBhcnNlPWZ1bmN0aW9uKGkscixuLG8pe3ZhciBzLGE9aS5uYW1lO3M9aS51cmw/bitpLnVybDpuK2E7dmFyIGgsYz17YXV0b3BsYXk6aS5hdXRvcGxheSxsb29wOmkubG9vcCx2b2x1bWU6aS52b2x1bWUsc3BhdGlhbFNvdW5kOmkuc3BhdGlhbFNvdW5kLG1heERpc3RhbmNlOmkubWF4RGlzdGFuY2Uscm9sbG9mZkZhY3RvcjppLnJvbGxvZmZGYWN0b3IscmVmRGlzdGFuY2U6aS5yZWZEaXN0YW5jZSxkaXN0YW5jZU1vZGVsOmkuZGlzdGFuY2VNb2RlbCxwbGF5YmFja1JhdGU6aS5wbGF5YmFja1JhdGV9O2lmKG8pe3ZhciBsPWZ1bmN0aW9uKCl7by5faXNSZWFkeVRvUGxheT8oaC5fYXVkaW9CdWZmZXI9by5nZXRBdWRpb0J1ZmZlcigpLGguX2lzUmVhZHlUb1BsYXk9ITAsaC5hdXRvcGxheSYmaC5wbGF5KCkpOndpbmRvdy5zZXRUaW1lb3V0KGwsMzAwKX07aD1uZXcgdChhLG5ldyBBcnJheUJ1ZmZlcigwKSxyLG51bGwsYyksbCgpfWVsc2UgaD1uZXcgdChhLHMscixmdW5jdGlvbigpe3IuX3JlbW92ZVBlbmRpbmdEYXRhKGgpfSxjKSxyLl9hZGRQZW5kaW5nRGF0YShoKTtpZihpLnBvc2l0aW9uKXt2YXIgdT1lLlZlY3RvcjMuRnJvbUFycmF5KGkucG9zaXRpb24pO2guc2V0UG9zaXRpb24odSl9aWYoaS5pc0RpcmVjdGlvbmFsJiYoaC5zZXREaXJlY3Rpb25hbENvbmUoaS5jb25lSW5uZXJBbmdsZXx8MzYwLGkuY29uZU91dGVyQW5nbGV8fDM2MCxpLmNvbmVPdXRlckdhaW58fDApLGkubG9jYWxEaXJlY3Rpb25Ub01lc2gpKXt2YXIgZj1lLlZlY3RvcjMuRnJvbUFycmF5KGkubG9jYWxEaXJlY3Rpb25Ub01lc2gpO2guc2V0TG9jYWxEaXJlY3Rpb25Ub01lc2goZil9aWYoaS5jb25uZWN0ZWRNZXNoSWQpe3ZhciBkPXIuZ2V0TWVzaEJ5SUQoaS5jb25uZWN0ZWRNZXNoSWQpO2QmJmguYXR0YWNoVG9NZXNoKGQpfXJldHVybiBofSx0fSgpO2UuU291bmQ9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KGUsdCl7dGhpcy5pZD0tMSx0aGlzLl9pc01haW5UcmFjaz0hMSx0aGlzLl9pc0luaXRpYWxpemVkPSExLHRoaXMuX3NjZW5lPWUsdGhpcy5zb3VuZENvbGxlY3Rpb249bmV3IEFycmF5LHRoaXMuX29wdGlvbnM9dCx0aGlzLl9pc01haW5UcmFja3x8KHRoaXMuX3NjZW5lLnNvdW5kVHJhY2tzLnB1c2godGhpcyksdGhpcy5pZD10aGlzLl9zY2VuZS5zb3VuZFRyYWNrcy5sZW5ndGgtMSl9cmV0dXJuIHQucHJvdG90eXBlLl9pbml0aWFsaXplU291bmRUcmFja0F1ZGlvR3JhcGg9ZnVuY3Rpb24oKXtlLkVuZ2luZS5hdWRpb0VuZ2luZS5jYW5Vc2VXZWJBdWRpbyYmKHRoaXMuX291dHB1dEF1ZGlvTm9kZT1lLkVuZ2luZS5hdWRpb0VuZ2luZS5hdWRpb0NvbnRleHQuY3JlYXRlR2FpbigpLHRoaXMuX291dHB1dEF1ZGlvTm9kZS5jb25uZWN0KGUuRW5naW5lLmF1ZGlvRW5naW5lLm1hc3RlckdhaW4pLHRoaXMuX29wdGlvbnMmJih0aGlzLl9vcHRpb25zLnZvbHVtZSYmKHRoaXMuX291dHB1dEF1ZGlvTm9kZS5nYWluLnZhbHVlPXRoaXMuX29wdGlvbnMudm9sdW1lKSx0aGlzLl9vcHRpb25zLm1haW5UcmFjayYmKHRoaXMuX2lzTWFpblRyYWNrPXRoaXMuX29wdGlvbnMubWFpblRyYWNrKSksdGhpcy5faXNJbml0aWFsaXplZD0hMCl9LHQucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXtpZihlLkVuZ2luZS5hdWRpb0VuZ2luZS5jYW5Vc2VXZWJBdWRpbyl7Zm9yKHRoaXMuX2Nvbm5lY3RlZEFuYWx5c2VyJiZ0aGlzLl9jb25uZWN0ZWRBbmFseXNlci5zdG9wRGVidWdDYW52YXMoKTt0aGlzLnNvdW5kQ29sbGVjdGlvbi5sZW5ndGg7KXRoaXMuc291bmRDb2xsZWN0aW9uWzBdLmRpc3Bvc2UoKTt0aGlzLl9vdXRwdXRBdWRpb05vZGUmJnRoaXMuX291dHB1dEF1ZGlvTm9kZS5kaXNjb25uZWN0KCksdGhpcy5fb3V0cHV0QXVkaW9Ob2RlPW51bGx9fSx0LnByb3RvdHlwZS5BZGRTb3VuZD1mdW5jdGlvbih0KXt0aGlzLl9pc0luaXRpYWxpemVkfHx0aGlzLl9pbml0aWFsaXplU291bmRUcmFja0F1ZGlvR3JhcGgoKSxlLkVuZ2luZS5hdWRpb0VuZ2luZS5jYW5Vc2VXZWJBdWRpbyYmdC5jb25uZWN0VG9Tb3VuZFRyYWNrQXVkaW9Ob2RlKHRoaXMuX291dHB1dEF1ZGlvTm9kZSksdC5zb3VuZFRyYWNrSWQmJigtMT09PXQuc291bmRUcmFja0lkP3RoaXMuX3NjZW5lLm1haW5Tb3VuZFRyYWNrLlJlbW92ZVNvdW5kKHQpOnRoaXMuX3NjZW5lLnNvdW5kVHJhY2tzW3Quc291bmRUcmFja0lkXS5SZW1vdmVTb3VuZCh0KSksdGhpcy5zb3VuZENvbGxlY3Rpb24ucHVzaCh0KSx0LnNvdW5kVHJhY2tJZD10aGlzLmlkfSx0LnByb3RvdHlwZS5SZW1vdmVTb3VuZD1mdW5jdGlvbihlKXt2YXIgdD10aGlzLnNvdW5kQ29sbGVjdGlvbi5pbmRleE9mKGUpOy0xIT09dCYmdGhpcy5zb3VuZENvbGxlY3Rpb24uc3BsaWNlKHQsMSl9LHQucHJvdG90eXBlLnNldFZvbHVtZT1mdW5jdGlvbih0KXtlLkVuZ2luZS5hdWRpb0VuZ2luZS5jYW5Vc2VXZWJBdWRpbyYmKHRoaXMuX291dHB1dEF1ZGlvTm9kZS5nYWluLnZhbHVlPXQpfSx0LnByb3RvdHlwZS5zd2l0Y2hQYW5uaW5nTW9kZWxUb0hSVEY9ZnVuY3Rpb24oKXtpZihlLkVuZ2luZS5hdWRpb0VuZ2luZS5jYW5Vc2VXZWJBdWRpbylmb3IodmFyIHQ9MDt0PHRoaXMuc291bmRDb2xsZWN0aW9uLmxlbmd0aDt0KyspdGhpcy5zb3VuZENvbGxlY3Rpb25bdF0uc3dpdGNoUGFubmluZ01vZGVsVG9IUlRGKCl9LHQucHJvdG90eXBlLnN3aXRjaFBhbm5pbmdNb2RlbFRvRXF1YWxQb3dlcj1mdW5jdGlvbigpe2lmKGUuRW5naW5lLmF1ZGlvRW5naW5lLmNhblVzZVdlYkF1ZGlvKWZvcih2YXIgdD0wO3Q8dGhpcy5zb3VuZENvbGxlY3Rpb24ubGVuZ3RoO3QrKyl0aGlzLnNvdW5kQ29sbGVjdGlvblt0XS5zd2l0Y2hQYW5uaW5nTW9kZWxUb0VxdWFsUG93ZXIoKX0sdC5wcm90b3R5cGUuY29ubmVjdFRvQW5hbHlzZXI9ZnVuY3Rpb24odCl7dGhpcy5fY29ubmVjdGVkQW5hbHlzZXImJnRoaXMuX2Nvbm5lY3RlZEFuYWx5c2VyLnN0b3BEZWJ1Z0NhbnZhcygpLHRoaXMuX2Nvbm5lY3RlZEFuYWx5c2VyPXQsZS5FbmdpbmUuYXVkaW9FbmdpbmUuY2FuVXNlV2ViQXVkaW8mJih0aGlzLl9vdXRwdXRBdWRpb05vZGUuZGlzY29ubmVjdCgpLHRoaXMuX2Nvbm5lY3RlZEFuYWx5c2VyLmNvbm5lY3RBdWRpb05vZGVzKHRoaXMuX291dHB1dEF1ZGlvTm9kZSxlLkVuZ2luZS5hdWRpb0VuZ2luZS5tYXN0ZXJHYWluKSl9LHR9KCk7ZS5Tb3VuZFRyYWNrPXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSgpe31yZXR1cm4gZS5UcmFuc2Zvcm1Db29yZGluYXRlc1RvUmVmU0lNRD1mdW5jdGlvbihlLHQsaSl7dmFyIHI9U0lNRC5mbG9hdDMyeDQubG9hZFhZWihlLl9kYXRhLDApLG49U0lNRC5mbG9hdDMyeDQubG9hZCh0Lm0sMCksbz1TSU1ELmZsb2F0MzJ4NC5sb2FkKHQubSw0KSxzPVNJTUQuZmxvYXQzMng0LmxvYWQodC5tLDgpLGE9U0lNRC5mbG9hdDMyeDQubG9hZCh0Lm0sMTIpLGg9U0lNRC5mbG9hdDMyeDQuYWRkKFNJTUQuZmxvYXQzMng0LmFkZChTSU1ELmZsb2F0MzJ4NC5tdWwoU0lNRC5mbG9hdDMyeDQuc3dpenpsZShyLDAsMCwwLDApLG4pLFNJTUQuZmxvYXQzMng0Lm11bChTSU1ELmZsb2F0MzJ4NC5zd2l6emxlKHIsMSwxLDEsMSksbykpLFNJTUQuZmxvYXQzMng0LmFkZChTSU1ELmZsb2F0MzJ4NC5tdWwoU0lNRC5mbG9hdDMyeDQuc3dpenpsZShyLDIsMiwyLDIpLHMpLGEpKTtoPVNJTUQuZmxvYXQzMng0LmRpdihoLFNJTUQuZmxvYXQzMng0LnN3aXp6bGUoaCwzLDMsMywzKSksU0lNRC5mbG9hdDMyeDQuc3RvcmVYWVooaS5fZGF0YSwwLGgpfSxlLlRyYW5zZm9ybUNvb3JkaW5hdGVzRnJvbUZsb2F0c1RvUmVmU0lNRD1mdW5jdGlvbihlLHQsaSxyLG4pe3ZhciBvPVNJTUQuZmxvYXQzMng0LnNwbGF0KGUpLHM9U0lNRC5mbG9hdDMyeDQuc3BsYXQodCksYT1TSU1ELmZsb2F0MzJ4NC5zcGxhdChpKSxoPVNJTUQuZmxvYXQzMng0LmxvYWQoci5tLDApLGM9U0lNRC5mbG9hdDMyeDQubG9hZChyLm0sNCksbD1TSU1ELmZsb2F0MzJ4NC5sb2FkKHIubSw4KSx1PVNJTUQuZmxvYXQzMng0LmxvYWQoci5tLDEyKSxmPVNJTUQuZmxvYXQzMng0LmFkZChTSU1ELmZsb2F0MzJ4NC5hZGQoU0lNRC5mbG9hdDMyeDQubXVsKG8saCksU0lNRC5mbG9hdDMyeDQubXVsKHMsYykpLFNJTUQuZmxvYXQzMng0LmFkZChTSU1ELmZsb2F0MzJ4NC5tdWwoYSxsKSx1KSk7XG5mPVNJTUQuZmxvYXQzMng0LmRpdihmLFNJTUQuZmxvYXQzMng0LnN3aXp6bGUoZiwzLDMsMywzKSksU0lNRC5mbG9hdDMyeDQuc3RvcmVYWVoobi5fZGF0YSwwLGYpfSxlfSgpO2UuU0lNRFZlY3RvcjM9dDt2YXIgaT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoKXt9cmV0dXJuIGUucHJvdG90eXBlLm11bHRpcGx5VG9BcnJheVNJTUQ9ZnVuY3Rpb24oZSx0LGkpe3ZvaWQgMD09PWkmJihpPTApO3ZhciByPXRoaXMubSxuPWUubSxvPVNJTUQuZmxvYXQzMng0LmxvYWQobiwwKSxzPVNJTUQuZmxvYXQzMng0LmxvYWQobiw0KSxhPVNJTUQuZmxvYXQzMng0LmxvYWQobiw4KSxoPVNJTUQuZmxvYXQzMng0LmxvYWQobiwxMiksYz1TSU1ELmZsb2F0MzJ4NC5sb2FkKHIsMCk7U0lNRC5mbG9hdDMyeDQuc3RvcmUodCxpKzAsU0lNRC5mbG9hdDMyeDQuYWRkKFNJTUQuZmxvYXQzMng0Lm11bChTSU1ELmZsb2F0MzJ4NC5zd2l6emxlKGMsMCwwLDAsMCksbyksU0lNRC5mbG9hdDMyeDQuYWRkKFNJTUQuZmxvYXQzMng0Lm11bChTSU1ELmZsb2F0MzJ4NC5zd2l6emxlKGMsMSwxLDEsMSkscyksU0lNRC5mbG9hdDMyeDQuYWRkKFNJTUQuZmxvYXQzMng0Lm11bChTSU1ELmZsb2F0MzJ4NC5zd2l6emxlKGMsMiwyLDIsMiksYSksU0lNRC5mbG9hdDMyeDQubXVsKFNJTUQuZmxvYXQzMng0LnN3aXp6bGUoYywzLDMsMywzKSxoKSkpKSk7dmFyIGw9U0lNRC5mbG9hdDMyeDQubG9hZChyLDQpO1NJTUQuZmxvYXQzMng0LnN0b3JlKHQsaSs0LFNJTUQuZmxvYXQzMng0LmFkZChTSU1ELmZsb2F0MzJ4NC5tdWwoU0lNRC5mbG9hdDMyeDQuc3dpenpsZShsLDAsMCwwLDApLG8pLFNJTUQuZmxvYXQzMng0LmFkZChTSU1ELmZsb2F0MzJ4NC5tdWwoU0lNRC5mbG9hdDMyeDQuc3dpenpsZShsLDEsMSwxLDEpLHMpLFNJTUQuZmxvYXQzMng0LmFkZChTSU1ELmZsb2F0MzJ4NC5tdWwoU0lNRC5mbG9hdDMyeDQuc3dpenpsZShsLDIsMiwyLDIpLGEpLFNJTUQuZmxvYXQzMng0Lm11bChTSU1ELmZsb2F0MzJ4NC5zd2l6emxlKGwsMywzLDMsMyksaCkpKSkpO3ZhciB1PVNJTUQuZmxvYXQzMng0LmxvYWQociw4KTtTSU1ELmZsb2F0MzJ4NC5zdG9yZSh0LGkrOCxTSU1ELmZsb2F0MzJ4NC5hZGQoU0lNRC5mbG9hdDMyeDQubXVsKFNJTUQuZmxvYXQzMng0LnN3aXp6bGUodSwwLDAsMCwwKSxvKSxTSU1ELmZsb2F0MzJ4NC5hZGQoU0lNRC5mbG9hdDMyeDQubXVsKFNJTUQuZmxvYXQzMng0LnN3aXp6bGUodSwxLDEsMSwxKSxzKSxTSU1ELmZsb2F0MzJ4NC5hZGQoU0lNRC5mbG9hdDMyeDQubXVsKFNJTUQuZmxvYXQzMng0LnN3aXp6bGUodSwyLDIsMiwyKSxhKSxTSU1ELmZsb2F0MzJ4NC5tdWwoU0lNRC5mbG9hdDMyeDQuc3dpenpsZSh1LDMsMywzLDMpLGgpKSkpKTt2YXIgZj1TSU1ELmZsb2F0MzJ4NC5sb2FkKHIsMTIpO1NJTUQuZmxvYXQzMng0LnN0b3JlKHQsaSsxMixTSU1ELmZsb2F0MzJ4NC5hZGQoU0lNRC5mbG9hdDMyeDQubXVsKFNJTUQuZmxvYXQzMng0LnN3aXp6bGUoZiwwLDAsMCwwKSxvKSxTSU1ELmZsb2F0MzJ4NC5hZGQoU0lNRC5mbG9hdDMyeDQubXVsKFNJTUQuZmxvYXQzMng0LnN3aXp6bGUoZiwxLDEsMSwxKSxzKSxTSU1ELmZsb2F0MzJ4NC5hZGQoU0lNRC5mbG9hdDMyeDQubXVsKFNJTUQuZmxvYXQzMng0LnN3aXp6bGUoZiwyLDIsMiwyKSxhKSxTSU1ELmZsb2F0MzJ4NC5tdWwoU0lNRC5mbG9hdDMyeDQuc3dpenpsZShmLDMsMywzLDMpLGgpKSkpKX0sZS5wcm90b3R5cGUuaW52ZXJ0VG9SZWZTSU1EPWZ1bmN0aW9uKGUpe3ZhciB0LGkscixuLG8scyxhLGgsYyxsLHU9dGhpcy5tLGY9ZS5tLGQ9U0lNRC5mbG9hdDMyeDQubG9hZCh1LDApLHA9U0lNRC5mbG9hdDMyeDQubG9hZCh1LDQpLF89U0lNRC5mbG9hdDMyeDQubG9hZCh1LDgpLG09U0lNRC5mbG9hdDMyeDQubG9hZCh1LDEyKTtyZXR1cm4gbz1TSU1ELmZsb2F0MzJ4NC5zaHVmZmxlKGQscCwwLDEsNCw1KSxpPVNJTUQuZmxvYXQzMng0LnNodWZmbGUoXyxtLDAsMSw0LDUpLHQ9U0lNRC5mbG9hdDMyeDQuc2h1ZmZsZShvLGksMCwyLDQsNiksaT1TSU1ELmZsb2F0MzJ4NC5zaHVmZmxlKGksbywxLDMsNSw3KSxvPVNJTUQuZmxvYXQzMng0LnNodWZmbGUoZCxwLDIsMyw2LDcpLG49U0lNRC5mbG9hdDMyeDQuc2h1ZmZsZShfLG0sMiwzLDYsNykscj1TSU1ELmZsb2F0MzJ4NC5zaHVmZmxlKG8sbiwwLDIsNCw2KSxuPVNJTUQuZmxvYXQzMng0LnNodWZmbGUobixvLDEsMyw1LDcpLG89U0lNRC5mbG9hdDMyeDQubXVsKHIsbiksbz1TSU1ELmZsb2F0MzJ4NC5zd2l6emxlKG8sMSwwLDMsMikscz1TSU1ELmZsb2F0MzJ4NC5tdWwoaSxvKSxhPVNJTUQuZmxvYXQzMng0Lm11bCh0LG8pLG89U0lNRC5mbG9hdDMyeDQuc3dpenpsZShvLDIsMywwLDEpLHM9U0lNRC5mbG9hdDMyeDQuc3ViKFNJTUQuZmxvYXQzMng0Lm11bChpLG8pLHMpLGE9U0lNRC5mbG9hdDMyeDQuc3ViKFNJTUQuZmxvYXQzMng0Lm11bCh0LG8pLGEpLGE9U0lNRC5mbG9hdDMyeDQuc3dpenpsZShhLDIsMywwLDEpLG89U0lNRC5mbG9hdDMyeDQubXVsKGksciksbz1TSU1ELmZsb2F0MzJ4NC5zd2l6emxlKG8sMSwwLDMsMikscz1TSU1ELmZsb2F0MzJ4NC5hZGQoU0lNRC5mbG9hdDMyeDQubXVsKG4sbykscyksYz1TSU1ELmZsb2F0MzJ4NC5tdWwodCxvKSxvPVNJTUQuZmxvYXQzMng0LnN3aXp6bGUobywyLDMsMCwxKSxzPVNJTUQuZmxvYXQzMng0LnN1YihzLFNJTUQuZmxvYXQzMng0Lm11bChuLG8pKSxjPVNJTUQuZmxvYXQzMng0LnN1YihTSU1ELmZsb2F0MzJ4NC5tdWwodCxvKSxjKSxjPVNJTUQuZmxvYXQzMng0LnN3aXp6bGUoYywyLDMsMCwxKSxvPVNJTUQuZmxvYXQzMng0Lm11bChTSU1ELmZsb2F0MzJ4NC5zd2l6emxlKGksMiwzLDAsMSksbiksbz1TSU1ELmZsb2F0MzJ4NC5zd2l6emxlKG8sMSwwLDMsMikscj1TSU1ELmZsb2F0MzJ4NC5zd2l6emxlKHIsMiwzLDAsMSkscz1TSU1ELmZsb2F0MzJ4NC5hZGQoU0lNRC5mbG9hdDMyeDQubXVsKHIsbykscyksaD1TSU1ELmZsb2F0MzJ4NC5tdWwodCxvKSxvPVNJTUQuZmxvYXQzMng0LnN3aXp6bGUobywyLDMsMCwxKSxzPVNJTUQuZmxvYXQzMng0LnN1YihzLFNJTUQuZmxvYXQzMng0Lm11bChyLG8pKSxoPVNJTUQuZmxvYXQzMng0LnN1YihTSU1ELmZsb2F0MzJ4NC5tdWwodCxvKSxoKSxoPVNJTUQuZmxvYXQzMng0LnN3aXp6bGUoaCwyLDMsMCwxKSxvPVNJTUQuZmxvYXQzMng0Lm11bCh0LGkpLG89U0lNRC5mbG9hdDMyeDQuc3dpenpsZShvLDEsMCwzLDIpLGg9U0lNRC5mbG9hdDMyeDQuYWRkKFNJTUQuZmxvYXQzMng0Lm11bChuLG8pLGgpLGM9U0lNRC5mbG9hdDMyeDQuc3ViKFNJTUQuZmxvYXQzMng0Lm11bChyLG8pLGMpLG89U0lNRC5mbG9hdDMyeDQuc3dpenpsZShvLDIsMywwLDEpLGg9U0lNRC5mbG9hdDMyeDQuc3ViKFNJTUQuZmxvYXQzMng0Lm11bChuLG8pLGgpLGM9U0lNRC5mbG9hdDMyeDQuc3ViKGMsU0lNRC5mbG9hdDMyeDQubXVsKHIsbykpLG89U0lNRC5mbG9hdDMyeDQubXVsKHQsbiksbz1TSU1ELmZsb2F0MzJ4NC5zd2l6emxlKG8sMSwwLDMsMiksYT1TSU1ELmZsb2F0MzJ4NC5zdWIoYSxTSU1ELmZsb2F0MzJ4NC5tdWwocixvKSksaD1TSU1ELmZsb2F0MzJ4NC5hZGQoU0lNRC5mbG9hdDMyeDQubXVsKGksbyksaCksbz1TSU1ELmZsb2F0MzJ4NC5zd2l6emxlKG8sMiwzLDAsMSksYT1TSU1ELmZsb2F0MzJ4NC5hZGQoU0lNRC5mbG9hdDMyeDQubXVsKHIsbyksYSksaD1TSU1ELmZsb2F0MzJ4NC5zdWIoaCxTSU1ELmZsb2F0MzJ4NC5tdWwoaSxvKSksbz1TSU1ELmZsb2F0MzJ4NC5tdWwodCxyKSxvPVNJTUQuZmxvYXQzMng0LnN3aXp6bGUobywxLDAsMywyKSxhPVNJTUQuZmxvYXQzMng0LmFkZChTSU1ELmZsb2F0MzJ4NC5tdWwobixvKSxhKSxjPVNJTUQuZmxvYXQzMng0LnN1YihjLFNJTUQuZmxvYXQzMng0Lm11bChpLG8pKSxvPVNJTUQuZmxvYXQzMng0LnN3aXp6bGUobywyLDMsMCwxKSxhPVNJTUQuZmxvYXQzMng0LnN1YihhLFNJTUQuZmxvYXQzMng0Lm11bChuLG8pKSxjPVNJTUQuZmxvYXQzMng0LmFkZChTSU1ELmZsb2F0MzJ4NC5tdWwoaSxvKSxjKSxsPVNJTUQuZmxvYXQzMng0Lm11bCh0LHMpLGw9U0lNRC5mbG9hdDMyeDQuYWRkKFNJTUQuZmxvYXQzMng0LnN3aXp6bGUobCwyLDMsMCwxKSxsKSxsPVNJTUQuZmxvYXQzMng0LmFkZChTSU1ELmZsb2F0MzJ4NC5zd2l6emxlKGwsMSwwLDMsMiksbCksbz1TSU1ELmZsb2F0MzJ4NC5yZWNpcHJvY2FsQXBwcm94aW1hdGlvbihsKSxsPVNJTUQuZmxvYXQzMng0LnN1YihTSU1ELmZsb2F0MzJ4NC5hZGQobyxvKSxTSU1ELmZsb2F0MzJ4NC5tdWwobCxTSU1ELmZsb2F0MzJ4NC5tdWwobyxvKSkpLGw9U0lNRC5mbG9hdDMyeDQuc3dpenpsZShsLDAsMCwwLDApLHM9U0lNRC5mbG9hdDMyeDQubXVsKGwscyksYT1TSU1ELmZsb2F0MzJ4NC5tdWwobCxhKSxoPVNJTUQuZmxvYXQzMng0Lm11bChsLGgpLGM9U0lNRC5mbG9hdDMyeDQubXVsKGwsYyksU0lNRC5mbG9hdDMyeDQuc3RvcmUoZiwwLHMpLFNJTUQuZmxvYXQzMng0LnN0b3JlKGYsNCxhKSxTSU1ELmZsb2F0MzJ4NC5zdG9yZShmLDgsaCksU0lNRC5mbG9hdDMyeDQuc3RvcmUoZiwxMixjKSx0aGlzfSxlLkxvb2tBdExIVG9SZWZTSU1EPWZ1bmN0aW9uKGUsdCxpLHIpe3ZhciBuPXIubSxvPVNJTUQuZmxvYXQzMng0KHQueCx0LnksdC56LDApLHM9U0lNRC5mbG9hdDMyeDQoZS54LGUueSxlLnosMCksYT1TSU1ELmZsb2F0MzJ4NChpLngsaS55LGkueiwwKSxoPVNJTUQuZmxvYXQzMng0LnN1YihvLHMpLGM9U0lNRC5mbG9hdDMyeDQubXVsKGgsaCk7Yz1TSU1ELmZsb2F0MzJ4NC5hZGQoYyxTSU1ELmZsb2F0MzJ4NC5hZGQoU0lNRC5mbG9hdDMyeDQuc3dpenpsZShjLDEsMiwwLDMpLFNJTUQuZmxvYXQzMng0LnN3aXp6bGUoYywyLDAsMSwzKSkpLGg9U0lNRC5mbG9hdDMyeDQubXVsKGgsU0lNRC5mbG9hdDMyeDQucmVjaXByb2NhbFNxcnRBcHByb3hpbWF0aW9uKGMpKSxjPVNJTUQuZmxvYXQzMng0Lm11bChhLGEpLGM9U0lNRC5mbG9hdDMyeDQuYWRkKGMsU0lNRC5mbG9hdDMyeDQuYWRkKFNJTUQuZmxvYXQzMng0LnN3aXp6bGUoYywxLDIsMCwzKSxTSU1ELmZsb2F0MzJ4NC5zd2l6emxlKGMsMiwwLDEsMykpKSxhPVNJTUQuZmxvYXQzMng0Lm11bChhLFNJTUQuZmxvYXQzMng0LnJlY2lwcm9jYWxTcXJ0QXBwcm94aW1hdGlvbihjKSk7dmFyIGw9U0lNRC5mbG9hdDMyeDQuc3ViKFNJTUQuZmxvYXQzMng0Lm11bChTSU1ELmZsb2F0MzJ4NC5zd2l6emxlKGgsMSwyLDAsMyksU0lNRC5mbG9hdDMyeDQuc3dpenpsZShhLDIsMCwxLDMpKSxTSU1ELmZsb2F0MzJ4NC5tdWwoU0lNRC5mbG9hdDMyeDQuc3dpenpsZShoLDIsMCwxLDMpLFNJTUQuZmxvYXQzMng0LnN3aXp6bGUoYSwxLDIsMCwzKSkpO2M9U0lNRC5mbG9hdDMyeDQubXVsKGwsbCksYz1TSU1ELmZsb2F0MzJ4NC5hZGQoYyxTSU1ELmZsb2F0MzJ4NC5hZGQoU0lNRC5mbG9hdDMyeDQuc3dpenpsZShjLDEsMiwwLDMpLFNJTUQuZmxvYXQzMng0LnN3aXp6bGUoYywyLDAsMSwzKSkpLGw9U0lNRC5mbG9hdDMyeDQubXVsKGwsU0lNRC5mbG9hdDMyeDQucmVjaXByb2NhbFNxcnRBcHByb3hpbWF0aW9uKGMpKTt2YXIgdT1TSU1ELmZsb2F0MzJ4NC5zdWIoU0lNRC5mbG9hdDMyeDQubXVsKFNJTUQuZmxvYXQzMng0LnN3aXp6bGUobCwxLDIsMCwzKSxTSU1ELmZsb2F0MzJ4NC5zd2l6emxlKGgsMiwwLDEsMykpLFNJTUQuZmxvYXQzMng0Lm11bChTSU1ELmZsb2F0MzJ4NC5zd2l6emxlKGwsMiwwLDEsMyksU0lNRC5mbG9hdDMyeDQuc3dpenpsZShoLDEsMiwwLDMpKSk7Yz1TSU1ELmZsb2F0MzJ4NC5tdWwobCxsKSxjPVNJTUQuZmxvYXQzMng0LmFkZChjLFNJTUQuZmxvYXQzMng0LmFkZChTSU1ELmZsb2F0MzJ4NC5zd2l6emxlKGMsMSwyLDAsMyksU0lNRC5mbG9hdDMyeDQuc3dpenpsZShjLDIsMCwxLDMpKSksbD1TSU1ELmZsb2F0MzJ4NC5tdWwobCxTSU1ELmZsb2F0MzJ4NC5yZWNpcHJvY2FsU3FydEFwcHJveGltYXRpb24oYykpO3ZhciBmPVNJTUQuZmxvYXQzMng0LnNwbGF0KDApO2w9U0lNRC5mbG9hdDMyeDQubmVnKGwpO3ZhciBkPVNJTUQuZmxvYXQzMng0LnNodWZmbGUobCx1LDAsMSw0LDUpLHA9U0lNRC5mbG9hdDMyeDQuc2h1ZmZsZShoLGYsMCwxLDQsNSksXz1TSU1ELmZsb2F0MzJ4NC5zaHVmZmxlKGQscCwwLDIsNCw2KSxtPVNJTUQuZmxvYXQzMng0LnNodWZmbGUoZCxwLDEsMyw1LDcpO2Q9U0lNRC5mbG9hdDMyeDQuc2h1ZmZsZShsLHUsMiwzLDYsNykscD1TSU1ELmZsb2F0MzJ4NC5zaHVmZmxlKGgsZiwyLDMsNiw3KTt2YXIgZz1TSU1ELmZsb2F0MzJ4NC5zaHVmZmxlKGQscCwwLDIsNCw2KSx2PVNJTUQuZmxvYXQzMng0KDAsMCwwLDEpLHk9U0lNRC5mbG9hdDMyeDQoMSwwLDAsMCkseD1TSU1ELmZsb2F0MzJ4NCgwLDEsMCwwKSxiPVNJTUQuZmxvYXQzMng0KDAsMCwxLDApLFA9U0lNRC5mbG9hdDMyeDQubmVnKHMpO1A9U0lNRC5mbG9hdDMyeDQud2l0aFcoUCwxKSxTSU1ELmZsb2F0MzJ4NC5zdG9yZShuLDAsU0lNRC5mbG9hdDMyeDQuYWRkKFNJTUQuZmxvYXQzMng0Lm11bChTSU1ELmZsb2F0MzJ4NC5zd2l6emxlKHksMCwwLDAsMCksXyksU0lNRC5mbG9hdDMyeDQuYWRkKFNJTUQuZmxvYXQzMng0Lm11bChTSU1ELmZsb2F0MzJ4NC5zd2l6emxlKHksMSwxLDEsMSksbSksU0lNRC5mbG9hdDMyeDQuYWRkKFNJTUQuZmxvYXQzMng0Lm11bChTSU1ELmZsb2F0MzJ4NC5zd2l6emxlKHksMiwyLDIsMiksZyksU0lNRC5mbG9hdDMyeDQubXVsKFNJTUQuZmxvYXQzMng0LnN3aXp6bGUoeSwzLDMsMywzKSx2KSkpKSksU0lNRC5mbG9hdDMyeDQuc3RvcmUobiw0LFNJTUQuZmxvYXQzMng0LmFkZChTSU1ELmZsb2F0MzJ4NC5tdWwoU0lNRC5mbG9hdDMyeDQuc3dpenpsZSh4LDAsMCwwLDApLF8pLFNJTUQuZmxvYXQzMng0LmFkZChTSU1ELmZsb2F0MzJ4NC5tdWwoU0lNRC5mbG9hdDMyeDQuc3dpenpsZSh4LDEsMSwxLDEpLG0pLFNJTUQuZmxvYXQzMng0LmFkZChTSU1ELmZsb2F0MzJ4NC5tdWwoU0lNRC5mbG9hdDMyeDQuc3dpenpsZSh4LDIsMiwyLDIpLGcpLFNJTUQuZmxvYXQzMng0Lm11bChTSU1ELmZsb2F0MzJ4NC5zd2l6emxlKHgsMywzLDMsMyksdikpKSkpLFNJTUQuZmxvYXQzMng0LnN0b3JlKG4sOCxTSU1ELmZsb2F0MzJ4NC5hZGQoU0lNRC5mbG9hdDMyeDQubXVsKFNJTUQuZmxvYXQzMng0LnN3aXp6bGUoYiwwLDAsMCwwKSxfKSxTSU1ELmZsb2F0MzJ4NC5hZGQoU0lNRC5mbG9hdDMyeDQubXVsKFNJTUQuZmxvYXQzMng0LnN3aXp6bGUoYiwxLDEsMSwxKSxtKSxTSU1ELmZsb2F0MzJ4NC5hZGQoU0lNRC5mbG9hdDMyeDQubXVsKFNJTUQuZmxvYXQzMng0LnN3aXp6bGUoYiwyLDIsMiwyKSxnKSxTSU1ELmZsb2F0MzJ4NC5tdWwoU0lNRC5mbG9hdDMyeDQuc3dpenpsZShiLDMsMywzLDMpLHYpKSkpKSxTSU1ELmZsb2F0MzJ4NC5zdG9yZShuLDEyLFNJTUQuZmxvYXQzMng0LmFkZChTSU1ELmZsb2F0MzJ4NC5tdWwoU0lNRC5mbG9hdDMyeDQuc3dpenpsZShQLDAsMCwwLDApLF8pLFNJTUQuZmxvYXQzMng0LmFkZChTSU1ELmZsb2F0MzJ4NC5tdWwoU0lNRC5mbG9hdDMyeDQuc3dpenpsZShQLDEsMSwxLDEpLG0pLFNJTUQuZmxvYXQzMng0LmFkZChTSU1ELmZsb2F0MzJ4NC5tdWwoU0lNRC5mbG9hdDMyeDQuc3dpenpsZShQLDIsMiwyLDIpLGcpLFNJTUQuZmxvYXQzMng0Lm11bChTSU1ELmZsb2F0MzJ4NC5zd2l6emxlKFAsMywzLDMsMyksdikpKSkpfSxlfSgpO2UuU0lNRE1hdHJpeD1pO3ZhciByPWUuTWF0cml4LnByb3RvdHlwZS5tdWx0aXBseVRvQXJyYXksbj1lLk1hdHJpeC5wcm90b3R5cGUuaW52ZXJ0VG9SZWYsbz1lLk1hdHJpeC5Mb29rQXRMSFRvUmVmLHM9ZS5WZWN0b3IzLlRyYW5zZm9ybUNvb3JkaW5hdGVzVG9SZWYsYT1lLlZlY3RvcjMuVHJhbnNmb3JtQ29vcmRpbmF0ZXNGcm9tRmxvYXRzVG9SZWYsaD1mdW5jdGlvbigpe2Z1bmN0aW9uIGgoKXt9cmV0dXJuIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShoLFwiSXNFbmFibGVkXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBoLl9pc0VuYWJsZWR9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksaC5EaXNhYmxlU0lNRD1mdW5jdGlvbigpe2UuTWF0cml4LnByb3RvdHlwZS5tdWx0aXBseVRvQXJyYXk9cixlLk1hdHJpeC5wcm90b3R5cGUuaW52ZXJ0VG9SZWY9bixlLk1hdHJpeC5Mb29rQXRMSFRvUmVmPW8sZS5WZWN0b3IzLlRyYW5zZm9ybUNvb3JkaW5hdGVzVG9SZWY9cyxlLlZlY3RvcjMuVHJhbnNmb3JtQ29vcmRpbmF0ZXNGcm9tRmxvYXRzVG9SZWY9YSxoLl9pc0VuYWJsZWQ9ITF9LGguRW5hYmxlU0lNRD1mdW5jdGlvbigpe3ZvaWQgMCE9PXdpbmRvdy5TSU1EJiYoZS5NYXRyaXgucHJvdG90eXBlLm11bHRpcGx5VG9BcnJheT1pLnByb3RvdHlwZS5tdWx0aXBseVRvQXJyYXlTSU1ELGUuTWF0cml4LnByb3RvdHlwZS5pbnZlcnRUb1JlZj1pLnByb3RvdHlwZS5pbnZlcnRUb1JlZlNJTUQsZS5NYXRyaXguTG9va0F0TEhUb1JlZj1pLkxvb2tBdExIVG9SZWZTSU1ELGUuVmVjdG9yMy5UcmFuc2Zvcm1Db29yZGluYXRlc1RvUmVmPXQuVHJhbnNmb3JtQ29vcmRpbmF0ZXNUb1JlZlNJTUQsZS5WZWN0b3IzLlRyYW5zZm9ybUNvb3JkaW5hdGVzRnJvbUZsb2F0c1RvUmVmPXQuVHJhbnNmb3JtQ29vcmRpbmF0ZXNGcm9tRmxvYXRzVG9SZWZTSU1ELE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLlZlY3RvcjMucHJvdG90eXBlLFwieFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZGF0YVswXX0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX2RhdGF8fCh0aGlzLl9kYXRhPW5ldyBGbG9hdDMyQXJyYXkoMykpLHRoaXMuX2RhdGFbMF09ZX19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZS5WZWN0b3IzLnByb3RvdHlwZSxcInlcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2RhdGFbMV19LHNldDpmdW5jdGlvbihlKXt0aGlzLl9kYXRhWzFdPWV9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGUuVmVjdG9yMy5wcm90b3R5cGUsXCJ6XCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9kYXRhWzJdfSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fZGF0YVsyXT1lfX0pLGguX2lzRW5hYmxlZD0hMCl9LGguX2lzRW5hYmxlZD0hMSxofSgpO2UuU0lNREhlbHBlcj1ofShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoZSx0LGkscil7dGhpcy5fcG9zPWksdGhpcy5fc2l6ZT1yLHRoaXMuX3Jvb3Q9ZSx0aGlzLl9wYXJlbnQ9dH1yZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwicG9zXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9wb3N9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwiY29udGVudFNpemVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2NvbnRlbnRTaXplfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcIlVWc1wiLHtnZXQ6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLl9yb290Ll9zaXplLndpZHRoLGk9dGhpcy5fcm9vdC5fc2l6ZS5oZWlnaHQscj1uZXcgZS5WZWN0b3IyKHRoaXMuX3Bvcy54L3QsdGhpcy5fcG9zLnkvaSksbj1uZXcgZS5WZWN0b3IyKCh0aGlzLl9wb3MueCt0aGlzLl9jb250ZW50U2l6ZS53aWR0aC0xKS90LCh0aGlzLl9wb3MueSt0aGlzLl9jb250ZW50U2l6ZS5oZWlnaHQtMSkvaSksbz1uZXcgQXJyYXk7cmV0dXJuIG8ucHVzaChyKSxvLnB1c2gobmV3IGUuVmVjdG9yMihuLngsci55KSksby5wdXNoKG4pLG8ucHVzaChuZXcgZS5WZWN0b3IyKHIueCxuLnkpKSxvfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLHQucHJvdG90eXBlLmZyZWVDb250ZW50PWZ1bmN0aW9uKCl7dGhpcy5jb250ZW50U2l6ZSYmKHRoaXMuX2NvbnRlbnRTaXplPW51bGwsdGhpcy5hdHRlbXB0RGVmcmFnKCkpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJpc1VzZWRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIG51bGwhPXRoaXMuX2NvbnRlbnRTaXplfHxudWxsIT10aGlzLl9sZWZ0Tm9kZX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSx0LnByb3RvdHlwZS5maW5kQW5kU3BsaXROb2RlPWZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuZmluZE5vZGUoZSk7cmV0dXJuIHQ/KHQuc3BsaXROb2RlKGUpLHQpOm51bGx9LHQucHJvdG90eXBlLmZpbmROb2RlPWZ1bmN0aW9uKGUpe3ZhciB0PW51bGw7cmV0dXJuIHRoaXMuaXNVc2VkPyh0aGlzLl9sZWZ0Tm9kZSYmKHQ9dGhpcy5fbGVmdE5vZGUuZmluZE5vZGUoZSkpLCF0JiZ0aGlzLl9yaWdodE5vZGUmJih0PXRoaXMuX3JpZ2h0Tm9kZS5maW5kTm9kZShlKSksIXQmJnRoaXMuX2JvdHRvbU5vZGUmJih0PXRoaXMuX2JvdHRvbU5vZGUuZmluZE5vZGUoZSkpKTp0aGlzLl9pbml0aWFsU2l6ZSYmZS53aWR0aDw9dGhpcy5faW5pdGlhbFNpemUud2lkdGgmJmUuaGVpZ2h0PD10aGlzLl9pbml0aWFsU2l6ZS5oZWlnaHQ/dD10aGlzOmUud2lkdGg8PXRoaXMuX3NpemUud2lkdGgmJmUuaGVpZ2h0PD10aGlzLl9zaXplLmhlaWdodCYmKHQ9dGhpcyksdH0sdC5wcm90b3R5cGUuc3BsaXROb2RlPWZ1bmN0aW9uKGkpe3JldHVybiF0aGlzLl9jb250ZW50U2l6ZSYmdGhpcy5faW5pdGlhbFNpemU/KHRoaXMuX2xlZnROb2RlPW5ldyB0KHRoaXMuX3Jvb3QsdGhpcyxuZXcgZS5WZWN0b3IyKHRoaXMuX3Bvcy54LHRoaXMuX3Bvcy55KSxuZXcgZS5TaXplKHRoaXMuX2luaXRpYWxTaXplLndpZHRoLHRoaXMuX2luaXRpYWxTaXplLmhlaWdodCkpLHRoaXMuX2xlZnROb2RlLnNwbGl0Tm9kZShpKSk6KHRoaXMuX2NvbnRlbnRTaXplPWkuY2xvbmUoKSx0aGlzLl9pbml0aWFsU2l6ZT1pLmNsb25lKCksaS53aWR0aCE9PXRoaXMuX3NpemUud2lkdGgmJih0aGlzLl9yaWdodE5vZGU9bmV3IHQodGhpcy5fcm9vdCx0aGlzLG5ldyBlLlZlY3RvcjIodGhpcy5fcG9zLngraS53aWR0aCx0aGlzLl9wb3MueSksbmV3IGUuU2l6ZSh0aGlzLl9zaXplLndpZHRoLWkud2lkdGgsaS5oZWlnaHQpKSksaS5oZWlnaHQhPT10aGlzLl9zaXplLmhlaWdodCYmKHRoaXMuX2JvdHRvbU5vZGU9bmV3IHQodGhpcy5fcm9vdCx0aGlzLG5ldyBlLlZlY3RvcjIodGhpcy5fcG9zLngsdGhpcy5fcG9zLnkraS5oZWlnaHQpLG5ldyBlLlNpemUodGhpcy5fc2l6ZS53aWR0aCx0aGlzLl9zaXplLmhlaWdodC1pLmhlaWdodCkpKSx0aGlzKX0sdC5wcm90b3R5cGUuYXR0ZW1wdERlZnJhZz1mdW5jdGlvbigpeyF0aGlzLmlzVXNlZCYmdGhpcy5pc1JlY3Vyc2l2ZUZyZWUmJih0aGlzLmNsZWFyTm9kZSgpLHRoaXMuX3BhcmVudCYmdGhpcy5fcGFyZW50LmF0dGVtcHREZWZyYWcoKSl9LHQucHJvdG90eXBlLmNsZWFyTm9kZT1mdW5jdGlvbigpe3RoaXMuX2luaXRpYWxTaXplPW51bGwsdGhpcy5fcmlnaHROb2RlPW51bGwsdGhpcy5fYm90dG9tTm9kZT1udWxsfSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJpc1JlY3Vyc2l2ZUZyZWVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIXRoaXMuY29udGVudFNpemUmJighdGhpcy5fbGVmdE5vZGV8fHRoaXMuX2xlZnROb2RlLmlzUmVjdXJzaXZlRnJlZSkmJighdGhpcy5fcmlnaHROb2RlfHx0aGlzLl9yaWdodE5vZGUuaXNSZWN1cnNpdmVGcmVlKSYmKCF0aGlzLl9ib3R0b21Ob2RlfHx0aGlzLl9ib3R0b21Ob2RlLmlzUmVjdXJzaXZlRnJlZSl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksdC5wcm90b3R5cGUuZXZhbEZyZWVTaXplPWZ1bmN0aW9uKGUpe3ZhciB0PTA7cmV0dXJuIHRoaXMuaXNVc2VkfHwodD10aGlzLl9pbml0aWFsU2l6ZT90aGlzLl9pbml0aWFsU2l6ZS5zdXJmYWNlOnRoaXMuX3NpemUuc3VyZmFjZSksdGhpcy5fcmlnaHROb2RlJiYodCs9dGhpcy5fcmlnaHROb2RlLmV2YWxGcmVlU2l6ZSgwKSksdGhpcy5fYm90dG9tTm9kZSYmKHQrPXRoaXMuX2JvdHRvbU5vZGUuZXZhbEZyZWVTaXplKDApKSx0K2V9LHR9KCk7ZS5QYWNrZWRSZWN0PXQ7dmFyIGk9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gaShpKXt0LmNhbGwodGhpcyxudWxsLG51bGwsZS5WZWN0b3IyLlplcm8oKSxpKSx0aGlzLl9yb290PXRoaXN9cmV0dXJuIF9fZXh0ZW5kcyhpLHQpLGkucHJvdG90eXBlLmFkZFJlY3Q9ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5maW5kQW5kU3BsaXROb2RlKGUpO3JldHVybiB0fSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJmcmVlU3BhY2VcIix7Z2V0OmZ1bmN0aW9uKCl7dmFyIGU9MDtyZXR1cm4gZT10aGlzLmV2YWxGcmVlU2l6ZShlKSxlLyh0aGlzLl9zaXplLndpZHRoKnRoaXMuX3NpemUuaGVpZ2h0KX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxpfSh0KTtlLlJlY3RQYWNraW5nTWFwPWl9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSgpe31yZXR1cm4gZX0oKTtlLkR5bmFtaWNGbG9hdEFycmF5RWxlbWVudEluZm89dDt2YXIgaT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSxpKXt0aGlzLmNvbXBhcmVWYWx1ZU9mZnNldD1udWxsLHRoaXMuc29ydGluZ0FzY2VuZGluZz0hMCx0aGlzLl9zdHJpZGU9ZSx0aGlzLmJ1ZmZlcj1uZXcgRmxvYXQzMkFycmF5KGUqaSksdGhpcy5fbGFzdFVzZWQ9MCx0aGlzLl9maXJzdEZyZWU9MCx0aGlzLl9hbGxFbnRyaWVzPW5ldyBBcnJheShpKSx0aGlzLl9mcmVlRW50cmllcz1uZXcgQXJyYXkoaSk7Zm9yKHZhciByPTA7aT5yO3IrKyl7dmFyIG49bmV3IHQ7bi5vZmZzZXQ9ciplLHRoaXMuX2FsbEVudHJpZXNbcl09bix0aGlzLl9mcmVlRW50cmllc1tpLXItMV09bn19cmV0dXJuIGUucHJvdG90eXBlLmFsbG9jRWxlbWVudD1mdW5jdGlvbigpezA9PT10aGlzLl9mcmVlRW50cmllcy5sZW5ndGgmJnRoaXMuX2dyb3dCdWZmZXIoKTt2YXIgZT10aGlzLl9mcmVlRW50cmllcy5wb3AoKTtyZXR1cm4gdGhpcy5fbGFzdFVzZWQ9TWF0aC5tYXgoZS5vZmZzZXQsdGhpcy5fbGFzdFVzZWQpLGUub2Zmc2V0PT09dGhpcy5fZmlyc3RGcmVlJiYodGhpcy5fZnJlZUVudHJpZXMubGVuZ3RoPjA/dGhpcy5fZmlyc3RGcmVlPXRoaXMuX2ZyZWVFbnRyaWVzW3RoaXMuX2ZyZWVFbnRyaWVzLmxlbmd0aC0xXS5vZmZzZXQ6dGhpcy5fZmlyc3RGcmVlKz10aGlzLl9zdHJpZGUpLGV9LGUucHJvdG90eXBlLmZyZWVFbGVtZW50PWZ1bmN0aW9uKGUpe3RoaXMuX2ZpcnN0RnJlZT1NYXRoLm1pbihlLm9mZnNldCx0aGlzLl9maXJzdEZyZWUpLHRoaXMuX2ZyZWVFbnRyaWVzLnB1c2goZSl9LGUucHJvdG90eXBlLnBhY2s9ZnVuY3Rpb24oKXtpZigwPT09dGhpcy5fZnJlZUVudHJpZXMubGVuZ3RoKXJldHVybiB0aGlzLmJ1ZmZlcjtpZih0aGlzLl9sYXN0VXNlZDx0aGlzLl9maXJzdEZyZWUpe3ZhciBlPXRoaXMuYnVmZmVyLnN1YmFycmF5KDAsdGhpcy5fbGFzdFVzZWQrdGhpcy5fc3RyaWRlKTtyZXR1cm4gZX12YXIgaT10aGlzLl9zdHJpZGUscj1uZXcgdDtyLm9mZnNldD10aGlzLnRvdGFsRWxlbWVudENvdW50KmksdGhpcy5fZnJlZUVudHJpZXMucHVzaChyKTtmb3IodmFyIG49dGhpcy5fZnJlZUVudHJpZXMuc29ydChmdW5jdGlvbihlLHQpe3JldHVybiBlLm9mZnNldC10Lm9mZnNldH0pLG89dGhpcy5fYWxsRW50cmllcy5zb3J0KGZ1bmN0aW9uKGUsdCl7cmV0dXJuIGUub2Zmc2V0LXQub2Zmc2V0fSkscz1uWzBdLm9mZnNldCxhPTEsaD0odGhpcy51c2VkRWxlbWVudENvdW50KzEpKmksYz1uWzBdLm9mZnNldCxsPTE7bDxuLmxlbmd0aCYmIShzPj1oKTtsKyspe3ZhciB1PW5bbF0sZj11Lm9mZnNldCxkPWYtYztpZihkIT09aSl7Zm9yKHZhciBwPWQvaS0xLF89Zi1pLG09TWF0aC5taW4oYSxwKSxnPTA7bT5nO2crKyl7dmFyIHY9cy9pLHk9Xy9pLHg9b1t5XTt0aGlzLl9tb3ZlRWxlbWVudCh4LHMpO3ZhciBiPW9bdl07Yi5vZmZzZXQ9XyxvW3ZdPXgsb1t5XT1iLF8tPWkscys9aX1wPj1hPyhzPV8raSxhPTErbSk6YT0oZi1zKS9pKzEsYz1mfWVsc2UrK2EsYz1mfXZhciBQPXRoaXMuYnVmZmVyLnN1YmFycmF5KDAscyk7cmV0dXJuIHRoaXMuX2xhc3RVc2VkPXMtaSx0aGlzLl9maXJzdEZyZWU9cyxuLnBvcCgpLHRoaXMuX2ZyZWVFbnRyaWVzPW4uc29ydChmdW5jdGlvbihlLHQpe3JldHVybiB0Lm9mZnNldC1lLm9mZnNldH0pLHRoaXMuX2FsbEVudHJpZXM9byxQfSxlLnByb3RvdHlwZS5fbW92ZUVsZW1lbnQ9ZnVuY3Rpb24oZSx0KXtmb3IodmFyIGk9MDtpPHRoaXMuX3N0cmlkZTtpKyspdGhpcy5idWZmZXJbdCtpXT10aGlzLmJ1ZmZlcltlLm9mZnNldCtpXTtlLm9mZnNldD10fSxlLnByb3RvdHlwZS5fZ3Jvd0J1ZmZlcj1mdW5jdGlvbigpe3ZhciBlPU1hdGguZmxvb3IoMS41KnRoaXMudG90YWxFbGVtZW50Q291bnQpLGk9bmV3IEZsb2F0MzJBcnJheShlKnRoaXMuX3N0cmlkZSk7aS5zZXQodGhpcy5idWZmZXIpO2Zvcih2YXIgcj10aGlzLnRvdGFsRWxlbWVudENvdW50LG49ZS10aGlzLnRvdGFsRWxlbWVudENvdW50LG89MDtuPm87bysrKXt2YXIgcz1uZXcgdDtzLm9mZnNldD0ocitvKSp0aGlzLnN0cmlkZSx0aGlzLl9hbGxFbnRyaWVzLnB1c2gocyksdGhpcy5fZnJlZUVudHJpZXNbbi1vLTFdPXN9dGhpcy5fZmlyc3RGcmVlPXIqdGhpcy5zdHJpZGUsdGhpcy5idWZmZXI9aX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KGUucHJvdG90eXBlLFwidG90YWxFbGVtZW50Q291bnRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2FsbEVudHJpZXMubGVuZ3RofSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLnByb3RvdHlwZSxcImZyZWVFbGVtZW50Q291bnRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2ZyZWVFbnRyaWVzLmxlbmd0aH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZS5wcm90b3R5cGUsXCJ1c2VkRWxlbWVudENvdW50XCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9hbGxFbnRyaWVzLmxlbmd0aC10aGlzLl9mcmVlRW50cmllcy5sZW5ndGh9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGUucHJvdG90eXBlLFwic3RyaWRlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9zdHJpZGV9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksZS5wcm90b3R5cGUuc29ydD1mdW5jdGlvbigpe3ZhciBlPXRoaXM7aWYoIXRoaXMuY29tcGFyZVZhbHVlT2Zmc2V0KXRocm93IG5ldyBFcnJvcihcIlRoZSBEeW5hbWljRmxvYXRBcnJheS5zb3J0KCkgbWV0aG9kIG5lZWRzIGEgdmFsaWQgJ2NvbXBhcmVWYWx1ZU9mZnNldCcgcHJvcGVydHlcIik7dmFyIHQ9dGhpcy51c2VkRWxlbWVudENvdW50O2lmKCF0aGlzLl9zb3J0VGFibGV8fHRoaXMuX3NvcnRUYWJsZS5sZW5ndGg8dCl7dmFyIGk9TWF0aC5taW4odGhpcy50b3RhbEVsZW1lbnRDb3VudCwyKnQpO3RoaXMuX3NvcnRUYWJsZT1uZXcgQXJyYXkoaSksdGhpcy5fc29ydGVkVGFibGU9bmV3IEFycmF5KGkpfXRoaXMucGFjaygpO2Zvcih2YXIgbj0wLG89dGhpcy5zdHJpZGUscz0wO3Q+cztzKyssbis9byl7dmFyIGE9dGhpcy5fc29ydFRhYmxlW3NdO2F8fChhPW5ldyByLHRoaXMuX3NvcnRUYWJsZVtzXT1hKSxhLmNvbXBhcmVEYXRhPXRoaXMuYnVmZmVyW24rdGhpcy5jb21wYXJlVmFsdWVPZmZzZXRdLGEub2Zmc2V0PW4sYS5zd2FwZWRPZmZzZXQ9bnVsbCx0aGlzLl9zb3J0ZWRUYWJsZVtzXT1hfXRoaXMuc29ydGluZ0FzY2VuZGluZz90aGlzLl9zb3J0ZWRUYWJsZS5zb3J0KGZ1bmN0aW9uKGUsdCl7cmV0dXJuIGUuY29tcGFyZURhdGEtdC5jb21wYXJlRGF0YX0pOnRoaXMuX3NvcnRlZFRhYmxlLnNvcnQoZnVuY3Rpb24oZSx0KXtyZXR1cm4gdC5jb21wYXJlRGF0YS1lLmNvbXBhcmVEYXRhfSk7Zm9yKHZhciBoPWZ1bmN0aW9uKHQsaSl7Zm9yKHZhciByPTA7bz5yO3IrKyl7dmFyIG49ZS5idWZmZXJbaStyXTtlLmJ1ZmZlcltpK3JdPWUuYnVmZmVyW3Qrcl0sZS5idWZmZXJbdCtyXT1ufX0scz0wO3Q+cztzKyspe3ZhciBjPXRoaXMuX3NvcnRlZFRhYmxlW3NdLGw9dGhpcy5fc29ydFRhYmxlW3NdLHU9Yy5vZmZzZXQ7aWYoYy5zd2FwZWRPZmZzZXQpe2Zvcih2YXIgZj1jO2Yuc3dhcGVkT2Zmc2V0OylmPXRoaXMuX3NvcnRUYWJsZVtmLnN3YXBlZE9mZnNldC9vXTt1PWYub2Zmc2V0fWwuc3dhcGVkT2Zmc2V0PXUsdSE9PWwub2Zmc2V0JiZoKHUsbC5vZmZzZXQpLHRoaXMuX2FsbEVudHJpZXNbYy5vZmZzZXQvb10ub2Zmc2V0PWwub2Zmc2V0fXJldHVybiB0aGlzLl9hbGxFbnRyaWVzLnNvcnQoZnVuY3Rpb24oZSx0KXtyZXR1cm4gZS5vZmZzZXQtdC5vZmZzZXR9KSwhMH0sZX0oKTtlLkR5bmFtaWNGbG9hdEFycmF5PWk7dmFyIHI9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7dGhpcy5jb21wYXJlRGF0YT10aGlzLm9mZnNldD10aGlzLnN3YXBlZE9mZnNldD1udWxsfXJldHVybiBlfSgpfShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoKXt9cmV0dXJuIGV9KCk7ZS5DaGFySW5mbz10O3ZhciBpPWZ1bmN0aW9uKGkpe2Z1bmN0aW9uIHIodCxyLG4sbyxzKXt2b2lkIDA9PT1vJiYobz0yMDApLHZvaWQgMD09PXMmJihzPWUuVGV4dHVyZS5UUklMSU5FQVJfU0FNUExJTkdNT0RFKSxpLmNhbGwodGhpcyxudWxsLG4sITAsITEscyksdGhpcy5fY2hhckluZm9zPXt9LHRoaXMuX2N1ckNoYXJDb3VudD0wLHRoaXMuX2xhc3RVcGRhdGVDaGFyQ291bnQ9LTEsdGhpcy5fdXNlZENvdW50ZXI9MSx0aGlzLm5hbWU9dCx0aGlzLndyYXBVPWUuVGV4dHVyZS5DTEFNUF9BRERSRVNTTU9ERSx0aGlzLndyYXBWPWUuVGV4dHVyZS5DTEFNUF9BRERSRVNTTU9ERSx0aGlzLl9jYW52YXM9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKSx0aGlzLl9jb250ZXh0PXRoaXMuX2NhbnZhcy5nZXRDb250ZXh0KFwiMmRcIiksdGhpcy5fY29udGV4dC5mb250PXIsdGhpcy5fY29udGV4dC5maWxsU3R5bGU9XCJ3aGl0ZVwiO3ZhciBhPXRoaXMuZ2V0Rm9udEhlaWdodChyKTt0aGlzLl9saW5lSGVpZ2h0PWEuaGVpZ2h0LHRoaXMuX29mZnNldD1hLm9mZnNldC0xO3ZhciBoPXRoaXMuX2NvbnRleHQubWVhc3VyZVRleHQoXCJXXCIpLndpZHRoO3RoaXMuX3NwYWNlV2lkdGg9dGhpcy5fY29udGV4dC5tZWFzdXJlVGV4dChcIiBcIikud2lkdGg7dmFyIGM9dGhpcy5fbGluZUhlaWdodCpoKm8sbD1NYXRoLnNxcnQoYyksdT1NYXRoLnBvdygyLE1hdGguY2VpbChNYXRoLmxvZyhsKS9NYXRoLmxvZygyKSkpO3RoaXMuX3RleHR1cmU9bi5nZXRFbmdpbmUoKS5jcmVhdGVEeW5hbWljVGV4dHVyZSh1LHUsITEscyk7dmFyIGY9dGhpcy5nZXRTaXplKCk7dGhpcy5fY2FudmFzPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIiksdGhpcy5fY2FudmFzLndpZHRoPWYud2lkdGgsdGhpcy5fY2FudmFzLmhlaWdodD1mLmhlaWdodCx0aGlzLl9jb250ZXh0PXRoaXMuX2NhbnZhcy5nZXRDb250ZXh0KFwiMmRcIiksdGhpcy5fY29udGV4dC50ZXh0QmFzZWxpbmU9XCJ0b3BcIix0aGlzLl9jb250ZXh0LmZvbnQ9cix0aGlzLl9jb250ZXh0LmZpbGxTdHlsZT1cIndoaXRlXCIsdGhpcy5fY29udGV4dC5pbWFnZVNtb290aGluZ0VuYWJsZWQ9ITEsdGhpcy5fY3VycmVudEZyZWVQb3NpdGlvbj1lLlZlY3RvcjIuWmVybygpO2Zvcih2YXIgZD0zMjsxMjc+ZDtkKyspe3ZhciBwPVN0cmluZy5mcm9tQ2hhckNvZGUoZCk7dGhpcy5nZXRDaGFyKHApfXRoaXMudXBkYXRlKCl9cmV0dXJuIF9fZXh0ZW5kcyhyLGkpLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLnByb3RvdHlwZSxcInNwYWNlV2lkdGhcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3NwYWNlV2lkdGh9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHIucHJvdG90eXBlLFwibGluZUhlaWdodFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fbGluZUhlaWdodH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxyLkdldENhY2hlZEZvbnRUZXh0dXJlPWZ1bmN0aW9uKHQsaSl7dmFyIG49dDtuLl9fZm9udFRleHR1cmVDYWNoZV9ffHwobi5fX2ZvbnRUZXh0dXJlQ2FjaGVfXz1uZXcgZS5TdHJpbmdEaWN0aW9uYXJ5KTt2YXIgbz1uLl9fZm9udFRleHR1cmVDYWNoZV9fLHM9aS50b0xvY2FsZUxvd2VyQ2FzZSgpLGE9by5nZXQocyk7cmV0dXJuIGE/KCsrYS5fdXNlZENvdW50ZXIsYSk6KGE9bmV3IHIobnVsbCxzLHQsMjAwLGUuVGV4dHVyZS5ORUFSRVNUX1NBTVBMSU5HTU9ERSksby5hZGQocyxhKSxhKX0sci5SZWxlYXNlQ2FjaGVkRm9udFRleHR1cmU9ZnVuY3Rpb24oZSx0KXt2YXIgaT1lLHI9aS5fX2ZvbnRUZXh0dXJlQ2FjaGVfXztpZihyKXt2YXIgbj10LnRvTG9jYWxlTG93ZXJDYXNlKCksbz1yLmdldChuKTswPT09LS1vLl91c2VkQ291bnRlciYmKHIucmVtb3ZlKG4pLG8uZGlzcG9zZSgpKX19LHIucHJvdG90eXBlLmdldENoYXI9ZnVuY3Rpb24oaSl7aWYoMSE9PWkubGVuZ3RoKXJldHVybiBudWxsO3ZhciByPXRoaXMuX2NoYXJJbmZvc1tpXTtpZihyKXJldHVybiByO3I9bmV3IHQ7dmFyIG49dGhpcy5fY29udGV4dC5tZWFzdXJlVGV4dChpKSxvPXRoaXMuZ2V0U2l6ZSgpLHM9MixhPTIsaD1uLndpZHRoO3JldHVybiB0aGlzLl9jdXJyZW50RnJlZVBvc2l0aW9uLngraCtzPm8ud2lkdGgmJih0aGlzLl9jdXJyZW50RnJlZVBvc2l0aW9uLng9MCx0aGlzLl9jdXJyZW50RnJlZVBvc2l0aW9uLnkrPXRoaXMuX2xpbmVIZWlnaHQrYSx0aGlzLl9jdXJyZW50RnJlZVBvc2l0aW9uLnk+by5oZWlnaHQpP3RoaXMuZ2V0Q2hhcihcIiFcIik6KHRoaXMuX2NvbnRleHQuZmlsbFRleHQoaSx0aGlzLl9jdXJyZW50RnJlZVBvc2l0aW9uLngtLjUsdGhpcy5fY3VycmVudEZyZWVQb3NpdGlvbi55LXRoaXMuX29mZnNldC0uNSksci50b3BMZWZ0VVY9bmV3IGUuVmVjdG9yMih0aGlzLl9jdXJyZW50RnJlZVBvc2l0aW9uLngvby53aWR0aCx0aGlzLl9jdXJyZW50RnJlZVBvc2l0aW9uLnkvby5oZWlnaHQpLHIuYm90dG9tUmlnaHRVVj1uZXcgZS5WZWN0b3IyKHIudG9wTGVmdFVWLngraC9vLndpZHRoLHIudG9wTGVmdFVWLnkrKHRoaXMuX2xpbmVIZWlnaHQrMikvby5oZWlnaHQpLHIuY2hhcldpZHRoPWgsdGhpcy5fY2hhckluZm9zW2ldPXIsdGhpcy5fY3VyQ2hhckNvdW50KyssdGhpcy5fY3VycmVudEZyZWVQb3NpdGlvbi54Kz1oK3Mscil9LHIucHJvdG90eXBlLm1lYXN1cmVUZXh0PWZ1bmN0aW9uKHQsaSl7dm9pZCAwPT09aSYmKGk9NCk7Zm9yKHZhciByPTAsbj0wLG89MSxzPTAsYT0wO2E8dC5sZW5ndGg7YSsrKXt2YXIgaD10W2FdO2lmKFwiXFxuXCIhPT1oKWlmKFwiXHRcIiE9PWgpXCIgXCI+aHx8KG4rPXRoaXMuZ2V0Q2hhcihoKS5jaGFyV2lkdGgsKytzKTtlbHNle3ZhciBjPXMraTtjLT1jJWksbis9KGMtcykqdGhpcy5zcGFjZVdpZHRoLHM9Y31lbHNlIHI9TWF0aC5tYXgocixuKSxzPTAsbj0wLCsrb31yZXR1cm4gcj1NYXRoLm1heChyLG4pLG5ldyBlLlNpemUocixvKnRoaXMuX2xpbmVIZWlnaHQpfSxyLnByb3RvdHlwZS5nZXRGb250SGVpZ2h0PWZ1bmN0aW9uKGUpe3ZhciB0PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIiksaT10LmdldENvbnRleHQoXCIyZFwiKTtpLmZpbGxSZWN0KDAsMCx0LndpZHRoLHQuaGVpZ2h0KSxpLnRleHRCYXNlbGluZT1cInRvcFwiLGkuZmlsbFN0eWxlPVwid2hpdGVcIixpLmZvbnQ9ZSxpLmZpbGxUZXh0KFwiakh8XCIsMCwwKTtmb3IodmFyIHI9aS5nZXRJbWFnZURhdGEoMCwwLHQud2lkdGgsdC5oZWlnaHQpLmRhdGEsbj0tMSxvPS0xLHM9MDtzPHQuaGVpZ2h0O3MrKylmb3IodmFyIGE9MDthPHQud2lkdGg7YSsrKXt2YXIgaD00KihzKnQud2lkdGgrYSk7e2lmKDAhPT1yW2hdKXstMT09PW4mJihuPXMpO2JyZWFrfWlmKGE9PT10LndpZHRoLTEmJi0xIT09bil7bz1zLHM9dC5oZWlnaHQ7YnJlYWt9fX1yZXR1cm57aGVpZ2h0Om8tbixvZmZzZXQ6bi0xfX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KHIucHJvdG90eXBlLFwiY2FuUmVzY2FsZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4hMX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxyLnByb3RvdHlwZS5nZXRDb250ZXh0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2NvbnRleHR9LHIucHJvdG90eXBlLnVwZGF0ZT1mdW5jdGlvbigpe3RoaXMuX2xhc3RVcGRhdGVDaGFyQ291bnQ8dGhpcy5fY3VyQ2hhckNvdW50JiYodGhpcy5nZXRTY2VuZSgpLmdldEVuZ2luZSgpLnVwZGF0ZUR5bmFtaWNUZXh0dXJlKHRoaXMuX3RleHR1cmUsdGhpcy5fY2FudmFzLCExLCEwKSx0aGlzLl9sYXN0VXBkYXRlQ2hhckNvdW50PXRoaXMuX2N1ckNoYXJDb3VudCl9LHIucHJvdG90eXBlLmNsb25lPWZ1bmN0aW9uKCl7cmV0dXJuIG51bGx9LHJ9KGUuVGV4dHVyZSk7ZS5Gb250VGV4dHVyZT1pfShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbih0KXtmdW5jdGlvbiBpKGkscixuLG8pe3ZvaWQgMD09PW8mJihvPWUuVGV4dHVyZS5UUklMSU5FQVJfU0FNUExJTkdNT0RFKSx0LmNhbGwodGhpcyxudWxsLHIsITAsITEsbyksdGhpcy5uYW1lPWksdGhpcy5fc2l6ZT1uLHRoaXMud3JhcFU9ZS5UZXh0dXJlLkNMQU1QX0FERFJFU1NNT0RFLHRoaXMud3JhcFY9ZS5UZXh0dXJlLkNMQU1QX0FERFJFU1NNT0RFLHRoaXMuX3JlY3RQYWNraW5nTWFwPW5ldyBlLlJlY3RQYWNraW5nTWFwKG5ldyBlLlNpemUobi53aWR0aCxuLmhlaWdodCkpLHRoaXMuX3RleHR1cmU9ci5nZXRFbmdpbmUoKS5jcmVhdGVSZW5kZXJUYXJnZXRUZXh0dXJlKG4se2dlbmVyYXRlTWlwTWFwczohdGhpcy5ub01pcG1hcCx0eXBlOmUuRW5naW5lLlRFWFRVUkVUWVBFX1VOU0lHTkVEX0lOVH0pfXJldHVybiBfX2V4dGVuZHMoaSx0KSxpLnByb3RvdHlwZS5hbGxvY2F0ZVJlY3Q9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX3JlY3RQYWNraW5nTWFwLmFkZFJlY3QoZSl9LGkucHJvdG90eXBlLmZyZWVSZWN0PWZ1bmN0aW9uKGUpe2UmJmUuZnJlZUNvbnRlbnQoKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KGkucHJvdG90eXBlLFwiZnJlZVNwYWNlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9yZWN0UGFja2luZ01hcC5mcmVlU3BhY2V9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksaS5wcm90b3R5cGUuYmluZFRleHR1cmVGb3JSZWN0PWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuYmluZFRleHR1cmVGb3JQb3NTaXplKGUucG9zLGUuY29udGVudFNpemUsdCl9LGkucHJvdG90eXBlLmJpbmRUZXh0dXJlRm9yUG9zU2l6ZT1mdW5jdGlvbih0LGkscil7dmFyIG49dGhpcy5nZXRTY2VuZSgpLmdldEVuZ2luZSgpO24uYmluZEZyYW1lYnVmZmVyKHRoaXMuX3RleHR1cmUpLHRoaXMuX3JlcGxhY2VkVmlld3BvcnQ9bi5zZXREaXJlY3RWaWV3cG9ydCh0LngsdC55LGkud2lkdGgsaS5oZWlnaHQpLHImJm4uc2Npc3NvckNsZWFyKHQueCx0LnksaS53aWR0aCxpLmhlaWdodCxuZXcgZS5Db2xvcjQoMCwwLDAsMCkpfSxpLnByb3RvdHlwZS51bmJpbmRUZXh0dXJlPWZ1bmN0aW9uKHQpe3QmJmUuVG9vbHMuRHVtcEZyYW1lYnVmZmVyKHRoaXMuX3NpemUud2lkdGgsdGhpcy5fc2l6ZS5oZWlnaHQsdGhpcy5nZXRTY2VuZSgpLmdldEVuZ2luZSgpKTt2YXIgaT10aGlzLmdldFNjZW5lKCkuZ2V0RW5naW5lKCk7dGhpcy5fcmVwbGFjZWRWaWV3cG9ydCYmKGkuc2V0Vmlld3BvcnQodGhpcy5fcmVwbGFjZWRWaWV3cG9ydCksdGhpcy5fcmVwbGFjZWRWaWV3cG9ydD1udWxsKSxpLnVuQmluZEZyYW1lYnVmZmVyKHRoaXMuX3RleHR1cmUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJjYW5SZXNjYWxlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiExfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLGkucHJvdG90eXBlLmNsb25lPWZ1bmN0aW9uKCl7cmV0dXJuIG51bGx9LGl9KGUuVGV4dHVyZSk7ZS5NYXBUZXh0dXJlPXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCgpe3RoaXMucmFkaXVzPTAsdGhpcy5jZW50ZXI9ZS5WZWN0b3IyLlplcm8oKSx0aGlzLmV4dGVudD1lLlZlY3RvcjIuWmVybygpfXJldHVybiB0LkNyZWF0ZUZyb21TaXplPWZ1bmN0aW9uKGUpe3ZhciBpPW5ldyB0O3JldHVybiB0LkNyZWF0ZUZyb21TaXplVG9SZWYoZSxpKSxpfSx0LkNyZWF0ZUZyb21SYWRpdXM9ZnVuY3Rpb24oZSl7dmFyIGk9bmV3IHQ7cmV0dXJuIHQuQ3JlYXRlRnJvbVJhZGl1c1RvUmVmKGUsaSksaX0sdC5DcmVhdGVGcm9tUG9pbnRzPWZ1bmN0aW9uKGUpe3ZhciBpPW5ldyB0O3JldHVybiB0LkNyZWF0ZUZyb21Qb2ludHNUb1JlZihlLGkpLGl9LHQuQ3JlYXRlRnJvbVNpemVUb1JlZj1mdW5jdGlvbih0LGkpe3R8fCh0PWUuU2l6ZS5aZXJvKCkpLGkuY2VudGVyLng9K3Qud2lkdGgvMixpLmNlbnRlci55PSt0LmhlaWdodC8yLGkuZXh0ZW50Lng9aS5jZW50ZXIueCxpLmV4dGVudC55PWkuY2VudGVyLnksaS5yYWRpdXM9aS5leHRlbnQubGVuZ3RoKCl9LHQuQ3JlYXRlRnJvbVJhZGl1c1RvUmVmPWZ1bmN0aW9uKGUsdCl7dC5jZW50ZXIueD10LmNlbnRlci55PTA7dmFyIGk9K2U7dC5leHRlbnQueD1pLHQuZXh0ZW50Lnk9aSx0LnJhZGl1cz1pfSx0LkNyZWF0ZUZyb21Qb2ludHNUb1JlZj1mdW5jdGlvbihlLGkpe2Zvcih2YXIgcj1OdW1iZXIuTUFYX1ZBTFVFLG49TnVtYmVyLk1BWF9WQUxVRSxvPU51bWJlci5NSU5fVkFMVUUscz1OdW1iZXIuTUlOX1ZBTFVFLGE9MDthPGUubGVuZ3RoO2ErKyl7dmFyIGg9ZVthXTtyPU1hdGgubWluKGgueCxyKSxvPU1hdGgubWF4KGgueCxvKSxuPU1hdGgubWluKGgueSxuKSxzPU1hdGgubWF4KGgueSxzKX10LkNyZWF0ZUZyb21NaW5NYXhUb1JlZihyLG8sbixzLGkpfSx0LkNyZWF0ZUZyb21NaW5NYXhUb1JlZj1mdW5jdGlvbih0LGkscixuLG8pe3ZhciBzPWktdCxhPW4tcjtvLmNlbnRlcj1uZXcgZS5WZWN0b3IyKHQrcy8yLHIrYS8yKSxvLmV4dGVudD1uZXcgZS5WZWN0b3IyKGktby5jZW50ZXIueCxuLW8uY2VudGVyLnkpLG8ucmFkaXVzPW8uZXh0ZW50Lmxlbmd0aCgpfSx0LnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbigpe3ZhciBlPW5ldyB0O3JldHVybiBlLmNlbnRlcj10aGlzLmNlbnRlci5jbG9uZSgpLGUucmFkaXVzPXRoaXMucmFkaXVzLGUuZXh0ZW50PXRoaXMuZXh0ZW50LmNsb25lKCksZX0sdC5wcm90b3R5cGUubWF4PWZ1bmN0aW9uKCl7dmFyIHQ9ZS5WZWN0b3IyLlplcm8oKTtyZXR1cm4gdGhpcy5tYXhUb1JlZih0KSx0fSx0LnByb3RvdHlwZS5tYXhUb1JlZj1mdW5jdGlvbihlKXtlLng9dGhpcy5jZW50ZXIueCt0aGlzLmV4dGVudC54LGUueT10aGlzLmNlbnRlci55K3RoaXMuZXh0ZW50Lnl9LHQucHJvdG90eXBlLnRyYW5zZm9ybT1mdW5jdGlvbihlKXt2YXIgaT1uZXcgdDtyZXR1cm4gdGhpcy50cmFuc2Zvcm1Ub1JlZihlLGkpLGl9LHQucHJvdG90eXBlLnVuaW9uPWZ1bmN0aW9uKGUpe3ZhciBpPW5ldyB0O3JldHVybiB0aGlzLnVuaW9uVG9SZWYoZSxpKSxpfSx0LnByb3RvdHlwZS50cmFuc2Zvcm1Ub1JlZj1mdW5jdGlvbihpLHIpe3ZhciBuPXQuX3RyYW5zZm9ybTtuWzBdLng9dGhpcy5jZW50ZXIueCt0aGlzLmV4dGVudC54LG5bMF0ueT10aGlzLmNlbnRlci55K3RoaXMuZXh0ZW50LnksblsxXS54PXRoaXMuY2VudGVyLngrdGhpcy5leHRlbnQueCxuWzFdLnk9dGhpcy5jZW50ZXIueS10aGlzLmV4dGVudC55LG5bMl0ueD10aGlzLmNlbnRlci54LXRoaXMuZXh0ZW50LngsblsyXS55PXRoaXMuY2VudGVyLnktdGhpcy5leHRlbnQueSxuWzNdLng9dGhpcy5jZW50ZXIueC10aGlzLmV4dGVudC54LG5bM10ueT10aGlzLmNlbnRlci55K3RoaXMuZXh0ZW50Lnk7Zm9yKHZhciBvPTA7ND5vO28rKyllLlZlY3RvcjIuVHJhbnNmb3JtVG9SZWYobltvXSxpLG5bb10pO3QuQ3JlYXRlRnJvbVBvaW50c1RvUmVmKG4scil9LHQucHJvdG90eXBlLnVuaW9uVG9SZWY9ZnVuY3Rpb24oZSxpKXt2YXIgcj1NYXRoLm1heCh0aGlzLmNlbnRlci54K3RoaXMuZXh0ZW50LngsZS5jZW50ZXIueCtlLmV4dGVudC54KSxuPU1hdGgubWF4KHRoaXMuY2VudGVyLnkrdGhpcy5leHRlbnQueSxlLmNlbnRlci55K2UuZXh0ZW50LnkpLG89TWF0aC5taW4odGhpcy5jZW50ZXIueC10aGlzLmV4dGVudC54LGUuY2VudGVyLngtZS5leHRlbnQueCkscz1NYXRoLm1pbih0aGlzLmNlbnRlci55LXRoaXMuZXh0ZW50LnksZS5jZW50ZXIueS1lLmV4dGVudC55KTt0LkNyZWF0ZUZyb21NaW5NYXhUb1JlZihvLHIscyxuLGkpfSx0LnByb3RvdHlwZS5kb2VzSW50ZXJzZWN0PWZ1bmN0aW9uKGUpe3ZhciB0PWUuc3VidHJhY3QodGhpcy5jZW50ZXIpO3JldHVybiB0Lmxlbmd0aFNxdWFyZWQoKTw9dGhpcy5yYWRpdXMqdGhpcy5yYWRpdXM/TWF0aC5hYnModC54KTw9dGhpcy5leHRlbnQueCYmTWF0aC5hYnModC55KTw9dGhpcy5leHRlbnQueTohMX0sdC5fdHJhbnNmb3JtPW5ldyBBcnJheShlLlZlY3RvcjIuWmVybygpLGUuVmVjdG9yMi5aZXJvKCksZS5WZWN0b3IyLlplcm8oKSxlLlZlY3RvcjIuWmVybygpKSx0fSgpO2UuQm91bmRpbmdJbmZvMkQ9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7fXJldHVybiBlLnByb3RvdHlwZS5pc0xvY2tlZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9pc0xvY2tlZH0sZS5wcm90b3R5cGUubG9jaz1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9pc0xvY2tlZD8hMDoodGhpcy5vbkxvY2soKSx0aGlzLl9pc0xvY2tlZD0hMCwhMSl9LGUucHJvdG90eXBlLm9uTG9jaz1mdW5jdGlvbigpe30sZX0oKTtlLkxvY2thYmxlQmFzZT10O3ZhciBpPWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGkoZSxpKXt2b2lkIDA9PT1pJiYoaT0hMSksdC5jYWxsKHRoaXMpLHRoaXMuX2NvbG9yPWUsaSYmdGhpcy5sb2NrKCl9cmV0dXJuIF9fZXh0ZW5kcyhpLHQpLGkucHJvdG90eXBlLmlzVHJhbnNwYXJlbnQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fY29sb3ImJnRoaXMuX2NvbG9yLmE8MX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KGkucHJvdG90eXBlLFwiY29sb3JcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2NvbG9yfSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5pc0xvY2tlZCgpfHwodGhpcy5fY29sb3I9ZSl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksaS5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fY29sb3IudG9IZXhTdHJpbmcoKX0saT1fX2RlY29yYXRlKFtlLmNsYXNzTmFtZShcIlNvbGlkQ29sb3JCcnVzaDJEXCIpXSxpKX0odCk7ZS5Tb2xpZENvbG9yQnJ1c2gyRD1pO3ZhciByPWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGkoaSxyLG4sbyxzLGEpe3ZvaWQgMD09PW4mJihuPWUuVmVjdG9yMi5aZXJvKCkpLHZvaWQgMD09PW8mJihvPTApLHZvaWQgMD09PXMmJihzPTEpLHZvaWQgMD09PWEmJihhPSExKSx0LmNhbGwodGhpcyksdGhpcy5fY29sb3IxPWksdGhpcy5fY29sb3IyPXIsdGhpcy5fdHJhbnNsYXRpb249bix0aGlzLl9yb3RhdGlvbj1vLHRoaXMuX3NjYWxlPXMsYSYmdGhpcy5sb2NrKCl9cmV0dXJuIF9fZXh0ZW5kcyhpLHQpLGkucHJvdG90eXBlLmlzVHJhbnNwYXJlbnQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fY29sb3IxJiZ0aGlzLl9jb2xvcjEuYTwxfHx0aGlzLl9jb2xvcjImJnRoaXMuX2NvbG9yMi5hPDF9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcImNvbG9yMVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fY29sb3IxfSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5pc0xvY2tlZCgpfHwodGhpcy5fY29sb3IxPWUpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcImNvbG9yMlwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fY29sb3IyfSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5pc0xvY2tlZCgpfHwodGhpcy5fY29sb3IyPWUpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcInRyYW5zbGF0aW9uXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl90cmFuc2xhdGlvbn0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuaXNMb2NrZWQoKXx8KHRoaXMuX3RyYW5zbGF0aW9uPWUpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcInJvdGF0aW9uXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9yb3RhdGlvbn0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuaXNMb2NrZWQoKXx8KHRoaXMuX3JvdGF0aW9uPWUpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcInNjYWxlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9zY2FsZX0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuaXNMb2NrZWQoKXx8KHRoaXMuX3NjYWxlPWUpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLGkucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuXCJDMTpcIit0aGlzLl9jb2xvcjErXCI7QzI6XCIrdGhpcy5fY29sb3IyK1wiO1Q6XCIrdGhpcy5fdHJhbnNsYXRpb24udG9TdHJpbmcoKStcIjtSOlwiK3RoaXMuX3JvdGF0aW9uK1wiO1M6XCIrdGhpcy5fc2NhbGUrXCI7XCJ9LGkuQnVpbGRLZXk9ZnVuY3Rpb24oZSx0LGkscixuKXtyZXR1cm5cIkMxOlwiK2UrXCI7QzI6XCIrdCtcIjtUOlwiK2kudG9TdHJpbmcoKStcIjtSOlwiK3IrXCI7UzpcIituK1wiO1wifSxpPV9fZGVjb3JhdGUoW2UuY2xhc3NOYW1lKFwiR3JhZGllbnRDb2xvckJydXNoMkRcIildLGkpfSh0KTtlLkdyYWRpZW50Q29sb3JCcnVzaDJEPXJ9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQoZSx0LGkscil7cmV0dXJuIHZvaWQgMD09PWkmJihpPSExKSx2b2lkIDA9PT1yJiYocj0hMSksaC5faG9va1Byb3BlcnR5KGUsdCxpLHIsby5QUk9QS0lORF9NT0RFTCl9ZnVuY3Rpb24gaShlLHQsaSxyKXtyZXR1cm4gdm9pZCAwPT09aSYmKGk9ITEpLHZvaWQgMD09PXImJihyPSExKSxoLl9ob29rUHJvcGVydHkoZSx0LGkscixvLlBST1BLSU5EX0lOU1RBTkNFKX1mdW5jdGlvbiByKGUsdCxpLHIpe3JldHVybiB2b2lkIDA9PT1pJiYoaT0hMSksdm9pZCAwPT09ciYmKHI9ITEpLGguX2hvb2tQcm9wZXJ0eShlLHQsaSxyLG8uUFJPUEtJTkRfRFlOQU1JQyl9dmFyIG49ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7fXJldHVybiBlfSgpO2UuUHJpbTJEQ2xhc3NJbmZvPW47dmFyIG89ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7fXJldHVybiBlLlBST1BLSU5EX01PREVMPTEsZS5QUk9QS0lORF9JTlNUQU5DRT0yLGUuUFJPUEtJTkRfRFlOQU1JQz0zLGV9KCk7ZS5QcmltMkRQcm9wSW5mbz1vO3ZhciBzPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSgpe31yZXR1cm4gZX0oKTtlLlByb3BlcnR5Q2hhbmdlZEluZm89czt2YXIgYT1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCxpLHIpe3RoaXMuX2Jhc2VDbGFzcz10LHRoaXMuX3R5cGU9aSx0aGlzLl9zdWJDbGFzc2VzPW5ldyBBcnJheSx0aGlzLl9sZXZlbENvbnRlbnQ9bmV3IGUuU3RyaW5nRGljdGlvbmFyeSx0aGlzLl9jbGFzc0NvbnRlbnRGYWN0b3J5PXJ9cmV0dXJuIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcImNsYXNzQ29udGVudFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fY2xhc3NDb250ZW50fHwodGhpcy5fY2xhc3NDb250ZW50PXRoaXMuX2NsYXNzQ29udGVudEZhY3RvcnkodGhpcy5fYmFzZUNsYXNzP3RoaXMuX2Jhc2VDbGFzcy5jbGFzc0NvbnRlbnQ6bnVsbCkpLHRoaXMuX2NsYXNzQ29udGVudH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJ0eXBlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl90eXBlfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcImxldmVsQ29udGVudFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fbGV2ZWxDb250ZW50fSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcImZ1bGxDb250ZW50XCIse2dldDpmdW5jdGlvbigpe2lmKCF0aGlzLl9mdWxsQ29udGVudCl7Zm9yKHZhciB0PW5ldyBlLlN0cmluZ0RpY3Rpb25hcnksaT10aGlzO2k7KWkubGV2ZWxDb250ZW50LmZvckVhY2goZnVuY3Rpb24oZSxpKXtyZXR1cm4gdC5hZGQoZSxpKX0pLGk9aS5fYmFzZUNsYXNzO3RoaXMuX2Z1bGxDb250ZW50PXR9cmV0dXJuIHRoaXMuX2Z1bGxDb250ZW50fSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLHQucHJvdG90eXBlLmdldExldmVsT2Y9ZnVuY3Rpb24oZSl7aWYoZT09PXRoaXMuX3R5cGUpcmV0dXJuIHRoaXM7dmFyIHQ9T2JqZWN0LmdldFByb3RvdHlwZU9mKGUpLGk9dGhpcy5nZXRPckFkZFR5cGUoT2JqZWN0LmdldFByb3RvdHlwZU9mKHQpLHQpO3JldHVybiBpfHx0aGlzLmdldExldmVsT2YodCksdGhpcy5nZXRPckFkZFR5cGUodCxlKX0sdC5wcm90b3R5cGUuZ2V0T3JBZGRUeXBlPWZ1bmN0aW9uKGUsaSl7aWYoZT09PXRoaXMuX3R5cGUpe2Zvcih2YXIgcj0wLG49dGhpcy5fc3ViQ2xhc3NlcztyPG4ubGVuZ3RoO3IrKyl7dmFyIG89bltyXTtpZihvLnR5cGU9PT1pKXJldHVybiBvLm5vZGV9dmFyIHM9bmV3IHQodGhpcyxpLHRoaXMuX2NsYXNzQ29udGVudEZhY3RvcnkpLGE9e3R5cGU6aSxub2RlOnN9O3JldHVybiB0aGlzLl9zdWJDbGFzc2VzLnB1c2goYSksYS5ub2RlfWZvcih2YXIgaD0wLGM9dGhpcy5fc3ViQ2xhc3NlcztoPGMubGVuZ3RoO2grKyl7dmFyIG89Y1toXSxhPW8ubm9kZS5nZXRPckFkZFR5cGUoZSxpKTtpZihhKXJldHVybiBhfXJldHVybiBudWxsfSx0LmdldD1mdW5jdGlvbihlKXt2YXIgdD1lLl9fY2xhc3NUcmVlSW5mbztyZXR1cm4gdD90LmdldExldmVsT2YoZSk6bnVsbH0sdC5nZXRPclJlZ2lzdGVyPWZ1bmN0aW9uKGUsaSl7dmFyIHI9ZS5fX2NsYXNzVHJlZUluZm87cmV0dXJuIHJ8fChyPW5ldyB0KG51bGwsZSxpKSxlLl9fY2xhc3NUcmVlSW5mbz1yKSxyfSx0fSgpO2UuQ2xhc3NUcmVlSW5mbz1hO3ZhciBoPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCgpe3RoaXMuX2ZsYWdzPTAsdGhpcy5fbW9kZWxLZXk9bnVsbCx0aGlzLl9pbnN0YW5jZURpcnR5RmxhZ3M9MCx0aGlzLl9sZXZlbEJvdW5kaW5nSW5mbz1uZXcgZS5Cb3VuZGluZ0luZm8yRCx0aGlzLmFuaW1hdGlvbnM9bmV3IEFycmF5fXJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJpc0Rpc3Bvc2VkXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9pc0ZsYWdTZXQodC5mbGFnSXNEaXNwb3NlZCl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksdC5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmlzRGlzcG9zZWQ/ITE6KHRoaXMuYW5pbWF0aW9ucy5zcGxpY2UoMCksdGhpcy5fc2V0RmxhZ3ModC5mbGFnSXNEaXNwb3NlZCksITApfSx0LnByb3RvdHlwZS5nZXRBbmltYXRhYmxlcz1mdW5jdGlvbigpe3JldHVybiBuZXcgQXJyYXl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcIm1vZGVsS2V5XCIse2dldDpmdW5jdGlvbigpe3ZhciBpPXRoaXM7aWYoIXRoaXMuX2lzRmxhZ1NldCh0LmZsYWdNb2RlbERpcnR5KSYmdGhpcy5fbW9kZWxLZXkpcmV0dXJuIHRoaXMuX21vZGVsS2V5O3ZhciByPVwiQ2xhc3M6XCIrZS5Ub29scy5nZXRDbGFzc05hbWUodGhpcykrXCI7XCIsbj10aGlzLnByb3BEaWM7cmV0dXJuIG4uZm9yRWFjaChmdW5jdGlvbih0LG4pe2lmKG4ua2luZD09PW8uUFJPUEtJTkRfTU9ERUwpe3ZhciBzPWlbbi5uYW1lXTtpZihzJiZzLmNvbnN0cnVjdG9yPT09QXJyYXkpe3ZhciBhPXNbMF07cz1hP2UuVG9vbHMuaGFzaENvZGVGcm9tU3RyZWFtKGUuVG9vbHMuYXJyYXlPclN0cmluZ0ZlZWRlcihzKSk6MH1yKz1uLm5hbWUrXCI6XCIrKG51bGwhPXM/bi50eXBlTGV2ZWxDb21wYXJlP2UuVG9vbHMuZ2V0Q2xhc3NOYW1lKHMpOnMudG9TdHJpbmcoKTpcIltudWxsXVwiKStcIjtcIn19KSx0aGlzLl9jbGVhckZsYWdzKHQuZmxhZ01vZGVsRGlydHkpLHRoaXMuX21vZGVsS2V5PXIscn0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJpc0RpcnR5XCIse2dldDpmdW5jdGlvbigpe3JldHVybiAwIT09dGhpcy5faW5zdGFuY2VEaXJ0eUZsYWdzfHx0aGlzLl9hcmVTb21lRmxhZ3NTZXQodC5mbGFnTW9kZWxEaXJ0eXx0LmZsYWdQb3NpdGlvbmluZ0RpcnR5fHQuZmxhZ0xheW91dERpcnR5KX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJwcm9wRGljXCIse2dldDpmdW5jdGlvbigpe2lmKCF0aGlzLl9wcm9wSW5mbyl7dmFyIGU9YS5nZXQoT2JqZWN0LmdldFByb3RvdHlwZU9mKHRoaXMpKTtpZighZSl0aHJvdyBuZXcgRXJyb3IoXCJDYW4ndCBhY2Nlc3MgdGhlIHByb3BEaWMgbWVtYmVyIGluIGNsYXNzIGRlZmluaXRpb24sIGlzIHRoaXMgY2xhc3MgU21hcnRQcm9wZXJ0eVByaW0gYmFzZWQ/XCIpO3RoaXMuX3Byb3BJbmZvPWUuZnVsbENvbnRlbnR9cmV0dXJuIHRoaXMuX3Byb3BJbmZvfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLHQuX2NyZWF0ZVByb3BJbmZvPWZ1bmN0aW9uKGUsdCxpLHIscyxoKXt2YXIgYz1hLmdldE9yUmVnaXN0ZXIoZSxmdW5jdGlvbigpe3JldHVybiBuZXcgbn0pLGw9Yy5nZXRMZXZlbE9mKGUpLHU9bC5sZXZlbENvbnRlbnQuZ2V0KGkudG9TdHJpbmcoKSk7aWYodSl0aHJvdyBuZXcgRXJyb3IoXCJUaGUgSUQgXCIraStcIiBpcyBhbHJlYWR5IHRha2VuIGJ5IGFub3RoZXIgcHJvcGVydHkgZGVjbGFyYXRpb24gbmFtZWQ6IFwiK3UubmFtZSk7cmV0dXJuIHU9bmV3IG8sdS5pZD1pLHUuZmxhZ0lkPU1hdGgucG93KDIsaSksdS5raW5kPWgsdS5uYW1lPXQsdS5kaXJ0eUJvdW5kaW5nSW5mbz1yLHUudHlwZUxldmVsQ29tcGFyZT1zLGwubGV2ZWxDb250ZW50LmFkZCh0LHUpLHV9LHQuX2NoZWNrVW5jaGFuZ2VkPWZ1bmN0aW9uKGUsdCl7aWYobnVsbD09PWUmJm51bGw9PT10fHx2b2lkIDA9PT1lJiZ2b2lkIDA9PT10KXJldHVybiEwO2lmKG51bGwhPWUmJm51bGwhPXQpaWYoXCJmdW5jdGlvblwiPT10eXBlb2YgZS5lcXVhbHMpe2lmKGUuZXF1YWxzKHQpKXJldHVybiEwfWVsc2UgaWYoZT09PXQpcmV0dXJuITA7cmV0dXJuITF9LHQucHJvdG90eXBlLm1hcmtBc0RpcnR5PWZ1bmN0aW9uKGUpe2lmKCF0aGlzLmlzRGlzcG9zZWQpe3ZhciB0PWUuaW5kZXhPZihcIi5cIik7LTEhPT10JiYoZT1lLnN1YnN0cigwLHQpKTt2YXIgaT10aGlzLnByb3BEaWMuZ2V0KGUpO2lmKGkpe3ZhciByPXRoaXNbZV07dGhpcy5faGFuZGxlUHJvcENoYW5nZWQodm9pZCAwLHIsZSxpLGkudHlwZUxldmVsQ29tcGFyZSl9fX0sdC5wcm90b3R5cGUuX2JvdW5kaW5nQm94RGlydHk9ZnVuY3Rpb24oKXtpZih0aGlzLl9zZXRGbGFncyh0LmZsYWdMZXZlbEJvdW5kaW5nSW5mb0RpcnR5KSx0aGlzIGluc3RhbmNlb2YgZS5QcmltMkRCYXNlKWZvcih2YXIgaT10aGlzO2kmJihpLl9ib3VuZGluZ1NpemU9bnVsbCxpLl9zZXRGbGFncyh0LmZsYWdCb3VuZGluZ0luZm9EaXJ0eSksaS5pc1NpemVBdXRvJiZpLm9uUHJpbWl0aXZlUHJvcGVydHlEaXJ0eShlLlByaW0yREJhc2Uuc2l6ZVByb3BlcnR5LmZsYWdJZCksIShpIGluc3RhbmNlb2YgZS5Hcm91cDJEJiZpLmlzUmVuZGVyYWJsZUdyb3VwKSk7KWk9aS5wYXJlbnQ7XG59LHQucHJvdG90eXBlLl9oYW5kbGVQcm9wQ2hhbmdlZD1mdW5jdGlvbihpLHIsbixzLGEpe3MuZGlydHlCb3VuZGluZ0luZm8mJnRoaXMuX2JvdW5kaW5nQm94RGlydHkoKTt2YXIgaD10LnByb3BDaGFuZ2VkSW5mbztoLm9sZFZhbHVlPWksaC5uZXdWYWx1ZT1yLGgucHJvcGVydHlOYW1lPW47dmFyIGM9cy5mbGFnSWQ7aWYodGhpcy5wcm9wZXJ0eUNoYW5nZWQubm90aWZ5T2JzZXJ2ZXJzKGgsYyksdGhpcyBpbnN0YW5jZW9mIGUuR3JvdXAyRCYmdGhpcy5oYW5kbGVHcm91cENoYW5nZWQocyksdGhpcyBpbnN0YW5jZW9mIGUuUHJpbTJEQmFzZSl7dmFyIGw9dGhpcy5fcGFyZW50O251bGwhPWwmJmwubGF5b3V0RW5naW5lJiYwIT09KGwubGF5b3V0RW5naW5lLmxheW91dERpcnR5T25Qcm9wZXJ0eUNoYW5nZWRNYXNrJnMuZmxhZ0lkKSYmbC5fc2V0TGF5b3V0RGlydHkoKX12YXIgdT0hMTtpZihhJiZudWxsIT1pJiZudWxsIT1yKXt2YXIgZj1pLl9fcHJvdG9fXyxkPXIuX19wcm90b19fO3U9Zj09PWR9dXx8cy5raW5kIT09by5QUk9QS0lORF9NT0RFTD8odXx8cy5raW5kPT09by5QUk9QS0lORF9JTlNUQU5DRXx8cy5raW5kPT09by5QUk9QS0lORF9EWU5BTUlDKSYmdGhpcy5vblByaW1pdGl2ZVByb3BlcnR5RGlydHkoYyk6dGhpcy5vblByaW1pdGl2ZVByb3BlcnR5RGlydHkodC5mbGFnTW9kZWxEaXJ0eSl9LHQucHJvdG90eXBlLm9uUHJpbWl0aXZlUHJvcGVydHlEaXJ0eT1mdW5jdGlvbihlKXt0aGlzLmlzRGlydHl8fHRoaXMub25QcmltQmVjb21lc0RpcnR5KCksdGhpcy5faW5zdGFuY2VEaXJ0eUZsYWdzfD1lfSx0LnByb3RvdHlwZS5oYW5kbGVHcm91cENoYW5nZWQ9ZnVuY3Rpb24oZSl7fSx0LnByb3RvdHlwZS5jaGVja1Byb3BlcnRpZXNEaXJ0eT1mdW5jdGlvbihlKXtyZXR1cm4gMCE9PSh0aGlzLl9pbnN0YW5jZURpcnR5RmxhZ3MmZSl9LHQucHJvdG90eXBlLmNsZWFyUHJvcGVydGllc0RpcnR5PWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9pbnN0YW5jZURpcnR5RmxhZ3MmPX5lLHRoaXMuX2luc3RhbmNlRGlydHlGbGFnc30sdC5wcm90b3R5cGUuX3Jlc2V0UHJvcGVydGllc0RpcnR5PWZ1bmN0aW9uKCl7dGhpcy5faW5zdGFuY2VEaXJ0eUZsYWdzPTB9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcImxldmVsQm91bmRpbmdJbmZvXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9pc0ZsYWdTZXQodC5mbGFnTGV2ZWxCb3VuZGluZ0luZm9EaXJ0eSkmJih0aGlzLnVwZGF0ZUxldmVsQm91bmRpbmdJbmZvKCksdGhpcy5fY2xlYXJGbGFncyh0LmZsYWdMZXZlbEJvdW5kaW5nSW5mb0RpcnR5KSksdGhpcy5fbGV2ZWxCb3VuZGluZ0luZm99LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksdC5wcm90b3R5cGUudXBkYXRlTGV2ZWxCb3VuZGluZ0luZm89ZnVuY3Rpb24oKXt9LHQucHJvdG90eXBlLm9uUHJpbUJlY29tZXNEaXJ0eT1mdW5jdGlvbigpe30sdC5faG9va1Byb3BlcnR5PWZ1bmN0aW9uKGUsaSxyLG4sbyl7cmV0dXJuIGZ1bmN0aW9uKHMsYSxoKXt2YXIgYz10Ll9jcmVhdGVQcm9wSW5mbyhzLGEsZSxuLHIsbyk7aSYmaShjKTt2YXIgbD1oLmdldCx1PWguc2V0O2guc2V0PWZ1bmN0aW9uKGUpe2lmKCF0aGlzLmlzRGlzcG9zZWQpe3ZhciBpPWwuY2FsbCh0aGlzKTtpZighdC5fY2hlY2tVbmNoYW5nZWQoaSxlKSl7dmFyIG49dGhpczt1LmNhbGwodGhpcyxlKSxuLl9oYW5kbGVQcm9wQ2hhbmdlZChpLGUsYSxjLHIpfX19fX0sdC5wcm90b3R5cGUuYWRkRXh0ZXJuYWxEYXRhPWZ1bmN0aW9uKHQsaSl7cmV0dXJuIHRoaXMuX2V4dGVybmFsRGF0YXx8KHRoaXMuX2V4dGVybmFsRGF0YT1uZXcgZS5TdHJpbmdEaWN0aW9uYXJ5KSx0aGlzLl9leHRlcm5hbERhdGEuYWRkKHQsaSl9LHQucHJvdG90eXBlLmdldEV4dGVybmFsRGF0YT1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fZXh0ZXJuYWxEYXRhP3RoaXMuX2V4dGVybmFsRGF0YS5nZXQoZSk6bnVsbH0sdC5wcm90b3R5cGUuZ2V0T3JBZGRFeHRlcm5hbERhdGFXaXRoRmFjdG9yeT1mdW5jdGlvbih0LGkpe3JldHVybiB0aGlzLl9leHRlcm5hbERhdGF8fCh0aGlzLl9leHRlcm5hbERhdGE9bmV3IGUuU3RyaW5nRGljdGlvbmFyeSksdGhpcy5fZXh0ZXJuYWxEYXRhLmdldE9yQWRkV2l0aEZhY3RvcnkodCxpKX0sdC5wcm90b3R5cGUucmVtb3ZlRXh0ZXJuYWxEYXRhPWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9leHRlcm5hbERhdGE/dGhpcy5fZXh0ZXJuYWxEYXRhLnJlbW92ZShlKTohMX0sdC5wcm90b3R5cGUuX2lzRmxhZ1NldD1mdW5jdGlvbihlKXtyZXR1cm4gMCE9PSh0aGlzLl9mbGFncyZlKX0sdC5wcm90b3R5cGUuX2FyZUFsbEZsYWdzU2V0PWZ1bmN0aW9uKGUpe3JldHVybih0aGlzLl9mbGFncyZlKT09PWV9LHQucHJvdG90eXBlLl9hcmVTb21lRmxhZ3NTZXQ9ZnVuY3Rpb24oZSl7cmV0dXJuIDAhPT0odGhpcy5fZmxhZ3MmZSl9LHQucHJvdG90eXBlLl9jbGVhckZsYWdzPWZ1bmN0aW9uKGUpe3RoaXMuX2ZsYWdzJj1+ZX0sdC5wcm90b3R5cGUuX3NldEZsYWdzPWZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuX2ZsYWdzO3JldHVybiB0aGlzLl9mbGFnc3w9ZSx0fSx0LnByb3RvdHlwZS5fY2hhbmdlRmxhZ3M9ZnVuY3Rpb24oZSx0KXt0P3RoaXMuX2ZsYWdzfD1lOnRoaXMuX2ZsYWdzJj1+ZX0sdC5wcm9wQ2hhbmdlZEluZm89bmV3IHMsdC5mbGFnSXNEaXNwb3NlZD0xLHQuZmxhZ0xldmVsQm91bmRpbmdJbmZvRGlydHk9Mix0LmZsYWdNb2RlbERpcnR5PTQsdC5mbGFnTGF5b3V0RGlydHk9OCx0LmZsYWdMZXZlbFZpc2libGU9MTYsdC5mbGFnQm91bmRpbmdJbmZvRGlydHk9MzIsdC5mbGFnSXNQaWNrYWJsZT02NCx0LmZsYWdJc1Zpc2libGU9MTI4LHQuZmxhZ1Zpc2liaWxpdHlDaGFuZ2VkPTI1Nix0LmZsYWdQb3NpdGlvbmluZ0RpcnR5PTUxMix0LmZsYWdUcmFja2VkR3JvdXA9MTAyNCx0PV9fZGVjb3JhdGUoW2UuY2xhc3NOYW1lKFwiU21hcnRQcm9wZXJ0eVByaW1cIildLHQpfSgpO2UuU21hcnRQcm9wZXJ0eVByaW09aCxlLm1vZGVsTGV2ZWxQcm9wZXJ0eT10LGUuaW5zdGFuY2VMZXZlbFByb3BlcnR5PWksZS5keW5hbWljTGV2ZWxQcm9wZXJ0eT1yfShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoKXt0aGlzLmZvcmNlUmVmcmVzaFByaW1pdGl2ZT0hMX1yZXR1cm4gZX0oKTtlLlByZXBhcmVSZW5kZXIyRENvbnRleHQ9dDt2YXIgaT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSl7dGhpcy5fcmVuZGVyTW9kZT1lLHRoaXMudXNlSW5zdGFuY2luZz0hMSx0aGlzLmdyb3VwSW5mb1BhcnREYXRhPW51bGwsdGhpcy5wYXJ0RGF0YVN0YXJ0SW5kZXg9dGhpcy5wYXJ0RGF0YUVuZEluZGV4PW51bGx9cmV0dXJuIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLnByb3RvdHlwZSxcInJlbmRlck1vZGVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3JlbmRlck1vZGV9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsXCJSZW5kZXJNb2RlT3BhcXVlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBlLl9yZW5kZXJNb2RlT3BhcXVlfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLFwiUmVuZGVyTW9kZUFscGhhVGVzdFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gZS5fcmVuZGVyTW9kZUFscGhhVGVzdH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZSxcIlJlbmRlck1vZGVUcmFuc3BhcmVudFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gZS5fcmVuZGVyTW9kZVRyYW5zcGFyZW50fSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLGUuX3JlbmRlck1vZGVPcGFxdWU9MSxlLl9yZW5kZXJNb2RlQWxwaGFUZXN0PTIsZS5fcmVuZGVyTW9kZVRyYW5zcGFyZW50PTMsZX0oKTtlLlJlbmRlcjJEQ29udGV4dD1pO3ZhciByPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCgpe3RoaXMucHJpbWl0aXZlUG9pbnRlclBvcz1lLlZlY3RvcjIuWmVybygpLHRoaXMudGlsdD1lLlZlY3RvcjIuWmVybygpLHRoaXMuY2FuY2VsQnViYmxlPSExfXJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIlBvaW50ZXJPdmVyXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0Ll9wb2ludGVyT3Zlcn0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIlBvaW50ZXJFbnRlclwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdC5fcG9pbnRlckVudGVyfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiUG9pbnRlckRvd25cIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHQuX3BvaW50ZXJEb3dufSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiUG9pbnRlck1vdXNlV2hlZWxcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHQuX3BvaW50ZXJNb3VzZVdoZWVsfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiUG9pbnRlck1vdmVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHQuX3BvaW50ZXJNb3ZlfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiUG9pbnRlclVwXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0Ll9wb2ludGVyVXB9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJQb2ludGVyT3V0XCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0Ll9wb2ludGVyT3V0fSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiUG9pbnRlckxlYXZlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0Ll9wb2ludGVyTGVhdmV9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJQb2ludGVyR290Q2FwdHVyZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdC5fcG9pbnRlckdvdENhcHR1cmV9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJQb2ludGVyTG9zdENhcHR1cmVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHQuX3BvaW50ZXJMb3N0Q2FwdHVyZX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIk1vdXNlV2hlZWxQcmVjaXNpb25cIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHQuX21vdXNlV2hlZWxQcmVjaXNpb259LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksdC5wcm90b3R5cGUudXBkYXRlUmVsYXRlZFRhcmdldD1mdW5jdGlvbihlLHQpe3RoaXMucmVsYXRlZFRhcmdldD1lLHRoaXMucmVsYXRlZFRhcmdldFBvaW50ZXJQb3M9dH0sdC5nZXRFdmVudFR5cGVOYW1lPWZ1bmN0aW9uKGUpe3N3aXRjaChlKXtjYXNlIHQuUG9pbnRlck92ZXI6cmV0dXJuXCJQb2ludGVyT3ZlclwiO2Nhc2UgdC5Qb2ludGVyRW50ZXI6cmV0dXJuXCJQb2ludGVyRW50ZXJcIjtjYXNlIHQuUG9pbnRlckRvd246cmV0dXJuXCJQb2ludGVyRG93blwiO2Nhc2UgdC5Qb2ludGVyTW91c2VXaGVlbDpyZXR1cm5cIlBvaW50ZXJNb3VzZVdoZWVsXCI7Y2FzZSB0LlBvaW50ZXJNb3ZlOnJldHVyblwiUG9pbnRlck1vdmVcIjtjYXNlIHQuUG9pbnRlclVwOnJldHVyblwiUG9pbnRlclVwXCI7Y2FzZSB0LlBvaW50ZXJPdXQ6cmV0dXJuXCJQb2ludGVyT3V0XCI7Y2FzZSB0LlBvaW50ZXJMZWF2ZTpyZXR1cm5cIlBvaW50ZXJMZWF2ZVwiO2Nhc2UgdC5Qb2ludGVyR290Q2FwdHVyZTpyZXR1cm5cIlBvaW50ZXJHb3RDYXB0dXJlXCI7Y2FzZSB0LlBvaW50ZXJMb3N0Q2FwdHVyZTpyZXR1cm5cIlBvaW50ZXJMb3N0Q2FwdHVyZVwifX0sdC5fcG9pbnRlck92ZXI9MSx0Ll9wb2ludGVyRW50ZXI9Mix0Ll9wb2ludGVyRG93bj00LHQuX3BvaW50ZXJNb3VzZVdoZWVsPTgsdC5fcG9pbnRlck1vdmU9MTYsdC5fcG9pbnRlclVwPTMyLHQuX3BvaW50ZXJPdXQ9NjQsdC5fcG9pbnRlckxlYXZlPTEyOCx0Ll9wb2ludGVyR290Q2FwdHVyZT0yNTYsdC5fcG9pbnRlckxvc3RDYXB0dXJlPTUxMix0Ll9tb3VzZVdoZWVsUHJlY2lzaW9uPTMsdH0oKTtlLlByaW1pdGl2ZVBvaW50ZXJJbmZvPXI7dmFyIG49ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQpe3RoaXMuX2NoYW5nZWRDYWxsYmFjaz10LHRoaXMuX2hvcml6b250YWw9ZS5BbGlnbkxlZnQsdGhpcy5fdmVydGljYWw9ZS5BbGlnbkJvdHRvbX1yZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsXCJBbGlnbkxlZnRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGUuX0FsaWduTGVmdH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZSxcIkFsaWduVG9wXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBlLl9BbGlnblRvcH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZSxcIkFsaWduUmlnaHRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGUuX0FsaWduUmlnaHR9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsXCJBbGlnbkJvdHRvbVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gZS5fQWxpZ25Cb3R0b219LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsXCJBbGlnbkNlbnRlclwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gZS5fQWxpZ25DZW50ZXJ9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsXCJBbGlnblN0cmV0Y2hcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGUuX0FsaWduU3RyZXRjaH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZS5wcm90b3R5cGUsXCJob3Jpem9udGFsXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9ob3Jpem9udGFsfSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5faG9yaXpvbnRhbCE9PWUmJih0aGlzLl9ob3Jpem9udGFsPWUsdGhpcy5fY2hhbmdlZENhbGxiYWNrKCkpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLnByb3RvdHlwZSxcInZlcnRpY2FsXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl92ZXJ0aWNhbH0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX3ZlcnRpY2FsIT09ZSYmKHRoaXMuX3ZlcnRpY2FsPWUsdGhpcy5fY2hhbmdlZENhbGxiYWNrKCkpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLGUucHJvdG90eXBlLnNldEhvcml6b250YWw9ZnVuY3Rpb24odCl7dmFyIGk9dC50cmltKCkudG9Mb2NhbGVMb3dlckNhc2UoKTtzd2l0Y2goaSl7Y2FzZVwibGVmdFwiOnJldHVybiB2b2lkKHRoaXMuaG9yaXpvbnRhbD1lLkFsaWduTGVmdCk7Y2FzZVwicmlnaHRcIjpyZXR1cm4gdm9pZCh0aGlzLmhvcml6b250YWw9ZS5BbGlnblJpZ2h0KTtjYXNlXCJjZW50ZXJcIjpyZXR1cm4gdm9pZCh0aGlzLmhvcml6b250YWw9ZS5BbGlnbkNlbnRlcik7Y2FzZVwic3RyZXRjaFwiOnJldHVybiB2b2lkKHRoaXMuaG9yaXpvbnRhbD1lLkFsaWduU3RyZXRjaCl9fSxlLnByb3RvdHlwZS5zZXRWZXJ0aWNhbD1mdW5jdGlvbih0KXt2YXIgaT10LnRyaW0oKS50b0xvY2FsZUxvd2VyQ2FzZSgpO3N3aXRjaChpKXtjYXNlXCJ0b3BcIjpyZXR1cm4gdm9pZCh0aGlzLnZlcnRpY2FsPWUuQWxpZ25Ub3ApO2Nhc2VcImJvdHRvbVwiOnJldHVybiB2b2lkKHRoaXMudmVydGljYWw9ZS5BbGlnbkJvdHRvbSk7Y2FzZVwiY2VudGVyXCI6cmV0dXJuIHZvaWQodGhpcy52ZXJ0aWNhbD1lLkFsaWduQ2VudGVyKTtjYXNlXCJzdHJldGNoXCI6cmV0dXJuIHZvaWQodGhpcy52ZXJ0aWNhbD1lLkFsaWduU3RyZXRjaCl9fSxlLnByb3RvdHlwZS5mcm9tU3RyaW5nPWZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1lLnRyaW0oKS5zcGxpdChcIixcIiksaT0wO2k8dC5sZW5ndGg7aSsrKXt2YXIgcj10W2ldO3I9ci50b0xvY2FsZUxvd2VyQ2FzZSgpLnRyaW0oKTt2YXIgbj1yLmluZGV4T2YoXCJoOlwiKTstMT09PW4mJihuPXIuaW5kZXhPZihcImhvcml6b250YWw6XCIpKSwtMT09PW4/KG49ci5pbmRleE9mKFwidjpcIiksLTE9PT1uJiYobj1yLmluZGV4T2YoXCJ2ZXJ0aWNhbDpcIikpLC0xPT09bnx8KHI9ci5zdWJzdHIoci5pbmRleE9mKFwiOlwiKSsxKSx0aGlzLnNldFZlcnRpY2FsKHIpKSk6KHI9ci5zdWJzdHIoci5pbmRleE9mKFwiOlwiKSsxKSx0aGlzLnNldEhvcml6b250YWwocikpfX0sZS5fQWxpZ25MZWZ0PTEsZS5fQWxpZ25Ub3A9MSxlLl9BbGlnblJpZ2h0PTIsZS5fQWxpZ25Cb3R0b209MixlLl9BbGlnbkNlbnRlcj0zLGUuX0FsaWduU3RyZXRjaD00LGV9KCk7ZS5QcmltaXRpdmVBbGlnbm1lbnQ9bjt2YXIgbz1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSx0KXt0aGlzLnByaW09ZSx0aGlzLmludGVyc2VjdGlvbkxvY2F0aW9uPXR9cmV0dXJuIGV9KCk7ZS5QcmltaXRpdmVJbnRlcnNlY3RlZEluZm89bzt2YXIgcz1mdW5jdGlvbigpe2Z1bmN0aW9uIGUodCxpKXt0aGlzLl9wYXJlbnRBY2Nlc3M9dCx0aGlzLl9jaGFuZ2VkQ2FsbGJhY2s9aSx0aGlzLl9waXhlbHM9bmV3IEFycmF5KDQpLHRoaXMuX3BlcmNlbnRhZ2VzPW5ldyBBcnJheSg0KSx0aGlzLl9zZXRUeXBlKDAsZS5BdXRvKSx0aGlzLl9zZXRUeXBlKDEsZS5BdXRvKSx0aGlzLl9zZXRUeXBlKDIsZS5BdXRvKSx0aGlzLl9zZXRUeXBlKDMsZS5BdXRvKSx0aGlzLl9waXhlbHNbMF09MCx0aGlzLl9waXhlbHNbMV09MCx0aGlzLl9waXhlbHNbMl09MCx0aGlzLl9waXhlbHNbM109MH1yZXR1cm4gZS5wcm90b3R5cGUuZnJvbVN0cmluZz1mdW5jdGlvbih0KXt0aGlzLl9jbGVhcigpO2Zvcih2YXIgaT10LnRyaW0oKS5zcGxpdChcIixcIikscj0hMSxuPTA7bjxpLmxlbmd0aDtuKyspe3ZhciBvPWlbbl07cj10aGlzLl9leHRyYWN0U3RyaW5nKG8sITEpfHxyfWlmKCFyKXRocm93IG5ldyBFcnJvcihcIkNhbid0IHBhcnNlIHRoZSBzdHJpbmcgdG8gY3JlYXRlIGEgUHJpbWl0aXZlTWFyZ2luIG9iamVjdCwgZm9ybWF0IG11c3QgYmU6ICd0b3A6IDx2YWx1ZT4sIGxlZnQ6PHZhbHVlPiwgcmlnaHQ6PHZhbHVlPiwgYm90dG9tOjx2YWx1ZT5cIik7MD09PSgxNSZ0aGlzLl9mbGFncykmJih0aGlzLl9mbGFnc3w9ZS5QaXhlbDw8MCksMD09PSgyNDAmdGhpcy5fZmxhZ3MpJiYodGhpcy5fZmxhZ3N8PWUuUGl4ZWw8PDQpLDA9PT0oMzg0MCZ0aGlzLl9mbGFncykmJih0aGlzLl9mbGFnc3w9ZS5QaXhlbDw8OCksMD09PSg2MTQ0MCZ0aGlzLl9mbGFncykmJih0aGlzLl9mbGFnc3w9ZS5QaXhlbDw8MTIpLHRoaXMuX2NoYW5nZWRDYWxsYmFjaygpfSxlLnByb3RvdHlwZS5mcm9tU3RyaW5ncz1mdW5jdGlvbihlLHQsaSxyKXtyZXR1cm4gdGhpcy5fY2xlYXIoKSx0aGlzLl9zZXRTdHJpbmdWYWx1ZShlLDAsITEpLHRoaXMuX3NldFN0cmluZ1ZhbHVlKHQsMSwhMSksdGhpcy5fc2V0U3RyaW5nVmFsdWUoaSwyLCExKSx0aGlzLl9zZXRTdHJpbmdWYWx1ZShyLDMsITEpLHRoaXMuX2NoYW5nZWRDYWxsYmFjaygpLHRoaXN9LGUucHJvdG90eXBlLmZyb21QaXhlbHM9ZnVuY3Rpb24oZSx0LGkscil7cmV0dXJuIHRoaXMuX2NsZWFyKCksdGhpcy5fcGl4ZWxzWzBdPWUsdGhpcy5fcGl4ZWxzWzFdPXQsdGhpcy5fcGl4ZWxzWzJdPWksdGhpcy5fcGl4ZWxzWzNdPXIsdGhpcy5fY2hhbmdlZENhbGxiYWNrKCksdGhpc30sZS5wcm90b3R5cGUuZnJvbVVuaWZvcm1QaXhlbHM9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2NsZWFyKCksdGhpcy5fcGl4ZWxzWzBdPWUsdGhpcy5fcGl4ZWxzWzFdPWUsdGhpcy5fcGl4ZWxzWzJdPWUsdGhpcy5fcGl4ZWxzWzNdPWUsdGhpcy5fY2hhbmdlZENhbGxiYWNrKCksdGhpc30sZS5wcm90b3R5cGUuYXV0bz1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9jbGVhcigpLHRoaXMuX2ZsYWdzPWUuQXV0bzw8MHxlLkF1dG88PDR8ZS5BdXRvPDw4fGUuQXV0bzw8MTIsdGhpcy5fcGl4ZWxzWzBdPTAsdGhpcy5fcGl4ZWxzWzFdPTAsdGhpcy5fcGl4ZWxzWzJdPTAsdGhpcy5fcGl4ZWxzWzNdPTAsdGhpcy5fY2hhbmdlZENhbGxiYWNrKCksdGhpc30sZS5wcm90b3R5cGUuX2NsZWFyPWZ1bmN0aW9uKCl7dGhpcy5fZmxhZ3M9MCx0aGlzLl9waXhlbHNbMF09MCx0aGlzLl9waXhlbHNbMV09MCx0aGlzLl9waXhlbHNbMl09MCx0aGlzLl9waXhlbHNbM109MCx0aGlzLl9wZXJjZW50YWdlc1swXT1udWxsLHRoaXMuX3BlcmNlbnRhZ2VzWzFdPW51bGwsdGhpcy5fcGVyY2VudGFnZXNbMl09bnVsbCx0aGlzLl9wZXJjZW50YWdlc1szXT1udWxsfSxlLnByb3RvdHlwZS5fZXh0cmFjdFN0cmluZz1mdW5jdGlvbihlLHQpe3ZhciBpPWUudHJpbSgpLnRvTG9jYWxlTG93ZXJDYXNlKCk7cmV0dXJuIDA9PT1pLmluZGV4T2YoXCJ0b3A6XCIpPyhpPWkuc3Vic3RyKDQpLnRyaW0oKSx0aGlzLl9zZXRTdHJpbmdWYWx1ZShpLDAsdCkpOjA9PT1pLmluZGV4T2YoXCJsZWZ0OlwiKT8oaT1pLnN1YnN0cig1KS50cmltKCksdGhpcy5fc2V0U3RyaW5nVmFsdWUoaSwxLHQpKTowPT09aS5pbmRleE9mKFwicmlnaHQ6XCIpPyhpPWkuc3Vic3RyKDYpLnRyaW0oKSx0aGlzLl9zZXRTdHJpbmdWYWx1ZShpLDIsdCkpOjA9PT1pLmluZGV4T2YoXCJib3R0b206XCIpPyhpPWkuc3Vic3RyKDcpLnRyaW0oKSx0aGlzLl9zZXRTdHJpbmdWYWx1ZShpLDMsdCkpOiExfSxlLnByb3RvdHlwZS5fc2V0U3RyaW5nVmFsdWU9ZnVuY3Rpb24odCxpLHIpe3ZhciBuPXQudHJpbSgpLnRvTG9jYWxlTG93ZXJDYXNlKCk7aWYoXCJhdXRvXCI9PT1uKXtpZih0aGlzLl9pc1R5cGUoaSxlLkF1dG8pKXJldHVybiEwO3RoaXMuX3NldFR5cGUoaSxlLkF1dG8pLHRoaXMuX3BpeGVsc1tpXT0wLHImJnRoaXMuX2NoYW5nZWRDYWxsYmFjaygpfWVsc2V7aWYoXCJpbmhlcml0XCIhPT1uKXt2YXIgbz1uLmluZGV4T2YoXCIlXCIpO2lmKC0xIT09byl7dmFyIHM9bi5zdWJzdHIoMCxvKSxhPU1hdGgucm91bmQoTnVtYmVyKHMpKS8xMDA7cmV0dXJuIHRoaXMuX2lzVHlwZShpLGUuUGVyY2VudGFnZSkmJnRoaXMuX3BlcmNlbnRhZ2VzW2ldPT09YT8hMDoodGhpcy5fc2V0VHlwZShpLGUuUGVyY2VudGFnZSksaXNOYU4oYSk/ITE6KHRoaXMuX3BlcmNlbnRhZ2VzW2ldPWEsciYmdGhpcy5fY2hhbmdlZENhbGxiYWNrKCksITApKX12YXIgaDtvPW4uaW5kZXhPZihcInB4XCIpLGg9LTEhPT1vP24uc3Vic3RyKDAsbykudHJpbSgpOm47dmFyIGM9TnVtYmVyKGgpO3JldHVybiB0aGlzLl9pc1R5cGUoaSxlLlBpeGVsKSYmdGhpcy5fcGl4ZWxzW2ldPT09Yz8hMDppc05hTihjKT8hMToodGhpcy5fcGl4ZWxzW2ldPWMsdGhpcy5fc2V0VHlwZShpLGUuUGl4ZWwpLHImJnRoaXMuX2NoYW5nZWRDYWxsYmFjaygpLCEwKX1pZih0aGlzLl9pc1R5cGUoaSxlLkluaGVyaXQpKXJldHVybiEwO3RoaXMuX3NldFR5cGUoaSxlLkluaGVyaXQpLHRoaXMuX3BpeGVsc1tpXT1udWxsLHImJnRoaXMuX2NoYW5nZWRDYWxsYmFjaygpfX0sZS5wcm90b3R5cGUuX3NldFBpeGVscz1mdW5jdGlvbih0LGkscil7dD1NYXRoLnJvdW5kKHQpLHRoaXMuX2lzVHlwZShpLGUuUGl4ZWwpJiZ0aGlzLl9waXhlbHNbaV09PT10fHwodGhpcy5fc2V0VHlwZShpLGUuUGl4ZWwpLHRoaXMuX3BpeGVsc1tpXT10LHImJnRoaXMuX2NoYW5nZWRDYWxsYmFjaygpKX0sZS5wcm90b3R5cGUuX3NldFBlcmNlbnRhZ2U9ZnVuY3Rpb24odCxpLHIpe3Q9TWF0aC5taW4oMSx0KSx0PU1hdGgubWF4KDAsdCksdD1NYXRoLnJvdW5kKDEwMCp0KS8xMDAsdGhpcy5faXNUeXBlKGksZS5QZXJjZW50YWdlKSYmdGhpcy5fcGVyY2VudGFnZXNbaV09PT10fHwodGhpcy5fc2V0VHlwZShpLGUuUGVyY2VudGFnZSksdGhpcy5fcGVyY2VudGFnZXNbaV09dCxyJiZ0aGlzLl9jaGFuZ2VkQ2FsbGJhY2soKSl9LGUucHJvdG90eXBlLl9nZXRTdHJpbmdWYWx1ZT1mdW5jdGlvbih0KXt2YXIgaT10aGlzLl9mbGFncz4+NCp0JjE1O3N3aXRjaChpKXtjYXNlIGUuQXV0bzpyZXR1cm5cImF1dG9cIjtjYXNlIGUuUGl4ZWw6cmV0dXJuIHRoaXMuX3BpeGVsc1t0XStcInB4XCI7Y2FzZSBlLlBlcmNlbnRhZ2U6cmV0dXJuIDEwMCp0aGlzLl9wZXJjZW50YWdlc1t0XStcIiVcIjtjYXNlIGUuSW5oZXJpdDpyZXR1cm5cImluaGVyaXRcIn1yZXR1cm5cIlwifSxlLnByb3RvdHlwZS5faXNUeXBlPWZ1bmN0aW9uKGUsdCl7dmFyIGk9dGhpcy5fZmxhZ3M+PjQqZSYxNTtyZXR1cm4gaT09PXR9LGUucHJvdG90eXBlLl9nZXRUeXBlPWZ1bmN0aW9uKHQsaSl7dmFyIHI9dGhpcy5fZmxhZ3M+PjQqdCYxNTtpZihpJiZyPT09ZS5Jbmhlcml0KXt2YXIgbj10aGlzLl9wYXJlbnRBY2Nlc3MoKTtyZXR1cm4gbj9uLl9nZXRUeXBlKHQsITApOmUuQXV0b31yZXR1cm4gcn0sZS5wcm90b3R5cGUuX3NldFR5cGU9ZnVuY3Rpb24oZSx0KXt0aGlzLl9mbGFncyY9figxNTw8NCplKSx0aGlzLl9mbGFnc3w9dDw8NCplfSxlLnByb3RvdHlwZS5zZXRUb3A9ZnVuY3Rpb24oZSl7XCJzdHJpbmdcIj09dHlwZW9mIGU/dGhpcy5fc2V0U3RyaW5nVmFsdWUoZSwwLCEwKTp0aGlzLnRvcFBpeGVscz1lfSxlLnByb3RvdHlwZS5zZXRMZWZ0PWZ1bmN0aW9uKGUpe1wic3RyaW5nXCI9PXR5cGVvZiBlP3RoaXMuX3NldFN0cmluZ1ZhbHVlKGUsMSwhMCk6dGhpcy5sZWZ0UGl4ZWxzPWV9LGUucHJvdG90eXBlLnNldFJpZ2h0PWZ1bmN0aW9uKGUpe1wic3RyaW5nXCI9PXR5cGVvZiBlP3RoaXMuX3NldFN0cmluZ1ZhbHVlKGUsMiwhMCk6dGhpcy5yaWdodFBpeGVscz1lfSxlLnByb3RvdHlwZS5zZXRCb3R0b209ZnVuY3Rpb24oZSl7XCJzdHJpbmdcIj09dHlwZW9mIGU/dGhpcy5fc2V0U3RyaW5nVmFsdWUoZSwzLCEwKTp0aGlzLmJvdHRvbVBpeGVscz1lfSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZS5wcm90b3R5cGUsXCJ0b3BcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2dldFN0cmluZ1ZhbHVlKDApfSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fc2V0U3RyaW5nVmFsdWUoZSwwLCEwKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZS5wcm90b3R5cGUsXCJsZWZ0XCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9nZXRTdHJpbmdWYWx1ZSgxKX0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX3NldFN0cmluZ1ZhbHVlKGUsMSwhMCl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGUucHJvdG90eXBlLFwicmlnaHRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2dldFN0cmluZ1ZhbHVlKDIpfSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fc2V0U3RyaW5nVmFsdWUoZSwyLCEwKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZS5wcm90b3R5cGUsXCJib3R0b21cIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2dldFN0cmluZ1ZhbHVlKDMpfSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fc2V0U3RyaW5nVmFsdWUoZSwzLCEwKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZS5wcm90b3R5cGUsXCJ0b3BQaXhlbHNcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3BpeGVsc1swXX0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX3NldFBpeGVscyhlLDAsITApfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLnByb3RvdHlwZSxcImxlZnRQaXhlbHNcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3BpeGVsc1sxXX0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX3NldFBpeGVscyhlLDEsITApfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLnByb3RvdHlwZSxcInJpZ2h0UGl4ZWxzXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9waXhlbHNbMl19LHNldDpmdW5jdGlvbihlKXt0aGlzLl9zZXRQaXhlbHMoZSwyLCEwKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZS5wcm90b3R5cGUsXCJib3R0b21QaXhlbHNcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3BpeGVsc1szXX0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX3NldFBpeGVscyhlLDMsITApfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLnByb3RvdHlwZSxcInRvcFBlcmNlbnRhZ2VcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3BlcmNlbnRhZ2VzWzBdfSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fc2V0UGVyY2VudGFnZShlLDAsITApfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLnByb3RvdHlwZSxcImxlZnRQZXJjZW50YWdlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9wZXJjZW50YWdlc1sxXX0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX3NldFBlcmNlbnRhZ2UoZSwxLCEwKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZS5wcm90b3R5cGUsXCJyaWdodFBlcmNlbnRhZ2VcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3BlcmNlbnRhZ2VzWzJdfSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fc2V0UGVyY2VudGFnZShlLDIsITApfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLnByb3RvdHlwZSxcImJvdHRvbVBlcmNlbnRhZ2VcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3BlcmNlbnRhZ2VzWzNdfSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fc2V0UGVyY2VudGFnZShlLDMsITApfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLnByb3RvdHlwZSxcInRvcE1vZGVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2dldFR5cGUoMCwhMSl9LHNldDpmdW5jdGlvbihlKXt0aGlzLl9zZXRUeXBlKDAsZSl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGUucHJvdG90eXBlLFwibGVmdE1vZGVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2dldFR5cGUoMSwhMSl9LHNldDpmdW5jdGlvbihlKXt0aGlzLl9zZXRUeXBlKDEsZSl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGUucHJvdG90eXBlLFwicmlnaHRNb2RlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9nZXRUeXBlKDIsITEpfSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fc2V0VHlwZSgyLGUpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLnByb3RvdHlwZSxcImJvdHRvbU1vZGVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2dldFR5cGUoMywhMSl9LHNldDpmdW5jdGlvbihlKXt0aGlzLl9zZXRUeXBlKDMsZSl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksZS5wcm90b3R5cGUuX2NvbXB1dGVQaXhlbHM9ZnVuY3Rpb24odCxpLHIpe3ZhciBuPXRoaXMuX2dldFR5cGUodCwhMSk7aWYobj09PWUuSW5oZXJpdClyZXR1cm4gdm9pZCB0aGlzLl9wYXJlbnRBY2Nlc3MoKS5fY29tcHV0ZVBpeGVscyh0LGkscik7aWYobj09PWUuUGVyY2VudGFnZSl7dmFyIG89KDA9PT10fHwzPT09dD9pLmhlaWdodDppLndpZHRoKSp0aGlzLl9wZXJjZW50YWdlc1t0XTt0aGlzLl9waXhlbHNbdF09byxyJiZ0aGlzLl9jaGFuZ2VkQ2FsbGJhY2soKX19LGUucHJvdG90eXBlLmNvbXB1dGVXaXRoQWxpZ25tZW50PWZ1bmN0aW9uKHQsaSxyLG8scyl7dmFyIGE9dGhpcy5fZ2V0VHlwZSgwLCEwKSxoPXRoaXMuX2dldFR5cGUoMSwhMCksYz10aGlzLl9nZXRUeXBlKDIsITApLGw9dGhpcy5fZ2V0VHlwZSgzLCEwKSx1PWkmJm51bGwhPWkud2lkdGgsZj1pJiZudWxsIT1pLmhlaWdodCxkPXU/aS53aWR0aDowLHA9Zj9pLmhlaWdodDowLF89YT09PWUuQXV0byxtPWg9PT1lLkF1dG8sZz1jPT09ZS5BdXRvLHY9bD09PWUuQXV0bztzd2l0Y2goci5ob3Jpem9udGFsKXtjYXNlIG4uQWxpZ25MZWZ0Om0/by54PTA6KHRoaXMuX2NvbXB1dGVQaXhlbHMoMSx0LCEwKSxvLng9dGhpcy5sZWZ0UGl4ZWxzKSxzLndpZHRoPWQ7YnJlYWs7Y2FzZSBuLkFsaWduUmlnaHQ6Zz9vLng9TWF0aC5yb3VuZCh0LndpZHRoLWQpOih0aGlzLl9jb21wdXRlUGl4ZWxzKDIsdCwhMCksby54PU1hdGgucm91bmQodC53aWR0aC0oZCt0aGlzLnJpZ2h0UGl4ZWxzKSkpLHMud2lkdGg9ZDticmVhaztjYXNlIG4uQWxpZ25TdHJldGNoOm0/by54PTA6KHRoaXMuX2NvbXB1dGVQaXhlbHMoMSx0LCEwKSxvLng9dGhpcy5sZWZ0UGl4ZWxzKTt2YXIgeT0wO2d8fCh0aGlzLl9jb21wdXRlUGl4ZWxzKDIsdCwhMCkseT10aGlzLnJpZ2h0UGl4ZWxzKSxzLndpZHRoPXQud2lkdGgtKG8ueCt5KTticmVhaztjYXNlIG4uQWxpZ25DZW50ZXI6bXx8dGhpcy5fY29tcHV0ZVBpeGVscygxLHQsITApLGd8fHRoaXMuX2NvbXB1dGVQaXhlbHMoMix0LCEwKTt2YXIgeD0obT8wOnRoaXMubGVmdFBpeGVscyktKGc/MDp0aGlzLnJpZ2h0UGl4ZWxzKTtvLng9TWF0aC5yb3VuZCgodC53aWR0aC1kKS8yK3gpLHMud2lkdGg9ZH1zd2l0Y2goci52ZXJ0aWNhbCl7Y2FzZSBuLkFsaWduVG9wOl8/by55PXQuaGVpZ2h0LXA6KHRoaXMuX2NvbXB1dGVQaXhlbHMoMCx0LCEwKSxvLnk9TWF0aC5yb3VuZCh0LmhlaWdodC0ocCt0aGlzLnRvcFBpeGVscykpKSxzLmhlaWdodD1wO2JyZWFrO2Nhc2Ugbi5BbGlnbkJvdHRvbTp2P28ueT0wOih0aGlzLl9jb21wdXRlUGl4ZWxzKDMsdCwhMCksby55PXRoaXMuYm90dG9tUGl4ZWxzKSxzLmhlaWdodD1wO2JyZWFrO2Nhc2Ugbi5BbGlnblN0cmV0Y2g6dj9vLnk9MDoodGhpcy5fY29tcHV0ZVBpeGVscygzLHQsITApLG8ueT10aGlzLmJvdHRvbVBpeGVscyk7dmFyIGI9MDtffHwodGhpcy5fY29tcHV0ZVBpeGVscygwLHQsITApLGI9dGhpcy50b3BQaXhlbHMpLHMuaGVpZ2h0PXQuaGVpZ2h0LShvLnkrYik7YnJlYWs7Y2FzZSBuLkFsaWduQ2VudGVyOl98fHRoaXMuX2NvbXB1dGVQaXhlbHMoMCx0LCEwKSx2fHx0aGlzLl9jb21wdXRlUGl4ZWxzKDMsdCwhMCk7dmFyIHg9KHY/MDp0aGlzLmJvdHRvbVBpeGVscyktKF8/MDp0aGlzLnRvcFBpeGVscyk7by55PU1hdGgucm91bmQoKHQuaGVpZ2h0LXApLzIreCkscy5oZWlnaHQ9cH19LGUucHJvdG90eXBlLmNvbXB1dGU9ZnVuY3Rpb24oZSx0LGkpe3RoaXMuX2NvbXB1dGVQaXhlbHMoMCxlLCEwKSx0aGlzLl9jb21wdXRlUGl4ZWxzKDEsZSwhMCksdGhpcy5fY29tcHV0ZVBpeGVscygyLGUsITApLHRoaXMuX2NvbXB1dGVQaXhlbHMoMyxlLCEwKSx0Lng9dGhpcy5sZWZ0UGl4ZWxzLGkud2lkdGg9ZS53aWR0aC0odC54K3RoaXMucmlnaHRQaXhlbHMpLHQueT10aGlzLmJvdHRvbVBpeGVscyxpLmhlaWdodD1lLmhlaWdodC0odC55K3RoaXMudG9wUGl4ZWxzKX0sZS5wcm90b3R5cGUuY29tcHV0ZUFyZWE9ZnVuY3Rpb24oZSx0KXt0aGlzLl9jb21wdXRlUGl4ZWxzKDAsZSwhMCksdGhpcy5fY29tcHV0ZVBpeGVscygxLGUsITApLHRoaXMuX2NvbXB1dGVQaXhlbHMoMixlLCEwKSx0aGlzLl9jb21wdXRlUGl4ZWxzKDMsZSwhMCksdC53aWR0aD10aGlzLmxlZnRQaXhlbHMrZS53aWR0aCt0aGlzLnJpZ2h0UGl4ZWxzLHQuaGVpZ2h0PXRoaXMuYm90dG9tUGl4ZWxzK2UuaGVpZ2h0K3RoaXMudG9wUGl4ZWxzfSxlLkF1dG89MSxlLkluaGVyaXQ9MixlLlBlcmNlbnRhZ2U9NCxlLlBpeGVsPTgsZX0oKTtlLlByaW1pdGl2ZVRoaWNrbmVzcz1zO3ZhciBhPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCgpe3RoaXMuZmluZEZpcnN0T25seT0hMSx0aGlzLmludGVyc2VjdEhpZGRlbj0hMSx0aGlzLnBpY2tQb3NpdGlvbj1lLlZlY3RvcjIuWmVybygpfXJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJpc0ludGVyc2VjdGVkXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmludGVyc2VjdGVkUHJpbWl0aXZlcyYmdGhpcy5pbnRlcnNlY3RlZFByaW1pdGl2ZXMubGVuZ3RoPjB9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksdC5wcm90b3R5cGUuaXNQcmltSW50ZXJzZWN0ZWQ9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PTAsaT10aGlzLmludGVyc2VjdGVkUHJpbWl0aXZlczt0PGkubGVuZ3RoO3QrKyl7dmFyIHI9aVt0XTtpZihyLnByaW09PT1lKXJldHVybiByLmludGVyc2VjdGlvbkxvY2F0aW9ufXJldHVybiBudWxsfSx0LnByb3RvdHlwZS5fZXhpdD1mdW5jdGlvbihlKXtlJiYodGhpcy5fZ2xvYmFsUGlja1Bvc2l0aW9uPW51bGwpfSx0fSgpO2UuSW50ZXJzZWN0SW5mbzJEPWE7dmFyIGg9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gaShyKXtudWxsPT1yJiYocj17fSksdC5jYWxsKHRoaXMpO3ZhciBuLG87aWYoaS5faXNDYW52YXNJbml0KW49dGhpcyxvPW51bGwsdGhpcy5fY2FudmFzUHJlSW5pdChyKTtlbHNlIGlmKG51bGwhPXIucGFyZW50KXtpZihvPXIucGFyZW50LG49ci5wYXJlbnQub3duZXIsIW4pdGhyb3cgbmV3IEVycm9yKFwiUGFyZW50IFwiK28uaWQrXCIgb2YgXCIrci5pZCtcIiBkb2Vzbid0IGhhdmUgYSB2YWxpZCBvd25lciFcIik7aWYoISh0aGlzIGluc3RhbmNlb2YgZS5Hcm91cDJEfHx0aGlzIGluc3RhbmNlb2YgZS5TcHJpdGUyRCYmbnVsbCE9PXIuaWQmJjA9PT1yLmlkLmluZGV4T2YoXCJfX2NhY2hlZFNwcml0ZU9mR3JvdXBfX1wiKXx8bi5jYWNoaW5nU3RyYXRlZ3khPT1lLkNhbnZhczJELkNBQ0hFU1RSQVRFR1lfVE9QTEVWRUxHUk9VUFN8fG8hPT1uKSl0aHJvdyBuZXcgRXJyb3IoXCJDYW4ndCBjcmVhdGUgYSBwcmltaXRpdmUgd2l0aCB0aGUgY2FudmFzIGFzIGRpcmVjdCBwYXJlbnQgd2hlbiB0aGUgY2FjaGluZyBzdHJhdGVneSBpcyBUT1BMRVZFTEdST1VQUy4gWW91IG5lZWQgdG8gY3JlYXRlIGEgR3JvdXAgYmVsb3cgdGhlIGNhbnZhcyBhbmQgdXNlIGl0IGFzIHRoZSBwYXJlbnQgZm9yIHRoZSBwcmltaXRpdmVcIil9aWYodGhpcy5fbGF5b3V0RW5naW5lPWUuQ2FudmFzTGF5b3V0RW5naW5lLlNpbmdsZXRvbix0aGlzLl9zaXplPW51bGwsdGhpcy5fYWN0dWFsU2l6ZT1udWxsLHRoaXMuX2JvdW5kaW5nU2l6ZT1udWxsLHRoaXMuX2xheW91dEFyZWE9ZS5TaXplLlplcm8oKSx0aGlzLl9sYXlvdXRBcmVhUG9zPWUuVmVjdG9yMi5aZXJvKCksdGhpcy5fbWFyZ2luT2Zmc2V0PWUuVmVjdG9yMi5aZXJvKCksdGhpcy5fcGFyZW50TWFyZ2luZ09mZnNldD1lLlZlY3RvcjIuWmVybygpLHRoaXMuX3BhcmVudENvbnRlbnRBcmVhPWUuU2l6ZS5aZXJvKCksdGhpcy5fY29udGVudEFyZWE9bmV3IGUuU2l6ZShudWxsLG51bGwpLHRoaXMuX3BvaW50ZXJFdmVudE9ic2VydmFibGU9bmV3IGUuT2JzZXJ2YWJsZSx0aGlzLl9zaWJsaW5nRGVwdGhPZmZzZXQ9dGhpcy5faGllcmFyY2h5RGVwdGhPZmZzZXQ9MCx0aGlzLl9ib3VuZGluZ0luZm89bmV3IGUuQm91bmRpbmdJbmZvMkQsdGhpcy5fb3duZXI9bix0aGlzLl9wYXJlbnQ9bnVsbCx0aGlzLl9tYXJnaW49bnVsbCx0aGlzLl9wYWRkaW5nPW51bGwsdGhpcy5fbWFyZ2luQWxpZ25tZW50PW51bGwsdGhpcy5faWQ9ci5pZCx0aGlzLnByb3BlcnR5Q2hhbmdlZD1uZXcgZS5PYnNlcnZhYmxlLHRoaXMuX2NoaWxkcmVuPW5ldyBBcnJheSx0aGlzLl9sb2NhbFRyYW5zZm9ybT1uZXcgZS5NYXRyaXgsdGhpcy5fZ2xvYmFsVHJhbnNmb3JtPW51bGwsdGhpcy5faW52R2xvYmFsVHJhbnNmb3JtPW51bGwsdGhpcy5fZ2xvYmFsVHJhbnNmb3JtUHJvY2Vzc1N0ZXA9MCx0aGlzLl9nbG9iYWxUcmFuc2Zvcm1TdGVwPTAsdGhpcy5faGllcmFyY2h5RGVwdGg9MCx0aGlzLl9yZW5kZXJHcm91cD1udWxsLHRoaXMuX3NldEZsYWdzKGUuU21hcnRQcm9wZXJ0eVByaW0uZmxhZ0lzUGlja2FibGV8ZS5TbWFydFByb3BlcnR5UHJpbS5mbGFnQm91bmRpbmdJbmZvRGlydHkpLG51bGwhPW8mJihvLmFkZENoaWxkKHRoaXMpLHRoaXMuX3BhdGNoSGllcmFyY2h5KG8ub3duZXIpKSx0aGlzLm93bmVyJiZ0aGlzIGluc3RhbmNlb2YgZS5Hcm91cDJEKXt2YXIgcz10aGlzO3MuZGV0ZWN0R3JvdXBTdGF0ZXMoKX1pZihudWxsIT1yLmNoaWxkcmVuKWZvcih2YXIgYT0wLGg9ci5jaGlsZHJlbjthPGgubGVuZ3RoO2ErKyl7dmFyIGM9aFthXTt0aGlzLmFkZENoaWxkKGMpLGMuX3BhdGNoSGllcmFyY2h5KHRoaXMub3duZXIpfWlmKG51bGwhPXIucG9zaXRpb24/dGhpcy5wb3NpdGlvbj1yLnBvc2l0aW9uOm51bGwhPXIueHx8bnVsbCE9ci55P3RoaXMucG9zaXRpb249bmV3IGUuVmVjdG9yMihyLnh8fDAsci55fHwwKTp0aGlzLl9wb3NpdGlvbj1udWxsLHRoaXMucm90YXRpb249bnVsbD09ci5yb3RhdGlvbj8wOnIucm90YXRpb24sdGhpcy5zY2FsZT1udWxsPT1yLnNjYWxlPzE6ci5zY2FsZSx0aGlzLmxldmVsVmlzaWJsZT1udWxsPT1yLmlzVmlzaWJsZT8hMDpyLmlzVmlzaWJsZSx0aGlzLm9yaWdpbj1yLm9yaWdpbnx8bmV3IGUuVmVjdG9yMiguNSwuNSksbnVsbCE9ci5sYXlvdXRFbmdpbmUpaWYoXCJzdHJpbmdcIj09dHlwZW9mIHIubGF5b3V0RW5naW5lKXt2YXIgbD1yLmxheW91dEVuZ2luZS50b0xvY2FsZUxvd2VyQ2FzZSgpLnRyaW0oKTtcImNhbnZhc1wiPT09bHx8XCJjYW52YXNsYXlvdXRlbmdpbmVcIj09PWw/dGhpcy5sYXlvdXRFbmdpbmU9ZS5DYW52YXNMYXlvdXRFbmdpbmUuU2luZ2xldG9uOjA9PT1sLmluZGV4T2YoXCJzdGFja3BhbmVsXCIpfHwwPT09bC5pbmRleE9mKFwiaG9yaXpvbnRhbHN0YWNrcGFuZWxcIik/dGhpcy5sYXlvdXRFbmdpbmU9ZS5TdGFja1BhbmVsTGF5b3V0RW5naW5lLkhvcml6b250YWw6MD09PWwuaW5kZXhPZihcInZlcnRpY2Fsc3RhY2twYW5lbFwiKSYmKHRoaXMubGF5b3V0RW5naW5lPWUuU3RhY2tQYW5lbExheW91dEVuZ2luZS5WZXJ0aWNhbCl9ZWxzZSByLmxheW91dEVuZ2luZSBpbnN0YW5jZW9mIGUuTGF5b3V0RW5naW5lQmFzZSYmKHRoaXMubGF5b3V0RW5naW5lPXIubGF5b3V0RW5naW5lKTtyLm1hcmdpblRvcCYmdGhpcy5tYXJnaW4uc2V0VG9wKHIubWFyZ2luVG9wKSxyLm1hcmdpbkxlZnQmJnRoaXMubWFyZ2luLnNldExlZnQoci5tYXJnaW5MZWZ0KSxyLm1hcmdpblJpZ2h0JiZ0aGlzLm1hcmdpbi5zZXRSaWdodChyLm1hcmdpblJpZ2h0KSxyLm1hcmdpbkJvdHRvbSYmdGhpcy5tYXJnaW4uc2V0Qm90dG9tKHIubWFyZ2luQm90dG9tKSxyLm1hcmdpbiYmKFwic3RyaW5nXCI9PXR5cGVvZiByLm1hcmdpbj90aGlzLm1hcmdpbi5mcm9tU3RyaW5nKHIubWFyZ2luKTp0aGlzLm1hcmdpbi5mcm9tVW5pZm9ybVBpeGVscyhyLm1hcmdpbikpLHIubWFyZ2luSEFsaWdubWVudCYmKHRoaXMubWFyZ2luQWxpZ25tZW50Lmhvcml6b250YWw9ci5tYXJnaW5IQWxpZ25tZW50KSxyLm1hcmdpblZBbGlnbm1lbnQmJih0aGlzLm1hcmdpbkFsaWdubWVudC52ZXJ0aWNhbD1yLm1hcmdpblZBbGlnbm1lbnQpLHIubWFyZ2luQWxpZ25tZW50JiZ0aGlzLm1hcmdpbkFsaWdubWVudC5mcm9tU3RyaW5nKHIubWFyZ2luQWxpZ25tZW50KSxyLnBhZGRpbmdUb3AmJnRoaXMucGFkZGluZy5zZXRUb3Aoci5wYWRkaW5nVG9wKSxyLnBhZGRpbmdMZWZ0JiZ0aGlzLnBhZGRpbmcuc2V0TGVmdChyLnBhZGRpbmdMZWZ0KSxyLnBhZGRpbmdSaWdodCYmdGhpcy5wYWRkaW5nLnNldFJpZ2h0KHIucGFkZGluZ1JpZ2h0KSxyLnBhZGRpbmdCb3R0b20mJnRoaXMucGFkZGluZy5zZXRCb3R0b20oci5wYWRkaW5nQm90dG9tKSxyLnBhZGRpbmcmJnRoaXMucGFkZGluZy5mcm9tU3RyaW5nKHIucGFkZGluZyksdGhpcy5fcGFyZW50TGF5b3V0RGlydHkoKSx0aGlzLl9wb3NpdGlvbmluZ0RpcnR5KCl9cmV0dXJuIF9fZXh0ZW5kcyhpLHQpLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcImFjdGlvbk1hbmFnZXJcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2FjdGlvbk1hbmFnZXJ8fCh0aGlzLl9hY3Rpb25NYW5hZ2VyPW5ldyBlLkFjdGlvbk1hbmFnZXIodGhpcy5vd25lci5zY2VuZSkpLHRoaXMuX2FjdGlvbk1hbmFnZXJ9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksaS5wcm90b3R5cGUudHJhdmVyc2VVcD1mdW5jdGlvbihlKXtmb3IodmFyIHQ9dGhpcztudWxsIT10Oyl7aWYoZSh0KSlyZXR1cm4gdDt0PXQuX3BhcmVudH1yZXR1cm4gbnVsbH0sT2JqZWN0LmRlZmluZVByb3BlcnR5KGkucHJvdG90eXBlLFwib3duZXJcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX293bmVyfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcInBhcmVudFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcGFyZW50fSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcImNoaWxkcmVuXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9jaGlsZHJlbn0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJpZFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faWR9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGkucHJvdG90eXBlLFwiYWN0dWFsUG9zaXRpb25cIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIG51bGwhPXRoaXMuX2FjdHVhbFBvc2l0aW9uP3RoaXMuX2FjdHVhbFBvc2l0aW9uOm51bGwhPXRoaXMuX3Bvc2l0aW9uP3RoaXMuX3Bvc2l0aW9uOmkuX251bGxQb3NpdGlvbn0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX2FjdHVhbFBvc2l0aW9uPWV9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGkucHJvdG90eXBlLFwiYWN0dWFsWFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hY3R1YWxQb3NpdGlvbi54fSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcImFjdHVhbFlcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYWN0dWFsUG9zaXRpb24ueX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJwb3NpdGlvblwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcG9zaXRpb259LHNldDpmdW5jdGlvbihlKXt0aGlzLl9jaGVja1Bvc2l0aW9uQ2hhbmdlKCkmJih0aGlzLl9wb3NpdGlvbj1lKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJ4XCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9wb3NpdGlvbj90aGlzLl9wb3NpdGlvbi54Om51bGx9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9jaGVja1Bvc2l0aW9uQ2hhbmdlKCkmJih0aGlzLl9wb3NpdGlvbnx8KHRoaXMuX3Bvc2l0aW9uPWUuVmVjdG9yMi5aZXJvKCkpLHRoaXMuX3Bvc2l0aW9uLnghPT10JiYodGhpcy5fcG9zaXRpb24ueD10LHRoaXMubWFya0FzRGlydHkoXCJwb3NpdGlvblwiKSkpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcInlcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3Bvc2l0aW9uP3RoaXMuX3Bvc2l0aW9uLnk6bnVsbH0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX2NoZWNrUG9zaXRpb25DaGFuZ2UoKSYmKHRoaXMuX3Bvc2l0aW9ufHwodGhpcy5fcG9zaXRpb249ZS5WZWN0b3IyLlplcm8oKSksdGhpcy5fcG9zaXRpb24ueSE9PXQmJih0aGlzLl9wb3NpdGlvbi55PXQsdGhpcy5tYXJrQXNEaXJ0eShcInBvc2l0aW9uXCIpKSl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGkucHJvdG90eXBlLFwic2l6ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtpZighdGhpcy5fc2l6ZXx8bnVsbD09dGhpcy5fc2l6ZS53aWR0aHx8bnVsbD09dGhpcy5fc2l6ZS5oZWlnaHQpe2lmKGkuYm91bmRpbmJCb3hSZWVudHJlbmN5KXJldHVybiBpLm51bGxTaXplO2lmKHRoaXMuX2JvdW5kaW5nU2l6ZSlyZXR1cm4gdGhpcy5fYm91bmRpbmdTaXplO2kuYm91bmRpbmJCb3hSZWVudHJlbmN5PSEwO3RoaXMuYm91bmRpbmdJbmZvO3JldHVybiBpLmJvdW5kaW5iQm94UmVlbnRyZW5jeT0hMSx0aGlzLl9ib3VuZGluZ1NpemV9cmV0dXJuIHRoaXMuX3NpemV9LHNldDpmdW5jdGlvbihlKXt0aGlzLl9zaXplPWV9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGkucHJvdG90eXBlLFwid2lkdGhcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2l6ZT90aGlzLnNpemUud2lkdGg6bnVsbH0sc2V0OmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnNpemU/dm9pZCh0aGlzLnNpemUud2lkdGghPT10JiYodGhpcy5zaXplLndpZHRoPXQsdGhpcy5tYXJrQXNEaXJ0eShcInNpemVcIiksdGhpcy5fcG9zaXRpb25pbmdEaXJ0eSgpKSk6dm9pZCh0aGlzLnNpemU9bmV3IGUuU2l6ZSh0LDApKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJoZWlnaHRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2l6ZT90aGlzLnNpemUuaGVpZ2h0Om51bGx9LHNldDpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5zaXplP3ZvaWQodGhpcy5zaXplLmhlaWdodCE9PXQmJih0aGlzLnNpemUuaGVpZ2h0PXQsdGhpcy5tYXJrQXNEaXJ0eShcInNpemVcIiksdGhpcy5fcG9zaXRpb25pbmdEaXJ0eSgpKSk6dm9pZCh0aGlzLnNpemU9bmV3IGUuU2l6ZSgwLHQpKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJyb3RhdGlvblwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcm90YXRpb259LHNldDpmdW5jdGlvbihlKXt0aGlzLl9yb3RhdGlvbj1lfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcInNjYWxlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9zY2FsZX0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX3NjYWxlPWV9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGkucHJvdG90eXBlLFwiYWN0dWFsU2l6ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fYWN0dWFsU2l6ZT90aGlzLl9hY3R1YWxTaXplOnRoaXMuX3NpemV9LHNldDpmdW5jdGlvbihlKXt0aGlzLl9hY3R1YWxTaXplLmVxdWFscyhlKXx8KHRoaXMuX2FjdHVhbFNpemU9ZSl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGkucHJvdG90eXBlLFwiYWN0dWFsWk9mZnNldFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fek9yZGVyfHwxLXRoaXMuX2hpZXJhcmNoeURlcHRoT2Zmc2V0fSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcIm1pblNpemVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX21pblNpemV9LHNldDpmdW5jdGlvbihlKXt0aGlzLl9taW5TaXplJiZlJiZ0aGlzLl9taW5TaXplLmVxdWFscyhlKXx8KHRoaXMuX21pblNpemU9ZSx0aGlzLl9wYXJlbnRMYXlvdXREaXJ0eSgpKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJtYXhTaXplXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9tYXhTaXplfSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fbWF4U2l6ZSYmZSYmdGhpcy5fbWF4U2l6ZS5lcXVhbHMoZSl8fCh0aGlzLl9tYXhTaXplPWUsdGhpcy5fcGFyZW50TGF5b3V0RGlydHkoKSl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGkucHJvdG90eXBlLFwib3JpZ2luXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9vcmlnaW59LHNldDpmdW5jdGlvbihlKXt0aGlzLl9vcmlnaW49ZX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJsZXZlbFZpc2libGVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lzRmxhZ1NldChlLlNtYXJ0UHJvcGVydHlQcmltLmZsYWdMZXZlbFZpc2libGUpfSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fY2hhbmdlRmxhZ3MoZS5TbWFydFByb3BlcnR5UHJpbS5mbGFnTGV2ZWxWaXNpYmxlLHQpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcImlzVmlzaWJsZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faXNGbGFnU2V0KGUuU21hcnRQcm9wZXJ0eVByaW0uZmxhZ0lzVmlzaWJsZSl9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9jaGFuZ2VGbGFncyhlLlNtYXJ0UHJvcGVydHlQcmltLmZsYWdJc1Zpc2libGUsdCl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGkucHJvdG90eXBlLFwiek9yZGVyXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl96T3JkZXJ9LHNldDpmdW5jdGlvbihlKXt0aGlzLl96T3JkZXI9ZSx0aGlzLm9uWk9yZGVyQ2hhbmdlZCgpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcIm1hcmdpblwiLHtnZXQ6ZnVuY3Rpb24oKXt2YXIgZT10aGlzO3JldHVybiB0aGlzLl9tYXJnaW58fCh0aGlzLl9tYXJnaW49bmV3IHMoZnVuY3Rpb24oKXtyZXR1cm4gZS5wYXJlbnQ/ZS5wYXJlbnQubWFyZ2luOm51bGx9LGZ1bmN0aW9uKCl7cmV0dXJuIGUuX3Bvc2l0aW9uaW5nRGlydHkoKX0pKSx0aGlzLl9tYXJnaW59LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGkucHJvdG90eXBlLFwiX2hhc01hcmdpblwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbCE9PXRoaXMuX21hcmdpbnx8bnVsbCE9PXRoaXMuX21hcmdpbkFsaWdubWVudH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJwYWRkaW5nXCIse2dldDpmdW5jdGlvbigpe3ZhciBlPXRoaXM7cmV0dXJuIHRoaXMuX3BhZGRpbmd8fCh0aGlzLl9wYWRkaW5nPW5ldyBzKGZ1bmN0aW9uKCl7cmV0dXJuIGUucGFyZW50P2UucGFyZW50LnBhZGRpbmc6bnVsbH0sZnVuY3Rpb24oKXtyZXR1cm4gZS5fcG9zaXRpb25pbmdEaXJ0eSgpfSkpLHRoaXMuX3BhZGRpbmd9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGkucHJvdG90eXBlLFwiX2hhc1BhZGRpbmdcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIG51bGwhPT10aGlzLl9wYWRkaW5nfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcIm1hcmdpbkFsaWdubWVudFwiLHtnZXQ6ZnVuY3Rpb24oKXt2YXIgZT10aGlzO3JldHVybiB0aGlzLl9tYXJnaW5BbGlnbm1lbnR8fCh0aGlzLl9tYXJnaW5BbGlnbm1lbnQ9bmV3IG4oZnVuY3Rpb24oKXtyZXR1cm4gZS5fcG9zaXRpb25pbmdEaXJ0eSgpfSkpLHRoaXMuX21hcmdpbkFsaWdubWVudH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJsYXlvdXRFbmdpbmVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2xheW91dEVuZ2luZXx8KHRoaXMuX2xheW91dEVuZ2luZT1lLkNhbnZhc0xheW91dEVuZ2luZS5TaW5nbGV0b24pLHRoaXMuX2xheW91dEVuZ2luZX0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX2xheW91dEVuZ2luZSE9PWUmJnRoaXMuX2NoYW5nZUxheW91dEVuZ2luZShlKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJsYXlvdXRBcmVhXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9sYXlvdXRBcmVhfSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fbGF5b3V0QXJlYS5lcXVhbHMoZSl8fCh0aGlzLl9wb3NpdGlvbmluZ0RpcnR5KCksdGhpcy5fbGF5b3V0QXJlYT1lKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJsYXlvdXRBcmVhUG9zXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9sYXlvdXRBcmVhUG9zfSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fbGF5b3V0QXJlYVBvcy5lcXVhbHMoZSl8fCh0aGlzLl9wb3NpdGlvbmluZ0RpcnR5KCksdGhpcy5fbGF5b3V0QXJlYVBvcz1lKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJpc1BpY2thYmxlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9pc0ZsYWdTZXQoZS5TbWFydFByb3BlcnR5UHJpbS5mbGFnSXNQaWNrYWJsZSl9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9jaGFuZ2VGbGFncyhlLlNtYXJ0UHJvcGVydHlQcmltLmZsYWdJc1BpY2thYmxlLHQpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcImhpZXJhcmNoeURlcHRoXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9oaWVyYXJjaHlEZXB0aH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJyZW5kZXJHcm91cFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcmVuZGVyR3JvdXB9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGkucHJvdG90eXBlLFwiZ2xvYmFsVHJhbnNmb3JtXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9nbG9iYWxUcmFuc2Zvcm19LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksaS5wcm90b3R5cGUuZ2V0R2xvYmFsUG9zaXRpb249ZnVuY3Rpb24oKXt2YXIgdD1uZXcgZS5WZWN0b3IyKDAsMCk7cmV0dXJuIHRoaXMuZ2V0R2xvYmFsUG9zaXRpb25CeVJlZih0KSx0fSxpLnByb3RvdHlwZS5nZXRHbG9iYWxQb3NpdGlvbkJ5UmVmPWZ1bmN0aW9uKGUpe2UueD10aGlzLmdsb2JhbFRyYW5zZm9ybS5tWzEyXSxlLnk9dGhpcy5nbG9iYWxUcmFuc2Zvcm0ubVsxM119LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcImludkdsb2JhbFRyYW5zZm9ybVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faW52R2xvYmFsVHJhbnNmb3JtfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcImxvY2FsVHJhbnNmb3JtXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl91cGRhdGVMb2NhbFRyYW5zZm9ybSgpLHRoaXMuX2xvY2FsVHJhbnNmb3JtfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcImJvdW5kaW5nSW5mb1wiLHtnZXQ6ZnVuY3Rpb24oKXtpZih0aGlzLl9pc0ZsYWdTZXQoZS5TbWFydFByb3BlcnR5UHJpbS5mbGFnQm91bmRpbmdJbmZvRGlydHkpKXt0aGlzLl9ib3VuZGluZ0luZm89dGhpcy5sZXZlbEJvdW5kaW5nSW5mby5jbG9uZSgpO2Zvcih2YXIgdD10aGlzLl9ib3VuZGluZ0luZm8saT1uZXcgZS5Cb3VuZGluZ0luZm8yRCxyPTAsbj10aGlzLl9jaGlsZHJlbjtyPG4ubGVuZ3RoO3IrKyl7dmFyIG89bltyXTtvLmJvdW5kaW5nSW5mby50cmFuc2Zvcm1Ub1JlZihvLmxvY2FsVHJhbnNmb3JtLGkpLHQudW5pb25Ub1JlZihpLHQpfXRoaXMuX2JvdW5kaW5nU2l6ZT1lLlNpemUuWmVybygpO3ZhciBzPXRoaXMuX2JvdW5kaW5nSW5mby5tYXgoKTt0aGlzLl9ib3VuZGluZ1NpemU9bmV3IGUuU2l6ZSh0aGlzLl9zaXplJiZudWxsIT10aGlzLl9zaXplLndpZHRoP3RoaXMuX3NpemUud2lkdGg6TWF0aC5jZWlsKHMueCksdGhpcy5fc2l6ZSYmbnVsbCE9dGhpcy5fc2l6ZS5oZWlnaHQ/dGhpcy5fc2l6ZS5oZWlnaHQ6TWF0aC5jZWlsKHMueSkpLHRoaXMuX2NsZWFyRmxhZ3MoZS5TbWFydFByb3BlcnR5UHJpbS5mbGFnQm91bmRpbmdJbmZvRGlydHkpfXJldHVybiB0aGlzLl9ib3VuZGluZ0luZm99LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGkucHJvdG90eXBlLFwiaXNTaXplQXV0b1wiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbD09dGhpcy5fc2l6ZX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJpc1Bvc2l0aW9uQXV0b1wiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbD09dGhpcy5fcG9zaXRpb259LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGkucHJvdG90eXBlLFwicG9pbnRlckV2ZW50T2JzZXJ2YWJsZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcG9pbnRlckV2ZW50T2JzZXJ2YWJsZX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxpLnByb3RvdHlwZS5maW5kQnlJZD1mdW5jdGlvbihlKXtpZih0aGlzLl9pZD09PWUpcmV0dXJuIHRoaXM7Zm9yKHZhciB0PTAsaT10aGlzLl9jaGlsZHJlbjt0PGkubGVuZ3RoO3QrKyl7dmFyIHI9aVt0XSxuPXIuZmluZEJ5SWQoZSk7aWYobnVsbCE9bilyZXR1cm4gbn19LGkucHJvdG90eXBlLm9uWk9yZGVyQ2hhbmdlZD1mdW5jdGlvbigpe30saS5wcm90b3R5cGUubGV2ZWxJbnRlcnNlY3Q9ZnVuY3Rpb24oZSl7cmV0dXJuITF9LGkucHJvdG90eXBlLnNldFBvaW50ZXJFdmVudENhcHR1cmU9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMub3duZXIuX3NldFBvaW50ZXJDYXB0dXJlKGUsdGhpcyl9LGkucHJvdG90eXBlLnJlbGVhc2VQb2ludGVyRXZlbnRzQ2FwdHVyZT1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5vd25lci5fcmVsZWFzZVBvaW50ZXJDYXB0dXJlKGUsdGhpcyl9LGkucHJvdG90eXBlLmludGVyc2VjdD1mdW5jdGlvbih0KXtpZighdClyZXR1cm4hMTt2YXIgaT0hdC5fZ2xvYmFsUGlja1Bvc2l0aW9uO2lmKGkmJih0Ll9nbG9iYWxQaWNrUG9zaXRpb249ZS5WZWN0b3IyLlplcm8oKSxlLlZlY3RvcjIuVHJhbnNmb3JtVG9SZWYodC5waWNrUG9zaXRpb24sdGhpcy5nbG9iYWxUcmFuc2Zvcm0sdC5fZ2xvYmFsUGlja1Bvc2l0aW9uKSx0Ll9sb2NhbFBpY2tQb3NpdGlvbj10LnBpY2tQb3NpdGlvbi5jbG9uZSgpLHQuaW50ZXJzZWN0ZWRQcmltaXRpdmVzPW5ldyBBcnJheSx0LnRvcE1vc3RJbnRlcnNlY3RlZFByaW1pdGl2ZT1udWxsKSwhdC5pbnRlcnNlY3RIaWRkZW4mJiF0aGlzLmlzVmlzaWJsZSlyZXR1cm4hMTtpZih0aGlzLmlzUGlja2FibGUmJiF0aGlzLmJvdW5kaW5nSW5mby5kb2VzSW50ZXJzZWN0KHQuX2xvY2FsUGlja1Bvc2l0aW9uKSlyZXR1cm4gdC5fZXhpdChpKSwhMTt2YXIgcj0hMTtpZih0aGlzLmlzUGlja2FibGUmJihyPXRoaXMubGV2ZWxJbnRlcnNlY3QodCkpKXt2YXIgbj1uZXcgbyh0aGlzLHQuX2xvY2FsUGlja1Bvc2l0aW9uLmNsb25lKCkpO2lmKHQuaW50ZXJzZWN0ZWRQcmltaXRpdmVzLnB1c2gobiksKCF0LnRvcE1vc3RJbnRlcnNlY3RlZFByaW1pdGl2ZXx8dC50b3BNb3N0SW50ZXJzZWN0ZWRQcmltaXRpdmUucHJpbS5hY3R1YWxaT2Zmc2V0Pm4ucHJpbS5hY3R1YWxaT2Zmc2V0KSYmKHQudG9wTW9zdEludGVyc2VjdGVkUHJpbWl0aXZlPW4pLHQuZmluZEZpcnN0T25seSlyZXR1cm4gdC5fZXhpdChpKSwhMH1pZighcnx8IXQuZmluZEZpcnN0T25seSlmb3IodmFyIHM9MCxhPXRoaXMuX2NoaWxkcmVuO3M8YS5sZW5ndGg7cysrKXt2YXIgaD1hW3NdO2lmKGguaXNQaWNrYWJsZSYmKHQuaW50ZXJzZWN0SGlkZGVufHxoLmlzVmlzaWJsZSkmJihlLlZlY3RvcjIuVHJhbnNmb3JtVG9SZWYodC5fZ2xvYmFsUGlja1Bvc2l0aW9uLGguaW52R2xvYmFsVHJhbnNmb3JtLHQuX2xvY2FsUGlja1Bvc2l0aW9uKSxcbmguaW50ZXJzZWN0KHQpJiZ0LmZpbmRGaXJzdE9ubHkpKXJldHVybiB0Ll9leGl0KGkpLCEwfXJldHVybiB0Ll9leGl0KGkpLHQuaXNJbnRlcnNlY3RlZH0saS5wcm90b3R5cGUubW92ZUNoaWxkPWZ1bmN0aW9uKGUsdCl7aWYoZS5wYXJlbnQhPT10aGlzKXJldHVybiExO3ZhciBpLHIsbj10aGlzLl9jaGlsZHJlbi5pbmRleE9mKGUpLG89dD90aGlzLl9jaGlsZHJlbi5pbmRleE9mKHQpOi0xO3Q/KGk9dGhpcy5fY2hpbGRyZW5bb10uX3NpYmxpbmdEZXB0aE9mZnNldCxyPXRoaXMuX2NoaWxkcmVuW28rMV0uX3NpYmxpbmdEZXB0aE9mZnNldCk6KGk9MSxyPXRoaXMuX2NoaWxkcmVuWzFdLl9zaWJsaW5nRGVwdGhPZmZzZXQpLGUuX3NpYmxpbmdEZXB0aE9mZnNldD0oci1pKS8yLHRoaXMuX2NoaWxkcmVuLnNwbGljZShvKzEsMCx0aGlzLl9jaGlsZHJlbi5zcGxpY2UobiwxKVswXSl9LGkucHJvdG90eXBlLmFkZENoaWxkPWZ1bmN0aW9uKGUpe2UuX3BhcmVudD10aGlzLHRoaXMuX2JvdW5kaW5nQm94RGlydHkoKSx0aGlzLl9wYXRjaEhpZXJhcmNoeURlcHRoKGUpLHRoaXMuX2NoaWxkcmVuLnB1c2goZSl9LGkucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXtpZighdC5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpKXJldHVybiExO2lmKHRoaXMuX2FjdGlvbk1hbmFnZXImJih0aGlzLl9hY3Rpb25NYW5hZ2VyLmRpc3Bvc2UoKSx0aGlzLl9hY3Rpb25NYW5hZ2VyPW51bGwpLHRoaXMuX3BhcmVudCl7dmFyIGU9dGhpcy5fcGFyZW50Ll9jaGlsZHJlbi5pbmRleE9mKHRoaXMpO3ZvaWQgMCE9PWUmJnRoaXMuX3BhcmVudC5fY2hpbGRyZW4uc3BsaWNlKGUsMSksdGhpcy5fcGFyZW50PW51bGx9aWYodGhpcy5fY2hpbGRyZW4pZm9yKDt0aGlzLl9jaGlsZHJlbi5sZW5ndGg+MDspdGhpcy5fY2hpbGRyZW5bdGhpcy5fY2hpbGRyZW4ubGVuZ3RoLTFdLmRpc3Bvc2UoKTtyZXR1cm4hMH0saS5wcm90b3R5cGUub25QcmltQmVjb21lc0RpcnR5PWZ1bmN0aW9uKCl7dGhpcy5fcmVuZGVyR3JvdXAmJnRoaXMuX3JlbmRlckdyb3VwLl9hZGRQcmltVG9EaXJ0eUxpc3QodGhpcyl9LGkucHJvdG90eXBlLl9uZWVkUHJlcGFyZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9hcmVTb21lRmxhZ3NTZXQoZS5TbWFydFByb3BlcnR5UHJpbS5mbGFnVmlzaWJpbGl0eUNoYW5nZWR8ZS5TbWFydFByb3BlcnR5UHJpbS5mbGFnTW9kZWxEaXJ0eSl8fDAhPT10aGlzLl9pbnN0YW5jZURpcnR5RmxhZ3N8fHRoaXMuX2dsb2JhbFRyYW5zZm9ybVByb2Nlc3NTdGVwIT09dGhpcy5fZ2xvYmFsVHJhbnNmb3JtU3RlcH0saS5wcm90b3R5cGUuX3ByZXBhcmVSZW5kZXI9ZnVuY3Rpb24oZSl7dGhpcy5fcHJlcGFyZVJlbmRlclByZShlKSx0aGlzLl9wcmVwYXJlUmVuZGVyUG9zdChlKX0saS5wcm90b3R5cGUuX3ByZXBhcmVSZW5kZXJQcmU9ZnVuY3Rpb24oZSl7fSxpLnByb3RvdHlwZS5fcHJlcGFyZVJlbmRlclBvc3Q9ZnVuY3Rpb24odCl7aWYodGhpcyBpbnN0YW5jZW9mIGUuR3JvdXAyRCl7dmFyIHI9dGhpcztpZihyLmlzUmVuZGVyYWJsZUdyb3VwKXJldHVybn10aGlzLl9jaGlsZHJlbi5sZW5ndGg+MCYmKHRoaXMuX2dsb2JhbFRyYW5zZm9ybVByb2Nlc3NTdGVwIT09dGhpcy5fZ2xvYmFsVHJhbnNmb3JtU3RlcHx8dGhpcy5jaGVja1Byb3BlcnRpZXNEaXJ0eShpLmlzVmlzaWJsZVByb3BlcnR5LmZsYWdJZCkpJiZ0aGlzLl9jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uKGkpe2kgaW5zdGFuY2VvZiBlLkdyb3VwMkQmJmkuaXNSZW5kZXJhYmxlR3JvdXB8fGkuX3ByZXBhcmVSZW5kZXIodCl9KSx0aGlzLl9jbGVhckZsYWdzKGUuU21hcnRQcm9wZXJ0eVByaW0uZmxhZ01vZGVsRGlydHkpLHRoaXMuX2luc3RhbmNlRGlydHlGbGFncz0wfSxpLnByb3RvdHlwZS5fY2FudmFzUHJlSW5pdD1mdW5jdGlvbihlKXt9LGkuQ2hlY2tQYXJlbnQ9ZnVuY3Rpb24oZSl7fSxpLnByb3RvdHlwZS51cGRhdGVDYWNoZWRTdGF0ZXNPZj1mdW5jdGlvbihlLHQpe2Zvcih2YXIgaT0wO2k8ZS5sZW5ndGg7aSsrKXt2YXIgcj1lW2ldO3IudXBkYXRlQ2FjaGVkU3RhdGVzKHQpfX0saS5wcm90b3R5cGUuX3BhcmVudExheW91dERpcnR5PWZ1bmN0aW9uKCl7dGhpcy5fcGFyZW50JiYhdGhpcy5fcGFyZW50LmlzRGlzcG9zZWQmJnRoaXMuX3BhcmVudC5fc2V0TGF5b3V0RGlydHkoKX0saS5wcm90b3R5cGUuX3NldExheW91dERpcnR5PWZ1bmN0aW9uKCl7dGhpcy5pc0RpcnR5fHx0aGlzLm9uUHJpbUJlY29tZXNEaXJ0eSgpLHRoaXMuX3NldEZsYWdzKGUuU21hcnRQcm9wZXJ0eVByaW0uZmxhZ0xheW91dERpcnR5KX0saS5wcm90b3R5cGUuX2NoZWNrUG9zaXRpb25DaGFuZ2U9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wYXJlbnQmJnRoaXMucGFyZW50LmxheW91dEVuZ2luZS5pc0NoaWxkUG9zaXRpb25BbGxvd2VkPT09ITE/KGNvbnNvbGUubG9nKFwiQ2FuJ3QgbWFudWFsbHkgc2V0IHRoZSBwb3NpdGlvbiBvZiBcIit0aGlzLmlkK1wiLCB0aGUgTGF5b3V0IEVuZ2luZSBvZiBpdHMgcGFyZW50IGRvZXNuJ3QgYWxsb3cgaXRcIiksITEpOiEwfSxpLnByb3RvdHlwZS5fcG9zaXRpb25pbmdEaXJ0eT1mdW5jdGlvbigpe3RoaXMuaXNEaXJ0eXx8dGhpcy5vblByaW1CZWNvbWVzRGlydHkoKSx0aGlzLl9zZXRGbGFncyhlLlNtYXJ0UHJvcGVydHlQcmltLmZsYWdQb3NpdGlvbmluZ0RpcnR5KX0saS5wcm90b3R5cGUuX2NoYW5nZUxheW91dEVuZ2luZT1mdW5jdGlvbihlKXt0aGlzLl9sYXlvdXRFbmdpbmU9ZX0saS5wcm90b3R5cGUuX3VwZGF0ZUxvY2FsVHJhbnNmb3JtPWZ1bmN0aW9uKCl7dmFyIHQ9ITEscj1udWxsO3RoaXMuX3BhcmVudD8ocj10aGlzLl9wYXJlbnQuX21hcmdpbk9mZnNldCx0PSFyLmVxdWFscyh0aGlzLl9wYXJlbnRNYXJnaW5nT2Zmc2V0KSx0aGlzLl9wYXJlbnRNYXJnaW5nT2Zmc2V0LmNvcHlGcm9tKHIpKTpyPWkuX3YwO3ZhciBuPWkuYWN0dWFsUG9zaXRpb25Qcm9wZXJ0eS5mbGFnSWR8aS5yb3RhdGlvblByb3BlcnR5LmZsYWdJZHxpLnNjYWxlUHJvcGVydHkuZmxhZ0lkfGkub3JpZ2luUHJvcGVydHkuZmxhZ0lkO2lmKHR8fHRoaXMuY2hlY2tQcm9wZXJ0aWVzRGlydHkobikpe3ZhciBvLHM9ZS5RdWF0ZXJuaW9uLlJvdGF0aW9uQXhpcyhuZXcgZS5WZWN0b3IzKDAsMCwxKSx0aGlzLl9yb3RhdGlvbik7aWYoMD09PXRoaXMuX29yaWdpbi54JiYwPT09dGhpcy5fb3JpZ2luLnkpbz1lLk1hdHJpeC5Db21wb3NlKG5ldyBlLlZlY3RvcjModGhpcy5fc2NhbGUsdGhpcy5fc2NhbGUsMSkscyxuZXcgZS5WZWN0b3IzKHRoaXMuYWN0dWFsUG9zaXRpb24ueCtyLngsdGhpcy5hY3R1YWxQb3NpdGlvbi55K3IueSwwKSksdGhpcy5fbG9jYWxUcmFuc2Zvcm09bztlbHNle3ZhciBhPXRoaXMuYWN0dWFsU2l6ZTtlLk1hdHJpeC5UcmFuc2xhdGlvblRvUmVmKC1hLndpZHRoKnRoaXMuX29yaWdpbi54LC1hLmhlaWdodCp0aGlzLl9vcmlnaW4ueSwwLGkuX3QwKSxzLnRvUm90YXRpb25NYXRyaXgoaS5fdDEpLGkuX3QwLm11bHRpcGx5VG9SZWYoaS5fdDEsaS5fdDIpLGUuTWF0cml4LlNjYWxpbmdUb1JlZih0aGlzLl9zY2FsZSx0aGlzLl9zY2FsZSwxLGkuX3QwKSxpLl90Mi5tdWx0aXBseVRvUmVmKGkuX3QwLGkuX3QxKSxlLk1hdHJpeC5UcmFuc2xhdGlvblRvUmVmKGEud2lkdGgqdGhpcy5fb3JpZ2luLngrdGhpcy5hY3R1YWxQb3NpdGlvbi54K3IueCxhLmhlaWdodCp0aGlzLl9vcmlnaW4ueSt0aGlzLmFjdHVhbFBvc2l0aW9uLnkrci55LDAsaS5fdDIpLGkuX3QxLm11bHRpcGx5VG9SZWYoaS5fdDIsdGhpcy5fbG9jYWxUcmFuc2Zvcm0pfXJldHVybiB0aGlzLmNsZWFyUHJvcGVydGllc0RpcnR5KG4pLCEwfXJldHVybiExfSxpLnByb3RvdHlwZS51cGRhdGVDYWNoZWRTdGF0ZXM9ZnVuY3Rpb24odCl7aWYoIXRoaXMuaXNEaXNwb3NlZCl7dGhpcy5fcGFyZW50JiYodGhpcy5fcGFyZW50Ll9nbG9iYWxUcmFuc2Zvcm1Qcm9jZXNzU3RlcCE9PXRoaXMub3duZXIuX2dsb2JhbFRyYW5zZm9ybVByb2Nlc3NTdGVwfHx0aGlzLl9wYXJlbnQuX2FyZVNvbWVGbGFnc1NldChlLlNtYXJ0UHJvcGVydHlQcmltLmZsYWdMYXlvdXREaXJ0eXxlLlNtYXJ0UHJvcGVydHlQcmltLmZsYWdQb3NpdGlvbmluZ0RpcnR5KSkmJnRoaXMuX3BhcmVudC51cGRhdGVDYWNoZWRTdGF0ZXMoITEpO3ZhciByPXRoaXMuY2hlY2tQcm9wZXJ0aWVzRGlydHkoaS5zaXplUHJvcGVydHkuZmxhZ0lkKTtpZighdGhpcy5faXNGbGFnU2V0KGUuU21hcnRQcm9wZXJ0eVByaW0uZmxhZ0xheW91dERpcnR5KSYmcil7dmFyIG49dGhpcy5zaXplO24mJihudWxsIT10aGlzLnNpemUud2lkdGgmJih0aGlzLmFjdHVhbFNpemUud2lkdGg9dGhpcy5zaXplLndpZHRoKSxudWxsIT10aGlzLnNpemUuaGVpZ2h0JiYodGhpcy5hY3R1YWxTaXplLmhlaWdodD10aGlzLnNpemUuaGVpZ2h0KSx0aGlzLmNsZWFyUHJvcGVydGllc0RpcnR5KGkuc2l6ZVByb3BlcnR5LmZsYWdJZCkpfXZhciBvPXRoaXMuX2lzRmxhZ1NldChlLlNtYXJ0UHJvcGVydHlQcmltLmZsYWdQb3NpdGlvbmluZ0RpcnR5KTt0aGlzLl9pc0ZsYWdTZXQoZS5TbWFydFByb3BlcnR5UHJpbS5mbGFnTGF5b3V0RGlydHkpJiYodGhpcy5fbGF5b3V0RW5naW5lLnVwZGF0ZUxheW91dCh0aGlzKSx0aGlzLl9jbGVhckZsYWdzKGUuU21hcnRQcm9wZXJ0eVByaW0uZmxhZ0xheW91dERpcnR5KSk7dmFyIHM9byYmIXRoaXMuX2lzRmxhZ1NldChlLlNtYXJ0UHJvcGVydHlQcmltLmZsYWdQb3NpdGlvbmluZ0RpcnR5KTtpZighcyYmKHJ8fHRoaXMuX2lzRmxhZ1NldChlLlNtYXJ0UHJvcGVydHlQcmltLmZsYWdQb3NpdGlvbmluZ0RpcnR5KXx8dGhpcy5fcGFyZW50JiYhdGhpcy5fcGFyZW50LmNvbnRlbnRBcmVhLmVxdWFscyh0aGlzLl9wYXJlbnRDb250ZW50QXJlYSkpJiYodGhpcy5fdXBkYXRlUG9zaXRpb25pbmcoKSx0aGlzLl9jbGVhckZsYWdzKGUuU21hcnRQcm9wZXJ0eVByaW0uZmxhZ1Bvc2l0aW9uaW5nRGlydHkpLHM9ITApLHMmJnRoaXMuX3BhcmVudCYmdGhpcy5fcGFyZW50Q29udGVudEFyZWEuY29weUZyb20odGhpcy5fcGFyZW50LmNvbnRlbnRBcmVhKSx0aGlzPT09dGhpcy5vd25lcnx8dGhpcy5fZ2xvYmFsVHJhbnNmb3JtUHJvY2Vzc1N0ZXAhPT10aGlzLm93bmVyLl9nbG9iYWxUcmFuc2Zvcm1Qcm9jZXNzU3RlcCl7dmFyIGE9dGhpcy5pc1Zpc2libGU7dGhpcy5pc1Zpc2libGU9KCF0aGlzLl9wYXJlbnR8fHRoaXMuX3BhcmVudC5pc1Zpc2libGUpJiZ0aGlzLmxldmVsVmlzaWJsZSx0aGlzLl9jaGFuZ2VGbGFncyhlLlNtYXJ0UHJvcGVydHlQcmltLmZsYWdWaXNpYmlsaXR5Q2hhbmdlZCxhIT09dGhpcy5pc1Zpc2libGUpO3ZhciBoPXRoaXMuX3VwZGF0ZUxvY2FsVHJhbnNmb3JtKCksYz1udWxsIT10aGlzLl9wYXJlbnQ/dGhpcy5fcGFyZW50Ll9nbG9iYWxUcmFuc2Zvcm1TdGVwIT09dGhpcy5fcGFyZW50VHJhbnNmb3JtU3RlcDohMTtpZighdGhpcy5fZ2xvYmFsVHJhbnNmb3JtfHxofHxjKXt2YXIgbD10aGlzLl9wYXJlbnQ/dGhpcy5fcGFyZW50Ll9nbG9iYWxUcmFuc2Zvcm06bnVsbDt0aGlzLl9nbG9iYWxUcmFuc2Zvcm09dGhpcy5fcGFyZW50P3RoaXMuX2xvY2FsVHJhbnNmb3JtLm11bHRpcGx5KGwpOnRoaXMuX2xvY2FsVHJhbnNmb3JtLHRoaXMuX2ludkdsb2JhbFRyYW5zZm9ybT1lLk1hdHJpeC5JbnZlcnQodGhpcy5fZ2xvYmFsVHJhbnNmb3JtKSx0aGlzLl9nbG9iYWxUcmFuc2Zvcm1TdGVwPXRoaXMub3duZXIuX2dsb2JhbFRyYW5zZm9ybVByb2Nlc3NTdGVwKzEsdGhpcy5fcGFyZW50VHJhbnNmb3JtU3RlcD10aGlzLl9wYXJlbnQ/dGhpcy5fcGFyZW50Ll9nbG9iYWxUcmFuc2Zvcm1TdGVwOjB9dGhpcy5fZ2xvYmFsVHJhbnNmb3JtUHJvY2Vzc1N0ZXA9dGhpcy5vd25lci5fZ2xvYmFsVHJhbnNmb3JtUHJvY2Vzc1N0ZXB9aWYodClmb3IodmFyIHU9MCxmPXRoaXMuX2NoaWxkcmVuO3U8Zi5sZW5ndGg7dSsrKXt2YXIgZD1mW3VdO2QudXBkYXRlQ2FjaGVkU3RhdGVzKCEoZCBpbnN0YW5jZW9mIGUuR3JvdXAyRCYmZC5pc1JlbmRlcmFibGVHcm91cCkpfX19LGkucHJvdG90eXBlLl91cGRhdGVQb3NpdGlvbmluZz1mdW5jdGlvbigpe3RoaXMuX2hhc01hcmdpbnx8bnVsbCE9dGhpcy5hY3R1YWxTaXplLndpZHRoJiZudWxsIT10aGlzLmFjdHVhbFNpemUuaGVpZ2h0fHwobnVsbD09dGhpcy5hY3R1YWxTaXplLndpZHRoJiYodGhpcy5tYXJnaW5BbGlnbm1lbnQuaG9yaXpvbnRhbD1uLkFsaWduU3RyZXRjaCksbnVsbD09dGhpcy5hY3R1YWxTaXplLmhlaWdodCYmKHRoaXMubWFyZ2luQWxpZ25tZW50LnZlcnRpY2FsPW4uQWxpZ25TdHJldGNoKSksdGhpcy5faGFzTWFyZ2luJiYodGhpcy5tYXJnaW4uY29tcHV0ZVdpdGhBbGlnbm1lbnQodGhpcy5sYXlvdXRBcmVhLHRoaXMuc2l6ZSx0aGlzLm1hcmdpbkFsaWdubWVudCx0aGlzLl9tYXJnaW5PZmZzZXQsaS5fc2l6ZSksdGhpcy5hY3R1YWxQb3NpdGlvbj10aGlzLl9tYXJnaW5PZmZzZXQuYWRkKHRoaXMuX2xheW91dEFyZWFQb3MpLG51bGwhPXRoaXMuc2l6ZS53aWR0aCYmKHRoaXMuc2l6ZS53aWR0aD1pLl9zaXplLndpZHRoKSxudWxsIT10aGlzLnNpemUuaGVpZ2h0JiYodGhpcy5zaXplLmhlaWdodD1pLl9zaXplLmhlaWdodCksdGhpcy5hY3R1YWxTaXplLmNvcHlGcm9tKGkuX3NpemUuY2xvbmUoKSkpLHRoaXMuX2hhc1BhZGRpbmc/KHRoaXMuX2dldEluaXRpYWxDb250ZW50QXJlYVRvUmVmKHRoaXMuYWN0dWFsU2l6ZSxpLl9pY1BvcyxpLl9pY0FyZWEpLGkuX2ljQXJlYS53aWR0aD1NYXRoLm1heCgwLGkuX2ljQXJlYS53aWR0aCksaS5faWNBcmVhLmhlaWdodD1NYXRoLm1heCgwLGkuX2ljQXJlYS5oZWlnaHQpLHRoaXMucGFkZGluZy5jb21wdXRlKGkuX2ljQXJlYSx0aGlzLl9tYXJnaW5PZmZzZXQsaS5fc2l6ZSksdGhpcy5fbWFyZ2luT2Zmc2V0LngrPWkuX2ljUG9zLngsdGhpcy5fbWFyZ2luT2Zmc2V0LnkrPWkuX2ljUG9zLnksdGhpcy5fY29udGVudEFyZWEuY29weUZyb20oaS5fc2l6ZSkpOih0aGlzLl9nZXRJbml0aWFsQ29udGVudEFyZWFUb1JlZih0aGlzLmFjdHVhbFNpemUsaS5faWNQb3MsaS5faWNBcmVhKSxpLl9pY0FyZWEud2lkdGg9TWF0aC5tYXgoMCxpLl9pY0FyZWEud2lkdGgpLGkuX2ljQXJlYS5oZWlnaHQ9TWF0aC5tYXgoMCxpLl9pY0FyZWEuaGVpZ2h0KSx0aGlzLl9tYXJnaW5PZmZzZXQuY29weUZyb20oaS5faWNQb3MpLHRoaXMuX2NvbnRlbnRBcmVhLmNvcHlGcm9tKGkuX2ljQXJlYSkpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJjb250ZW50QXJlYVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faXNGbGFnU2V0KGUuU21hcnRQcm9wZXJ0eVByaW0uZmxhZ1Bvc2l0aW9uaW5nRGlydHkpJiYodGhpcy5fdXBkYXRlUG9zaXRpb25pbmcoKSx0aGlzLl9jbGVhckZsYWdzKGUuU21hcnRQcm9wZXJ0eVByaW0uZmxhZ1Bvc2l0aW9uaW5nRGlydHkpKSx0aGlzLl9jb250ZW50QXJlYX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxpLnByb3RvdHlwZS5fcGF0Y2hIaWVyYXJjaHk9ZnVuY3Rpb24odCl7aWYodGhpcy5fb3duZXI9dCxudWxsPT10aGlzLl9yZW5kZXJHcm91cCl7aWYodGhpcyBpbnN0YW5jZW9mIGUuR3JvdXAyRCl7dmFyIGk9dGhpcztpLmRldGVjdEdyb3VwU3RhdGVzKCksaS5fdHJhY2tlZE5vZGUmJiFpLl9pc0ZsYWdTZXQoZS5TbWFydFByb3BlcnR5UHJpbS5mbGFnVHJhY2tlZEdyb3VwKSYmaS5vd25lci5fcmVnaXN0ZXJUcmFja2VkTm9kZSh0aGlzKX1pZih0aGlzLl9wYXJlbnQmJih0aGlzLl9yZW5kZXJHcm91cD10aGlzLnBhcmVudC50cmF2ZXJzZVVwKGZ1bmN0aW9uKHQpe3JldHVybiB0IGluc3RhbmNlb2YgZS5Hcm91cDJEJiZ0LmlzUmVuZGVyYWJsZUdyb3VwfSksdGhpcy5fcGFyZW50TGF5b3V0RGlydHkoKSksdGhpcy5fcmVuZGVyR3JvdXAmJnRoaXMuaXNEaXJ0eSl7dmFyIHI9dGhpcy5fcmVuZGVyR3JvdXAuX3JlbmRlcmFibGVEYXRhLl9wcmltRGlydHlMaXN0LG49ci5pbmRleE9mKHRoaXMpOy0xPT09biYmci5wdXNoKHRoaXMpfWZvcih2YXIgbz0wLHM9dGhpcy5fY2hpbGRyZW47bzxzLmxlbmd0aDtvKyspe3ZhciBhPXNbb107dGhpcy5fcGF0Y2hIaWVyYXJjaHlEZXB0aChhKSxhLl9wYXRjaEhpZXJhcmNoeSh0KX19fSxpLnByb3RvdHlwZS5fcGF0Y2hIaWVyYXJjaHlEZXB0aD1mdW5jdGlvbih0KXt0Ll9oaWVyYXJjaHlEZXB0aD10aGlzLl9oaWVyYXJjaHlEZXB0aCsxLHQuX2hpZXJhcmNoeURlcHRoT2Zmc2V0PXRoaXMuX2hpZXJhcmNoeURlcHRoT2Zmc2V0Kyh0aGlzLl9jaGlsZHJlbi5sZW5ndGgrMSkqdGhpcy5fc2libGluZ0RlcHRoT2Zmc2V0LHQuX3NpYmxpbmdEZXB0aE9mZnNldD10aGlzLl9zaWJsaW5nRGVwdGhPZmZzZXQvZS5DYW52YXMyRC5oaWVyYXJjaHlMZXZlbE1heFNpYmxpbmdDb3VudH0saS5wcm90b3R5cGUuX2dldEluaXRpYWxDb250ZW50QXJlYVRvUmVmPWZ1bmN0aW9uKGUsdCxpKXtpLndpZHRoPWUud2lkdGgsaS5oZWlnaHQ9ZS5oZWlnaHQsdC54PXQueT0wfSxpLlBSSU0yREJBU0VfUFJPUENPVU5UPTE1LGkuX251bGxQb3NpdGlvbj1lLlZlY3RvcjIuWmVybygpLGkuYm91bmRpbmJCb3hSZWVudHJlbmN5PSExLGkubnVsbFNpemU9ZS5TaXplLlplcm8oKSxpLl9pc0NhbnZhc0luaXQ9ITEsaS5fdDA9bmV3IGUuTWF0cml4LGkuX3QxPW5ldyBlLk1hdHJpeCxpLl90Mj1uZXcgZS5NYXRyaXgsaS5fdjA9ZS5WZWN0b3IyLlplcm8oKSxpLl9pY1Bvcz1lLlZlY3RvcjIuWmVybygpLGkuX2ljQXJlYT1lLlNpemUuWmVybygpLGkuX3NpemU9ZS5TaXplLlplcm8oKSxfX2RlY29yYXRlKFtlLmluc3RhbmNlTGV2ZWxQcm9wZXJ0eSgxLGZ1bmN0aW9uKGUpe3JldHVybiBpLmFjdHVhbFBvc2l0aW9uUHJvcGVydHk9ZX0sITEsITApXSxpLnByb3RvdHlwZSxcImFjdHVhbFBvc2l0aW9uXCIsbnVsbCksX19kZWNvcmF0ZShbZS5keW5hbWljTGV2ZWxQcm9wZXJ0eSgxLGZ1bmN0aW9uKGUpe3JldHVybiBpLnBvc2l0aW9uUHJvcGVydHk9ZX0sITEsITApXSxpLnByb3RvdHlwZSxcInBvc2l0aW9uXCIsbnVsbCksX19kZWNvcmF0ZShbZS5keW5hbWljTGV2ZWxQcm9wZXJ0eSgyLGZ1bmN0aW9uKGUpe3JldHVybiBpLnNpemVQcm9wZXJ0eT1lfSwhMSwhMCldLGkucHJvdG90eXBlLFwic2l6ZVwiLG51bGwpLF9fZGVjb3JhdGUoW2UuaW5zdGFuY2VMZXZlbFByb3BlcnR5KDMsZnVuY3Rpb24oZSl7cmV0dXJuIGkucm90YXRpb25Qcm9wZXJ0eT1lfSwhMSwhMCldLGkucHJvdG90eXBlLFwicm90YXRpb25cIixudWxsKSxfX2RlY29yYXRlKFtlLmluc3RhbmNlTGV2ZWxQcm9wZXJ0eSg0LGZ1bmN0aW9uKGUpe3JldHVybiBpLnNjYWxlUHJvcGVydHk9ZX0sITEsITApXSxpLnByb3RvdHlwZSxcInNjYWxlXCIsbnVsbCksX19kZWNvcmF0ZShbZS5keW5hbWljTGV2ZWxQcm9wZXJ0eSg1LGZ1bmN0aW9uKGUpe3JldHVybiBpLm9yaWdpblByb3BlcnR5PWV9LCExLCEwKV0saS5wcm90b3R5cGUsXCJvcmlnaW5cIixudWxsKSxfX2RlY29yYXRlKFtlLmR5bmFtaWNMZXZlbFByb3BlcnR5KDYsZnVuY3Rpb24oZSl7cmV0dXJuIGkubGV2ZWxWaXNpYmxlUHJvcGVydHk9ZX0pXSxpLnByb3RvdHlwZSxcImxldmVsVmlzaWJsZVwiLG51bGwpLF9fZGVjb3JhdGUoW2UuaW5zdGFuY2VMZXZlbFByb3BlcnR5KDcsZnVuY3Rpb24oZSl7cmV0dXJuIGkuaXNWaXNpYmxlUHJvcGVydHk9ZX0pXSxpLnByb3RvdHlwZSxcImlzVmlzaWJsZVwiLG51bGwpLF9fZGVjb3JhdGUoW2UuaW5zdGFuY2VMZXZlbFByb3BlcnR5KDgsZnVuY3Rpb24oZSl7cmV0dXJuIGkuek9yZGVyUHJvcGVydHk9ZX0pXSxpLnByb3RvdHlwZSxcInpPcmRlclwiLG51bGwpLF9fZGVjb3JhdGUoW2UuZHluYW1pY0xldmVsUHJvcGVydHkoOSxmdW5jdGlvbihlKXtyZXR1cm4gaS5tYXJnaW5Qcm9wZXJ0eT1lfSldLGkucHJvdG90eXBlLFwibWFyZ2luXCIsbnVsbCksX19kZWNvcmF0ZShbZS5keW5hbWljTGV2ZWxQcm9wZXJ0eSgxMCxmdW5jdGlvbihlKXtyZXR1cm4gaS5wYWRkaW5nUHJvcGVydHk9ZX0pXSxpLnByb3RvdHlwZSxcInBhZGRpbmdcIixudWxsKSxfX2RlY29yYXRlKFtlLmR5bmFtaWNMZXZlbFByb3BlcnR5KDExLGZ1bmN0aW9uKGUpe3JldHVybiBpLm1hcmdpbkFsaWdubWVudFByb3BlcnR5PWV9KV0saS5wcm90b3R5cGUsXCJtYXJnaW5BbGlnbm1lbnRcIixudWxsKSxpPV9fZGVjb3JhdGUoW2UuY2xhc3NOYW1lKFwiUHJpbTJEQmFzZVwiKV0saSl9KGUuU21hcnRQcm9wZXJ0eVByaW0pO2UuUHJpbTJEQmFzZT1ofShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCxpLHIpe3RoaXMuX3BhcnRDb3VudD1yLHRoaXMub3duZXI9dCx0aGlzLm1vZGVsUmVuZGVyQ2FjaGU9aSx0aGlzLm1vZGVsUmVuZGVyQ2FjaGUuYWRkUmVmKCksdGhpcy5wYXJ0SW5kZXhGcm9tSWQ9bmV3IGUuU3RyaW5nRGljdGlvbmFyeSx0aGlzLl91c2VkU2hhZGVyQ2F0ZWdvcmllcz1uZXcgQXJyYXkociksdGhpcy5fc3RyaWRlcz1uZXcgQXJyYXkociksdGhpcy5fb3BhcXVlRGF0YT1udWxsLHRoaXMuX2FscGhhVGVzdERhdGE9bnVsbCx0aGlzLl90cmFuc3BhcmVudERhdGE9bnVsbCx0aGlzLm9wYXF1ZURpcnR5PXRoaXMuYWxwaGFUZXN0RGlydHk9dGhpcy50cmFuc3BhcmVudERpcnR5PXRoaXMudHJhbnNwYXJlbnRPcmRlckRpcnR5PSExfXJldHVybiB0LnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7aWYodGhpcy5faXNEaXNwb3NlZClyZXR1cm4hMTt0aGlzLm1vZGVsUmVuZGVyQ2FjaGUmJnRoaXMubW9kZWxSZW5kZXJDYWNoZS5kaXNwb3NlKCk7dmFyIGU9dGhpcy5vd25lci5vd25lci5lbmdpbmU7cmV0dXJuIHRoaXMub3BhcXVlRGF0YSYmKHRoaXMub3BhcXVlRGF0YS5mb3JFYWNoKGZ1bmN0aW9uKHQpe3JldHVybiB0LmRpc3Bvc2UoZSl9KSx0aGlzLm9wYXF1ZURhdGE9bnVsbCksdGhpcy5wYXJ0SW5kZXhGcm9tSWQ9bnVsbCx0aGlzLl9pc0Rpc3Bvc2VkPSEwLCEwfSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJoYXNPcGFxdWVEYXRhXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBudWxsIT10aGlzLl9vcGFxdWVEYXRhfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcImhhc0FscGhhVGVzdERhdGFcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIG51bGwhPXRoaXMuX2FscGhhVGVzdERhdGF9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwiaGFzVHJhbnNwYXJlbnREYXRhXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBudWxsIT10aGlzLl90cmFuc3BhcmVudERhdGF9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwib3BhcXVlRGF0YVwiLHtnZXQ6ZnVuY3Rpb24oKXtpZighdGhpcy5fb3BhcXVlRGF0YSl7dGhpcy5fb3BhcXVlRGF0YT1uZXcgQXJyYXkodGhpcy5fcGFydENvdW50KTtmb3IodmFyIGU9MDtlPHRoaXMuX3BhcnRDb3VudDtlKyspdGhpcy5fb3BhcXVlRGF0YVtlXT1uZXcgcih0aGlzLl9zdHJpZGVzW2VdKX1yZXR1cm4gdGhpcy5fb3BhcXVlRGF0YX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJhbHBoYVRlc3REYXRhXCIse2dldDpmdW5jdGlvbigpe2lmKCF0aGlzLl9hbHBoYVRlc3REYXRhKXt0aGlzLl9hbHBoYVRlc3REYXRhPW5ldyBBcnJheSh0aGlzLl9wYXJ0Q291bnQpO2Zvcih2YXIgZT0wO2U8dGhpcy5fcGFydENvdW50O2UrKyl0aGlzLl9hbHBoYVRlc3REYXRhW2VdPW5ldyByKHRoaXMuX3N0cmlkZXNbZV0pfXJldHVybiB0aGlzLl9hbHBoYVRlc3REYXRhfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcInRyYW5zcGFyZW50RGF0YVwiLHtnZXQ6ZnVuY3Rpb24oKXtpZighdGhpcy5fdHJhbnNwYXJlbnREYXRhKXt0aGlzLl90cmFuc3BhcmVudERhdGE9bmV3IEFycmF5KHRoaXMuX3BhcnRDb3VudCk7Zm9yKHZhciBlPTA7ZTx0aGlzLl9wYXJ0Q291bnQ7ZSsrKXt2YXIgdD10aGlzLm1vZGVsUmVuZGVyQ2FjaGUuX3BhcnREYXRhW2VdLl96Qmlhc09mZnNldDt0aGlzLl90cmFuc3BhcmVudERhdGFbZV09bmV3IG4odGhpcy5fc3RyaWRlc1tlXSx0KX19cmV0dXJuIHRoaXMuX3RyYW5zcGFyZW50RGF0YX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSx0LnByb3RvdHlwZS5zb3J0VHJhbnNwYXJlbnREYXRhPWZ1bmN0aW9uKCl7aWYodGhpcy50cmFuc3BhcmVudE9yZGVyRGlydHkpe2Zvcih2YXIgZT0wO2U8dGhpcy5fdHJhbnNwYXJlbnREYXRhLmxlbmd0aDtlKyspe3ZhciB0PXRoaXMuX3RyYW5zcGFyZW50RGF0YVtlXTt0Ll9wYXJ0RGF0YS5zb3J0KCl9dGhpcy50cmFuc3BhcmVudE9yZGVyRGlydHk9ITF9fSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJ1c2VkU2hhZGVyQ2F0ZWdvcmllc1wiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fdXNlZFNoYWRlckNhdGVnb3JpZXN9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwic3RyaWRlc1wiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc3RyaWRlc30sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSx0fSgpO2UuR3JvdXBJbnN0YW5jZUluZm89dDt2YXIgaT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoKXt9cmV0dXJuIGV9KCk7ZS5UcmFuc3BhcmVudFNlZ21lbnQ9aTt2YXIgcj1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCl7dGhpcy5fcGFydERhdGE9bnVsbCx0aGlzLl9wYXJ0QnVmZmVyPW51bGwsdGhpcy5fcGFydEJ1ZmZlclNpemU9MCx0aGlzLl9wYXJ0RGF0YT1uZXcgZS5EeW5hbWljRmxvYXRBcnJheSh0LzQsNTApLHRoaXMuX2lzRGlzcG9zZWQ9ITF9cmV0dXJuIHQucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2lzRGlzcG9zZWQ/ITE6KHRoaXMuX3BhcnRCdWZmZXImJihlLl9yZWxlYXNlQnVmZmVyKHRoaXMuX3BhcnRCdWZmZXIpLHRoaXMuX3BhcnRCdWZmZXI9bnVsbCksdGhpcy5fcGFydERhdGE9bnVsbCx2b2lkKHRoaXMuX2lzRGlzcG9zZWQ9ITApKX0sdH0oKTtlLkdyb3VwSW5mb1BhcnREYXRhPXI7dmFyIG49ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdCh0LGkpe2UuY2FsbCh0aGlzLHQpLHRoaXMuX3BhcnREYXRhLmNvbXBhcmVWYWx1ZU9mZnNldD1pLHRoaXMuX3BhcnREYXRhLnNvcnRpbmdBc2NlbmRpbmc9ITF9cmV0dXJuIF9fZXh0ZW5kcyh0LGUpLHR9KHIpO2UuVHJhbnNwYXJlbnRHcm91cEluZm9QYXJ0RGF0YT1uO3ZhciBvPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGkpe3RoaXMuX2VuZ2luZT10LHRoaXMuX21vZGVsS2V5PWksdGhpcy5fbmV4dEtleT0xLHRoaXMuX3JlZkNvdW50ZXI9MSx0aGlzLl9pbnN0YW5jZXNEYXRhPW5ldyBlLlN0cmluZ0RpY3Rpb25hcnksdGhpcy5fcGFydERhdGE9bnVsbH1yZXR1cm4gdC5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe2lmKDAhPT0tLXRoaXMuX3JlZkNvdW50ZXIpcmV0dXJuITE7dmFyIGU9dGhpcy5fZW5naW5lLmdldEV4dGVybmFsRGF0YShcIl9fQkpTQ0FOVkFTMkRfX1wiKTtyZXR1cm4gZSYmZS5EaXNwb3NlTW9kZWxSZW5kZXJDYWNoZSh0aGlzKSwhMH0sT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwiaXNEaXNwb3NlZFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcmVmQ291bnRlcjw9MH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSx0LnByb3RvdHlwZS5hZGRSZWY9ZnVuY3Rpb24oKXtyZXR1cm4rK3RoaXMuX3JlZkNvdW50ZXJ9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcIm1vZGVsS2V5XCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9tb2RlbEtleX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSx0LnByb3RvdHlwZS5yZW5kZXI9ZnVuY3Rpb24oZSx0KXtyZXR1cm4hMH0sdC5wcm90b3R5cGUuYWRkSW5zdGFuY2VEYXRhUGFydHM9ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5fbmV4dEtleS50b1N0cmluZygpO2lmKCF0aGlzLl9pbnN0YW5jZXNEYXRhLmFkZCh0LGUpKXRocm93IEVycm9yKFwiS2V5OiBcIit0K1wiIGlzIGFscmVhZHkgYWxsb2NhdGVkXCIpO3JldHVybisrdGhpcy5fbmV4dEtleSx0fSx0LnByb3RvdHlwZS5yZW1vdmVJbnN0YW5jZURhdGE9ZnVuY3Rpb24oZSl7dGhpcy5faW5zdGFuY2VzRGF0YS5yZW1vdmUoZSl9LHQucHJvdG90eXBlLmdldFBhcnRJbmRleEZyb21JZD1mdW5jdGlvbihlKXtmb3IodmFyIHQ9MDt0PHRoaXMuX3BhcnREYXRhLmxlbmd0aDt0KyspaWYodGhpcy5fcGFydERhdGFbdF0uX3BhcnRJZD09PWUpcmV0dXJuIHQ7cmV0dXJuIG51bGx9LHQucHJvdG90eXBlLmxvYWRJbnN0YW5jaW5nQXR0cmlidXRlcz1mdW5jdGlvbihlLHQpe3ZhciBpPXRoaXMuZ2V0UGFydEluZGV4RnJvbUlkKGUpO2lmKG51bGw9PT1pKXJldHVybiBudWxsO3ZhciByPXRoaXMuX3BhcnRzQ2xhc3NJbmZvW2ldLG49dGhpcy5fcGFydERhdGFbaV0uX3BhcnRVc2VkQ2F0ZWdvcmllcyxvPXIuY2xhc3NDb250ZW50LmdldEluc3RhbmNpbmdBdHRyaWJ1dGVJbmZvcyh0LG4pO3JldHVybiBvfSx0LnByb3RvdHlwZS5zZXR1cFVuaWZvcm1zPWZ1bmN0aW9uKGUsaSxyLG4pe3ZhciBvPXRoaXMuX3BhcnREYXRhW2ldLHM9by5fcGFydERhdGFTdHJpZGUvNCpuLGE9dGhpcy5fcGFydHNDbGFzc0luZm9baV07YS5mdWxsQ29udGVudC5mb3JFYWNoKGZ1bmN0aW9uKGksbil7aWYoIW4uY2F0ZWdvcnl8fC0xIT09by5fcGFydFVzZWRDYXRlZ29yaWVzLmluZGV4T2Yobi5jYXRlZ29yeSkpc3dpdGNoKG4uZGF0YVR5cGUpe2Nhc2UgNDp2YXIgYT1uLmluc3RhbmNlT2Zmc2V0LmdldChvLl9wYXJ0Sm9pbmVkVXNlZENhdGVnb3JpZXMpO2Uuc2V0RmxvYXQobi5hdHRyaWJ1dGVOYW1lLHIuYnVmZmVyW3MrYV0pO2JyZWFrO2Nhc2UgMDp2YXIgYT1uLmluc3RhbmNlT2Zmc2V0LmdldChvLl9wYXJ0Sm9pbmVkVXNlZENhdGVnb3JpZXMpO3QudjIueD1yLmJ1ZmZlcltzK2ErMF0sdC52Mi55PXIuYnVmZmVyW3MrYSsxXSxlLnNldFZlY3RvcjIobi5hdHRyaWJ1dGVOYW1lLHQudjIpO2JyZWFrO2Nhc2UgNTpjYXNlIDE6dmFyIGE9bi5pbnN0YW5jZU9mZnNldC5nZXQoby5fcGFydEpvaW5lZFVzZWRDYXRlZ29yaWVzKTt0LnYzLng9ci5idWZmZXJbcythKzBdLHQudjMueT1yLmJ1ZmZlcltzK2ErMV0sdC52My56PXIuYnVmZmVyW3MrYSsyXSxlLnNldFZlY3RvcjMobi5hdHRyaWJ1dGVOYW1lLHQudjMpO2JyZWFrO2Nhc2UgNjpjYXNlIDI6dmFyIGE9bi5pbnN0YW5jZU9mZnNldC5nZXQoby5fcGFydEpvaW5lZFVzZWRDYXRlZ29yaWVzKTt0LnY0Lng9ci5idWZmZXJbcythKzBdLHQudjQueT1yLmJ1ZmZlcltzK2ErMV0sdC52NC56PXIuYnVmZmVyW3MrYSsyXSx0LnY0Lnc9ci5idWZmZXJbcythKzNdLGUuc2V0VmVjdG9yNChuLmF0dHJpYnV0ZU5hbWUsdC52NCl9fSl9LHQudjI9ZS5WZWN0b3IyLlplcm8oKSx0LnYzPWUuVmVjdG9yMy5aZXJvKCksdC52ND1lLlZlY3RvcjQuWmVybygpLHR9KCk7ZS5Nb2RlbFJlbmRlckNhY2hlPW87dmFyIHM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7fXJldHVybiBlfSgpO2UuTW9kZWxSZW5kZXJDYWNoZVBhcnREYXRhPXN9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQodCxuKXtyZXR1cm4gZnVuY3Rpb24obyxzLGEpe3ZhciBoPWUuQ2xhc3NUcmVlSW5mby5nZXRPclJlZ2lzdGVyKG8sZnVuY3Rpb24oZSl7cmV0dXJuIG5ldyBpKGUpfSksYz1oLmdldExldmVsT2YobyksbD1zO249bnx8bDt2YXIgdT1jLmxldmVsQ29udGVudC5nZXQobCk7aWYodSl0aHJvdyBuZXcgRXJyb3IoXCJUaGUgSUQgXCIrbCtcIiBpcyBhbHJlYWR5IHRha2VuIGJ5IGFub3RoZXIgaW5zdGFuY2UgZGF0YVwiKTt1PW5ldyByLHUuYXR0cmlidXRlTmFtZT1uLHUuY2F0ZWdvcnk9dHx8bnVsbCx1LmNhdGVnb3J5JiYodS5kZWxpbWl0ZWRDYXRlZ29yeT1cIjtcIit1LmNhdGVnb3J5K1wiO1wiKSxjLmxldmVsQ29udGVudC5hZGQobCx1KSxhLmdldD1mdW5jdGlvbigpe3JldHVybiBudWxsfSxhLnNldD1mdW5jdGlvbihlKXtpZighdS5jYXRlZ29yeXx8LTEhPT1pLl9DdXJDYXRlZ29yaWVzLmluZGV4T2YodS5kZWxpbWl0ZWRDYXRlZ29yeSkpe3Uuc2l6ZT91Lmluc3RhbmNlT2Zmc2V0LmNvbnRhaW5zKGkuX0N1ckNhdGVnb3JpZXMpfHxjLmNsYXNzQ29udGVudC5tYXBQcm9wZXJ0eSh1LCExKToodS5zZXRTaXplKGUpLGMuY2xhc3NDb250ZW50Lm1hcFByb3BlcnR5KHUsITApKTt2YXIgdD10aGlzO2lmKHQuZGF0YUJ1ZmZlciYmdC5kYXRhRWxlbWVudHMpe3ZhciByPXQuZGF0YUVsZW1lbnRzW3QuY3VyRWxlbWVudF0ub2Zmc2V0K3UuaW5zdGFuY2VPZmZzZXQuZ2V0KGkuX0N1ckNhdGVnb3JpZXMpO3Uud3JpdGVEYXRhKHQuZGF0YUJ1ZmZlci5idWZmZXIscixlKX19fX19dmFyIGk9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQpe3RoaXMuX2Jhc2VJbmZvPXQsdGhpcy5fbmV4dE9mZnNldD1uZXcgZS5TdHJpbmdEaWN0aW9uYXJ5LHRoaXMuX2F0dHJpYnV0ZXM9bmV3IEFycmF5fXJldHVybiB0LnByb3RvdHlwZS5tYXBQcm9wZXJ0eT1mdW5jdGlvbihlLGkpe3ZhciByPXRoaXMuX25leHRPZmZzZXQuZ2V0T3JBZGQodC5fQ3VyQ2F0ZWdvcmllcywwKTtlLmluc3RhbmNlT2Zmc2V0LmFkZCh0Ll9DdXJDYXRlZ29yaWVzLHRoaXMuX2dldEJhc2VPZmZzZXQodC5fQ3VyQ2F0ZWdvcmllcykrciksdGhpcy5fbmV4dE9mZnNldC5zZXQodC5fQ3VyQ2F0ZWdvcmllcyxyK2Uuc2l6ZS80KSxpJiZ0aGlzLl9hdHRyaWJ1dGVzLnB1c2goZSl9LHQucHJvdG90eXBlLmdldEluc3RhbmNpbmdBdHRyaWJ1dGVJbmZvcz1mdW5jdGlvbih0LGkpe2Zvcih2YXIgcj1cIjtcIitpLmpvaW4oXCI7XCIpK1wiO1wiLG49bmV3IEFycmF5LG89dGhpcztvOyl7Zm9yKHZhciBzPTAsYT1vLl9hdHRyaWJ1dGVzO3M8YS5sZW5ndGg7cysrKXt2YXIgaD1hW3NdO2lmKCFoLmNhdGVnb3J5fHwtMSE9PWkuaW5kZXhPZihoLmNhdGVnb3J5KSl7dmFyIGM9dC5nZXRBdHRyaWJ1dGVMb2NhdGlvbkJ5TmFtZShoLmF0dHJpYnV0ZU5hbWUpLGw9bmV3IGUuSW5zdGFuY2luZ0F0dHJpYnV0ZUluZm87bC5pbmRleD1jLGwuYXR0cmlidXRlU2l6ZT1oLnNpemUvNCxsLm9mZnNldD00KmguaW5zdGFuY2VPZmZzZXQuZ2V0KHIpLGwuYXR0cmlidXRlTmFtZT1oLmF0dHJpYnV0ZU5hbWUsbi5wdXNoKGwpfX1vPW8uX2Jhc2VJbmZvfXJldHVybiBufSx0LnByb3RvdHlwZS5nZXRTaGFkZXJBdHRyaWJ1dGVzPWZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1uZXcgQXJyYXksaT10aGlzO2k7KXtmb3IodmFyIHI9MCxuPWkuX2F0dHJpYnV0ZXM7cjxuLmxlbmd0aDtyKyspe3ZhciBvPW5bcl07by5jYXRlZ29yeSYmLTE9PT1lLmluZGV4T2Yoby5jYXRlZ29yeSl8fHQucHVzaChvLmF0dHJpYnV0ZU5hbWUpfWk9aS5fYmFzZUluZm99cmV0dXJuIHR9LHQucHJvdG90eXBlLl9nZXRCYXNlT2Zmc2V0PWZ1bmN0aW9uKGUpe2Zvcih2YXIgdD0wLGk9dGhpcy5fYmFzZUluZm87aTspdCs9aS5fbmV4dE9mZnNldC5nZXRPckFkZChlLDApLGk9aS5fYmFzZUluZm87cmV0dXJuIHR9LHR9KCk7ZS5JbnN0YW5jZUNsYXNzSW5mbz1pO3ZhciByPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCgpe3RoaXMuaW5zdGFuY2VPZmZzZXQ9bmV3IGUuU3RyaW5nRGljdGlvbmFyeX1yZXR1cm4gdC5wcm90b3R5cGUuc2V0U2l6ZT1mdW5jdGlvbih0KXtpZih0IGluc3RhbmNlb2YgZS5WZWN0b3IyKXJldHVybiB0aGlzLnNpemU9OCx2b2lkKHRoaXMuZGF0YVR5cGU9MCk7aWYodCBpbnN0YW5jZW9mIGUuVmVjdG9yMylyZXR1cm4gdGhpcy5zaXplPTEyLHZvaWQodGhpcy5kYXRhVHlwZT0xKTtpZih0IGluc3RhbmNlb2YgZS5WZWN0b3I0KXJldHVybiB0aGlzLnNpemU9MTYsdm9pZCh0aGlzLmRhdGFUeXBlPTIpO2lmKHQgaW5zdGFuY2VvZiBlLk1hdHJpeCl0aHJvdyBuZXcgRXJyb3IoXCJNYXRyaXggdHlwZSBpcyBub3Qgc3VwcG9ydGVkIGJ5IFdlYkdMIEluc3RhbmNlIEJ1ZmZlciwgeW91IGhhdmUgdG8gdXNlIGZvdXIgVmVjdG9yNCBwcm9wZXJ0aWVzIGluc3RlYWRcIik7cmV0dXJuXCJudW1iZXJcIj09dHlwZW9mIHQ/KHRoaXMuc2l6ZT00LHZvaWQodGhpcy5kYXRhVHlwZT00KSk6dCBpbnN0YW5jZW9mIGUuQ29sb3IzPyh0aGlzLnNpemU9MTIsdm9pZCh0aGlzLmRhdGFUeXBlPTUpKTp0IGluc3RhbmNlb2YgZS5Db2xvcjQ/KHRoaXMuc2l6ZT0xNix2b2lkKHRoaXMuZGF0YVR5cGU9NikpOnQgaW5zdGFuY2VvZiBlLlNpemU/KHRoaXMuc2l6ZT04LHZvaWQodGhpcy5kYXRhVHlwZT03KSk6dm9pZCAwfSx0LnByb3RvdHlwZS53cml0ZURhdGE9ZnVuY3Rpb24oZSx0LGkpe3N3aXRjaCh0aGlzLmRhdGFUeXBlKXtjYXNlIDA6dmFyIHI9aTtlW3QrMF09ci54LGVbdCsxXT1yLnk7YnJlYWs7Y2FzZSAxOnZhciByPWk7ZVt0KzBdPXIueCxlW3QrMV09ci55LGVbdCsyXT1yLno7YnJlYWs7Y2FzZSAyOnZhciByPWk7ZVt0KzBdPXIueCxlW3QrMV09ci55LGVbdCsyXT1yLnosZVt0KzNdPXIudzticmVhaztjYXNlIDU6dmFyIHI9aTtlW3QrMF09ci5yLGVbdCsxXT1yLmcsZVt0KzJdPXIuYjticmVhaztjYXNlIDY6dmFyIHI9aTtlW3QrMF09ci5yLGVbdCsxXT1yLmcsZVt0KzJdPXIuYixlW3QrM109ci5hO2JyZWFrO2Nhc2UgNDp2YXIgcj1pO2VbdF09cjticmVhaztjYXNlIDM6Zm9yKHZhciByPWksbj0wOzE2Pm47bisrKWVbdCtuXT1yLm1bbl07YnJlYWs7Y2FzZSA3OnZhciBvPWk7ZVt0KzBdPW8ud2lkdGgsZVt0KzFdPW8uaGVpZ2h0fX0sdH0oKTtlLkluc3RhbmNlUHJvcEluZm89cixlLmluc3RhbmNlRGF0YT10O3ZhciBuPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gaShlLHQpe3RoaXMuaWQ9ZSx0aGlzLmN1ckVsZW1lbnQ9MCx0aGlzLmRhdGFFbGVtZW50Q291bnQ9dH1yZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KGkucHJvdG90eXBlLFwiekJpYXNcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIG51bGx9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGkucHJvdG90eXBlLFwidHJhbnNmb3JtWFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJ0cmFuc2Zvcm1ZXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBudWxsfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLGkucHJvdG90eXBlLmdldENsYXNzVHJlZUluZm89ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50eXBlSW5mb3x8KHRoaXMudHlwZUluZm89ZS5DbGFzc1RyZWVJbmZvLmdldChPYmplY3QuZ2V0UHJvdG90eXBlT2YodGhpcykpKSx0aGlzLnR5cGVJbmZvfSxpLnByb3RvdHlwZS5hbGxvY0VsZW1lbnRzPWZ1bmN0aW9uKCl7aWYodGhpcy5kYXRhQnVmZmVyKXtmb3IodmFyIGU9bmV3IEFycmF5KHRoaXMuZGF0YUVsZW1lbnRDb3VudCksdD0wO3Q8dGhpcy5kYXRhRWxlbWVudENvdW50O3QrKyllW3RdPXRoaXMuZGF0YUJ1ZmZlci5hbGxvY0VsZW1lbnQoKTt0aGlzLmRhdGFFbGVtZW50cz1lfX0saS5wcm90b3R5cGUuZnJlZUVsZW1lbnRzPWZ1bmN0aW9uKCl7aWYodGhpcy5kYXRhRWxlbWVudHMpe2Zvcih2YXIgZT0wLHQ9dGhpcy5kYXRhRWxlbWVudHM7ZTx0Lmxlbmd0aDtlKyspe3ZhciBpPXRbZV07dGhpcy5kYXRhQnVmZmVyLmZyZWVFbGVtZW50KGkpfXRoaXMuZGF0YUVsZW1lbnRzPW51bGx9fSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJkYXRhRWxlbWVudENvdW50XCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9kYXRhRWxlbWVudENvdW50fSxzZXQ6ZnVuY3Rpb24oZSl7ZSE9PXRoaXMuX2RhdGFFbGVtZW50Q291bnQmJih0aGlzLmZyZWVFbGVtZW50cygpLHRoaXMuX2RhdGFFbGVtZW50Q291bnQ9ZSx0aGlzLmFsbG9jRWxlbWVudHMoKSl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksX19kZWNvcmF0ZShbdCgpXSxpLnByb3RvdHlwZSxcInpCaWFzXCIsbnVsbCksX19kZWNvcmF0ZShbdCgpXSxpLnByb3RvdHlwZSxcInRyYW5zZm9ybVhcIixudWxsKSxfX2RlY29yYXRlKFt0KCldLGkucHJvdG90eXBlLFwidHJhbnNmb3JtWVwiLG51bGwpLGl9KCk7ZS5JbnN0YW5jZURhdGFCYXNlPW47dmFyIG89ZnVuY3Rpb24odCl7ZnVuY3Rpb24gcihlKXt0LmNhbGwodGhpcyxlKSx0aGlzLl9pc1RyYW5zcGFyZW50PSExLHRoaXMuX2lzQWxwaGFUZXN0PSExLHRoaXMuX3RyYW5zcGFyZW50UHJpbWl0aXZlSW5mbz1udWxsfXJldHVybiBfX2V4dGVuZHMocix0KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoci5wcm90b3R5cGUsXCJpc0FscGhhVGVzdFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faXNBbHBoYVRlc3R9LHNldDpmdW5jdGlvbihlKXt0aGlzLl9pc0FscGhhVGVzdD1lfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLnByb3RvdHlwZSxcImlzVHJhbnNwYXJlbnRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lzVHJhbnNwYXJlbnR9LHNldDpmdW5jdGlvbihlKXt0aGlzLl9pc1RyYW5zcGFyZW50PWV9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksci5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3JldHVybiB0LnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyk/KHRoaXMuX3RyYW5zcGFyZW50UHJpbWl0aXZlSW5mbyYmKHRoaXMucmVuZGVyR3JvdXAuX3JlbmRlcmFibGVEYXRhLnJlbW92ZVRyYW5zcGFyZW50UHJpbWl0aXZlSW5mbyh0aGlzLl90cmFuc3BhcmVudFByaW1pdGl2ZUluZm8pLHRoaXMuX3RyYW5zcGFyZW50UHJpbWl0aXZlSW5mbz1udWxsKSx0aGlzLl9tb2RlbFJlbmRlckluc3RhbmNlSUQmJih0aGlzLl9tb2RlbFJlbmRlckNhY2hlLnJlbW92ZUluc3RhbmNlRGF0YSh0aGlzLl9tb2RlbFJlbmRlckluc3RhbmNlSUQpLHRoaXMuX21vZGVsUmVuZGVySW5zdGFuY2VJRD1udWxsKSx0aGlzLl9tb2RlbFJlbmRlckNhY2hlJiYodGhpcy5fbW9kZWxSZW5kZXJDYWNoZS5kaXNwb3NlKCksdGhpcy5fbW9kZWxSZW5kZXJDYWNoZT1udWxsKSx0aGlzLl9pbnN0YW5jZURhdGFQYXJ0cyYmKHRoaXMuX2luc3RhbmNlRGF0YVBhcnRzLmZvckVhY2goZnVuY3Rpb24oZSl7ZS5mcmVlRWxlbWVudHMoKX0pLHRoaXMuX2luc3RhbmNlRGF0YVBhcnRzPW51bGwpLCEwKTohMX0sci5wcm90b3R5cGUuX3ByZXBhcmVSZW5kZXJQcmU9ZnVuY3Rpb24oaSl7dC5wcm90b3R5cGUuX3ByZXBhcmVSZW5kZXJQcmUuY2FsbCh0aGlzLGkpLHRoaXMuX2lzRmxhZ1NldChlLlNtYXJ0UHJvcGVydHlQcmltLmZsYWdNb2RlbERpcnR5KSYmdGhpcy5fbW9kZWxSZW5kZXJJbnN0YW5jZUlEJiYodGhpcy5fbW9kZWxSZW5kZXJDYWNoZS5yZW1vdmVJbnN0YW5jZURhdGEodGhpcy5fbW9kZWxSZW5kZXJJbnN0YW5jZUlEKSx0aGlzLl9tb2RlbFJlbmRlckluc3RhbmNlSUQ9bnVsbCk7dmFyIHI9ITE7dGhpcy5fbW9kZWxSZW5kZXJDYWNoZSYmIXRoaXMuX2lzRmxhZ1NldChlLlNtYXJ0UHJvcGVydHlQcmltLmZsYWdNb2RlbERpcnR5KXx8KHI9dGhpcy5fY3JlYXRlTW9kZWxSZW5kZXJDYWNoZSgpKTt2YXIgbj1udWxsLG89ITE7dGhpcy5fbW9kZWxSZW5kZXJJbnN0YW5jZUlEfHwobz0hMCxuPXRoaXMuX2NyZWF0ZU1vZGVsRGF0YVBhcnRzKCkpLHImJnRoaXMuc2V0dXBNb2RlbFJlbmRlckNhY2hlKHRoaXMuX21vZGVsUmVuZGVyQ2FjaGUpLCh0aGlzLl9pc0ZsYWdTZXQoZS5TbWFydFByb3BlcnR5UHJpbS5mbGFnVmlzaWJpbGl0eUNoYW5nZWQpfHxpLmZvcmNlUmVmcmVzaFByaW1pdGl2ZXx8b3x8MCE9PXRoaXMuX2luc3RhbmNlRGlydHlGbGFnc3x8dGhpcy5fZ2xvYmFsVHJhbnNmb3JtUHJvY2Vzc1N0ZXAhPT10aGlzLl9nbG9iYWxUcmFuc2Zvcm1TdGVwKSYmKHRoaXMuaXNUcmFuc3BhcmVudCx0aGlzLl91cGRhdGVJbnN0YW5jZURhdGFQYXJ0cyhuKSl9LHIucHJvdG90eXBlLl9jcmVhdGVNb2RlbFJlbmRlckNhY2hlPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcyxpPSExO3JldHVybiB0aGlzLl9tb2RlbFJlbmRlckNhY2hlJiZ0aGlzLl9tb2RlbFJlbmRlckNhY2hlLmRpc3Bvc2UoKSx0aGlzLl9tb2RlbFJlbmRlckNhY2hlPXRoaXMub3duZXIuX2VuZ2luZURhdGEuR2V0T3JBZGRNb2RlbENhY2hlKHRoaXMubW9kZWxLZXksZnVuY3Rpb24oZSl7dmFyIHI9dC5jcmVhdGVNb2RlbFJlbmRlckNhY2hlKGUpO3JldHVybiBpPSEwLHJ9KSx0aGlzLl9jbGVhckZsYWdzKGUuU21hcnRQcm9wZXJ0eVByaW0uZmxhZ01vZGVsRGlydHkpLGl8fHRoaXMuX21vZGVsUmVuZGVyQ2FjaGUuYWRkUmVmKCksaX0sci5wcm90b3R5cGUuX2NyZWF0ZU1vZGVsRGF0YVBhcnRzPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcyxpPXRoaXMuY3JlYXRlSW5zdGFuY2VEYXRhUGFydHMoKTt0aGlzLl9pbnN0YW5jZURhdGFQYXJ0cz1pLHRoaXMuX21vZGVsUmVuZGVyQ2FjaGUuX3BhcnREYXRhfHx0aGlzLl9zZXR1cE1vZGVsUmVuZGVyQ2FjaGUoaSk7dmFyIHI9dGhpcy5yZW5kZXJHcm91cC5fcmVuZGVyYWJsZURhdGEuX3JlbmRlckdyb3VwSW5zdGFuY2VzSW5mby5nZXRPckFkZFdpdGhGYWN0b3J5KHRoaXMubW9kZWxLZXksZnVuY3Rpb24oaSl7Zm9yKHZhciByPW5ldyBlLkdyb3VwSW5zdGFuY2VJbmZvKHQucmVuZGVyR3JvdXAsdC5fbW9kZWxSZW5kZXJDYWNoZSx0Ll9tb2RlbFJlbmRlckNhY2hlLl9wYXJ0RGF0YS5sZW5ndGgpLG49MDtuPHQuX21vZGVsUmVuZGVyQ2FjaGUuX3BhcnREYXRhLmxlbmd0aDtuKyspe3ZhciBvPXQuX2luc3RhbmNlRGF0YVBhcnRzW25dO3IucGFydEluZGV4RnJvbUlkLmFkZChvLmlkLnRvU3RyaW5nKCksbiksci51c2VkU2hhZGVyQ2F0ZWdvcmllc1tuXT1cIjtcIit0LmdldFVzZWRTaGFkZXJDYXRlZ29yaWVzKG8pLmpvaW4oXCI7XCIpK1wiO1wiLHIuc3RyaWRlc1tuXT10Ll9tb2RlbFJlbmRlckNhY2hlLl9wYXJ0RGF0YVtuXS5fcGFydERhdGFTdHJpZGV9cmV0dXJuIHJ9KSxuPW51bGw7bj10aGlzLmlzVHJhbnNwYXJlbnQ/ci50cmFuc3BhcmVudERhdGE6dGhpcy5pc0FscGhhVGVzdD9yLmFscGhhVGVzdERhdGE6ci5vcGFxdWVEYXRhO2Zvcih2YXIgbz0wO288aS5sZW5ndGg7bysrKXt2YXIgcz1pW29dO3MuZGF0YUJ1ZmZlcj1uW29dLl9wYXJ0RGF0YSxzLmFsbG9jRWxlbWVudHMoKX1yZXR1cm4gdGhpcy5fbW9kZWxSZW5kZXJJbnN0YW5jZUlEPXRoaXMuX21vZGVsUmVuZGVyQ2FjaGUuYWRkSW5zdGFuY2VEYXRhUGFydHModGhpcy5faW5zdGFuY2VEYXRhUGFydHMpLHJ9LHIucHJvdG90eXBlLl9zZXR1cE1vZGVsUmVuZGVyQ2FjaGU9ZnVuY3Rpb24odCl7dmFyIHI9bmV3IEFycmF5O3RoaXMuX21vZGVsUmVuZGVyQ2FjaGUuX3BhcnREYXRhPW5ldyBBcnJheTtmb3IodmFyIG49MDtuPHQubGVuZ3RoO24rKyl7dmFyIG89dFtuXSxzPW5ldyBlLk1vZGVsUmVuZGVyQ2FjaGVQYXJ0RGF0YTt0aGlzLl9tb2RlbFJlbmRlckNhY2hlLl9wYXJ0RGF0YS5wdXNoKHMpO3ZhciBhPXRoaXMuZ2V0VXNlZFNoYWRlckNhdGVnb3JpZXMobyksaD1vLmdldENsYXNzVHJlZUluZm8oKSxjPXRoaXMuaXNWaXNpYmxlO3RoaXMuaXNWaXNpYmxlPSEwO3ZhciBsPVwiO1wiK2Euam9pbihcIjtcIikrXCI7XCI7cy5fcGFydEpvaW5lZFVzZWRDYXRlZ29yaWVzPWwsaS5fQ3VyQ2F0ZWdvcmllcz1sO3ZhciB1PXRoaXMuYmVmb3JlUmVmcmVzaEZvckxheW91dENvbnN0cnVjdGlvbihvKTt0aGlzLnJlZnJlc2hJbnN0YW5jZURhdGFQYXJ0KG8pLHRoaXMuYWZ0ZXJSZWZyZXNoRm9yTGF5b3V0Q29uc3RydWN0aW9uKG8sdSksdGhpcy5pc1Zpc2libGU9Yzt2YXIgZj0wO2guZnVsbENvbnRlbnQuZm9yRWFjaChmdW5jdGlvbih0LGkpe2kuY2F0ZWdvcnkmJi0xPT09YS5pbmRleE9mKGkuY2F0ZWdvcnkpfHwoXCJ6Qmlhc1wiPT09aS5hdHRyaWJ1dGVOYW1lJiYocy5fekJpYXNPZmZzZXQ9aS5pbnN0YW5jZU9mZnNldC5nZXQobCkpLGkuc2l6ZT9mKz1pLnNpemU6Y29uc29sZS5sb2coXCJFUlJPUjogQ291bGRuJ3QgZGV0ZWN0IHRoZSBzaXplIG9mIHRoZSBQcm9wZXJ0eSBcIitpLmF0dHJpYnV0ZU5hbWUrXCIgZnJvbSB0eXBlIFwiK2UuVG9vbHMuZ2V0Q2xhc3NOYW1lKGgudHlwZSkrXCIuIFByb3BlcnR5IGlzIGlnbm9yZWQuXCIpKX0pLHMuX3BhcnREYXRhU3RyaWRlPWYscy5fcGFydFVzZWRDYXRlZ29yaWVzPWEscy5fcGFydElkPW8uaWQsci5wdXNoKGgpfXRoaXMuX21vZGVsUmVuZGVyQ2FjaGUuX3BhcnRzQ2xhc3NJbmZvPXJ9LHIucHJvdG90eXBlLm9uWk9yZGVyQ2hhbmdlZD1mdW5jdGlvbigpe2lmKHRoaXMuaXNUcmFuc3BhcmVudCYmdGhpcy5fdHJhbnNwYXJlbnRQcmltaXRpdmVJbmZvKXt0aGlzLnJlbmRlckdyb3VwLl9yZW5kZXJhYmxlRGF0YS50cmFuc3BhcmVudFByaW1pdGl2ZVpDaGFuZ2VkKHRoaXMuX3RyYW5zcGFyZW50UHJpbWl0aXZlSW5mbyk7dmFyIGU9dGhpcy5yZW5kZXJHcm91cC5fcmVuZGVyYWJsZURhdGEuX3JlbmRlckdyb3VwSW5zdGFuY2VzSW5mby5nZXQodGhpcy5tb2RlbEtleSk7ZS50cmFuc3BhcmVudE9yZGVyRGlydHk9ITB9fSxyLnByb3RvdHlwZS5fdXBkYXRlSW5zdGFuY2VEYXRhUGFydHM9ZnVuY3Rpb24odCl7dHx8KHQ9dGhpcy5yZW5kZXJHcm91cC5fcmVuZGVyYWJsZURhdGEuX3JlbmRlckdyb3VwSW5zdGFuY2VzSW5mby5nZXQodGhpcy5tb2RlbEtleSkpLHRoaXMuaXNUcmFuc3BhcmVudCYmdGhpcy5faXNGbGFnU2V0KGUuU21hcnRQcm9wZXJ0eVByaW0uZmxhZ1Zpc2liaWxpdHlDaGFuZ2VkKSYmKHRoaXMuaXNWaXNpYmxlP3RoaXMuX3RyYW5zcGFyZW50UHJpbWl0aXZlSW5mb3x8KHRoaXMuX3RyYW5zcGFyZW50UHJpbWl0aXZlSW5mbz10aGlzLnJlbmRlckdyb3VwLl9yZW5kZXJhYmxlRGF0YS5hZGROZXdUcmFuc3BhcmVudFByaW1pdGl2ZUluZm8odGhpcyx0KSk6dGhpcy5fdHJhbnNwYXJlbnRQcmltaXRpdmVJbmZvJiYodGhpcy5yZW5kZXJHcm91cC5fcmVuZGVyYWJsZURhdGEucmVtb3ZlVHJhbnNwYXJlbnRQcmltaXRpdmVJbmZvKHRoaXMuX3RyYW5zcGFyZW50UHJpbWl0aXZlSW5mbyksdGhpcy5fdHJhbnNwYXJlbnRQcmltaXRpdmVJbmZvPW51bGwpLHQudHJhbnNwYXJlbnRPcmRlckRpcnR5PSEwKTtmb3IodmFyIHI9MCxuPXRoaXMuX2luc3RhbmNlRGF0YVBhcnRzO3I8bi5sZW5ndGg7cisrKXt2YXIgbz1uW3JdO3RoaXMuX2lzRmxhZ1NldChlLlNtYXJ0UHJvcGVydHlQcmltLmZsYWdWaXNpYmlsaXR5Q2hhbmdlZCkmJiFvLmRhdGFFbGVtZW50cyYmby5hbGxvY0VsZW1lbnRzKCksaS5fQ3VyQ2F0ZWdvcmllcz10LnVzZWRTaGFkZXJDYXRlZ29yaWVzW3QucGFydEluZGV4RnJvbUlkLmdldChvLmlkLnRvU3RyaW5nKCkpXSx0aGlzLnJlZnJlc2hJbnN0YW5jZURhdGFQYXJ0KG8pfHxvLmRhdGFFbGVtZW50cyYmby5mcmVlRWxlbWVudHMoKX10aGlzLl9pbnN0YW5jZURpcnR5RmxhZ3M9MCx0aGlzLmlzVHJhbnNwYXJlbnQ/dC50cmFuc3BhcmVudERpcnR5PSEwOnRoaXMuaXNBbHBoYVRlc3Q/dC5hbHBoYVRlc3REaXJ0eT0hMDp0Lm9wYXF1ZURpcnR5PSEwLHRoaXMuX2NsZWFyRmxhZ3MoZS5TbWFydFByb3BlcnR5UHJpbS5mbGFnVmlzaWJpbGl0eUNoYW5nZWQpfSxyLnByb3RvdHlwZS5fZ2V0Rmlyc3RJbmRleEluRGF0YUJ1ZmZlcj1mdW5jdGlvbigpe2Zvcih2YXIgZT0wLHQ9dGhpcy5faW5zdGFuY2VEYXRhUGFydHM7ZTx0Lmxlbmd0aDtlKyspe3ZhciBpPXRbZV07aWYoaSlyZXR1cm4gaS5kYXRhRWxlbWVudHNbMF0ub2Zmc2V0L2kuZGF0YUJ1ZmZlci5zdHJpZGV9cmV0dXJuIG51bGx9LHIucHJvdG90eXBlLl9nZXRMYXN0SW5kZXhJbkRhdGFCdWZmZXI9ZnVuY3Rpb24oKXtmb3IodmFyIGU9MCx0PXRoaXMuX2luc3RhbmNlRGF0YVBhcnRzO2U8dC5sZW5ndGg7ZSsrKXt2YXIgaT10W2VdO2lmKGkpcmV0dXJuIGkuZGF0YUVsZW1lbnRzW2kuZGF0YUVsZW1lbnRzLmxlbmd0aC0xXS5vZmZzZXQvaS5kYXRhQnVmZmVyLnN0cmlkZX1yZXR1cm4gbnVsbH0sci5wcm90b3R5cGUuX2dldE5leHRQcmltWk9yZGVyPWZ1bmN0aW9uKCl7Zm9yKHZhciBlPXRoaXMuX2luc3RhbmNlRGF0YVBhcnRzLmxlbmd0aCx0PTA7ZT50O3QrKyl7dmFyIGk9dGhpcy5faW5zdGFuY2VEYXRhUGFydHNbdF07aWYoaSl7dmFyIHI9aS5kYXRhQnVmZmVyLnN0cmlkZSxuPWkuZGF0YUVsZW1lbnRzW2kuZGF0YUVsZW1lbnRzLmxlbmd0aC0xXS5vZmZzZXQ7cmV0dXJuIGkuZGF0YUJ1ZmZlci50b3RhbEVsZW1lbnRDb3VudCpyPD1uP251bGw6aS5kYXRhQnVmZmVyW24rcit0aGlzLm1vZGVsUmVuZGVyQ2FjaGUuX3BhcnREYXRhW3RdLl96Qmlhc09mZnNldF19fXJldHVybiBudWxsfSxyLnByb3RvdHlwZS5fZ2V0UHJldlByaW1aT3JkZXI9ZnVuY3Rpb24oKXtmb3IodmFyIGU9dGhpcy5faW5zdGFuY2VEYXRhUGFydHMubGVuZ3RoLHQ9MDtlPnQ7dCsrKXt2YXIgaT10aGlzLl9pbnN0YW5jZURhdGFQYXJ0c1t0XTtpZihpKXt2YXIgcj1pLmRhdGFCdWZmZXIuc3RyaWRlLG49aS5kYXRhRWxlbWVudHNbMF0ub2Zmc2V0O3JldHVybiAwPT09bj9udWxsOmkuZGF0YUJ1ZmZlcltuLXIrdGhpcy5tb2RlbFJlbmRlckNhY2hlLl9wYXJ0RGF0YVt0XS5fekJpYXNPZmZzZXRdfX1yZXR1cm4gbnVsbH0sci5wcm90b3R5cGUudHJhbnNmb3JtUG9pbnRXaXRoT3JpZ2luQnlSZWY9ZnVuY3Rpb24oZSx0LGkpe3ZhciByPXRoaXMuYWN0dWFsU2l6ZTtpLng9ZS54LSh0aGlzLm9yaWdpbi54Kyh0P3QueDowKSkqci53aWR0aCxpLnk9ZS55LSh0aGlzLm9yaWdpbi55Kyh0P3QueTowKSkqci5oZWlnaHR9LHIucHJvdG90eXBlLnRyYW5zZm9ybVBvaW50V2l0aE9yaWdpblRvUmVmPWZ1bmN0aW9uKGUsdCxpKXtyZXR1cm4gdGhpcy50cmFuc2Zvcm1Qb2ludFdpdGhPcmlnaW5CeVJlZihlLHQsaSksaX0sci5wcm90b3R5cGUuZ2V0RGF0YVBhcnRFZmZlY3RJbmZvPWZ1bmN0aW9uKHQsaSxyKXt2b2lkIDA9PT1yJiYocj1udWxsKTt2YXIgbj1lLlRvb2xzLmZpcnN0KHRoaXMuX2luc3RhbmNlRGF0YVBhcnRzLGZ1bmN0aW9uKGUpe3JldHVybiBlLmlkPT09dH0pO2lmKCFuKXJldHVybiBudWxsO3ZhciBvPXRoaXMub3duZXIuc3VwcG9ydEluc3RhbmNlZEFycmF5O2lmKG51bGwhPXIpe2lmKHImJm89PT0hMSlyZXR1cm4gbnVsbDtvPXJ9dmFyIHM9bi5nZXRDbGFzc1RyZWVJbmZvKCksYT10aGlzLmdldFVzZWRTaGFkZXJDYXRlZ29yaWVzKG4pLGg9cy5jbGFzc0NvbnRlbnQuZ2V0U2hhZGVyQXR0cmlidXRlcyhhKSxjPVwiXCI7cmV0dXJuIGEuZm9yRWFjaChmdW5jdGlvbihlKXtjKz1cIiNkZWZpbmUgXCIrZStcIlxcblwifSksbyYmKGMrPVwiI2RlZmluZSBJbnN0YW5jZWRcXG5cIikse2F0dHJpYnV0ZXM6bz9pLmNvbmNhdChoKTppLHVuaWZvcm1zOm8/W106aCxkZWZpbmVzOmN9fSxPYmplY3QuZGVmaW5lUHJvcGVydHkoci5wcm90b3R5cGUsXCJtb2RlbFJlbmRlckNhY2hlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9tb2RlbFJlbmRlckNhY2hlfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLHIucHJvdG90eXBlLmNyZWF0ZU1vZGVsUmVuZGVyQ2FjaGU9ZnVuY3Rpb24oZSl7cmV0dXJuIG51bGx9LHIucHJvdG90eXBlLnNldHVwTW9kZWxSZW5kZXJDYWNoZT1mdW5jdGlvbihlKXt9LHIucHJvdG90eXBlLmNyZWF0ZUluc3RhbmNlRGF0YVBhcnRzPWZ1bmN0aW9uKCl7cmV0dXJuIG51bGx9LHIucHJvdG90eXBlLmdldFVzZWRTaGFkZXJDYXRlZ29yaWVzPWZ1bmN0aW9uKGUpe3JldHVybltdfSxyLnByb3RvdHlwZS5iZWZvcmVSZWZyZXNoRm9yTGF5b3V0Q29uc3RydWN0aW9uPWZ1bmN0aW9uKGUpe30sci5wcm90b3R5cGUuYWZ0ZXJSZWZyZXNoRm9yTGF5b3V0Q29uc3RydWN0aW9uPWZ1bmN0aW9uKGUsdCl7fSxyLnByb3RvdHlwZS5yZWZyZXNoSW5zdGFuY2VEYXRhUGFydD1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5pc1Zpc2libGU/KGUuaXNWaXNpYmxlPXRoaXMuaXNWaXNpYmxlLDE9PT1lLmRhdGFFbGVtZW50Q291bnQmJihlLmN1ckVsZW1lbnQ9MCx0aGlzLnVwZGF0ZUluc3RhbmNlRGF0YVBhcnQoZSkpLCEwKTohMX0sci5wcm90b3R5cGUudXBkYXRlSW5zdGFuY2VEYXRhUGFydD1mdW5jdGlvbih0LGkpe3ZvaWQgMD09PWkmJihpPW51bGwpO3ZhciByPXRoaXMuX2dsb2JhbFRyYW5zZm9ybS5tdWx0aXBseSh0aGlzLnJlbmRlckdyb3VwLmludkdsb2JhbFRyYW5zZm9ybSksbj10aGlzLnJlbmRlckdyb3VwLnZpZXdwb3J0U2l6ZSxvPXRoaXMuYWN0dWFsWk9mZnNldCxzPTAsYT0wO2kmJihzPWkueCpyLm1bMF0raS55KnIubVs0XSxhPWkueCpyLm1bMV0raS55KnIubVs1XSk7dmFyIGg9bi53aWR0aCxjPW4uaGVpZ2h0LGw9MS9vLHU9bmV3IGUuVmVjdG9yNCgyKnIubVswXS9oLDIqci5tWzRdL2gsMCwyKihyLm1bMTJdK3MpL2gtMSksZj1uZXcgZS5WZWN0b3I0KDIqci5tWzFdL2MsMipyLm1bNV0vYywwLDIqKHIubVsxM10rYSkvYy0xKTt0LnRyYW5zZm9ybVg9dSx0LnRyYW5zZm9ybVk9Zix0LnpCaWFzPW5ldyBlLlZlY3RvcjIobyxsKX0sci5SRU5ERVJBQkxFUFJJTTJEX1BST1BDT1VOVD1lLlByaW0yREJhc2UuUFJJTTJEQkFTRV9QUk9QQ09VTlQrNSxfX2RlY29yYXRlKFtlLmR5bmFtaWNMZXZlbFByb3BlcnR5KGUuUHJpbTJEQmFzZS5QUklNMkRCQVNFX1BST1BDT1VOVCswLGZ1bmN0aW9uKGUpe3JldHVybiByLmlzQWxwaGFUZXN0UHJvcGVydHk9ZX0pXSxyLnByb3RvdHlwZSxcImlzQWxwaGFUZXN0XCIsbnVsbCksX19kZWNvcmF0ZShbZS5keW5hbWljTGV2ZWxQcm9wZXJ0eShlLlByaW0yREJhc2UuUFJJTTJEQkFTRV9QUk9QQ09VTlQrMSxmdW5jdGlvbihlKXtyZXR1cm4gci5pc1RyYW5zcGFyZW50UHJvcGVydHk9ZX0pXSxyLnByb3RvdHlwZSxcImlzVHJhbnNwYXJlbnRcIixudWxsKSxyPV9fZGVjb3JhdGUoW2UuY2xhc3NOYW1lKFwiUmVuZGVyYWJsZVByaW0yRFwiKV0scil9KGUuUHJpbTJEQmFzZSk7ZS5SZW5kZXJhYmxlUHJpbTJEPW99KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGkoaSl7dC5jYWxsKHRoaXMsaSksaXx8KGk9e30pO3ZhciByPW51bGw7aS5ib3JkZXImJihyPVwic3RyaW5nXCI9PXR5cGVvZiBpLmJvcmRlcj9lLkNhbnZhczJELkdldEJydXNoRnJvbVN0cmluZyhpLmJvcmRlcik6aS5ib3JkZXIpO3ZhciBuPW51bGw7aS5maWxsJiYobj1cInN0cmluZ1wiPT10eXBlb2YgaS5maWxsP2UuQ2FudmFzMkQuR2V0QnJ1c2hGcm9tU3RyaW5nKGkuZmlsbCk6aS5maWxsKSx0aGlzLmJvcmRlcj1yLHRoaXMuZmlsbD1uLHRoaXMuYm9yZGVyVGhpY2tuZXNzPWkuYm9yZGVyVGhpY2tuZXNzfXJldHVybiBfX2V4dGVuZHMoaSx0KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJib3JkZXJcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2JvcmRlcn0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX2JvcmRlcj1lLHRoaXMuX3VwZGF0ZVRyYW5zcGFyZW5jeVN0YXR1cygpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcImZpbGxcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2ZpbGx9LHNldDpmdW5jdGlvbihlKXt0aGlzLl9maWxsPWUsdGhpcy5fdXBkYXRlVHJhbnNwYXJlbmN5U3RhdHVzKCl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGkucHJvdG90eXBlLFwiYm9yZGVyVGhpY2tuZXNzXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9ib3JkZXJUaGlja25lc3N9LHNldDpmdW5jdGlvbihlKXt0aGlzLl9ib3JkZXJUaGlja25lc3M9ZX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxpLnByb3RvdHlwZS5nZXRVc2VkU2hhZGVyQ2F0ZWdvcmllcz1mdW5jdGlvbihyKXt2YXIgbj10LnByb3RvdHlwZS5nZXRVc2VkU2hhZGVyQ2F0ZWdvcmllcy5jYWxsKHRoaXMscik7aWYoci5pZD09PWkuU0hBUEUyRF9GSUxMUEFSVElEKXt2YXIgbz10aGlzLmZpbGw7byBpbnN0YW5jZW9mIGUuU29saWRDb2xvckJydXNoMkQmJm4ucHVzaChpLlNIQVBFMkRfQ0FURUdPUllfRklMTFNPTElEKSxvIGluc3RhbmNlb2YgZS5HcmFkaWVudENvbG9yQnJ1c2gyRCYmbi5wdXNoKGkuU0hBUEUyRF9DQVRFR09SWV9GSUxMR1JBRElFTlQpfWlmKHIuaWQ9PT1pLlNIQVBFMkRfQk9SREVSUEFSVElEKXtuLnB1c2goaS5TSEFQRTJEX0NBVEVHT1JZX0JPUkRFUik7dmFyIHM9dGhpcy5ib3JkZXI7cyBpbnN0YW5jZW9mIGUuU29saWRDb2xvckJydXNoMkQmJm4ucHVzaChpLlNIQVBFMkRfQ0FURUdPUllfQk9SREVSU09MSUQpLHMgaW5zdGFuY2VvZiBlLkdyYWRpZW50Q29sb3JCcnVzaDJEJiZuLnB1c2goaS5TSEFQRTJEX0NBVEVHT1JZX0JPUkRFUkdSQURJRU5UKX1yZXR1cm4gbn0saS5wcm90b3R5cGUucmVmcmVzaEluc3RhbmNlRGF0YVBhcnQ9ZnVuY3Rpb24ocil7aWYoIXQucHJvdG90eXBlLnJlZnJlc2hJbnN0YW5jZURhdGFQYXJ0LmNhbGwodGhpcyxyKSlyZXR1cm4hMTtpZihyLmlkPT09aS5TSEFQRTJEX0ZJTExQQVJUSUQpe3ZhciBuPXI7aWYodGhpcy5maWxsKXt2YXIgbz10aGlzLmZpbGw7aWYobyBpbnN0YW5jZW9mIGUuU29saWRDb2xvckJydXNoMkQpbi5maWxsU29saWRDb2xvcj1vLmNvbG9yO2Vsc2UgaWYobyBpbnN0YW5jZW9mIGUuR3JhZGllbnRDb2xvckJydXNoMkQpe24uZmlsbEdyYWRpZW50Q29sb3IxPW8uY29sb3IxLG4uZmlsbEdyYWRpZW50Q29sb3IyPW8uY29sb3IyO3ZhciBzPWUuTWF0cml4LkNvbXBvc2UobmV3IGUuVmVjdG9yMyhvLnNjYWxlLG8uc2NhbGUsby5zY2FsZSksZS5RdWF0ZXJuaW9uLlJvdGF0aW9uQXhpcyhuZXcgZS5WZWN0b3IzKDAsMCwxKSxvLnJvdGF0aW9uKSxuZXcgZS5WZWN0b3IzKG8udHJhbnNsYXRpb24ueCxvLnRyYW5zbGF0aW9uLnksMCkpLGE9bmV3IGUuVmVjdG9yNChzLm1bMV0scy5tWzVdLHMubVs5XSxzLm1bMTNdKTtuLmZpbGxHcmFkaWVudFRZPWF9fX1lbHNlIGlmKHIuaWQ9PT1pLlNIQVBFMkRfQk9SREVSUEFSVElEKXt2YXIgbj1yO2lmKHRoaXMuYm9yZGVyKXtuLmJvcmRlclRoaWNrbmVzcz10aGlzLmJvcmRlclRoaWNrbmVzczt2YXIgaD10aGlzLmJvcmRlcjtpZihoIGluc3RhbmNlb2YgZS5Tb2xpZENvbG9yQnJ1c2gyRCluLmJvcmRlclNvbGlkQ29sb3I9aC5jb2xvcjtlbHNlIGlmKGggaW5zdGFuY2VvZiBlLkdyYWRpZW50Q29sb3JCcnVzaDJEKXtuLmJvcmRlckdyYWRpZW50Q29sb3IxPWguY29sb3IxLG4uYm9yZGVyR3JhZGllbnRDb2xvcjI9aC5jb2xvcjI7dmFyIHM9ZS5NYXRyaXguQ29tcG9zZShuZXcgZS5WZWN0b3IzKGguc2NhbGUsaC5zY2FsZSxoLnNjYWxlKSxlLlF1YXRlcm5pb24uUm90YXRpb25BeGlzKG5ldyBlLlZlY3RvcjMoMCwwLDEpLGgucm90YXRpb24pLG5ldyBlLlZlY3RvcjMoaC50cmFuc2xhdGlvbi54LGgudHJhbnNsYXRpb24ueSwwKSksYT1uZXcgZS5WZWN0b3I0KHMubVsxXSxzLm1bNV0scy5tWzldLHMubVsxM10pO24uYm9yZGVyR3JhZGllbnRUWT1hfX19cmV0dXJuITB9LGkucHJvdG90eXBlLl91cGRhdGVUcmFuc3BhcmVuY3lTdGF0dXM9ZnVuY3Rpb24oKXt0aGlzLmlzVHJhbnNwYXJlbnQ9dGhpcy5fYm9yZGVyJiZ0aGlzLl9ib3JkZXIuaXNUcmFuc3BhcmVudCgpfHx0aGlzLl9maWxsJiZ0aGlzLl9maWxsLmlzVHJhbnNwYXJlbnQoKX0saS5TSEFQRTJEX0JPUkRFUlBBUlRJRD0xLGkuU0hBUEUyRF9GSUxMUEFSVElEPTIsaS5TSEFQRTJEX0NBVEVHT1JZX0JPUkRFUj1cIkJvcmRlclwiLGkuU0hBUEUyRF9DQVRFR09SWV9CT1JERVJTT0xJRD1cIkJvcmRlclNvbGlkXCIsaS5TSEFQRTJEX0NBVEVHT1JZX0JPUkRFUkdSQURJRU5UPVwiQm9yZGVyR3JhZGllbnRcIixpLlNIQVBFMkRfQ0FURUdPUllfRklMTFNPTElEPVwiRmlsbFNvbGlkXCIsXG5pLlNIQVBFMkRfQ0FURUdPUllfRklMTEdSQURJRU5UPVwiRmlsbEdyYWRpZW50XCIsaS5TSEFQRTJEX1BST1BDT1VOVD1lLlJlbmRlcmFibGVQcmltMkQuUkVOREVSQUJMRVBSSU0yRF9QUk9QQ09VTlQrNSxfX2RlY29yYXRlKFtlLm1vZGVsTGV2ZWxQcm9wZXJ0eShlLlJlbmRlcmFibGVQcmltMkQuUkVOREVSQUJMRVBSSU0yRF9QUk9QQ09VTlQrMSxmdW5jdGlvbihlKXtyZXR1cm4gaS5ib3JkZXJQcm9wZXJ0eT1lfSwhMCldLGkucHJvdG90eXBlLFwiYm9yZGVyXCIsbnVsbCksX19kZWNvcmF0ZShbZS5tb2RlbExldmVsUHJvcGVydHkoZS5SZW5kZXJhYmxlUHJpbTJELlJFTkRFUkFCTEVQUklNMkRfUFJPUENPVU5UKzIsZnVuY3Rpb24oZSl7cmV0dXJuIGkuZmlsbFByb3BlcnR5PWV9LCEwKV0saS5wcm90b3R5cGUsXCJmaWxsXCIsbnVsbCksX19kZWNvcmF0ZShbZS5pbnN0YW5jZUxldmVsUHJvcGVydHkoZS5SZW5kZXJhYmxlUHJpbTJELlJFTkRFUkFCTEVQUklNMkRfUFJPUENPVU5UKzMsZnVuY3Rpb24oZSl7cmV0dXJuIGkuYm9yZGVyVGhpY2tuZXNzUHJvcGVydHk9ZX0pXSxpLnByb3RvdHlwZSxcImJvcmRlclRoaWNrbmVzc1wiLG51bGwpLGk9X19kZWNvcmF0ZShbZS5jbGFzc05hbWUoXCJTaGFwZTJEXCIpXSxpKX0oZS5SZW5kZXJhYmxlUHJpbTJEKTtlLlNoYXBlMkQ9dDt2YXIgaT1mdW5jdGlvbihpKXtmdW5jdGlvbiByKCl7aS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9cmV0dXJuIF9fZXh0ZW5kcyhyLGkpLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLnByb3RvdHlwZSxcImZpbGxTb2xpZENvbG9yXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBudWxsfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLnByb3RvdHlwZSxcImZpbGxHcmFkaWVudENvbG9yMVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoci5wcm90b3R5cGUsXCJmaWxsR3JhZGllbnRDb2xvcjJcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIG51bGx9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHIucHJvdG90eXBlLFwiZmlsbEdyYWRpZW50VFlcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIG51bGx9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHIucHJvdG90eXBlLFwiYm9yZGVyVGhpY2tuZXNzXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBudWxsfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLnByb3RvdHlwZSxcImJvcmRlclNvbGlkQ29sb3JcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIG51bGx9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHIucHJvdG90eXBlLFwiYm9yZGVyR3JhZGllbnRDb2xvcjFcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIG51bGx9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHIucHJvdG90eXBlLFwiYm9yZGVyR3JhZGllbnRDb2xvcjJcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIG51bGx9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHIucHJvdG90eXBlLFwiYm9yZGVyR3JhZGllbnRUWVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxfX2RlY29yYXRlKFtlLmluc3RhbmNlRGF0YSh0LlNIQVBFMkRfQ0FURUdPUllfRklMTFNPTElEKV0sci5wcm90b3R5cGUsXCJmaWxsU29saWRDb2xvclwiLG51bGwpLF9fZGVjb3JhdGUoW2UuaW5zdGFuY2VEYXRhKHQuU0hBUEUyRF9DQVRFR09SWV9GSUxMR1JBRElFTlQpXSxyLnByb3RvdHlwZSxcImZpbGxHcmFkaWVudENvbG9yMVwiLG51bGwpLF9fZGVjb3JhdGUoW2UuaW5zdGFuY2VEYXRhKHQuU0hBUEUyRF9DQVRFR09SWV9GSUxMR1JBRElFTlQpXSxyLnByb3RvdHlwZSxcImZpbGxHcmFkaWVudENvbG9yMlwiLG51bGwpLF9fZGVjb3JhdGUoW2UuaW5zdGFuY2VEYXRhKHQuU0hBUEUyRF9DQVRFR09SWV9GSUxMR1JBRElFTlQpXSxyLnByb3RvdHlwZSxcImZpbGxHcmFkaWVudFRZXCIsbnVsbCksX19kZWNvcmF0ZShbZS5pbnN0YW5jZURhdGEodC5TSEFQRTJEX0NBVEVHT1JZX0JPUkRFUildLHIucHJvdG90eXBlLFwiYm9yZGVyVGhpY2tuZXNzXCIsbnVsbCksX19kZWNvcmF0ZShbZS5pbnN0YW5jZURhdGEodC5TSEFQRTJEX0NBVEVHT1JZX0JPUkRFUlNPTElEKV0sci5wcm90b3R5cGUsXCJib3JkZXJTb2xpZENvbG9yXCIsbnVsbCksX19kZWNvcmF0ZShbZS5pbnN0YW5jZURhdGEodC5TSEFQRTJEX0NBVEVHT1JZX0JPUkRFUkdSQURJRU5UKV0sci5wcm90b3R5cGUsXCJib3JkZXJHcmFkaWVudENvbG9yMVwiLG51bGwpLF9fZGVjb3JhdGUoW2UuaW5zdGFuY2VEYXRhKHQuU0hBUEUyRF9DQVRFR09SWV9CT1JERVJHUkFESUVOVCldLHIucHJvdG90eXBlLFwiYm9yZGVyR3JhZGllbnRDb2xvcjJcIixudWxsKSxfX2RlY29yYXRlKFtlLmluc3RhbmNlRGF0YSh0LlNIQVBFMkRfQ0FURUdPUllfQk9SREVSR1JBRElFTlQpXSxyLnByb3RvdHlwZSxcImJvcmRlckdyYWRpZW50VFlcIixudWxsKSxyfShlLkluc3RhbmNlRGF0YUJhc2UpO2UuU2hhcGUyREluc3RhbmNlRGF0YT1pfShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbih0KXtmdW5jdGlvbiByKGkpe251bGw9PWkmJihpPXt9KSxudWxsPT1pLm9yaWdpbiYmKGkub3JpZ2luPW5ldyBlLlZlY3RvcjIoMCwwKSksdC5jYWxsKHRoaXMsaSk7dmFyIG49aS5zaXplfHxpLndpZHRofHxpLmhlaWdodD9pLnNpemV8fG5ldyBlLlNpemUoaS53aWR0aHx8MCxpLmhlaWdodHx8MCk6bnVsbDt0aGlzLl90cmFja2VkTm9kZT1udWxsPT1pLnRyYWNrTm9kZT9udWxsOmkudHJhY2tOb2RlLHRoaXMuX3RyYWNrZWROb2RlJiZ0aGlzLm93bmVyJiZ0aGlzLm93bmVyLl9yZWdpc3RlclRyYWNrZWROb2RlKHRoaXMpLHRoaXMuX2NhY2hlQmVoYXZpb3I9bnVsbD09aS5jYWNoZUJlaGF2aW9yP3IuR1JPVVBDQUNIRUJFSEFWSU9SX0ZPTExPV0NBQ0hFU1RSQVRFR1k6aS5jYWNoZUJlaGF2aW9yLHRoaXMuc2l6ZT1uLHRoaXMuX3ZpZXdwb3J0UG9zaXRpb249ZS5WZWN0b3IyLlplcm8oKX1yZXR1cm4gX19leHRlbmRzKHIsdCksci5fY3JlYXRlQ2FjaGVkQ2FudmFzR3JvdXA9ZnVuY3Rpb24odCl7dmFyIGk9bmV3IHIoe3BhcmVudDp0LGlkOlwiX19jYWNoZWRDYW52YXNHcm91cF9fXCIscG9zaXRpb246ZS5WZWN0b3IyLlplcm8oKSxvcmlnaW46ZS5WZWN0b3IyLlplcm8oKSxzaXplOm51bGwsaXNWaXNpYmxlOiEwfSk7cmV0dXJuIGl9LHIucHJvdG90eXBlLmFwcGx5Q2FjaGVkVGV4dHVyZT1mdW5jdGlvbih0LGkpe2lmKHRoaXMuX2JpbmRDYWNoZVRhcmdldCgpLHQpZm9yKHZhciByPXQudXZzLG49dGhpcy5fcmVuZGVyYWJsZURhdGEuX2NhY2hlTm9kZS5VVnMsbz0wOzQ+bztvKyspclsyKm8rMF09bltvXS54LHJbMipvKzFdPW5bb10ueTtpJiYoaS5kaWZmdXNlVGV4dHVyZT10aGlzLl9yZW5kZXJhYmxlRGF0YS5fY2FjaGVUZXh0dXJlLGkuZW1pc3NpdmVDb2xvcj1uZXcgZS5Db2xvcjMoMSwxLDEpKSx0aGlzLl9yZW5kZXJhYmxlRGF0YS5fY2FjaGVUZXh0dXJlLmhhc0FscGhhPSEwLHRoaXMuX3VuYmluZENhY2hlVGFyZ2V0KCl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLnByb3RvdHlwZSxcImNhY2hlZFJlY3RcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3JlbmRlcmFibGVEYXRhP3RoaXMuX3JlbmRlcmFibGVEYXRhLl9jYWNoZU5vZGU6bnVsbH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoci5wcm90b3R5cGUsXCJjYWNoZVRleHR1cmVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3JlbmRlcmFibGVEYXRhP3RoaXMuX3JlbmRlcmFibGVEYXRhLl9jYWNoZVRleHR1cmU6bnVsbH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxyLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHQucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKT8obnVsbCE9dGhpcy5fdHJhY2tlZE5vZGUmJih0aGlzLm93bmVyLl91bnJlZ2lzdGVyVHJhY2tlZE5vZGUodGhpcyksdGhpcy5fdHJhY2tlZE5vZGU9bnVsbCksdGhpcy5fcmVuZGVyYWJsZURhdGEmJih0aGlzLl9yZW5kZXJhYmxlRGF0YS5kaXNwb3NlKCksdGhpcy5fcmVuZGVyYWJsZURhdGE9bnVsbCksITApOiExfSxPYmplY3QuZGVmaW5lUHJvcGVydHkoci5wcm90b3R5cGUsXCJpc1JlbmRlcmFibGVHcm91cFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faXNSZW5kZXJhYmxlR3JvdXB9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHIucHJvdG90eXBlLFwiaXNDYWNoZWRHcm91cFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faXNDYWNoZWRHcm91cH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoci5wcm90b3R5cGUsXCJzaXplXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9zaXplfSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fc2l6ZT1lfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLnByb3RvdHlwZSxcInZpZXdwb3J0U2l6ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fdmlld3BvcnRTaXplfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLnByb3RvdHlwZSxcImFjdHVhbFNpemVcIix7Z2V0OmZ1bmN0aW9uKCl7dmFyIHQ7aWYodGhpcy5fc2l6ZSl0PW5ldyBlLlNpemUoTWF0aC5jZWlsKHRoaXMuX3NpemUud2lkdGgpLE1hdGguY2VpbCh0aGlzLl9zaXplLmhlaWdodCkpO2Vsc2V7dmFyIGk9dGhpcy5ib3VuZGluZ0luZm8ubWF4KCk7dD1uZXcgZS5TaXplKE1hdGguY2VpbChpLngpLE1hdGguY2VpbChpLnkpKX1yZXR1cm4gdC5lcXVhbHModGhpcy5fYWN0dWFsU2l6ZSl8fCh0aGlzLm9uUHJpbWl0aXZlUHJvcGVydHlEaXJ0eShyLmFjdHVhbFNpemVQcm9wZXJ0eS5mbGFnSWQpLHRoaXMuX2FjdHVhbFNpemU9dCx0aGlzLmhhbmRsZUdyb3VwQ2hhbmdlZChyLmFjdHVhbFNpemVQcm9wZXJ0eSkpLHR9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHIucHJvdG90eXBlLFwiY2FjaGVCZWhhdmlvclwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fY2FjaGVCZWhhdmlvcn0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxyLnByb3RvdHlwZS5fYWRkUHJpbVRvRGlydHlMaXN0PWZ1bmN0aW9uKGUpe3RoaXMuX3JlbmRlcmFibGVEYXRhLl9wcmltRGlydHlMaXN0LnB1c2goZSl9LHIucHJvdG90eXBlLl9yZW5kZXJDYWNoZWRDYW52YXM9ZnVuY3Rpb24oKXt0aGlzLnVwZGF0ZUNhY2hlZFN0YXRlcyghMCk7dmFyIHQ9bmV3IGUuUHJlcGFyZVJlbmRlcjJEQ29udGV4dDt0aGlzLl9wcmVwYXJlR3JvdXBSZW5kZXIodCksdGhpcy5fZ3JvdXBSZW5kZXIoKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KHIucHJvdG90eXBlLFwidHJhY2tlZE5vZGVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3RyYWNrZWROb2RlfSxzZXQ6ZnVuY3Rpb24odCl7bnVsbCE9dD8odGhpcy5faXNGbGFnU2V0KGUuU21hcnRQcm9wZXJ0eVByaW0uZmxhZ1RyYWNrZWRHcm91cCl8fHRoaXMub3duZXIuX3JlZ2lzdGVyVHJhY2tlZE5vZGUodGhpcyksdGhpcy5fdHJhY2tlZE5vZGU9dCk6KHRoaXMuX2lzRmxhZ1NldChlLlNtYXJ0UHJvcGVydHlQcmltLmZsYWdUcmFja2VkR3JvdXApJiZ0aGlzLm93bmVyLl91bnJlZ2lzdGVyVHJhY2tlZE5vZGUodGhpcyksdGhpcy5fdHJhY2tlZE5vZGU9bnVsbCl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksci5wcm90b3R5cGUubGV2ZWxJbnRlcnNlY3Q9ZnVuY3Rpb24oZSl7cmV0dXJuITB9LHIucHJvdG90eXBlLnVwZGF0ZUxldmVsQm91bmRpbmdJbmZvPWZ1bmN0aW9uKCl7dmFyIHQ7dD10aGlzLnNpemU/dGhpcy5zaXplOm5ldyBlLlNpemUoMCwwKSxlLkJvdW5kaW5nSW5mbzJELkNyZWF0ZUZyb21TaXplVG9SZWYodCx0aGlzLl9sZXZlbEJvdW5kaW5nSW5mbyl9LHIucHJvdG90eXBlLl9wcmVwYXJlR3JvdXBSZW5kZXI9ZnVuY3Rpb24odCl7dmFyIGk9bnVsbDtpZigodGhpcy5fcmVuZGVyYWJsZURhdGEuX3ByaW1EaXJ0eUxpc3QubGVuZ3RoPjB8fHQuZm9yY2VSZWZyZXNoUHJpbWl0aXZlKSYmKGk9dGhpcy5fcmVuZGVyYWJsZURhdGEuX3ByaW1EaXJ0eUxpc3Quc29ydChmdW5jdGlvbihlLHQpe3JldHVybiBlLmhpZXJhcmNoeURlcHRoLXQuaGllcmFyY2h5RGVwdGh9KSx0aGlzLnVwZGF0ZUNhY2hlZFN0YXRlc09mKGksITApKSx0aGlzLl9pc0NhY2hlZEdyb3VwKXt2YXIgcj10aGlzLmFjdHVhbFNpemUuY2xvbmUoKTtyLmVxdWFscyh0aGlzLl92aWV3cG9ydFNpemUpfHwodC5mb3JjZVJlZnJlc2hQcmltaXRpdmU9ITApLHRoaXMuX3ZpZXdwb3J0U2l6ZT1yfWVsc2V7dmFyIG49dGhpcy5fZ2xvYmFsVHJhbnNmb3JtLmdldFRyYW5zbGF0aW9uKCksbz10aGlzLmFjdHVhbFNpemUuY2xvbmUoKSxzPXRoaXMub3duZXIuX3JlbmRlcmluZ1NpemU7by5oZWlnaHQ9TWF0aC5taW4oby5oZWlnaHQscy5oZWlnaHQtbi55KSxvLndpZHRoPU1hdGgubWluKG8ud2lkdGgscy53aWR0aC1uLngpO3ZhciBhPW4ueCxoPW4ueTt0aGlzLl92aWV3cG9ydFBvc2l0aW9uLng9YSx0aGlzLl92aWV3cG9ydFBvc2l0aW9uLnk9aDt2YXIgYz1vLndpZHRoLGw9by5oZWlnaHQ7dGhpcy5fdmlld3BvcnRTaXplPyh0aGlzLl92aWV3cG9ydFNpemUud2lkdGg9PT1jJiZ0aGlzLl92aWV3cG9ydFNpemUuaGVpZ2h0PT09bHx8KHQuZm9yY2VSZWZyZXNoUHJpbWl0aXZlPSEwKSx0aGlzLl92aWV3cG9ydFNpemUud2lkdGg9Yyx0aGlzLl92aWV3cG9ydFNpemUuaGVpZ2h0PWwpOnRoaXMuX3ZpZXdwb3J0U2l6ZT1uZXcgZS5TaXplKGMsbCl9aWYodGhpcy5fcmVuZGVyYWJsZURhdGEuX3ByaW1EaXJ0eUxpc3QubGVuZ3RoPjB8fHQuZm9yY2VSZWZyZXNoUHJpbWl0aXZlKWlmKHRoaXMuX2NhY2hlR3JvdXBEaXJ0eT10aGlzLl9pc0NhY2hlZEdyb3VwLHQuZm9yY2VSZWZyZXNoUHJpbWl0aXZlKWZvcih2YXIgdT0wLGY9dGhpcy5fY2hpbGRyZW47dTxmLmxlbmd0aDt1Kyspe3ZhciBkPWZbdV07ZC5fcHJlcGFyZVJlbmRlcih0KX1lbHNlIGl8fChpPXRoaXMuX3JlbmRlcmFibGVEYXRhLl9wcmltRGlydHlMaXN0LnNvcnQoZnVuY3Rpb24oZSx0KXtyZXR1cm4gZS5oaWVyYXJjaHlEZXB0aC10LmhpZXJhcmNoeURlcHRofSkpLGkuZm9yRWFjaChmdW5jdGlvbihlKXshZS5pc0Rpc3Bvc2VkJiZlLl9uZWVkUHJlcGFyZSgpJiZlLl9wcmVwYXJlUmVuZGVyKHQpfSksdGhpcy5fcmVuZGVyYWJsZURhdGEuX3ByaW1EaXJ0eUxpc3QuZm9yRWFjaChmdW5jdGlvbihlKXtyZXR1cm4gZS5fcmVzZXRQcm9wZXJ0aWVzRGlydHkoKX0pLHRoaXMuX3JlbmRlcmFibGVEYXRhLl9wcmltRGlydHlMaXN0LnNwbGljZSgwKTt0aGlzLl9yZW5kZXJhYmxlRGF0YS5fY2hpbGRyZW5SZW5kZXJhYmxlR3JvdXBzLmZvckVhY2goZnVuY3Rpb24oZSl7ZS5fcHJlcGFyZUdyb3VwUmVuZGVyKHQpfSl9LHIucHJvdG90eXBlLl9ncm91cFJlbmRlcj1mdW5jdGlvbigpe2Zvcih2YXIgdD10aGlzLGk9dGhpcy5vd25lci5lbmdpbmUscj0wLG49MCxvPXRoaXMuX3JlbmRlcmFibGVEYXRhLl9jaGlsZHJlblJlbmRlcmFibGVHcm91cHM7bjxvLmxlbmd0aDtuKyspe3ZhciBzPW9bbl07cy5fZ3JvdXBSZW5kZXIoKX1pZighdGhpcy5pc0NhY2hlZEdyb3VwfHx0aGlzLl9jYWNoZUdyb3VwRGlydHkpe2lmKHRoaXMuaXNDYWNoZWRHcm91cCl0aGlzLl9iaW5kQ2FjaGVUYXJnZXQoKTtlbHNlIHZhciBhPWkuc2V0RGlyZWN0Vmlld3BvcnQodGhpcy5fdmlld3BvcnRQb3NpdGlvbi54LHRoaXMuX3ZpZXdwb3J0UG9zaXRpb24ueSx0aGlzLl92aWV3cG9ydFNpemUud2lkdGgsdGhpcy5fdmlld3BvcnRTaXplLmhlaWdodCk7dmFyIGg9aS5nZXRBbHBoYVRlc3RpbmcoKT09PSEwLGM9aS5nZXREZXB0aFdyaXRlKCk9PT0hMDtpLnNldEFscGhhVGVzdGluZyghMSksaS5zZXREZXB0aFdyaXRlKCEwKTt2YXIgbD1uZXcgZS5SZW5kZXIyRENvbnRleHQoZS5SZW5kZXIyRENvbnRleHQuUmVuZGVyTW9kZU9wYXF1ZSk7dGhpcy5fcmVuZGVyYWJsZURhdGEuX3JlbmRlckdyb3VwSW5zdGFuY2VzSW5mby5mb3JFYWNoKGZ1bmN0aW9uKGUsbil7dmFyIG89dC5fcHJlcGFyZUNvbnRleHQoaSxsLG4pO2lmKG51bGwhPT1vJiYoIXQub3duZXIuc3VwcG9ydEluc3RhbmNlZEFycmF5fHxvPjApKXt2YXIgcz0hbi5tb2RlbFJlbmRlckNhY2hlLnJlbmRlcihuLGwpO24ub3BhcXVlRGlydHk9cyxyKz1zPzE6MH19KSxpLnNldEFscGhhVGVzdGluZyghMCksaS5zZXREZXB0aFdyaXRlKCEwKSxsPW5ldyBlLlJlbmRlcjJEQ29udGV4dChlLlJlbmRlcjJEQ29udGV4dC5SZW5kZXJNb2RlQWxwaGFUZXN0KSx0aGlzLl9yZW5kZXJhYmxlRGF0YS5fcmVuZGVyR3JvdXBJbnN0YW5jZXNJbmZvLmZvckVhY2goZnVuY3Rpb24oZSxuKXt2YXIgbz10Ll9wcmVwYXJlQ29udGV4dChpLGwsbik7aWYobnVsbCE9PW8mJighdC5vd25lci5zdXBwb3J0SW5zdGFuY2VkQXJyYXl8fG8+MCkpe3ZhciBzPSFuLm1vZGVsUmVuZGVyQ2FjaGUucmVuZGVyKG4sbCk7bi5vcGFxdWVEaXJ0eT1zLHIrPXM/MTowfX0pLGkuc2V0QWxwaGFUZXN0aW5nKCEwKSxpLnNldERlcHRoV3JpdGUoITEpLHRoaXMuX3JlbmRlcmFibGVEYXRhLl90cmFuc3BhcmVudExpc3RDaGFuZ2VkJiZ0aGlzLl91cGRhdGVUcmFuc3BhcmVudERhdGEoKSxyKz10aGlzLl9yZW5kZXJUcmFuc3BhcmVudERhdGEoKSx0aGlzLl9jYWNoZUdyb3VwRGlydHk9MCE9PXIsdGhpcy5pc0NhY2hlZEdyb3VwP3RoaXMuX3VuYmluZENhY2hlVGFyZ2V0KCk6YSYmaS5zZXRWaWV3cG9ydChhKSxpLnNldEFscGhhVGVzdGluZyhoKSxpLnNldERlcHRoV3JpdGUoYyl9fSxyLnByb3RvdHlwZS5fdXBkYXRlVHJhbnNwYXJlbnREYXRhPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5fcmVuZGVyYWJsZURhdGE7aWYobnVsbCE9PXQuX2ZpcnN0Q2hhbmdlZFByaW0pe3QuX3RyYW5zcGFyZW50UHJpbWl0aXZlcy5zb3J0KGZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQuX3ByaW1pdGl2ZS5hY3R1YWxaT2Zmc2V0LWUuX3ByaW1pdGl2ZS5hY3R1YWxaT2Zmc2V0fSk7dmFyIGk9ZnVuY3Rpb24oZSxpKXt2YXIgcj10Ll90cmFuc3BhcmVudFByaW1pdGl2ZXNbaV07aWYoZS5ncm91cEluc2FuY2VJbmZvIT09ci5fZ3JvdXBJbnN0YW5jZUluZm8pcmV0dXJuITE7dmFyIG49ci5fcHJpbWl0aXZlLmFjdHVhbFpPZmZzZXQ7cmV0dXJuIHIuX3RyYW5zcGFyZW50U2VnbWVudD1lLG48ZS5lbmRaJiYoZS5lbmRaPW4sZS5lbmREYXRhSW5kZXg9ci5fcHJpbWl0aXZlLl9nZXRMYXN0SW5kZXhJbkRhdGFCdWZmZXIoKSsxKSwhMH07dC5fdHJhbnNwYXJlbnRTZWdtZW50cy5zcGxpY2UoMCk7Zm9yKHZhciByPW51bGwsbj0wO248dC5fdHJhbnNwYXJlbnRQcmltaXRpdmVzLmxlbmd0aDtuKyspe3ZhciBvPXQuX3RyYW5zcGFyZW50UHJpbWl0aXZlc1tuXTtpZihvLl9ncm91cEluc3RhbmNlSW5mby50cmFuc3BhcmVudE9yZGVyRGlydHkmJm8uX2dyb3VwSW5zdGFuY2VJbmZvLnNvcnRUcmFuc3BhcmVudERhdGEoKSxvLl90cmFuc3BhcmVudFNlZ21lbnQ9bnVsbCxyJiZpKHIsbiksIW8uX3RyYW5zcGFyZW50U2VnbWVudCl7dmFyIHM9bmV3IGUuVHJhbnNwYXJlbnRTZWdtZW50O3MuZ3JvdXBJbnNhbmNlSW5mbz1vLl9ncm91cEluc3RhbmNlSW5mbzt2YXIgYT1vLl9wcmltaXRpdmU7cy5zdGFydFo9YS5hY3R1YWxaT2Zmc2V0LHMuc3RhcnREYXRhSW5kZXg9YS5fZ2V0Rmlyc3RJbmRleEluRGF0YUJ1ZmZlcigpLHMuZW5kRGF0YUluZGV4PWEuX2dldExhc3RJbmRleEluRGF0YUJ1ZmZlcigpKzEscy5lbmRaPXMuc3RhcnRaLG8uX3RyYW5zcGFyZW50U2VnbWVudD1zLHQuX3RyYW5zcGFyZW50U2VnbWVudHMucHVzaChzKX1yPW8uX3RyYW5zcGFyZW50U2VnbWVudH10Ll9maXJzdENoYW5nZWRQcmltPW51bGwsdC5fdHJhbnNwYXJlbnRMaXN0Q2hhbmdlZD0hMX19LHIucHJvdG90eXBlLl9yZW5kZXJUcmFuc3BhcmVudERhdGE9ZnVuY3Rpb24oKXtmb3IodmFyIHQ9MCxpPW5ldyBlLlJlbmRlcjJEQ29udGV4dChlLlJlbmRlcjJEQ29udGV4dC5SZW5kZXJNb2RlVHJhbnNwYXJlbnQpLHI9dGhpcy5fcmVuZGVyYWJsZURhdGEsbj1yLl90cmFuc3BhcmVudFNlZ21lbnRzLmxlbmd0aCxvPTA7bj5vO28rKyl7dmFyIHM9ci5fdHJhbnNwYXJlbnRTZWdtZW50c1tvXSxhPXMuZ3JvdXBJbnNhbmNlSW5mbyxoPWEubW9kZWxSZW5kZXJDYWNoZTtpLnVzZUluc3RhbmNpbmc9ITEsaS5wYXJ0RGF0YVN0YXJ0SW5kZXg9cy5zdGFydERhdGFJbmRleCxpLnBhcnREYXRhRW5kSW5kZXg9cy5lbmREYXRhSW5kZXgsaS5ncm91cEluZm9QYXJ0RGF0YT1hLnRyYW5zcGFyZW50RGF0YTt2YXIgYz0haC5yZW5kZXIoYSxpKTt0Kz1jPzE6MH1yZXR1cm4gdH0sci5wcm90b3R5cGUuX3ByZXBhcmVDb250ZXh0PWZ1bmN0aW9uKHQsaSxyKXt2YXIgbixvLHM9bnVsbDtzd2l0Y2goaS5yZW5kZXJNb2RlKXtjYXNlIGUuUmVuZGVyMkRDb250ZXh0LlJlbmRlck1vZGVPcGFxdWU6aWYoIXIuaGFzT3BhcXVlRGF0YSlyZXR1cm4gbnVsbDtuPWZ1bmN0aW9uKGUpe3Iub3BhcXVlRGlydHk9ZX0sbz1mdW5jdGlvbigpe3JldHVybiByLm9wYXF1ZURpcnR5fSxpLmdyb3VwSW5mb1BhcnREYXRhPXIub3BhcXVlRGF0YSxzPXIub3BhcXVlRGF0YTticmVhaztjYXNlIGUuUmVuZGVyMkRDb250ZXh0LlJlbmRlck1vZGVBbHBoYVRlc3Q6aWYoIXIuaGFzQWxwaGFUZXN0RGF0YSlyZXR1cm4gbnVsbDtuPWZ1bmN0aW9uKGUpe3IuYWxwaGFUZXN0RGlydHk9ZX0sbz1mdW5jdGlvbigpe3JldHVybiByLmFscGhhVGVzdERpcnR5fSxpLmdyb3VwSW5mb1BhcnREYXRhPXIuYWxwaGFUZXN0RGF0YSxzPXIuYWxwaGFUZXN0RGF0YTticmVhaztkZWZhdWx0OnRocm93IG5ldyBFcnJvcihcIl9wcmVwYXJlQ29udGV4dCBpcyBvbmx5IGZvciBvcGFxdWUgb3IgYWxwaGFUZXN0XCIpfXZhciBhPTA7aWYodGhpcy5vd25lci5zdXBwb3J0SW5zdGFuY2VkQXJyYXkpe2kudXNlSW5zdGFuY2luZz0hMDtmb3IodmFyIGg9MDtoPHMubGVuZ3RoO2grKyl7dmFyIGM9c1toXSxsPWMuX3BhcnREYXRhLHU9bC5wYWNrKCk7YSs9bC51c2VkRWxlbWVudENvdW50O3ZhciBmPWwudXNlZEVsZW1lbnRDb3VudCpsLnN0cmlkZSo0OyFjLl9wYXJ0QnVmZmVyfHxjLl9wYXJ0QnVmZmVyU2l6ZTxmPyhjLl9wYXJ0QnVmZmVyJiZ0LmRlbGV0ZUluc3RhbmNlc0J1ZmZlcihjLl9wYXJ0QnVmZmVyKSxjLl9wYXJ0QnVmZmVyPXQuY3JlYXRlSW5zdGFuY2VzQnVmZmVyKGYpLGMuX3BhcnRCdWZmZXJTaXplPWYsbighMSksdC51cGRhdGVBcnJheUJ1ZmZlcih1KSk6bygpJiYodC5iaW5kQXJyYXlCdWZmZXIoYy5fcGFydEJ1ZmZlciksdC51cGRhdGVBcnJheUJ1ZmZlcih1KSl9bighMSl9ZWxzZXtpLnBhcnREYXRhU3RhcnRJbmRleD0wO2Zvcih2YXIgaD0wOyFpLmdyb3VwSW5mb1BhcnREYXRhW2hdOyloKys7aS5wYXJ0RGF0YUVuZEluZGV4PWkuZ3JvdXBJbmZvUGFydERhdGFbaF0uX3BhcnREYXRhLnVzZWRFbGVtZW50Q291bnR9cmV0dXJuIGF9LHIucHJvdG90eXBlLl9iaW5kQ2FjaGVUYXJnZXQ9ZnVuY3Rpb24oKXt2YXIgdCxpLHI9dGhpcy5fcmVuZGVyYWJsZURhdGE7aWYoci5fY2FjaGVOb2RlKXt2YXIgbj1yLl9jYWNoZU5vZGUuY29udGVudFNpemUsbz1NYXRoLmNlaWwodGhpcy5hY3R1YWxTaXplLndpZHRoKSxzPU1hdGguY2VpbCh0aGlzLmFjdHVhbFNpemUuaGVpZ2h0KTsobi53aWR0aDxvfHxuLmhlaWdodDxzKSYmKHQ9TWF0aC5mbG9vcigxLjA3Km4ud2lkdGgpLGk9TWF0aC5mbG9vcigxLjA3Km4uaGVpZ2h0KSxyLl9jYWNoZVRleHR1cmUuZnJlZVJlY3Qoci5fY2FjaGVOb2RlKSxyLl9jYWNoZU5vZGU9bnVsbCl9aWYoIXIuX2NhY2hlTm9kZSl7dmFyIGE9dGhpcy5vd25lci5fYWxsb2NhdGVHcm91cENhY2hlKHRoaXMsdGhpcy5yZW5kZXJHcm91cCx0P25ldyBlLlNpemUodCxpKTpudWxsKTtyLl9jYWNoZU5vZGU9YS5ub2RlLHIuX2NhY2hlVGV4dHVyZT1hLnRleHR1cmUsci5fY2FjaGVSZW5kZXJTcHJpdGU9YS5zcHJpdGU7dmFyIG49ci5fY2FjaGVOb2RlLmNvbnRlbnRTaXplfXZhciBoPXIuX2NhY2hlTm9kZTtyLl9jYWNoZVRleHR1cmUuYmluZFRleHR1cmVGb3JQb3NTaXplKGgucG9zLHRoaXMuYWN0dWFsU2l6ZSwhMCl9LHIucHJvdG90eXBlLl91bmJpbmRDYWNoZVRhcmdldD1mdW5jdGlvbigpe3RoaXMuX3JlbmRlcmFibGVEYXRhLl9jYWNoZVRleHR1cmUmJnRoaXMuX3JlbmRlcmFibGVEYXRhLl9jYWNoZVRleHR1cmUudW5iaW5kVGV4dHVyZSgpfSxyLnByb3RvdHlwZS5oYW5kbGVHcm91cENoYW5nZWQ9ZnVuY3Rpb24odCl7dmFyIGk9dGhpcy5fcmVuZGVyYWJsZURhdGE7dGhpcy5pc0NhY2hlZEdyb3VwJiZpLl9jYWNoZVJlbmRlclNwcml0ZSYmKHQuaWQ9PT1lLlByaW0yREJhc2UuYWN0dWFsUG9zaXRpb25Qcm9wZXJ0eS5pZD9pLl9jYWNoZVJlbmRlclNwcml0ZS5hY3R1YWxQb3NpdGlvbj10aGlzLmFjdHVhbFBvc2l0aW9uLmNsb25lKCk6dC5pZD09PWUuUHJpbTJEQmFzZS5yb3RhdGlvblByb3BlcnR5LmlkP2kuX2NhY2hlUmVuZGVyU3ByaXRlLnJvdGF0aW9uPXRoaXMucm90YXRpb246dC5pZD09PWUuUHJpbTJEQmFzZS5zY2FsZVByb3BlcnR5LmlkP2kuX2NhY2hlUmVuZGVyU3ByaXRlLnNjYWxlPXRoaXMuc2NhbGU6dC5pZD09PWUuUHJpbTJEQmFzZS5vcmlnaW5Qcm9wZXJ0eS5pZD9pLl9jYWNoZVJlbmRlclNwcml0ZS5vcmlnaW49dGhpcy5vcmlnaW4uY2xvbmUoKTp0LmlkPT09ci5hY3R1YWxTaXplUHJvcGVydHkuaWQmJihpLl9jYWNoZVJlbmRlclNwcml0ZS5zaXplPXRoaXMuYWN0dWFsU2l6ZS5jbG9uZSgpKSl9LHIucHJvdG90eXBlLmRldGVjdEdyb3VwU3RhdGVzPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcyBpbnN0YW5jZW9mIGUuQ2FudmFzMkQsbj10aGlzLm93bmVyLmNhY2hpbmdTdHJhdGVneTtpZihuPT09ZS5DYW52YXMyRC5DQUNIRVNUUkFURUdZX0RPTlRDQUNIRSl0aGlzLl9pc1JlbmRlcmFibGVHcm91cD10LHRoaXMuX2lzQ2FjaGVkR3JvdXA9ITE7ZWxzZSBpZihuPT09ZS5DYW52YXMyRC5DQUNIRVNUUkFURUdZX0NBTlZBUyl0Pyh0aGlzLl9pc1JlbmRlcmFibGVHcm91cD0hMCx0aGlzLl9pc0NhY2hlZEdyb3VwPSEwKToodGhpcy5faXNSZW5kZXJhYmxlR3JvdXA9XCJfX2NhY2hlZENhbnZhc0dyb3VwX19cIj09PXRoaXMuaWQsdGhpcy5faXNDYWNoZWRHcm91cD0hMSk7ZWxzZSBpZihuPT09ZS5DYW52YXMyRC5DQUNIRVNUUkFURUdZX1RPUExFVkVMR1JPVVBTKXQ/KHRoaXMuX2lzUmVuZGVyYWJsZUdyb3VwPSEwLHRoaXMuX2lzQ2FjaGVkR3JvdXA9ITEpOjE9PT10aGlzLmhpZXJhcmNoeURlcHRoPyh0aGlzLl9pc1JlbmRlcmFibGVHcm91cD0hMCx0aGlzLl9pc0NhY2hlZEdyb3VwPSEwKToodGhpcy5faXNSZW5kZXJhYmxlR3JvdXA9ITEsdGhpcy5faXNDYWNoZWRHcm91cD0hMSk7ZWxzZSBpZihuPT09ZS5DYW52YXMyRC5DQUNIRVNUUkFURUdZX0FMTEdST1VQUyl7dmFyIG89dGhpcy5jYWNoZUJlaGF2aW9yO28hPT1yLkdST1VQQ0FDSEVCRUhBVklPUl9ET05UQ0FDSEVPVkVSUklERSYmbyE9PXIuR1JPVVBDQUNIRUJFSEFWSU9SX0NBQ0hFSU5QQVJFTlRHUk9VUHx8KHRoaXMuX2lzUmVuZGVyYWJsZUdyb3VwPW89PT1yLkdST1VQQ0FDSEVCRUhBVklPUl9ET05UQ0FDSEVPVkVSUklERSx0aGlzLl9pc0NhY2hlZEdyb3VwPSExKSxvPT09ci5HUk9VUENBQ0hFQkVIQVZJT1JfRk9MTE9XQ0FDSEVTVFJBVEVHWSYmKHRoaXMuX2lzUmVuZGVyYWJsZUdyb3VwPSEwLHRoaXMuX2lzQ2FjaGVkR3JvdXA9ITApfWlmKHRoaXMuX2lzUmVuZGVyYWJsZUdyb3VwJiYodGhpcy5fcmVuZGVyYWJsZURhdGF8fCh0aGlzLl9yZW5kZXJhYmxlRGF0YT1uZXcgaSkpLHRoaXMuX2lzQ2FjaGVkR3JvdXApZm9yKHZhciBzPXRoaXMucGFyZW50O3M7KXtpZihzIGluc3RhbmNlb2YgciYmcy5faXNSZW5kZXJhYmxlR3JvdXApey0xPT09cy5fcmVuZGVyYWJsZURhdGEuX2NoaWxkcmVuUmVuZGVyYWJsZUdyb3Vwcy5pbmRleE9mKHRoaXMpJiZzLl9yZW5kZXJhYmxlRGF0YS5fY2hpbGRyZW5SZW5kZXJhYmxlR3JvdXBzLnB1c2godGhpcyk7YnJlYWt9cz1zLnBhcmVudH19LHIuR1JPVVAyRF9QUk9QQ09VTlQ9ZS5QcmltMkRCYXNlLlBSSU0yREJBU0VfUFJPUENPVU5UKzUsci5HUk9VUENBQ0hFQkVIQVZJT1JfRk9MTE9XQ0FDSEVTVFJBVEVHWT0wLHIuR1JPVVBDQUNIRUJFSEFWSU9SX0RPTlRDQUNIRU9WRVJSSURFPTEsci5HUk9VUENBQ0hFQkVIQVZJT1JfQ0FDSEVJTlBBUkVOVEdST1VQPTIsX19kZWNvcmF0ZShbZS5pbnN0YW5jZUxldmVsUHJvcGVydHkoZS5QcmltMkRCYXNlLlBSSU0yREJBU0VfUFJPUENPVU5UKzEsZnVuY3Rpb24oZSl7cmV0dXJuIHIuc2l6ZVByb3BlcnR5PWV9LCExLCEwKV0sci5wcm90b3R5cGUsXCJzaXplXCIsbnVsbCksX19kZWNvcmF0ZShbZS5pbnN0YW5jZUxldmVsUHJvcGVydHkoZS5QcmltMkRCYXNlLlBSSU0yREJBU0VfUFJPUENPVU5UKzIsZnVuY3Rpb24oZSl7cmV0dXJuIHIuYWN0dWFsU2l6ZVByb3BlcnR5PWV9KV0sci5wcm90b3R5cGUsXCJhY3R1YWxTaXplXCIsbnVsbCkscj1fX2RlY29yYXRlKFtlLmNsYXNzTmFtZShcIkdyb3VwMkRcIildLHIpfShlLlByaW0yREJhc2UpO2UuR3JvdXAyRD10O3ZhciBpPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCgpe3RoaXMuX3ByaW1EaXJ0eUxpc3Q9bmV3IEFycmF5LHRoaXMuX2NoaWxkcmVuUmVuZGVyYWJsZUdyb3Vwcz1uZXcgQXJyYXksdGhpcy5fcmVuZGVyR3JvdXBJbnN0YW5jZXNJbmZvPW5ldyBlLlN0cmluZ0RpY3Rpb25hcnksdGhpcy5fdHJhbnNwYXJlbnRQcmltaXRpdmVzPW5ldyBBcnJheSx0aGlzLl90cmFuc3BhcmVudFNlZ21lbnRzPW5ldyBBcnJheSx0aGlzLl9maXJzdENoYW5nZWRQcmltPW51bGwsdGhpcy5fdHJhbnNwYXJlbnRMaXN0Q2hhbmdlZD0hMSx0aGlzLl9jYWNoZU5vZGU9bnVsbCx0aGlzLl9jYWNoZVRleHR1cmU9bnVsbCx0aGlzLl9jYWNoZVJlbmRlclNwcml0ZT1udWxsfXJldHVybiB0LnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7dGhpcy5fY2FjaGVSZW5kZXJTcHJpdGUmJih0aGlzLl9jYWNoZVJlbmRlclNwcml0ZS5kaXNwb3NlKCksdGhpcy5fY2FjaGVSZW5kZXJTcHJpdGU9bnVsbCksdGhpcy5fY2FjaGVUZXh0dXJlJiZ0aGlzLl9jYWNoZU5vZGUmJih0aGlzLl9jYWNoZVRleHR1cmUuZnJlZVJlY3QodGhpcy5fY2FjaGVOb2RlKSx0aGlzLl9jYWNoZVRleHR1cmU9bnVsbCx0aGlzLl9jYWNoZU5vZGU9bnVsbCksdGhpcy5fcHJpbURpcnR5TGlzdCYmKHRoaXMuX3ByaW1EaXJ0eUxpc3Quc3BsaWNlKDApLHRoaXMuX3ByaW1EaXJ0eUxpc3Q9bnVsbCksdGhpcy5fcmVuZGVyR3JvdXBJbnN0YW5jZXNJbmZvJiYodGhpcy5fcmVuZGVyR3JvdXBJbnN0YW5jZXNJbmZvLmZvckVhY2goZnVuY3Rpb24oZSx0KXt0LmRpc3Bvc2UoKX0pLHRoaXMuX3JlbmRlckdyb3VwSW5zdGFuY2VzSW5mbz1udWxsKX0sdC5wcm90b3R5cGUuYWRkTmV3VHJhbnNwYXJlbnRQcmltaXRpdmVJbmZvPWZ1bmN0aW9uKGUsdCl7dmFyIGk9bmV3IHI7cmV0dXJuIGkuX3ByaW1pdGl2ZT1lLGkuX2dyb3VwSW5zdGFuY2VJbmZvPXQsaS5fdHJhbnNwYXJlbnRTZWdtZW50PW51bGwsdGhpcy5fdHJhbnNwYXJlbnRQcmltaXRpdmVzLnB1c2goaSksdGhpcy5fdHJhbnNwYXJlbnRMaXN0Q2hhbmdlZD0hMCx0aGlzLnVwZGF0ZVNtYWxsZXN0WkNoYW5nZWRQcmltKGkpLGl9LHQucHJvdG90eXBlLnJlbW92ZVRyYW5zcGFyZW50UHJpbWl0aXZlSW5mbz1mdW5jdGlvbihlKXt2YXIgdD10aGlzLl90cmFuc3BhcmVudFByaW1pdGl2ZXMuaW5kZXhPZihlKTstMSE9PXQmJih0aGlzLl90cmFuc3BhcmVudFByaW1pdGl2ZXMuc3BsaWNlKHQsMSksdGhpcy5fdHJhbnNwYXJlbnRMaXN0Q2hhbmdlZD0hMCx0aGlzLnVwZGF0ZVNtYWxsZXN0WkNoYW5nZWRQcmltKGUpKX0sdC5wcm90b3R5cGUudHJhbnNwYXJlbnRQcmltaXRpdmVaQ2hhbmdlZD1mdW5jdGlvbihlKXt0aGlzLl90cmFuc3BhcmVudExpc3RDaGFuZ2VkPSEwLHRoaXMudXBkYXRlU21hbGxlc3RaQ2hhbmdlZFByaW0oZSl9LHQucHJvdG90eXBlLnVwZGF0ZVNtYWxsZXN0WkNoYW5nZWRQcmltPWZ1bmN0aW9uKGUpe2lmKGUuX3ByaW1pdGl2ZSl7dmFyIHQ9ZS5fcHJpbWl0aXZlLmFjdHVhbFpPZmZzZXQsaT10aGlzLl9maXJzdENoYW5nZWRQcmltP3RoaXMuX2ZpcnN0Q2hhbmdlZFByaW0uX3ByaW1pdGl2ZS5hY3R1YWxaT2Zmc2V0Ok51bWJlci5NSU5fVkFMVUU7dD5pJiYodGhpcy5fZmlyc3RDaGFuZ2VkUHJpbT1lKX19LHR9KCk7ZS5SZW5kZXJhYmxlR3JvdXBEYXRhPWk7dmFyIHI9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7fXJldHVybiBlfSgpO2UuVHJhbnNwYXJlbnRQcmltaXRpdmVJbmZvPXJ9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGkoZSxpKXt0LmNhbGwodGhpcyxlLGkpLHRoaXMuZWZmZWN0c1JlYWR5PSExLHRoaXMuZmlsbFZCPW51bGwsdGhpcy5maWxsSUI9bnVsbCx0aGlzLmZpbGxJbmRpY2VzQ291bnQ9MCx0aGlzLmluc3RhbmNpbmdGaWxsQXR0cmlidXRlcz1udWxsLHRoaXMuZWZmZWN0RmlsbD1udWxsLHRoaXMuZWZmZWN0RmlsbEluc3RhbmNlZD1udWxsLHRoaXMuYm9yZGVyVkI9bnVsbCx0aGlzLmJvcmRlcklCPW51bGwsdGhpcy5ib3JkZXJJbmRpY2VzQ291bnQ9MCx0aGlzLmluc3RhbmNpbmdCb3JkZXJBdHRyaWJ1dGVzPW51bGwsdGhpcy5lZmZlY3RCb3JkZXI9bnVsbCx0aGlzLmVmZmVjdEJvcmRlckluc3RhbmNlZD1udWxsfXJldHVybiBfX2V4dGVuZHMoaSx0KSxpLnByb3RvdHlwZS5yZW5kZXI9ZnVuY3Rpb24odCxpKXtpZighdGhpcy5lZmZlY3RzUmVhZHkpe2lmKHRoaXMuZWZmZWN0RmlsbCYmKCF0aGlzLmVmZmVjdEZpbGwuaXNSZWFkeSgpfHx0aGlzLmVmZmVjdEZpbGxJbnN0YW5jZWQmJiF0aGlzLmVmZmVjdEZpbGxJbnN0YW5jZWQuaXNSZWFkeSgpKXx8dGhpcy5lZmZlY3RCb3JkZXImJighdGhpcy5lZmZlY3RCb3JkZXIuaXNSZWFkeSgpfHx0aGlzLmVmZmVjdEJvcmRlckluc3RhbmNlZCYmIXRoaXMuZWZmZWN0Qm9yZGVySW5zdGFuY2VkLmlzUmVhZHkoKSkpcmV0dXJuITE7dGhpcy5lZmZlY3RzUmVhZHk9ITB9dmFyIHI9dC5vd25lci5vd25lci5lbmdpbmUsbj0wO3RoaXMuZWZmZWN0RmlsbCYmdGhpcy5lZmZlY3RCb3JkZXImJihuPXIuZ2V0RGVwdGhGdW5jdGlvbigpLHIuc2V0RGVwdGhGdW5jdGlvblRvTGVzc09yRXF1YWwoKSk7dmFyIG89ci5nZXRBbHBoYU1vZGUoKTtpZih0aGlzLmVmZmVjdEZpbGwpe3ZhciBzPXQucGFydEluZGV4RnJvbUlkLmdldChlLlNoYXBlMkQuU0hBUEUyRF9GSUxMUEFSVElELnRvU3RyaW5nKCkpLGE9aS5ncm91cEluZm9QYXJ0RGF0YVtzXTtpLnJlbmRlck1vZGUhPT1lLlJlbmRlcjJEQ29udGV4dC5SZW5kZXJNb2RlT3BhcXVlJiZyLnNldEFscGhhTW9kZShlLkVuZ2luZS5BTFBIQV9DT01CSU5FKTt2YXIgaD1pLnVzZUluc3RhbmNpbmc/dGhpcy5lZmZlY3RGaWxsSW5zdGFuY2VkOnRoaXMuZWZmZWN0RmlsbDtpZihyLmVuYWJsZUVmZmVjdChoKSxyLmJpbmRCdWZmZXJzRGlyZWN0bHkodGhpcy5maWxsVkIsdGhpcy5maWxsSUIsWzFdLDQsaCksaS51c2VJbnN0YW5jaW5nKXRoaXMuaW5zdGFuY2luZ0ZpbGxBdHRyaWJ1dGVzfHwodGhpcy5pbnN0YW5jaW5nRmlsbEF0dHJpYnV0ZXM9dGhpcy5sb2FkSW5zdGFuY2luZ0F0dHJpYnV0ZXMoZS5TaGFwZTJELlNIQVBFMkRfRklMTFBBUlRJRCxoKSksci51cGRhdGVBbmRCaW5kSW5zdGFuY2VzQnVmZmVyKGEuX3BhcnRCdWZmZXIsbnVsbCx0aGlzLmluc3RhbmNpbmdGaWxsQXR0cmlidXRlcyksci5kcmF3KCEwLDAsdGhpcy5maWxsSW5kaWNlc0NvdW50LGEuX3BhcnREYXRhLnVzZWRFbGVtZW50Q291bnQpLHIudW5iaW5kSW5zdGFuY2VBdHRyaWJ1dGVzKCk7ZWxzZSBmb3IodmFyIGM9aS5wYXJ0RGF0YVN0YXJ0SW5kZXg7YzxpLnBhcnREYXRhRW5kSW5kZXg7YysrKXRoaXMuc2V0dXBVbmlmb3JtcyhoLHMsYS5fcGFydERhdGEsYyksci5kcmF3KCEwLDAsdGhpcy5maWxsSW5kaWNlc0NvdW50KX1pZih0aGlzLmVmZmVjdEJvcmRlcil7dmFyIHM9dC5wYXJ0SW5kZXhGcm9tSWQuZ2V0KGUuU2hhcGUyRC5TSEFQRTJEX0JPUkRFUlBBUlRJRC50b1N0cmluZygpKSxhPWkuZ3JvdXBJbmZvUGFydERhdGFbc107aS5yZW5kZXJNb2RlIT09ZS5SZW5kZXIyRENvbnRleHQuUmVuZGVyTW9kZU9wYXF1ZSYmci5zZXRBbHBoYU1vZGUoZS5FbmdpbmUuQUxQSEFfQ09NQklORSk7dmFyIGg9aS51c2VJbnN0YW5jaW5nP3RoaXMuZWZmZWN0Qm9yZGVySW5zdGFuY2VkOnRoaXMuZWZmZWN0Qm9yZGVyO2lmKHIuZW5hYmxlRWZmZWN0KGgpLHIuYmluZEJ1ZmZlcnNEaXJlY3RseSh0aGlzLmJvcmRlclZCLHRoaXMuYm9yZGVySUIsWzFdLDQsaCksaS51c2VJbnN0YW5jaW5nKXRoaXMuaW5zdGFuY2luZ0JvcmRlckF0dHJpYnV0ZXN8fCh0aGlzLmluc3RhbmNpbmdCb3JkZXJBdHRyaWJ1dGVzPXRoaXMubG9hZEluc3RhbmNpbmdBdHRyaWJ1dGVzKGUuU2hhcGUyRC5TSEFQRTJEX0JPUkRFUlBBUlRJRCxoKSksci51cGRhdGVBbmRCaW5kSW5zdGFuY2VzQnVmZmVyKGEuX3BhcnRCdWZmZXIsbnVsbCx0aGlzLmluc3RhbmNpbmdCb3JkZXJBdHRyaWJ1dGVzKSxyLmRyYXcoITAsMCx0aGlzLmJvcmRlckluZGljZXNDb3VudCxhLl9wYXJ0RGF0YS51c2VkRWxlbWVudENvdW50KSxyLnVuYmluZEluc3RhbmNlQXR0cmlidXRlcygpO2Vsc2UgZm9yKHZhciBjPWkucGFydERhdGFTdGFydEluZGV4O2M8aS5wYXJ0RGF0YUVuZEluZGV4O2MrKyl0aGlzLnNldHVwVW5pZm9ybXMoaCxzLGEuX3BhcnREYXRhLGMpLHIuZHJhdyghMCwwLHRoaXMuYm9yZGVySW5kaWNlc0NvdW50KX1yZXR1cm4gci5zZXRBbHBoYU1vZGUobyksdGhpcy5lZmZlY3RGaWxsJiZ0aGlzLmVmZmVjdEJvcmRlciYmci5zZXREZXB0aEZ1bmN0aW9uKG4pLCEwfSxpLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHQucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKT8odGhpcy5maWxsVkImJih0aGlzLl9lbmdpbmUuX3JlbGVhc2VCdWZmZXIodGhpcy5maWxsVkIpLHRoaXMuZmlsbFZCPW51bGwpLHRoaXMuZmlsbElCJiYodGhpcy5fZW5naW5lLl9yZWxlYXNlQnVmZmVyKHRoaXMuZmlsbElCKSx0aGlzLmZpbGxJQj1udWxsKSx0aGlzLmVmZmVjdEZpbGwmJih0aGlzLl9lbmdpbmUuX3JlbGVhc2VFZmZlY3QodGhpcy5lZmZlY3RGaWxsKSx0aGlzLmVmZmVjdEZpbGw9bnVsbCksdGhpcy5lZmZlY3RGaWxsSW5zdGFuY2VkJiYodGhpcy5fZW5naW5lLl9yZWxlYXNlRWZmZWN0KHRoaXMuZWZmZWN0RmlsbEluc3RhbmNlZCksdGhpcy5lZmZlY3RGaWxsSW5zdGFuY2VkPW51bGwpLHRoaXMuYm9yZGVyVkImJih0aGlzLl9lbmdpbmUuX3JlbGVhc2VCdWZmZXIodGhpcy5ib3JkZXJWQiksdGhpcy5ib3JkZXJWQj1udWxsKSx0aGlzLmJvcmRlcklCJiYodGhpcy5fZW5naW5lLl9yZWxlYXNlQnVmZmVyKHRoaXMuYm9yZGVySUIpLHRoaXMuYm9yZGVySUI9bnVsbCksdGhpcy5lZmZlY3RCb3JkZXImJih0aGlzLl9lbmdpbmUuX3JlbGVhc2VFZmZlY3QodGhpcy5lZmZlY3RCb3JkZXIpLHRoaXMuZWZmZWN0Qm9yZGVyPW51bGwpLHRoaXMuZWZmZWN0Qm9yZGVySW5zdGFuY2VkJiYodGhpcy5fZW5naW5lLl9yZWxlYXNlRWZmZWN0KHRoaXMuZWZmZWN0Qm9yZGVySW5zdGFuY2VkKSx0aGlzLmVmZmVjdEJvcmRlckluc3RhbmNlZD1udWxsKSwhMCk6ITF9LGl9KGUuTW9kZWxSZW5kZXJDYWNoZSk7ZS5SZWN0YW5nbGUyRFJlbmRlckNhY2hlPXQ7dmFyIGk9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gaShlKXt0LmNhbGwodGhpcyxlLDEpfXJldHVybiBfX2V4dGVuZHMoaSx0KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJwcm9wZXJ0aWVzXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBudWxsfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLF9fZGVjb3JhdGUoW2UuaW5zdGFuY2VEYXRhKCldLGkucHJvdG90eXBlLFwicHJvcGVydGllc1wiLG51bGwpLGl9KGUuU2hhcGUyREluc3RhbmNlRGF0YSk7ZS5SZWN0YW5nbGUyREluc3RhbmNlRGF0YT1pO3ZhciByPWZ1bmN0aW9uKHIpe2Z1bmN0aW9uIG4odCl7aWYobnVsbD09dCYmKHQ9e30pLHIuY2FsbCh0aGlzLHQpLG51bGwhPXQuc2l6ZSl0aGlzLnNpemU9dC5zaXplO2Vsc2UgaWYodC53aWR0aHx8dC5oZWlnaHQpe3ZhciBpPW5ldyBlLlNpemUodC53aWR0aCx0LmhlaWdodCk7dGhpcy5zaXplPWl9dmFyIG49bnVsbD09dC5yb3VuZFJhZGl1cz8wOnQucm91bmRSYWRpdXMsbz1udWxsPT10LmJvcmRlclRoaWNrbmVzcz8xOnQuYm9yZGVyVGhpY2tuZXNzO3RoaXMucm91bmRSYWRpdXM9bix0aGlzLmJvcmRlclRoaWNrbmVzcz1vfXJldHVybiBfX2V4dGVuZHMobixyKSxPYmplY3QuZGVmaW5lUHJvcGVydHkobi5wcm90b3R5cGUsXCJhY3R1YWxTaXplXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9hY3R1YWxTaXplP3RoaXMuX2FjdHVhbFNpemU6dGhpcy5zaXplfSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fYWN0dWFsU2l6ZT1lfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuLnByb3RvdHlwZSxcIm5vdFJvdW5kZWRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX25vdFJvdW5kZWR9LHNldDpmdW5jdGlvbihlKXt0aGlzLl9ub3RSb3VuZGVkPWV9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KG4ucHJvdG90eXBlLFwicm91bmRSYWRpdXNcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3JvdW5kUmFkaXVzfSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fcm91bmRSYWRpdXM9ZSx0aGlzLm5vdFJvdW5kZWQ9MD09PWUsdGhpcy5fcG9zaXRpb25pbmdEaXJ0eSgpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLG4ucHJvdG90eXBlLmxldmVsSW50ZXJzZWN0PWZ1bmN0aW9uKGUpe2lmKHRoaXMubm90Um91bmRlZClyZXR1cm4hMDt2YXIgdD10aGlzLnNpemU7bi5faTAueD1lLl9sb2NhbFBpY2tQb3NpdGlvbi54LG4uX2kwLnk9ZS5fbG9jYWxQaWNrUG9zaXRpb24ueTt2YXIgaT10aGlzLnJvdW5kUmFkaXVzLHI9aSppO3JldHVybiBuLl9pMS54PWksbi5faTEueT1pLG4uX2kwLng8PW4uX2kxLngmJm4uX2kwLnk8PW4uX2kxLnk/KG4uX2kyLng9bi5faTAueC1uLl9pMS54LG4uX2kyLnk9bi5faTAueS1uLl9pMS55LG4uX2kyLmxlbmd0aFNxdWFyZWQoKTw9cik6KG4uX2kxLng9aSxuLl9pMS55PXQuaGVpZ2h0LWksbi5faTAueDw9bi5faTEueCYmbi5faTAueT49bi5faTEueT8obi5faTIueD1uLl9pMC54LW4uX2kxLngsbi5faTIueT1uLl9pMC55LW4uX2kxLnksbi5faTIubGVuZ3RoU3F1YXJlZCgpPD1yKToobi5faTEueD10LndpZHRoLWksbi5faTEueT10LmhlaWdodC1pLG4uX2kwLng+PW4uX2kxLngmJm4uX2kwLnk+PW4uX2kxLnk/KG4uX2kyLng9bi5faTAueC1uLl9pMS54LG4uX2kyLnk9bi5faTAueS1uLl9pMS55LG4uX2kyLmxlbmd0aFNxdWFyZWQoKTw9cik6KG4uX2kxLng9dC53aWR0aC1pLG4uX2kxLnk9aSxuLl9pMC54Pj1uLl9pMS54JiZuLl9pMC55PD1uLl9pMS55PyhuLl9pMi54PW4uX2kwLngtbi5faTEueCxuLl9pMi55PW4uX2kwLnktbi5faTEueSxuLl9pMi5sZW5ndGhTcXVhcmVkKCk8PXIpOiEwKSkpfSxuLnByb3RvdHlwZS51cGRhdGVMZXZlbEJvdW5kaW5nSW5mbz1mdW5jdGlvbigpe2UuQm91bmRpbmdJbmZvMkQuQ3JlYXRlRnJvbVNpemVUb1JlZih0aGlzLmFjdHVhbFNpemUsdGhpcy5fbGV2ZWxCb3VuZGluZ0luZm8pfSxuLnByb3RvdHlwZS5jcmVhdGVNb2RlbFJlbmRlckNhY2hlPWZ1bmN0aW9uKGUpe3ZhciBpPW5ldyB0KHRoaXMub3duZXIuZW5naW5lLGUpO3JldHVybiBpfSxuLnByb3RvdHlwZS5zZXR1cE1vZGVsUmVuZGVyQ2FjaGU9ZnVuY3Rpb24odCl7dmFyIGk9dCxyPXRoaXMub3duZXIuZW5naW5lO2lmKHRoaXMuZmlsbCl7Zm9yKHZhciBvPTQqKHRoaXMubm90Um91bmRlZD8xOm4ucm91bmRTdWJkaXZpc2lvbnMpKzEscz1uZXcgRmxvYXQzMkFycmF5KG8pLGE9MDtvPmE7YSsrKXNbYV09YTtpLmZpbGxWQj1yLmNyZWF0ZVZlcnRleEJ1ZmZlcihzKTtmb3IodmFyIGg9by0xLGM9bmV3IEZsb2F0MzJBcnJheSgzKmgpLGE9MDtoPmE7YSsrKWNbMyphKzBdPTAsY1szKmErMl09YSsxLGNbMyphKzFdPWErMjtjWzMqaC0yXT0xLGkuZmlsbElCPXIuY3JlYXRlSW5kZXhCdWZmZXIoYyksaS5maWxsSW5kaWNlc0NvdW50PTMqaDt2YXIgbD10aGlzLmdldERhdGFQYXJ0RWZmZWN0SW5mbyhlLlNoYXBlMkQuU0hBUEUyRF9GSUxMUEFSVElELFtcImluZGV4XCJdLCEwKTtsJiYoaS5lZmZlY3RGaWxsSW5zdGFuY2VkPXIuY3JlYXRlRWZmZWN0KFwicmVjdDJkXCIsbC5hdHRyaWJ1dGVzLGwudW5pZm9ybXMsW10sbC5kZWZpbmVzLG51bGwpKSxsPXRoaXMuZ2V0RGF0YVBhcnRFZmZlY3RJbmZvKGUuU2hhcGUyRC5TSEFQRTJEX0ZJTExQQVJUSUQsW1wiaW5kZXhcIl0sITEpLGkuZWZmZWN0RmlsbD1yLmNyZWF0ZUVmZmVjdChcInJlY3QyZFwiLGwuYXR0cmlidXRlcyxsLnVuaWZvcm1zLFtdLGwuZGVmaW5lcyxudWxsKX1pZih0aGlzLmJvcmRlcil7Zm9yKHZhciBvPTQqKHRoaXMubm90Um91bmRlZD8xOm4ucm91bmRTdWJkaXZpc2lvbnMpKjIscz1uZXcgRmxvYXQzMkFycmF5KG8pLGE9MDtvPmE7YSsrKXNbYV09YTtpLmJvcmRlclZCPXIuY3JlYXRlVmVydGV4QnVmZmVyKHMpO2Zvcih2YXIgaD1vLHU9aC8yLGM9bmV3IEZsb2F0MzJBcnJheSgzKmgpLGE9MDt1PmE7YSsrKXt2YXIgZj1hLGQ9KGErMSkldTtjWzYqYSswXT11K2QsY1s2KmErMV09dStmLGNbNiphKzJdPWYsY1s2KmErM109ZCxjWzYqYSs0XT11K2QsY1s2KmErNV09Zn1pLmJvcmRlcklCPXIuY3JlYXRlSW5kZXhCdWZmZXIoYyksaS5ib3JkZXJJbmRpY2VzQ291bnQ9MypoO3ZhciBsPXRoaXMuZ2V0RGF0YVBhcnRFZmZlY3RJbmZvKGUuU2hhcGUyRC5TSEFQRTJEX0JPUkRFUlBBUlRJRCxbXCJpbmRleFwiXSwhMCk7bCYmKGkuZWZmZWN0Qm9yZGVySW5zdGFuY2VkPXIuY3JlYXRlRWZmZWN0KFwicmVjdDJkXCIsbC5hdHRyaWJ1dGVzLGwudW5pZm9ybXMsW10sbC5kZWZpbmVzLG51bGwpKSxsPXRoaXMuZ2V0RGF0YVBhcnRFZmZlY3RJbmZvKGUuU2hhcGUyRC5TSEFQRTJEX0JPUkRFUlBBUlRJRCxbXCJpbmRleFwiXSwhMSksaS5lZmZlY3RCb3JkZXI9ci5jcmVhdGVFZmZlY3QoXCJyZWN0MmRcIixsLmF0dHJpYnV0ZXMsbC51bmlmb3JtcyxbXSxsLmRlZmluZXMsbnVsbCl9cmV0dXJuIGl9LG4ucHJvdG90eXBlLl9nZXRJbml0aWFsQ29udGVudEFyZWFUb1JlZj1mdW5jdGlvbihlLHQsaSl7aWYodGhpcy5fbm90Um91bmRlZClyLnByb3RvdHlwZS5fZ2V0SW5pdGlhbENvbnRlbnRBcmVhVG9SZWYuY2FsbCh0aGlzLGUsdCxpKTtlbHNle3ZhciBuPU1hdGgucm91bmQoMS4zKih0aGlzLnJvdW5kUmFkaXVzLXRoaXMucm91bmRSYWRpdXMvTWF0aC5zcXJ0KDIpKSk7dC54PXQueT1uLGkud2lkdGg9TWF0aC5tYXgoMCxlLndpZHRoLTIqbiksaS5oZWlnaHQ9TWF0aC5tYXgoMCxlLmhlaWdodC0yKm4pfX0sbi5wcm90b3R5cGUuY3JlYXRlSW5zdGFuY2VEYXRhUGFydHM9ZnVuY3Rpb24oKXt2YXIgdD1uZXcgQXJyYXk7cmV0dXJuIHRoaXMuYm9yZGVyJiZ0LnB1c2gobmV3IGkoZS5TaGFwZTJELlNIQVBFMkRfQk9SREVSUEFSVElEKSksdGhpcy5maWxsJiZ0LnB1c2gobmV3IGkoZS5TaGFwZTJELlNIQVBFMkRfRklMTFBBUlRJRCkpLHR9LG4ucHJvdG90eXBlLnJlZnJlc2hJbnN0YW5jZURhdGFQYXJ0PWZ1bmN0aW9uKHQpe2lmKCFyLnByb3RvdHlwZS5yZWZyZXNoSW5zdGFuY2VEYXRhUGFydC5jYWxsKHRoaXMsdCkpcmV0dXJuITE7aWYodC5pZD09PWUuU2hhcGUyRC5TSEFQRTJEX0JPUkRFUlBBUlRJRCl7dmFyIGk9dCxuPXRoaXMuYWN0dWFsU2l6ZTtpLnByb3BlcnRpZXM9bmV3IGUuVmVjdG9yMyhuLndpZHRoLG4uaGVpZ2h0LHRoaXMucm91bmRSYWRpdXN8fDApfWVsc2UgaWYodC5pZD09PWUuU2hhcGUyRC5TSEFQRTJEX0ZJTExQQVJUSUQpe3ZhciBpPXQsbj10aGlzLmFjdHVhbFNpemU7aS5wcm9wZXJ0aWVzPW5ldyBlLlZlY3RvcjMobi53aWR0aCxuLmhlaWdodCx0aGlzLnJvdW5kUmFkaXVzfHwwKX1yZXR1cm4hMH0sbi5faTA9ZS5WZWN0b3IyLlplcm8oKSxuLl9pMT1lLlZlY3RvcjIuWmVybygpLG4uX2kyPWUuVmVjdG9yMi5aZXJvKCksbi5yb3VuZFN1YmRpdmlzaW9ucz0xNixfX2RlY29yYXRlKFtlLmluc3RhbmNlTGV2ZWxQcm9wZXJ0eShlLlNoYXBlMkQuU0hBUEUyRF9QUk9QQ09VTlQrMSxmdW5jdGlvbihlKXtyZXR1cm4gbi5hY3R1YWxTaXplUHJvcGVydHk9ZX0sITEsITApXSxuLnByb3RvdHlwZSxcImFjdHVhbFNpemVcIixudWxsKSxfX2RlY29yYXRlKFtlLm1vZGVsTGV2ZWxQcm9wZXJ0eShlLlNoYXBlMkQuU0hBUEUyRF9QUk9QQ09VTlQrMixmdW5jdGlvbihlKXtyZXR1cm4gbi5ub3RSb3VuZGVkUHJvcGVydHk9ZX0pXSxuLnByb3RvdHlwZSxcIm5vdFJvdW5kZWRcIixudWxsKSxfX2RlY29yYXRlKFtlLmluc3RhbmNlTGV2ZWxQcm9wZXJ0eShlLlNoYXBlMkQuU0hBUEUyRF9QUk9QQ09VTlQrMyxmdW5jdGlvbihlKXtyZXR1cm4gbi5yb3VuZFJhZGl1c1Byb3BlcnR5PWV9KV0sbi5wcm90b3R5cGUsXCJyb3VuZFJhZGl1c1wiLG51bGwpLG49X19kZWNvcmF0ZShbZS5jbGFzc05hbWUoXCJSZWN0YW5nbGUyRFwiKV0sbil9KGUuU2hhcGUyRCk7ZS5SZWN0YW5nbGUyRD1yfShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbih0KXtmdW5jdGlvbiBpKGUsaSl7dC5jYWxsKHRoaXMsZSxpKSx0aGlzLmVmZmVjdHNSZWFkeT0hMSx0aGlzLmZpbGxWQj1udWxsLHRoaXMuZmlsbElCPW51bGwsdGhpcy5maWxsSW5kaWNlc0NvdW50PTAsdGhpcy5pbnN0YW5jaW5nRmlsbEF0dHJpYnV0ZXM9bnVsbCx0aGlzLmVmZmVjdEZpbGxJbnN0YW5jZWQ9bnVsbCx0aGlzLmVmZmVjdEZpbGw9bnVsbCx0aGlzLmJvcmRlclZCPW51bGwsdGhpcy5ib3JkZXJJQj1udWxsLHRoaXMuYm9yZGVySW5kaWNlc0NvdW50PTAsdGhpcy5pbnN0YW5jaW5nQm9yZGVyQXR0cmlidXRlcz1udWxsLHRoaXMuZWZmZWN0Qm9yZGVySW5zdGFuY2VkPW51bGwsdGhpcy5lZmZlY3RCb3JkZXI9bnVsbH1yZXR1cm4gX19leHRlbmRzKGksdCksaS5wcm90b3R5cGUucmVuZGVyPWZ1bmN0aW9uKHQsaSl7aWYoIXRoaXMuZWZmZWN0c1JlYWR5KXtpZih0aGlzLmVmZmVjdEZpbGwmJighdGhpcy5lZmZlY3RGaWxsLmlzUmVhZHkoKXx8dGhpcy5lZmZlY3RGaWxsSW5zdGFuY2VkJiYhdGhpcy5lZmZlY3RGaWxsSW5zdGFuY2VkLmlzUmVhZHkoKSl8fHRoaXMuZWZmZWN0Qm9yZGVyJiYoIXRoaXMuZWZmZWN0Qm9yZGVyLmlzUmVhZHkoKXx8dGhpcy5lZmZlY3RCb3JkZXJJbnN0YW5jZWQmJiF0aGlzLmVmZmVjdEJvcmRlckluc3RhbmNlZC5pc1JlYWR5KCkpKXJldHVybiExO3RoaXMuZWZmZWN0c1JlYWR5PSEwfXZhciByPXQub3duZXIub3duZXIuZW5naW5lLG49MDt0aGlzLmVmZmVjdEZpbGwmJnRoaXMuZWZmZWN0Qm9yZGVyJiYobj1yLmdldERlcHRoRnVuY3Rpb24oKSxyLnNldERlcHRoRnVuY3Rpb25Ub0xlc3NPckVxdWFsKCkpO3ZhciBvPXIuZ2V0QWxwaGFNb2RlKCk7aWYodGhpcy5lZmZlY3RGaWxsKXt2YXIgcz10LnBhcnRJbmRleEZyb21JZC5nZXQoZS5TaGFwZTJELlNIQVBFMkRfRklMTFBBUlRJRC50b1N0cmluZygpKSxhPWkuZ3JvdXBJbmZvUGFydERhdGFbc107aS5yZW5kZXJNb2RlIT09ZS5SZW5kZXIyRENvbnRleHQuUmVuZGVyTW9kZU9wYXF1ZSYmci5zZXRBbHBoYU1vZGUoZS5FbmdpbmUuQUxQSEFfQ09NQklORSk7dmFyIGg9aS51c2VJbnN0YW5jaW5nP3RoaXMuZWZmZWN0RmlsbEluc3RhbmNlZDp0aGlzLmVmZmVjdEZpbGw7aWYoci5lbmFibGVFZmZlY3QoaCksci5iaW5kQnVmZmVyc0RpcmVjdGx5KHRoaXMuZmlsbFZCLHRoaXMuZmlsbElCLFsxXSw0LGgpLGkudXNlSW5zdGFuY2luZyl0aGlzLmluc3RhbmNpbmdGaWxsQXR0cmlidXRlc3x8KHRoaXMuaW5zdGFuY2luZ0ZpbGxBdHRyaWJ1dGVzPXRoaXMubG9hZEluc3RhbmNpbmdBdHRyaWJ1dGVzKGUuU2hhcGUyRC5TSEFQRTJEX0ZJTExQQVJUSUQsaCkpLHIudXBkYXRlQW5kQmluZEluc3RhbmNlc0J1ZmZlcihhLl9wYXJ0QnVmZmVyLG51bGwsdGhpcy5pbnN0YW5jaW5nRmlsbEF0dHJpYnV0ZXMpLHIuZHJhdyghMCwwLHRoaXMuZmlsbEluZGljZXNDb3VudCxhLl9wYXJ0RGF0YS51c2VkRWxlbWVudENvdW50KSxyLnVuYmluZEluc3RhbmNlQXR0cmlidXRlcygpO2Vsc2UgZm9yKHZhciBjPWkucGFydERhdGFTdGFydEluZGV4O2M8aS5wYXJ0RGF0YUVuZEluZGV4O2MrKyl0aGlzLnNldHVwVW5pZm9ybXMoaCxzLGEuX3BhcnREYXRhLGMpLHIuZHJhdyghMCwwLHRoaXMuZmlsbEluZGljZXNDb3VudCl9aWYodGhpcy5lZmZlY3RCb3JkZXIpe3ZhciBzPXQucGFydEluZGV4RnJvbUlkLmdldChlLlNoYXBlMkQuU0hBUEUyRF9CT1JERVJQQVJUSUQudG9TdHJpbmcoKSksYT1pLmdyb3VwSW5mb1BhcnREYXRhW3NdO2kucmVuZGVyTW9kZSE9PWUuUmVuZGVyMkRDb250ZXh0LlJlbmRlck1vZGVPcGFxdWUmJnIuc2V0QWxwaGFNb2RlKGUuRW5naW5lLkFMUEhBX0NPTUJJTkUpO3ZhciBoPWkudXNlSW5zdGFuY2luZz90aGlzLmVmZmVjdEJvcmRlckluc3RhbmNlZDp0aGlzLmVmZmVjdEJvcmRlcjtpZihyLmVuYWJsZUVmZmVjdChoKSxyLmJpbmRCdWZmZXJzRGlyZWN0bHkodGhpcy5ib3JkZXJWQix0aGlzLmJvcmRlcklCLFsxXSw0LGgpLGkudXNlSW5zdGFuY2luZyl0aGlzLmluc3RhbmNpbmdCb3JkZXJBdHRyaWJ1dGVzfHwodGhpcy5pbnN0YW5jaW5nQm9yZGVyQXR0cmlidXRlcz10aGlzLmxvYWRJbnN0YW5jaW5nQXR0cmlidXRlcyhlLlNoYXBlMkQuU0hBUEUyRF9CT1JERVJQQVJUSUQsaCkpLHIudXBkYXRlQW5kQmluZEluc3RhbmNlc0J1ZmZlcihhLl9wYXJ0QnVmZmVyLG51bGwsdGhpcy5pbnN0YW5jaW5nQm9yZGVyQXR0cmlidXRlcyksci5kcmF3KCEwLDAsdGhpcy5ib3JkZXJJbmRpY2VzQ291bnQsYS5fcGFydERhdGEudXNlZEVsZW1lbnRDb3VudCksci51bmJpbmRJbnN0YW5jZUF0dHJpYnV0ZXMoKTtlbHNlIGZvcih2YXIgYz1pLnBhcnREYXRhU3RhcnRJbmRleDtjPGkucGFydERhdGFFbmRJbmRleDtjKyspdGhpcy5zZXR1cFVuaWZvcm1zKGgscyxhLl9wYXJ0RGF0YSxjKSxyLmRyYXcoITAsMCx0aGlzLmJvcmRlckluZGljZXNDb3VudCl9cmV0dXJuIHIuc2V0QWxwaGFNb2RlKG8pLHRoaXMuZWZmZWN0RmlsbCYmdGhpcy5lZmZlY3RCb3JkZXImJnIuc2V0RGVwdGhGdW5jdGlvbihuKSwhMH0saS5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3JldHVybiB0LnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyk/KHRoaXMuZmlsbFZCJiYodGhpcy5fZW5naW5lLl9yZWxlYXNlQnVmZmVyKHRoaXMuZmlsbFZCKSx0aGlzLmZpbGxWQj1udWxsKSx0aGlzLmZpbGxJQiYmKHRoaXMuX2VuZ2luZS5fcmVsZWFzZUJ1ZmZlcih0aGlzLmZpbGxJQiksdGhpcy5maWxsSUI9bnVsbCksdGhpcy5lZmZlY3RGaWxsJiYodGhpcy5fZW5naW5lLl9yZWxlYXNlRWZmZWN0KHRoaXMuZWZmZWN0RmlsbCksdGhpcy5lZmZlY3RGaWxsPW51bGwpLHRoaXMuZWZmZWN0RmlsbEluc3RhbmNlZCYmKHRoaXMuX2VuZ2luZS5fcmVsZWFzZUVmZmVjdCh0aGlzLmVmZmVjdEZpbGxJbnN0YW5jZWQpLHRoaXMuZWZmZWN0RmlsbEluc3RhbmNlZD1udWxsKSx0aGlzLmJvcmRlclZCJiYodGhpcy5fZW5naW5lLl9yZWxlYXNlQnVmZmVyKHRoaXMuYm9yZGVyVkIpLHRoaXMuYm9yZGVyVkI9bnVsbCksdGhpcy5ib3JkZXJJQiYmKHRoaXMuX2VuZ2luZS5fcmVsZWFzZUJ1ZmZlcih0aGlzLmJvcmRlcklCKSx0aGlzLmJvcmRlcklCPW51bGwpLHRoaXMuZWZmZWN0Qm9yZGVyJiYodGhpcy5fZW5naW5lLl9yZWxlYXNlRWZmZWN0KHRoaXMuZWZmZWN0Qm9yZGVyKSx0aGlzLmVmZmVjdEJvcmRlcj1udWxsKSx0aGlzLmVmZmVjdEJvcmRlckluc3RhbmNlZCYmKHRoaXMuX2VuZ2luZS5fcmVsZWFzZUVmZmVjdCh0aGlzLmVmZmVjdEJvcmRlckluc3RhbmNlZCksdGhpcy5lZmZlY3RCb3JkZXJJbnN0YW5jZWQ9bnVsbCksITApOiExfSxpfShlLk1vZGVsUmVuZGVyQ2FjaGUpO2UuRWxsaXBzZTJEUmVuZGVyQ2FjaGU9dDt2YXIgaT1mdW5jdGlvbih0KXtmdW5jdGlvbiBpKGUpe3QuY2FsbCh0aGlzLGUsMSl9cmV0dXJuIF9fZXh0ZW5kcyhpLHQpLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcInByb3BlcnRpZXNcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIG51bGx9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksX19kZWNvcmF0ZShbZS5pbnN0YW5jZURhdGEoKV0saS5wcm90b3R5cGUsXCJwcm9wZXJ0aWVzXCIsbnVsbCksaX0oZS5TaGFwZTJESW5zdGFuY2VEYXRhKTtlLkVsbGlwc2UyREluc3RhbmNlRGF0YT1pO3ZhciByPWZ1bmN0aW9uKHIpe2Z1bmN0aW9uIG4odCl7aWYobnVsbD09dCYmKHQ9e30pLHIuY2FsbCh0aGlzLHQpLG51bGwhPXQuc2l6ZSl0aGlzLnNpemU9dC5zaXplO2Vsc2UgaWYodC53aWR0aHx8dC5oZWlnaHQpe3ZhciBpPW5ldyBlLlNpemUodC53aWR0aCx0LmhlaWdodCk7dGhpcy5zaXplPWl9dmFyIG49bnVsbD09dC5zdWJkaXZpc2lvbnM/NjQ6dC5zdWJkaXZpc2lvbnM7dGhpcy5zdWJkaXZpc2lvbnM9bn1yZXR1cm4gX19leHRlbmRzKG4sciksT2JqZWN0LmRlZmluZVByb3BlcnR5KG4ucHJvdG90eXBlLFwiYWN0dWFsU2l6ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fYWN0dWFsU2l6ZT90aGlzLl9hY3R1YWxTaXplOnRoaXMuc2l6ZX0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX2FjdHVhbFNpemU9ZX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkobi5wcm90b3R5cGUsXCJzdWJkaXZpc2lvbnNcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3N1YmRpdmlzaW9uc30sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX3N1YmRpdmlzaW9ucz1lfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLG4ucHJvdG90eXBlLmxldmVsSW50ZXJzZWN0PWZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuc2l6ZS53aWR0aC8yLGk9dGhpcy5zaXplLmhlaWdodC8yLHI9ZS5fbG9jYWxQaWNrUG9zaXRpb24ueC10LG49ZS5fbG9jYWxQaWNrUG9zaXRpb24ueS1pO3JldHVybiAxPj1yKnIvKHQqdCkrbipuLyhpKmkpfSxuLnByb3RvdHlwZS51cGRhdGVMZXZlbEJvdW5kaW5nSW5mbz1mdW5jdGlvbigpe2UuQm91bmRpbmdJbmZvMkQuQ3JlYXRlRnJvbVNpemVUb1JlZih0aGlzLmFjdHVhbFNpemUsdGhpcy5fbGV2ZWxCb3VuZGluZ0luZm8pfSxuLnByb3RvdHlwZS5jcmVhdGVNb2RlbFJlbmRlckNhY2hlPWZ1bmN0aW9uKGUpe3ZhciBpPW5ldyB0KHRoaXMub3duZXIuZW5naW5lLGUpO3JldHVybiBpfSxuLnByb3RvdHlwZS5zZXR1cE1vZGVsUmVuZGVyQ2FjaGU9ZnVuY3Rpb24odCl7dmFyIGk9dCxyPXRoaXMub3duZXIuZW5naW5lO2lmKHRoaXMuZmlsbCl7Zm9yKHZhciBuPXRoaXMuc3ViZGl2aXNpb25zKzEsbz1uZXcgRmxvYXQzMkFycmF5KG4pLHM9MDtuPnM7cysrKW9bc109cztpLmZpbGxWQj1yLmNyZWF0ZVZlcnRleEJ1ZmZlcihvKTtmb3IodmFyIGE9bi0xLGg9bmV3IEZsb2F0MzJBcnJheSgzKmEpLHM9MDthPnM7cysrKWhbMypzKzBdPTAsaFszKnMrMl09cysxLGhbMypzKzFdPXMrMjtoWzMqYS0yXT0xLGkuZmlsbElCPXIuY3JlYXRlSW5kZXhCdWZmZXIoaCksaS5maWxsSW5kaWNlc0NvdW50PTMqYTt2YXIgYz10aGlzLmdldERhdGFQYXJ0RWZmZWN0SW5mbyhlLlNoYXBlMkQuU0hBUEUyRF9GSUxMUEFSVElELFtcImluZGV4XCJdLCEwKTtjJiYoaS5lZmZlY3RGaWxsSW5zdGFuY2VkPXIuY3JlYXRlRWZmZWN0KHt2ZXJ0ZXg6XCJlbGxpcHNlMmRcIixmcmFnbWVudDpcImVsbGlwc2UyZFwifSxjLmF0dHJpYnV0ZXMsYy51bmlmb3JtcyxbXSxjLmRlZmluZXMsbnVsbCkpLGM9dGhpcy5nZXREYXRhUGFydEVmZmVjdEluZm8oZS5TaGFwZTJELlNIQVBFMkRfRklMTFBBUlRJRCxbXCJpbmRleFwiXSwhMSksaS5lZmZlY3RGaWxsPXIuY3JlYXRlRWZmZWN0KHt2ZXJ0ZXg6XCJlbGxpcHNlMmRcIixmcmFnbWVudDpcImVsbGlwc2UyZFwifSxjLmF0dHJpYnV0ZXMsYy51bmlmb3JtcyxbXSxjLmRlZmluZXMsbnVsbCl9aWYodGhpcy5ib3JkZXIpe2Zvcih2YXIgbj0yKnRoaXMuc3ViZGl2aXNpb25zLG89bmV3IEZsb2F0MzJBcnJheShuKSxzPTA7bj5zO3MrKylvW3NdPXM7aS5ib3JkZXJWQj1yLmNyZWF0ZVZlcnRleEJ1ZmZlcihvKTtmb3IodmFyIGE9bixsPWEvMixoPW5ldyBGbG9hdDMyQXJyYXkoMyphKSxzPTA7bD5zO3MrKyl7dmFyIHU9cyxmPShzKzEpJWw7aFs2KnMrMF09bCtmLGhbNipzKzFdPWwrdSxoWzYqcysyXT11LGhbNipzKzNdPWYsaFs2KnMrNF09bCtmLGhbNipzKzVdPXV9aS5ib3JkZXJJQj1yLmNyZWF0ZUluZGV4QnVmZmVyKGgpLGkuYm9yZGVySW5kaWNlc0NvdW50PTMqYTt2YXIgYz10aGlzLmdldERhdGFQYXJ0RWZmZWN0SW5mbyhlLlNoYXBlMkQuU0hBUEUyRF9CT1JERVJQQVJUSUQsW1wiaW5kZXhcIl0sITApO2MmJihpLmVmZmVjdEJvcmRlckluc3RhbmNlZD1yLmNyZWF0ZUVmZmVjdChcImVsbGlwc2UyZFwiLGMuYXR0cmlidXRlcyxjLnVuaWZvcm1zLFtdLGMuZGVmaW5lcyxudWxsKSksYz10aGlzLmdldERhdGFQYXJ0RWZmZWN0SW5mbyhlLlNoYXBlMkQuU0hBUEUyRF9CT1JERVJQQVJUSUQsW1wiaW5kZXhcIl0sITEpLGkuZWZmZWN0Qm9yZGVyPXIuY3JlYXRlRWZmZWN0KFwiZWxsaXBzZTJkXCIsYy5hdHRyaWJ1dGVzLGMudW5pZm9ybXMsW10sYy5kZWZpbmVzLG51bGwpfXJldHVybiBpfSxuLnByb3RvdHlwZS5jcmVhdGVJbnN0YW5jZURhdGFQYXJ0cz1mdW5jdGlvbigpe3ZhciB0PW5ldyBBcnJheTtyZXR1cm4gdGhpcy5ib3JkZXImJnQucHVzaChuZXcgaShlLlNoYXBlMkQuU0hBUEUyRF9CT1JERVJQQVJUSUQpKSx0aGlzLmZpbGwmJnQucHVzaChuZXcgaShlLlNoYXBlMkQuU0hBUEUyRF9GSUxMUEFSVElEKSksdH0sbi5wcm90b3R5cGUucmVmcmVzaEluc3RhbmNlRGF0YVBhcnQ9ZnVuY3Rpb24odCl7aWYoIXIucHJvdG90eXBlLnJlZnJlc2hJbnN0YW5jZURhdGFQYXJ0LmNhbGwodGhpcyx0KSlyZXR1cm4hMTtpZih0LmlkPT09ZS5TaGFwZTJELlNIQVBFMkRfQk9SREVSUEFSVElEKXt2YXIgaT10LG49dGhpcy5hY3R1YWxTaXplO2kucHJvcGVydGllcz1uZXcgZS5WZWN0b3IzKG4ud2lkdGgsbi5oZWlnaHQsdGhpcy5zdWJkaXZpc2lvbnMpfWVsc2UgaWYodC5pZD09PWUuU2hhcGUyRC5TSEFQRTJEX0ZJTExQQVJUSUQpe3ZhciBpPXQsbj10aGlzLmFjdHVhbFNpemU7aS5wcm9wZXJ0aWVzPW5ldyBlLlZlY3RvcjMobi53aWR0aCxuLmhlaWdodCx0aGlzLnN1YmRpdmlzaW9ucyl9cmV0dXJuITB9LF9fZGVjb3JhdGUoW2UuaW5zdGFuY2VMZXZlbFByb3BlcnR5KGUuU2hhcGUyRC5TSEFQRTJEX1BST1BDT1VOVCsxLGZ1bmN0aW9uKGUpe3JldHVybiBuLmFjdXRhbFNpemVQcm9wZXJ0eT1lfSwhMSwhMCldLG4ucHJvdG90eXBlLFwiYWN0dWFsU2l6ZVwiLG51bGwpLF9fZGVjb3JhdGUoW2UubW9kZWxMZXZlbFByb3BlcnR5KGUuU2hhcGUyRC5TSEFQRTJEX1BST1BDT1VOVCsyLGZ1bmN0aW9uKGUpe3JldHVybiBuLnN1YmRpdmlzaW9uc1Byb3BlcnR5PWU7XG59KV0sbi5wcm90b3R5cGUsXCJzdWJkaXZpc2lvbnNcIixudWxsKSxuPV9fZGVjb3JhdGUoW2UuY2xhc3NOYW1lKFwiRWxsaXBzZTJEXCIpXSxuKX0oZS5TaGFwZTJEKTtlLkVsbGlwc2UyRD1yfShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbih0KXtmdW5jdGlvbiBpKCl7dC5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5lZmZlY3RzUmVhZHk9ITEsdGhpcy52Yj1udWxsLHRoaXMuaWI9bnVsbCx0aGlzLmluc3RhbmNpbmdBdHRyaWJ1dGVzPW51bGwsdGhpcy50ZXh0dXJlPW51bGwsdGhpcy5lZmZlY3Q9bnVsbCx0aGlzLmVmZmVjdEluc3RhbmNlZD1udWxsfXJldHVybiBfX2V4dGVuZHMoaSx0KSxpLnByb3RvdHlwZS5yZW5kZXI9ZnVuY3Rpb24odCxpKXtpZighdGhpcy5lZmZlY3RzUmVhZHkpe2lmKHRoaXMuZWZmZWN0JiYoIXRoaXMuZWZmZWN0LmlzUmVhZHkoKXx8dGhpcy5lZmZlY3RJbnN0YW5jZWQmJiF0aGlzLmVmZmVjdEluc3RhbmNlZC5pc1JlYWR5KCkpKXJldHVybiExO3RoaXMuZWZmZWN0c1JlYWR5PSEwfXZhciBuPXQub3duZXIub3duZXIuZW5naW5lLG89aS51c2VJbnN0YW5jaW5nP3RoaXMuZWZmZWN0SW5zdGFuY2VkOnRoaXMuZWZmZWN0O24uZW5hYmxlRWZmZWN0KG8pLG8uc2V0VGV4dHVyZShcImRpZmZ1c2VTYW1wbGVyXCIsdGhpcy50ZXh0dXJlKSxuLmJpbmRCdWZmZXJzRGlyZWN0bHkodGhpcy52Yix0aGlzLmliLFsxXSw0LG8pO3ZhciBzPW4uZ2V0QWxwaGFNb2RlKCk7aS5yZW5kZXJNb2RlIT09ZS5SZW5kZXIyRENvbnRleHQuUmVuZGVyTW9kZU9wYXF1ZSYmbi5zZXRBbHBoYU1vZGUoZS5FbmdpbmUuQUxQSEFfQ09NQklORSk7dmFyIGE9aS5ncm91cEluZm9QYXJ0RGF0YVswXTtpZihpLnVzZUluc3RhbmNpbmcpdGhpcy5pbnN0YW5jaW5nQXR0cmlidXRlc3x8KHRoaXMuaW5zdGFuY2luZ0F0dHJpYnV0ZXM9dGhpcy5sb2FkSW5zdGFuY2luZ0F0dHJpYnV0ZXMoci5TUFJJVEUyRF9NQUlOUEFSVElELG8pKSxuLnVwZGF0ZUFuZEJpbmRJbnN0YW5jZXNCdWZmZXIoYS5fcGFydEJ1ZmZlcixudWxsLHRoaXMuaW5zdGFuY2luZ0F0dHJpYnV0ZXMpLG4uZHJhdyghMCwwLDYsYS5fcGFydERhdGEudXNlZEVsZW1lbnRDb3VudCksbi51bmJpbmRJbnN0YW5jZUF0dHJpYnV0ZXMoKTtlbHNlIGZvcih2YXIgaD1pLnBhcnREYXRhU3RhcnRJbmRleDtoPGkucGFydERhdGFFbmRJbmRleDtoKyspdGhpcy5zZXR1cFVuaWZvcm1zKG8sMCxhLl9wYXJ0RGF0YSxoKSxuLmRyYXcoITAsMCw2KTtyZXR1cm4gbi5zZXRBbHBoYU1vZGUocyksITB9LGkucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXtyZXR1cm4gdC5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpPyh0aGlzLnZiJiYodGhpcy5fZW5naW5lLl9yZWxlYXNlQnVmZmVyKHRoaXMudmIpLHRoaXMudmI9bnVsbCksdGhpcy5pYiYmKHRoaXMuX2VuZ2luZS5fcmVsZWFzZUJ1ZmZlcih0aGlzLmliKSx0aGlzLmliPW51bGwpLHRoaXMudGV4dHVyZSYmKHRoaXMudGV4dHVyZS5kaXNwb3NlKCksdGhpcy50ZXh0dXJlPW51bGwpLHRoaXMuZWZmZWN0JiYodGhpcy5fZW5naW5lLl9yZWxlYXNlRWZmZWN0KHRoaXMuZWZmZWN0KSx0aGlzLmVmZmVjdD1udWxsKSx0aGlzLmVmZmVjdEluc3RhbmNlZCYmKHRoaXMuX2VuZ2luZS5fcmVsZWFzZUVmZmVjdCh0aGlzLmVmZmVjdEluc3RhbmNlZCksdGhpcy5lZmZlY3RJbnN0YW5jZWQ9bnVsbCksITApOiExfSxpfShlLk1vZGVsUmVuZGVyQ2FjaGUpO2UuU3ByaXRlMkRSZW5kZXJDYWNoZT10O3ZhciBpPWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGkoZSl7dC5jYWxsKHRoaXMsZSwxKX1yZXR1cm4gX19leHRlbmRzKGksdCksT2JqZWN0LmRlZmluZVByb3BlcnR5KGkucHJvdG90eXBlLFwidG9wTGVmdFVWXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBudWxsfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcInNpemVVVlwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJ0ZXh0dXJlU2l6ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJwcm9wZXJ0aWVzXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBudWxsfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLF9fZGVjb3JhdGUoW2UuaW5zdGFuY2VEYXRhKCldLGkucHJvdG90eXBlLFwidG9wTGVmdFVWXCIsbnVsbCksX19kZWNvcmF0ZShbZS5pbnN0YW5jZURhdGEoKV0saS5wcm90b3R5cGUsXCJzaXplVVZcIixudWxsKSxfX2RlY29yYXRlKFtlLmluc3RhbmNlRGF0YSgpXSxpLnByb3RvdHlwZSxcInRleHR1cmVTaXplXCIsbnVsbCksX19kZWNvcmF0ZShbZS5pbnN0YW5jZURhdGEoKV0saS5wcm90b3R5cGUsXCJwcm9wZXJ0aWVzXCIsbnVsbCksaX0oZS5JbnN0YW5jZURhdGFCYXNlKTtlLlNwcml0ZTJESW5zdGFuY2VEYXRhPWk7dmFyIHI9ZnVuY3Rpb24ocil7ZnVuY3Rpb24gbih0LGkpe2lmKGl8fChpPXt9KSxyLmNhbGwodGhpcyxpKSx0aGlzLnRleHR1cmU9dCx0aGlzLnRleHR1cmUud3JhcFU9ZS5UZXh0dXJlLkNMQU1QX0FERFJFU1NNT0RFLHRoaXMudGV4dHVyZS53cmFwVj1lLlRleHR1cmUuQ0xBTVBfQUREUkVTU01PREUsdGhpcy5zaXplPWkuc3ByaXRlU2l6ZXx8bnVsbCx0aGlzLnNwcml0ZUxvY2F0aW9uPWkuc3ByaXRlTG9jYXRpb258fG5ldyBlLlZlY3RvcjIoMCwwKSx0aGlzLnNwcml0ZUZyYW1lPTAsdGhpcy5pbnZlcnRZPW51bGw9PWkuaW52ZXJ0WT8hMTppLmludmVydFksdGhpcy5hbGlnblRvUGl4ZWw9bnVsbD09aS5hbGlnblRvUGl4ZWw/ITA6aS5hbGlnblRvUGl4ZWwsdGhpcy5faXNUcmFuc3BhcmVudD0hMCwhdGhpcy5zaXplKXt2YXIgbj10LmdldFNpemUoKTt0aGlzLnNpemU9bmV3IGUuU2l6ZShuLndpZHRoLG4uaGVpZ2h0KX19cmV0dXJuIF9fZXh0ZW5kcyhuLHIpLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuLnByb3RvdHlwZSxcInRleHR1cmVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3RleHR1cmV9LHNldDpmdW5jdGlvbihlKXt0aGlzLl90ZXh0dXJlPWV9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KG4ucHJvdG90eXBlLFwiYWN0dWFsU2l6ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fYWN0dWFsU2l6ZT90aGlzLl9hY3R1YWxTaXplOnRoaXMuc2l6ZX0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX2FjdHVhbFNpemU9ZX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkobi5wcm90b3R5cGUsXCJzcHJpdGVMb2NhdGlvblwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fbG9jYXRpb259LHNldDpmdW5jdGlvbihlKXt0aGlzLl9sb2NhdGlvbj1lfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuLnByb3RvdHlwZSxcInNwcml0ZUZyYW1lXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9zcHJpdGVGcmFtZX0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX3Nwcml0ZUZyYW1lPWV9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KG4ucHJvdG90eXBlLFwiaW52ZXJ0WVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faW52ZXJ0WX0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX2ludmVydFk9ZX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkobi5wcm90b3R5cGUsXCJhbGlnblRvUGl4ZWxcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2FsaWduVG9QaXhlbH0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX2FsaWduVG9QaXhlbD1lfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLG4ucHJvdG90eXBlLnVwZGF0ZUxldmVsQm91bmRpbmdJbmZvPWZ1bmN0aW9uKCl7ZS5Cb3VuZGluZ0luZm8yRC5DcmVhdGVGcm9tU2l6ZVRvUmVmKHRoaXMuc2l6ZSx0aGlzLl9sZXZlbEJvdW5kaW5nSW5mbyl9LG4ucHJvdG90eXBlLmdldEFuaW1hdGFibGVzPWZ1bmN0aW9uKCl7dmFyIGU9bmV3IEFycmF5O3JldHVybiB0aGlzLnRleHR1cmUmJnRoaXMudGV4dHVyZS5hbmltYXRpb25zJiZ0aGlzLnRleHR1cmUuYW5pbWF0aW9ucy5sZW5ndGg+MCYmZS5wdXNoKHRoaXMudGV4dHVyZSksZX0sbi5wcm90b3R5cGUubGV2ZWxJbnRlcnNlY3Q9ZnVuY3Rpb24oZSl7cmV0dXJuITB9LG4uX2NyZWF0ZUNhY2hlZENhbnZhc1Nwcml0ZT1mdW5jdGlvbih0LGkscixvKXt2YXIgcz1uZXcgbihpLHtwYXJlbnQ6dCxpZDpcIl9fY2FjaGVkQ2FudmFzU3ByaXRlX19cIixwb3NpdGlvbjplLlZlY3RvcjIuWmVybygpLG9yaWdpbjplLlZlY3RvcjIuWmVybygpLHNwcml0ZVNpemU6cixzcHJpdGVMb2NhdGlvbjpvLGFsaWduVG9QaXhlbDohMH0pO3JldHVybiBzfSxuLnByb3RvdHlwZS5jcmVhdGVNb2RlbFJlbmRlckNhY2hlPWZ1bmN0aW9uKGUpe3ZhciBpPW5ldyB0KHRoaXMub3duZXIuZW5naW5lLGUpO3JldHVybiBpfSxuLnByb3RvdHlwZS5zZXR1cE1vZGVsUmVuZGVyQ2FjaGU9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PWUsaT10aGlzLm93bmVyLmVuZ2luZSxyPW5ldyBGbG9hdDMyQXJyYXkoNCksbz0wOzQ+bztvKyspcltvXT1vO3QudmI9aS5jcmVhdGVWZXJ0ZXhCdWZmZXIocik7dmFyIHM9bmV3IEZsb2F0MzJBcnJheSg2KTtzWzBdPTAsc1sxXT0yLHNbMl09MSxzWzNdPTAsc1s0XT0zLHNbNV09Mix0LmliPWkuY3JlYXRlSW5kZXhCdWZmZXIocyksdC50ZXh0dXJlPXRoaXMudGV4dHVyZTt2YXIgYT10aGlzLmdldERhdGFQYXJ0RWZmZWN0SW5mbyhuLlNQUklURTJEX01BSU5QQVJUSUQsW1wiaW5kZXhcIl0sITApO3JldHVybiBhJiYodC5lZmZlY3RJbnN0YW5jZWQ9aS5jcmVhdGVFZmZlY3QoXCJzcHJpdGUyZFwiLGEuYXR0cmlidXRlcyxhLnVuaWZvcm1zLFtcImRpZmZ1c2VTYW1wbGVyXCJdLGEuZGVmaW5lcyxudWxsKSksYT10aGlzLmdldERhdGFQYXJ0RWZmZWN0SW5mbyhuLlNQUklURTJEX01BSU5QQVJUSUQsW1wiaW5kZXhcIl0sITEpLHQuZWZmZWN0PWkuY3JlYXRlRWZmZWN0KFwic3ByaXRlMmRcIixhLmF0dHJpYnV0ZXMsYS51bmlmb3JtcyxbXCJkaWZmdXNlU2FtcGxlclwiXSxhLmRlZmluZXMsbnVsbCksdH0sbi5wcm90b3R5cGUuY3JlYXRlSW5zdGFuY2VEYXRhUGFydHM9ZnVuY3Rpb24oKXtyZXR1cm5bbmV3IGkobi5TUFJJVEUyRF9NQUlOUEFSVElEKV19LG4ucHJvdG90eXBlLnJlZnJlc2hJbnN0YW5jZURhdGFQYXJ0PWZ1bmN0aW9uKHQpe2lmKCFyLnByb3RvdHlwZS5yZWZyZXNoSW5zdGFuY2VEYXRhUGFydC5jYWxsKHRoaXMsdCkpcmV0dXJuITE7aWYodC5pZD09PW4uU1BSSVRFMkRfTUFJTlBBUlRJRCl7dmFyIGk9dGhpcy5faW5zdGFuY2VEYXRhUGFydHNbMF0sbz10aGlzLnRleHR1cmUuZ2V0QmFzZVNpemUoKSxzPXRoaXMuc3ByaXRlTG9jYXRpb24sYT10aGlzLmFjdHVhbFNpemU7aS50b3BMZWZ0VVY9bmV3IGUuVmVjdG9yMihzLngvby53aWR0aCxzLnkvby5oZWlnaHQpO3ZhciBoPW5ldyBlLlZlY3RvcjIoYS53aWR0aC9vLndpZHRoLGEuaGVpZ2h0L28uaGVpZ2h0KTtpLnNpemVVVj1oLG4uX3Byb3AueD10aGlzLnNwcml0ZUZyYW1lLG4uX3Byb3AueT10aGlzLmludmVydFk/MTowLG4uX3Byb3Auej10aGlzLmFsaWduVG9QaXhlbD8xOjAsaS5wcm9wZXJ0aWVzPW4uX3Byb3AsaS50ZXh0dXJlU2l6ZT1uZXcgZS5WZWN0b3IyKG8ud2lkdGgsby5oZWlnaHQpfXJldHVybiEwfSxuLlNQUklURTJEX01BSU5QQVJUSUQ9MSxuLl9wcm9wPWUuVmVjdG9yMy5aZXJvKCksX19kZWNvcmF0ZShbZS5tb2RlbExldmVsUHJvcGVydHkoZS5SZW5kZXJhYmxlUHJpbTJELlJFTkRFUkFCTEVQUklNMkRfUFJPUENPVU5UKzEsZnVuY3Rpb24oZSl7cmV0dXJuIG4udGV4dHVyZVByb3BlcnR5PWV9KV0sbi5wcm90b3R5cGUsXCJ0ZXh0dXJlXCIsbnVsbCksX19kZWNvcmF0ZShbZS5pbnN0YW5jZUxldmVsUHJvcGVydHkoZS5SZW5kZXJhYmxlUHJpbTJELlJFTkRFUkFCTEVQUklNMkRfUFJPUENPVU5UKzIsZnVuY3Rpb24oZSl7cmV0dXJuIG4uYWN0dWFsU2l6ZVByb3BlcnR5PWV9LCExLCEwKV0sbi5wcm90b3R5cGUsXCJhY3R1YWxTaXplXCIsbnVsbCksX19kZWNvcmF0ZShbZS5pbnN0YW5jZUxldmVsUHJvcGVydHkoZS5SZW5kZXJhYmxlUHJpbTJELlJFTkRFUkFCTEVQUklNMkRfUFJPUENPVU5UKzMsZnVuY3Rpb24oZSl7cmV0dXJuIG4uc3ByaXRlTG9jYXRpb25Qcm9wZXJ0eT1lfSldLG4ucHJvdG90eXBlLFwic3ByaXRlTG9jYXRpb25cIixudWxsKSxfX2RlY29yYXRlKFtlLmluc3RhbmNlTGV2ZWxQcm9wZXJ0eShlLlJlbmRlcmFibGVQcmltMkQuUkVOREVSQUJMRVBSSU0yRF9QUk9QQ09VTlQrNCxmdW5jdGlvbihlKXtyZXR1cm4gbi5zcHJpdGVGcmFtZVByb3BlcnR5PWV9KV0sbi5wcm90b3R5cGUsXCJzcHJpdGVGcmFtZVwiLG51bGwpLF9fZGVjb3JhdGUoW2UuaW5zdGFuY2VMZXZlbFByb3BlcnR5KGUuUmVuZGVyYWJsZVByaW0yRC5SRU5ERVJBQkxFUFJJTTJEX1BST1BDT1VOVCs1LGZ1bmN0aW9uKGUpe3JldHVybiBuLmludmVydFlQcm9wZXJ0eT1lfSldLG4ucHJvdG90eXBlLFwiaW52ZXJ0WVwiLG51bGwpLG49X19kZWNvcmF0ZShbZS5jbGFzc05hbWUoXCJTcHJpdGUyRFwiKV0sbil9KGUuUmVuZGVyYWJsZVByaW0yRCk7ZS5TcHJpdGUyRD1yfShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbih0KXtmdW5jdGlvbiBpKCl7dC5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5lZmZlY3RzUmVhZHk9ITEsdGhpcy52Yj1udWxsLHRoaXMuaWI9bnVsbCx0aGlzLmluc3RhbmNpbmdBdHRyaWJ1dGVzPW51bGwsdGhpcy5mb250VGV4dHVyZT1udWxsLHRoaXMuZWZmZWN0PW51bGwsdGhpcy5lZmZlY3RJbnN0YW5jZWQ9bnVsbH1yZXR1cm4gX19leHRlbmRzKGksdCksaS5wcm90b3R5cGUucmVuZGVyPWZ1bmN0aW9uKHQsaSl7aWYoIXRoaXMuZWZmZWN0c1JlYWR5KXtpZih0aGlzLmVmZmVjdCYmKCF0aGlzLmVmZmVjdC5pc1JlYWR5KCl8fHRoaXMuZWZmZWN0SW5zdGFuY2VkJiYhdGhpcy5lZmZlY3RJbnN0YW5jZWQuaXNSZWFkeSgpKSlyZXR1cm4hMTt0aGlzLmVmZmVjdHNSZWFkeT0hMH12YXIgbj10Lm93bmVyLm93bmVyLmVuZ2luZTt0aGlzLmZvbnRUZXh0dXJlLnVwZGF0ZSgpO3ZhciBvPWkudXNlSW5zdGFuY2luZz90aGlzLmVmZmVjdEluc3RhbmNlZDp0aGlzLmVmZmVjdDtuLmVuYWJsZUVmZmVjdChvKSxvLnNldFRleHR1cmUoXCJkaWZmdXNlU2FtcGxlclwiLHRoaXMuZm9udFRleHR1cmUpLG4uYmluZEJ1ZmZlcnNEaXJlY3RseSh0aGlzLnZiLHRoaXMuaWIsWzFdLDQsbyk7dmFyIHM9bi5nZXRBbHBoYU1vZGUoKTtuLnNldEFscGhhTW9kZShlLkVuZ2luZS5BTFBIQV9DT01CSU5FLCEwKTt2YXIgYT1pLmdyb3VwSW5mb1BhcnREYXRhWzBdO2lmKGkudXNlSW5zdGFuY2luZyl0aGlzLmluc3RhbmNpbmdBdHRyaWJ1dGVzfHwodGhpcy5pbnN0YW5jaW5nQXR0cmlidXRlcz10aGlzLmxvYWRJbnN0YW5jaW5nQXR0cmlidXRlcyhyLlRFWFQyRF9NQUlOUEFSVElELG8pKSxuLnVwZGF0ZUFuZEJpbmRJbnN0YW5jZXNCdWZmZXIoYS5fcGFydEJ1ZmZlcixudWxsLHRoaXMuaW5zdGFuY2luZ0F0dHJpYnV0ZXMpLG4uZHJhdyghMCwwLDYsYS5fcGFydERhdGEudXNlZEVsZW1lbnRDb3VudCksbi51bmJpbmRJbnN0YW5jZUF0dHJpYnV0ZXMoKTtlbHNlIGZvcih2YXIgaD1pLnBhcnREYXRhU3RhcnRJbmRleDtoPGkucGFydERhdGFFbmRJbmRleDtoKyspdGhpcy5zZXR1cFVuaWZvcm1zKG8sMCxhLl9wYXJ0RGF0YSxoKSxuLmRyYXcoITAsMCw2KTtyZXR1cm4gbi5zZXRBbHBoYU1vZGUocyksITB9LGkucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXtyZXR1cm4gdC5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpPyh0aGlzLnZiJiYodGhpcy5fZW5naW5lLl9yZWxlYXNlQnVmZmVyKHRoaXMudmIpLHRoaXMudmI9bnVsbCksdGhpcy5pYiYmKHRoaXMuX2VuZ2luZS5fcmVsZWFzZUJ1ZmZlcih0aGlzLmliKSx0aGlzLmliPW51bGwpLHRoaXMuZm9udFRleHR1cmUmJih0aGlzLmZvbnRUZXh0dXJlLmRpc3Bvc2UoKSx0aGlzLmZvbnRUZXh0dXJlPW51bGwpLHRoaXMuZWZmZWN0JiYodGhpcy5fZW5naW5lLl9yZWxlYXNlRWZmZWN0KHRoaXMuZWZmZWN0KSx0aGlzLmVmZmVjdD1udWxsKSx0aGlzLmVmZmVjdEluc3RhbmNlZCYmKHRoaXMuX2VuZ2luZS5fcmVsZWFzZUVmZmVjdCh0aGlzLmVmZmVjdEluc3RhbmNlZCksdGhpcy5lZmZlY3RJbnN0YW5jZWQ9bnVsbCksITApOiExfSxpfShlLk1vZGVsUmVuZGVyQ2FjaGUpO2UuVGV4dDJEUmVuZGVyQ2FjaGU9dDt2YXIgaT1mdW5jdGlvbih0KXtmdW5jdGlvbiBpKGUsaSl7dC5jYWxsKHRoaXMsZSxpKX1yZXR1cm4gX19leHRlbmRzKGksdCksT2JqZWN0LmRlZmluZVByb3BlcnR5KGkucHJvdG90eXBlLFwidG9wTGVmdFVWXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBudWxsfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcInNpemVVVlwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJ0ZXh0dXJlU2l6ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJjb2xvclwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxfX2RlY29yYXRlKFtlLmluc3RhbmNlRGF0YSgpXSxpLnByb3RvdHlwZSxcInRvcExlZnRVVlwiLG51bGwpLF9fZGVjb3JhdGUoW2UuaW5zdGFuY2VEYXRhKCldLGkucHJvdG90eXBlLFwic2l6ZVVWXCIsbnVsbCksX19kZWNvcmF0ZShbZS5pbnN0YW5jZURhdGEoKV0saS5wcm90b3R5cGUsXCJ0ZXh0dXJlU2l6ZVwiLG51bGwpLF9fZGVjb3JhdGUoW2UuaW5zdGFuY2VEYXRhKCldLGkucHJvdG90eXBlLFwiY29sb3JcIixudWxsKSxpfShlLkluc3RhbmNlRGF0YUJhc2UpO2UuVGV4dDJESW5zdGFuY2VEYXRhPWk7dmFyIHI9ZnVuY3Rpb24ocil7ZnVuY3Rpb24gbih0LGkpe2l8fChpPXt9KSxyLmNhbGwodGhpcyxpKSx0aGlzLmZvbnROYW1lPW51bGw9PWkuZm9udE5hbWU/XCIxMnB0IEFyaWFsXCI6aS5mb250TmFtZSx0aGlzLmRlZmF1bHRGb250Q29sb3I9bnVsbD09aS5kZWZhdWx0Rm9udENvbG9yP25ldyBlLkNvbG9yNCgxLDEsMSwxKTppLmRlZmF1bHRGb250Q29sb3IsdGhpcy5fdGFidWxhdGlvblNpemU9bnVsbD09aS50YWJ1bGF0aW9uU2l6ZT80OmkudGFidWxhdGlvblNpemUsdGhpcy5fdGV4dFNpemU9bnVsbCx0aGlzLnRleHQ9dCx0aGlzLnNpemU9bnVsbD09aS5zaXplP251bGw6aS5zaXplLHRoaXMuaXNBbHBoYVRlc3Q9ITB9cmV0dXJuIF9fZXh0ZW5kcyhuLHIpLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuLnByb3RvdHlwZSxcImZvbnROYW1lXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9mb250TmFtZX0sc2V0OmZ1bmN0aW9uKGUpe2lmKHRoaXMuX2ZvbnROYW1lKXRocm93IG5ldyBFcnJvcihcIkZvbnQgTmFtZSBjaGFuZ2UgaXMgbm90IHN1cHBvcnRlZCByaWdodCBub3cuXCIpO3RoaXMuX2ZvbnROYW1lPWV9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KG4ucHJvdG90eXBlLFwiZGVmYXVsdEZvbnRDb2xvclwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZGVmYXVsdEZvbnRDb2xvcn0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX2RlZmF1bHRGb250Q29sb3I9ZX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkobi5wcm90b3R5cGUsXCJ0ZXh0XCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl90ZXh0fSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fdGV4dD1lLHRoaXMuX3RleHRTaXplPW51bGwsdGhpcy5fc2l6ZT1udWxsLHRoaXMuX3VwZGF0ZUNoYXJDb3VudCgpO3RoaXMudGV4dFNpemV9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KG4ucHJvdG90eXBlLFwic2l6ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbCE9dGhpcy5fc2l6ZT90aGlzLl9zaXplOnRoaXMudGV4dFNpemV9LHNldDpmdW5jdGlvbihlKXt0aGlzLl9zaXplPWV9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KG4ucHJvdG90eXBlLFwiYWN0dWFsU2l6ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fYWN0dWFsU2l6ZT90aGlzLl9hY3R1YWxTaXplOnRoaXMuc2l6ZX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkobi5wcm90b3R5cGUsXCJ0ZXh0U2l6ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtpZighdGhpcy5fdGV4dFNpemUpe2lmKCF0aGlzLm93bmVyKXJldHVybiBuLm51bGxTaXplO3ZhciB0PXRoaXMuZm9udFRleHR1cmUubWVhc3VyZVRleHQodGhpcy5fdGV4dCx0aGlzLl90YWJ1bGF0aW9uU2l6ZSk7dC5lcXVhbHModGhpcy5fdGV4dFNpemUpfHwodGhpcy5vblByaW1pdGl2ZVByb3BlcnR5RGlydHkoZS5QcmltMkRCYXNlLnNpemVQcm9wZXJ0eS5mbGFnSWQpLHRoaXMuX3Bvc2l0aW9uaW5nRGlydHkoKSksdGhpcy5fdGV4dFNpemU9dH1yZXR1cm4gdGhpcy5fdGV4dFNpemV9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KG4ucHJvdG90eXBlLFwiZm9udFRleHR1cmVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2ZvbnRUZXh0dXJlP3RoaXMuX2ZvbnRUZXh0dXJlOih0aGlzLl9mb250VGV4dHVyZT1lLkZvbnRUZXh0dXJlLkdldENhY2hlZEZvbnRUZXh0dXJlKHRoaXMub3duZXIuc2NlbmUsdGhpcy5mb250TmFtZSksdGhpcy5fZm9udFRleHR1cmUpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLG4ucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXtyZXR1cm4gci5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpPyh0aGlzLl9mb250VGV4dHVyZSYmKGUuRm9udFRleHR1cmUuUmVsZWFzZUNhY2hlZEZvbnRUZXh0dXJlKHRoaXMub3duZXIuc2NlbmUsdGhpcy5mb250TmFtZSksdGhpcy5fZm9udFRleHR1cmU9bnVsbCksITApOiExfSxuLnByb3RvdHlwZS51cGRhdGVMZXZlbEJvdW5kaW5nSW5mbz1mdW5jdGlvbigpe2UuQm91bmRpbmdJbmZvMkQuQ3JlYXRlRnJvbVNpemVUb1JlZih0aGlzLmFjdHVhbFNpemUsdGhpcy5fbGV2ZWxCb3VuZGluZ0luZm8pfSxuLnByb3RvdHlwZS5sZXZlbEludGVyc2VjdD1mdW5jdGlvbihlKXtyZXR1cm4hMH0sbi5wcm90b3R5cGUuY3JlYXRlTW9kZWxSZW5kZXJDYWNoZT1mdW5jdGlvbihlKXt2YXIgaT1uZXcgdCh0aGlzLm93bmVyLmVuZ2luZSxlKTtyZXR1cm4gaX0sbi5wcm90b3R5cGUuc2V0dXBNb2RlbFJlbmRlckNhY2hlPWZ1bmN0aW9uKGUpe3ZhciB0PWUsaT10aGlzLm93bmVyLmVuZ2luZTt0LmZvbnRUZXh0dXJlPXRoaXMuZm9udFRleHR1cmU7Zm9yKHZhciByPW5ldyBGbG9hdDMyQXJyYXkoNCksbz0wOzQ+bztvKyspcltvXT1vO3QudmI9aS5jcmVhdGVWZXJ0ZXhCdWZmZXIocik7dmFyIHM9bmV3IEZsb2F0MzJBcnJheSg2KTtzWzBdPTAsc1sxXT0yLHNbMl09MSxzWzNdPTAsc1s0XT0zLHNbNV09Mix0LmliPWkuY3JlYXRlSW5kZXhCdWZmZXIocyk7dmFyIGE9dGhpcy5nZXREYXRhUGFydEVmZmVjdEluZm8obi5URVhUMkRfTUFJTlBBUlRJRCxbXCJpbmRleFwiXSwhMCk7cmV0dXJuIGEmJih0LmVmZmVjdEluc3RhbmNlZD1pLmNyZWF0ZUVmZmVjdChcInRleHQyZFwiLGEuYXR0cmlidXRlcyxhLnVuaWZvcm1zLFtcImRpZmZ1c2VTYW1wbGVyXCJdLGEuZGVmaW5lcyxudWxsKSksYT10aGlzLmdldERhdGFQYXJ0RWZmZWN0SW5mbyhuLlRFWFQyRF9NQUlOUEFSVElELFtcImluZGV4XCJdLCExKSx0LmVmZmVjdD1pLmNyZWF0ZUVmZmVjdChcInRleHQyZFwiLGEuYXR0cmlidXRlcyxhLnVuaWZvcm1zLFtcImRpZmZ1c2VTYW1wbGVyXCJdLGEuZGVmaW5lcyxudWxsKSx0fSxuLnByb3RvdHlwZS5jcmVhdGVJbnN0YW5jZURhdGFQYXJ0cz1mdW5jdGlvbigpe3JldHVybltuZXcgaShuLlRFWFQyRF9NQUlOUEFSVElELHRoaXMuX2NoYXJDb3VudCldfSxuLnByb3RvdHlwZS5iZWZvcmVSZWZyZXNoRm9yTGF5b3V0Q29uc3RydWN0aW9uPWZ1bmN0aW9uKGUpe2lmKCF0aGlzLl9jaGFyQ291bnQpe3ZhciB0PXRoaXMuX3RleHQ7cmV0dXJuIHRoaXMudGV4dD1cIkFcIix0fX0sbi5wcm90b3R5cGUuYWZ0ZXJSZWZyZXNoRm9yTGF5b3V0Q29uc3RydWN0aW9uPWZ1bmN0aW9uKGUsdCl7dm9pZCAwIT09dCYmKHRoaXMudGV4dD10KX0sbi5wcm90b3R5cGUucmVmcmVzaEluc3RhbmNlRGF0YVBhcnQ9ZnVuY3Rpb24odCl7aWYoIXIucHJvdG90eXBlLnJlZnJlc2hJbnN0YW5jZURhdGFQYXJ0LmNhbGwodGhpcyx0KSlyZXR1cm4hMTtpZih0LmlkPT09bi5URVhUMkRfTUFJTlBBUlRJRCl7dmFyIGk9dCxvPXRoaXMuZm9udFRleHR1cmUscz1vLmdldFNpemUoKSxhPWUuVmVjdG9yMi5aZXJvKCksaD10aGlzLmZvbnRUZXh0dXJlLmxpbmVIZWlnaHQ7YS55PSh0aGlzLnRleHRTaXplLmhlaWdodC9oLTEpKmg7dmFyIGM9MDtpLmRhdGFFbGVtZW50Q291bnQ9dGhpcy5fY2hhckNvdW50LGkuY3VyRWxlbWVudD0wO2Zvcih2YXIgbD0wLHU9dGhpcy50ZXh0O2w8dS5sZW5ndGg7bCsrKXt2YXIgZj11W2xdO2lmKFwiXFxuXCI9PT1mJiYoYS54PTAsYS55LT1vLmxpbmVIZWlnaHQpLFwiXHRcIiE9PWYpe2lmKCEoXCIgXCI+Zikpe3RoaXMudXBkYXRlSW5zdGFuY2VEYXRhUGFydChpLGEpO3ZhciBkPW8uZ2V0Q2hhcihmKTthLngrPWQuY2hhcldpZHRoLGkudG9wTGVmdFVWPWQudG9wTGVmdFVWO3ZhciBwPWQuYm90dG9tUmlnaHRVVi5zdWJ0cmFjdChkLnRvcExlZnRVVik7aS5zaXplVVY9cCxpLnRleHR1cmVTaXplPW5ldyBlLlZlY3RvcjIocy53aWR0aCxzLmhlaWdodCksaS5jb2xvcj10aGlzLmRlZmF1bHRGb250Q29sb3IsKytpLmN1ckVsZW1lbnR9fWVsc2V7dmFyIF89Yyt0aGlzLl90YWJ1bGF0aW9uU2l6ZTtfLT1fJXRoaXMuX3RhYnVsYXRpb25TaXplLGEueCs9KF8tYykqby5zcGFjZVdpZHRoLGM9X319fXJldHVybiEwfSxuLnByb3RvdHlwZS5fdXBkYXRlQ2hhckNvdW50PWZ1bmN0aW9uKCl7Zm9yKHZhciBlPTAsdD0wLGk9dGhpcy5fdGV4dDt0PGkubGVuZ3RoO3QrKyl7dmFyIHI9aVt0XTtcIlxcclwiPT09cnx8XCJcXG5cIj09PXJ8fFwiXHRcIj09PXJ8fFwiIFwiPnJ8fCsrZX10aGlzLl9jaGFyQ291bnQ9ZX0sbi5URVhUMkRfTUFJTlBBUlRJRD0xLF9fZGVjb3JhdGUoW2UubW9kZWxMZXZlbFByb3BlcnR5KGUuUmVuZGVyYWJsZVByaW0yRC5SRU5ERVJBQkxFUFJJTTJEX1BST1BDT1VOVCsxLGZ1bmN0aW9uKGUpe3JldHVybiBuLmZvbnRQcm9wZXJ0eT1lfSwhMSwhMCldLG4ucHJvdG90eXBlLFwiZm9udE5hbWVcIixudWxsKSxfX2RlY29yYXRlKFtlLmR5bmFtaWNMZXZlbFByb3BlcnR5KGUuUmVuZGVyYWJsZVByaW0yRC5SRU5ERVJBQkxFUFJJTTJEX1BST1BDT1VOVCsyLGZ1bmN0aW9uKGUpe3JldHVybiBuLmRlZmF1bHRGb250Q29sb3JQcm9wZXJ0eT1lfSldLG4ucHJvdG90eXBlLFwiZGVmYXVsdEZvbnRDb2xvclwiLG51bGwpLF9fZGVjb3JhdGUoW2UuaW5zdGFuY2VMZXZlbFByb3BlcnR5KGUuUmVuZGVyYWJsZVByaW0yRC5SRU5ERVJBQkxFUFJJTTJEX1BST1BDT1VOVCszLGZ1bmN0aW9uKGUpe3JldHVybiBuLnRleHRQcm9wZXJ0eT1lfSwhMSwhMCldLG4ucHJvdG90eXBlLFwidGV4dFwiLG51bGwpLF9fZGVjb3JhdGUoW2UuaW5zdGFuY2VMZXZlbFByb3BlcnR5KGUuUmVuZGVyYWJsZVByaW0yRC5SRU5ERVJBQkxFUFJJTTJEX1BST1BDT1VOVCs0LGZ1bmN0aW9uKGUpe3JldHVybiBuLnNpemVQcm9wZXJ0eT1lfSldLG4ucHJvdG90eXBlLFwic2l6ZVwiLG51bGwpLG49X19kZWNvcmF0ZShbZS5jbGFzc05hbWUoXCJUZXh0MkRcIildLG4pfShlLlJlbmRlcmFibGVQcmltMkQpO2UuVGV4dDJEPXJ9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGkoZSxpKXt0LmNhbGwodGhpcyxlLGkpLHRoaXMuZWZmZWN0c1JlYWR5PSExLHRoaXMuZmlsbFZCPW51bGwsdGhpcy5maWxsSUI9bnVsbCx0aGlzLmZpbGxJbmRpY2VzQ291bnQ9MCx0aGlzLmluc3RhbmNpbmdGaWxsQXR0cmlidXRlcz1udWxsLHRoaXMuZWZmZWN0RmlsbD1udWxsLHRoaXMuZWZmZWN0RmlsbEluc3RhbmNlZD1udWxsLHRoaXMuYm9yZGVyVkI9bnVsbCx0aGlzLmJvcmRlcklCPW51bGwsdGhpcy5ib3JkZXJJbmRpY2VzQ291bnQ9MCx0aGlzLmluc3RhbmNpbmdCb3JkZXJBdHRyaWJ1dGVzPW51bGwsdGhpcy5lZmZlY3RCb3JkZXI9bnVsbCx0aGlzLmVmZmVjdEJvcmRlckluc3RhbmNlZD1udWxsfXJldHVybiBfX2V4dGVuZHMoaSx0KSxpLnByb3RvdHlwZS5yZW5kZXI9ZnVuY3Rpb24odCxpKXtpZighdGhpcy5lZmZlY3RzUmVhZHkpe2lmKHRoaXMuZWZmZWN0RmlsbCYmKCF0aGlzLmVmZmVjdEZpbGwuaXNSZWFkeSgpfHx0aGlzLmVmZmVjdEZpbGxJbnN0YW5jZWQmJiF0aGlzLmVmZmVjdEZpbGxJbnN0YW5jZWQuaXNSZWFkeSgpKXx8dGhpcy5lZmZlY3RCb3JkZXImJighdGhpcy5lZmZlY3RCb3JkZXIuaXNSZWFkeSgpfHx0aGlzLmVmZmVjdEJvcmRlckluc3RhbmNlZCYmIXRoaXMuZWZmZWN0Qm9yZGVySW5zdGFuY2VkLmlzUmVhZHkoKSkpcmV0dXJuITE7dGhpcy5lZmZlY3RzUmVhZHk9ITB9dmFyIHI9dC5vd25lci5vd25lci5lbmdpbmUsbj0wO3RoaXMuZWZmZWN0RmlsbCYmdGhpcy5lZmZlY3RCb3JkZXImJihuPXIuZ2V0RGVwdGhGdW5jdGlvbigpLHIuc2V0RGVwdGhGdW5jdGlvblRvTGVzc09yRXF1YWwoKSk7dmFyIG89ci5nZXRBbHBoYU1vZGUoKTtpZih0aGlzLmVmZmVjdEZpbGwpe3ZhciBzPXQucGFydEluZGV4RnJvbUlkLmdldChlLlNoYXBlMkQuU0hBUEUyRF9GSUxMUEFSVElELnRvU3RyaW5nKCkpLGE9aS5ncm91cEluZm9QYXJ0RGF0YVtzXTtpLnJlbmRlck1vZGUhPT1lLlJlbmRlcjJEQ29udGV4dC5SZW5kZXJNb2RlT3BhcXVlJiZyLnNldEFscGhhTW9kZShlLkVuZ2luZS5BTFBIQV9DT01CSU5FKTt2YXIgaD1pLnVzZUluc3RhbmNpbmc/dGhpcy5lZmZlY3RGaWxsSW5zdGFuY2VkOnRoaXMuZWZmZWN0RmlsbDtpZihyLmVuYWJsZUVmZmVjdChoKSxyLmJpbmRCdWZmZXJzRGlyZWN0bHkodGhpcy5maWxsVkIsdGhpcy5maWxsSUIsWzJdLDgsaCksaS51c2VJbnN0YW5jaW5nKXRoaXMuaW5zdGFuY2luZ0ZpbGxBdHRyaWJ1dGVzfHwodGhpcy5pbnN0YW5jaW5nRmlsbEF0dHJpYnV0ZXM9dGhpcy5sb2FkSW5zdGFuY2luZ0F0dHJpYnV0ZXMoZS5TaGFwZTJELlNIQVBFMkRfRklMTFBBUlRJRCxoKSksci51cGRhdGVBbmRCaW5kSW5zdGFuY2VzQnVmZmVyKGEuX3BhcnRCdWZmZXIsbnVsbCx0aGlzLmluc3RhbmNpbmdGaWxsQXR0cmlidXRlcyksci5kcmF3KCEwLDAsdGhpcy5maWxsSW5kaWNlc0NvdW50LGEuX3BhcnREYXRhLnVzZWRFbGVtZW50Q291bnQpLHIudW5iaW5kSW5zdGFuY2VBdHRyaWJ1dGVzKCk7ZWxzZSBmb3IodmFyIGM9aS5wYXJ0RGF0YVN0YXJ0SW5kZXg7YzxpLnBhcnREYXRhRW5kSW5kZXg7YysrKXRoaXMuc2V0dXBVbmlmb3JtcyhoLHMsYS5fcGFydERhdGEsYyksci5kcmF3KCEwLDAsdGhpcy5maWxsSW5kaWNlc0NvdW50KX1pZih0aGlzLmVmZmVjdEJvcmRlcil7dmFyIHM9dC5wYXJ0SW5kZXhGcm9tSWQuZ2V0KGUuU2hhcGUyRC5TSEFQRTJEX0JPUkRFUlBBUlRJRC50b1N0cmluZygpKSxhPWkuZ3JvdXBJbmZvUGFydERhdGFbc107aS5yZW5kZXJNb2RlIT09ZS5SZW5kZXIyRENvbnRleHQuUmVuZGVyTW9kZU9wYXF1ZSYmci5zZXRBbHBoYU1vZGUoZS5FbmdpbmUuQUxQSEFfQ09NQklORSk7dmFyIGg9aS51c2VJbnN0YW5jaW5nP3RoaXMuZWZmZWN0Qm9yZGVySW5zdGFuY2VkOnRoaXMuZWZmZWN0Qm9yZGVyO2lmKHIuZW5hYmxlRWZmZWN0KGgpLHIuYmluZEJ1ZmZlcnNEaXJlY3RseSh0aGlzLmJvcmRlclZCLHRoaXMuYm9yZGVySUIsWzJdLDgsaCksaS51c2VJbnN0YW5jaW5nKXRoaXMuaW5zdGFuY2luZ0JvcmRlckF0dHJpYnV0ZXN8fCh0aGlzLmluc3RhbmNpbmdCb3JkZXJBdHRyaWJ1dGVzPXRoaXMubG9hZEluc3RhbmNpbmdBdHRyaWJ1dGVzKGUuU2hhcGUyRC5TSEFQRTJEX0JPUkRFUlBBUlRJRCxoKSksci51cGRhdGVBbmRCaW5kSW5zdGFuY2VzQnVmZmVyKGEuX3BhcnRCdWZmZXIsbnVsbCx0aGlzLmluc3RhbmNpbmdCb3JkZXJBdHRyaWJ1dGVzKSxyLmRyYXcoITAsMCx0aGlzLmJvcmRlckluZGljZXNDb3VudCxhLl9wYXJ0RGF0YS51c2VkRWxlbWVudENvdW50KSxyLnVuYmluZEluc3RhbmNlQXR0cmlidXRlcygpO2Vsc2UgZm9yKHZhciBjPWkucGFydERhdGFTdGFydEluZGV4O2M8aS5wYXJ0RGF0YUVuZEluZGV4O2MrKyl0aGlzLnNldHVwVW5pZm9ybXMoaCxzLGEuX3BhcnREYXRhLGMpLHIuZHJhdyghMCwwLHRoaXMuYm9yZGVySW5kaWNlc0NvdW50KX1yZXR1cm4gci5zZXRBbHBoYU1vZGUobyksdGhpcy5lZmZlY3RGaWxsJiZ0aGlzLmVmZmVjdEJvcmRlciYmci5zZXREZXB0aEZ1bmN0aW9uKG4pLCEwfSxpLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHQucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKT8odGhpcy5maWxsVkImJih0aGlzLl9lbmdpbmUuX3JlbGVhc2VCdWZmZXIodGhpcy5maWxsVkIpLHRoaXMuZmlsbFZCPW51bGwpLHRoaXMuZmlsbElCJiYodGhpcy5fZW5naW5lLl9yZWxlYXNlQnVmZmVyKHRoaXMuZmlsbElCKSx0aGlzLmZpbGxJQj1udWxsKSx0aGlzLmVmZmVjdEZpbGwmJih0aGlzLl9lbmdpbmUuX3JlbGVhc2VFZmZlY3QodGhpcy5lZmZlY3RGaWxsKSx0aGlzLmVmZmVjdEZpbGw9bnVsbCksdGhpcy5lZmZlY3RGaWxsSW5zdGFuY2VkJiYodGhpcy5fZW5naW5lLl9yZWxlYXNlRWZmZWN0KHRoaXMuZWZmZWN0RmlsbEluc3RhbmNlZCksdGhpcy5lZmZlY3RGaWxsSW5zdGFuY2VkPW51bGwpLHRoaXMuYm9yZGVyVkImJih0aGlzLl9lbmdpbmUuX3JlbGVhc2VCdWZmZXIodGhpcy5ib3JkZXJWQiksdGhpcy5ib3JkZXJWQj1udWxsKSx0aGlzLmJvcmRlcklCJiYodGhpcy5fZW5naW5lLl9yZWxlYXNlQnVmZmVyKHRoaXMuYm9yZGVySUIpLHRoaXMuYm9yZGVySUI9bnVsbCksdGhpcy5lZmZlY3RCb3JkZXImJih0aGlzLl9lbmdpbmUuX3JlbGVhc2VFZmZlY3QodGhpcy5lZmZlY3RCb3JkZXIpLHRoaXMuZWZmZWN0Qm9yZGVyPW51bGwpLHRoaXMuZWZmZWN0Qm9yZGVySW5zdGFuY2VkJiYodGhpcy5fZW5naW5lLl9yZWxlYXNlRWZmZWN0KHRoaXMuZWZmZWN0Qm9yZGVySW5zdGFuY2VkKSx0aGlzLmVmZmVjdEJvcmRlckluc3RhbmNlZD1udWxsKSwhMCk6ITF9LGl9KGUuTW9kZWxSZW5kZXJDYWNoZSk7ZS5MaW5lczJEUmVuZGVyQ2FjaGU9dDt2YXIgaT1mdW5jdGlvbih0KXtmdW5jdGlvbiBpKGUpe3QuY2FsbCh0aGlzLGUsMSl9cmV0dXJuIF9fZXh0ZW5kcyhpLHQpLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcImJvdW5kaW5nTWluXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBudWxsfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcImJvdW5kaW5nTWF4XCIse2dldDpmdW5jdGlvbigpe3JldHVybiBudWxsfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLF9fZGVjb3JhdGUoW2UuaW5zdGFuY2VEYXRhKGUuU2hhcGUyRC5TSEFQRTJEX0NBVEVHT1JZX0ZJTExHUkFESUVOVCldLGkucHJvdG90eXBlLFwiYm91bmRpbmdNaW5cIixudWxsKSxfX2RlY29yYXRlKFtlLmluc3RhbmNlRGF0YShlLlNoYXBlMkQuU0hBUEUyRF9DQVRFR09SWV9GSUxMR1JBRElFTlQpXSxpLnByb3RvdHlwZSxcImJvdW5kaW5nTWF4XCIsbnVsbCksaX0oZS5TaGFwZTJESW5zdGFuY2VEYXRhKTtlLkxpbmVzMkRJbnN0YW5jZURhdGE9aTt2YXIgcj1mdW5jdGlvbihyKXtmdW5jdGlvbiBuKHQsaSl7aXx8KGk9e30pLHIuY2FsbCh0aGlzLGkpLHRoaXMuX2ZpbGxWQj1udWxsLHRoaXMuX2ZpbGxJQj1udWxsLHRoaXMuX2JvcmRlclZCPW51bGwsdGhpcy5fYm9yZGVySUI9bnVsbCx0aGlzLl9zaXplPWUuU2l6ZS5aZXJvKCksdGhpcy5fYm91bmRpbmdNaW49bnVsbCx0aGlzLl9ib3VuZGluZ01heD1udWxsO3ZhciBuPW51bGw9PWkuZmlsbFRoaWNrbmVzcz8xOmkuZmlsbFRoaWNrbmVzcyxvPW51bGw9PWkuc3RhcnRDYXA/MDppLnN0YXJ0Q2FwLHM9bnVsbD09aS5lbmRDYXA/MDppLmVuZENhcCxhPW51bGw9PWkuY2xvc2VkPyExOmkuY2xvc2VkO3RoaXMucG9pbnRzPXQsdGhpcy5maWxsVGhpY2tuZXNzPW4sdGhpcy5zdGFydENhcD1vLHRoaXMuZW5kQ2FwPXMsdGhpcy5jbG9zZWQ9YX1yZXR1cm4gX19leHRlbmRzKG4sciksT2JqZWN0LmRlZmluZVByb3BlcnR5KG4sXCJOb0NhcFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gbi5fbm9DYXB9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KG4sXCJSb3VuZENhcFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gbi5fcm91bmRDYXB9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KG4sXCJUcmlhbmdsZUNhcFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gbi5fdHJpYW5nbGVDYXB9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KG4sXCJTcXVhcmVBbmNob3JDYXBcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIG4uX3NxdWFyZUFuY2hvckNhcH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkobixcIlJvdW5kQW5jaG9yQ2FwXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBuLl9yb3VuZEFuY2hvckNhcH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkobixcIkRpYW1vbmRBbmNob3JDYXBcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIG4uX2RpYW1vbmRBbmNob3JDYXB9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KG4sXCJBcnJvd0NhcFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gbi5fYXJyb3dDYXB9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KG4ucHJvdG90eXBlLFwicG9pbnRzXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9wb2ludHN9LHNldDpmdW5jdGlvbihlKXt0aGlzLl9wb2ludHM9ZSx0aGlzLl9ib3VuZGluZ0JveERpcnR5KCl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KG4ucHJvdG90eXBlLFwiZmlsbFRoaWNrbmVzc1wiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZmlsbFRoaWNrbmVzc30sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX2ZpbGxUaGlja25lc3M9ZX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkobi5wcm90b3R5cGUsXCJjbG9zZWRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2Nsb3NlZH0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX2Nsb3NlZD1lfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuLnByb3RvdHlwZSxcInN0YXJ0Q2FwXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9zdGFydENhcH0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX3N0YXJ0Q2FwPWV9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KG4ucHJvdG90eXBlLFwiZW5kQ2FwXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9lbmRDYXB9LHNldDpmdW5jdGlvbihlKXt0aGlzLl9lbmRDYXA9ZX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxuLnByb3RvdHlwZS5sZXZlbEludGVyc2VjdD1mdW5jdGlvbih0KXt2YXIgaT10aGlzO251bGw9PXRoaXMuX2NvbnRvdXImJnRoaXMuX2NvbXB1dGVMaW5lczJEKCk7dmFyIHI9dGhpcy5wb2ludHMubGVuZ3RoLG89dGhpcy5jbG9zZWQ/cisxOnIscz10Ll9sb2NhbFBpY2tQb3NpdGlvbjt0aGlzLnRyYW5zZm9ybVBvaW50V2l0aE9yaWdpblRvUmVmKHRoaXMuX2NvbnRvdXJbMF0sbnVsbCxuLl9wcmV2QSksdGhpcy50cmFuc2Zvcm1Qb2ludFdpdGhPcmlnaW5Ub1JlZih0aGlzLl9jb250b3VyWzFdLG51bGwsbi5fcHJldkIpO2Zvcih2YXIgYT0xO28+YTthKyspe2lmKHRoaXMudHJhbnNmb3JtUG9pbnRXaXRoT3JpZ2luVG9SZWYodGhpcy5fY29udG91clthJXIqMiswXSxudWxsLG4uX2N1ckEpLHRoaXMudHJhbnNmb3JtUG9pbnRXaXRoT3JpZ2luVG9SZWYodGhpcy5fY29udG91clthJXIqMisxXSxudWxsLG4uX2N1ckIpLGUuVmVjdG9yMi5Qb2ludEluVHJpYW5nbGUocyxuLl9wcmV2QSxuLl9wcmV2QixuLl9jdXJBKSlyZXR1cm4hMDtpZihlLlZlY3RvcjIuUG9pbnRJblRyaWFuZ2xlKHMsbi5fY3VyQSxuLl9wcmV2QixuLl9jdXJCKSlyZXR1cm4hMDtuLl9wcmV2QS54PW4uX2N1ckEueCxuLl9wcmV2QS55PW4uX2N1ckEueSxuLl9wcmV2Qi54PW4uX2N1ckIueCxuLl9wcmV2Qi55PW4uX2N1ckIueX12YXIgaD1mdW5jdGlvbih0LHIpe2Zvcih2YXIgbz10Lmxlbmd0aCxhPTA7bz5hO2ErPTMpaWYobi5fY3VyQS54PXJbMip0W2ErMF0rMF0sbi5fY3VyQS55PXJbMip0W2ErMF0rMV0saS50cmFuc2Zvcm1Qb2ludFdpdGhPcmlnaW5Ub1JlZihuLl9jdXJBLG51bGwsbi5fY3VyQiksbi5fY3VyQS54PXJbMip0W2ErMV0rMF0sbi5fY3VyQS55PXJbMip0W2ErMV0rMV0saS50cmFuc2Zvcm1Qb2ludFdpdGhPcmlnaW5Ub1JlZihuLl9jdXJBLG51bGwsbi5fcHJldkEpLG4uX2N1ckEueD1yWzIqdFthKzJdKzBdLG4uX2N1ckEueT1yWzIqdFthKzJdKzFdLGkudHJhbnNmb3JtUG9pbnRXaXRoT3JpZ2luVG9SZWYobi5fY3VyQSxudWxsLG4uX3ByZXZCKSxlLlZlY3RvcjIuUG9pbnRJblRyaWFuZ2xlKHMsbi5fcHJldkEsbi5fcHJldkIsbi5fY3VyQikpcmV0dXJuITA7cmV0dXJuITF9O2lmKHRoaXMuX3N0YXJ0Q2FwVHJpSW5kaWNlcyl7aWYoaCh0aGlzLl9zdGFydENhcFRyaUluZGljZXMsdGhpcy5fc3RhcnRDYXBDb250b3VyKSlyZXR1cm4hMDtpZihoKHRoaXMuX2VuZENhcFRyaUluZGljZXMsdGhpcy5fZW5kQ2FwQ29udG91cikpcmV0dXJuITB9cmV0dXJuITF9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuLnByb3RvdHlwZSxcImJvdW5kaW5nTWluXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9ib3VuZGluZ01pbnx8dGhpcy5fY29tcHV0ZUxpbmVzMkQoKSx0aGlzLl9ib3VuZGluZ01pbn0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkobi5wcm90b3R5cGUsXCJib3VuZGluZ01heFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fYm91bmRpbmdNYXh8fHRoaXMuX2NvbXB1dGVMaW5lczJEKCksdGhpcy5fYm91bmRpbmdNYXh9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksbi5wcm90b3R5cGUuZ2V0VXNlZFNoYWRlckNhdGVnb3JpZXM9ZnVuY3Rpb24odCl7dmFyIGk9ci5wcm90b3R5cGUuZ2V0VXNlZFNoYWRlckNhdGVnb3JpZXMuY2FsbCh0aGlzLHQpLG49aS5pbmRleE9mKGUuU2hhcGUyRC5TSEFQRTJEX0NBVEVHT1JZX0JPUkRFUik7cmV0dXJuLTEhPT1uJiZpLnNwbGljZShuLDEpLGl9LG4ucHJvdG90eXBlLnVwZGF0ZUxldmVsQm91bmRpbmdJbmZvPWZ1bmN0aW9uKCl7dGhpcy5fYm91bmRpbmdNaW58fHRoaXMuX2NvbXB1dGVMaW5lczJEKCksZS5Cb3VuZGluZ0luZm8yRC5DcmVhdGVGcm9tTWluTWF4VG9SZWYodGhpcy5fYm91bmRpbmdNaW4ueCx0aGlzLl9ib3VuZGluZ01heC54LHRoaXMuX2JvdW5kaW5nTWluLnksdGhpcy5fYm91bmRpbmdNYXgueSx0aGlzLl9sZXZlbEJvdW5kaW5nSW5mbyl9LG4ucHJvdG90eXBlLmNyZWF0ZU1vZGVsUmVuZGVyQ2FjaGU9ZnVuY3Rpb24oZSl7dmFyIGk9bmV3IHQodGhpcy5vd25lci5lbmdpbmUsZSk7cmV0dXJuIGl9LG4ucHJvdG90eXBlLl9wZXJwPWZ1bmN0aW9uKGUsdCl7dC54PWUueSx0Lnk9LWUueH0sbi5wcm90b3R5cGUuX2RpcmVjdGlvbj1mdW5jdGlvbihlLHQsaSl7ZS5zdWJ0cmFjdFRvUmVmKHQsaSksaS5ub3JtYWxpemUoKX0sbi5wcm90b3R5cGUuX2NvbXB1dGVNaXRlcj1mdW5jdGlvbih0LGkscixvKXtyZXR1cm4gci5hZGRUb1JlZihvLHQpLHQubm9ybWFsaXplKCksaS54PS10LnksaS55PXQueCxuLl9taXRlclRwcy54PS1yLnksbi5fbWl0ZXJUcHMueT1yLngsMS9lLlZlY3RvcjIuRG90KGksbi5fbWl0ZXJUcHMpfSxuLnByb3RvdHlwZS5faW50ZXJzZWN0PWZ1bmN0aW9uKGUsdCxpLHIsbixvLHMsYSl7dmFyIGg9KGUtaSkqKG8tYSktKHQtcikqKG4tcyk7aWYoMD09PWgpcmV0dXJuITE7dmFyIGM9KChuLXMpKihlKnItdCppKS0oZS1pKSoobiphLW8qcykpL2g7cmV0dXJuIGM8TWF0aC5taW4oZSxpKXx8Yz5NYXRoLm1heChlLGkpPyExOiEoYzxNYXRoLm1pbihuLHMpfHxjPk1hdGgubWF4KG4scykpfSxuLnByb3RvdHlwZS5fdXBkYXRlTWluTWF4PWZ1bmN0aW9uKGUsdCl7dD49ZS5sZW5ndGh8fCh0aGlzLl9ib3VuZGluZ01pbi54PU1hdGgubWluKHRoaXMuX2JvdW5kaW5nTWluLngsZVt0XSksdGhpcy5fYm91bmRpbmdNYXgueD1NYXRoLm1heCh0aGlzLl9ib3VuZGluZ01heC54LGVbdF0pLHRoaXMuX2JvdW5kaW5nTWluLnk9TWF0aC5taW4odGhpcy5fYm91bmRpbmdNaW4ueSxlW3QrMV0pLHRoaXMuX2JvdW5kaW5nTWF4Lnk9TWF0aC5tYXgodGhpcy5fYm91bmRpbmdNYXgueSxlW3QrMV0pKX0sbi5wcm90b3R5cGUuX3N0b3JlPWZ1bmN0aW9uKHQsaSxyLG8scyxhLGgsYyxsKXt2YXIgdT1udWxsIT1jJiYhaXNOYU4oYyksZj1yKih1Pzg6NCk7aWYoIShmPj10Lmxlbmd0aCkpezA9PT1yP3RoaXMuX3BlcnAoYSxuLl9zdGFydERpcik6cj09PW8tMSYmKHRoaXMuX3BlcnAoYSxuLl9lbmREaXIpLG4uX2VuZERpci54Kj0tMSxuLl9lbmREaXIueSo9LTEpO3ZhciBkPSExO2lmKHRbZiswXT1zLngrYS54KmgsdFtmKzFdPXMueSthLnkqaCx0W2YrMl09cy54K2EueCotaCx0W2YrM109cy55K2EueSotaCx0aGlzLl91cGRhdGVNaW5NYXgodCxmKSx0aGlzLl91cGRhdGVNaW5NYXgodCxmKzIpLHZvaWQgMCE9PWwpe3ZhciBwPWwqKHU/ODo0KTtpZih0aGlzLl9pbnRlcnNlY3QodFtmKzBdLHRbZisxXSx0W3ArMF0sdFtwKzFdLHRbZisyXSx0W2YrM10sdFtwKzJdLHRbcCszXSkpe2Q9ITA7dmFyIF89dFtmKzBdO3RbZiswXT10W2YrMl0sdFtmKzJdPV8sXz10W2YrMV0sdFtmKzFdPXRbZiszXSx0W2YrM109X319aWYodSl7dmFyIG09aCtjO3RbZis0XT1zLngrYS54KihkPy1tOm0pLHRbZis1XT1zLnkrYS55KihkPy1tOm0pLHRbZis2XT1zLngrYS54KihkP206LW0pLHRbZis3XT1zLnkrYS55KihkP206LW0pLHRoaXMuX3VwZGF0ZU1pbk1heCh0LGYrNCksdGhpcy5fdXBkYXRlTWluTWF4KHQsZis2KX1pJiYoZis9dT80OjAsaS5wdXNoKG5ldyBlLlZlY3RvcjIodFtmKzBdLHRbZisxXSkpLGkucHVzaChuZXcgZS5WZWN0b3IyKHRbZisyXSx0W2YrM10pKSl9fSxuLnByb3RvdHlwZS5fZ2V0Q2FwU2l6ZT1mdW5jdGlvbihlLHQpe3ZvaWQgMD09PXQmJih0PSExKTt2YXIgaT1uLl9yb3VuZENhcFN1YkRpdixyPTAsbz0wO3N3aXRjaChlKXtjYXNlIG4uTm9DYXA6IXRoaXMuY2xvc2VkJiZ0PyhyPTQsbz02KTpyPW89MDticmVhaztjYXNlIG4uUm91bmRDYXA6dD8ocj1pLG89MyooaS0yKSk6KHI9aS8yKzEsbz1pLzIqMyk7YnJlYWs7Y2FzZSBuLkFycm93Q2FwOnQ/KHI9MTIsbz0yNCk6KHI9MyxvPTMpO2JyZWFrO2Nhc2Ugbi5UcmlhbmdsZUNhcDp0PyhyPTYsbz0xMik6KHI9MyxvPTMpO2JyZWFrO2Nhc2Ugbi5EaWFtb25kQW5jaG9yQ2FwOnQ/KHI9MTAsbz0yNCk6KHI9NSxvPTkpO2JyZWFrO2Nhc2Ugbi5TcXVhcmVBbmNob3JDYXA6dD8ocj0xMixvPTMwKToocj00LG89Nik7YnJlYWs7Y2FzZSBuLlJvdW5kQW5jaG9yQ2FwOnQ/KHI9MippLG89NiooaS0xKSk6KHI9aSsxLG89MyooaSsxKSl9cmV0dXJue3Zic2l6ZToyKnIsaWJzaXplOm99fSxuLnByb3RvdHlwZS5fc3RvcmVWZXJ0ZXg9ZnVuY3Rpb24oZSx0LGkscixvLHMsYSl7dmFyIGg9TWF0aC5jb3MobyksYz1NYXRoLnNpbihvKTtuLl90cHNWLng9aCpzLngrLWMqcy55K3IueCxuLl90cHNWLnk9YypzLngraCpzLnkrci55O3ZhciBsPXQrMippO3JldHVybiBlW2wrMF09bi5fdHBzVi54LGVbbCsxXT1uLl90cHNWLnksYSYmKGEucHVzaChuLl90cHNWLngpLGEucHVzaChuLl90cHNWLnkpKSx0aGlzLl91cGRhdGVNaW5NYXgoZSxsKSwodCsyKmkpLzJ9LG4ucHJvdG90eXBlLl9zdG9yZUluZGV4PWZ1bmN0aW9uKGUsdCxpLHIpe2VbdCtpXT1yfSxuLnByb3RvdHlwZS5fYnVpbGRDYXA9ZnVuY3Rpb24odCxpLHIsbyxzLGEsaCxjLGwsdSl7dmFyIGY9bi5fcm91bmRDYXBTdWJEaXYsZD1uZXcgZS5WZWN0b3IyKDEsMCkscD1NYXRoLmF0YW4yKGwueSxsLngpLU1hdGguYXRhbjIoZC55LGQueCksXz1hLzIsbT1hLGc9bnVsbCE9aCx2PWg7c3dpdGNoKGMpe2Nhc2Ugbi5Ob0NhcDppZihnJiYhdGhpcy5jbG9zZWQpe3ZhciB5PTAseD0wLGI9dGhpcy5fc3RvcmVWZXJ0ZXgodCxpLHkrKyxzLHAsbmV3IGUuVmVjdG9yMigwLF8rdiksdSksUD10aGlzLl9zdG9yZVZlcnRleCh0LGkseSsrLHMscCxuZXcgZS5WZWN0b3IyKHYsXyt2KSx1KSxBPXRoaXMuX3N0b3JlVmVydGV4KHQsaSx5KysscyxwLG5ldyBlLlZlY3RvcjIodiwtKF8rdikpLHUpLFQ9dGhpcy5fc3RvcmVWZXJ0ZXgodCxpLHkrKyxzLHAsbmV3IGUuVmVjdG9yMigwLC0oXyt2KSksdSk7dGhpcy5fc3RvcmVJbmRleChyLG8seCsrLGIpLHRoaXMuX3N0b3JlSW5kZXgocixvLHgrKyxQKSx0aGlzLl9zdG9yZUluZGV4KHIsbyx4KyssQSksdGhpcy5fc3RvcmVJbmRleChyLG8seCsrLGIpLHRoaXMuX3N0b3JlSW5kZXgocixvLHgrKyxBKSx0aGlzLl9zdG9yZUluZGV4KHIsbyx4KyssVCl9YnJlYWs7Y2FzZSBuLkFycm93Q2FwOl8qPTI7Y2FzZSBuLlRyaWFuZ2xlQ2FwOmlmKGcpe3ZhciBFPWM9PT1uLlRyaWFuZ2xlQ2FwP3Y6TWF0aC5zcXJ0KHYqdioyKSxiPXRoaXMuX3N0b3JlVmVydGV4KHQsaSwwLHMscCxuZXcgZS5WZWN0b3IyKDAsXyksbnVsbCksUD10aGlzLl9zdG9yZVZlcnRleCh0LGksMSxzLHAsbmV3IGUuVmVjdG9yMihfLDApLG51bGwpLEE9dGhpcy5fc3RvcmVWZXJ0ZXgodCxpLDIscyxwLG5ldyBlLlZlY3RvcjIoMCwtXyksbnVsbCksVD10aGlzLl9zdG9yZVZlcnRleCh0LGksMyxzLHAsbmV3IGUuVmVjdG9yMigwLF8rRSksdSksQz10aGlzLl9zdG9yZVZlcnRleCh0LGksNCxzLHAsbmV3IGUuVmVjdG9yMihfK0UsMCksdSksUz10aGlzLl9zdG9yZVZlcnRleCh0LGksNSxzLHAsbmV3IGUuVmVjdG9yMigwLC0oXytFKSksdSkseD0wO2lmKHRoaXMuX3N0b3JlSW5kZXgocixvLHgrKyxiKSx0aGlzLl9zdG9yZUluZGV4KHIsbyx4KyssVCksdGhpcy5fc3RvcmVJbmRleChyLG8seCsrLEMpLHRoaXMuX3N0b3JlSW5kZXgocixvLHgrKyxiKSx0aGlzLl9zdG9yZUluZGV4KHIsbyx4KyssQyksdGhpcy5fc3RvcmVJbmRleChyLG8seCsrLFApLHRoaXMuX3N0b3JlSW5kZXgocixvLHgrKyxTKSx0aGlzLl9zdG9yZUluZGV4KHIsbyx4KyssQSksdGhpcy5fc3RvcmVJbmRleChyLG8seCsrLFApLHRoaXMuX3N0b3JlSW5kZXgocixvLHgrKyxTKSx0aGlzLl9zdG9yZUluZGV4KHIsbyx4KyssUCksdGhpcy5fc3RvcmVJbmRleChyLG8seCsrLEMpLGM9PT1uLkFycm93Q2FwKXt2YXIgTT1hLzIsST10aGlzLl9zdG9yZVZlcnRleCh0LGksOSxzLHAsbmV3IGUuVmVjdG9yMigwLC0oTSt2KSksbnVsbCksRD10aGlzLl9zdG9yZVZlcnRleCh0LGksMTEscyxwLG5ldyBlLlZlY3RvcjIoLXYsLShfK0UpKSx1KSxSPXRoaXMuX3N0b3JlVmVydGV4KHQsaSwxMCxzLHAsbmV3IGUuVmVjdG9yMigtdiwtKE0rdikpLHUpLE89dGhpcy5fc3RvcmVWZXJ0ZXgodCxpLDYscyxwLG5ldyBlLlZlY3RvcjIoMCxNK3YpLG51bGwpLHc9dGhpcy5fc3RvcmVWZXJ0ZXgodCxpLDcscyxwLG5ldyBlLlZlY3RvcjIoLXYsTSt2KSx1KSxMPXRoaXMuX3N0b3JlVmVydGV4KHQsaSw4LHMscCxuZXcgZS5WZWN0b3IyKC12LF8rRSksdSk7dGhpcy5fc3RvcmVJbmRleChyLG8seCsrLE8pLHRoaXMuX3N0b3JlSW5kZXgocixvLHgrKyx3KSx0aGlzLl9zdG9yZUluZGV4KHIsbyx4KyssTCksdGhpcy5fc3RvcmVJbmRleChyLG8seCsrLE8pLHRoaXMuX3N0b3JlSW5kZXgocixvLHgrKyxMKSx0aGlzLl9zdG9yZUluZGV4KHIsbyx4KyssVCksdGhpcy5fc3RvcmVJbmRleChyLG8seCsrLEkpLHRoaXMuX3N0b3JlSW5kZXgocixvLHgrKyxEKSx0aGlzLl9zdG9yZUluZGV4KHIsbyx4KyssUiksdGhpcy5fc3RvcmVJbmRleChyLG8seCsrLEkpLHRoaXMuX3N0b3JlSW5kZXgocixvLHgrKyxTKSx0aGlzLl9zdG9yZUluZGV4KHIsbyx4KyssRCl9fWVsc2V7dmFyIGI9dGhpcy5fc3RvcmVWZXJ0ZXgodCxpLDAscyxwLG5ldyBlLlZlY3RvcjIoMCxfKSx1KSxQPXRoaXMuX3N0b3JlVmVydGV4KHQsaSwxLHMscCxuZXcgZS5WZWN0b3IyKF8sMCksdSksQT10aGlzLl9zdG9yZVZlcnRleCh0LGksMixzLHAsbmV3IGUuVmVjdG9yMigwLC1fKSx1KTt0aGlzLl9zdG9yZUluZGV4KHIsbywwLGIpLHRoaXMuX3N0b3JlSW5kZXgocixvLDEsUCksdGhpcy5fc3RvcmVJbmRleChyLG8sMixBKX1icmVhaztjYXNlIG4uUm91bmRDYXA6aWYoZylmb3IodmFyIEI9LU1hdGguUEkvMixWPU1hdGguUEkvKGYvMi0xKSx4PTAsRj0wO2YvMj5GO0YrKyl7dmFyIGI9dGhpcy5fc3RvcmVWZXJ0ZXgodCxpLDIqRiswLHMscCxuZXcgZS5WZWN0b3IyKE1hdGguY29zKEIpKl8sTWF0aC5zaW4oQikqXyksbnVsbCksUD10aGlzLl9zdG9yZVZlcnRleCh0LGksMipGKzEscyxwLG5ldyBlLlZlY3RvcjIoTWF0aC5jb3MoQikqKF8rdiksTWF0aC5zaW4oQikqKF8rdikpLHUpO0Y+MCYmKHRoaXMuX3N0b3JlSW5kZXgocixvLHgrKyxiLTIpLHRoaXMuX3N0b3JlSW5kZXgocixvLHgrKyxQLTIpLHRoaXMuX3N0b3JlSW5kZXgocixvLHgrKyxQKSx0aGlzLl9zdG9yZUluZGV4KHIsbyx4KyssYi0yKSx0aGlzLl9zdG9yZUluZGV4KHIsbyx4KyssUCksdGhpcy5fc3RvcmVJbmRleChyLG8seCsrLGIpKSxCKz1WfWVsc2V7dmFyIE49dGhpcy5fc3RvcmVWZXJ0ZXgodCxpLDAscyxwLG5ldyBlLlZlY3RvcjIoMCwwKSxudWxsKSxCPS1NYXRoLlBJLzIsVj1NYXRoLlBJLyhmLzItMSk7dGhpcy5fc3RvcmVWZXJ0ZXgodCxpLDEscyxwLG5ldyBlLlZlY3RvcjIoTWF0aC5jb3MoQikqXyxNYXRoLnNpbihCKSpfKSxudWxsKSxCKz1WO2Zvcih2YXIgRj0xO2YvMj5GO0YrKyl7dmFyIFA9dGhpcy5fc3RvcmVWZXJ0ZXgodCxpLEYrMSxzLHAsbmV3IGUuVmVjdG9yMihNYXRoLmNvcyhCKSpfLE1hdGguc2luKEIpKl8pLHUpO3RoaXMuX3N0b3JlSW5kZXgocixvLDMqRiswLE4pLHRoaXMuX3N0b3JlSW5kZXgocixvLDMqRisxLFAtMSksdGhpcy5fc3RvcmVJbmRleChyLG8sMypGKzIsUCksQis9Vn19YnJlYWs7Y2FzZSBuLlNxdWFyZUFuY2hvckNhcDp2YXIgeT0wLE49Zz9udWxsOnUsYj10aGlzLl9zdG9yZVZlcnRleCh0LGkseSsrLHMscCxuZXcgZS5WZWN0b3IyKDAsbSksTiksUD10aGlzLl9zdG9yZVZlcnRleCh0LGkseSsrLHMscCxuZXcgZS5WZWN0b3IyKDIqbSxtKSxOKSxBPXRoaXMuX3N0b3JlVmVydGV4KHQsaSx5KysscyxwLG5ldyBlLlZlY3RvcjIoMiptLC1tKSxOKSxUPXRoaXMuX3N0b3JlVmVydGV4KHQsaSx5KysscyxwLG5ldyBlLlZlY3RvcjIoMCwtbSksTik7aWYoZyl7dmFyIEM9dGhpcy5fc3RvcmVWZXJ0ZXgodCxpLHkrKyxzLHAsbmV3IGUuVmVjdG9yMigwLF8rdiksbnVsbCksUz10aGlzLl9zdG9yZVZlcnRleCh0LGkseSsrLHMscCxuZXcgZS5WZWN0b3IyKC12LF8rdiksdSksTz10aGlzLl9zdG9yZVZlcnRleCh0LGkseSsrLHMscCxuZXcgZS5WZWN0b3IyKC12LG0rdiksdSksdz10aGlzLl9zdG9yZVZlcnRleCh0LGkseSsrLHMscCxuZXcgZS5WZWN0b3IyKDIqbSt2LG0rdiksdSksTD10aGlzLl9zdG9yZVZlcnRleCh0LGkseSsrLHMscCxuZXcgZS5WZWN0b3IyKDIqbSt2LC0obSt2KSksdSksST10aGlzLl9zdG9yZVZlcnRleCh0LGkseSsrLHMscCxuZXcgZS5WZWN0b3IyKC12LC0obSt2KSksdSksUj10aGlzLl9zdG9yZVZlcnRleCh0LGkseSsrLHMscCxuZXcgZS5WZWN0b3IyKC12LC0oXyt2KSksdSksRD10aGlzLl9zdG9yZVZlcnRleCh0LGkseSsrLHMscCxuZXcgZS5WZWN0b3IyKDAsLShfK3YpKSxudWxsKSx4PTA7dGhpcy5fc3RvcmVJbmRleChyLG8seCsrLFMpLHRoaXMuX3N0b3JlSW5kZXgocixvLHgrKyxiKSx0aGlzLl9zdG9yZUluZGV4KHIsbyx4KyssQyksdGhpcy5fc3RvcmVJbmRleChyLG8seCsrLFMpLHRoaXMuX3N0b3JlSW5kZXgocixvLHgrKyxPKSx0aGlzLl9zdG9yZUluZGV4KHIsbyx4KyssYiksdGhpcy5fc3RvcmVJbmRleChyLG8seCsrLGIpLHRoaXMuX3N0b3JlSW5kZXgocixvLHgrKyxPKSx0aGlzLl9zdG9yZUluZGV4KHIsbyx4KyssdyksdGhpcy5fc3RvcmVJbmRleChyLG8seCsrLGIpLHRoaXMuX3N0b3JlSW5kZXgocixvLHgrKyx3KSx0aGlzLl9zdG9yZUluZGV4KHIsbyx4KyssUCksdGhpcy5fc3RvcmVJbmRleChyLG8seCsrLFApLHRoaXMuX3N0b3JlSW5kZXgocixvLHgrKyx3KSx0aGlzLl9zdG9yZUluZGV4KHIsbyx4KyssTCksdGhpcy5fc3RvcmVJbmRleChyLG8seCsrLFApLHRoaXMuX3N0b3JlSW5kZXgocixvLHgrKyxMKSx0aGlzLl9zdG9yZUluZGV4KHIsbyx4KyssQSksdGhpcy5fc3RvcmVJbmRleChyLG8seCsrLEEpLHRoaXMuX3N0b3JlSW5kZXgocixvLHgrKyxMKSx0aGlzLl9zdG9yZUluZGV4KHIsbyx4KyssSSksdGhpcy5fc3RvcmVJbmRleChyLG8seCsrLEEpLHRoaXMuX3N0b3JlSW5kZXgocixvLHgrKyxJKSx0aGlzLl9zdG9yZUluZGV4KHIsbyx4KyssVCksdGhpcy5fc3RvcmVJbmRleChyLG8seCsrLEkpLHRoaXMuX3N0b3JlSW5kZXgocixvLHgrKyxSKSx0aGlzLl9zdG9yZUluZGV4KHIsbyx4KyssVCksdGhpcy5fc3RvcmVJbmRleChyLG8seCsrLFIpLHRoaXMuX3N0b3JlSW5kZXgocixvLHgrKyxEKSx0aGlzLl9zdG9yZUluZGV4KHIsbyx4KyssVCl9ZWxzZSB0aGlzLl9zdG9yZUluZGV4KHIsbywwLGIpLHRoaXMuX3N0b3JlSW5kZXgocixvLDEsUCksdGhpcy5fc3RvcmVJbmRleChyLG8sMixBKSx0aGlzLl9zdG9yZUluZGV4KHIsbywzLGIpLHRoaXMuX3N0b3JlSW5kZXgocixvLDQsQSksdGhpcy5fc3RvcmVJbmRleChyLG8sNSxUKTticmVhaztjYXNlIG4uUm91bmRBbmNob3JDYXA6dmFyIHo9TWF0aC5zcXJ0KG0qbS1fKl8pLGs9bmV3IGUuVmVjdG9yMih6LDApLEI9ZS5Ub29scy5Ub1JhZGlhbnMoLTE1MCksVj1lLlRvb2xzLlRvUmFkaWFucygzMDApLyhmLTEpO2lmKGcpZm9yKHZhciB4PTAsRj0wO2Y+RjtGKyspe3ZhciBiPXRoaXMuX3N0b3JlVmVydGV4KHQsaSwyKkYrMCxzLHAsbmV3IGUuVmVjdG9yMih6K01hdGguY29zKEIpKm0sTWF0aC5zaW4oQikqbSksbnVsbCksUD10aGlzLl9zdG9yZVZlcnRleCh0LGksMipGKzEscyxwLG5ldyBlLlZlY3RvcjIoeitNYXRoLmNvcyhCKSoobSt2KSxNYXRoLnNpbihCKSoobSt2KSksdSk7Rj4wJiYodGhpcy5fc3RvcmVJbmRleChyLG8seCsrLGItMiksdGhpcy5fc3RvcmVJbmRleChyLG8seCsrLFAtMiksdGhpcy5fc3RvcmVJbmRleChyLG8seCsrLFApLHRoaXMuX3N0b3JlSW5kZXgocixvLHgrKyxiLTIpLHRoaXMuX3N0b3JlSW5kZXgocixvLHgrKyxQKSx0aGlzLl9zdG9yZUluZGV4KHIsbyx4KyssYikpLEIrPVZ9ZWxzZXt2YXIgTj10aGlzLl9zdG9yZVZlcnRleCh0LGksMCxzLHAsayxudWxsKTt0aGlzLl9zdG9yZVZlcnRleCh0LGksMSxzLHAsbmV3IGUuVmVjdG9yMih6K01hdGguY29zKEIpKm0sTWF0aC5zaW4oQikqbSksbnVsbCksQis9Vjtmb3IodmFyIEY9MTtmPkY7RisrKXt2YXIgUD10aGlzLl9zdG9yZVZlcnRleCh0LGksRisxLHMscCxuZXcgZS5WZWN0b3IyKHorTWF0aC5jb3MoQikqbSxNYXRoLnNpbihCKSptKSx1KTt0aGlzLl9zdG9yZUluZGV4KHIsbywzKkYrMCxOKSx0aGlzLl9zdG9yZUluZGV4KHIsbywzKkYrMSxQLTEpLHRoaXMuX3N0b3JlSW5kZXgocixvLDMqRisyLFApLEIrPVZ9dGhpcy5fc3RvcmVJbmRleChyLG8sMypmKzAsTiksdGhpcy5fc3RvcmVJbmRleChyLG8sMypmKzEsTisxKSx0aGlzLl9zdG9yZUluZGV4KHIsbywzKmYrMixOK2YpfWJyZWFrO2Nhc2Ugbi5EaWFtb25kQW5jaG9yQ2FwOnZhciB5PTAsTj1nP251bGw6dSxiPXRoaXMuX3N0b3JlVmVydGV4KHQsaSx5KysscyxwLG5ldyBlLlZlY3RvcjIoMCxfKSxOKSxQPXRoaXMuX3N0b3JlVmVydGV4KHQsaSx5KysscyxwLG5ldyBlLlZlY3RvcjIoXyxtKSxOKSxBPXRoaXMuX3N0b3JlVmVydGV4KHQsaSx5KysscyxwLG5ldyBlLlZlY3RvcjIoMypfLDApLE4pLFQ9dGhpcy5fc3RvcmVWZXJ0ZXgodCxpLHkrKyxzLHAsbmV3IGUuVmVjdG9yMihfLC1tKSxOKSxDPXRoaXMuX3N0b3JlVmVydGV4KHQsaSx5KysscyxwLG5ldyBlLlZlY3RvcjIoMCwtXyksTik7aWYoZyl7dmFyIEU9TWF0aC5zcXJ0KHYqdioyKSxTPXRoaXMuX3N0b3JlVmVydGV4KHQsaSx5KysscyxwLG5ldyBlLlZlY3RvcjIoLUUsXyksdSksTz10aGlzLl9zdG9yZVZlcnRleCh0LGkseSsrLHMscCxuZXcgZS5WZWN0b3IyKF8sbStFKSx1KSx3PXRoaXMuX3N0b3JlVmVydGV4KHQsaSx5KysscyxwLG5ldyBlLlZlY3RvcjIoMypfK0UsMCksdSksTD10aGlzLl9zdG9yZVZlcnRleCh0LGkseSsrLHMscCxuZXcgZS5WZWN0b3IyKF8sLShtK0UpKSx1KSxJPXRoaXMuX3N0b3JlVmVydGV4KHQsaSx5KysscyxwLG5ldyBlLlZlY3RvcjIoLUUsLV8pLHUpLHg9MDt0aGlzLl9zdG9yZUluZGV4KHIsbyx4KyssUyksdGhpcy5fc3RvcmVJbmRleChyLG8seCsrLE8pLHRoaXMuX3N0b3JlSW5kZXgocixvLHgrKyxiKSx0aGlzLl9zdG9yZUluZGV4KHIsbyx4KyssYiksdGhpcy5fc3RvcmVJbmRleChyLG8seCsrLE8pLHRoaXMuX3N0b3JlSW5kZXgocixvLHgrKyxQKSx0aGlzLl9zdG9yZUluZGV4KHIsbyx4KyssUCksdGhpcy5fc3RvcmVJbmRleChyLG8seCsrLE8pLHRoaXMuX3N0b3JlSW5kZXgocixvLHgrKyx3KSx0aGlzLl9zdG9yZUluZGV4KHIsbyx4KyssUCksdGhpcy5fc3RvcmVJbmRleChyLG8seCsrLHcpLHRoaXMuX3N0b3JlSW5kZXgocixvLHgrKyxBKSx0aGlzLl9zdG9yZUluZGV4KHIsbyx4KyssQSksdGhpcy5fc3RvcmVJbmRleChyLG8seCsrLHcpLHRoaXMuX3N0b3JlSW5kZXgocixvLHgrKyxMKSx0aGlzLl9zdG9yZUluZGV4KHIsbyx4KyssQSksdGhpcy5fc3RvcmVJbmRleChyLG8seCsrLEwpLHRoaXMuX3N0b3JlSW5kZXgocixvLHgrKyxUKSx0aGlzLl9zdG9yZUluZGV4KHIsbyx4KyssVCksdGhpcy5fc3RvcmVJbmRleChyLG8seCsrLEwpLHRoaXMuX3N0b3JlSW5kZXgocixvLHgrKyxJKSx0aGlzLl9zdG9yZUluZGV4KHIsbyx4KyssVCksdGhpcy5fc3RvcmVJbmRleChyLG8seCsrLEkpLHRoaXMuX3N0b3JlSW5kZXgocixvLHgrKyxDKX1lbHNlIHRoaXMuX3N0b3JlSW5kZXgocixvLDAsYiksdGhpcy5fc3RvcmVJbmRleChyLG8sMSxQKSx0aGlzLl9zdG9yZUluZGV4KHIsbywyLEEpLHRoaXMuX3N0b3JlSW5kZXgocixvLDMsYiksdGhpcy5fc3RvcmVJbmRleChyLG8sNCxBKSx0aGlzLl9zdG9yZUluZGV4KHIsbyw1LEMpLHRoaXMuX3N0b3JlSW5kZXgocixvLDYsQyksXG50aGlzLl9zdG9yZUluZGV4KHIsbyw3LEEpLHRoaXMuX3N0b3JlSW5kZXgocixvLDgsVCl9cmV0dXJuIG51bGx9LG4ucHJvdG90eXBlLl9idWlsZExpbmU9ZnVuY3Rpb24odCxpLHIsbil7dmFyIG89ZS5WZWN0b3IyLlplcm8oKSxzPWUuVmVjdG9yMi5aZXJvKCksYT1lLlZlY3RvcjIuWmVybygpLGg9ZS5WZWN0b3IyLlplcm8oKSxjPW51bGw7dGhpcy5jbG9zZWQmJnRoaXMucG9pbnRzLnB1c2godGhpcy5wb2ludHNbMF0pO2Zvcih2YXIgbD10aGlzLnBvaW50cy5sZW5ndGgsdT0xO2w+dTt1Kyspe3ZhciBmPXRoaXMucG9pbnRzW3UtMV0sZD10aGlzLnBvaW50c1t1XSxwPXU8dGhpcy5wb2ludHMubGVuZ3RoLTE/dGhpcy5wb2ludHNbdSsxXTpudWxsO2lmKHRoaXMuX2RpcmVjdGlvbihkLGYsbyksY3x8KGM9ZS5WZWN0b3IyLlplcm8oKSx0aGlzLl9wZXJwKG8sYykpLDE9PT11JiZ0aGlzLl9zdG9yZSh0LGksMCxsLHRoaXMucG9pbnRzWzBdLGMscixuKSxwKXt0aGlzLl9kaXJlY3Rpb24ocCxkLHMpO3ZhciBfPXRoaXMuX2NvbXB1dGVNaXRlcihhLGgsbyxzKTt0aGlzLl9zdG9yZSh0LGksdSxsLHRoaXMucG9pbnRzW3VdLGgsXypyLF8qbix1LTEpfWVsc2UgdGhpcy5fcGVycChvLGMpLHRoaXMuX3N0b3JlKHQsaSx1LGwsdGhpcy5wb2ludHNbdV0sYyxyLG4sdS0xKX1pZih0aGlzLnBvaW50cy5sZW5ndGg+MiYmdGhpcy5jbG9zZWQpe3ZhciBtPXRoaXMucG9pbnRzW2wtMl0sZz10aGlzLnBvaW50c1swXSx2PXRoaXMucG9pbnRzWzFdO3RoaXMuX2RpcmVjdGlvbihnLG0sbyksdGhpcy5fZGlyZWN0aW9uKHYsZyxzKSx0aGlzLl9wZXJwKG8sYyk7dmFyIHk9dGhpcy5fY29tcHV0ZU1pdGVyKGEsaCxvLHMpO2lmKHRoaXMuX3N0b3JlKHQsbnVsbCwwLGwsdGhpcy5wb2ludHNbMF0saCx5KnIseSpuLDEpLGkpe3ZhciB4PW51bGw9PW4/MDo0O2lbMF0ueD10W3grMF0saVswXS55PXRbeCsxXSxpWzFdLng9dFt4KzJdLGlbMV0ueT10W3grM119fXRoaXMuY2xvc2VkJiZ0aGlzLnBvaW50cy5zcGxpY2UobC0xKX0sbi5wcm90b3R5cGUuc2V0dXBNb2RlbFJlbmRlckNhY2hlPWZ1bmN0aW9uKHQpe3ZhciBpPXQscj10aGlzLm93bmVyLmVuZ2luZTtpZihudWxsPT09dGhpcy5fZmlsbFZCJiZ0aGlzLl9jb21wdXRlTGluZXMyRCgpLHRoaXMuZmlsbCl7aS5maWxsVkI9ci5jcmVhdGVWZXJ0ZXhCdWZmZXIodGhpcy5fZmlsbFZCKSxpLmZpbGxJQj1yLmNyZWF0ZUluZGV4QnVmZmVyKHRoaXMuX2ZpbGxJQiksaS5maWxsSW5kaWNlc0NvdW50PXRoaXMuX2ZpbGxJQi5sZW5ndGg7dmFyIG49dGhpcy5nZXREYXRhUGFydEVmZmVjdEluZm8oZS5TaGFwZTJELlNIQVBFMkRfRklMTFBBUlRJRCxbXCJwb3NpdGlvblwiXSwhMCk7biYmKGkuZWZmZWN0RmlsbEluc3RhbmNlZD1yLmNyZWF0ZUVmZmVjdChcImxpbmVzMmRcIixuLmF0dHJpYnV0ZXMsbi51bmlmb3JtcyxbXSxuLmRlZmluZXMsbnVsbCkpLG49dGhpcy5nZXREYXRhUGFydEVmZmVjdEluZm8oZS5TaGFwZTJELlNIQVBFMkRfRklMTFBBUlRJRCxbXCJwb3NpdGlvblwiXSwhMSksaS5lZmZlY3RGaWxsPXIuY3JlYXRlRWZmZWN0KFwibGluZXMyZFwiLG4uYXR0cmlidXRlcyxuLnVuaWZvcm1zLFtdLG4uZGVmaW5lcyxudWxsKX1pZih0aGlzLmJvcmRlcil7aS5ib3JkZXJWQj1yLmNyZWF0ZVZlcnRleEJ1ZmZlcih0aGlzLl9ib3JkZXJWQiksaS5ib3JkZXJJQj1yLmNyZWF0ZUluZGV4QnVmZmVyKHRoaXMuX2JvcmRlcklCKSxpLmJvcmRlckluZGljZXNDb3VudD10aGlzLl9ib3JkZXJJQi5sZW5ndGg7dmFyIG49dGhpcy5nZXREYXRhUGFydEVmZmVjdEluZm8oZS5TaGFwZTJELlNIQVBFMkRfQk9SREVSUEFSVElELFtcInBvc2l0aW9uXCJdLCEwKTtuJiYoaS5lZmZlY3RCb3JkZXJJbnN0YW5jZWQ9ci5jcmVhdGVFZmZlY3Qoe3ZlcnRleDpcImxpbmVzMmRcIixmcmFnbWVudDpcImxpbmVzMmRcIn0sbi5hdHRyaWJ1dGVzLG4udW5pZm9ybXMsW10sbi5kZWZpbmVzLG51bGwpKSxuPXRoaXMuZ2V0RGF0YVBhcnRFZmZlY3RJbmZvKGUuU2hhcGUyRC5TSEFQRTJEX0JPUkRFUlBBUlRJRCxbXCJwb3NpdGlvblwiXSwhMSksaS5lZmZlY3RCb3JkZXI9ci5jcmVhdGVFZmZlY3Qoe3ZlcnRleDpcImxpbmVzMmRcIixmcmFnbWVudDpcImxpbmVzMmRcIn0sbi5hdHRyaWJ1dGVzLG4udW5pZm9ybXMsW10sbi5kZWZpbmVzLG51bGwpfXJldHVybiB0aGlzLl9maWxsVkI9bnVsbCx0aGlzLl9maWxsSUI9bnVsbCx0aGlzLl9ib3JkZXJWQj1udWxsLHRoaXMuX2JvcmRlcklCPW51bGwsaX0sbi5wcm90b3R5cGUuX2NvbXB1dGVMaW5lczJEPWZ1bmN0aW9uKCl7dGhpcy5fYm91bmRpbmdNaW49bmV3IGUuVmVjdG9yMihOdW1iZXIuTUFYX1ZBTFVFLE51bWJlci5NQVhfVkFMVUUpLHRoaXMuX2JvdW5kaW5nTWF4PW5ldyBlLlZlY3RvcjIoTnVtYmVyLk1JTl9WQUxVRSxOdW1iZXIuTUlOX1ZBTFVFKTt2YXIgdD1uZXcgQXJyYXksaT1uZXcgQXJyYXkscj1uZXcgQXJyYXk7aWYodGhpcy5maWxsKXt2YXIgbz10aGlzLl9nZXRDYXBTaXplKHRoaXMuc3RhcnRDYXApLHM9dGhpcy5fZ2V0Q2FwU2l6ZSh0aGlzLmVuZENhcCksYT10aGlzLnBvaW50cy5sZW5ndGgsaD0yKmEqMitvLnZic2l6ZStzLnZic2l6ZTt0aGlzLl9maWxsVkI9bmV3IEZsb2F0MzJBcnJheShoKTt2YXIgYz10aGlzLl9maWxsVkIsbD10aGlzLmZpbGxUaGlja25lc3MvMix1PXRoaXMucG9pbnRzLmxlbmd0aDt0aGlzLl9idWlsZExpbmUoYyx0aGlzLmJvcmRlcj9udWxsOnQsbCk7dmFyIGY9Mip1LGQ9MiooYS0odGhpcy5jbG9zZWQ/MDoxKSk7dGhpcy5fZmlsbElCPW5ldyBGbG9hdDMyQXJyYXkoMypkK28uaWJzaXplK3MuaWJzaXplKTtmb3IodmFyIHA9dGhpcy5fZmlsbElCLF89MDtkPl87Xys9MilwWzMqXyswXT1fKzAscFszKl8rMV09XysxLHBbMypfKzJdPShfKzIpJWYscFszKl8rM109XysxLHBbMypfKzRdPShfKzMpJWYscFszKl8rNV09KF8rMiklZjt0aGlzLl9idWlsZENhcChjLDIqYSoyLHAsMypkLHRoaXMucG9pbnRzWzBdLHRoaXMuZmlsbFRoaWNrbmVzcyxudWxsLHRoaXMuc3RhcnRDYXAsbi5fc3RhcnREaXIsdGhpcy5ib3JkZXI/bnVsbDppKSx0aGlzLl9idWlsZENhcChjLDIqYSoyK28udmJzaXplLHAsMypkK28uaWJzaXplLHRoaXMucG9pbnRzW3UtMV0sdGhpcy5maWxsVGhpY2tuZXNzLG51bGwsdGhpcy5lbmRDYXAsbi5fZW5kRGlyLHRoaXMuYm9yZGVyP251bGw6aSl9aWYodGhpcy5ib3JkZXIpe3ZhciBvPXRoaXMuX2dldENhcFNpemUodGhpcy5zdGFydENhcCwhMCkscz10aGlzLl9nZXRDYXBTaXplKHRoaXMuZW5kQ2FwLCEwKSxhPXRoaXMucG9pbnRzLmxlbmd0aCxoPTIqYSoyKjIrby52YnNpemUrcy52YnNpemU7dGhpcy5fYm9yZGVyVkI9bmV3IEZsb2F0MzJBcnJheShoKTt2YXIgYz10aGlzLl9ib3JkZXJWQixsPXRoaXMuZmlsbFRoaWNrbmVzcy8yLG09dGhpcy5ib3JkZXJUaGlja25lc3MsdT10aGlzLnBvaW50cy5sZW5ndGg7dGhpcy5fYnVpbGRMaW5lKGMsdCxsLG0pO3ZhciBmPTIqdSoyLGQ9MiooYS0odGhpcy5jbG9zZWQ/MDoxKSkqMjt0aGlzLl9ib3JkZXJJQj1uZXcgRmxvYXQzMkFycmF5KDMqZCtvLmlic2l6ZStzLmlic2l6ZSk7Zm9yKHZhciBwPXRoaXMuX2JvcmRlcklCLF89MDtkPl87Xys9NClwWzMqXyswXT1fKzAscFszKl8rMV09XysyLHBbMypfKzJdPShfKzYpJWYscFszKl8rM109XyswLHBbMypfKzRdPShfKzYpJWYscFszKl8rNV09KF8rNCklZixwWzMqXys2XT1fKzMscFszKl8rN109XysxLHBbMypfKzhdPShfKzUpJWYscFszKl8rOV09XyszLHBbMypfKzEwXT0oXys1KSVmLHBbMypfKzExXT0oXys3KSVmO3RoaXMuX2J1aWxkQ2FwKGMsMiphKjIqMixwLDMqZCx0aGlzLnBvaW50c1swXSx0aGlzLmZpbGxUaGlja25lc3MsdGhpcy5ib3JkZXJUaGlja25lc3MsdGhpcy5zdGFydENhcCxuLl9zdGFydERpcixpKSx0aGlzLl9idWlsZENhcChjLDIqYSoyKjIrby52YnNpemUscCwzKmQrby5pYnNpemUsdGhpcy5wb2ludHNbdS0xXSx0aGlzLmZpbGxUaGlja25lc3MsdGhpcy5ib3JkZXJUaGlja25lc3MsdGhpcy5lbmRDYXAsbi5fZW5kRGlyLHIpfWlmKHRoaXMuX2NvbnRvdXI9dCxpLmxlbmd0aD4wKXt2YXIgZz1FYXJjdXQuZWFyY3V0KGksbnVsbCwyKTt0aGlzLl9zdGFydENhcFRyaUluZGljZXM9Zyx0aGlzLl9zdGFydENhcENvbnRvdXI9aX1pZihyLmxlbmd0aD4wKXt2YXIgdj1FYXJjdXQuZWFyY3V0KHIsbnVsbCwyKTt0aGlzLl9lbmRDYXBDb250b3VyPXIsdGhpcy5fZW5kQ2FwVHJpSW5kaWNlcz12fXZhciB5PXRoaXMuX2JvdW5kaW5nTWF4LnN1YnRyYWN0KHRoaXMuX2JvdW5kaW5nTWluKTt0aGlzLl9zaXplLndpZHRoPXkueCx0aGlzLl9zaXplLmhlaWdodD15Lnl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuLnByb3RvdHlwZSxcInNpemVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIG51bGw9PXRoaXMuX3NpemUmJnRoaXMuX2NvbXB1dGVMaW5lczJEKCksdGhpcy5fc2l6ZX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxuLnByb3RvdHlwZS5jcmVhdGVJbnN0YW5jZURhdGFQYXJ0cz1mdW5jdGlvbigpe3ZhciB0PW5ldyBBcnJheTtyZXR1cm4gdGhpcy5ib3JkZXImJnQucHVzaChuZXcgaShlLlNoYXBlMkQuU0hBUEUyRF9CT1JERVJQQVJUSUQpKSx0aGlzLmZpbGwmJnQucHVzaChuZXcgaShlLlNoYXBlMkQuU0hBUEUyRF9GSUxMUEFSVElEKSksdH0sbi5wcm90b3R5cGUucmVmcmVzaEluc3RhbmNlRGF0YVBhcnQ9ZnVuY3Rpb24odCl7aWYoIXIucHJvdG90eXBlLnJlZnJlc2hJbnN0YW5jZURhdGFQYXJ0LmNhbGwodGhpcyx0KSlyZXR1cm4hMTtpZih0LmlkPT09ZS5TaGFwZTJELlNIQVBFMkRfQk9SREVSUEFSVElEKXt2YXIgaT10O3RoaXMuYm9yZGVyIGluc3RhbmNlb2YgZS5HcmFkaWVudENvbG9yQnJ1c2gyRCYmKGkuYm91bmRpbmdNaW49dGhpcy5ib3VuZGluZ01pbixpLmJvdW5kaW5nTWF4PXRoaXMuYm91bmRpbmdNYXgpfWVsc2UgaWYodC5pZD09PWUuU2hhcGUyRC5TSEFQRTJEX0ZJTExQQVJUSUQpe3ZhciBpPXQ7dGhpcy5maWxsIGluc3RhbmNlb2YgZS5HcmFkaWVudENvbG9yQnJ1c2gyRCYmKGkuYm91bmRpbmdNaW49dGhpcy5ib3VuZGluZ01pbixpLmJvdW5kaW5nTWF4PXRoaXMuYm91bmRpbmdNYXgpfXJldHVybiEwfSxuLl9wcmV2QT1lLlZlY3RvcjIuWmVybygpLG4uX3ByZXZCPWUuVmVjdG9yMi5aZXJvKCksbi5fY3VyQT1lLlZlY3RvcjIuWmVybygpLG4uX2N1ckI9ZS5WZWN0b3IyLlplcm8oKSxuLl9taXRlclRwcz1lLlZlY3RvcjIuWmVybygpLG4uX3N0YXJ0RGlyPWUuVmVjdG9yMi5aZXJvKCksbi5fZW5kRGlyPWUuVmVjdG9yMi5aZXJvKCksbi5fdHBzVj1lLlZlY3RvcjIuWmVybygpLG4uX25vQ2FwPTAsbi5fcm91bmRDYXA9MSxuLl90cmlhbmdsZUNhcD0yLG4uX3NxdWFyZUFuY2hvckNhcD0zLG4uX3JvdW5kQW5jaG9yQ2FwPTQsbi5fZGlhbW9uZEFuY2hvckNhcD01LG4uX2Fycm93Q2FwPTYsbi5fcm91bmRDYXBTdWJEaXY9MzYsX19kZWNvcmF0ZShbZS5tb2RlbExldmVsUHJvcGVydHkoZS5TaGFwZTJELlNIQVBFMkRfUFJPUENPVU5UKzEsZnVuY3Rpb24oZSl7cmV0dXJuIG4ucG9pbnRzUHJvcGVydHk9ZX0pXSxuLnByb3RvdHlwZSxcInBvaW50c1wiLG51bGwpLF9fZGVjb3JhdGUoW2UubW9kZWxMZXZlbFByb3BlcnR5KGUuU2hhcGUyRC5TSEFQRTJEX1BST1BDT1VOVCsyLGZ1bmN0aW9uKGUpe3JldHVybiBuLmZpbGxUaGlja25lc3NQcm9wZXJ0eT1lfSldLG4ucHJvdG90eXBlLFwiZmlsbFRoaWNrbmVzc1wiLG51bGwpLF9fZGVjb3JhdGUoW2UubW9kZWxMZXZlbFByb3BlcnR5KGUuU2hhcGUyRC5TSEFQRTJEX1BST1BDT1VOVCszLGZ1bmN0aW9uKGUpe3JldHVybiBuLmNsb3NlZFByb3BlcnR5PWV9KV0sbi5wcm90b3R5cGUsXCJjbG9zZWRcIixudWxsKSxfX2RlY29yYXRlKFtlLm1vZGVsTGV2ZWxQcm9wZXJ0eShlLlNoYXBlMkQuU0hBUEUyRF9QUk9QQ09VTlQrNCxmdW5jdGlvbihlKXtyZXR1cm4gbi5zdGFydENhcFByb3BlcnR5PWV9KV0sbi5wcm90b3R5cGUsXCJzdGFydENhcFwiLG51bGwpLF9fZGVjb3JhdGUoW2UubW9kZWxMZXZlbFByb3BlcnR5KGUuU2hhcGUyRC5TSEFQRTJEX1BST1BDT1VOVCs1LGZ1bmN0aW9uKGUpe3JldHVybiBuLmVuZENhcFByb3BlcnR5PWV9KV0sbi5wcm90b3R5cGUsXCJlbmRDYXBcIixudWxsKSxuPV9fZGVjb3JhdGUoW2UuY2xhc3NOYW1lKFwiTGluZXMyRFwiKV0sbil9KGUuU2hhcGUyRCk7ZS5MaW5lczJEPXJ9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCgpe3RoaXMuX21vZGVsQ2FjaGU9bmV3IGUuU3RyaW5nRGljdGlvbmFyeX1yZXR1cm4gdC5wcm90b3R5cGUuR2V0T3JBZGRNb2RlbENhY2hlPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuX21vZGVsQ2FjaGUuZ2V0T3JBZGRXaXRoRmFjdG9yeShlLHQpfSx0LnByb3RvdHlwZS5EaXNwb3NlTW9kZWxSZW5kZXJDYWNoZT1mdW5jdGlvbihlKXtyZXR1cm4gZS5pc0Rpc3Bvc2VkPyh0aGlzLl9tb2RlbENhY2hlLnJlbW92ZShlLm1vZGVsS2V5KSwhMCk6ITF9LHR9KCk7ZS5DYW52YXMyREVuZ2luZUJvdW5kRGF0YT10O3ZhciBpPWZ1bmN0aW9uKGkpe2Z1bmN0aW9uIHIobixvKXt2YXIgcz10aGlzO2kuY2FsbCh0aGlzLG8pLHRoaXMud29ybGRTcGFjZVRvTm9kZUxvY2FsPWZ1bmN0aW9uKHQpe3ZhciBpPXMuX3dvcmxkU3BhY2VOb2RlO2lmKGkpe3ZhciByPWkuZ2V0V29ybGRNYXRyaXgoKS5jbG9uZSgpO3IuaW52ZXJ0KCk7dmFyIG49ZS5WZWN0b3IzLlRyYW5zZm9ybUNvb3JkaW5hdGVzKHQsciksbz1zLl9yZW5kZXJTY2FsZUZhY3RvcixhPW5ldyBlLlZlY3RvcjIobi54Km8sbi55Km8pLGg9cy5hY3R1YWxTaXplO3Mub3JpZ2luO3JldHVybiBhLngrPS41Kmgud2lkdGgsYS55Kz0uNSpoLndpZHRoLGF9fSx0aGlzLl9ub3RpZkRlYnVnTW9kZT0hMSx0aGlzLl9tYXBDb3VudGVyPTAsZS5QcmltMkRCYXNlLl9pc0NhbnZhc0luaXQ9ITEsb3x8KG89e30pO3ZhciBhPW51bGw9PW8ucmVuZGVyU2NhbGVGYWN0b3I/MTpvLnJlbmRlclNjYWxlRmFjdG9yO3RoaXMuX2NhY2hpbmdTdHJhdGVneSE9PXIuQ0FDSEVTVFJBVEVHWV9UT1BMRVZFTEdST1VQUyYmKHRoaXMuX2JhY2tncm91bmQ9bmV3IGUuUmVjdGFuZ2xlMkQoe3BhcmVudDp0aGlzLGlkOlwiIyMjQ0FOVkFTIEJBQ0tHUk9VTkQjIyNcIixzaXplOm8uc2l6ZX0pLHRoaXMuX2JhY2tncm91bmQuek9yZGVyPTEsdGhpcy5fYmFja2dyb3VuZC5pc1BpY2thYmxlPSExLHRoaXMuX2JhY2tncm91bmQub3JpZ2luPWUuVmVjdG9yMi5aZXJvKCksdGhpcy5fYmFja2dyb3VuZC5sZXZlbFZpc2libGU9ITEsbnVsbCE9by5iYWNrZ3JvdW5kUm91bmRSYWRpdXMmJih0aGlzLmJhY2tncm91bmRSb3VuZFJhZGl1cz1vLmJhY2tncm91bmRSb3VuZFJhZGl1cyksbnVsbCE9by5iYWNrZ3JvdW5kQm9yZGVyJiYoXCJzdHJpbmdcIj09dHlwZW9mIG8uYmFja2dyb3VuZEJvcmRlcj90aGlzLmJhY2tncm91bmRCb3JkZXI9ci5HZXRCcnVzaEZyb21TdHJpbmcoby5iYWNrZ3JvdW5kQm9yZGVyKTp0aGlzLmJhY2tncm91bmRCb3JkZXI9by5iYWNrZ3JvdW5kQm9yZGVyKSxudWxsIT1vLmJhY2tncm91bmRCb3JkZXJUaGlja05lc3MmJih0aGlzLmJhY2tncm91bmRCb3JkZXJUaGlja25lc3M9by5iYWNrZ3JvdW5kQm9yZGVyVGhpY2tOZXNzKSxudWxsIT1vLmJhY2tncm91bmRGaWxsJiYoXCJzdHJpbmdcIj09dHlwZW9mIG8uYmFja2dyb3VuZEZpbGw/dGhpcy5iYWNrZ3JvdW5kRmlsbD1yLkdldEJydXNoRnJvbVN0cmluZyhvLmJhY2tncm91bmRGaWxsKTp0aGlzLmJhY2tncm91bmRGaWxsPW8uYmFja2dyb3VuZEZpbGwpLHRoaXMuX2JhY2tncm91bmQuX3BhdGNoSGllcmFyY2h5KHRoaXMpKTt2YXIgaD1uLmdldEVuZ2luZSgpO3RoaXMuX19lbmdpbmVEYXRhPWguZ2V0T3JBZGRFeHRlcm5hbERhdGFXaXRoRmFjdG9yeShcIl9fQkpTQ0FOVkFTMkRfX1wiLGZ1bmN0aW9uKGUpe3JldHVybiBuZXcgdH0pLHRoaXMuX3JlbmRlclNjYWxlRmFjdG9yPWEsdGhpcy5fcHJpbVBvaW50ZXJJbmZvPW5ldyBlLlByaW1pdGl2ZVBvaW50ZXJJbmZvLHRoaXMuX2NhcHR1cmVkUG9pbnRlcnM9bmV3IGUuU3RyaW5nRGljdGlvbmFyeSx0aGlzLl9waWNrU3RhcnRpbmdQb3NpdGlvbj1lLlZlY3RvcjIuWmVybygpLHRoaXMuX2hpZXJhcmNoeUxldmVsTWF4U2libGluZ0NvdW50PTUwLHRoaXMuX2hpZXJhcmNoeURlcHRoT2Zmc2V0PTAsdGhpcy5fc2libGluZ0RlcHRoT2Zmc2V0PTEvdGhpcy5faGllcmFyY2h5TGV2ZWxNYXhTaWJsaW5nQ291bnQsdGhpcy5fc2NlbmU9bix0aGlzLl9lbmdpbmU9aCx0aGlzLl9yZW5kZXJpbmdTaXplPW5ldyBlLlNpemUoMCwwKSx0aGlzLl90cmFja2VkR3JvdXBzPW5ldyBBcnJheSx0aGlzLl9wYXRjaEhpZXJhcmNoeSh0aGlzKTt2YXIgYz1udWxsPT1vLmVuYWJsZUludGVyYWN0aW9uPyEwOm8uZW5hYmxlSW50ZXJhY3Rpb247dGhpcy5fZml0UmVuZGVyaW5nRGV2aWNlPSFvLnNpemUsby5zaXplPyhvLnNpemUuaGVpZ2h0Kj1hLG8uc2l6ZS53aWR0aCo9YSk6by5zaXplPW5ldyBlLlNpemUoaC5nZXRSZW5kZXJXaWR0aCgpLGguZ2V0UmVuZGVySGVpZ2h0KCkpLG4ub25EaXNwb3NlT2JzZXJ2YWJsZS5hZGQoZnVuY3Rpb24oZSx0KXtzLmRpc3Bvc2UoKX0pLHRoaXMuX2lzU2NyZWVuU3BhY2U/dGhpcy5fYWZ0ZXJSZW5kZXJPYnNlcnZlcj10aGlzLl9zY2VuZS5vbkFmdGVyUmVuZGVyT2JzZXJ2YWJsZS5hZGQoZnVuY3Rpb24oZSx0KXtzLl9lbmdpbmUuY2xlYXIobnVsbCwhMSwhMCkscy5fcmVuZGVyKCl9KTp0aGlzLl9iZWZvcmVSZW5kZXJPYnNlcnZlcj10aGlzLl9zY2VuZS5vbkJlZm9yZVJlbmRlck9ic2VydmFibGUuYWRkKGZ1bmN0aW9uKGUsdCl7cy5fcmVuZGVyKCl9KSx0aGlzLl9zdXBwcnRJbnN0YW5jZWRBcnJheT1udWxsIT09dGhpcy5fZW5naW5lLmdldENhcHMoKS5pbnN0YW5jZWRBcnJheXMsdGhpcy5fc2V0dXBJbnRlcmFjdGlvbihjKX1yZXR1cm4gX19leHRlbmRzKHIsaSksci5wcm90b3R5cGUuX2NhbnZhc1ByZUluaXQ9ZnVuY3Rpb24oZSl7dmFyIHQ9bnVsbD09ZS5jYWNoaW5nU3RyYXRlZ3k/ci5DQUNIRVNUUkFURUdZX0RPTlRDQUNIRTplLmNhY2hpbmdTdHJhdGVneTt0aGlzLl9jYWNoaW5nU3RyYXRlZ3k9dCx0aGlzLl9pc1NjcmVlblNwYWNlPW51bGw9PWUuaXNTY3JlZW5TcGFjZT8hMDplLmlzU2NyZWVuU3BhY2V9LHIucHJvdG90eXBlLl9zZXR1cEludGVyYWN0aW9uPWZ1bmN0aW9uKGUpe3ZhciB0PXRoaXM7aWYoZSE9PXRoaXMuX2ludGVyYWN0aW9uRW5hYmxlZClpZih0aGlzLl9pbnRlcmFjdGlvbkVuYWJsZWQ9ZSx0aGlzLl9pc1NjcmVlblNwYWNlKXtpZighZSlyZXR1cm4gdm9pZCh0aGlzLl9zY2VuZVByZVBvaW50ZXJPYnNlcnZlciYmKHRoaXMuc2NlbmUub25QcmVQb2ludGVyT2JzZXJ2YWJsZS5yZW1vdmUodGhpcy5fc2NlbmVQcmVQb2ludGVyT2JzZXJ2ZXIpLHRoaXMuX3NjZW5lUHJlUG9pbnRlck9ic2VydmVyPW51bGwpKTt0aGlzLl9zY2VuZVByZVBvaW50ZXJPYnNlcnZlcj10aGlzLnNjZW5lLm9uUHJlUG9pbnRlck9ic2VydmFibGUuYWRkKGZ1bmN0aW9uKGUsaSl7dmFyIHI9MS90LmVuZ2luZS5nZXRIYXJkd2FyZVNjYWxpbmdMZXZlbCgpLG49ZS5sb2NhbFBvc2l0aW9uLm11bHRpcGx5QnlGbG9hdHMocixyKTt0Ll9oYW5kbGVQb2ludGVyRXZlbnRGb3JJbnRlcmFjdGlvbihlLG4saSl9KX1lbHNle3ZhciBpPXRoaXMuc2NlbmU7ZT8oaS5jb25zdGFudGx5VXBkYXRlTWVzaFVuZGVyUG9pbnRlcj0hMCx0aGlzLl9zY2VuZVBvaW50ZXJPYnNlcnZlcj1pLm9uUG9pbnRlck9ic2VydmFibGUuYWRkKGZ1bmN0aW9uKGUsaSl7aWYoZS5waWNrSW5mby5oaXQmJmUucGlja0luZm8ucGlja2VkTWVzaD09PXQuX3dvcmxkU3BhY2VOb2RlJiZ0LndvcmxkU3BhY2VUb05vZGVMb2NhbCl7dmFyIHI9dC53b3JsZFNwYWNlVG9Ob2RlTG9jYWwoZS5waWNrSW5mby5waWNrZWRQb2ludCk7dC5faGFuZGxlUG9pbnRlckV2ZW50Rm9ySW50ZXJhY3Rpb24oZSxyLGkpfX0pKTp0aGlzLl9zY2VuZVBvaW50ZXJPYnNlcnZlciYmKHRoaXMuc2NlbmUub25Qb2ludGVyT2JzZXJ2YWJsZS5yZW1vdmUodGhpcy5fc2NlbmVQb2ludGVyT2JzZXJ2ZXIpLHRoaXMuX3NjZW5lUG9pbnRlck9ic2VydmVyPW51bGwpfX0sci5wcm90b3R5cGUuX3NldFBvaW50ZXJDYXB0dXJlPWZ1bmN0aW9uKHQsaSl7aWYodGhpcy5pc1BvaW50ZXJDYXB0dXJlZCh0KSlyZXR1cm4hMTt0cnl7dGhpcy5lbmdpbmUuZ2V0UmVuZGVyaW5nQ2FudmFzKCkuc2V0UG9pbnRlckNhcHR1cmUodCl9Y2F0Y2gocil7fXJldHVybiB0aGlzLl9wcmltUG9pbnRlckluZm8udXBkYXRlUmVsYXRlZFRhcmdldChpLGUuVmVjdG9yMi5aZXJvKCkpLHRoaXMuX2J1YmJsZU5vdGlmeVByaW1Qb2ludGVyT2JzZXJ2ZXIoaSxlLlByaW1pdGl2ZVBvaW50ZXJJbmZvLlBvaW50ZXJHb3RDYXB0dXJlLG51bGwpLHRoaXMuX2NhcHR1cmVkUG9pbnRlcnMuYWRkKHQudG9TdHJpbmcoKSxpKSwhMH0sci5wcm90b3R5cGUuX3JlbGVhc2VQb2ludGVyQ2FwdHVyZT1mdW5jdGlvbih0LGkpe2lmKHRoaXMuX2NhcHR1cmVkUG9pbnRlcnMuZ2V0KHQudG9TdHJpbmcoKSkhPT1pKXJldHVybiExO3RyeXt0aGlzLmVuZ2luZS5nZXRSZW5kZXJpbmdDYW52YXMoKS5yZWxlYXNlUG9pbnRlckNhcHR1cmUodCl9Y2F0Y2gocil7fXJldHVybiB0aGlzLl9wcmltUG9pbnRlckluZm8udXBkYXRlUmVsYXRlZFRhcmdldChpLGUuVmVjdG9yMi5aZXJvKCkpLHRoaXMuX2J1YmJsZU5vdGlmeVByaW1Qb2ludGVyT2JzZXJ2ZXIoaSxlLlByaW1pdGl2ZVBvaW50ZXJJbmZvLlBvaW50ZXJMb3N0Q2FwdHVyZSxudWxsKSx0aGlzLl9jYXB0dXJlZFBvaW50ZXJzLnJlbW92ZSh0LnRvU3RyaW5nKCkpLCEwfSxyLnByb3RvdHlwZS5pc1BvaW50ZXJDYXB0dXJlZD1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fY2FwdHVyZWRQb2ludGVycy5jb250YWlucyhlLnRvU3RyaW5nKCkpfSxyLnByb3RvdHlwZS5nZXRDYXB0dXJlZFByaW1pdGl2ZT1mdW5jdGlvbihlKXtyZXR1cm4gMD09PXRoaXMuX2NhcHR1cmVkUG9pbnRlcnMuY291bnQ/bnVsbDp0aGlzLl9jYXB0dXJlZFBvaW50ZXJzLmdldChlLnRvU3RyaW5nKCkpfSxyLnByb3RvdHlwZS5faGFuZGxlUG9pbnRlckV2ZW50Rm9ySW50ZXJhY3Rpb249ZnVuY3Rpb24odCxpLHIpe2lmKCF0aGlzLmlzRGlzcG9zZWQpe3RoaXMuX3VwZGF0ZVBvaW50ZXJJbmZvKHQsaSk7dmFyIG49dGhpcy5nZXRDYXB0dXJlZFByaW1pdGl2ZSh0aGlzLl9wcmltUG9pbnRlckluZm8ucG9pbnRlcklkKTtpZih0aGlzLl91cGRhdGVJbnRlcnNlY3Rpb25MaXN0KHRoaXMuX3ByaW1Qb2ludGVySW5mby5jYW52YXNQb2ludGVyUG9zLG51bGwhPT1uKSx0aGlzLl91cGRhdGVPdmVyU3RhdHVzKCksdGhpcy5fYWN0dWFsT3ZlclByaW1pdGl2ZXx8bil7dmFyIG89bnx8dGhpcy5fYWN0dWFsT3ZlclByaW1pdGl2ZS5wcmltLHM9bj90aGlzLl9wcmltUG9pbnRlckluZm8uY2FudmFzUG9pbnRlclBvcy5zdWJ0cmFjdChuZXcgZS5WZWN0b3IyKG8uZ2xvYmFsVHJhbnNmb3JtLm1bMTJdLG8uZ2xvYmFsVHJhbnNmb3JtLm1bMTNdKSk6dGhpcy5fYWN0dWFsT3ZlclByaW1pdGl2ZS5pbnRlcnNlY3Rpb25Mb2NhdGlvbjt0aGlzLl9wcmltUG9pbnRlckluZm8udXBkYXRlUmVsYXRlZFRhcmdldChvLHMpLHQudHlwZT09PWUuUG9pbnRlckV2ZW50VHlwZXMuUE9JTlRFUldIRUVMP3RoaXMuX2J1YmJsZU5vdGlmeVByaW1Qb2ludGVyT2JzZXJ2ZXIobyxlLlByaW1pdGl2ZVBvaW50ZXJJbmZvLlBvaW50ZXJNb3VzZVdoZWVsLHQuZXZlbnQpOnQudHlwZT09PWUuUG9pbnRlckV2ZW50VHlwZXMuUE9JTlRFUk1PVkU/dGhpcy5fYnViYmxlTm90aWZ5UHJpbVBvaW50ZXJPYnNlcnZlcihvLGUuUHJpbWl0aXZlUG9pbnRlckluZm8uUG9pbnRlck1vdmUsdC5ldmVudCk6dC50eXBlPT09ZS5Qb2ludGVyRXZlbnRUeXBlcy5QT0lOVEVSRE9XTj90aGlzLl9idWJibGVOb3RpZnlQcmltUG9pbnRlck9ic2VydmVyKG8sZS5QcmltaXRpdmVQb2ludGVySW5mby5Qb2ludGVyRG93bix0LmV2ZW50KTp0LnR5cGU9PT1lLlBvaW50ZXJFdmVudFR5cGVzLlBPSU5URVJVUCYmdGhpcy5fYnViYmxlTm90aWZ5UHJpbVBvaW50ZXJPYnNlcnZlcihvLGUuUHJpbWl0aXZlUG9pbnRlckluZm8uUG9pbnRlclVwLHQuZXZlbnQpfX19LHIucHJvdG90eXBlLl91cGRhdGVQb2ludGVySW5mbz1mdW5jdGlvbih0LGkpe3ZhciByPXRoaXMuX3ByaW1Qb2ludGVySW5mbztyLmNhbnZhc1BvaW50ZXJQb3N8fChyLmNhbnZhc1BvaW50ZXJQb3M9ZS5WZWN0b3IyLlplcm8oKSk7dmFyIG49dGhpcy5fc2NlbmUuY2FtZXJhVG9Vc2VGb3JQb2ludGVyc3x8dGhpcy5fc2NlbmUuYWN0aXZlQ2FtZXJhLG89dGhpcy5fc2NlbmUuZ2V0RW5naW5lKCk7aWYodGhpcy5faXNTY3JlZW5TcGFjZSl7dmFyIHM9bi52aWV3cG9ydCxhPXMudG9HbG9iYWwoby5nZXRSZW5kZXJXaWR0aCgpLG8uZ2V0UmVuZGVySGVpZ2h0KCkpLGg9aS54LWEueCxjPWkueS1hLnk7ci5jYW52YXNQb2ludGVyUG9zLng9aC10aGlzLmFjdHVhbFBvc2l0aW9uLngsci5jYW52YXNQb2ludGVyUG9zLnk9by5nZXRSZW5kZXJIZWlnaHQoKS1jLXRoaXMuYWN0dWFsUG9zaXRpb24ueX1lbHNlIHIuY2FudmFzUG9pbnRlclBvcy54PWkueCxyLmNhbnZhc1BvaW50ZXJQb3MueT1pLnk7aWYoci5tb3VzZVdoZWVsRGVsdGE9MCx0LnR5cGU9PT1lLlBvaW50ZXJFdmVudFR5cGVzLlBPSU5URVJXSEVFTCl7dmFyIGw9dC5ldmVudDtsLndoZWVsRGVsdGE/ci5tb3VzZVdoZWVsRGVsdGE9bC53aGVlbERlbHRhLyg0MCplLlByaW1pdGl2ZVBvaW50ZXJJbmZvLk1vdXNlV2hlZWxQcmVjaXNpb24pOmwuZGV0YWlsJiYoci5tb3VzZVdoZWVsRGVsdGE9LWwuZGV0YWlsL2UuUHJpbWl0aXZlUG9pbnRlckluZm8uTW91c2VXaGVlbFByZWNpc2lvbil9ZWxzZXt2YXIgdT10LmV2ZW50O3IuY3RybEtleT11LmN0cmxLZXksci5hbHRLZXk9dS5hbHRLZXksci5zaGlmdEtleT11LnNoaWZ0S2V5LHIubWV0YUtleT11Lm1ldGFLZXksci5idXR0b249dS5idXR0b24sci5idXR0b25zPXUuYnV0dG9ucyxyLnBvaW50ZXJJZD11LnBvaW50ZXJJZCxyLndpZHRoPXUud2lkdGgsci5oZWlnaHQ9dS5oZWlnaHQsci5wcmVzc3N1cmU9dS5wcmVzc3VyZSxyLnRpbHQueD11LnRpbHRYLHIudGlsdC55PXUudGlsdFksci5pc0NhcHR1cmVkPW51bGwhPT10aGlzLmdldENhcHR1cmVkUHJpbWl0aXZlKHUucG9pbnRlcklkKX19LHIucHJvdG90eXBlLl91cGRhdGVJbnRlcnNlY3Rpb25MaXN0PWZ1bmN0aW9uKGUsdCl7aWYodGhpcy5zY2VuZS5nZXRSZW5kZXJJZCgpIT09dGhpcy5faW50ZXJzZWN0aW9uUmVuZGVySWQpe3RoaXMuX2dsb2JhbFRyYW5zZm9ybXx8dGhpcy51cGRhdGVDYWNoZWRTdGF0ZXMoITApO3ZhciBpPXIuX2ludGVySW5mbztpZihpLnBpY2tQb3NpdGlvbi54PWUueCxpLnBpY2tQb3NpdGlvbi55PWUueSxpLmZpbmRGaXJzdE9ubHk9ITEsIXQmJiF0aGlzLmJvdW5kaW5nSW5mby5kb2VzSW50ZXJzZWN0KGkucGlja1Bvc2l0aW9uKSlyZXR1cm4gdGhpcy5fcHJldmlvdXNJbnRlcnNlY3Rpb25MaXN0PXRoaXMuX2FjdHVhbEludGVyc2VjdGlvbkxpc3QsdGhpcy5fYWN0dWFsSW50ZXJzZWN0aW9uTGlzdD1udWxsLHRoaXMuX3ByZXZpb3VzT3ZlclByaW1pdGl2ZT10aGlzLl9hY3R1YWxPdmVyUHJpbWl0aXZlLHZvaWQodGhpcy5fYWN0dWFsT3ZlclByaW1pdGl2ZT1udWxsKTt0aGlzLmludGVyc2VjdChpKSx0aGlzLl9wcmV2aW91c0ludGVyc2VjdGlvbkxpc3Q9dGhpcy5fYWN0dWFsSW50ZXJzZWN0aW9uTGlzdCx0aGlzLl9hY3R1YWxJbnRlcnNlY3Rpb25MaXN0PWkuaW50ZXJzZWN0ZWRQcmltaXRpdmVzLHRoaXMuX3ByZXZpb3VzT3ZlclByaW1pdGl2ZT10aGlzLl9hY3R1YWxPdmVyUHJpbWl0aXZlLHRoaXMuX2FjdHVhbE92ZXJQcmltaXRpdmU9aS50b3BNb3N0SW50ZXJzZWN0ZWRQcmltaXRpdmUsdGhpcy5faW50ZXJzZWN0aW9uUmVuZGVySWQ9dGhpcy5zY2VuZS5nZXRSZW5kZXJJZCgpfX0sci5wcm90b3R5cGUuX3VwZGF0ZU92ZXJTdGF0dXM9ZnVuY3Rpb24oKXtpZih0aGlzLnNjZW5lLmdldFJlbmRlcklkKCkhPT10aGlzLl9ob3ZlclN0YXR1c1JlbmRlcklkJiZ0aGlzLl9wcmV2aW91c0ludGVyc2VjdGlvbkxpc3QmJnRoaXMuX2FjdHVhbEludGVyc2VjdGlvbkxpc3Qpe3ZhciB0PXRoaXMuX3ByZXZpb3VzT3ZlclByaW1pdGl2ZT90aGlzLl9wcmV2aW91c092ZXJQcmltaXRpdmUucHJpbTpudWxsLGk9dGhpcy5fYWN0dWFsT3ZlclByaW1pdGl2ZT90aGlzLl9hY3R1YWxPdmVyUHJpbWl0aXZlLnByaW06bnVsbDtpZih0IT09aSl7dmFyIHI9dGhpcy5nZXRDYXB0dXJlZFByaW1pdGl2ZSh0aGlzLl9wcmltUG9pbnRlckluZm8ucG9pbnRlcklkKTsociYmcj09PXR8fCFyJiZ0KSYmKHRoaXMuX3ByaW1Qb2ludGVySW5mby51cGRhdGVSZWxhdGVkVGFyZ2V0KHQsdGhpcy5fcHJldmlvdXNPdmVyUHJpbWl0aXZlLmludGVyc2VjdGlvbkxvY2F0aW9uKSx0aGlzLl9idWJibGVOb3RpZnlQcmltUG9pbnRlck9ic2VydmVyKHQsZS5QcmltaXRpdmVQb2ludGVySW5mby5Qb2ludGVyT3V0LG51bGwpKSwociYmcj09PWl8fCFyJiZpKSYmKHRoaXMuX3ByaW1Qb2ludGVySW5mby51cGRhdGVSZWxhdGVkVGFyZ2V0KGksdGhpcy5fYWN0dWFsT3ZlclByaW1pdGl2ZS5pbnRlcnNlY3Rpb25Mb2NhdGlvbiksdGhpcy5fYnViYmxlTm90aWZ5UHJpbVBvaW50ZXJPYnNlcnZlcihpLGUuUHJpbWl0aXZlUG9pbnRlckluZm8uUG9pbnRlck92ZXIsbnVsbCkpfXRoaXMuX2hvdmVyU3RhdHVzUmVuZGVySWQ9dGhpcy5zY2VuZS5nZXRSZW5kZXJJZCgpfX0sci5wcm90b3R5cGUuX3VwZGF0ZVByaW1Qb2ludGVyUG9zPWZ1bmN0aW9uKGUpe2lmKHRoaXMuX3ByaW1Qb2ludGVySW5mby5pc0NhcHR1cmVkKXRoaXMuX3ByaW1Qb2ludGVySW5mby5wcmltaXRpdmVQb2ludGVyUG9zPXRoaXMuX3ByaW1Qb2ludGVySW5mby5yZWxhdGVkVGFyZ2V0UG9pbnRlclBvcztlbHNlIGZvcih2YXIgdD0wLGk9dGhpcy5fYWN0dWFsSW50ZXJzZWN0aW9uTGlzdDt0PGkubGVuZ3RoO3QrKyl7dmFyIHI9aVt0XTtpZihyLnByaW09PT1lKXJldHVybiB2b2lkKHRoaXMuX3ByaW1Qb2ludGVySW5mby5wcmltaXRpdmVQb2ludGVyUG9zPXIuaW50ZXJzZWN0aW9uTG9jYXRpb24pfX0sci5wcm90b3R5cGUuX2RlYnVnRXhlY09ic2VydmVyPWZ1bmN0aW9uKHQsaSl7aWYodGhpcy5fbm90aWZEZWJ1Z01vZGUpe2Zvcih2YXIgcj1cIlwiLG49MDtuPHQuaGllcmFyY2h5RGVwdGg7bisrKXIrPVwiICBcIjt2YXIgbz10aGlzLl9wcmltUG9pbnRlckluZm87cis9XCJbUklEOlwiK3RoaXMuc2NlbmUuZ2V0UmVuZGVySWQoKStcIl0gW1wiK3QuaGllcmFyY2h5RGVwdGgrXCJdIGV2ZW50OlwiK2UuUHJpbWl0aXZlUG9pbnRlckluZm8uZ2V0RXZlbnRUeXBlTmFtZShpKStcIiwgaWQ6IFwiK3QuaWQrXCIgKFwiK2UuVG9vbHMuZ2V0Q2xhc3NOYW1lKHQpK1wiKSwgcHJpbVBvczogXCIrby5wcmltaXRpdmVQb2ludGVyUG9zLnRvU3RyaW5nKCkrXCIsIGNhbnZhc1BvczogXCIrby5jYW52YXNQb2ludGVyUG9zLnRvU3RyaW5nKCksY29uc29sZS5sb2cocil9fSxyLnByb3RvdHlwZS5fYnViYmxlTm90aWZ5UHJpbVBvaW50ZXJPYnNlcnZlcj1mdW5jdGlvbih0LGkscil7dmFyIG49dGhpcy5fcHJpbVBvaW50ZXJJbmZvOzAhPT0oaSYoZS5QcmltaXRpdmVQb2ludGVySW5mby5Qb2ludGVyT3ZlcnxlLlByaW1pdGl2ZVBvaW50ZXJJbmZvLlBvaW50ZXJPdXQpKSYmdGhpcy5fbm90aWZQYXJlbnRzKHQsaSk7Zm9yKHZhciBvPSExLHM9dDtzOyl7aWYoIW8mJih0aGlzLl91cGRhdGVQcmltUG9pbnRlclBvcyhzKSx0aGlzLl9kZWJ1Z0V4ZWNPYnNlcnZlcihzLGkpLHMuX3BvaW50ZXJFdmVudE9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKG4saSksdGhpcy5fdHJpZ2dlckFjdGlvbk1hbmFnZXIocyxuLGksciksbi5jYW5jZWxCdWJibGUpKXtpZigwPT09KGkmKGUuUHJpbWl0aXZlUG9pbnRlckluZm8uUG9pbnRlck92ZXJ8ZS5QcmltaXRpdmVQb2ludGVySW5mby5Qb2ludGVyT3V0KSkpcmV0dXJuO289ITB9byYmdGhpcy5fdXBkYXRlUHJpbVBvaW50ZXJQb3MocyksaT09PWUuUHJpbWl0aXZlUG9pbnRlckluZm8uUG9pbnRlck92ZXI/KHRoaXMuX2RlYnVnRXhlY09ic2VydmVyKHMsZS5QcmltaXRpdmVQb2ludGVySW5mby5Qb2ludGVyRW50ZXIpLHMuX3BvaW50ZXJFdmVudE9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKG4sZS5QcmltaXRpdmVQb2ludGVySW5mby5Qb2ludGVyRW50ZXIpKTppPT09ZS5QcmltaXRpdmVQb2ludGVySW5mby5Qb2ludGVyT3V0JiYodGhpcy5fZGVidWdFeGVjT2JzZXJ2ZXIocyxlLlByaW1pdGl2ZVBvaW50ZXJJbmZvLlBvaW50ZXJMZWF2ZSkscy5fcG9pbnRlckV2ZW50T2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMobixlLlByaW1pdGl2ZVBvaW50ZXJJbmZvLlBvaW50ZXJMZWF2ZSkpLHM9cy5wYXJlbnR9fSxyLnByb3RvdHlwZS5fdHJpZ2dlckFjdGlvbk1hbmFnZXI9ZnVuY3Rpb24odCxpLHIsbil7dmFyIG89dGhpcztpZih0aGlzLl9nbG9iYWxUcmFuc2Zvcm18fHRoaXMudXBkYXRlQ2FjaGVkU3RhdGVzKCEwKSwwIT09KHImZS5QcmltaXRpdmVQb2ludGVySW5mby5Qb2ludGVyRG93bikpe2lmKHRoaXMuX3BpY2tTdGFydGluZ1Bvc2l0aW9uPWkucHJpbWl0aXZlUG9pbnRlclBvcy5jbG9uZSgpLHRoaXMuX3BpY2tTdGFydGluZ1RpbWU9KG5ldyBEYXRlKS5nZXRUaW1lKCksdGhpcy5fcGlja2VkRG93blByaW09bnVsbCx0LmFjdGlvbk1hbmFnZXIpe2lmKHRoaXMuX3BpY2tlZERvd25QcmltPXQsdC5hY3Rpb25NYW5hZ2VyLmhhc1BpY2tUcmlnZ2Vycyl7dmFyIHM9ZS5BY3Rpb25FdmVudC5DcmVhdGVOZXdGcm9tUHJpbWl0aXZlKHQsaS5wcmltaXRpdmVQb2ludGVyUG9zLG4pO3N3aXRjaChuLmJ1dHRvbil7Y2FzZSAwOnQuYWN0aW9uTWFuYWdlci5wcm9jZXNzVHJpZ2dlcihlLkFjdGlvbk1hbmFnZXIuT25MZWZ0UGlja1RyaWdnZXIscyk7YnJlYWs7Y2FzZSAxOnQuYWN0aW9uTWFuYWdlci5wcm9jZXNzVHJpZ2dlcihlLkFjdGlvbk1hbmFnZXIuT25DZW50ZXJQaWNrVHJpZ2dlcixzKTticmVhaztjYXNlIDI6dC5hY3Rpb25NYW5hZ2VyLnByb2Nlc3NUcmlnZ2VyKGUuQWN0aW9uTWFuYWdlci5PblJpZ2h0UGlja1RyaWdnZXIscyl9dC5hY3Rpb25NYW5hZ2VyLnByb2Nlc3NUcmlnZ2VyKGUuQWN0aW9uTWFuYWdlci5PblBpY2tEb3duVHJpZ2dlcixzKX10LmFjdGlvbk1hbmFnZXIuaGFzU3BlY2lmaWNUcmlnZ2VyKGUuQWN0aW9uTWFuYWdlci5PbkxvbmdQcmVzc1RyaWdnZXIpJiZ3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbigpe3ZhciBpPW8uX3ByaW1Qb2ludGVySW5mbyxyPW8uZ2V0Q2FwdHVyZWRQcmltaXRpdmUoaS5wb2ludGVySWQpO28uX3VwZGF0ZUludGVyc2VjdGlvbkxpc3QoaS5jYW52YXNQb2ludGVyUG9zLG51bGwhPT1yKTt2YXIgcz1uZXcgZS5JbnRlcnNlY3RJbmZvMkQ7cy5waWNrUG9zaXRpb249aS5jYW52YXNQb2ludGVyUG9zLmNsb25lKCkscy5maW5kRmlyc3RPbmx5PSExLG8uaW50ZXJzZWN0KHMpLG51bGwhPT1zLmlzUHJpbUludGVyc2VjdGVkKHQpJiZ0LmFjdGlvbk1hbmFnZXImJjAhPT1vLl9waWNrU3RhcnRpbmdUaW1lJiYobmV3IERhdGUpLmdldFRpbWUoKS1vLl9waWNrU3RhcnRpbmdUaW1lPmUuQWN0aW9uTWFuYWdlci5Mb25nUHJlc3NEZWxheSYmTWF0aC5hYnMoby5fcGlja1N0YXJ0aW5nUG9zaXRpb24ueC1zLnBpY2tQb3NpdGlvbi54KTxlLkFjdGlvbk1hbmFnZXIuRHJhZ01vdmVtZW50VGhyZXNob2xkJiZNYXRoLmFicyhvLl9waWNrU3RhcnRpbmdQb3NpdGlvbi55LXMucGlja1Bvc2l0aW9uLnkpPGUuQWN0aW9uTWFuYWdlci5EcmFnTW92ZW1lbnRUaHJlc2hvbGQmJihvLl9waWNrU3RhcnRpbmdUaW1lPTAsdC5hY3Rpb25NYW5hZ2VyLnByb2Nlc3NUcmlnZ2VyKGUuQWN0aW9uTWFuYWdlci5PbkxvbmdQcmVzc1RyaWdnZXIsZS5BY3Rpb25FdmVudC5DcmVhdGVOZXdGcm9tUHJpbWl0aXZlKHQsaS5wcmltaXRpdmVQb2ludGVyUG9zLG4pKSl9LGUuQWN0aW9uTWFuYWdlci5Mb25nUHJlc3NEZWxheSl9fWVsc2UgaWYoMCE9PShyJmUuUHJpbWl0aXZlUG9pbnRlckluZm8uUG9pbnRlclVwKSl7dGhpcy5fcGlja1N0YXJ0aW5nVGltZT0wO3ZhciBzPWUuQWN0aW9uRXZlbnQuQ3JlYXRlTmV3RnJvbVByaW1pdGl2ZSh0LGkucHJpbWl0aXZlUG9pbnRlclBvcyxuKTt0LmFjdGlvbk1hbmFnZXImJih0LmFjdGlvbk1hbmFnZXIucHJvY2Vzc1RyaWdnZXIoZS5BY3Rpb25NYW5hZ2VyLk9uUGlja1VwVHJpZ2dlcixzKSxNYXRoLmFicyh0aGlzLl9waWNrU3RhcnRpbmdQb3NpdGlvbi54LWkuY2FudmFzUG9pbnRlclBvcy54KTxlLkFjdGlvbk1hbmFnZXIuRHJhZ01vdmVtZW50VGhyZXNob2xkJiZNYXRoLmFicyh0aGlzLl9waWNrU3RhcnRpbmdQb3NpdGlvbi55LWkuY2FudmFzUG9pbnRlclBvcy55KTxlLkFjdGlvbk1hbmFnZXIuRHJhZ01vdmVtZW50VGhyZXNob2xkJiZ0LmFjdGlvbk1hbmFnZXIucHJvY2Vzc1RyaWdnZXIoZS5BY3Rpb25NYW5hZ2VyLk9uUGlja1RyaWdnZXIscykpLHRoaXMuX3BpY2tlZERvd25QcmltJiZ0aGlzLl9waWNrZWREb3duUHJpbS5hY3Rpb25NYW5hZ2VyJiZ0aGlzLl9waWNrZWREb3duUHJpbSE9PXQmJnRoaXMuX3BpY2tlZERvd25QcmltLmFjdGlvbk1hbmFnZXIucHJvY2Vzc1RyaWdnZXIoZS5BY3Rpb25NYW5hZ2VyLk9uUGlja091dFRyaWdnZXIscyl9ZWxzZSBpZigwIT09KHImZS5QcmltaXRpdmVQb2ludGVySW5mby5Qb2ludGVyT3Zlcikpe2lmKHQuYWN0aW9uTWFuYWdlcil7dmFyIHM9ZS5BY3Rpb25FdmVudC5DcmVhdGVOZXdGcm9tUHJpbWl0aXZlKHQsaS5wcmltaXRpdmVQb2ludGVyUG9zLG4pO3QuYWN0aW9uTWFuYWdlci5wcm9jZXNzVHJpZ2dlcihlLkFjdGlvbk1hbmFnZXIuT25Qb2ludGVyT3ZlclRyaWdnZXIscyl9fWVsc2UgaWYoMCE9PShyJmUuUHJpbWl0aXZlUG9pbnRlckluZm8uUG9pbnRlck91dCkmJnQuYWN0aW9uTWFuYWdlcil7dmFyIHM9ZS5BY3Rpb25FdmVudC5DcmVhdGVOZXdGcm9tUHJpbWl0aXZlKHQsaS5wcmltaXRpdmVQb2ludGVyUG9zLG4pO3QuYWN0aW9uTWFuYWdlci5wcm9jZXNzVHJpZ2dlcihlLkFjdGlvbk1hbmFnZXIuT25Qb2ludGVyT3V0VHJpZ2dlcixzKX19LHIucHJvdG90eXBlLl9ub3RpZlBhcmVudHM9ZnVuY3Rpb24odCxpKXtmb3IodmFyIHI9dGhpcy5fcHJpbVBvaW50ZXJJbmZvLG49dGhpcztuOyl0aGlzLl91cGRhdGVQcmltUG9pbnRlclBvcyhuKSxpPT09ZS5QcmltaXRpdmVQb2ludGVySW5mby5Qb2ludGVyT3Zlcj8odGhpcy5fZGVidWdFeGVjT2JzZXJ2ZXIobixlLlByaW1pdGl2ZVBvaW50ZXJJbmZvLlBvaW50ZXJFbnRlciksbi5fcG9pbnRlckV2ZW50T2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMocixlLlByaW1pdGl2ZVBvaW50ZXJJbmZvLlBvaW50ZXJFbnRlcikpOmk9PT1lLlByaW1pdGl2ZVBvaW50ZXJJbmZvLlBvaW50ZXJPdXQmJih0aGlzLl9kZWJ1Z0V4ZWNPYnNlcnZlcihuLGUuUHJpbWl0aXZlUG9pbnRlckluZm8uUG9pbnRlckxlYXZlKSxuLl9wb2ludGVyRXZlbnRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhyLGUuUHJpbWl0aXZlUG9pbnRlckluZm8uUG9pbnRlckxlYXZlKSksbj1uLnBhcmVudH0sci5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3JldHVybiBpLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyk/KHRoaXMuaW50ZXJhY3Rpb25FbmFibGVkJiZ0aGlzLl9zZXR1cEludGVyYWN0aW9uKCExKSx0aGlzLl9iZWZvcmVSZW5kZXJPYnNlcnZlciYmKHRoaXMuX3NjZW5lLm9uQmVmb3JlUmVuZGVyT2JzZXJ2YWJsZS5yZW1vdmUodGhpcy5fYmVmb3JlUmVuZGVyT2JzZXJ2ZXIpLHRoaXMuX2JlZm9yZVJlbmRlck9ic2VydmVyPW51bGwpLHRoaXMuX2FmdGVyUmVuZGVyT2JzZXJ2ZXImJih0aGlzLl9zY2VuZS5vbkFmdGVyUmVuZGVyT2JzZXJ2YWJsZS5yZW1vdmUodGhpcy5fYWZ0ZXJSZW5kZXJPYnNlcnZlciksdGhpcy5fYWZ0ZXJSZW5kZXJPYnNlcnZlcj1udWxsKSx2b2lkKHRoaXMuX2dyb3VwQ2FjaGVNYXBzJiYodGhpcy5fZ3JvdXBDYWNoZU1hcHMuZm9yRWFjaChmdW5jdGlvbihlKXtyZXR1cm4gZS5kaXNwb3NlKCl9KSx0aGlzLl9ncm91cENhY2hlTWFwcz1udWxsKSkpOiExfSxPYmplY3QuZGVmaW5lUHJvcGVydHkoci5wcm90b3R5cGUsXCJzY2VuZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc2NlbmV9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHIucHJvdG90eXBlLFwiZW5naW5lXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9lbmdpbmV9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHIucHJvdG90eXBlLFwiY2FjaGluZ1N0cmF0ZWd5XCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9jYWNoaW5nU3RyYXRlZ3l9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHIucHJvdG90eXBlLFwid29ybGRTcGFjZUNhbnZhc05vZGVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3dvcmxkU3BhY2VOb2RlfSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fd29ybGRTcGFjZU5vZGU9ZX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoci5wcm90b3R5cGUsXCJzdXBwb3J0SW5zdGFuY2VkQXJyYXlcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3N1cHBydEluc3RhbmNlZEFycmF5fSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLnByb3RvdHlwZSxcImJhY2tncm91bmRGaWxsXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9iYWNrZ3JvdW5kJiZ0aGlzLl9iYWNrZ3JvdW5kLmlzVmlzaWJsZT90aGlzLl9iYWNrZ3JvdW5kLmZpbGw6bnVsbH0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuY2hlY2tCYWNrZ3JvdW5kQXZhaWxhYmlsaXR5KCksZSE9PXRoaXMuX2JhY2tncm91bmQuZmlsbCYmKHRoaXMuX2JhY2tncm91bmQuZmlsbD1lLHRoaXMuX2JhY2tncm91bmQubGV2ZWxWaXNpYmxlPSEwKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoci5wcm90b3R5cGUsXCJiYWNrZ3JvdW5kQm9yZGVyXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9iYWNrZ3JvdW5kJiZ0aGlzLl9iYWNrZ3JvdW5kLmlzVmlzaWJsZT90aGlzLl9iYWNrZ3JvdW5kLmJvcmRlcjpudWxsfSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5jaGVja0JhY2tncm91bmRBdmFpbGFiaWxpdHkoKSxlIT09dGhpcy5fYmFja2dyb3VuZC5ib3JkZXImJih0aGlzLl9iYWNrZ3JvdW5kLmJvcmRlcj1lLHRoaXMuX2JhY2tncm91bmQubGV2ZWxWaXNpYmxlPSEwKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoci5wcm90b3R5cGUsXCJiYWNrZ3JvdW5kQm9yZGVyVGhpY2tuZXNzXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9iYWNrZ3JvdW5kJiZ0aGlzLl9iYWNrZ3JvdW5kLmlzVmlzaWJsZT90aGlzLl9iYWNrZ3JvdW5kLmJvcmRlclRoaWNrbmVzczpudWxsfSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5jaGVja0JhY2tncm91bmRBdmFpbGFiaWxpdHkoKSxlIT09dGhpcy5fYmFja2dyb3VuZC5ib3JkZXJUaGlja25lc3MmJih0aGlzLl9iYWNrZ3JvdW5kLmJvcmRlclRoaWNrbmVzcz1lKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoci5wcm90b3R5cGUsXCJiYWNrZ3JvdW5kUm91bmRSYWRpdXNcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2JhY2tncm91bmQmJnRoaXMuX2JhY2tncm91bmQuaXNWaXNpYmxlP3RoaXMuX2JhY2tncm91bmQucm91bmRSYWRpdXM6bnVsbH0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuY2hlY2tCYWNrZ3JvdW5kQXZhaWxhYmlsaXR5KCksZSE9PXRoaXMuX2JhY2tncm91bmQucm91bmRSYWRpdXMmJih0aGlzLl9iYWNrZ3JvdW5kLnJvdW5kUmFkaXVzPWUsdGhpcy5fYmFja2dyb3VuZC5sZXZlbFZpc2libGU9ITApfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLnByb3RvdHlwZSxcImludGVyYWN0aW9uRW5hYmxlZFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faW50ZXJhY3Rpb25FbmFibGVkfSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fc2V0dXBJbnRlcmFjdGlvbihlKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoci5wcm90b3R5cGUsXCJfZW5naW5lRGF0YVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fX2VuZ2luZURhdGF9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksci5wcm90b3R5cGUuY2hlY2tCYWNrZ3JvdW5kQXZhaWxhYmlsaXR5PWZ1bmN0aW9uKCl7aWYodGhpcy5fY2FjaGluZ1N0cmF0ZWd5PT09ci5DQUNIRVNUUkFURUdZX1RPUExFVkVMR1JPVVBTKXRocm93IEVycm9yKFwiQ2FuJ3QgdXNlIENhbnZhcyBCYWNrZ3JvdW5kIHdpdGggdGhlIGNhY2hpbmcgc3RyYXRlZ3kgVE9QTEVWRUxHUk9VUFNcIil9LHIucHJvdG90eXBlLm9uUHJpbUJlY29tZXNEaXJ0eT1mdW5jdGlvbigpe3RoaXMuX2FkZFByaW1Ub0RpcnR5TGlzdCh0aGlzKX0sci5wcm90b3R5cGUuX3VwZGF0ZVRyYWNrZWROb2Rlcz1mdW5jdGlvbigpe3ZhciB0PXRoaXMuc2NlbmUuY2FtZXJhVG9Vc2VGb3JQb2ludGVyc3x8dGhpcy5zY2VuZS5hY3RpdmVDYW1lcmE7dC5nZXRWaWV3TWF0cml4KCkubXVsdGlwbHlUb1JlZih0LmdldFByb2plY3Rpb25NYXRyaXgoKSxyLl9tKTtmb3IodmFyIGk9dGhpcy5lbmdpbmUuZ2V0UmVuZGVySGVpZ2h0KCksbj10LnZpZXdwb3J0LnRvR2xvYmFsKHRoaXMuZW5naW5lLmdldFJlbmRlcldpZHRoKCksaSksbz0wLHM9dGhpcy5fdHJhY2tlZEdyb3VwcztvPHMubGVuZ3RoO28rKyl7dmFyIGE9c1tvXTtpZighYS5pc0Rpc3Bvc2VkJiZhLmlzVmlzaWJsZSl7dmFyIGg9YS50cmFja2VkTm9kZSxjPWguZ2V0V29ybGRNYXRyaXgoKSxsPWUuVmVjdG9yMy5Qcm9qZWN0KHIuX3YsYyxyLl9tLG4pO2EueD1NYXRoLnJvdW5kKGwueCksYS55PU1hdGgucm91bmQoaS1sLnkpfX19LHIucHJvdG90eXBlLl91cGRhdGVDYW52YXNTdGF0ZT1mdW5jdGlvbigpe2lmKHRoaXMuc2NlbmUuZ2V0UmVuZGVySWQoKSE9PXRoaXMuX3VwZGF0ZVJlbmRlcklkKXt2YXIgdD0hMSxpPXRoaXMuZW5naW5lLmdldFJlbmRlcldpZHRoKCk7aSE9PXRoaXMuX3JlbmRlcmluZ1NpemUud2lkdGgmJih0PSEwKSx0aGlzLl9yZW5kZXJpbmdTaXplLndpZHRoPWk7dmFyIHI9dGhpcy5lbmdpbmUuZ2V0UmVuZGVySGVpZ2h0KCk7ciE9PXRoaXMuX3JlbmRlcmluZ1NpemUuaGVpZ2h0JiYodD0hMCksdGhpcy5fcmVuZGVyaW5nU2l6ZS5oZWlnaHQ9cix0JiZ0aGlzLl9maXRSZW5kZXJpbmdEZXZpY2UmJih0aGlzLnNpemU9dGhpcy5fcmVuZGVyaW5nU2l6ZSx0aGlzLl9iYWNrZ3JvdW5kJiYodGhpcy5fYmFja2dyb3VuZC5zaXplPXRoaXMuc2l6ZSksdGhpcy5fc2V0TGF5b3V0RGlydHkoKSk7dmFyIG49bmV3IGUuUHJlcGFyZVJlbmRlcjJEQ29udGV4dDsrK3RoaXMuX2dsb2JhbFRyYW5zZm9ybVByb2Nlc3NTdGVwLHRoaXMudXBkYXRlQ2FjaGVkU3RhdGVzKCExKSx0aGlzLl9wcmVwYXJlR3JvdXBSZW5kZXIobiksdGhpcy5fdXBkYXRlUmVuZGVySWQ9dGhpcy5zY2VuZS5nZXRSZW5kZXJJZCgpfX0sci5wcm90b3R5cGUuX3JlbmRlcj1mdW5jdGlvbigpe3RoaXMuX3VwZGF0ZVRyYWNrZWROb2RlcygpLHRoaXMuX3VwZGF0ZUNhbnZhc1N0YXRlKCksdGhpcy5fcHJpbVBvaW50ZXJJbmZvLmNhbnZhc1BvaW50ZXJQb3MmJih0aGlzLl91cGRhdGVJbnRlcnNlY3Rpb25MaXN0KHRoaXMuX3ByaW1Qb2ludGVySW5mby5jYW52YXNQb2ludGVyUG9zLCExKSx0aGlzLl91cGRhdGVPdmVyU3RhdHVzKCkpLHRoaXMuZW5naW5lLnNldFN0YXRlKCExKSx0aGlzLl9ncm91cFJlbmRlcigpLHRoaXMuX2NhY2hpbmdTdHJhdGVneT09PXIuQ0FDSEVTVFJBVEVHWV9DQU5WQVMmJnRoaXMuX2NhY2hlZENhbnZhc0dyb3VwJiZ0aGlzLl9jYWNoZWRDYW52YXNHcm91cC5fcmVuZGVyQ2FjaGVkQ2FudmFzKCl9LHIucHJvdG90eXBlLl9hbGxvY2F0ZUdyb3VwQ2FjaGU9ZnVuY3Rpb24odCxpLG4pe3ZhciBvPXQuYWN0dWFsU2l6ZTtvPW5ldyBlLlNpemUoTWF0aC5jZWlsKG8ud2lkdGgpLE1hdGguY2VpbChvLmhlaWdodCkpLG4mJihvLndpZHRoPU1hdGgubWF4KG4ud2lkdGgsby53aWR0aCksby5oZWlnaHQ9TWF0aC5tYXgobi5oZWlnaHQsby5oZWlnaHQpKSx0aGlzLl9ncm91cENhY2hlTWFwc3x8KHRoaXMuX2dyb3VwQ2FjaGVNYXBzPW5ldyBBcnJheSk7Zm9yKHZhciBzPW51bGwsYT0wLGg9dGhpcy5fZ3JvdXBDYWNoZU1hcHM7YTxoLmxlbmd0aDthKyspe3ZhciBjPWhbYV0sbD1jLmFsbG9jYXRlUmVjdChvKTtpZihsKXtzPXtub2RlOmwsdGV4dHVyZTpjfTticmVha319aWYoIXMpe3ZhciB1PW5ldyBlLlNpemUoci5fZ3JvdXBUZXh0dXJlQ2FjaGVTaXplLHIuX2dyb3VwVGV4dHVyZUNhY2hlU2l6ZSk7KG8ud2lkdGg+dS53aWR0aHx8by5oZWlnaHQ+dS5oZWlnaHQpJiYodS53aWR0aD1NYXRoLnBvdygyLE1hdGguY2VpbChNYXRoLmxvZyhvLndpZHRoKS9NYXRoLmxvZygyKSkpLHUuaGVpZ2h0PU1hdGgucG93KDIsTWF0aC5jZWlsKE1hdGgubG9nKG8uaGVpZ2h0KS9NYXRoLmxvZygyKSkpKTt2YXIgZj1cImdyb3Vwc01hcENoYWNoZVwiK3RoaXMuX21hcENvdW50ZXIrXCJmb3JDYW52YXNcIit0aGlzLmlkO2M9bmV3IGUuTWFwVGV4dHVyZShmLHRoaXMuX3NjZW5lLHUpLHRoaXMuX2dyb3VwQ2FjaGVNYXBzLnB1c2goYyk7dmFyIGw9Yy5hbGxvY2F0ZVJlY3Qobyk7cz17bm9kZTpsLHRleHR1cmU6Y319aWYodCE9PXRoaXN8fHRoaXMuX2lzU2NyZWVuU3BhY2Upe3ZhciBsPXMubm9kZTtpZih0aGlzLl9jYWNoaW5nU3RyYXRlZ3k9PT1yLkNBQ0hFU1RSQVRFR1lfQ0FOVkFTKXt0aGlzLl9jYWNoZWRDYW52YXNHcm91cD1lLkdyb3VwMkQuX2NyZWF0ZUNhY2hlZENhbnZhc0dyb3VwKHRoaXMpO3ZhciBkPW5ldyBlLlNwcml0ZTJEKGMse3BhcmVudDp0aGlzLl9jYWNoZWRDYW52YXNHcm91cCxpZDpcIl9fY2FjaGVkQ2FudmFzU3ByaXRlX19cIixzcHJpdGVTaXplOmwuY29udGVudFNpemUsc3ByaXRlTG9jYXRpb246bC5wb3N9KTtkLnpPcmRlcj0xLGQub3JpZ2luPWUuVmVjdG9yMi5aZXJvKCl9ZWxzZXt2YXIgZD1uZXcgZS5TcHJpdGUyRChjLHtwYXJlbnQ6aSxpZDpcIl9fY2FjaGVkU3ByaXRlT2ZHcm91cF9fXCIrdC5pZCx4OnQuYWN0dWFsUG9zaXRpb24ueCx5OnQuYWN0dWFsUG9zaXRpb24ueSxzcHJpdGVTaXplOmwuY29udGVudFNpemUsc3ByaXRlTG9jYXRpb246bC5wb3N9KTtkLm9yaWdpbj10Lm9yaWdpbi5jbG9uZSgpLHMuc3ByaXRlPWR9fXJldHVybiBzfSxyLnByb3RvdHlwZS5fcmVnaXN0ZXJUcmFja2VkTm9kZT1mdW5jdGlvbih0KXt0Ll9pc0ZsYWdTZXQoZS5TbWFydFByb3BlcnR5UHJpbS5mbGFnVHJhY2tlZEdyb3VwKXx8KHRoaXMuX3RyYWNrZWRHcm91cHMucHVzaCh0KSx0Ll9zZXRGbGFncyhlLlNtYXJ0UHJvcGVydHlQcmltLmZsYWdUcmFja2VkR3JvdXApKX0sci5wcm90b3R5cGUuX3VucmVnaXN0ZXJUcmFja2VkTm9kZT1mdW5jdGlvbih0KXtpZih0Ll9pc0ZsYWdTZXQoZS5TbWFydFByb3BlcnR5UHJpbS5mbGFnVHJhY2tlZEdyb3VwKSl7dmFyIGk9dGhpcy5fdHJhY2tlZEdyb3Vwcy5pbmRleE9mKHQpOy0xIT09aSYmdGhpcy5fdHJhY2tlZEdyb3Vwcy5zcGxpY2UoaSwxKSx0Ll9jbGVhckZsYWdzKGUuU21hcnRQcm9wZXJ0eVByaW0uZmxhZ1RyYWNrZWRHcm91cCl9fSxyLkdldFNvbGlkQ29sb3JCcnVzaD1mdW5jdGlvbih0KXtyZXR1cm4gci5fc29saWRDb2xvckJydXNoZXMuZ2V0T3JBZGRXaXRoRmFjdG9yeSh0LnRvSGV4U3RyaW5nKCksZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGUuU29saWRDb2xvckJydXNoMkQodC5jbG9uZSgpLCEwKX0pfSxyLkdldFNvbGlkQ29sb3JCcnVzaEZyb21IZXg9ZnVuY3Rpb24odCl7cmV0dXJuIHIuX3NvbGlkQ29sb3JCcnVzaGVzLmdldE9yQWRkV2l0aEZhY3RvcnkodCxmdW5jdGlvbigpe3JldHVybiBuZXcgZS5Tb2xpZENvbG9yQnJ1c2gyRChlLkNvbG9yNC5Gcm9tSGV4U3RyaW5nKHQpLCEwKX0pfSxyLkdldEdyYWRpZW50Q29sb3JCcnVzaD1mdW5jdGlvbih0LGksbixvLHMpe3JldHVybiB2b2lkIDA9PT1uJiYobj1lLlZlY3RvcjIuWmVybygpKSx2b2lkIDA9PT1vJiYobz0wKSx2b2lkIDA9PT1zJiYocz0xKSxyLl9ncmFkaWVudENvbG9yQnJ1c2hlcy5nZXRPckFkZFdpdGhGYWN0b3J5KGUuR3JhZGllbnRDb2xvckJydXNoMkQuQnVpbGRLZXkodCxpLG4sbyxzKSxmdW5jdGlvbigpe3JldHVybiBuZXcgZS5HcmFkaWVudENvbG9yQnJ1c2gyRCh0LGksbixvLHMsITApfSl9LHIuR2V0QnJ1c2hGcm9tU3RyaW5nPWZ1bmN0aW9uKHQpe3Q9dC50cmltKCk7dmFyIGk9dC5zcGxpdChcIixcIik7aWYoMT09PWkubGVuZ3RoKXt2YXIgbj1udWxsO2lmKDA9PT10LmluZGV4T2YoXCJzb2xpZDpcIikpbj10LnN1YnN0cig2KS50cmltKCk7ZWxzZXtpZigwIT09dC5pbmRleE9mKFwiI1wiKSlyZXR1cm4gbnVsbDtuPXR9cmV0dXJuIHIuR2V0U29saWRDb2xvckJydXNoRnJvbUhleChuKX0wPT09aVswXS5pbmRleE9mKFwiZ3JhZGllbnQ6XCIpJiYoaVswXT1pWzBdLnN1YnN0cig5KS50cmltKCkpO3RyeXt2YXIgbz1lLkNvbG9yNC5Gcm9tSGV4U3RyaW5nKGlbMF0udHJpbSgpKSxzPWUuQ29sb3I0LkZyb21IZXhTdHJpbmcoaVsxXS50cmltKCkpLGE9ZS5WZWN0b3IyLlplcm8oKTtpZihpLmxlbmd0aD4yKXt2YXIgaD1pWzJdLnRyaW0oKTtpZihcIltcIiE9PWguY2hhckF0KDApfHxcIl1cIiE9PWguY2hhckF0KGgubGVuZ3RoLTEpKXJldHVybiBudWxsO3ZhciBjPWguaW5kZXhPZihcIjpcIiksbD1wYXJzZUZsb2F0KGguc3Vic3RyKDEsYykpLHU9cGFyc2VGbG9hdChoLnN1YnN0cihjKzEsaC5sZW5ndGgtKGMrMSkpKTthPW5ldyBlLlZlY3RvcjIobCx1KX12YXIgZj0wO2kubGVuZ3RoPjMmJihmPWUuVG9vbHMuVG9SYWRpYW5zKHBhcnNlRmxvYXQoaVszXS50cmltKCkpKSk7dmFyIGQ9MTtyZXR1cm4gaS5sZW5ndGg+NCYmKGQ9cGFyc2VGbG9hdChpWzRdLnRyaW0oKSkpLHIuR2V0R3JhZGllbnRDb2xvckJydXNoKG8scyxhLGYsZCl9Y2F0Y2gocCl7cmV0dXJuIG51bGx9fSxyLkNBQ0hFU1RSQVRFR1lfVE9QTEVWRUxHUk9VUFM9MSxyLkNBQ0hFU1RSQVRFR1lfQUxMR1JPVVBTPTIsci5DQUNIRVNUUkFURUdZX0NBTlZBUz0zLHIuQ0FDSEVTVFJBVEVHWV9ET05UQ0FDSEU9NCxyLmhpZXJhcmNoeUxldmVsTWF4U2libGluZ0NvdW50PTUwLHIuX2ludGVySW5mbz1uZXcgZS5JbnRlcnNlY3RJbmZvMkQsci5fdj1lLlZlY3RvcjMuWmVybygpLHIuX209ZS5NYXRyaXguSWRlbnRpdHkoKSxyLl9ncm91cFRleHR1cmVDYWNoZVNpemU9MTAyNCxyLl9zb2xpZENvbG9yQnJ1c2hlcz1uZXcgZS5TdHJpbmdEaWN0aW9uYXJ5LHIuX2dyYWRpZW50Q29sb3JCcnVzaGVzPW5ldyBlLlN0cmluZ0RpY3Rpb25hcnkscj1fX2RlY29yYXRlKFtlLmNsYXNzTmFtZShcIkNhbnZhczJEXCIpXSxyKX0oZS5Hcm91cDJEKTtlLkNhbnZhczJEPWk7dmFyIHI9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gcihyLG4sbyl7ZS5QcmltMkRCYXNlLl9pc0NhbnZhc0luaXQ9ITA7dmFyIHM9bztpZihzLmlzU2NyZWVuU3BhY2U9ITEscy5zaXplPW4uY2xvbmUoKSxvLmNhY2hpbmdTdHJhdGVneT1udWxsPT1vLmNhY2hpbmdTdHJhdGVneT9pLkNBQ0hFU1RSQVRFR1lfQ0FOVkFTOm8uY2FjaGluZ1N0cmF0ZWd5LG8uY2FjaGluZ1N0cmF0ZWd5IT09aS5DQUNIRVNUUkFURUdZX0NBTlZBUyl0aHJvdyBuZXcgRXJyb3IoXCJSaWdodCBub3cgb25seSB0aGUgQ0FDSEVTVFJBVEVHWV9DQU5WQVMgY2FjaGUgU3RyYXRlZ3kgaXMgc3VwcG9ydGVkIGZvciBXb3JsZFNwYWNlIENhbnZhcy4gTW9yZSB3aWxsIGNvbWUgc29vbiFcIik7dC5jYWxsKHRoaXMscixvKSxlLlByaW0yREJhc2UuX2lzQ2FudmFzSW5pdD0hMTt2YXIgYT0hb3x8bnVsbD09by5jdXN0b21Xb3JsZFNwYWNlTm9kZSxoPW8/by5pZHx8bnVsbDpudWxsO2lmKGEpe3ZhciBjPW5ldyBlLldvcmxkU3BhY2VDYW52YXMyRE5vZGUoaCxyLHRoaXMpLGw9ZS5WZXJ0ZXhEYXRhLkNyZWF0ZVBsYW5lKHt3aWR0aDpuLndpZHRoLGhlaWdodDpuLmhlaWdodCxzaWRlT3JpZW50YXRpb246byYmby5zaWRlT3JpZW50YXRpb258fGUuTWVzaC5ERUZBVUxUU0lERX0pLHU9bmV3IGUuU3RhbmRhcmRNYXRlcmlhbChoK1wiX01hdGVyaWFsXCIscik7dGhpcy5hcHBseUNhY2hlZFRleHR1cmUobCx1KSxsLmFwcGx5VG9NZXNoKGMsITEpLHUuc3BlY3VsYXJDb2xvcj1uZXcgZS5Db2xvcjMoMCwwLDApLHUuZGlzYWJsZUxpZ2h0aW5nPSEwLHUudXNlQWxwaGFGcm9tRGlmZnVzZVRleHR1cmU9ITAsYy5wb3NpdGlvbj1vJiZvLndvcmxkUG9zaXRpb258fGUuVmVjdG9yMy5aZXJvKCksYy5yb3RhdGlvblF1YXRlcm5pb249byYmby53b3JsZFJvdGF0aW9ufHxlLlF1YXRlcm5pb24uSWRlbnRpdHkoKSxjLm1hdGVyaWFsPXUsdGhpcy5fd29ybGRTcGFjZU5vZGU9Y31lbHNlIHRoaXMuX3dvcmxkU3BhY2VOb2RlPW8uY3VzdG9tV29ybGRTcGFjZU5vZGUsdGhpcy5hcHBseUNhY2hlZFRleHR1cmUobnVsbCxudWxsKX1yZXR1cm4gX19leHRlbmRzKHIsdCkscj1fX2RlY29yYXRlKFtlLmNsYXNzTmFtZShcIldvcmxkU3BhY2VDYW52YXMyRFwiKV0scil9KGkpO2UuV29ybGRTcGFjZUNhbnZhczJEPXI7dmFyIG49ZnVuY3Rpb24odCl7ZnVuY3Rpb24gaShpLHIpe2UuUHJpbTJEQmFzZS5faXNDYW52YXNJbml0PSEwLHQuY2FsbCh0aGlzLGkscil9cmV0dXJuIF9fZXh0ZW5kcyhpLHQpLGk9X19kZWNvcmF0ZShbZS5jbGFzc05hbWUoXCJTY3JlZW5TcGFjZUNhbnZhczJEXCIpXSxpKX0oaSk7ZS5TY3JlZW5TcGFjZUNhbnZhczJEPW59KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQodCxpLHIpe2UuY2FsbCh0aGlzLHQsaSksdGhpcy5fY2FudmFzPXJ9cmV0dXJuIF9fZXh0ZW5kcyh0LGUpLHQucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXtlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5fY2FudmFzJiYodGhpcy5fY2FudmFzLmRpc3Bvc2UoKSx0aGlzLl9jYW52YXM9bnVsbCl9LHR9KGUuTWVzaCk7ZS5Xb3JsZFNwYWNlQ2FudmFzMkROb2RlPXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCgpe3RoaXMubGF5b3V0RGlydHlPblByb3BlcnR5Q2hhbmdlZE1hc2s9MH1yZXR1cm4gdC5wcm90b3R5cGUudXBkYXRlTGF5b3V0PWZ1bmN0aW9uKGUpe30sT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwiaXNDaGlsZFBvc2l0aW9uQWxsb3dlZFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4hMX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSx0LnByb3RvdHlwZS5pc0xvY2tlZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9pc0xvY2tlZH0sdC5wcm90b3R5cGUubG9jaz1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9pc0xvY2tlZD8hMToodGhpcy5faXNMb2NrZWQ9ITAsITApfSx0PV9fZGVjb3JhdGUoW2UuY2xhc3NOYW1lKFwiTGF5b3V0RW5naW5lQmFzZVwiKV0sdCl9KCk7ZS5MYXlvdXRFbmdpbmVCYXNlPXQ7dmFyIGk9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gaSgpe3QuYXBwbHkodGhpcyxhcmd1bWVudHMpfXJldHVybiBfX2V4dGVuZHMoaSx0KSxpLnByb3RvdHlwZS51cGRhdGVMYXlvdXQ9ZnVuY3Rpb24odCl7aWYodC5faXNGbGFnU2V0KGUuU21hcnRQcm9wZXJ0eVByaW0uZmxhZ0xheW91dERpcnR5KSl7Zm9yKHZhciBpPTAscj10LmNoaWxkcmVuO2k8ci5sZW5ndGg7aSsrKXt2YXIgbj1yW2ldO3RoaXMuX2RvVXBkYXRlKG4pfXQuX2NsZWFyRmxhZ3MoZS5TbWFydFByb3BlcnR5UHJpbS5mbGFnTGF5b3V0RGlydHkpfX0saS5wcm90b3R5cGUuX2RvVXBkYXRlPWZ1bmN0aW9uKHQpe3QgaW5zdGFuY2VvZiBlLkNhbnZhczJEP3QubGF5b3V0QXJlYT10LmFjdHVhbFNpemU6dC5wYXJlbnQgaW5zdGFuY2VvZiBlLkNhbnZhczJEP3QubGF5b3V0QXJlYT10Lm93bmVyLmFjdHVhbFNpemU6dC5sYXlvdXRBcmVhPXQucGFyZW50LmNvbnRlbnRBcmVhfSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJpc0NoaWxkUG9zaXRpb25BbGxvd2VkXCIse2dldDpmdW5jdGlvbigpe3JldHVybiEwfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLGkuU2luZ2xldG9uPW5ldyBpLGk9X19kZWNvcmF0ZShbZS5jbGFzc05hbWUoXCJDYW52YXNMYXlvdXRFbmdpbmVcIildLGkpfSh0KTtlLkNhbnZhc0xheW91dEVuZ2luZT1pO3ZhciByPWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGkoKXt0LmNhbGwodGhpcyksdGhpcy5faXNIb3Jpem9udGFsPSEwLHRoaXMubGF5b3V0RGlydHlPblByb3BlcnR5Q2hhbmdlZE1hc2s9ZS5QcmltMkRCYXNlLnNpemVQcm9wZXJ0eS5mbGFnSWR9cmV0dXJuIF9fZXh0ZW5kcyhpLHQpLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLFwiSG9yaXpvbnRhbFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gaS5faG9yaXpvbnRhbHx8KGkuX2hvcml6b250YWw9bmV3IGksaS5faG9yaXpvbnRhbC5pc0hvcml6b250YWw9ITAsaS5faG9yaXpvbnRhbC5sb2NrKCkpLGkuX2hvcml6b250YWx9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGksXCJWZXJ0aWNhbFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gaS5fdmVydGljYWx8fChpLl92ZXJ0aWNhbD1uZXcgaSxpLl92ZXJ0aWNhbC5pc0hvcml6b250YWw9ITEsaS5fdmVydGljYWwubG9jaygpKSxpLl92ZXJ0aWNhbH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJpc0hvcml6b250YWxcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lzSG9yaXpvbnRhbH0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuaXNMb2NrZWQoKXx8KHRoaXMuX2lzSG9yaXpvbnRhbD1lKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxpLnByb3RvdHlwZS51cGRhdGVMYXlvdXQ9ZnVuY3Rpb24odCl7aWYodC5faXNGbGFnU2V0KGUuU21hcnRQcm9wZXJ0eVByaW0uZmxhZ0xheW91dERpcnR5KSl7Zm9yKHZhciBpPTAscj0wLG49dGhpcy5pc0hvcml6b250YWwsbz0wLHM9MCxhPXQuY2hpbGRyZW47czxhLmxlbmd0aDtzKyspe3ZhciBoPWFbc10sYz1oLmxheW91dEFyZWE7aC5tYXJnaW4uY29tcHV0ZUFyZWEoaC5hY3R1YWxTaXplLGMpLG89TWF0aC5tYXgobyxuP2MuaGVpZ2h0OmMud2lkdGgpfWZvcih2YXIgbD0wLHU9dC5jaGlsZHJlbjtsPHUubGVuZ3RoO2wrKyl7dmFyIGg9dVtsXTtoLmxheW91dEFyZWFQb3M9bmV3IGUuVmVjdG9yMihpLHIpO3ZhciBjPWgubGF5b3V0QXJlYTtuPyhpKz1jLndpZHRoLGgubGF5b3V0QXJlYT1uZXcgZS5TaXplKGMud2lkdGgsbykpOihyKz1jLmhlaWdodCxoLmxheW91dEFyZWE9bmV3IGUuU2l6ZShvLGMuaGVpZ2h0KSl9dC5fY2xlYXJGbGFncyhlLlNtYXJ0UHJvcGVydHlQcmltLmZsYWdMYXlvdXREaXJ0eSl9fSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJpc0NoaWxkUG9zaXRpb25BbGxvd2VkXCIse2dldDpmdW5jdGlvbigpe3JldHVybiExfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLGkuX2hvcml6b250YWw9bnVsbCxpLl92ZXJ0aWNhbD1udWxsLGk9X19kZWNvcmF0ZShbZS5jbGFzc05hbWUoXCJTdGFja1BhbmVsTGF5b3V0RW5naW5lXCIpXSxpKX0odCk7ZS5TdGFja1BhbmVsTGF5b3V0RW5naW5lPXI7XG59KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGkoaSxyLG4sbyl7dC5jYWxsKHRoaXMsaSxyKSx0aGlzLl90ZXh0dXJlcz17fSx0aGlzLl9mbG9hdHM9e30sdGhpcy5fZmxvYXRzQXJyYXlzPXt9LHRoaXMuX2NvbG9yczM9e30sdGhpcy5fY29sb3JzND17fSx0aGlzLl92ZWN0b3JzMj17fSx0aGlzLl92ZWN0b3JzMz17fSx0aGlzLl92ZWN0b3JzND17fSx0aGlzLl9tYXRyaWNlcz17fSx0aGlzLl9tYXRyaWNlczN4Mz17fSx0aGlzLl9tYXRyaWNlczJ4Mj17fSx0aGlzLl9jYWNoZWRXb3JsZFZpZXdNYXRyaXg9bmV3IGUuTWF0cml4LHRoaXMuX3NoYWRlclBhdGg9bixvLm5lZWRBbHBoYUJsZW5kaW5nPW8ubmVlZEFscGhhQmxlbmRpbmd8fCExLG8ubmVlZEFscGhhVGVzdGluZz1vLm5lZWRBbHBoYVRlc3Rpbmd8fCExLG8uYXR0cmlidXRlcz1vLmF0dHJpYnV0ZXN8fFtcInBvc2l0aW9uXCIsXCJub3JtYWxcIixcInV2XCJdLG8udW5pZm9ybXM9by51bmlmb3Jtc3x8W1wid29ybGRWaWV3UHJvamVjdGlvblwiXSxvLnNhbXBsZXJzPW8uc2FtcGxlcnN8fFtdLG8uZGVmaW5lcz1vLmRlZmluZXN8fFtdLHRoaXMuX29wdGlvbnM9b31yZXR1cm4gX19leHRlbmRzKGksdCksaS5wcm90b3R5cGUubmVlZEFscGhhQmxlbmRpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fb3B0aW9ucy5uZWVkQWxwaGFCbGVuZGluZ30saS5wcm90b3R5cGUubmVlZEFscGhhVGVzdGluZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9vcHRpb25zLm5lZWRBbHBoYVRlc3Rpbmd9LGkucHJvdG90eXBlLl9jaGVja1VuaWZvcm09ZnVuY3Rpb24oZSl7LTE9PT10aGlzLl9vcHRpb25zLnVuaWZvcm1zLmluZGV4T2YoZSkmJnRoaXMuX29wdGlvbnMudW5pZm9ybXMucHVzaChlKX0saS5wcm90b3R5cGUuc2V0VGV4dHVyZT1mdW5jdGlvbihlLHQpe3JldHVybi0xPT09dGhpcy5fb3B0aW9ucy5zYW1wbGVycy5pbmRleE9mKGUpJiZ0aGlzLl9vcHRpb25zLnNhbXBsZXJzLnB1c2goZSksdGhpcy5fdGV4dHVyZXNbZV09dCx0aGlzfSxpLnByb3RvdHlwZS5zZXRGbG9hdD1mdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLl9jaGVja1VuaWZvcm0oZSksdGhpcy5fZmxvYXRzW2VdPXQsdGhpc30saS5wcm90b3R5cGUuc2V0RmxvYXRzPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuX2NoZWNrVW5pZm9ybShlKSx0aGlzLl9mbG9hdHNBcnJheXNbZV09dCx0aGlzfSxpLnByb3RvdHlwZS5zZXRDb2xvcjM9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5fY2hlY2tVbmlmb3JtKGUpLHRoaXMuX2NvbG9yczNbZV09dCx0aGlzfSxpLnByb3RvdHlwZS5zZXRDb2xvcjQ9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5fY2hlY2tVbmlmb3JtKGUpLHRoaXMuX2NvbG9yczRbZV09dCx0aGlzfSxpLnByb3RvdHlwZS5zZXRWZWN0b3IyPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuX2NoZWNrVW5pZm9ybShlKSx0aGlzLl92ZWN0b3JzMltlXT10LHRoaXN9LGkucHJvdG90eXBlLnNldFZlY3RvcjM9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5fY2hlY2tVbmlmb3JtKGUpLHRoaXMuX3ZlY3RvcnMzW2VdPXQsdGhpc30saS5wcm90b3R5cGUuc2V0VmVjdG9yND1mdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLl9jaGVja1VuaWZvcm0oZSksdGhpcy5fdmVjdG9yczRbZV09dCx0aGlzfSxpLnByb3RvdHlwZS5zZXRNYXRyaXg9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5fY2hlY2tVbmlmb3JtKGUpLHRoaXMuX21hdHJpY2VzW2VdPXQsdGhpc30saS5wcm90b3R5cGUuc2V0TWF0cml4M3gzPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuX2NoZWNrVW5pZm9ybShlKSx0aGlzLl9tYXRyaWNlczN4M1tlXT10LHRoaXN9LGkucHJvdG90eXBlLnNldE1hdHJpeDJ4Mj1mdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLl9jaGVja1VuaWZvcm0oZSksdGhpcy5fbWF0cmljZXMyeDJbZV09dCx0aGlzfSxpLnByb3RvdHlwZS5pc1JlYWR5PWZ1bmN0aW9uKHQsaSl7dmFyIHI9dGhpcy5nZXRTY2VuZSgpLG49ci5nZXRFbmdpbmUoKTtpZighdGhpcy5jaGVja1JlYWR5T25FdmVyeUNhbGwmJnRoaXMuX3JlbmRlcklkPT09ci5nZXRSZW5kZXJJZCgpKXJldHVybiEwO3ZhciBvPVtdLHM9bmV3IGUuRWZmZWN0RmFsbGJhY2tzO2kmJm8ucHVzaChcIiNkZWZpbmUgSU5TVEFOQ0VTXCIpO2Zvcih2YXIgYT0wO2E8dGhpcy5fb3B0aW9ucy5kZWZpbmVzLmxlbmd0aDthKyspby5wdXNoKHRoaXMuX29wdGlvbnMuZGVmaW5lc1thXSk7dCYmdC51c2VCb25lcyYmdC5jb21wdXRlQm9uZXNVc2luZ1NoYWRlcnMmJihvLnB1c2goXCIjZGVmaW5lIE5VTV9CT05FX0lORkxVRU5DRVJTIFwiK3QubnVtQm9uZUluZmx1ZW5jZXJzKSxvLnB1c2goXCIjZGVmaW5lIEJvbmVzUGVyTWVzaCBcIisodC5za2VsZXRvbi5ib25lcy5sZW5ndGgrMSkpLHMuYWRkQ1BVU2tpbm5pbmdGYWxsYmFjaygwLHQpKSxuLmdldEFscGhhVGVzdGluZygpJiZvLnB1c2goXCIjZGVmaW5lIEFMUEhBVEVTVFwiKTt2YXIgaD10aGlzLl9lZmZlY3QsYz1vLmpvaW4oXCJcXG5cIik7cmV0dXJuIHRoaXMuX2VmZmVjdD1uLmNyZWF0ZUVmZmVjdCh0aGlzLl9zaGFkZXJQYXRoLHRoaXMuX29wdGlvbnMuYXR0cmlidXRlcyx0aGlzLl9vcHRpb25zLnVuaWZvcm1zLHRoaXMuX29wdGlvbnMuc2FtcGxlcnMsYyxzLHRoaXMub25Db21waWxlZCx0aGlzLm9uRXJyb3IpLHRoaXMuX2VmZmVjdC5pc1JlYWR5KCk/KGghPT10aGlzLl9lZmZlY3QmJnIucmVzZXRDYWNoZWRNYXRlcmlhbCgpLHRoaXMuX3JlbmRlcklkPXIuZ2V0UmVuZGVySWQoKSwhMCk6ITF9LGkucHJvdG90eXBlLmJpbmRPbmx5V29ybGRNYXRyaXg9ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5nZXRTY2VuZSgpOy0xIT09dGhpcy5fb3B0aW9ucy51bmlmb3Jtcy5pbmRleE9mKFwid29ybGRcIikmJnRoaXMuX2VmZmVjdC5zZXRNYXRyaXgoXCJ3b3JsZFwiLGUpLC0xIT09dGhpcy5fb3B0aW9ucy51bmlmb3Jtcy5pbmRleE9mKFwid29ybGRWaWV3XCIpJiYoZS5tdWx0aXBseVRvUmVmKHQuZ2V0Vmlld01hdHJpeCgpLHRoaXMuX2NhY2hlZFdvcmxkVmlld01hdHJpeCksdGhpcy5fZWZmZWN0LnNldE1hdHJpeChcIndvcmxkVmlld1wiLHRoaXMuX2NhY2hlZFdvcmxkVmlld01hdHJpeCkpLC0xIT09dGhpcy5fb3B0aW9ucy51bmlmb3Jtcy5pbmRleE9mKFwid29ybGRWaWV3UHJvamVjdGlvblwiKSYmdGhpcy5fZWZmZWN0LnNldE1hdHJpeChcIndvcmxkVmlld1Byb2plY3Rpb25cIixlLm11bHRpcGx5KHQuZ2V0VHJhbnNmb3JtTWF0cml4KCkpKX0saS5wcm90b3R5cGUuYmluZD1mdW5jdGlvbihlLGkpe2lmKHRoaXMuYmluZE9ubHlXb3JsZE1hdHJpeChlKSx0aGlzLmdldFNjZW5lKCkuZ2V0Q2FjaGVkTWF0ZXJpYWwoKSE9PXRoaXMpey0xIT09dGhpcy5fb3B0aW9ucy51bmlmb3Jtcy5pbmRleE9mKFwidmlld1wiKSYmdGhpcy5fZWZmZWN0LnNldE1hdHJpeChcInZpZXdcIix0aGlzLmdldFNjZW5lKCkuZ2V0Vmlld01hdHJpeCgpKSwtMSE9PXRoaXMuX29wdGlvbnMudW5pZm9ybXMuaW5kZXhPZihcInByb2plY3Rpb25cIikmJnRoaXMuX2VmZmVjdC5zZXRNYXRyaXgoXCJwcm9qZWN0aW9uXCIsdGhpcy5nZXRTY2VuZSgpLmdldFByb2plY3Rpb25NYXRyaXgoKSksLTEhPT10aGlzLl9vcHRpb25zLnVuaWZvcm1zLmluZGV4T2YoXCJ2aWV3UHJvamVjdGlvblwiKSYmdGhpcy5fZWZmZWN0LnNldE1hdHJpeChcInZpZXdQcm9qZWN0aW9uXCIsdGhpcy5nZXRTY2VuZSgpLmdldFRyYW5zZm9ybU1hdHJpeCgpKSxpJiZpLnVzZUJvbmVzJiZpLmNvbXB1dGVCb25lc1VzaW5nU2hhZGVycyYmdGhpcy5fZWZmZWN0LnNldE1hdHJpY2VzKFwibUJvbmVzXCIsaS5za2VsZXRvbi5nZXRUcmFuc2Zvcm1NYXRyaWNlcyhpKSk7Zm9yKHZhciByIGluIHRoaXMuX3RleHR1cmVzKXRoaXMuX2VmZmVjdC5zZXRUZXh0dXJlKHIsdGhpcy5fdGV4dHVyZXNbcl0pO2ZvcihyIGluIHRoaXMuX2Zsb2F0cyl0aGlzLl9lZmZlY3Quc2V0RmxvYXQocix0aGlzLl9mbG9hdHNbcl0pO2ZvcihyIGluIHRoaXMuX2Zsb2F0c0FycmF5cyl0aGlzLl9lZmZlY3Quc2V0QXJyYXkocix0aGlzLl9mbG9hdHNBcnJheXNbcl0pO2ZvcihyIGluIHRoaXMuX2NvbG9yczMpdGhpcy5fZWZmZWN0LnNldENvbG9yMyhyLHRoaXMuX2NvbG9yczNbcl0pO2ZvcihyIGluIHRoaXMuX2NvbG9yczQpe3ZhciBuPXRoaXMuX2NvbG9yczRbcl07dGhpcy5fZWZmZWN0LnNldEZsb2F0NChyLG4ucixuLmcsbi5iLG4uYSl9Zm9yKHIgaW4gdGhpcy5fdmVjdG9yczIpdGhpcy5fZWZmZWN0LnNldFZlY3RvcjIocix0aGlzLl92ZWN0b3JzMltyXSk7Zm9yKHIgaW4gdGhpcy5fdmVjdG9yczMpdGhpcy5fZWZmZWN0LnNldFZlY3RvcjMocix0aGlzLl92ZWN0b3JzM1tyXSk7Zm9yKHIgaW4gdGhpcy5fdmVjdG9yczQpdGhpcy5fZWZmZWN0LnNldFZlY3RvcjQocix0aGlzLl92ZWN0b3JzNFtyXSk7Zm9yKHIgaW4gdGhpcy5fbWF0cmljZXMpdGhpcy5fZWZmZWN0LnNldE1hdHJpeChyLHRoaXMuX21hdHJpY2VzW3JdKTtmb3IociBpbiB0aGlzLl9tYXRyaWNlczN4Myl0aGlzLl9lZmZlY3Quc2V0TWF0cml4M3gzKHIsdGhpcy5fbWF0cmljZXMzeDNbcl0pO2ZvcihyIGluIHRoaXMuX21hdHJpY2VzMngyKXRoaXMuX2VmZmVjdC5zZXRNYXRyaXgyeDIocix0aGlzLl9tYXRyaWNlczJ4MltyXSl9dC5wcm90b3R5cGUuYmluZC5jYWxsKHRoaXMsZSxpKX0saS5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oZSl7dmFyIHQ9bmV3IGkoZSx0aGlzLmdldFNjZW5lKCksdGhpcy5fc2hhZGVyUGF0aCx0aGlzLl9vcHRpb25zKTtyZXR1cm4gdH0saS5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbihlLGkpe2lmKGkpZm9yKHZhciByIGluIHRoaXMuX3RleHR1cmVzKXRoaXMuX3RleHR1cmVzW3JdLmRpc3Bvc2UoKTt0aGlzLl90ZXh0dXJlcz17fSx0LnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyxlLGkpfSxpLnByb3RvdHlwZS5zZXJpYWxpemU9ZnVuY3Rpb24oKXt2YXIgdD1lLlNlcmlhbGl6YXRpb25IZWxwZXIuU2VyaWFsaXplKHRoaXMpO3QuY3VzdG9tVHlwZT1cIkJBQllMT04uU2hhZGVyTWF0ZXJpYWxcIix0Lm9wdGlvbnM9dGhpcy5fb3B0aW9ucyx0LnNoYWRlclBhdGg9dGhpcy5fc2hhZGVyUGF0aCx0LnRleHR1cmVzPXt9O2Zvcih2YXIgaSBpbiB0aGlzLl90ZXh0dXJlcyl0LnRleHR1cmVzW2ldPXRoaXMuX3RleHR1cmVzW2ldLnNlcmlhbGl6ZSgpO3QuZmxvYXRzPXt9O2ZvcihpIGluIHRoaXMuX2Zsb2F0cyl0LmZsb2F0c1tpXT10aGlzLl9mbG9hdHNbaV07dC5mbG9hdEFycmF5cz17fTtmb3IoaSBpbiB0aGlzLl9mbG9hdHNBcnJheXMpdC5mbG9hdEFycmF5c1tpXT10aGlzLl9mbG9hdHNBcnJheXNbaV07dC5jb2xvcnMzPXt9O2ZvcihpIGluIHRoaXMuX2NvbG9yczMpdC5jb2xvcnMzW2ldPXRoaXMuX2NvbG9yczNbaV0uYXNBcnJheSgpO3QuY29sb3JzND17fTtmb3IoaSBpbiB0aGlzLl9jb2xvcnM0KXQuY29sb3JzNFtpXT10aGlzLl9jb2xvcnM0W2ldLmFzQXJyYXkoKTt0LnZlY3RvcnMyPXt9O2ZvcihpIGluIHRoaXMuX3ZlY3RvcnMyKXQudmVjdG9yczJbaV09dGhpcy5fdmVjdG9yczJbaV0uYXNBcnJheSgpO3QudmVjdG9yczM9e307Zm9yKGkgaW4gdGhpcy5fdmVjdG9yczMpdC52ZWN0b3JzM1tpXT10aGlzLl92ZWN0b3JzM1tpXS5hc0FycmF5KCk7dC52ZWN0b3JzND17fTtmb3IoaSBpbiB0aGlzLl92ZWN0b3JzNCl0LnZlY3RvcnM0W2ldPXRoaXMuX3ZlY3RvcnM0W2ldLmFzQXJyYXkoKTt0Lm1hdHJpY2VzPXt9O2ZvcihpIGluIHRoaXMuX21hdHJpY2VzKXQubWF0cmljZXNbaV09dGhpcy5fbWF0cmljZXNbaV0uYXNBcnJheSgpO3QubWF0cmljZXMzeDM9e307Zm9yKGkgaW4gdGhpcy5fbWF0cmljZXMzeDMpdC5tYXRyaWNlczN4M1tpXT10aGlzLl9tYXRyaWNlczN4M1tpXTt0Lm1hdHJpY2VzMngyPXt9O2ZvcihpIGluIHRoaXMuX21hdHJpY2VzMngyKXQubWF0cmljZXMyeDJbaV09dGhpcy5fbWF0cmljZXMyeDJbaV07cmV0dXJuIHR9LGkuUGFyc2U9ZnVuY3Rpb24odCxyLG4pe3ZhciBvPWUuU2VyaWFsaXphdGlvbkhlbHBlci5QYXJzZShmdW5jdGlvbigpe3JldHVybiBuZXcgaSh0Lm5hbWUscix0LnNoYWRlclBhdGgsdC5vcHRpb25zKX0sdCxyLG4pO2Zvcih2YXIgcyBpbiB0LnRleHR1cmVzKW8uc2V0VGV4dHVyZShzLGUuVGV4dHVyZS5QYXJzZSh0LnRleHR1cmVzW3NdLHIsbikpO2ZvcihzIGluIHQuZmxvYXRzKW8uc2V0RmxvYXQocyx0LmZsb2F0c1tzXSk7Zm9yKHMgaW4gdC5mbG9hdHNBcnJheXMpby5zZXRGbG9hdHMocyx0LmZsb2F0c0FycmF5c1tzXSk7Zm9yKHMgaW4gdC5jb2xvcnMzKW8uc2V0Q29sb3IzKHMsZS5Db2xvcjMuRnJvbUFycmF5KHQuY29sb3JzM1tzXSkpO2ZvcihzIGluIHQuY29sb3JzNClvLnNldENvbG9yNChzLGUuQ29sb3I0LkZyb21BcnJheSh0LmNvbG9yczRbc10pKTtmb3IocyBpbiB0LnZlY3RvcnMyKW8uc2V0VmVjdG9yMihzLGUuVmVjdG9yMi5Gcm9tQXJyYXkodC52ZWN0b3JzMltzXSkpO2ZvcihzIGluIHQudmVjdG9yczMpby5zZXRWZWN0b3IzKHMsZS5WZWN0b3IzLkZyb21BcnJheSh0LnZlY3RvcnMzW3NdKSk7Zm9yKHMgaW4gdC52ZWN0b3JzNClvLnNldFZlY3RvcjQocyxlLlZlY3RvcjQuRnJvbUFycmF5KHQudmVjdG9yczRbc10pKTtmb3IocyBpbiB0Lm1hdHJpY2VzKW8uc2V0TWF0cml4KHMsZS5NYXRyaXguRnJvbUFycmF5KHQubWF0cmljZXNbc10pKTtmb3IocyBpbiB0Lm1hdHJpY2VzM3gzKW8uc2V0TWF0cml4M3gzKHMsdC5tYXRyaWNlczN4M1tzXSk7Zm9yKHMgaW4gdC5tYXRyaWNlczJ4MilvLnNldE1hdHJpeDJ4MihzLHQubWF0cmljZXMyeDJbc10pO3JldHVybiBvfSxpfShlLk1hdGVyaWFsKTtlLlNoYWRlck1hdGVyaWFsPXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0OyFmdW5jdGlvbih0KXtmdW5jdGlvbiBpKGUpe3JldHVybiBlLmNoYXJDb2RlQXQoMCkrKGUuY2hhckNvZGVBdCgxKTw8OCkrKGUuY2hhckNvZGVBdCgyKTw8MTYpKyhlLmNoYXJDb2RlQXQoMyk8PDI0KX1mdW5jdGlvbiByKGUpe3JldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlKDI1NSZlLGU+PjgmMjU1LGU+PjE2JjI1NSxlPj4yNCYyNTUpfXZhciBuPTU0MjMyNzg3NixvPTEzMTA3MixzPTUxMixhPTQsaD02NCxjPTEzMTA3MixsPWkoXCJEWFQxXCIpLHU9aShcIkRYVDNcIiksZj1pKFwiRFhUNVwiKSxkPTMxLHA9MCxfPTEsbT0yLGc9Myx2PTQseT03LHg9MjAsYj0yMSxQPTIyLEE9MjgsVD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoKXt9cmV0dXJuIHQuR2V0RERTSW5mbz1mdW5jdGlvbihlKXt2YXIgdD1uZXcgSW50MzJBcnJheShlLDAsZCksaT0xO3JldHVybiB0W21dJm8mJihpPU1hdGgubWF4KDEsdFt5XSkpLHt3aWR0aDp0W3ZdLGhlaWdodDp0W2ddLG1pcG1hcENvdW50OmksaXNGb3VyQ0M6KHRbeF0mYSk9PT1hLGlzUkdCOih0W3hdJmgpPT09aCxpc0x1bWluYW5jZToodFt4XSZjKT09PWMsaXNDdWJlOih0W0FdJnMpPT09c319LHQuR2V0UkdCQUFycmF5QnVmZmVyPWZ1bmN0aW9uKGUsdCxpLHIsbil7Zm9yKHZhciBvPW5ldyBVaW50OEFycmF5KHIpLHM9bmV3IFVpbnQ4QXJyYXkobiksYT0wLGg9dC0xO2g+PTA7aC0tKWZvcih2YXIgYz0wO2U+YztjKyspe3ZhciBsPWkrNCooYytoKmUpO29bYSsyXT1zW2xdLG9bYSsxXT1zW2wrMV0sb1thXT1zW2wrMl0sb1thKzNdPXNbbCszXSxhKz00fXJldHVybiBvfSx0LkdldFJHQkFycmF5QnVmZmVyPWZ1bmN0aW9uKGUsdCxpLHIsbil7Zm9yKHZhciBvPW5ldyBVaW50OEFycmF5KHIpLHM9bmV3IFVpbnQ4QXJyYXkobiksYT0wLGg9dC0xO2g+PTA7aC0tKWZvcih2YXIgYz0wO2U+YztjKyspe3ZhciBsPWkrMyooYytoKmUpO29bYSsyXT1zW2xdLG9bYSsxXT1zW2wrMV0sb1thXT1zW2wrMl0sYSs9M31yZXR1cm4gb30sdC5HZXRMdW1pbmFuY2VBcnJheUJ1ZmZlcj1mdW5jdGlvbihlLHQsaSxyLG4pe2Zvcih2YXIgbz1uZXcgVWludDhBcnJheShyKSxzPW5ldyBVaW50OEFycmF5KG4pLGE9MCxoPXQtMTtoPj0wO2gtLSlmb3IodmFyIGM9MDtlPmM7YysrKXt2YXIgbD1pKyhjK2gqZSk7b1thXT1zW2xdLGErK31yZXR1cm4gb30sdC5VcGxvYWRERFNMZXZlbHM9ZnVuY3Rpb24oaSxzLGEsaCxjLHgpe3ZhciBBLFQsRSxDLFMsTSxJLEQsUixPLHc9bmV3IEludDMyQXJyYXkoYSwwLGQpO2lmKHdbcF0hPW4pcmV0dXJuIHZvaWQgZS5Ub29scy5FcnJvcihcIkludmFsaWQgbWFnaWMgbnVtYmVyIGluIEREUyBoZWFkZXJcIik7aWYoIWguaXNGb3VyQ0MmJiFoLmlzUkdCJiYhaC5pc0x1bWluYW5jZSlyZXR1cm4gdm9pZCBlLlRvb2xzLkVycm9yKFwiVW5zdXBwb3J0ZWQgZm9ybWF0LCBtdXN0IGNvbnRhaW4gYSBGb3VyQ0MsIFJHQiBvciBMVU1JTkFOQ0UgY29kZVwiKTtpZihoLmlzRm91ckNDKXN3aXRjaChBPXdbYl0pe2Nhc2UgbDpUPTgsRT1zLkNPTVBSRVNTRURfUkdCQV9TM1RDX0RYVDFfRVhUO2JyZWFrO2Nhc2UgdTpUPTE2LEU9cy5DT01QUkVTU0VEX1JHQkFfUzNUQ19EWFQzX0VYVDticmVhaztjYXNlIGY6VD0xNixFPXMuQ09NUFJFU1NFRF9SR0JBX1MzVENfRFhUNV9FWFQ7YnJlYWs7ZGVmYXVsdDpyZXR1cm4gdm9pZCBjb25zb2xlLmVycm9yKFwiVW5zdXBwb3J0ZWQgRm91ckNDIGNvZGU6XCIscihBKSl9Uj0xLHdbbV0mbyYmYyE9PSExJiYoUj1NYXRoLm1heCgxLHdbeV0pKTtmb3IodmFyIEw9d1tQXSxCPTA7eD5CO0IrKyl7dmFyIFY9MT09PXg/aS5URVhUVVJFXzJEOmkuVEVYVFVSRV9DVUJFX01BUF9QT1NJVElWRV9YK0I7Zm9yKEM9d1t2XSxTPXdbZ10sST13W19dKzQsTz0wO1I+TzsrK08pe2lmKGguaXNSR0IpMjQ9PT1MPyhNPUMqUyozLEQ9dC5HZXRSR0JBcnJheUJ1ZmZlcihDLFMsSSxNLGEpLGkudGV4SW1hZ2UyRChWLE8saS5SR0IsQyxTLDAsaS5SR0IsaS5VTlNJR05FRF9CWVRFLEQpKTooTT1DKlMqNCxEPXQuR2V0UkdCQUFycmF5QnVmZmVyKEMsUyxJLE0sYSksaS50ZXhJbWFnZTJEKFYsTyxpLlJHQkEsQyxTLDAsaS5SR0JBLGkuVU5TSUdORURfQllURSxEKSk7ZWxzZSBpZihoLmlzTHVtaW5hbmNlKXt2YXIgRj1pLmdldFBhcmFtZXRlcihpLlVOUEFDS19BTElHTk1FTlQpLE49Qyx6PU1hdGguZmxvb3IoKEMrRi0xKS9GKSpGO009eiooUy0xKStOLEQ9dC5HZXRMdW1pbmFuY2VBcnJheUJ1ZmZlcihDLFMsSSxNLGEpLGkudGV4SW1hZ2UyRChWLE8saS5MVU1JTkFOQ0UsQyxTLDAsaS5MVU1JTkFOQ0UsaS5VTlNJR05FRF9CWVRFLEQpfWVsc2UgTT1NYXRoLm1heCg0LEMpLzQqTWF0aC5tYXgoNCxTKS80KlQsRD1uZXcgVWludDhBcnJheShhLEksTSksaS5jb21wcmVzc2VkVGV4SW1hZ2UyRChWLE8sRSxDLFMsMCxEKTtJKz1NLEMqPS41LFMqPS41LEM9TWF0aC5tYXgoMSxDKSxTPU1hdGgubWF4KDEsUyl9fX0sdH0oKTt0LkREU1Rvb2xzPVR9KHQ9ZS5JbnRlcm5hbHN8fChlLkludGVybmFscz17fSkpfShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCxpKXtyZXR1cm4gdm9pZCAwPT09dCYmKHQ9ITApLHZvaWQgMD09PWkmJihpPTEwKSx0aGlzLl91c2VEZWx0YUZvcldvcmxkU3RlcD10LHRoaXMubmFtZT1cIkNhbm5vbkpTUGx1Z2luXCIsdGhpcy5fcGh5c2ljc01hdGVyaWFscz1bXSx0aGlzLl9maXhlZFRpbWVTdGVwPTEvNjAsdGhpcy5fY3VycmVudENvbGxpc2lvbkdyb3VwPTIsdGhpcy5fbWludXM5MFg9bmV3IGUuUXVhdGVybmlvbigtLjcwNzEwNjc4MTE4NjU0NzUsMCwwLC43MDcxMDY3ODExODY1NDc1KSx0aGlzLl9wbHVzOTBYPW5ldyBlLlF1YXRlcm5pb24oLjcwNzEwNjc4MTE4NjU0NzUsMCwwLC43MDcxMDY3ODExODY1NDc1KSx0aGlzLl90bXBQb3NpdGlvbj1lLlZlY3RvcjMuWmVybygpLHRoaXMuX3RtcFF1YXRlcm5pb249bmV3IGUuUXVhdGVybmlvbix0aGlzLl90bXBEZWx0YVBvc2l0aW9uPWUuVmVjdG9yMy5aZXJvKCksdGhpcy5fdG1wRGVsdGFSb3RhdGlvbj1uZXcgZS5RdWF0ZXJuaW9uLHRoaXMuX3RtcFVuaXR5Um90YXRpb249bmV3IGUuUXVhdGVybmlvbix0aGlzLmlzU3VwcG9ydGVkKCk/KHRoaXMud29ybGQ9bmV3IENBTk5PTi5Xb3JsZCx0aGlzLndvcmxkLmJyb2FkcGhhc2U9bmV3IENBTk5PTi5OYWl2ZUJyb2FkcGhhc2Usdm9pZCh0aGlzLndvcmxkLnNvbHZlci5pdGVyYXRpb25zPWkpKTp2b2lkIGUuVG9vbHMuRXJyb3IoXCJDYW5ub25KUyBpcyBub3QgYXZhaWxhYmxlLiBQbGVhc2UgbWFrZSBzdXJlIHlvdSBpbmNsdWRlZCB0aGUganMgZmlsZS5cIil9cmV0dXJuIHQucHJvdG90eXBlLnNldEdyYXZpdHk9ZnVuY3Rpb24oZSl7dGhpcy53b3JsZC5ncmF2aXR5LmNvcHkoZSl9LHQucHJvdG90eXBlLnNldFRpbWVTdGVwPWZ1bmN0aW9uKGUpe3RoaXMuX2ZpeGVkVGltZVN0ZXA9ZX0sdC5wcm90b3R5cGUuZXhlY3V0ZVN0ZXA9ZnVuY3Rpb24oZSx0KXt0aGlzLndvcmxkLnN0ZXAodGhpcy5fZml4ZWRUaW1lU3RlcCx0aGlzLl91c2VEZWx0YUZvcldvcmxkU3RlcD8xZTMqZTowLDMpfSx0LnByb3RvdHlwZS5hcHBseUltcHVsc2U9ZnVuY3Rpb24oZSx0LGkpe3ZhciByPW5ldyBDQU5OT04uVmVjMyhpLngsaS55LGkueiksbj1uZXcgQ0FOTk9OLlZlYzModC54LHQueSx0LnopO2UucGh5c2ljc0JvZHkuYXBwbHlJbXB1bHNlKG4scil9LHQucHJvdG90eXBlLmFwcGx5Rm9yY2U9ZnVuY3Rpb24oZSx0LGkpe3ZhciByPW5ldyBDQU5OT04uVmVjMyhpLngsaS55LGkueiksbj1uZXcgQ0FOTk9OLlZlYzModC54LHQueSx0LnopO2UucGh5c2ljc0JvZHkuYXBwbHlJbXB1bHNlKG4scil9LHQucHJvdG90eXBlLmdlbmVyYXRlUGh5c2ljc0JvZHk9ZnVuY3Rpb24oZSl7aWYoZS5wYXJlbnQpcmV0dXJuIHZvaWQoZS5waHlzaWNzQm9keSYmKHRoaXMucmVtb3ZlUGh5c2ljc0JvZHkoZSksZS5mb3JjZVVwZGF0ZSgpKSk7aWYoZS5pc0JvZHlJbml0UmVxdWlyZWQoKSl7dmFyIHQ9dGhpcy5fY3JlYXRlU2hhcGUoZSksaT1lLnBoeXNpY3NCb2R5O2kmJnRoaXMucmVtb3ZlUGh5c2ljc0JvZHkoZSk7dmFyIHI9dGhpcy5fYWRkTWF0ZXJpYWwoXCJtYXQtXCIrZS51bmlxdWVJZCxlLmdldFBhcmFtKFwiZnJpY3Rpb25cIiksZS5nZXRQYXJhbShcInJlc3RpdHV0aW9uXCIpKSxuPXttYXNzOmUuZ2V0UGFyYW0oXCJtYXNzXCIpLG1hdGVyaWFsOnJ9LG89ZS5nZXRQYXJhbShcIm5hdGl2ZU9wdGlvbnNcIik7Zm9yKHZhciBzIGluIG8pby5oYXNPd25Qcm9wZXJ0eShzKSYmKG5bc109b1tzXSk7ZS5waHlzaWNzQm9keT1uZXcgQ0FOTk9OLkJvZHkobiksZS5waHlzaWNzQm9keS5hZGRFdmVudExpc3RlbmVyKFwiY29sbGlkZVwiLGUub25Db2xsaWRlKSx0aGlzLndvcmxkLmFkZEV2ZW50TGlzdGVuZXIoXCJwcmVTdGVwXCIsZS5iZWZvcmVTdGVwKSx0aGlzLndvcmxkLmFkZEV2ZW50TGlzdGVuZXIoXCJwb3N0U3RlcFwiLGUuYWZ0ZXJTdGVwKSxlLnBoeXNpY3NCb2R5LmFkZFNoYXBlKHQpLHRoaXMud29ybGQuYWRkKGUucGh5c2ljc0JvZHkpLGkmJltcImZvcmNlXCIsXCJ0b3JxdWVcIixcInZlbG9jaXR5XCIsXCJhbmd1bGFyVmVsb2NpdHlcIl0uZm9yRWFjaChmdW5jdGlvbih0KXtlLnBoeXNpY3NCb2R5W3RdLmNvcHkoaVt0XSl9KSx0aGlzLl9wcm9jZXNzQ2hpbGRNZXNoZXMoZSl9dGhpcy5fdXBkYXRlUGh5c2ljc0JvZHlUcmFuc2Zvcm1hdGlvbihlKX0sdC5wcm90b3R5cGUuX3Byb2Nlc3NDaGlsZE1lc2hlcz1mdW5jdGlvbih0KXt2YXIgaT10aGlzLHI9dC5vYmplY3QuZ2V0Q2hpbGRNZXNoZXM/dC5vYmplY3QuZ2V0Q2hpbGRNZXNoZXMoKTpbXTtpZihyLmxlbmd0aCl7dmFyIG49ZnVuY3Rpb24oZSxyKXt2YXIgbz1yLmdldFBoeXNpY3NJbXBvc3RvcigpO2lmKG8pe3ZhciBzPW8ucGFyZW50O2lmKHMhPT10KXt2YXIgZT1yLnBvc2l0aW9uO28ucGh5c2ljc0JvZHkmJihpLnJlbW92ZVBoeXNpY3NCb2R5KG8pLG8ucGh5c2ljc0JvZHk9bnVsbCksby5wYXJlbnQ9dCxvLnJlc2V0VXBkYXRlRmxhZ3MoKSx0LnBoeXNpY3NCb2R5LmFkZFNoYXBlKGkuX2NyZWF0ZVNoYXBlKG8pLG5ldyBDQU5OT04uVmVjMyhlLngsZS55LGUueikpLHQucGh5c2ljc0JvZHkubWFzcys9by5nZXRQYXJhbShcIm1hc3NcIil9fXIuZ2V0Q2hpbGRNZXNoZXMoKS5mb3JFYWNoKG4uYmluZChpLHIucG9zaXRpb24pKX07ci5mb3JFYWNoKG4uYmluZCh0aGlzLGUuVmVjdG9yMy5aZXJvKCkpKX19LHQucHJvdG90eXBlLnJlbW92ZVBoeXNpY3NCb2R5PWZ1bmN0aW9uKGUpe2UucGh5c2ljc0JvZHkucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNvbGxpZGVcIixlLm9uQ29sbGlkZSksdGhpcy53b3JsZC5yZW1vdmVFdmVudExpc3RlbmVyKFwicHJlU3RlcFwiLGUuYmVmb3JlU3RlcCksdGhpcy53b3JsZC5yZW1vdmVFdmVudExpc3RlbmVyKFwicG9zdFN0ZXBcIixlLmFmdGVyU3RlcCksdGhpcy53b3JsZC5yZW1vdmUoZS5waHlzaWNzQm9keSl9LHQucHJvdG90eXBlLmdlbmVyYXRlSm9pbnQ9ZnVuY3Rpb24odCl7dmFyIGk9dC5tYWluSW1wb3N0b3IucGh5c2ljc0JvZHkscj10LmNvbm5lY3RlZEltcG9zdG9yLnBoeXNpY3NCb2R5O2lmKGkmJnIpe3ZhciBuLG89dC5qb2ludC5qb2ludERhdGEscz17cGl2b3RBOm8ubWFpblBpdm90PyhuZXcgQ0FOTk9OLlZlYzMpLmNvcHkoby5tYWluUGl2b3QpOm51bGwscGl2b3RCOm8uY29ubmVjdGVkUGl2b3Q/KG5ldyBDQU5OT04uVmVjMykuY29weShvLmNvbm5lY3RlZFBpdm90KTpudWxsLGF4aXNBOm8ubWFpbkF4aXM/KG5ldyBDQU5OT04uVmVjMykuY29weShvLm1haW5BeGlzKTpudWxsLGF4aXNCOm8uY29ubmVjdGVkQXhpcz8obmV3IENBTk5PTi5WZWMzKS5jb3B5KG8uY29ubmVjdGVkQXhpcyk6bnVsbCxtYXhGb3JjZTpvLm5hdGl2ZVBhcmFtcy5tYXhGb3JjZSxjb2xsaWRlQ29ubmVjdGVkOiEhby5jb2xsaXNpb259O3N3aXRjaCh0LmpvaW50LnR5cGUpe2Nhc2UgZS5QaHlzaWNzSm9pbnQuSGluZ2VKb2ludDpjYXNlIGUuUGh5c2ljc0pvaW50LkhpbmdlMkpvaW50Om49bmV3IENBTk5PTi5IaW5nZUNvbnN0cmFpbnQoaSxyLHMpO2JyZWFrO2Nhc2UgZS5QaHlzaWNzSm9pbnQuRGlzdGFuY2VKb2ludDpuPW5ldyBDQU5OT04uRGlzdGFuY2VDb25zdHJhaW50KGkscixvLm1heERpc3RhbmNlfHwyKTticmVhaztjYXNlIGUuUGh5c2ljc0pvaW50LlNwcmluZ0pvaW50OnZhciBhPW87bj1uZXcgQ0FOTk9OLlNwcmluZyhpLHIse3Jlc3RMZW5ndGg6YS5sZW5ndGgsc3RpZmZuZXNzOmEuc3RpZmZuZXNzLGRhbXBpbmc6YS5kYW1waW5nLGxvY2FsQW5jaG9yQTpzLnBpdm90QSxsb2NhbEFuY2hvckI6cy5waXZvdEJ9KTticmVhaztjYXNlIGUuUGh5c2ljc0pvaW50LkxvY2tKb2ludDpuPW5ldyBDQU5OT04uTG9ja0NvbnN0cmFpbnQoaSxyLHMpO2JyZWFrO2Nhc2UgZS5QaHlzaWNzSm9pbnQuUG9pbnRUb1BvaW50Sm9pbnQ6Y2FzZSBlLlBoeXNpY3NKb2ludC5CYWxsQW5kU29ja2V0Sm9pbnQ6ZGVmYXVsdDpuPW5ldyBDQU5OT04uUG9pbnRUb1BvaW50Q29uc3RyYWludChpLHMucGl2b3RBLHIscy5waXZvdEEscy5tYXhGb3JjZSl9bi5jb2xsaWRlQ29ubmVjdGVkPSEhby5jb2xsaXNpb24sdC5qb2ludC5waHlzaWNzSm9pbnQ9bix0LmpvaW50LnR5cGUhPT1lLlBoeXNpY3NKb2ludC5TcHJpbmdKb2ludD90aGlzLndvcmxkLmFkZENvbnN0cmFpbnQobik6dC5tYWluSW1wb3N0b3IucmVnaXN0ZXJBZnRlclBoeXNpY3NTdGVwKGZ1bmN0aW9uKCl7bi5hcHBseUZvcmNlKCl9KX19LHQucHJvdG90eXBlLnJlbW92ZUpvaW50PWZ1bmN0aW9uKGUpe3RoaXMud29ybGQucmVtb3ZlQ29uc3RyYWludChlLmpvaW50LnBoeXNpY3NKb2ludCl9LHQucHJvdG90eXBlLl9hZGRNYXRlcmlhbD1mdW5jdGlvbihlLHQsaSl7dmFyIHIsbjtmb3Iocj0wO3I8dGhpcy5fcGh5c2ljc01hdGVyaWFscy5sZW5ndGg7cisrKWlmKG49dGhpcy5fcGh5c2ljc01hdGVyaWFsc1tyXSxuLmZyaWN0aW9uPT09dCYmbi5yZXN0aXR1dGlvbj09PWkpcmV0dXJuIG47dmFyIG89bmV3IENBTk5PTi5NYXRlcmlhbChlKTtyZXR1cm4gby5mcmljdGlvbj10LG8ucmVzdGl0dXRpb249aSx0aGlzLl9waHlzaWNzTWF0ZXJpYWxzLnB1c2gobyksb30sdC5wcm90b3R5cGUuX2NoZWNrV2l0aEVwc2lsb249ZnVuY3Rpb24odCl7cmV0dXJuIHQ8ZS5QaHlzaWNzRW5naW5lLkVwc2lsb24/ZS5QaHlzaWNzRW5naW5lLkVwc2lsb246dH0sdC5wcm90b3R5cGUuX2NyZWF0ZVNoYXBlPWZ1bmN0aW9uKHQpe3ZhciBpLHI9dC5vYmplY3Qsbj10LmdldE9iamVjdEV4dGVuZFNpemUoKTtzd2l0Y2godC50eXBlKXtjYXNlIGUuUGh5c2ljc0VuZ2luZS5TcGhlcmVJbXBvc3Rvcjp2YXIgbz1uLngscz1uLnksYT1uLno7aT1uZXcgQ0FOTk9OLlNwaGVyZShNYXRoLm1heCh0aGlzLl9jaGVja1dpdGhFcHNpbG9uKG8pLHRoaXMuX2NoZWNrV2l0aEVwc2lsb24ocyksdGhpcy5fY2hlY2tXaXRoRXBzaWxvbihhKSkvMik7YnJlYWs7Y2FzZSBlLlBoeXNpY3NJbXBvc3Rvci5DeWxpbmRlckltcG9zdG9yOmk9bmV3IENBTk5PTi5DeWxpbmRlcih0aGlzLl9jaGVja1dpdGhFcHNpbG9uKG4ueCkvMix0aGlzLl9jaGVja1dpdGhFcHNpbG9uKG4ueCkvMix0aGlzLl9jaGVja1dpdGhFcHNpbG9uKG4ueSksMTYpO2JyZWFrO2Nhc2UgZS5QaHlzaWNzSW1wb3N0b3IuQm94SW1wb3N0b3I6dmFyIGg9bi5zY2FsZSguNSk7aT1uZXcgQ0FOTk9OLkJveChuZXcgQ0FOTk9OLlZlYzModGhpcy5fY2hlY2tXaXRoRXBzaWxvbihoLngpLHRoaXMuX2NoZWNrV2l0aEVwc2lsb24oaC55KSx0aGlzLl9jaGVja1dpdGhFcHNpbG9uKGgueikpKTticmVhaztjYXNlIGUuUGh5c2ljc0ltcG9zdG9yLlBsYW5lSW1wb3N0b3I6ZS5Ub29scy5XYXJuKFwiQXR0ZW50aW9uLCBQbGFuZUltcG9zdGVyIG1pZ2h0IG5vdCBiZWhhdmUgYXMgeW91IGV4cGVjdC4gQ29uc2lkZXIgdXNpbmcgQm94SW1wb3N0ZXIgaW5zdGVhZFwiKSxpPW5ldyBDQU5OT04uUGxhbmU7YnJlYWs7Y2FzZSBlLlBoeXNpY3NJbXBvc3Rvci5NZXNoSW1wb3N0b3I6dmFyIGM9ci5nZXRWZXJ0aWNlc0RhdGE/ci5nZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuUG9zaXRpb25LaW5kKTpbXSxsPXIuZ2V0SW5kaWNlcz9yLmdldEluZGljZXMoKTpbXTtlLlRvb2xzLldhcm4oXCJNZXNoSW1wb3N0b3Igb25seSBjb2xsaWRlcyBhZ2FpbnN0IHNwaGVyZXMuXCIpLGk9bmV3IENBTk5PTi5UcmltZXNoKGMsbCk7YnJlYWs7Y2FzZSBlLlBoeXNpY3NJbXBvc3Rvci5IZWlnaHRtYXBJbXBvc3RvcjppPXRoaXMuX2NyZWF0ZUhlaWdodG1hcChyKTticmVhaztjYXNlIGUuUGh5c2ljc0ltcG9zdG9yLlBhcnRpY2xlSW1wb3N0b3I6aT1uZXcgQ0FOTk9OLlBhcnRpY2xlfXJldHVybiBpfSx0LnByb3RvdHlwZS5fY3JlYXRlSGVpZ2h0bWFwPWZ1bmN0aW9uKHQsaSl7Zm9yKHZhciByPXQuZ2V0VmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLlBvc2l0aW9uS2luZCksbj1bXSxvPWl8fH5+KE1hdGguc3FydChyLmxlbmd0aC8zKS0xKSxzPU1hdGgubWluKHQuZ2V0Qm91bmRpbmdJbmZvKCkuYm91bmRpbmdCb3guZXh0ZW5kU2l6ZS54LHQuZ2V0Qm91bmRpbmdJbmZvKCkuYm91bmRpbmdCb3guZXh0ZW5kU2l6ZS56KSxhPTIqcy9vLGg9dC5nZXRCb3VuZGluZ0luZm8oKS5ib3VuZGluZ0JveC5leHRlbmRTaXplLnksYz0wO2M8ci5sZW5ndGg7Yys9Myl7dmFyIGw9TWF0aC5yb3VuZChyW2MrMF0vYStvLzIpLHU9TWF0aC5yb3VuZCgtMSoocltjKzJdL2Etby8yKSksZj1yW2MrMV0raDtuW2xdfHwobltsXT1bXSksbltsXVt1XXx8KG5bbF1bdV09ZiksbltsXVt1XT1NYXRoLm1heChmLG5bbF1bdV0pfWZvcih2YXIgbD0wO28+PWw7KytsKXtpZighbltsXSl7Zm9yKHZhciBkPTE7IW5bKGwrZCklb107KWQrKztuW2xdPW5bKGwrZCklb10uc2xpY2UoKX1mb3IodmFyIHU9MDtvPj11OysrdSlpZighbltsXVt1XSl7Zm9yKHZhciBwLGQ9MTt2b2lkIDA9PT1wOylwPW5bbF1bKHUrZCsrKSVvXTtuW2xdW3VdPXB9fXZhciBfPW5ldyBDQU5OT04uSGVpZ2h0ZmllbGQobix7ZWxlbWVudFNpemU6YX0pO3JldHVybiBfLm1pblk9aCxffSx0LnByb3RvdHlwZS5fdXBkYXRlUGh5c2ljc0JvZHlUcmFuc2Zvcm1hdGlvbj1mdW5jdGlvbih0KXt2YXIgaT10Lm9iamVjdDtpLmNvbXB1dGVXb3JsZE1hdHJpeCYmaS5jb21wdXRlV29ybGRNYXRyaXgoITApO3ZhciByPXQuZ2V0T2JqZWN0Q2VudGVyKCk7dC5nZXRPYmplY3RFeHRlbmRTaXplKCk7dGhpcy5fdG1wRGVsdGFQb3NpdGlvbi5jb3B5RnJvbShpLnBvc2l0aW9uLnN1YnRyYWN0KHIpKSx0aGlzLl90bXBQb3NpdGlvbi5jb3B5RnJvbShyKTt2YXIgbj1pLnJvdGF0aW9uUXVhdGVybmlvbjtpZih0LnR5cGUhPT1lLlBoeXNpY3NJbXBvc3Rvci5QbGFuZUltcG9zdG9yJiZ0LnR5cGUhPT1lLlBoeXNpY3NJbXBvc3Rvci5IZWlnaHRtYXBJbXBvc3RvciYmdC50eXBlIT09ZS5QaHlzaWNzSW1wb3N0b3IuQ3lsaW5kZXJJbXBvc3Rvcnx8KG49bi5tdWx0aXBseSh0aGlzLl9taW51czkwWCksdC5zZXREZWx0YVJvdGF0aW9uKHRoaXMuX3BsdXM5MFgpKSx0LnR5cGU9PT1lLlBoeXNpY3NFbmdpbmUuSGVpZ2h0bWFwSW1wb3N0b3Ipe3ZhciBvPWkscz1vLnJvdGF0aW9uUXVhdGVybmlvbjtvLnJvdGF0aW9uUXVhdGVybmlvbj10aGlzLl90bXBVbml0eVJvdGF0aW9uLG8uY29tcHV0ZVdvcmxkTWF0cml4KCEwKTt2YXIgYT1yLmNsb25lKCksaD1vLmdldFBpdm90TWF0cml4KCl8fGUuTWF0cml4LlRyYW5zbGF0aW9uKDAsMCwwKTtvLnJvdGF0aW9uUXVhdGVybmlvbj1zO3ZhciBjPWUuTWF0cml4LlRyYW5zbGF0aW9uKG8uZ2V0Qm91bmRpbmdJbmZvKCkuYm91bmRpbmdCb3guZXh0ZW5kU2l6ZS54LDAsLW8uZ2V0Qm91bmRpbmdJbmZvKCkuYm91bmRpbmdCb3guZXh0ZW5kU2l6ZS56KTtvLnNldFBpdm90TWF0cml4KGMpLG8uY29tcHV0ZVdvcmxkTWF0cml4KCEwKTt2YXIgbD1vLmdldEJvdW5kaW5nSW5mbygpLmJvdW5kaW5nQm94LmNlbnRlci5zdWJ0cmFjdChyKS5zdWJ0cmFjdChvLnBvc2l0aW9uKS5uZWdhdGUoKTt0aGlzLl90bXBQb3NpdGlvbi5jb3B5RnJvbUZsb2F0cyhsLngsbC55LW8uZ2V0Qm91bmRpbmdJbmZvKCkuYm91bmRpbmdCb3guZXh0ZW5kU2l6ZS55LGwueiksdGhpcy5fdG1wRGVsdGFQb3NpdGlvbi5jb3B5RnJvbShvLmdldEJvdW5kaW5nSW5mbygpLmJvdW5kaW5nQm94LmNlbnRlci5zdWJ0cmFjdChhKSksdGhpcy5fdG1wRGVsdGFQb3NpdGlvbi55Kz1vLmdldEJvdW5kaW5nSW5mbygpLmJvdW5kaW5nQm94LmV4dGVuZFNpemUueSxvLnNldFBpdm90TWF0cml4KGgpLG8uY29tcHV0ZVdvcmxkTWF0cml4KCEwKX1lbHNlIHQudHlwZT09PWUuUGh5c2ljc0VuZ2luZS5NZXNoSW1wb3N0b3ImJih0aGlzLl90bXBEZWx0YVBvc2l0aW9uLmNvcHlGcm9tRmxvYXRzKDAsMCwwKSx0aGlzLl90bXBQb3NpdGlvbi5jb3B5RnJvbShpLnBvc2l0aW9uKSk7dC5zZXREZWx0YVBvc2l0aW9uKHRoaXMuX3RtcERlbHRhUG9zaXRpb24pLHQucGh5c2ljc0JvZHkucG9zaXRpb24uY29weSh0aGlzLl90bXBQb3NpdGlvbiksdC5waHlzaWNzQm9keS5xdWF0ZXJuaW9uLmNvcHkobil9LHQucHJvdG90eXBlLnNldFRyYW5zZm9ybWF0aW9uRnJvbVBoeXNpY3NCb2R5PWZ1bmN0aW9uKGUpe2Uub2JqZWN0LnBvc2l0aW9uLmNvcHlGcm9tKGUucGh5c2ljc0JvZHkucG9zaXRpb24pLGUub2JqZWN0LnJvdGF0aW9uUXVhdGVybmlvbi5jb3B5RnJvbShlLnBoeXNpY3NCb2R5LnF1YXRlcm5pb24pfSx0LnByb3RvdHlwZS5zZXRQaHlzaWNzQm9keVRyYW5zZm9ybWF0aW9uPWZ1bmN0aW9uKGUsdCxpKXtlLnBoeXNpY3NCb2R5LnBvc2l0aW9uLmNvcHkodCksZS5waHlzaWNzQm9keS5xdWF0ZXJuaW9uLmNvcHkoaSl9LHQucHJvdG90eXBlLmlzU3VwcG9ydGVkPWZ1bmN0aW9uKCl7cmV0dXJuIHZvaWQgMCE9PXdpbmRvdy5DQU5OT059LHQucHJvdG90eXBlLnNldExpbmVhclZlbG9jaXR5PWZ1bmN0aW9uKGUsdCl7ZS5waHlzaWNzQm9keS52ZWxvY2l0eS5jb3B5KHQpfSx0LnByb3RvdHlwZS5zZXRBbmd1bGFyVmVsb2NpdHk9ZnVuY3Rpb24oZSx0KXtlLnBoeXNpY3NCb2R5LmFuZ3VsYXJWZWxvY2l0eS5jb3B5KHQpfSx0LnByb3RvdHlwZS5nZXRMaW5lYXJWZWxvY2l0eT1mdW5jdGlvbih0KXt2YXIgaT10LnBoeXNpY3NCb2R5LnZlbG9jaXR5O3JldHVybiBpP25ldyBlLlZlY3RvcjMoaS54LGkueSxpLnopOm51bGx9LHQucHJvdG90eXBlLmdldEFuZ3VsYXJWZWxvY2l0eT1mdW5jdGlvbih0KXt2YXIgaT10LnBoeXNpY3NCb2R5LmFuZ3VsYXJWZWxvY2l0eTtyZXR1cm4gaT9uZXcgZS5WZWN0b3IzKGkueCxpLnksaS56KTpudWxsfSx0LnByb3RvdHlwZS5zZXRCb2R5TWFzcz1mdW5jdGlvbihlLHQpe2UucGh5c2ljc0JvZHkubWFzcz10LGUucGh5c2ljc0JvZHkudXBkYXRlTWFzc1Byb3BlcnRpZXMoKX0sdC5wcm90b3R5cGUuc2xlZXBCb2R5PWZ1bmN0aW9uKGUpe2UucGh5c2ljc0JvZHkuc2xlZXAoKX0sdC5wcm90b3R5cGUud2FrZVVwQm9keT1mdW5jdGlvbihlKXtlLnBoeXNpY3NCb2R5Lndha2VVcCgpfSx0LnByb3RvdHlwZS51cGRhdGVEaXN0YW5jZUpvaW50PWZ1bmN0aW9uKGUsdCxpKXtlLnBoeXNpY3NKb2ludC5kaXN0YW5jZT10fSx0LnByb3RvdHlwZS5lbmFibGVNb3Rvcj1mdW5jdGlvbihlLHQpe3R8fGUucGh5c2ljc0pvaW50LmVuYWJsZU1vdG9yKCl9LHQucHJvdG90eXBlLmRpc2FibGVNb3Rvcj1mdW5jdGlvbihlLHQpe3R8fGUucGh5c2ljc0pvaW50LmRpc2FibGVNb3RvcigpfSx0LnByb3RvdHlwZS5zZXRNb3Rvcj1mdW5jdGlvbihlLHQsaSxyKXtyfHwoZS5waHlzaWNzSm9pbnQuZW5hYmxlTW90b3IoKSxlLnBoeXNpY3NKb2ludC5zZXRNb3RvclNwZWVkKHQpLGkmJnRoaXMuc2V0TGltaXQoZSxpKSl9LHQucHJvdG90eXBlLnNldExpbWl0PWZ1bmN0aW9uKGUsdCxpKXtlLnBoeXNpY3NKb2ludC5tb3RvckVxdWF0aW9uLm1heEZvcmNlPXQsZS5waHlzaWNzSm9pbnQubW90b3JFcXVhdGlvbi5taW5Gb3JjZT12b2lkIDA9PT1pPy10Oml9LHQucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXt9LHR9KCk7ZS5DYW5ub25KU1BsdWdpbj10fShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCl7dGhpcy5uYW1lPVwiT2ltb0pTUGx1Z2luXCIsdGhpcy5fdG1wSW1wb3N0b3JzQXJyYXk9W10sdGhpcy5fdG1wUG9zaXRpb25WZWN0b3I9ZS5WZWN0b3IzLlplcm8oKSx0aGlzLndvcmxkPW5ldyBPSU1PLldvcmxkKDEvNjAsMix0LCEwKSx0aGlzLndvcmxkLmNsZWFyKCksdGhpcy53b3JsZC5pc05vU3RhdD0hMH1yZXR1cm4gdC5wcm90b3R5cGUuc2V0R3Jhdml0eT1mdW5jdGlvbihlKXt0aGlzLndvcmxkLmdyYXZpdHkuY29weShlKX0sdC5wcm90b3R5cGUuc2V0VGltZVN0ZXA9ZnVuY3Rpb24oZSl7dGhpcy53b3JsZC50aW1lU3RlcD1lfSx0LnByb3RvdHlwZS5leGVjdXRlU3RlcD1mdW5jdGlvbihlLHQpe3ZhciBpPXRoaXM7dC5mb3JFYWNoKGZ1bmN0aW9uKGUpe2UuYmVmb3JlU3RlcCgpfSksdGhpcy53b3JsZC5zdGVwKCksdC5mb3JFYWNoKGZ1bmN0aW9uKGUpe2UuYWZ0ZXJTdGVwKCksaS5fdG1wSW1wb3N0b3JzQXJyYXlbZS51bmlxdWVJZF09ZX0pO2Zvcih2YXIgcj10aGlzLndvcmxkLmNvbnRhY3RzO251bGwhPT1yOylpZighci50b3VjaGluZ3x8ci5ib2R5MS5zbGVlcGluZ3x8ci5ib2R5Mi5zbGVlcGluZyl7dmFyIG49dGhpcy5fdG1wSW1wb3N0b3JzQXJyYXlbK3IuYm9keTEubmFtZV0sbz10aGlzLl90bXBJbXBvc3RvcnNBcnJheVsrci5ib2R5Mi5uYW1lXTtuJiZvPyhuLm9uQ29sbGlkZSh7Ym9keTpvLnBoeXNpY3NCb2R5fSksby5vbkNvbGxpZGUoe2JvZHk6bi5waHlzaWNzQm9keX0pLHI9ci5uZXh0KTpyPXIubmV4dH1lbHNlIHI9ci5uZXh0fSx0LnByb3RvdHlwZS5hcHBseUltcHVsc2U9ZnVuY3Rpb24oZSx0LGkpe3ZhciByPWUucGh5c2ljc0JvZHkubWFzc0luZm8ubWFzcztlLnBoeXNpY3NCb2R5LmFwcGx5SW1wdWxzZShpLnNjYWxlKE9JTU8uSU5WX1NDQUxFKSx0LnNjYWxlKE9JTU8uSU5WX1NDQUxFKnIpKX0sdC5wcm90b3R5cGUuYXBwbHlGb3JjZT1mdW5jdGlvbih0LGkscil7ZS5Ub29scy5XYXJuKFwiT2ltbyBkb2Vzbid0IHN1cHBvcnQgYXBwbHlpbmcgZm9yY2UuIFVzaW5nIGltcHVsZSBpbnN0ZWFkLlwiKSx0aGlzLmFwcGx5SW1wdWxzZSh0LGkscil9LHQucHJvdG90eXBlLmdlbmVyYXRlUGh5c2ljc0JvZHk9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gaShlKXtlLmdldENoaWxkTWVzaGVzJiZlLmdldENoaWxkTWVzaGVzKCkuZm9yRWFjaChmdW5jdGlvbihlKXtlLnBoeXNpY3NJbXBvc3RvciYmKHMucHVzaChlLnBoeXNpY3NJbXBvc3RvciksZS5waHlzaWNzSW1wb3N0b3IuX2luaXQoKSl9KX1mdW5jdGlvbiByKHQpe3JldHVybiBNYXRoLm1heCh0LGUuUGh5c2ljc0VuZ2luZS5FcHNpbG9uKX12YXIgbj10aGlzO2lmKHQucGFyZW50KXJldHVybiB2b2lkKHQucGh5c2ljc0JvZHkmJih0aGlzLnJlbW92ZVBoeXNpY3NCb2R5KHQpLHQuZm9yY2VVcGRhdGUoKSkpO2lmKHQuaXNCb2R5SW5pdFJlcXVpcmVkKCkpe3ZhciBvPXtuYW1lOnQudW5pcXVlSWQsY29uZmlnOlt0LmdldFBhcmFtKFwibWFzc1wiKXx8MSx0LmdldFBhcmFtKFwiZnJpY3Rpb25cIiksdC5nZXRQYXJhbShcInJlc3RpdHV0aW9uXCIpXSxzaXplOltdLHR5cGU6W10scG9zOltdLHJvdDpbXSxtb3ZlOjAhPT10LmdldFBhcmFtKFwibWFzc1wiKSx3b3JsZDp0aGlzLndvcmxkfSxzPVt0XTtpKHQub2JqZWN0KSxzLmZvckVhY2goZnVuY3Rpb24oaSl7dmFyIHM9aS5vYmplY3Qucm90YXRpb25RdWF0ZXJuaW9uLGE9KG5ldyBPSU1PLkV1bGVyKS5zZXRGcm9tUXVhdGVybmlvbih7eDp0Lm9iamVjdC5yb3RhdGlvblF1YXRlcm5pb24ueCx5OnQub2JqZWN0LnJvdGF0aW9uUXVhdGVybmlvbi55LHo6dC5vYmplY3Qucm90YXRpb25RdWF0ZXJuaW9uLnosczp0Lm9iamVjdC5yb3RhdGlvblF1YXRlcm5pb24ud30pLGg9aS5nZXRPYmplY3RFeHRlbmRTaXplKCk7aWYoaT09PXQpe3ZhciBjPXQuZ2V0T2JqZWN0Q2VudGVyKCk7dC5vYmplY3QucG9zaXRpb24uc3VidHJhY3RUb1JlZihjLG4uX3RtcFBvc2l0aW9uVmVjdG9yKSxvLnBvcy5wdXNoKGMueCksby5wb3MucHVzaChjLnkpLG8ucG9zLnB1c2goYy56KSxvLnJvdC5wdXNoKGEueC8oT0lNTy5kZWd0b3JhZHx8T0lNTy5UT19SQUQpKSxvLnJvdC5wdXNoKGEueS8oT0lNTy5kZWd0b3JhZHx8T0lNTy5UT19SQUQpKSxvLnJvdC5wdXNoKGEuei8oT0lNTy5kZWd0b3JhZHx8T0lNTy5UT19SQUQpKX1lbHNlIG8ucG9zLnB1c2goaS5vYmplY3QucG9zaXRpb24ueCksby5wb3MucHVzaChpLm9iamVjdC5wb3NpdGlvbi55KSxvLnBvcy5wdXNoKGkub2JqZWN0LnBvc2l0aW9uLnopLG8ucm90LnB1c2goMCksby5yb3QucHVzaCgwKSxvLnJvdC5wdXNoKDApO3N3aXRjaChpLnR5cGUpe2Nhc2UgZS5QaHlzaWNzSW1wb3N0b3IuUGFydGljbGVJbXBvc3RvcjplLlRvb2xzLldhcm4oXCJObyBQYXJ0aWNsZSBzdXBwb3J0IGluIE9pbW8uanMuIHVzaW5nIFNwaGVyZUltcG9zdG9yIGluc3RlYWRcIik7Y2FzZSBlLlBoeXNpY3NJbXBvc3Rvci5TcGhlcmVJbXBvc3Rvcjp2YXIgbD1oLngsdT1oLnksZj1oLnosZD1NYXRoLm1heChyKGwpLHIodSkscihmKSkvMjtvLnR5cGUucHVzaChcInNwaGVyZVwiKSxvLnNpemUucHVzaChkKSxvLnNpemUucHVzaChkKSxvLnNpemUucHVzaChkKTticmVhaztjYXNlIGUuUGh5c2ljc0ltcG9zdG9yLkN5bGluZGVySW1wb3N0b3I6dmFyIHA9cihoLngpLzIsXz1yKGgueSk7by50eXBlLnB1c2goXCJjeWxpbmRlclwiKSxvLnNpemUucHVzaChwKSxvLnNpemUucHVzaChfKSxvLnNpemUucHVzaChfKTticmVhaztjYXNlIGUuUGh5c2ljc0ltcG9zdG9yLlBsYW5lSW1wb3N0b3I6Y2FzZSBlLlBoeXNpY3NJbXBvc3Rvci5Cb3hJbXBvc3RvcjpkZWZhdWx0OnZhciBwPXIoaC54KSxfPXIoaC55KSxtPXIoaC56KTtvLnR5cGUucHVzaChcImJveFwiKSxvLnNpemUucHVzaChwKSxvLnNpemUucHVzaChfKSxvLnNpemUucHVzaChtKX1pLm9iamVjdC5yb3RhdGlvblF1YXRlcm5pb249c30pLHQucGh5c2ljc0JvZHk9bmV3IE9JTU8uQm9keShvKS5ib2R5fWVsc2UgdGhpcy5fdG1wUG9zaXRpb25WZWN0b3IuY29weUZyb21GbG9hdHMoMCwwLDApO3Quc2V0RGVsdGFQb3NpdGlvbih0aGlzLl90bXBQb3NpdGlvblZlY3Rvcil9LHQucHJvdG90eXBlLnJlbW92ZVBoeXNpY3NCb2R5PWZ1bmN0aW9uKGUpe3RoaXMud29ybGQucmVtb3ZlUmlnaWRCb2R5KGUucGh5c2ljc0JvZHkpfSx0LnByb3RvdHlwZS5nZW5lcmF0ZUpvaW50PWZ1bmN0aW9uKHQpe3ZhciBpPXQubWFpbkltcG9zdG9yLnBoeXNpY3NCb2R5LHI9dC5jb25uZWN0ZWRJbXBvc3Rvci5waHlzaWNzQm9keTtpZihpJiZyKXt2YXIgbixvPXQuam9pbnQuam9pbnREYXRhLHM9by5uYXRpdmVQYXJhbXN8fHt9LGE9e2JvZHkxOmksYm9keTI6cixheGUxOnMuYXhlMXx8KG8ubWFpbkF4aXM/by5tYWluQXhpcy5hc0FycmF5KCk6bnVsbCksYXhlMjpzLmF4ZTJ8fChvLmNvbm5lY3RlZEF4aXM/by5jb25uZWN0ZWRBeGlzLmFzQXJyYXkoKTpudWxsKSxwb3MxOnMucG9zMXx8KG8ubWFpblBpdm90P28ubWFpblBpdm90LmFzQXJyYXkoKTpudWxsKSxwb3MyOnMucG9zMnx8KG8uY29ubmVjdGVkUGl2b3Q/by5jb25uZWN0ZWRQaXZvdC5hc0FycmF5KCk6bnVsbCksbWluOnMubWluLG1heDpzLm1heCxjb2xsaXNpb246cy5jb2xsaXNpb258fG8uY29sbGlzaW9uLHNwcmluZzpzLnNwcmluZyx3b3JsZDp0aGlzLndvcmxkfTtzd2l0Y2godC5qb2ludC50eXBlKXtjYXNlIGUuUGh5c2ljc0pvaW50LkJhbGxBbmRTb2NrZXRKb2ludDpuPVwiam9pbnRCYWxsXCI7YnJlYWs7Y2FzZSBlLlBoeXNpY3NKb2ludC5TcHJpbmdKb2ludDplLlRvb2xzLldhcm4oXCJPaW1vLmpzIGRvZXNuJ3Qgc3VwcG9ydCBTcHJpbmcgQ29uc3RyYWludC4gU2ltdWxhdGluZyB1c2luZyBEaXN0YW5jZUpvaW50IGluc3RlYWRcIik7dmFyIGg9bzthLm1pbj1oLmxlbmd0aHx8YS5taW4sYS5tYXg9TWF0aC5tYXgoYS5taW4sYS5tYXgpO2Nhc2UgZS5QaHlzaWNzSm9pbnQuRGlzdGFuY2VKb2ludDpuPVwiam9pbnREaXN0YW5jZVwiLGEubWF4PW8ubWF4RGlzdGFuY2U7YnJlYWs7Y2FzZSBlLlBoeXNpY3NKb2ludC5QcmlzbWF0aWNKb2ludDpuPVwiam9pbnRQcmlzbWVcIjticmVhaztjYXNlIGUuUGh5c2ljc0pvaW50LlNsaWRlckpvaW50Om49XCJqb2ludFNsaWRlXCI7YnJlYWs7Y2FzZSBlLlBoeXNpY3NKb2ludC5XaGVlbEpvaW50Om49XCJqb2ludFdoZWVsXCI7YnJlYWs7Y2FzZSBlLlBoeXNpY3NKb2ludC5IaW5nZUpvaW50OmRlZmF1bHQ6bj1cImpvaW50SGluZ2VcIn1hLnR5cGU9bix0LmpvaW50LnBoeXNpY3NKb2ludD1uZXcgT0lNTy5MaW5rKGEpLmpvaW50fX0sdC5wcm90b3R5cGUucmVtb3ZlSm9pbnQ9ZnVuY3Rpb24odCl7dHJ5e3RoaXMud29ybGQucmVtb3ZlSm9pbnQodC5qb2ludC5waHlzaWNzSm9pbnQpfWNhdGNoKGkpe2UuVG9vbHMuV2FybihpKX19LHQucHJvdG90eXBlLmlzU3VwcG9ydGVkPWZ1bmN0aW9uKCl7cmV0dXJuIHZvaWQgMCE9PU9JTU99LHQucHJvdG90eXBlLnNldFRyYW5zZm9ybWF0aW9uRnJvbVBoeXNpY3NCb2R5PWZ1bmN0aW9uKGUpe2lmKCFlLnBoeXNpY3NCb2R5LnNsZWVwaW5nKXtpZihlLnBoeXNpY3NCb2R5LnNoYXBlcy5uZXh0KXt2YXIgdD10aGlzLl9nZXRMYXN0U2hhcGUoZS5waHlzaWNzQm9keSk7ZS5vYmplY3QucG9zaXRpb24ueD10LnBvc2l0aW9uLngqT0lNTy5XT1JMRF9TQ0FMRSxlLm9iamVjdC5wb3NpdGlvbi55PXQucG9zaXRpb24ueSpPSU1PLldPUkxEX1NDQUxFLGUub2JqZWN0LnBvc2l0aW9uLno9dC5wb3NpdGlvbi56Kk9JTU8uV09STERfU0NBTEV9ZWxzZSBlLm9iamVjdC5wb3NpdGlvbi5jb3B5RnJvbShlLnBoeXNpY3NCb2R5LmdldFBvc2l0aW9uKCkpO2Uub2JqZWN0LnJvdGF0aW9uUXVhdGVybmlvbi5jb3B5RnJvbShlLnBoeXNpY3NCb2R5LmdldFF1YXRlcm5pb24oKSksZS5vYmplY3Qucm90YXRpb25RdWF0ZXJuaW9uLm5vcm1hbGl6ZSgpfX0sdC5wcm90b3R5cGUuc2V0UGh5c2ljc0JvZHlUcmFuc2Zvcm1hdGlvbj1mdW5jdGlvbihlLHQsaSl7dmFyIHI9ZS5waHlzaWNzQm9keTtyLnBvc2l0aW9uLmluaXQodC54Kk9JTU8uSU5WX1NDQUxFLHQueSpPSU1PLklOVl9TQ0FMRSx0LnoqT0lNTy5JTlZfU0NBTEUpLHIub3JpZW50YXRpb24uaW5pdChpLncsaS54LGkueSxpLnopLHIuc3luY1NoYXBlcygpLHIuYXdha2UoKX0sdC5wcm90b3R5cGUuX2dldExhc3RTaGFwZT1mdW5jdGlvbihlKXtmb3IodmFyIHQ9ZS5zaGFwZXM7dC5uZXh0Oyl0PXQubmV4dDtyZXR1cm4gdH0sdC5wcm90b3R5cGUuc2V0TGluZWFyVmVsb2NpdHk9ZnVuY3Rpb24oZSx0KXtlLnBoeXNpY3NCb2R5LmxpbmVhclZlbG9jaXR5LmluaXQodC54LHQueSx0LnopfSx0LnByb3RvdHlwZS5zZXRBbmd1bGFyVmVsb2NpdHk9ZnVuY3Rpb24oZSx0KXtlLnBoeXNpY3NCb2R5LmFuZ3VsYXJWZWxvY2l0eS5pbml0KHQueCx0LnksdC56KX0sdC5wcm90b3R5cGUuZ2V0TGluZWFyVmVsb2NpdHk9ZnVuY3Rpb24odCl7dmFyIGk9dC5waHlzaWNzQm9keS5saW5lYXJWZWxvY2l0eTtyZXR1cm4gaT9uZXcgZS5WZWN0b3IzKGkueCxpLnksaS56KTpudWxsfSx0LnByb3RvdHlwZS5nZXRBbmd1bGFyVmVsb2NpdHk9ZnVuY3Rpb24odCl7dmFyIGk9dC5waHlzaWNzQm9keS5hbmd1bGFyVmVsb2NpdHk7cmV0dXJuIGk/bmV3IGUuVmVjdG9yMyhpLngsaS55LGkueik6bnVsbH0sdC5wcm90b3R5cGUuc2V0Qm9keU1hc3M9ZnVuY3Rpb24oZSx0KXt2YXIgaT0wPT09dDtlLnBoeXNpY3NCb2R5LnNoYXBlcy5kZW5zaXR5PWk/MTp0LGUucGh5c2ljc0JvZHkuc2V0dXBNYXNzKGk/MjoxKX0sdC5wcm90b3R5cGUuc2xlZXBCb2R5PWZ1bmN0aW9uKGUpe2UucGh5c2ljc0JvZHkuc2xlZXAoKX0sdC5wcm90b3R5cGUud2FrZVVwQm9keT1mdW5jdGlvbihlKXtlLnBoeXNpY3NCb2R5LmF3YWtlKCl9LHQucHJvdG90eXBlLnVwZGF0ZURpc3RhbmNlSm9pbnQ9ZnVuY3Rpb24oZSx0LGkpe2UucGh5c2ljc0pvaW50LmxpbWl0TW90b2UudXBwZXJMaW1pdD10LHZvaWQgMCE9PWkmJihlLnBoeXNpY3NKb2ludC5saW1pdE1vdG9lLmxvd2VyTGltaXQ9aSl9LHQucHJvdG90eXBlLnNldE1vdG9yPWZ1bmN0aW9uKGUsdCxpLHIpe3ZhciBuPXI/ZS5waHlzaWNzSm9pbnQucm90YXRpb25hbExpbWl0TW90b3IyOmUucGh5c2ljc0pvaW50LnJvdGF0aW9uYWxMaW1pdE1vdG9yMXx8ZS5waHlzaWNzSm9pbnQucm90YXRpb25hbExpbWl0TW90b3J8fGUucGh5c2ljc0pvaW50LmxpbWl0TW90b3I7biYmbi5zZXRNb3Rvcih0LGkpfSx0LnByb3RvdHlwZS5zZXRMaW1pdD1mdW5jdGlvbihlLHQsaSxyKXt2YXIgbj1yP2UucGh5c2ljc0pvaW50LnJvdGF0aW9uYWxMaW1pdE1vdG9yMjplLnBoeXNpY3NKb2ludC5yb3RhdGlvbmFsTGltaXRNb3RvcjF8fGUucGh5c2ljc0pvaW50LnJvdGF0aW9uYWxMaW1pdE1vdG9yfHxlLnBoeXNpY3NKb2ludC5saW1pdE1vdG9yO24mJm4uc2V0TGltaXQodCx2b2lkIDA9PT1pPy10OmkpfSx0LnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7dGhpcy53b3JsZC5jbGVhcigpfSx0fSgpO2UuT2ltb0pTUGx1Z2luPXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQodCxpLHIsbixvLHMpe2UuY2FsbCh0aGlzLHQsXCJkaXNwbGF5UGFzc1wiLFtcInBhc3NTYW1wbGVyXCJdLFtcInBhc3NTYW1wbGVyXCJdLGkscixuLG8scyl9cmV0dXJuIF9fZXh0ZW5kcyh0LGUpLHR9KGUuUG9zdFByb2Nlc3MpO2UuRGlzcGxheVBhc3NQb3N0UHJvY2Vzcz10fShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSx0LGkpe3RoaXMucXVhbGl0eT1lLHRoaXMuZGlzdGFuY2U9dCx0aGlzLm9wdGltaXplTWVzaD1pfXJldHVybiBlfSgpO2UuU2ltcGxpZmljYXRpb25TZXR0aW5ncz10O3ZhciBpPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCgpe3RoaXMucnVubmluZz0hMSx0aGlzLl9zaW1wbGlmaWNhdGlvbkFycmF5PVtdfXJldHVybiB0LnByb3RvdHlwZS5hZGRUYXNrPWZ1bmN0aW9uKGUpe3RoaXMuX3NpbXBsaWZpY2F0aW9uQXJyYXkucHVzaChlKX0sdC5wcm90b3R5cGUuZXhlY3V0ZU5leHQ9ZnVuY3Rpb24oKXt2YXIgZT10aGlzLl9zaW1wbGlmaWNhdGlvbkFycmF5LnBvcCgpO2U/KHRoaXMucnVubmluZz0hMCx0aGlzLnJ1blNpbXBsaWZpY2F0aW9uKGUpKTp0aGlzLnJ1bm5pbmc9ITF9LHQucHJvdG90eXBlLnJ1blNpbXBsaWZpY2F0aW9uPWZ1bmN0aW9uKHQpe3ZhciBpPXRoaXM7aWYodC5wYXJhbGxlbFByb2Nlc3NpbmcpdC5zZXR0aW5ncy5mb3JFYWNoKGZ1bmN0aW9uKGUpe3ZhciByPWkuZ2V0U2ltcGxpZmllcih0KTtyLnNpbXBsaWZ5KGUsZnVuY3Rpb24ocil7dC5tZXNoLmFkZExPRExldmVsKGUuZGlzdGFuY2Usciksci5pc1Zpc2libGU9ITAsZS5xdWFsaXR5PT09dC5zZXR0aW5nc1t0LnNldHRpbmdzLmxlbmd0aC0xXS5xdWFsaXR5JiZ0LnN1Y2Nlc3NDYWxsYmFjayYmdC5zdWNjZXNzQ2FsbGJhY2soKSxpLmV4ZWN1dGVOZXh0KCl9KX0pO2Vsc2V7dmFyIHI9dGhpcy5nZXRTaW1wbGlmaWVyKHQpLG49ZnVuY3Rpb24oZSxpKXtyLnNpbXBsaWZ5KGUsZnVuY3Rpb24ocil7dC5tZXNoLmFkZExPRExldmVsKGUuZGlzdGFuY2Usciksci5pc1Zpc2libGU9ITAsaSgpfSl9O2UuQXN5bmNMb29wLlJ1bih0LnNldHRpbmdzLmxlbmd0aCxmdW5jdGlvbihlKXtuKHQuc2V0dGluZ3NbZS5pbmRleF0sZnVuY3Rpb24oKXtlLmV4ZWN1dGVOZXh0KCl9KX0sZnVuY3Rpb24oKXt0LnN1Y2Nlc3NDYWxsYmFjayYmdC5zdWNjZXNzQ2FsbGJhY2soKSxpLmV4ZWN1dGVOZXh0KCl9KX19LHQucHJvdG90eXBlLmdldFNpbXBsaWZpZXI9ZnVuY3Rpb24oZSl7c3dpdGNoKGUuc2ltcGxpZmljYXRpb25UeXBlKXtjYXNlIHIuUVVBRFJBVElDOmRlZmF1bHQ6cmV0dXJuIG5ldyBoKGUubWVzaCl9fSx0fSgpO2UuU2ltcGxpZmljYXRpb25RdWV1ZT1pLGZ1bmN0aW9uKGUpe2VbZS5RVUFEUkFUSUM9MF09XCJRVUFEUkFUSUNcIn0oZS5TaW1wbGlmaWNhdGlvblR5cGV8fChlLlNpbXBsaWZpY2F0aW9uVHlwZT17fSkpO3ZhciByPWUuU2ltcGxpZmljYXRpb25UeXBlLG49ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUpe3RoaXMudmVydGljZXM9ZSx0aGlzLmVycm9yPW5ldyBBcnJheSg0KSx0aGlzLmRlbGV0ZWQ9ITEsdGhpcy5pc0RpcnR5PSExLHRoaXMuZGVsZXRlUGVuZGluZz0hMSx0aGlzLmJvcmRlckZhY3Rvcj0wfXJldHVybiBlfSgpO2UuRGVjaW1hdGlvblRyaWFuZ2xlPW47dmFyIG89ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUsdCl7dGhpcy5wb3NpdGlvbj1lLHRoaXMuaWQ9dCx0aGlzLmlzQm9yZGVyPSEwLHRoaXMucT1uZXcgcyx0aGlzLnRyaWFuZ2xlQ291bnQ9MCx0aGlzLnRyaWFuZ2xlU3RhcnQ9MCx0aGlzLm9yaWdpbmFsT2Zmc2V0cz1bXX1yZXR1cm4gZS5wcm90b3R5cGUudXBkYXRlUG9zaXRpb249ZnVuY3Rpb24oZSl7dGhpcy5wb3NpdGlvbi5jb3B5RnJvbShlKX0sZX0oKTtlLkRlY2ltYXRpb25WZXJ0ZXg9bzt2YXIgcz1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSl7dGhpcy5kYXRhPW5ldyBBcnJheSgxMCk7Zm9yKHZhciB0PTA7MTA+dDsrK3QpZSYmZVt0XT90aGlzLmRhdGFbdF09ZVt0XTp0aGlzLmRhdGFbdF09MH1yZXR1cm4gZS5wcm90b3R5cGUuZGV0PWZ1bmN0aW9uKGUsdCxpLHIsbixvLHMsYSxoKXt2YXIgYz10aGlzLmRhdGFbZV0qdGhpcy5kYXRhW25dKnRoaXMuZGF0YVtoXSt0aGlzLmRhdGFbaV0qdGhpcy5kYXRhW3JdKnRoaXMuZGF0YVthXSt0aGlzLmRhdGFbdF0qdGhpcy5kYXRhW29dKnRoaXMuZGF0YVtzXS10aGlzLmRhdGFbaV0qdGhpcy5kYXRhW25dKnRoaXMuZGF0YVtzXS10aGlzLmRhdGFbZV0qdGhpcy5kYXRhW29dKnRoaXMuZGF0YVthXS10aGlzLmRhdGFbdF0qdGhpcy5kYXRhW3JdKnRoaXMuZGF0YVtoXTtyZXR1cm4gY30sZS5wcm90b3R5cGUuYWRkSW5QbGFjZT1mdW5jdGlvbihlKXtmb3IodmFyIHQ9MDsxMD50OysrdCl0aGlzLmRhdGFbdF0rPWUuZGF0YVt0XX0sZS5wcm90b3R5cGUuYWRkQXJyYXlJblBsYWNlPWZ1bmN0aW9uKGUpe2Zvcih2YXIgdD0wOzEwPnQ7Kyt0KXRoaXMuZGF0YVt0XSs9ZVt0XX0sZS5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKHQpe2Zvcih2YXIgaT1uZXcgZSxyPTA7MTA+cjsrK3IpaS5kYXRhW3JdPXRoaXMuZGF0YVtyXSt0LmRhdGFbcl07cmV0dXJuIGl9LGUuRnJvbURhdGE9ZnVuY3Rpb24odCxpLHIsbil7cmV0dXJuIG5ldyBlKGUuRGF0YUZyb21OdW1iZXJzKHQsaSxyLG4pKX0sZS5EYXRhRnJvbU51bWJlcnM9ZnVuY3Rpb24oZSx0LGkscil7cmV0dXJuW2UqZSxlKnQsZSppLGUqcix0KnQsdCppLHQqcixpKmksaSpyLHIqcl19LGV9KCk7ZS5RdWFkcmF0aWNNYXRyaXg9czt2YXIgYT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSx0KXt0aGlzLnZlcnRleElkPWUsdGhpcy50cmlhbmdsZUlkPXR9cmV0dXJuIGV9KCk7ZS5SZWZlcmVuY2U9YTt2YXIgaD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCl7dGhpcy5fbWVzaD10LHRoaXMuaW5pdGlhbGl6ZWQ9ITEsdGhpcy5zeW5jSXRlcmF0aW9ucz01ZTMsdGhpcy5hZ2dyZXNzaXZlbmVzcz03LHRoaXMuZGVjaW1hdGlvbkl0ZXJhdGlvbnM9MTAwLHRoaXMuYm91bmRpbmdCb3hFcHNpbG9uPWUuRXBzaWxvbn1yZXR1cm4gdC5wcm90b3R5cGUuc2ltcGxpZnk9ZnVuY3Rpb24odCxpKXt2YXIgcj10aGlzO3RoaXMuaW5pdERlY2ltYXRlZE1lc2goKSxlLkFzeW5jTG9vcC5SdW4odGhpcy5fbWVzaC5zdWJNZXNoZXMubGVuZ3RoLGZ1bmN0aW9uKGUpe3IuaW5pdFdpdGhNZXNoKGUuaW5kZXgsZnVuY3Rpb24oKXtyLnJ1bkRlY2ltYXRpb24odCxlLmluZGV4LGZ1bmN0aW9uKCl7ZS5leGVjdXRlTmV4dCgpfSl9LHQub3B0aW1pemVNZXNoKX0sZnVuY3Rpb24oKXtzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7aShyLl9yZWNvbnN0cnVjdGVkTWVzaCl9LDApfSl9LHQucHJvdG90eXBlLmlzVHJpYW5nbGVPbkJvdW5kaW5nQm94PWZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsaT0wO3JldHVybiBlLnZlcnRpY2VzLmZvckVhY2goZnVuY3Rpb24oZSl7dmFyIHI9MCxuPWUucG9zaXRpb24sbz10Ll9tZXNoLmdldEJvdW5kaW5nSW5mbygpLmJvdW5kaW5nQm94OyhvLm1heGltdW0ueC1uLng8dC5ib3VuZGluZ0JveEVwc2lsb258fG4ueC1vLm1pbmltdW0ueD50LmJvdW5kaW5nQm94RXBzaWxvbikmJisrcixvLm1heGltdW0ueSE9PW4ueSYmbi55IT09by5taW5pbXVtLnl8fCsrcixvLm1heGltdW0ueiE9PW4ueiYmbi56IT09by5taW5pbXVtLnp8fCsrcixyPjEmJisraX0pLGk+MSYmY29uc29sZS5sb2coZSxpKSxpPjF9LHQucHJvdG90eXBlLnJ1bkRlY2ltYXRpb249ZnVuY3Rpb24odCxpLHIpe3ZhciBuPXRoaXMsbz1+fih0aGlzLnRyaWFuZ2xlcy5sZW5ndGgqdC5xdWFsaXR5KSxzPTAsYT10aGlzLnRyaWFuZ2xlcy5sZW5ndGgsaD1mdW5jdGlvbih0LGkpe3NldFRpbWVvdXQoZnVuY3Rpb24oKXt0JTU9PT0wJiZuLnVwZGF0ZU1lc2goMD09PXQpO2Zvcih2YXIgcj0wO3I8bi50cmlhbmdsZXMubGVuZ3RoOysrciluLnRyaWFuZ2xlc1tyXS5pc0RpcnR5PSExO3ZhciBoPTFlLTkqTWF0aC5wb3codCszLG4uYWdncmVzc2l2ZW5lc3MpLGM9ZnVuY3Rpb24odCl7dmFyIGk9fn4oKG4udHJpYW5nbGVzLmxlbmd0aC8yK3QpJW4udHJpYW5nbGVzLmxlbmd0aCkscj1uLnRyaWFuZ2xlc1tpXTtpZihyJiYhKHIuZXJyb3JbM10+aHx8ci5kZWxldGVkfHxyLmlzRGlydHkpKWZvcih2YXIgbz0wOzM+bzsrK28paWYoci5lcnJvcltvXTxoKXt2YXIgYT1bXSxjPVtdLGw9ci52ZXJ0aWNlc1tvXSx1PXIudmVydGljZXNbKG8rMSklM107aWYobC5pc0JvcmRlcnx8dS5pc0JvcmRlciljb250aW51ZTt2YXIgZj1lLlZlY3RvcjMuWmVybygpLGQ9ZS5WZWN0b3IzLlplcm8oKSxwPWUuVmVjdG9yMi5aZXJvKCksXz1uZXcgZS5Db2xvcjQoMCwwLDAsMSk7bi5jYWxjdWxhdGVFcnJvcihsLHUsZixkLHAsXyk7dmFyIG09W107aWYobi5pc0ZsaXBwZWQobCx1LGYsYSxyLmJvcmRlckZhY3RvcixtKSljb250aW51ZTtpZihuLmlzRmxpcHBlZCh1LGwsZixjLHIuYm9yZGVyRmFjdG9yLG0pKWNvbnRpbnVlO2lmKGEuaW5kZXhPZighMCk8MHx8Yy5pbmRleE9mKCEwKTwwKWNvbnRpbnVlO3ZhciBnPVtdO2lmKG0uZm9yRWFjaChmdW5jdGlvbihlKXstMT09PWcuaW5kZXhPZihlKSYmKGUuZGVsZXRlUGVuZGluZz0hMCxnLnB1c2goZSkpfSksZy5sZW5ndGglMiE9PTApY29udGludWU7bC5xPXUucS5hZGQobC5xKSxsLnVwZGF0ZVBvc2l0aW9uKGYpO3ZhciB2PW4ucmVmZXJlbmNlcy5sZW5ndGg7cz1uLnVwZGF0ZVRyaWFuZ2xlcyhsLGwsYSxzKSxzPW4udXBkYXRlVHJpYW5nbGVzKGwsdSxjLHMpO3ZhciB5PW4ucmVmZXJlbmNlcy5sZW5ndGgtdjtpZih5PD1sLnRyaWFuZ2xlQ291bnQpe2lmKHkpZm9yKHZhciB4PTA7eT54O3grKyluLnJlZmVyZW5jZXNbbC50cmlhbmdsZVN0YXJ0K3hdPW4ucmVmZXJlbmNlc1t2K3hdfWVsc2UgbC50cmlhbmdsZVN0YXJ0PXY7bC50cmlhbmdsZUNvdW50PXk7YnJlYWt9fTtlLkFzeW5jTG9vcC5TeW5jQXN5bmNGb3JMb29wKG4udHJpYW5nbGVzLmxlbmd0aCxuLnN5bmNJdGVyYXRpb25zLGMsaSxmdW5jdGlvbigpe3JldHVybiBvPj1hLXN9KX0sMCl9O2UuQXN5bmNMb29wLlJ1bih0aGlzLmRlY2ltYXRpb25JdGVyYXRpb25zLGZ1bmN0aW9uKGUpe28+PWEtcz9lLmJyZWFrTG9vcCgpOmgoZS5pbmRleCxmdW5jdGlvbigpe2UuZXhlY3V0ZU5leHQoKX0pfSxmdW5jdGlvbigpe3NldFRpbWVvdXQoZnVuY3Rpb24oKXtuLnJlY29uc3RydWN0TWVzaChpKSxyKCl9LDApfSl9LHQucHJvdG90eXBlLmluaXRXaXRoTWVzaD1mdW5jdGlvbih0LGkscil7dmFyIHM9dGhpczt0aGlzLnZlcnRpY2VzPVtdLHRoaXMudHJpYW5nbGVzPVtdO3ZhciBhPXRoaXMuX21lc2guZ2V0VmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLlBvc2l0aW9uS2luZCksaD10aGlzLl9tZXNoLmdldEluZGljZXMoKSxjPXRoaXMuX21lc2guc3ViTWVzaGVzW3RdLGw9ZnVuY3Rpb24oZSl7aWYocilmb3IodmFyIHQ9MDt0PHMudmVydGljZXMubGVuZ3RoOysrdClpZihzLnZlcnRpY2VzW3RdLnBvc2l0aW9uLmVxdWFscyhlKSlyZXR1cm4gcy52ZXJ0aWNlc1t0XTtyZXR1cm4gbnVsbH0sdT1bXSxmPWZ1bmN0aW9uKHQpe3ZhciBpPXQrYy52ZXJ0aWNlc1N0YXJ0LHI9ZS5WZWN0b3IzLkZyb21BcnJheShhLDMqaSksbj1sKHIpfHxuZXcgbyhyLHMudmVydGljZXMubGVuZ3RoKTtuLm9yaWdpbmFsT2Zmc2V0cy5wdXNoKGkpLG4uaWQ9PT1zLnZlcnRpY2VzLmxlbmd0aCYmcy52ZXJ0aWNlcy5wdXNoKG4pLHUucHVzaChuLmlkKX0sZD1jLnZlcnRpY2VzQ291bnQ7ZS5Bc3luY0xvb3AuU3luY0FzeW5jRm9yTG9vcChkLHRoaXMuc3luY0l0ZXJhdGlvbnMvND4+MCxmLGZ1bmN0aW9uKCl7dmFyIHQ9ZnVuY3Rpb24oZSl7dmFyIHQ9Yy5pbmRleFN0YXJ0LzMrZSxpPTMqdCxyPWhbaSswXSxvPWhbaSsxXSxhPWhbaSsyXSxsPXMudmVydGljZXNbdVtyLWMudmVydGljZXNTdGFydF1dLGY9cy52ZXJ0aWNlc1t1W28tYy52ZXJ0aWNlc1N0YXJ0XV0sZD1zLnZlcnRpY2VzW3VbYS1jLnZlcnRpY2VzU3RhcnRdXSxwPW5ldyBuKFtsLGYsZF0pO3Aub3JpZ2luYWxPZmZzZXQ9aSxzLnRyaWFuZ2xlcy5wdXNoKHApfTtlLkFzeW5jTG9vcC5TeW5jQXN5bmNGb3JMb29wKGMuaW5kZXhDb3VudC8zLHMuc3luY0l0ZXJhdGlvbnMsdCxmdW5jdGlvbigpe3MuaW5pdChpKX0pfSl9LHQucHJvdG90eXBlLmluaXQ9ZnVuY3Rpb24odCl7dmFyIGk9dGhpcyxyPWZ1bmN0aW9uKHQpe3ZhciByPWkudHJpYW5nbGVzW3RdO3Iubm9ybWFsPWUuVmVjdG9yMy5Dcm9zcyhyLnZlcnRpY2VzWzFdLnBvc2l0aW9uLnN1YnRyYWN0KHIudmVydGljZXNbMF0ucG9zaXRpb24pLHIudmVydGljZXNbMl0ucG9zaXRpb24uc3VidHJhY3Qoci52ZXJ0aWNlc1swXS5wb3NpdGlvbikpLm5vcm1hbGl6ZSgpO1xuZm9yKHZhciBuPTA7Mz5uO24rKylyLnZlcnRpY2VzW25dLnEuYWRkQXJyYXlJblBsYWNlKHMuRGF0YUZyb21OdW1iZXJzKHIubm9ybWFsLngsci5ub3JtYWwueSxyLm5vcm1hbC56LC1lLlZlY3RvcjMuRG90KHIubm9ybWFsLHIudmVydGljZXNbMF0ucG9zaXRpb24pKSl9O2UuQXN5bmNMb29wLlN5bmNBc3luY0Zvckxvb3AodGhpcy50cmlhbmdsZXMubGVuZ3RoLHRoaXMuc3luY0l0ZXJhdGlvbnMscixmdW5jdGlvbigpe3ZhciByPWZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1pLnRyaWFuZ2xlc1tlXSxyPTA7Mz5yOysrcil0LmVycm9yW3JdPWkuY2FsY3VsYXRlRXJyb3IodC52ZXJ0aWNlc1tyXSx0LnZlcnRpY2VzWyhyKzEpJTNdKTt0LmVycm9yWzNdPU1hdGgubWluKHQuZXJyb3JbMF0sdC5lcnJvclsxXSx0LmVycm9yWzJdKX07ZS5Bc3luY0xvb3AuU3luY0FzeW5jRm9yTG9vcChpLnRyaWFuZ2xlcy5sZW5ndGgsaS5zeW5jSXRlcmF0aW9ucyxyLGZ1bmN0aW9uKCl7aS5pbml0aWFsaXplZD0hMCx0KCl9KX0pfSx0LnByb3RvdHlwZS5yZWNvbnN0cnVjdE1lc2g9ZnVuY3Rpb24odCl7dmFyIGkscj1bXTtmb3IoaT0wO2k8dGhpcy52ZXJ0aWNlcy5sZW5ndGg7KytpKXRoaXMudmVydGljZXNbaV0udHJpYW5nbGVDb3VudD0wO3ZhciBuLG87Zm9yKGk9MDtpPHRoaXMudHJpYW5nbGVzLmxlbmd0aDsrK2kpaWYoIXRoaXMudHJpYW5nbGVzW2ldLmRlbGV0ZWQpe2ZvcihuPXRoaXMudHJpYW5nbGVzW2ldLG89MDszPm87KytvKW4udmVydGljZXNbb10udHJpYW5nbGVDb3VudD0xO3IucHVzaChuKX12YXIgcz10aGlzLl9yZWNvbnN0cnVjdGVkTWVzaC5nZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuUG9zaXRpb25LaW5kKXx8W10sYT10aGlzLl9yZWNvbnN0cnVjdGVkTWVzaC5nZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuTm9ybWFsS2luZCl8fFtdLGg9dGhpcy5fcmVjb25zdHJ1Y3RlZE1lc2guZ2V0VmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLlVWS2luZCl8fFtdLGM9dGhpcy5fcmVjb25zdHJ1Y3RlZE1lc2guZ2V0VmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLkNvbG9yS2luZCl8fFtdLGw9dGhpcy5fbWVzaC5nZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuTm9ybWFsS2luZCksdT10aGlzLl9tZXNoLmdldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5VVktpbmQpLGY9dGhpcy5fbWVzaC5nZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuQ29sb3JLaW5kKSxkPTA7Zm9yKGk9MDtpPHRoaXMudmVydGljZXMubGVuZ3RoOysraSl7dmFyIHA9dGhpcy52ZXJ0aWNlc1tpXTtwLmlkPWQscC50cmlhbmdsZUNvdW50JiZwLm9yaWdpbmFsT2Zmc2V0cy5mb3JFYWNoKGZ1bmN0aW9uKGUpe3MucHVzaChwLnBvc2l0aW9uLngpLHMucHVzaChwLnBvc2l0aW9uLnkpLHMucHVzaChwLnBvc2l0aW9uLnopLGEucHVzaChsWzMqZV0pLGEucHVzaChsWzMqZSsxXSksYS5wdXNoKGxbMyplKzJdKSx1JiZ1Lmxlbmd0aD8oaC5wdXNoKHVbMiplXSksaC5wdXNoKHVbMiplKzFdKSk6ZiYmZi5sZW5ndGgmJihjLnB1c2goZls0KmVdKSxjLnB1c2goZls0KmUrMV0pLGMucHVzaChmWzQqZSsyXSksYy5wdXNoKGZbNCplKzNdKSksKytkfSl9dmFyIF89dGhpcy5fcmVjb25zdHJ1Y3RlZE1lc2guZ2V0VG90YWxJbmRpY2VzKCksbT10aGlzLl9yZWNvbnN0cnVjdGVkTWVzaC5nZXRUb3RhbFZlcnRpY2VzKCksZz10aGlzLl9yZWNvbnN0cnVjdGVkTWVzaC5zdWJNZXNoZXM7dGhpcy5fcmVjb25zdHJ1Y3RlZE1lc2guc3ViTWVzaGVzPVtdO3ZhciB2PXRoaXMuX3JlY29uc3RydWN0ZWRNZXNoLmdldEluZGljZXMoKSx5PXRoaXMuX21lc2guZ2V0SW5kaWNlcygpO2ZvcihpPTA7aTxyLmxlbmd0aDsrK2kpbj1yW2ldLFswLDEsMl0uZm9yRWFjaChmdW5jdGlvbihlKXt2YXIgdD15W24ub3JpZ2luYWxPZmZzZXQrZV0saT1uLnZlcnRpY2VzW2VdLm9yaWdpbmFsT2Zmc2V0cy5pbmRleE9mKHQpOzA+aSYmKGk9MCksdi5wdXNoKG4udmVydGljZXNbZV0uaWQraSttKX0pO3RoaXMuX3JlY29uc3RydWN0ZWRNZXNoLnNldEluZGljZXModiksdGhpcy5fcmVjb25zdHJ1Y3RlZE1lc2guc2V0VmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLlBvc2l0aW9uS2luZCxzKSx0aGlzLl9yZWNvbnN0cnVjdGVkTWVzaC5zZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuTm9ybWFsS2luZCxhKSxoLmxlbmd0aD4wJiZ0aGlzLl9yZWNvbnN0cnVjdGVkTWVzaC5zZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuVVZLaW5kLGgpLGMubGVuZ3RoPjAmJnRoaXMuX3JlY29uc3RydWN0ZWRNZXNoLnNldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5Db2xvcktpbmQsYyk7dmFyIHg9dGhpcy5fbWVzaC5zdWJNZXNoZXNbdF07aWYodD4wKXt0aGlzLl9yZWNvbnN0cnVjdGVkTWVzaC5zdWJNZXNoZXM9W10sZy5mb3JFYWNoKGZ1bmN0aW9uKHQpe25ldyBlLlN1Yk1lc2godC5tYXRlcmlhbEluZGV4LHQudmVydGljZXNTdGFydCx0LnZlcnRpY2VzQ291bnQsdC5pbmRleFN0YXJ0LHQuaW5kZXhDb3VudCx0LmdldE1lc2goKSl9KTtuZXcgZS5TdWJNZXNoKHgubWF0ZXJpYWxJbmRleCxtLGQsXywzKnIubGVuZ3RoLHRoaXMuX3JlY29uc3RydWN0ZWRNZXNoKX19LHQucHJvdG90eXBlLmluaXREZWNpbWF0ZWRNZXNoPWZ1bmN0aW9uKCl7dGhpcy5fcmVjb25zdHJ1Y3RlZE1lc2g9bmV3IGUuTWVzaCh0aGlzLl9tZXNoLm5hbWUrXCJEZWNpbWF0ZWRcIix0aGlzLl9tZXNoLmdldFNjZW5lKCkpLHRoaXMuX3JlY29uc3RydWN0ZWRNZXNoLm1hdGVyaWFsPXRoaXMuX21lc2gubWF0ZXJpYWwsdGhpcy5fcmVjb25zdHJ1Y3RlZE1lc2gucGFyZW50PXRoaXMuX21lc2gucGFyZW50LHRoaXMuX3JlY29uc3RydWN0ZWRNZXNoLmlzVmlzaWJsZT0hMSx0aGlzLl9yZWNvbnN0cnVjdGVkTWVzaC5yZW5kZXJpbmdHcm91cElkPXRoaXMuX21lc2gucmVuZGVyaW5nR3JvdXBJZH0sdC5wcm90b3R5cGUuaXNGbGlwcGVkPWZ1bmN0aW9uKHQsaSxyLG4sbyxzKXtmb3IodmFyIGE9MDthPHQudHJpYW5nbGVDb3VudDsrK2Epe3ZhciBoPXRoaXMudHJpYW5nbGVzW3RoaXMucmVmZXJlbmNlc1t0LnRyaWFuZ2xlU3RhcnQrYV0udHJpYW5nbGVJZF07aWYoIWguZGVsZXRlZCl7dmFyIGM9dGhpcy5yZWZlcmVuY2VzW3QudHJpYW5nbGVTdGFydCthXS52ZXJ0ZXhJZCxsPWgudmVydGljZXNbKGMrMSklM10sdT1oLnZlcnRpY2VzWyhjKzIpJTNdO2lmKGwhPT1pJiZ1IT09aSl7dmFyIGY9bC5wb3NpdGlvbi5zdWJ0cmFjdChyKTtmPWYubm9ybWFsaXplKCk7dmFyIGQ9dS5wb3NpdGlvbi5zdWJ0cmFjdChyKTtpZihkPWQubm9ybWFsaXplKCksTWF0aC5hYnMoZS5WZWN0b3IzLkRvdChmLGQpKT4uOTk5KXJldHVybiEwO3ZhciBwPWUuVmVjdG9yMy5Dcm9zcyhmLGQpLm5vcm1hbGl6ZSgpO2lmKG5bYV09ITEsZS5WZWN0b3IzLkRvdChwLGgubm9ybWFsKTwuMilyZXR1cm4hMH1lbHNlIG5bYV09ITAscy5wdXNoKGgpfX1yZXR1cm4hMX0sdC5wcm90b3R5cGUudXBkYXRlVHJpYW5nbGVzPWZ1bmN0aW9uKGUsdCxpLHIpe2Zvcih2YXIgbj1yLG89MDtvPHQudHJpYW5nbGVDb3VudDsrK28pe3ZhciBzPXRoaXMucmVmZXJlbmNlc1t0LnRyaWFuZ2xlU3RhcnQrb10sYT10aGlzLnRyaWFuZ2xlc1tzLnRyaWFuZ2xlSWRdO2EuZGVsZXRlZHx8KGlbb10mJmEuZGVsZXRlUGVuZGluZz8oYS5kZWxldGVkPSEwLG4rKyk6KGEudmVydGljZXNbcy52ZXJ0ZXhJZF09ZSxhLmlzRGlydHk9ITAsYS5lcnJvclswXT10aGlzLmNhbGN1bGF0ZUVycm9yKGEudmVydGljZXNbMF0sYS52ZXJ0aWNlc1sxXSkrYS5ib3JkZXJGYWN0b3IvMixhLmVycm9yWzFdPXRoaXMuY2FsY3VsYXRlRXJyb3IoYS52ZXJ0aWNlc1sxXSxhLnZlcnRpY2VzWzJdKSthLmJvcmRlckZhY3Rvci8yLGEuZXJyb3JbMl09dGhpcy5jYWxjdWxhdGVFcnJvcihhLnZlcnRpY2VzWzJdLGEudmVydGljZXNbMF0pK2EuYm9yZGVyRmFjdG9yLzIsYS5lcnJvclszXT1NYXRoLm1pbihhLmVycm9yWzBdLGEuZXJyb3JbMV0sYS5lcnJvclsyXSksdGhpcy5yZWZlcmVuY2VzLnB1c2gocykpKX1yZXR1cm4gbn0sdC5wcm90b3R5cGUuaWRlbnRpZnlCb3JkZXI9ZnVuY3Rpb24oKXtmb3IodmFyIGU9MDtlPHRoaXMudmVydGljZXMubGVuZ3RoOysrZSl7dmFyIHQsaT1bXSxyPVtdLG49dGhpcy52ZXJ0aWNlc1tlXTtmb3IodD0wO3Q8bi50cmlhbmdsZUNvdW50OysrdClmb3IodmFyIG89dGhpcy50cmlhbmdsZXNbdGhpcy5yZWZlcmVuY2VzW24udHJpYW5nbGVTdGFydCt0XS50cmlhbmdsZUlkXSxzPTA7Mz5zO3MrKyl7Zm9yKHZhciBhPTAsaD1vLnZlcnRpY2VzW3NdO2E8aS5sZW5ndGgmJnJbYV0hPT1oLmlkOykrK2E7YT09PWkubGVuZ3RoPyhpLnB1c2goMSksci5wdXNoKGguaWQpKTppW2FdKyt9Zm9yKHQ9MDt0PGkubGVuZ3RoOysrdCkxPT09aVt0XT90aGlzLnZlcnRpY2VzW3JbdF1dLmlzQm9yZGVyPSEwOnRoaXMudmVydGljZXNbclt0XV0uaXNCb3JkZXI9ITF9fSx0LnByb3RvdHlwZS51cGRhdGVNZXNoPWZ1bmN0aW9uKGUpe3ZvaWQgMD09PWUmJihlPSExKTt2YXIgdDtpZighZSl7dmFyIGk9W107Zm9yKHQ9MDt0PHRoaXMudHJpYW5nbGVzLmxlbmd0aDsrK3QpdGhpcy50cmlhbmdsZXNbdF0uZGVsZXRlZHx8aS5wdXNoKHRoaXMudHJpYW5nbGVzW3RdKTt0aGlzLnRyaWFuZ2xlcz1pfWZvcih0PTA7dDx0aGlzLnZlcnRpY2VzLmxlbmd0aDsrK3QpdGhpcy52ZXJ0aWNlc1t0XS50cmlhbmdsZUNvdW50PTAsdGhpcy52ZXJ0aWNlc1t0XS50cmlhbmdsZVN0YXJ0PTA7dmFyIHIsbixvO2Zvcih0PTA7dDx0aGlzLnRyaWFuZ2xlcy5sZW5ndGg7Kyt0KWZvcihyPXRoaXMudHJpYW5nbGVzW3RdLG49MDszPm47KytuKW89ci52ZXJ0aWNlc1tuXSxvLnRyaWFuZ2xlQ291bnQrKzt2YXIgcz0wO2Zvcih0PTA7dDx0aGlzLnZlcnRpY2VzLmxlbmd0aDsrK3QpdGhpcy52ZXJ0aWNlc1t0XS50cmlhbmdsZVN0YXJ0PXMscys9dGhpcy52ZXJ0aWNlc1t0XS50cmlhbmdsZUNvdW50LHRoaXMudmVydGljZXNbdF0udHJpYW5nbGVDb3VudD0wO3ZhciBoPW5ldyBBcnJheSgzKnRoaXMudHJpYW5nbGVzLmxlbmd0aCk7Zm9yKHQ9MDt0PHRoaXMudHJpYW5nbGVzLmxlbmd0aDsrK3QpZm9yKHI9dGhpcy50cmlhbmdsZXNbdF0sbj0wOzM+bjsrK24pbz1yLnZlcnRpY2VzW25dLGhbby50cmlhbmdsZVN0YXJ0K28udHJpYW5nbGVDb3VudF09bmV3IGEobix0KSxvLnRyaWFuZ2xlQ291bnQrKzt0aGlzLnJlZmVyZW5jZXM9aCxlJiZ0aGlzLmlkZW50aWZ5Qm9yZGVyKCl9LHQucHJvdG90eXBlLnZlcnRleEVycm9yPWZ1bmN0aW9uKGUsdCl7dmFyIGk9dC54LHI9dC55LG49dC56O3JldHVybiBlLmRhdGFbMF0qaSppKzIqZS5kYXRhWzFdKmkqcisyKmUuZGF0YVsyXSppKm4rMiplLmRhdGFbM10qaStlLmRhdGFbNF0qcipyKzIqZS5kYXRhWzVdKnIqbisyKmUuZGF0YVs2XSpyK2UuZGF0YVs3XSpuKm4rMiplLmRhdGFbOF0qbitlLmRhdGFbOV19LHQucHJvdG90eXBlLmNhbGN1bGF0ZUVycm9yPWZ1bmN0aW9uKHQsaSxyLG4sbyxzKXt2YXIgYT10LnEuYWRkKGkucSksaD10LmlzQm9yZGVyJiZpLmlzQm9yZGVyLGM9MCxsPWEuZGV0KDAsMSwyLDEsNCw1LDIsNSw3KTtpZigwPT09bHx8aCl7dmFyIHU9dC5wb3NpdGlvbi5hZGQoaS5wb3NpdGlvbikuZGl2aWRlKG5ldyBlLlZlY3RvcjMoMiwyLDIpKSxmPXRoaXMudmVydGV4RXJyb3IoYSx0LnBvc2l0aW9uKSxkPXRoaXMudmVydGV4RXJyb3IoYSxpLnBvc2l0aW9uKSxwPXRoaXMudmVydGV4RXJyb3IoYSx1KTtjPU1hdGgubWluKGYsZCxwKSxjPT09Zj9yJiZyLmNvcHlGcm9tKHQucG9zaXRpb24pOmM9PT1kP3ImJnIuY29weUZyb20oaS5wb3NpdGlvbik6ciYmci5jb3B5RnJvbSh1KX1lbHNlIHJ8fChyPWUuVmVjdG9yMy5aZXJvKCkpLHIueD0tMS9sKmEuZGV0KDEsMiwzLDQsNSw2LDUsNyw4KSxyLnk9MS9sKmEuZGV0KDAsMiwzLDEsNSw2LDIsNyw4KSxyLno9LTEvbCphLmRldCgwLDEsMywxLDQsNiwyLDUsOCksYz10aGlzLnZlcnRleEVycm9yKGEscik7cmV0dXJuIGN9LHR9KCk7ZS5RdWFkcmF0aWNFcnJvclNpbXBsaWZpY2F0aW9uPWh9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PVtdLGk9ZnVuY3Rpb24oaSxyKXtpZighdFtpLmlkXSl7aWYoaSBpbnN0YW5jZW9mIGUuR2VvbWV0cnkuUHJpbWl0aXZlcy5Cb3gpci5ib3hlcy5wdXNoKGkuc2VyaWFsaXplKCkpO2Vsc2UgaWYoaSBpbnN0YW5jZW9mIGUuR2VvbWV0cnkuUHJpbWl0aXZlcy5TcGhlcmUpci5zcGhlcmVzLnB1c2goaS5zZXJpYWxpemUoKSk7ZWxzZSBpZihpIGluc3RhbmNlb2YgZS5HZW9tZXRyeS5QcmltaXRpdmVzLkN5bGluZGVyKXIuY3lsaW5kZXJzLnB1c2goaS5zZXJpYWxpemUoKSk7ZWxzZSBpZihpIGluc3RhbmNlb2YgZS5HZW9tZXRyeS5QcmltaXRpdmVzLlRvcnVzKXIudG9ydXNlcy5wdXNoKGkuc2VyaWFsaXplKCkpO2Vsc2UgaWYoaSBpbnN0YW5jZW9mIGUuR2VvbWV0cnkuUHJpbWl0aXZlcy5Hcm91bmQpci5ncm91bmRzLnB1c2goaS5zZXJpYWxpemUoKSk7ZWxzZSBpZihpIGluc3RhbmNlb2YgZS5HZW9tZXRyeS5QcmltaXRpdmVzLlBsYW5lKXIucGxhbmVzLnB1c2goaS5zZXJpYWxpemUoKSk7ZWxzZSBpZihpIGluc3RhbmNlb2YgZS5HZW9tZXRyeS5QcmltaXRpdmVzLlRvcnVzS25vdClyLnRvcnVzS25vdHMucHVzaChpLnNlcmlhbGl6ZSgpKTtlbHNle2lmKGkgaW5zdGFuY2VvZiBlLkdlb21ldHJ5LlByaW1pdGl2ZXMuX1ByaW1pdGl2ZSl0aHJvdyBuZXcgRXJyb3IoXCJVbmtub3duIHByaW1pdGl2ZSB0eXBlXCIpO3IudmVydGV4RGF0YS5wdXNoKGkuc2VyaWFsaXplVmVydGljZURhdGEoKSl9dFtpLmlkXT0hMH19LHI9ZnVuY3Rpb24odCxyKXt2YXIgbj17fTtuLm5hbWU9dC5uYW1lLG4uaWQ9dC5pZCxlLlRhZ3MuSGFzVGFncyh0KSYmKG4udGFncz1lLlRhZ3MuR2V0VGFncyh0KSksbi5wb3NpdGlvbj10LnBvc2l0aW9uLmFzQXJyYXkoKSx0LnJvdGF0aW9uUXVhdGVybmlvbj9uLnJvdGF0aW9uUXVhdGVybmlvbj10LnJvdGF0aW9uUXVhdGVybmlvbi5hc0FycmF5KCk6dC5yb3RhdGlvbiYmKG4ucm90YXRpb249dC5yb3RhdGlvbi5hc0FycmF5KCkpLG4uc2NhbGluZz10LnNjYWxpbmcuYXNBcnJheSgpLG4ubG9jYWxNYXRyaXg9dC5nZXRQaXZvdE1hdHJpeCgpLmFzQXJyYXkoKSxuLmlzRW5hYmxlZD10LmlzRW5hYmxlZCgpLG4uaXNWaXNpYmxlPXQuaXNWaXNpYmxlLG4uaW5maW5pdGVEaXN0YW5jZT10LmluZmluaXRlRGlzdGFuY2Usbi5waWNrYWJsZT10LmlzUGlja2FibGUsbi5yZWNlaXZlU2hhZG93cz10LnJlY2VpdmVTaGFkb3dzLG4uYmlsbGJvYXJkTW9kZT10LmJpbGxib2FyZE1vZGUsbi52aXNpYmlsaXR5PXQudmlzaWJpbGl0eSxuLmNoZWNrQ29sbGlzaW9ucz10LmNoZWNrQ29sbGlzaW9ucyx0LnBhcmVudCYmKG4ucGFyZW50SWQ9dC5wYXJlbnQuaWQpO3ZhciBvPXQuX2dlb21ldHJ5O2lmKG8pe3ZhciBzPW8uaWQ7bi5nZW9tZXRyeUlkPXMsdC5nZXRTY2VuZSgpLmdldEdlb21ldHJ5QnlJRChzKXx8aShvLHIuZ2VvbWV0cmllcyksbi5zdWJNZXNoZXM9W107Zm9yKHZhciBhPTA7YTx0LnN1Yk1lc2hlcy5sZW5ndGg7YSsrKXt2YXIgaD10LnN1Yk1lc2hlc1thXTtuLnN1Yk1lc2hlcy5wdXNoKHttYXRlcmlhbEluZGV4OmgubWF0ZXJpYWxJbmRleCx2ZXJ0aWNlc1N0YXJ0OmgudmVydGljZXNTdGFydCx2ZXJ0aWNlc0NvdW50OmgudmVydGljZXNDb3VudCxpbmRleFN0YXJ0OmguaW5kZXhTdGFydCxpbmRleENvdW50OmguaW5kZXhDb3VudH0pfX10Lm1hdGVyaWFsP24ubWF0ZXJpYWxJZD10Lm1hdGVyaWFsLmlkOnQubWF0ZXJpYWw9bnVsbCx0LnNrZWxldG9uJiYobi5za2VsZXRvbklkPXQuc2tlbGV0b24uaWQpLHQuZ2V0UGh5c2ljc0ltcG9zdG9yKCkmJihuLnBoeXNpY3NNYXNzPXQuZ2V0UGh5c2ljc01hc3MoKSxuLnBoeXNpY3NGcmljdGlvbj10LmdldFBoeXNpY3NGcmljdGlvbigpLG4ucGh5c2ljc1Jlc3RpdHV0aW9uPXQuZ2V0UGh5c2ljc1Jlc3RpdHV0aW9uKCksbi5waHlzaWNzSW1wb3N0b3I9dC5nZXRQaHlzaWNzSW1wb3N0b3IoKS50eXBlKSxuLmluc3RhbmNlcz1bXTtmb3IodmFyIGM9MDtjPHQuaW5zdGFuY2VzLmxlbmd0aDtjKyspe3ZhciBsPXQuaW5zdGFuY2VzW2NdLHU9e25hbWU6bC5uYW1lLHBvc2l0aW9uOmwucG9zaXRpb24uYXNBcnJheSgpLHNjYWxpbmc6bC5zY2FsaW5nLmFzQXJyYXkoKX07bC5yb3RhdGlvblF1YXRlcm5pb24/dS5yb3RhdGlvblF1YXRlcm5pb249bC5yb3RhdGlvblF1YXRlcm5pb24uYXNBcnJheSgpOmwucm90YXRpb24mJih1LnJvdGF0aW9uPWwucm90YXRpb24uYXNBcnJheSgpKSxuLmluc3RhbmNlcy5wdXNoKHUpLGUuQW5pbWF0aW9uLkFwcGVuZFNlcmlhbGl6ZWRBbmltYXRpb25zKGwsdSksdS5yYW5nZXM9bC5zZXJpYWxpemVBbmltYXRpb25SYW5nZXMoKX1yZXR1cm4gZS5BbmltYXRpb24uQXBwZW5kU2VyaWFsaXplZEFuaW1hdGlvbnModCxuKSxuLnJhbmdlcz10LnNlcmlhbGl6ZUFuaW1hdGlvblJhbmdlcygpLG4ubGF5ZXJNYXNrPXQubGF5ZXJNYXNrLHQuYWN0aW9uTWFuYWdlciYmKG4uYWN0aW9ucz10LmFjdGlvbk1hbmFnZXIuc2VyaWFsaXplKHQubmFtZSkpLG59LG49ZnVuY3Rpb24odCxuKXtpZih0LmRlbGF5TG9hZFN0YXRlPT09ZS5FbmdpbmUuREVMQVlMT0FEU1RBVEVfTE9BREVEfHx0LmRlbGF5TG9hZFN0YXRlPT09ZS5FbmdpbmUuREVMQVlMT0FEU1RBVEVfTk9ORSl7dC5tYXRlcmlhbCYmKHQubWF0ZXJpYWwgaW5zdGFuY2VvZiBlLlN0YW5kYXJkTWF0ZXJpYWw/KG4ubWF0ZXJpYWxzPW4ubWF0ZXJpYWxzfHxbXSxuLm1hdGVyaWFscy5zb21lKGZ1bmN0aW9uKGUpe3JldHVybiBlLmlkPT09dC5tYXRlcmlhbC5pZH0pfHxuLm1hdGVyaWFscy5wdXNoKHQubWF0ZXJpYWwuc2VyaWFsaXplKCkpKTp0Lm1hdGVyaWFsIGluc3RhbmNlb2YgZS5NdWx0aU1hdGVyaWFsJiYobi5tdWx0aU1hdGVyaWFscz1uLm11bHRpTWF0ZXJpYWxzfHxbXSxuLm11bHRpTWF0ZXJpYWxzLnNvbWUoZnVuY3Rpb24oZSl7cmV0dXJuIGUuaWQ9PT10Lm1hdGVyaWFsLmlkfSl8fG4ubXVsdGlNYXRlcmlhbHMucHVzaCh0Lm1hdGVyaWFsLnNlcmlhbGl6ZSgpKSkpO3ZhciBvPXQuX2dlb21ldHJ5O28mJihuLmdlb21ldHJpZXN8fChuLmdlb21ldHJpZXM9e30sbi5nZW9tZXRyaWVzLmJveGVzPVtdLG4uZ2VvbWV0cmllcy5zcGhlcmVzPVtdLG4uZ2VvbWV0cmllcy5jeWxpbmRlcnM9W10sbi5nZW9tZXRyaWVzLnRvcnVzZXM9W10sbi5nZW9tZXRyaWVzLmdyb3VuZHM9W10sbi5nZW9tZXRyaWVzLnBsYW5lcz1bXSxuLmdlb21ldHJpZXMudG9ydXNLbm90cz1bXSxuLmdlb21ldHJpZXMudmVydGV4RGF0YT1bXSksaShvLG4uZ2VvbWV0cmllcykpLHQuc2tlbGV0b24mJihuLnNrZWxldG9ucz1uLnNrZWxldG9uc3x8W10sbi5za2VsZXRvbnMucHVzaCh0LnNrZWxldG9uLnNlcmlhbGl6ZSgpKSksbi5tZXNoZXM9bi5tZXNoZXN8fFtdLG4ubWVzaGVzLnB1c2gocih0LG4pKX19LG89ZnVuY3Rpb24oKXtmdW5jdGlvbiBvKCl7fXJldHVybiBvLkNsZWFyQ2FjaGU9ZnVuY3Rpb24oKXt0PVtdfSxvLlNlcmlhbGl6ZT1mdW5jdGlvbihuKXt2YXIgbz17fTtvLnVzZURlbGF5ZWRUZXh0dXJlTG9hZGluZz1uLnVzZURlbGF5ZWRUZXh0dXJlTG9hZGluZyxvLmF1dG9DbGVhcj1uLmF1dG9DbGVhcixvLmNsZWFyQ29sb3I9bi5jbGVhckNvbG9yLmFzQXJyYXkoKSxvLmFtYmllbnRDb2xvcj1uLmFtYmllbnRDb2xvci5hc0FycmF5KCksby5ncmF2aXR5PW4uZ3Jhdml0eS5hc0FycmF5KCksby5jb2xsaXNpb25zRW5hYmxlZD1uLmNvbGxpc2lvbnNFbmFibGVkLG8ud29ya2VyQ29sbGlzaW9ucz1uLndvcmtlckNvbGxpc2lvbnMsbi5mb2dNb2RlJiYwIT09bi5mb2dNb2RlJiYoby5mb2dNb2RlPW4uZm9nTW9kZSxvLmZvZ0NvbG9yPW4uZm9nQ29sb3IuYXNBcnJheSgpLG8uZm9nU3RhcnQ9bi5mb2dTdGFydCxvLmZvZ0VuZD1uLmZvZ0VuZCxvLmZvZ0RlbnNpdHk9bi5mb2dEZW5zaXR5KSxuLmlzUGh5c2ljc0VuYWJsZWQoKSYmKG8ucGh5c2ljc0VuYWJsZWQ9ITAsby5waHlzaWNzR3Jhdml0eT1uLmdldFBoeXNpY3NFbmdpbmUoKS5ncmF2aXR5LmFzQXJyYXkoKSxvLnBoeXNpY3NFbmdpbmU9bi5nZXRQaHlzaWNzRW5naW5lKCkuZ2V0UGh5c2ljc1BsdWdpbk5hbWUoKSksby5saWdodHM9W107dmFyIHMsYTtmb3Iocz0wO3M8bi5saWdodHMubGVuZ3RoO3MrKylhPW4ubGlnaHRzW3NdLG8ubGlnaHRzLnB1c2goYS5zZXJpYWxpemUoKSk7Zm9yKG8uY2FtZXJhcz1bXSxzPTA7czxuLmNhbWVyYXMubGVuZ3RoO3MrKyl7dmFyIGg9bi5jYW1lcmFzW3NdO28uY2FtZXJhcy5wdXNoKGguc2VyaWFsaXplKCkpfW4uYWN0aXZlQ2FtZXJhJiYoby5hY3RpdmVDYW1lcmFJRD1uLmFjdGl2ZUNhbWVyYS5pZCksZS5BbmltYXRpb24uQXBwZW5kU2VyaWFsaXplZEFuaW1hdGlvbnMobixvKSxvLm1hdGVyaWFscz1bXSxvLm11bHRpTWF0ZXJpYWxzPVtdO3ZhciBjO2ZvcihzPTA7czxuLm1hdGVyaWFscy5sZW5ndGg7cysrKWM9bi5tYXRlcmlhbHNbc10sby5tYXRlcmlhbHMucHVzaChjLnNlcmlhbGl6ZSgpKTtmb3Ioby5tdWx0aU1hdGVyaWFscz1bXSxzPTA7czxuLm11bHRpTWF0ZXJpYWxzLmxlbmd0aDtzKyspe3ZhciBsPW4ubXVsdGlNYXRlcmlhbHNbc107by5tdWx0aU1hdGVyaWFscy5wdXNoKGwuc2VyaWFsaXplKCkpfWZvcihvLnNrZWxldG9ucz1bXSxzPTA7czxuLnNrZWxldG9ucy5sZW5ndGg7cysrKW8uc2tlbGV0b25zLnB1c2gobi5za2VsZXRvbnNbc10uc2VyaWFsaXplKCkpO28uZ2VvbWV0cmllcz17fSxvLmdlb21ldHJpZXMuYm94ZXM9W10sby5nZW9tZXRyaWVzLnNwaGVyZXM9W10sby5nZW9tZXRyaWVzLmN5bGluZGVycz1bXSxvLmdlb21ldHJpZXMudG9ydXNlcz1bXSxvLmdlb21ldHJpZXMuZ3JvdW5kcz1bXSxvLmdlb21ldHJpZXMucGxhbmVzPVtdLG8uZ2VvbWV0cmllcy50b3J1c0tub3RzPVtdLG8uZ2VvbWV0cmllcy52ZXJ0ZXhEYXRhPVtdLHQ9W107dmFyIHU9bi5nZXRHZW9tZXRyaWVzKCk7Zm9yKHM9MDtzPHUubGVuZ3RoO3MrKyl7dmFyIGY9dVtzXTtmLmlzUmVhZHkoKSYmaShmLG8uZ2VvbWV0cmllcyl9Zm9yKG8ubWVzaGVzPVtdLHM9MDtzPG4ubWVzaGVzLmxlbmd0aDtzKyspe3ZhciBkPW4ubWVzaGVzW3NdO2lmKGQgaW5zdGFuY2VvZiBlLk1lc2gpe3ZhciBwPWQ7cC5kZWxheUxvYWRTdGF0ZSE9PWUuRW5naW5lLkRFTEFZTE9BRFNUQVRFX0xPQURFRCYmcC5kZWxheUxvYWRTdGF0ZSE9PWUuRW5naW5lLkRFTEFZTE9BRFNUQVRFX05PTkV8fG8ubWVzaGVzLnB1c2gocihwLG8pKX19Zm9yKG8ucGFydGljbGVTeXN0ZW1zPVtdLHM9MDtzPG4ucGFydGljbGVTeXN0ZW1zLmxlbmd0aDtzKyspby5wYXJ0aWNsZVN5c3RlbXMucHVzaChuLnBhcnRpY2xlU3lzdGVtc1tzXS5zZXJpYWxpemUoKSk7Zm9yKG8ubGVuc0ZsYXJlU3lzdGVtcz1bXSxzPTA7czxuLmxlbnNGbGFyZVN5c3RlbXMubGVuZ3RoO3MrKylvLmxlbnNGbGFyZVN5c3RlbXMucHVzaChuLmxlbnNGbGFyZVN5c3RlbXNbc10uc2VyaWFsaXplKCkpO2ZvcihvLnNoYWRvd0dlbmVyYXRvcnM9W10scz0wO3M8bi5saWdodHMubGVuZ3RoO3MrKylhPW4ubGlnaHRzW3NdLGEuZ2V0U2hhZG93R2VuZXJhdG9yKCkmJm8uc2hhZG93R2VuZXJhdG9ycy5wdXNoKGEuZ2V0U2hhZG93R2VuZXJhdG9yKCkuc2VyaWFsaXplKCkpO3JldHVybiBuLmFjdGlvbk1hbmFnZXImJihvLmFjdGlvbnM9bi5hY3Rpb25NYW5hZ2VyLnNlcmlhbGl6ZShcInNjZW5lXCIpKSxvfSxvLlNlcmlhbGl6ZU1lc2g9ZnVuY3Rpb24odCxpLHIpe3ZvaWQgMD09PWkmJihpPSExKSx2b2lkIDA9PT1yJiYocj0hMSk7dmFyIG89e307aWYodD10IGluc3RhbmNlb2YgQXJyYXk/dDpbdF0saXx8cilmb3IodmFyIHM9MDtzPHQubGVuZ3RoOysrcylyJiZ0W3NdLmdldERlc2NlbmRhbnRzKCkuZm9yRWFjaChmdW5jdGlvbihpKXtpIGluc3RhbmNlb2YgZS5NZXNoJiZ0LmluZGV4T2YoaSk8MCYmdC5wdXNoKGkpfSksaSYmdFtzXS5wYXJlbnQmJnQuaW5kZXhPZih0W3NdLnBhcmVudCk8MCYmdC5wdXNoKHRbc10ucGFyZW50KTtyZXR1cm4gdC5mb3JFYWNoKGZ1bmN0aW9uKGUpe24oZSxvKX0pLG99LG99KCk7ZS5TY2VuZVNlcmlhbGl6ZXI9b30oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgRWFyY3V0OyFmdW5jdGlvbihlKXtmdW5jdGlvbiB0KGUsdCxyKXtyPXJ8fDI7dmFyIG89dCYmdC5sZW5ndGgscz1vP3RbMF0qcjplLmxlbmd0aCxhPWkoZSwwLHMsciwhMCksaD1bXTtpZighYSlyZXR1cm4gaDt2YXIgbCx1LGYsZCxwLF8sbTtpZihvJiYoYT1jKGUsdCxhLHIpKSxlLmxlbmd0aD44MCpyKXtsPWY9ZVswXSx1PWQ9ZVsxXTtmb3IodmFyIGc9cjtzPmc7Zys9cilwPWVbZ10sXz1lW2crMV0sbD5wJiYobD1wKSx1Pl8mJih1PV8pLHA+ZiYmKGY9cCksXz5kJiYoZD1fKTttPU1hdGgubWF4KGYtbCxkLXUpfXJldHVybiBuKGEsaCxyLGwsdSxtLHZvaWQgMCksaH1mdW5jdGlvbiBpKGUsdCxpLHIsbil7dmFyIG8scztpZihuPT09RChlLHQsaSxyKT4wKWZvcihvPXQ7aT5vO28rPXIpcz1DKG8sZVtvXSxlW28rMV0scyk7ZWxzZSBmb3Iobz1pLXI7bz49dDtvLT1yKXM9QyhvLGVbb10sZVtvKzFdLHMpO3JldHVybiBzJiZ4KHMscy5uZXh0KSYmKFMocykscz1zLm5leHQpLHN9ZnVuY3Rpb24gcihlLHQpe2lmKCFlKXJldHVybiBlO3R8fCh0PWUpO3ZhciBpLHI9ZTtkbyBpZihpPSExLHIuc3RlaW5lcnx8IXgocixyLm5leHQpJiYwIT09eShyLnByZXYscixyLm5leHQpKXI9ci5uZXh0O2Vsc2V7aWYoUyhyKSxyPXQ9ci5wcmV2LHI9PT1yLm5leHQpcmV0dXJuIG51bGw7aT0hMH13aGlsZShpfHxyIT09dCk7cmV0dXJuIHR9ZnVuY3Rpb24gbihlLHQsaSxjLGwsdSxmKXtpZihlKXshZiYmdSYmZChlLGMsbCx1KTtmb3IodmFyIHAsXyxtPWU7ZS5wcmV2IT09ZS5uZXh0OylpZihwPWUucHJldixfPWUubmV4dCx1P3MoZSxjLGwsdSk6byhlKSl0LnB1c2gocC5pL2kpLHQucHVzaChlLmkvaSksdC5wdXNoKF8uaS9pKSxTKGUpLGU9Xy5uZXh0LG09Xy5uZXh0O2Vsc2UgaWYoZT1fLGU9PT1tKXtmPzE9PT1mPyhlPWEoZSx0LGkpLG4oZSx0LGksYyxsLHUsMikpOjI9PT1mJiZoKGUsdCxpLGMsbCx1KTpuKHIoZSx2b2lkIDApLHQsaSxjLGwsdSwxKTticmVha319fWZ1bmN0aW9uIG8oZSl7dmFyIHQ9ZS5wcmV2LGk9ZSxyPWUubmV4dDtpZih5KHQsaSxyKT49MClyZXR1cm4hMTtmb3IodmFyIG49ZS5uZXh0Lm5leHQ7biE9PWUucHJldjspe2lmKGcodC54LHQueSxpLngsaS55LHIueCxyLnksbi54LG4ueSkmJnkobi5wcmV2LG4sbi5uZXh0KT49MClyZXR1cm4hMTtuPW4ubmV4dH1yZXR1cm4hMH1mdW5jdGlvbiBzKGUsdCxpLHIpe3ZhciBuPWUucHJldixvPWUscz1lLm5leHQ7aWYoeShuLG8scyk+PTApcmV0dXJuITE7Zm9yKHZhciBhPW4ueDxvLng/bi54PHMueD9uLng6cy54Om8ueDxzLng/by54OnMueCxoPW4ueTxvLnk/bi55PHMueT9uLnk6cy55Om8ueTxzLnk/by55OnMueSxjPW4ueD5vLng/bi54PnMueD9uLng6cy54Om8ueD5zLng/by54OnMueCxsPW4ueT5vLnk/bi55PnMueT9uLnk6cy55Om8ueT5zLnk/by55OnMueSx1PV8oYSxoLHQsaSxyKSxmPV8oYyxsLHQsaSxyKSxkPWUubmV4dFo7ZCYmZC56PD1mOyl7aWYoZCE9PWUucHJldiYmZCE9PWUubmV4dCYmZyhuLngsbi55LG8ueCxvLnkscy54LHMueSxkLngsZC55KSYmeShkLnByZXYsZCxkLm5leHQpPj0wKXJldHVybiExO2Q9ZC5uZXh0Wn1mb3IoZD1lLnByZXZaO2QmJmQuej49dTspe2lmKGQhPT1lLnByZXYmJmQhPT1lLm5leHQmJmcobi54LG4ueSxvLngsby55LHMueCxzLnksZC54LGQueSkmJnkoZC5wcmV2LGQsZC5uZXh0KT49MClyZXR1cm4hMTtkPWQucHJldlp9cmV0dXJuITB9ZnVuY3Rpb24gYShlLHQsaSl7dmFyIHI9ZTtkb3t2YXIgbj1yLnByZXYsbz1yLm5leHQubmV4dDsheChuLG8pJiZiKG4scixyLm5leHQsbykmJkEobixvKSYmQShvLG4pJiYodC5wdXNoKG4uaS9pKSx0LnB1c2goci5pL2kpLHQucHVzaChvLmkvaSksUyhyKSxTKHIubmV4dCkscj1lPW8pLHI9ci5uZXh0fXdoaWxlKHIhPT1lKTtyZXR1cm4gcn1mdW5jdGlvbiBoKGUsdCxpLG8scyxhKXt2YXIgaD1lO2Rve2Zvcih2YXIgYz1oLm5leHQubmV4dDtjIT09aC5wcmV2Oyl7aWYoaC5pIT09Yy5pJiZ2KGgsYykpe3ZhciBsPUUoaCxjKTtyZXR1cm4gaD1yKGgsaC5uZXh0KSxsPXIobCxsLm5leHQpLG4oaCx0LGksbyxzLGEsdm9pZCAwKSx2b2lkIG4obCx0LGksbyxzLGEsdm9pZCAwKX1jPWMubmV4dH1oPWgubmV4dH13aGlsZShoIT09ZSl9ZnVuY3Rpb24gYyhlLHQsbixvKXt2YXIgcyxhLGgsYyxmLGQ9W107Zm9yKHM9MCxhPXQubGVuZ3RoO2E+cztzKyspaD10W3NdKm8sYz1hLTE+cz90W3MrMV0qbzplLmxlbmd0aCxmPWkoZSxoLGMsbywhMSksZj09PWYubmV4dCYmKGYuc3RlaW5lcj0hMCksZC5wdXNoKG0oZikpO2ZvcihkLnNvcnQobCkscz0wO3M8ZC5sZW5ndGg7cysrKXUoZFtzXSxuKSxuPXIobixuLm5leHQpO3JldHVybiBufWZ1bmN0aW9uIGwoZSx0KXtyZXR1cm4gZS54LXQueH1mdW5jdGlvbiB1KGUsdCl7aWYodD1mKGUsdCkpe3ZhciBpPUUodCxlKTtyKGksaS5uZXh0KX19ZnVuY3Rpb24gZihlLHQpe3ZhciBpLHI9dCxuPWUueCxvPWUueSxzPS0oMS8wKTtkb3tpZihvPD1yLnkmJm8+PXIubmV4dC55KXt2YXIgYT1yLngrKG8tci55KSooci5uZXh0Lngtci54KS8oci5uZXh0Lnktci55KTtpZihuPj1hJiZhPnMpe2lmKHM9YSxhPT09bil7aWYobz09PXIueSlyZXR1cm4gcjtpZihvPT09ci5uZXh0LnkpcmV0dXJuIHIubmV4dH1pPXIueDxyLm5leHQueD9yOnIubmV4dH19cj1yLm5leHR9d2hpbGUociE9PXQpO2lmKCFpKXJldHVybiBudWxsO2lmKG49PT1zKXJldHVybiBpLnByZXY7dmFyIGgsYz1pLGw9aS54LHU9aS55LGY9MS8wO2ZvcihyPWkubmV4dDtyIT09Yzspbj49ci54JiZyLng+PWwmJmcodT5vP246cyxvLGwsdSx1Pm8/czpuLG8sci54LHIueSkmJihoPU1hdGguYWJzKG8tci55KS8obi1yLngpLChmPmh8fGg9PT1mJiZyLng+aS54KSYmQShyLGUpJiYoaT1yLGY9aCkpLHI9ci5uZXh0O3JldHVybiBpfWZ1bmN0aW9uIGQoZSx0LGkscil7dmFyIG49ZTtkbyBudWxsPT09bi56JiYobi56PV8obi54LG4ueSx0LGkscikpLG4ucHJldlo9bi5wcmV2LG4ubmV4dFo9bi5uZXh0LG49bi5uZXh0O3doaWxlKG4hPT1lKTtuLnByZXZaLm5leHRaPW51bGwsbi5wcmV2Wj1udWxsLHAobil9ZnVuY3Rpb24gcChlKXt2YXIgdCxpLHIsbixvLHMsYSxoLGM9MTtkb3tmb3IoaT1lLGU9bnVsbCxvPW51bGwscz0wO2k7KXtmb3IocysrLHI9aSxhPTAsdD0wO2M+dCYmKGErKyxyPXIubmV4dFoscik7dCsrKTtmb3IoaD1jO2E+MHx8aD4wJiZyOykwPT09YT8obj1yLHI9ci5uZXh0WixoLS0pOjAhPT1oJiZyP2kuejw9ci56PyhuPWksaT1pLm5leHRaLGEtLSk6KG49cixyPXIubmV4dFosaC0tKToobj1pLGk9aS5uZXh0WixhLS0pLG8/by5uZXh0Wj1uOmU9bixuLnByZXZaPW8sbz1uO2k9cn1vLm5leHRaPW51bGwsYyo9Mn13aGlsZShzPjEpO3JldHVybiBlfWZ1bmN0aW9uIF8oZSx0LGkscixuKXtyZXR1cm4gZT0zMjc2NyooZS1pKS9uLHQ9MzI3NjcqKHQtcikvbixlPTE2NzExOTM1JihlfGU8PDgpLGU9MjUyNjQ1MTM1JihlfGU8PDQpLGU9ODU4OTkzNDU5JihlfGU8PDIpLGU9MTQzMTY1NTc2NSYoZXxlPDwxKSx0PTE2NzExOTM1Jih0fHQ8PDgpLHQ9MjUyNjQ1MTM1Jih0fHQ8PDQpLHQ9ODU4OTkzNDU5Jih0fHQ8PDIpLHQ9MTQzMTY1NTc2NSYodHx0PDwxKSxlfHQ8PDF9ZnVuY3Rpb24gbShlKXt2YXIgdD1lLGk9ZTtkbyB0Lng8aS54JiYoaT10KSx0PXQubmV4dDt3aGlsZSh0IT09ZSk7cmV0dXJuIGl9ZnVuY3Rpb24gZyhlLHQsaSxyLG4sbyxzLGEpe3JldHVybihuLXMpKih0LWEpLShlLXMpKihvLWEpPj0wJiYoZS1zKSooci1hKS0oaS1zKSoodC1hKT49MCYmKGktcykqKG8tYSktKG4tcykqKHItYSk+PTB9ZnVuY3Rpb24gdihlLHQpe3JldHVybiBlLm5leHQuaSE9PXQuaSYmZS5wcmV2LmkhPT10LmkmJiFQKGUsdCkmJkEoZSx0KSYmQSh0LGUpJiZUKGUsdCl9ZnVuY3Rpb24geShlLHQsaSl7cmV0dXJuKHQueS1lLnkpKihpLngtdC54KS0odC54LWUueCkqKGkueS10LnkpfWZ1bmN0aW9uIHgoZSx0KXtyZXR1cm4gZS54PT09dC54JiZlLnk9PT10Lnl9ZnVuY3Rpb24gYihlLHQsaSxyKXtyZXR1cm4geChlLHQpJiZ4KGkscil8fHgoZSxyKSYmeChpLHQpPyEwOnkoZSx0LGkpPjAhPXkoZSx0LHIpPjAmJnkoaSxyLGUpPjAhPXkoaSxyLHQpPjB9ZnVuY3Rpb24gUChlLHQpe3ZhciBpPWU7ZG97aWYoaS5pIT09ZS5pJiZpLm5leHQuaSE9PWUuaSYmaS5pIT09dC5pJiZpLm5leHQuaSE9PXQuaSYmYihpLGkubmV4dCxlLHQpKXJldHVybiEwO2k9aS5uZXh0fXdoaWxlKGkhPT1lKTtyZXR1cm4hMX1mdW5jdGlvbiBBKGUsdCl7cmV0dXJuIHkoZS5wcmV2LGUsZS5uZXh0KTwwP3koZSx0LGUubmV4dCk+PTAmJnkoZSxlLnByZXYsdCk+PTA6eShlLHQsZS5wcmV2KTwwfHx5KGUsZS5uZXh0LHQpPDB9ZnVuY3Rpb24gVChlLHQpe3ZhciBpPWUscj0hMSxuPShlLngrdC54KS8yLG89KGUueSt0LnkpLzI7ZG8gaS55Pm8hPWkubmV4dC55Pm8mJm48KGkubmV4dC54LWkueCkqKG8taS55KS8oaS5uZXh0LnktaS55KStpLngmJihyPSFyKSxpPWkubmV4dDt3aGlsZShpIT09ZSk7cmV0dXJuIHJ9ZnVuY3Rpb24gRShlLHQpe3ZhciBpPW5ldyBNKGUuaSxlLngsZS55KSxyPW5ldyBNKHQuaSx0LngsdC55KSxuPWUubmV4dCxvPXQucHJldjtyZXR1cm4gZS5uZXh0PXQsdC5wcmV2PWUsaS5uZXh0PW4sbi5wcmV2PWksci5uZXh0PWksaS5wcmV2PXIsby5uZXh0PXIsci5wcmV2PW8scn1mdW5jdGlvbiBDKGUsdCxpLHIpe3ZhciBuPW5ldyBNKGUsdCxpKTtyZXR1cm4gcj8obi5uZXh0PXIubmV4dCxuLnByZXY9cixyLm5leHQucHJldj1uLHIubmV4dD1uKToobi5wcmV2PW4sbi5uZXh0PW4pLG59ZnVuY3Rpb24gUyhlKXtlLm5leHQucHJldj1lLnByZXYsZS5wcmV2Lm5leHQ9ZS5uZXh0LGUucHJldlomJihlLnByZXZaLm5leHRaPWUubmV4dFopLGUubmV4dFomJihlLm5leHRaLnByZXZaPWUucHJldlopfWZ1bmN0aW9uIE0oZSx0LGkpe3RoaXMuaT1lLHRoaXMueD10LHRoaXMueT1pLHRoaXMucHJldj1udWxsLHRoaXMubmV4dD1udWxsLHRoaXMuej1udWxsLHRoaXMucHJldlo9bnVsbCx0aGlzLm5leHRaPW51bGwsdGhpcy5zdGVpbmVyPSExfWZ1bmN0aW9uIEkoZSx0LGkscil7dmFyIG49dCYmdC5sZW5ndGgsbz1uP3RbMF0qaTplLmxlbmd0aCxzPU1hdGguYWJzKEQoZSwwLG8saSkpO2lmKG4pZm9yKHZhciBhPTAsaD10Lmxlbmd0aDtoPmE7YSsrKXt2YXIgYz10W2FdKmksbD1oLTE+YT90W2ErMV0qaTplLmxlbmd0aDtzLT1NYXRoLmFicyhEKGUsYyxsLGkpKX12YXIgdT0wO2ZvcihhPTA7YTxyLmxlbmd0aDthKz0zKXt2YXIgZj1yW2FdKmksZD1yW2ErMV0qaSxwPXJbYSsyXSppO3UrPU1hdGguYWJzKChlW2ZdLWVbcF0pKihlW2QrMV0tZVtmKzFdKS0oZVtmXS1lW2RdKSooZVtwKzFdLWVbZisxXSkpfXJldHVybiAwPT09cyYmMD09PXU/MDpNYXRoLmFicygodS1zKS9zKX1mdW5jdGlvbiBEKGUsdCxpLHIpe2Zvcih2YXIgbj0wLG89dCxzPWktcjtpPm87bys9ciluKz0oZVtzXS1lW29dKSooZVtvKzFdK2VbcysxXSkscz1vO3JldHVybiBufWZ1bmN0aW9uIFIoZSl7Zm9yKHZhciB0PWVbMF1bMF0ubGVuZ3RoLGk9e3ZlcnRpY2VzOltdLGhvbGVzOltdLGRpbWVuc2lvbnM6dH0scj0wLG49MDtuPGUubGVuZ3RoO24rKyl7Zm9yKHZhciBvPTA7bzxlW25dLmxlbmd0aDtvKyspZm9yKHZhciBzPTA7dD5zO3MrKylpLnZlcnRpY2VzLnB1c2goZVtuXVtvXVtzXSk7bj4wJiYocis9ZVtuLTFdLmxlbmd0aCxpLmhvbGVzLnB1c2gocikpfXJldHVybiBpfWUuZWFyY3V0PXQsZS5kZXZpYXRpb249SSxlLmZsYXR0ZW49Un0oRWFyY3V0fHwoRWFyY3V0PXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PTAsaT1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoZSx0LGkpe3RoaXMucG9zPWUsdGhpcy5ub3JtYWw9dCx0aGlzLnV2PWl9cmV0dXJuIHQucHJvdG90eXBlLmNsb25lPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyB0KHRoaXMucG9zLmNsb25lKCksdGhpcy5ub3JtYWwuY2xvbmUoKSx0aGlzLnV2LmNsb25lKCkpfSx0LnByb3RvdHlwZS5mbGlwPWZ1bmN0aW9uKCl7dGhpcy5ub3JtYWw9dGhpcy5ub3JtYWwuc2NhbGUoLTEpfSx0LnByb3RvdHlwZS5pbnRlcnBvbGF0ZT1mdW5jdGlvbihpLHIpe3JldHVybiBuZXcgdChlLlZlY3RvcjMuTGVycCh0aGlzLnBvcyxpLnBvcyxyKSxlLlZlY3RvcjMuTGVycCh0aGlzLm5vcm1hbCxpLm5vcm1hbCxyKSxlLlZlY3RvcjIuTGVycCh0aGlzLnV2LGkudXYscikpfSx0fSgpLHI9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KGUsdCl7dGhpcy5ub3JtYWw9ZSx0aGlzLnc9dH1yZXR1cm4gdC5Gcm9tUG9pbnRzPWZ1bmN0aW9uKGkscixuKXt2YXIgbz1uLnN1YnRyYWN0KGkpLHM9ci5zdWJ0cmFjdChpKTtpZigwPT09by5sZW5ndGhTcXVhcmVkKCl8fDA9PT1zLmxlbmd0aFNxdWFyZWQoKSlyZXR1cm4gbnVsbDt2YXIgYT1lLlZlY3RvcjMuTm9ybWFsaXplKGUuVmVjdG9yMy5Dcm9zcyhvLHMpKTtyZXR1cm4gbmV3IHQoYSxlLlZlY3RvcjMuRG90KGEsaSkpfSx0LnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbigpe3JldHVybiBuZXcgdCh0aGlzLm5vcm1hbC5jbG9uZSgpLHRoaXMudyl9LHQucHJvdG90eXBlLmZsaXA9ZnVuY3Rpb24oKXt0aGlzLm5vcm1hbC5zY2FsZUluUGxhY2UoLTEpLHRoaXMudz0tdGhpcy53fSx0LnByb3RvdHlwZS5zcGxpdFBvbHlnb249ZnVuY3Rpb24oaSxyLG8scyxhKXt2YXIgaCxjLGw9MCx1PTEsZj0yLGQ9MyxwPTAsXz1bXTtmb3IoaD0wO2g8aS52ZXJ0aWNlcy5sZW5ndGg7aCsrKXtjPWUuVmVjdG9yMy5Eb3QodGhpcy5ub3JtYWwsaS52ZXJ0aWNlc1toXS5wb3MpLXRoaXMudzt2YXIgbT1jPC10LkVQU0lMT04/ZjpjPnQuRVBTSUxPTj91Omw7cHw9bSxfLnB1c2gobSl9c3dpdGNoKHApe2Nhc2UgbDooZS5WZWN0b3IzLkRvdCh0aGlzLm5vcm1hbCxpLnBsYW5lLm5vcm1hbCk+MD9yOm8pLnB1c2goaSk7YnJlYWs7Y2FzZSB1OnMucHVzaChpKTticmVhaztjYXNlIGY6YS5wdXNoKGkpO2JyZWFrO2Nhc2UgZDp2YXIgZz1bXSx2PVtdO2ZvcihoPTA7aDxpLnZlcnRpY2VzLmxlbmd0aDtoKyspe3ZhciB5PShoKzEpJWkudmVydGljZXMubGVuZ3RoLHg9X1toXSxiPV9beV0sUD1pLnZlcnRpY2VzW2hdLEE9aS52ZXJ0aWNlc1t5XTtpZih4IT09ZiYmZy5wdXNoKFApLHghPT11JiZ2LnB1c2goeCE9PWY/UC5jbG9uZSgpOlApLCh4fGIpPT09ZCl7Yz0odGhpcy53LWUuVmVjdG9yMy5Eb3QodGhpcy5ub3JtYWwsUC5wb3MpKS9lLlZlY3RvcjMuRG90KHRoaXMubm9ybWFsLEEucG9zLnN1YnRyYWN0KFAucG9zKSk7dmFyIFQ9UC5pbnRlcnBvbGF0ZShBLGMpO2cucHVzaChUKSx2LnB1c2goVC5jbG9uZSgpKX19dmFyIEU7Zy5sZW5ndGg+PTMmJihFPW5ldyBuKGcsaS5zaGFyZWQpLEUucGxhbmUmJnMucHVzaChFKSksdi5sZW5ndGg+PTMmJihFPW5ldyBuKHYsaS5zaGFyZWQpLEUucGxhbmUmJmEucHVzaChFKSl9fSx0LkVQU0lMT049MWUtNSx0fSgpLG49ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUsdCl7dGhpcy52ZXJ0aWNlcz1lLHRoaXMuc2hhcmVkPXQsdGhpcy5wbGFuZT1yLkZyb21Qb2ludHMoZVswXS5wb3MsZVsxXS5wb3MsZVsyXS5wb3MpfXJldHVybiBlLnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbigpe3ZhciB0PXRoaXMudmVydGljZXMubWFwKGZ1bmN0aW9uKGUpe3JldHVybiBlLmNsb25lKCl9KTtyZXR1cm4gbmV3IGUodCx0aGlzLnNoYXJlZCl9LGUucHJvdG90eXBlLmZsaXA9ZnVuY3Rpb24oKXt0aGlzLnZlcnRpY2VzLnJldmVyc2UoKS5tYXAoZnVuY3Rpb24oZSl7ZS5mbGlwKCl9KSx0aGlzLnBsYW5lLmZsaXAoKX0sZX0oKSxvPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlKXt0aGlzLnBsYW5lPW51bGwsdGhpcy5mcm9udD1udWxsLHRoaXMuYmFjaz1udWxsLHRoaXMucG9seWdvbnM9W10sZSYmdGhpcy5idWlsZChlKX1yZXR1cm4gZS5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oKXt2YXIgdD1uZXcgZTtyZXR1cm4gdC5wbGFuZT10aGlzLnBsYW5lJiZ0aGlzLnBsYW5lLmNsb25lKCksdC5mcm9udD10aGlzLmZyb250JiZ0aGlzLmZyb250LmNsb25lKCksdC5iYWNrPXRoaXMuYmFjayYmdGhpcy5iYWNrLmNsb25lKCksdC5wb2x5Z29ucz10aGlzLnBvbHlnb25zLm1hcChmdW5jdGlvbihlKXtyZXR1cm4gZS5jbG9uZSgpfSksdH0sZS5wcm90b3R5cGUuaW52ZXJ0PWZ1bmN0aW9uKCl7Zm9yKHZhciBlPTA7ZTx0aGlzLnBvbHlnb25zLmxlbmd0aDtlKyspdGhpcy5wb2x5Z29uc1tlXS5mbGlwKCk7dGhpcy5wbGFuZSYmdGhpcy5wbGFuZS5mbGlwKCksdGhpcy5mcm9udCYmdGhpcy5mcm9udC5pbnZlcnQoKSx0aGlzLmJhY2smJnRoaXMuYmFjay5pbnZlcnQoKTt2YXIgdD10aGlzLmZyb250O3RoaXMuZnJvbnQ9dGhpcy5iYWNrLHRoaXMuYmFjaz10fSxlLnByb3RvdHlwZS5jbGlwUG9seWdvbnM9ZnVuY3Rpb24oZSl7aWYoIXRoaXMucGxhbmUpcmV0dXJuIGUuc2xpY2UoKTtmb3IodmFyIHQ9W10saT1bXSxyPTA7cjxlLmxlbmd0aDtyKyspdGhpcy5wbGFuZS5zcGxpdFBvbHlnb24oZVtyXSx0LGksdCxpKTtyZXR1cm4gdGhpcy5mcm9udCYmKHQ9dGhpcy5mcm9udC5jbGlwUG9seWdvbnModCkpLGk9dGhpcy5iYWNrP3RoaXMuYmFjay5jbGlwUG9seWdvbnMoaSk6W10sdC5jb25jYXQoaSl9LGUucHJvdG90eXBlLmNsaXBUbz1mdW5jdGlvbihlKXt0aGlzLnBvbHlnb25zPWUuY2xpcFBvbHlnb25zKHRoaXMucG9seWdvbnMpLHRoaXMuZnJvbnQmJnRoaXMuZnJvbnQuY2xpcFRvKGUpLHRoaXMuYmFjayYmdGhpcy5iYWNrLmNsaXBUbyhlKX0sZS5wcm90b3R5cGUuYWxsUG9seWdvbnM9ZnVuY3Rpb24oKXt2YXIgZT10aGlzLnBvbHlnb25zLnNsaWNlKCk7cmV0dXJuIHRoaXMuZnJvbnQmJihlPWUuY29uY2F0KHRoaXMuZnJvbnQuYWxsUG9seWdvbnMoKSkpLHRoaXMuYmFjayYmKGU9ZS5jb25jYXQodGhpcy5iYWNrLmFsbFBvbHlnb25zKCkpKSxlfSxlLnByb3RvdHlwZS5idWlsZD1mdW5jdGlvbih0KXtpZih0Lmxlbmd0aCl7dGhpcy5wbGFuZXx8KHRoaXMucGxhbmU9dFswXS5wbGFuZS5jbG9uZSgpKTtmb3IodmFyIGk9W10scj1bXSxuPTA7bjx0Lmxlbmd0aDtuKyspdGhpcy5wbGFuZS5zcGxpdFBvbHlnb24odFtuXSx0aGlzLnBvbHlnb25zLHRoaXMucG9seWdvbnMsaSxyKTtpLmxlbmd0aCYmKHRoaXMuZnJvbnR8fCh0aGlzLmZyb250PW5ldyBlKSx0aGlzLmZyb250LmJ1aWxkKGkpKSxyLmxlbmd0aCYmKHRoaXMuYmFja3x8KHRoaXMuYmFjaz1uZXcgZSksdGhpcy5iYWNrLmJ1aWxkKHIpKX19LGV9KCkscz1mdW5jdGlvbigpe2Z1bmN0aW9uIHIoKXt0aGlzLnBvbHlnb25zPW5ldyBBcnJheX1yZXR1cm4gci5Gcm9tTWVzaD1mdW5jdGlvbihvKXt2YXIgcyxhLGgsYyxsLHUsZixkLHAsXyxtLGc9bmV3IEFycmF5O2lmKCEobyBpbnN0YW5jZW9mIGUuTWVzaCkpdGhyb3dcIkJBQllMT04uQ1NHOiBXcm9uZyBNZXNoIHR5cGUsIG11c3QgYmUgQkFCWUxPTi5NZXNoXCI7by5jb21wdXRlV29ybGRNYXRyaXgoITApLGY9by5nZXRXb3JsZE1hdHJpeCgpLGQ9by5wb3NpdGlvbi5jbG9uZSgpLHA9by5yb3RhdGlvbi5jbG9uZSgpLG8ucm90YXRpb25RdWF0ZXJuaW9uJiYoXz1vLnJvdGF0aW9uUXVhdGVybmlvbi5jbG9uZSgpKSxtPW8uc2NhbGluZy5jbG9uZSgpO2Zvcih2YXIgdj1vLmdldEluZGljZXMoKSx5PW8uZ2V0VmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLlBvc2l0aW9uS2luZCkseD1vLmdldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5Ob3JtYWxLaW5kKSxiPW8uZ2V0VmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLlVWS2luZCksUD1vLnN1Yk1lc2hlcyxBPTAsVD1QLmxlbmd0aDtUPkE7QSsrKWZvcih2YXIgRT1QW0FdLmluZGV4U3RhcnQsQz1QW0FdLmluZGV4Q291bnQrUFtBXS5pbmRleFN0YXJ0O0M+RTtFKz0zKXt1PVtdO2Zvcih2YXIgUz0wOzM+UztTKyspe3ZhciBNPW5ldyBlLlZlY3RvcjMoeFszKnZbRStTXV0seFszKnZbRStTXSsxXSx4WzMqdltFK1NdKzJdKTtoPW5ldyBlLlZlY3RvcjIoYlsyKnZbRStTXV0sYlsyKnZbRStTXSsxXSk7dmFyIEk9bmV3IGUuVmVjdG9yMyh5WzMqdltFK1NdXSx5WzMqdltFK1NdKzFdLHlbMyp2W0UrU10rMl0pO2M9ZS5WZWN0b3IzLlRyYW5zZm9ybUNvb3JkaW5hdGVzKEksZiksYT1lLlZlY3RvcjMuVHJhbnNmb3JtTm9ybWFsKE0sZikscz1uZXcgaShjLGEsaCksdS5wdXNoKHMpfWw9bmV3IG4odSx7c3ViTWVzaElkOkEsbWVzaElkOnQsbWF0ZXJpYWxJbmRleDpQW0FdLm1hdGVyaWFsSW5kZXh9KSxsLnBsYW5lJiZnLnB1c2gobCl9dmFyIEQ9ci5Gcm9tUG9seWdvbnMoZyk7cmV0dXJuIEQubWF0cml4PWYsRC5wb3NpdGlvbj1kLEQucm90YXRpb249cCxELnNjYWxpbmc9bSxELnJvdGF0aW9uUXVhdGVybmlvbj1fLHQrKyxEfSxyLkZyb21Qb2x5Z29ucz1mdW5jdGlvbihlKXt2YXIgdD1uZXcgcjtyZXR1cm4gdC5wb2x5Z29ucz1lLHR9LHIucHJvdG90eXBlLmNsb25lPWZ1bmN0aW9uKCl7dmFyIGU9bmV3IHI7cmV0dXJuIGUucG9seWdvbnM9dGhpcy5wb2x5Z29ucy5tYXAoZnVuY3Rpb24oZSl7cmV0dXJuIGUuY2xvbmUoKX0pLGUuY29weVRyYW5zZm9ybUF0dHJpYnV0ZXModGhpcyksZX0sci5wcm90b3R5cGUudG9Qb2x5Z29ucz1mdW5jdGlvbigpe3JldHVybiB0aGlzLnBvbHlnb25zfSxyLnByb3RvdHlwZS51bmlvbj1mdW5jdGlvbihlKXt2YXIgdD1uZXcgbyh0aGlzLmNsb25lKCkucG9seWdvbnMpLGk9bmV3IG8oZS5jbG9uZSgpLnBvbHlnb25zKTtyZXR1cm4gdC5jbGlwVG8oaSksaS5jbGlwVG8odCksaS5pbnZlcnQoKSxpLmNsaXBUbyh0KSxpLmludmVydCgpLHQuYnVpbGQoaS5hbGxQb2x5Z29ucygpKSxyLkZyb21Qb2x5Z29ucyh0LmFsbFBvbHlnb25zKCkpLmNvcHlUcmFuc2Zvcm1BdHRyaWJ1dGVzKHRoaXMpfSxyLnByb3RvdHlwZS51bmlvbkluUGxhY2U9ZnVuY3Rpb24oZSl7dmFyIHQ9bmV3IG8odGhpcy5wb2x5Z29ucyksaT1uZXcgbyhlLnBvbHlnb25zKTt0LmNsaXBUbyhpKSxpLmNsaXBUbyh0KSxpLmludmVydCgpLGkuY2xpcFRvKHQpLGkuaW52ZXJ0KCksdC5idWlsZChpLmFsbFBvbHlnb25zKCkpLHRoaXMucG9seWdvbnM9dC5hbGxQb2x5Z29ucygpfSxyLnByb3RvdHlwZS5zdWJ0cmFjdD1mdW5jdGlvbihlKXt2YXIgdD1uZXcgbyh0aGlzLmNsb25lKCkucG9seWdvbnMpLGk9bmV3IG8oZS5jbG9uZSgpLnBvbHlnb25zKTtyZXR1cm4gdC5pbnZlcnQoKSx0LmNsaXBUbyhpKSxpLmNsaXBUbyh0KSxpLmludmVydCgpLGkuY2xpcFRvKHQpLGkuaW52ZXJ0KCksdC5idWlsZChpLmFsbFBvbHlnb25zKCkpLHQuaW52ZXJ0KCksci5Gcm9tUG9seWdvbnModC5hbGxQb2x5Z29ucygpKS5jb3B5VHJhbnNmb3JtQXR0cmlidXRlcyh0aGlzKX0sci5wcm90b3R5cGUuc3VidHJhY3RJblBsYWNlPWZ1bmN0aW9uKGUpe3ZhciB0PW5ldyBvKHRoaXMucG9seWdvbnMpLGk9bmV3IG8oZS5wb2x5Z29ucyk7dC5pbnZlcnQoKSx0LmNsaXBUbyhpKSxpLmNsaXBUbyh0KSxpLmludmVydCgpLGkuY2xpcFRvKHQpLGkuaW52ZXJ0KCksdC5idWlsZChpLmFsbFBvbHlnb25zKCkpLHQuaW52ZXJ0KCksdGhpcy5wb2x5Z29ucz10LmFsbFBvbHlnb25zKCl9LHIucHJvdG90eXBlLmludGVyc2VjdD1mdW5jdGlvbihlKXt2YXIgdD1uZXcgbyh0aGlzLmNsb25lKCkucG9seWdvbnMpLGk9bmV3IG8oZS5jbG9uZSgpLnBvbHlnb25zKTtyZXR1cm4gdC5pbnZlcnQoKSxpLmNsaXBUbyh0KSxpLmludmVydCgpLHQuY2xpcFRvKGkpLGkuY2xpcFRvKHQpLHQuYnVpbGQoaS5hbGxQb2x5Z29ucygpKSx0LmludmVydCgpLHIuRnJvbVBvbHlnb25zKHQuYWxsUG9seWdvbnMoKSkuY29weVRyYW5zZm9ybUF0dHJpYnV0ZXModGhpcyl9LHIucHJvdG90eXBlLmludGVyc2VjdEluUGxhY2U9ZnVuY3Rpb24oZSl7dmFyIHQ9bmV3IG8odGhpcy5wb2x5Z29ucyksaT1uZXcgbyhlLnBvbHlnb25zKTt0LmludmVydCgpLGkuY2xpcFRvKHQpLGkuaW52ZXJ0KCksdC5jbGlwVG8oaSksaS5jbGlwVG8odCksdC5idWlsZChpLmFsbFBvbHlnb25zKCkpLHQuaW52ZXJ0KCksdGhpcy5wb2x5Z29ucz10LmFsbFBvbHlnb25zKCl9LHIucHJvdG90eXBlLmludmVyc2U9ZnVuY3Rpb24oKXt2YXIgZT10aGlzLmNsb25lKCk7cmV0dXJuIGUuaW52ZXJzZUluUGxhY2UoKSxlfSxyLnByb3RvdHlwZS5pbnZlcnNlSW5QbGFjZT1mdW5jdGlvbigpe3RoaXMucG9seWdvbnMubWFwKGZ1bmN0aW9uKGUpe2UuZmxpcCgpfSl9LHIucHJvdG90eXBlLmNvcHlUcmFuc2Zvcm1BdHRyaWJ1dGVzPWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLm1hdHJpeD1lLm1hdHJpeCx0aGlzLnBvc2l0aW9uPWUucG9zaXRpb24sdGhpcy5yb3RhdGlvbj1lLnJvdGF0aW9uLHRoaXMuc2NhbGluZz1lLnNjYWxpbmcsdGhpcy5yb3RhdGlvblF1YXRlcm5pb249ZS5yb3RhdGlvblF1YXRlcm5pb24sdGhpc30sci5wcm90b3R5cGUuYnVpbGRNZXNoR2VvbWV0cnk9ZnVuY3Rpb24odCxpLHIpe3ZhciBuPXRoaXMubWF0cml4LmNsb25lKCk7bi5pbnZlcnQoKTt2YXIgbyxzLGEsaD1uZXcgZS5NZXNoKHQsaSksYz1bXSxsPVtdLHU9W10sZj1bXSxkPWUuVmVjdG9yMy5aZXJvKCkscD1lLlZlY3RvcjMuWmVybygpLF89ZS5WZWN0b3IyLlplcm8oKSxtPXRoaXMucG9seWdvbnMsZz1bMCwwLDBdLHY9e30seT0wLHg9e307ciYmbS5zb3J0KGZ1bmN0aW9uKGUsdCl7cmV0dXJuIGUuc2hhcmVkLm1lc2hJZD09PXQuc2hhcmVkLm1lc2hJZD9lLnNoYXJlZC5zdWJNZXNoSWQtdC5zaGFyZWQuc3ViTWVzaElkOmUuc2hhcmVkLm1lc2hJZC10LnNoYXJlZC5tZXNoSWR9KTtmb3IodmFyIGI9MCxQPW0ubGVuZ3RoO1A+YjtiKyspe289bVtiXSx4W28uc2hhcmVkLm1lc2hJZF18fCh4W28uc2hhcmVkLm1lc2hJZF09e30pLHhbby5zaGFyZWQubWVzaElkXVtvLnNoYXJlZC5zdWJNZXNoSWRdfHwoeFtvLnNoYXJlZC5tZXNoSWRdW28uc2hhcmVkLnN1Yk1lc2hJZF09e2luZGV4U3RhcnQ6KygxLzApLGluZGV4RW5kOi0oMS8wKSxtYXRlcmlhbEluZGV4Om8uc2hhcmVkLm1hdGVyaWFsSW5kZXh9KSxhPXhbby5zaGFyZWQubWVzaElkXVtvLnNoYXJlZC5zdWJNZXNoSWRdO2Zvcih2YXIgQT0yLFQ9by52ZXJ0aWNlcy5sZW5ndGg7VD5BO0ErKyl7Z1swXT0wLGdbMV09QS0xLGdbMl09QTtmb3IodmFyIEU9MDszPkU7RSsrKXtkLmNvcHlGcm9tKG8udmVydGljZXNbZ1tFXV0ucG9zKSxwLmNvcHlGcm9tKG8udmVydGljZXNbZ1tFXV0ubm9ybWFsKSxfLmNvcHlGcm9tKG8udmVydGljZXNbZ1tFXV0udXYpO3ZhciBDPWUuVmVjdG9yMy5UcmFuc2Zvcm1Db29yZGluYXRlcyhkLG4pLFM9ZS5WZWN0b3IzLlRyYW5zZm9ybU5vcm1hbChwLG4pO3M9dltDLngrXCIsXCIrQy55K1wiLFwiK0Muel0sXCJ1bmRlZmluZWRcIiE9dHlwZW9mIHMmJnVbMypzXT09PVMueCYmdVszKnMrMV09PT1TLnkmJnVbMypzKzJdPT09Uy56JiZmWzIqc109PT1fLngmJmZbMipzKzFdPT09Xy55fHwoYy5wdXNoKEMueCxDLnksQy56KSxmLnB1c2goXy54LF8ueSksdS5wdXNoKHAueCxwLnkscC56KSxzPXZbQy54K1wiLFwiK0MueStcIixcIitDLnpdPWMubGVuZ3RoLzMtMSksbC5wdXNoKHMpLGEuaW5kZXhTdGFydD1NYXRoLm1pbih5LGEuaW5kZXhTdGFydCksYS5pbmRleEVuZD1NYXRoLm1heCh5LGEuaW5kZXhFbmQpLHkrK319fWlmKGguc2V0VmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLlBvc2l0aW9uS2luZCxjKSxoLnNldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5Ob3JtYWxLaW5kLHUpLGguc2V0VmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLlVWS2luZCxmKSxoLnNldEluZGljZXMobCkscil7dmFyIE0sST0wO2guc3ViTWVzaGVzPW5ldyBBcnJheTtmb3IodmFyIEQgaW4geCl7TT0tMTtmb3IodmFyIFIgaW4geFtEXSlhPXhbRF1bUl0sZS5TdWJNZXNoLkNyZWF0ZUZyb21JbmRpY2VzKGEubWF0ZXJpYWxJbmRleCtJLGEuaW5kZXhTdGFydCxhLmluZGV4RW5kLWEuaW5kZXhTdGFydCsxLGgpLE09TWF0aC5tYXgoYS5tYXRlcmlhbEluZGV4LE0pO0krPSsrTX19cmV0dXJuIGh9LHIucHJvdG90eXBlLnRvTWVzaD1mdW5jdGlvbihlLHQsaSxyKXt2YXIgbj10aGlzLmJ1aWxkTWVzaEdlb21ldHJ5KGUsaSxyKTtyZXR1cm4gbi5tYXRlcmlhbD10LG4ucG9zaXRpb24uY29weUZyb20odGhpcy5wb3NpdGlvbiksbi5yb3RhdGlvbi5jb3B5RnJvbSh0aGlzLnJvdGF0aW9uKSx0aGlzLnJvdGF0aW9uUXVhdGVybmlvbiYmKG4ucm90YXRpb25RdWF0ZXJuaW9uPXRoaXMucm90YXRpb25RdWF0ZXJuaW9uLmNsb25lKCkpLG4uc2NhbGluZy5jb3B5RnJvbSh0aGlzLnNjYWxpbmcpLG4uY29tcHV0ZVdvcmxkTWF0cml4KCEwKSxufSxyfSgpO2UuQ1NHPXN9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGkoaSxyLG4sbyl7dmFyIHM9dGhpczt0LmNhbGwodGhpcyxpLFwidnJEaXN0b3J0aW9uQ29ycmVjdGlvblwiLFtcIkxlbnNDZW50ZXJcIixcIlNjYWxlXCIsXCJTY2FsZUluXCIsXCJIbWRXYXJwUGFyYW1cIl0sbnVsbCxvLnBvc3RQcm9jZXNzU2NhbGVGYWN0b3IscixlLlRleHR1cmUuQklMSU5FQVJfU0FNUExJTkdNT0RFLG51bGwsbnVsbCksdGhpcy5faXNSaWdodEV5ZT1uLHRoaXMuX2Rpc3RvcnRpb25GYWN0b3JzPW8uZGlzdG9ydGlvbkssdGhpcy5fcG9zdFByb2Nlc3NTY2FsZUZhY3Rvcj1vLnBvc3RQcm9jZXNzU2NhbGVGYWN0b3IsdGhpcy5fbGVuc0NlbnRlck9mZnNldD1vLmxlbnNDZW50ZXJPZmZzZXQsdGhpcy5vblNpemVDaGFuZ2VkT2JzZXJ2YWJsZS5hZGQoZnVuY3Rpb24oKXtzLmFzcGVjdFJhdGlvPS41KnMud2lkdGgvcy5oZWlnaHQscy5fc2NhbGVJbj1uZXcgZS5WZWN0b3IyKDIsMi9zLmFzcGVjdFJhdGlvKSxzLl9zY2FsZUZhY3Rvcj1uZXcgZS5WZWN0b3IyKC41KigxL3MuX3Bvc3RQcm9jZXNzU2NhbGVGYWN0b3IpLC41KigxL3MuX3Bvc3RQcm9jZXNzU2NhbGVGYWN0b3IpKnMuYXNwZWN0UmF0aW8pLHMuX2xlbnNDZW50ZXI9bmV3IGUuVmVjdG9yMihzLl9pc1JpZ2h0RXllPy41LS41KnMuX2xlbnNDZW50ZXJPZmZzZXQ6LjUrLjUqcy5fbGVuc0NlbnRlck9mZnNldCwuNSl9KSx0aGlzLm9uQXBwbHlPYnNlcnZhYmxlLmFkZChmdW5jdGlvbihlKXtlLnNldEZsb2F0MihcIkxlbnNDZW50ZXJcIixzLl9sZW5zQ2VudGVyLngscy5fbGVuc0NlbnRlci55KSxlLnNldEZsb2F0MihcIlNjYWxlXCIscy5fc2NhbGVGYWN0b3IueCxzLl9zY2FsZUZhY3Rvci55KSxlLnNldEZsb2F0MihcIlNjYWxlSW5cIixzLl9zY2FsZUluLngscy5fc2NhbGVJbi55KSxlLnNldEZsb2F0NChcIkhtZFdhcnBQYXJhbVwiLHMuX2Rpc3RvcnRpb25GYWN0b3JzWzBdLHMuX2Rpc3RvcnRpb25GYWN0b3JzWzFdLHMuX2Rpc3RvcnRpb25GYWN0b3JzWzJdLHMuX2Rpc3RvcnRpb25GYWN0b3JzWzNdKX0pfXJldHVybiBfX2V4dGVuZHMoaSx0KSxpfShlLlBvc3RQcm9jZXNzKTtlLlZSRGlzdG9ydGlvbkNvcnJlY3Rpb25Qb3N0UHJvY2Vzcz10fShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXshZnVuY3Rpb24oZSl7ZVtlLlg9MF09XCJYXCIsZVtlLlk9MV09XCJZXCIsZVtlLlo9Ml09XCJaXCJ9KGUuSm95c3RpY2tBeGlzfHwoZS5Kb3lzdGlja0F4aXM9e30pKTt2YXIgdD1lLkpveXN0aWNrQXhpcyxpPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gaShyKXt2YXIgbj10aGlzO3I/dGhpcy5fbGVmdEpveXN0aWNrPSEwOnRoaXMuX2xlZnRKb3lzdGljaz0hMSx0aGlzLl9qb3lzdGlja0luZGV4PWkuX2dsb2JhbEpveXN0aWNrSW5kZXgsaS5fZ2xvYmFsSm95c3RpY2tJbmRleCsrLHRoaXMuX2F4aXNUYXJnZXRlZEJ5TGVmdEFuZFJpZ2h0PXQuWCx0aGlzLl9heGlzVGFyZ2V0ZWRCeVVwQW5kRG93bj10LlksdGhpcy5yZXZlcnNlTGVmdFJpZ2h0PSExLHRoaXMucmV2ZXJzZVVwRG93bj0hMSx0aGlzLl90b3VjaGVzPW5ldyBlLlN0cmluZ0RpY3Rpb25hcnksdGhpcy5kZWx0YVBvc2l0aW9uPWUuVmVjdG9yMy5aZXJvKCksdGhpcy5fam95c3RpY2tTZW5zaWJpbGl0eT0yNSx0aGlzLl9pbnZlcnNlZFNlbnNpYmlsaXR5PTEvKHRoaXMuX2pveXN0aWNrU2Vuc2liaWxpdHkvMWUzKSx0aGlzLl9yb3RhdGlvblNwZWVkPTI1LHRoaXMuX2ludmVyc2VSb3RhdGlvblNwZWVkPTEvKHRoaXMuX3JvdGF0aW9uU3BlZWQvMWUzKSx0aGlzLl9yb3RhdGVPbkF4aXNSZWxhdGl2ZVRvTWVzaD0hMSx0aGlzLl9vblJlc2l6ZT1mdW5jdGlvbihlKXtpLnZqQ2FudmFzV2lkdGg9d2luZG93LmlubmVyV2lkdGgsaS52akNhbnZhc0hlaWdodD13aW5kb3cuaW5uZXJIZWlnaHQsaS52akNhbnZhcy53aWR0aD1pLnZqQ2FudmFzV2lkdGgsaS52akNhbnZhcy5oZWlnaHQ9aS52akNhbnZhc0hlaWdodCxpLmhhbGZXaWR0aD1pLnZqQ2FudmFzV2lkdGgvMixpLmhhbGZIZWlnaHQ9aS52akNhbnZhc0hlaWdodC8yfSxpLnZqQ2FudmFzfHwod2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIix0aGlzLl9vblJlc2l6ZSwhMSksaS52akNhbnZhcz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpLGkudmpDYW52YXNXaWR0aD13aW5kb3cuaW5uZXJXaWR0aCxpLnZqQ2FudmFzSGVpZ2h0PXdpbmRvdy5pbm5lckhlaWdodCxpLnZqQ2FudmFzLndpZHRoPXdpbmRvdy5pbm5lcldpZHRoLGkudmpDYW52YXMuaGVpZ2h0PXdpbmRvdy5pbm5lckhlaWdodCxpLnZqQ2FudmFzLnN0eWxlLndpZHRoPVwiMTAwJVwiLGkudmpDYW52YXMuc3R5bGUuaGVpZ2h0PVwiMTAwJVwiLGkudmpDYW52YXMuc3R5bGUucG9zaXRpb249XCJhYnNvbHV0ZVwiLGkudmpDYW52YXMuc3R5bGUuYmFja2dyb3VuZENvbG9yPVwidHJhbnNwYXJlbnRcIixpLnZqQ2FudmFzLnN0eWxlLnRvcD1cIjBweFwiLGkudmpDYW52YXMuc3R5bGUubGVmdD1cIjBweFwiLGkudmpDYW52YXMuc3R5bGUuekluZGV4PVwiNVwiLGkudmpDYW52YXMuc3R5bGUubXNUb3VjaEFjdGlvbj1cIm5vbmVcIixpLnZqQ2FudmFzLnNldEF0dHJpYnV0ZShcInRvdWNoLWFjdGlvblwiLFwibm9uZVwiKSxpLnZqQ2FudmFzQ29udGV4dD1pLnZqQ2FudmFzLmdldENvbnRleHQoXCIyZFwiKSxpLnZqQ2FudmFzQ29udGV4dC5zdHJva2VTdHlsZT1cIiNmZmZmZmZcIixpLnZqQ2FudmFzQ29udGV4dC5saW5lV2lkdGg9Mixkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGkudmpDYW52YXMpKSxpLmhhbGZXaWR0aD1pLnZqQ2FudmFzLndpZHRoLzIsaS5oYWxmSGVpZ2h0PWkudmpDYW52YXMuaGVpZ2h0LzIsdGhpcy5wcmVzc2VkPSExLHRoaXMuX2pveXN0aWNrQ29sb3I9XCJjeWFuXCIsdGhpcy5fam95c3RpY2tQb2ludGVySUQ9LTEsdGhpcy5fam95c3RpY2tQb2ludGVyUG9zPW5ldyBlLlZlY3RvcjIoMCwwKSx0aGlzLl9qb3lzdGlja1ByZXZpb3VzUG9pbnRlclBvcz1uZXcgZS5WZWN0b3IyKDAsMCksdGhpcy5fam95c3RpY2tQb2ludGVyU3RhcnRQb3M9bmV3IGUuVmVjdG9yMigwLDApLHRoaXMuX2RlbHRhSm95c3RpY2tWZWN0b3I9bmV3IGUuVmVjdG9yMigwLDApLHRoaXMuX29uUG9pbnRlckRvd25IYW5kbGVyUmVmPWZ1bmN0aW9uKGUpe24uX29uUG9pbnRlckRvd24oZSl9LHRoaXMuX29uUG9pbnRlck1vdmVIYW5kbGVyUmVmPWZ1bmN0aW9uKGUpe24uX29uUG9pbnRlck1vdmUoZSl9LHRoaXMuX29uUG9pbnRlck91dEhhbmRsZXJSZWY9ZnVuY3Rpb24oZSl7bi5fb25Qb2ludGVyVXAoZSl9LHRoaXMuX29uUG9pbnRlclVwSGFuZGxlclJlZj1mdW5jdGlvbihlKXtuLl9vblBvaW50ZXJVcChlKX0saS52akNhbnZhcy5hZGRFdmVudExpc3RlbmVyKFwicG9pbnRlcmRvd25cIix0aGlzLl9vblBvaW50ZXJEb3duSGFuZGxlclJlZiwhMSksaS52akNhbnZhcy5hZGRFdmVudExpc3RlbmVyKFwicG9pbnRlcm1vdmVcIix0aGlzLl9vblBvaW50ZXJNb3ZlSGFuZGxlclJlZiwhMSksaS52akNhbnZhcy5hZGRFdmVudExpc3RlbmVyKFwicG9pbnRlcnVwXCIsdGhpcy5fb25Qb2ludGVyVXBIYW5kbGVyUmVmLCExKSxpLnZqQ2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoXCJwb2ludGVyb3V0XCIsdGhpcy5fb25Qb2ludGVyVXBIYW5kbGVyUmVmLCExKSxpLnZqQ2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoXCJjb250ZXh0bWVudVwiLGZ1bmN0aW9uKGUpe2UucHJldmVudERlZmF1bHQoKX0sITEpLHJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbigpe24uX2RyYXdWaXJ0dWFsSm95c3RpY2soKX0pfXJldHVybiBpLnByb3RvdHlwZS5zZXRKb3lzdGlja1NlbnNpYmlsaXR5PWZ1bmN0aW9uKGUpe3RoaXMuX2pveXN0aWNrU2Vuc2liaWxpdHk9ZSx0aGlzLl9pbnZlcnNlZFNlbnNpYmlsaXR5PTEvKHRoaXMuX2pveXN0aWNrU2Vuc2liaWxpdHkvMWUzKX0saS5wcm90b3R5cGUuX29uUG9pbnRlckRvd249ZnVuY3Rpb24oZSl7dmFyIHQ7ZS5wcmV2ZW50RGVmYXVsdCgpLHQ9dGhpcy5fbGVmdEpveXN0aWNrPT09ITA/ZS5jbGllbnRYPGkuaGFsZldpZHRoOmUuY2xpZW50WD5pLmhhbGZXaWR0aCx0JiZ0aGlzLl9qb3lzdGlja1BvaW50ZXJJRDwwPyh0aGlzLl9qb3lzdGlja1BvaW50ZXJJRD1lLnBvaW50ZXJJZCx0aGlzLl9qb3lzdGlja1BvaW50ZXJTdGFydFBvcy54PWUuY2xpZW50WCx0aGlzLl9qb3lzdGlja1BvaW50ZXJTdGFydFBvcy55PWUuY2xpZW50WSx0aGlzLl9qb3lzdGlja1BvaW50ZXJQb3M9dGhpcy5fam95c3RpY2tQb2ludGVyU3RhcnRQb3MuY2xvbmUoKSx0aGlzLl9qb3lzdGlja1ByZXZpb3VzUG9pbnRlclBvcz10aGlzLl9qb3lzdGlja1BvaW50ZXJTdGFydFBvcy5jbG9uZSgpLHRoaXMuX2RlbHRhSm95c3RpY2tWZWN0b3IueD0wLHRoaXMuX2RlbHRhSm95c3RpY2tWZWN0b3IueT0wLHRoaXMucHJlc3NlZD0hMCx0aGlzLl90b3VjaGVzLmFkZChlLnBvaW50ZXJJZC50b1N0cmluZygpLGUpKTppLl9nbG9iYWxKb3lzdGlja0luZGV4PDImJnRoaXMuX2FjdGlvbiYmKHRoaXMuX2FjdGlvbigpLHRoaXMuX3RvdWNoZXMuYWRkKGUucG9pbnRlcklkLnRvU3RyaW5nKCkse3g6ZS5jbGllbnRYLHk6ZS5jbGllbnRZLHByZXZYOmUuY2xpZW50WCxwcmV2WTplLmNsaWVudFl9KSl9LGkucHJvdG90eXBlLl9vblBvaW50ZXJNb3ZlPWZ1bmN0aW9uKGUpe2lmKHRoaXMuX2pveXN0aWNrUG9pbnRlcklEPT1lLnBvaW50ZXJJZCl7dGhpcy5fam95c3RpY2tQb2ludGVyUG9zLng9ZS5jbGllbnRYLHRoaXMuX2pveXN0aWNrUG9pbnRlclBvcy55PWUuY2xpZW50WSx0aGlzLl9kZWx0YUpveXN0aWNrVmVjdG9yPXRoaXMuX2pveXN0aWNrUG9pbnRlclBvcy5jbG9uZSgpLHRoaXMuX2RlbHRhSm95c3RpY2tWZWN0b3I9dGhpcy5fZGVsdGFKb3lzdGlja1ZlY3Rvci5zdWJ0cmFjdCh0aGlzLl9qb3lzdGlja1BvaW50ZXJTdGFydFBvcyk7dmFyIGk9dGhpcy5yZXZlcnNlTGVmdFJpZ2h0Py0xOjEscj1pKnRoaXMuX2RlbHRhSm95c3RpY2tWZWN0b3IueC90aGlzLl9pbnZlcnNlZFNlbnNpYmlsaXR5O3N3aXRjaCh0aGlzLl9heGlzVGFyZ2V0ZWRCeUxlZnRBbmRSaWdodCl7Y2FzZSB0Llg6dGhpcy5kZWx0YVBvc2l0aW9uLng9TWF0aC5taW4oMSxNYXRoLm1heCgtMSxyKSk7YnJlYWs7Y2FzZSB0Llk6dGhpcy5kZWx0YVBvc2l0aW9uLnk9TWF0aC5taW4oMSxNYXRoLm1heCgtMSxyKSk7YnJlYWs7Y2FzZSB0Llo6dGhpcy5kZWx0YVBvc2l0aW9uLno9TWF0aC5taW4oMSxNYXRoLm1heCgtMSxyKSl9dmFyIG49dGhpcy5yZXZlcnNlVXBEb3duPzE6LTEsbz1uKnRoaXMuX2RlbHRhSm95c3RpY2tWZWN0b3IueS90aGlzLl9pbnZlcnNlZFNlbnNpYmlsaXR5O3N3aXRjaCh0aGlzLl9heGlzVGFyZ2V0ZWRCeVVwQW5kRG93bil7Y2FzZSB0Llg6dGhpcy5kZWx0YVBvc2l0aW9uLng9TWF0aC5taW4oMSxNYXRoLm1heCgtMSxvKSk7YnJlYWs7Y2FzZSB0Llk6dGhpcy5kZWx0YVBvc2l0aW9uLnk9TWF0aC5taW4oMSxNYXRoLm1heCgtMSxvKSk7XG5icmVhaztjYXNlIHQuWjp0aGlzLmRlbHRhUG9zaXRpb24uej1NYXRoLm1pbigxLE1hdGgubWF4KC0xLG8pKX19ZWxzZXt2YXIgcz10aGlzLl90b3VjaGVzLmdldChlLnBvaW50ZXJJZC50b1N0cmluZygpKTtzJiYocy54PWUuY2xpZW50WCxzLnk9ZS5jbGllbnRZKX19LGkucHJvdG90eXBlLl9vblBvaW50ZXJVcD1mdW5jdGlvbihlKXtpZih0aGlzLl9qb3lzdGlja1BvaW50ZXJJRD09ZS5wb2ludGVySWQpaS52akNhbnZhc0NvbnRleHQuY2xlYXJSZWN0KHRoaXMuX2pveXN0aWNrUG9pbnRlclN0YXJ0UG9zLngtNjMsdGhpcy5fam95c3RpY2tQb2ludGVyU3RhcnRQb3MueS02MywxMjYsMTI2KSxpLnZqQ2FudmFzQ29udGV4dC5jbGVhclJlY3QodGhpcy5fam95c3RpY2tQcmV2aW91c1BvaW50ZXJQb3MueC00MSx0aGlzLl9qb3lzdGlja1ByZXZpb3VzUG9pbnRlclBvcy55LTQxLDgyLDgyKSx0aGlzLl9qb3lzdGlja1BvaW50ZXJJRD0tMSx0aGlzLnByZXNzZWQ9ITE7ZWxzZXt2YXIgdD10aGlzLl90b3VjaGVzLmdldChlLnBvaW50ZXJJZC50b1N0cmluZygpKTt0JiZpLnZqQ2FudmFzQ29udGV4dC5jbGVhclJlY3QodC5wcmV2WC00Myx0LnByZXZZLTQzLDg2LDg2KX10aGlzLl9kZWx0YUpveXN0aWNrVmVjdG9yLng9MCx0aGlzLl9kZWx0YUpveXN0aWNrVmVjdG9yLnk9MCx0aGlzLl90b3VjaGVzLnJlbW92ZShlLnBvaW50ZXJJZC50b1N0cmluZygpKX0saS5wcm90b3R5cGUuc2V0Sm95c3RpY2tDb2xvcj1mdW5jdGlvbihlKXt0aGlzLl9qb3lzdGlja0NvbG9yPWV9LGkucHJvdG90eXBlLnNldEFjdGlvbk9uVG91Y2g9ZnVuY3Rpb24oZSl7dGhpcy5fYWN0aW9uPWV9LGkucHJvdG90eXBlLnNldEF4aXNGb3JMZWZ0UmlnaHQ9ZnVuY3Rpb24oZSl7c3dpdGNoKGUpe2Nhc2UgdC5YOmNhc2UgdC5ZOmNhc2UgdC5aOnRoaXMuX2F4aXNUYXJnZXRlZEJ5TGVmdEFuZFJpZ2h0PWU7YnJlYWs7ZGVmYXVsdDp0aGlzLl9heGlzVGFyZ2V0ZWRCeUxlZnRBbmRSaWdodD10Llh9fSxpLnByb3RvdHlwZS5zZXRBeGlzRm9yVXBEb3duPWZ1bmN0aW9uKGUpe3N3aXRjaChlKXtjYXNlIHQuWDpjYXNlIHQuWTpjYXNlIHQuWjp0aGlzLl9heGlzVGFyZ2V0ZWRCeVVwQW5kRG93bj1lO2JyZWFrO2RlZmF1bHQ6dGhpcy5fYXhpc1RhcmdldGVkQnlVcEFuZERvd249dC5ZfX0saS5wcm90b3R5cGUuX2NsZWFyQ2FudmFzPWZ1bmN0aW9uKCl7dGhpcy5fbGVmdEpveXN0aWNrP2kudmpDYW52YXNDb250ZXh0LmNsZWFyUmVjdCgwLDAsaS52akNhbnZhc1dpZHRoLzIsaS52akNhbnZhc0hlaWdodCk6aS52akNhbnZhc0NvbnRleHQuY2xlYXJSZWN0KGkudmpDYW52YXNXaWR0aC8yLDAsaS52akNhbnZhc1dpZHRoLGkudmpDYW52YXNIZWlnaHQpfSxpLnByb3RvdHlwZS5fZHJhd1ZpcnR1YWxKb3lzdGljaz1mdW5jdGlvbigpe3ZhciBlPXRoaXM7dGhpcy5wcmVzc2VkJiZ0aGlzLl90b3VjaGVzLmZvckVhY2goZnVuY3Rpb24odCl7dC5wb2ludGVySWQ9PT1lLl9qb3lzdGlja1BvaW50ZXJJRD8oaS52akNhbnZhc0NvbnRleHQuY2xlYXJSZWN0KGUuX2pveXN0aWNrUG9pbnRlclN0YXJ0UG9zLngtNjMsZS5fam95c3RpY2tQb2ludGVyU3RhcnRQb3MueS02MywxMjYsMTI2KSxpLnZqQ2FudmFzQ29udGV4dC5jbGVhclJlY3QoZS5fam95c3RpY2tQcmV2aW91c1BvaW50ZXJQb3MueC00MSxlLl9qb3lzdGlja1ByZXZpb3VzUG9pbnRlclBvcy55LTQxLDgyLDgyKSxpLnZqQ2FudmFzQ29udGV4dC5iZWdpblBhdGgoKSxpLnZqQ2FudmFzQ29udGV4dC5saW5lV2lkdGg9NixpLnZqQ2FudmFzQ29udGV4dC5zdHJva2VTdHlsZT1lLl9qb3lzdGlja0NvbG9yLGkudmpDYW52YXNDb250ZXh0LmFyYyhlLl9qb3lzdGlja1BvaW50ZXJTdGFydFBvcy54LGUuX2pveXN0aWNrUG9pbnRlclN0YXJ0UG9zLnksNDAsMCwyKk1hdGguUEksITApLGkudmpDYW52YXNDb250ZXh0LnN0cm9rZSgpLGkudmpDYW52YXNDb250ZXh0LmNsb3NlUGF0aCgpLGkudmpDYW52YXNDb250ZXh0LmJlZ2luUGF0aCgpLGkudmpDYW52YXNDb250ZXh0LnN0cm9rZVN0eWxlPWUuX2pveXN0aWNrQ29sb3IsaS52akNhbnZhc0NvbnRleHQubGluZVdpZHRoPTIsaS52akNhbnZhc0NvbnRleHQuYXJjKGUuX2pveXN0aWNrUG9pbnRlclN0YXJ0UG9zLngsZS5fam95c3RpY2tQb2ludGVyU3RhcnRQb3MueSw2MCwwLDIqTWF0aC5QSSwhMCksaS52akNhbnZhc0NvbnRleHQuc3Ryb2tlKCksaS52akNhbnZhc0NvbnRleHQuY2xvc2VQYXRoKCksaS52akNhbnZhc0NvbnRleHQuYmVnaW5QYXRoKCksaS52akNhbnZhc0NvbnRleHQuc3Ryb2tlU3R5bGU9ZS5fam95c3RpY2tDb2xvcixpLnZqQ2FudmFzQ29udGV4dC5hcmMoZS5fam95c3RpY2tQb2ludGVyUG9zLngsZS5fam95c3RpY2tQb2ludGVyUG9zLnksNDAsMCwyKk1hdGguUEksITApLGkudmpDYW52YXNDb250ZXh0LnN0cm9rZSgpLGkudmpDYW52YXNDb250ZXh0LmNsb3NlUGF0aCgpLGUuX2pveXN0aWNrUHJldmlvdXNQb2ludGVyUG9zPWUuX2pveXN0aWNrUG9pbnRlclBvcy5jbG9uZSgpKTooaS52akNhbnZhc0NvbnRleHQuY2xlYXJSZWN0KHQucHJldlgtNDMsdC5wcmV2WS00Myw4Niw4NiksaS52akNhbnZhc0NvbnRleHQuYmVnaW5QYXRoKCksaS52akNhbnZhc0NvbnRleHQuZmlsbFN0eWxlPVwid2hpdGVcIixpLnZqQ2FudmFzQ29udGV4dC5iZWdpblBhdGgoKSxpLnZqQ2FudmFzQ29udGV4dC5zdHJva2VTdHlsZT1cInJlZFwiLGkudmpDYW52YXNDb250ZXh0LmxpbmVXaWR0aD02LGkudmpDYW52YXNDb250ZXh0LmFyYyh0LngsdC55LDQwLDAsMipNYXRoLlBJLCEwKSxpLnZqQ2FudmFzQ29udGV4dC5zdHJva2UoKSxpLnZqQ2FudmFzQ29udGV4dC5jbG9zZVBhdGgoKSx0LnByZXZYPXQueCx0LnByZXZZPXQueSl9KSxyZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24oKXtlLl9kcmF3VmlydHVhbEpveXN0aWNrKCl9KX0saS5wcm90b3R5cGUucmVsZWFzZUNhbnZhcz1mdW5jdGlvbigpe2kudmpDYW52YXMmJihpLnZqQ2FudmFzLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJwb2ludGVyZG93blwiLHRoaXMuX29uUG9pbnRlckRvd25IYW5kbGVyUmVmKSxpLnZqQ2FudmFzLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJwb2ludGVybW92ZVwiLHRoaXMuX29uUG9pbnRlck1vdmVIYW5kbGVyUmVmKSxpLnZqQ2FudmFzLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJwb2ludGVydXBcIix0aGlzLl9vblBvaW50ZXJVcEhhbmRsZXJSZWYpLGkudmpDYW52YXMucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInBvaW50ZXJvdXRcIix0aGlzLl9vblBvaW50ZXJVcEhhbmRsZXJSZWYpLHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwicmVzaXplXCIsdGhpcy5fb25SZXNpemUpLGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoaS52akNhbnZhcyksaS52akNhbnZhcz1udWxsKX0saS5fZ2xvYmFsSm95c3RpY2tJbmRleD0wLGl9KCk7ZS5WaXJ0dWFsSm95c3RpY2s9aX0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdCh0LGkscil7ZS5jYWxsKHRoaXMsdCxpLHIpLHRoaXMuaW5wdXRzLmFkZFZpcnR1YWxKb3lzdGljaygpfXJldHVybiBfX2V4dGVuZHModCxlKSx0fShlLkZyZWVDYW1lcmEpO2UuVmlydHVhbEpveXN0aWNrc0NhbWVyYT10fShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoKXt9cmV0dXJuIHQucHJvdG90eXBlLmdldExlZnRKb3lzdGljaz1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9sZWZ0am95c3RpY2t9LHQucHJvdG90eXBlLmdldFJpZ2h0Sm95c3RpY2s9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcmlnaHRqb3lzdGlja30sdC5wcm90b3R5cGUuY2hlY2tJbnB1dHM9ZnVuY3Rpb24oKXtpZih0aGlzLl9sZWZ0am95c3RpY2spe3ZhciB0PXRoaXMuY2FtZXJhLGk9NTAqdC5fY29tcHV0ZUxvY2FsQ2FtZXJhU3BlZWQoKSxyPWUuTWF0cml4LlJvdGF0aW9uWWF3UGl0Y2hSb2xsKHQucm90YXRpb24ueSx0LnJvdGF0aW9uLngsMCksbj1lLlZlY3RvcjMuVHJhbnNmb3JtQ29vcmRpbmF0ZXMobmV3IGUuVmVjdG9yMyh0aGlzLl9sZWZ0am95c3RpY2suZGVsdGFQb3NpdGlvbi54KmksdGhpcy5fbGVmdGpveXN0aWNrLmRlbHRhUG9zaXRpb24ueSppLHRoaXMuX2xlZnRqb3lzdGljay5kZWx0YVBvc2l0aW9uLnoqaSkscik7dC5jYW1lcmFEaXJlY3Rpb249dC5jYW1lcmFEaXJlY3Rpb24uYWRkKG4pLHQuY2FtZXJhUm90YXRpb249dC5jYW1lcmFSb3RhdGlvbi5hZGRWZWN0b3IzKHRoaXMuX3JpZ2h0am95c3RpY2suZGVsdGFQb3NpdGlvbiksdGhpcy5fbGVmdGpveXN0aWNrLnByZXNzZWR8fCh0aGlzLl9sZWZ0am95c3RpY2suZGVsdGFQb3NpdGlvbj10aGlzLl9sZWZ0am95c3RpY2suZGVsdGFQb3NpdGlvbi5zY2FsZSguOSkpLHRoaXMuX3JpZ2h0am95c3RpY2sucHJlc3NlZHx8KHRoaXMuX3JpZ2h0am95c3RpY2suZGVsdGFQb3NpdGlvbj10aGlzLl9yaWdodGpveXN0aWNrLmRlbHRhUG9zaXRpb24uc2NhbGUoLjkpKX19LHQucHJvdG90eXBlLmF0dGFjaENvbnRyb2w9ZnVuY3Rpb24odCxpKXt0aGlzLl9sZWZ0am95c3RpY2s9bmV3IGUuVmlydHVhbEpveXN0aWNrKCEwKSx0aGlzLl9sZWZ0am95c3RpY2suc2V0QXhpc0ZvclVwRG93bihlLkpveXN0aWNrQXhpcy5aKSx0aGlzLl9sZWZ0am95c3RpY2suc2V0QXhpc0ZvckxlZnRSaWdodChlLkpveXN0aWNrQXhpcy5YKSx0aGlzLl9sZWZ0am95c3RpY2suc2V0Sm95c3RpY2tTZW5zaWJpbGl0eSguMTUpLHRoaXMuX3JpZ2h0am95c3RpY2s9bmV3IGUuVmlydHVhbEpveXN0aWNrKCExKSx0aGlzLl9yaWdodGpveXN0aWNrLnNldEF4aXNGb3JVcERvd24oZS5Kb3lzdGlja0F4aXMuWCksdGhpcy5fcmlnaHRqb3lzdGljay5zZXRBeGlzRm9yTGVmdFJpZ2h0KGUuSm95c3RpY2tBeGlzLlkpLHRoaXMuX3JpZ2h0am95c3RpY2sucmV2ZXJzZVVwRG93bj0hMCx0aGlzLl9yaWdodGpveXN0aWNrLnNldEpveXN0aWNrU2Vuc2liaWxpdHkoLjA1KSx0aGlzLl9yaWdodGpveXN0aWNrLnNldEpveXN0aWNrQ29sb3IoXCJ5ZWxsb3dcIil9LHQucHJvdG90eXBlLmRldGFjaENvbnRyb2w9ZnVuY3Rpb24oZSl7dGhpcy5fbGVmdGpveXN0aWNrLnJlbGVhc2VDYW52YXMoKSx0aGlzLl9yaWdodGpveXN0aWNrLnJlbGVhc2VDYW52YXMoKX0sdC5wcm90b3R5cGUuZ2V0VHlwZU5hbWU9ZnVuY3Rpb24oKXtyZXR1cm5cIkZyZWVDYW1lcmFWaXJ0dWFsSm95c3RpY2tJbnB1dFwifSx0LnByb3RvdHlwZS5nZXRTaW1wbGVOYW1lPWZ1bmN0aW9uKCl7cmV0dXJuXCJ2aXJ0dWFsSm95c3RpY2tcIn0sdH0oKTtlLkZyZWVDYW1lcmFWaXJ0dWFsSm95c3RpY2tJbnB1dD10LGUuQ2FtZXJhSW5wdXRUeXBlcy5GcmVlQ2FtZXJhVmlydHVhbEpveXN0aWNrSW5wdXQ9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdCh0LGkscixuLG8scyl7dmFyIGE9dGhpcztlLmNhbGwodGhpcyx0LFwiYW5hZ2x5cGhcIixudWxsLFtcImxlZnRTYW1wbGVyXCJdLGksclsxXSxuLG8scyksdGhpcy5fcGFzc2VkUHJvY2Vzcz1yWzBdLl9yaWdQb3N0UHJvY2Vzcyx0aGlzLm9uQXBwbHlPYnNlcnZhYmxlLmFkZChmdW5jdGlvbihlKXtlLnNldFRleHR1cmVGcm9tUG9zdFByb2Nlc3MoXCJsZWZ0U2FtcGxlclwiLGEuX3Bhc3NlZFByb2Nlc3MpfSl9cmV0dXJuIF9fZXh0ZW5kcyh0LGUpLHR9KGUuUG9zdFByb2Nlc3MpO2UuQW5hZ2x5cGhQb3N0UHJvY2Vzcz10fShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoZSl7dGhpcy5fc2NlbmU9ZX1yZXR1cm4gdC5wcm90b3R5cGUucmVuZGVyPWZ1bmN0aW9uKHQsaSxyKXt2YXIgbj10aGlzO3ZvaWQgMD09PXImJihyPSExKTt2YXIgbz10aGlzLl9zY2VuZSxzPXRoaXMuX3NjZW5lLmdldEVuZ2luZSgpLGE9bnVsbCE9PXMuZ2V0Q2FwcygpLmluc3RhbmNlZEFycmF5cyYmbnVsbCE9PWkudmlzaWJsZUluc3RhbmNlc1t0Ll9pZF0mJnZvaWQgMCE9PWkudmlzaWJsZUluc3RhbmNlc1t0Ll9pZF07aWYodGhpcy5pc1JlYWR5KHQsYSkpe3ZhciBoPXQuZ2V0UmVuZGVyaW5nTWVzaCgpLGM9dC5nZXRNYXRlcmlhbCgpO2lmKHMuZW5hYmxlRWZmZWN0KHRoaXMuX2VmZmVjdCksdGhpcy5fZWZmZWN0LnNldEZsb2F0KFwib2Zmc2V0XCIscj8wOmgub3V0bGluZVdpZHRoKSx0aGlzLl9lZmZlY3Quc2V0Q29sb3I0KFwiY29sb3JcIixyP2gub3ZlcmxheUNvbG9yOmgub3V0bGluZUNvbG9yLHI/aC5vdmVybGF5QWxwaGE6MSksdGhpcy5fZWZmZWN0LnNldE1hdHJpeChcInZpZXdQcm9qZWN0aW9uXCIsby5nZXRUcmFuc2Zvcm1NYXRyaXgoKSksaC51c2VCb25lcyYmaC5jb21wdXRlQm9uZXNVc2luZ1NoYWRlcnMmJnRoaXMuX2VmZmVjdC5zZXRNYXRyaWNlcyhcIm1Cb25lc1wiLGguc2tlbGV0b24uZ2V0VHJhbnNmb3JtTWF0cmljZXMoaCkpLGguX2JpbmQodCx0aGlzLl9lZmZlY3QsZS5NYXRlcmlhbC5UcmlhbmdsZUZpbGxNb2RlKSxjJiZjLm5lZWRBbHBoYVRlc3RpbmcoKSl7dmFyIGw9Yy5nZXRBbHBoYVRlc3RUZXh0dXJlKCk7dGhpcy5fZWZmZWN0LnNldFRleHR1cmUoXCJkaWZmdXNlU2FtcGxlclwiLGwpLHRoaXMuX2VmZmVjdC5zZXRNYXRyaXgoXCJkaWZmdXNlTWF0cml4XCIsbC5nZXRUZXh0dXJlTWF0cml4KCkpfWguX3Byb2Nlc3NSZW5kZXJpbmcodCx0aGlzLl9lZmZlY3QsZS5NYXRlcmlhbC5UcmlhbmdsZUZpbGxNb2RlLGksYSxmdW5jdGlvbihlLHQpe24uX2VmZmVjdC5zZXRNYXRyaXgoXCJ3b3JsZFwiLHQpfSl9fSx0LnByb3RvdHlwZS5pc1JlYWR5PWZ1bmN0aW9uKHQsaSl7dmFyIHI9W10sbj1bZS5WZXJ0ZXhCdWZmZXIuUG9zaXRpb25LaW5kLGUuVmVydGV4QnVmZmVyLk5vcm1hbEtpbmRdLG89dC5nZXRNZXNoKCkscz10LmdldE1hdGVyaWFsKCk7cyYmcy5uZWVkQWxwaGFUZXN0aW5nKCkmJihyLnB1c2goXCIjZGVmaW5lIEFMUEhBVEVTVFwiKSxvLmlzVmVydGljZXNEYXRhUHJlc2VudChlLlZlcnRleEJ1ZmZlci5VVktpbmQpJiYobi5wdXNoKGUuVmVydGV4QnVmZmVyLlVWS2luZCksci5wdXNoKFwiI2RlZmluZSBVVjFcIikpLG8uaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGUuVmVydGV4QnVmZmVyLlVWMktpbmQpJiYobi5wdXNoKGUuVmVydGV4QnVmZmVyLlVWMktpbmQpLHIucHVzaChcIiNkZWZpbmUgVVYyXCIpKSksby51c2VCb25lcyYmby5jb21wdXRlQm9uZXNVc2luZ1NoYWRlcnM/KG4ucHVzaChlLlZlcnRleEJ1ZmZlci5NYXRyaWNlc0luZGljZXNLaW5kKSxuLnB1c2goZS5WZXJ0ZXhCdWZmZXIuTWF0cmljZXNXZWlnaHRzS2luZCksby5udW1Cb25lSW5mbHVlbmNlcnM+NCYmKG4ucHVzaChlLlZlcnRleEJ1ZmZlci5NYXRyaWNlc0luZGljZXNFeHRyYUtpbmQpLG4ucHVzaChlLlZlcnRleEJ1ZmZlci5NYXRyaWNlc1dlaWdodHNFeHRyYUtpbmQpKSxyLnB1c2goXCIjZGVmaW5lIE5VTV9CT05FX0lORkxVRU5DRVJTIFwiK28ubnVtQm9uZUluZmx1ZW5jZXJzKSxyLnB1c2goXCIjZGVmaW5lIEJvbmVzUGVyTWVzaCBcIisoby5za2VsZXRvbi5ib25lcy5sZW5ndGgrMSkpKTpyLnB1c2goXCIjZGVmaW5lIE5VTV9CT05FX0lORkxVRU5DRVJTIDBcIiksaSYmKHIucHVzaChcIiNkZWZpbmUgSU5TVEFOQ0VTXCIpLG4ucHVzaChcIndvcmxkMFwiKSxuLnB1c2goXCJ3b3JsZDFcIiksbi5wdXNoKFwid29ybGQyXCIpLG4ucHVzaChcIndvcmxkM1wiKSk7dmFyIGE9ci5qb2luKFwiXFxuXCIpO3JldHVybiB0aGlzLl9jYWNoZWREZWZpbmVzIT09YSYmKHRoaXMuX2NhY2hlZERlZmluZXM9YSx0aGlzLl9lZmZlY3Q9dGhpcy5fc2NlbmUuZ2V0RW5naW5lKCkuY3JlYXRlRWZmZWN0KFwib3V0bGluZVwiLG4sW1wid29ybGRcIixcIm1Cb25lc1wiLFwidmlld1Byb2plY3Rpb25cIixcImRpZmZ1c2VNYXRyaXhcIixcIm9mZnNldFwiLFwiY29sb3JcIl0sW1wiZGlmZnVzZVNhbXBsZXJcIl0sYSkpLHRoaXMuX2VmZmVjdC5pc1JlYWR5KCl9LHR9KCk7ZS5PdXRsaW5lUmVuZGVyZXI9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KGUsdCxpLHIpe3RoaXMubmFtZT1lLHRoaXMubWVzaGVzTmFtZXM9dCx0aGlzLnJvb3RVcmw9aSx0aGlzLnNjZW5lRmlsZW5hbWU9cix0aGlzLmlzQ29tcGxldGVkPSExfXJldHVybiB0LnByb3RvdHlwZS5ydW49ZnVuY3Rpb24odCxpLHIpe3ZhciBuPXRoaXM7ZS5TY2VuZUxvYWRlci5JbXBvcnRNZXNoKHRoaXMubWVzaGVzTmFtZXMsdGhpcy5yb290VXJsLHRoaXMuc2NlbmVGaWxlbmFtZSx0LGZ1bmN0aW9uKGUsdCxyKXtuLmxvYWRlZE1lc2hlcz1lLG4ubG9hZGVkUGFydGljbGVTeXN0ZW1zPXQsbi5sb2FkZWRTa2VsZXRvbnM9cixuLmlzQ29tcGxldGVkPSEwLG4ub25TdWNjZXNzJiZuLm9uU3VjY2VzcyhuKSxpKCl9LG51bGwsZnVuY3Rpb24oKXtuLm9uRXJyb3ImJm4ub25FcnJvcihuKSxyKCl9KX0sdH0oKTtlLk1lc2hBc3NldFRhc2s9dDt2YXIgaT1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoZSx0KXt0aGlzLm5hbWU9ZSx0aGlzLnVybD10LHRoaXMuaXNDb21wbGV0ZWQ9ITF9cmV0dXJuIHQucHJvdG90eXBlLnJ1bj1mdW5jdGlvbih0LGkscil7dmFyIG49dGhpcztlLlRvb2xzLkxvYWRGaWxlKHRoaXMudXJsLGZ1bmN0aW9uKGUpe24udGV4dD1lLG4uaXNDb21wbGV0ZWQ9ITAsbi5vblN1Y2Nlc3MmJm4ub25TdWNjZXNzKG4pLGkoKX0sbnVsbCx0LmRhdGFiYXNlLCExLGZ1bmN0aW9uKCl7bi5vbkVycm9yJiZuLm9uRXJyb3IobikscigpfSl9LHR9KCk7ZS5UZXh0RmlsZUFzc2V0VGFzaz1pO3ZhciByPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdChlLHQpe3RoaXMubmFtZT1lLHRoaXMudXJsPXQsdGhpcy5pc0NvbXBsZXRlZD0hMX1yZXR1cm4gdC5wcm90b3R5cGUucnVuPWZ1bmN0aW9uKHQsaSxyKXt2YXIgbj10aGlzO2UuVG9vbHMuTG9hZEZpbGUodGhpcy51cmwsZnVuY3Rpb24oZSl7bi5kYXRhPWUsbi5pc0NvbXBsZXRlZD0hMCxuLm9uU3VjY2VzcyYmbi5vblN1Y2Nlc3MobiksaSgpfSxudWxsLHQuZGF0YWJhc2UsITAsZnVuY3Rpb24oKXtuLm9uRXJyb3ImJm4ub25FcnJvcihuKSxyKCl9KX0sdH0oKTtlLkJpbmFyeUZpbGVBc3NldFRhc2s9cjt2YXIgbj1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSx0KXt0aGlzLm5hbWU9ZSx0aGlzLnVybD10LHRoaXMuaXNDb21wbGV0ZWQ9ITF9cmV0dXJuIGUucHJvdG90eXBlLnJ1bj1mdW5jdGlvbihlLHQsaSl7dmFyIHI9dGhpcyxuPW5ldyBJbWFnZTtuLm9ubG9hZD1mdW5jdGlvbigpe3IuaW1hZ2U9bixyLmlzQ29tcGxldGVkPSEwLHIub25TdWNjZXNzJiZyLm9uU3VjY2VzcyhyKSx0KCl9LG4ub25lcnJvcj1mdW5jdGlvbigpe3Iub25FcnJvciYmci5vbkVycm9yKHIpLGkoKX0sbi5zcmM9dGhpcy51cmx9LGV9KCk7ZS5JbWFnZUFzc2V0VGFzaz1uO3ZhciBvPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGkscixuLG8pe3ZvaWQgMD09PW8mJihvPWUuVGV4dHVyZS5UUklMSU5FQVJfU0FNUExJTkdNT0RFKSx0aGlzLm5hbWU9dCx0aGlzLnVybD1pLHRoaXMubm9NaXBtYXA9cix0aGlzLmludmVydFk9bix0aGlzLnNhbXBsaW5nTW9kZT1vLHRoaXMuaXNDb21wbGV0ZWQ9ITF9cmV0dXJuIHQucHJvdG90eXBlLnJ1bj1mdW5jdGlvbih0LGkscil7dmFyIG49dGhpcyxvPWZ1bmN0aW9uKCl7bi5pc0NvbXBsZXRlZD0hMCxuLm9uU3VjY2VzcyYmbi5vblN1Y2Nlc3MobiksaSgpfSxzPWZ1bmN0aW9uKCl7bi5vbkVycm9yJiZuLm9uRXJyb3IobikscigpfTt0aGlzLnRleHR1cmU9bmV3IGUuVGV4dHVyZSh0aGlzLnVybCx0LHRoaXMubm9NaXBtYXAsdGhpcy5pbnZlcnRZLHRoaXMuc2FtcGxpbmdNb2RlLG8scyl9LHR9KCk7ZS5UZXh0dXJlQXNzZXRUYXNrPW87dmFyIHM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBzKGUpe3RoaXMuX3Rhc2tzPW5ldyBBcnJheSx0aGlzLl93YWl0aW5nVGFza3NDb3VudD0wLHRoaXMudXNlRGVmYXVsdExvYWRpbmdTY3JlZW49ITAsdGhpcy5fc2NlbmU9ZX1yZXR1cm4gcy5wcm90b3R5cGUuYWRkTWVzaFRhc2s9ZnVuY3Rpb24oZSxpLHIsbil7dmFyIG89bmV3IHQoZSxpLHIsbik7cmV0dXJuIHRoaXMuX3Rhc2tzLnB1c2gobyksb30scy5wcm90b3R5cGUuYWRkVGV4dEZpbGVUYXNrPWZ1bmN0aW9uKGUsdCl7dmFyIHI9bmV3IGkoZSx0KTtyZXR1cm4gdGhpcy5fdGFza3MucHVzaChyKSxyfSxzLnByb3RvdHlwZS5hZGRCaW5hcnlGaWxlVGFzaz1mdW5jdGlvbihlLHQpe3ZhciBpPW5ldyByKGUsdCk7cmV0dXJuIHRoaXMuX3Rhc2tzLnB1c2goaSksaX0scy5wcm90b3R5cGUuYWRkSW1hZ2VUYXNrPWZ1bmN0aW9uKGUsdCl7dmFyIGk9bmV3IG4oZSx0KTtyZXR1cm4gdGhpcy5fdGFza3MucHVzaChpKSxpfSxzLnByb3RvdHlwZS5hZGRUZXh0dXJlVGFzaz1mdW5jdGlvbih0LGkscixuLHMpe3ZvaWQgMD09PXMmJihzPWUuVGV4dHVyZS5UUklMSU5FQVJfU0FNUExJTkdNT0RFKTt2YXIgYT1uZXcgbyh0LGkscixuLHMpO3JldHVybiB0aGlzLl90YXNrcy5wdXNoKGEpLGF9LHMucHJvdG90eXBlLl9kZWNyZWFzZVdhaXRpbmdUYXNrc0NvdW50PWZ1bmN0aW9uKCl7dGhpcy5fd2FpdGluZ1Rhc2tzQ291bnQtLSwwPT09dGhpcy5fd2FpdGluZ1Rhc2tzQ291bnQmJih0aGlzLm9uRmluaXNoJiZ0aGlzLm9uRmluaXNoKHRoaXMuX3Rhc2tzKSx0aGlzLl9zY2VuZS5nZXRFbmdpbmUoKS5oaWRlTG9hZGluZ1VJKCkpfSxzLnByb3RvdHlwZS5fcnVuVGFzaz1mdW5jdGlvbihlKXt2YXIgdD10aGlzO2UucnVuKHRoaXMuX3NjZW5lLGZ1bmN0aW9uKCl7dC5vblRhc2tTdWNjZXNzJiZ0Lm9uVGFza1N1Y2Nlc3MoZSksdC5fZGVjcmVhc2VXYWl0aW5nVGFza3NDb3VudCgpfSxmdW5jdGlvbigpe3Qub25UYXNrRXJyb3ImJnQub25UYXNrRXJyb3IoZSksdC5fZGVjcmVhc2VXYWl0aW5nVGFza3NDb3VudCgpfSl9LHMucHJvdG90eXBlLnJlc2V0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3Rhc2tzPW5ldyBBcnJheSx0aGlzfSxzLnByb3RvdHlwZS5sb2FkPWZ1bmN0aW9uKCl7aWYodGhpcy5fd2FpdGluZ1Rhc2tzQ291bnQ9dGhpcy5fdGFza3MubGVuZ3RoLDA9PT10aGlzLl93YWl0aW5nVGFza3NDb3VudClyZXR1cm4gdGhpcy5vbkZpbmlzaCYmdGhpcy5vbkZpbmlzaCh0aGlzLl90YXNrcyksdGhpczt0aGlzLnVzZURlZmF1bHRMb2FkaW5nU2NyZWVuJiZ0aGlzLl9zY2VuZS5nZXRFbmdpbmUoKS5kaXNwbGF5TG9hZGluZ1VJKCk7Zm9yKHZhciBlPTA7ZTx0aGlzLl90YXNrcy5sZW5ndGg7ZSsrKXt2YXIgdD10aGlzLl90YXNrc1tlXTt0aGlzLl9ydW5UYXNrKHQpfXJldHVybiB0aGlzfSxzfSgpO2UuQXNzZXRzTWFuYWdlcj1zfShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoKXt0aGlzLmNvbXBlbnNhdGVEaXN0b3J0aW9uPSEwfXJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJhc3BlY3RSYXRpb1wiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5oUmVzb2x1dGlvbi8oMip0aGlzLnZSZXNvbHV0aW9uKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJhc3BlY3RSYXRpb0ZvdlwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gMipNYXRoLmF0YW4odGhpcy5wb3N0UHJvY2Vzc1NjYWxlRmFjdG9yKnRoaXMudlNjcmVlblNpemUvKDIqdGhpcy5leWVUb1NjcmVlbkRpc3RhbmNlKSl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwibGVmdEhNYXRyaXhcIix7Z2V0OmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5oU2NyZWVuU2l6ZS80LXRoaXMubGVuc1NlcGFyYXRpb25EaXN0YW5jZS8yLGk9NCp0L3RoaXMuaFNjcmVlblNpemU7cmV0dXJuIGUuTWF0cml4LlRyYW5zbGF0aW9uKGksMCwwKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJyaWdodEhNYXRyaXhcIix7Z2V0OmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5oU2NyZWVuU2l6ZS80LXRoaXMubGVuc1NlcGFyYXRpb25EaXN0YW5jZS8yLGk9NCp0L3RoaXMuaFNjcmVlblNpemU7cmV0dXJuIGUuTWF0cml4LlRyYW5zbGF0aW9uKC1pLDAsMCl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwibGVmdFByZVZpZXdNYXRyaXhcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGUuTWF0cml4LlRyYW5zbGF0aW9uKC41KnRoaXMuaW50ZXJwdXBpbGxhcnlEaXN0YW5jZSwwLDApfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcInJpZ2h0UHJlVmlld01hdHJpeFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gZS5NYXRyaXguVHJhbnNsYXRpb24oLS41KnRoaXMuaW50ZXJwdXBpbGxhcnlEaXN0YW5jZSwwLDApfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLHQuR2V0RGVmYXVsdD1mdW5jdGlvbigpe3ZhciBlPW5ldyB0O3JldHVybiBlLmhSZXNvbHV0aW9uPTEyODAsZS52UmVzb2x1dGlvbj04MDAsZS5oU2NyZWVuU2l6ZT0uMTQ5NzU5OTkzLGUudlNjcmVlblNpemU9LjA5MzU5OTk5NzUsZS52U2NyZWVuQ2VudGVyPS4wNDY3OTk5OTg3LGUuZXllVG9TY3JlZW5EaXN0YW5jZT0uMDQxMDAwMDAxMSxlLmxlbnNTZXBhcmF0aW9uRGlzdGFuY2U9LjA2MzUwMDAwMixlLmludGVycHVwaWxsYXJ5RGlzdGFuY2U9LjA2NDAwMDAwMyxlLmRpc3RvcnRpb25LPVsxLC4yMTk5OTk5OTksLjIzOTk5OTk5NSwwXSxlLmNocm9tYUFiQ29ycmVjdGlvbj1bLjk5NTk5OTk5MiwtLjAwNDAwMDAwMDE5LDEuMDE0MDAwMDYsMF0sZS5wb3N0UHJvY2Vzc1NjYWxlRmFjdG9yPTEuNzE0NjA1NTA3ODA4NDEyLGUubGVuc0NlbnRlck9mZnNldD0uMTUxOTc2NDIxLGV9LHR9KCk7ZS5WUkNhbWVyYU1ldHJpY3M9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gaShpLHIsbixvKXt2b2lkIDA9PT1vJiYobz0hMCksdC5jYWxsKHRoaXMsaSxyLG4pLHRoaXMucm90YXRpb25RdWF0ZXJuaW9uPW5ldyBlLlF1YXRlcm5pb247dmFyIHM9ZS5WUkNhbWVyYU1ldHJpY3MuR2V0RGVmYXVsdCgpO3MuY29tcGVuc2F0ZURpc3RvcnRpb249byx0aGlzLnNldENhbWVyYVJpZ01vZGUoZS5DYW1lcmEuUklHX01PREVfVlIse3ZyQ2FtZXJhTWV0cmljczpzfSksdGhpcy5pbnB1dHMuYWRkRGV2aWNlT3JpZW50YXRpb24oKX1yZXR1cm4gX19leHRlbmRzKGksdCksaS5wcm90b3R5cGUuZ2V0VHlwZU5hbWU9ZnVuY3Rpb24oKXtyZXR1cm5cIlZSRGV2aWNlT3JpZW50YXRpb25GcmVlQ2FtZXJhXCJ9LGl9KGUuRnJlZUNhbWVyYSk7ZS5WUkRldmljZU9yaWVudGF0aW9uRnJlZUNhbWVyYT10O3ZhciBpPWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGkoaSxyLG4sbyxzLGEsaCl7dm9pZCAwPT09aCYmKGg9ITApLHQuY2FsbCh0aGlzLGkscixuLG8scyxhKTt2YXIgYz1lLlZSQ2FtZXJhTWV0cmljcy5HZXREZWZhdWx0KCk7Yy5jb21wZW5zYXRlRGlzdG9ydGlvbj1oLHRoaXMuc2V0Q2FtZXJhUmlnTW9kZShlLkNhbWVyYS5SSUdfTU9ERV9WUix7dnJDYW1lcmFNZXRyaWNzOmN9KSx0aGlzLmlucHV0cy5hZGRWUkRldmljZU9yaWVudGF0aW9uKCl9cmV0dXJuIF9fZXh0ZW5kcyhpLHQpLGkucHJvdG90eXBlLmdldFR5cGVOYW1lPWZ1bmN0aW9uKCl7cmV0dXJuXCJWUkRldmljZU9yaWVudGF0aW9uQXJjUm90YXRlQ2FtZXJhXCJ9LGl9KGUuQXJjUm90YXRlQ2FtZXJhKTtlLlZSRGV2aWNlT3JpZW50YXRpb25BcmNSb3RhdGVDYW1lcmE9aX0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gaShpLHIsbixvKXt2b2lkIDA9PT1vJiYobz0hMCksdC5jYWxsKHRoaXMsaSxyLG4pLHRoaXMuX2htZERldmljZT1udWxsLHRoaXMuX3NlbnNvckRldmljZT1udWxsLHRoaXMuX2NhY2hlU3RhdGU9bnVsbCx0aGlzLl92ckVuYWJsZWQ9ITE7dmFyIHM9ZS5WUkNhbWVyYU1ldHJpY3MuR2V0RGVmYXVsdCgpO3MuY29tcGVuc2F0ZURpc3RvcnRpb249byx0aGlzLnNldENhbWVyYVJpZ01vZGUoZS5DYW1lcmEuUklHX01PREVfVlIse3ZyQ2FtZXJhTWV0cmljczpzfSksdGhpcy5fZ2V0V2ViVlJEZXZpY2VzPXRoaXMuX2dldFdlYlZSRGV2aWNlcy5iaW5kKHRoaXMpLHRoaXMucm90YXRpb25RdWF0ZXJuaW9uPW5ldyBlLlF1YXRlcm5pb259cmV0dXJuIF9fZXh0ZW5kcyhpLHQpLGkucHJvdG90eXBlLl9nZXRXZWJWUkRldmljZXM9ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5sZW5ndGgsaT0wO2Zvcih0aGlzLl9zZW5zb3JEZXZpY2U9bnVsbCx0aGlzLl9obWREZXZpY2U9bnVsbDt0PmkmJm51bGw9PT10aGlzLl9obWREZXZpY2U7KWVbaV1pbnN0YW5jZW9mIEhNRFZSRGV2aWNlJiYodGhpcy5faG1kRGV2aWNlPWVbaV0pLGkrKztmb3IoaT0wO3Q+aSYmbnVsbD09PXRoaXMuX3NlbnNvckRldmljZTspZVtpXWluc3RhbmNlb2YgUG9zaXRpb25TZW5zb3JWUkRldmljZSYmKCF0aGlzLl9obWREZXZpY2V8fGVbaV0uaGFyZHdhcmVVbml0SWQ9PT10aGlzLl9obWREZXZpY2UuaGFyZHdhcmVVbml0SWQpJiYodGhpcy5fc2Vuc29yRGV2aWNlPWVbaV0pLGkrKzt0aGlzLl92ckVuYWJsZWQ9ISghdGhpcy5fc2Vuc29yRGV2aWNlfHwhdGhpcy5faG1kRGV2aWNlKX0saS5wcm90b3R5cGUuX2NoZWNrSW5wdXRzPWZ1bmN0aW9uKCl7dGhpcy5fdnJFbmFibGVkJiYodGhpcy5fY2FjaGVTdGF0ZT10aGlzLl9zZW5zb3JEZXZpY2UuZ2V0U3RhdGUoKSx0aGlzLnJvdGF0aW9uUXVhdGVybmlvbi5jb3B5RnJvbSh0aGlzLl9jYWNoZVN0YXRlLm9yaWVudGF0aW9uKSx0aGlzLnJvdGF0aW9uUXVhdGVybmlvbi56Kj0tMSx0aGlzLnJvdGF0aW9uUXVhdGVybmlvbi53Kj0tMSksdC5wcm90b3R5cGUuX2NoZWNrSW5wdXRzLmNhbGwodGhpcyl9LGkucHJvdG90eXBlLmF0dGFjaENvbnRyb2w9ZnVuY3Rpb24oaSxyKXt0LnByb3RvdHlwZS5hdHRhY2hDb250cm9sLmNhbGwodGhpcyxpLHIpLHI9ZS5DYW1lcmEuRm9yY2VBdHRhY2hDb250cm9sVG9BbHdheXNQcmV2ZW50RGVmYXVsdD8hMTpyLG5hdmlnYXRvci5nZXRWUkRldmljZXM/bmF2aWdhdG9yLmdldFZSRGV2aWNlcygpLnRoZW4odGhpcy5fZ2V0V2ViVlJEZXZpY2VzKTpuYXZpZ2F0b3IubW96R2V0VlJEZXZpY2VzJiZuYXZpZ2F0b3IubW96R2V0VlJEZXZpY2VzKHRoaXMuX2dldFdlYlZSRGV2aWNlcyl9LGkucHJvdG90eXBlLmRldGFjaENvbnRyb2w9ZnVuY3Rpb24oZSl7dC5wcm90b3R5cGUuZGV0YWNoQ29udHJvbC5jYWxsKHRoaXMsZSksdGhpcy5fdnJFbmFibGVkPSExfSxpLnByb3RvdHlwZS5yZXF1ZXN0VlJGdWxsc2NyZWVuPWZ1bmN0aW9uKGUpe3RoaXMuX2htZERldmljZSYmdGhpcy5nZXRFbmdpbmUoKS5zd2l0Y2hGdWxsc2NyZWVuKGUse3ZyRGlzcGxheTp0aGlzLl9obWREZXZpY2V9KX0saS5wcm90b3R5cGUuZ2V0VHlwZU5hbWU9ZnVuY3Rpb24oKXtyZXR1cm5cIldlYlZSRnJlZUNhbWVyYVwifSxpfShlLkZyZWVDYW1lcmEpO2UuV2ViVlJGcmVlQ2FtZXJhPXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlKXt2b2lkIDA9PT1lJiYoZT0wKSx0aGlzLnByaW9yaXR5PWUsdGhpcy5hcHBseT1mdW5jdGlvbihlKXtyZXR1cm4hMH19cmV0dXJuIGV9KCk7ZS5TY2VuZU9wdGltaXphdGlvbj10O3ZhciBpPWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQodCxpKXt2YXIgcj10aGlzO3ZvaWQgMD09PXQmJih0PTApLHZvaWQgMD09PWkmJihpPTEwMjQpLGUuY2FsbCh0aGlzLHQpLHRoaXMucHJpb3JpdHk9dCx0aGlzLm1heGltdW1TaXplPWksdGhpcy5hcHBseT1mdW5jdGlvbihlKXtmb3IodmFyIHQ9ITAsaT0wO2k8ZS50ZXh0dXJlcy5sZW5ndGg7aSsrKXt2YXIgbj1lLnRleHR1cmVzW2ldO2lmKG4uY2FuUmVzY2FsZSl7dmFyIG89bi5nZXRTaXplKCkscz1NYXRoLm1heChvLndpZHRoLG8uaGVpZ2h0KTtzPnIubWF4aW11bVNpemUmJihuLnNjYWxlKC41KSx0PSExKX19cmV0dXJuIHR9fXJldHVybiBfX2V4dGVuZHModCxlKSx0fSh0KTtlLlRleHR1cmVPcHRpbWl6YXRpb249aTt2YXIgcj1mdW5jdGlvbihlKXtmdW5jdGlvbiB0KHQsaSl7dmFyIHI9dGhpczt2b2lkIDA9PT10JiYodD0wKSx2b2lkIDA9PT1pJiYoaT0yKSxlLmNhbGwodGhpcyx0KSx0aGlzLnByaW9yaXR5PXQsdGhpcy5tYXhpbXVtU2NhbGU9aSx0aGlzLl9jdXJyZW50U2NhbGU9MSx0aGlzLmFwcGx5PWZ1bmN0aW9uKGUpe3JldHVybiByLl9jdXJyZW50U2NhbGUrKyxlLmdldEVuZ2luZSgpLnNldEhhcmR3YXJlU2NhbGluZ0xldmVsKHIuX2N1cnJlbnRTY2FsZSksci5fY3VycmVudFNjYWxlPj1yLm1heGltdW1TY2FsZX19cmV0dXJuIF9fZXh0ZW5kcyh0LGUpLHR9KHQpO2UuSGFyZHdhcmVTY2FsaW5nT3B0aW1pemF0aW9uPXI7dmFyIG49ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdCgpe2UuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuYXBwbHk9ZnVuY3Rpb24oZSl7cmV0dXJuIGUuc2hhZG93c0VuYWJsZWQ9ITEsITB9fXJldHVybiBfX2V4dGVuZHModCxlKSx0fSh0KTtlLlNoYWRvd3NPcHRpbWl6YXRpb249bjt2YXIgbz1mdW5jdGlvbihlKXtmdW5jdGlvbiB0KCl7ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5hcHBseT1mdW5jdGlvbihlKXtyZXR1cm4gZS5wb3N0UHJvY2Vzc2VzRW5hYmxlZD0hMSwhMH19cmV0dXJuIF9fZXh0ZW5kcyh0LGUpLHR9KHQpO2UuUG9zdFByb2Nlc3Nlc09wdGltaXphdGlvbj1vO3ZhciBzPWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQoKXtlLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLmFwcGx5PWZ1bmN0aW9uKGUpe3JldHVybiBlLmxlbnNGbGFyZXNFbmFibGVkPSExLCEwfX1yZXR1cm4gX19leHRlbmRzKHQsZSksdH0odCk7ZS5MZW5zRmxhcmVzT3B0aW1pemF0aW9uPXM7dmFyIGE9ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdCgpe2UuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuYXBwbHk9ZnVuY3Rpb24oZSl7cmV0dXJuIGUucGFydGljbGVzRW5hYmxlZD0hMSwhMH19cmV0dXJuIF9fZXh0ZW5kcyh0LGUpLHR9KHQpO2UuUGFydGljbGVzT3B0aW1pemF0aW9uPWE7dmFyIGg9ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdCgpe2UuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuYXBwbHk9ZnVuY3Rpb24oZSl7cmV0dXJuIGUucmVuZGVyVGFyZ2V0c0VuYWJsZWQ9ITEsITB9fXJldHVybiBfX2V4dGVuZHModCxlKSx0fSh0KTtlLlJlbmRlclRhcmdldHNPcHRpbWl6YXRpb249aDt2YXIgYz1mdW5jdGlvbih0KXtmdW5jdGlvbiBpKCl7dmFyIHI9dGhpczt0LmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLl9jYW5CZU1lcmdlZD1mdW5jdGlvbih0KXtpZighKHQgaW5zdGFuY2VvZiBlLk1lc2gpKXJldHVybiExO3ZhciBpPXQ7cmV0dXJuIGkuaXNWaXNpYmxlJiZpLmlzRW5hYmxlZCgpP2kuaW5zdGFuY2VzLmxlbmd0aD4wPyExOmkuc2tlbGV0b258fGkuaGFzTE9ETGV2ZWxzPyExOiFpLnBhcmVudDohMX0sdGhpcy5hcHBseT1mdW5jdGlvbih0LG4pe2Zvcih2YXIgbz10Lm1lc2hlcy5zbGljZSgwKSxzPW8ubGVuZ3RoLGE9MDtzPmE7YSsrKXt2YXIgaD1uZXcgQXJyYXksYz1vW2FdO2lmKHIuX2NhbkJlTWVyZ2VkKGMpKXtoLnB1c2goYyk7Zm9yKHZhciBsPWErMTtzPmw7bCsrKXt2YXIgdT1vW2xdO3IuX2NhbkJlTWVyZ2VkKHUpJiZ1Lm1hdGVyaWFsPT09Yy5tYXRlcmlhbCYmdS5jaGVja0NvbGxpc2lvbnM9PT1jLmNoZWNrQ29sbGlzaW9ucyYmKGgucHVzaCh1KSxzLS0sby5zcGxpY2UobCwxKSxsLS0pfWgubGVuZ3RoPDJ8fGUuTWVzaC5NZXJnZU1lc2hlcyhoKX19cmV0dXJuIHZvaWQgMCE9bj9uJiZ0LmNyZWF0ZU9yVXBkYXRlU2VsZWN0aW9uT2N0cmVlKCk6aS5VcGRhdGVTZWxlY3Rpb25UcmVlJiZ0LmNyZWF0ZU9yVXBkYXRlU2VsZWN0aW9uT2N0cmVlKCksITB9fXJldHVybiBfX2V4dGVuZHMoaSx0KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaSxcIlVwZGF0ZVNlbGVjdGlvblRyZWVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGkuX1VwZGF0ZVNlbGVjdGlvblRyZWV9LHNldDpmdW5jdGlvbihlKXtpLl9VcGRhdGVTZWxlY3Rpb25UcmVlPWV9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksaS5fVXBkYXRlU2VsZWN0aW9uVHJlZT0hMSxpfSh0KTtlLk1lcmdlTWVzaGVzT3B0aW1pemF0aW9uPWM7dmFyIGw9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUsdCl7dm9pZCAwPT09ZSYmKGU9NjApLHZvaWQgMD09PXQmJih0PTJlMyksdGhpcy50YXJnZXRGcmFtZVJhdGU9ZSx0aGlzLnRyYWNrZXJEdXJhdGlvbj10LHRoaXMub3B0aW1pemF0aW9ucz1uZXcgQXJyYXl9cmV0dXJuIGUuTG93RGVncmFkYXRpb25BbGxvd2VkPWZ1bmN0aW9uKHQpe3ZhciByPW5ldyBlKHQpLGg9MDtyZXR1cm4gci5vcHRpbWl6YXRpb25zLnB1c2gobmV3IGMoaCkpLHIub3B0aW1pemF0aW9ucy5wdXNoKG5ldyBuKGgpKSxyLm9wdGltaXphdGlvbnMucHVzaChuZXcgcyhoKSksaCsrLHIub3B0aW1pemF0aW9ucy5wdXNoKG5ldyBvKGgpKSxyLm9wdGltaXphdGlvbnMucHVzaChuZXcgYShoKSksaCsrLHIub3B0aW1pemF0aW9ucy5wdXNoKG5ldyBpKGgsMTAyNCkpLHJ9LGUuTW9kZXJhdGVEZWdyYWRhdGlvbkFsbG93ZWQ9ZnVuY3Rpb24odCl7dmFyIGw9bmV3IGUodCksdT0wO3JldHVybiBsLm9wdGltaXphdGlvbnMucHVzaChuZXcgYyh1KSksbC5vcHRpbWl6YXRpb25zLnB1c2gobmV3IG4odSkpLGwub3B0aW1pemF0aW9ucy5wdXNoKG5ldyBzKHUpKSx1KyssbC5vcHRpbWl6YXRpb25zLnB1c2gobmV3IG8odSkpLGwub3B0aW1pemF0aW9ucy5wdXNoKG5ldyBhKHUpKSx1KyssbC5vcHRpbWl6YXRpb25zLnB1c2gobmV3IGkodSw1MTIpKSx1KyssbC5vcHRpbWl6YXRpb25zLnB1c2gobmV3IGgodSkpLHUrKyxsLm9wdGltaXphdGlvbnMucHVzaChuZXcgcih1LDIpKSxsfSxlLkhpZ2hEZWdyYWRhdGlvbkFsbG93ZWQ9ZnVuY3Rpb24odCl7dmFyIGw9bmV3IGUodCksdT0wO3JldHVybiBsLm9wdGltaXphdGlvbnMucHVzaChuZXcgYyh1KSksbC5vcHRpbWl6YXRpb25zLnB1c2gobmV3IG4odSkpLGwub3B0aW1pemF0aW9ucy5wdXNoKG5ldyBzKHUpKSx1KyssbC5vcHRpbWl6YXRpb25zLnB1c2gobmV3IG8odSkpLGwub3B0aW1pemF0aW9ucy5wdXNoKG5ldyBhKHUpKSx1KyssbC5vcHRpbWl6YXRpb25zLnB1c2gobmV3IGkodSwyNTYpKSx1KyssbC5vcHRpbWl6YXRpb25zLnB1c2gobmV3IGgodSkpLHUrKyxsLm9wdGltaXphdGlvbnMucHVzaChuZXcgcih1LDQpKSxsfSxlfSgpO2UuU2NlbmVPcHRpbWl6ZXJPcHRpb25zPWw7dmFyIHU9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7fXJldHVybiBlLl9DaGVja0N1cnJlbnRTdGF0ZT1mdW5jdGlvbih0LGkscixuLG8pe2lmKHQuZ2V0RW5naW5lKCkuZ2V0RnBzKCk+PWkudGFyZ2V0RnJhbWVSYXRlKXJldHVybiB2b2lkKG4mJm4oKSk7Zm9yKHZhciBzPSEwLGE9ITAsaD0wO2g8aS5vcHRpbWl6YXRpb25zLmxlbmd0aDtoKyspe3ZhciBjPWkub3B0aW1pemF0aW9uc1toXTtjLnByaW9yaXR5PT09ciYmKGE9ITEscz1zJiZjLmFwcGx5KHQpKX1yZXR1cm4gYT92b2lkKG8mJm8oKSk6KHMmJnIrKyx2b2lkIHQuZXhlY3V0ZVdoZW5SZWFkeShmdW5jdGlvbigpe3NldFRpbWVvdXQoZnVuY3Rpb24oKXtlLl9DaGVja0N1cnJlbnRTdGF0ZSh0LGkscixuLG8pfSxpLnRyYWNrZXJEdXJhdGlvbil9KSl9LGUuT3B0aW1pemVBc3luYz1mdW5jdGlvbih0LGkscixuKXtpfHwoaT1sLk1vZGVyYXRlRGVncmFkYXRpb25BbGxvd2VkKCkpLHQuZXhlY3V0ZVdoZW5SZWFkeShmdW5jdGlvbigpe3NldFRpbWVvdXQoZnVuY3Rpb24oKXtlLl9DaGVja0N1cnJlbnRTdGF0ZSh0LGksMCxyLG4pfSxpLnRyYWNrZXJEdXJhdGlvbil9KX0sZX0oKTtlLlNjZW5lT3B0aW1pemVyPXV9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0OyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSx0KXt0aGlzLmRpc3RhbmNlPWUsdGhpcy5tZXNoPXR9cmV0dXJuIGV9KCk7ZS5NZXNoTE9ETGV2ZWw9dH0odD1lLkludGVybmFsc3x8KGUuSW50ZXJuYWxzPXt9KSl9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGkoaSxyLG4sbyxzLGEsaCxjKXt2b2lkIDA9PT1hJiYoYT0hMCksdm9pZCAwPT09aCYmKGg9ITEpLHZvaWQgMD09PWMmJihjPWUuVGV4dHVyZS5UUklMSU5FQVJfU0FNUExJTkdNT0RFKSx0LmNhbGwodGhpcyxudWxsLHMsIWEsaCksdGhpcy5mb3JtYXQ9byx0aGlzLl90ZXh0dXJlPXMuZ2V0RW5naW5lKCkuY3JlYXRlUmF3VGV4dHVyZShpLHIsbixvLGEsaCxjKSx0aGlzLndyYXBVPWUuVGV4dHVyZS5DTEFNUF9BRERSRVNTTU9ERSx0aGlzLndyYXBWPWUuVGV4dHVyZS5DTEFNUF9BRERSRVNTTU9ERX1yZXR1cm4gX19leHRlbmRzKGksdCksaS5wcm90b3R5cGUudXBkYXRlPWZ1bmN0aW9uKGUpe3RoaXMuZ2V0U2NlbmUoKS5nZXRFbmdpbmUoKS51cGRhdGVSYXdUZXh0dXJlKHRoaXMuX3RleHR1cmUsZSx0aGlzLmZvcm1hdCx0aGlzLl9pbnZlcnRZKX0saS5DcmVhdGVMdW1pbmFuY2VUZXh0dXJlPWZ1bmN0aW9uKHQscixuLG8scyxhLGgpe3JldHVybiB2b2lkIDA9PT1zJiYocz0hMCksdm9pZCAwPT09YSYmKGE9ITEpLHZvaWQgMD09PWgmJihoPWUuVGV4dHVyZS5UUklMSU5FQVJfU0FNUExJTkdNT0RFKSxuZXcgaSh0LHIsbixlLkVuZ2luZS5URVhUVVJFRk9STUFUX0xVTUlOQU5DRSxvLHMsYSxoKX0saS5DcmVhdGVMdW1pbmFuY2VBbHBoYVRleHR1cmU9ZnVuY3Rpb24odCxyLG4sbyxzLGEsaCl7cmV0dXJuIHZvaWQgMD09PXMmJihzPSEwKSx2b2lkIDA9PT1hJiYoYT0hMSksdm9pZCAwPT09aCYmKGg9ZS5UZXh0dXJlLlRSSUxJTkVBUl9TQU1QTElOR01PREUpLG5ldyBpKHQscixuLGUuRW5naW5lLlRFWFRVUkVGT1JNQVRfTFVNSU5BTkNFX0FMUEhBLG8scyxhLGgpfSxpLkNyZWF0ZUFscGhhVGV4dHVyZT1mdW5jdGlvbih0LHIsbixvLHMsYSxoKXtyZXR1cm4gdm9pZCAwPT09cyYmKHM9ITApLHZvaWQgMD09PWEmJihhPSExKSx2b2lkIDA9PT1oJiYoaD1lLlRleHR1cmUuVFJJTElORUFSX1NBTVBMSU5HTU9ERSksbmV3IGkodCxyLG4sZS5FbmdpbmUuVEVYVFVSRUZPUk1BVF9BTFBIQSxvLHMsYSxoKX0saS5DcmVhdGVSR0JUZXh0dXJlPWZ1bmN0aW9uKHQscixuLG8scyxhLGgpe3JldHVybiB2b2lkIDA9PT1zJiYocz0hMCksdm9pZCAwPT09YSYmKGE9ITEpLHZvaWQgMD09PWgmJihoPWUuVGV4dHVyZS5UUklMSU5FQVJfU0FNUExJTkdNT0RFKSxuZXcgaSh0LHIsbixlLkVuZ2luZS5URVhUVVJFRk9STUFUX1JHQixvLHMsYSxoKX0saS5DcmVhdGVSR0JBVGV4dHVyZT1mdW5jdGlvbih0LHIsbixvLHMsYSxoKXtyZXR1cm4gdm9pZCAwPT09cyYmKHM9ITApLHZvaWQgMD09PWEmJihhPSExKSx2b2lkIDA9PT1oJiYoaD1lLlRleHR1cmUuVFJJTElORUFSX1NBTVBMSU5HTU9ERSksbmV3IGkodCxyLG4sZS5FbmdpbmUuVEVYVFVSRUZPUk1BVF9SR0JBLG8scyxhLGgpfSxpfShlLlRleHR1cmUpO2UuUmF3VGV4dHVyZT10fShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbihlKXtmdW5jdGlvbiB0KHQsaSl7ZS5jYWxsKHRoaXMsdC54LHQueSksdGhpcy5pbmRleD1pfXJldHVybiBfX2V4dGVuZHModCxlKSx0fShlLlZlY3RvcjIpLGk9ZnVuY3Rpb24oKXtmdW5jdGlvbiBpKCl7dGhpcy5lbGVtZW50cz1uZXcgQXJyYXl9cmV0dXJuIGkucHJvdG90eXBlLmFkZD1mdW5jdGlvbihlKXt2YXIgaT10aGlzLHI9bmV3IEFycmF5O3JldHVybiBlLmZvckVhY2goZnVuY3Rpb24oZSl7aWYoMD09PXIubGVuZ3RofHwhZS5lcXVhbHNXaXRoRXBzaWxvbihyWzBdKSl7dmFyIG49bmV3IHQoZSxpLmVsZW1lbnRzLmxlbmd0aCk7ci5wdXNoKG4pLGkuZWxlbWVudHMucHVzaChuKX19KSxyfSxpLnByb3RvdHlwZS5jb21wdXRlQm91bmRzPWZ1bmN0aW9uKCl7dmFyIHQ9bmV3IGUuVmVjdG9yMih0aGlzLmVsZW1lbnRzWzBdLngsdGhpcy5lbGVtZW50c1swXS55KSxpPW5ldyBlLlZlY3RvcjIodGhpcy5lbGVtZW50c1swXS54LHRoaXMuZWxlbWVudHNbMF0ueSk7cmV0dXJuIHRoaXMuZWxlbWVudHMuZm9yRWFjaChmdW5jdGlvbihlKXtlLng8dC54P3QueD1lLng6ZS54PmkueCYmKGkueD1lLngpLGUueTx0Lnk/dC55PWUueTplLnk+aS55JiYoaS55PWUueSl9KSx7bWluOnQsbWF4Omksd2lkdGg6aS54LXQueCxoZWlnaHQ6aS55LXQueX19LGl9KCkscj1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoKXt9cmV0dXJuIHQuUmVjdGFuZ2xlPWZ1bmN0aW9uKHQsaSxyLG4pe3JldHVybltuZXcgZS5WZWN0b3IyKHQsaSksbmV3IGUuVmVjdG9yMihyLGkpLG5ldyBlLlZlY3RvcjIocixuKSxuZXcgZS5WZWN0b3IyKHQsbildfSx0LkNpcmNsZT1mdW5jdGlvbih0LGkscixuKXt2b2lkIDA9PT1pJiYoaT0wKSx2b2lkIDA9PT1yJiYocj0wKSx2b2lkIDA9PT1uJiYobj0zMik7Zm9yKHZhciBvPW5ldyBBcnJheSxzPTAsYT0yKk1hdGguUEkvbixoPTA7bj5oO2grKylvLnB1c2gobmV3IGUuVmVjdG9yMihpK01hdGguY29zKHMpKnQscitNYXRoLnNpbihzKSp0KSkscy09YTtyZXR1cm4gb30sdC5QYXJzZT1mdW5jdGlvbih0KXt2YXIgaSxyPXQuc3BsaXQoL1teLStlRVxcLlxcZF0rLykubWFwKHBhcnNlRmxvYXQpLmZpbHRlcihmdW5jdGlvbihlKXtyZXR1cm4haXNOYU4oZSl9KSxuPVtdO2ZvcihpPTA7aTwoMjE0NzQ4MzY0NiZyLmxlbmd0aCk7aSs9MiluLnB1c2gobmV3IGUuVmVjdG9yMihyW2ldLHJbaSsxXSkpO3JldHVybiBufSx0LlN0YXJ0aW5nQXQ9ZnVuY3Rpb24odCxpKXtyZXR1cm4gZS5QYXRoMi5TdGFydGluZ0F0KHQsaSl9LHR9KCk7ZS5Qb2x5Z29uPXI7dmFyIG49ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQscixuKXt0aGlzLl9wb2ludHM9bmV3IGksdGhpcy5fb3V0bGluZXBvaW50cz1uZXcgaSx0aGlzLl9ob2xlcz1bXSx0aGlzLl9lcG9pbnRzPW5ldyBBcnJheSx0aGlzLl9laG9sZXM9bmV3IEFycmF5LHRoaXMuX25hbWU9dCx0aGlzLl9zY2VuZT1uO3ZhciBvO289ciBpbnN0YW5jZW9mIGUuUGF0aDI/ci5nZXRQb2ludHMoKTpyLHRoaXMuX2FkZFRvZXBvaW50KG8pLHRoaXMuX3BvaW50cy5hZGQobyksdGhpcy5fb3V0bGluZXBvaW50cy5hZGQobyl9cmV0dXJuIHQucHJvdG90eXBlLl9hZGRUb2Vwb2ludD1mdW5jdGlvbihlKXtmb3IodmFyIHQ9MDt0PGUubGVuZ3RoO3QrKyl7dmFyIGk9ZVt0XTt0aGlzLl9lcG9pbnRzLnB1c2goaS54LGkueSl9fSx0LnByb3RvdHlwZS5hZGRIb2xlPWZ1bmN0aW9uKGUpe3RoaXMuX3BvaW50cy5hZGQoZSk7dmFyIHQ9bmV3IGk7cmV0dXJuIHQuYWRkKGUpLHRoaXMuX2hvbGVzLnB1c2godCksdGhpcy5fZWhvbGVzLnB1c2godGhpcy5fZXBvaW50cy5sZW5ndGgvMiksdGhpcy5fYWRkVG9lcG9pbnQoZSksdGhpc30sdC5wcm90b3R5cGUuYnVpbGQ9ZnVuY3Rpb24odCxpKXt2YXIgcj10aGlzO3ZvaWQgMD09PXQmJih0PSExKTt2YXIgbj1uZXcgZS5NZXNoKHRoaXMuX25hbWUsdGhpcy5fc2NlbmUpLG89W10scz1bXSxhPVtdLGg9dGhpcy5fcG9pbnRzLmNvbXB1dGVCb3VuZHMoKTt0aGlzLl9wb2ludHMuZWxlbWVudHMuZm9yRWFjaChmdW5jdGlvbihlKXtvLnB1c2goMCwxLDApLHMucHVzaChlLngsMCxlLnkpLGEucHVzaCgoZS54LWgubWluLngpL2gud2lkdGgsKGUueS1oLm1pbi55KS9oLmhlaWdodCl9KTtmb3IodmFyIGM9W10sbD1FYXJjdXQuZWFyY3V0KHRoaXMuX2Vwb2ludHMsdGhpcy5fZWhvbGVzLDIpLHU9MDt1PGwubGVuZ3RoO3UrKyljLnB1c2gobFt1XSk7aWYoaT4wKXt2YXIgZj1zLmxlbmd0aC8zO3RoaXMuX3BvaW50cy5lbGVtZW50cy5mb3JFYWNoKGZ1bmN0aW9uKGUpe28ucHVzaCgwLC0xLDApLHMucHVzaChlLngsLWksZS55KSxhLnB1c2goMS0oZS54LWgubWluLngpL2gud2lkdGgsMS0oZS55LWgubWluLnkpL2guaGVpZ2h0KX0pO2Zvcih2YXIgZD1jLmxlbmd0aCx1PTA7ZD51O3UrPTMpe3ZhciBwPWNbdSswXSxfPWNbdSsxXSxtPWNbdSsyXTtjLnB1c2gobStmKSxjLnB1c2goXytmKSxjLnB1c2gocCtmKX10aGlzLmFkZFNpZGUocyxvLGEsYyxoLHRoaXMuX291dGxpbmVwb2ludHMsaSwhMSksdGhpcy5faG9sZXMuZm9yRWFjaChmdW5jdGlvbihlKXtyLmFkZFNpZGUocyxvLGEsYyxoLGUsaSwhMCl9KX1yZXR1cm4gbi5zZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuUG9zaXRpb25LaW5kLHMsdCksbi5zZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuTm9ybWFsS2luZCxvLHQpLG4uc2V0VmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLlVWS2luZCxhLHQpLG4uc2V0SW5kaWNlcyhjKSxufSx0LnByb3RvdHlwZS5hZGRTaWRlPWZ1bmN0aW9uKHQsaSxyLG4sbyxzLGEsaCl7Zm9yKHZhciBjPXQubGVuZ3RoLzMsbD0wLHU9MDt1PHMuZWxlbWVudHMubGVuZ3RoO3UrKyl7dmFyIGYsZD1zLmVsZW1lbnRzW3VdO2Y9dSsxPnMuZWxlbWVudHMubGVuZ3RoLTE/cy5lbGVtZW50c1swXTpzLmVsZW1lbnRzW3UrMV0sdC5wdXNoKGQueCwwLGQueSksdC5wdXNoKGQueCwtYSxkLnkpLHQucHVzaChmLngsMCxmLnkpLHQucHVzaChmLngsLWEsZi55KTt2YXIgcD1uZXcgZS5WZWN0b3IzKGQueCwwLGQueSksXz1uZXcgZS5WZWN0b3IzKGYueCwwLGYueSksbT1fLnN1YnRyYWN0KHApLGc9bmV3IGUuVmVjdG9yMygwLDEsMCksdj1lLlZlY3RvcjMuQ3Jvc3MobSxnKTt2PXYubm9ybWFsaXplKCksci5wdXNoKGwvby53aWR0aCwwKSxyLnB1c2gobC9vLndpZHRoLDEpLGwrPW0ubGVuZ3RoKCksci5wdXNoKGwvby53aWR0aCwwKSxyLnB1c2gobC9vLndpZHRoLDEpLGg/KGkucHVzaCh2Lngsdi55LHYueiksaS5wdXNoKHYueCx2Lnksdi56KSxpLnB1c2godi54LHYueSx2LnopLGkucHVzaCh2Lngsdi55LHYueiksbi5wdXNoKGMpLG4ucHVzaChjKzIpLG4ucHVzaChjKzEpLG4ucHVzaChjKzEpLG4ucHVzaChjKzIpLG4ucHVzaChjKzMpKTooaS5wdXNoKC12LngsLXYueSwtdi56KSxpLnB1c2goLXYueCwtdi55LC12LnopLGkucHVzaCgtdi54LC12LnksLXYueiksaS5wdXNoKC12LngsLXYueSwtdi56KSxuLnB1c2goYyksbi5wdXNoKGMrMSksbi5wdXNoKGMrMiksbi5wdXNoKGMrMSksbi5wdXNoKGMrMyksbi5wdXNoKGMrMikpLGMrPTR9fSx0fSgpO2UuUG9seWdvbk1lc2hCdWlsZGVyPW59KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGkscil7dm9pZCAwPT09ciYmKHI9MiksdGhpcy5tYXhEZXB0aD1yLHRoaXMuZHluYW1pY0NvbnRlbnQ9bmV3IEFycmF5LHRoaXMuX21heEJsb2NrQ2FwYWNpdHk9aXx8NjQsdGhpcy5fc2VsZWN0aW9uQ29udGVudD1uZXcgZS5TbWFydEFycmF5KDEwMjQpLHRoaXMuX2NyZWF0aW9uRnVuYz10fXJldHVybiB0LnByb3RvdHlwZS51cGRhdGU9ZnVuY3Rpb24oZSxpLHIpe3QuX0NyZWF0ZUJsb2NrcyhlLGkscix0aGlzLl9tYXhCbG9ja0NhcGFjaXR5LDAsdGhpcy5tYXhEZXB0aCx0aGlzLHRoaXMuX2NyZWF0aW9uRnVuYyl9LHQucHJvdG90eXBlLmFkZE1lc2g9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PTA7dDx0aGlzLmJsb2Nrcy5sZW5ndGg7dCsrKXt2YXIgaT10aGlzLmJsb2Nrc1t0XTtpLmFkZEVudHJ5KGUpfX0sdC5wcm90b3R5cGUuc2VsZWN0PWZ1bmN0aW9uKGUsdCl7dGhpcy5fc2VsZWN0aW9uQ29udGVudC5yZXNldCgpO2Zvcih2YXIgaT0wO2k8dGhpcy5ibG9ja3MubGVuZ3RoO2krKyl7dmFyIHI9dGhpcy5ibG9ja3NbaV07ci5zZWxlY3QoZSx0aGlzLl9zZWxlY3Rpb25Db250ZW50LHQpfXJldHVybiB0P3RoaXMuX3NlbGVjdGlvbkNvbnRlbnQuY29uY2F0KHRoaXMuZHluYW1pY0NvbnRlbnQpOnRoaXMuX3NlbGVjdGlvbkNvbnRlbnQuY29uY2F0V2l0aE5vRHVwbGljYXRlKHRoaXMuZHluYW1pY0NvbnRlbnQpLHRoaXMuX3NlbGVjdGlvbkNvbnRlbnR9LHQucHJvdG90eXBlLmludGVyc2VjdHM9ZnVuY3Rpb24oZSx0LGkpe3RoaXMuX3NlbGVjdGlvbkNvbnRlbnQucmVzZXQoKTtmb3IodmFyIHI9MDtyPHRoaXMuYmxvY2tzLmxlbmd0aDtyKyspe3ZhciBuPXRoaXMuYmxvY2tzW3JdO24uaW50ZXJzZWN0cyhlLHQsdGhpcy5fc2VsZWN0aW9uQ29udGVudCxpKX1yZXR1cm4gaT90aGlzLl9zZWxlY3Rpb25Db250ZW50LmNvbmNhdCh0aGlzLmR5bmFtaWNDb250ZW50KTp0aGlzLl9zZWxlY3Rpb25Db250ZW50LmNvbmNhdFdpdGhOb0R1cGxpY2F0ZSh0aGlzLmR5bmFtaWNDb250ZW50KSx0aGlzLl9zZWxlY3Rpb25Db250ZW50fSx0LnByb3RvdHlwZS5pbnRlcnNlY3RzUmF5PWZ1bmN0aW9uKGUpe3RoaXMuX3NlbGVjdGlvbkNvbnRlbnQucmVzZXQoKTtmb3IodmFyIHQ9MDt0PHRoaXMuYmxvY2tzLmxlbmd0aDt0Kyspe3ZhciBpPXRoaXMuYmxvY2tzW3RdO2kuaW50ZXJzZWN0c1JheShlLHRoaXMuX3NlbGVjdGlvbkNvbnRlbnQpfXJldHVybiB0aGlzLl9zZWxlY3Rpb25Db250ZW50LmNvbmNhdFdpdGhOb0R1cGxpY2F0ZSh0aGlzLmR5bmFtaWNDb250ZW50KSx0aGlzLl9zZWxlY3Rpb25Db250ZW50fSx0Ll9DcmVhdGVCbG9ja3M9ZnVuY3Rpb24odCxpLHIsbixvLHMsYSxoKXthLmJsb2Nrcz1uZXcgQXJyYXk7Zm9yKHZhciBjPW5ldyBlLlZlY3RvcjMoKGkueC10LngpLzIsKGkueS10LnkpLzIsKGkuei10LnopLzIpLGw9MDsyPmw7bCsrKWZvcih2YXIgdT0wOzI+dTt1KyspZm9yKHZhciBmPTA7Mj5mO2YrKyl7dmFyIGQ9dC5hZGQoYy5tdWx0aXBseUJ5RmxvYXRzKGwsdSxmKSkscD10LmFkZChjLm11bHRpcGx5QnlGbG9hdHMobCsxLHUrMSxmKzEpKSxfPW5ldyBlLk9jdHJlZUJsb2NrKGQscCxuLG8rMSxzLGgpO18uYWRkRW50cmllcyhyKSxhLmJsb2Nrcy5wdXNoKF8pfX0sdC5DcmVhdGlvbkZ1bmNGb3JNZXNoZXM9ZnVuY3Rpb24oZSx0KXshZS5pc0Jsb2NrZWQmJmUuZ2V0Qm91bmRpbmdJbmZvKCkuYm91bmRpbmdCb3guaW50ZXJzZWN0c01pbk1heCh0Lm1pblBvaW50LHQubWF4UG9pbnQpJiZ0LmVudHJpZXMucHVzaChlKX0sdC5DcmVhdGlvbkZ1bmNGb3JTdWJNZXNoZXM9ZnVuY3Rpb24oZSx0KXtlLmdldEJvdW5kaW5nSW5mbygpLmJvdW5kaW5nQm94LmludGVyc2VjdHNNaW5NYXgodC5taW5Qb2ludCx0Lm1heFBvaW50KSYmdC5lbnRyaWVzLnB1c2goZSl9LHR9KCk7ZS5PY3RyZWU9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KGUsdCxpLHIsbixvKXt0aGlzLmVudHJpZXM9bmV3IEFycmF5LHRoaXMuX2JvdW5kaW5nVmVjdG9ycz1uZXcgQXJyYXksdGhpcy5fY2FwYWNpdHk9aSx0aGlzLl9kZXB0aD1yLHRoaXMuX21heERlcHRoPW4sdGhpcy5fY3JlYXRpb25GdW5jPW8sdGhpcy5fbWluUG9pbnQ9ZSx0aGlzLl9tYXhQb2ludD10LHRoaXMuX2JvdW5kaW5nVmVjdG9ycy5wdXNoKGUuY2xvbmUoKSksdGhpcy5fYm91bmRpbmdWZWN0b3JzLnB1c2godC5jbG9uZSgpKSx0aGlzLl9ib3VuZGluZ1ZlY3RvcnMucHVzaChlLmNsb25lKCkpLHRoaXMuX2JvdW5kaW5nVmVjdG9yc1syXS54PXQueCx0aGlzLl9ib3VuZGluZ1ZlY3RvcnMucHVzaChlLmNsb25lKCkpLHRoaXMuX2JvdW5kaW5nVmVjdG9yc1szXS55PXQueSx0aGlzLl9ib3VuZGluZ1ZlY3RvcnMucHVzaChlLmNsb25lKCkpLHRoaXMuX2JvdW5kaW5nVmVjdG9yc1s0XS56PXQueix0aGlzLl9ib3VuZGluZ1ZlY3RvcnMucHVzaCh0LmNsb25lKCkpLHRoaXMuX2JvdW5kaW5nVmVjdG9yc1s1XS56PWUueix0aGlzLl9ib3VuZGluZ1ZlY3RvcnMucHVzaCh0LmNsb25lKCkpLHRoaXMuX2JvdW5kaW5nVmVjdG9yc1s2XS54PWUueCx0aGlzLl9ib3VuZGluZ1ZlY3RvcnMucHVzaCh0LmNsb25lKCkpLHRoaXMuX2JvdW5kaW5nVmVjdG9yc1s3XS55PWUueX1yZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwiY2FwYWNpdHlcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2NhcGFjaXR5fSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcIm1pblBvaW50XCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9taW5Qb2ludH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJtYXhQb2ludFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fbWF4UG9pbnR9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksdC5wcm90b3R5cGUuYWRkRW50cnk9ZnVuY3Rpb24oZSl7aWYodGhpcy5ibG9ja3MpZm9yKHZhciB0PTA7dDx0aGlzLmJsb2Nrcy5sZW5ndGg7dCsrKXt2YXIgaT10aGlzLmJsb2Nrc1t0XTtpLmFkZEVudHJ5KGUpfWVsc2UgdGhpcy5fY3JlYXRpb25GdW5jKGUsdGhpcyksdGhpcy5lbnRyaWVzLmxlbmd0aD50aGlzLmNhcGFjaXR5JiZ0aGlzLl9kZXB0aDx0aGlzLl9tYXhEZXB0aCYmdGhpcy5jcmVhdGVJbm5lckJsb2NrcygpfSx0LnByb3RvdHlwZS5hZGRFbnRyaWVzPWZ1bmN0aW9uKGUpe2Zvcih2YXIgdD0wO3Q8ZS5sZW5ndGg7dCsrKXt2YXIgaT1lW3RdO3RoaXMuYWRkRW50cnkoaSl9fSx0LnByb3RvdHlwZS5zZWxlY3Q9ZnVuY3Rpb24odCxpLHIpe2lmKGUuQm91bmRpbmdCb3guSXNJbkZydXN0dW0odGhpcy5fYm91bmRpbmdWZWN0b3JzLHQpKXtpZih0aGlzLmJsb2Nrcyl7Zm9yKHZhciBuPTA7bjx0aGlzLmJsb2Nrcy5sZW5ndGg7bisrKXt2YXIgbz10aGlzLmJsb2Nrc1tuXTtvLnNlbGVjdCh0LGkscil9cmV0dXJufXI/aS5jb25jYXQodGhpcy5lbnRyaWVzKTppLmNvbmNhdFdpdGhOb0R1cGxpY2F0ZSh0aGlzLmVudHJpZXMpfX0sdC5wcm90b3R5cGUuaW50ZXJzZWN0cz1mdW5jdGlvbih0LGkscixuKXtpZihlLkJvdW5kaW5nQm94LkludGVyc2VjdHNTcGhlcmUodGhpcy5fbWluUG9pbnQsdGhpcy5fbWF4UG9pbnQsdCxpKSl7aWYodGhpcy5ibG9ja3Mpe2Zvcih2YXIgbz0wO288dGhpcy5ibG9ja3MubGVuZ3RoO28rKyl7dmFyIHM9dGhpcy5ibG9ja3Nbb107cy5pbnRlcnNlY3RzKHQsaSxyLG4pfXJldHVybn1uP3IuY29uY2F0KHRoaXMuZW50cmllcyk6ci5jb25jYXRXaXRoTm9EdXBsaWNhdGUodGhpcy5lbnRyaWVzKX19LHQucHJvdG90eXBlLmludGVyc2VjdHNSYXk9ZnVuY3Rpb24oZSx0KXtpZihlLmludGVyc2VjdHNCb3hNaW5NYXgodGhpcy5fbWluUG9pbnQsdGhpcy5fbWF4UG9pbnQpKXtpZih0aGlzLmJsb2Nrcyl7Zm9yKHZhciBpPTA7aTx0aGlzLmJsb2Nrcy5sZW5ndGg7aSsrKXt2YXIgcj10aGlzLmJsb2Nrc1tpXTtyLmludGVyc2VjdHNSYXkoZSx0KX1yZXR1cm59dC5jb25jYXRXaXRoTm9EdXBsaWNhdGUodGhpcy5lbnRyaWVzKX19LHQucHJvdG90eXBlLmNyZWF0ZUlubmVyQmxvY2tzPWZ1bmN0aW9uKCl7ZS5PY3RyZWUuX0NyZWF0ZUJsb2Nrcyh0aGlzLl9taW5Qb2ludCx0aGlzLl9tYXhQb2ludCx0aGlzLmVudHJpZXMsdGhpcy5fY2FwYWNpdHksdGhpcy5fZGVwdGgsdGhpcy5fbWF4RGVwdGgsdGhpcyx0aGlzLl9jcmVhdGlvbkZ1bmMpfSx0fSgpO2UuT2N0cmVlQmxvY2s9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gaShpLHIsbixvLHMsYSxoLGMpe3ZhciBsPXRoaXM7dm9pZCAwPT09YSYmKGE9ZS5UZXh0dXJlLkJJTElORUFSX1NBTVBMSU5HTU9ERSksdC5jYWxsKHRoaXMsaSxcImJsdXJcIixbXCJzY3JlZW5TaXplXCIsXCJkaXJlY3Rpb25cIixcImJsdXJXaWR0aFwiXSxudWxsLG8scyxhLGgsYyksdGhpcy5kaXJlY3Rpb249cix0aGlzLmJsdXJXaWR0aD1uLHRoaXMub25BcHBseU9ic2VydmFibGUuYWRkKGZ1bmN0aW9uKGUpe2Uuc2V0RmxvYXQyKFwic2NyZWVuU2l6ZVwiLGwud2lkdGgsbC5oZWlnaHQpLGUuc2V0VmVjdG9yMihcImRpcmVjdGlvblwiLGwuZGlyZWN0aW9uKSxlLnNldEZsb2F0KFwiYmx1cldpZHRoXCIsbC5ibHVyV2lkdGgpfSl9cmV0dXJuIF9fZXh0ZW5kcyhpLHQpLGl9KGUuUG9zdFByb2Nlc3MpO2UuQmx1clBvc3RQcm9jZXNzPXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGkoaSxyLG4sbyxzLGEsaCxjLGwsdSl7dmFyIGY9dGhpczt0LmNhbGwodGhpcyxpLFwicmVmcmFjdGlvblwiLFtcImJhc2VDb2xvclwiLFwiZGVwdGhcIixcImNvbG9yTGV2ZWxcIl0sW1wicmVmcmFjdGlvblNhbXBsZXJcIl0sYSxoLGMsbCx1KSx0aGlzLmNvbG9yPW4sdGhpcy5kZXB0aD1vLHRoaXMuY29sb3JMZXZlbD1zLHRoaXMub25BY3RpdmF0ZU9ic2VydmFibGUuYWRkKGZ1bmN0aW9uKHQpe2YuX3JlZlJleHR1cmU9Zi5fcmVmUmV4dHVyZXx8bmV3IGUuVGV4dHVyZShyLHQuZ2V0U2NlbmUoKSl9KSx0aGlzLm9uQXBwbHlPYnNlcnZhYmxlLmFkZChmdW5jdGlvbihlKXtlLnNldENvbG9yMyhcImJhc2VDb2xvclwiLGYuY29sb3IpLGUuc2V0RmxvYXQoXCJkZXB0aFwiLGYuZGVwdGgpLGUuc2V0RmxvYXQoXCJjb2xvckxldmVsXCIsZi5jb2xvckxldmVsKSxlLnNldFRleHR1cmUoXCJyZWZyYWN0aW9uU2FtcGxlclwiLGYuX3JlZlJleHR1cmUpfSl9cmV0dXJuIF9fZXh0ZW5kcyhpLHQpLGkucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oZSl7dGhpcy5fcmVmUmV4dHVyZSYmdGhpcy5fcmVmUmV4dHVyZS5kaXNwb3NlKCksdC5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMsZSl9LGl9KGUuUG9zdFByb2Nlc3MpO2UuUmVmcmFjdGlvblBvc3RQcm9jZXNzPXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQodCxpLHIsbixvLHMpe2UuY2FsbCh0aGlzLHQsXCJibGFja0FuZFdoaXRlXCIsbnVsbCxudWxsLGkscixuLG8scyl9cmV0dXJuIF9fZXh0ZW5kcyh0LGUpLHR9KGUuUG9zdFByb2Nlc3MpO2UuQmxhY2tBbmRXaGl0ZVBvc3RQcm9jZXNzPXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQodCxpLHIsbixvLHMsYSl7dmFyIGg9dGhpcztlLmNhbGwodGhpcyx0LFwiY29udm9sdXRpb25cIixbXCJrZXJuZWxcIixcInNjcmVlblNpemVcIl0sbnVsbCxyLG4sbyxzLGEpLHRoaXMua2VybmVsPWksdGhpcy5vbkFwcGx5PWZ1bmN0aW9uKGUpe2Uuc2V0RmxvYXQyKFwic2NyZWVuU2l6ZVwiLGgud2lkdGgsaC5oZWlnaHQpLGUuc2V0QXJyYXkoXCJrZXJuZWxcIixoLmtlcm5lbCl9fXJldHVybiBfX2V4dGVuZHModCxlKSx0LkVkZ2VEZXRlY3QwS2VybmVsPVsxLDAsLTEsMCwwLDAsLTEsMCwxXSx0LkVkZ2VEZXRlY3QxS2VybmVsPVswLDEsMCwxLC00LDEsMCwxLDBdLHQuRWRnZURldGVjdDJLZXJuZWw9Wy0xLC0xLC0xLC0xLDgsLTEsLTEsLTEsLTFdLHQuU2hhcnBlbktlcm5lbD1bMCwtMSwwLC0xLDUsLTEsMCwtMSwwXSx0LkVtYm9zc0tlcm5lbD1bLTIsLTEsMCwtMSwxLDEsMCwxLDJdLHQuR2F1c3NpYW5LZXJuZWw9WzAsMSwwLDEsMSwxLDAsMSwwXSx0fShlLlBvc3RQcm9jZXNzKTtlLkNvbnZvbHV0aW9uUG9zdFByb2Nlc3M9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdCh0LGkscixuLG8scyxhKXt2YXIgaD10aGlzO2UuY2FsbCh0aGlzLHQsXCJmaWx0ZXJcIixbXCJrZXJuZWxNYXRyaXhcIl0sbnVsbCxyLG4sbyxzLGEpLHRoaXMua2VybmVsTWF0cml4PWksXG50aGlzLm9uQXBwbHk9ZnVuY3Rpb24oZSl7ZS5zZXRNYXRyaXgoXCJrZXJuZWxNYXRyaXhcIixoLmtlcm5lbE1hdHJpeCl9fXJldHVybiBfX2V4dGVuZHModCxlKSx0fShlLlBvc3RQcm9jZXNzKTtlLkZpbHRlclBvc3RQcm9jZXNzPXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQodCxpLHIsbixvLHMpe3ZhciBhPXRoaXM7ZS5jYWxsKHRoaXMsdCxcImZ4YWFcIixbXCJ0ZXhlbFNpemVcIl0sbnVsbCxpLHIsbixvLHMpLHRoaXMub25TaXplQ2hhbmdlZE9ic2VydmFibGUuYWRkKGZ1bmN0aW9uKCl7YS50ZXhlbFdpZHRoPTEvYS53aWR0aCxhLnRleGVsSGVpZ2h0PTEvYS5oZWlnaHR9KSx0aGlzLm9uQXBwbHlPYnNlcnZhYmxlLmFkZChmdW5jdGlvbihlKXtlLnNldEZsb2F0MihcInRleGVsU2l6ZVwiLGEudGV4ZWxXaWR0aCxhLnRleGVsSGVpZ2h0KX0pfXJldHVybiBfX2V4dGVuZHModCxlKSx0fShlLlBvc3RQcm9jZXNzKTtlLkZ4YWFQb3N0UHJvY2Vzcz10fShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbih0KXtmdW5jdGlvbiBpKGkscixuLG8scyxhKXt2YXIgaD10aGlzO3QuY2FsbCh0aGlzLGksXCJzdGVyZW9zY29waWNJbnRlcmxhY2VcIixbXCJzdGVwU2l6ZVwiXSxbXCJjYW1BU2FtcGxlclwiXSwxLHJbMV0sbyxzLGEsbj9cIiNkZWZpbmUgSVNfU1RFUkVPU0NPUElDX0hPUklaIDFcIjp2b2lkIDApLHRoaXMuX3Bhc3NlZFByb2Nlc3M9clswXS5fcmlnUG9zdFByb2Nlc3MsdGhpcy5fc3RlcFNpemU9bmV3IGUuVmVjdG9yMigxL3RoaXMud2lkdGgsMS90aGlzLmhlaWdodCksdGhpcy5vblNpemVDaGFuZ2VkT2JzZXJ2YWJsZS5hZGQoZnVuY3Rpb24oKXtoLl9zdGVwU2l6ZT1uZXcgZS5WZWN0b3IyKDEvaC53aWR0aCwxL2guaGVpZ2h0KX0pLHRoaXMub25BcHBseU9ic2VydmFibGUuYWRkKGZ1bmN0aW9uKGUpe2Uuc2V0VGV4dHVyZUZyb21Qb3N0UHJvY2VzcyhcImNhbUFTYW1wbGVyXCIsaC5fcGFzc2VkUHJvY2VzcyksZS5zZXRGbG9hdDIoXCJzdGVwU2l6ZVwiLGguX3N0ZXBTaXplLngsaC5fc3RlcFNpemUueSl9KX1yZXR1cm4gX19leHRlbmRzKGksdCksaX0oZS5Qb3N0UHJvY2Vzcyk7ZS5TdGVyZW9zY29waWNJbnRlcmxhY2VQb3N0UHJvY2Vzcz10fShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCxpLHIsbixvKXt0aGlzLnNpemU9dCx0aGlzLnBvc2l0aW9uPWksdGhpcy5kaXNwb3NlPWZ1bmN0aW9uKCl7dGhpcy50ZXh0dXJlJiZ0aGlzLnRleHR1cmUuZGlzcG9zZSgpO3ZhciBlPXRoaXMuX3N5c3RlbS5sZW5zRmxhcmVzLmluZGV4T2YodGhpcyk7dGhpcy5fc3lzdGVtLmxlbnNGbGFyZXMuc3BsaWNlKGUsMSl9LHRoaXMuY29sb3I9cnx8bmV3IGUuQ29sb3IzKDEsMSwxKSx0aGlzLnRleHR1cmU9bj9uZXcgZS5UZXh0dXJlKG4sby5nZXRTY2VuZSgpLCEwKTpudWxsLHRoaXMuX3N5c3RlbT1vLG8ubGVuc0ZsYXJlcy5wdXNoKHRoaXMpfXJldHVybiB0fSgpO2UuTGVuc0ZsYXJlPXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGkscil7dGhpcy5uYW1lPXQsdGhpcy5sZW5zRmxhcmVzPW5ldyBBcnJheSx0aGlzLmJvcmRlckxpbWl0PTMwMCx0aGlzLmxheWVyTWFzaz0yNjg0MzU0NTUsdGhpcy5fdmVydGV4QnVmZmVycz17fSx0aGlzLl9pc0VuYWJsZWQ9ITAsdGhpcy5fc2NlbmU9cix0aGlzLl9lbWl0dGVyPWksdGhpcy5pZD10LHIubGVuc0ZsYXJlU3lzdGVtcy5wdXNoKHRoaXMpLHRoaXMubWVzaGVzU2VsZWN0aW9uUHJlZGljYXRlPWZ1bmN0aW9uKGUpe3JldHVybiBlLm1hdGVyaWFsJiZlLmlzVmlzaWJsZSYmZS5pc0VuYWJsZWQoKSYmZS5pc0Jsb2NrZXImJjAhPShlLmxheWVyTWFzayZyLmFjdGl2ZUNhbWVyYS5sYXllck1hc2spfTt2YXIgbj1yLmdldEVuZ2luZSgpLG89W107by5wdXNoKDEsMSksby5wdXNoKC0xLDEpLG8ucHVzaCgtMSwtMSksby5wdXNoKDEsLTEpLHRoaXMuX3ZlcnRleEJ1ZmZlcnNbZS5WZXJ0ZXhCdWZmZXIuUG9zaXRpb25LaW5kXT1uZXcgZS5WZXJ0ZXhCdWZmZXIobixvLGUuVmVydGV4QnVmZmVyLlBvc2l0aW9uS2luZCwhMSwhMSwyKTt2YXIgcz1bXTtzLnB1c2goMCkscy5wdXNoKDEpLHMucHVzaCgyKSxzLnB1c2goMCkscy5wdXNoKDIpLHMucHVzaCgzKSx0aGlzLl9pbmRleEJ1ZmZlcj1uLmNyZWF0ZUluZGV4QnVmZmVyKHMpLHRoaXMuX2VmZmVjdD1uLmNyZWF0ZUVmZmVjdChcImxlbnNGbGFyZVwiLFtlLlZlcnRleEJ1ZmZlci5Qb3NpdGlvbktpbmRdLFtcImNvbG9yXCIsXCJ2aWV3cG9ydE1hdHJpeFwiXSxbXCJ0ZXh0dXJlU2FtcGxlclwiXSxcIlwiKX1yZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwiaXNFbmFibGVkXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9pc0VuYWJsZWR9LHNldDpmdW5jdGlvbihlKXt0aGlzLl9pc0VuYWJsZWQ9ZX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSx0LnByb3RvdHlwZS5nZXRTY2VuZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9zY2VuZX0sdC5wcm90b3R5cGUuZ2V0RW1pdHRlcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9lbWl0dGVyfSx0LnByb3RvdHlwZS5zZXRFbWl0dGVyPWZ1bmN0aW9uKGUpe3RoaXMuX2VtaXR0ZXI9ZX0sdC5wcm90b3R5cGUuZ2V0RW1pdHRlclBvc2l0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2VtaXR0ZXIuZ2V0QWJzb2x1dGVQb3NpdGlvbj90aGlzLl9lbWl0dGVyLmdldEFic29sdXRlUG9zaXRpb24oKTp0aGlzLl9lbWl0dGVyLnBvc2l0aW9ufSx0LnByb3RvdHlwZS5jb21wdXRlRWZmZWN0aXZlUG9zaXRpb249ZnVuY3Rpb24odCl7dmFyIGk9dGhpcy5nZXRFbWl0dGVyUG9zaXRpb24oKTtyZXR1cm4gaT1lLlZlY3RvcjMuUHJvamVjdChpLGUuTWF0cml4LklkZW50aXR5KCksdGhpcy5fc2NlbmUuZ2V0VHJhbnNmb3JtTWF0cml4KCksdCksdGhpcy5fcG9zaXRpb25YPWkueCx0aGlzLl9wb3NpdGlvblk9aS55LGk9ZS5WZWN0b3IzLlRyYW5zZm9ybUNvb3JkaW5hdGVzKHRoaXMuZ2V0RW1pdHRlclBvc2l0aW9uKCksdGhpcy5fc2NlbmUuZ2V0Vmlld01hdHJpeCgpKSxpLno+MCYmdGhpcy5fcG9zaXRpb25YPnQueCYmdGhpcy5fcG9zaXRpb25YPHQueCt0LndpZHRoJiZ0aGlzLl9wb3NpdGlvblk+dC55JiZ0aGlzLl9wb3NpdGlvblk8dC55K3QuaGVpZ2h0fSx0LnByb3RvdHlwZS5faXNWaXNpYmxlPWZ1bmN0aW9uKCl7aWYoIXRoaXMuX2lzRW5hYmxlZClyZXR1cm4hMTt2YXIgdD10aGlzLmdldEVtaXR0ZXJQb3NpdGlvbigpLGk9dC5zdWJ0cmFjdCh0aGlzLl9zY2VuZS5hY3RpdmVDYW1lcmEucG9zaXRpb24pLHI9aS5sZW5ndGgoKTtpLm5vcm1hbGl6ZSgpO3ZhciBuPW5ldyBlLlJheSh0aGlzLl9zY2VuZS5hY3RpdmVDYW1lcmEucG9zaXRpb24saSksbz10aGlzLl9zY2VuZS5waWNrV2l0aFJheShuLHRoaXMubWVzaGVzU2VsZWN0aW9uUHJlZGljYXRlLCEwKTtyZXR1cm4hby5oaXR8fG8uZGlzdGFuY2U+cn0sdC5wcm90b3R5cGUucmVuZGVyPWZ1bmN0aW9uKCl7aWYoIXRoaXMuX2VmZmVjdC5pc1JlYWR5KCkpcmV0dXJuITE7dmFyIHQ9dGhpcy5fc2NlbmUuZ2V0RW5naW5lKCksaT10aGlzLl9zY2VuZS5hY3RpdmVDYW1lcmEudmlld3BvcnQscj1pLnRvR2xvYmFsKHQuZ2V0UmVuZGVyV2lkdGgoITApLHQuZ2V0UmVuZGVySGVpZ2h0KCEwKSk7aWYoIXRoaXMuY29tcHV0ZUVmZmVjdGl2ZVBvc2l0aW9uKHIpKXJldHVybiExO2lmKCF0aGlzLl9pc1Zpc2libGUoKSlyZXR1cm4hMTt2YXIgbixvO249dGhpcy5fcG9zaXRpb25YPHRoaXMuYm9yZGVyTGltaXQrci54P3RoaXMuYm9yZGVyTGltaXQrci54LXRoaXMuX3Bvc2l0aW9uWDp0aGlzLl9wb3NpdGlvblg+ci54K3Iud2lkdGgtdGhpcy5ib3JkZXJMaW1pdD90aGlzLl9wb3NpdGlvblgtci54LXIud2lkdGgrdGhpcy5ib3JkZXJMaW1pdDowLG89dGhpcy5fcG9zaXRpb25ZPHRoaXMuYm9yZGVyTGltaXQrci55P3RoaXMuYm9yZGVyTGltaXQrci55LXRoaXMuX3Bvc2l0aW9uWTp0aGlzLl9wb3NpdGlvblk+ci55K3IuaGVpZ2h0LXRoaXMuYm9yZGVyTGltaXQ/dGhpcy5fcG9zaXRpb25ZLXIueS1yLmhlaWdodCt0aGlzLmJvcmRlckxpbWl0OjA7dmFyIHM9bj5vP246bztzPnRoaXMuYm9yZGVyTGltaXQmJihzPXRoaXMuYm9yZGVyTGltaXQpO3ZhciBhPTEtcy90aGlzLmJvcmRlckxpbWl0O2lmKDA+YSlyZXR1cm4hMTthPjEmJihhPTEpO3ZhciBoPXIueCtyLndpZHRoLzIsYz1yLnkrci5oZWlnaHQvMixsPWgtdGhpcy5fcG9zaXRpb25YLHU9Yy10aGlzLl9wb3NpdGlvblk7dC5lbmFibGVFZmZlY3QodGhpcy5fZWZmZWN0KSx0LnNldFN0YXRlKCExKSx0LnNldERlcHRoQnVmZmVyKCExKSx0LnNldEFscGhhTW9kZShlLkVuZ2luZS5BTFBIQV9PTkVPTkUpLHQuYmluZEJ1ZmZlcnModGhpcy5fdmVydGV4QnVmZmVycyx0aGlzLl9pbmRleEJ1ZmZlcix0aGlzLl9lZmZlY3QpO2Zvcih2YXIgZj0wO2Y8dGhpcy5sZW5zRmxhcmVzLmxlbmd0aDtmKyspe3ZhciBkPXRoaXMubGVuc0ZsYXJlc1tmXSxwPWgtbCpkLnBvc2l0aW9uLF89Yy11KmQucG9zaXRpb24sbT1kLnNpemUsZz1kLnNpemUqdC5nZXRBc3BlY3RSYXRpbyh0aGlzLl9zY2VuZS5hY3RpdmVDYW1lcmEsITApLHY9MioocC9yLndpZHRoKS0xLHk9MS0yKihfL3IuaGVpZ2h0KSx4PWUuTWF0cml4LkZyb21WYWx1ZXMobS8yLDAsMCwwLDAsZy8yLDAsMCwwLDAsMSwwLHYseSwwLDEpO3RoaXMuX2VmZmVjdC5zZXRNYXRyaXgoXCJ2aWV3cG9ydE1hdHJpeFwiLHgpLHRoaXMuX2VmZmVjdC5zZXRUZXh0dXJlKFwidGV4dHVyZVNhbXBsZXJcIixkLnRleHR1cmUpLHRoaXMuX2VmZmVjdC5zZXRGbG9hdDQoXCJjb2xvclwiLGQuY29sb3IuciphLGQuY29sb3IuZyphLGQuY29sb3IuYiphLDEpLHQuZHJhdyghMCwwLDYpfXJldHVybiB0LnNldERlcHRoQnVmZmVyKCEwKSx0LnNldEFscGhhTW9kZShlLkVuZ2luZS5BTFBIQV9ESVNBQkxFKSwhMH0sdC5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3ZhciB0PXRoaXMuX3ZlcnRleEJ1ZmZlcnNbZS5WZXJ0ZXhCdWZmZXIuUG9zaXRpb25LaW5kXTtmb3IodCYmKHQuZGlzcG9zZSgpLHRoaXMuX3ZlcnRleEJ1ZmZlcnNbZS5WZXJ0ZXhCdWZmZXIuUG9zaXRpb25LaW5kXT1udWxsKSx0aGlzLl9pbmRleEJ1ZmZlciYmKHRoaXMuX3NjZW5lLmdldEVuZ2luZSgpLl9yZWxlYXNlQnVmZmVyKHRoaXMuX2luZGV4QnVmZmVyKSx0aGlzLl9pbmRleEJ1ZmZlcj1udWxsKTt0aGlzLmxlbnNGbGFyZXMubGVuZ3RoOyl0aGlzLmxlbnNGbGFyZXNbMF0uZGlzcG9zZSgpO3ZhciBpPXRoaXMuX3NjZW5lLmxlbnNGbGFyZVN5c3RlbXMuaW5kZXhPZih0aGlzKTt0aGlzLl9zY2VuZS5sZW5zRmxhcmVTeXN0ZW1zLnNwbGljZShpLDEpfSx0LlBhcnNlPWZ1bmN0aW9uKGkscixuKXt2YXIgbz1yLmdldExhc3RFbnRyeUJ5SUQoaS5lbWl0dGVySWQpLHM9aS5uYW1lfHxcImxlbnNGbGFyZVN5c3RlbSNcIitpLmVtaXR0ZXJJZCxhPW5ldyB0KHMsbyxyKTthLmlkPWkuaWR8fHMsYS5ib3JkZXJMaW1pdD1pLmJvcmRlckxpbWl0O2Zvcih2YXIgaD0wO2g8aS5mbGFyZXMubGVuZ3RoO2grKyl7dmFyIGM9aS5mbGFyZXNbaF07bmV3IGUuTGVuc0ZsYXJlKGMuc2l6ZSxjLnBvc2l0aW9uLGUuQ29sb3IzLkZyb21BcnJheShjLmNvbG9yKSxuK2MudGV4dHVyZU5hbWUsYSl9cmV0dXJuIGF9LHQucHJvdG90eXBlLnNlcmlhbGl6ZT1mdW5jdGlvbigpe3ZhciB0PXt9O3QuaWQ9dGhpcy5pZCx0Lm5hbWU9dGhpcy5uYW1lLHQuZW1pdHRlcklkPXRoaXMuZ2V0RW1pdHRlcigpLmlkLHQuYm9yZGVyTGltaXQ9dGhpcy5ib3JkZXJMaW1pdCx0LmZsYXJlcz1bXTtmb3IodmFyIGk9MDtpPHRoaXMubGVuc0ZsYXJlcy5sZW5ndGg7aSsrKXt2YXIgcj10aGlzLmxlbnNGbGFyZXNbaV07dC5mbGFyZXMucHVzaCh7c2l6ZTpyLnNpemUscG9zaXRpb246ci5wb3NpdGlvbixjb2xvcjpyLmNvbG9yLmFzQXJyYXkoKSx0ZXh0dXJlTmFtZTplLlRvb2xzLkdldEZpbGVuYW1lKHIudGV4dHVyZS5uYW1lKX0pfXJldHVybiB0fSx0fSgpO2UuTGVuc0ZsYXJlU3lzdGVtPXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQodCxpLHIpe2UuY2FsbCh0aGlzLHQsaSxyKSx0aGlzLmlucHV0cy5hZGREZXZpY2VPcmllbnRhdGlvbigpfXJldHVybiBfX2V4dGVuZHModCxlKSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJhbmd1bGFyU2Vuc2liaWxpdHlcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIDB9LHNldDpmdW5jdGlvbihlKXt9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwibW92ZVNlbnNpYmlsaXR5XCIse2dldDpmdW5jdGlvbigpe3JldHVybiAwfSxzZXQ6ZnVuY3Rpb24oZSl7fSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLHQucHJvdG90eXBlLmdldFR5cGVOYW1lPWZ1bmN0aW9uKCl7cmV0dXJuXCJEZXZpY2VPcmllbnRhdGlvbkNhbWVyYVwifSx0fShlLkZyZWVDYW1lcmEpO2UuRGV2aWNlT3JpZW50YXRpb25DYW1lcmE9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdCh0LGkscil7ZS5jYWxsKHRoaXMsdCxpLHIpLHRoaXMuaW5wdXRzLmFkZEdhbWVwYWQoKX1yZXR1cm4gX19leHRlbmRzKHQsZSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwiZ2FtZXBhZEFuZ3VsYXJTZW5zaWJpbGl0eVwiLHtnZXQ6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLmlucHV0cy5hdHRhY2hlZC5nYW1lcGFkO3JldHVybiBlP2UuZ2FtZXBhZEFuZ3VsYXJTZW5zaWJpbGl0eTp2b2lkIDB9LHNldDpmdW5jdGlvbihlKXt2YXIgdD10aGlzLmlucHV0cy5hdHRhY2hlZC5nYW1lcGFkO3QmJih0LmdhbWVwYWRBbmd1bGFyU2Vuc2liaWxpdHk9ZSl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwiZ2FtZXBhZE1vdmVTZW5zaWJpbGl0eVwiLHtnZXQ6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLmlucHV0cy5hdHRhY2hlZC5nYW1lcGFkO3JldHVybiBlP2UuZ2FtZXBhZE1vdmVTZW5zaWJpbGl0eTp2b2lkIDB9LHNldDpmdW5jdGlvbihlKXt2YXIgdD10aGlzLmlucHV0cy5hdHRhY2hlZC5nYW1lcGFkO3QmJih0LmdhbWVwYWRNb3ZlU2Vuc2liaWxpdHk9ZSl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksdC5wcm90b3R5cGUuZ2V0VHlwZU5hbWU9ZnVuY3Rpb24oKXtyZXR1cm5cIlVuaXZlcnNhbENhbWVyYVwifSx0fShlLlRvdWNoQ2FtZXJhKTtlLlVuaXZlcnNhbENhbWVyYT10fShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSl7dmFyIHQ9dGhpczt0aGlzLmJhYnlsb25HYW1lcGFkcz1bXSx0aGlzLm9uZUdhbWVwYWRDb25uZWN0ZWQ9ITEsdGhpcy5pc01vbml0b3Jpbmc9ITEsdGhpcy5nYW1lcGFkRXZlbnRTdXBwb3J0ZWQ9XCJHYW1lcGFkRXZlbnRcImluIHdpbmRvdyx0aGlzLmdhbWVwYWRTdXBwb3J0QXZhaWxhYmxlPW5hdmlnYXRvci5nZXRHYW1lcGFkc3x8ISFuYXZpZ2F0b3Iud2Via2l0R2V0R2FtZXBhZHN8fCEhbmF2aWdhdG9yLm1zR2V0R2FtZXBhZHN8fCEhbmF2aWdhdG9yLndlYmtpdEdhbWVwYWRzLHRoaXMuX2NhbGxiYWNrR2FtZXBhZENvbm5lY3RlZD1lLHRoaXMuZ2FtZXBhZFN1cHBvcnRBdmFpbGFibGUmJih0aGlzLmdhbWVwYWRFdmVudFN1cHBvcnRlZD8odGhpcy5fb25HYW1lcGFkQ29ubmVjdGVkRXZlbnQ9ZnVuY3Rpb24oZSl7dC5fb25HYW1lcGFkQ29ubmVjdGVkKGUpfSx0aGlzLl9vbkdhbWVwYWREaXNvbm5lY3RlZEV2ZW50PWZ1bmN0aW9uKGUpe3QuX29uR2FtZXBhZERpc2Nvbm5lY3RlZChlKX0sd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJnYW1lcGFkY29ubmVjdGVkXCIsdGhpcy5fb25HYW1lcGFkQ29ubmVjdGVkRXZlbnQsITEpLHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwiZ2FtZXBhZGRpc2Nvbm5lY3RlZFwiLHRoaXMuX29uR2FtZXBhZERpc29ubmVjdGVkRXZlbnQsITEpKTp0aGlzLl9zdGFydE1vbml0b3JpbmdHYW1lcGFkcygpKX1yZXR1cm4gZS5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe2UuZ2FtZXBhZERPTUluZm8mJmRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoZS5nYW1lcGFkRE9NSW5mbyksdGhpcy5fb25HYW1lcGFkQ29ubmVjdGVkRXZlbnQmJih3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImdhbWVwYWRjb25uZWN0ZWRcIix0aGlzLl9vbkdhbWVwYWRDb25uZWN0ZWRFdmVudCwhMSksd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJnYW1lcGFkZGlzY29ubmVjdGVkXCIsdGhpcy5fb25HYW1lcGFkRGlzb25uZWN0ZWRFdmVudCwhMSksdGhpcy5fb25HYW1lcGFkQ29ubmVjdGVkRXZlbnQ9bnVsbCx0aGlzLl9vbkdhbWVwYWREaXNvbm5lY3RlZEV2ZW50PW51bGwpfSxlLnByb3RvdHlwZS5fb25HYW1lcGFkQ29ubmVjdGVkPWZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuX2FkZE5ld0dhbWVwYWQoZS5nYW1lcGFkKTt0aGlzLl9jYWxsYmFja0dhbWVwYWRDb25uZWN0ZWQmJnRoaXMuX2NhbGxiYWNrR2FtZXBhZENvbm5lY3RlZCh0KSx0aGlzLl9zdGFydE1vbml0b3JpbmdHYW1lcGFkcygpfSxlLnByb3RvdHlwZS5fYWRkTmV3R2FtZXBhZD1mdW5jdGlvbih0KXt0aGlzLm9uZUdhbWVwYWRDb25uZWN0ZWR8fCh0aGlzLm9uZUdhbWVwYWRDb25uZWN0ZWQ9ITAsZS5nYW1lcGFkRE9NSW5mbyYmKGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoZS5nYW1lcGFkRE9NSW5mbyksZS5nYW1lcGFkRE9NSW5mbz1udWxsKSk7dmFyIGk7cmV0dXJuIGk9LTEhPT10LmlkLnNlYXJjaChcIlhib3ggMzYwXCIpfHwtMSE9PXQuaWQuc2VhcmNoKFwieGlucHV0XCIpP25ldyBhKHQuaWQsdC5pbmRleCx0KTpuZXcgbih0LmlkLHQuaW5kZXgsdCksdGhpcy5iYWJ5bG9uR2FtZXBhZHMucHVzaChpKSxpfSxlLnByb3RvdHlwZS5fb25HYW1lcGFkRGlzY29ubmVjdGVkPWZ1bmN0aW9uKGUpe2Zvcih2YXIgdCBpbiB0aGlzLmJhYnlsb25HYW1lcGFkcylpZih0aGlzLmJhYnlsb25HYW1lcGFkc1t0XS5pbmRleD09ZS5nYW1lcGFkLmluZGV4KXt0aGlzLmJhYnlsb25HYW1lcGFkcy5zcGxpY2UoK3QsMSk7YnJlYWt9MD09dGhpcy5iYWJ5bG9uR2FtZXBhZHMubGVuZ3RoJiZ0aGlzLl9zdG9wTW9uaXRvcmluZ0dhbWVwYWRzKCl9LGUucHJvdG90eXBlLl9zdGFydE1vbml0b3JpbmdHYW1lcGFkcz1mdW5jdGlvbigpe3RoaXMuaXNNb25pdG9yaW5nfHwodGhpcy5pc01vbml0b3Jpbmc9ITAsdGhpcy5fY2hlY2tHYW1lcGFkc1N0YXR1cygpKX0sZS5wcm90b3R5cGUuX3N0b3BNb25pdG9yaW5nR2FtZXBhZHM9ZnVuY3Rpb24oKXt0aGlzLmlzTW9uaXRvcmluZz0hMX0sZS5wcm90b3R5cGUuX2NoZWNrR2FtZXBhZHNTdGF0dXM9ZnVuY3Rpb24oKXt2YXIgZT10aGlzO3RoaXMuX3VwZGF0ZUdhbWVwYWRPYmplY3RzKCk7Zm9yKHZhciB0IGluIHRoaXMuYmFieWxvbkdhbWVwYWRzKXRoaXMuYmFieWxvbkdhbWVwYWRzW3RdLnVwZGF0ZSgpO3RoaXMuaXNNb25pdG9yaW5nJiYod2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZT93aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uKCl7ZS5fY2hlY2tHYW1lcGFkc1N0YXR1cygpfSk6d2luZG93Lm1velJlcXVlc3RBbmltYXRpb25GcmFtZT93aW5kb3cubW96UmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uKCl7ZS5fY2hlY2tHYW1lcGFkc1N0YXR1cygpfSk6d2luZG93LndlYmtpdFJlcXVlc3RBbmltYXRpb25GcmFtZSYmd2luZG93LndlYmtpdFJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbigpe2UuX2NoZWNrR2FtZXBhZHNTdGF0dXMoKX0pKX0sZS5wcm90b3R5cGUuX3VwZGF0ZUdhbWVwYWRPYmplY3RzPWZ1bmN0aW9uKCl7Zm9yKHZhciBlPW5hdmlnYXRvci5nZXRHYW1lcGFkcz9uYXZpZ2F0b3IuZ2V0R2FtZXBhZHMoKTpuYXZpZ2F0b3Iud2Via2l0R2V0R2FtZXBhZHM/bmF2aWdhdG9yLndlYmtpdEdldEdhbWVwYWRzKCk6W10sdD0wO3Q8ZS5sZW5ndGg7dCsrKWlmKGVbdF0paWYoZVt0XS5pbmRleCBpbiB0aGlzLmJhYnlsb25HYW1lcGFkcyl0aGlzLmJhYnlsb25HYW1lcGFkc1t0XS5icm93c2VyR2FtZXBhZD1lW3RdO2Vsc2V7dmFyIGk9dGhpcy5fYWRkTmV3R2FtZXBhZChlW3RdKTt0aGlzLl9jYWxsYmFja0dhbWVwYWRDb25uZWN0ZWQmJnRoaXMuX2NhbGxiYWNrR2FtZXBhZENvbm5lY3RlZChpKX19LGV9KCk7ZS5HYW1lcGFkcz10O3ZhciBpPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlLHQpe3RoaXMueD1lLHRoaXMueT10fXJldHVybiBlfSgpO2UuU3RpY2tWYWx1ZXM9aTt2YXIgcj1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSx0LGkpe3RoaXMuaWQ9ZSx0aGlzLmluZGV4PXQsdGhpcy5icm93c2VyR2FtZXBhZD1pLHRoaXMuYnJvd3NlckdhbWVwYWQuYXhlcy5sZW5ndGg+PTImJih0aGlzLl9sZWZ0U3RpY2s9e3g6dGhpcy5icm93c2VyR2FtZXBhZC5heGVzWzBdLHk6dGhpcy5icm93c2VyR2FtZXBhZC5heGVzWzFdfSksdGhpcy5icm93c2VyR2FtZXBhZC5heGVzLmxlbmd0aD49NCYmKHRoaXMuX3JpZ2h0U3RpY2s9e3g6dGhpcy5icm93c2VyR2FtZXBhZC5heGVzWzJdLHk6dGhpcy5icm93c2VyR2FtZXBhZC5heGVzWzNdfSl9cmV0dXJuIGUucHJvdG90eXBlLm9ubGVmdHN0aWNrY2hhbmdlZD1mdW5jdGlvbihlKXt0aGlzLl9vbmxlZnRzdGlja2NoYW5nZWQ9ZX0sZS5wcm90b3R5cGUub25yaWdodHN0aWNrY2hhbmdlZD1mdW5jdGlvbihlKXt0aGlzLl9vbnJpZ2h0c3RpY2tjaGFuZ2VkPWV9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLnByb3RvdHlwZSxcImxlZnRTdGlja1wiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fbGVmdFN0aWNrfSxzZXQ6ZnVuY3Rpb24oZSl7IXRoaXMuX29ubGVmdHN0aWNrY2hhbmdlZHx8dGhpcy5fbGVmdFN0aWNrLng9PT1lLngmJnRoaXMuX2xlZnRTdGljay55PT09ZS55fHx0aGlzLl9vbmxlZnRzdGlja2NoYW5nZWQoZSksdGhpcy5fbGVmdFN0aWNrPWV9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGUucHJvdG90eXBlLFwicmlnaHRTdGlja1wiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcmlnaHRTdGlja30sc2V0OmZ1bmN0aW9uKGUpeyF0aGlzLl9vbnJpZ2h0c3RpY2tjaGFuZ2VkfHx0aGlzLl9yaWdodFN0aWNrLng9PT1lLngmJnRoaXMuX3JpZ2h0U3RpY2sueT09PWUueXx8dGhpcy5fb25yaWdodHN0aWNrY2hhbmdlZChlKSx0aGlzLl9yaWdodFN0aWNrPWV9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksZS5wcm90b3R5cGUudXBkYXRlPWZ1bmN0aW9uKCl7dGhpcy5fbGVmdFN0aWNrJiYodGhpcy5sZWZ0U3RpY2s9e3g6dGhpcy5icm93c2VyR2FtZXBhZC5heGVzWzBdLHk6dGhpcy5icm93c2VyR2FtZXBhZC5heGVzWzFdfSksdGhpcy5fcmlnaHRTdGljayYmKHRoaXMucmlnaHRTdGljaz17eDp0aGlzLmJyb3dzZXJHYW1lcGFkLmF4ZXNbMl0seTp0aGlzLmJyb3dzZXJHYW1lcGFkLmF4ZXNbM119KX0sZX0oKTtlLkdhbWVwYWQ9cjt2YXIgbj1mdW5jdGlvbihlKXtmdW5jdGlvbiB0KHQsaSxyKXtlLmNhbGwodGhpcyx0LGksciksdGhpcy5pZD10LHRoaXMuaW5kZXg9aSx0aGlzLmdhbWVwYWQ9cix0aGlzLl9idXR0b25zPW5ldyBBcnJheShyLmJ1dHRvbnMubGVuZ3RoKX1yZXR1cm4gX19leHRlbmRzKHQsZSksdC5wcm90b3R5cGUub25idXR0b25kb3duPWZ1bmN0aW9uKGUpe3RoaXMuX29uYnV0dG9uZG93bj1lfSx0LnByb3RvdHlwZS5vbmJ1dHRvbnVwPWZ1bmN0aW9uKGUpe3RoaXMuX29uYnV0dG9udXA9ZX0sdC5wcm90b3R5cGUuX3NldEJ1dHRvblZhbHVlPWZ1bmN0aW9uKGUsdCxpKXtyZXR1cm4gZSE9PXQmJih0aGlzLl9vbmJ1dHRvbmRvd24mJjE9PT1lJiZ0aGlzLl9vbmJ1dHRvbmRvd24oaSksdGhpcy5fb25idXR0b251cCYmMD09PWUmJnRoaXMuX29uYnV0dG9udXAoaSkpLGV9LHQucHJvdG90eXBlLnVwZGF0ZT1mdW5jdGlvbigpe2UucHJvdG90eXBlLnVwZGF0ZS5jYWxsKHRoaXMpO2Zvcih2YXIgdD0wO3Q8dGhpcy5fYnV0dG9ucy5sZW5ndGg7dCsrKXRoaXMuX2J1dHRvbnNbdF09dGhpcy5fc2V0QnV0dG9uVmFsdWUodGhpcy5nYW1lcGFkLmJ1dHRvbnNbdF0udmFsdWUsdGhpcy5fYnV0dG9uc1t0XSx0KX0sdH0ocik7ZS5HZW5lcmljUGFkPW4sZnVuY3Rpb24oZSl7ZVtlLkE9MF09XCJBXCIsZVtlLkI9MV09XCJCXCIsZVtlLlg9Ml09XCJYXCIsZVtlLlk9M109XCJZXCIsZVtlLlN0YXJ0PTRdPVwiU3RhcnRcIixlW2UuQmFjaz01XT1cIkJhY2tcIixlW2UuTEI9Nl09XCJMQlwiLGVbZS5SQj03XT1cIlJCXCIsZVtlLkxlZnRTdGljaz04XT1cIkxlZnRTdGlja1wiLGVbZS5SaWdodFN0aWNrPTldPVwiUmlnaHRTdGlja1wifShlLlhib3gzNjBCdXR0b258fChlLlhib3gzNjBCdXR0b249e30pKTt2YXIgbz1lLlhib3gzNjBCdXR0b247IWZ1bmN0aW9uKGUpe2VbZS5VcD0wXT1cIlVwXCIsZVtlLkRvd249MV09XCJEb3duXCIsZVtlLkxlZnQ9Ml09XCJMZWZ0XCIsZVtlLlJpZ2h0PTNdPVwiUmlnaHRcIn0oZS5YYm94MzYwRHBhZHx8KGUuWGJveDM2MERwYWQ9e30pKTt2YXIgcz1lLlhib3gzNjBEcGFkLGE9ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdCgpe2UuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuX2xlZnRUcmlnZ2VyPTAsdGhpcy5fcmlnaHRUcmlnZ2VyPTAsdGhpcy5fYnV0dG9uQT0wLHRoaXMuX2J1dHRvbkI9MCx0aGlzLl9idXR0b25YPTAsdGhpcy5fYnV0dG9uWT0wLHRoaXMuX2J1dHRvbkJhY2s9MCx0aGlzLl9idXR0b25TdGFydD0wLHRoaXMuX2J1dHRvbkxCPTAsdGhpcy5fYnV0dG9uUkI9MCx0aGlzLl9idXR0b25MZWZ0U3RpY2s9MCx0aGlzLl9idXR0b25SaWdodFN0aWNrPTAsdGhpcy5fZFBhZFVwPTAsdGhpcy5fZFBhZERvd249MCx0aGlzLl9kUGFkTGVmdD0wLHRoaXMuX2RQYWRSaWdodD0wfXJldHVybiBfX2V4dGVuZHModCxlKSx0LnByb3RvdHlwZS5vbmxlZnR0cmlnZ2VyY2hhbmdlZD1mdW5jdGlvbihlKXt0aGlzLl9vbmxlZnR0cmlnZ2VyY2hhbmdlZD1lfSx0LnByb3RvdHlwZS5vbnJpZ2h0dHJpZ2dlcmNoYW5nZWQ9ZnVuY3Rpb24oZSl7dGhpcy5fb25yaWdodHRyaWdnZXJjaGFuZ2VkPWV9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcImxlZnRUcmlnZ2VyXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9sZWZ0VHJpZ2dlcn0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX29ubGVmdHRyaWdnZXJjaGFuZ2VkJiZ0aGlzLl9sZWZ0VHJpZ2dlciE9PWUmJnRoaXMuX29ubGVmdHRyaWdnZXJjaGFuZ2VkKGUpLHRoaXMuX2xlZnRUcmlnZ2VyPWV9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwicmlnaHRUcmlnZ2VyXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9yaWdodFRyaWdnZXJ9LHNldDpmdW5jdGlvbihlKXt0aGlzLl9vbnJpZ2h0dHJpZ2dlcmNoYW5nZWQmJnRoaXMuX3JpZ2h0VHJpZ2dlciE9PWUmJnRoaXMuX29ucmlnaHR0cmlnZ2VyY2hhbmdlZChlKSx0aGlzLl9yaWdodFRyaWdnZXI9ZX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSx0LnByb3RvdHlwZS5vbmJ1dHRvbmRvd249ZnVuY3Rpb24oZSl7dGhpcy5fb25idXR0b25kb3duPWV9LHQucHJvdG90eXBlLm9uYnV0dG9udXA9ZnVuY3Rpb24oZSl7dGhpcy5fb25idXR0b251cD1lfSx0LnByb3RvdHlwZS5vbmRwYWRkb3duPWZ1bmN0aW9uKGUpe3RoaXMuX29uZHBhZGRvd249ZX0sdC5wcm90b3R5cGUub25kcGFkdXA9ZnVuY3Rpb24oZSl7dGhpcy5fb25kcGFkdXA9ZX0sdC5wcm90b3R5cGUuX3NldEJ1dHRvblZhbHVlPWZ1bmN0aW9uKGUsdCxpKXtyZXR1cm4gZSE9PXQmJih0aGlzLl9vbmJ1dHRvbmRvd24mJjE9PT1lJiZ0aGlzLl9vbmJ1dHRvbmRvd24oaSksdGhpcy5fb25idXR0b251cCYmMD09PWUmJnRoaXMuX29uYnV0dG9udXAoaSkpLGV9LHQucHJvdG90eXBlLl9zZXREUGFkVmFsdWU9ZnVuY3Rpb24oZSx0LGkpe3JldHVybiBlIT09dCYmKHRoaXMuX29uZHBhZGRvd24mJjE9PT1lJiZ0aGlzLl9vbmRwYWRkb3duKGkpLHRoaXMuX29uZHBhZHVwJiYwPT09ZSYmdGhpcy5fb25kcGFkdXAoaSkpLGV9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcImJ1dHRvbkFcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2J1dHRvbkF9LHNldDpmdW5jdGlvbihlKXt0aGlzLl9idXR0b25BPXRoaXMuX3NldEJ1dHRvblZhbHVlKGUsdGhpcy5fYnV0dG9uQSxvLkEpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcImJ1dHRvbkJcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2J1dHRvbkJ9LHNldDpmdW5jdGlvbihlKXt0aGlzLl9idXR0b25CPXRoaXMuX3NldEJ1dHRvblZhbHVlKGUsdGhpcy5fYnV0dG9uQixvLkIpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcImJ1dHRvblhcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2J1dHRvblh9LHNldDpmdW5jdGlvbihlKXt0aGlzLl9idXR0b25YPXRoaXMuX3NldEJ1dHRvblZhbHVlKGUsdGhpcy5fYnV0dG9uWCxvLlgpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcImJ1dHRvbllcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2J1dHRvbll9LHNldDpmdW5jdGlvbihlKXt0aGlzLl9idXR0b25ZPXRoaXMuX3NldEJ1dHRvblZhbHVlKGUsdGhpcy5fYnV0dG9uWSxvLlkpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcImJ1dHRvblN0YXJ0XCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9idXR0b25TdGFydH0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX2J1dHRvblN0YXJ0PXRoaXMuX3NldEJ1dHRvblZhbHVlKGUsdGhpcy5fYnV0dG9uU3RhcnQsby5TdGFydCl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwiYnV0dG9uQmFja1wiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fYnV0dG9uQmFja30sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX2J1dHRvbkJhY2s9dGhpcy5fc2V0QnV0dG9uVmFsdWUoZSx0aGlzLl9idXR0b25CYWNrLG8uQmFjayl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwiYnV0dG9uTEJcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2J1dHRvbkxCfSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fYnV0dG9uTEI9dGhpcy5fc2V0QnV0dG9uVmFsdWUoZSx0aGlzLl9idXR0b25MQixvLkxCKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJidXR0b25SQlwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fYnV0dG9uUkJ9LHNldDpmdW5jdGlvbihlKXt0aGlzLl9idXR0b25SQj10aGlzLl9zZXRCdXR0b25WYWx1ZShlLHRoaXMuX2J1dHRvblJCLG8uUkIpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcImJ1dHRvbkxlZnRTdGlja1wiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fYnV0dG9uTGVmdFN0aWNrfSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fYnV0dG9uTGVmdFN0aWNrPXRoaXMuX3NldEJ1dHRvblZhbHVlKGUsdGhpcy5fYnV0dG9uTGVmdFN0aWNrLG8uTGVmdFN0aWNrKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJidXR0b25SaWdodFN0aWNrXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9idXR0b25SaWdodFN0aWNrfSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fYnV0dG9uUmlnaHRTdGljaz10aGlzLl9zZXRCdXR0b25WYWx1ZShlLHRoaXMuX2J1dHRvblJpZ2h0U3RpY2ssby5SaWdodFN0aWNrKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJkUGFkVXBcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2RQYWRVcH0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX2RQYWRVcD10aGlzLl9zZXREUGFkVmFsdWUoZSx0aGlzLl9kUGFkVXAscy5VcCl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwiZFBhZERvd25cIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2RQYWREb3dufSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fZFBhZERvd249dGhpcy5fc2V0RFBhZFZhbHVlKGUsdGhpcy5fZFBhZERvd24scy5Eb3duKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJkUGFkTGVmdFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZFBhZExlZnR9LHNldDpmdW5jdGlvbihlKXt0aGlzLl9kUGFkTGVmdD10aGlzLl9zZXREUGFkVmFsdWUoZSx0aGlzLl9kUGFkTGVmdCxzLkxlZnQpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcImRQYWRSaWdodFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZFBhZFJpZ2h0fSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fZFBhZFJpZ2h0PXRoaXMuX3NldERQYWRWYWx1ZShlLHRoaXMuX2RQYWRSaWdodCxzLlJpZ2h0KX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSx0LnByb3RvdHlwZS51cGRhdGU9ZnVuY3Rpb24oKXtlLnByb3RvdHlwZS51cGRhdGUuY2FsbCh0aGlzKSx0aGlzLmJ1dHRvbkE9dGhpcy5icm93c2VyR2FtZXBhZC5idXR0b25zWzBdLnZhbHVlLHRoaXMuYnV0dG9uQj10aGlzLmJyb3dzZXJHYW1lcGFkLmJ1dHRvbnNbMV0udmFsdWUsdGhpcy5idXR0b25YPXRoaXMuYnJvd3NlckdhbWVwYWQuYnV0dG9uc1syXS52YWx1ZSx0aGlzLmJ1dHRvblk9dGhpcy5icm93c2VyR2FtZXBhZC5idXR0b25zWzNdLnZhbHVlLHRoaXMuYnV0dG9uTEI9dGhpcy5icm93c2VyR2FtZXBhZC5idXR0b25zWzRdLnZhbHVlLHRoaXMuYnV0dG9uUkI9dGhpcy5icm93c2VyR2FtZXBhZC5idXR0b25zWzVdLnZhbHVlLHRoaXMubGVmdFRyaWdnZXI9dGhpcy5icm93c2VyR2FtZXBhZC5idXR0b25zWzZdLnZhbHVlLHRoaXMucmlnaHRUcmlnZ2VyPXRoaXMuYnJvd3NlckdhbWVwYWQuYnV0dG9uc1s3XS52YWx1ZSx0aGlzLmJ1dHRvbkJhY2s9dGhpcy5icm93c2VyR2FtZXBhZC5idXR0b25zWzhdLnZhbHVlLHRoaXMuYnV0dG9uU3RhcnQ9dGhpcy5icm93c2VyR2FtZXBhZC5idXR0b25zWzldLnZhbHVlLHRoaXMuYnV0dG9uTGVmdFN0aWNrPXRoaXMuYnJvd3NlckdhbWVwYWQuYnV0dG9uc1sxMF0udmFsdWUsdGhpcy5idXR0b25SaWdodFN0aWNrPXRoaXMuYnJvd3NlckdhbWVwYWQuYnV0dG9uc1sxMV0udmFsdWUsdGhpcy5kUGFkVXA9dGhpcy5icm93c2VyR2FtZXBhZC5idXR0b25zWzEyXS52YWx1ZSx0aGlzLmRQYWREb3duPXRoaXMuYnJvd3NlckdhbWVwYWQuYnV0dG9uc1sxM10udmFsdWUsdGhpcy5kUGFkTGVmdD10aGlzLmJyb3dzZXJHYW1lcGFkLmJ1dHRvbnNbMTRdLnZhbHVlLHRoaXMuZFBhZFJpZ2h0PXRoaXMuYnJvd3NlckdhbWVwYWQuYnV0dG9uc1sxNV0udmFsdWV9LHR9KHIpO2UuWGJveDM2MFBhZD1hfShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbih0KXtmdW5jdGlvbiBpKGkscixuKXtlLlRvb2xzLldhcm4oXCJEZXByZWNhdGVkLiBQbGVhc2UgdXNlIFVuaXZlcnNhbCBDYW1lcmEgaW5zdGVhZC5cIiksdC5jYWxsKHRoaXMsaSxyLG4pfXJldHVybiBfX2V4dGVuZHMoaSx0KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJnYW1lcGFkQW5ndWxhclNlbnNpYmlsaXR5XCIse2dldDpmdW5jdGlvbigpe3ZhciBlPXRoaXMuaW5wdXRzLmF0dGFjaGVkLmdhbWVwYWQ7cmV0dXJuIGU/ZS5nYW1lcGFkQW5ndWxhclNlbnNpYmlsaXR5OnZvaWQgMH0sc2V0OmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuaW5wdXRzLmF0dGFjaGVkLmdhbWVwYWQ7dCYmKHQuZ2FtZXBhZEFuZ3VsYXJTZW5zaWJpbGl0eT1lKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJnYW1lcGFkTW92ZVNlbnNpYmlsaXR5XCIse2dldDpmdW5jdGlvbigpe3ZhciBlPXRoaXMuaW5wdXRzLmF0dGFjaGVkLmdhbWVwYWQ7cmV0dXJuIGU/ZS5nYW1lcGFkTW92ZVNlbnNpYmlsaXR5OnZvaWQgMH0sc2V0OmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuaW5wdXRzLmF0dGFjaGVkLmdhbWVwYWQ7dCYmKHQuZ2FtZXBhZE1vdmVTZW5zaWJpbGl0eT1lKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxpLnByb3RvdHlwZS5nZXRUeXBlTmFtZT1mdW5jdGlvbigpe3JldHVyblwiR2FtZXBhZENhbWVyYVwifSxpfShlLlVuaXZlcnNhbENhbWVyYSk7ZS5HYW1lcGFkQ2FtZXJhPXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0KXt0aGlzLlNNT09USElORz0uNzUsdGhpcy5GRlRfU0laRT01MTIsdGhpcy5CQVJHUkFQSEFNUExJVFVERT0yNTYsdGhpcy5ERUJVR0NBTlZBU1BPUz17eDoyMCx5OjIwfSx0aGlzLkRFQlVHQ0FOVkFTU0laRT17d2lkdGg6MzIwLGhlaWdodDoyMDB9LHRoaXMuX3NjZW5lPXQsdGhpcy5fYXVkaW9FbmdpbmU9ZS5FbmdpbmUuYXVkaW9FbmdpbmUsdGhpcy5fYXVkaW9FbmdpbmUuY2FuVXNlV2ViQXVkaW8mJih0aGlzLl93ZWJBdWRpb0FuYWx5c2VyPXRoaXMuX2F1ZGlvRW5naW5lLmF1ZGlvQ29udGV4dC5jcmVhdGVBbmFseXNlcigpLHRoaXMuX3dlYkF1ZGlvQW5hbHlzZXIubWluRGVjaWJlbHM9LTE0MCx0aGlzLl93ZWJBdWRpb0FuYWx5c2VyLm1heERlY2liZWxzPTAsdGhpcy5fYnl0ZUZyZXFzPW5ldyBVaW50OEFycmF5KHRoaXMuX3dlYkF1ZGlvQW5hbHlzZXIuZnJlcXVlbmN5QmluQ291bnQpLHRoaXMuX2J5dGVUaW1lPW5ldyBVaW50OEFycmF5KHRoaXMuX3dlYkF1ZGlvQW5hbHlzZXIuZnJlcXVlbmN5QmluQ291bnQpLHRoaXMuX2Zsb2F0RnJlcXM9bmV3IEZsb2F0MzJBcnJheSh0aGlzLl93ZWJBdWRpb0FuYWx5c2VyLmZyZXF1ZW5jeUJpbkNvdW50KSl9cmV0dXJuIHQucHJvdG90eXBlLmdldEZyZXF1ZW5jeUJpbkNvdW50PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2F1ZGlvRW5naW5lLmNhblVzZVdlYkF1ZGlvP3RoaXMuX3dlYkF1ZGlvQW5hbHlzZXIuZnJlcXVlbmN5QmluQ291bnQ6MH0sdC5wcm90b3R5cGUuZ2V0Qnl0ZUZyZXF1ZW5jeURhdGE9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fYXVkaW9FbmdpbmUuY2FuVXNlV2ViQXVkaW8mJih0aGlzLl93ZWJBdWRpb0FuYWx5c2VyLnNtb290aGluZ1RpbWVDb25zdGFudD10aGlzLlNNT09USElORyx0aGlzLl93ZWJBdWRpb0FuYWx5c2VyLmZmdFNpemU9dGhpcy5GRlRfU0laRSx0aGlzLl93ZWJBdWRpb0FuYWx5c2VyLmdldEJ5dGVGcmVxdWVuY3lEYXRhKHRoaXMuX2J5dGVGcmVxcykpLHRoaXMuX2J5dGVGcmVxc30sdC5wcm90b3R5cGUuZ2V0Qnl0ZVRpbWVEb21haW5EYXRhPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2F1ZGlvRW5naW5lLmNhblVzZVdlYkF1ZGlvJiYodGhpcy5fd2ViQXVkaW9BbmFseXNlci5zbW9vdGhpbmdUaW1lQ29uc3RhbnQ9dGhpcy5TTU9PVEhJTkcsdGhpcy5fd2ViQXVkaW9BbmFseXNlci5mZnRTaXplPXRoaXMuRkZUX1NJWkUsdGhpcy5fd2ViQXVkaW9BbmFseXNlci5nZXRCeXRlVGltZURvbWFpbkRhdGEodGhpcy5fYnl0ZVRpbWUpKSx0aGlzLl9ieXRlVGltZX0sdC5wcm90b3R5cGUuZ2V0RmxvYXRGcmVxdWVuY3lEYXRhPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2F1ZGlvRW5naW5lLmNhblVzZVdlYkF1ZGlvJiYodGhpcy5fd2ViQXVkaW9BbmFseXNlci5zbW9vdGhpbmdUaW1lQ29uc3RhbnQ9dGhpcy5TTU9PVEhJTkcsdGhpcy5fd2ViQXVkaW9BbmFseXNlci5mZnRTaXplPXRoaXMuRkZUX1NJWkUsdGhpcy5fd2ViQXVkaW9BbmFseXNlci5nZXRGbG9hdEZyZXF1ZW5jeURhdGEodGhpcy5fZmxvYXRGcmVxcykpLHRoaXMuX2Zsb2F0RnJlcXN9LHQucHJvdG90eXBlLmRyYXdEZWJ1Z0NhbnZhcz1mdW5jdGlvbigpe3ZhciBlPXRoaXM7aWYodGhpcy5fYXVkaW9FbmdpbmUuY2FuVXNlV2ViQXVkaW8mJih0aGlzLl9kZWJ1Z0NhbnZhc3x8KHRoaXMuX2RlYnVnQ2FudmFzPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIiksdGhpcy5fZGVidWdDYW52YXMud2lkdGg9dGhpcy5ERUJVR0NBTlZBU1NJWkUud2lkdGgsdGhpcy5fZGVidWdDYW52YXMuaGVpZ2h0PXRoaXMuREVCVUdDQU5WQVNTSVpFLmhlaWdodCx0aGlzLl9kZWJ1Z0NhbnZhcy5zdHlsZS5wb3NpdGlvbj1cImFic29sdXRlXCIsdGhpcy5fZGVidWdDYW52YXMuc3R5bGUudG9wPXRoaXMuREVCVUdDQU5WQVNQT1MueStcInB4XCIsdGhpcy5fZGVidWdDYW52YXMuc3R5bGUubGVmdD10aGlzLkRFQlVHQ0FOVkFTUE9TLngrXCJweFwiLHRoaXMuX2RlYnVnQ2FudmFzQ29udGV4dD10aGlzLl9kZWJ1Z0NhbnZhcy5nZXRDb250ZXh0KFwiMmRcIiksZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0aGlzLl9kZWJ1Z0NhbnZhcyksdGhpcy5fcmVnaXN0ZXJGdW5jPWZ1bmN0aW9uKCl7ZS5kcmF3RGVidWdDYW52YXMoKX0sdGhpcy5fc2NlbmUucmVnaXN0ZXJCZWZvcmVSZW5kZXIodGhpcy5fcmVnaXN0ZXJGdW5jKSksdGhpcy5fcmVnaXN0ZXJGdW5jKSl7dmFyIHQ9dGhpcy5nZXRCeXRlRnJlcXVlbmN5RGF0YSgpO3RoaXMuX2RlYnVnQ2FudmFzQ29udGV4dC5maWxsU3R5bGU9XCJyZ2IoMCwgMCwgMClcIix0aGlzLl9kZWJ1Z0NhbnZhc0NvbnRleHQuZmlsbFJlY3QoMCwwLHRoaXMuREVCVUdDQU5WQVNTSVpFLndpZHRoLHRoaXMuREVCVUdDQU5WQVNTSVpFLmhlaWdodCk7Zm9yKHZhciBpPTA7aTx0aGlzLmdldEZyZXF1ZW5jeUJpbkNvdW50KCk7aSsrKXt2YXIgcj10W2ldLG49ci90aGlzLkJBUkdSQVBIQU1QTElUVURFLG89dGhpcy5ERUJVR0NBTlZBU1NJWkUuaGVpZ2h0Km4scz10aGlzLkRFQlVHQ0FOVkFTU0laRS5oZWlnaHQtby0xLGE9dGhpcy5ERUJVR0NBTlZBU1NJWkUud2lkdGgvdGhpcy5nZXRGcmVxdWVuY3lCaW5Db3VudCgpLGg9aS90aGlzLmdldEZyZXF1ZW5jeUJpbkNvdW50KCkqMzYwO3RoaXMuX2RlYnVnQ2FudmFzQ29udGV4dC5maWxsU3R5bGU9XCJoc2woXCIraCtcIiwgMTAwJSwgNTAlKVwiLHRoaXMuX2RlYnVnQ2FudmFzQ29udGV4dC5maWxsUmVjdChpKmEscyxhLG8pfX19LHQucHJvdG90eXBlLnN0b3BEZWJ1Z0NhbnZhcz1mdW5jdGlvbigpe3RoaXMuX2RlYnVnQ2FudmFzJiYodGhpcy5fc2NlbmUudW5yZWdpc3RlckJlZm9yZVJlbmRlcih0aGlzLl9yZWdpc3RlckZ1bmMpLHRoaXMuX3JlZ2lzdGVyRnVuYz1udWxsLGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQodGhpcy5fZGVidWdDYW52YXMpLHRoaXMuX2RlYnVnQ2FudmFzPW51bGwsdGhpcy5fZGVidWdDYW52YXNDb250ZXh0PW51bGwpfSx0LnByb3RvdHlwZS5jb25uZWN0QXVkaW9Ob2Rlcz1mdW5jdGlvbihlLHQpe3RoaXMuX2F1ZGlvRW5naW5lLmNhblVzZVdlYkF1ZGlvJiYoZS5jb25uZWN0KHRoaXMuX3dlYkF1ZGlvQW5hbHlzZXIpLHRoaXMuX3dlYkF1ZGlvQW5hbHlzZXIuY29ubmVjdCh0KSl9LHQucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXt0aGlzLl9hdWRpb0VuZ2luZS5jYW5Vc2VXZWJBdWRpbyYmdGhpcy5fd2ViQXVkaW9BbmFseXNlci5kaXNjb25uZWN0KCl9LHR9KCk7ZS5BbmFseXNlcj10fShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCxpKXt2YXIgcj10aGlzO3ZvaWQgMD09PWkmJihpPWUuRW5naW5lLlRFWFRVUkVUWVBFX0ZMT0FUKSx0aGlzLl92aWV3TWF0cml4PWUuTWF0cml4Llplcm8oKSx0aGlzLl9wcm9qZWN0aW9uTWF0cml4PWUuTWF0cml4Llplcm8oKSx0aGlzLl90cmFuc2Zvcm1NYXRyaXg9ZS5NYXRyaXguWmVybygpLHRoaXMuX3dvcmxkVmlld1Byb2plY3Rpb249ZS5NYXRyaXguWmVybygpLHRoaXMuX3NjZW5lPXQ7dmFyIG49dC5nZXRFbmdpbmUoKTt0aGlzLl9kZXB0aE1hcD1uZXcgZS5SZW5kZXJUYXJnZXRUZXh0dXJlKFwiZGVwdGhNYXBcIix7d2lkdGg6bi5nZXRSZW5kZXJXaWR0aCgpLGhlaWdodDpuLmdldFJlbmRlckhlaWdodCgpfSx0aGlzLl9zY2VuZSwhMSwhMCxpKSx0aGlzLl9kZXB0aE1hcC53cmFwVT1lLlRleHR1cmUuQ0xBTVBfQUREUkVTU01PREUsdGhpcy5fZGVwdGhNYXAud3JhcFY9ZS5UZXh0dXJlLkNMQU1QX0FERFJFU1NNT0RFLHRoaXMuX2RlcHRoTWFwLnJlZnJlc2hSYXRlPTEsdGhpcy5fZGVwdGhNYXAucmVuZGVyUGFydGljbGVzPSExLHRoaXMuX2RlcHRoTWFwLnJlbmRlckxpc3Q9bnVsbCx0aGlzLl9kZXB0aE1hcC5vbkNsZWFyT2JzZXJ2YWJsZS5hZGQoZnVuY3Rpb24odCl7dC5jbGVhcihuZXcgZS5Db2xvcjQoMSwxLDEsMSksITAsITApfSk7dmFyIG89ZnVuY3Rpb24odCl7dmFyIGk9dC5nZXRSZW5kZXJpbmdNZXNoKCksbj1yLl9zY2VuZSxvPW4uZ2V0RW5naW5lKCk7by5zZXRTdGF0ZSh0LmdldE1hdGVyaWFsKCkuYmFja0ZhY2VDdWxsaW5nKTt2YXIgcz1pLl9nZXRJbnN0YW5jZXNSZW5kZXJMaXN0KHQuX2lkKTtpZighcy5tdXN0UmV0dXJuKXt2YXIgYT1udWxsIT09by5nZXRDYXBzKCkuaW5zdGFuY2VkQXJyYXlzJiZudWxsIT09cy52aXNpYmxlSW5zdGFuY2VzW3QuX2lkXTtpZihyLmlzUmVhZHkodCxhKSl7by5lbmFibGVFZmZlY3Qoci5fZWZmZWN0KSxpLl9iaW5kKHQsci5fZWZmZWN0LGUuTWF0ZXJpYWwuVHJpYW5nbGVGaWxsTW9kZSk7dmFyIGg9dC5nZXRNYXRlcmlhbCgpO2lmKHIuX2VmZmVjdC5zZXRNYXRyaXgoXCJ2aWV3UHJvamVjdGlvblwiLG4uZ2V0VHJhbnNmb3JtTWF0cml4KCkpLHIuX2VmZmVjdC5zZXRGbG9hdChcImZhclwiLG4uYWN0aXZlQ2FtZXJhLm1heFopLGgmJmgubmVlZEFscGhhVGVzdGluZygpKXt2YXIgYz1oLmdldEFscGhhVGVzdFRleHR1cmUoKTtyLl9lZmZlY3Quc2V0VGV4dHVyZShcImRpZmZ1c2VTYW1wbGVyXCIsYyksci5fZWZmZWN0LnNldE1hdHJpeChcImRpZmZ1c2VNYXRyaXhcIixjLmdldFRleHR1cmVNYXRyaXgoKSl9aS51c2VCb25lcyYmaS5jb21wdXRlQm9uZXNVc2luZ1NoYWRlcnMmJnIuX2VmZmVjdC5zZXRNYXRyaWNlcyhcIm1Cb25lc1wiLGkuc2tlbGV0b24uZ2V0VHJhbnNmb3JtTWF0cmljZXMoaSkpLGkuX3Byb2Nlc3NSZW5kZXJpbmcodCxyLl9lZmZlY3QsZS5NYXRlcmlhbC5UcmlhbmdsZUZpbGxNb2RlLHMsYSxmdW5jdGlvbihlLHQpe3JldHVybiByLl9lZmZlY3Quc2V0TWF0cml4KFwid29ybGRcIix0KX0pfX19O3RoaXMuX2RlcHRoTWFwLmN1c3RvbVJlbmRlckZ1bmN0aW9uPWZ1bmN0aW9uKGUsdCl7dmFyIGk7Zm9yKGk9MDtpPGUubGVuZ3RoO2krKylvKGUuZGF0YVtpXSk7Zm9yKGk9MDtpPHQubGVuZ3RoO2krKylvKHQuZGF0YVtpXSl9fXJldHVybiB0LnByb3RvdHlwZS5pc1JlYWR5PWZ1bmN0aW9uKHQsaSl7dmFyIHI9dC5nZXRNYXRlcmlhbCgpO2lmKHIuZGlzYWJsZURlcHRoV3JpdGUpcmV0dXJuITE7dmFyIG49W10sbz1bZS5WZXJ0ZXhCdWZmZXIuUG9zaXRpb25LaW5kXSxzPXQuZ2V0TWVzaCgpO3MuZ2V0U2NlbmUoKTtyJiZyLm5lZWRBbHBoYVRlc3RpbmcoKSYmKG4ucHVzaChcIiNkZWZpbmUgQUxQSEFURVNUXCIpLHMuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGUuVmVydGV4QnVmZmVyLlVWS2luZCkmJihvLnB1c2goZS5WZXJ0ZXhCdWZmZXIuVVZLaW5kKSxuLnB1c2goXCIjZGVmaW5lIFVWMVwiKSkscy5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZS5WZXJ0ZXhCdWZmZXIuVVYyS2luZCkmJihvLnB1c2goZS5WZXJ0ZXhCdWZmZXIuVVYyS2luZCksbi5wdXNoKFwiI2RlZmluZSBVVjJcIikpKSxzLnVzZUJvbmVzJiZzLmNvbXB1dGVCb25lc1VzaW5nU2hhZGVycz8oby5wdXNoKGUuVmVydGV4QnVmZmVyLk1hdHJpY2VzSW5kaWNlc0tpbmQpLG8ucHVzaChlLlZlcnRleEJ1ZmZlci5NYXRyaWNlc1dlaWdodHNLaW5kKSxzLm51bUJvbmVJbmZsdWVuY2Vycz40JiYoby5wdXNoKGUuVmVydGV4QnVmZmVyLk1hdHJpY2VzSW5kaWNlc0V4dHJhS2luZCksby5wdXNoKGUuVmVydGV4QnVmZmVyLk1hdHJpY2VzV2VpZ2h0c0V4dHJhS2luZCkpLG4ucHVzaChcIiNkZWZpbmUgTlVNX0JPTkVfSU5GTFVFTkNFUlMgXCIrcy5udW1Cb25lSW5mbHVlbmNlcnMpLG4ucHVzaChcIiNkZWZpbmUgQm9uZXNQZXJNZXNoIFwiKyhzLnNrZWxldG9uLmJvbmVzLmxlbmd0aCsxKSkpOm4ucHVzaChcIiNkZWZpbmUgTlVNX0JPTkVfSU5GTFVFTkNFUlMgMFwiKSxpJiYobi5wdXNoKFwiI2RlZmluZSBJTlNUQU5DRVNcIiksby5wdXNoKFwid29ybGQwXCIpLG8ucHVzaChcIndvcmxkMVwiKSxvLnB1c2goXCJ3b3JsZDJcIiksby5wdXNoKFwid29ybGQzXCIpKTt2YXIgYT1uLmpvaW4oXCJcXG5cIik7cmV0dXJuIHRoaXMuX2NhY2hlZERlZmluZXMhPT1hJiYodGhpcy5fY2FjaGVkRGVmaW5lcz1hLHRoaXMuX2VmZmVjdD10aGlzLl9zY2VuZS5nZXRFbmdpbmUoKS5jcmVhdGVFZmZlY3QoXCJkZXB0aFwiLG8sW1wid29ybGRcIixcIm1Cb25lc1wiLFwidmlld1Byb2plY3Rpb25cIixcImRpZmZ1c2VNYXRyaXhcIixcImZhclwiXSxbXCJkaWZmdXNlU2FtcGxlclwiXSxhKSksdGhpcy5fZWZmZWN0LmlzUmVhZHkoKX0sdC5wcm90b3R5cGUuZ2V0RGVwdGhNYXA9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZGVwdGhNYXB9LHQucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXt0aGlzLl9kZXB0aE1hcC5kaXNwb3NlKCl9LHR9KCk7ZS5EZXB0aFJlbmRlcmVyPXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGkoaSxyLG4sbyl7dmFyIHM9dGhpczt0LmNhbGwodGhpcyxyLmdldEVuZ2luZSgpLGkpLHRoaXMuU1NBT09yaWdpbmFsU2NlbmVDb2xvckVmZmVjdD1cIlNTQU9PcmlnaW5hbFNjZW5lQ29sb3JFZmZlY3RcIix0aGlzLlNTQU9SZW5kZXJFZmZlY3Q9XCJTU0FPUmVuZGVyRWZmZWN0XCIsdGhpcy5TU0FPQmx1ckhSZW5kZXJFZmZlY3Q9XCJTU0FPQmx1ckhSZW5kZXJFZmZlY3RcIix0aGlzLlNTQU9CbHVyVlJlbmRlckVmZmVjdD1cIlNTQU9CbHVyVlJlbmRlckVmZmVjdFwiLHRoaXMuU1NBT0NvbWJpbmVSZW5kZXJFZmZlY3Q9XCJTU0FPQ29tYmluZVJlbmRlckVmZmVjdFwiLHRoaXMudG90YWxTdHJlbmd0aD0xLHRoaXMucmFkaXVzPTFlLTQsdGhpcy5hcmVhPS4wMDc1LHRoaXMuZmFsbE9mZj0xZS02LHRoaXMuYmFzZT0uNSx0aGlzLl9maXJzdFVwZGF0ZT0hMCx0aGlzLl9zY2VuZT1yLHRoaXMuX2NyZWF0ZVJhbmRvbVRleHR1cmUoKSx0aGlzLl9kZXB0aFRleHR1cmU9ci5lbmFibGVEZXB0aFJlbmRlcmVyKCkuZ2V0RGVwdGhNYXAoKTt2YXIgYT1uLnNzYW9SYXRpb3x8bixoPW4uY29tYmluZVJhdGlvfHxuO3RoaXMuX3JhdGlvPXtzc2FvUmF0aW86YSxjb21iaW5lUmF0aW86aH0sdGhpcy5fb3JpZ2luYWxDb2xvclBvc3RQcm9jZXNzPW5ldyBlLlBhc3NQb3N0UHJvY2VzcyhcIlNTQU9PcmlnaW5hbFNjZW5lQ29sb3JcIixoLG51bGwsZS5UZXh0dXJlLkJJTElORUFSX1NBTVBMSU5HTU9ERSxyLmdldEVuZ2luZSgpLCExKSx0aGlzLl9jcmVhdGVTU0FPUG9zdFByb2Nlc3MoYSksdGhpcy5fY3JlYXRlQmx1clBvc3RQcm9jZXNzKGEpLHRoaXMuX2NyZWF0ZVNTQU9Db21iaW5lUG9zdFByb2Nlc3MoaCksdGhpcy5hZGRFZmZlY3QobmV3IGUuUG9zdFByb2Nlc3NSZW5kZXJFZmZlY3Qoci5nZXRFbmdpbmUoKSx0aGlzLlNTQU9PcmlnaW5hbFNjZW5lQ29sb3JFZmZlY3QsZnVuY3Rpb24oKXtyZXR1cm4gcy5fb3JpZ2luYWxDb2xvclBvc3RQcm9jZXNzfSwhMCkpLHRoaXMuYWRkRWZmZWN0KG5ldyBlLlBvc3RQcm9jZXNzUmVuZGVyRWZmZWN0KHIuZ2V0RW5naW5lKCksdGhpcy5TU0FPUmVuZGVyRWZmZWN0LGZ1bmN0aW9uKCl7cmV0dXJuIHMuX3NzYW9Qb3N0UHJvY2Vzc30sITApKSx0aGlzLmFkZEVmZmVjdChuZXcgZS5Qb3N0UHJvY2Vzc1JlbmRlckVmZmVjdChyLmdldEVuZ2luZSgpLHRoaXMuU1NBT0JsdXJIUmVuZGVyRWZmZWN0LGZ1bmN0aW9uKCl7cmV0dXJuIHMuX2JsdXJIUG9zdFByb2Nlc3N9LCEwKSksdGhpcy5hZGRFZmZlY3QobmV3IGUuUG9zdFByb2Nlc3NSZW5kZXJFZmZlY3Qoci5nZXRFbmdpbmUoKSx0aGlzLlNTQU9CbHVyVlJlbmRlckVmZmVjdCxmdW5jdGlvbigpe3JldHVybiBzLl9ibHVyVlBvc3RQcm9jZXNzfSwhMCkpLHRoaXMuYWRkRWZmZWN0KG5ldyBlLlBvc3RQcm9jZXNzUmVuZGVyRWZmZWN0KHIuZ2V0RW5naW5lKCksdGhpcy5TU0FPQ29tYmluZVJlbmRlckVmZmVjdCxmdW5jdGlvbigpe3JldHVybiBzLl9zc2FvQ29tYmluZVBvc3RQcm9jZXNzfSwhMCkpLHIucG9zdFByb2Nlc3NSZW5kZXJQaXBlbGluZU1hbmFnZXIuYWRkUGlwZWxpbmUodGhpcyksbyYmci5wb3N0UHJvY2Vzc1JlbmRlclBpcGVsaW5lTWFuYWdlci5hdHRhY2hDYW1lcmFzVG9SZW5kZXJQaXBlbGluZShpLG8pfXJldHVybiBfX2V4dGVuZHMoaSx0KSxpLnByb3RvdHlwZS5nZXRCbHVySFBvc3RQcm9jZXNzPWZ1bmN0aW9uKCl7cmV0dXJuIGUuVG9vbHMuRXJyb3IoXCJTU0FPUmVuZGVyaW5QaXBlbGluZS5nZXRCbHVySFBvc3RQcm9jZXNzKCkgaXMgZGVwcmVjYXRlZCwgbm8gbW9yZSBibHVyIHBvc3QtcHJvY2VzcyBleGlzdHNcIiksbnVsbH0saS5wcm90b3R5cGUuZ2V0Qmx1clZQb3N0UHJvY2Vzcz1mdW5jdGlvbigpe3JldHVybiBlLlRvb2xzLkVycm9yKFwiU1NBT1JlbmRlcmluUGlwZWxpbmUuZ2V0Qmx1clZQb3N0UHJvY2VzcygpIGlzIGRlcHJlY2F0ZWQsIG5vIG1vcmUgYmx1ciBwb3N0LXByb2Nlc3MgZXhpc3RzXCIpLG51bGx9LGkucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oZSl7dm9pZCAwPT09ZSYmKGU9ITEpO2Zvcih2YXIgdD0wO3Q8dGhpcy5fc2NlbmUuY2FtZXJhcy5sZW5ndGg7dCsrKXt2YXIgaT10aGlzLl9zY2VuZS5jYW1lcmFzW3RdO3RoaXMuX29yaWdpbmFsQ29sb3JQb3N0UHJvY2Vzcy5kaXNwb3NlKGkpLHRoaXMuX3NzYW9Qb3N0UHJvY2Vzcy5kaXNwb3NlKGkpLHRoaXMuX2JsdXJIUG9zdFByb2Nlc3MuZGlzcG9zZShpKSx0aGlzLl9ibHVyVlBvc3RQcm9jZXNzLmRpc3Bvc2UoaSksdGhpcy5fc3Nhb0NvbWJpbmVQb3N0UHJvY2Vzcy5kaXNwb3NlKGkpfXRoaXMuX3JhbmRvbVRleHR1cmUuZGlzcG9zZSgpLGUmJnRoaXMuX3NjZW5lLmRpc2FibGVEZXB0aFJlbmRlcmVyKCksdGhpcy5fc2NlbmUucG9zdFByb2Nlc3NSZW5kZXJQaXBlbGluZU1hbmFnZXIuZGV0YWNoQ2FtZXJhc0Zyb21SZW5kZXJQaXBlbGluZSh0aGlzLl9uYW1lLHRoaXMuX3NjZW5lLmNhbWVyYXMpfSxpLnByb3RvdHlwZS5fY3JlYXRlQmx1clBvc3RQcm9jZXNzPWZ1bmN0aW9uKHQpe2Zvcih2YXIgaT10aGlzLHI9W10sbj0tODs4Pm47bisrKXIucHVzaCgyKm4pO3RoaXMuX2JsdXJIUG9zdFByb2Nlc3M9bmV3IGUuUG9zdFByb2Nlc3MoXCJCbHVySFwiLFwic3Nhb1wiLFtcIm91dFNpemVcIixcInNhbXBsZXJPZmZzZXRzXCJdLFtcImRlcHRoU2FtcGxlclwiXSx0LG51bGwsZS5UZXh0dXJlLlRSSUxJTkVBUl9TQU1QTElOR01PREUsdGhpcy5fc2NlbmUuZ2V0RW5naW5lKCksITEsXCIjZGVmaW5lIEJJTEFURVJBTF9CTFVSXFxuI2RlZmluZSBCSUxBVEVSQUxfQkxVUl9IXFxuI2RlZmluZSBTQU1QTEVTIDE2XCIpLHRoaXMuX2JsdXJIUG9zdFByb2Nlc3Mub25BcHBseT1mdW5jdGlvbihlKXtlLnNldEZsb2F0KFwib3V0U2l6ZVwiLGkuX3NzYW9Db21iaW5lUG9zdFByb2Nlc3Mud2lkdGgpLGUuc2V0VGV4dHVyZShcImRlcHRoU2FtcGxlclwiLGkuX2RlcHRoVGV4dHVyZSksaS5fZmlyc3RVcGRhdGUmJmUuc2V0QXJyYXkoXCJzYW1wbGVyT2Zmc2V0c1wiLHIpfSx0aGlzLl9ibHVyVlBvc3RQcm9jZXNzPW5ldyBlLlBvc3RQcm9jZXNzKFwiQmx1clZcIixcInNzYW9cIixbXCJvdXRTaXplXCIsXCJzYW1wbGVyT2Zmc2V0c1wiXSxbXCJkZXB0aFNhbXBsZXJcIl0sdCxudWxsLGUuVGV4dHVyZS5UUklMSU5FQVJfU0FNUExJTkdNT0RFLHRoaXMuX3NjZW5lLmdldEVuZ2luZSgpLCExLFwiI2RlZmluZSBCSUxBVEVSQUxfQkxVUlxcbiNkZWZpbmUgU0FNUExFUyAxNlwiKSx0aGlzLl9ibHVyVlBvc3RQcm9jZXNzLm9uQXBwbHk9ZnVuY3Rpb24oZSl7ZS5zZXRGbG9hdChcIm91dFNpemVcIixpLl9zc2FvQ29tYmluZVBvc3RQcm9jZXNzLmhlaWdodCksZS5zZXRUZXh0dXJlKFwiZGVwdGhTYW1wbGVyXCIsaS5fZGVwdGhUZXh0dXJlKSxpLl9maXJzdFVwZGF0ZSYmKGUuc2V0QXJyYXkoXCJzYW1wbGVyT2Zmc2V0c1wiLHIpLGkuX2ZpcnN0VXBkYXRlPSExKX19LGkucHJvdG90eXBlLl9jcmVhdGVTU0FPUG9zdFByb2Nlc3M9ZnVuY3Rpb24odCl7dmFyIGk9dGhpcyxyPTE2LG49Wy41MzgxLC4xODU2LC0uNDMxOSwuMTM3OSwuMjQ4NiwuNDQzLC4zMzcxLC41Njc5LC0uMDA1NywtLjY5OTksLS4wNDUxLC0uMDAxOSwuMDY4OSwtLjE1OTgsLS44NTQ3LC4wNTYsLjAwNjksLS4xODQzLC0uMDE0NiwuMTQwMiwuMDc2MiwuMDEsLS4xOTI0LC0uMDM0NCwtLjM1NzcsLS41MzAxLC0uNDM1OCwtLjMxNjksLjEwNjMsLjAxNTgsLjAxMDMsLS41ODY5LC4wMDQ2LC0uMDg5NywtLjQ5NCwuMzI4NywuNzExOSwtLjAxNTQsLS4wOTE4LC0uMDUzMywuMDU5NiwtLjU0MTEsLjAzNTIsLS4wNjMxLC41NDYsLS40Nzc2LC4yODQ3LC0uMDI3MV0sbz0xL3I7dGhpcy5fc3Nhb1Bvc3RQcm9jZXNzPW5ldyBlLlBvc3RQcm9jZXNzKFwic3Nhb1wiLFwic3Nhb1wiLFtcInNhbXBsZVNwaGVyZVwiLFwic2FtcGxlc0ZhY3RvclwiLFwicmFuZFRleHR1cmVUaWxlc1wiLFwidG90YWxTdHJlbmd0aFwiLFwicmFkaXVzXCIsXCJhcmVhXCIsXCJmYWxsT2ZmXCIsXCJiYXNlXCIsXCJyYW5nZVwiLFwidmlld3BvcnRcIl0sW1wicmFuZG9tU2FtcGxlclwiXSx0LG51bGwsZS5UZXh0dXJlLkJJTElORUFSX1NBTVBMSU5HTU9ERSx0aGlzLl9zY2VuZS5nZXRFbmdpbmUoKSwhMSxcIiNkZWZpbmUgU0FNUExFUyBcIityK1wiXFxuI2RlZmluZSBTU0FPXCIpO25ldyBlLlZlY3RvcjIoMCwwKTt0aGlzLl9zc2FvUG9zdFByb2Nlc3Mub25BcHBseT1mdW5jdGlvbihlKXtpLl9maXJzdFVwZGF0ZSYmKGUuc2V0QXJyYXkzKFwic2FtcGxlU3BoZXJlXCIsbiksZS5zZXRGbG9hdChcInNhbXBsZXNGYWN0b3JcIixvKSxlLnNldEZsb2F0KFwicmFuZFRleHR1cmVUaWxlc1wiLDQpKSxlLnNldEZsb2F0KFwidG90YWxTdHJlbmd0aFwiLGkudG90YWxTdHJlbmd0aCksZS5zZXRGbG9hdChcInJhZGl1c1wiLGkucmFkaXVzKSxlLnNldEZsb2F0KFwiYXJlYVwiLGkuYXJlYSksZS5zZXRGbG9hdChcImZhbGxPZmZcIixpLmZhbGxPZmYpLGUuc2V0RmxvYXQoXCJiYXNlXCIsaS5iYXNlKSxlLnNldFRleHR1cmUoXCJ0ZXh0dXJlU2FtcGxlclwiLGkuX2RlcHRoVGV4dHVyZSksZS5zZXRUZXh0dXJlKFwicmFuZG9tU2FtcGxlclwiLGkuX3JhbmRvbVRleHR1cmUpfX0saS5wcm90b3R5cGUuX2NyZWF0ZVNTQU9Db21iaW5lUG9zdFByb2Nlc3M9ZnVuY3Rpb24odCl7dmFyIGk9dGhpczt0aGlzLl9zc2FvQ29tYmluZVBvc3RQcm9jZXNzPW5ldyBlLlBvc3RQcm9jZXNzKFwic3Nhb0NvbWJpbmVcIixcInNzYW9Db21iaW5lXCIsW10sW1wib3JpZ2luYWxDb2xvclwiXSx0LG51bGwsZS5UZXh0dXJlLkJJTElORUFSX1NBTVBMSU5HTU9ERSx0aGlzLl9zY2VuZS5nZXRFbmdpbmUoKSwhMSksdGhpcy5fc3Nhb0NvbWJpbmVQb3N0UHJvY2Vzcy5vbkFwcGx5PWZ1bmN0aW9uKGUpe2Uuc2V0VGV4dHVyZUZyb21Qb3N0UHJvY2VzcyhcIm9yaWdpbmFsQ29sb3JcIixpLl9vcmlnaW5hbENvbG9yUG9zdFByb2Nlc3MpfX0saS5wcm90b3R5cGUuX2NyZWF0ZVJhbmRvbVRleHR1cmU9ZnVuY3Rpb24oKXt2YXIgdD01MTI7dGhpcy5fcmFuZG9tVGV4dHVyZT1uZXcgZS5EeW5hbWljVGV4dHVyZShcIlNTQU9SYW5kb21UZXh0dXJlXCIsdCx0aGlzLl9zY2VuZSwhMSxlLlRleHR1cmUuVFJJTElORUFSX1NBTVBMSU5HTU9ERSksdGhpcy5fcmFuZG9tVGV4dHVyZS53cmFwVT1lLlRleHR1cmUuV1JBUF9BRERSRVNTTU9ERSx0aGlzLl9yYW5kb21UZXh0dXJlLndyYXBWPWUuVGV4dHVyZS5XUkFQX0FERFJFU1NNT0RFO2Zvcih2YXIgaT10aGlzLl9yYW5kb21UZXh0dXJlLmdldENvbnRleHQoKSxyPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIE1hdGgucmFuZG9tKCkqKHQtZSkrZX0sbj1lLlZlY3RvcjMuWmVybygpLG89MDt0Pm87bysrKWZvcih2YXIgcz0wO3Q+cztzKyspbi54PU1hdGguZmxvb3IoMjU1KnIoLTEsMSkpLG4ueT1NYXRoLmZsb29yKDI1NSpyKC0xLDEpKSxuLno9TWF0aC5mbG9vcigyNTUqcigtMSwxKSksaS5maWxsU3R5bGU9XCJyZ2IoXCIrbi54K1wiLCBcIituLnkrXCIsIFwiK24ueitcIilcIixpLmZpbGxSZWN0KG8scywxLDEpO3RoaXMuX3JhbmRvbVRleHR1cmUudXBkYXRlKCExKX0sX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0saS5wcm90b3R5cGUsXCJ0b3RhbFN0cmVuZ3RoXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSxpLnByb3RvdHlwZSxcInJhZGl1c1wiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0saS5wcm90b3R5cGUsXCJhcmVhXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSxpLnByb3RvdHlwZSxcImZhbGxPZmZcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLGkucHJvdG90eXBlLFwiYmFzZVwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0saS5wcm90b3R5cGUsXCJfcmF0aW9cIix2b2lkIDApLGl9KGUuUG9zdFByb2Nlc3NSZW5kZXJQaXBlbGluZSk7ZS5TU0FPUmVuZGVyaW5nUGlwZWxpbmU9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gaShyLG4sbyxzLGEsaCxjLGwsdSl7dmFyIGY9dGhpczt2b2lkIDA9PT1hJiYoYT0xMDApLHZvaWQgMD09PWgmJihoPWUuVGV4dHVyZS5CSUxJTkVBUl9TQU1QTElOR01PREUpLHQuY2FsbCh0aGlzLHIsXCJ2b2x1bWV0cmljTGlnaHRTY2F0dGVyaW5nXCIsW1wiZGVjYXlcIixcImV4cG9zdXJlXCIsXCJ3ZWlnaHRcIixcIm1lc2hQb3NpdGlvbk9uU2NyZWVuXCIsXCJkZW5zaXR5XCJdLFtcImxpZ2h0U2NhdHRlcmluZ1NhbXBsZXJcIl0sbi5wb3N0UHJvY2Vzc1JhdGlvfHxuLG8saCxjLGwsXCIjZGVmaW5lIE5VTV9TQU1QTEVTIFwiK2EpLHRoaXMuX3NjcmVlbkNvb3JkaW5hdGVzPWUuVmVjdG9yMi5aZXJvKCksdGhpcy5jdXN0b21NZXNoUG9zaXRpb249ZS5WZWN0b3IzLlplcm8oKSx0aGlzLnVzZUN1c3RvbU1lc2hQb3NpdGlvbj0hMSx0aGlzLmludmVydD0hMCx0aGlzLmV4Y2x1ZGVkTWVzaGVzPW5ldyBBcnJheSx0aGlzLmV4cG9zdXJlPS4zLHRoaXMuZGVjYXk9Ljk2ODE1LHRoaXMud2VpZ2h0PS41ODc2Nyx0aGlzLmRlbnNpdHk9LjkyNix1PW51bGw9PT1vP3U6by5nZXRTY2VuZSgpO3ZhciBjPXUuZ2V0RW5naW5lKCk7dGhpcy5fdmlld1BvcnQ9bmV3IGUuVmlld3BvcnQoMCwwLDEsMSkudG9HbG9iYWwoYy5nZXRSZW5kZXJXaWR0aCgpLGMuZ2V0UmVuZGVySGVpZ2h0KCkpLHRoaXMubWVzaD1udWxsIT09cz9zOmkuQ3JlYXRlRGVmYXVsdE1lc2goXCJWb2x1bWV0cmljTGlnaHRTY2F0dGVyaW5nTWVzaFwiLHUpLHRoaXMuX2NyZWF0ZVBhc3ModSxuLnBhc3NSYXRpb3x8biksdGhpcy5vbkFjdGl2YXRlPWZ1bmN0aW9uKGUpe2YuaXNTdXBwb3J0ZWR8fGYuZGlzcG9zZShlKSxcbmYub25BY3RpdmF0ZT1udWxsfSx0aGlzLm9uQXBwbHlPYnNlcnZhYmxlLmFkZChmdW5jdGlvbihlKXtmLl91cGRhdGVNZXNoU2NyZWVuQ29vcmRpbmF0ZXModSksZS5zZXRUZXh0dXJlKFwibGlnaHRTY2F0dGVyaW5nU2FtcGxlclwiLGYuX3ZvbHVtZXRyaWNMaWdodFNjYXR0ZXJpbmdSVFQpLGUuc2V0RmxvYXQoXCJleHBvc3VyZVwiLGYuZXhwb3N1cmUpLGUuc2V0RmxvYXQoXCJkZWNheVwiLGYuZGVjYXkpLGUuc2V0RmxvYXQoXCJ3ZWlnaHRcIixmLndlaWdodCksZS5zZXRGbG9hdChcImRlbnNpdHlcIixmLmRlbnNpdHkpLGUuc2V0VmVjdG9yMihcIm1lc2hQb3NpdGlvbk9uU2NyZWVuXCIsZi5fc2NyZWVuQ29vcmRpbmF0ZXMpfSl9cmV0dXJuIF9fZXh0ZW5kcyhpLHQpLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpLnByb3RvdHlwZSxcInVzZURpZmZ1c2VDb2xvclwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gZS5Ub29scy5XYXJuKFwiVm9sdW1ldHJpY0xpZ2h0U2NhdHRlcmluZ1Bvc3RQcm9jZXNzLnVzZURpZmZ1c2VDb2xvciBpcyBubyBsb25nZXIgdXNlZCwgdXNlIHRoZSBtZXNoIG1hdGVyaWFsIGRpcmVjdGx5IGluc3RlYWRcIiksITF9LHNldDpmdW5jdGlvbih0KXtlLlRvb2xzLldhcm4oXCJWb2x1bWV0cmljTGlnaHRTY2F0dGVyaW5nUG9zdFByb2Nlc3MudXNlRGlmZnVzZUNvbG9yIGlzIG5vIGxvbmdlciB1c2VkLCB1c2UgdGhlIG1lc2ggbWF0ZXJpYWwgZGlyZWN0bHkgaW5zdGVhZFwiKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxpLnByb3RvdHlwZS5pc1JlYWR5PWZ1bmN0aW9uKHQsaSl7dmFyIHI9dC5nZXRNZXNoKCk7aWYocj09PXRoaXMubWVzaClyZXR1cm4gci5tYXRlcmlhbC5pc1JlYWR5KHIpO3ZhciBuPVtdLG89W2UuVmVydGV4QnVmZmVyLlBvc2l0aW9uS2luZF0scz10LmdldE1hdGVyaWFsKCk7cyYmKHMubmVlZEFscGhhVGVzdGluZygpJiZuLnB1c2goXCIjZGVmaW5lIEFMUEhBVEVTVFwiKSxyLmlzVmVydGljZXNEYXRhUHJlc2VudChlLlZlcnRleEJ1ZmZlci5VVktpbmQpJiYoby5wdXNoKGUuVmVydGV4QnVmZmVyLlVWS2luZCksbi5wdXNoKFwiI2RlZmluZSBVVjFcIikpLHIuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGUuVmVydGV4QnVmZmVyLlVWMktpbmQpJiYoby5wdXNoKGUuVmVydGV4QnVmZmVyLlVWMktpbmQpLG4ucHVzaChcIiNkZWZpbmUgVVYyXCIpKSksci51c2VCb25lcyYmci5jb21wdXRlQm9uZXNVc2luZ1NoYWRlcnM/KG8ucHVzaChlLlZlcnRleEJ1ZmZlci5NYXRyaWNlc0luZGljZXNLaW5kKSxvLnB1c2goZS5WZXJ0ZXhCdWZmZXIuTWF0cmljZXNXZWlnaHRzS2luZCksbi5wdXNoKFwiI2RlZmluZSBOVU1fQk9ORV9JTkZMVUVOQ0VSUyBcIityLm51bUJvbmVJbmZsdWVuY2Vycyksbi5wdXNoKFwiI2RlZmluZSBCb25lc1Blck1lc2ggXCIrKHIuc2tlbGV0b24uYm9uZXMubGVuZ3RoKzEpKSk6bi5wdXNoKFwiI2RlZmluZSBOVU1fQk9ORV9JTkZMVUVOQ0VSUyAwXCIpLGkmJihuLnB1c2goXCIjZGVmaW5lIElOU1RBTkNFU1wiKSxvLnB1c2goXCJ3b3JsZDBcIiksby5wdXNoKFwid29ybGQxXCIpLG8ucHVzaChcIndvcmxkMlwiKSxvLnB1c2goXCJ3b3JsZDNcIikpO3ZhciBhPW4uam9pbihcIlxcblwiKTtyZXR1cm4gdGhpcy5fY2FjaGVkRGVmaW5lcyE9PWEmJih0aGlzLl9jYWNoZWREZWZpbmVzPWEsdGhpcy5fdm9sdW1ldHJpY0xpZ2h0U2NhdHRlcmluZ1Bhc3M9ci5nZXRTY2VuZSgpLmdldEVuZ2luZSgpLmNyZWF0ZUVmZmVjdCh7dmVydGV4RWxlbWVudDpcImRlcHRoXCIsZnJhZ21lbnRFbGVtZW50Olwidm9sdW1ldHJpY0xpZ2h0U2NhdHRlcmluZ1Bhc3NcIn0sbyxbXCJ3b3JsZFwiLFwibUJvbmVzXCIsXCJ2aWV3UHJvamVjdGlvblwiLFwiZGlmZnVzZU1hdHJpeFwiXSxbXCJkaWZmdXNlU2FtcGxlclwiXSxhKSksdGhpcy5fdm9sdW1ldHJpY0xpZ2h0U2NhdHRlcmluZ1Bhc3MuaXNSZWFkeSgpfSxpLnByb3RvdHlwZS5zZXRDdXN0b21NZXNoUG9zaXRpb249ZnVuY3Rpb24oZSl7dGhpcy5jdXN0b21NZXNoUG9zaXRpb249ZX0saS5wcm90b3R5cGUuZ2V0Q3VzdG9tTWVzaFBvc2l0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY3VzdG9tTWVzaFBvc2l0aW9ufSxpLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKGUpe3ZhciBpPWUuZ2V0U2NlbmUoKS5jdXN0b21SZW5kZXJUYXJnZXRzLmluZGV4T2YodGhpcy5fdm9sdW1ldHJpY0xpZ2h0U2NhdHRlcmluZ1JUVCk7LTEhPT1pJiZlLmdldFNjZW5lKCkuY3VzdG9tUmVuZGVyVGFyZ2V0cy5zcGxpY2UoaSwxKSx0aGlzLl92b2x1bWV0cmljTGlnaHRTY2F0dGVyaW5nUlRULmRpc3Bvc2UoKSx0LnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyxlKX0saS5wcm90b3R5cGUuZ2V0UGFzcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLl92b2x1bWV0cmljTGlnaHRTY2F0dGVyaW5nUlRUfSxpLnByb3RvdHlwZS5fbWVzaEV4Y2x1ZGVkPWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmV4Y2x1ZGVkTWVzaGVzLmxlbmd0aD4wJiYtMSE9PXRoaXMuZXhjbHVkZWRNZXNoZXMuaW5kZXhPZihlKX0saS5wcm90b3R5cGUuX2NyZWF0ZVBhc3M9ZnVuY3Rpb24odCxpKXt2YXIgcj10aGlzLG49dC5nZXRFbmdpbmUoKTt0aGlzLl92b2x1bWV0cmljTGlnaHRTY2F0dGVyaW5nUlRUPW5ldyBlLlJlbmRlclRhcmdldFRleHR1cmUoXCJ2b2x1bWV0cmljTGlnaHRTY2F0dGVyaW5nTWFwXCIse3dpZHRoOm4uZ2V0UmVuZGVyV2lkdGgoKSppLGhlaWdodDpuLmdldFJlbmRlckhlaWdodCgpKml9LHQsITEsITAsZS5FbmdpbmUuVEVYVFVSRVRZUEVfVU5TSUdORURfSU5UKSx0aGlzLl92b2x1bWV0cmljTGlnaHRTY2F0dGVyaW5nUlRULndyYXBVPWUuVGV4dHVyZS5DTEFNUF9BRERSRVNTTU9ERSx0aGlzLl92b2x1bWV0cmljTGlnaHRTY2F0dGVyaW5nUlRULndyYXBWPWUuVGV4dHVyZS5DTEFNUF9BRERSRVNTTU9ERSx0aGlzLl92b2x1bWV0cmljTGlnaHRTY2F0dGVyaW5nUlRULnJlbmRlckxpc3Q9bnVsbCx0aGlzLl92b2x1bWV0cmljTGlnaHRTY2F0dGVyaW5nUlRULnJlbmRlclBhcnRpY2xlcz0hMSx0LmN1c3RvbVJlbmRlclRhcmdldHMucHVzaCh0aGlzLl92b2x1bWV0cmljTGlnaHRTY2F0dGVyaW5nUlRUKTt2YXIgbyxzPWZ1bmN0aW9uKHQpe3ZhciBpPXQuZ2V0UmVuZGVyaW5nTWVzaCgpO2lmKCFyLl9tZXNoRXhjbHVkZWQoaSkpe3ZhciBuPWkuZ2V0U2NlbmUoKSxvPW4uZ2V0RW5naW5lKCk7by5zZXRTdGF0ZSh0LmdldE1hdGVyaWFsKCkuYmFja0ZhY2VDdWxsaW5nKTt2YXIgcz1pLl9nZXRJbnN0YW5jZXNSZW5kZXJMaXN0KHQuX2lkKTtpZighcy5tdXN0UmV0dXJuKXt2YXIgYT1udWxsIT09by5nZXRDYXBzKCkuaW5zdGFuY2VkQXJyYXlzJiZudWxsIT09cy52aXNpYmxlSW5zdGFuY2VzW3QuX2lkXTtpZihyLmlzUmVhZHkodCxhKSl7dmFyIGg9ci5fdm9sdW1ldHJpY0xpZ2h0U2NhdHRlcmluZ1Bhc3M7aWYoaT09PXIubWVzaCYmKGg9dC5nZXRNYXRlcmlhbCgpLmdldEVmZmVjdCgpKSxvLmVuYWJsZUVmZmVjdChoKSxpLl9iaW5kKHQsaCxlLk1hdGVyaWFsLlRyaWFuZ2xlRmlsbE1vZGUpLGk9PT1yLm1lc2gpdC5nZXRNYXRlcmlhbCgpLmJpbmQoaS5nZXRXb3JsZE1hdHJpeCgpLGkpO2Vsc2V7dmFyIGM9dC5nZXRNYXRlcmlhbCgpO2lmKHIuX3ZvbHVtZXRyaWNMaWdodFNjYXR0ZXJpbmdQYXNzLnNldE1hdHJpeChcInZpZXdQcm9qZWN0aW9uXCIsbi5nZXRUcmFuc2Zvcm1NYXRyaXgoKSksYyYmYy5uZWVkQWxwaGFUZXN0aW5nKCkpe3ZhciBsPWMuZ2V0QWxwaGFUZXN0VGV4dHVyZSgpO3IuX3ZvbHVtZXRyaWNMaWdodFNjYXR0ZXJpbmdQYXNzLnNldFRleHR1cmUoXCJkaWZmdXNlU2FtcGxlclwiLGwpLGwmJnIuX3ZvbHVtZXRyaWNMaWdodFNjYXR0ZXJpbmdQYXNzLnNldE1hdHJpeChcImRpZmZ1c2VNYXRyaXhcIixsLmdldFRleHR1cmVNYXRyaXgoKSl9aS51c2VCb25lcyYmaS5jb21wdXRlQm9uZXNVc2luZ1NoYWRlcnMmJnIuX3ZvbHVtZXRyaWNMaWdodFNjYXR0ZXJpbmdQYXNzLnNldE1hdHJpY2VzKFwibUJvbmVzXCIsaS5za2VsZXRvbi5nZXRUcmFuc2Zvcm1NYXRyaWNlcyhpKSl9aS5fcHJvY2Vzc1JlbmRlcmluZyh0LHIuX3ZvbHVtZXRyaWNMaWdodFNjYXR0ZXJpbmdQYXNzLGUuTWF0ZXJpYWwuVHJpYW5nbGVGaWxsTW9kZSxzLGEsZnVuY3Rpb24oZSx0KXtyZXR1cm4gaC5zZXRNYXRyaXgoXCJ3b3JsZFwiLHQpfSl9fX19LGE9bmV3IGUuQ29sb3I0KDAsMCwwLDEpO3RoaXMuX3ZvbHVtZXRyaWNMaWdodFNjYXR0ZXJpbmdSVFQub25CZWZvcmVSZW5kZXJPYnNlcnZhYmxlLmFkZChmdW5jdGlvbigpe289dC5jbGVhckNvbG9yLHQuY2xlYXJDb2xvcj1hfSksdGhpcy5fdm9sdW1ldHJpY0xpZ2h0U2NhdHRlcmluZ1JUVC5vbkFmdGVyUmVuZGVyT2JzZXJ2YWJsZS5hZGQoZnVuY3Rpb24oKXt0LmNsZWFyQ29sb3I9b30pLHRoaXMuX3ZvbHVtZXRyaWNMaWdodFNjYXR0ZXJpbmdSVFQuY3VzdG9tUmVuZGVyRnVuY3Rpb249ZnVuY3Rpb24oaSxyLG4pe3ZhciBvLGE9dC5nZXRFbmdpbmUoKTtmb3Iobz0wO288aS5sZW5ndGg7bysrKXMoaS5kYXRhW29dKTtmb3IoYS5zZXRBbHBoYVRlc3RpbmcoITApLG89MDtvPHIubGVuZ3RoO28rKylzKHIuZGF0YVtvXSk7aWYoYS5zZXRBbHBoYVRlc3RpbmcoITEpLG4ubGVuZ3RoKXtmb3Iobz0wO288bi5sZW5ndGg7bysrKXt2YXIgaD1uLmRhdGFbb107aC5fYWxwaGFJbmRleD1oLmdldE1lc2goKS5hbHBoYUluZGV4LGguX2Rpc3RhbmNlVG9DYW1lcmE9aC5nZXRCb3VuZGluZ0luZm8oKS5ib3VuZGluZ1NwaGVyZS5jZW50ZXJXb3JsZC5zdWJ0cmFjdCh0LmFjdGl2ZUNhbWVyYS5wb3NpdGlvbikubGVuZ3RoKCl9dmFyIGM9bi5kYXRhLnNsaWNlKDAsbi5sZW5ndGgpO2ZvcihjLnNvcnQoZnVuY3Rpb24oZSx0KXtyZXR1cm4gZS5fYWxwaGFJbmRleD50Ll9hbHBoYUluZGV4PzE6ZS5fYWxwaGFJbmRleDx0Ll9hbHBoYUluZGV4Py0xOmUuX2Rpc3RhbmNlVG9DYW1lcmE8dC5fZGlzdGFuY2VUb0NhbWVyYT8xOmUuX2Rpc3RhbmNlVG9DYW1lcmE+dC5fZGlzdGFuY2VUb0NhbWVyYT8tMTowfSksYS5zZXRBbHBoYU1vZGUoZS5FbmdpbmUuQUxQSEFfQ09NQklORSksbz0wO288Yy5sZW5ndGg7bysrKXMoY1tvXSk7YS5zZXRBbHBoYU1vZGUoZS5FbmdpbmUuQUxQSEFfRElTQUJMRSl9fX0saS5wcm90b3R5cGUuX3VwZGF0ZU1lc2hTY3JlZW5Db29yZGluYXRlcz1mdW5jdGlvbih0KXt2YXIgaSxyPXQuZ2V0VHJhbnNmb3JtTWF0cml4KCk7aT10aGlzLnVzZUN1c3RvbU1lc2hQb3NpdGlvbj90aGlzLmN1c3RvbU1lc2hQb3NpdGlvbjp0aGlzLmF0dGFjaGVkTm9kZT90aGlzLmF0dGFjaGVkTm9kZS5wb3NpdGlvbjp0aGlzLm1lc2gucGFyZW50P3RoaXMubWVzaC5nZXRBYnNvbHV0ZVBvc2l0aW9uKCk6dGhpcy5tZXNoLnBvc2l0aW9uO3ZhciBuPWUuVmVjdG9yMy5Qcm9qZWN0KGksZS5NYXRyaXguSWRlbnRpdHkoKSxyLHRoaXMuX3ZpZXdQb3J0KTt0aGlzLl9zY3JlZW5Db29yZGluYXRlcy54PW4ueC90aGlzLl92aWV3UG9ydC53aWR0aCx0aGlzLl9zY3JlZW5Db29yZGluYXRlcy55PW4ueS90aGlzLl92aWV3UG9ydC5oZWlnaHQsdGhpcy5pbnZlcnQmJih0aGlzLl9zY3JlZW5Db29yZGluYXRlcy55PTEtdGhpcy5fc2NyZWVuQ29vcmRpbmF0ZXMueSl9LGkuQ3JlYXRlRGVmYXVsdE1lc2g9ZnVuY3Rpb24odCxpKXt2YXIgcj1lLk1lc2guQ3JlYXRlUGxhbmUodCwxLGkpO3IuYmlsbGJvYXJkTW9kZT1lLkFic3RyYWN0TWVzaC5CSUxMQk9BUkRNT0RFX0FMTDt2YXIgbj1uZXcgZS5TdGFuZGFyZE1hdGVyaWFsKHQrXCJNYXRlcmlhbFwiLGkpO3JldHVybiBuLmVtaXNzaXZlQ29sb3I9bmV3IGUuQ29sb3IzKDEsMSwxKSxyLm1hdGVyaWFsPW4scn0sX19kZWNvcmF0ZShbZS5zZXJpYWxpemVBc1ZlY3RvcjMoKV0saS5wcm90b3R5cGUsXCJjdXN0b21NZXNoUG9zaXRpb25cIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLGkucHJvdG90eXBlLFwidXNlQ3VzdG9tTWVzaFBvc2l0aW9uXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSxpLnByb3RvdHlwZSxcImludmVydFwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemVBc01lc2hSZWZlcmVuY2UoKV0saS5wcm90b3R5cGUsXCJtZXNoXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSxpLnByb3RvdHlwZSxcImV4Y2x1ZGVkTWVzaGVzXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSxpLnByb3RvdHlwZSxcImV4cG9zdXJlXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSxpLnByb3RvdHlwZSxcImRlY2F5XCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSxpLnByb3RvdHlwZSxcIndlaWdodFwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0saS5wcm90b3R5cGUsXCJkZW5zaXR5XCIsdm9pZCAwKSxpfShlLlBvc3RQcm9jZXNzKTtlLlZvbHVtZXRyaWNMaWdodFNjYXR0ZXJpbmdQb3N0UHJvY2Vzcz10fShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbih0KXtmdW5jdGlvbiBpKGkscixuLG8scyl7dmFyIGE9dGhpczt2b2lkIDA9PT1vJiYobz0xKSx0LmNhbGwodGhpcyxuLmdldEVuZ2luZSgpLGkpLHRoaXMuTGVuc0Nocm9tYXRpY0FiZXJyYXRpb25FZmZlY3Q9XCJMZW5zQ2hyb21hdGljQWJlcnJhdGlvbkVmZmVjdFwiLHRoaXMuSGlnaGxpZ2h0c0VuaGFuY2luZ0VmZmVjdD1cIkhpZ2hsaWdodHNFbmhhbmNpbmdFZmZlY3RcIix0aGlzLkxlbnNEZXB0aE9mRmllbGRFZmZlY3Q9XCJMZW5zRGVwdGhPZkZpZWxkRWZmZWN0XCIsdGhpcy5fc2NlbmU9bix0aGlzLl9kZXB0aFRleHR1cmU9bi5lbmFibGVEZXB0aFJlbmRlcmVyKCkuZ2V0RGVwdGhNYXAoKSxyLmdyYWluX3RleHR1cmU/dGhpcy5fZ3JhaW5UZXh0dXJlPXIuZ3JhaW5fdGV4dHVyZTp0aGlzLl9jcmVhdGVHcmFpblRleHR1cmUoKSx0aGlzLl9lZGdlQmx1cj1yLmVkZ2VfYmx1cj9yLmVkZ2VfYmx1cjowLHRoaXMuX2dyYWluQW1vdW50PXIuZ3JhaW5fYW1vdW50P3IuZ3JhaW5fYW1vdW50OjAsdGhpcy5fY2hyb21hdGljQWJlcnJhdGlvbj1yLmNocm9tYXRpY19hYmVycmF0aW9uP3IuY2hyb21hdGljX2FiZXJyYXRpb246MCx0aGlzLl9kaXN0b3J0aW9uPXIuZGlzdG9ydGlvbj9yLmRpc3RvcnRpb246MCx0aGlzLl9oaWdobGlnaHRzR2Fpbj12b2lkIDAhPT1yLmRvZl9nYWluP3IuZG9mX2dhaW46LTEsdGhpcy5faGlnaGxpZ2h0c1RocmVzaG9sZD1yLmRvZl90aHJlc2hvbGQ/ci5kb2ZfdGhyZXNob2xkOjEsdGhpcy5fZG9mRGlzdGFuY2U9dm9pZCAwIT09ci5kb2ZfZm9jdXNfZGlzdGFuY2U/ci5kb2ZfZm9jdXNfZGlzdGFuY2U6LTEsdGhpcy5fZG9mQXBlcnR1cmU9ci5kb2ZfYXBlcnR1cmU/ci5kb2ZfYXBlcnR1cmU6MSx0aGlzLl9kb2ZEYXJrZW49ci5kb2ZfZGFya2VuP3IuZG9mX2RhcmtlbjowLHRoaXMuX2RvZlBlbnRhZ29uPXZvaWQgMCE9PXIuZG9mX3BlbnRhZ29uP3IuZG9mX3BlbnRhZ29uOiEwLHRoaXMuX2JsdXJOb2lzZT12b2lkIDAhPT1yLmJsdXJfbm9pc2U/ci5ibHVyX25vaXNlOiEwLHRoaXMuX2NyZWF0ZUNocm9tYXRpY0FiZXJyYXRpb25Qb3N0UHJvY2VzcyhvKSx0aGlzLl9jcmVhdGVIaWdobGlnaHRzUG9zdFByb2Nlc3MobyksdGhpcy5fY3JlYXRlRGVwdGhPZkZpZWxkUG9zdFByb2Nlc3Moby80KSx0aGlzLmFkZEVmZmVjdChuZXcgZS5Qb3N0UHJvY2Vzc1JlbmRlckVmZmVjdChuLmdldEVuZ2luZSgpLHRoaXMuTGVuc0Nocm9tYXRpY0FiZXJyYXRpb25FZmZlY3QsZnVuY3Rpb24oKXtyZXR1cm4gYS5fY2hyb21hdGljQWJlcnJhdGlvblBvc3RQcm9jZXNzfSwhMCkpLHRoaXMuYWRkRWZmZWN0KG5ldyBlLlBvc3RQcm9jZXNzUmVuZGVyRWZmZWN0KG4uZ2V0RW5naW5lKCksdGhpcy5IaWdobGlnaHRzRW5oYW5jaW5nRWZmZWN0LGZ1bmN0aW9uKCl7cmV0dXJuIGEuX2hpZ2hsaWdodHNQb3N0UHJvY2Vzc30sITApKSx0aGlzLmFkZEVmZmVjdChuZXcgZS5Qb3N0UHJvY2Vzc1JlbmRlckVmZmVjdChuLmdldEVuZ2luZSgpLHRoaXMuTGVuc0RlcHRoT2ZGaWVsZEVmZmVjdCxmdW5jdGlvbigpe3JldHVybiBhLl9kZXB0aE9mRmllbGRQb3N0UHJvY2Vzc30sITApKSwtMT09PXRoaXMuX2hpZ2hsaWdodHNHYWluJiZ0aGlzLl9kaXNhYmxlRWZmZWN0KHRoaXMuSGlnaGxpZ2h0c0VuaGFuY2luZ0VmZmVjdCxudWxsKSxuLnBvc3RQcm9jZXNzUmVuZGVyUGlwZWxpbmVNYW5hZ2VyLmFkZFBpcGVsaW5lKHRoaXMpLHMmJm4ucG9zdFByb2Nlc3NSZW5kZXJQaXBlbGluZU1hbmFnZXIuYXR0YWNoQ2FtZXJhc1RvUmVuZGVyUGlwZWxpbmUoaSxzKX1yZXR1cm4gX19leHRlbmRzKGksdCksaS5wcm90b3R5cGUuc2V0RWRnZUJsdXI9ZnVuY3Rpb24oZSl7dGhpcy5fZWRnZUJsdXI9ZX0saS5wcm90b3R5cGUuZGlzYWJsZUVkZ2VCbHVyPWZ1bmN0aW9uKCl7dGhpcy5fZWRnZUJsdXI9MH0saS5wcm90b3R5cGUuc2V0R3JhaW5BbW91bnQ9ZnVuY3Rpb24oZSl7dGhpcy5fZ3JhaW5BbW91bnQ9ZX0saS5wcm90b3R5cGUuZGlzYWJsZUdyYWluPWZ1bmN0aW9uKCl7dGhpcy5fZ3JhaW5BbW91bnQ9MH0saS5wcm90b3R5cGUuc2V0Q2hyb21hdGljQWJlcnJhdGlvbj1mdW5jdGlvbihlKXt0aGlzLl9jaHJvbWF0aWNBYmVycmF0aW9uPWV9LGkucHJvdG90eXBlLmRpc2FibGVDaHJvbWF0aWNBYmVycmF0aW9uPWZ1bmN0aW9uKCl7dGhpcy5fY2hyb21hdGljQWJlcnJhdGlvbj0wfSxpLnByb3RvdHlwZS5zZXRFZGdlRGlzdG9ydGlvbj1mdW5jdGlvbihlKXt0aGlzLl9kaXN0b3J0aW9uPWV9LGkucHJvdG90eXBlLmRpc2FibGVFZGdlRGlzdG9ydGlvbj1mdW5jdGlvbigpe3RoaXMuX2Rpc3RvcnRpb249MH0saS5wcm90b3R5cGUuc2V0Rm9jdXNEaXN0YW5jZT1mdW5jdGlvbihlKXt0aGlzLl9kb2ZEaXN0YW5jZT1lfSxpLnByb3RvdHlwZS5kaXNhYmxlRGVwdGhPZkZpZWxkPWZ1bmN0aW9uKCl7dGhpcy5fZG9mRGlzdGFuY2U9LTF9LGkucHJvdG90eXBlLnNldEFwZXJ0dXJlPWZ1bmN0aW9uKGUpe3RoaXMuX2RvZkFwZXJ0dXJlPWV9LGkucHJvdG90eXBlLnNldERhcmtlbk91dE9mRm9jdXM9ZnVuY3Rpb24oZSl7dGhpcy5fZG9mRGFya2VuPWV9LGkucHJvdG90eXBlLmVuYWJsZVBlbnRhZ29uQm9rZWg9ZnVuY3Rpb24oKXt0aGlzLl9oaWdobGlnaHRzUG9zdFByb2Nlc3MudXBkYXRlRWZmZWN0KFwiI2RlZmluZSBQRU5UQUdPTlxcblwiKX0saS5wcm90b3R5cGUuZGlzYWJsZVBlbnRhZ29uQm9rZWg9ZnVuY3Rpb24oKXt0aGlzLl9oaWdobGlnaHRzUG9zdFByb2Nlc3MudXBkYXRlRWZmZWN0KCl9LGkucHJvdG90eXBlLmVuYWJsZU5vaXNlQmx1cj1mdW5jdGlvbigpe3RoaXMuX2JsdXJOb2lzZT0hMH0saS5wcm90b3R5cGUuZGlzYWJsZU5vaXNlQmx1cj1mdW5jdGlvbigpe3RoaXMuX2JsdXJOb2lzZT0hMX0saS5wcm90b3R5cGUuc2V0SGlnaGxpZ2h0c0dhaW49ZnVuY3Rpb24oZSl7dGhpcy5faGlnaGxpZ2h0c0dhaW49ZX0saS5wcm90b3R5cGUuc2V0SGlnaGxpZ2h0c1RocmVzaG9sZD1mdW5jdGlvbihlKXstMT09PXRoaXMuX2hpZ2hsaWdodHNHYWluJiYodGhpcy5faGlnaGxpZ2h0c0dhaW49MSksdGhpcy5faGlnaGxpZ2h0c1RocmVzaG9sZD1lfSxpLnByb3RvdHlwZS5kaXNhYmxlSGlnaGxpZ2h0cz1mdW5jdGlvbigpe3RoaXMuX2hpZ2hsaWdodHNHYWluPS0xfSxpLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKGUpe3ZvaWQgMD09PWUmJihlPSExKSx0aGlzLl9zY2VuZS5wb3N0UHJvY2Vzc1JlbmRlclBpcGVsaW5lTWFuYWdlci5kZXRhY2hDYW1lcmFzRnJvbVJlbmRlclBpcGVsaW5lKHRoaXMuX25hbWUsdGhpcy5fc2NlbmUuY2FtZXJhcyksdGhpcy5fY2hyb21hdGljQWJlcnJhdGlvblBvc3RQcm9jZXNzPXZvaWQgMCx0aGlzLl9oaWdobGlnaHRzUG9zdFByb2Nlc3M9dm9pZCAwLHRoaXMuX2RlcHRoT2ZGaWVsZFBvc3RQcm9jZXNzPXZvaWQgMCx0aGlzLl9ncmFpblRleHR1cmUuZGlzcG9zZSgpLGUmJnRoaXMuX3NjZW5lLmRpc2FibGVEZXB0aFJlbmRlcmVyKCl9LGkucHJvdG90eXBlLl9jcmVhdGVDaHJvbWF0aWNBYmVycmF0aW9uUG9zdFByb2Nlc3M9ZnVuY3Rpb24odCl7dmFyIGk9dGhpczt0aGlzLl9jaHJvbWF0aWNBYmVycmF0aW9uUG9zdFByb2Nlc3M9bmV3IGUuUG9zdFByb2Nlc3MoXCJMZW5zQ2hyb21hdGljQWJlcnJhdGlvblwiLFwiY2hyb21hdGljQWJlcnJhdGlvblwiLFtcImNocm9tYXRpY19hYmVycmF0aW9uXCIsXCJzY3JlZW5fd2lkdGhcIixcInNjcmVlbl9oZWlnaHRcIl0sW10sdCxudWxsLGUuVGV4dHVyZS5UUklMSU5FQVJfU0FNUExJTkdNT0RFLHRoaXMuX3NjZW5lLmdldEVuZ2luZSgpLCExKSx0aGlzLl9jaHJvbWF0aWNBYmVycmF0aW9uUG9zdFByb2Nlc3Mub25BcHBseT1mdW5jdGlvbihlKXtlLnNldEZsb2F0KFwiY2hyb21hdGljX2FiZXJyYXRpb25cIixpLl9jaHJvbWF0aWNBYmVycmF0aW9uKSxlLnNldEZsb2F0KFwic2NyZWVuX3dpZHRoXCIsaS5fc2NlbmUuZ2V0RW5naW5lKCkuZ2V0UmVuZGVyaW5nQ2FudmFzKCkud2lkdGgpLGUuc2V0RmxvYXQoXCJzY3JlZW5faGVpZ2h0XCIsaS5fc2NlbmUuZ2V0RW5naW5lKCkuZ2V0UmVuZGVyaW5nQ2FudmFzKCkuaGVpZ2h0KX19LGkucHJvdG90eXBlLl9jcmVhdGVIaWdobGlnaHRzUG9zdFByb2Nlc3M9ZnVuY3Rpb24odCl7dmFyIGk9dGhpczt0aGlzLl9oaWdobGlnaHRzUG9zdFByb2Nlc3M9bmV3IGUuUG9zdFByb2Nlc3MoXCJMZW5zSGlnaGxpZ2h0c1wiLFwibGVuc0hpZ2hsaWdodHNcIixbXCJnYWluXCIsXCJ0aHJlc2hvbGRcIixcInNjcmVlbl93aWR0aFwiLFwic2NyZWVuX2hlaWdodFwiXSxbXSx0LG51bGwsZS5UZXh0dXJlLlRSSUxJTkVBUl9TQU1QTElOR01PREUsdGhpcy5fc2NlbmUuZ2V0RW5naW5lKCksITEsdGhpcy5fZG9mUGVudGFnb24/XCIjZGVmaW5lIFBFTlRBR09OXFxuXCI6XCJcIiksdGhpcy5faGlnaGxpZ2h0c1Bvc3RQcm9jZXNzLm9uQXBwbHk9ZnVuY3Rpb24oZSl7ZS5zZXRGbG9hdChcImdhaW5cIixpLl9oaWdobGlnaHRzR2FpbiksZS5zZXRGbG9hdChcInRocmVzaG9sZFwiLGkuX2hpZ2hsaWdodHNUaHJlc2hvbGQpLGUuc2V0VGV4dHVyZUZyb21Qb3N0UHJvY2VzcyhcInRleHR1cmVTYW1wbGVyXCIsaS5fY2hyb21hdGljQWJlcnJhdGlvblBvc3RQcm9jZXNzKSxlLnNldEZsb2F0KFwic2NyZWVuX3dpZHRoXCIsaS5fc2NlbmUuZ2V0RW5naW5lKCkuZ2V0UmVuZGVyaW5nQ2FudmFzKCkud2lkdGgpLGUuc2V0RmxvYXQoXCJzY3JlZW5faGVpZ2h0XCIsaS5fc2NlbmUuZ2V0RW5naW5lKCkuZ2V0UmVuZGVyaW5nQ2FudmFzKCkuaGVpZ2h0KX19LGkucHJvdG90eXBlLl9jcmVhdGVEZXB0aE9mRmllbGRQb3N0UHJvY2Vzcz1mdW5jdGlvbih0KXt2YXIgaT10aGlzO3RoaXMuX2RlcHRoT2ZGaWVsZFBvc3RQcm9jZXNzPW5ldyBlLlBvc3RQcm9jZXNzKFwiTGVuc0RlcHRoT2ZGaWVsZFwiLFwiZGVwdGhPZkZpZWxkXCIsW1wiZ3JhaW5fYW1vdW50XCIsXCJibHVyX25vaXNlXCIsXCJzY3JlZW5fd2lkdGhcIixcInNjcmVlbl9oZWlnaHRcIixcImRpc3RvcnRpb25cIixcImRvZl9lbmFibGVkXCIsXCJzY3JlZW5fZGlzdGFuY2VcIixcImFwZXJ0dXJlXCIsXCJkYXJrZW5cIixcImVkZ2VfYmx1clwiLFwiaGlnaGxpZ2h0c1wiLFwibmVhclwiLFwiZmFyXCJdLFtcImRlcHRoU2FtcGxlclwiLFwiZ3JhaW5TYW1wbGVyXCIsXCJoaWdobGlnaHRzU2FtcGxlclwiXSx0LG51bGwsZS5UZXh0dXJlLlRSSUxJTkVBUl9TQU1QTElOR01PREUsdGhpcy5fc2NlbmUuZ2V0RW5naW5lKCksITEpLHRoaXMuX2RlcHRoT2ZGaWVsZFBvc3RQcm9jZXNzLm9uQXBwbHk9ZnVuY3Rpb24oZSl7ZS5zZXRUZXh0dXJlKFwiZGVwdGhTYW1wbGVyXCIsaS5fZGVwdGhUZXh0dXJlKSxlLnNldFRleHR1cmUoXCJncmFpblNhbXBsZXJcIixpLl9ncmFpblRleHR1cmUpLGUuc2V0VGV4dHVyZUZyb21Qb3N0UHJvY2VzcyhcInRleHR1cmVTYW1wbGVyXCIsaS5faGlnaGxpZ2h0c1Bvc3RQcm9jZXNzKSxlLnNldFRleHR1cmVGcm9tUG9zdFByb2Nlc3MoXCJoaWdobGlnaHRzU2FtcGxlclwiLGkuX2RlcHRoT2ZGaWVsZFBvc3RQcm9jZXNzKSxlLnNldEZsb2F0KFwiZ3JhaW5fYW1vdW50XCIsaS5fZ3JhaW5BbW91bnQpLGUuc2V0Qm9vbChcImJsdXJfbm9pc2VcIixpLl9ibHVyTm9pc2UpLGUuc2V0RmxvYXQoXCJzY3JlZW5fd2lkdGhcIixpLl9zY2VuZS5nZXRFbmdpbmUoKS5nZXRSZW5kZXJpbmdDYW52YXMoKS53aWR0aCksZS5zZXRGbG9hdChcInNjcmVlbl9oZWlnaHRcIixpLl9zY2VuZS5nZXRFbmdpbmUoKS5nZXRSZW5kZXJpbmdDYW52YXMoKS5oZWlnaHQpLGUuc2V0RmxvYXQoXCJkaXN0b3J0aW9uXCIsaS5fZGlzdG9ydGlvbiksZS5zZXRCb29sKFwiZG9mX2VuYWJsZWRcIiwtMSE9PWkuX2RvZkRpc3RhbmNlKSxlLnNldEZsb2F0KFwic2NyZWVuX2Rpc3RhbmNlXCIsMS8oLjEtMS9pLl9kb2ZEaXN0YW5jZSkpLGUuc2V0RmxvYXQoXCJhcGVydHVyZVwiLGkuX2RvZkFwZXJ0dXJlKSxlLnNldEZsb2F0KFwiZGFya2VuXCIsaS5fZG9mRGFya2VuKSxlLnNldEZsb2F0KFwiZWRnZV9ibHVyXCIsaS5fZWRnZUJsdXIpLGUuc2V0Qm9vbChcImhpZ2hsaWdodHNcIiwtMSE9PWkuX2hpZ2hsaWdodHNHYWluKSxlLnNldEZsb2F0KFwibmVhclwiLGkuX3NjZW5lLmFjdGl2ZUNhbWVyYS5taW5aKSxlLnNldEZsb2F0KFwiZmFyXCIsaS5fc2NlbmUuYWN0aXZlQ2FtZXJhLm1heFopfX0saS5wcm90b3R5cGUuX2NyZWF0ZUdyYWluVGV4dHVyZT1mdW5jdGlvbigpe3ZhciB0PTUxMjt0aGlzLl9ncmFpblRleHR1cmU9bmV3IGUuRHluYW1pY1RleHR1cmUoXCJMZW5zTm9pc2VUZXh0dXJlXCIsdCx0aGlzLl9zY2VuZSwhMSxlLlRleHR1cmUuQklMSU5FQVJfU0FNUExJTkdNT0RFKSx0aGlzLl9ncmFpblRleHR1cmUud3JhcFU9ZS5UZXh0dXJlLldSQVBfQUREUkVTU01PREUsdGhpcy5fZ3JhaW5UZXh0dXJlLndyYXBWPWUuVGV4dHVyZS5XUkFQX0FERFJFU1NNT0RFO2Zvcih2YXIgaSxyPXRoaXMuX2dyYWluVGV4dHVyZS5nZXRDb250ZXh0KCksbj1mdW5jdGlvbihlLHQpe3JldHVybiBNYXRoLnJhbmRvbSgpKih0LWUpK2V9LG89MDt0Pm87bysrKWZvcih2YXIgcz0wO3Q+cztzKyspaT1NYXRoLmZsb29yKDI1NSpuKC40MiwuNTgpKSxyLmZpbGxTdHlsZT1cInJnYihcIitpK1wiLCBcIitpK1wiLCBcIitpK1wiKVwiLHIuZmlsbFJlY3QobyxzLDEsMSk7dGhpcy5fZ3JhaW5UZXh0dXJlLnVwZGF0ZSghMSl9LGl9KGUuUG9zdFByb2Nlc3NSZW5kZXJQaXBlbGluZSk7ZS5MZW5zUmVuZGVyaW5nUGlwZWxpbmU9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gaShpLHIsbixvLHMsYSxoKXt2YXIgYz10aGlzO3QuY2FsbCh0aGlzLGksXCJjb2xvckNvcnJlY3Rpb25cIixudWxsLFtcImNvbG9yVGFibGVcIl0sbixvLHMsYSxoKSx0aGlzLl9jb2xvclRhYmxlVGV4dHVyZT1uZXcgZS5UZXh0dXJlKHIsby5nZXRTY2VuZSgpLCEwLCExLGUuVGV4dHVyZS5UUklMSU5FQVJfU0FNUExJTkdNT0RFKSx0aGlzLl9jb2xvclRhYmxlVGV4dHVyZS5hbmlzb3Ryb3BpY0ZpbHRlcmluZ0xldmVsPTEsdGhpcy5fY29sb3JUYWJsZVRleHR1cmUud3JhcFU9ZS5UZXh0dXJlLkNMQU1QX0FERFJFU1NNT0RFLHRoaXMuX2NvbG9yVGFibGVUZXh0dXJlLndyYXBWPWUuVGV4dHVyZS5DTEFNUF9BRERSRVNTTU9ERSx0aGlzLm9uQXBwbHk9ZnVuY3Rpb24oZSl7ZS5zZXRUZXh0dXJlKFwiY29sb3JUYWJsZVwiLGMuX2NvbG9yVGFibGVUZXh0dXJlKX19cmV0dXJuIF9fZXh0ZW5kcyhpLHQpLGl9KGUuUG9zdFByb2Nlc3MpO2UuQ29sb3JDb3JyZWN0aW9uUG9zdFByb2Nlc3M9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gaShpLHIsbixvKXt0LmNhbGwodGhpcyxpLHIsbyksdGhpcy5pbnRlcmF4aWFsRGlzdGFuY2U9bix0aGlzLnNldENhbWVyYVJpZ01vZGUoZS5DYW1lcmEuUklHX01PREVfU1RFUkVPU0NPUElDX0FOQUdMWVBILHtpbnRlcmF4aWFsRGlzdGFuY2U6bn0pfXJldHVybiBfX2V4dGVuZHMoaSx0KSxpLnByb3RvdHlwZS5nZXRUeXBlTmFtZT1mdW5jdGlvbigpe3JldHVyblwiQW5hZ2x5cGhGcmVlQ2FtZXJhXCJ9LGl9KGUuRnJlZUNhbWVyYSk7ZS5BbmFnbHlwaEZyZWVDYW1lcmE9dDt2YXIgaT1mdW5jdGlvbih0KXtmdW5jdGlvbiBpKGkscixuLG8scyxhLGgpe3QuY2FsbCh0aGlzLGkscixuLG8scyxoKSx0aGlzLmludGVyYXhpYWxEaXN0YW5jZT1hLHRoaXMuc2V0Q2FtZXJhUmlnTW9kZShlLkNhbWVyYS5SSUdfTU9ERV9TVEVSRU9TQ09QSUNfQU5BR0xZUEgse2ludGVyYXhpYWxEaXN0YW5jZTphfSl9cmV0dXJuIF9fZXh0ZW5kcyhpLHQpLGkucHJvdG90eXBlLmdldFR5cGVOYW1lPWZ1bmN0aW9uKCl7cmV0dXJuXCJBbmFnbHlwaEFyY1JvdGF0ZUNhbWVyYVwifSxpfShlLkFyY1JvdGF0ZUNhbWVyYSk7ZS5BbmFnbHlwaEFyY1JvdGF0ZUNhbWVyYT1pO3ZhciByPWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGkoaSxyLG4sbyl7dC5jYWxsKHRoaXMsaSxyLG8pLHRoaXMuaW50ZXJheGlhbERpc3RhbmNlPW4sdGhpcy5zZXRDYW1lcmFSaWdNb2RlKGUuQ2FtZXJhLlJJR19NT0RFX1NURVJFT1NDT1BJQ19BTkFHTFlQSCx7aW50ZXJheGlhbERpc3RhbmNlOm59KX1yZXR1cm4gX19leHRlbmRzKGksdCksaS5wcm90b3R5cGUuZ2V0VHlwZU5hbWU9ZnVuY3Rpb24oKXtyZXR1cm5cIkFuYWdseXBoR2FtZXBhZENhbWVyYVwifSxpfShlLkdhbWVwYWRDYW1lcmEpO2UuQW5hZ2x5cGhHYW1lcGFkQ2FtZXJhPXI7dmFyIG49ZnVuY3Rpb24odCl7ZnVuY3Rpb24gaShpLHIsbixvKXt0LmNhbGwodGhpcyxpLHIsbyksdGhpcy5pbnRlcmF4aWFsRGlzdGFuY2U9bix0aGlzLnNldENhbWVyYVJpZ01vZGUoZS5DYW1lcmEuUklHX01PREVfU1RFUkVPU0NPUElDX0FOQUdMWVBILHtpbnRlcmF4aWFsRGlzdGFuY2U6bn0pfXJldHVybiBfX2V4dGVuZHMoaSx0KSxpLnByb3RvdHlwZS5nZXRUeXBlTmFtZT1mdW5jdGlvbigpe3JldHVyblwiQW5hZ2x5cGhVbml2ZXJzYWxDYW1lcmFcIn0saX0oZS5Vbml2ZXJzYWxDYW1lcmEpO2UuQW5hZ2x5cGhVbml2ZXJzYWxDYW1lcmE9bjt2YXIgbz1mdW5jdGlvbih0KXtmdW5jdGlvbiBpKGkscixuLG8scyl7dC5jYWxsKHRoaXMsaSxyLHMpLHRoaXMuaW50ZXJheGlhbERpc3RhbmNlPW4sdGhpcy5pc1N0ZXJlb3Njb3BpY1NpZGVCeVNpZGU9byx0aGlzLnNldENhbWVyYVJpZ01vZGUobz9lLkNhbWVyYS5SSUdfTU9ERV9TVEVSRU9TQ09QSUNfU0lERUJZU0lERV9QQVJBTExFTDplLkNhbWVyYS5SSUdfTU9ERV9TVEVSRU9TQ09QSUNfT1ZFUlVOREVSLHtpbnRlcmF4aWFsRGlzdGFuY2U6bn0pfXJldHVybiBfX2V4dGVuZHMoaSx0KSxpLnByb3RvdHlwZS5nZXRUeXBlTmFtZT1mdW5jdGlvbigpe3JldHVyblwiU3RlcmVvc2NvcGljRnJlZUNhbWVyYVwifSxpfShlLkZyZWVDYW1lcmEpO2UuU3RlcmVvc2NvcGljRnJlZUNhbWVyYT1vO3ZhciBzPWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGkoaSxyLG4sbyxzLGEsaCxjKXt0LmNhbGwodGhpcyxpLHIsbixvLHMsYyksdGhpcy5pbnRlcmF4aWFsRGlzdGFuY2U9YSx0aGlzLmlzU3RlcmVvc2NvcGljU2lkZUJ5U2lkZT1oLHRoaXMuc2V0Q2FtZXJhUmlnTW9kZShoP2UuQ2FtZXJhLlJJR19NT0RFX1NURVJFT1NDT1BJQ19TSURFQllTSURFX1BBUkFMTEVMOmUuQ2FtZXJhLlJJR19NT0RFX1NURVJFT1NDT1BJQ19PVkVSVU5ERVIse2ludGVyYXhpYWxEaXN0YW5jZTphfSl9cmV0dXJuIF9fZXh0ZW5kcyhpLHQpLGkucHJvdG90eXBlLmdldFR5cGVOYW1lPWZ1bmN0aW9uKCl7cmV0dXJuXCJTdGVyZW9zY29waWNBcmNSb3RhdGVDYW1lcmFcIn0saX0oZS5BcmNSb3RhdGVDYW1lcmEpO2UuU3RlcmVvc2NvcGljQXJjUm90YXRlQ2FtZXJhPXM7dmFyIGE9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gaShpLHIsbixvLHMpe3QuY2FsbCh0aGlzLGkscixzKSx0aGlzLmludGVyYXhpYWxEaXN0YW5jZT1uLHRoaXMuaXNTdGVyZW9zY29waWNTaWRlQnlTaWRlPW8sdGhpcy5zZXRDYW1lcmFSaWdNb2RlKG8/ZS5DYW1lcmEuUklHX01PREVfU1RFUkVPU0NPUElDX1NJREVCWVNJREVfUEFSQUxMRUw6ZS5DYW1lcmEuUklHX01PREVfU1RFUkVPU0NPUElDX09WRVJVTkRFUix7aW50ZXJheGlhbERpc3RhbmNlOm59KX1yZXR1cm4gX19leHRlbmRzKGksdCksaS5wcm90b3R5cGUuZ2V0VHlwZU5hbWU9ZnVuY3Rpb24oKXtyZXR1cm5cIlN0ZXJlb3Njb3BpY0dhbWVwYWRDYW1lcmFcIn0saX0oZS5HYW1lcGFkQ2FtZXJhKTtlLlN0ZXJlb3Njb3BpY0dhbWVwYWRDYW1lcmE9YTt2YXIgaD1mdW5jdGlvbih0KXtmdW5jdGlvbiBpKGkscixuLG8scyl7dC5jYWxsKHRoaXMsaSxyLHMpLHRoaXMuaW50ZXJheGlhbERpc3RhbmNlPW4sdGhpcy5pc1N0ZXJlb3Njb3BpY1NpZGVCeVNpZGU9byx0aGlzLnNldENhbWVyYVJpZ01vZGUobz9lLkNhbWVyYS5SSUdfTU9ERV9TVEVSRU9TQ09QSUNfU0lERUJZU0lERV9QQVJBTExFTDplLkNhbWVyYS5SSUdfTU9ERV9TVEVSRU9TQ09QSUNfT1ZFUlVOREVSLHtpbnRlcmF4aWFsRGlzdGFuY2U6bn0pfXJldHVybiBfX2V4dGVuZHMoaSx0KSxpLnByb3RvdHlwZS5nZXRUeXBlTmFtZT1mdW5jdGlvbigpe3JldHVyblwiU3RlcmVvc2NvcGljVW5pdmVyc2FsQ2FtZXJhXCJ9LGl9KGUuVW5pdmVyc2FsQ2FtZXJhKTtlLlN0ZXJlb3Njb3BpY1VuaXZlcnNhbENhbWVyYT1ofShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbih0KXtmdW5jdGlvbiBpKHIsbixvLHMsYSl7dmFyIGg9dGhpczt2b2lkIDA9PT1zJiYocz1udWxsKSx0LmNhbGwodGhpcyxuLmdldEVuZ2luZSgpLHIpLHRoaXMuZ2F1c3NDb2VmZj0uMyx0aGlzLmdhdXNzTWVhbj0xLHRoaXMuZ2F1c3NTdGFuZERldj0uOCx0aGlzLmdhdXNzTXVsdGlwbGllcj00LHRoaXMuZXhwb3N1cmU9MSx0aGlzLm1pbmltdW1MdW1pbmFuY2U9MSx0aGlzLm1heGltdW1MdW1pbmFuY2U9MWUyMCx0aGlzLmx1bWluYW5jZUluY3JlYXNlcmF0ZT0uNSx0aGlzLmx1bWluYW5jZURlY3JlYXNlUmF0ZT0uNSx0aGlzLmJyaWdodFRocmVzaG9sZD0uOCx0aGlzLl9uZWVkVXBkYXRlPSEwLHRoaXMuX3NjZW5lPW4sdGhpcy5fY3JlYXRlQnJpZ2h0UGFzc1Bvc3RQcm9jZXNzKG4sbyksdGhpcy5fY3JlYXRlRG93blNhbXBsZVg0UG9zdFByb2Nlc3MobixvKSx0aGlzLl9jcmVhdGVHYXVzc2lhbkJsdXJQb3N0UHJvY2VzcyhuLG8pLHRoaXMuX2NyZWF0ZVRleHR1cmVBZGRlclBvc3RQcm9jZXNzKG4sbyksdGhpcy5fY3JlYXRlTHVtaW5hbmNlR2VuZXJhdG9yUG9zdFByb2Nlc3MobiksdGhpcy5fY3JlYXRlSERSUG9zdFByb2Nlc3MobixvKSxudWxsPT09cz90aGlzLl9vcmlnaW5hbFBvc3RQcm9jZXNzPW5ldyBlLlBhc3NQb3N0UHJvY2VzcyhcImhkclwiLG8sbnVsbCxlLlRleHR1cmUuQklMSU5FQVJfU0FNUExJTkdNT0RFLG4uZ2V0RW5naW5lKCksITEpOnRoaXMuX29yaWdpbmFsUG9zdFByb2Nlc3M9cyx0aGlzLmFkZEVmZmVjdChuZXcgZS5Qb3N0UHJvY2Vzc1JlbmRlckVmZmVjdChuLmdldEVuZ2luZSgpLFwiSERSUGFzc1Bvc3RQcm9jZXNzXCIsZnVuY3Rpb24oKXtyZXR1cm4gaC5fb3JpZ2luYWxQb3N0UHJvY2Vzc30sITApKSx0aGlzLmFkZEVmZmVjdChuZXcgZS5Qb3N0UHJvY2Vzc1JlbmRlckVmZmVjdChuLmdldEVuZ2luZSgpLFwiSERSQnJpZ2h0UGFzc1wiLGZ1bmN0aW9uKCl7cmV0dXJuIGguX2JyaWdodFBhc3NQb3N0UHJvY2Vzc30sITApKSx0aGlzLmFkZEVmZmVjdChuZXcgZS5Qb3N0UHJvY2Vzc1JlbmRlckVmZmVjdChuLmdldEVuZ2luZSgpLFwiSERSRG93blNhbXBsZVg0XCIsZnVuY3Rpb24oKXtyZXR1cm4gaC5fZG93blNhbXBsZVg0UG9zdFByb2Nlc3N9LCEwKSksdGhpcy5hZGRFZmZlY3QobmV3IGUuUG9zdFByb2Nlc3NSZW5kZXJFZmZlY3Qobi5nZXRFbmdpbmUoKSxcIkhEUkdhdXNzaWFuQmx1ckhcIixmdW5jdGlvbigpe3JldHVybiBoLl9ndWFzc2lhbkJsdXJIUG9zdFByb2Nlc3N9LCEwKSksdGhpcy5hZGRFZmZlY3QobmV3IGUuUG9zdFByb2Nlc3NSZW5kZXJFZmZlY3Qobi5nZXRFbmdpbmUoKSxcIkhEUkdhdXNzaWFuQmx1clZcIixmdW5jdGlvbigpe3JldHVybiBoLl9ndWFzc2lhbkJsdXJWUG9zdFByb2Nlc3N9LCEwKSksdGhpcy5hZGRFZmZlY3QobmV3IGUuUG9zdFByb2Nlc3NSZW5kZXJFZmZlY3Qobi5nZXRFbmdpbmUoKSxcIkhEUlRleHR1cmVBZGRlclwiLGZ1bmN0aW9uKCl7cmV0dXJuIGguX3RleHR1cmVBZGRlclBvc3RQcm9jZXNzfSwhMCkpO2Zvcih2YXIgYz1mdW5jdGlvbih0KXtoLmFkZEVmZmVjdChuZXcgZS5Qb3N0UHJvY2Vzc1JlbmRlckVmZmVjdChuLmdldEVuZ2luZSgpLFwiSERSRG93blNhbXBsZXJcIit0LGZ1bmN0aW9uKCl7cmV0dXJuIGguX2Rvd25TYW1wbGVQb3N0UHJvY2Vzc2VzW3RdfSwhMCkpfSxsPWkuTFVNX1NURVBTLTE7bD49MDtsLS0pYyhsKTt0aGlzLmFkZEVmZmVjdChuZXcgZS5Qb3N0UHJvY2Vzc1JlbmRlckVmZmVjdChuLmdldEVuZ2luZSgpLFwiSERSXCIsZnVuY3Rpb24oKXtyZXR1cm4gaC5faGRyUG9zdFByb2Nlc3N9LCEwKSksbi5wb3N0UHJvY2Vzc1JlbmRlclBpcGVsaW5lTWFuYWdlci5hZGRQaXBlbGluZSh0aGlzKSxudWxsIT09YSYmbi5wb3N0UHJvY2Vzc1JlbmRlclBpcGVsaW5lTWFuYWdlci5hdHRhY2hDYW1lcmFzVG9SZW5kZXJQaXBlbGluZShyLGEpLHRoaXMudXBkYXRlKCl9cmV0dXJuIF9fZXh0ZW5kcyhpLHQpLGkucHJvdG90eXBlLnVwZGF0ZT1mdW5jdGlvbigpe3RoaXMuX25lZWRVcGRhdGU9ITB9LGkucHJvdG90eXBlLmdldEN1cnJlbnRMdW1pbmFuY2U9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faGRyQ3VycmVudEx1bWluYW5jZX0saS5wcm90b3R5cGUuZ2V0T3V0cHV0THVtaW5hbmNlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2hkck91dHB1dEx1bWluYW5jZX0saS5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3RoaXMuX29yaWdpbmFsUG9zdFByb2Nlc3M9dm9pZCAwLHRoaXMuX2JyaWdodFBhc3NQb3N0UHJvY2Vzcz12b2lkIDAsdGhpcy5fZG93blNhbXBsZVg0UG9zdFByb2Nlc3M9dm9pZCAwLHRoaXMuX2d1YXNzaWFuQmx1ckhQb3N0UHJvY2Vzcz12b2lkIDAsdGhpcy5fZ3Vhc3NpYW5CbHVyVlBvc3RQcm9jZXNzPXZvaWQgMCx0aGlzLl90ZXh0dXJlQWRkZXJQb3N0UHJvY2Vzcz12b2lkIDA7Zm9yKHZhciBlPWkuTFVNX1NURVBTLTE7ZT49MDtlLS0pdGhpcy5fZG93blNhbXBsZVBvc3RQcm9jZXNzZXNbZV09dm9pZCAwO3RoaXMuX2hkclBvc3RQcm9jZXNzPXZvaWQgMCx0aGlzLl9zY2VuZS5wb3N0UHJvY2Vzc1JlbmRlclBpcGVsaW5lTWFuYWdlci5kZXRhY2hDYW1lcmFzRnJvbVJlbmRlclBpcGVsaW5lKHRoaXMuX25hbWUsdGhpcy5fc2NlbmUuY2FtZXJhcyl9LGkucHJvdG90eXBlLl9jcmVhdGVIRFJQb3N0UHJvY2Vzcz1mdW5jdGlvbih0LGkpe3ZhciByPXRoaXMsbj0wO3RoaXMuX2hkck91dHB1dEx1bWluYW5jZT0tMSx0aGlzLl9oZHJDdXJyZW50THVtaW5hbmNlPTEsdGhpcy5faGRyUG9zdFByb2Nlc3M9bmV3IGUuUG9zdFByb2Nlc3MoXCJoZHJcIixcImhkclwiLFtcImV4cG9zdXJlXCIsXCJhdmdMdW1pbmFuY2VcIl0sW1wib3RoZXJTYW1wbGVyXCJdLGksbnVsbCxlLlRleHR1cmUuQklMSU5FQVJfU0FNUExJTkdNT0RFLHQuZ2V0RW5naW5lKCksITEsXCIjZGVmaW5lIEhEUlwiKSx0aGlzLl9oZHJQb3N0UHJvY2Vzcy5vbkFwcGx5PWZ1bmN0aW9uKGkpe2lmKHIuX2hkck91dHB1dEx1bWluYW5jZTwwKXIuX2hkck91dHB1dEx1bWluYW5jZT1yLl9oZHJDdXJyZW50THVtaW5hbmNlO2Vsc2V7dmFyIG89KG4tKG4rdC5nZXRFbmdpbmUoKS5nZXREZWx0YVRpbWUoKSkpLzFlMztyLl9oZHJDdXJyZW50THVtaW5hbmNlPHIuX2hkck91dHB1dEx1bWluYW5jZStyLmx1bWluYW5jZURlY3JlYXNlUmF0ZSpvP3IuX2hkck91dHB1dEx1bWluYW5jZSs9ci5sdW1pbmFuY2VEZWNyZWFzZVJhdGUqbzpyLl9oZHJDdXJyZW50THVtaW5hbmNlPnIuX2hkck91dHB1dEx1bWluYW5jZS1yLmx1bWluYW5jZUluY3JlYXNlcmF0ZSpvP3IuX2hkck91dHB1dEx1bWluYW5jZS09ci5sdW1pbmFuY2VJbmNyZWFzZXJhdGUqbzpyLl9oZHJPdXRwdXRMdW1pbmFuY2U9ci5faGRyQ3VycmVudEx1bWluYW5jZX1yLl9oZHJPdXRwdXRMdW1pbmFuY2U9ZS5NYXRoVG9vbHMuQ2xhbXAoci5faGRyT3V0cHV0THVtaW5hbmNlLHIubWluaW11bUx1bWluYW5jZSxyLm1heGltdW1MdW1pbmFuY2UpLG4rPXQuZ2V0RW5naW5lKCkuZ2V0RGVsdGFUaW1lKCksaS5zZXRUZXh0dXJlRnJvbVBvc3RQcm9jZXNzKFwidGV4dHVyZVNhbXBsZXJcIixyLl90ZXh0dXJlQWRkZXJQb3N0UHJvY2VzcyksaS5zZXRUZXh0dXJlRnJvbVBvc3RQcm9jZXNzKFwib3RoZXJTYW1wbGVyXCIsci5fb3JpZ2luYWxQb3N0UHJvY2VzcyksaS5zZXRGbG9hdChcImV4cG9zdXJlXCIsci5leHBvc3VyZSksaS5zZXRGbG9hdChcImF2Z0x1bWluYW5jZVwiLHIuX2hkck91dHB1dEx1bWluYW5jZSksci5fbmVlZFVwZGF0ZT0hMX19LGkucHJvdG90eXBlLl9jcmVhdGVUZXh0dXJlQWRkZXJQb3N0UHJvY2Vzcz1mdW5jdGlvbih0LGkpe3ZhciByPXRoaXM7dGhpcy5fdGV4dHVyZUFkZGVyUG9zdFByb2Nlc3M9bmV3IGUuUG9zdFByb2Nlc3MoXCJoZHJcIixcImhkclwiLFtdLFtcIm90aGVyU2FtcGxlclwiXSxpLG51bGwsZS5UZXh0dXJlLkJJTElORUFSX1NBTVBMSU5HTU9ERSx0LmdldEVuZ2luZSgpLCExLFwiI2RlZmluZSBURVhUVVJFX0FEREVSXCIpLHRoaXMuX3RleHR1cmVBZGRlclBvc3RQcm9jZXNzLm9uQXBwbHk9ZnVuY3Rpb24oZSl7ZS5zZXRUZXh0dXJlRnJvbVBvc3RQcm9jZXNzKFwib3RoZXJTYW1wbGVyXCIsci5fb3JpZ2luYWxQb3N0UHJvY2Vzcyl9fSxpLnByb3RvdHlwZS5fY3JlYXRlRG93blNhbXBsZVg0UG9zdFByb2Nlc3M9ZnVuY3Rpb24odCxpKXt2YXIgcj10aGlzLG49bmV3IEFycmF5KDMyKTt0aGlzLl9kb3duU2FtcGxlWDRQb3N0UHJvY2Vzcz1uZXcgZS5Qb3N0UHJvY2VzcyhcImhkclwiLFwiaGRyXCIsW1wiZHNPZmZzZXRzXCJdLFtdLGkvNCxudWxsLGUuVGV4dHVyZS5CSUxJTkVBUl9TQU1QTElOR01PREUsdC5nZXRFbmdpbmUoKSwhMSxcIiNkZWZpbmUgRE9XTl9TQU1QTEVfWDRcIiksdGhpcy5fZG93blNhbXBsZVg0UG9zdFByb2Nlc3Mub25BcHBseT1mdW5jdGlvbihlKXtpZihyLl9uZWVkVXBkYXRlKWZvcih2YXIgdD0wLGk9LTI7Mj5pO2krKylmb3IodmFyIG89LTI7Mj5vO28rKyluW3RdPShpKy41KSooMS9yLl9kb3duU2FtcGxlWDRQb3N0UHJvY2Vzcy53aWR0aCksblt0KzFdPShvKy41KSooMS9yLl9kb3duU2FtcGxlWDRQb3N0UHJvY2Vzcy5oZWlnaHQpLHQrPTI7ZS5zZXRBcnJheTIoXCJkc09mZnNldHNcIixuKX19LGkucHJvdG90eXBlLl9jcmVhdGVCcmlnaHRQYXNzUG9zdFByb2Nlc3M9ZnVuY3Rpb24odCxpKXt2YXIgcj10aGlzLG49bmV3IEFycmF5KDgpLG89ZnVuY3Rpb24oZSl7aWYoci5fbmVlZFVwZGF0ZSl7dmFyIHQ9MS9yLl9icmlnaHRQYXNzUG9zdFByb2Nlc3Mud2lkdGgsaT0xL3IuX2JyaWdodFBhc3NQb3N0UHJvY2Vzcy5oZWlnaHQ7blswXT0tLjUqdCxuWzFdPS41KmksblsyXT0uNSp0LG5bM109LjUqaSxuWzRdPS0uNSp0LG5bNV09LS41Kmksbls2XT0uNSp0LG5bN109LS41Kml9ZS5zZXRBcnJheTIoXCJkc09mZnNldHNcIixuKSxlLnNldEZsb2F0KFwiYnJpZ2h0VGhyZXNob2xkXCIsci5icmlnaHRUaHJlc2hvbGQpfTt0aGlzLl9icmlnaHRQYXNzUG9zdFByb2Nlc3M9bmV3IGUuUG9zdFByb2Nlc3MoXCJoZHJcIixcImhkclwiLFtcImRzT2Zmc2V0c1wiLFwiYnJpZ2h0VGhyZXNob2xkXCJdLFtdLGksbnVsbCxlLlRleHR1cmUuQklMSU5FQVJfU0FNUExJTkdNT0RFLHQuZ2V0RW5naW5lKCksITEsXCIjZGVmaW5lIEJSSUdIVF9QQVNTXCIpLHRoaXMuX2JyaWdodFBhc3NQb3N0UHJvY2Vzcy5vbkFwcGx5PW99LGkucHJvdG90eXBlLl9jcmVhdGVMdW1pbmFuY2VHZW5lcmF0b3JQb3N0UHJvY2Vzcz1mdW5jdGlvbih0KXt2YXIgcixuPXRoaXMsbz1pLkxVTV9TVEVQUyxzPW5ldyBBcnJheSg4KSxhPW5ldyBBcnJheSgxOCk7dGhpcy5fZG93blNhbXBsZVBvc3RQcm9jZXNzZXM9bmV3IEFycmF5KG8pO3ZhciBoPWZ1bmN0aW9uKGUsdCl7dmFyIGk9MS9lLHI9MS90O3NbMF09LS41Kmksc1sxXT0uNSpyLHNbMl09LjUqaSxzWzNdPS41KnIsc1s0XT0tLjUqaSxzWzVdPS0uNSpyLHNbNl09LjUqaSxzWzddPS0uNSpyfSxjPWZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBpPTAscj0tMTsyPnI7cisrKWZvcih2YXIgbj0tMTsyPm47bisrKWFbaV09ci9lLGFbaSsxXT1uL3QsaSs9Mn0sbD1mdW5jdGlvbihlKXtuLl9uZWVkVXBkYXRlJiZoKG4uX3RleHR1cmVBZGRlclBvc3RQcm9jZXNzLndpZHRoLG4uX3RleHR1cmVBZGRlclBvc3RQcm9jZXNzLmhlaWdodCksZS5zZXRUZXh0dXJlRnJvbVBvc3RQcm9jZXNzKFwidGV4dHVyZVNhbXBsZXJcIixuLl90ZXh0dXJlQWRkZXJQb3N0UHJvY2VzcyksZS5zZXRBcnJheTIoXCJsdW1PZmZzZXRzXCIscyl9LHU9ZnVuY3Rpb24oZSl7dmFyIHQ9ZTtyZXR1cm4gZnVuY3Rpb24oZSl7aChuLl9kb3duU2FtcGxlUG9zdFByb2Nlc3Nlc1t0XS53aWR0aCxuLl9kb3duU2FtcGxlUG9zdFByb2Nlc3Nlc1t0XS5oZWlnaHQpLGMobi5fZG93blNhbXBsZVBvc3RQcm9jZXNzZXNbdF0ud2lkdGgsbi5fZG93blNhbXBsZVBvc3RQcm9jZXNzZXNbdF0uaGVpZ2h0KSxyPS41L24uX2Rvd25TYW1wbGVQb3N0UHJvY2Vzc2VzW3RdLndpZHRoLGUuc2V0VGV4dHVyZUZyb21Qb3N0UHJvY2VzcyhcInRleHR1cmVTYW1wbGVyXCIsbi5fZG93blNhbXBsZVBvc3RQcm9jZXNzZXNbdCsxXSksZS5zZXRGbG9hdChcImhhbGZEZXN0UGl4ZWxTaXplXCIsciksZS5zZXRBcnJheTIoXCJkc09mZnNldHNcIixhKX19LGY9ZnVuY3Rpb24oaSl7dmFyIHI9dC5nZXRFbmdpbmUoKS5yZWFkUGl4ZWxzKDAsMCwxLDEpLG89bmV3IGUuVmVjdG9yNCgxLzE2NTgxMzc1LDEvNjUwMjUsMS8yNTUsMSk7bi5faGRyQ3VycmVudEx1bWluYW5jZT0oclswXSpvLngrclsxXSpvLnkrclsyXSpvLnorclszXSpvLncpLzEwMH0sZD17d2lkdGg6TWF0aC5wb3coMyxvLTEpLGhlaWdodDpNYXRoLnBvdygzLG8tMSl9O3RoaXMuX2Rvd25TYW1wbGVQb3N0UHJvY2Vzc2VzW28tMV09bmV3IGUuUG9zdFByb2Nlc3MoXCJoZHJcIixcImhkclwiLFtcImx1bU9mZnNldHNcIl0sW10sZCxudWxsLGUuVGV4dHVyZS5ORUFSRVNUX1NBTVBMSU5HTU9ERSx0LmdldEVuZ2luZSgpLCExLFwiI2RlZmluZSBMVU1JTkFOQ0VfR0VORVJBVE9SXCIsZS5FbmdpbmUuVEVYVFVSRVRZUEVfRkxPQVQpLHRoaXMuX2Rvd25TYW1wbGVQb3N0UHJvY2Vzc2VzW28tMV0ub25BcHBseT1sO2Zvcih2YXIgcD1vLTI7cD49MDtwLS0pe3ZhciBfPU1hdGgucG93KDMscCk7ZD17d2lkdGg6XyxoZWlnaHQ6X307dmFyIG09XCIjZGVmaW5lIERPV05fU0FNUExFXFxuXCI7MD09PXAmJihtKz1cIiNkZWZpbmUgRklOQUxfRE9XTl9TQU1QTEVcXG5cIiksdGhpcy5fZG93blNhbXBsZVBvc3RQcm9jZXNzZXNbcF09bmV3IGUuUG9zdFByb2Nlc3MoXCJoZHJcIixcImhkclwiLFtcImRzT2Zmc2V0c1wiLFwiaGFsZkRlc3RQaXhlbFNpemVcIl0sW10sZCxudWxsLGUuVGV4dHVyZS5ORUFSRVNUX1NBTVBMSU5HTU9ERSx0LmdldEVuZ2luZSgpLCExLG0sZS5FbmdpbmUuVEVYVFVSRVRZUEVfRkxPQVQpLHRoaXMuX2Rvd25TYW1wbGVQb3N0UHJvY2Vzc2VzW3BdLm9uQXBwbHk9dShwKSwwPT09cCYmKHRoaXMuX2Rvd25TYW1wbGVQb3N0UHJvY2Vzc2VzW3BdLm9uQWZ0ZXJSZW5kZXI9Zil9fSxpLnByb3RvdHlwZS5fY3JlYXRlR2F1c3NpYW5CbHVyUG9zdFByb2Nlc3M9ZnVuY3Rpb24odCxpKXt2YXIgcj10aGlzLG49bmV3IEFycmF5KDkpLG89bmV3IEFycmF5KDkpLHM9bmV3IEFycmF5KDkpLGE9W1wiYmx1ck9mZnNldHNcIixcImJsdXJXZWlnaHRzXCIsXCJtdWx0aXBsaWVyXCJdLGg9ZnVuY3Rpb24oZSl7Zm9yKHZhciBpPXt3aWR0aDp0LmdldEVuZ2luZSgpLmdldFJlbmRlcldpZHRoKCksaGVpZ2h0OnQuZ2V0RW5naW5lKCkuZ2V0UmVuZGVySGVpZ2h0KCl9LHI9MDs5PnI7cisrKXt2YXIgcz0oci00KSooMS8oZT09PSEwP2kuaGVpZ2h0Omkud2lkdGgpKTtlP29bcl09czpuW3JdPXN9fSxjPWZ1bmN0aW9uKCl7Zm9yKHZhciBlPTAsdD0wOzk+dDt0KyspZT0odC00KS80LHNbdF09ci5nYXVzc0NvZWZmKigxL01hdGguc3FydCgyKk1hdGguUEkqci5nYXVzc1N0YW5kRGV2KSkqTWF0aC5leHAoLSgoZS1yLmdhdXNzTWVhbikqKGUtci5nYXVzc01lYW4pKS8oMipyLmdhdXNzU3RhbmREZXYqci5nYXVzc1N0YW5kRGV2KSl9LGw9ZnVuY3Rpb24oZSl7cmV0dXJuIGZ1bmN0aW9uKHQpe3IuX25lZWRVcGRhdGUmJihjKCksaChlKSksdC5zZXRBcnJheShcImJsdXJPZmZzZXRzXCIsZT9vOm4pLHQuc2V0QXJyYXkoXCJibHVyV2VpZ2h0c1wiLHMpLHQuc2V0RmxvYXQoXCJtdWx0aXBsaWVyXCIsci5nYXVzc011bHRpcGxpZXIpfX07dGhpcy5fZ3Vhc3NpYW5CbHVySFBvc3RQcm9jZXNzPW5ldyBlLlBvc3RQcm9jZXNzKFwiaGRyXCIsXCJoZHJcIixhLFtdLGkvNCxudWxsLGUuVGV4dHVyZS5CSUxJTkVBUl9TQU1QTElOR01PREUsdC5nZXRFbmdpbmUoKSwhMSxcIiNkZWZpbmUgR0FVU1NJQU5fQkxVUl9IXCIpLHRoaXMuX2d1YXNzaWFuQmx1ckhQb3N0UHJvY2Vzcy5vbkFwcGx5PWwoITEpLHRoaXMuX2d1YXNzaWFuQmx1clZQb3N0UHJvY2Vzcz1uZXcgZS5Qb3N0UHJvY2VzcyhcImhkclwiLFwiaGRyXCIsYSxbXSxpLzQsbnVsbCxlLlRleHR1cmUuQklMSU5FQVJfU0FNUExJTkdNT0RFLHQuZ2V0RW5naW5lKCksITEsXCIjZGVmaW5lIEdBVVNTSUFOX0JMVVJfVlwiKSx0aGlzLl9ndWFzc2lhbkJsdXJWUG9zdFByb2Nlc3Mub25BcHBseT1sKCEwKX0saS5MVU1fU1RFUFM9NixpfShlLlBvc3RQcm9jZXNzUmVuZGVyUGlwZWxpbmUpO2UuSERSUmVuZGVyaW5nUGlwZWxpbmU9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7dGhpcy5lZGdlcz1uZXcgQXJyYXksdGhpcy5lZGdlc0Nvbm5lY3RlZENvdW50PTB9cmV0dXJuIGV9KCksaT1mdW5jdGlvbigpe2Z1bmN0aW9uIGkoZSx0LGkpe3ZvaWQgMD09PXQmJih0PS45NSksdm9pZCAwPT09aSYmKGk9ITEpLHRoaXMuZWRnZXNXaWR0aFNjYWxlckZvck9ydGhvZ3JhcGhpYz0xZTMsdGhpcy5lZGdlc1dpZHRoU2NhbGVyRm9yUGVyc3BlY3RpdmU9NTAsdGhpcy5fbGluZXNQb3NpdGlvbnM9bmV3IEFycmF5LHRoaXMuX2xpbmVzTm9ybWFscz1uZXcgQXJyYXksdGhpcy5fbGluZXNJbmRpY2VzPW5ldyBBcnJheSx0aGlzLl9idWZmZXJzPXt9LHRoaXMuX2NoZWNrVmVydGljZXNJbnN0ZWFkT2ZJbmRpY2VzPSExLHRoaXMuX3NvdXJjZT1lLHRoaXMuX2NoZWNrVmVydGljZXNJbnN0ZWFkT2ZJbmRpY2VzPWksdGhpcy5fZXBzaWxvbj10LHRoaXMuX3ByZXBhcmVSZXNzb3VyY2VzKCksdGhpcy5fZ2VuZXJhdGVFZGdlc0xpbmVzKCl9cmV0dXJuIGkucHJvdG90eXBlLl9wcmVwYXJlUmVzc291cmNlcz1mdW5jdGlvbigpe3RoaXMuX2xpbmVTaGFkZXJ8fCh0aGlzLl9saW5lU2hhZGVyPW5ldyBlLlNoYWRlck1hdGVyaWFsKFwibGluZVNoYWRlclwiLHRoaXMuX3NvdXJjZS5nZXRTY2VuZSgpLFwibGluZVwiLHthdHRyaWJ1dGVzOltcInBvc2l0aW9uXCIsXCJub3JtYWxcIl0sdW5pZm9ybXM6W1wid29ybGRWaWV3UHJvamVjdGlvblwiLFwiY29sb3JcIixcIndpZHRoXCIsXCJhc3BlY3RSYXRpb1wiXX0pLHRoaXMuX2xpbmVTaGFkZXIuZGlzYWJsZURlcHRoV3JpdGU9ITAsdGhpcy5fbGluZVNoYWRlci5iYWNrRmFjZUN1bGxpbmc9ITEpfSxpLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5fYnVmZmVyc1tlLlZlcnRleEJ1ZmZlci5Qb3NpdGlvbktpbmRdO3QmJih0LmRpc3Bvc2UoKSx0aGlzLl9idWZmZXJzW2UuVmVydGV4QnVmZmVyLlBvc2l0aW9uS2luZF09bnVsbCksdD10aGlzLl9idWZmZXJzW2UuVmVydGV4QnVmZmVyLk5vcm1hbEtpbmRdLHQmJih0LmRpc3Bvc2UoKSx0aGlzLl9idWZmZXJzW2UuVmVydGV4QnVmZmVyLk5vcm1hbEtpbmRdPW51bGwpLHRoaXMuX3NvdXJjZS5nZXRTY2VuZSgpLmdldEVuZ2luZSgpLl9yZWxlYXNlQnVmZmVyKHRoaXMuX2liKSx0aGlzLl9saW5lU2hhZGVyLmRpc3Bvc2UoKX0saS5wcm90b3R5cGUuX3Byb2Nlc3NFZGdlRm9yQWRqYWNlbmNpZXM9ZnVuY3Rpb24oZSx0LGkscixuKXtyZXR1cm4gZT09PWkmJnQ9PT1yfHxlPT09ciYmdD09PWk/MDplPT09ciYmdD09PW58fGU9PT1uJiZ0PT09cj8xOmU9PT1uJiZ0PT09aXx8ZT09PWkmJnQ9PT1uPzI6LTF9LGkucHJvdG90eXBlLl9wcm9jZXNzRWRnZUZvckFkamFjZW5jaWVzV2l0aFZlcnRpY2VzPWZ1bmN0aW9uKGUsdCxpLHIsbil7cmV0dXJuIGUuZXF1YWxzV2l0aEVwc2lsb24oaSkmJnQuZXF1YWxzV2l0aEVwc2lsb24ocil8fGUuZXF1YWxzV2l0aEVwc2lsb24ocikmJnQuZXF1YWxzV2l0aEVwc2lsb24oaSk/MDplLmVxdWFsc1dpdGhFcHNpbG9uKHIpJiZ0LmVxdWFsc1dpdGhFcHNpbG9uKG4pfHxlLmVxdWFsc1dpdGhFcHNpbG9uKG4pJiZ0LmVxdWFsc1dpdGhFcHNpbG9uKHIpPzE6ZS5lcXVhbHNXaXRoRXBzaWxvbihuKSYmdC5lcXVhbHNXaXRoRXBzaWxvbihpKXx8ZS5lcXVhbHNXaXRoRXBzaWxvbihpKSYmdC5lcXVhbHNXaXRoRXBzaWxvbihuKT8yOi0xfSxpLnByb3RvdHlwZS5fY2hlY2tFZGdlPWZ1bmN0aW9uKHQsaSxyLG4sbyl7dmFyIHM7aWYodm9pZCAwPT09aSlzPSEwO2Vsc2V7dmFyIGE9ZS5WZWN0b3IzLkRvdChyW3RdLHJbaV0pO3M9YTx0aGlzLl9lcHNpbG9ufWlmKHMpe3ZhciBoPXRoaXMuX2xpbmVzUG9zaXRpb25zLmxlbmd0aC8zLGM9bi5zdWJ0cmFjdChvKTtjLm5vcm1hbGl6ZSgpLHRoaXMuX2xpbmVzUG9zaXRpb25zLnB1c2gobi54KSx0aGlzLl9saW5lc1Bvc2l0aW9ucy5wdXNoKG4ueSksdGhpcy5fbGluZXNQb3NpdGlvbnMucHVzaChuLnopLHRoaXMuX2xpbmVzUG9zaXRpb25zLnB1c2gobi54KSx0aGlzLl9saW5lc1Bvc2l0aW9ucy5wdXNoKG4ueSksdGhpcy5fbGluZXNQb3NpdGlvbnMucHVzaChuLnopLHRoaXMuX2xpbmVzUG9zaXRpb25zLnB1c2goby54KSx0aGlzLl9saW5lc1Bvc2l0aW9ucy5wdXNoKG8ueSksdGhpcy5fbGluZXNQb3NpdGlvbnMucHVzaChvLnopLHRoaXMuX2xpbmVzUG9zaXRpb25zLnB1c2goby54KSx0aGlzLl9saW5lc1Bvc2l0aW9ucy5wdXNoKG8ueSksdGhpcy5fbGluZXNQb3NpdGlvbnMucHVzaChvLnopLHRoaXMuX2xpbmVzTm9ybWFscy5wdXNoKG8ueCksdGhpcy5fbGluZXNOb3JtYWxzLnB1c2goby55KSx0aGlzLl9saW5lc05vcm1hbHMucHVzaChvLnopLHRoaXMuX2xpbmVzTm9ybWFscy5wdXNoKC0xKSx0aGlzLl9saW5lc05vcm1hbHMucHVzaChvLngpLHRoaXMuX2xpbmVzTm9ybWFscy5wdXNoKG8ueSksdGhpcy5fbGluZXNOb3JtYWxzLnB1c2goby56KSx0aGlzLl9saW5lc05vcm1hbHMucHVzaCgxKSx0aGlzLl9saW5lc05vcm1hbHMucHVzaChuLngpLHRoaXMuX2xpbmVzTm9ybWFscy5wdXNoKG4ueSksdGhpcy5fbGluZXNOb3JtYWxzLnB1c2gobi56KSx0aGlzLl9saW5lc05vcm1hbHMucHVzaCgtMSksdGhpcy5fbGluZXNOb3JtYWxzLnB1c2gobi54KSx0aGlzLl9saW5lc05vcm1hbHMucHVzaChuLnkpLHRoaXMuX2xpbmVzTm9ybWFscy5wdXNoKG4ueiksdGhpcy5fbGluZXNOb3JtYWxzLnB1c2goMSksdGhpcy5fbGluZXNJbmRpY2VzLnB1c2goaCksdGhpcy5fbGluZXNJbmRpY2VzLnB1c2goaCsxKSx0aGlzLl9saW5lc0luZGljZXMucHVzaChoKzIpLHRoaXMuX2xpbmVzSW5kaWNlcy5wdXNoKGgpLHRoaXMuX2xpbmVzSW5kaWNlcy5wdXNoKGgrMiksdGhpcy5fbGluZXNJbmRpY2VzLnB1c2goaCszKX19LGkucHJvdG90eXBlLl9nZW5lcmF0ZUVkZ2VzTGluZXM9ZnVuY3Rpb24oKXt2YXIgaSxyLG49dGhpcy5fc291cmNlLmdldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5Qb3NpdGlvbktpbmQpLG89dGhpcy5fc291cmNlLmdldEluZGljZXMoKSxzPW5ldyBBcnJheSxhPW5ldyBBcnJheTtmb3IoaT0wO2k8by5sZW5ndGg7aSs9Myl7cj1uZXcgdDt2YXIgaD1vW2ldLGM9b1tpKzFdLGw9b1tpKzJdO3IucDA9bmV3IGUuVmVjdG9yMyhuWzMqaF0sblszKmgrMV0sblszKmgrMl0pLHIucDE9bmV3IGUuVmVjdG9yMyhuWzMqY10sblszKmMrMV0sblszKmMrMl0pLHIucDI9bmV3IGUuVmVjdG9yMyhuWzMqbF0sblszKmwrMV0sblszKmwrMl0pO3ZhciB1PWUuVmVjdG9yMy5Dcm9zcyhyLnAxLnN1YnRyYWN0KHIucDApLHIucDIuc3VidHJhY3Qoci5wMSkpO3Uubm9ybWFsaXplKCksYS5wdXNoKHUpLHMucHVzaChyKX1mb3IoaT0wO2k8cy5sZW5ndGg7aSsrKXtyPXNbaV07Zm9yKHZhciBmPWkrMTtmPHMubGVuZ3RoO2YrKyl7dmFyIGQ9c1tmXTtpZigzPT09ci5lZGdlc0Nvbm5lY3RlZENvdW50KWJyZWFrO2lmKDMhPT1kLmVkZ2VzQ29ubmVjdGVkQ291bnQpZm9yKHZhciBwPW9bMypmXSxfPW9bMypmKzFdLG09b1szKmYrMl0sZz0wOzM+ZztnKyspe3ZhciB2O2lmKHZvaWQgMD09PXIuZWRnZXNbZ10pe3N3aXRjaChnKXtjYXNlIDA6dj10aGlzLl9jaGVja1ZlcnRpY2VzSW5zdGVhZE9mSW5kaWNlcz90aGlzLl9wcm9jZXNzRWRnZUZvckFkamFjZW5jaWVzV2l0aFZlcnRpY2VzKHIucDAsci5wMSxkLnAwLGQucDEsZC5wMik6dGhpcy5fcHJvY2Vzc0VkZ2VGb3JBZGphY2VuY2llcyhvWzMqaV0sb1szKmkrMV0scCxfLG0pO2JyZWFrO2Nhc2UgMTp2PXRoaXMuX2NoZWNrVmVydGljZXNJbnN0ZWFkT2ZJbmRpY2VzP3RoaXMuX3Byb2Nlc3NFZGdlRm9yQWRqYWNlbmNpZXNXaXRoVmVydGljZXMoci5wMSxyLnAyLGQucDAsZC5wMSxkLnAyKTp0aGlzLl9wcm9jZXNzRWRnZUZvckFkamFjZW5jaWVzKG9bMyppKzFdLG9bMyppKzJdLHAsXyxtKTticmVhaztjYXNlIDI6dj10aGlzLl9jaGVja1ZlcnRpY2VzSW5zdGVhZE9mSW5kaWNlcz90aGlzLl9wcm9jZXNzRWRnZUZvckFkamFjZW5jaWVzV2l0aFZlcnRpY2VzKHIucDIsci5wMCxkLnAwLGQucDEsZC5wMik6dGhpcy5fcHJvY2Vzc0VkZ2VGb3JBZGphY2VuY2llcyhvWzMqaSsyXSxvWzMqaV0scCxfLG0pfWlmKC0xIT09diYmKHIuZWRnZXNbZ109ZixkLmVkZ2VzW3ZdPWksci5lZGdlc0Nvbm5lY3RlZENvdW50KyssZC5lZGdlc0Nvbm5lY3RlZENvdW50KyssMz09PXIuZWRnZXNDb25uZWN0ZWRDb3VudCkpYnJlYWt9fX19Zm9yKGk9MDtpPHMubGVuZ3RoO2krKyl7dmFyIHk9c1tpXTt0aGlzLl9jaGVja0VkZ2UoaSx5LmVkZ2VzWzBdLGEseS5wMCx5LnAxKSx0aGlzLl9jaGVja0VkZ2UoaSx5LmVkZ2VzWzFdLGEseS5wMSx5LnAyKSx0aGlzLl9jaGVja0VkZ2UoaSx5LmVkZ2VzWzJdLGEseS5wMix5LnAwKX12YXIgeD10aGlzLl9zb3VyY2UuZ2V0U2NlbmUoKS5nZXRFbmdpbmUoKTt0aGlzLl9idWZmZXJzW2UuVmVydGV4QnVmZmVyLlBvc2l0aW9uS2luZF09bmV3IGUuVmVydGV4QnVmZmVyKHgsdGhpcy5fbGluZXNQb3NpdGlvbnMsZS5WZXJ0ZXhCdWZmZXIuUG9zaXRpb25LaW5kLCExKSx0aGlzLl9idWZmZXJzW2UuVmVydGV4QnVmZmVyLk5vcm1hbEtpbmRdPW5ldyBlLlZlcnRleEJ1ZmZlcih4LHRoaXMuX2xpbmVzTm9ybWFscyxlLlZlcnRleEJ1ZmZlci5Ob3JtYWxLaW5kLCExLCExLDQpLHRoaXMuX2liPXguY3JlYXRlSW5kZXhCdWZmZXIodGhpcy5fbGluZXNJbmRpY2VzKSx0aGlzLl9pbmRpY2VzQ291bnQ9dGhpcy5fbGluZXNJbmRpY2VzLmxlbmd0aH0saS5wcm90b3R5cGUucmVuZGVyPWZ1bmN0aW9uKCl7aWYodGhpcy5fbGluZVNoYWRlci5pc1JlYWR5KCkpe3ZhciB0PXRoaXMuX3NvdXJjZS5nZXRTY2VuZSgpLGk9dC5nZXRFbmdpbmUoKTt0aGlzLl9saW5lU2hhZGVyLl9wcmVCaW5kKCksaS5iaW5kQnVmZmVycyh0aGlzLl9idWZmZXJzLHRoaXMuX2liLHRoaXMuX2xpbmVTaGFkZXIuZ2V0RWZmZWN0KCkpLHQucmVzZXRDYWNoZWRNYXRlcmlhbCgpLHRoaXMuX2xpbmVTaGFkZXIuc2V0Q29sb3I0KFwiY29sb3JcIix0aGlzLl9zb3VyY2UuZWRnZXNDb2xvciksdC5hY3RpdmVDYW1lcmEubW9kZT09PWUuQ2FtZXJhLk9SVEhPR1JBUEhJQ19DQU1FUkE/dGhpcy5fbGluZVNoYWRlci5zZXRGbG9hdChcIndpZHRoXCIsdGhpcy5fc291cmNlLmVkZ2VzV2lkdGgvdGhpcy5lZGdlc1dpZHRoU2NhbGVyRm9yT3J0aG9ncmFwaGljKTp0aGlzLl9saW5lU2hhZGVyLnNldEZsb2F0KFwid2lkdGhcIix0aGlzLl9zb3VyY2UuZWRnZXNXaWR0aC90aGlzLmVkZ2VzV2lkdGhTY2FsZXJGb3JQZXJzcGVjdGl2ZSksdGhpcy5fbGluZVNoYWRlci5zZXRGbG9hdChcImFzcGVjdFJhdGlvXCIsaS5nZXRBc3BlY3RSYXRpbyh0LmFjdGl2ZUNhbWVyYSkpLHRoaXMuX2xpbmVTaGFkZXIuYmluZCh0aGlzLl9zb3VyY2UuZ2V0V29ybGRNYXRyaXgoKSksaS5kcmF3KCEwLDAsdGhpcy5faW5kaWNlc0NvdW50KSx0aGlzLl9saW5lU2hhZGVyLnVuYmluZCgpLGkuc2V0RGVwdGhXcml0ZSghMCl9fSxpfSgpO2UuRWRnZXNSZW5kZXJlcj1pfShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXshZnVuY3Rpb24oZSl7ZVtlLkhhYmxlPTBdPVwiSGFibGVcIixlW2UuUmVpbmhhcmQ9MV09XCJSZWluaGFyZFwiLGVbZS5IZWppRGF3c29uPTJdPVwiSGVqaURhd3NvblwiLGVbZS5QaG90b2dyYXBoaWM9M109XCJQaG90b2dyYXBoaWNcIn0oZS5Ub25lbWFwcGluZ09wZXJhdG9yfHwoZS5Ub25lbWFwcGluZ09wZXJhdG9yPXt9KSk7dmFyIHQ9ZS5Ub25lbWFwcGluZ09wZXJhdG9yLGk9ZnVuY3Rpb24oaSl7ZnVuY3Rpb24gcihyLG4sbyxzLGEsaCxjKXt2YXIgbD10aGlzO3ZvaWQgMD09PWEmJihhPWUuVGV4dHVyZS5CSUxJTkVBUl9TQU1QTElOR01PREUpLHZvaWQgMD09PWMmJihjPWUuRW5naW5lLlRFWFRVUkVUWVBFX1VOU0lHTkVEX0lOVCksaS5jYWxsKHRoaXMscixcInRvbmVtYXBcIixbXCJfRXhwb3N1cmVBZGp1c3RtZW50XCJdLG51bGwsMSxzLGEsaCwhMCx1LGMpLHRoaXMuX29wZXJhdG9yPW4sdGhpcy5leHBvc3VyZUFkanVzdG1lbnQ9bzt2YXIgdT1cIiNkZWZpbmUgXCI7dGhpcy5fb3BlcmF0b3I9PT10LkhhYmxlP3UrPVwiSEFCTEVfVE9ORU1BUFBJTkdcIjp0aGlzLl9vcGVyYXRvcj09PXQuUmVpbmhhcmQ/dSs9XCJSRUlOSEFSRF9UT05FTUFQUElOR1wiOnRoaXMuX29wZXJhdG9yPT09dC5IZWppRGF3c29uP3UrPVwiT1BUSU1JWkVEX0hFSklEQVdTT05fVE9ORU1BUFBJTkdcIjp0aGlzLl9vcGVyYXRvcj09PXQuUGhvdG9ncmFwaGljJiYodSs9XCJQSE9UT0dSQVBISUNfVE9ORU1BUFBJTkdcIiksdGhpcy51cGRhdGVFZmZlY3QodSksdGhpcy5vbkFwcGx5PWZ1bmN0aW9uKGUpe2Uuc2V0RmxvYXQoXCJfRXhwb3N1cmVBZGp1c3RtZW50XCIsbC5leHBvc3VyZUFkanVzdG1lbnQpfX1yZXR1cm4gX19leHRlbmRzKHIsaSkscn0oZS5Qb3N0UHJvY2Vzcyk7ZS5Ub25lbWFwUG9zdFByb2Nlc3M9aX0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQsaSxyLG4pe3ZhciBvPXRoaXM7dm9pZCAwPT09biYmKG49ITApLHRoaXMubmFtZT10LHRoaXMuX3ZpZXdNYXRyaXg9ZS5NYXRyaXguSWRlbnRpdHkoKSx0aGlzLl90YXJnZXQ9ZS5WZWN0b3IzLlplcm8oKSx0aGlzLl9hZGQ9ZS5WZWN0b3IzLlplcm8oKSx0aGlzLmludmVydFlBeGlzPSExLHRoaXMucG9zaXRpb249ZS5WZWN0b3IzLlplcm8oKSx0aGlzLl9zY2VuZT1yLHRoaXMuX3NjZW5lLnJlZmxlY3Rpb25Qcm9iZXMucHVzaCh0aGlzKSx0aGlzLl9yZW5kZXJUYXJnZXRUZXh0dXJlPW5ldyBlLlJlbmRlclRhcmdldFRleHR1cmUodCxpLHIsbiwhMCxlLkVuZ2luZS5URVhUVVJFVFlQRV9VTlNJR05FRF9JTlQsITApLHRoaXMuX3JlbmRlclRhcmdldFRleHR1cmUub25CZWZvcmVSZW5kZXJPYnNlcnZhYmxlLmFkZChmdW5jdGlvbih0KXtzd2l0Y2godCl7Y2FzZSAwOm8uX2FkZC5jb3B5RnJvbUZsb2F0cygxLDAsMCk7YnJlYWs7Y2FzZSAxOm8uX2FkZC5jb3B5RnJvbUZsb2F0cygtMSwwLDApO2JyZWFrO2Nhc2UgMjpvLl9hZGQuY29weUZyb21GbG9hdHMoMCxvLmludmVydFlBeGlzPzE6LTEsMCk7YnJlYWs7Y2FzZSAzOm8uX2FkZC5jb3B5RnJvbUZsb2F0cygwLG8uaW52ZXJ0WUF4aXM/LTE6MSwwKTticmVhaztjYXNlIDQ6by5fYWRkLmNvcHlGcm9tRmxvYXRzKDAsMCwxKTticmVhaztjYXNlIDU6XG5vLl9hZGQuY29weUZyb21GbG9hdHMoMCwwLC0xKX1vLl9hdHRhY2hlZE1lc2gmJm8ucG9zaXRpb24uY29weUZyb20oby5fYXR0YWNoZWRNZXNoLmdldEFic29sdXRlUG9zaXRpb24oKSksby5wb3NpdGlvbi5hZGRUb1JlZihvLl9hZGQsby5fdGFyZ2V0KSxlLk1hdHJpeC5Mb29rQXRMSFRvUmVmKG8ucG9zaXRpb24sby5fdGFyZ2V0LGUuVmVjdG9yMy5VcCgpLG8uX3ZpZXdNYXRyaXgpLHIuc2V0VHJhbnNmb3JtTWF0cml4KG8uX3ZpZXdNYXRyaXgsby5fcHJvamVjdGlvbk1hdHJpeCl9KSx0aGlzLl9yZW5kZXJUYXJnZXRUZXh0dXJlLm9uQWZ0ZXJVbmJpbmRPYnNlcnZhYmxlLmFkZChmdW5jdGlvbigpe3IudXBkYXRlVHJhbnNmb3JtTWF0cml4KCEwKX0pLHRoaXMuX3Byb2plY3Rpb25NYXRyaXg9ZS5NYXRyaXguUGVyc3BlY3RpdmVGb3ZMSChNYXRoLlBJLzIsMSxyLmFjdGl2ZUNhbWVyYS5taW5aLHIuYWN0aXZlQ2FtZXJhLm1heFopfXJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJyZWZyZXNoUmF0ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcmVuZGVyVGFyZ2V0VGV4dHVyZS5yZWZyZXNoUmF0ZX0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX3JlbmRlclRhcmdldFRleHR1cmUucmVmcmVzaFJhdGU9ZX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSx0LnByb3RvdHlwZS5nZXRTY2VuZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9zY2VuZX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwiY3ViZVRleHR1cmVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3JlbmRlclRhcmdldFRleHR1cmV9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwicmVuZGVyTGlzdFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcmVuZGVyVGFyZ2V0VGV4dHVyZS5yZW5kZXJMaXN0fSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLHQucHJvdG90eXBlLmF0dGFjaFRvTWVzaD1mdW5jdGlvbihlKXt0aGlzLl9hdHRhY2hlZE1lc2g9ZX0sdC5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3ZhciBlPXRoaXMuX3NjZW5lLnJlZmxlY3Rpb25Qcm9iZXMuaW5kZXhPZih0aGlzKTstMSE9PWUmJnRoaXMuX3NjZW5lLnJlZmxlY3Rpb25Qcm9iZXMuc3BsaWNlKGUsMSksdGhpcy5fcmVuZGVyVGFyZ2V0VGV4dHVyZSYmKHRoaXMuX3JlbmRlclRhcmdldFRleHR1cmUuZGlzcG9zZSgpLHRoaXMuX3JlbmRlclRhcmdldFRleHR1cmU9bnVsbCl9LHR9KCk7ZS5SZWZsZWN0aW9uUHJvYmU9dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQsaSxyLG4sbyl7dGhpcy5jb2xvcj1uZXcgZS5Db2xvcjQoMSwxLDEsMSksdGhpcy5wb3NpdGlvbj1lLlZlY3RvcjMuWmVybygpLHRoaXMucm90YXRpb249ZS5WZWN0b3IzLlplcm8oKSx0aGlzLnNjYWxpbmc9bmV3IGUuVmVjdG9yMygxLDEsMSksdGhpcy51dnM9bmV3IGUuVmVjdG9yNCgwLDAsMSwxKSx0aGlzLnZlbG9jaXR5PWUuVmVjdG9yMy5aZXJvKCksdGhpcy5hbGl2ZT0hMCx0aGlzLmlzVmlzaWJsZT0hMCx0aGlzLmlkeD10LHRoaXMuX3Bvcz1pLHRoaXMuX21vZGVsPXIsdGhpcy5zaGFwZUlkPW4sdGhpcy5pZHhJblNoYXBlPW99cmV0dXJuIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcInNjYWxlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnNjYWxpbmd9LHNldDpmdW5jdGlvbihlKXt0aGlzLnNjYWxpbmc9ZX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJxdWF0ZXJuaW9uXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnJvdGF0aW9uUXVhdGVybmlvbn0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMucm90YXRpb25RdWF0ZXJuaW9uPWV9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksdH0oKTtlLlNvbGlkUGFydGljbGU9dDt2YXIgaT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSx0LGkscixuKXt0aGlzLnNoYXBlSUQ9ZSx0aGlzLl9zaGFwZT10LHRoaXMuX3NoYXBlVVY9aSx0aGlzLl9wb3NpdGlvbkZ1bmN0aW9uPXIsdGhpcy5fdmVydGV4RnVuY3Rpb249bn1yZXR1cm4gZX0oKTtlLk1vZGVsU2hhcGU9aX0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQsaSxyKXt0aGlzLnBhcnRpY2xlcz1uZXcgQXJyYXksdGhpcy5uYlBhcnRpY2xlcz0wLHRoaXMuYmlsbGJvYXJkPSExLHRoaXMuY291bnRlcj0wLHRoaXMudmFycz17fSx0aGlzLl9wb3NpdGlvbnM9bmV3IEFycmF5LHRoaXMuX2luZGljZXM9bmV3IEFycmF5LHRoaXMuX25vcm1hbHM9bmV3IEFycmF5LHRoaXMuX2NvbG9ycz1uZXcgQXJyYXksdGhpcy5fdXZzPW5ldyBBcnJheSx0aGlzLl9pbmRleD0wLHRoaXMuX3VwZGF0YWJsZT0hMCx0aGlzLl9waWNrYWJsZT0hMSx0aGlzLl9pc1Zpc2liaWxpdHlCb3hMb2NrZWQ9ITEsdGhpcy5fYWx3YXlzVmlzaWJsZT0hMSx0aGlzLl9zaGFwZUNvdW50ZXI9MCx0aGlzLl9jb3B5PW5ldyBlLlNvbGlkUGFydGljbGUobnVsbCxudWxsLG51bGwsbnVsbCxudWxsKSx0aGlzLl9jb2xvcj1uZXcgZS5Db2xvcjQoMCwwLDAsMCksdGhpcy5fY29tcHV0ZVBhcnRpY2xlQ29sb3I9ITAsdGhpcy5fY29tcHV0ZVBhcnRpY2xlVGV4dHVyZT0hMCx0aGlzLl9jb21wdXRlUGFydGljbGVSb3RhdGlvbj0hMCx0aGlzLl9jb21wdXRlUGFydGljbGVWZXJ0ZXg9ITEsdGhpcy5fY29tcHV0ZUJvdW5kaW5nQm94PSExLHRoaXMuX2NhbV9heGlzWj1lLlZlY3RvcjMuWmVybygpLHRoaXMuX2NhbV9heGlzWT1lLlZlY3RvcjMuWmVybygpLHRoaXMuX2NhbV9heGlzWD1lLlZlY3RvcjMuWmVybygpLHRoaXMuX2F4aXNYPWUuQXhpcy5YLHRoaXMuX2F4aXNZPWUuQXhpcy5ZLHRoaXMuX2F4aXNaPWUuQXhpcy5aLHRoaXMuX2Zha2VDYW1Qb3M9ZS5WZWN0b3IzLlplcm8oKSx0aGlzLl9yb3RNYXRyaXg9bmV3IGUuTWF0cml4LHRoaXMuX2ludmVydE1hdHJpeD1uZXcgZS5NYXRyaXgsdGhpcy5fcm90YXRlZD1lLlZlY3RvcjMuWmVybygpLHRoaXMuX3F1YXRlcm5pb249bmV3IGUuUXVhdGVybmlvbix0aGlzLl92ZXJ0ZXg9ZS5WZWN0b3IzLlplcm8oKSx0aGlzLl9ub3JtYWw9ZS5WZWN0b3IzLlplcm8oKSx0aGlzLl95YXc9MCx0aGlzLl9waXRjaD0wLHRoaXMuX3JvbGw9MCx0aGlzLl9oYWxmcm9sbD0wLHRoaXMuX2hhbGZwaXRjaD0wLHRoaXMuX2hhbGZ5YXc9MCx0aGlzLl9zaW5Sb2xsPTAsdGhpcy5fY29zUm9sbD0wLHRoaXMuX3NpblBpdGNoPTAsdGhpcy5fY29zUGl0Y2g9MCx0aGlzLl9zaW5ZYXc9MCx0aGlzLl9jb3NZYXc9MCx0aGlzLl93PTAsdGhpcy5fbWluaW11bT1lLlRtcC5WZWN0b3IzWzBdLHRoaXMuX21heGltdW09ZS5UbXAuVmVjdG9yM1sxXSx0aGlzLm5hbWU9dCx0aGlzLl9zY2VuZT1pLHRoaXMuX2NhbWVyYT1pLmFjdGl2ZUNhbWVyYSx0aGlzLl9waWNrYWJsZT1yP3IuaXNQaWNrYWJsZTohMSxyJiZyLnVwZGF0YWJsZT90aGlzLl91cGRhdGFibGU9ci51cGRhdGFibGU6dGhpcy5fdXBkYXRhYmxlPSEwLHRoaXMuX3BpY2thYmxlJiYodGhpcy5waWNrZWRQYXJ0aWNsZXM9W10pfXJldHVybiB0LnByb3RvdHlwZS5idWlsZE1lc2g9ZnVuY3Rpb24oKXtpZigwPT09dGhpcy5uYlBhcnRpY2xlcyl7dmFyIHQ9ZS5NZXNoQnVpbGRlci5DcmVhdGVEaXNjKFwiXCIse3JhZGl1czoxLHRlc3NlbGxhdGlvbjozfSx0aGlzLl9zY2VuZSk7dGhpcy5hZGRTaGFwZSh0LDEpLHQuZGlzcG9zZSgpfXRoaXMuX3Bvc2l0aW9uczMyPW5ldyBGbG9hdDMyQXJyYXkodGhpcy5fcG9zaXRpb25zKSx0aGlzLl91dnMzMj1uZXcgRmxvYXQzMkFycmF5KHRoaXMuX3V2cyksdGhpcy5fY29sb3JzMzI9bmV3IEZsb2F0MzJBcnJheSh0aGlzLl9jb2xvcnMpLGUuVmVydGV4RGF0YS5Db21wdXRlTm9ybWFscyh0aGlzLl9wb3NpdGlvbnMzMix0aGlzLl9pbmRpY2VzLHRoaXMuX25vcm1hbHMpLHRoaXMuX25vcm1hbHMzMj1uZXcgRmxvYXQzMkFycmF5KHRoaXMuX25vcm1hbHMpLHRoaXMuX2ZpeGVkTm9ybWFsMzI9bmV3IEZsb2F0MzJBcnJheSh0aGlzLl9ub3JtYWxzKTt2YXIgaT1uZXcgZS5WZXJ0ZXhEYXRhO2kuc2V0KHRoaXMuX3Bvc2l0aW9uczMyLGUuVmVydGV4QnVmZmVyLlBvc2l0aW9uS2luZCksaS5pbmRpY2VzPXRoaXMuX2luZGljZXMsaS5zZXQodGhpcy5fbm9ybWFsczMyLGUuVmVydGV4QnVmZmVyLk5vcm1hbEtpbmQpLHRoaXMuX3V2czMyJiZpLnNldCh0aGlzLl91dnMzMixlLlZlcnRleEJ1ZmZlci5VVktpbmQpLHRoaXMuX2NvbG9yczMyJiZpLnNldCh0aGlzLl9jb2xvcnMzMixlLlZlcnRleEJ1ZmZlci5Db2xvcktpbmQpO3ZhciByPW5ldyBlLk1lc2godGhpcy5uYW1lLHRoaXMuX3NjZW5lKTtyZXR1cm4gaS5hcHBseVRvTWVzaChyLHRoaXMuX3VwZGF0YWJsZSksdGhpcy5tZXNoPXIsdGhpcy5tZXNoLmlzUGlja2FibGU9dGhpcy5fcGlja2FibGUsdGhpcy5fcG9zaXRpb25zPW51bGwsdGhpcy5fbm9ybWFscz1udWxsLHRoaXMuX3V2cz1udWxsLHRoaXMuX2NvbG9ycz1udWxsLHRoaXMuX3VwZGF0YWJsZXx8KHRoaXMucGFydGljbGVzLmxlbmd0aD0wKSxyfSx0LnByb3RvdHlwZS5kaWdlc3Q9ZnVuY3Rpb24odCxpKXt2YXIgcj1pJiZpLmZhY2V0TmJ8fDEsbj1pJiZpLm51bWJlcixvPWkmJmkuZGVsdGF8fDAscz10LmdldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5Qb3NpdGlvbktpbmQpLGE9dC5nZXRJbmRpY2VzKCksaD10LmdldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5VVktpbmQpLGM9dC5nZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuQ29sb3JLaW5kKSxsPTAsdT1hLmxlbmd0aC8zO24/KG49bj51P3U6bixyPU1hdGgucm91bmQodS9uKSxvPTApOnI9cj51P3U6cjtmb3IodmFyIGY9W10sZD1bXSxwPVtdLF89W10sbT1lLlRtcC5WZWN0b3IzWzBdLGc9cjt1Pmw7KXtyPWcrTWF0aC5mbG9vcigoMStvKSpNYXRoLnJhbmRvbSgpKSxsPnUtciYmKHI9dS1sKSxmLmxlbmd0aD0wLGQubGVuZ3RoPTAscC5sZW5ndGg9MCxfLmxlbmd0aD0wO2Zvcih2YXIgdj0wLHk9MypsOzMqKGwrcik+eTt5Kyspe2QucHVzaCh2KTt2YXIgeD1hW3ldO2YucHVzaChzWzMqeF0sc1szKngrMV0sc1szKngrMl0pLGgmJnAucHVzaChoWzIqeF0saFsyKngrMV0pLGMmJl8ucHVzaChjWzQqeF0sY1s0KngrMV0sY1s0KngrMl0sY1s0KngrM10pLHYrK312YXIgYixQPXRoaXMubmJQYXJ0aWNsZXMsQT10aGlzLl9wb3NUb1NoYXBlKGYpLFQ9dGhpcy5fdXZzVG9TaGFwZVVWKHApO2ZvcihiPTA7YjxBLmxlbmd0aDtiKyspbS5hZGRJblBsYWNlKEFbYl0pO2ZvcihtLnNjYWxlSW5QbGFjZSgxL0EubGVuZ3RoKSxiPTA7YjxBLmxlbmd0aDtiKyspQVtiXS5zdWJ0cmFjdEluUGxhY2UobSk7dmFyIEU9bmV3IGUuTW9kZWxTaGFwZSh0aGlzLl9zaGFwZUNvdW50ZXIsQSxULG51bGwsbnVsbCk7dGhpcy5fbWVzaEJ1aWxkZXIodGhpcy5faW5kZXgsQSx0aGlzLl9wb3NpdGlvbnMsZCx0aGlzLl9pbmRpY2VzLHAsdGhpcy5fdXZzLF8sdGhpcy5fY29sb3JzLFAsMCxudWxsKSx0aGlzLl9hZGRQYXJ0aWNsZShQLHRoaXMuX3Bvc2l0aW9ucy5sZW5ndGgsRSx0aGlzLl9zaGFwZUNvdW50ZXIsMCksdGhpcy5wYXJ0aWNsZXNbdGhpcy5uYlBhcnRpY2xlc10ucG9zaXRpb24uYWRkSW5QbGFjZShtKSx0aGlzLl9pbmRleCs9QS5sZW5ndGgsUCsrLHRoaXMubmJQYXJ0aWNsZXMrKyx0aGlzLl9zaGFwZUNvdW50ZXIrKyxsKz1yfXJldHVybiB0aGlzfSx0LnByb3RvdHlwZS5fcmVzZXRDb3B5PWZ1bmN0aW9uKCl7dGhpcy5fY29weS5wb3NpdGlvbi54PTAsdGhpcy5fY29weS5wb3NpdGlvbi55PTAsdGhpcy5fY29weS5wb3NpdGlvbi56PTAsdGhpcy5fY29weS5yb3RhdGlvbi54PTAsdGhpcy5fY29weS5yb3RhdGlvbi55PTAsdGhpcy5fY29weS5yb3RhdGlvbi56PTAsdGhpcy5fY29weS5yb3RhdGlvblF1YXRlcm5pb249bnVsbCx0aGlzLl9jb3B5LnNjYWxpbmcueD0xLHRoaXMuX2NvcHkuc2NhbGluZy55PTEsdGhpcy5fY29weS5zY2FsaW5nLno9MSx0aGlzLl9jb3B5LnV2cy54PTAsdGhpcy5fY29weS51dnMueT0wLHRoaXMuX2NvcHkudXZzLno9MSx0aGlzLl9jb3B5LnV2cy53PTEsdGhpcy5fY29weS5jb2xvcj1udWxsfSx0LnByb3RvdHlwZS5fbWVzaEJ1aWxkZXI9ZnVuY3Rpb24odCxpLHIsbixvLHMsYSxoLGMsbCx1LGYpe3ZhciBkLHA9MCxfPTA7Zm9yKHRoaXMuX3Jlc2V0Q29weSgpLGYmJmYucG9zaXRpb25GdW5jdGlvbiYmZi5wb3NpdGlvbkZ1bmN0aW9uKHRoaXMuX2NvcHksbCx1KSx0aGlzLl9jb3B5LnJvdGF0aW9uUXVhdGVybmlvbj90aGlzLl9xdWF0ZXJuaW9uLmNvcHlGcm9tKHRoaXMuX2NvcHkucm90YXRpb25RdWF0ZXJuaW9uKToodGhpcy5feWF3PXRoaXMuX2NvcHkucm90YXRpb24ueSx0aGlzLl9waXRjaD10aGlzLl9jb3B5LnJvdGF0aW9uLngsdGhpcy5fcm9sbD10aGlzLl9jb3B5LnJvdGF0aW9uLnosdGhpcy5fcXVhdGVybmlvblJvdGF0aW9uWVBSKCkpLHRoaXMuX3F1YXRlcm5pb25Ub1JvdGF0aW9uTWF0cml4KCksZD0wO2Q8aS5sZW5ndGg7ZCsrKXRoaXMuX3ZlcnRleC54PWlbZF0ueCx0aGlzLl92ZXJ0ZXgueT1pW2RdLnksdGhpcy5fdmVydGV4Lno9aVtkXS56LGYmJmYudmVydGV4RnVuY3Rpb24mJmYudmVydGV4RnVuY3Rpb24odGhpcy5fY29weSx0aGlzLl92ZXJ0ZXgsZCksdGhpcy5fdmVydGV4LngqPXRoaXMuX2NvcHkuc2NhbGluZy54LHRoaXMuX3ZlcnRleC55Kj10aGlzLl9jb3B5LnNjYWxpbmcueSx0aGlzLl92ZXJ0ZXgueio9dGhpcy5fY29weS5zY2FsaW5nLnosZS5WZWN0b3IzLlRyYW5zZm9ybUNvb3JkaW5hdGVzVG9SZWYodGhpcy5fdmVydGV4LHRoaXMuX3JvdE1hdHJpeCx0aGlzLl9yb3RhdGVkKSxyLnB1c2godGhpcy5fY29weS5wb3NpdGlvbi54K3RoaXMuX3JvdGF0ZWQueCx0aGlzLl9jb3B5LnBvc2l0aW9uLnkrdGhpcy5fcm90YXRlZC55LHRoaXMuX2NvcHkucG9zaXRpb24ueit0aGlzLl9yb3RhdGVkLnopLHMmJihhLnB1c2goKHRoaXMuX2NvcHkudXZzLnotdGhpcy5fY29weS51dnMueCkqc1twXSt0aGlzLl9jb3B5LnV2cy54LCh0aGlzLl9jb3B5LnV2cy53LXRoaXMuX2NvcHkudXZzLnkpKnNbcCsxXSt0aGlzLl9jb3B5LnV2cy55KSxwKz0yKSx0aGlzLl9jb3B5LmNvbG9yP3RoaXMuX2NvbG9yPXRoaXMuX2NvcHkuY29sb3I6aCYmaFtfXT8odGhpcy5fY29sb3Iucj1oW19dLHRoaXMuX2NvbG9yLmc9aFtfKzFdLHRoaXMuX2NvbG9yLmI9aFtfKzJdLHRoaXMuX2NvbG9yLmE9aFtfKzNdKToodGhpcy5fY29sb3Iucj0xLHRoaXMuX2NvbG9yLmc9MSx0aGlzLl9jb2xvci5iPTEsdGhpcy5fY29sb3IuYT0xKSxjLnB1c2godGhpcy5fY29sb3Iucix0aGlzLl9jb2xvci5nLHRoaXMuX2NvbG9yLmIsdGhpcy5fY29sb3IuYSksXys9NDtmb3IoZD0wO2Q8bi5sZW5ndGg7ZCsrKW8ucHVzaCh0K25bZF0pO2lmKHRoaXMuX3BpY2thYmxlKXt2YXIgbT1uLmxlbmd0aC8zO2ZvcihkPTA7bT5kO2QrKyl0aGlzLnBpY2tlZFBhcnRpY2xlcy5wdXNoKHtpZHg6bCxmYWNlSWQ6ZH0pfX0sdC5wcm90b3R5cGUuX3Bvc1RvU2hhcGU9ZnVuY3Rpb24odCl7Zm9yKHZhciBpPVtdLHI9MDtyPHQubGVuZ3RoO3IrPTMpaS5wdXNoKG5ldyBlLlZlY3RvcjModFtyXSx0W3IrMV0sdFtyKzJdKSk7cmV0dXJuIGl9LHQucHJvdG90eXBlLl91dnNUb1NoYXBlVVY9ZnVuY3Rpb24oZSl7dmFyIHQ9W107aWYoZSlmb3IodmFyIGk9MDtpPGUubGVuZ3RoO2krKyl0LnB1c2goZVtpXSk7cmV0dXJuIHR9LHQucHJvdG90eXBlLl9hZGRQYXJ0aWNsZT1mdW5jdGlvbih0LGkscixuLG8pe3RoaXMucGFydGljbGVzLnB1c2gobmV3IGUuU29saWRQYXJ0aWNsZSh0LGkscixuLG8pKX0sdC5wcm90b3R5cGUuYWRkU2hhcGU9ZnVuY3Rpb24odCxpLHIpe2Zvcih2YXIgbj10LmdldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5Qb3NpdGlvbktpbmQpLG89dC5nZXRJbmRpY2VzKCkscz10LmdldFZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5VVktpbmQpLGE9dC5nZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuQ29sb3JLaW5kKSxoPXRoaXMuX3Bvc1RvU2hhcGUobiksYz10aGlzLl91dnNUb1NoYXBlVVYocyksbD1yP3IucG9zaXRpb25GdW5jdGlvbjpudWxsLHU9cj9yLnZlcnRleEZ1bmN0aW9uOm51bGwsZj1uZXcgZS5Nb2RlbFNoYXBlKHRoaXMuX3NoYXBlQ291bnRlcixoLGMsbCx1KSxkPXRoaXMubmJQYXJ0aWNsZXMscD0wO2k+cDtwKyspdGhpcy5fbWVzaEJ1aWxkZXIodGhpcy5faW5kZXgsaCx0aGlzLl9wb3NpdGlvbnMsbyx0aGlzLl9pbmRpY2VzLHMsdGhpcy5fdXZzLGEsdGhpcy5fY29sb3JzLGQscCxyKSx0aGlzLl91cGRhdGFibGUmJnRoaXMuX2FkZFBhcnRpY2xlKGQsdGhpcy5fcG9zaXRpb25zLmxlbmd0aCxmLHRoaXMuX3NoYXBlQ291bnRlcixwKSx0aGlzLl9pbmRleCs9aC5sZW5ndGgsZCsrO3JldHVybiB0aGlzLm5iUGFydGljbGVzKz1pLHRoaXMuX3NoYXBlQ291bnRlcisrLHRoaXMuX3NoYXBlQ291bnRlci0xfSx0LnByb3RvdHlwZS5fcmVidWlsZFBhcnRpY2xlPWZ1bmN0aW9uKHQpe3RoaXMuX3Jlc2V0Q29weSgpLHQuX21vZGVsLl9wb3NpdGlvbkZ1bmN0aW9uJiZ0Ll9tb2RlbC5fcG9zaXRpb25GdW5jdGlvbih0aGlzLl9jb3B5LHQuaWR4LHQuaWR4SW5TaGFwZSksdGhpcy5fY29weS5yb3RhdGlvblF1YXRlcm5pb24/dGhpcy5fcXVhdGVybmlvbi5jb3B5RnJvbSh0aGlzLl9jb3B5LnJvdGF0aW9uUXVhdGVybmlvbik6KHRoaXMuX3lhdz10aGlzLl9jb3B5LnJvdGF0aW9uLnksdGhpcy5fcGl0Y2g9dGhpcy5fY29weS5yb3RhdGlvbi54LHRoaXMuX3JvbGw9dGhpcy5fY29weS5yb3RhdGlvbi56LHRoaXMuX3F1YXRlcm5pb25Sb3RhdGlvbllQUigpKSx0aGlzLl9xdWF0ZXJuaW9uVG9Sb3RhdGlvbk1hdHJpeCgpLHRoaXMuX3NoYXBlPXQuX21vZGVsLl9zaGFwZTtmb3IodmFyIGk9MDtpPHRoaXMuX3NoYXBlLmxlbmd0aDtpKyspdGhpcy5fdmVydGV4Lng9dGhpcy5fc2hhcGVbaV0ueCx0aGlzLl92ZXJ0ZXgueT10aGlzLl9zaGFwZVtpXS55LHRoaXMuX3ZlcnRleC56PXRoaXMuX3NoYXBlW2ldLnosdC5fbW9kZWwuX3ZlcnRleEZ1bmN0aW9uJiZ0Ll9tb2RlbC5fdmVydGV4RnVuY3Rpb24odGhpcy5fY29weSx0aGlzLl92ZXJ0ZXgsaSksdGhpcy5fdmVydGV4LngqPXRoaXMuX2NvcHkuc2NhbGluZy54LHRoaXMuX3ZlcnRleC55Kj10aGlzLl9jb3B5LnNjYWxpbmcueSx0aGlzLl92ZXJ0ZXgueio9dGhpcy5fY29weS5zY2FsaW5nLnosZS5WZWN0b3IzLlRyYW5zZm9ybUNvb3JkaW5hdGVzVG9SZWYodGhpcy5fdmVydGV4LHRoaXMuX3JvdE1hdHJpeCx0aGlzLl9yb3RhdGVkKSx0aGlzLl9wb3NpdGlvbnMzMlt0Ll9wb3MrMyppXT10aGlzLl9jb3B5LnBvc2l0aW9uLngrdGhpcy5fcm90YXRlZC54LHRoaXMuX3Bvc2l0aW9uczMyW3QuX3BvcyszKmkrMV09dGhpcy5fY29weS5wb3NpdGlvbi55K3RoaXMuX3JvdGF0ZWQueSx0aGlzLl9wb3NpdGlvbnMzMlt0Ll9wb3MrMyppKzJdPXRoaXMuX2NvcHkucG9zaXRpb24ueit0aGlzLl9yb3RhdGVkLno7dC5wb3NpdGlvbi54PTAsdC5wb3NpdGlvbi55PTAsdC5wb3NpdGlvbi56PTAsdC5yb3RhdGlvbi54PTAsdC5yb3RhdGlvbi55PTAsdC5yb3RhdGlvbi56PTAsdC5yb3RhdGlvblF1YXRlcm5pb249bnVsbCx0LnNjYWxpbmcueD0xLHQuc2NhbGluZy55PTEsdC5zY2FsaW5nLno9MX0sdC5wcm90b3R5cGUucmVidWlsZE1lc2g9ZnVuY3Rpb24oKXtmb3IodmFyIHQ9MDt0PHRoaXMucGFydGljbGVzLmxlbmd0aDt0KyspdGhpcy5fcmVidWlsZFBhcnRpY2xlKHRoaXMucGFydGljbGVzW3RdKTt0aGlzLm1lc2gudXBkYXRlVmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLlBvc2l0aW9uS2luZCx0aGlzLl9wb3NpdGlvbnMzMiwhMSwhMSl9LHQucHJvdG90eXBlLnNldFBhcnRpY2xlcz1mdW5jdGlvbih0LGkscil7aWYodm9pZCAwPT09dCYmKHQ9MCksdm9pZCAwPT09aSYmKGk9dGhpcy5uYlBhcnRpY2xlcy0xKSx2b2lkIDA9PT1yJiYocj0hMCksdGhpcy5fdXBkYXRhYmxlKXt0aGlzLmJlZm9yZVVwZGF0ZVBhcnRpY2xlcyh0LGksciksdGhpcy5fY2FtX2F4aXNYLng9MSx0aGlzLl9jYW1fYXhpc1gueT0wLHRoaXMuX2NhbV9heGlzWC56PTAsdGhpcy5fY2FtX2F4aXNZLng9MCx0aGlzLl9jYW1fYXhpc1kueT0xLHRoaXMuX2NhbV9heGlzWS56PTAsdGhpcy5fY2FtX2F4aXNaLng9MCx0aGlzLl9jYW1fYXhpc1oueT0wLHRoaXMuX2NhbV9heGlzWi56PTEsdGhpcy5iaWxsYm9hcmQmJih0aGlzLl95YXc9dGhpcy5tZXNoLnJvdGF0aW9uLnksdGhpcy5fcGl0Y2g9dGhpcy5tZXNoLnJvdGF0aW9uLngsdGhpcy5fcm9sbD10aGlzLm1lc2gucm90YXRpb24ueix0aGlzLl9xdWF0ZXJuaW9uUm90YXRpb25ZUFIoKSx0aGlzLl9xdWF0ZXJuaW9uVG9Sb3RhdGlvbk1hdHJpeCgpLHRoaXMuX3JvdE1hdHJpeC5pbnZlcnRUb1JlZih0aGlzLl9pbnZlcnRNYXRyaXgpLGUuVmVjdG9yMy5UcmFuc2Zvcm1Db29yZGluYXRlc1RvUmVmKHRoaXMuX2NhbWVyYS5nbG9iYWxQb3NpdGlvbix0aGlzLl9pbnZlcnRNYXRyaXgsdGhpcy5fZmFrZUNhbVBvcyksdGhpcy5fZmFrZUNhbVBvcy5zdWJ0cmFjdFRvUmVmKHRoaXMubWVzaC5wb3NpdGlvbix0aGlzLl9jYW1fYXhpc1opLGUuVmVjdG9yMy5Dcm9zc1RvUmVmKHRoaXMuX2NhbV9heGlzWix0aGlzLl9heGlzWCx0aGlzLl9jYW1fYXhpc1kpLGUuVmVjdG9yMy5Dcm9zc1RvUmVmKHRoaXMuX2NhbV9heGlzWix0aGlzLl9jYW1fYXhpc1ksdGhpcy5fY2FtX2F4aXNYKSx0aGlzLl9jYW1fYXhpc1kubm9ybWFsaXplKCksdGhpcy5fY2FtX2F4aXNYLm5vcm1hbGl6ZSgpLHRoaXMuX2NhbV9heGlzWi5ub3JtYWxpemUoKSksZS5NYXRyaXguSWRlbnRpdHlUb1JlZih0aGlzLl9yb3RNYXRyaXgpO3ZhciBuPTAsbz0wLHM9MCxhPTAsaD0wLGM9MCxsPTA7dGhpcy5fY29tcHV0ZUJvdW5kaW5nQm94JiYoZS5WZWN0b3IzLkZyb21GbG9hdHNUb1JlZihOdW1iZXIuTUFYX1ZBTFVFLE51bWJlci5NQVhfVkFMVUUsTnVtYmVyLk1BWF9WQUxVRSx0aGlzLl9taW5pbXVtKSxlLlZlY3RvcjMuRnJvbUZsb2F0c1RvUmVmKC1OdW1iZXIuTUFYX1ZBTFVFLC1OdW1iZXIuTUFYX1ZBTFVFLC1OdW1iZXIuTUFYX1ZBTFVFLHRoaXMuX21heGltdW0pKSxpPWk+dGhpcy5uYlBhcnRpY2xlcy0xP3RoaXMubmJQYXJ0aWNsZXMtMTppO2Zvcih2YXIgdT10O2k+PXU7dSsrKXtpZih0aGlzLl9wYXJ0aWNsZT10aGlzLnBhcnRpY2xlc1t1XSx0aGlzLl9zaGFwZT10aGlzLl9wYXJ0aWNsZS5fbW9kZWwuX3NoYXBlLHRoaXMuX3NoYXBlVVY9dGhpcy5fcGFydGljbGUuX21vZGVsLl9zaGFwZVVWLHRoaXMudXBkYXRlUGFydGljbGUodGhpcy5fcGFydGljbGUpLHRoaXMuX3BhcnRpY2xlLmlzVmlzaWJsZSlmb3IodGhpcy5iaWxsYm9hcmQmJih0aGlzLl9wYXJ0aWNsZS5yb3RhdGlvbi54PTAsdGhpcy5fcGFydGljbGUucm90YXRpb24ueT0wKSx0aGlzLl9jb21wdXRlUGFydGljbGVSb3RhdGlvbiYmKHRoaXMuX3BhcnRpY2xlLnJvdGF0aW9uUXVhdGVybmlvbj90aGlzLl9xdWF0ZXJuaW9uLmNvcHlGcm9tKHRoaXMuX3BhcnRpY2xlLnJvdGF0aW9uUXVhdGVybmlvbik6KHRoaXMuX3lhdz10aGlzLl9wYXJ0aWNsZS5yb3RhdGlvbi55LHRoaXMuX3BpdGNoPXRoaXMuX3BhcnRpY2xlLnJvdGF0aW9uLngsdGhpcy5fcm9sbD10aGlzLl9wYXJ0aWNsZS5yb3RhdGlvbi56LHRoaXMuX3F1YXRlcm5pb25Sb3RhdGlvbllQUigpKSx0aGlzLl9xdWF0ZXJuaW9uVG9Sb3RhdGlvbk1hdHJpeCgpKSxsPTA7bDx0aGlzLl9zaGFwZS5sZW5ndGg7bCsrKW49byszKmwscz1hKzQqbCxoPWMrMipsLHRoaXMuX3ZlcnRleC54PXRoaXMuX3NoYXBlW2xdLngsdGhpcy5fdmVydGV4Lnk9dGhpcy5fc2hhcGVbbF0ueSx0aGlzLl92ZXJ0ZXguej10aGlzLl9zaGFwZVtsXS56LHRoaXMuX2NvbXB1dGVQYXJ0aWNsZVZlcnRleCYmdGhpcy51cGRhdGVQYXJ0aWNsZVZlcnRleCh0aGlzLl9wYXJ0aWNsZSx0aGlzLl92ZXJ0ZXgsbCksdGhpcy5fdmVydGV4LngqPXRoaXMuX3BhcnRpY2xlLnNjYWxpbmcueCx0aGlzLl92ZXJ0ZXgueSo9dGhpcy5fcGFydGljbGUuc2NhbGluZy55LHRoaXMuX3ZlcnRleC56Kj10aGlzLl9wYXJ0aWNsZS5zY2FsaW5nLnosdGhpcy5fdz10aGlzLl92ZXJ0ZXgueCp0aGlzLl9yb3RNYXRyaXgubVszXSt0aGlzLl92ZXJ0ZXgueSp0aGlzLl9yb3RNYXRyaXgubVs3XSt0aGlzLl92ZXJ0ZXgueip0aGlzLl9yb3RNYXRyaXgubVsxMV0rdGhpcy5fcm90TWF0cml4Lm1bMTVdLHRoaXMuX3JvdGF0ZWQueD0odGhpcy5fdmVydGV4LngqdGhpcy5fcm90TWF0cml4Lm1bMF0rdGhpcy5fdmVydGV4LnkqdGhpcy5fcm90TWF0cml4Lm1bNF0rdGhpcy5fdmVydGV4LnoqdGhpcy5fcm90TWF0cml4Lm1bOF0rdGhpcy5fcm90TWF0cml4Lm1bMTJdKS90aGlzLl93LHRoaXMuX3JvdGF0ZWQueT0odGhpcy5fdmVydGV4LngqdGhpcy5fcm90TWF0cml4Lm1bMV0rdGhpcy5fdmVydGV4LnkqdGhpcy5fcm90TWF0cml4Lm1bNV0rdGhpcy5fdmVydGV4LnoqdGhpcy5fcm90TWF0cml4Lm1bOV0rdGhpcy5fcm90TWF0cml4Lm1bMTNdKS90aGlzLl93LHRoaXMuX3JvdGF0ZWQuej0odGhpcy5fdmVydGV4LngqdGhpcy5fcm90TWF0cml4Lm1bMl0rdGhpcy5fdmVydGV4LnkqdGhpcy5fcm90TWF0cml4Lm1bNl0rdGhpcy5fdmVydGV4LnoqdGhpcy5fcm90TWF0cml4Lm1bMTBdK3RoaXMuX3JvdE1hdHJpeC5tWzE0XSkvdGhpcy5fdyx0aGlzLl9wb3NpdGlvbnMzMltuXT10aGlzLl9wYXJ0aWNsZS5wb3NpdGlvbi54K3RoaXMuX2NhbV9heGlzWC54KnRoaXMuX3JvdGF0ZWQueCt0aGlzLl9jYW1fYXhpc1kueCp0aGlzLl9yb3RhdGVkLnkrdGhpcy5fY2FtX2F4aXNaLngqdGhpcy5fcm90YXRlZC56LHRoaXMuX3Bvc2l0aW9uczMyW24rMV09dGhpcy5fcGFydGljbGUucG9zaXRpb24ueSt0aGlzLl9jYW1fYXhpc1gueSp0aGlzLl9yb3RhdGVkLngrdGhpcy5fY2FtX2F4aXNZLnkqdGhpcy5fcm90YXRlZC55K3RoaXMuX2NhbV9heGlzWi55KnRoaXMuX3JvdGF0ZWQueix0aGlzLl9wb3NpdGlvbnMzMltuKzJdPXRoaXMuX3BhcnRpY2xlLnBvc2l0aW9uLnordGhpcy5fY2FtX2F4aXNYLnoqdGhpcy5fcm90YXRlZC54K3RoaXMuX2NhbV9heGlzWS56KnRoaXMuX3JvdGF0ZWQueSt0aGlzLl9jYW1fYXhpc1oueip0aGlzLl9yb3RhdGVkLnosdGhpcy5fY29tcHV0ZUJvdW5kaW5nQm94JiYodGhpcy5fcG9zaXRpb25zMzJbbl08dGhpcy5fbWluaW11bS54JiYodGhpcy5fbWluaW11bS54PXRoaXMuX3Bvc2l0aW9uczMyW25dKSx0aGlzLl9wb3NpdGlvbnMzMltuXT50aGlzLl9tYXhpbXVtLngmJih0aGlzLl9tYXhpbXVtLng9dGhpcy5fcG9zaXRpb25zMzJbbl0pLHRoaXMuX3Bvc2l0aW9uczMyW24rMV08dGhpcy5fbWluaW11bS55JiYodGhpcy5fbWluaW11bS55PXRoaXMuX3Bvc2l0aW9uczMyW24rMV0pLHRoaXMuX3Bvc2l0aW9uczMyW24rMV0+dGhpcy5fbWF4aW11bS55JiYodGhpcy5fbWF4aW11bS55PXRoaXMuX3Bvc2l0aW9uczMyW24rMV0pLHRoaXMuX3Bvc2l0aW9uczMyW24rMl08dGhpcy5fbWluaW11bS56JiYodGhpcy5fbWluaW11bS56PXRoaXMuX3Bvc2l0aW9uczMyW24rMl0pLHRoaXMuX3Bvc2l0aW9uczMyW24rMl0+dGhpcy5fbWF4aW11bS56JiYodGhpcy5fbWF4aW11bS56PXRoaXMuX3Bvc2l0aW9uczMyW24rMl0pKSx0aGlzLl9jb21wdXRlUGFydGljbGVWZXJ0ZXh8fHRoaXMuYmlsbGJvYXJkfHwodGhpcy5fbm9ybWFsLng9dGhpcy5fZml4ZWROb3JtYWwzMltuXSx0aGlzLl9ub3JtYWwueT10aGlzLl9maXhlZE5vcm1hbDMyW24rMV0sdGhpcy5fbm9ybWFsLno9dGhpcy5fZml4ZWROb3JtYWwzMltuKzJdLHRoaXMuX3c9dGhpcy5fbm9ybWFsLngqdGhpcy5fcm90TWF0cml4Lm1bM10rdGhpcy5fbm9ybWFsLnkqdGhpcy5fcm90TWF0cml4Lm1bN10rdGhpcy5fbm9ybWFsLnoqdGhpcy5fcm90TWF0cml4Lm1bMTFdK3RoaXMuX3JvdE1hdHJpeC5tWzE1XSx0aGlzLl9yb3RhdGVkLng9KHRoaXMuX25vcm1hbC54KnRoaXMuX3JvdE1hdHJpeC5tWzBdK3RoaXMuX25vcm1hbC55KnRoaXMuX3JvdE1hdHJpeC5tWzRdK3RoaXMuX25vcm1hbC56KnRoaXMuX3JvdE1hdHJpeC5tWzhdK3RoaXMuX3JvdE1hdHJpeC5tWzEyXSkvdGhpcy5fdyx0aGlzLl9yb3RhdGVkLnk9KHRoaXMuX25vcm1hbC54KnRoaXMuX3JvdE1hdHJpeC5tWzFdK3RoaXMuX25vcm1hbC55KnRoaXMuX3JvdE1hdHJpeC5tWzVdK3RoaXMuX25vcm1hbC56KnRoaXMuX3JvdE1hdHJpeC5tWzldK3RoaXMuX3JvdE1hdHJpeC5tWzEzXSkvdGhpcy5fdyx0aGlzLl9yb3RhdGVkLno9KHRoaXMuX25vcm1hbC54KnRoaXMuX3JvdE1hdHJpeC5tWzJdK3RoaXMuX25vcm1hbC55KnRoaXMuX3JvdE1hdHJpeC5tWzZdK3RoaXMuX25vcm1hbC56KnRoaXMuX3JvdE1hdHJpeC5tWzEwXSt0aGlzLl9yb3RNYXRyaXgubVsxNF0pL3RoaXMuX3csdGhpcy5fbm9ybWFsczMyW25dPXRoaXMuX2NhbV9heGlzWC54KnRoaXMuX3JvdGF0ZWQueCt0aGlzLl9jYW1fYXhpc1kueCp0aGlzLl9yb3RhdGVkLnkrdGhpcy5fY2FtX2F4aXNaLngqdGhpcy5fcm90YXRlZC56LHRoaXMuX25vcm1hbHMzMltuKzFdPXRoaXMuX2NhbV9heGlzWC55KnRoaXMuX3JvdGF0ZWQueCt0aGlzLl9jYW1fYXhpc1kueSp0aGlzLl9yb3RhdGVkLnkrdGhpcy5fY2FtX2F4aXNaLnkqdGhpcy5fcm90YXRlZC56LHRoaXMuX25vcm1hbHMzMltuKzJdPXRoaXMuX2NhbV9heGlzWC56KnRoaXMuX3JvdGF0ZWQueCt0aGlzLl9jYW1fYXhpc1kueip0aGlzLl9yb3RhdGVkLnkrdGhpcy5fY2FtX2F4aXNaLnoqdGhpcy5fcm90YXRlZC56KSx0aGlzLl9jb21wdXRlUGFydGljbGVDb2xvciYmKHRoaXMuX2NvbG9yczMyW3NdPXRoaXMuX3BhcnRpY2xlLmNvbG9yLnIsdGhpcy5fY29sb3JzMzJbcysxXT10aGlzLl9wYXJ0aWNsZS5jb2xvci5nLHRoaXMuX2NvbG9yczMyW3MrMl09dGhpcy5fcGFydGljbGUuY29sb3IuYix0aGlzLl9jb2xvcnMzMltzKzNdPXRoaXMuX3BhcnRpY2xlLmNvbG9yLmEpLHRoaXMuX2NvbXB1dGVQYXJ0aWNsZVRleHR1cmUmJih0aGlzLl91dnMzMltoXT10aGlzLl9zaGFwZVVWWzIqbF0qKHRoaXMuX3BhcnRpY2xlLnV2cy56LXRoaXMuX3BhcnRpY2xlLnV2cy54KSt0aGlzLl9wYXJ0aWNsZS51dnMueCx0aGlzLl91dnMzMltoKzFdPXRoaXMuX3NoYXBlVVZbMipsKzFdKih0aGlzLl9wYXJ0aWNsZS51dnMudy10aGlzLl9wYXJ0aWNsZS51dnMueSkrdGhpcy5fcGFydGljbGUudXZzLnkpO2Vsc2UgZm9yKGw9MDtsPHRoaXMuX3NoYXBlLmxlbmd0aDtsKyspbj1vKzMqbCxzPWErNCpsLGg9YysyKmwsdGhpcy5fcG9zaXRpb25zMzJbbl09dGhpcy5fY2FtZXJhLnBvc2l0aW9uLngsdGhpcy5fcG9zaXRpb25zMzJbbisxXT10aGlzLl9jYW1lcmEucG9zaXRpb24ueSx0aGlzLl9wb3NpdGlvbnMzMltuKzJdPXRoaXMuX2NhbWVyYS5wb3NpdGlvbi56LHRoaXMuX25vcm1hbHMzMltuXT0wLHRoaXMuX25vcm1hbHMzMltuKzFdPTAsdGhpcy5fbm9ybWFsczMyW24rMl09MCx0aGlzLl9jb21wdXRlUGFydGljbGVDb2xvciYmKHRoaXMuX2NvbG9yczMyW3NdPXRoaXMuX3BhcnRpY2xlLmNvbG9yLnIsdGhpcy5fY29sb3JzMzJbcysxXT10aGlzLl9wYXJ0aWNsZS5jb2xvci5nLHRoaXMuX2NvbG9yczMyW3MrMl09dGhpcy5fcGFydGljbGUuY29sb3IuYix0aGlzLl9jb2xvcnMzMltzKzNdPXRoaXMuX3BhcnRpY2xlLmNvbG9yLmEpLHRoaXMuX2NvbXB1dGVQYXJ0aWNsZVRleHR1cmUmJih0aGlzLl91dnMzMltoXT10aGlzLl9zaGFwZVVWWzIqbF0qKHRoaXMuX3BhcnRpY2xlLnV2cy56LXRoaXMuX3BhcnRpY2xlLnV2cy54KSt0aGlzLl9wYXJ0aWNsZS51dnMueCx0aGlzLl91dnMzMltoKzFdPXRoaXMuX3NoYXBlVVZbMipsKzFdKih0aGlzLl9wYXJ0aWNsZS51dnMudy10aGlzLl9wYXJ0aWNsZS51dnMueSkrdGhpcy5fcGFydGljbGUudXZzLnkpO289biszLGE9cys0LGM9aCsyfWlmKHImJih0aGlzLl9jb21wdXRlUGFydGljbGVDb2xvciYmdGhpcy5tZXNoLnVwZGF0ZVZlcnRpY2VzRGF0YShlLlZlcnRleEJ1ZmZlci5Db2xvcktpbmQsdGhpcy5fY29sb3JzMzIsITEsITEpLHRoaXMuX2NvbXB1dGVQYXJ0aWNsZVRleHR1cmUmJnRoaXMubWVzaC51cGRhdGVWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuVVZLaW5kLHRoaXMuX3V2czMyLCExLCExKSx0aGlzLm1lc2gudXBkYXRlVmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLlBvc2l0aW9uS2luZCx0aGlzLl9wb3NpdGlvbnMzMiwhMSwhMSksIXRoaXMubWVzaC5hcmVOb3JtYWxzRnJvemVuKSl7aWYodGhpcy5fY29tcHV0ZVBhcnRpY2xlVmVydGV4fHx0aGlzLmJpbGxib2FyZCl7ZS5WZXJ0ZXhEYXRhLkNvbXB1dGVOb3JtYWxzKHRoaXMuX3Bvc2l0aW9uczMyLHRoaXMuX2luZGljZXMsdGhpcy5fbm9ybWFsczMyKTtmb3IodmFyIGY9MDtmPHRoaXMuX25vcm1hbHMzMi5sZW5ndGg7ZisrKXRoaXMuX2ZpeGVkTm9ybWFsMzJbZl09dGhpcy5fbm9ybWFsczMyW2ZdfXRoaXMubWVzaC51cGRhdGVWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuTm9ybWFsS2luZCx0aGlzLl9ub3JtYWxzMzIsITEsITEpfXRoaXMuX2NvbXB1dGVCb3VuZGluZ0JveCYmKHRoaXMubWVzaC5fYm91bmRpbmdJbmZvPW5ldyBlLkJvdW5kaW5nSW5mbyh0aGlzLl9taW5pbXVtLHRoaXMuX21heGltdW0pLHRoaXMubWVzaC5fYm91bmRpbmdJbmZvLnVwZGF0ZSh0aGlzLm1lc2guX3dvcmxkTWF0cml4KSksdGhpcy5hZnRlclVwZGF0ZVBhcnRpY2xlcyh0LGkscil9fSx0LnByb3RvdHlwZS5fcXVhdGVybmlvblJvdGF0aW9uWVBSPWZ1bmN0aW9uKCl7dGhpcy5faGFsZnJvbGw9LjUqdGhpcy5fcm9sbCx0aGlzLl9oYWxmcGl0Y2g9LjUqdGhpcy5fcGl0Y2gsdGhpcy5faGFsZnlhdz0uNSp0aGlzLl95YXcsdGhpcy5fc2luUm9sbD1NYXRoLnNpbih0aGlzLl9oYWxmcm9sbCksdGhpcy5fY29zUm9sbD1NYXRoLmNvcyh0aGlzLl9oYWxmcm9sbCksdGhpcy5fc2luUGl0Y2g9TWF0aC5zaW4odGhpcy5faGFsZnBpdGNoKSx0aGlzLl9jb3NQaXRjaD1NYXRoLmNvcyh0aGlzLl9oYWxmcGl0Y2gpLHRoaXMuX3Npbllhdz1NYXRoLnNpbih0aGlzLl9oYWxmeWF3KSx0aGlzLl9jb3NZYXc9TWF0aC5jb3ModGhpcy5faGFsZnlhdyksdGhpcy5fcXVhdGVybmlvbi54PXRoaXMuX2Nvc1lhdyp0aGlzLl9zaW5QaXRjaCp0aGlzLl9jb3NSb2xsK3RoaXMuX3Npbllhdyp0aGlzLl9jb3NQaXRjaCp0aGlzLl9zaW5Sb2xsLHRoaXMuX3F1YXRlcm5pb24ueT10aGlzLl9zaW5ZYXcqdGhpcy5fY29zUGl0Y2gqdGhpcy5fY29zUm9sbC10aGlzLl9jb3NZYXcqdGhpcy5fc2luUGl0Y2gqdGhpcy5fc2luUm9sbCx0aGlzLl9xdWF0ZXJuaW9uLno9dGhpcy5fY29zWWF3KnRoaXMuX2Nvc1BpdGNoKnRoaXMuX3NpblJvbGwtdGhpcy5fc2luWWF3KnRoaXMuX3NpblBpdGNoKnRoaXMuX2Nvc1JvbGwsdGhpcy5fcXVhdGVybmlvbi53PXRoaXMuX2Nvc1lhdyp0aGlzLl9jb3NQaXRjaCp0aGlzLl9jb3NSb2xsK3RoaXMuX3Npbllhdyp0aGlzLl9zaW5QaXRjaCp0aGlzLl9zaW5Sb2xsfSx0LnByb3RvdHlwZS5fcXVhdGVybmlvblRvUm90YXRpb25NYXRyaXg9ZnVuY3Rpb24oKXt0aGlzLl9yb3RNYXRyaXgubVswXT0xLTIqKHRoaXMuX3F1YXRlcm5pb24ueSp0aGlzLl9xdWF0ZXJuaW9uLnkrdGhpcy5fcXVhdGVybmlvbi56KnRoaXMuX3F1YXRlcm5pb24ueiksdGhpcy5fcm90TWF0cml4Lm1bMV09MioodGhpcy5fcXVhdGVybmlvbi54KnRoaXMuX3F1YXRlcm5pb24ueSt0aGlzLl9xdWF0ZXJuaW9uLnoqdGhpcy5fcXVhdGVybmlvbi53KSx0aGlzLl9yb3RNYXRyaXgubVsyXT0yKih0aGlzLl9xdWF0ZXJuaW9uLnoqdGhpcy5fcXVhdGVybmlvbi54LXRoaXMuX3F1YXRlcm5pb24ueSp0aGlzLl9xdWF0ZXJuaW9uLncpLHRoaXMuX3JvdE1hdHJpeC5tWzNdPTAsdGhpcy5fcm90TWF0cml4Lm1bNF09MioodGhpcy5fcXVhdGVybmlvbi54KnRoaXMuX3F1YXRlcm5pb24ueS10aGlzLl9xdWF0ZXJuaW9uLnoqdGhpcy5fcXVhdGVybmlvbi53KSx0aGlzLl9yb3RNYXRyaXgubVs1XT0xLTIqKHRoaXMuX3F1YXRlcm5pb24ueip0aGlzLl9xdWF0ZXJuaW9uLnordGhpcy5fcXVhdGVybmlvbi54KnRoaXMuX3F1YXRlcm5pb24ueCksdGhpcy5fcm90TWF0cml4Lm1bNl09MioodGhpcy5fcXVhdGVybmlvbi55KnRoaXMuX3F1YXRlcm5pb24ueit0aGlzLl9xdWF0ZXJuaW9uLngqdGhpcy5fcXVhdGVybmlvbi53KSx0aGlzLl9yb3RNYXRyaXgubVs3XT0wLHRoaXMuX3JvdE1hdHJpeC5tWzhdPTIqKHRoaXMuX3F1YXRlcm5pb24ueip0aGlzLl9xdWF0ZXJuaW9uLngrdGhpcy5fcXVhdGVybmlvbi55KnRoaXMuX3F1YXRlcm5pb24udyksdGhpcy5fcm90TWF0cml4Lm1bOV09MioodGhpcy5fcXVhdGVybmlvbi55KnRoaXMuX3F1YXRlcm5pb24uei10aGlzLl9xdWF0ZXJuaW9uLngqdGhpcy5fcXVhdGVybmlvbi53KSx0aGlzLl9yb3RNYXRyaXgubVsxMF09MS0yKih0aGlzLl9xdWF0ZXJuaW9uLnkqdGhpcy5fcXVhdGVybmlvbi55K3RoaXMuX3F1YXRlcm5pb24ueCp0aGlzLl9xdWF0ZXJuaW9uLngpLHRoaXMuX3JvdE1hdHJpeC5tWzExXT0wLHRoaXMuX3JvdE1hdHJpeC5tWzEyXT0wLHRoaXMuX3JvdE1hdHJpeC5tWzEzXT0wLHRoaXMuX3JvdE1hdHJpeC5tWzE0XT0wLHRoaXMuX3JvdE1hdHJpeC5tWzE1XT0xfSx0LnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7dGhpcy5tZXNoLmRpc3Bvc2UoKSx0aGlzLnZhcnM9bnVsbCx0aGlzLl9wb3NpdGlvbnM9bnVsbCx0aGlzLl9pbmRpY2VzPW51bGwsdGhpcy5fbm9ybWFscz1udWxsLHRoaXMuX3V2cz1udWxsLHRoaXMuX2NvbG9ycz1udWxsLHRoaXMuX3Bvc2l0aW9uczMyPW51bGwsdGhpcy5fbm9ybWFsczMyPW51bGwsdGhpcy5fZml4ZWROb3JtYWwzMj1udWxsLHRoaXMuX3V2czMyPW51bGwsdGhpcy5fY29sb3JzMzI9bnVsbCx0aGlzLnBpY2tlZFBhcnRpY2xlcz1udWxsfSx0LnByb3RvdHlwZS5yZWZyZXNoVmlzaWJsZVNpemU9ZnVuY3Rpb24oKXt0aGlzLl9pc1Zpc2liaWxpdHlCb3hMb2NrZWR8fHRoaXMubWVzaC5yZWZyZXNoQm91bmRpbmdJbmZvKCl9LHQucHJvdG90eXBlLnNldFZpc2liaWxpdHlCb3g9ZnVuY3Rpb24odCl7dmFyIGk9dC8yO3RoaXMubWVzaC5fYm91bmRpbmdJbmZvPW5ldyBlLkJvdW5kaW5nSW5mbyhuZXcgZS5WZWN0b3IzKC1pLC1pLC1pKSxuZXcgZS5WZWN0b3IzKGksaSxpKSl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcImlzQWx3YXlzVmlzaWJsZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fYWx3YXlzVmlzaWJsZX0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX2Fsd2F5c1Zpc2libGU9ZSx0aGlzLm1lc2guYWx3YXlzU2VsZWN0QXNBY3RpdmVNZXNoPWV9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwiaXNWaXNpYmlsaXR5Qm94TG9ja2VkXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9pc1Zpc2liaWxpdHlCb3hMb2NrZWR9LHNldDpmdW5jdGlvbihlKXt0aGlzLl9pc1Zpc2liaWxpdHlCb3hMb2NrZWQ9ZSx0aGlzLm1lc2guZ2V0Qm91bmRpbmdJbmZvKCkuaXNMb2NrZWQ9ZX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJjb21wdXRlUGFydGljbGVSb3RhdGlvblwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fY29tcHV0ZVBhcnRpY2xlUm90YXRpb259LHNldDpmdW5jdGlvbihlKXt0aGlzLl9jb21wdXRlUGFydGljbGVSb3RhdGlvbj1lfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcImNvbXB1dGVQYXJ0aWNsZUNvbG9yXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9jb21wdXRlUGFydGljbGVDb2xvcn0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX2NvbXB1dGVQYXJ0aWNsZUNvbG9yPWV9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwiY29tcHV0ZVBhcnRpY2xlVGV4dHVyZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fY29tcHV0ZVBhcnRpY2xlVGV4dHVyZX0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX2NvbXB1dGVQYXJ0aWNsZVRleHR1cmU9ZX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJjb21wdXRlUGFydGljbGVWZXJ0ZXhcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2NvbXB1dGVQYXJ0aWNsZVZlcnRleH0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX2NvbXB1dGVQYXJ0aWNsZVZlcnRleD1lfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcImNvbXB1dGVCb3VuZGluZ0JveFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fY29tcHV0ZUJvdW5kaW5nQm94fSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fY29tcHV0ZUJvdW5kaW5nQm94PWV9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksdC5wcm90b3R5cGUuaW5pdFBhcnRpY2xlcz1mdW5jdGlvbigpe30sdC5wcm90b3R5cGUucmVjeWNsZVBhcnRpY2xlPWZ1bmN0aW9uKGUpe3JldHVybiBlfSx0LnByb3RvdHlwZS51cGRhdGVQYXJ0aWNsZT1mdW5jdGlvbihlKXtyZXR1cm4gZX0sdC5wcm90b3R5cGUudXBkYXRlUGFydGljbGVWZXJ0ZXg9ZnVuY3Rpb24oZSx0LGkpe3JldHVybiB0fSx0LnByb3RvdHlwZS5iZWZvcmVVcGRhdGVQYXJ0aWNsZXM9ZnVuY3Rpb24oZSx0LGkpe30sdC5wcm90b3R5cGUuYWZ0ZXJVcGRhdGVQYXJ0aWNsZXM9ZnVuY3Rpb24oZSx0LGkpe30sdH0oKTtlLlNvbGlkUGFydGljbGVTeXN0ZW09dH0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ7IWZ1bmN0aW9uKHQpe3ZhciBpPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlLHQsaSxyKXt0aGlzLm5hbWU9ZSx0aGlzLndvcmxkQXhpc0Zvck5vcm1hbD10LHRoaXMud29ybGRBeGlzRm9yRmlsZVg9aSx0aGlzLndvcmxkQXhpc0ZvckZpbGVZPXJ9cmV0dXJuIGV9KCkscj1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoKXt9cmV0dXJuIHQuQ29udmVydEN1YmVNYXBUb1NwaGVyaWNhbFBvbHlub21pYWw9ZnVuY3Rpb24odCl7Zm9yKHZhciBpPW5ldyBlLlNwaGVyaWNhbEhhcm1vbmljcyxyPTAsbj0yL3Quc2l6ZSxvPW4scz0uNSpuLTEsYT0wOzY+YTthKyspZm9yKHZhciBoPXRoaXMuRmlsZUZhY2VzW2FdLGM9dFtoLm5hbWVdLGw9cyx1PTA7dTx0LnNpemU7dSsrKXtmb3IodmFyIGY9cyxkPTA7ZDx0LnNpemU7ZCsrKXt2YXIgcD1oLndvcmxkQXhpc0ZvckZpbGVYLnNjYWxlKGYpLmFkZChoLndvcmxkQXhpc0ZvckZpbGVZLnNjYWxlKGwpKS5hZGQoaC53b3JsZEF4aXNGb3JOb3JtYWwpO3Aubm9ybWFsaXplKCk7dmFyIF8sbT1NYXRoLnBvdygxK2YqZitsKmwsLTEuNSksZz1jW3UqdC5zaXplKjMrMypkKzBdLHY9Y1t1KnQuc2l6ZSozKzMqZCsxXSx5PWNbdSp0LnNpemUqMyszKmQrMl0sXz1uZXcgZS5Db2xvcjMoZyx2LHkpO2kuYWRkTGlnaHQocCxfLG0pLHIrPW0sZis9bn1sKz1vfXZhciB4PTQqTWF0aC5QSSxiPXgvcjtyZXR1cm4gaS5zY2FsZShiKSxpLnNjYWxlKDEvTWF0aC5QSSksZS5TcGhlcmljYWxQb2x5bm9taWFsLmdldFNwaGVyaWNhbFBvbHlub21pYWxGcm9tSGFybW9uaWNzKGkpfSx0LkZpbGVGYWNlcz1bbmV3IGkoXCJyaWdodFwiLG5ldyBlLlZlY3RvcjMoMSwwLDApLG5ldyBlLlZlY3RvcjMoMCwwLC0xKSxuZXcgZS5WZWN0b3IzKDAsLTEsMCkpLG5ldyBpKFwibGVmdFwiLG5ldyBlLlZlY3RvcjMoLTEsMCwwKSxuZXcgZS5WZWN0b3IzKDAsMCwxKSxuZXcgZS5WZWN0b3IzKDAsLTEsMCkpLG5ldyBpKFwidXBcIixuZXcgZS5WZWN0b3IzKDAsMSwwKSxuZXcgZS5WZWN0b3IzKDEsMCwwKSxuZXcgZS5WZWN0b3IzKDAsMCwxKSksbmV3IGkoXCJkb3duXCIsbmV3IGUuVmVjdG9yMygwLC0xLDApLG5ldyBlLlZlY3RvcjMoMSwwLDApLG5ldyBlLlZlY3RvcjMoMCwwLC0xKSksbmV3IGkoXCJmcm9udFwiLG5ldyBlLlZlY3RvcjMoMCwwLDEpLG5ldyBlLlZlY3RvcjMoMSwwLDApLG5ldyBlLlZlY3RvcjMoMCwtMSwwKSksbmV3IGkoXCJiYWNrXCIsbmV3IGUuVmVjdG9yMygwLDAsLTEpLG5ldyBlLlZlY3RvcjMoLTEsMCwwKSxuZXcgZS5WZWN0b3IzKDAsLTEsMCkpXSx0fSgpO3QuQ3ViZU1hcFRvU3BoZXJpY2FsUG9seW5vbWlhbFRvb2xzPXJ9KHQ9ZS5JbnRlcm5hbHN8fChlLkludGVybmFscz17fSkpfShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdDshZnVuY3Rpb24odCl7dmFyIGk9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KCl7fXJldHVybiB0LkNvbnZlcnRQYW5vcmFtYVRvQ3ViZW1hcD1mdW5jdGlvbihlLHQsaSxyKXtpZighZSl0aHJvd1wiQ29udmVydFBhbm9yYW1hVG9DdWJlbWFwOiBpbnB1dCBjYW5ub3QgYmUgbnVsbFwiO2lmKGUubGVuZ3RoIT10KmkqMyl0aHJvd1wiQ29udmVydFBhbm9yYW1hVG9DdWJlbWFwOiBpbnB1dCBzaXplIGlzIHdyb25nXCI7dmFyIG49dGhpcy5DcmVhdGVDdWJlbWFwVGV4dHVyZShyLHRoaXMuRkFDRV9GUk9OVCxlLHQsaSksbz10aGlzLkNyZWF0ZUN1YmVtYXBUZXh0dXJlKHIsdGhpcy5GQUNFX0JBQ0ssZSx0LGkpLHM9dGhpcy5DcmVhdGVDdWJlbWFwVGV4dHVyZShyLHRoaXMuRkFDRV9MRUZULGUsdCxpKSxhPXRoaXMuQ3JlYXRlQ3ViZW1hcFRleHR1cmUocix0aGlzLkZBQ0VfUklHSFQsZSx0LGkpLGg9dGhpcy5DcmVhdGVDdWJlbWFwVGV4dHVyZShyLHRoaXMuRkFDRV9VUCxlLHQsaSksYz10aGlzLkNyZWF0ZUN1YmVtYXBUZXh0dXJlKHIsdGhpcy5GQUNFX0RPV04sZSx0LGkpO3JldHVybntmcm9udDpuLGJhY2s6byxsZWZ0OnMscmlnaHQ6YSx1cDpoLGRvd246YyxzaXplOnJ9fSx0LkNyZWF0ZUN1YmVtYXBUZXh0dXJlPWZ1bmN0aW9uKGUsdCxpLHIsbil7Zm9yKHZhciBvPW5ldyBBcnJheUJ1ZmZlcihlKmUqNCozKSxzPW5ldyBGbG9hdDMyQXJyYXkobyksYT10WzFdLnN1YnRyYWN0KHRbMF0pLnNjYWxlKDEvZSksaD10WzNdLnN1YnRyYWN0KHRbMl0pLnNjYWxlKDEvZSksYz0xL2UsbD0wLHU9MDtlPnU7dSsrKXtmb3IodmFyIGY9dFswXSxkPXRbMl0scD0wO2U+cDtwKyspe3ZhciBfPWQuc3VidHJhY3QoZikuc2NhbGUobCkuYWRkKGYpO18ubm9ybWFsaXplKCk7dmFyIG09dGhpcy5DYWxjUHJvamVjdGlvblNwaGVyaWNhbChfLGkscixuKTtzW3UqZSozKzMqcCswXT1tLnIsc1t1KmUqMyszKnArMV09bS5nLHNbdSplKjMrMypwKzJdPW0uYixmPWYuYWRkKGEpLGQ9ZC5hZGQoaCl9bCs9Y31yZXR1cm4gc30sdC5DYWxjUHJvamVjdGlvblNwaGVyaWNhbD1mdW5jdGlvbihlLHQsaSxyKXtmb3IodmFyIG49TWF0aC5hdGFuMihlLnosZS54KSxvPU1hdGguYWNvcyhlLnkpO248LU1hdGguUEk7KW4rPTIqTWF0aC5QSTtmb3IoO24+TWF0aC5QSTspbi09MipNYXRoLlBJO3ZhciBzPW4vTWF0aC5QSSxhPW8vTWF0aC5QSTtzPS41KnMrLjU7dmFyIGg9TWF0aC5yb3VuZChzKmkpOzA+aD9oPTA6aD49aSYmKGg9aS0xKTt2YXIgYz1NYXRoLnJvdW5kKGEqcik7MD5jP2M9MDpjPj1yJiYoYz1yLTEpO3ZhciBsPXItYy0xLHU9dFtsKmkqMyszKmgrMF0sZj10W2wqaSozKzMqaCsxXSxkPXRbbCppKjMrMypoKzJdO3JldHVybntyOnUsZzpmLGI6ZH19LHQuRkFDRV9GUk9OVD1bbmV3IGUuVmVjdG9yMygtMSwtMSwtMSksbmV3IGUuVmVjdG9yMygxLC0xLC0xKSxuZXcgZS5WZWN0b3IzKC0xLDEsLTEpLG5ldyBlLlZlY3RvcjMoMSwxLC0xKV0sdC5GQUNFX0JBQ0s9W25ldyBlLlZlY3RvcjMoMSwtMSwxKSxuZXcgZS5WZWN0b3IzKC0xLC0xLDEpLG5ldyBlLlZlY3RvcjMoMSwxLDEpLG5ldyBlLlZlY3RvcjMoLTEsMSwxKV0sdC5GQUNFX1JJR0hUPVtuZXcgZS5WZWN0b3IzKDEsLTEsLTEpLG5ldyBlLlZlY3RvcjMoMSwtMSwxKSxuZXcgZS5WZWN0b3IzKDEsMSwtMSksbmV3IGUuVmVjdG9yMygxLDEsMSldLHQuRkFDRV9MRUZUPVtuZXcgZS5WZWN0b3IzKC0xLC0xLDEpLG5ldyBlLlZlY3RvcjMoLTEsLTEsLTEpLG5ldyBlLlZlY3RvcjMoLTEsMSwxKSxuZXcgZS5WZWN0b3IzKC0xLDEsLTEpXSx0LkZBQ0VfRE9XTj1bbmV3IGUuVmVjdG9yMygtMSwxLC0xKSxuZXcgZS5WZWN0b3IzKDEsMSwtMSksbmV3IGUuVmVjdG9yMygtMSwxLDEpLG5ldyBlLlZlY3RvcjMoMSwxLDEpXSx0LkZBQ0VfVVA9W25ldyBlLlZlY3RvcjMoLTEsLTEsMSksbmV3IGUuVmVjdG9yMygxLC0xLDEpLG5ldyBlLlZlY3RvcjMoLTEsLTEsLTEpLG5ldyBlLlZlY3RvcjMoMSwtMSwtMSldLHR9KCk7dC5QYW5vcmFtYVRvQ3ViZU1hcFRvb2xzPWl9KHQ9ZS5JbnRlcm5hbHN8fChlLkludGVybmFscz17fSkpfShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdDshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KCl7fXJldHVybiB0LkxkZXhwPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQ+MTAyMz9lKk1hdGgucG93KDIsMTAyMykqTWF0aC5wb3coMix0LTEwMjMpOi0xMDc0PnQ/ZSpNYXRoLnBvdygyLC0xMDc0KSpNYXRoLnBvdygyLHQrMTA3NCk6ZSpNYXRoLnBvdygyLHQpfSx0LlJnYmUyZmxvYXQ9ZnVuY3Rpb24oZSx0LGkscixuLG8pe24+MD8obj10aGlzLkxkZXhwKDEsbi0xMzYpLGVbbyswXT10Km4sZVtvKzFdPWkqbixlW28rMl09cipuKTooZVtvKzBdPTAsZVtvKzFdPTAsZVtvKzJdPTApfSx0LnJlYWRTdHJpbmdMaW5lPWZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBpPVwiXCIscj1cIlwiLG49dDtuPGUubGVuZ3RoLXQmJihyPVN0cmluZy5mcm9tQ2hhckNvZGUoZVtuXSksXCJcXG5cIiE9cik7bisrKWkrPXI7cmV0dXJuIGl9LHQuUkdCRV9SZWFkSGVhZGVyPWZ1bmN0aW9uKGUpe3ZhciB0PTAsaT0wLHI9dGhpcy5yZWFkU3RyaW5nTGluZShlLDApO2lmKFwiI1wiIT1yWzBdfHxcIj9cIiE9clsxXSl0aHJvd1wiQmFkIEhEUiBGb3JtYXQuXCI7dmFyIG49ITEsbz0hMSxzPTA7ZG8gcys9ci5sZW5ndGgrMSxyPXRoaXMucmVhZFN0cmluZ0xpbmUoZSxzKSxcIkZPUk1BVD0zMi1iaXRfcmxlX3JnYmVcIj09cj9vPSEwOjA9PXIubGVuZ3RoJiYobj0hMCk7d2hpbGUoIW4pO2lmKCFvKXRocm93XCJIRFIgQmFkIGhlYWRlciBmb3JtYXQsIHVuc3VwcG9ydGVkIEZPUk1BVFwiO3MrPXIubGVuZ3RoKzEscj10aGlzLnJlYWRTdHJpbmdMaW5lKGUscyk7dmFyIGE9L15cXC1ZICguKikgXFwrWCAoLiopJC9nLGg9YS5leGVjKHIpO2lmKGgubGVuZ3RoPDMpdGhyb3dcIkhEUiBCYWQgaGVhZGVyIGZvcm1hdCwgbm8gc2l6ZVwiO2lmKGk9cGFyc2VJbnQoaFsyXSksdD1wYXJzZUludChoWzFdKSw4Pml8fGk+MzI3NjcpdGhyb3dcIkhEUiBCYWQgaGVhZGVyIGZvcm1hdCwgdW5zdXBwb3J0ZWQgc2l6ZVwiO3JldHVybiBzKz1yLmxlbmd0aCsxLHtoZWlnaHQ6dCx3aWR0aDppLGRhdGFQb3NpdGlvbjpzfX0sdC5HZXRDdWJlTWFwVGV4dHVyZURhdGE9ZnVuY3Rpb24odCxpKXt2YXIgcj1uZXcgVWludDhBcnJheSh0KSxuPXRoaXMuUkdCRV9SZWFkSGVhZGVyKHIpLG89dGhpcy5SR0JFX1JlYWRQaXhlbHNfUkxFKHIsbikscz1lLlBhbm9yYW1hVG9DdWJlTWFwVG9vbHMuQ29udmVydFBhbm9yYW1hVG9DdWJlbWFwKG8sbi53aWR0aCxuLmhlaWdodCxpKTtyZXR1cm4gc30sdC5SR0JFX1JlYWRQaXhlbHM9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5SR0JFX1JlYWRQaXhlbHNfUkxFKGUsdCl9LHQuUkdCRV9SZWFkUGl4ZWxzX1JMRT1mdW5jdGlvbihlLHQpe2Zvcih2YXIgaSxyLG4sbyxzLGE9dC5oZWlnaHQsaD10LndpZHRoLGM9dC5kYXRhUG9zaXRpb24sbD0wLHU9MCxmPTAsZD1uZXcgQXJyYXlCdWZmZXIoNCpoKSxwPW5ldyBVaW50OEFycmF5KGQpLF89bmV3IEFycmF5QnVmZmVyKHQud2lkdGgqdC5oZWlnaHQqNCozKSxtPW5ldyBGbG9hdDMyQXJyYXkoXyk7YT4wOyl7aWYoaT1lW2MrK10scj1lW2MrK10sbj1lW2MrK10sbz1lW2MrK10sMiE9aXx8MiE9cnx8MTI4Jm4pdGhyb3dcIkhEUiBCYWQgaGVhZGVyIGZvcm1hdCwgbm90IFJMRVwiO2lmKChuPDw4fG8pIT1oKXRocm93XCJIRFIgQmFkIGhlYWRlciBmb3JtYXQsIHdyb25nIHNjYW4gbGluZSB3aWR0aFwiO2ZvcihsPTAsZj0wOzQ+ZjtmKyspZm9yKHU9KGYrMSkqaDt1Pmw7KWlmKGk9ZVtjKytdLHI9ZVtjKytdLGk+MTI4KXtpZihzPWktMTI4LDA9PXN8fHM+dS1sKXRocm93XCJIRFIgQmFkIEZvcm1hdCwgYmFkIHNjYW5saW5lIGRhdGEgKHJ1bilcIjtmb3IoO3MtLSA+MDspcFtsKytdPXJ9ZWxzZXtpZihzPWksMD09c3x8cz51LWwpdGhyb3dcIkhEUiBCYWQgRm9ybWF0LCBiYWQgc2NhbmxpbmUgZGF0YSAobm9uLXJ1bilcIjtpZihwW2wrK109ciwtLXM+MClmb3IodmFyIGc9MDtzPmc7ZysrKXBbbCsrXT1lW2MrK119Zm9yKGY9MDtoPmY7ZisrKWk9cFtmXSxyPXBbZitoXSxuPXBbZisyKmhdLG89cFtmKzMqaF0sdGhpcy5SZ2JlMmZsb2F0KG0saSxyLG4sbywodC5oZWlnaHQtYSkqaCozKzMqZik7YS0tfXJldHVybiBtfSx0fSgpO2UuSERSVG9vbHM9dH0odD1lLkludGVybmFsc3x8KGUuSW50ZXJuYWxzPXt9KSl9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0OyFmdW5jdGlvbih0KXt2YXIgaT1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoKXt0aGlzLm1pbj1uZXcgZS5WZWN0b3IzKDAsMCwwKSx0aGlzLm1heD1uZXcgZS5WZWN0b3IzKDAsMCwwKSx0aGlzLmNsZWFyKCl9cmV0dXJuIHQucHJvdG90eXBlLmNsZWFyPWZ1bmN0aW9uKCl7dGhpcy5taW4ueD10Lk1BWCx0aGlzLm1pbi55PXQuTUFYLHRoaXMubWluLno9dC5NQVgsdGhpcy5tYXgueD10Lk1JTix0aGlzLm1heC55PXQuTUlOLHRoaXMubWF4Lno9dC5NSU59LHQucHJvdG90eXBlLmF1Z21lbnQ9ZnVuY3Rpb24oZSx0LGkpe3RoaXMubWluLng9TWF0aC5taW4odGhpcy5taW4ueCxlKSx0aGlzLm1pbi55PU1hdGgubWluKHRoaXMubWluLnksdCksdGhpcy5taW4uej1NYXRoLm1pbih0aGlzLm1pbi56LGkpLHRoaXMubWF4Lng9TWF0aC5tYXgodGhpcy5tYXgueCxlKSx0aGlzLm1heC55PU1hdGgubWF4KHRoaXMubWF4LnksdCksdGhpcy5tYXguej1NYXRoLm1heCh0aGlzLm1heC56LGkpfSx0LnByb3RvdHlwZS5jbGFtcE1pbj1mdW5jdGlvbihlLHQsaSl7dGhpcy5taW4ueD1NYXRoLm1heCh0aGlzLm1pbi54LGUpLHRoaXMubWluLnk9TWF0aC5tYXgodGhpcy5taW4ueSx0KSx0aGlzLm1pbi56PU1hdGgubWF4KHRoaXMubWluLnosaSl9LHQucHJvdG90eXBlLmNsYW1wTWF4PWZ1bmN0aW9uKGUsdCxpKXt0aGlzLm1heC54PU1hdGgubWluKHRoaXMubWF4LngsZSksdGhpcy5tYXgueT1NYXRoLm1pbih0aGlzLm1heC55LHQpLHRoaXMubWF4Lno9TWF0aC5taW4odGhpcy5tYXgueixpKX0sdC5wcm90b3R5cGUuZW1wdHk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5taW4ueD50aGlzLm1heC55fHx0aGlzLm1pbi55PnRoaXMubWF4Lnl8fHRoaXMubWluLno+dGhpcy5tYXgueX0sdC5NQVg9TnVtYmVyLk1BWF9WQUxVRSx0Lk1JTj1OdW1iZXIuTUlOX1ZBTFVFLHR9KCkscj1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoZSx0LGkscixuLG8scyxhLGgsYyl7dGhpcy5pbnB1dD1lLHRoaXMuaW5wdXRTaXplPXQsdGhpcy5vdXRwdXRTaXplPWksdGhpcy5tYXhOdW1NaXBMZXZlbHM9cix0aGlzLm51bUNoYW5uZWxzPW4sdGhpcy5pc0Zsb2F0PW8sdGhpcy5zcGVjdWxhclBvd2VyPXMsdGhpcy5jb3NpbmVQb3dlckRyb3BQZXJNaXA9YSx0aGlzLmV4Y2x1ZGVCYXNlPWgsdGhpcy5maXh1cD1jLHRoaXMuX291dHB1dFN1cmZhY2U9W10sdGhpcy5fbnVtTWlwTGV2ZWxzPTB9cmV0dXJuIHQucHJvdG90eXBlLmZpbHRlckN1YmVNYXA9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbml0KCksdGhpcy5maWx0ZXJDdWJlTWFwTWlwQ2hhaW4oKSx0aGlzLl9vdXRwdXRTdXJmYWNlfSx0LnByb3RvdHlwZS5pbml0PWZ1bmN0aW9uKCl7dmFyIGUsaSxyO2ZvcigwPT10aGlzLm1heE51bU1pcExldmVscyYmKHRoaXMubWF4TnVtTWlwTGV2ZWxzPXQuQ1BfTUFYX01JUExFVkVMUykscj10aGlzLm91dHB1dFNpemUsaT0wO2k8dGhpcy5tYXhOdW1NaXBMZXZlbHM7aSsrKXtmb3IodGhpcy5fb3V0cHV0U3VyZmFjZS5sZW5ndGgrKyx0aGlzLl9vdXRwdXRTdXJmYWNlW2ldPVtdLGU9MDs2PmU7ZSsrKXRoaXMuX291dHB1dFN1cmZhY2VbaV0ubGVuZ3RoKyssdGhpcy5pc0Zsb2F0P3RoaXMuX291dHB1dFN1cmZhY2VbaV1bZV09bmV3IEZsb2F0MzJBcnJheShyKnIqdGhpcy5udW1DaGFubmVscyk6dGhpcy5fb3V0cHV0U3VyZmFjZVtpXVtlXT1uZXcgVWludDMyQXJyYXkocipyKnRoaXMubnVtQ2hhbm5lbHMpO2lmKHI+Pj0xLHRoaXMuX251bU1pcExldmVscysrLDA9PXIpcmV0dXJuIHZvaWQodGhpcy5tYXhOdW1NaXBMZXZlbHM9aSl9fSx0LnByb3RvdHlwZS5maWx0ZXJDdWJlTWFwTWlwQ2hhaW49ZnVuY3Rpb24oKXt2YXIgZT10aGlzLnNwZWN1bGFyUG93ZXI7dGhpcy5wcmVjb21wdXRlRmlsdGVyTG9va3VwVGFibGVzKHRoaXMuaW5wdXRTaXplKTtmb3IodmFyIHQ9MDt0PHRoaXMuX251bU1pcExldmVsczt0Kyspe3RoaXMuZXhjbHVkZUJhc2UmJjA9PXQmJihlPTFlNSk7dmFyIGk9dGhpcy5pbnB1dCxyPXRoaXMuX291dHB1dFN1cmZhY2VbdF0sbj10aGlzLm91dHB1dFNpemU+PnQsbz10aGlzLmdldEJhc2VGaWx0ZXJBbmdsZShlKTt0aGlzLmZpbHRlckN1YmVTdXJmYWNlcyhpLHRoaXMuaW5wdXRTaXplLHIsbixvLGUpLHRoaXMuZml4dXAmJnRoaXMuZml4dXBDdWJlRWRnZXMocixuKSx0aGlzLmV4Y2x1ZGVCYXNlJiYwPT10JiYoZT10aGlzLnNwZWN1bGFyUG93ZXIpLGUqPXRoaXMuY29zaW5lUG93ZXJEcm9wUGVyTWlwfX0sdC5wcm90b3R5cGUuZ2V0QmFzZUZpbHRlckFuZ2xlPWZ1bmN0aW9uKGUpe3ZhciB0PTFlLTYsaT0xODA7cmV0dXJuIGk9TWF0aC5hY29zKE1hdGgucG93KHQsMS9lKSksaSo9MTgwL01hdGguUEksaSo9Mn0sdC5wcm90b3R5cGUucHJlY29tcHV0ZUZpbHRlckxvb2t1cFRhYmxlcz1mdW5jdGlvbihlKXt0aGlzLl9ub3JtQ3ViZU1hcD1bXSx0aGlzLmJ1aWxkTm9ybWFsaXplclNvbGlkQW5nbGVDdWJlbWFwKGUpfSx0LnByb3RvdHlwZS5idWlsZE5vcm1hbGl6ZXJTb2xpZEFuZ2xlQ3ViZW1hcD1mdW5jdGlvbihlKXt2YXIgdCxpLHI7Zm9yKHQ9MDs2PnQ7dCsrKXt0aGlzLl9ub3JtQ3ViZU1hcC5wdXNoKG5ldyBGbG9hdDMyQXJyYXkoZSplKjQpKTt0aGlzLmlucHV0W3RdO2ZvcihyPTA7ZT5yO3IrKylmb3IoaT0wO2U+aTtpKyspe3ZhciBuPXRoaXMudGV4ZWxDb29yZFRvVmVjdCh0LGkscixlLHRoaXMuZml4dXApO3RoaXMuX25vcm1DdWJlTWFwW3RdWzQqKHIqZStpKSswXT1uLngsdGhpcy5fbm9ybUN1YmVNYXBbdF1bNCoociplK2kpKzFdPW4ueSx0aGlzLl9ub3JtQ3ViZU1hcFt0XVs0KihyKmUraSkrMl09bi56O3ZhciBvPXRoaXMudGV4ZWxDb29yZFNvbGlkQW5nbGUodCxpLHIsZSk7dGhpcy5fbm9ybUN1YmVNYXBbdF1bNCoociplK2kpKzRdPW99fX0sdC5wcm90b3R5cGUudGV4ZWxDb29yZFRvVmVjdD1mdW5jdGlvbihlLGkscixuLG8pe3ZhciBzLGE7aWYocz0yKihpKy41KS9uLTEsYT0yKihyKy41KS9uLTEsbyYmbj4xKXt2YXIgaD1NYXRoLnBvdyhuLDIpL01hdGgucG93KG4tMSwzKTtzPWgqTWF0aC5wb3cocywzKStzLGE9aCpNYXRoLnBvdyhhLDMpK2F9dmFyIGM9dC5fc2dGYWNlMkRNYXBwaW5nW2VdW3QuQ1BfVURJUl07dC5fdmVjdG9yVGVtcC54PWNbMF0qcyx0Ll92ZWN0b3JUZW1wLnk9Y1sxXSpzLHQuX3ZlY3RvclRlbXAuej1jWzJdKnM7dmFyIGw9dC5fc2dGYWNlMkRNYXBwaW5nW2VdW3QuQ1BfVkRJUl07dC5fdmVjdG9yVGVtcC54Kz1sWzBdKmEsdC5fdmVjdG9yVGVtcC55Kz1sWzFdKmEsdC5fdmVjdG9yVGVtcC56Kz1sWzJdKmE7dmFyIHU9dC5fc2dGYWNlMkRNYXBwaW5nW2VdW3QuQ1BfRkFDRUFYSVNdO3JldHVybiB0Ll92ZWN0b3JUZW1wLngrPXVbMF0sdC5fdmVjdG9yVGVtcC55Kz11WzFdLHQuX3ZlY3RvclRlbXAueis9dVsyXSx0Ll92ZWN0b3JUZW1wLm5vcm1hbGl6ZSgpLHQuX3ZlY3RvclRlbXB9LHQucHJvdG90eXBlLnZlY3RUb1RleGVsQ29vcmQ9ZnVuY3Rpb24oZSxpLHIsbil7dmFyIG8scyxhPU1hdGguYWJzKGUpLGg9TWF0aC5hYnMoaSksYz1NYXRoLmFicyhyKTthPj1oJiZhPj1jPyhvPWEscz1lPj0wP3QuQ1BfRkFDRV9YX1BPUzp0LkNQX0ZBQ0VfWF9ORUcpOmg+PWEmJmg+PWM/KG89aCxzPWk+PTA/dC5DUF9GQUNFX1lfUE9TOnQuQ1BfRkFDRV9ZX05FRyk6KG89YyxzPXI+PTA/dC5DUF9GQUNFX1pfUE9TOnQuQ1BfRkFDRV9aX05FRyk7dmFyIGw9MS9vO2UqPWwsaSo9bCxyKj1sO3ZhciB1PXQuX3NnRmFjZTJETWFwcGluZ1tzXVt0LkNQX1VESVJdLGY9dVswXSplK3VbMV0qaSt1WzJdKnI7dT10Ll9zZ0ZhY2UyRE1hcHBpbmdbc11bdC5DUF9WRElSXTt2YXIgZD11WzBdKmUrdVsxXSppK3VbMl0qcixwPU1hdGguZmxvb3IoLjUqKG4tMSkqKGYrMSkpLF89TWF0aC5mbG9vciguNSoobi0xKSooZCsxKSk7cmV0dXJuIHQuX3ZlY3RvclRlbXAueD1zLHQuX3ZlY3RvclRlbXAueT1wLHQuX3ZlY3RvclRlbXAuej1fLHQuX3ZlY3RvclRlbXB9LHQucHJvdG90eXBlLmFyZWFFbGVtZW50PWZ1bmN0aW9uKGUsdCl7cmV0dXJuIE1hdGguYXRhbjIoZSp0LE1hdGguc3FydChlKmUrdCp0KzEpKX0sdC5wcm90b3R5cGUudGV4ZWxDb29yZFNvbGlkQW5nbGU9ZnVuY3Rpb24oZSx0LGkscil7dD0yKih0Ky41KS9yLTEsaT0yKihpKy41KS9yLTE7dmFyIG49MS9yLG89dC1uLHM9aS1uLGE9dCtuLGg9aStuLGM9dGhpcy5hcmVhRWxlbWVudChvLHMpLXRoaXMuYXJlYUVsZW1lbnQobyxoKS10aGlzLmFyZWFFbGVtZW50KGEscykrdGhpcy5hcmVhRWxlbWVudChhLGgpO3JldHVybiBjfSx0LnByb3RvdHlwZS5maWx0ZXJDdWJlU3VyZmFjZXM9ZnVuY3Rpb24oZSx0LHIsbixvLHMpe3ZhciBhLGgsYyxsPVtdO2ZvcihhPTA7Nj5hO2ErKylsLnB1c2gobmV3IGkpO3ZhciB1PTE4MC9NYXRoLlBJKk1hdGguYXRhbjIoMSx0KSxmPW8vMjt1PmYmJihmPXUpLGY+OTAmJihmPTkwKTt2YXIgZD1NYXRoLmNlaWwoZi91KTsxPmQmJihkPTEpO3ZhciBwPU1hdGguY29zKE1hdGguUEkvMTgwKmYpO2ZvcihhPTA7Nj5hO2ErKylmb3IoYz0wO24+YztjKyspZm9yKGg9MDtuPmg7aCsrKXt2YXIgXz10aGlzLnRleGVsQ29vcmRUb1ZlY3QoYSxoLGMsbix0aGlzLmZpeHVwKS5jbG9uZSgpO3RoaXMuY2xlYXJGaWx0ZXJFeHRlbnRzKGwpLHRoaXMuZGV0ZXJtaW5lRmlsdGVyRXh0ZW50cyhfLHQsZCxsKTt2YXIgbT10aGlzLnByb2Nlc3NGaWx0ZXJFeHRlbnRzKF8scCxsLGUsdCxzKTtyW2FdWyhjKm4raCkqdGhpcy5udW1DaGFubmVscyswXT1tLngsclthXVsoYypuK2gpKnRoaXMubnVtQ2hhbm5lbHMrMV09bS55LHJbYV1bKGMqbitoKSp0aGlzLm51bUNoYW5uZWxzKzJdPW0uen19LHQucHJvdG90eXBlLmNsZWFyRmlsdGVyRXh0ZW50cz1mdW5jdGlvbihlKXtmb3IodmFyIHQ9MDs2PnQ7dCsrKWVbdF0uY2xlYXIoKX0sdC5wcm90b3R5cGUuZGV0ZXJtaW5lRmlsdGVyRXh0ZW50cz1mdW5jdGlvbihlLGkscixuKXt2YXIgbyxzLGEsaD1bMCwwLDAsMF0sYz1bMCwwLDAsMF0sbD1bMCwwLDAsMF0sdT10aGlzLnZlY3RUb1RleGVsQ29vcmQoZS54LGUueSxlLnosaSksZj11LngsZD11LnkscD11Lno7bltmXS5hdWdtZW50KGQtcixwLXIsMCksbltmXS5hdWdtZW50KGQrcixwK3IsMCksbltmXS5jbGFtcE1pbigwLDAsMCksbltmXS5jbGFtcE1heChpLTEsaS0xLDApO3ZhciBfPW5bZl0ubWluLngsbT1uW2ZdLm1pbi55LGc9bltmXS5tYXgueCx2PW5bZl0ubWF4Lnk7XG5oWzBdPXItZCxjWzBdPW0sbFswXT12LGhbMV09ZCtyLShpLTEpLGNbMV09bSxsWzFdPXYsaFsyXT1yLXAsY1syXT1fLGxbMl09ZyxoWzNdPXArci0oaS0xKSxjWzNdPV8sbFszXT1nO2Zvcih2YXIgeT0wOzQ+eTt5Kyspe2lmKGhbeV0+MCl7c3dpdGNoKG89dC5fc2dDdWJlTmdoW2ZdW3ldWzBdLHM9dC5fc2dDdWJlTmdoW2ZdW3ldWzFdLHkhPXMmJnkrcyE9M3x8KGNbeV09aS0xLWNbeV0sbFt5XT1pLTEtbFt5XSksdC5fc2dDdWJlTmdoW2ZdW3ldWzFdKXtjYXNlIHQuQ1BfRURHRV9MRUZUOm5bb10uYXVnbWVudCgwLGNbeV0sMCksbltvXS5hdWdtZW50KGhbeV0sbFt5XSwwKTticmVhaztjYXNlIHQuQ1BfRURHRV9SSUdIVDpuW29dLmF1Z21lbnQoaS0xLGNbeV0sMCksbltvXS5hdWdtZW50KGktMS1oW3ldLGxbeV0sMCk7YnJlYWs7Y2FzZSB0LkNQX0VER0VfVE9QOm5bb10uYXVnbWVudChjW3ldLDAsMCksbltvXS5hdWdtZW50KGxbeV0saFt5XSwwKTticmVhaztjYXNlIHQuQ1BfRURHRV9CT1RUT006bltvXS5hdWdtZW50KGNbeV0saS0xLDApLG5bb10uYXVnbWVudChsW3ldLGktMS1oW3ldLDApfW5bb10uY2xhbXBNaW4oMCwwLDApLG5bb10uY2xhbXBNYXgoaS0xLGktMSwwKX1pZihoW3ldPmkpe3N3aXRjaChmKXtjYXNlIHQuQ1BfRkFDRV9YX1BPUzphPXQuQ1BfRkFDRV9YX05FRzticmVhaztjYXNlIHQuQ1BfRkFDRV9YX05FRzphPXQuQ1BfRkFDRV9YX1BPUzticmVhaztjYXNlIHQuQ1BfRkFDRV9ZX1BPUzphPXQuQ1BfRkFDRV9ZX05FRzticmVhaztjYXNlIHQuQ1BfRkFDRV9ZX05FRzphPXQuQ1BfRkFDRV9ZX1BPUzticmVhaztjYXNlIHQuQ1BfRkFDRV9aX1BPUzphPXQuQ1BfRkFDRV9aX05FRzticmVhaztjYXNlIHQuQ1BfRkFDRV9aX05FRzphPXQuQ1BfRkFDRV9aX1BPU31uW2FdLmF1Z21lbnQoMCwwLDApLG5bYV0uYXVnbWVudChpLTEsaS0xLDApfX19LHQucHJvdG90eXBlLnByb2Nlc3NGaWx0ZXJFeHRlbnRzPWZ1bmN0aW9uKGUsaSxyLG4sbyxzKXtmb3IodmFyIGE9WzAsMCwwLDBdLGg9MCxjPTAsbD10aGlzLm51bUNoYW5uZWxzLHU9byxmPTQqdSxkPXUqdGhpcy5udW1DaGFubmVscyxwPTEsXz0wOzY+XztfKyspaWYoIXJbX10uZW1wdHkoKSlmb3IodmFyIG09cltfXS5taW4ueCxnPXJbX10ubWluLnksdj1yW19dLm1heC54LHk9cltfXS5tYXgueSx4PTQqKGcqdSttKSxiPXRoaXMubnVtQ2hhbm5lbHMqKGcqdSttKSxQPWc7eT49UDtQKyspe2Zvcih2YXIgQT0wLFQ9MCxFPW07dj49RTtFKyspe3ZhciBDPXRoaXMuX25vcm1DdWJlTWFwW19dW3grQSswXSxTPXRoaXMuX25vcm1DdWJlTWFwW19dW3grQSsxXSxNPXRoaXMuX25vcm1DdWJlTWFwW19dW3grQSsyXSxJPUMqZS54K1MqZS55K00qZS56O2lmKEk+PWkmJkk+MCl7dmFyIEQ9dGhpcy5fbm9ybUN1YmVNYXBbX11beCtBKzNdO2ZvcihEKj1NYXRoLnBvdyhJLHMrcCksYz0wO2w+YztjKyspYVtjXSs9RCpuW19dW2IrVF0sVCsrO2grPUR9ZWxzZSBUKz1sO0ErPTR9eCs9ZixiKz1kfWlmKDAhPWgpdC5fdmVjdG9yVGVtcC54PWFbMF0vaCx0Ll92ZWN0b3JUZW1wLnk9YVsxXS9oLHQuX3ZlY3RvclRlbXAuej1hWzJdL2gsdGhpcy5udW1DaGFubmVscz4zJiYodC5fdmVjdG9yVGVtcC53PWFbM10vaCk7ZWxzZXt2YXIgUj10aGlzLnZlY3RUb1RleGVsQ29vcmQoZS54LGUueSxlLnosbykuY2xvbmUoKTt0Ll92ZWN0b3JUZW1wLng9bltSLnhdW3RoaXMubnVtQ2hhbm5lbHMqKFIueipvK1IueSkrMF0sdC5fdmVjdG9yVGVtcC55PW5bUi54XVt0aGlzLm51bUNoYW5uZWxzKihSLnoqbytSLnkpKzFdLHQuX3ZlY3RvclRlbXAuej1uW1IueF1bdGhpcy5udW1DaGFubmVscyooUi56Km8rUi55KSsyXSx0aGlzLm51bUNoYW5uZWxzPjMmJih0Ll92ZWN0b3JUZW1wLno9bltSLnhdW3RoaXMubnVtQ2hhbm5lbHMqKFIueipvK1IueSkrM10pfXJldHVybiB0Ll92ZWN0b3JUZW1wfSx0LnByb3RvdHlwZS5maXh1cEN1YmVFZGdlcz1mdW5jdGlvbihlLGkpe3ZhciByLG4sbyxzLGE9MCxoPVswLDAsMCwwLDAsMCwwLDBdLGM9W1tdLFtdLFtdLFtdXSxsPVtbW10sW10sW11dLFtbXSxbXSxbXV0sW1tdLFtdLFtdXSxbW10sW10sW11dLFtbXSxbXSxbXV0sW1tdLFtdLFtdXSxbW10sW10sW11dLFtbXSxbXSxbXV1dO2lmKCEoMT5pKSlpZigxIT1pKXtmb3Iocz0wOzY+cztzKyspZm9yKGNbMF09W3MsMF0sY1sxXT1bcywoaS0xKSp0aGlzLm51bUNoYW5uZWxzXSxjWzJdPVtzLGkqKGktMSkqdGhpcy5udW1DaGFubmVsc10sY1szXT1bcywoaSooaS0xKSsoaS0xKSkqdGhpcy5udW1DaGFubmVsc10sYT0wOzQ+YTthKyspe3ZhciB1PXQuX3NnQ3ViZUNvcm5lckxpc3Rbc11bYV07bFt1XVtoW3VdXT1jW2FdLGhbdV0rK31mb3IoYT0wOzg+YTthKyspZm9yKHI9MDtyPHRoaXMubnVtQ2hhbm5lbHM7cisrKXt2YXIgZj0wO2ZvcihvPTA7Mz5vO28rKylmKz1lW2xbYV1bb11bMF1dW2xbYV1bb11bMV0rcl07Zm9yKGYqPTEvMyxvPTA7Mz5vO28rKyllW2xbYV1bb11bMF1dW2xbYV1bb11bMV0rcl09Zn1mb3Iobz0wOzEyPm87bysrKXt2YXIgZD10Ll9zZ0N1YmVFZGdlTGlzdFtvXVswXSxwPXQuX3NnQ3ViZUVkZ2VMaXN0W29dWzFdLF89dC5fc2dDdWJlTmdoW2RdW3BdWzBdLG09dC5fc2dDdWJlTmdoW2RdW3BdWzFdLGc9MCx2PTAseT0wLHg9MDtzd2l0Y2gocCl7Y2FzZSB0LkNQX0VER0VfTEVGVDp5PXRoaXMubnVtQ2hhbm5lbHMqaTticmVhaztjYXNlIHQuQ1BfRURHRV9SSUdIVDpnKz0oaS0xKSp0aGlzLm51bUNoYW5uZWxzLHk9dGhpcy5udW1DaGFubmVscyppO2JyZWFrO2Nhc2UgdC5DUF9FREdFX1RPUDp5PXRoaXMubnVtQ2hhbm5lbHM7YnJlYWs7Y2FzZSB0LkNQX0VER0VfQk9UVE9NOmcrPWkqKGktMSkqdGhpcy5udW1DaGFubmVscyx5PXRoaXMubnVtQ2hhbm5lbHN9aWYocD09bXx8cCttPT0zKXN3aXRjaChtKXtjYXNlIHQuQ1BfRURHRV9MRUZUOnYrPShpLTEpKmkqdGhpcy5udW1DaGFubmVscyx4PS0odGhpcy5udW1DaGFubmVscyppKTticmVhaztjYXNlIHQuQ1BfRURHRV9SSUdIVDp2Kz0oKGktMSkqaSsoaS0xKSkqdGhpcy5udW1DaGFubmVscyx4PS0odGhpcy5udW1DaGFubmVscyppKTticmVhaztjYXNlIHQuQ1BfRURHRV9UT1A6dis9KGktMSkqdGhpcy5udW1DaGFubmVscyx4PS10aGlzLm51bUNoYW5uZWxzO2JyZWFrO2Nhc2UgdC5DUF9FREdFX0JPVFRPTTp2Kz0oKGktMSkqaSsoaS0xKSkqdGhpcy5udW1DaGFubmVscyx4PS10aGlzLm51bUNoYW5uZWxzfWVsc2Ugc3dpdGNoKG0pe2Nhc2UgdC5DUF9FREdFX0xFRlQ6eD10aGlzLm51bUNoYW5uZWxzKmk7YnJlYWs7Y2FzZSB0LkNQX0VER0VfUklHSFQ6dis9KGktMSkqdGhpcy5udW1DaGFubmVscyx4PXRoaXMubnVtQ2hhbm5lbHMqaTticmVhaztjYXNlIHQuQ1BfRURHRV9UT1A6eD10aGlzLm51bUNoYW5uZWxzO2JyZWFrO2Nhc2UgdC5DUF9FREdFX0JPVFRPTTp2Kz1pKihpLTEpKnRoaXMubnVtQ2hhbm5lbHMseD10aGlzLm51bUNoYW5uZWxzfWZvcihnKz15LHYrPXgsbj0xO2ktMT5uO24rKyl7Zm9yKHI9MDtyPHRoaXMubnVtQ2hhbm5lbHM7cisrKXt2YXIgYj1lW2RdW2crcl0sUD1lW19dW3Yrcl0sQT0uNSooYitQKTtlW2RdW2crcl09QSxlW19dW3Yrcl09QX1nKz15LHYrPXh9fX1lbHNlIGZvcihyPTA7cjx0aGlzLm51bUNoYW5uZWxzO3IrKyl7dmFyIFQ9MDtmb3Iocz0wOzY+cztzKyspVCs9ZVtzXVtyXTtmb3IoVC89NixzPTA7Nj5zO3MrKyllW3NdW3JdPVR9fSx0LkNQX01BWF9NSVBMRVZFTFM9MTYsdC5DUF9VRElSPTAsdC5DUF9WRElSPTEsdC5DUF9GQUNFQVhJUz0yLHQuQ1BfRkFDRV9YX1BPUz0wLHQuQ1BfRkFDRV9YX05FRz0xLHQuQ1BfRkFDRV9ZX1BPUz0yLHQuQ1BfRkFDRV9ZX05FRz0zLHQuQ1BfRkFDRV9aX1BPUz00LHQuQ1BfRkFDRV9aX05FRz01LHQuQ1BfRURHRV9MRUZUPTAsdC5DUF9FREdFX1JJR0hUPTEsdC5DUF9FREdFX1RPUD0yLHQuQ1BfRURHRV9CT1RUT009Myx0LkNQX0NPUk5FUl9OTk49MCx0LkNQX0NPUk5FUl9OTlA9MSx0LkNQX0NPUk5FUl9OUE49Mix0LkNQX0NPUk5FUl9OUFA9Myx0LkNQX0NPUk5FUl9QTk49NCx0LkNQX0NPUk5FUl9QTlA9NSx0LkNQX0NPUk5FUl9QUE49Nix0LkNQX0NPUk5FUl9QUFA9Nyx0Ll92ZWN0b3JUZW1wPW5ldyBlLlZlY3RvcjQoMCwwLDAsMCksdC5fc2dGYWNlMkRNYXBwaW5nPVtbWzAsMCwtMV0sWzAsLTEsMF0sWzEsMCwwXV0sW1swLDAsMV0sWzAsLTEsMF0sWy0xLDAsMF1dLFtbMSwwLDBdLFswLDAsMV0sWzAsMSwwXV0sW1sxLDAsMF0sWzAsMCwtMV0sWzAsLTEsMF1dLFtbMSwwLDBdLFswLC0xLDBdLFswLDAsMV1dLFtbLTEsMCwwXSxbMCwtMSwwXSxbMCwwLC0xXV1dLHQuX3NnQ3ViZU5naD1bW1t0LkNQX0ZBQ0VfWl9QT1MsdC5DUF9FREdFX1JJR0hUXSxbdC5DUF9GQUNFX1pfTkVHLHQuQ1BfRURHRV9MRUZUXSxbdC5DUF9GQUNFX1lfUE9TLHQuQ1BfRURHRV9SSUdIVF0sW3QuQ1BfRkFDRV9ZX05FRyx0LkNQX0VER0VfUklHSFRdXSxbW3QuQ1BfRkFDRV9aX05FRyx0LkNQX0VER0VfUklHSFRdLFt0LkNQX0ZBQ0VfWl9QT1MsdC5DUF9FREdFX0xFRlRdLFt0LkNQX0ZBQ0VfWV9QT1MsdC5DUF9FREdFX0xFRlRdLFt0LkNQX0ZBQ0VfWV9ORUcsdC5DUF9FREdFX0xFRlRdXSxbW3QuQ1BfRkFDRV9YX05FRyx0LkNQX0VER0VfVE9QXSxbdC5DUF9GQUNFX1hfUE9TLHQuQ1BfRURHRV9UT1BdLFt0LkNQX0ZBQ0VfWl9ORUcsdC5DUF9FREdFX1RPUF0sW3QuQ1BfRkFDRV9aX1BPUyx0LkNQX0VER0VfVE9QXV0sW1t0LkNQX0ZBQ0VfWF9ORUcsdC5DUF9FREdFX0JPVFRPTV0sW3QuQ1BfRkFDRV9YX1BPUyx0LkNQX0VER0VfQk9UVE9NXSxbdC5DUF9GQUNFX1pfUE9TLHQuQ1BfRURHRV9CT1RUT01dLFt0LkNQX0ZBQ0VfWl9ORUcsdC5DUF9FREdFX0JPVFRPTV1dLFtbdC5DUF9GQUNFX1hfTkVHLHQuQ1BfRURHRV9SSUdIVF0sW3QuQ1BfRkFDRV9YX1BPUyx0LkNQX0VER0VfTEVGVF0sW3QuQ1BfRkFDRV9ZX1BPUyx0LkNQX0VER0VfQk9UVE9NXSxbdC5DUF9GQUNFX1lfTkVHLHQuQ1BfRURHRV9UT1BdXSxbW3QuQ1BfRkFDRV9YX1BPUyx0LkNQX0VER0VfUklHSFRdLFt0LkNQX0ZBQ0VfWF9ORUcsdC5DUF9FREdFX0xFRlRdLFt0LkNQX0ZBQ0VfWV9QT1MsdC5DUF9FREdFX1RPUF0sW3QuQ1BfRkFDRV9ZX05FRyx0LkNQX0VER0VfQk9UVE9NXV1dLHQuX3NnQ3ViZUVkZ2VMaXN0PVtbdC5DUF9GQUNFX1hfUE9TLHQuQ1BfRURHRV9MRUZUXSxbdC5DUF9GQUNFX1hfUE9TLHQuQ1BfRURHRV9SSUdIVF0sW3QuQ1BfRkFDRV9YX1BPUyx0LkNQX0VER0VfVE9QXSxbdC5DUF9GQUNFX1hfUE9TLHQuQ1BfRURHRV9CT1RUT01dLFt0LkNQX0ZBQ0VfWF9ORUcsdC5DUF9FREdFX0xFRlRdLFt0LkNQX0ZBQ0VfWF9ORUcsdC5DUF9FREdFX1JJR0hUXSxbdC5DUF9GQUNFX1hfTkVHLHQuQ1BfRURHRV9UT1BdLFt0LkNQX0ZBQ0VfWF9ORUcsdC5DUF9FREdFX0JPVFRPTV0sW3QuQ1BfRkFDRV9aX1BPUyx0LkNQX0VER0VfVE9QXSxbdC5DUF9GQUNFX1pfUE9TLHQuQ1BfRURHRV9CT1RUT01dLFt0LkNQX0ZBQ0VfWl9ORUcsdC5DUF9FREdFX1RPUF0sW3QuQ1BfRkFDRV9aX05FRyx0LkNQX0VER0VfQk9UVE9NXV0sdC5fc2dDdWJlQ29ybmVyTGlzdD1bW3QuQ1BfQ09STkVSX1BQUCx0LkNQX0NPUk5FUl9QUE4sdC5DUF9DT1JORVJfUE5QLHQuQ1BfQ09STkVSX1BOTl0sW3QuQ1BfQ09STkVSX05QTix0LkNQX0NPUk5FUl9OUFAsdC5DUF9DT1JORVJfTk5OLHQuQ1BfQ09STkVSX05OUF0sW3QuQ1BfQ09STkVSX05QTix0LkNQX0NPUk5FUl9QUE4sdC5DUF9DT1JORVJfTlBQLHQuQ1BfQ09STkVSX1BQUF0sW3QuQ1BfQ09STkVSX05OUCx0LkNQX0NPUk5FUl9QTlAsdC5DUF9DT1JORVJfTk5OLHQuQ1BfQ09STkVSX1BOTl0sW3QuQ1BfQ09STkVSX05QUCx0LkNQX0NPUk5FUl9QUFAsdC5DUF9DT1JORVJfTk5QLHQuQ1BfQ09STkVSX1BOUF0sW3QuQ1BfQ09STkVSX1BQTix0LkNQX0NPUk5FUl9OUE4sdC5DUF9DT1JORVJfUE5OLHQuQ1BfQ09STkVSX05OTl1dLHR9KCk7dC5QTVJFTUdlbmVyYXRvcj1yfSh0PWUuSW50ZXJuYWxzfHwoZS5JbnRlcm5hbHM9e30pKX0oQkFCWUxPTnx8KEJBQllMT049e30pKTt2YXIgQkFCWUxPTjshZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gaShpLHIsbixvLHMsYSxoKXt2b2lkIDA9PT1vJiYobz0hMSksdm9pZCAwPT09cyYmKHM9ITApLHZvaWQgMD09PWEmJihhPSExKSx2b2lkIDA9PT1oJiYoaD0hMSksdC5jYWxsKHRoaXMsciksdGhpcy5fdXNlSW5HYW1tYVNwYWNlPSExLHRoaXMuX2dlbmVyYXRlSGFybW9uaWNzPSEwLHRoaXMuX2lzQkFCWUxPTlByZXByb2Nlc3NlZD0hMSx0aGlzLmNvb3JkaW5hdGVzTW9kZT1lLlRleHR1cmUuQ1VCSUNfTU9ERSx0aGlzLnNwaGVyaWNhbFBvbHlub21pYWw9bnVsbCx0aGlzLmlzUE1SRU09ITEsaSYmKHRoaXMubmFtZT1pLHRoaXMudXJsPWksdGhpcy5oYXNBbHBoYT0hMSx0aGlzLmlzQ3ViZT0hMCx0aGlzLl90ZXh0dXJlTWF0cml4PWUuTWF0cml4LklkZW50aXR5KCksbj8odGhpcy5faXNCQUJZTE9OUHJlcHJvY2Vzc2VkPSExLHRoaXMuX25vTWlwbWFwPW8sdGhpcy5fc2l6ZT1uLHRoaXMuX3VzZUluR2FtbWFTcGFjZT1hLHRoaXMuX3VzZVBNUkVNR2VuZXJhdG9yPWgmJnIuZ2V0RW5naW5lKCkuZ2V0Q2FwcygpLnRleHR1cmVMT0QmJnRoaXMuZ2V0U2NlbmUoKS5nZXRFbmdpbmUoKS5nZXRDYXBzKCkudGV4dHVyZUZsb2F0JiYhdGhpcy5fdXNlSW5HYW1tYVNwYWNlKToodGhpcy5faXNCQUJZTE9OUHJlcHJvY2Vzc2VkPSEwLHRoaXMuX25vTWlwbWFwPSExLHRoaXMuX3VzZUluR2FtbWFTcGFjZT0hMSx0aGlzLl91c2VQTVJFTUdlbmVyYXRvcj1yLmdldEVuZ2luZSgpLmdldENhcHMoKS50ZXh0dXJlTE9EJiZ0aGlzLmdldFNjZW5lKCkuZ2V0RW5naW5lKCkuZ2V0Q2FwcygpLnRleHR1cmVGbG9hdCYmIXRoaXMuX3VzZUluR2FtbWFTcGFjZSksdGhpcy5pc1BNUkVNPXRoaXMuX3VzZVBNUkVNR2VuZXJhdG9yLHRoaXMuX3RleHR1cmU9dGhpcy5fZ2V0RnJvbUNhY2hlKGksdGhpcy5fbm9NaXBtYXApLHRoaXMuX3RleHR1cmV8fChyLnVzZURlbGF5ZWRUZXh0dXJlTG9hZGluZz90aGlzLmRlbGF5TG9hZFN0YXRlPWUuRW5naW5lLkRFTEFZTE9BRFNUQVRFX05PVExPQURFRDp0aGlzLmxvYWRUZXh0dXJlKCkpKX1yZXR1cm4gX19leHRlbmRzKGksdCksaS5wcm90b3R5cGUubG9hZEJhYnlsb25UZXh0dXJlPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcyxpPTAscj1udWxsLG49IXRoaXMuX3VzZUluR2FtbWFTcGFjZSYmdGhpcy5nZXRTY2VuZSgpLmdldEVuZ2luZSgpLmdldENhcHMoKS50ZXh0dXJlRmxvYXQ/ZnVuY3Rpb24oZSl7Zm9yKHZhciBuPVtdLG89MzAscz0wO2k+cztzKyspe24ucHVzaChbXSk7Zm9yKHZhciBhPTMqTWF0aC5wb3codC5fc2l6ZT4+cywyKSxoPTA7Nj5oO2grKyl7dmFyIGM9ci5zdWJhcnJheShvLG8rYSk7bltzXS5wdXNoKGMpLG8rPWF9fXJldHVybiBufTpudWxsLG89ZnVuY3Rpb24obyl7dmFyIHM9bmV3IEludDMyQXJyYXkobyk7cj1uZXcgRmxvYXQzMkFycmF5KG8pO3NbMF07dC5fc2l6ZT1zWzFdLHQuZ2V0U2NlbmUoKS5nZXRFbmdpbmUoKS51cGRhdGVUZXh0dXJlU2l6ZSh0Ll90ZXh0dXJlLHQuX3NpemUsdC5fc2l6ZSksdC5zcGhlcmljYWxQb2x5bm9taWFsPW5ldyBlLlNwaGVyaWNhbFBvbHlub21pYWwsdC5zcGhlcmljYWxQb2x5bm9taWFsLnguY29weUZyb21GbG9hdHMoclsyXSxyWzNdLHJbNF0pLHQuc3BoZXJpY2FsUG9seW5vbWlhbC55LmNvcHlGcm9tRmxvYXRzKHJbNV0scls2XSxyWzddKSx0LnNwaGVyaWNhbFBvbHlub21pYWwuei5jb3B5RnJvbUZsb2F0cyhyWzhdLHJbOV0sclsxMF0pLHQuc3BoZXJpY2FsUG9seW5vbWlhbC54eC5jb3B5RnJvbUZsb2F0cyhyWzExXSxyWzEyXSxyWzEzXSksdC5zcGhlcmljYWxQb2x5bm9taWFsLnl5LmNvcHlGcm9tRmxvYXRzKHJbMTRdLHJbMTVdLHJbMTZdKSx0LnNwaGVyaWNhbFBvbHlub21pYWwuenouY29weUZyb21GbG9hdHMoclsxN10sclsxOF0sclsxOV0pLHQuc3BoZXJpY2FsUG9seW5vbWlhbC54eS5jb3B5RnJvbUZsb2F0cyhyWzIwXSxyWzIxXSxyWzIyXSksdC5zcGhlcmljYWxQb2x5bm9taWFsLnl6LmNvcHlGcm9tRmxvYXRzKHJbMjNdLHJbMjRdLHJbMjVdKSx0LnNwaGVyaWNhbFBvbHlub21pYWwuenguY29weUZyb21GbG9hdHMoclsyNl0sclsyN10sclsyOF0pLGk9c1syOV07Zm9yKHZhciBhPTMwLGg9W10sYz0zKk1hdGgucG93KHQuX3NpemUsMiksbD0wOzY+bDtsKyspaC5wdXNoKHIuc3ViYXJyYXkoYSxhK2MpKSxhKz1jO2Zvcih2YXIgdT1bXSxmPW51bGwsZD0wOzY+ZDtkKyspe3ZhciBwPW51bGw7aWYobilwPWhbZF07ZWxzZXt2YXIgXz1bMCwyLDQsMSwzLDVdW2RdO2lmKHA9aFtfXSwhdC5nZXRTY2VuZSgpLmdldEVuZ2luZSgpLmdldENhcHMoKS50ZXh0dXJlRmxvYXQpe3ZhciBtPW5ldyBBcnJheUJ1ZmZlcihjKTtmPW5ldyBVaW50OEFycmF5KG0pfWZvcih2YXIgZz0wO2c8dC5fc2l6ZSp0Ll9zaXplO2crKylpZih0Ll91c2VJbkdhbW1hU3BhY2UmJihwWzMqZyswXT1NYXRoLnBvdyhwWzMqZyswXSxlLlRvR2FtbWFTcGFjZSkscFszKmcrMV09TWF0aC5wb3cocFszKmcrMV0sZS5Ub0dhbW1hU3BhY2UpLHBbMypnKzJdPU1hdGgucG93KHBbMypnKzJdLGUuVG9HYW1tYVNwYWNlKSksZil7dmFyIHY9TWF0aC5tYXgoMjU1KnBbMypnKzBdLDApLHk9TWF0aC5tYXgoMjU1KnBbMypnKzFdLDApLHg9TWF0aC5tYXgoMjU1KnBbMypnKzJdLDApLGI9TWF0aC5tYXgoTWF0aC5tYXgodix5KSx4KTtpZihiPjI1NSl7dmFyIFA9MjU1L2I7dio9UCx5Kj1QLHgqPVB9ZlszKmcrMF09dixmWzMqZysxXT15LGZbMypnKzJdPXh9fWY/dS5wdXNoKGYpOnUucHVzaChwKX1yZXR1cm4gdX07dGhpcy5fdGV4dHVyZT10aGlzLmdldFNjZW5lKCkuZ2V0RW5naW5lKCkuY3JlYXRlUmF3Q3ViZVRleHR1cmUodGhpcy51cmwsdGhpcy5nZXRTY2VuZSgpLHRoaXMuX3NpemUsZS5FbmdpbmUuVEVYVFVSRUZPUk1BVF9SR0IsdGhpcy5nZXRTY2VuZSgpLmdldEVuZ2luZSgpLmdldENhcHMoKS50ZXh0dXJlRmxvYXQ/ZS5FbmdpbmUuVEVYVFVSRVRZUEVfRkxPQVQ6ZS5FbmdpbmUuVEVYVFVSRVRZUEVfVU5TSUdORURfSU5ULHRoaXMuX25vTWlwbWFwLG8sbil9LGkucHJvdG90eXBlLmxvYWRIRFJUZXh0dXJlPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcyxyPWZ1bmN0aW9uKHIpe3ZhciBuPWUuSW50ZXJuYWxzLkhEUlRvb2xzLkdldEN1YmVNYXBUZXh0dXJlRGF0YShyLHQuX3NpemUpO3QuX2dlbmVyYXRlSGFybW9uaWNzJiYodC5zcGhlcmljYWxQb2x5bm9taWFsPWUuSW50ZXJuYWxzLkN1YmVNYXBUb1NwaGVyaWNhbFBvbHlub21pYWxUb29scy5Db252ZXJ0Q3ViZU1hcFRvU3BoZXJpY2FsUG9seW5vbWlhbChuKSk7Zm9yKHZhciBvPVtdLHM9bnVsbCxhPTA7Nj5hO2ErKyl7aWYoIXQuZ2V0U2NlbmUoKS5nZXRFbmdpbmUoKS5nZXRDYXBzKCkudGV4dHVyZUZsb2F0KXt2YXIgaD1uZXcgQXJyYXlCdWZmZXIodC5fc2l6ZSp0Ll9zaXplKjMpO3M9bmV3IFVpbnQ4QXJyYXkoaCl9dmFyIGM9bltpLl9mYWNlc01hcHBpbmdbYV1dO2lmKHQuX3VzZUluR2FtbWFTcGFjZXx8cylmb3IodmFyIGw9MDtsPHQuX3NpemUqdC5fc2l6ZTtsKyspaWYodC5fdXNlSW5HYW1tYVNwYWNlJiYoY1szKmwrMF09TWF0aC5wb3coY1szKmwrMF0sZS5Ub0dhbW1hU3BhY2UpLGNbMypsKzFdPU1hdGgucG93KGNbMypsKzFdLGUuVG9HYW1tYVNwYWNlKSxjWzMqbCsyXT1NYXRoLnBvdyhjWzMqbCsyXSxlLlRvR2FtbWFTcGFjZSkpLHMpe3ZhciB1PU1hdGgubWF4KDI1NSpjWzMqbCswXSwwKSxmPU1hdGgubWF4KDI1NSpjWzMqbCsxXSwwKSxkPU1hdGgubWF4KDI1NSpjWzMqbCsyXSwwKSxwPU1hdGgubWF4KE1hdGgubWF4KHUsZiksZCk7aWYocD4yNTUpe3ZhciBfPTI1NS9wO3UqPV8sZio9XyxkKj1ffXNbMypsKzBdPXUsc1szKmwrMV09ZixzWzMqbCsyXT1kfXM/by5wdXNoKHMpOm8ucHVzaChjKX1yZXR1cm4gb30sbj1udWxsOyF0aGlzLl9ub01pcG1hcCYmdGhpcy5fdXNlUE1SRU1HZW5lcmF0b3ImJihuPWZ1bmN0aW9uKGkpe3ZhciByPW5ldyBlLkludGVybmFscy5QTVJFTUdlbmVyYXRvcihpLHQuX3NpemUsdC5fc2l6ZSwwLDMsdC5nZXRTY2VuZSgpLmdldEVuZ2luZSgpLmdldENhcHMoKS50ZXh0dXJlRmxvYXQsMjA0OCwuMjUsITEsITApO3JldHVybiByLmZpbHRlckN1YmVNYXAoKX0pLHRoaXMuX3RleHR1cmU9dGhpcy5nZXRTY2VuZSgpLmdldEVuZ2luZSgpLmNyZWF0ZVJhd0N1YmVUZXh0dXJlKHRoaXMudXJsLHRoaXMuZ2V0U2NlbmUoKSx0aGlzLl9zaXplLGUuRW5naW5lLlRFWFRVUkVGT1JNQVRfUkdCLHRoaXMuZ2V0U2NlbmUoKS5nZXRFbmdpbmUoKS5nZXRDYXBzKCkudGV4dHVyZUZsb2F0P2UuRW5naW5lLlRFWFRVUkVUWVBFX0ZMT0FUOmUuRW5naW5lLlRFWFRVUkVUWVBFX1VOU0lHTkVEX0lOVCx0aGlzLl9ub01pcG1hcCxyLG4pfSxpLnByb3RvdHlwZS5sb2FkVGV4dHVyZT1mdW5jdGlvbigpe3RoaXMuX2lzQkFCWUxPTlByZXByb2Nlc3NlZD90aGlzLmxvYWRCYWJ5bG9uVGV4dHVyZSgpOnRoaXMubG9hZEhEUlRleHR1cmUoKX0saS5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oKXt2YXIgZT10aGlzLl9pc0JBQllMT05QcmVwcm9jZXNzZWQ/bnVsbDp0aGlzLl9zaXplLHQ9bmV3IGkodGhpcy51cmwsdGhpcy5nZXRTY2VuZSgpLGUsdGhpcy5fbm9NaXBtYXAsdGhpcy5fZ2VuZXJhdGVIYXJtb25pY3MsdGhpcy5fdXNlSW5HYW1tYVNwYWNlLHRoaXMuX3VzZVBNUkVNR2VuZXJhdG9yKTtyZXR1cm4gdC5sZXZlbD10aGlzLmxldmVsLHQud3JhcFU9dGhpcy53cmFwVSx0LndyYXBWPXRoaXMud3JhcFYsdC5jb29yZGluYXRlc0luZGV4PXRoaXMuY29vcmRpbmF0ZXNJbmRleCx0LmNvb3JkaW5hdGVzTW9kZT10aGlzLmNvb3JkaW5hdGVzTW9kZSx0fSxpLnByb3RvdHlwZS5kZWxheUxvYWQ9ZnVuY3Rpb24oKXt0aGlzLmRlbGF5TG9hZFN0YXRlPT09ZS5FbmdpbmUuREVMQVlMT0FEU1RBVEVfTk9UTE9BREVEJiYodGhpcy5kZWxheUxvYWRTdGF0ZT1lLkVuZ2luZS5ERUxBWUxPQURTVEFURV9MT0FERUQsdGhpcy5fdGV4dHVyZT10aGlzLl9nZXRGcm9tQ2FjaGUodGhpcy51cmwsdGhpcy5fbm9NaXBtYXApLHRoaXMuX3RleHR1cmV8fHRoaXMubG9hZFRleHR1cmUoKSl9LGkucHJvdG90eXBlLmdldFJlZmxlY3Rpb25UZXh0dXJlTWF0cml4PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3RleHR1cmVNYXRyaXh9LGkuUGFyc2U9ZnVuY3Rpb24odCxpLHIpe3ZhciBuPW51bGw7aWYodC5uYW1lJiYhdC5pc1JlbmRlclRhcmdldCl7dmFyIG89dC5pc0JBQllMT05QcmVwcm9jZXNzZWQ/bnVsbDp0LnNpemU7bj1uZXcgZS5IRFJDdWJlVGV4dHVyZShyK3QubmFtZSxpLG8sbi5nZW5lcmF0ZUhhcm1vbmljcyxuLnVzZUluR2FtbWFTcGFjZSxuLnVzZVBNUkVNR2VuZXJhdG9yKSxuLm5hbWU9dC5uYW1lLG4uaGFzQWxwaGE9dC5oYXNBbHBoYSxuLmxldmVsPXQubGV2ZWwsbi5jb29yZGluYXRlc01vZGU9dC5jb29yZGluYXRlc01vZGV9cmV0dXJuIG59LGkucHJvdG90eXBlLnNlcmlhbGl6ZT1mdW5jdGlvbigpe2lmKCF0aGlzLm5hbWUpcmV0dXJuIG51bGw7dmFyIGU9e307cmV0dXJuIGUubmFtZT10aGlzLm5hbWUsZS5oYXNBbHBoYT10aGlzLmhhc0FscGhhLGUuaXNDdWJlPSEwLGUubGV2ZWw9dGhpcy5sZXZlbCxlLnNpemU9dGhpcy5fc2l6ZSxlLmNvb3JkaW5hdGVzTW9kZT10aGlzLmNvb3JkaW5hdGVzTW9kZSxlLnVzZUluR2FtbWFTcGFjZT10aGlzLl91c2VJbkdhbW1hU3BhY2UsZS5nZW5lcmF0ZUhhcm1vbmljcz10aGlzLl9nZW5lcmF0ZUhhcm1vbmljcyxlLnVzZVBNUkVNR2VuZXJhdG9yPXRoaXMuX3VzZVBNUkVNR2VuZXJhdG9yLGUuaXNCQUJZTE9OUHJlcHJvY2Vzc2VkPXRoaXMuX2lzQkFCWUxPTlByZXByb2Nlc3NlZCxlfSxpLmdlbmVyYXRlQmFieWxvbkhEUk9uRGlzaz1mdW5jdGlvbihlLHQscil7dm9pZCAwPT09ciYmKHI9bnVsbCk7dmFyIG49ZnVuY3Rpb24oZSl7dmFyIHQ9bmV3IEJsb2IoW2VdLHt0eXBlOlwiYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtXCJ9KSxpPXdpbmRvdy5VUkwuY3JlYXRlT2JqZWN0VVJMKHQpLHI9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImFcIik7ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChyKSxyLnN0eWxlLmRpc3BsYXk9XCJub25lXCIsci5ocmVmPWksci5kb3dubG9hZD1cImVudm1hcC5iYWJ5bG9uLmhkclwiLHIuY2xpY2soKX07aS5nZW5lcmF0ZUJhYnlsb25IRFIoZSx0LG4scil9LGkuZ2VuZXJhdGVCYWJ5bG9uSERSPWZ1bmN0aW9uKHQsaSxyLG4pe2lmKHZvaWQgMD09PW4mJihuPW51bGwpLCF0KXJldHVybiBudWxsO2lmKCFlLlRvb2xzLklzRXhwb25lbnRPZlR3byhpKSlyZXR1cm4gbnVsbDt2YXIgbz1mdW5jdGlvbih0KXt2YXIgbj1lLkludGVybmFscy5IRFJUb29scy5HZXRDdWJlTWFwVGV4dHVyZURhdGEodCxpKSxvPWUuSW50ZXJuYWxzLkN1YmVNYXBUb1NwaGVyaWNhbFBvbHlub21pYWxUb29scy5Db252ZXJ0Q3ViZU1hcFRvU3BoZXJpY2FsUG9seW5vbWlhbChuKSxzPVtdO3MucHVzaChuLnJpZ2h0KSxzLnB1c2gobi5sZWZ0KSxzLnB1c2gobi51cCkscy5wdXNoKG4uZG93bikscy5wdXNoKG4uZnJvbnQpLHMucHVzaChuLmJhY2spO3ZhciBhPW5ldyBlLkludGVybmFscy5QTVJFTUdlbmVyYXRvcihzLGksaSwwLDMsITAsMjA0OCwuMjUsITEsITApLGg9YS5maWx0ZXJDdWJlTWFwKCksYz00O2MrPTQsYys9MTA4LGMrPTQ7Zm9yKHZhciBsPTA7bDxoLmxlbmd0aDtsKyspe3ZhciB1PWk+Pmw7Yys9Nip1KnUqMyo0fXZhciBmPW5ldyBBcnJheUJ1ZmZlcihjKSxkPW5ldyBJbnQzMkFycmF5KGYpLHA9bmV3IEZsb2F0MzJBcnJheShmKTtkWzBdPTEsZFsxXT1pLG8ueC50b0FycmF5KHAsMiksby55LnRvQXJyYXkocCw1KSxvLnoudG9BcnJheShwLDgpLG8ueHgudG9BcnJheShwLDExKSxvLnl5LnRvQXJyYXkocCwxNCksby56ei50b0FycmF5KHAsMTcpLG8ueHkudG9BcnJheShwLDIwKSxvLnl6LnRvQXJyYXkocCwyMyksby56eC50b0FycmF5KHAsMjYpLGRbMjldPWgubGVuZ3RoO2Zvcih2YXIgXz0zMCxsPTA7bDxoLmxlbmd0aDtsKyspZm9yKHZhciBtPTMqTWF0aC5wb3coaT4+bCwyKSxnPTA7Nj5nO2crKylwLnNldChoW2xdW2ddLF8pLF8rPW07cihmKX07ZS5Ub29scy5Mb2FkRmlsZSh0LGZ1bmN0aW9uKGUpe28oZSl9LG51bGwsbnVsbCwhMCxuKX0saS5fZmFjZXNNYXBwaW5nPVtcInJpZ2h0XCIsXCJ1cFwiLFwiZnJvbnRcIixcImxlZnRcIixcImRvd25cIixcImJhY2tcIl0saX0oZS5CYXNlVGV4dHVyZSk7ZS5IRFJDdWJlVGV4dHVyZT10fShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdDshZnVuY3Rpb24odCl7dmFyIGk9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQsaSxyLG4sbyl7dm9pZCAwPT09biYmKG49ITApLHZvaWQgMD09PW8mJihvPTEpLHRoaXMuc2tlbGV0b249dCx0aGlzLm1lc2g9aSx0aGlzLmF1dG9VcGRhdGVCb25lc01hdHJpY2VzPW4sdGhpcy5yZW5kZXJpbmdHcm91cElkPW8sdGhpcy5jb2xvcj1lLkNvbG9yMy5XaGl0ZSgpLHRoaXMuX2RlYnVnTGluZXM9W10sdGhpcy5faXNFbmFibGVkPSExLHRoaXMuX3NjZW5lPXIsdGhpcy51cGRhdGUoKSx0aGlzLl9yZW5kZXJGdW5jdGlvbj10aGlzLnVwZGF0ZS5iaW5kKHRoaXMpfXJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJpc0VuYWJsZWRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lzRW5hYmxlZH0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX2lzRW5hYmxlZCE9PWUmJih0aGlzLl9pc0VuYWJsZWQ9ZSxlP3RoaXMuX3NjZW5lLnJlZ2lzdGVyQmVmb3JlUmVuZGVyKHRoaXMuX3JlbmRlckZ1bmN0aW9uKTp0aGlzLl9zY2VuZS51bnJlZ2lzdGVyQmVmb3JlUmVuZGVyKHRoaXMuX3JlbmRlckZ1bmN0aW9uKSl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksdC5wcm90b3R5cGUuX2dldEJvbmVQb3NpdGlvbj1mdW5jdGlvbih0LGkscixuLG8scyl7dm9pZCAwPT09biYmKG49MCksdm9pZCAwPT09byYmKG89MCksdm9pZCAwPT09cyYmKHM9MCk7dmFyIGE9ZS5UbXAuTWF0cml4WzBdLGg9aS5nZXRQYXJlbnQoKTtpZihhLmNvcHlGcm9tKGkuZ2V0TG9jYWxNYXRyaXgoKSksMCE9PW58fDAhPT1vfHwwIT09cyl7dmFyIGM9ZS5UbXAuTWF0cml4WzFdO2UuTWF0cml4LklkZW50aXR5VG9SZWYoYyksYy5tWzEyXT1uLGMubVsxM109byxjLm1bMTRdPXMsYy5tdWx0aXBseVRvUmVmKGEsYSl9aCYmYS5tdWx0aXBseVRvUmVmKGguZ2V0QWJzb2x1dGVUcmFuc2Zvcm0oKSxhKSxhLm11bHRpcGx5VG9SZWYocixhKSx0Lng9YS5tWzEyXSx0Lnk9YS5tWzEzXSx0Lno9YS5tWzE0XX0sdC5wcm90b3R5cGUuX2dldExpbmVzRm9yQm9uZXNXaXRoTGVuZ3RoPWZ1bmN0aW9uKHQsaSl7Zm9yKHZhciByPXQubGVuZ3RoLG49MDtyPm47bisrKXt2YXIgbz10W25dLHM9dGhpcy5fZGVidWdMaW5lc1tuXTtzfHwocz1bZS5WZWN0b3IzLlplcm8oKSxlLlZlY3RvcjMuWmVybygpXSx0aGlzLl9kZWJ1Z0xpbmVzW25dPXMpLHRoaXMuX2dldEJvbmVQb3NpdGlvbihzWzBdLG8saSksdGhpcy5fZ2V0Qm9uZVBvc2l0aW9uKHNbMV0sbyxpLDAsby5sZW5ndGgsMCl9fSx0LnByb3RvdHlwZS5fZ2V0TGluZXNGb3JCb25lc05vTGVuZ3RoPWZ1bmN0aW9uKHQsaSl7Zm9yKHZhciByPXQubGVuZ3RoLG49MCxvPXItMTtvPj0wO28tLSl7dmFyIHM9dFtvXSxhPXMuZ2V0UGFyZW50KCk7aWYoYSl7dmFyIGg9dGhpcy5fZGVidWdMaW5lc1tuXTtofHwoaD1bZS5WZWN0b3IzLlplcm8oKSxlLlZlY3RvcjMuWmVybygpXSx0aGlzLl9kZWJ1Z0xpbmVzW25dPWgpLHRoaXMuX2dldEJvbmVQb3NpdGlvbihoWzBdLHMsaSksdGhpcy5fZ2V0Qm9uZVBvc2l0aW9uKGhbMV0sYSxpKSxuKyt9fX0sdC5wcm90b3R5cGUudXBkYXRlPWZ1bmN0aW9uKCl7dGhpcy5hdXRvVXBkYXRlQm9uZXNNYXRyaWNlcyYmdGhpcy5fdXBkYXRlQm9uZU1hdHJpeCh0aGlzLnNrZWxldG9uLmJvbmVzWzBdKSx2b2lkIDA9PT10aGlzLnNrZWxldG9uLmJvbmVzWzBdLmxlbmd0aD90aGlzLl9nZXRMaW5lc0ZvckJvbmVzTm9MZW5ndGgodGhpcy5za2VsZXRvbi5ib25lcyx0aGlzLm1lc2guZ2V0V29ybGRNYXRyaXgoKSk6dGhpcy5fZ2V0TGluZXNGb3JCb25lc1dpdGhMZW5ndGgodGhpcy5za2VsZXRvbi5ib25lcyx0aGlzLm1lc2guZ2V0V29ybGRNYXRyaXgoKSksdGhpcy5fZGVidWdNZXNoP2UuTWVzaEJ1aWxkZXIuQ3JlYXRlTGluZVN5c3RlbShudWxsLHtsaW5lczp0aGlzLl9kZWJ1Z0xpbmVzLHVwZGF0YWJsZTohMCxpbnN0YW5jZTp0aGlzLl9kZWJ1Z01lc2h9LHRoaXMuX3NjZW5lKToodGhpcy5fZGVidWdNZXNoPWUuTWVzaEJ1aWxkZXIuQ3JlYXRlTGluZVN5c3RlbShudWxsLHtsaW5lczp0aGlzLl9kZWJ1Z0xpbmVzLHVwZGF0YWJsZTohMH0sdGhpcy5fc2NlbmUpLHRoaXMuX2RlYnVnTWVzaC5yZW5kZXJpbmdHcm91cElkPXRoaXMucmVuZGVyaW5nR3JvdXBJZCksdGhpcy5fZGVidWdNZXNoLmNvbG9yPXRoaXMuY29sb3J9LHQucHJvdG90eXBlLl91cGRhdGVCb25lTWF0cml4PWZ1bmN0aW9uKGUpe2UuZ2V0UGFyZW50KCkmJmUuZ2V0TG9jYWxNYXRyaXgoKS5tdWx0aXBseVRvUmVmKGUuZ2V0UGFyZW50KCkuZ2V0QWJzb2x1dGVUcmFuc2Zvcm0oKSxlLmdldEFic29sdXRlVHJhbnNmb3JtKCkpO2Zvcih2YXIgdD1lLmNoaWxkcmVuLGk9dC5sZW5ndGgscj0wO2k+cjtyKyspdGhpcy5fdXBkYXRlQm9uZU1hdHJpeCh0W3JdKX0sdC5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3RoaXMuX2RlYnVnTWVzaCYmKHRoaXMuaXNFbmFibGVkPSExLHRoaXMuX2RlYnVnTWVzaC5kaXNwb3NlKCksdGhpcy5fZGVidWdNZXNoPW51bGwpfSx0fSgpO3QuU2tlbGV0b25WaWV3ZXI9aX0odD1lLkRlYnVnfHwoZS5EZWJ1Zz17fSkpfShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoKXt0aGlzLl9kaXJ0eT0hMCx0aGlzLl90ZW1wQ29sb3I9bmV3IGUuQ29sb3I0KDAsMCwwLDApLHRoaXMuX2dsb2JhbEN1cnZlPW5ldyBlLkNvbG9yNCgwLDAsMCwwKSx0aGlzLl9oaWdobGlnaHRzQ3VydmU9bmV3IGUuQ29sb3I0KDAsMCwwLDApLHRoaXMuX21pZHRvbmVzQ3VydmU9bmV3IGUuQ29sb3I0KDAsMCwwLDApLHRoaXMuX3NoYWRvd3NDdXJ2ZT1uZXcgZS5Db2xvcjQoMCwwLDAsMCksdGhpcy5fcG9zaXRpdmVDdXJ2ZT1uZXcgZS5Db2xvcjQoMCwwLDAsMCksdGhpcy5fbmVnYXRpdmVDdXJ2ZT1uZXcgZS5Db2xvcjQoMCwwLDAsMCksdGhpcy5fZ2xvYmFsSHVlPTMwLHRoaXMuX2dsb2JhbERlbnNpdHk9MCx0aGlzLl9nbG9iYWxTYXR1cmF0aW9uPTAsdGhpcy5fZ2xvYmFsRXhwb3N1cmU9MCx0aGlzLl9oaWdobGlnaHRzSHVlPTMwLHRoaXMuX2hpZ2hsaWdodHNEZW5zaXR5PTAsdGhpcy5faGlnaGxpZ2h0c1NhdHVyYXRpb249MCx0aGlzLl9oaWdobGlnaHRzRXhwb3N1cmU9MCx0aGlzLl9taWR0b25lc0h1ZT0zMCx0aGlzLl9taWR0b25lc0RlbnNpdHk9MCx0aGlzLl9taWR0b25lc1NhdHVyYXRpb249MCx0aGlzLl9taWR0b25lc0V4cG9zdXJlPTAsdGhpcy5fc2hhZG93c0h1ZT0zMCx0aGlzLl9zaGFkb3dzRGVuc2l0eT0wLHRoaXMuX3NoYWRvd3NTYXR1cmF0aW9uPTAsdGhpcy5fc2hhZG93c0V4cG9zdXJlPTB9cmV0dXJuIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcIkdsb2JhbEh1ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZ2xvYmFsSHVlfSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fZ2xvYmFsSHVlPWUsdGhpcy5fZGlydHk9ITB9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwiR2xvYmFsRGVuc2l0eVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZ2xvYmFsRGVuc2l0eX0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX2dsb2JhbERlbnNpdHk9ZSx0aGlzLl9kaXJ0eT0hMH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJHbG9iYWxTYXR1cmF0aW9uXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9nbG9iYWxTYXR1cmF0aW9ufSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fZ2xvYmFsU2F0dXJhdGlvbj1lLHRoaXMuX2RpcnR5PSEwfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcIkhpZ2hsaWdodHNIdWVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2hpZ2hsaWdodHNIdWV9LHNldDpmdW5jdGlvbihlKXt0aGlzLl9oaWdobGlnaHRzSHVlPWUsdGhpcy5fZGlydHk9ITB9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwiSGlnaGxpZ2h0c0RlbnNpdHlcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2hpZ2hsaWdodHNEZW5zaXR5fSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5faGlnaGxpZ2h0c0RlbnNpdHk9ZSx0aGlzLl9kaXJ0eT0hMH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJIaWdobGlnaHRzU2F0dXJhdGlvblwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faGlnaGxpZ2h0c1NhdHVyYXRpb259LHNldDpmdW5jdGlvbihlKXt0aGlzLl9oaWdobGlnaHRzU2F0dXJhdGlvbj1lLHRoaXMuX2RpcnR5PSEwfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcIkhpZ2hsaWdodHNFeHBvc3VyZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faGlnaGxpZ2h0c0V4cG9zdXJlfSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5faGlnaGxpZ2h0c0V4cG9zdXJlPWUsdGhpcy5fZGlydHk9ITB9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwiTWlkdG9uZXNIdWVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX21pZHRvbmVzSHVlfSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fbWlkdG9uZXNIdWU9ZSx0aGlzLl9kaXJ0eT0hMH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJNaWR0b25lc0RlbnNpdHlcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX21pZHRvbmVzRGVuc2l0eX0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX21pZHRvbmVzRGVuc2l0eT1lLHRoaXMuX2RpcnR5PSEwfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcIk1pZHRvbmVzU2F0dXJhdGlvblwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fbWlkdG9uZXNTYXR1cmF0aW9ufSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fbWlkdG9uZXNTYXR1cmF0aW9uPWUsdGhpcy5fZGlydHk9ITB9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwiTWlkdG9uZXNFeHBvc3VyZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fbWlkdG9uZXNFeHBvc3VyZX0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX21pZHRvbmVzRXhwb3N1cmU9ZSx0aGlzLl9kaXJ0eT0hMH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJTaGFkb3dzSHVlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9zaGFkb3dzSHVlfSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fc2hhZG93c0h1ZT1lLHRoaXMuX2RpcnR5PSEwfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcIlNoYWRvd3NEZW5zaXR5XCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9zaGFkb3dzRGVuc2l0eX0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX3NoYWRvd3NEZW5zaXR5PWUsdGhpcy5fZGlydHk9ITB9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwiU2hhZG93c1NhdHVyYXRpb25cIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3NoYWRvd3NTYXR1cmF0aW9ufSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5fc2hhZG93c1NhdHVyYXRpb249ZSx0aGlzLl9kaXJ0eT0hMH0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJTaGFkb3dzRXhwb3N1cmVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3NoYWRvd3NFeHBvc3VyZX0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX3NoYWRvd3NFeHBvc3VyZT1lLHRoaXMuX2RpcnR5PSEwfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLHQuQmluZD1mdW5jdGlvbihlLHQpe2UuX2RpcnR5JiYoZS5fZGlydHk9ITEsZS5nZXRDb2xvckdyYWRpbmdEYXRhVG9SZWYoZS5fZ2xvYmFsSHVlLGUuX2dsb2JhbERlbnNpdHksZS5fZ2xvYmFsU2F0dXJhdGlvbixlLl9nbG9iYWxFeHBvc3VyZSxlLl9nbG9iYWxDdXJ2ZSksZS5nZXRDb2xvckdyYWRpbmdEYXRhVG9SZWYoZS5faGlnaGxpZ2h0c0h1ZSxlLl9oaWdobGlnaHRzRGVuc2l0eSxlLl9oaWdobGlnaHRzU2F0dXJhdGlvbixlLl9oaWdobGlnaHRzRXhwb3N1cmUsZS5fdGVtcENvbG9yKSxlLl90ZW1wQ29sb3IubXVsdGlwbHlUb1JlZihlLl9nbG9iYWxDdXJ2ZSxlLl9oaWdobGlnaHRzQ3VydmUpLGUuZ2V0Q29sb3JHcmFkaW5nRGF0YVRvUmVmKGUuX21pZHRvbmVzSHVlLGUuX21pZHRvbmVzRGVuc2l0eSxlLl9taWR0b25lc1NhdHVyYXRpb24sZS5fbWlkdG9uZXNFeHBvc3VyZSxlLl90ZW1wQ29sb3IpLGUuX3RlbXBDb2xvci5tdWx0aXBseVRvUmVmKGUuX2dsb2JhbEN1cnZlLGUuX21pZHRvbmVzQ3VydmUpLGUuZ2V0Q29sb3JHcmFkaW5nRGF0YVRvUmVmKGUuX3NoYWRvd3NIdWUsZS5fc2hhZG93c0RlbnNpdHksZS5fc2hhZG93c1NhdHVyYXRpb24sZS5fc2hhZG93c0V4cG9zdXJlLGUuX3RlbXBDb2xvciksZS5fdGVtcENvbG9yLm11bHRpcGx5VG9SZWYoZS5fZ2xvYmFsQ3VydmUsZS5fc2hhZG93c0N1cnZlKSxlLl9oaWdobGlnaHRzQ3VydmUuc3VidHJhY3RUb1JlZihlLl9taWR0b25lc0N1cnZlLGUuX3Bvc2l0aXZlQ3VydmUpLGUuX21pZHRvbmVzQ3VydmUuc3VidHJhY3RUb1JlZihlLl9zaGFkb3dzQ3VydmUsZS5fbmVnYXRpdmVDdXJ2ZSkpLHQuc2V0RmxvYXQ0KFwidkNhbWVyYUNvbG9yQ3VydmVQb3NpdGl2ZVwiLGUuX3Bvc2l0aXZlQ3VydmUucixlLl9wb3NpdGl2ZUN1cnZlLmcsZS5fcG9zaXRpdmVDdXJ2ZS5iLGUuX3Bvc2l0aXZlQ3VydmUuYSksdC5zZXRGbG9hdDQoXCJ2Q2FtZXJhQ29sb3JDdXJ2ZU5ldXRyYWxcIixlLl9taWR0b25lc0N1cnZlLnIsZS5fbWlkdG9uZXNDdXJ2ZS5nLGUuX21pZHRvbmVzQ3VydmUuYixlLl9taWR0b25lc0N1cnZlLmEpLHQuc2V0RmxvYXQ0KFwidkNhbWVyYUNvbG9yQ3VydmVOZWdhdGl2ZVwiLGUuX25lZ2F0aXZlQ3VydmUucixlLl9uZWdhdGl2ZUN1cnZlLmcsZS5fbmVnYXRpdmVDdXJ2ZS5iLGUuX25lZ2F0aXZlQ3VydmUuYSl9LHQuUHJlcGFyZVVuaWZvcm1zPWZ1bmN0aW9uKGUpe2UucHVzaChcInZDYW1lcmFDb2xvckN1cnZlTmV1dHJhbFwiLFwidkNhbWVyYUNvbG9yQ3VydmVQb3NpdGl2ZVwiLFwidkNhbWVyYUNvbG9yQ3VydmVOZWdhdGl2ZVwiKX0sdC5wcm90b3R5cGUuZ2V0Q29sb3JHcmFkaW5nRGF0YVRvUmVmPWZ1bmN0aW9uKGUsaSxyLG4sbyl7bnVsbCE9ZSYmKGU9dC5jbGFtcChlLDAsMzYwKSxpPXQuY2xhbXAoaSwtMTAwLDEwMCkscj10LmNsYW1wKHIsLTEwMCwxMDApLG49dC5jbGFtcChuLC0xMDAsMTAwKSxpPXQuYXBwbHlDb2xvckdyYWRpbmdTbGlkZXJOb25saW5lYXIoaSksaSo9LjUsbj10LmFwcGx5Q29sb3JHcmFkaW5nU2xpZGVyTm9ubGluZWFyKG4pLDA+aSYmKGkqPS0xLGU9KGUrMTgwKSUzNjApLHQuZnJvbUhTQlRvUmVmKGUsaSw1MCsuMjUqbixvKSxvLnNjYWxlVG9SZWYoMixvKSxvLmE9MSsuMDEqcil9LHQuYXBwbHlDb2xvckdyYWRpbmdTbGlkZXJOb25saW5lYXI9ZnVuY3Rpb24oZSl7ZS89MTAwO3ZhciB0PU1hdGguYWJzKGUpO3JldHVybiB0PU1hdGgucG93KHQsMiksMD5lJiYodCo9LTEpLHQqPTEwMH0sdC5mcm9tSFNCVG9SZWY9ZnVuY3Rpb24oZSxpLHIsbil7dmFyIG89dC5jbGFtcChlLDAsMzYwKSxzPXQuY2xhbXAoaS8xMDAsMCwxKSxhPXQuY2xhbXAoci8xMDAsMCwxKTtpZigwPT09cyluLnI9YSxuLmc9YSxuLmI9YTtlbHNle28vPTYwO3ZhciBoPU1hdGguZmxvb3IobyksYz1vLWgsbD1hKigxLXMpLHU9YSooMS1zKmMpLGY9YSooMS1zKigxLWMpKTtzd2l0Y2goaCl7Y2FzZSAwOm4ucj1hLG4uZz1mLG4uYj1sO2JyZWFrO2Nhc2UgMTpuLnI9dSxuLmc9YSxuLmI9bDticmVhaztjYXNlIDI6bi5yPWwsbi5nPWEsbi5iPWY7YnJlYWs7Y2FzZSAzOm4ucj1sLG4uZz11LG4uYj1hO2JyZWFrO2Nhc2UgNDpuLnI9ZixuLmc9bCxuLmI9YTticmVhaztkZWZhdWx0Om4ucj1hLG4uZz1sLG4uYj11fX1uLmE9MX0sdC5jbGFtcD1mdW5jdGlvbihlLHQsaSl7cmV0dXJuIE1hdGgubWluKE1hdGgubWF4KGUsdCksaSl9LHQucHJvdG90eXBlLmNsb25lPWZ1bmN0aW9uKCl7cmV0dXJuIGUuU2VyaWFsaXphdGlvbkhlbHBlci5DbG9uZShmdW5jdGlvbigpe3JldHVybiBuZXcgdH0sdGhpcyl9LHQucHJvdG90eXBlLnNlcmlhbGl6ZT1mdW5jdGlvbigpe3JldHVybiBlLlNlcmlhbGl6YXRpb25IZWxwZXIuU2VyaWFsaXplKHRoaXMpfSx0LlBhcnNlPWZ1bmN0aW9uKGkpe3JldHVybiBlLlNlcmlhbGl6YXRpb25IZWxwZXIuUGFyc2UoZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHR9LGksbnVsbCxudWxsKX0sX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0sdC5wcm90b3R5cGUsXCJfZ2xvYmFsSHVlXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSx0LnByb3RvdHlwZSxcIl9nbG9iYWxEZW5zaXR5XCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSx0LnByb3RvdHlwZSxcIl9nbG9iYWxTYXR1cmF0aW9uXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSx0LnByb3RvdHlwZSxcIl9nbG9iYWxFeHBvc3VyZVwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0sdC5wcm90b3R5cGUsXCJfaGlnaGxpZ2h0c0h1ZVwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0sdC5wcm90b3R5cGUsXCJfaGlnaGxpZ2h0c0RlbnNpdHlcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHQucHJvdG90eXBlLFwiX2hpZ2hsaWdodHNTYXR1cmF0aW9uXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSx0LnByb3RvdHlwZSxcIl9oaWdobGlnaHRzRXhwb3N1cmVcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHQucHJvdG90eXBlLFwiX21pZHRvbmVzSHVlXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSx0LnByb3RvdHlwZSxcIl9taWR0b25lc0RlbnNpdHlcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHQucHJvdG90eXBlLFwiX21pZHRvbmVzU2F0dXJhdGlvblwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0sdC5wcm90b3R5cGUsXCJfbWlkdG9uZXNFeHBvc3VyZVwiLHZvaWQgMCksdH0oKTtlLkNvbG9yQ3VydmVzPXR9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGkoaSxyKXt0LmNhbGwodGhpcyxyKSxpJiYodGhpcy5fdGV4dHVyZU1hdHJpeD1lLk1hdHJpeC5JZGVudGl0eSgpLHRoaXMubmFtZT1pLHRoaXMudXJsPWksdGhpcy5oYXNBbHBoYT0hMSx0aGlzLmlzQ3ViZT0hMSx0aGlzLndyYXBVPWUuVGV4dHVyZS5DTEFNUF9BRERSRVNTTU9ERSx0aGlzLndyYXBWPWUuVGV4dHVyZS5DTEFNUF9BRERSRVNTTU9ERSx0aGlzLmFuaXNvdHJvcGljRmlsdGVyaW5nTGV2ZWw9MSx0aGlzLl90ZXh0dXJlPXRoaXMuX2dldEZyb21DYWNoZShpLCEwKSx0aGlzLl90ZXh0dXJlfHwoci51c2VEZWxheWVkVGV4dHVyZUxvYWRpbmc/dGhpcy5kZWxheUxvYWRTdGF0ZT1lLkVuZ2luZS5ERUxBWUxPQURTVEFURV9OT1RMT0FERUQ6dGhpcy5sb2FkVGV4dHVyZSgpKSl9cmV0dXJuIF9fZXh0ZW5kcyhpLHQpLGkucHJvdG90eXBlLmdldFRleHR1cmVNYXRyaXg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fdGV4dHVyZU1hdHJpeH0saS5wcm90b3R5cGUubG9hZDNkbFRleHR1cmU9ZnVuY3Rpb24oKXt2YXIgdD10aGlzLHI9dGhpcy5nZXRTY2VuZSgpLmdldEVuZ2luZSgpLmNyZWF0ZVJhd1RleHR1cmUobnVsbCwxLDEsZS5FbmdpbmUuVEVYVFVSRUZPUk1BVF9SR0JBLCExLCExLGUuVGV4dHVyZS5CSUxJTkVBUl9TQU1QTElOR01PREUpO3RoaXMuX3RleHR1cmU9cjt2YXIgbj1mdW5jdGlvbihuKXtmb3IodmFyIG8scyxhLGg9bi5zcGxpdChcIlxcblwiKSxjPTAsbD0wLHU9MCxmPTAsZD0wLHA9MDtwPGgubGVuZ3RoO3ArKylpZihhPWhbcF0saS5fbm9uZUVtcHR5TGluZVJlZ2V4LnRlc3QoYSkmJjAhPT1hLmluZGV4T2YoXCIjXCIpKXt2YXIgXz1hLnNwbGl0KFwiIFwiKTtpZigwIT09Yyl7aWYoMCE9Yyl7dmFyIG09TWF0aC5tYXgocGFyc2VJbnQoX1swXSksMCksZz1NYXRoLm1heChwYXJzZUludChfWzFdKSwwKSx2PU1hdGgubWF4KHBhcnNlSW50KF9bMl0pLDApO2Q9TWF0aC5tYXgobSxkKSxkPU1hdGgubWF4KGcsZCksZD1NYXRoLm1heCh2LGQpO3ZhciB5PTQqKGwrZipjK3UqYypjKTtzW3krMF09bSxzW3krMV09ZyxzW3krMl09dixzW3krM109MCxmKyssZiVjPT0wJiYodSsrLGY9MCx1JWM9PTAmJihsKyssdT0wKSl9fWVsc2UgYz1fLmxlbmd0aCxvPW5ldyBVaW50OEFycmF5KGMqYypjKjQpLHM9bmV3IEZsb2F0MzJBcnJheShjKmMqYyo0KX1mb3IodmFyIHA9MDtwPHMubGVuZ3RoO3ArKyl7dmFyIHg9c1twXTtvW3BdPXgvZCoyNTV9dC5nZXRTY2VuZSgpLmdldEVuZ2luZSgpLnVwZGF0ZVRleHR1cmVTaXplKHIsYypjLGMpLHQuZ2V0U2NlbmUoKS5nZXRFbmdpbmUoKS51cGRhdGVSYXdUZXh0dXJlKHIsbyxlLkVuZ2luZS5URVhUVVJFRk9STUFUX1JHQkEsITEpfTtyZXR1cm4gZS5Ub29scy5Mb2FkRmlsZSh0aGlzLnVybCxuKSx0aGlzLl90ZXh0dXJlfSxpLnByb3RvdHlwZS5sb2FkVGV4dHVyZT1mdW5jdGlvbigpe3RoaXMudXJsJiZ0aGlzLnVybC50b0xvY2FsZUxvd2VyQ2FzZSgpLmluZGV4T2YoXCIuM2RsXCIpPT10aGlzLnVybC5sZW5ndGgtNCYmdGhpcy5sb2FkM2RsVGV4dHVyZSgpfSxpLnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbigpe3ZhciBlPW5ldyBpKHRoaXMudXJsLHRoaXMuZ2V0U2NlbmUoKSk7cmV0dXJuIGUubGV2ZWw9dGhpcy5sZXZlbCxlfSxpLnByb3RvdHlwZS5kZWxheUxvYWQ9ZnVuY3Rpb24oKXt0aGlzLmRlbGF5TG9hZFN0YXRlPT09ZS5FbmdpbmUuREVMQVlMT0FEU1RBVEVfTk9UTE9BREVEJiYodGhpcy5kZWxheUxvYWRTdGF0ZT1lLkVuZ2luZS5ERUxBWUxPQURTVEFURV9MT0FERUQsdGhpcy5fdGV4dHVyZT10aGlzLl9nZXRGcm9tQ2FjaGUodGhpcy51cmwsITApLHRoaXMuX3RleHR1cmV8fHRoaXMubG9hZFRleHR1cmUoKSl9LGkuUGFyc2U9ZnVuY3Rpb24odCxpLHIpe3ZhciBuPW51bGw7cmV0dXJuIHQubmFtZSYmIXQuaXNSZW5kZXJUYXJnZXQmJihuPW5ldyBlLkNvbG9yR3JhZGluZ1RleHR1cmUodC5uYW1lLGkpLG4ubmFtZT10Lm5hbWUsbi5sZXZlbD10LmxldmVsKSxufSxpLnByb3RvdHlwZS5zZXJpYWxpemU9ZnVuY3Rpb24oKXtpZighdGhpcy5uYW1lKXJldHVybiBudWxsO3ZhciBlPXt9O3JldHVybiBlLm5hbWU9dGhpcy5uYW1lLGUubGV2ZWw9dGhpcy5sZXZlbCxlfSxpLl9ub25lRW1wdHlMaW5lUmVnZXg9L1xcUysvLGl9KGUuQmFzZVRleHR1cmUpO2UuQ29sb3JHcmFkaW5nVGV4dHVyZT10fShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbihlKXtmdW5jdGlvbiB0KCl7ZS5jYWxsKHRoaXMpLHRoaXMuQUxCRURPPSExLHRoaXMuQU1CSUVOVD0hMSx0aGlzLk9QQUNJVFk9ITEsdGhpcy5PUEFDSVRZUkdCPSExLHRoaXMuUkVGTEVDVElPTj0hMSx0aGlzLkVNSVNTSVZFPSExLHRoaXMuUkVGTEVDVElWSVRZPSExLHRoaXMuQlVNUD0hMSx0aGlzLlBBUkFMTEFYPSExLHRoaXMuUEFSQUxMQVhPQ0NMVVNJT049ITEsdGhpcy5TUEVDVUxBUk9WRVJBTFBIQT0hMSx0aGlzLkNMSVBQTEFORT0hMSx0aGlzLkFMUEhBVEVTVD0hMSx0aGlzLkFMUEhBRlJPTUFMQkVETz0hMSx0aGlzLlBPSU5UU0laRT0hMSx0aGlzLkZPRz0hMSx0aGlzLlNQRUNVTEFSVEVSTT0hMSx0aGlzLk9QQUNJVFlGUkVTTkVMPSExLHRoaXMuRU1JU1NJVkVGUkVTTkVMPSExLHRoaXMuRlJFU05FTD0hMSx0aGlzLk5PUk1BTD0hMSx0aGlzLlVWMT0hMSx0aGlzLlVWMj0hMSx0aGlzLlZFUlRFWENPTE9SPSExLHRoaXMuVkVSVEVYQUxQSEE9ITEsdGhpcy5OVU1fQk9ORV9JTkZMVUVOQ0VSUz0wLHRoaXMuQm9uZXNQZXJNZXNoPTAsdGhpcy5JTlNUQU5DRVM9ITEsdGhpcy5NSUNST1NVUkZBQ0VGUk9NUkVGTEVDVElWSVRZTUFQPSExLHRoaXMuTUlDUk9TVVJGQUNFQVVUT01BVElDPSExLHRoaXMuRU1JU1NJVkVBU0lMTFVNSU5BVElPTj0hMSx0aGlzLkxJTktFTUlTU0lWRVdJVEhBTEJFRE89ITEsdGhpcy5MSUdIVE1BUD0hMSx0aGlzLlVTRUxJR0hUTUFQQVNTSEFET1dNQVA9ITEsdGhpcy5SRUZMRUNUSU9OTUFQXzNEPSExLHRoaXMuUkVGTEVDVElPTk1BUF9TUEhFUklDQUw9ITEsdGhpcy5SRUZMRUNUSU9OTUFQX1BMQU5BUj0hMSx0aGlzLlJFRkxFQ1RJT05NQVBfQ1VCSUM9ITEsdGhpcy5SRUZMRUNUSU9OTUFQX1BST0pFQ1RJT049ITEsdGhpcy5SRUZMRUNUSU9OTUFQX1NLWUJPWD0hMSx0aGlzLlJFRkxFQ1RJT05NQVBfRVhQTElDSVQ9ITEsdGhpcy5SRUZMRUNUSU9OTUFQX0VRVUlSRUNUQU5HVUxBUj0hMSx0aGlzLklOVkVSVENVQklDTUFQPSExLHRoaXMuTE9HQVJJVEhNSUNERVBUSD0hMSx0aGlzLkNBTUVSQVRPTkVNQVA9ITEsdGhpcy5DQU1FUkFDT05UUkFTVD0hMSx0aGlzLkNBTUVSQUNPTE9SR1JBRElORz0hMSx0aGlzLkNBTUVSQUNPTE9SQ1VSVkVTPSExLHRoaXMuT1ZFUkxPQURFRFZBTFVFUz0hMSx0aGlzLk9WRVJMT0FERURTSEFET1dWQUxVRVM9ITEsdGhpcy5VU0VTUEhFUklDQUxGUk9NUkVGTEVDVElPTk1BUD0hMSx0aGlzLlJFRlJBQ1RJT049ITEsdGhpcy5SRUZSQUNUSU9OTUFQXzNEPSExLHRoaXMuTElOS1JFRlJBQ1RJT05UT1RSQU5TUEFSRU5DWT0hMSx0aGlzLlJFRlJBQ1RJT05NQVBJTkxJTkVBUlNQQUNFPSExLHRoaXMuTE9EQkFTRURNSUNST1NGVVJBQ0U9ITEsdGhpcy5VU0VQSFlTSUNBTExJR0hURkFMTE9GRj0hMSx0aGlzLlJBRElBTkNFT1ZFUkFMUEhBPSExLHRoaXMuVVNFUE1SRU1SRUZMRUNUSU9OPSExLHRoaXMuVVNFUE1SRU1SRUZSQUNUSU9OPSExLHRoaXMuT1BFTkdMTk9STUFMTUFQPSExLHRoaXMuSU5WRVJUTk9STUFMTUFQWD0hMSx0aGlzLklOVkVSVE5PUk1BTE1BUFk9ITEsdGhpcy5yZWJ1aWxkKCl9cmV0dXJuIF9fZXh0ZW5kcyh0LGUpLHR9KGUuTWF0ZXJpYWxEZWZpbmVzKSxpPWZ1bmN0aW9uKGkpe2Z1bmN0aW9uIHIocixuKXt2YXIgbz10aGlzO2kuY2FsbCh0aGlzLHIsbiksdGhpcy5kaXJlY3RJbnRlbnNpdHk9MSx0aGlzLmVtaXNzaXZlSW50ZW5zaXR5PTEsdGhpcy5lbnZpcm9ubWVudEludGVuc2l0eT0xLHRoaXMuc3BlY3VsYXJJbnRlbnNpdHk9MSx0aGlzLl9saWdodGluZ0luZm9zPW5ldyBlLlZlY3RvcjQodGhpcy5kaXJlY3RJbnRlbnNpdHksdGhpcy5lbWlzc2l2ZUludGVuc2l0eSx0aGlzLmVudmlyb25tZW50SW50ZW5zaXR5LHRoaXMuc3BlY3VsYXJJbnRlbnNpdHkpLHRoaXMuZGlzYWJsZUJ1bXBNYXA9ITEsdGhpcy5vdmVybG9hZGVkU2hhZG93SW50ZW5zaXR5PTEsdGhpcy5vdmVybG9hZGVkU2hhZGVJbnRlbnNpdHk9MSx0aGlzLl9vdmVybG9hZGVkU2hhZG93SW5mb3M9bmV3IGUuVmVjdG9yNCh0aGlzLm92ZXJsb2FkZWRTaGFkb3dJbnRlbnNpdHksdGhpcy5vdmVybG9hZGVkU2hhZGVJbnRlbnNpdHksMCwwKSx0aGlzLmNhbWVyYUV4cG9zdXJlPTEsdGhpcy5jYW1lcmFDb250cmFzdD0xLHRoaXMuY2FtZXJhQ29sb3JHcmFkaW5nVGV4dHVyZT1udWxsLHRoaXMuX2NhbWVyYUNvbG9yR3JhZGluZ1NjYWxlT2Zmc2V0PW5ldyBlLlZlY3RvcjQoMSwxLDAsMCksdGhpcy5fY2FtZXJhQ29sb3JHcmFkaW5nSW5mb3M9bmV3IGUuVmVjdG9yNCgxLDEsMCwwKSx0aGlzLmNhbWVyYUNvbG9yQ3VydmVzPW51bGwsdGhpcy5fY2FtZXJhSW5mb3M9bmV3IGUuVmVjdG9yNCgxLDEsMCwwKSx0aGlzLl9taWNyb3N1cmZhY2VUZXh0dXJlTG9kcz1uZXcgZS5WZWN0b3IyKDAsMCksdGhpcy5vdmVybG9hZGVkQW1iaWVudD1lLkNvbG9yMy5XaGl0ZSgpLHRoaXMub3ZlcmxvYWRlZEFtYmllbnRJbnRlbnNpdHk9MCx0aGlzLm92ZXJsb2FkZWRBbGJlZG89ZS5Db2xvcjMuV2hpdGUoKSx0aGlzLm92ZXJsb2FkZWRBbGJlZG9JbnRlbnNpdHk9MCx0aGlzLm92ZXJsb2FkZWRSZWZsZWN0aXZpdHk9bmV3IGUuQ29sb3IzKC4zLC4zLC4zKSx0aGlzLm92ZXJsb2FkZWRSZWZsZWN0aXZpdHlJbnRlbnNpdHk9MCx0aGlzLm92ZXJsb2FkZWRFbWlzc2l2ZT1lLkNvbG9yMy5XaGl0ZSgpLHRoaXMub3ZlcmxvYWRlZEVtaXNzaXZlSW50ZW5zaXR5PTAsdGhpcy5fb3ZlcmxvYWRlZEludGVuc2l0eT1uZXcgZS5WZWN0b3I0KHRoaXMub3ZlcmxvYWRlZEFtYmllbnRJbnRlbnNpdHksdGhpcy5vdmVybG9hZGVkQWxiZWRvSW50ZW5zaXR5LHRoaXMub3ZlcmxvYWRlZFJlZmxlY3Rpdml0eUludGVuc2l0eSx0aGlzLm92ZXJsb2FkZWRFbWlzc2l2ZUludGVuc2l0eSksdGhpcy5vdmVybG9hZGVkUmVmbGVjdGlvbj1lLkNvbG9yMy5XaGl0ZSgpLHRoaXMub3ZlcmxvYWRlZFJlZmxlY3Rpb25JbnRlbnNpdHk9MCx0aGlzLm92ZXJsb2FkZWRNaWNyb1N1cmZhY2U9MCx0aGlzLm92ZXJsb2FkZWRNaWNyb1N1cmZhY2VJbnRlbnNpdHk9MCx0aGlzLl9vdmVybG9hZGVkTWljcm9TdXJmYWNlPW5ldyBlLlZlY3RvcjModGhpcy5vdmVybG9hZGVkTWljcm9TdXJmYWNlLHRoaXMub3ZlcmxvYWRlZE1pY3JvU3VyZmFjZUludGVuc2l0eSx0aGlzLm92ZXJsb2FkZWRSZWZsZWN0aW9uSW50ZW5zaXR5KSx0aGlzLmFtYmllbnRDb2xvcj1uZXcgZS5Db2xvcjMoMCwwLDApLHRoaXMuYWxiZWRvQ29sb3I9bmV3IGUuQ29sb3IzKDEsMSwxKSx0aGlzLnJlZmxlY3Rpdml0eUNvbG9yPW5ldyBlLkNvbG9yMygxLDEsMSksdGhpcy5yZWZsZWN0aW9uQ29sb3I9bmV3IGUuQ29sb3IzKC41LC41LC41KSx0aGlzLmVtaXNzaXZlQ29sb3I9bmV3IGUuQ29sb3IzKDAsMCwwKSx0aGlzLm1pY3JvU3VyZmFjZT0uOSx0aGlzLmluZGV4T2ZSZWZyYWN0aW9uPS42Nix0aGlzLmludmVydFJlZnJhY3Rpb25ZPSExLHRoaXMubGlua1JlZnJhY3Rpb25XaXRoVHJhbnNwYXJlbmN5PSExLHRoaXMubGlua0VtaXNzaXZlV2l0aEFsYmVkbz0hMSx0aGlzLnVzZUxpZ2h0bWFwQXNTaGFkb3dtYXA9ITEsdGhpcy51c2VFbWlzc2l2ZUFzSWxsdW1pbmF0aW9uPSExLHRoaXMudXNlQWxwaGFGcm9tQWxiZWRvVGV4dHVyZT0hMSx0aGlzLnVzZVNwZWN1bGFyT3ZlckFscGhhPSEwLHRoaXMudXNlTWljcm9TdXJmYWNlRnJvbVJlZmxlY3Rpdml0eU1hcEFscGhhPSExLHRoaXMudXNlQXV0b01pY3JvU3VyZmFjZUZyb21SZWZsZWN0aXZpdHlNYXA9ITEsdGhpcy51c2VTY2FsYXJJbkxpbmVhclNwYWNlPSExLHRoaXMudXNlUGh5c2ljYWxMaWdodEZhbGxvZmY9ITAsdGhpcy51c2VSYWRpYW5jZU92ZXJBbHBoYT0hMCx0aGlzLnVzZVBhcmFsbGF4PSExLHRoaXMudXNlUGFyYWxsYXhPY2NsdXNpb249ITEsdGhpcy5wYXJhbGxheFNjYWxlQmlhcz0uMDUsdGhpcy5kaXNhYmxlTGlnaHRpbmc9ITEsdGhpcy5tYXhTaW11bHRhbmVvdXNMaWdodHM9NCx0aGlzLmludmVydE5vcm1hbE1hcFg9ITEsdGhpcy5pbnZlcnROb3JtYWxNYXBZPSExLHRoaXMuX3JlbmRlclRhcmdldHM9bmV3IGUuU21hcnRBcnJheSgxNiksdGhpcy5fd29ybGRWaWV3UHJvamVjdGlvbk1hdHJpeD1lLk1hdHJpeC5aZXJvKCksdGhpcy5fZ2xvYmFsQW1iaWVudENvbG9yPW5ldyBlLkNvbG9yMygwLDAsMCksdGhpcy5fdGVtcENvbG9yPW5ldyBlLkNvbG9yMyx0aGlzLl9kZWZpbmVzPW5ldyB0LHRoaXMuX2NhY2hlZERlZmluZXM9bmV3IHQsdGhpcy5fbXlTY2VuZT1udWxsLHRoaXMuX215U2hhZG93R2VuZXJhdG9yPW51bGwsdGhpcy5fY2FjaGVkRGVmaW5lcy5Cb25lc1Blck1lc2g9LTEsdGhpcy5nZXRSZW5kZXJUYXJnZXRUZXh0dXJlcz1mdW5jdGlvbigpe3JldHVybiBvLl9yZW5kZXJUYXJnZXRzLnJlc2V0KCksby5yZWZsZWN0aW9uVGV4dHVyZSYmby5yZWZsZWN0aW9uVGV4dHVyZS5pc1JlbmRlclRhcmdldCYmby5fcmVuZGVyVGFyZ2V0cy5wdXNoKG8ucmVmbGVjdGlvblRleHR1cmUpLG8ucmVmcmFjdGlvblRleHR1cmUmJm8ucmVmcmFjdGlvblRleHR1cmUuaXNSZW5kZXJUYXJnZXQmJm8uX3JlbmRlclRhcmdldHMucHVzaChvLnJlZnJhY3Rpb25UZXh0dXJlKSxvLl9yZW5kZXJUYXJnZXRzfX1yZXR1cm4gX19leHRlbmRzKHIsaSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHIucHJvdG90eXBlLFwidXNlTG9nYXJpdGhtaWNEZXB0aFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fdXNlTG9nYXJpdGhtaWNEZXB0aH0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuX3VzZUxvZ2FyaXRobWljRGVwdGg9ZSYmdGhpcy5nZXRTY2VuZSgpLmdldEVuZ2luZSgpLmdldENhcHMoKS5mcmFnbWVudERlcHRoU3VwcG9ydGVkfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLHIucHJvdG90eXBlLm5lZWRBbHBoYUJsZW5kaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubGlua1JlZnJhY3Rpb25XaXRoVHJhbnNwYXJlbmN5PyExOnRoaXMuYWxwaGE8MXx8bnVsbCE9dGhpcy5vcGFjaXR5VGV4dHVyZXx8dGhpcy5fc2hvdWxkVXNlQWxwaGFGcm9tQWxiZWRvVGV4dHVyZSgpfHx0aGlzLm9wYWNpdHlGcmVzbmVsUGFyYW1ldGVycyYmdGhpcy5vcGFjaXR5RnJlc25lbFBhcmFtZXRlcnMuaXNFbmFibGVkfSxyLnByb3RvdHlwZS5uZWVkQWxwaGFUZXN0aW5nPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubGlua1JlZnJhY3Rpb25XaXRoVHJhbnNwYXJlbmN5PyExOm51bGwhPXRoaXMuYWxiZWRvVGV4dHVyZSYmdGhpcy5hbGJlZG9UZXh0dXJlLmhhc0FscGhhfSxyLnByb3RvdHlwZS5fc2hvdWxkVXNlQWxwaGFGcm9tQWxiZWRvVGV4dHVyZT1mdW5jdGlvbigpe3JldHVybiBudWxsIT10aGlzLmFsYmVkb1RleHR1cmUmJnRoaXMuYWxiZWRvVGV4dHVyZS5oYXNBbHBoYSYmdGhpcy51c2VBbHBoYUZyb21BbGJlZG9UZXh0dXJlfSxyLnByb3RvdHlwZS5nZXRBbHBoYVRlc3RUZXh0dXJlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYWxiZWRvVGV4dHVyZX0sci5wcm90b3R5cGUuX2NoZWNrQ2FjaGU9ZnVuY3Rpb24oZSx0LGkpe3JldHVybiB0P3RoaXMuX2RlZmluZXMuSU5TVEFOQ0VTIT09aT8hMTohKCF0Ll9tYXRlcmlhbERlZmluZXN8fCF0Ll9tYXRlcmlhbERlZmluZXMuaXNFcXVhbCh0aGlzLl9kZWZpbmVzKSk6ITB9LHIucHJvdG90eXBlLmNvbnZlcnRDb2xvclRvTGluZWFyU3BhY2VUb1JlZj1mdW5jdGlvbihlLHQpe3IuY29udmVydENvbG9yVG9MaW5lYXJTcGFjZVRvUmVmKGUsdCx0aGlzLnVzZVNjYWxhckluTGluZWFyU3BhY2UpfSxyLmNvbnZlcnRDb2xvclRvTGluZWFyU3BhY2VUb1JlZj1mdW5jdGlvbihlLHQsaSl7aT8odC5yPWUucix0Lmc9ZS5nLHQuYj1lLmIpOmUudG9MaW5lYXJTcGFjZVRvUmVmKHQpfSxyLkJpbmRMaWdodHM9ZnVuY3Rpb24odCxpLG4sbyxzLGEsaCl7Zm9yKHZhciBjPTAsbD0hMSx1PTA7dTx0LmxpZ2h0cy5sZW5ndGg7dSsrKXt2YXIgZj10LmxpZ2h0c1t1XTtpZihmLmlzRW5hYmxlZCgpJiZmLmNhbkFmZmVjdE1lc2goaSkmJihlLk1hdGVyaWFsSGVscGVyLkJpbmRMaWdodFByb3BlcnRpZXMoZixuLGMpLHRoaXMuY29udmVydENvbG9yVG9MaW5lYXJTcGFjZVRvUmVmKGYuZGlmZnVzZSxyLl9zY2FsZWRBbGJlZG8scyksci5fc2NhbGVkQWxiZWRvLnNjYWxlVG9SZWYoZi5pbnRlbnNpdHksci5fc2NhbGVkQWxiZWRvKSxuLnNldENvbG9yNChcInZMaWdodERpZmZ1c2VcIitjLHIuX3NjYWxlZEFsYmVkbyxoP2YucmFkaXVzOmYucmFuZ2UpLG8uU1BFQ1VMQVJURVJNJiYodGhpcy5jb252ZXJ0Q29sb3JUb0xpbmVhclNwYWNlVG9SZWYoZi5zcGVjdWxhcixyLl9zY2FsZWRSZWZsZWN0aXZpdHkscyksci5fc2NhbGVkUmVmbGVjdGl2aXR5LnNjYWxlVG9SZWYoZi5pbnRlbnNpdHksci5fc2NhbGVkUmVmbGVjdGl2aXR5KSxuLnNldENvbG9yMyhcInZMaWdodFNwZWN1bGFyXCIrYyxyLl9zY2FsZWRSZWZsZWN0aXZpdHkpKSx0LnNoYWRvd3NFbmFibGVkJiYobD1lLk1hdGVyaWFsSGVscGVyLkJpbmRMaWdodFNoYWRvdyhmLHQsaSxjLG4sbCkpLGMrKyxjPT09YSkpYnJlYWt9fSxyLnByb3RvdHlwZS5pc1JlYWR5PWZ1bmN0aW9uKGkscil7aWYodGhpcy5jaGVja1JlYWR5T25seU9uY2UmJnRoaXMuX3dhc1ByZXZpb3VzbHlSZWFkeSlyZXR1cm4hMDt2YXIgbj10aGlzLmdldFNjZW5lKCk7aWYoIXRoaXMuY2hlY2tSZWFkeU9uRXZlcnlDYWxsJiZ0aGlzLl9yZW5kZXJJZD09PW4uZ2V0UmVuZGVySWQoKSYmdGhpcy5fY2hlY2tDYWNoZShuLGkscikpcmV0dXJuITA7dmFyIG89bi5nZXRFbmdpbmUoKSxzPSExLGE9ITE7aWYodGhpcy5fZGVmaW5lcy5yZXNldCgpLG4udGV4dHVyZXNFbmFibGVkKXtpZihuLnRleHR1cmVzRW5hYmxlZCl7aWYobi5nZXRFbmdpbmUoKS5nZXRDYXBzKCkudGV4dHVyZUxPRCYmKHRoaXMuX2RlZmluZXMuTE9EQkFTRURNSUNST1NGVVJBQ0U9ITApLFxudGhpcy5hbGJlZG9UZXh0dXJlJiZlLlN0YW5kYXJkTWF0ZXJpYWwuRGlmZnVzZVRleHR1cmVFbmFibGVkKXtpZighdGhpcy5hbGJlZG9UZXh0dXJlLmlzUmVhZHkoKSlyZXR1cm4hMTthPSEwLHRoaXMuX2RlZmluZXMuQUxCRURPPSEwfWlmKHRoaXMuYW1iaWVudFRleHR1cmUmJmUuU3RhbmRhcmRNYXRlcmlhbC5BbWJpZW50VGV4dHVyZUVuYWJsZWQpe2lmKCF0aGlzLmFtYmllbnRUZXh0dXJlLmlzUmVhZHkoKSlyZXR1cm4hMTthPSEwLHRoaXMuX2RlZmluZXMuQU1CSUVOVD0hMH1pZih0aGlzLm9wYWNpdHlUZXh0dXJlJiZlLlN0YW5kYXJkTWF0ZXJpYWwuT3BhY2l0eVRleHR1cmVFbmFibGVkKXtpZighdGhpcy5vcGFjaXR5VGV4dHVyZS5pc1JlYWR5KCkpcmV0dXJuITE7YT0hMCx0aGlzLl9kZWZpbmVzLk9QQUNJVFk9ITAsdGhpcy5vcGFjaXR5VGV4dHVyZS5nZXRBbHBoYUZyb21SR0ImJih0aGlzLl9kZWZpbmVzLk9QQUNJVFlSR0I9ITApfWlmKHRoaXMucmVmbGVjdGlvblRleHR1cmUmJmUuU3RhbmRhcmRNYXRlcmlhbC5SZWZsZWN0aW9uVGV4dHVyZUVuYWJsZWQpe2lmKCF0aGlzLnJlZmxlY3Rpb25UZXh0dXJlLmlzUmVhZHkoKSlyZXR1cm4hMTtzd2l0Y2gocz0hMCx0aGlzLl9kZWZpbmVzLlJFRkxFQ1RJT049ITAsdGhpcy5yZWZsZWN0aW9uVGV4dHVyZS5jb29yZGluYXRlc01vZGU9PT1lLlRleHR1cmUuSU5WQ1VCSUNfTU9ERSYmKHRoaXMuX2RlZmluZXMuSU5WRVJUQ1VCSUNNQVA9ITApLHRoaXMuX2RlZmluZXMuUkVGTEVDVElPTk1BUF8zRD10aGlzLnJlZmxlY3Rpb25UZXh0dXJlLmlzQ3ViZSx0aGlzLnJlZmxlY3Rpb25UZXh0dXJlLmNvb3JkaW5hdGVzTW9kZSl7Y2FzZSBlLlRleHR1cmUuQ1VCSUNfTU9ERTpjYXNlIGUuVGV4dHVyZS5JTlZDVUJJQ19NT0RFOnRoaXMuX2RlZmluZXMuUkVGTEVDVElPTk1BUF9DVUJJQz0hMDticmVhaztjYXNlIGUuVGV4dHVyZS5FWFBMSUNJVF9NT0RFOnRoaXMuX2RlZmluZXMuUkVGTEVDVElPTk1BUF9FWFBMSUNJVD0hMDticmVhaztjYXNlIGUuVGV4dHVyZS5QTEFOQVJfTU9ERTp0aGlzLl9kZWZpbmVzLlJFRkxFQ1RJT05NQVBfUExBTkFSPSEwO2JyZWFrO2Nhc2UgZS5UZXh0dXJlLlBST0pFQ1RJT05fTU9ERTp0aGlzLl9kZWZpbmVzLlJFRkxFQ1RJT05NQVBfUFJPSkVDVElPTj0hMDticmVhaztjYXNlIGUuVGV4dHVyZS5TS1lCT1hfTU9ERTp0aGlzLl9kZWZpbmVzLlJFRkxFQ1RJT05NQVBfU0tZQk9YPSEwO2JyZWFrO2Nhc2UgZS5UZXh0dXJlLlNQSEVSSUNBTF9NT0RFOnRoaXMuX2RlZmluZXMuUkVGTEVDVElPTk1BUF9TUEhFUklDQUw9ITA7YnJlYWs7Y2FzZSBlLlRleHR1cmUuRVFVSVJFQ1RBTkdVTEFSX01PREU6dGhpcy5fZGVmaW5lcy5SRUZMRUNUSU9OTUFQX0VRVUlSRUNUQU5HVUxBUj0hMH10aGlzLnJlZmxlY3Rpb25UZXh0dXJlIGluc3RhbmNlb2YgZS5IRFJDdWJlVGV4dHVyZSYmdGhpcy5yZWZsZWN0aW9uVGV4dHVyZSYmKHRoaXMuX2RlZmluZXMuVVNFU1BIRVJJQ0FMRlJPTVJFRkxFQ1RJT05NQVA9ITAscz0hMCx0aGlzLnJlZmxlY3Rpb25UZXh0dXJlLmlzUE1SRU0mJih0aGlzLl9kZWZpbmVzLlVTRVBNUkVNUkVGTEVDVElPTj0hMCkpfWlmKHRoaXMubGlnaHRtYXBUZXh0dXJlJiZlLlN0YW5kYXJkTWF0ZXJpYWwuTGlnaHRtYXBUZXh0dXJlRW5hYmxlZCl7aWYoIXRoaXMubGlnaHRtYXBUZXh0dXJlLmlzUmVhZHkoKSlyZXR1cm4hMTthPSEwLHRoaXMuX2RlZmluZXMuTElHSFRNQVA9ITAsdGhpcy5fZGVmaW5lcy5VU0VMSUdIVE1BUEFTU0hBRE9XTUFQPXRoaXMudXNlTGlnaHRtYXBBc1NoYWRvd21hcH1pZih0aGlzLmVtaXNzaXZlVGV4dHVyZSYmZS5TdGFuZGFyZE1hdGVyaWFsLkVtaXNzaXZlVGV4dHVyZUVuYWJsZWQpe2lmKCF0aGlzLmVtaXNzaXZlVGV4dHVyZS5pc1JlYWR5KCkpcmV0dXJuITE7YT0hMCx0aGlzLl9kZWZpbmVzLkVNSVNTSVZFPSEwfWlmKHRoaXMucmVmbGVjdGl2aXR5VGV4dHVyZSYmZS5TdGFuZGFyZE1hdGVyaWFsLlNwZWN1bGFyVGV4dHVyZUVuYWJsZWQpe2lmKCF0aGlzLnJlZmxlY3Rpdml0eVRleHR1cmUuaXNSZWFkeSgpKXJldHVybiExO2E9ITAsdGhpcy5fZGVmaW5lcy5SRUZMRUNUSVZJVFk9ITAsdGhpcy5fZGVmaW5lcy5NSUNST1NVUkZBQ0VGUk9NUkVGTEVDVElWSVRZTUFQPXRoaXMudXNlTWljcm9TdXJmYWNlRnJvbVJlZmxlY3Rpdml0eU1hcEFscGhhLHRoaXMuX2RlZmluZXMuTUlDUk9TVVJGQUNFQVVUT01BVElDPXRoaXMudXNlQXV0b01pY3JvU3VyZmFjZUZyb21SZWZsZWN0aXZpdHlNYXB9fWlmKG4uZ2V0RW5naW5lKCkuZ2V0Q2FwcygpLnN0YW5kYXJkRGVyaXZhdGl2ZXMmJnRoaXMuYnVtcFRleHR1cmUmJmUuU3RhbmRhcmRNYXRlcmlhbC5CdW1wVGV4dHVyZUVuYWJsZWQmJiF0aGlzLmRpc2FibGVCdW1wTWFwKXtpZighdGhpcy5idW1wVGV4dHVyZS5pc1JlYWR5KCkpcmV0dXJuITE7YT0hMCx0aGlzLl9kZWZpbmVzLkJVTVA9ITAsdGhpcy51c2VQYXJhbGxheCYmKHRoaXMuX2RlZmluZXMuUEFSQUxMQVg9ITAsdGhpcy51c2VQYXJhbGxheE9jY2x1c2lvbiYmKHRoaXMuX2RlZmluZXMuUEFSQUxMQVhPQ0NMVVNJT049ITApKSx0aGlzLmludmVydE5vcm1hbE1hcFgmJih0aGlzLl9kZWZpbmVzLklOVkVSVE5PUk1BTE1BUFg9ITApLHRoaXMuaW52ZXJ0Tm9ybWFsTWFwWSYmKHRoaXMuX2RlZmluZXMuSU5WRVJUTk9STUFMTUFQWT0hMCl9aWYodGhpcy5yZWZyYWN0aW9uVGV4dHVyZSYmZS5TdGFuZGFyZE1hdGVyaWFsLlJlZnJhY3Rpb25UZXh0dXJlRW5hYmxlZCl7aWYoIXRoaXMucmVmcmFjdGlvblRleHR1cmUuaXNSZWFkeSgpKXJldHVybiExO2E9ITAsdGhpcy5fZGVmaW5lcy5SRUZSQUNUSU9OPSEwLHRoaXMuX2RlZmluZXMuUkVGUkFDVElPTk1BUF8zRD10aGlzLnJlZnJhY3Rpb25UZXh0dXJlLmlzQ3ViZSx0aGlzLmxpbmtSZWZyYWN0aW9uV2l0aFRyYW5zcGFyZW5jeSYmKHRoaXMuX2RlZmluZXMuTElOS1JFRlJBQ1RJT05UT1RSQU5TUEFSRU5DWT0hMCksdGhpcy5yZWZyYWN0aW9uVGV4dHVyZSBpbnN0YW5jZW9mIGUuSERSQ3ViZVRleHR1cmUmJih0aGlzLl9kZWZpbmVzLlJFRlJBQ1RJT05NQVBJTkxJTkVBUlNQQUNFPSEwLHRoaXMucmVmcmFjdGlvblRleHR1cmUuaXNQTVJFTSYmKHRoaXMuX2RlZmluZXMuVVNFUE1SRU1SRUZSQUNUSU9OPSEwKSl9aWYodGhpcy5jYW1lcmFDb2xvckdyYWRpbmdUZXh0dXJlKXtpZighdGhpcy5jYW1lcmFDb2xvckdyYWRpbmdUZXh0dXJlLmlzUmVhZHkoKSlyZXR1cm4hMTt0aGlzLl9kZWZpbmVzLkNBTUVSQUNPTE9SR1JBRElORz0hMH19aWYobi5jbGlwUGxhbmUmJih0aGlzLl9kZWZpbmVzLkNMSVBQTEFORT0hMCksby5nZXRBbHBoYVRlc3RpbmcoKSYmKHRoaXMuX2RlZmluZXMuQUxQSEFURVNUPSEwKSx0aGlzLl9zaG91bGRVc2VBbHBoYUZyb21BbGJlZG9UZXh0dXJlKCkmJih0aGlzLl9kZWZpbmVzLkFMUEhBRlJPTUFMQkVETz0hMCksdGhpcy51c2VFbWlzc2l2ZUFzSWxsdW1pbmF0aW9uJiYodGhpcy5fZGVmaW5lcy5FTUlTU0lWRUFTSUxMVU1JTkFUSU9OPSEwKSx0aGlzLmxpbmtFbWlzc2l2ZVdpdGhBbGJlZG8mJih0aGlzLl9kZWZpbmVzLkxJTktFTUlTU0lWRVdJVEhBTEJFRE89ITApLHRoaXMudXNlTG9nYXJpdGhtaWNEZXB0aCYmKHRoaXMuX2RlZmluZXMuTE9HQVJJVEhNSUNERVBUSD0hMCksMSE9dGhpcy5jYW1lcmFDb250cmFzdCYmKHRoaXMuX2RlZmluZXMuQ0FNRVJBQ09OVFJBU1Q9ITApLDEhPXRoaXMuY2FtZXJhRXhwb3N1cmUmJih0aGlzLl9kZWZpbmVzLkNBTUVSQVRPTkVNQVA9ITApLHRoaXMuY2FtZXJhQ29sb3JDdXJ2ZXMmJih0aGlzLl9kZWZpbmVzLkNBTUVSQUNPTE9SQ1VSVkVTPSEwKSwxPT10aGlzLm92ZXJsb2FkZWRTaGFkZUludGVuc2l0eSYmMT09dGhpcy5vdmVybG9hZGVkU2hhZG93SW50ZW5zaXR5fHwodGhpcy5fZGVmaW5lcy5PVkVSTE9BREVEU0hBRE9XVkFMVUVTPSEwKSwodGhpcy5vdmVybG9hZGVkTWljcm9TdXJmYWNlSW50ZW5zaXR5PjB8fHRoaXMub3ZlcmxvYWRlZEVtaXNzaXZlSW50ZW5zaXR5PjB8fHRoaXMub3ZlcmxvYWRlZFJlZmxlY3Rpdml0eUludGVuc2l0eT4wfHx0aGlzLm92ZXJsb2FkZWRBbGJlZG9JbnRlbnNpdHk+MHx8dGhpcy5vdmVybG9hZGVkQW1iaWVudEludGVuc2l0eT4wfHx0aGlzLm92ZXJsb2FkZWRSZWZsZWN0aW9uSW50ZW5zaXR5PjApJiYodGhpcy5fZGVmaW5lcy5PVkVSTE9BREVEVkFMVUVTPSEwKSwodGhpcy5wb2ludHNDbG91ZHx8bi5mb3JjZVBvaW50c0Nsb3VkKSYmKHRoaXMuX2RlZmluZXMuUE9JTlRTSVpFPSEwKSxuLmZvZ0VuYWJsZWQmJmkmJmkuYXBwbHlGb2cmJm4uZm9nTW9kZSE9PWUuU2NlbmUuRk9HTU9ERV9OT05FJiZ0aGlzLmZvZ0VuYWJsZWQmJih0aGlzLl9kZWZpbmVzLkZPRz0hMCksbi5saWdodHNFbmFibGVkJiYhdGhpcy5kaXNhYmxlTGlnaHRpbmcmJihzPWUuTWF0ZXJpYWxIZWxwZXIuUHJlcGFyZURlZmluZXNGb3JMaWdodHMobixpLHRoaXMuX2RlZmluZXMsdGhpcy5tYXhTaW11bHRhbmVvdXNMaWdodHMpfHxzKSxlLlN0YW5kYXJkTWF0ZXJpYWwuRnJlc25lbEVuYWJsZWQmJih0aGlzLm9wYWNpdHlGcmVzbmVsUGFyYW1ldGVycyYmdGhpcy5vcGFjaXR5RnJlc25lbFBhcmFtZXRlcnMuaXNFbmFibGVkfHx0aGlzLmVtaXNzaXZlRnJlc25lbFBhcmFtZXRlcnMmJnRoaXMuZW1pc3NpdmVGcmVzbmVsUGFyYW1ldGVycy5pc0VuYWJsZWQpJiYodGhpcy5vcGFjaXR5RnJlc25lbFBhcmFtZXRlcnMmJnRoaXMub3BhY2l0eUZyZXNuZWxQYXJhbWV0ZXJzLmlzRW5hYmxlZCYmKHRoaXMuX2RlZmluZXMuT1BBQ0lUWUZSRVNORUw9ITApLHRoaXMuZW1pc3NpdmVGcmVzbmVsUGFyYW1ldGVycyYmdGhpcy5lbWlzc2l2ZUZyZXNuZWxQYXJhbWV0ZXJzLmlzRW5hYmxlZCYmKHRoaXMuX2RlZmluZXMuRU1JU1NJVkVGUkVTTkVMPSEwKSxzPSEwLHRoaXMuX2RlZmluZXMuRlJFU05FTD0hMCksdGhpcy5fZGVmaW5lcy5TUEVDVUxBUlRFUk0mJnRoaXMudXNlU3BlY3VsYXJPdmVyQWxwaGEmJih0aGlzLl9kZWZpbmVzLlNQRUNVTEFST1ZFUkFMUEhBPSEwKSx0aGlzLnVzZVBoeXNpY2FsTGlnaHRGYWxsb2ZmJiYodGhpcy5fZGVmaW5lcy5VU0VQSFlTSUNBTExJR0hURkFMTE9GRj0hMCksdGhpcy51c2VSYWRpYW5jZU92ZXJBbHBoYSYmKHRoaXMuX2RlZmluZXMuUkFESUFOQ0VPVkVSQUxQSEE9ITApLGkmJihzJiZpLmlzVmVydGljZXNEYXRhUHJlc2VudChlLlZlcnRleEJ1ZmZlci5Ob3JtYWxLaW5kKSYmKHRoaXMuX2RlZmluZXMuTk9STUFMPSEwKSxhJiYoaS5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZS5WZXJ0ZXhCdWZmZXIuVVZLaW5kKSYmKHRoaXMuX2RlZmluZXMuVVYxPSEwKSxpLmlzVmVydGljZXNEYXRhUHJlc2VudChlLlZlcnRleEJ1ZmZlci5VVjJLaW5kKSYmKHRoaXMuX2RlZmluZXMuVVYyPSEwKSksaS51c2VWZXJ0ZXhDb2xvcnMmJmkuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGUuVmVydGV4QnVmZmVyLkNvbG9yS2luZCkmJih0aGlzLl9kZWZpbmVzLlZFUlRFWENPTE9SPSEwLGkuaGFzVmVydGV4QWxwaGEmJih0aGlzLl9kZWZpbmVzLlZFUlRFWEFMUEhBPSEwKSksaS51c2VCb25lcyYmaS5jb21wdXRlQm9uZXNVc2luZ1NoYWRlcnMmJih0aGlzLl9kZWZpbmVzLk5VTV9CT05FX0lORkxVRU5DRVJTPWkubnVtQm9uZUluZmx1ZW5jZXJzLHRoaXMuX2RlZmluZXMuQm9uZXNQZXJNZXNoPWkuc2tlbGV0b24uYm9uZXMubGVuZ3RoKzEpLHImJih0aGlzLl9kZWZpbmVzLklOU1RBTkNFUz0hMCkpLCF0aGlzLl9kZWZpbmVzLmlzRXF1YWwodGhpcy5fY2FjaGVkRGVmaW5lcykpe3RoaXMuX2RlZmluZXMuY2xvbmVUbyh0aGlzLl9jYWNoZWREZWZpbmVzKSxuLnJlc2V0Q2FjaGVkTWF0ZXJpYWwoKTt2YXIgaD1uZXcgZS5FZmZlY3RGYWxsYmFja3M7dGhpcy5fZGVmaW5lcy5SRUZMRUNUSU9OJiZoLmFkZEZhbGxiYWNrKDAsXCJSRUZMRUNUSU9OXCIpLHRoaXMuX2RlZmluZXMuUkVGUkFDVElPTiYmaC5hZGRGYWxsYmFjaygwLFwiUkVGUkFDVElPTlwiKSx0aGlzLl9kZWZpbmVzLlJFRkxFQ1RJVklUWSYmaC5hZGRGYWxsYmFjaygwLFwiUkVGTEVDVElWSVRZXCIpLHRoaXMuX2RlZmluZXMuQlVNUCYmaC5hZGRGYWxsYmFjaygwLFwiQlVNUFwiKSx0aGlzLl9kZWZpbmVzLlBBUkFMTEFYJiZoLmFkZEZhbGxiYWNrKDEsXCJQQVJBTExBWFwiKSx0aGlzLl9kZWZpbmVzLlBBUkFMTEFYT0NDTFVTSU9OJiZoLmFkZEZhbGxiYWNrKDAsXCJQQVJBTExBWE9DQ0xVU0lPTlwiKSx0aGlzLl9kZWZpbmVzLlNQRUNVTEFST1ZFUkFMUEhBJiZoLmFkZEZhbGxiYWNrKDAsXCJTUEVDVUxBUk9WRVJBTFBIQVwiKSx0aGlzLl9kZWZpbmVzLkZPRyYmaC5hZGRGYWxsYmFjaygxLFwiRk9HXCIpLHRoaXMuX2RlZmluZXMuUE9JTlRTSVpFJiZoLmFkZEZhbGxiYWNrKDAsXCJQT0lOVFNJWkVcIiksdGhpcy5fZGVmaW5lcy5MT0dBUklUSE1JQ0RFUFRIJiZoLmFkZEZhbGxiYWNrKDAsXCJMT0dBUklUSE1JQ0RFUFRIXCIpLGUuTWF0ZXJpYWxIZWxwZXIuSGFuZGxlRmFsbGJhY2tzRm9yU2hhZG93cyh0aGlzLl9kZWZpbmVzLGgsdGhpcy5tYXhTaW11bHRhbmVvdXNMaWdodHMpLHRoaXMuX2RlZmluZXMuU1BFQ1VMQVJURVJNJiZoLmFkZEZhbGxiYWNrKDAsXCJTUEVDVUxBUlRFUk1cIiksdGhpcy5fZGVmaW5lcy5PUEFDSVRZRlJFU05FTCYmaC5hZGRGYWxsYmFjaygxLFwiT1BBQ0lUWUZSRVNORUxcIiksdGhpcy5fZGVmaW5lcy5FTUlTU0lWRUZSRVNORUwmJmguYWRkRmFsbGJhY2soMixcIkVNSVNTSVZFRlJFU05FTFwiKSx0aGlzLl9kZWZpbmVzLkZSRVNORUwmJmguYWRkRmFsbGJhY2soMyxcIkZSRVNORUxcIiksdGhpcy5fZGVmaW5lcy5OVU1fQk9ORV9JTkZMVUVOQ0VSUz4wJiZoLmFkZENQVVNraW5uaW5nRmFsbGJhY2soMCxpKTt2YXIgYz1bZS5WZXJ0ZXhCdWZmZXIuUG9zaXRpb25LaW5kXTt0aGlzLl9kZWZpbmVzLk5PUk1BTCYmYy5wdXNoKGUuVmVydGV4QnVmZmVyLk5vcm1hbEtpbmQpLHRoaXMuX2RlZmluZXMuVVYxJiZjLnB1c2goZS5WZXJ0ZXhCdWZmZXIuVVZLaW5kKSx0aGlzLl9kZWZpbmVzLlVWMiYmYy5wdXNoKGUuVmVydGV4QnVmZmVyLlVWMktpbmQpLHRoaXMuX2RlZmluZXMuVkVSVEVYQ09MT1ImJmMucHVzaChlLlZlcnRleEJ1ZmZlci5Db2xvcktpbmQpLGUuTWF0ZXJpYWxIZWxwZXIuUHJlcGFyZUF0dHJpYnV0ZXNGb3JCb25lcyhjLGksdGhpcy5fZGVmaW5lcyxoKSxlLk1hdGVyaWFsSGVscGVyLlByZXBhcmVBdHRyaWJ1dGVzRm9ySW5zdGFuY2VzKGMsdGhpcy5fZGVmaW5lcyk7dmFyIGw9XCJwYnJcIjtuLmdldEVuZ2luZSgpLmdldENhcHMoKS5zdGFuZGFyZERlcml2YXRpdmVzfHwobD1cImxlZ2FjeXBiclwiKTt2YXIgdT10aGlzLl9kZWZpbmVzLnRvU3RyaW5nKCksZj1bXCJ3b3JsZFwiLFwidmlld1wiLFwidmlld1Byb2plY3Rpb25cIixcInZFeWVQb3NpdGlvblwiLFwidkxpZ2h0c1R5cGVcIixcInZBbWJpZW50Q29sb3JcIixcInZBbGJlZG9Db2xvclwiLFwidlJlZmxlY3Rpdml0eUNvbG9yXCIsXCJ2RW1pc3NpdmVDb2xvclwiLFwidlJlZmxlY3Rpb25Db2xvclwiLFwidkZvZ0luZm9zXCIsXCJ2Rm9nQ29sb3JcIixcInBvaW50U2l6ZVwiLFwidkFsYmVkb0luZm9zXCIsXCJ2QW1iaWVudEluZm9zXCIsXCJ2T3BhY2l0eUluZm9zXCIsXCJ2UmVmbGVjdGlvbkluZm9zXCIsXCJ2RW1pc3NpdmVJbmZvc1wiLFwidlJlZmxlY3Rpdml0eUluZm9zXCIsXCJ2QnVtcEluZm9zXCIsXCJ2TGlnaHRtYXBJbmZvc1wiLFwidlJlZnJhY3Rpb25JbmZvc1wiLFwibUJvbmVzXCIsXCJ2Q2xpcFBsYW5lXCIsXCJhbGJlZG9NYXRyaXhcIixcImFtYmllbnRNYXRyaXhcIixcIm9wYWNpdHlNYXRyaXhcIixcInJlZmxlY3Rpb25NYXRyaXhcIixcImVtaXNzaXZlTWF0cml4XCIsXCJyZWZsZWN0aXZpdHlNYXRyaXhcIixcImJ1bXBNYXRyaXhcIixcImxpZ2h0bWFwTWF0cml4XCIsXCJyZWZyYWN0aW9uTWF0cml4XCIsXCJkZXB0aFZhbHVlc1wiLFwib3BhY2l0eVBhcnRzXCIsXCJlbWlzc2l2ZUxlZnRDb2xvclwiLFwiZW1pc3NpdmVSaWdodENvbG9yXCIsXCJ2TGlnaHRpbmdJbnRlbnNpdHlcIixcInZPdmVybG9hZGVkU2hhZG93SW50ZW5zaXR5XCIsXCJ2T3ZlcmxvYWRlZEludGVuc2l0eVwiLFwidk92ZXJsb2FkZWRBbGJlZG9cIixcInZPdmVybG9hZGVkUmVmbGVjdGlvblwiLFwidk92ZXJsb2FkZWRSZWZsZWN0aXZpdHlcIixcInZPdmVybG9hZGVkRW1pc3NpdmVcIixcInZPdmVybG9hZGVkTWljcm9TdXJmYWNlXCIsXCJsb2dhcml0aG1pY0RlcHRoQ29uc3RhbnRcIixcInZTcGhlcmljYWxYXCIsXCJ2U3BoZXJpY2FsWVwiLFwidlNwaGVyaWNhbFpcIixcInZTcGhlcmljYWxYWFwiLFwidlNwaGVyaWNhbFlZXCIsXCJ2U3BoZXJpY2FsWlpcIixcInZTcGhlcmljYWxYWVwiLFwidlNwaGVyaWNhbFlaXCIsXCJ2U3BoZXJpY2FsWlhcIixcInZNaWNyb3N1cmZhY2VUZXh0dXJlTG9kc1wiLFwidkNhbWVyYUluZm9zXCIsXCJ2Q2FtZXJhQ29sb3JHcmFkaW5nSW5mb3NcIixcInZDYW1lcmFDb2xvckdyYWRpbmdTY2FsZU9mZnNldFwiXSxkPVtcImFsYmVkb1NhbXBsZXJcIixcImFtYmllbnRTYW1wbGVyXCIsXCJvcGFjaXR5U2FtcGxlclwiLFwicmVmbGVjdGlvbkN1YmVTYW1wbGVyXCIsXCJyZWZsZWN0aW9uMkRTYW1wbGVyXCIsXCJlbWlzc2l2ZVNhbXBsZXJcIixcInJlZmxlY3Rpdml0eVNhbXBsZXJcIixcImJ1bXBTYW1wbGVyXCIsXCJsaWdodG1hcFNhbXBsZXJcIixcInJlZnJhY3Rpb25DdWJlU2FtcGxlclwiLFwicmVmcmFjdGlvbjJEU2FtcGxlclwiLFwiY2FtZXJhQ29sb3JHcmFkaW5nMkRTYW1wbGVyXCJdO2UuQ29sb3JDdXJ2ZXMuUHJlcGFyZVVuaWZvcm1zKGYpLGUuTWF0ZXJpYWxIZWxwZXIuUHJlcGFyZVVuaWZvcm1zQW5kU2FtcGxlcnNMaXN0KGYsZCx0aGlzLl9kZWZpbmVzLHRoaXMubWF4U2ltdWx0YW5lb3VzTGlnaHRzKSx0aGlzLl9lZmZlY3Q9bi5nZXRFbmdpbmUoKS5jcmVhdGVFZmZlY3QobCxjLGYsZCx1LGgsdGhpcy5vbkNvbXBpbGVkLHRoaXMub25FcnJvcix7bWF4U2ltdWx0YW5lb3VzTGlnaHRzOnRoaXMubWF4U2ltdWx0YW5lb3VzTGlnaHRzfSl9cmV0dXJuIHRoaXMuX2VmZmVjdC5pc1JlYWR5KCk/KHRoaXMuX3JlbmRlcklkPW4uZ2V0UmVuZGVySWQoKSx0aGlzLl93YXNQcmV2aW91c2x5UmVhZHk9ITAsaSYmKGkuX21hdGVyaWFsRGVmaW5lc3x8KGkuX21hdGVyaWFsRGVmaW5lcz1uZXcgdCksdGhpcy5fZGVmaW5lcy5jbG9uZVRvKGkuX21hdGVyaWFsRGVmaW5lcykpLCEwKTohMX0sci5wcm90b3R5cGUudW5iaW5kPWZ1bmN0aW9uKCl7dGhpcy5yZWZsZWN0aW9uVGV4dHVyZSYmdGhpcy5yZWZsZWN0aW9uVGV4dHVyZS5pc1JlbmRlclRhcmdldCYmdGhpcy5fZWZmZWN0LnNldFRleHR1cmUoXCJyZWZsZWN0aW9uMkRTYW1wbGVyXCIsbnVsbCksdGhpcy5yZWZyYWN0aW9uVGV4dHVyZSYmdGhpcy5yZWZyYWN0aW9uVGV4dHVyZS5pc1JlbmRlclRhcmdldCYmdGhpcy5fZWZmZWN0LnNldFRleHR1cmUoXCJyZWZyYWN0aW9uMkRTYW1wbGVyXCIsbnVsbCksaS5wcm90b3R5cGUudW5iaW5kLmNhbGwodGhpcyl9LHIucHJvdG90eXBlLmJpbmRPbmx5V29ybGRNYXRyaXg9ZnVuY3Rpb24oZSl7dGhpcy5fZWZmZWN0LnNldE1hdHJpeChcIndvcmxkXCIsZSl9LHIucHJvdG90eXBlLmJpbmQ9ZnVuY3Rpb24odCxuKXtpZih0aGlzLl9teVNjZW5lPXRoaXMuZ2V0U2NlbmUoKSx0aGlzLmJpbmRPbmx5V29ybGRNYXRyaXgodCksZS5NYXRlcmlhbEhlbHBlci5CaW5kQm9uZXNQYXJhbWV0ZXJzKG4sdGhpcy5fZWZmZWN0KSx0aGlzLl9teVNjZW5lLmdldENhY2hlZE1hdGVyaWFsKCkhPT10aGlzKXtpZih0aGlzLl9lZmZlY3Quc2V0TWF0cml4KFwidmlld1Byb2plY3Rpb25cIix0aGlzLl9teVNjZW5lLmdldFRyYW5zZm9ybU1hdHJpeCgpKSxlLlN0YW5kYXJkTWF0ZXJpYWwuRnJlc25lbEVuYWJsZWQmJih0aGlzLm9wYWNpdHlGcmVzbmVsUGFyYW1ldGVycyYmdGhpcy5vcGFjaXR5RnJlc25lbFBhcmFtZXRlcnMuaXNFbmFibGVkJiZ0aGlzLl9lZmZlY3Quc2V0Q29sb3I0KFwib3BhY2l0eVBhcnRzXCIsbmV3IGUuQ29sb3IzKHRoaXMub3BhY2l0eUZyZXNuZWxQYXJhbWV0ZXJzLmxlZnRDb2xvci50b0x1bWluYW5jZSgpLHRoaXMub3BhY2l0eUZyZXNuZWxQYXJhbWV0ZXJzLnJpZ2h0Q29sb3IudG9MdW1pbmFuY2UoKSx0aGlzLm9wYWNpdHlGcmVzbmVsUGFyYW1ldGVycy5iaWFzKSx0aGlzLm9wYWNpdHlGcmVzbmVsUGFyYW1ldGVycy5wb3dlciksdGhpcy5lbWlzc2l2ZUZyZXNuZWxQYXJhbWV0ZXJzJiZ0aGlzLmVtaXNzaXZlRnJlc25lbFBhcmFtZXRlcnMuaXNFbmFibGVkJiYodGhpcy5fZWZmZWN0LnNldENvbG9yNChcImVtaXNzaXZlTGVmdENvbG9yXCIsdGhpcy5lbWlzc2l2ZUZyZXNuZWxQYXJhbWV0ZXJzLmxlZnRDb2xvcix0aGlzLmVtaXNzaXZlRnJlc25lbFBhcmFtZXRlcnMucG93ZXIpLHRoaXMuX2VmZmVjdC5zZXRDb2xvcjQoXCJlbWlzc2l2ZVJpZ2h0Q29sb3JcIix0aGlzLmVtaXNzaXZlRnJlc25lbFBhcmFtZXRlcnMucmlnaHRDb2xvcix0aGlzLmVtaXNzaXZlRnJlc25lbFBhcmFtZXRlcnMuYmlhcykpKSx0aGlzLl9teVNjZW5lLnRleHR1cmVzRW5hYmxlZCl7aWYodGhpcy5hbGJlZG9UZXh0dXJlJiZlLlN0YW5kYXJkTWF0ZXJpYWwuRGlmZnVzZVRleHR1cmVFbmFibGVkJiYodGhpcy5fZWZmZWN0LnNldFRleHR1cmUoXCJhbGJlZG9TYW1wbGVyXCIsdGhpcy5hbGJlZG9UZXh0dXJlKSx0aGlzLl9lZmZlY3Quc2V0RmxvYXQyKFwidkFsYmVkb0luZm9zXCIsdGhpcy5hbGJlZG9UZXh0dXJlLmNvb3JkaW5hdGVzSW5kZXgsdGhpcy5hbGJlZG9UZXh0dXJlLmxldmVsKSx0aGlzLl9lZmZlY3Quc2V0TWF0cml4KFwiYWxiZWRvTWF0cml4XCIsdGhpcy5hbGJlZG9UZXh0dXJlLmdldFRleHR1cmVNYXRyaXgoKSkpLHRoaXMuYW1iaWVudFRleHR1cmUmJmUuU3RhbmRhcmRNYXRlcmlhbC5BbWJpZW50VGV4dHVyZUVuYWJsZWQmJih0aGlzLl9lZmZlY3Quc2V0VGV4dHVyZShcImFtYmllbnRTYW1wbGVyXCIsdGhpcy5hbWJpZW50VGV4dHVyZSksdGhpcy5fZWZmZWN0LnNldEZsb2F0MihcInZBbWJpZW50SW5mb3NcIix0aGlzLmFtYmllbnRUZXh0dXJlLmNvb3JkaW5hdGVzSW5kZXgsdGhpcy5hbWJpZW50VGV4dHVyZS5sZXZlbCksdGhpcy5fZWZmZWN0LnNldE1hdHJpeChcImFtYmllbnRNYXRyaXhcIix0aGlzLmFtYmllbnRUZXh0dXJlLmdldFRleHR1cmVNYXRyaXgoKSkpLHRoaXMub3BhY2l0eVRleHR1cmUmJmUuU3RhbmRhcmRNYXRlcmlhbC5PcGFjaXR5VGV4dHVyZUVuYWJsZWQmJih0aGlzLl9lZmZlY3Quc2V0VGV4dHVyZShcIm9wYWNpdHlTYW1wbGVyXCIsdGhpcy5vcGFjaXR5VGV4dHVyZSksdGhpcy5fZWZmZWN0LnNldEZsb2F0MihcInZPcGFjaXR5SW5mb3NcIix0aGlzLm9wYWNpdHlUZXh0dXJlLmNvb3JkaW5hdGVzSW5kZXgsdGhpcy5vcGFjaXR5VGV4dHVyZS5sZXZlbCksdGhpcy5fZWZmZWN0LnNldE1hdHJpeChcIm9wYWNpdHlNYXRyaXhcIix0aGlzLm9wYWNpdHlUZXh0dXJlLmdldFRleHR1cmVNYXRyaXgoKSkpLHRoaXMucmVmbGVjdGlvblRleHR1cmUmJmUuU3RhbmRhcmRNYXRlcmlhbC5SZWZsZWN0aW9uVGV4dHVyZUVuYWJsZWQmJih0aGlzLl9taWNyb3N1cmZhY2VUZXh0dXJlTG9kcy54PU1hdGgucm91bmQoTWF0aC5sb2codGhpcy5yZWZsZWN0aW9uVGV4dHVyZS5nZXRTaXplKCkud2lkdGgpKk1hdGguTE9HMkUpLHRoaXMucmVmbGVjdGlvblRleHR1cmUuaXNDdWJlP3RoaXMuX2VmZmVjdC5zZXRUZXh0dXJlKFwicmVmbGVjdGlvbkN1YmVTYW1wbGVyXCIsdGhpcy5yZWZsZWN0aW9uVGV4dHVyZSk6dGhpcy5fZWZmZWN0LnNldFRleHR1cmUoXCJyZWZsZWN0aW9uMkRTYW1wbGVyXCIsdGhpcy5yZWZsZWN0aW9uVGV4dHVyZSksdGhpcy5fZWZmZWN0LnNldE1hdHJpeChcInJlZmxlY3Rpb25NYXRyaXhcIix0aGlzLnJlZmxlY3Rpb25UZXh0dXJlLmdldFJlZmxlY3Rpb25UZXh0dXJlTWF0cml4KCkpLHRoaXMuX2VmZmVjdC5zZXRGbG9hdDIoXCJ2UmVmbGVjdGlvbkluZm9zXCIsdGhpcy5yZWZsZWN0aW9uVGV4dHVyZS5sZXZlbCwwKSx0aGlzLl9kZWZpbmVzLlVTRVNQSEVSSUNBTEZST01SRUZMRUNUSU9OTUFQJiYodGhpcy5fZWZmZWN0LnNldEZsb2F0MyhcInZTcGhlcmljYWxYXCIsdGhpcy5yZWZsZWN0aW9uVGV4dHVyZS5zcGhlcmljYWxQb2x5bm9taWFsLngueCx0aGlzLnJlZmxlY3Rpb25UZXh0dXJlLnNwaGVyaWNhbFBvbHlub21pYWwueC55LHRoaXMucmVmbGVjdGlvblRleHR1cmUuc3BoZXJpY2FsUG9seW5vbWlhbC54LnopLHRoaXMuX2VmZmVjdC5zZXRGbG9hdDMoXCJ2U3BoZXJpY2FsWVwiLHRoaXMucmVmbGVjdGlvblRleHR1cmUuc3BoZXJpY2FsUG9seW5vbWlhbC55LngsdGhpcy5yZWZsZWN0aW9uVGV4dHVyZS5zcGhlcmljYWxQb2x5bm9taWFsLnkueSx0aGlzLnJlZmxlY3Rpb25UZXh0dXJlLnNwaGVyaWNhbFBvbHlub21pYWwueS56KSx0aGlzLl9lZmZlY3Quc2V0RmxvYXQzKFwidlNwaGVyaWNhbFpcIix0aGlzLnJlZmxlY3Rpb25UZXh0dXJlLnNwaGVyaWNhbFBvbHlub21pYWwuei54LHRoaXMucmVmbGVjdGlvblRleHR1cmUuc3BoZXJpY2FsUG9seW5vbWlhbC56LnksdGhpcy5yZWZsZWN0aW9uVGV4dHVyZS5zcGhlcmljYWxQb2x5bm9taWFsLnoueiksdGhpcy5fZWZmZWN0LnNldEZsb2F0MyhcInZTcGhlcmljYWxYWFwiLHRoaXMucmVmbGVjdGlvblRleHR1cmUuc3BoZXJpY2FsUG9seW5vbWlhbC54eC54LHRoaXMucmVmbGVjdGlvblRleHR1cmUuc3BoZXJpY2FsUG9seW5vbWlhbC54eC55LHRoaXMucmVmbGVjdGlvblRleHR1cmUuc3BoZXJpY2FsUG9seW5vbWlhbC54eC56KSx0aGlzLl9lZmZlY3Quc2V0RmxvYXQzKFwidlNwaGVyaWNhbFlZXCIsdGhpcy5yZWZsZWN0aW9uVGV4dHVyZS5zcGhlcmljYWxQb2x5bm9taWFsLnl5LngsdGhpcy5yZWZsZWN0aW9uVGV4dHVyZS5zcGhlcmljYWxQb2x5bm9taWFsLnl5LnksdGhpcy5yZWZsZWN0aW9uVGV4dHVyZS5zcGhlcmljYWxQb2x5bm9taWFsLnl5LnopLHRoaXMuX2VmZmVjdC5zZXRGbG9hdDMoXCJ2U3BoZXJpY2FsWlpcIix0aGlzLnJlZmxlY3Rpb25UZXh0dXJlLnNwaGVyaWNhbFBvbHlub21pYWwuenoueCx0aGlzLnJlZmxlY3Rpb25UZXh0dXJlLnNwaGVyaWNhbFBvbHlub21pYWwuenoueSx0aGlzLnJlZmxlY3Rpb25UZXh0dXJlLnNwaGVyaWNhbFBvbHlub21pYWwuenoueiksdGhpcy5fZWZmZWN0LnNldEZsb2F0MyhcInZTcGhlcmljYWxYWVwiLHRoaXMucmVmbGVjdGlvblRleHR1cmUuc3BoZXJpY2FsUG9seW5vbWlhbC54eS54LHRoaXMucmVmbGVjdGlvblRleHR1cmUuc3BoZXJpY2FsUG9seW5vbWlhbC54eS55LHRoaXMucmVmbGVjdGlvblRleHR1cmUuc3BoZXJpY2FsUG9seW5vbWlhbC54eS56KSx0aGlzLl9lZmZlY3Quc2V0RmxvYXQzKFwidlNwaGVyaWNhbFlaXCIsdGhpcy5yZWZsZWN0aW9uVGV4dHVyZS5zcGhlcmljYWxQb2x5bm9taWFsLnl6LngsdGhpcy5yZWZsZWN0aW9uVGV4dHVyZS5zcGhlcmljYWxQb2x5bm9taWFsLnl6LnksdGhpcy5yZWZsZWN0aW9uVGV4dHVyZS5zcGhlcmljYWxQb2x5bm9taWFsLnl6LnopLHRoaXMuX2VmZmVjdC5zZXRGbG9hdDMoXCJ2U3BoZXJpY2FsWlhcIix0aGlzLnJlZmxlY3Rpb25UZXh0dXJlLnNwaGVyaWNhbFBvbHlub21pYWwuengueCx0aGlzLnJlZmxlY3Rpb25UZXh0dXJlLnNwaGVyaWNhbFBvbHlub21pYWwuengueSx0aGlzLnJlZmxlY3Rpb25UZXh0dXJlLnNwaGVyaWNhbFBvbHlub21pYWwuengueikpKSx0aGlzLmVtaXNzaXZlVGV4dHVyZSYmZS5TdGFuZGFyZE1hdGVyaWFsLkVtaXNzaXZlVGV4dHVyZUVuYWJsZWQmJih0aGlzLl9lZmZlY3Quc2V0VGV4dHVyZShcImVtaXNzaXZlU2FtcGxlclwiLHRoaXMuZW1pc3NpdmVUZXh0dXJlKSx0aGlzLl9lZmZlY3Quc2V0RmxvYXQyKFwidkVtaXNzaXZlSW5mb3NcIix0aGlzLmVtaXNzaXZlVGV4dHVyZS5jb29yZGluYXRlc0luZGV4LHRoaXMuZW1pc3NpdmVUZXh0dXJlLmxldmVsKSx0aGlzLl9lZmZlY3Quc2V0TWF0cml4KFwiZW1pc3NpdmVNYXRyaXhcIix0aGlzLmVtaXNzaXZlVGV4dHVyZS5nZXRUZXh0dXJlTWF0cml4KCkpKSx0aGlzLmxpZ2h0bWFwVGV4dHVyZSYmZS5TdGFuZGFyZE1hdGVyaWFsLkxpZ2h0bWFwVGV4dHVyZUVuYWJsZWQmJih0aGlzLl9lZmZlY3Quc2V0VGV4dHVyZShcImxpZ2h0bWFwU2FtcGxlclwiLHRoaXMubGlnaHRtYXBUZXh0dXJlKSx0aGlzLl9lZmZlY3Quc2V0RmxvYXQyKFwidkxpZ2h0bWFwSW5mb3NcIix0aGlzLmxpZ2h0bWFwVGV4dHVyZS5jb29yZGluYXRlc0luZGV4LHRoaXMubGlnaHRtYXBUZXh0dXJlLmxldmVsKSx0aGlzLl9lZmZlY3Quc2V0TWF0cml4KFwibGlnaHRtYXBNYXRyaXhcIix0aGlzLmxpZ2h0bWFwVGV4dHVyZS5nZXRUZXh0dXJlTWF0cml4KCkpKSx0aGlzLnJlZmxlY3Rpdml0eVRleHR1cmUmJmUuU3RhbmRhcmRNYXRlcmlhbC5TcGVjdWxhclRleHR1cmVFbmFibGVkJiYodGhpcy5fZWZmZWN0LnNldFRleHR1cmUoXCJyZWZsZWN0aXZpdHlTYW1wbGVyXCIsdGhpcy5yZWZsZWN0aXZpdHlUZXh0dXJlKSx0aGlzLl9lZmZlY3Quc2V0RmxvYXQyKFwidlJlZmxlY3Rpdml0eUluZm9zXCIsdGhpcy5yZWZsZWN0aXZpdHlUZXh0dXJlLmNvb3JkaW5hdGVzSW5kZXgsdGhpcy5yZWZsZWN0aXZpdHlUZXh0dXJlLmxldmVsKSx0aGlzLl9lZmZlY3Quc2V0TWF0cml4KFwicmVmbGVjdGl2aXR5TWF0cml4XCIsdGhpcy5yZWZsZWN0aXZpdHlUZXh0dXJlLmdldFRleHR1cmVNYXRyaXgoKSkpLHRoaXMuYnVtcFRleHR1cmUmJnRoaXMuX215U2NlbmUuZ2V0RW5naW5lKCkuZ2V0Q2FwcygpLnN0YW5kYXJkRGVyaXZhdGl2ZXMmJmUuU3RhbmRhcmRNYXRlcmlhbC5CdW1wVGV4dHVyZUVuYWJsZWQmJiF0aGlzLmRpc2FibGVCdW1wTWFwJiYodGhpcy5fZWZmZWN0LnNldFRleHR1cmUoXCJidW1wU2FtcGxlclwiLHRoaXMuYnVtcFRleHR1cmUpLHRoaXMuX2VmZmVjdC5zZXRGbG9hdDMoXCJ2QnVtcEluZm9zXCIsdGhpcy5idW1wVGV4dHVyZS5jb29yZGluYXRlc0luZGV4LDEvdGhpcy5idW1wVGV4dHVyZS5sZXZlbCx0aGlzLnBhcmFsbGF4U2NhbGVCaWFzKSx0aGlzLl9lZmZlY3Quc2V0TWF0cml4KFwiYnVtcE1hdHJpeFwiLHRoaXMuYnVtcFRleHR1cmUuZ2V0VGV4dHVyZU1hdHJpeCgpKSksdGhpcy5yZWZyYWN0aW9uVGV4dHVyZSYmZS5TdGFuZGFyZE1hdGVyaWFsLlJlZnJhY3Rpb25UZXh0dXJlRW5hYmxlZCl7dGhpcy5fbWljcm9zdXJmYWNlVGV4dHVyZUxvZHMueT1NYXRoLnJvdW5kKE1hdGgubG9nKHRoaXMucmVmcmFjdGlvblRleHR1cmUuZ2V0U2l6ZSgpLndpZHRoKSpNYXRoLkxPRzJFKTt2YXIgbz0xO3RoaXMucmVmcmFjdGlvblRleHR1cmUuaXNDdWJlP3RoaXMuX2VmZmVjdC5zZXRUZXh0dXJlKFwicmVmcmFjdGlvbkN1YmVTYW1wbGVyXCIsdGhpcy5yZWZyYWN0aW9uVGV4dHVyZSk6KHRoaXMuX2VmZmVjdC5zZXRUZXh0dXJlKFwicmVmcmFjdGlvbjJEU2FtcGxlclwiLHRoaXMucmVmcmFjdGlvblRleHR1cmUpLHRoaXMuX2VmZmVjdC5zZXRNYXRyaXgoXCJyZWZyYWN0aW9uTWF0cml4XCIsdGhpcy5yZWZyYWN0aW9uVGV4dHVyZS5nZXRSZWZsZWN0aW9uVGV4dHVyZU1hdHJpeCgpKSx0aGlzLnJlZnJhY3Rpb25UZXh0dXJlLmRlcHRoJiYobz10aGlzLnJlZnJhY3Rpb25UZXh0dXJlLmRlcHRoKSksdGhpcy5fZWZmZWN0LnNldEZsb2F0NChcInZSZWZyYWN0aW9uSW5mb3NcIix0aGlzLnJlZnJhY3Rpb25UZXh0dXJlLmxldmVsLHRoaXMuaW5kZXhPZlJlZnJhY3Rpb24sbyx0aGlzLmludmVydFJlZnJhY3Rpb25ZPy0xOjEpfWlmKCh0aGlzLnJlZmxlY3Rpb25UZXh0dXJlfHx0aGlzLnJlZnJhY3Rpb25UZXh0dXJlKSYmdGhpcy5fZWZmZWN0LnNldEZsb2F0MihcInZNaWNyb3N1cmZhY2VUZXh0dXJlTG9kc1wiLHRoaXMuX21pY3Jvc3VyZmFjZVRleHR1cmVMb2RzLngsdGhpcy5fbWljcm9zdXJmYWNlVGV4dHVyZUxvZHMueSksdGhpcy5jYW1lcmFDb2xvckdyYWRpbmdUZXh0dXJlKXt0aGlzLl9lZmZlY3Quc2V0VGV4dHVyZShcImNhbWVyYUNvbG9yR3JhZGluZzJEU2FtcGxlclwiLHRoaXMuY2FtZXJhQ29sb3JHcmFkaW5nVGV4dHVyZSksdGhpcy5fY2FtZXJhQ29sb3JHcmFkaW5nSW5mb3MueD10aGlzLmNhbWVyYUNvbG9yR3JhZGluZ1RleHR1cmUubGV2ZWwsdGhpcy5fY2FtZXJhQ29sb3JHcmFkaW5nSW5mb3MueT10aGlzLmNhbWVyYUNvbG9yR3JhZGluZ1RleHR1cmUuZ2V0U2l6ZSgpLmhlaWdodCx0aGlzLl9jYW1lcmFDb2xvckdyYWRpbmdJbmZvcy56PXRoaXMuX2NhbWVyYUNvbG9yR3JhZGluZ0luZm9zLnktMSx0aGlzLl9jYW1lcmFDb2xvckdyYWRpbmdJbmZvcy53PTEvdGhpcy5fY2FtZXJhQ29sb3JHcmFkaW5nSW5mb3MueSx0aGlzLl9lZmZlY3Quc2V0RmxvYXQ0KFwidkNhbWVyYUNvbG9yR3JhZGluZ0luZm9zXCIsdGhpcy5fY2FtZXJhQ29sb3JHcmFkaW5nSW5mb3MueCx0aGlzLl9jYW1lcmFDb2xvckdyYWRpbmdJbmZvcy55LHRoaXMuX2NhbWVyYUNvbG9yR3JhZGluZ0luZm9zLnosdGhpcy5fY2FtZXJhQ29sb3JHcmFkaW5nSW5mb3Mudyk7dmFyIHM9dGhpcy5fY2FtZXJhQ29sb3JHcmFkaW5nSW5mb3Mudy90aGlzLl9jYW1lcmFDb2xvckdyYWRpbmdJbmZvcy55LGE9MS90aGlzLl9jYW1lcmFDb2xvckdyYWRpbmdJbmZvcy55O3RoaXMuX2NhbWVyYUNvbG9yR3JhZGluZ1NjYWxlT2Zmc2V0Lng9dGhpcy5fY2FtZXJhQ29sb3JHcmFkaW5nSW5mb3MueipzLHRoaXMuX2NhbWVyYUNvbG9yR3JhZGluZ1NjYWxlT2Zmc2V0Lnk9dGhpcy5fY2FtZXJhQ29sb3JHcmFkaW5nSW5mb3Muei90aGlzLl9jYW1lcmFDb2xvckdyYWRpbmdJbmZvcy55LHRoaXMuX2NhbWVyYUNvbG9yR3JhZGluZ1NjYWxlT2Zmc2V0Lno9LjUqcyx0aGlzLl9jYW1lcmFDb2xvckdyYWRpbmdTY2FsZU9mZnNldC53PS41KmEsdGhpcy5fZWZmZWN0LnNldEZsb2F0NChcInZDYW1lcmFDb2xvckdyYWRpbmdTY2FsZU9mZnNldFwiLHRoaXMuX2NhbWVyYUNvbG9yR3JhZGluZ1NjYWxlT2Zmc2V0LngsdGhpcy5fY2FtZXJhQ29sb3JHcmFkaW5nU2NhbGVPZmZzZXQueSx0aGlzLl9jYW1lcmFDb2xvckdyYWRpbmdTY2FsZU9mZnNldC56LHRoaXMuX2NhbWVyYUNvbG9yR3JhZGluZ1NjYWxlT2Zmc2V0LncpfX1lLk1hdGVyaWFsSGVscGVyLkJpbmRDbGlwUGxhbmUodGhpcy5fZWZmZWN0LHRoaXMuX215U2NlbmUpLHRoaXMucG9pbnRzQ2xvdWQmJnRoaXMuX2VmZmVjdC5zZXRGbG9hdChcInBvaW50U2l6ZVwiLHRoaXMucG9pbnRTaXplKSx0aGlzLl9teVNjZW5lLmFtYmllbnRDb2xvci5tdWx0aXBseVRvUmVmKHRoaXMuYW1iaWVudENvbG9yLHRoaXMuX2dsb2JhbEFtYmllbnRDb2xvciksdGhpcy5jb252ZXJ0Q29sb3JUb0xpbmVhclNwYWNlVG9SZWYodGhpcy5yZWZsZWN0aXZpdHlDb2xvcixyLl9zY2FsZWRSZWZsZWN0aXZpdHkpLHRoaXMuX2VmZmVjdC5zZXRWZWN0b3IzKFwidkV5ZVBvc2l0aW9uXCIsdGhpcy5fbXlTY2VuZS5fbWlycm9yZWRDYW1lcmFQb3NpdGlvbj90aGlzLl9teVNjZW5lLl9taXJyb3JlZENhbWVyYVBvc2l0aW9uOnRoaXMuX215U2NlbmUuYWN0aXZlQ2FtZXJhLnBvc2l0aW9uKSx0aGlzLl9lZmZlY3Quc2V0Q29sb3IzKFwidkFtYmllbnRDb2xvclwiLHRoaXMuX2dsb2JhbEFtYmllbnRDb2xvciksdGhpcy5fZWZmZWN0LnNldENvbG9yNChcInZSZWZsZWN0aXZpdHlDb2xvclwiLHIuX3NjYWxlZFJlZmxlY3Rpdml0eSx0aGlzLm1pY3JvU3VyZmFjZSksdGhpcy5jb252ZXJ0Q29sb3JUb0xpbmVhclNwYWNlVG9SZWYodGhpcy5lbWlzc2l2ZUNvbG9yLHIuX3NjYWxlZEVtaXNzaXZlKSx0aGlzLl9lZmZlY3Quc2V0Q29sb3IzKFwidkVtaXNzaXZlQ29sb3JcIixyLl9zY2FsZWRFbWlzc2l2ZSksdGhpcy5jb252ZXJ0Q29sb3JUb0xpbmVhclNwYWNlVG9SZWYodGhpcy5yZWZsZWN0aW9uQ29sb3Isci5fc2NhbGVkUmVmbGVjdGlvbiksdGhpcy5fZWZmZWN0LnNldENvbG9yMyhcInZSZWZsZWN0aW9uQ29sb3JcIixyLl9zY2FsZWRSZWZsZWN0aW9uKX10aGlzLl9teVNjZW5lLmdldENhY2hlZE1hdGVyaWFsKCk9PT10aGlzJiZ0aGlzLmlzRnJvemVufHwodGhpcy5jb252ZXJ0Q29sb3JUb0xpbmVhclNwYWNlVG9SZWYodGhpcy5hbGJlZG9Db2xvcixyLl9zY2FsZWRBbGJlZG8pLHRoaXMuX2VmZmVjdC5zZXRDb2xvcjQoXCJ2QWxiZWRvQ29sb3JcIixyLl9zY2FsZWRBbGJlZG8sdGhpcy5hbHBoYSpuLnZpc2liaWxpdHkpLHRoaXMuX215U2NlbmUubGlnaHRzRW5hYmxlZCYmIXRoaXMuZGlzYWJsZUxpZ2h0aW5nJiZyLkJpbmRMaWdodHModGhpcy5fbXlTY2VuZSxuLHRoaXMuX2VmZmVjdCx0aGlzLl9kZWZpbmVzLHRoaXMudXNlU2NhbGFySW5MaW5lYXJTcGFjZSx0aGlzLm1heFNpbXVsdGFuZW91c0xpZ2h0cyx0aGlzLnVzZVBoeXNpY2FsTGlnaHRGYWxsb2ZmKSwodGhpcy5fbXlTY2VuZS5mb2dFbmFibGVkJiZuLmFwcGx5Rm9nJiZ0aGlzLl9teVNjZW5lLmZvZ01vZGUhPT1lLlNjZW5lLkZPR01PREVfTk9ORXx8dGhpcy5yZWZsZWN0aW9uVGV4dHVyZSkmJnRoaXMuX2VmZmVjdC5zZXRNYXRyaXgoXCJ2aWV3XCIsdGhpcy5fbXlTY2VuZS5nZXRWaWV3TWF0cml4KCkpLGUuTWF0ZXJpYWxIZWxwZXIuQmluZEZvZ1BhcmFtZXRlcnModGhpcy5fbXlTY2VuZSxuLHRoaXMuX2VmZmVjdCksdGhpcy5fbGlnaHRpbmdJbmZvcy54PXRoaXMuZGlyZWN0SW50ZW5zaXR5LHRoaXMuX2xpZ2h0aW5nSW5mb3MueT10aGlzLmVtaXNzaXZlSW50ZW5zaXR5LHRoaXMuX2xpZ2h0aW5nSW5mb3Muej10aGlzLmVudmlyb25tZW50SW50ZW5zaXR5LHRoaXMuX2xpZ2h0aW5nSW5mb3Mudz10aGlzLnNwZWN1bGFySW50ZW5zaXR5LHRoaXMuX2VmZmVjdC5zZXRWZWN0b3I0KFwidkxpZ2h0aW5nSW50ZW5zaXR5XCIsdGhpcy5fbGlnaHRpbmdJbmZvcyksdGhpcy5fb3ZlcmxvYWRlZFNoYWRvd0luZm9zLng9dGhpcy5vdmVybG9hZGVkU2hhZG93SW50ZW5zaXR5LHRoaXMuX292ZXJsb2FkZWRTaGFkb3dJbmZvcy55PXRoaXMub3ZlcmxvYWRlZFNoYWRlSW50ZW5zaXR5LHRoaXMuX2VmZmVjdC5zZXRWZWN0b3I0KFwidk92ZXJsb2FkZWRTaGFkb3dJbnRlbnNpdHlcIix0aGlzLl9vdmVybG9hZGVkU2hhZG93SW5mb3MpLHRoaXMuX2NhbWVyYUluZm9zLng9dGhpcy5jYW1lcmFFeHBvc3VyZSx0aGlzLl9jYW1lcmFJbmZvcy55PXRoaXMuY2FtZXJhQ29udHJhc3QsdGhpcy5fZWZmZWN0LnNldFZlY3RvcjQoXCJ2Q2FtZXJhSW5mb3NcIix0aGlzLl9jYW1lcmFJbmZvcyksdGhpcy5jYW1lcmFDb2xvckN1cnZlcyYmZS5Db2xvckN1cnZlcy5CaW5kKHRoaXMuY2FtZXJhQ29sb3JDdXJ2ZXMsdGhpcy5fZWZmZWN0KSx0aGlzLl9vdmVybG9hZGVkSW50ZW5zaXR5Lng9dGhpcy5vdmVybG9hZGVkQW1iaWVudEludGVuc2l0eSx0aGlzLl9vdmVybG9hZGVkSW50ZW5zaXR5Lnk9dGhpcy5vdmVybG9hZGVkQWxiZWRvSW50ZW5zaXR5LHRoaXMuX292ZXJsb2FkZWRJbnRlbnNpdHkuej10aGlzLm92ZXJsb2FkZWRSZWZsZWN0aXZpdHlJbnRlbnNpdHksdGhpcy5fb3ZlcmxvYWRlZEludGVuc2l0eS53PXRoaXMub3ZlcmxvYWRlZEVtaXNzaXZlSW50ZW5zaXR5LHRoaXMuX2VmZmVjdC5zZXRWZWN0b3I0KFwidk92ZXJsb2FkZWRJbnRlbnNpdHlcIix0aGlzLl9vdmVybG9hZGVkSW50ZW5zaXR5KSx0aGlzLmNvbnZlcnRDb2xvclRvTGluZWFyU3BhY2VUb1JlZih0aGlzLm92ZXJsb2FkZWRBbWJpZW50LHRoaXMuX3RlbXBDb2xvciksdGhpcy5fZWZmZWN0LnNldENvbG9yMyhcInZPdmVybG9hZGVkQW1iaWVudFwiLHRoaXMuX3RlbXBDb2xvciksdGhpcy5jb252ZXJ0Q29sb3JUb0xpbmVhclNwYWNlVG9SZWYodGhpcy5vdmVybG9hZGVkQWxiZWRvLHRoaXMuX3RlbXBDb2xvciksdGhpcy5fZWZmZWN0LnNldENvbG9yMyhcInZPdmVybG9hZGVkQWxiZWRvXCIsdGhpcy5fdGVtcENvbG9yKSx0aGlzLmNvbnZlcnRDb2xvclRvTGluZWFyU3BhY2VUb1JlZih0aGlzLm92ZXJsb2FkZWRSZWZsZWN0aXZpdHksdGhpcy5fdGVtcENvbG9yKSx0aGlzLl9lZmZlY3Quc2V0Q29sb3IzKFwidk92ZXJsb2FkZWRSZWZsZWN0aXZpdHlcIix0aGlzLl90ZW1wQ29sb3IpLHRoaXMuY29udmVydENvbG9yVG9MaW5lYXJTcGFjZVRvUmVmKHRoaXMub3ZlcmxvYWRlZEVtaXNzaXZlLHRoaXMuX3RlbXBDb2xvciksdGhpcy5fZWZmZWN0LnNldENvbG9yMyhcInZPdmVybG9hZGVkRW1pc3NpdmVcIix0aGlzLl90ZW1wQ29sb3IpLHRoaXMuY29udmVydENvbG9yVG9MaW5lYXJTcGFjZVRvUmVmKHRoaXMub3ZlcmxvYWRlZFJlZmxlY3Rpb24sdGhpcy5fdGVtcENvbG9yKSx0aGlzLl9lZmZlY3Quc2V0Q29sb3IzKFwidk92ZXJsb2FkZWRSZWZsZWN0aW9uXCIsdGhpcy5fdGVtcENvbG9yKSx0aGlzLl9vdmVybG9hZGVkTWljcm9TdXJmYWNlLng9dGhpcy5vdmVybG9hZGVkTWljcm9TdXJmYWNlLHRoaXMuX292ZXJsb2FkZWRNaWNyb1N1cmZhY2UueT10aGlzLm92ZXJsb2FkZWRNaWNyb1N1cmZhY2VJbnRlbnNpdHksdGhpcy5fb3ZlcmxvYWRlZE1pY3JvU3VyZmFjZS56PXRoaXMub3ZlcmxvYWRlZFJlZmxlY3Rpb25JbnRlbnNpdHksdGhpcy5fZWZmZWN0LnNldFZlY3RvcjMoXCJ2T3ZlcmxvYWRlZE1pY3JvU3VyZmFjZVwiLHRoaXMuX292ZXJsb2FkZWRNaWNyb1N1cmZhY2UpLGUuTWF0ZXJpYWxIZWxwZXIuQmluZExvZ0RlcHRoKHRoaXMuX2RlZmluZXMsdGhpcy5fZWZmZWN0LHRoaXMuX215U2NlbmUpKSxpLnByb3RvdHlwZS5iaW5kLmNhbGwodGhpcyx0LG4pLHRoaXMuX215U2NlbmU9bnVsbH0sci5wcm90b3R5cGUuZ2V0QW5pbWF0YWJsZXM9ZnVuY3Rpb24oKXt2YXIgZT1bXTtyZXR1cm4gdGhpcy5hbGJlZG9UZXh0dXJlJiZ0aGlzLmFsYmVkb1RleHR1cmUuYW5pbWF0aW9ucyYmdGhpcy5hbGJlZG9UZXh0dXJlLmFuaW1hdGlvbnMubGVuZ3RoPjAmJmUucHVzaCh0aGlzLmFsYmVkb1RleHR1cmUpLHRoaXMuYW1iaWVudFRleHR1cmUmJnRoaXMuYW1iaWVudFRleHR1cmUuYW5pbWF0aW9ucyYmdGhpcy5hbWJpZW50VGV4dHVyZS5hbmltYXRpb25zLmxlbmd0aD4wJiZlLnB1c2godGhpcy5hbWJpZW50VGV4dHVyZSksdGhpcy5vcGFjaXR5VGV4dHVyZSYmdGhpcy5vcGFjaXR5VGV4dHVyZS5hbmltYXRpb25zJiZ0aGlzLm9wYWNpdHlUZXh0dXJlLmFuaW1hdGlvbnMubGVuZ3RoPjAmJmUucHVzaCh0aGlzLm9wYWNpdHlUZXh0dXJlKSx0aGlzLnJlZmxlY3Rpb25UZXh0dXJlJiZ0aGlzLnJlZmxlY3Rpb25UZXh0dXJlLmFuaW1hdGlvbnMmJnRoaXMucmVmbGVjdGlvblRleHR1cmUuYW5pbWF0aW9ucy5sZW5ndGg+MCYmZS5wdXNoKHRoaXMucmVmbGVjdGlvblRleHR1cmUpLHRoaXMuZW1pc3NpdmVUZXh0dXJlJiZ0aGlzLmVtaXNzaXZlVGV4dHVyZS5hbmltYXRpb25zJiZ0aGlzLmVtaXNzaXZlVGV4dHVyZS5hbmltYXRpb25zLmxlbmd0aD4wJiZlLnB1c2godGhpcy5lbWlzc2l2ZVRleHR1cmUpLHRoaXMucmVmbGVjdGl2aXR5VGV4dHVyZSYmdGhpcy5yZWZsZWN0aXZpdHlUZXh0dXJlLmFuaW1hdGlvbnMmJnRoaXMucmVmbGVjdGl2aXR5VGV4dHVyZS5hbmltYXRpb25zLmxlbmd0aD4wJiZlLnB1c2godGhpcy5yZWZsZWN0aXZpdHlUZXh0dXJlKSx0aGlzLmJ1bXBUZXh0dXJlJiZ0aGlzLmJ1bXBUZXh0dXJlLmFuaW1hdGlvbnMmJnRoaXMuYnVtcFRleHR1cmUuYW5pbWF0aW9ucy5sZW5ndGg+MCYmZS5wdXNoKHRoaXMuYnVtcFRleHR1cmUpLHRoaXMubGlnaHRtYXBUZXh0dXJlJiZ0aGlzLmxpZ2h0bWFwVGV4dHVyZS5hbmltYXRpb25zJiZ0aGlzLmxpZ2h0bWFwVGV4dHVyZS5hbmltYXRpb25zLmxlbmd0aD4wJiZlLnB1c2godGhpcy5saWdodG1hcFRleHR1cmUpLHRoaXMucmVmcmFjdGlvblRleHR1cmUmJnRoaXMucmVmcmFjdGlvblRleHR1cmUuYW5pbWF0aW9ucyYmdGhpcy5yZWZyYWN0aW9uVGV4dHVyZS5hbmltYXRpb25zLmxlbmd0aD4wJiZlLnB1c2godGhpcy5yZWZyYWN0aW9uVGV4dHVyZSksdGhpcy5jYW1lcmFDb2xvckdyYWRpbmdUZXh0dXJlJiZ0aGlzLmNhbWVyYUNvbG9yR3JhZGluZ1RleHR1cmUuYW5pbWF0aW9ucyYmdGhpcy5jYW1lcmFDb2xvckdyYWRpbmdUZXh0dXJlLmFuaW1hdGlvbnMubGVuZ3RoPjAmJmUucHVzaCh0aGlzLmNhbWVyYUNvbG9yR3JhZGluZ1RleHR1cmUpLGV9LHIucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oZSx0KXt0JiYodGhpcy5hbGJlZG9UZXh0dXJlJiZ0aGlzLmFsYmVkb1RleHR1cmUuZGlzcG9zZSgpLHRoaXMuYW1iaWVudFRleHR1cmUmJnRoaXMuYW1iaWVudFRleHR1cmUuZGlzcG9zZSgpLHRoaXMub3BhY2l0eVRleHR1cmUmJnRoaXMub3BhY2l0eVRleHR1cmUuZGlzcG9zZSgpLHRoaXMucmVmbGVjdGlvblRleHR1cmUmJnRoaXMucmVmbGVjdGlvblRleHR1cmUuZGlzcG9zZSgpLHRoaXMuZW1pc3NpdmVUZXh0dXJlJiZ0aGlzLmVtaXNzaXZlVGV4dHVyZS5kaXNwb3NlKCksdGhpcy5yZWZsZWN0aXZpdHlUZXh0dXJlJiZ0aGlzLnJlZmxlY3Rpdml0eVRleHR1cmUuZGlzcG9zZSgpLHRoaXMuYnVtcFRleHR1cmUmJnRoaXMuYnVtcFRleHR1cmUuZGlzcG9zZSgpLHRoaXMubGlnaHRtYXBUZXh0dXJlJiZ0aGlzLmxpZ2h0bWFwVGV4dHVyZS5kaXNwb3NlKCksdGhpcy5yZWZyYWN0aW9uVGV4dHVyZSYmdGhpcy5yZWZyYWN0aW9uVGV4dHVyZS5kaXNwb3NlKCksdGhpcy5jYW1lcmFDb2xvckdyYWRpbmdUZXh0dXJlJiZ0aGlzLmNhbWVyYUNvbG9yR3JhZGluZ1RleHR1cmUuZGlzcG9zZSgpKSxpLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyxlLHQpfSxyLnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbih0KXt2YXIgaT10aGlzO3JldHVybiBlLlNlcmlhbGl6YXRpb25IZWxwZXIuQ2xvbmUoZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHIodCxpLmdldFNjZW5lKCkpfSx0aGlzKX0sci5wcm90b3R5cGUuc2VyaWFsaXplPWZ1bmN0aW9uKCl7dmFyIHQ9ZS5TZXJpYWxpemF0aW9uSGVscGVyLlNlcmlhbGl6ZSh0aGlzKTtyZXR1cm4gdC5jdXN0b21UeXBlPVwiQkFCWUxPTi5QQlJNYXRlcmlhbFwiLHR9LHIuUGFyc2U9ZnVuY3Rpb24odCxpLG4pe3JldHVybiBlLlNlcmlhbGl6YXRpb25IZWxwZXIuUGFyc2UoZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHIodC5uYW1lLGkpfSx0LGksbil9LHIuX3NjYWxlZEFsYmVkbz1uZXcgZS5Db2xvcjMsci5fc2NhbGVkUmVmbGVjdGl2aXR5PW5ldyBlLkNvbG9yMyxyLl9zY2FsZWRFbWlzc2l2ZT1uZXcgZS5Db2xvcjMsci5fc2NhbGVkUmVmbGVjdGlvbj1uZXcgZS5Db2xvcjMsX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0sci5wcm90b3R5cGUsXCJkaXJlY3RJbnRlbnNpdHlcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHIucHJvdG90eXBlLFwiZW1pc3NpdmVJbnRlbnNpdHlcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHIucHJvdG90eXBlLFwiZW52aXJvbm1lbnRJbnRlbnNpdHlcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHIucHJvdG90eXBlLFwic3BlY3VsYXJJbnRlbnNpdHlcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHIucHJvdG90eXBlLFwiZGlzYWJsZUJ1bXBNYXBcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHIucHJvdG90eXBlLFwib3ZlcmxvYWRlZFNoYWRvd0ludGVuc2l0eVwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0sci5wcm90b3R5cGUsXCJvdmVybG9hZGVkU2hhZGVJbnRlbnNpdHlcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHIucHJvdG90eXBlLFwiY2FtZXJhRXhwb3N1cmVcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHIucHJvdG90eXBlLFwiY2FtZXJhQ29udHJhc3RcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplQXNUZXh0dXJlKCldLHIucHJvdG90eXBlLFwiY2FtZXJhQ29sb3JHcmFkaW5nVGV4dHVyZVwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemVBc0NvbG9yQ3VydmVzKCldLHIucHJvdG90eXBlLFwiY2FtZXJhQ29sb3JDdXJ2ZXNcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplQXNDb2xvcjMoKV0sci5wcm90b3R5cGUsXCJvdmVybG9hZGVkQW1iaWVudFwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0sci5wcm90b3R5cGUsXCJvdmVybG9hZGVkQW1iaWVudEludGVuc2l0eVwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemVBc0NvbG9yMygpXSxyLnByb3RvdHlwZSxcIm92ZXJsb2FkZWRBbGJlZG9cIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHIucHJvdG90eXBlLFwib3ZlcmxvYWRlZEFsYmVkb0ludGVuc2l0eVwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemVBc0NvbG9yMygpXSxyLnByb3RvdHlwZSxcIm92ZXJsb2FkZWRSZWZsZWN0aXZpdHlcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHIucHJvdG90eXBlLFwib3ZlcmxvYWRlZFJlZmxlY3Rpdml0eUludGVuc2l0eVwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemVBc0NvbG9yMygpXSxyLnByb3RvdHlwZSxcIm92ZXJsb2FkZWRFbWlzc2l2ZVwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0sci5wcm90b3R5cGUsXCJvdmVybG9hZGVkRW1pc3NpdmVJbnRlbnNpdHlcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplQXNDb2xvcjMoKV0sci5wcm90b3R5cGUsXCJvdmVybG9hZGVkUmVmbGVjdGlvblwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0sci5wcm90b3R5cGUsXCJvdmVybG9hZGVkUmVmbGVjdGlvbkludGVuc2l0eVwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0sci5wcm90b3R5cGUsXCJvdmVybG9hZGVkTWljcm9TdXJmYWNlXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSxyLnByb3RvdHlwZSxcIm92ZXJsb2FkZWRNaWNyb1N1cmZhY2VJbnRlbnNpdHlcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplQXNUZXh0dXJlKCldLHIucHJvdG90eXBlLFwiYWxiZWRvVGV4dHVyZVwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemVBc1RleHR1cmUoKV0sci5wcm90b3R5cGUsXCJhbWJpZW50VGV4dHVyZVwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemVBc1RleHR1cmUoKV0sci5wcm90b3R5cGUsXCJvcGFjaXR5VGV4dHVyZVwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemVBc1RleHR1cmUoKV0sci5wcm90b3R5cGUsXCJyZWZsZWN0aW9uVGV4dHVyZVwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemVBc1RleHR1cmUoKV0sci5wcm90b3R5cGUsXCJlbWlzc2l2ZVRleHR1cmVcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplQXNUZXh0dXJlKCldLHIucHJvdG90eXBlLFwicmVmbGVjdGl2aXR5VGV4dHVyZVwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemVBc1RleHR1cmUoKV0sci5wcm90b3R5cGUsXCJidW1wVGV4dHVyZVwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemVBc1RleHR1cmUoKV0sci5wcm90b3R5cGUsXCJsaWdodG1hcFRleHR1cmVcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplQXNUZXh0dXJlKCldLHIucHJvdG90eXBlLFwicmVmcmFjdGlvblRleHR1cmVcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplQXNDb2xvcjMoXCJhbWJpZW50XCIpXSxyLnByb3RvdHlwZSxcImFtYmllbnRDb2xvclwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemVBc0NvbG9yMyhcImFsYmVkb1wiKV0sci5wcm90b3R5cGUsXCJhbGJlZG9Db2xvclwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemVBc0NvbG9yMyhcInJlZmxlY3Rpdml0eVwiKV0sci5wcm90b3R5cGUsXCJyZWZsZWN0aXZpdHlDb2xvclwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemVBc0NvbG9yMyhcInJlZmxlY3Rpb25cIildLHIucHJvdG90eXBlLFwicmVmbGVjdGlvbkNvbG9yXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZUFzQ29sb3IzKFwiZW1pc3NpdmVcIildLHIucHJvdG90eXBlLFwiZW1pc3NpdmVDb2xvclwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0sci5wcm90b3R5cGUsXCJtaWNyb1N1cmZhY2VcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHIucHJvdG90eXBlLFwiaW5kZXhPZlJlZnJhY3Rpb25cIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHIucHJvdG90eXBlLFwiaW52ZXJ0UmVmcmFjdGlvbllcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplQXNGcmVzbmVsUGFyYW1ldGVycygpXSxyLnByb3RvdHlwZSxcIm9wYWNpdHlGcmVzbmVsUGFyYW1ldGVyc1wiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemVBc0ZyZXNuZWxQYXJhbWV0ZXJzKCldLHIucHJvdG90eXBlLFwiZW1pc3NpdmVGcmVzbmVsUGFyYW1ldGVyc1wiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0sci5wcm90b3R5cGUsXCJsaW5rUmVmcmFjdGlvbldpdGhUcmFuc3BhcmVuY3lcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHIucHJvdG90eXBlLFwibGlua0VtaXNzaXZlV2l0aEFsYmVkb1wiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0sci5wcm90b3R5cGUsXCJ1c2VMaWdodG1hcEFzU2hhZG93bWFwXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSxyLnByb3RvdHlwZSxcInVzZUVtaXNzaXZlQXNJbGx1bWluYXRpb25cIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHIucHJvdG90eXBlLFwidXNlQWxwaGFGcm9tQWxiZWRvVGV4dHVyZVwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0sci5wcm90b3R5cGUsXCJ1c2VTcGVjdWxhck92ZXJBbHBoYVwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0sci5wcm90b3R5cGUsXCJ1c2VNaWNyb1N1cmZhY2VGcm9tUmVmbGVjdGl2aXR5TWFwQWxwaGFcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHIucHJvdG90eXBlLFwidXNlQXV0b01pY3JvU3VyZmFjZUZyb21SZWZsZWN0aXZpdHlNYXBcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHIucHJvdG90eXBlLFwidXNlU2NhbGFySW5MaW5lYXJTcGFjZVwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0sci5wcm90b3R5cGUsXCJ1c2VQaHlzaWNhbExpZ2h0RmFsbG9mZlwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0sci5wcm90b3R5cGUsXCJ1c2VSYWRpYW5jZU92ZXJBbHBoYVwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0sci5wcm90b3R5cGUsXCJ1c2VQYXJhbGxheFwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0sci5wcm90b3R5cGUsXCJ1c2VQYXJhbGxheE9jY2x1c2lvblwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0sci5wcm90b3R5cGUsXCJwYXJhbGxheFNjYWxlQmlhc1wiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0sci5wcm90b3R5cGUsXCJkaXNhYmxlTGlnaHRpbmdcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHIucHJvdG90eXBlLFwibWF4U2ltdWx0YW5lb3VzTGlnaHRzXCIsdm9pZCAwKSxfX2RlY29yYXRlKFtlLnNlcmlhbGl6ZSgpXSxyLnByb3RvdHlwZSxcImludmVydE5vcm1hbE1hcFhcIix2b2lkIDApLF9fZGVjb3JhdGUoW2Uuc2VyaWFsaXplKCldLHIucHJvdG90eXBlLFwiaW52ZXJ0Tm9ybWFsTWFwWVwiLHZvaWQgMCksX19kZWNvcmF0ZShbZS5zZXJpYWxpemUoKV0sci5wcm90b3R5cGUsXCJ1c2VMb2dhcml0aG1pY0RlcHRoXCIsbnVsbCkscn0oZS5NYXRlcmlhbCk7ZS5QQlJNYXRlcmlhbD1pfShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCl7dmFyIGk9dGhpczt0aGlzLl90cmFuc2Zvcm1hdGlvbk1hdHJpeD1lLk1hdHJpeC5JZGVudGl0eSgpLHRoaXMuX2VuYWJsZWQ9ITEsdGhpcy5fbGFiZWxzRW5hYmxlZD0hMSx0aGlzLl9kaXNwbGF5U3RhdGlzdGljcz0hMCx0aGlzLl9kaXNwbGF5VHJlZT0hMSx0aGlzLl9kaXNwbGF5TG9ncz0hMSx0aGlzLl9za2VsZXRvblZpZXdlcnM9bmV3IEFycmF5LHRoaXMuX2lkZW50aXR5TWF0cml4PWUuTWF0cml4LklkZW50aXR5KCksdGhpcy5heGlzUmF0aW89LjAyLHRoaXMuYWNjZW50Q29sb3I9XCJvcmFuZ2VcIix0aGlzLl9zY2VuZT10LHRoaXMuX3N5bmNQb3NpdGlvbnM9ZnVuY3Rpb24oKXt2YXIgZT1pLl9zY2VuZS5nZXRFbmdpbmUoKSx0PWUuZ2V0UmVuZGVyaW5nQ2FudmFzQ2xpZW50UmVjdCgpO2kuX3Nob3dVSSYmKGkuX3N0YXRzRGl2LnN0eWxlLmxlZnQ9dC53aWR0aC00MTArXCJweFwiLGkuX3N0YXRzRGl2LnN0eWxlLnRvcD10LmhlaWdodC0yOTArXCJweFwiLGkuX3N0YXRzRGl2LnN0eWxlLndpZHRoPVwiNDAwcHhcIixpLl9zdGF0c0Rpdi5zdHlsZS5oZWlnaHQ9XCJhdXRvXCIsaS5fc3RhdHNTdWJzZXREaXYuc3R5bGUubWF4SGVpZ2h0PVwiMjQwcHhcIixpLl9vcHRpb25zRGl2LnN0eWxlLmxlZnQ9XCIwcHhcIixpLl9vcHRpb25zRGl2LnN0eWxlLnRvcD1cIjEwcHhcIixpLl9vcHRpb25zRGl2LnN0eWxlLndpZHRoPVwiMjAwcHhcIixpLl9vcHRpb25zRGl2LnN0eWxlLmhlaWdodD1cImF1dG9cIixpLl9vcHRpb25zU3Vic2V0RGl2LnN0eWxlLm1heEhlaWdodD10LmhlaWdodC0yMjUrXCJweFwiLGkuX2xvZ0Rpdi5zdHlsZS5sZWZ0PVwiMHB4XCIsaS5fbG9nRGl2LnN0eWxlLnRvcD10LmhlaWdodC0xNzArXCJweFwiLGkuX2xvZ0Rpdi5zdHlsZS53aWR0aD1cIjYwMHB4XCIsaS5fbG9nRGl2LnN0eWxlLmhlaWdodD1cIjE2MHB4XCIsaS5fdHJlZURpdi5zdHlsZS5sZWZ0PXQud2lkdGgtMzEwK1wicHhcIixpLl90cmVlRGl2LnN0eWxlLnRvcD1cIjEwcHhcIixpLl90cmVlRGl2LnN0eWxlLndpZHRoPVwiMzAwcHhcIixpLl90cmVlRGl2LnN0eWxlLmhlaWdodD1cImF1dG9cIixpLl90cmVlU3Vic2V0RGl2LnN0eWxlLm1heEhlaWdodD10LmhlaWdodC0zNDArXCJweFwiKSxpLl9nbG9iYWxEaXYuc3R5bGUubGVmdD10LmxlZnQrXCJweFwiLGkuX2dsb2JhbERpdi5zdHlsZS50b3A9dC50b3ArXCJweFwiLGkuX2RyYXdpbmdDYW52YXMuc3R5bGUubGVmdD1cIjBweFwiLGkuX2RyYXdpbmdDYW52YXMuc3R5bGUudG9wPVwiMHB4XCIsaS5fZHJhd2luZ0NhbnZhcy5zdHlsZS53aWR0aD1lLmdldFJlbmRlcldpZHRoKCkrXCJweFwiLGkuX2RyYXdpbmdDYW52YXMuc3R5bGUuaGVpZ2h0PWUuZ2V0UmVuZGVySGVpZ2h0KCkrXCJweFwiO3ZhciByPXdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvfHwxLG49aS5fZHJhd2luZ0NvbnRleHQsbz1uLndlYmtpdEJhY2tpbmdTdG9yZVBpeGVsUmF0aW98fG4ubW96QmFja2luZ1N0b3JlUGl4ZWxSYXRpb3x8bi5tc0JhY2tpbmdTdG9yZVBpeGVsUmF0aW98fG4ub0JhY2tpbmdTdG9yZVBpeGVsUmF0aW98fG4uYmFja2luZ1N0b3JlUGl4ZWxSYXRpb3x8MTtpLl9yYXRpbz1yL28saS5fZHJhd2luZ0NhbnZhcy53aWR0aD1lLmdldFJlbmRlcldpZHRoKCkqaS5fcmF0aW8saS5fZHJhd2luZ0NhbnZhcy5oZWlnaHQ9ZS5nZXRSZW5kZXJIZWlnaHQoKSppLl9yYXRpb30sdGhpcy5fb25DYW52YXNDbGljaz1mdW5jdGlvbihlKXtpLl9jbGlja1Bvc2l0aW9uPXt4OmUuY2xpZW50WCppLl9yYXRpbyx5OmUuY2xpZW50WSppLl9yYXRpb319LHRoaXMuX3N5bmNVST1mdW5jdGlvbigpe2kuX3Nob3dVSSYmKGkuX2Rpc3BsYXlTdGF0aXN0aWNzPyhpLl9kaXNwbGF5U3RhdHMoKSxpLl9zdGF0c0Rpdi5zdHlsZS5kaXNwbGF5PVwiXCIpOmkuX3N0YXRzRGl2LnN0eWxlLmRpc3BsYXk9XCJub25lXCIsaS5fZGlzcGxheUxvZ3M/aS5fbG9nRGl2LnN0eWxlLmRpc3BsYXk9XCJcIjppLl9sb2dEaXYuc3R5bGUuZGlzcGxheT1cIm5vbmVcIixpLl9kaXNwbGF5VHJlZT8oaS5fdHJlZURpdi5zdHlsZS5kaXNwbGF5PVwiXCIsaS5fbmVlZFRvUmVmcmVzaE1lc2hlc1RyZWUmJihpLl9uZWVkVG9SZWZyZXNoTWVzaGVzVHJlZT0hMSxpLl9yZWZyZXNoTWVzaGVzVHJlZUNvbnRlbnQoKSkpOmkuX3RyZWVEaXYuc3R5bGUuZGlzcGxheT1cIm5vbmVcIil9LHRoaXMuX3N5bmNEYXRhPWZ1bmN0aW9uKCl7aWYoaS5fbGFiZWxzRW5hYmxlZHx8IWkuX3Nob3dVSSl7aS5fY2FtZXJhLmdldFZpZXdNYXRyaXgoKS5tdWx0aXBseVRvUmVmKGkuX2NhbWVyYS5nZXRQcm9qZWN0aW9uTWF0cml4KCksaS5fdHJhbnNmb3JtYXRpb25NYXRyaXgpLGkuX2RyYXdpbmdDb250ZXh0LmNsZWFyUmVjdCgwLDAsaS5fZHJhd2luZ0NhbnZhcy53aWR0aCxpLl9kcmF3aW5nQ2FudmFzLmhlaWdodCk7dmFyIHQscixuPWkuX3NjZW5lLmdldEVuZ2luZSgpLG89aS5fY2FtZXJhLnZpZXdwb3J0LHM9by50b0dsb2JhbChuLmdldFJlbmRlcldpZHRoKCksbi5nZXRSZW5kZXJIZWlnaHQoKSksYT1pLl9jYW1lcmEuZ2V0QWN0aXZlTWVzaGVzKCk7Zm9yKHQ9MDt0PGEubGVuZ3RoO3QrKyl7dmFyIGg9YS5kYXRhW3RdLGM9aC5nZXRCb3VuZGluZ0luZm8oKS5ib3VuZGluZ1NwaGVyZS5jZW50ZXI7cj1lLlZlY3RvcjMuUHJvamVjdChjLGguZ2V0V29ybGRNYXRyaXgoKSxpLl90cmFuc2Zvcm1hdGlvbk1hdHJpeCxzKSwoaC5yZW5kZXJPdmVybGF5fHxpLnNob3VsZERpc3BsYXlBeGlzJiZpLnNob3VsZERpc3BsYXlBeGlzKGgpKSYmaS5fcmVuZGVyQXhpcyhyLGgscyksaS5zaG91bGREaXNwbGF5TGFiZWwmJiFpLnNob3VsZERpc3BsYXlMYWJlbChoKXx8aS5fcmVuZGVyTGFiZWwoaC5uYW1lLHIsMTIsZnVuY3Rpb24oKXtoLnJlbmRlck92ZXJsYXk9IWgucmVuZGVyT3ZlcmxheX0sZnVuY3Rpb24oKXtyZXR1cm4gaC5yZW5kZXJPdmVybGF5P1wicmVkXCI6XCJibGFja1wifSl9dmFyIGw9aS5fc2NlbmUuY2FtZXJhcztmb3IodD0wO3Q8bC5sZW5ndGg7dCsrKXt2YXIgdT1sW3RdO3UhPT1pLl9jYW1lcmEmJihyPWUuVmVjdG9yMy5Qcm9qZWN0KGUuVmVjdG9yMy5aZXJvKCksdS5nZXRXb3JsZE1hdHJpeCgpLGkuX3RyYW5zZm9ybWF0aW9uTWF0cml4LHMpLGkuc2hvdWxkRGlzcGxheUxhYmVsJiYhaS5zaG91bGREaXNwbGF5TGFiZWwodSl8fGkuX3JlbmRlckxhYmVsKHUubmFtZSxyLDEyLGZ1bmN0aW9uKCl7aS5fY2FtZXJhLmRldGFjaENvbnRyb2wobi5nZXRSZW5kZXJpbmdDYW52YXMoKSksaS5fY2FtZXJhPXUsaS5fY2FtZXJhLmF0dGFjaENvbnRyb2wobi5nZXRSZW5kZXJpbmdDYW52YXMoKSl9LGZ1bmN0aW9uKCl7cmV0dXJuXCJwdXJwbGVcIn0pKX12YXIgZj1pLl9zY2VuZS5saWdodHM7Zm9yKHQ9MDt0PGYubGVuZ3RoO3QrKyl7dmFyIGQ9Zlt0XTtkLnBvc2l0aW9uJiYocj1lLlZlY3RvcjMuUHJvamVjdChkLmdldEFic29sdXRlUG9zaXRpb24oKSxpLl9pZGVudGl0eU1hdHJpeCxpLl90cmFuc2Zvcm1hdGlvbk1hdHJpeCxzKSxpLnNob3VsZERpc3BsYXlMYWJlbCYmIWkuc2hvdWxkRGlzcGxheUxhYmVsKGQpfHxpLl9yZW5kZXJMYWJlbChkLm5hbWUsciwtMjAsZnVuY3Rpb24oKXtkLnNldEVuYWJsZWQoIWQuaXNFbmFibGVkKCkpfSxmdW5jdGlvbigpe3JldHVybiBkLmlzRW5hYmxlZCgpP1wib3JhbmdlXCI6XCJncmF5XCJ9KSl9fWkuX2NsaWNrUG9zaXRpb249dm9pZCAwfX1yZXR1cm4gdC5wcm90b3R5cGUuX3JlZnJlc2hNZXNoZXNUcmVlQ29udGVudD1mdW5jdGlvbigpe2Zvcig7dGhpcy5fdHJlZVN1YnNldERpdi5oYXNDaGlsZE5vZGVzKCk7KXRoaXMuX3RyZWVTdWJzZXREaXYucmVtb3ZlQ2hpbGQodGhpcy5fdHJlZVN1YnNldERpdi5sYXN0Q2hpbGQpO3ZhciBlPXRoaXMuX3NjZW5lLm1lc2hlcy5zbGljZSgwLHRoaXMuX3NjZW5lLm1lc2hlcy5sZW5ndGgpO2Uuc29ydChmdW5jdGlvbihlLHQpe3JldHVybiBlLm5hbWU9PT10Lm5hbWU/MDplLm5hbWU+dC5uYW1lPzE6LTF9KTtmb3IodmFyIHQ9MDt0PGUubGVuZ3RoO3QrKyl7dmFyIGk9ZVt0XTtpLmlzRW5hYmxlZCgpJiZ0aGlzLl9nZW5lcmF0ZUFkdmFuY2VkQ2hlY2tCb3godGhpcy5fdHJlZVN1YnNldERpdixpLm5hbWUsaS5nZXRUb3RhbFZlcnRpY2VzKCkrXCIgdmVydHNcIixpLmlzVmlzaWJsZSxmdW5jdGlvbihlLHQpe3QuaXNWaXNpYmxlPWUuY2hlY2tlZH0saSl9fSx0LnByb3RvdHlwZS5fcmVuZGVyU2luZ2xlQXhpcz1mdW5jdGlvbihlLHQsaSxyLG4pe3RoaXMuX2RyYXdpbmdDb250ZXh0LmJlZ2luUGF0aCgpLHRoaXMuX2RyYXdpbmdDb250ZXh0Lm1vdmVUbyhlLngsZS55KSx0aGlzLl9kcmF3aW5nQ29udGV4dC5saW5lVG8odC54LHQueSksdGhpcy5fZHJhd2luZ0NvbnRleHQuc3Ryb2tlU3R5bGU9bix0aGlzLl9kcmF3aW5nQ29udGV4dC5saW5lV2lkdGg9NCx0aGlzLl9kcmF3aW5nQ29udGV4dC5zdHJva2UoKSx0aGlzLl9kcmF3aW5nQ29udGV4dC5mb250PVwibm9ybWFsIDE0cHggU2Vnb2UgVUlcIix0aGlzLl9kcmF3aW5nQ29udGV4dC5maWxsU3R5bGU9bix0aGlzLl9kcmF3aW5nQ29udGV4dC5maWxsVGV4dChyLGkueCxpLnkpO1xufSx0LnByb3RvdHlwZS5fcmVuZGVyQXhpcz1mdW5jdGlvbih0LGkscil7dmFyIG49aS5nZXRCb3VuZGluZ0luZm8oKS5ib3VuZGluZ1NwaGVyZS5jZW50ZXIsbz1pLmdldFdvcmxkTWF0cml4KCkscz1lLlZlY3RvcjMuVW5wcm9qZWN0RnJvbVRyYW5zZm9ybSh0LmFkZChuZXcgZS5WZWN0b3IzKHRoaXMuX2RyYXdpbmdDYW52YXMud2lkdGgqdGhpcy5heGlzUmF0aW8sMCwwKSksci53aWR0aCxyLmhlaWdodCxvLHRoaXMuX3RyYW5zZm9ybWF0aW9uTWF0cml4KSxhPXMuc3VidHJhY3QobikubGVuZ3RoKCksaD1lLlZlY3RvcjMuUHJvamVjdChuLmFkZChuZXcgZS5WZWN0b3IzKGEsMCwwKSksbyx0aGlzLl90cmFuc2Zvcm1hdGlvbk1hdHJpeCxyKSxjPWUuVmVjdG9yMy5Qcm9qZWN0KG4uYWRkKG5ldyBlLlZlY3RvcjMoMS41KmEsMCwwKSksbyx0aGlzLl90cmFuc2Zvcm1hdGlvbk1hdHJpeCxyKTt0aGlzLl9yZW5kZXJTaW5nbGVBeGlzKHQsaCxjLFwieFwiLFwiI0ZGMDAwMFwiKTt2YXIgbD1lLlZlY3RvcjMuUHJvamVjdChuLmFkZChuZXcgZS5WZWN0b3IzKDAsYSwwKSksbyx0aGlzLl90cmFuc2Zvcm1hdGlvbk1hdHJpeCxyKSx1PWUuVmVjdG9yMy5Qcm9qZWN0KG4uYWRkKG5ldyBlLlZlY3RvcjMoMCwxLjUqYSwwKSksbyx0aGlzLl90cmFuc2Zvcm1hdGlvbk1hdHJpeCxyKTt0aGlzLl9yZW5kZXJTaW5nbGVBeGlzKHQsbCx1LFwieVwiLFwiIzAwRkYwMFwiKTt2YXIgZj1lLlZlY3RvcjMuUHJvamVjdChuLmFkZChuZXcgZS5WZWN0b3IzKDAsMCxhKSksbyx0aGlzLl90cmFuc2Zvcm1hdGlvbk1hdHJpeCxyKSxkPWUuVmVjdG9yMy5Qcm9qZWN0KG4uYWRkKG5ldyBlLlZlY3RvcjMoMCwwLDEuNSphKSksbyx0aGlzLl90cmFuc2Zvcm1hdGlvbk1hdHJpeCxyKTt0aGlzLl9yZW5kZXJTaW5nbGVBeGlzKHQsZixkLFwielwiLFwiIzAwMDBGRlwiKX0sdC5wcm90b3R5cGUuX3JlbmRlckxhYmVsPWZ1bmN0aW9uKGUsdCxpLHIsbil7aWYodC56PjAmJnQuejwxKXt0aGlzLl9kcmF3aW5nQ29udGV4dC5mb250PVwibm9ybWFsIDEycHggU2Vnb2UgVUlcIjt2YXIgbz10aGlzLl9kcmF3aW5nQ29udGV4dC5tZWFzdXJlVGV4dChlKSxzPXQueC1vLndpZHRoLzIsYT10LnksaD10aGlzLl9kcmF3aW5nQ2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO3RoaXMuX3Nob3dVSSYmdGhpcy5faXNDbGlja0luc2lkZVJlY3QoaC5sZWZ0KnRoaXMuX3JhdGlvK3MtNSxoLnRvcCp0aGlzLl9yYXRpbythLWktMTIsby53aWR0aCsxMCwxNykmJnIoKSx0aGlzLl9kcmF3aW5nQ29udGV4dC5iZWdpblBhdGgoKSx0aGlzLl9kcmF3aW5nQ29udGV4dC5yZWN0KHMtNSxhLWktMTIsby53aWR0aCsxMCwxNyksdGhpcy5fZHJhd2luZ0NvbnRleHQuZmlsbFN0eWxlPW4oKSx0aGlzLl9kcmF3aW5nQ29udGV4dC5nbG9iYWxBbHBoYT0uNSx0aGlzLl9kcmF3aW5nQ29udGV4dC5maWxsKCksdGhpcy5fZHJhd2luZ0NvbnRleHQuZ2xvYmFsQWxwaGE9MSx0aGlzLl9kcmF3aW5nQ29udGV4dC5zdHJva2VTdHlsZT1cIiNGRkZGRkZcIix0aGlzLl9kcmF3aW5nQ29udGV4dC5saW5lV2lkdGg9MSx0aGlzLl9kcmF3aW5nQ29udGV4dC5zdHJva2UoKSx0aGlzLl9kcmF3aW5nQ29udGV4dC5maWxsU3R5bGU9XCIjRkZGRkZGXCIsdGhpcy5fZHJhd2luZ0NvbnRleHQuZmlsbFRleHQoZSxzLGEtaSksdGhpcy5fZHJhd2luZ0NvbnRleHQuYmVnaW5QYXRoKCksdGhpcy5fZHJhd2luZ0NvbnRleHQuYXJjKHQueCxhLDUsMCwyKk1hdGguUEksITEpLHRoaXMuX2RyYXdpbmdDb250ZXh0LmZpbGwoKX19LHQucHJvdG90eXBlLl9pc0NsaWNrSW5zaWRlUmVjdD1mdW5jdGlvbihlLHQsaSxyKXtyZXR1cm4gdGhpcy5fY2xpY2tQb3NpdGlvbj90aGlzLl9jbGlja1Bvc2l0aW9uLng8ZXx8dGhpcy5fY2xpY2tQb3NpdGlvbi54PmUraT8hMTohKHRoaXMuX2NsaWNrUG9zaXRpb24ueTx0fHx0aGlzLl9jbGlja1Bvc2l0aW9uLnk+dCtyKTohMX0sdC5wcm90b3R5cGUuaXNWaXNpYmxlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2VuYWJsZWR9LHQucHJvdG90eXBlLmhpZGU9ZnVuY3Rpb24oKXtpZih0aGlzLl9lbmFibGVkKXt0aGlzLl9lbmFibGVkPSExO3ZhciB0PXRoaXMuX3NjZW5lLmdldEVuZ2luZSgpO3RoaXMuX3NjZW5lLnVucmVnaXN0ZXJCZWZvcmVSZW5kZXIodGhpcy5fc3luY0RhdGEpLHRoaXMuX3NjZW5lLnVucmVnaXN0ZXJBZnRlclJlbmRlcih0aGlzLl9zeW5jVUkpLHRoaXMuX3Jvb3RFbGVtZW50LnJlbW92ZUNoaWxkKHRoaXMuX2dsb2JhbERpdiksdGhpcy5fc2NlbmUuZm9yY2VTaG93Qm91bmRpbmdCb3hlcz0hMSx0aGlzLl9zY2VuZS5mb3JjZVdpcmVmcmFtZT0hMSxlLlN0YW5kYXJkTWF0ZXJpYWwuRGlmZnVzZVRleHR1cmVFbmFibGVkPSEwLGUuU3RhbmRhcmRNYXRlcmlhbC5BbWJpZW50VGV4dHVyZUVuYWJsZWQ9ITAsZS5TdGFuZGFyZE1hdGVyaWFsLlNwZWN1bGFyVGV4dHVyZUVuYWJsZWQ9ITAsZS5TdGFuZGFyZE1hdGVyaWFsLkVtaXNzaXZlVGV4dHVyZUVuYWJsZWQ9ITAsZS5TdGFuZGFyZE1hdGVyaWFsLkJ1bXBUZXh0dXJlRW5hYmxlZD0hMCxlLlN0YW5kYXJkTWF0ZXJpYWwuT3BhY2l0eVRleHR1cmVFbmFibGVkPSEwLGUuU3RhbmRhcmRNYXRlcmlhbC5SZWZsZWN0aW9uVGV4dHVyZUVuYWJsZWQ9ITAsZS5TdGFuZGFyZE1hdGVyaWFsLkxpZ2h0bWFwVGV4dHVyZUVuYWJsZWQ9ITAsZS5TdGFuZGFyZE1hdGVyaWFsLlJlZnJhY3Rpb25UZXh0dXJlRW5hYmxlZD0hMCx0aGlzLl9zY2VuZS5zaGFkb3dzRW5hYmxlZD0hMCx0aGlzLl9zY2VuZS5wYXJ0aWNsZXNFbmFibGVkPSEwLHRoaXMuX3NjZW5lLnBvc3RQcm9jZXNzZXNFbmFibGVkPSEwLHRoaXMuX3NjZW5lLmNvbGxpc2lvbnNFbmFibGVkPSEwLHRoaXMuX3NjZW5lLmxpZ2h0c0VuYWJsZWQ9ITAsdGhpcy5fc2NlbmUudGV4dHVyZXNFbmFibGVkPSEwLHRoaXMuX3NjZW5lLmxlbnNGbGFyZXNFbmFibGVkPSEwLHRoaXMuX3NjZW5lLnByb2NlZHVyYWxUZXh0dXJlc0VuYWJsZWQ9ITAsdGhpcy5fc2NlbmUucmVuZGVyVGFyZ2V0c0VuYWJsZWQ9ITAsdGhpcy5fc2NlbmUucHJvYmVzRW5hYmxlZD0hMCx0LmdldFJlbmRlcmluZ0NhbnZhcygpLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLHRoaXMuX29uQ2FudmFzQ2xpY2spLHRoaXMuX2NsZWFyU2tlbGV0b25WaWV3ZXJzKCl9fSx0LnByb3RvdHlwZS5fY2xlYXJTa2VsZXRvblZpZXdlcnM9ZnVuY3Rpb24oKXtmb3IodmFyIGU9MDtlPHRoaXMuX3NrZWxldG9uVmlld2Vycy5sZW5ndGg7ZSsrKXRoaXMuX3NrZWxldG9uVmlld2Vyc1tlXS5kaXNwb3NlKCk7dGhpcy5fc2tlbGV0b25WaWV3ZXJzPVtdfSx0LnByb3RvdHlwZS5zaG93PWZ1bmN0aW9uKGUsdCxpKXtpZih2b2lkIDA9PT1lJiYoZT0hMCksdm9pZCAwPT09dCYmKHQ9bnVsbCksdm9pZCAwPT09aSYmKGk9bnVsbCksIXRoaXMuX2VuYWJsZWQpe3RoaXMuX2VuYWJsZWQ9ITAsdD90aGlzLl9jYW1lcmE9dDp0aGlzLl9jYW1lcmE9dGhpcy5fc2NlbmUuYWN0aXZlQ2FtZXJhLHRoaXMuX3Nob3dVST1lO3ZhciByPXRoaXMuX3NjZW5lLmdldEVuZ2luZSgpO3RoaXMuX2dsb2JhbERpdj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpLHRoaXMuX3Jvb3RFbGVtZW50PWl8fGRvY3VtZW50LmJvZHksdGhpcy5fcm9vdEVsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy5fZ2xvYmFsRGl2KSx0aGlzLl9nZW5lcmF0ZURPTWVsZW1lbnRzKCksci5nZXRSZW5kZXJpbmdDYW52YXMoKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIix0aGlzLl9vbkNhbnZhc0NsaWNrKSx0aGlzLl9zeW5jUG9zaXRpb25zKCksdGhpcy5fc2NlbmUucmVnaXN0ZXJCZWZvcmVSZW5kZXIodGhpcy5fc3luY0RhdGEpLHRoaXMuX3NjZW5lLnJlZ2lzdGVyQWZ0ZXJSZW5kZXIodGhpcy5fc3luY1VJKX19LHQucHJvdG90eXBlLl9jbGVhckxhYmVscz1mdW5jdGlvbigpe3RoaXMuX2RyYXdpbmdDb250ZXh0LmNsZWFyUmVjdCgwLDAsdGhpcy5fZHJhd2luZ0NhbnZhcy53aWR0aCx0aGlzLl9kcmF3aW5nQ2FudmFzLmhlaWdodCk7Zm9yKHZhciBlPTA7ZTx0aGlzLl9zY2VuZS5tZXNoZXMubGVuZ3RoO2UrKyl7dmFyIHQ9dGhpcy5fc2NlbmUubWVzaGVzW2VdO3QucmVuZGVyT3ZlcmxheT0hMX19LHQucHJvdG90eXBlLl9nZW5lcmF0ZWhlYWRlcj1mdW5jdGlvbihlLHQpe3ZhciBpPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7aS5pbm5lckhUTUw9dCtcIiZuYnNwO1wiLGkuc3R5bGUudGV4dEFsaWduPVwicmlnaHRcIixpLnN0eWxlLndpZHRoPVwiMTAwJVwiLGkuc3R5bGUuY29sb3I9XCJ3aGl0ZVwiLGkuc3R5bGUuYmFja2dyb3VuZENvbG9yPVwiQmxhY2tcIixpLnN0eWxlLnBhZGRpbmc9XCI1cHggNXB4IDRweCAwcHhcIixpLnN0eWxlLm1hcmdpbkxlZnQ9XCItNXB4XCIsaS5zdHlsZS5mb250V2VpZ2h0PVwiYm9sZFwiLGUuYXBwZW5kQ2hpbGQoaSl9LHQucHJvdG90eXBlLl9nZW5lcmF0ZVRleEJveD1mdW5jdGlvbihlLHQsaSl7dmFyIHI9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxhYmVsXCIpO3Iuc3R5bGUuZGlzcGxheT1cImlubGluZVwiLHIuaW5uZXJIVE1MPXQsci5zdHlsZS5jb2xvcj1pLGUuYXBwZW5kQ2hpbGQociksZS5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnJcIikpfSx0LnByb3RvdHlwZS5fZ2VuZXJhdGVBZHZhbmNlZENoZWNrQm94PWZ1bmN0aW9uKGUsdCxpLHIsbixvKXt2b2lkIDA9PT1vJiYobz1udWxsKTt2YXIgcz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGFiZWxcIik7cy5zdHlsZS5kaXNwbGF5PVwiaW5saW5lXCI7dmFyIGE9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlucHV0XCIpO2EudHlwZT1cImNoZWNrYm94XCIsYS5jaGVja2VkPXIsYS5zdHlsZS5kaXNwbGF5PVwiaW5saW5lXCIsYS5zdHlsZS5tYXJnaW49XCIwcHggNXB4IDBweCAwcHhcIixhLnN0eWxlLnZlcnRpY2FsQWxpZ249XCJzdWJcIixhLmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIixmdW5jdGlvbihlKXtuKGUudGFyZ2V0LG8pfSkscy5hcHBlbmRDaGlsZChhKTt2YXIgaD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKSxjPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpLGw9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7bC5zdHlsZS5jc3NGbG9hdD1cInJpZ2h0XCIsYy5pbm5lckhUTUw9dCxsLmlubmVySFRNTD1pLGwuc3R5bGUuZm9udFNpemU9XCIxMnB4XCIsbC5zdHlsZS5tYXhXaWR0aD1cIjIwMHB4XCIsaC5hcHBlbmRDaGlsZChjKSxoLmFwcGVuZENoaWxkKGwpLHMuYXBwZW5kQ2hpbGQoaCksZS5hcHBlbmRDaGlsZChzKSxlLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJiclwiKSl9LHQucHJvdG90eXBlLl9nZW5lcmF0ZUNoZWNrQm94PWZ1bmN0aW9uKGUsdCxpLHIsbil7dm9pZCAwPT09biYmKG49bnVsbCk7dmFyIG89ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxhYmVsXCIpO28uc3R5bGUuZGlzcGxheT1cImlubGluZVwiO3ZhciBzPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtzLnR5cGU9XCJjaGVja2JveFwiLHMuY2hlY2tlZD1pLHMuc3R5bGUuZGlzcGxheT1cImlubGluZVwiLHMuc3R5bGUubWFyZ2luPVwiMHB4IDVweCAwcHggMHB4XCIscy5zdHlsZS52ZXJ0aWNhbEFsaWduPVwic3ViXCIscy5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsZnVuY3Rpb24oZSl7cihlLnRhcmdldCxuKX0pLG8uYXBwZW5kQ2hpbGQocyksby5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSh0KSksZS5hcHBlbmRDaGlsZChvKSxlLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJiclwiKSl9LHQucHJvdG90eXBlLl9nZW5lcmF0ZUJ1dHRvbj1mdW5jdGlvbihlLHQsaSxyKXt2b2lkIDA9PT1yJiYocj1udWxsKTt2YXIgbj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO24uaW5uZXJIVE1MPXQsbi5zdHlsZS5oZWlnaHQ9XCIyNHB4XCIsbi5zdHlsZS53aWR0aD1cIjE1MHB4XCIsbi5zdHlsZS5tYXJnaW5Cb3R0b209XCI1cHhcIixuLnN0eWxlLmNvbG9yPVwiIzQ0NDQ0NFwiLG4uc3R5bGUuYm9yZGVyPVwiMXB4IHNvbGlkIHdoaXRlXCIsbi5jbGFzc05hbWU9XCJkZWJ1Z0xheWVyQnV0dG9uXCIsbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIixmdW5jdGlvbihlKXtpKGUudGFyZ2V0LHIpfSksZS5hcHBlbmRDaGlsZChuKSxlLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJiclwiKSl9LHQucHJvdG90eXBlLl9nZW5lcmF0ZVJhZGlvPWZ1bmN0aW9uKGUsdCxpLHIsbixvKXt2b2lkIDA9PT1vJiYobz1udWxsKTt2YXIgcz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGFiZWxcIik7cy5zdHlsZS5kaXNwbGF5PVwiaW5saW5lXCI7dmFyIGE9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlucHV0XCIpO2EudHlwZT1cInJhZGlvXCIsYS5uYW1lPWksYS5jaGVja2VkPXIsYS5zdHlsZS5kaXNwbGF5PVwiaW5saW5lXCIsYS5zdHlsZS5tYXJnaW49XCIwcHggNXB4IDBweCAwcHhcIixhLnN0eWxlLnZlcnRpY2FsQWxpZ249XCJzdWJcIixhLmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIixmdW5jdGlvbihlKXtuKGUudGFyZ2V0LG8pfSkscy5hcHBlbmRDaGlsZChhKSxzLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHQpKSxlLmFwcGVuZENoaWxkKHMpLGUuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJyXCIpKX0sdC5wcm90b3R5cGUuX2dlbmVyYXRlRE9NZWxlbWVudHM9ZnVuY3Rpb24oKXt2YXIgdD10aGlzO2lmKHRoaXMuX2dsb2JhbERpdi5pZD1cIkRlYnVnTGF5ZXJcIix0aGlzLl9nbG9iYWxEaXYuc3R5bGUucG9zaXRpb249XCJhYnNvbHV0ZVwiLHRoaXMuX2dsb2JhbERpdi5zdHlsZS5mb250RmFtaWx5PVwiU2Vnb2UgVUksIEFyaWFsXCIsdGhpcy5fZ2xvYmFsRGl2LnN0eWxlLmZvbnRTaXplPVwiMTRweFwiLHRoaXMuX2dsb2JhbERpdi5zdHlsZS5jb2xvcj1cIndoaXRlXCIsdGhpcy5fZHJhd2luZ0NhbnZhcz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpLHRoaXMuX2RyYXdpbmdDYW52YXMuaWQ9XCJEZWJ1Z0xheWVyRHJhd2luZ0NhbnZhc1wiLHRoaXMuX2RyYXdpbmdDYW52YXMuc3R5bGUucG9zaXRpb249XCJhYnNvbHV0ZVwiLHRoaXMuX2RyYXdpbmdDYW52YXMuc3R5bGUucG9pbnRlckV2ZW50cz1cIm5vbmVcIix0aGlzLl9kcmF3aW5nQ2FudmFzLnN0eWxlLmJhY2tncm91bmRDb2xvcj1cInRyYW5zcGFyZW50XCIsdGhpcy5fZHJhd2luZ0NvbnRleHQ9dGhpcy5fZHJhd2luZ0NhbnZhcy5nZXRDb250ZXh0KFwiMmRcIiksdGhpcy5fZ2xvYmFsRGl2LmFwcGVuZENoaWxkKHRoaXMuX2RyYXdpbmdDYW52YXMpLHRoaXMuX3Nob3dVSSl7dmFyIGk9XCJyZ2JhKDEyOCwgMTI4LCAxMjgsIDAuNClcIixyPVwicmdiKDE4MCwgMTgwLCAxODApIHNvbGlkIDFweFwiO3RoaXMuX3N0YXRzRGl2PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiksdGhpcy5fc3RhdHNEaXYuaWQ9XCJEZWJ1Z0xheWVyU3RhdHNcIix0aGlzLl9zdGF0c0Rpdi5zdHlsZS5ib3JkZXI9cix0aGlzLl9zdGF0c0Rpdi5zdHlsZS5wb3NpdGlvbj1cImFic29sdXRlXCIsdGhpcy5fc3RhdHNEaXYuc3R5bGUuYmFja2dyb3VuZD1pLHRoaXMuX3N0YXRzRGl2LnN0eWxlLnBhZGRpbmc9XCIwcHggMHB4IDBweCA1cHhcIix0aGlzLl9nZW5lcmF0ZWhlYWRlcih0aGlzLl9zdGF0c0RpdixcIlNUQVRJU1RJQ1NcIiksdGhpcy5fc3RhdHNTdWJzZXREaXY9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKSx0aGlzLl9zdGF0c1N1YnNldERpdi5zdHlsZS5wYWRkaW5nVG9wPVwiNXB4XCIsdGhpcy5fc3RhdHNTdWJzZXREaXYuc3R5bGUucGFkZGluZ0JvdHRvbT1cIjVweFwiLHRoaXMuX3N0YXRzU3Vic2V0RGl2LnN0eWxlLm92ZXJmbG93WT1cImF1dG9cIix0aGlzLl9zdGF0c0Rpdi5hcHBlbmRDaGlsZCh0aGlzLl9zdGF0c1N1YnNldERpdiksdGhpcy5fdHJlZURpdj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpLHRoaXMuX3RyZWVEaXYuaWQ9XCJEZWJ1Z0xheWVyVHJlZVwiLHRoaXMuX3RyZWVEaXYuc3R5bGUuYm9yZGVyPXIsdGhpcy5fdHJlZURpdi5zdHlsZS5wb3NpdGlvbj1cImFic29sdXRlXCIsdGhpcy5fdHJlZURpdi5zdHlsZS5iYWNrZ3JvdW5kPWksdGhpcy5fdHJlZURpdi5zdHlsZS5wYWRkaW5nPVwiMHB4IDBweCAwcHggNXB4XCIsdGhpcy5fdHJlZURpdi5zdHlsZS5kaXNwbGF5PVwibm9uZVwiLHRoaXMuX2dlbmVyYXRlaGVhZGVyKHRoaXMuX3RyZWVEaXYsXCJNRVNIRVMgVFJFRVwiKSx0aGlzLl90cmVlU3Vic2V0RGl2PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiksdGhpcy5fdHJlZVN1YnNldERpdi5zdHlsZS5wYWRkaW5nVG9wPVwiNXB4XCIsdGhpcy5fdHJlZVN1YnNldERpdi5zdHlsZS5wYWRkaW5nUmlnaHQ9XCI1cHhcIix0aGlzLl90cmVlU3Vic2V0RGl2LnN0eWxlLm92ZXJmbG93WT1cImF1dG9cIix0aGlzLl90cmVlU3Vic2V0RGl2LnN0eWxlLm1heEhlaWdodD1cIjMwMHB4XCIsdGhpcy5fdHJlZURpdi5hcHBlbmRDaGlsZCh0aGlzLl90cmVlU3Vic2V0RGl2KSx0aGlzLl9uZWVkVG9SZWZyZXNoTWVzaGVzVHJlZT0hMCx0aGlzLl9sb2dEaXY9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKSx0aGlzLl9sb2dEaXYuc3R5bGUuYm9yZGVyPXIsdGhpcy5fbG9nRGl2LmlkPVwiRGVidWdMYXllckxvZ3NcIix0aGlzLl9sb2dEaXYuc3R5bGUucG9zaXRpb249XCJhYnNvbHV0ZVwiLHRoaXMuX2xvZ0Rpdi5zdHlsZS5iYWNrZ3JvdW5kPWksdGhpcy5fbG9nRGl2LnN0eWxlLnBhZGRpbmc9XCIwcHggMHB4IDBweCA1cHhcIix0aGlzLl9sb2dEaXYuc3R5bGUuZGlzcGxheT1cIm5vbmVcIix0aGlzLl9nZW5lcmF0ZWhlYWRlcih0aGlzLl9sb2dEaXYsXCJMT0dTXCIpLHRoaXMuX2xvZ1N1YnNldERpdj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpLHRoaXMuX2xvZ1N1YnNldERpdi5zdHlsZS5oZWlnaHQ9XCIxMjdweFwiLHRoaXMuX2xvZ1N1YnNldERpdi5zdHlsZS5wYWRkaW5nVG9wPVwiNXB4XCIsdGhpcy5fbG9nU3Vic2V0RGl2LnN0eWxlLm92ZXJmbG93WT1cImF1dG9cIix0aGlzLl9sb2dTdWJzZXREaXYuc3R5bGUuZm9udFNpemU9XCIxMnB4XCIsdGhpcy5fbG9nU3Vic2V0RGl2LnN0eWxlLmZvbnRGYW1pbHk9XCJjb25zb2xhc1wiLHRoaXMuX2xvZ1N1YnNldERpdi5pbm5lckhUTUw9ZS5Ub29scy5Mb2dDYWNoZSx0aGlzLl9sb2dEaXYuYXBwZW5kQ2hpbGQodGhpcy5fbG9nU3Vic2V0RGl2KSxlLlRvb2xzLk9uTmV3Q2FjaGVFbnRyeT1mdW5jdGlvbihlKXt0Ll9sb2dTdWJzZXREaXYuaW5uZXJIVE1MPWUrdC5fbG9nU3Vic2V0RGl2LmlubmVySFRNTH0sdGhpcy5fb3B0aW9uc0Rpdj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpLHRoaXMuX29wdGlvbnNEaXYuaWQ9XCJEZWJ1Z0xheWVyT3B0aW9uc1wiLHRoaXMuX29wdGlvbnNEaXYuc3R5bGUuYm9yZGVyPXIsdGhpcy5fb3B0aW9uc0Rpdi5zdHlsZS5wb3NpdGlvbj1cImFic29sdXRlXCIsdGhpcy5fb3B0aW9uc0Rpdi5zdHlsZS5iYWNrZ3JvdW5kPWksdGhpcy5fb3B0aW9uc0Rpdi5zdHlsZS5wYWRkaW5nPVwiMHB4IDBweCAwcHggNXB4XCIsdGhpcy5fb3B0aW9uc0Rpdi5zdHlsZS5vdmVyZmxvd1k9XCJhdXRvXCIsdGhpcy5fZ2VuZXJhdGVoZWFkZXIodGhpcy5fb3B0aW9uc0RpdixcIk9QVElPTlNcIiksdGhpcy5fb3B0aW9uc1N1YnNldERpdj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpLHRoaXMuX29wdGlvbnNTdWJzZXREaXYuc3R5bGUucGFkZGluZ1RvcD1cIjVweFwiLHRoaXMuX29wdGlvbnNTdWJzZXREaXYuc3R5bGUucGFkZGluZ0JvdHRvbT1cIjVweFwiLHRoaXMuX29wdGlvbnNTdWJzZXREaXYuc3R5bGUub3ZlcmZsb3dZPVwiYXV0b1wiLHRoaXMuX29wdGlvbnNTdWJzZXREaXYuc3R5bGUubWF4SGVpZ2h0PVwiMjAwcHhcIix0aGlzLl9vcHRpb25zRGl2LmFwcGVuZENoaWxkKHRoaXMuX29wdGlvbnNTdWJzZXREaXYpLHRoaXMuX2dlbmVyYXRlVGV4Qm94KHRoaXMuX29wdGlvbnNTdWJzZXREaXYsXCI8Yj5XaW5kb3dzOjwvYj5cIix0aGlzLmFjY2VudENvbG9yKSx0aGlzLl9nZW5lcmF0ZUNoZWNrQm94KHRoaXMuX29wdGlvbnNTdWJzZXREaXYsXCJTdGF0aXN0aWNzXCIsdGhpcy5fZGlzcGxheVN0YXRpc3RpY3MsZnVuY3Rpb24oZSl7dC5fZGlzcGxheVN0YXRpc3RpY3M9ZS5jaGVja2VkfSksdGhpcy5fZ2VuZXJhdGVDaGVja0JveCh0aGlzLl9vcHRpb25zU3Vic2V0RGl2LFwiTG9nc1wiLHRoaXMuX2Rpc3BsYXlMb2dzLGZ1bmN0aW9uKGUpe3QuX2Rpc3BsYXlMb2dzPWUuY2hlY2tlZH0pLHRoaXMuX2dlbmVyYXRlQ2hlY2tCb3godGhpcy5fb3B0aW9uc1N1YnNldERpdixcIk1lc2hlcyB0cmVlXCIsdGhpcy5fZGlzcGxheVRyZWUsZnVuY3Rpb24oZSl7dC5fZGlzcGxheVRyZWU9ZS5jaGVja2VkLHQuX25lZWRUb1JlZnJlc2hNZXNoZXNUcmVlPSEwfSksdGhpcy5fb3B0aW9uc1N1YnNldERpdi5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnJcIikpLHRoaXMuX2dlbmVyYXRlVGV4Qm94KHRoaXMuX29wdGlvbnNTdWJzZXREaXYsXCI8Yj5HZW5lcmFsOjwvYj5cIix0aGlzLmFjY2VudENvbG9yKSx0aGlzLl9nZW5lcmF0ZUNoZWNrQm94KHRoaXMuX29wdGlvbnNTdWJzZXREaXYsXCJCb3VuZGluZyBib3hlc1wiLHRoaXMuX3NjZW5lLmZvcmNlU2hvd0JvdW5kaW5nQm94ZXMsZnVuY3Rpb24oZSl7dC5fc2NlbmUuZm9yY2VTaG93Qm91bmRpbmdCb3hlcz1lLmNoZWNrZWR9KSx0aGlzLl9nZW5lcmF0ZUNoZWNrQm94KHRoaXMuX29wdGlvbnNTdWJzZXREaXYsXCJDbGlja2FibGUgbGFiZWxzXCIsdGhpcy5fbGFiZWxzRW5hYmxlZCxmdW5jdGlvbihlKXt0Ll9sYWJlbHNFbmFibGVkPWUuY2hlY2tlZCx0Ll9sYWJlbHNFbmFibGVkfHx0Ll9jbGVhckxhYmVscygpfSksdGhpcy5fZ2VuZXJhdGVDaGVja0JveCh0aGlzLl9vcHRpb25zU3Vic2V0RGl2LFwiR2VuZXJhdGUgdXNlciBtYXJrcyAoRjEyKVwiLGUuVG9vbHMuUGVyZm9ybWFuY2VMb2dMZXZlbD09PWUuVG9vbHMuUGVyZm9ybWFuY2VVc2VyTWFya0xvZ0xldmVsLGZ1bmN0aW9uKHQpe3QuY2hlY2tlZD9lLlRvb2xzLlBlcmZvcm1hbmNlTG9nTGV2ZWw9ZS5Ub29scy5QZXJmb3JtYW5jZVVzZXJNYXJrTG9nTGV2ZWw6ZS5Ub29scy5QZXJmb3JtYW5jZUxvZ0xldmVsPWUuVG9vbHMuUGVyZm9ybWFuY2VOb25lTG9nTGV2ZWx9KSx0aGlzLl9vcHRpb25zU3Vic2V0RGl2LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJiclwiKSksdGhpcy5fZ2VuZXJhdGVUZXhCb3godGhpcy5fb3B0aW9uc1N1YnNldERpdixcIjxiPlJlbmRlcmluZyBtb2RlOjwvYj5cIix0aGlzLmFjY2VudENvbG9yKSx0aGlzLl9nZW5lcmF0ZVJhZGlvKHRoaXMuX29wdGlvbnNTdWJzZXREaXYsXCJTb2xpZFwiLFwicmVuZGVyTW9kZVwiLCF0aGlzLl9zY2VuZS5mb3JjZVdpcmVmcmFtZSYmIXRoaXMuX3NjZW5lLmZvcmNlUG9pbnRzQ2xvdWQsZnVuY3Rpb24oZSl7ZS5jaGVja2VkJiYodC5fc2NlbmUuZm9yY2VXaXJlZnJhbWU9ITEsdC5fc2NlbmUuZm9yY2VQb2ludHNDbG91ZD0hMSl9KSx0aGlzLl9nZW5lcmF0ZVJhZGlvKHRoaXMuX29wdGlvbnNTdWJzZXREaXYsXCJXaXJlZnJhbWVcIixcInJlbmRlck1vZGVcIix0aGlzLl9zY2VuZS5mb3JjZVdpcmVmcmFtZSxmdW5jdGlvbihlKXtlLmNoZWNrZWQmJih0Ll9zY2VuZS5mb3JjZVdpcmVmcmFtZT0hMCx0Ll9zY2VuZS5mb3JjZVBvaW50c0Nsb3VkPSExKX0pLHRoaXMuX2dlbmVyYXRlUmFkaW8odGhpcy5fb3B0aW9uc1N1YnNldERpdixcIlBvaW50XCIsXCJyZW5kZXJNb2RlXCIsdGhpcy5fc2NlbmUuZm9yY2VQb2ludHNDbG91ZCxmdW5jdGlvbihlKXtlLmNoZWNrZWQmJih0Ll9zY2VuZS5mb3JjZVdpcmVmcmFtZT0hMSx0Ll9zY2VuZS5mb3JjZVBvaW50c0Nsb3VkPSEwKX0pLHRoaXMuX29wdGlvbnNTdWJzZXREaXYuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJyXCIpKSx0aGlzLl9nZW5lcmF0ZVRleEJveCh0aGlzLl9vcHRpb25zU3Vic2V0RGl2LFwiPGI+VGV4dHVyZSBjaGFubmVsczo8L2I+XCIsdGhpcy5hY2NlbnRDb2xvciksdGhpcy5fZ2VuZXJhdGVDaGVja0JveCh0aGlzLl9vcHRpb25zU3Vic2V0RGl2LFwiRGlmZnVzZVwiLGUuU3RhbmRhcmRNYXRlcmlhbC5EaWZmdXNlVGV4dHVyZUVuYWJsZWQsZnVuY3Rpb24odCl7ZS5TdGFuZGFyZE1hdGVyaWFsLkRpZmZ1c2VUZXh0dXJlRW5hYmxlZD10LmNoZWNrZWR9KSx0aGlzLl9nZW5lcmF0ZUNoZWNrQm94KHRoaXMuX29wdGlvbnNTdWJzZXREaXYsXCJBbWJpZW50XCIsZS5TdGFuZGFyZE1hdGVyaWFsLkFtYmllbnRUZXh0dXJlRW5hYmxlZCxmdW5jdGlvbih0KXtlLlN0YW5kYXJkTWF0ZXJpYWwuQW1iaWVudFRleHR1cmVFbmFibGVkPXQuY2hlY2tlZH0pLHRoaXMuX2dlbmVyYXRlQ2hlY2tCb3godGhpcy5fb3B0aW9uc1N1YnNldERpdixcIlNwZWN1bGFyXCIsZS5TdGFuZGFyZE1hdGVyaWFsLlNwZWN1bGFyVGV4dHVyZUVuYWJsZWQsZnVuY3Rpb24odCl7ZS5TdGFuZGFyZE1hdGVyaWFsLlNwZWN1bGFyVGV4dHVyZUVuYWJsZWQ9dC5jaGVja2VkfSksdGhpcy5fZ2VuZXJhdGVDaGVja0JveCh0aGlzLl9vcHRpb25zU3Vic2V0RGl2LFwiRW1pc3NpdmVcIixlLlN0YW5kYXJkTWF0ZXJpYWwuRW1pc3NpdmVUZXh0dXJlRW5hYmxlZCxmdW5jdGlvbih0KXtlLlN0YW5kYXJkTWF0ZXJpYWwuRW1pc3NpdmVUZXh0dXJlRW5hYmxlZD10LmNoZWNrZWR9KSx0aGlzLl9nZW5lcmF0ZUNoZWNrQm94KHRoaXMuX29wdGlvbnNTdWJzZXREaXYsXCJCdW1wXCIsZS5TdGFuZGFyZE1hdGVyaWFsLkJ1bXBUZXh0dXJlRW5hYmxlZCxmdW5jdGlvbih0KXtlLlN0YW5kYXJkTWF0ZXJpYWwuQnVtcFRleHR1cmVFbmFibGVkPXQuY2hlY2tlZH0pLHRoaXMuX2dlbmVyYXRlQ2hlY2tCb3godGhpcy5fb3B0aW9uc1N1YnNldERpdixcIk9wYWNpdHlcIixlLlN0YW5kYXJkTWF0ZXJpYWwuT3BhY2l0eVRleHR1cmVFbmFibGVkLGZ1bmN0aW9uKHQpe2UuU3RhbmRhcmRNYXRlcmlhbC5PcGFjaXR5VGV4dHVyZUVuYWJsZWQ9dC5jaGVja2VkfSksdGhpcy5fZ2VuZXJhdGVDaGVja0JveCh0aGlzLl9vcHRpb25zU3Vic2V0RGl2LFwiUmVmbGVjdGlvblwiLGUuU3RhbmRhcmRNYXRlcmlhbC5SZWZsZWN0aW9uVGV4dHVyZUVuYWJsZWQsZnVuY3Rpb24odCl7ZS5TdGFuZGFyZE1hdGVyaWFsLlJlZmxlY3Rpb25UZXh0dXJlRW5hYmxlZD10LmNoZWNrZWR9KSx0aGlzLl9nZW5lcmF0ZUNoZWNrQm94KHRoaXMuX29wdGlvbnNTdWJzZXREaXYsXCJSZWZyYWN0aW9uXCIsZS5TdGFuZGFyZE1hdGVyaWFsLlJlZnJhY3Rpb25UZXh0dXJlRW5hYmxlZCxmdW5jdGlvbih0KXtlLlN0YW5kYXJkTWF0ZXJpYWwuUmVmcmFjdGlvblRleHR1cmVFbmFibGVkPXQuY2hlY2tlZH0pLHRoaXMuX2dlbmVyYXRlQ2hlY2tCb3godGhpcy5fb3B0aW9uc1N1YnNldERpdixcIkxpZ2h0bWFwXCIsZS5TdGFuZGFyZE1hdGVyaWFsLkxpZ2h0bWFwVGV4dHVyZUVuYWJsZWQsZnVuY3Rpb24odCl7ZS5TdGFuZGFyZE1hdGVyaWFsLkxpZ2h0bWFwVGV4dHVyZUVuYWJsZWQ9dC5jaGVja2VkfSksdGhpcy5fZ2VuZXJhdGVDaGVja0JveCh0aGlzLl9vcHRpb25zU3Vic2V0RGl2LFwiRnJlc25lbFwiLGUuU3RhbmRhcmRNYXRlcmlhbC5GcmVzbmVsRW5hYmxlZCxmdW5jdGlvbih0KXtlLlN0YW5kYXJkTWF0ZXJpYWwuRnJlc25lbEVuYWJsZWQ9dC5jaGVja2VkfSksdGhpcy5fb3B0aW9uc1N1YnNldERpdi5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnJcIikpLHRoaXMuX2dlbmVyYXRlVGV4Qm94KHRoaXMuX29wdGlvbnNTdWJzZXREaXYsXCI8Yj5PcHRpb25zOjwvYj5cIix0aGlzLmFjY2VudENvbG9yKSx0aGlzLl9nZW5lcmF0ZUNoZWNrQm94KHRoaXMuX29wdGlvbnNTdWJzZXREaXYsXCJBbmltYXRpb25zXCIsdGhpcy5fc2NlbmUuYW5pbWF0aW9uc0VuYWJsZWQsZnVuY3Rpb24oZSl7dC5fc2NlbmUuYW5pbWF0aW9uc0VuYWJsZWQ9ZS5jaGVja2VkfSksdGhpcy5fZ2VuZXJhdGVDaGVja0JveCh0aGlzLl9vcHRpb25zU3Vic2V0RGl2LFwiQ29sbGlzaW9uc1wiLHRoaXMuX3NjZW5lLmNvbGxpc2lvbnNFbmFibGVkLGZ1bmN0aW9uKGUpe3QuX3NjZW5lLmNvbGxpc2lvbnNFbmFibGVkPWUuY2hlY2tlZH0pLHRoaXMuX2dlbmVyYXRlQ2hlY2tCb3godGhpcy5fb3B0aW9uc1N1YnNldERpdixcIkZvZ1wiLHRoaXMuX3NjZW5lLmZvZ0VuYWJsZWQsZnVuY3Rpb24oZSl7dC5fc2NlbmUuZm9nRW5hYmxlZD1lLmNoZWNrZWR9KSx0aGlzLl9nZW5lcmF0ZUNoZWNrQm94KHRoaXMuX29wdGlvbnNTdWJzZXREaXYsXCJMZW5zIGZsYXJlc1wiLHRoaXMuX3NjZW5lLmxlbnNGbGFyZXNFbmFibGVkLGZ1bmN0aW9uKGUpe3QuX3NjZW5lLmxlbnNGbGFyZXNFbmFibGVkPWUuY2hlY2tlZH0pLHRoaXMuX2dlbmVyYXRlQ2hlY2tCb3godGhpcy5fb3B0aW9uc1N1YnNldERpdixcIkxpZ2h0c1wiLHRoaXMuX3NjZW5lLmxpZ2h0c0VuYWJsZWQsZnVuY3Rpb24oZSl7dC5fc2NlbmUubGlnaHRzRW5hYmxlZD1lLmNoZWNrZWR9KSx0aGlzLl9nZW5lcmF0ZUNoZWNrQm94KHRoaXMuX29wdGlvbnNTdWJzZXREaXYsXCJQYXJ0aWNsZXNcIix0aGlzLl9zY2VuZS5wYXJ0aWNsZXNFbmFibGVkLGZ1bmN0aW9uKGUpe3QuX3NjZW5lLnBhcnRpY2xlc0VuYWJsZWQ9ZS5jaGVja2VkfSksdGhpcy5fZ2VuZXJhdGVDaGVja0JveCh0aGlzLl9vcHRpb25zU3Vic2V0RGl2LFwiUG9zdC1wcm9jZXNzZXNcIix0aGlzLl9zY2VuZS5wb3N0UHJvY2Vzc2VzRW5hYmxlZCxmdW5jdGlvbihlKXt0Ll9zY2VuZS5wb3N0UHJvY2Vzc2VzRW5hYmxlZD1lLmNoZWNrZWR9KSx0aGlzLl9nZW5lcmF0ZUNoZWNrQm94KHRoaXMuX29wdGlvbnNTdWJzZXREaXYsXCJQcm9iZXNcIix0aGlzLl9zY2VuZS5wcm9iZXNFbmFibGVkLGZ1bmN0aW9uKGUpe3QuX3NjZW5lLnByb2Jlc0VuYWJsZWQ9ZS5jaGVja2VkfSksdGhpcy5fZ2VuZXJhdGVDaGVja0JveCh0aGlzLl9vcHRpb25zU3Vic2V0RGl2LFwiUHJvY2VkdXJhbCB0ZXh0dXJlc1wiLHRoaXMuX3NjZW5lLnByb2NlZHVyYWxUZXh0dXJlc0VuYWJsZWQsZnVuY3Rpb24oZSl7dC5fc2NlbmUucHJvY2VkdXJhbFRleHR1cmVzRW5hYmxlZD1lLmNoZWNrZWR9KSx0aGlzLl9nZW5lcmF0ZUNoZWNrQm94KHRoaXMuX29wdGlvbnNTdWJzZXREaXYsXCJSZW5kZXIgdGFyZ2V0c1wiLHRoaXMuX3NjZW5lLnJlbmRlclRhcmdldHNFbmFibGVkLGZ1bmN0aW9uKGUpe3QuX3NjZW5lLnJlbmRlclRhcmdldHNFbmFibGVkPWUuY2hlY2tlZH0pLHRoaXMuX2dlbmVyYXRlQ2hlY2tCb3godGhpcy5fb3B0aW9uc1N1YnNldERpdixcIlNoYWRvd3NcIix0aGlzLl9zY2VuZS5zaGFkb3dzRW5hYmxlZCxmdW5jdGlvbihlKXt0Ll9zY2VuZS5zaGFkb3dzRW5hYmxlZD1lLmNoZWNrZWR9KSx0aGlzLl9nZW5lcmF0ZUNoZWNrQm94KHRoaXMuX29wdGlvbnNTdWJzZXREaXYsXCJTa2VsZXRvbnNcIix0aGlzLl9zY2VuZS5za2VsZXRvbnNFbmFibGVkLGZ1bmN0aW9uKGUpe3QuX3NjZW5lLnNrZWxldG9uc0VuYWJsZWQ9ZS5jaGVja2VkfSksdGhpcy5fZ2VuZXJhdGVDaGVja0JveCh0aGlzLl9vcHRpb25zU3Vic2V0RGl2LFwiU3ByaXRlc1wiLHRoaXMuX3NjZW5lLnNwcml0ZXNFbmFibGVkLGZ1bmN0aW9uKGUpe3QuX3NjZW5lLnNwcml0ZXNFbmFibGVkPWUuY2hlY2tlZH0pLHRoaXMuX2dlbmVyYXRlQ2hlY2tCb3godGhpcy5fb3B0aW9uc1N1YnNldERpdixcIlRleHR1cmVzXCIsdGhpcy5fc2NlbmUudGV4dHVyZXNFbmFibGVkLGZ1bmN0aW9uKGUpe3QuX3NjZW5lLnRleHR1cmVzRW5hYmxlZD1lLmNoZWNrZWR9KSxlLkF1ZGlvRW5naW5lJiZlLkVuZ2luZS5hdWRpb0VuZ2luZS5jYW5Vc2VXZWJBdWRpbyYmKHRoaXMuX29wdGlvbnNTdWJzZXREaXYuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJyXCIpKSx0aGlzLl9nZW5lcmF0ZVRleEJveCh0aGlzLl9vcHRpb25zU3Vic2V0RGl2LFwiPGI+QXVkaW86PC9iPlwiLHRoaXMuYWNjZW50Q29sb3IpLHRoaXMuX2dlbmVyYXRlUmFkaW8odGhpcy5fb3B0aW9uc1N1YnNldERpdixcIkhlYWRwaG9uZXNcIixcInBhbm5pbmdNb2RlbFwiLHRoaXMuX3NjZW5lLmhlYWRwaG9uZSxmdW5jdGlvbihlKXtlLmNoZWNrZWQmJih0Ll9zY2VuZS5oZWFkcGhvbmU9ITApfSksdGhpcy5fZ2VuZXJhdGVSYWRpbyh0aGlzLl9vcHRpb25zU3Vic2V0RGl2LFwiTm9ybWFsIFNwZWFrZXJzXCIsXCJwYW5uaW5nTW9kZWxcIiwhdGhpcy5fc2NlbmUuaGVhZHBob25lLGZ1bmN0aW9uKGUpe2UuY2hlY2tlZCYmKHQuX3NjZW5lLmhlYWRwaG9uZT0hMSl9KSx0aGlzLl9nZW5lcmF0ZUNoZWNrQm94KHRoaXMuX29wdGlvbnNTdWJzZXREaXYsXCJEaXNhYmxlIGF1ZGlvXCIsIXRoaXMuX3NjZW5lLmF1ZGlvRW5hYmxlZCxmdW5jdGlvbihlKXt0Ll9zY2VuZS5hdWRpb0VuYWJsZWQ9IWUuY2hlY2tlZH0pKSx0aGlzLl9vcHRpb25zU3Vic2V0RGl2LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJiclwiKSksdGhpcy5fZ2VuZXJhdGVUZXhCb3godGhpcy5fb3B0aW9uc1N1YnNldERpdixcIjxiPlZpZXdlcnM6PC9iPlwiLHRoaXMuYWNjZW50Q29sb3IpLHRoaXMuX2dlbmVyYXRlQ2hlY2tCb3godGhpcy5fb3B0aW9uc1N1YnNldERpdixcIlNrZWxldG9uc1wiLCExLGZ1bmN0aW9uKGkpe2lmKCFpLmNoZWNrZWQpcmV0dXJuIHZvaWQgdC5fY2xlYXJTa2VsZXRvblZpZXdlcnMoKTtmb3IodmFyIHI9MDtyPHQuX3NjZW5lLm1lc2hlcy5sZW5ndGg7cisrKXt2YXIgbj10Ll9zY2VuZS5tZXNoZXNbcl07aWYobi5za2VsZXRvbil7Zm9yKHZhciBvPSExLHM9MDtzPHQuX3NrZWxldG9uVmlld2Vycy5sZW5ndGg7cysrKWlmKHQuX3NrZWxldG9uVmlld2Vyc1tzXS5za2VsZXRvbj09PW4uc2tlbGV0b24pe289ITA7YnJlYWt9aWYobyljb250aW51ZTt2YXIgYT1uZXcgZS5EZWJ1Zy5Ta2VsZXRvblZpZXdlcihuLnNrZWxldG9uLG4sdC5fc2NlbmUpO2EuaXNFbmFibGVkPSEwLHQuX3NrZWxldG9uVmlld2Vycy5wdXNoKGEpfX19KSx0aGlzLl9vcHRpb25zU3Vic2V0RGl2LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJiclwiKSksdGhpcy5fZ2VuZXJhdGVUZXhCb3godGhpcy5fb3B0aW9uc1N1YnNldERpdixcIjxiPlRvb2xzOjwvYj5cIix0aGlzLmFjY2VudENvbG9yKSx0aGlzLl9nZW5lcmF0ZUJ1dHRvbih0aGlzLl9vcHRpb25zU3Vic2V0RGl2LFwiRHVtcCByZW5kZXJ0YXJnZXRzXCIsZnVuY3Rpb24oZSl7dC5fc2NlbmUuZHVtcE5leHRSZW5kZXJUYXJnZXRzPSEwfSksdGhpcy5fZ2VuZXJhdGVCdXR0b24odGhpcy5fb3B0aW9uc1N1YnNldERpdixcIlJ1biBTY2VuZU9wdGltaXplclwiLGZ1bmN0aW9uKGkpe2UuU2NlbmVPcHRpbWl6ZXIuT3B0aW1pemVBc3luYyh0Ll9zY2VuZSl9KSx0aGlzLl9nZW5lcmF0ZUJ1dHRvbih0aGlzLl9vcHRpb25zU3Vic2V0RGl2LFwiTG9nIGNhbWVyYSBvYmplY3RcIixmdW5jdGlvbihlKXt0Ll9jYW1lcmE/Y29uc29sZS5sb2codC5fY2FtZXJhKTpjb25zb2xlLndhcm4oXCJObyBjYW1lcmEgZGVmaW5lZCwgb3IgZGVidWcgbGF5ZXIgY3JlYXRlZCBiZWZvcmUgY2FtZXJhIGNyZWF0aW9uIVwiKX0pLHRoaXMuX29wdGlvbnNTdWJzZXREaXYuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJyXCIpKSx0aGlzLl9nbG9iYWxEaXYuYXBwZW5kQ2hpbGQodGhpcy5fc3RhdHNEaXYpLHRoaXMuX2dsb2JhbERpdi5hcHBlbmRDaGlsZCh0aGlzLl9sb2dEaXYpLHRoaXMuX2dsb2JhbERpdi5hcHBlbmRDaGlsZCh0aGlzLl9vcHRpb25zRGl2KSx0aGlzLl9nbG9iYWxEaXYuYXBwZW5kQ2hpbGQodGhpcy5fdHJlZURpdil9fSx0LnByb3RvdHlwZS5fZGlzcGxheVN0YXRzPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5fc2NlbmUsaT10LmdldEVuZ2luZSgpLHI9aS5nZXRHbEluZm8oKTt0aGlzLl9zdGF0c1N1YnNldERpdi5pbm5lckhUTUw9XCJCYWJ5bG9uLmpzIHZcIitlLkVuZ2luZS5WZXJzaW9uK1wiIC0gPGI+XCIrZS5Ub29scy5Gb3JtYXQoaS5nZXRGcHMoKSwwKStcIiBmcHM8L2I+PGJyPjxicj48ZGl2IHN0eWxlPSdjb2x1bW4tY291bnQ6IDI7LW1vei1jb2x1bW4tY291bnQ6Mjstd2Via2l0LWNvbHVtbi1jb3VudDoyJz48Yj5Db3VudDwvYj48YnI+VG90YWwgbWVzaGVzOiBcIit0Lm1lc2hlcy5sZW5ndGgrXCI8YnI+VG90YWwgbGlnaHRzOiBcIit0LmxpZ2h0cy5sZW5ndGgrXCI8YnI+VG90YWwgdmVydGljZXM6IFwiK3QuZ2V0VG90YWxWZXJ0aWNlcygpK1wiPGJyPlRvdGFsIG1hdGVyaWFsczogXCIrdC5tYXRlcmlhbHMubGVuZ3RoK1wiPGJyPlRvdGFsIHRleHR1cmVzOiBcIit0LnRleHR1cmVzLmxlbmd0aCtcIjxicj5BY3RpdmUgbWVzaGVzOiBcIit0LmdldEFjdGl2ZU1lc2hlcygpLmxlbmd0aCtcIjxicj5BY3RpdmUgaW5kaWNlczogXCIrdC5nZXRBY3RpdmVJbmRpY2VzKCkrXCI8YnI+QWN0aXZlIGJvbmVzOiBcIit0LmdldEFjdGl2ZUJvbmVzKCkrXCI8YnI+QWN0aXZlIHBhcnRpY2xlczogXCIrdC5nZXRBY3RpdmVQYXJ0aWNsZXMoKStcIjxicj48Yj5EcmF3IGNhbGxzOiBcIitpLmRyYXdDYWxscytcIjwvYj48YnI+PGJyPjxiPkR1cmF0aW9uPC9iPjxicj5NZXNoZXMgc2VsZWN0aW9uOjwvaT4gXCIrZS5Ub29scy5Gb3JtYXQodC5nZXRFdmFsdWF0ZUFjdGl2ZU1lc2hlc0R1cmF0aW9uKCkpK1wiIG1zPGJyPlJlbmRlciBUYXJnZXRzOiBcIitlLlRvb2xzLkZvcm1hdCh0LmdldFJlbmRlclRhcmdldHNEdXJhdGlvbigpKStcIiBtczxicj5QYXJ0aWNsZXM6IFwiK2UuVG9vbHMuRm9ybWF0KHQuZ2V0UGFydGljbGVzRHVyYXRpb24oKSkrXCIgbXM8YnI+U3ByaXRlczogXCIrZS5Ub29scy5Gb3JtYXQodC5nZXRTcHJpdGVzRHVyYXRpb24oKSkrXCIgbXM8YnI+PGJyPlJlbmRlcjogPGI+XCIrZS5Ub29scy5Gb3JtYXQodC5nZXRSZW5kZXJEdXJhdGlvbigpKStcIiBtczwvYj48YnI+RnJhbWU6IFwiK2UuVG9vbHMuRm9ybWF0KHQuZ2V0TGFzdEZyYW1lRHVyYXRpb24oKSkrXCIgbXM8YnI+UG90ZW50aWFsIEZQUzogXCIrZS5Ub29scy5Gb3JtYXQoMWUzL3QuZ2V0TGFzdEZyYW1lRHVyYXRpb24oKSwwKStcIjxicj5SZXNvbHV0aW9uOiBcIitpLmdldFJlbmRlcldpZHRoKCkrXCJ4XCIraS5nZXRSZW5kZXJIZWlnaHQoKStcIjxicj48YnI+PC9kaXY+PGRpdiBzdHlsZT0nY29sdW1uLWNvdW50OiAyOy1tb3otY29sdW1uLWNvdW50OjI7LXdlYmtpdC1jb2x1bW4tY291bnQ6Mic+PGI+RXh0ZW5zaW9uczwvYj48YnI+U3RkIGRlcml2YXRpdmVzOiBcIisoaS5nZXRDYXBzKCkuc3RhbmRhcmREZXJpdmF0aXZlcz9cIlllc1wiOlwiTm9cIikrXCI8YnI+Q29tcHJlc3NlZCB0ZXh0dXJlczogXCIrKGkuZ2V0Q2FwcygpLnMzdGM/XCJZZXNcIjpcIk5vXCIpK1wiPGJyPkhhcmR3YXJlIGluc3RhbmNlczogXCIrKGkuZ2V0Q2FwcygpLmluc3RhbmNlZEFycmF5cz9cIlllc1wiOlwiTm9cIikrXCI8YnI+VGV4dHVyZSBmbG9hdDogXCIrKGkuZ2V0Q2FwcygpLnRleHR1cmVGbG9hdD9cIlllc1wiOlwiTm9cIikrXCI8YnI+PGJyPjMyYml0cyBpbmRpY2VzOiBcIisoaS5nZXRDYXBzKCkudWludEluZGljZXM/XCJZZXNcIjpcIk5vXCIpK1wiPGJyPkZyYWdtZW50IGRlcHRoOiBcIisoaS5nZXRDYXBzKCkuZnJhZ21lbnREZXB0aFN1cHBvcnRlZD9cIlllc1wiOlwiTm9cIikrXCI8YnI+SGlnaCBwcmVjaXNpb24gc2hhZGVyczogXCIrKGkuZ2V0Q2FwcygpLmhpZ2hQcmVjaXNpb25TaGFkZXJTdXBwb3J0ZWQ/XCJZZXNcIjpcIk5vXCIpK1wiPGJyPkRyYXcgYnVmZmVyczogXCIrKGkuZ2V0Q2FwcygpLmRyYXdCdWZmZXJzRXh0ZW5zaW9uP1wiWWVzXCI6XCJOb1wiKStcIjxicj48L2Rpdj48YnI+PGRpdiBzdHlsZT0nY29sdW1uLWNvdW50OiAyOy1tb3otY29sdW1uLWNvdW50OjI7LXdlYmtpdC1jb2x1bW4tY291bnQ6Mic+PGI+Q2Fwcy48L2I+PGJyPk1heCB0ZXh0dXJlcyB1bml0czogXCIraS5nZXRDYXBzKCkubWF4VGV4dHVyZXNJbWFnZVVuaXRzK1wiPGJyPk1heCB0ZXh0dXJlcyBzaXplOiBcIitpLmdldENhcHMoKS5tYXhUZXh0dXJlU2l6ZStcIjxicj5NYXggYW5pc290cm9weTogXCIraS5nZXRDYXBzKCkubWF4QW5pc290cm9weStcIjxicj48Yj5JbmZvPC9iPjxicj5XZWJHTCBmZWF0dXJlIGxldmVsOiBcIitpLndlYkdMVmVyc2lvbitcIjxicj5cIityLnZlcnNpb24rXCI8YnI+PC9kaXY+PGJyPlwiK3IucmVuZGVyZXIrXCI8YnI+XCIsdGhpcy5jdXN0b21TdGF0c0Z1bmN0aW9uJiYodGhpcy5fc3RhdHNTdWJzZXREaXYuaW5uZXJIVE1MKz10aGlzLmN1c3RvbVN0YXRzRnVuY3Rpb24oKSl9LHR9KCk7ZS5EZWJ1Z0xheWVyPXR9KEJBQllMT058fChCQUJZTE9OPXt9KSksQkFCWUxPTi5FZmZlY3QuU2hhZGVyc1N0b3JlPXthbmFnbHlwaFBpeGVsU2hhZGVyOlwiXFxudmFyeWluZyB2ZWMyIHZVVjtcXG51bmlmb3JtIHNhbXBsZXIyRCB0ZXh0dXJlU2FtcGxlcjtcXG51bmlmb3JtIHNhbXBsZXIyRCBsZWZ0U2FtcGxlcjtcXG52b2lkIG1haW4odm9pZClcXG57XFxudmVjNCBsZWZ0RnJhZz10ZXh0dXJlMkQobGVmdFNhbXBsZXIsdlVWKTtcXG5sZWZ0RnJhZz12ZWM0KDEuMCxsZWZ0RnJhZy5nLGxlZnRGcmFnLmIsMS4wKTtcXG52ZWM0IHJpZ2h0RnJhZz10ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWKTtcXG5yaWdodEZyYWc9dmVjNChyaWdodEZyYWcuciwxLjAsMS4wLDEuMCk7XFxuZ2xfRnJhZ0NvbG9yPXZlYzQocmlnaHRGcmFnLnJnYipsZWZ0RnJhZy5yZ2IsMS4wKTtcXG59XCIsYmxhY2tBbmRXaGl0ZVBpeGVsU2hhZGVyOlwiXFxudmFyeWluZyB2ZWMyIHZVVjtcXG51bmlmb3JtIHNhbXBsZXIyRCB0ZXh0dXJlU2FtcGxlcjtcXG52b2lkIG1haW4odm9pZCkgXFxue1xcbmZsb2F0IGx1bWluYW5jZT1kb3QodGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVikucmdiLHZlYzMoMC4zLDAuNTksMC4xMSkpO1xcbmdsX0ZyYWdDb2xvcj12ZWM0KGx1bWluYW5jZSxsdW1pbmFuY2UsbHVtaW5hbmNlLDEuMCk7XFxufVwiLGJsdXJQaXhlbFNoYWRlcjpcIlxcbnZhcnlpbmcgdmVjMiB2VVY7XFxudW5pZm9ybSBzYW1wbGVyMkQgdGV4dHVyZVNhbXBsZXI7XFxuXFxudW5pZm9ybSB2ZWMyIHNjcmVlblNpemU7XFxudW5pZm9ybSB2ZWMyIGRpcmVjdGlvbjtcXG51bmlmb3JtIGZsb2F0IGJsdXJXaWR0aDtcXG52b2lkIG1haW4odm9pZClcXG57XFxuZmxvYXQgd2VpZ2h0c1s3XTtcXG53ZWlnaHRzWzBdPTAuMDU7XFxud2VpZ2h0c1sxXT0wLjE7XFxud2VpZ2h0c1syXT0wLjI7XFxud2VpZ2h0c1szXT0wLjM7XFxud2VpZ2h0c1s0XT0wLjI7XFxud2VpZ2h0c1s1XT0wLjE7XFxud2VpZ2h0c1s2XT0wLjA1O1xcbnZlYzIgdGV4ZWxTaXplPXZlYzIoMS4wL3NjcmVlblNpemUueCwxLjAvc2NyZWVuU2l6ZS55KTtcXG52ZWMyIHRleGVsU3RlcD10ZXhlbFNpemUqZGlyZWN0aW9uKmJsdXJXaWR0aDtcXG52ZWMyIHN0YXJ0PXZVVi0zLjAqdGV4ZWxTdGVwO1xcbnZlYzQgYmFzZUNvbG9yPXZlYzQoMC4sMC4sMC4sMC4pO1xcbnZlYzIgdGV4ZWxPZmZzZXQ9dmVjMigwLiwwLik7XFxuZm9yIChpbnQgaT0wOyBpPDc7IGkrKylcXG57XFxuYmFzZUNvbG9yKz10ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsc3RhcnQrdGV4ZWxPZmZzZXQpKndlaWdodHNbaV07XFxudGV4ZWxPZmZzZXQrPXRleGVsU3RlcDtcXG59XFxuZ2xfRnJhZ0NvbG9yPWJhc2VDb2xvcjtcXG59XCIsY2hyb21hdGljQWJlcnJhdGlvblBpeGVsU2hhZGVyOlwiXFxudW5pZm9ybSBzYW1wbGVyMkQgdGV4dHVyZVNhbXBsZXI7IFxcblxcbnVuaWZvcm0gZmxvYXQgY2hyb21hdGljX2FiZXJyYXRpb247XFxudW5pZm9ybSBmbG9hdCBzY3JlZW5fd2lkdGg7XFxudW5pZm9ybSBmbG9hdCBzY3JlZW5faGVpZ2h0O1xcblxcbnZhcnlpbmcgdmVjMiB2VVY7XFxudm9pZCBtYWluKHZvaWQpXFxue1xcbnZlYzIgY2VudGVyZWRfc2NyZWVuX3Bvcz12ZWMyKHZVVi54LTAuNSx2VVYueS0wLjUpO1xcbmZsb2F0IHJhZGl1czI9Y2VudGVyZWRfc2NyZWVuX3Bvcy54KmNlbnRlcmVkX3NjcmVlbl9wb3MueFxcbitjZW50ZXJlZF9zY3JlZW5fcG9zLnkqY2VudGVyZWRfc2NyZWVuX3Bvcy55O1xcbmZsb2F0IHJhZGl1cz1zcXJ0KHJhZGl1czIpO1xcbnZlYzQgb3JpZ2luYWw9dGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVik7XFxuaWYgKGNocm9tYXRpY19hYmVycmF0aW9uPjAuMCkge1xcblxcbnZlYzMgcmVmX2luZGljZXM9dmVjMygtMC4zLDAuMCwwLjMpO1xcbmZsb2F0IHJlZl9zaGlmdFg9Y2hyb21hdGljX2FiZXJyYXRpb24qcmFkaXVzKjE3LjAvc2NyZWVuX3dpZHRoO1xcbmZsb2F0IHJlZl9zaGlmdFk9Y2hyb21hdGljX2FiZXJyYXRpb24qcmFkaXVzKjE3LjAvc2NyZWVuX2hlaWdodDtcXG5cXG52ZWMyIHJlZl9jb29yZHNfcj12ZWMyKHZVVi54K3JlZl9pbmRpY2VzLnIqcmVmX3NoaWZ0WCx2VVYueStyZWZfaW5kaWNlcy5yKnJlZl9zaGlmdFkqMC41KTtcXG52ZWMyIHJlZl9jb29yZHNfZz12ZWMyKHZVVi54K3JlZl9pbmRpY2VzLmcqcmVmX3NoaWZ0WCx2VVYueStyZWZfaW5kaWNlcy5nKnJlZl9zaGlmdFkqMC41KTtcXG52ZWMyIHJlZl9jb29yZHNfYj12ZWMyKHZVVi54K3JlZl9pbmRpY2VzLmIqcmVmX3NoaWZ0WCx2VVYueStyZWZfaW5kaWNlcy5iKnJlZl9zaGlmdFkqMC41KTtcXG5vcmlnaW5hbC5yPXRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcixyZWZfY29vcmRzX3IpLnI7XFxub3JpZ2luYWwuZz10ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIscmVmX2Nvb3Jkc19nKS5nO1xcbm9yaWdpbmFsLmI9dGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHJlZl9jb29yZHNfYikuYjtcXG59XFxuZ2xfRnJhZ0NvbG9yPW9yaWdpbmFsO1xcbn1cIixjb2xvclBpeGVsU2hhZGVyOlwidW5pZm9ybSB2ZWM0IGNvbG9yO1xcbnZvaWQgbWFpbih2b2lkKSB7XFxuZ2xfRnJhZ0NvbG9yPWNvbG9yO1xcbn1cIixjb2xvclZlcnRleFNoYWRlcjpcIlxcbmF0dHJpYnV0ZSB2ZWMzIHBvc2l0aW9uO1xcblxcbnVuaWZvcm0gbWF0NCB3b3JsZFZpZXdQcm9qZWN0aW9uO1xcbnZvaWQgbWFpbih2b2lkKSB7XFxuZ2xfUG9zaXRpb249d29ybGRWaWV3UHJvamVjdGlvbip2ZWM0KHBvc2l0aW9uLDEuMCk7XFxufVwiLGNvbG9yQ29ycmVjdGlvblBpeGVsU2hhZGVyOlwiXFxudW5pZm9ybSBzYW1wbGVyMkQgdGV4dHVyZVNhbXBsZXI7IFxcbnVuaWZvcm0gc2FtcGxlcjJEIGNvbG9yVGFibGU7IFxcblxcbnZhcnlpbmcgdmVjMiB2VVY7XFxuXFxuY29uc3QgZmxvYXQgU0xJQ0VfQ09VTlQ9MTYuMDsgXFxuXFxudmVjNCBzYW1wbGVBczNEVGV4dHVyZShzYW1wbGVyMkQgdGV4dHVyZSx2ZWMzIHV2LGZsb2F0IHdpZHRoKSB7XFxuZmxvYXQgc2xpY2VTaXplPTEuMC93aWR0aDsgXFxuZmxvYXQgc2xpY2VQaXhlbFNpemU9c2xpY2VTaXplL3dpZHRoOyBcXG5mbG9hdCBzbGljZUlubmVyU2l6ZT1zbGljZVBpeGVsU2l6ZSood2lkdGgtMS4wKTsgXFxuZmxvYXQgelNsaWNlMD1taW4oZmxvb3IodXYueip3aWR0aCksd2lkdGgtMS4wKTtcXG5mbG9hdCB6U2xpY2UxPW1pbih6U2xpY2UwKzEuMCx3aWR0aC0xLjApO1xcbmZsb2F0IHhPZmZzZXQ9c2xpY2VQaXhlbFNpemUqMC41K3V2Lngqc2xpY2VJbm5lclNpemU7XFxuZmxvYXQgczA9eE9mZnNldCsoelNsaWNlMCpzbGljZVNpemUpO1xcbmZsb2F0IHMxPXhPZmZzZXQrKHpTbGljZTEqc2xpY2VTaXplKTtcXG52ZWM0IHNsaWNlMENvbG9yPXRleHR1cmUyRCh0ZXh0dXJlLHZlYzIoczAsdXYueSkpO1xcbnZlYzQgc2xpY2UxQ29sb3I9dGV4dHVyZTJEKHRleHR1cmUsdmVjMihzMSx1di55KSk7XFxuZmxvYXQgek9mZnNldD1tb2QodXYueip3aWR0aCwxLjApO1xcbnZlYzQgcmVzdWx0PW1peChzbGljZTBDb2xvcixzbGljZTFDb2xvcix6T2Zmc2V0KTtcXG5yZXR1cm4gcmVzdWx0O1xcbn1cXG52b2lkIG1haW4odm9pZClcXG57XFxudmVjNCBzY3JlZW5fY29sb3I9dGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVik7XFxuZ2xfRnJhZ0NvbG9yPXNhbXBsZUFzM0RUZXh0dXJlKGNvbG9yVGFibGUsc2NyZWVuX2NvbG9yLnJnYixTTElDRV9DT1VOVCk7XFxufVwiLGNvbnZvbHV0aW9uUGl4ZWxTaGFkZXI6XCJcXG52YXJ5aW5nIHZlYzIgdlVWO1xcbnVuaWZvcm0gc2FtcGxlcjJEIHRleHR1cmVTYW1wbGVyO1xcbnVuaWZvcm0gdmVjMiBzY3JlZW5TaXplO1xcbnVuaWZvcm0gZmxvYXQga2VybmVsWzldO1xcbnZvaWQgbWFpbih2b2lkKVxcbntcXG52ZWMyIG9uZVBpeGVsPXZlYzIoMS4wLDEuMCkvc2NyZWVuU2l6ZTtcXG52ZWM0IGNvbG9yU3VtID1cXG50ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK29uZVBpeGVsKnZlYzIoLTEsLTEpKSprZXJuZWxbMF0gK1xcbnRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcix2VVYrb25lUGl4ZWwqdmVjMigwLC0xKSkqa2VybmVsWzFdICtcXG50ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK29uZVBpeGVsKnZlYzIoMSwtMSkpKmtlcm5lbFsyXSArXFxudGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVitvbmVQaXhlbCp2ZWMyKC0xLDApKSprZXJuZWxbM10gK1xcbnRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcix2VVYrb25lUGl4ZWwqdmVjMigwLDApKSprZXJuZWxbNF0gK1xcbnRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcix2VVYrb25lUGl4ZWwqdmVjMigxLDApKSprZXJuZWxbNV0gK1xcbnRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcix2VVYrb25lUGl4ZWwqdmVjMigtMSwxKSkqa2VybmVsWzZdICtcXG50ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK29uZVBpeGVsKnZlYzIoMCwxKSkqa2VybmVsWzddICtcXG50ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK29uZVBpeGVsKnZlYzIoMSwxKSkqa2VybmVsWzhdO1xcbmZsb2F0IGtlcm5lbFdlaWdodCA9XFxua2VybmVsWzBdICtcXG5rZXJuZWxbMV0gK1xcbmtlcm5lbFsyXSArXFxua2VybmVsWzNdICtcXG5rZXJuZWxbNF0gK1xcbmtlcm5lbFs1XSArXFxua2VybmVsWzZdICtcXG5rZXJuZWxbN10gK1xcbmtlcm5lbFs4XTtcXG5pZiAoa2VybmVsV2VpZ2h0PD0wLjApIHtcXG5rZXJuZWxXZWlnaHQ9MS4wO1xcbn1cXG5nbF9GcmFnQ29sb3I9dmVjNCgoY29sb3JTdW0va2VybmVsV2VpZ2h0KS5yZ2IsMSk7XFxufVwiLGRlZmF1bHRQaXhlbFNoYWRlcjpcIiNpZmRlZiBCVU1QXFxuI2V4dGVuc2lvbiBHTF9PRVNfc3RhbmRhcmRfZGVyaXZhdGl2ZXMgOiBlbmFibGVcXG4jZW5kaWZcXG4jaWZkZWYgTE9HQVJJVEhNSUNERVBUSFxcbiNleHRlbnNpb24gR0xfRVhUX2ZyYWdfZGVwdGggOiBlbmFibGVcXG4jZW5kaWZcXG5cXG4jZGVmaW5lIFJFQ0lQUk9DQUxfUEkyIDAuMTU5MTU0OTRcXG51bmlmb3JtIHZlYzMgdkV5ZVBvc2l0aW9uO1xcbnVuaWZvcm0gdmVjMyB2QW1iaWVudENvbG9yO1xcbnVuaWZvcm0gdmVjNCB2RGlmZnVzZUNvbG9yO1xcbiNpZmRlZiBTUEVDVUxBUlRFUk1cXG51bmlmb3JtIHZlYzQgdlNwZWN1bGFyQ29sb3I7XFxuI2VuZGlmXFxudW5pZm9ybSB2ZWMzIHZFbWlzc2l2ZUNvbG9yO1xcblxcbnZhcnlpbmcgdmVjMyB2UG9zaXRpb25XO1xcbiNpZmRlZiBOT1JNQUxcXG52YXJ5aW5nIHZlYzMgdk5vcm1hbFc7XFxuI2VuZGlmXFxuI2lmZGVmIFZFUlRFWENPTE9SXFxudmFyeWluZyB2ZWM0IHZDb2xvcjtcXG4jZW5kaWZcXG5cXG4jaW5jbHVkZTxoZWxwZXJGdW5jdGlvbnM+XFxuXFxuI2luY2x1ZGU8bGlnaHRGcmFnbWVudERlY2xhcmF0aW9uPlswLi5tYXhTaW11bHRhbmVvdXNMaWdodHNdXFxuI2luY2x1ZGU8bGlnaHRzRnJhZ21lbnRGdW5jdGlvbnM+XFxuI2luY2x1ZGU8c2hhZG93c0ZyYWdtZW50RnVuY3Rpb25zPlxcblxcbiNpZmRlZiBESUZGVVNFXFxudmFyeWluZyB2ZWMyIHZEaWZmdXNlVVY7XFxudW5pZm9ybSBzYW1wbGVyMkQgZGlmZnVzZVNhbXBsZXI7XFxudW5pZm9ybSB2ZWMyIHZEaWZmdXNlSW5mb3M7XFxuI2VuZGlmXFxuI2lmZGVmIEFNQklFTlRcXG52YXJ5aW5nIHZlYzIgdkFtYmllbnRVVjtcXG51bmlmb3JtIHNhbXBsZXIyRCBhbWJpZW50U2FtcGxlcjtcXG51bmlmb3JtIHZlYzIgdkFtYmllbnRJbmZvcztcXG4jZW5kaWZcXG4jaWZkZWYgT1BBQ0lUWSBcXG52YXJ5aW5nIHZlYzIgdk9wYWNpdHlVVjtcXG51bmlmb3JtIHNhbXBsZXIyRCBvcGFjaXR5U2FtcGxlcjtcXG51bmlmb3JtIHZlYzIgdk9wYWNpdHlJbmZvcztcXG4jZW5kaWZcXG4jaWZkZWYgRU1JU1NJVkVcXG52YXJ5aW5nIHZlYzIgdkVtaXNzaXZlVVY7XFxudW5pZm9ybSB2ZWMyIHZFbWlzc2l2ZUluZm9zO1xcbnVuaWZvcm0gc2FtcGxlcjJEIGVtaXNzaXZlU2FtcGxlcjtcXG4jZW5kaWZcXG4jaWZkZWYgTElHSFRNQVBcXG52YXJ5aW5nIHZlYzIgdkxpZ2h0bWFwVVY7XFxudW5pZm9ybSB2ZWMyIHZMaWdodG1hcEluZm9zO1xcbnVuaWZvcm0gc2FtcGxlcjJEIGxpZ2h0bWFwU2FtcGxlcjtcXG4jZW5kaWZcXG4jaWYgZGVmaW5lZChSRUZMRUNUSU9OTUFQX1NQSEVSSUNBTCkgfHwgZGVmaW5lZChSRUZMRUNUSU9OTUFQX1BST0pFQ1RJT04pIHx8IGRlZmluZWQoUkVGUkFDVElPTilcXG51bmlmb3JtIG1hdDQgdmlldztcXG4jZW5kaWZcXG4jaWZkZWYgUkVGUkFDVElPTlxcbnVuaWZvcm0gdmVjNCB2UmVmcmFjdGlvbkluZm9zO1xcbiNpZmRlZiBSRUZSQUNUSU9OTUFQXzNEXFxudW5pZm9ybSBzYW1wbGVyQ3ViZSByZWZyYWN0aW9uQ3ViZVNhbXBsZXI7XFxuI2Vsc2VcXG51bmlmb3JtIHNhbXBsZXIyRCByZWZyYWN0aW9uMkRTYW1wbGVyO1xcbnVuaWZvcm0gbWF0NCByZWZyYWN0aW9uTWF0cml4O1xcbiNlbmRpZlxcbiNpZmRlZiBSRUZSQUNUSU9ORlJFU05FTFxcbnVuaWZvcm0gdmVjNCByZWZyYWN0aW9uTGVmdENvbG9yO1xcbnVuaWZvcm0gdmVjNCByZWZyYWN0aW9uUmlnaHRDb2xvcjtcXG4jZW5kaWZcXG4jZW5kaWZcXG4jaWYgZGVmaW5lZChTUEVDVUxBUikgJiYgZGVmaW5lZChTUEVDVUxBUlRFUk0pXFxudmFyeWluZyB2ZWMyIHZTcGVjdWxhclVWO1xcbnVuaWZvcm0gdmVjMiB2U3BlY3VsYXJJbmZvcztcXG51bmlmb3JtIHNhbXBsZXIyRCBzcGVjdWxhclNhbXBsZXI7XFxuI2VuZGlmXFxuXFxuI2luY2x1ZGU8ZnJlc25lbEZ1bmN0aW9uPlxcbiNpZmRlZiBESUZGVVNFRlJFU05FTFxcbnVuaWZvcm0gdmVjNCBkaWZmdXNlTGVmdENvbG9yO1xcbnVuaWZvcm0gdmVjNCBkaWZmdXNlUmlnaHRDb2xvcjtcXG4jZW5kaWZcXG4jaWZkZWYgT1BBQ0lUWUZSRVNORUxcXG51bmlmb3JtIHZlYzQgb3BhY2l0eVBhcnRzO1xcbiNlbmRpZlxcbiNpZmRlZiBFTUlTU0lWRUZSRVNORUxcXG51bmlmb3JtIHZlYzQgZW1pc3NpdmVMZWZ0Q29sb3I7XFxudW5pZm9ybSB2ZWM0IGVtaXNzaXZlUmlnaHRDb2xvcjtcXG4jZW5kaWZcXG5cXG4jaWZkZWYgUkVGTEVDVElPTlxcbnVuaWZvcm0gdmVjMiB2UmVmbGVjdGlvbkluZm9zO1xcbiNpZmRlZiBSRUZMRUNUSU9OTUFQXzNEXFxudW5pZm9ybSBzYW1wbGVyQ3ViZSByZWZsZWN0aW9uQ3ViZVNhbXBsZXI7XFxuI2Vsc2VcXG51bmlmb3JtIHNhbXBsZXIyRCByZWZsZWN0aW9uMkRTYW1wbGVyO1xcbiNlbmRpZlxcbiNpZmRlZiBSRUZMRUNUSU9OTUFQX1NLWUJPWFxcbnZhcnlpbmcgdmVjMyB2UG9zaXRpb25VVlc7XFxuI2Vsc2VcXG4jaWZkZWYgUkVGTEVDVElPTk1BUF9FUVVJUkVDVEFOR1VMQVJfRklYRURcXG52YXJ5aW5nIHZlYzMgdkRpcmVjdGlvblc7XFxuI2VuZGlmXFxuI2lmIGRlZmluZWQoUkVGTEVDVElPTk1BUF9QTEFOQVIpIHx8IGRlZmluZWQoUkVGTEVDVElPTk1BUF9DVUJJQykgfHwgZGVmaW5lZChSRUZMRUNUSU9OTUFQX1BST0pFQ1RJT04pXFxudW5pZm9ybSBtYXQ0IHJlZmxlY3Rpb25NYXRyaXg7XFxuI2VuZGlmXFxuI2VuZGlmXFxuI2luY2x1ZGU8cmVmbGVjdGlvbkZ1bmN0aW9uPlxcbiNpZmRlZiBSRUZMRUNUSU9ORlJFU05FTFxcbnVuaWZvcm0gdmVjNCByZWZsZWN0aW9uTGVmdENvbG9yO1xcbnVuaWZvcm0gdmVjNCByZWZsZWN0aW9uUmlnaHRDb2xvcjtcXG4jZW5kaWZcXG4jZW5kaWZcXG4jaW5jbHVkZTxidW1wRnJhZ21lbnRGdW5jdGlvbnM+XFxuI2luY2x1ZGU8Y2xpcFBsYW5lRnJhZ21lbnREZWNsYXJhdGlvbj5cXG4jaW5jbHVkZTxsb2dEZXB0aERlY2xhcmF0aW9uPlxcbiNpbmNsdWRlPGZvZ0ZyYWdtZW50RGVjbGFyYXRpb24+XFxudm9pZCBtYWluKHZvaWQpIHtcXG4jaW5jbHVkZTxjbGlwUGxhbmVGcmFnbWVudD5cXG52ZWMzIHZpZXdEaXJlY3Rpb25XPW5vcm1hbGl6ZSh2RXllUG9zaXRpb24tdlBvc2l0aW9uVyk7XFxuXFxudmVjNCBiYXNlQ29sb3I9dmVjNCgxLiwxLiwxLiwxLik7XFxudmVjMyBkaWZmdXNlQ29sb3I9dkRpZmZ1c2VDb2xvci5yZ2I7XFxuXFxuZmxvYXQgYWxwaGE9dkRpZmZ1c2VDb2xvci5hO1xcblxcbiNpZmRlZiBOT1JNQUxcXG52ZWMzIG5vcm1hbFc9bm9ybWFsaXplKHZOb3JtYWxXKTtcXG4jZWxzZVxcbnZlYzMgbm9ybWFsVz12ZWMzKDEuMCwxLjAsMS4wKTtcXG4jZW5kaWZcXG4jaWZkZWYgRElGRlVTRVxcbnZlYzIgZGlmZnVzZVVWPXZEaWZmdXNlVVY7XFxuI2VuZGlmXFxuI2luY2x1ZGU8YnVtcEZyYWdtZW50PlxcbiNpZmRlZiBESUZGVVNFXFxuYmFzZUNvbG9yPXRleHR1cmUyRChkaWZmdXNlU2FtcGxlcixkaWZmdXNlVVYpO1xcbiNpZmRlZiBBTFBIQVRFU1RcXG5pZiAoYmFzZUNvbG9yLmE8MC40KVxcbmRpc2NhcmQ7XFxuI2VuZGlmXFxuI2lmZGVmIEFMUEhBRlJPTURJRkZVU0VcXG5hbHBoYSo9YmFzZUNvbG9yLmE7XFxuI2VuZGlmXFxuYmFzZUNvbG9yLnJnYio9dkRpZmZ1c2VJbmZvcy55O1xcbiNlbmRpZlxcbiNpZmRlZiBWRVJURVhDT0xPUlxcbmJhc2VDb2xvci5yZ2IqPXZDb2xvci5yZ2I7XFxuI2VuZGlmXFxuXFxudmVjMyBiYXNlQW1iaWVudENvbG9yPXZlYzMoMS4sMS4sMS4pO1xcbiNpZmRlZiBBTUJJRU5UXFxuYmFzZUFtYmllbnRDb2xvcj10ZXh0dXJlMkQoYW1iaWVudFNhbXBsZXIsdkFtYmllbnRVVikucmdiKnZBbWJpZW50SW5mb3MueTtcXG4jZW5kaWZcXG5cXG4jaWZkZWYgU1BFQ1VMQVJURVJNXFxuZmxvYXQgZ2xvc3NpbmVzcz12U3BlY3VsYXJDb2xvci5hO1xcbnZlYzMgc3BlY3VsYXJDb2xvcj12U3BlY3VsYXJDb2xvci5yZ2I7XFxuI2lmZGVmIFNQRUNVTEFSXFxudmVjNCBzcGVjdWxhck1hcENvbG9yPXRleHR1cmUyRChzcGVjdWxhclNhbXBsZXIsdlNwZWN1bGFyVVYpO1xcbnNwZWN1bGFyQ29sb3I9c3BlY3VsYXJNYXBDb2xvci5yZ2I7XFxuI2lmZGVmIEdMT1NTSU5FU1NcXG5nbG9zc2luZXNzPWdsb3NzaW5lc3Mqc3BlY3VsYXJNYXBDb2xvci5hO1xcbiNlbmRpZlxcbiNlbmRpZlxcbiNlbHNlXFxuZmxvYXQgZ2xvc3NpbmVzcz0wLjtcXG4jZW5kaWZcXG5cXG52ZWMzIGRpZmZ1c2VCYXNlPXZlYzMoMC4sMC4sMC4pO1xcbmxpZ2h0aW5nSW5mbyBpbmZvO1xcbiNpZmRlZiBTUEVDVUxBUlRFUk1cXG52ZWMzIHNwZWN1bGFyQmFzZT12ZWMzKDAuLDAuLDAuKTtcXG4jZW5kaWZcXG5mbG9hdCBzaGFkb3c9MS47XFxuI2luY2x1ZGU8bGlnaHRGcmFnbWVudD5bMC4ubWF4U2ltdWx0YW5lb3VzTGlnaHRzXVxcblxcbnZlYzMgcmVmcmFjdGlvbkNvbG9yPXZlYzMoMC4sMC4sMC4pO1xcbiNpZmRlZiBSRUZSQUNUSU9OXFxudmVjMyByZWZyYWN0aW9uVmVjdG9yPW5vcm1hbGl6ZShyZWZyYWN0KC12aWV3RGlyZWN0aW9uVyxub3JtYWxXLHZSZWZyYWN0aW9uSW5mb3MueSkpO1xcbiNpZmRlZiBSRUZSQUNUSU9OTUFQXzNEXFxucmVmcmFjdGlvblZlY3Rvci55PXJlZnJhY3Rpb25WZWN0b3IueSp2UmVmcmFjdGlvbkluZm9zLnc7XFxuaWYgKGRvdChyZWZyYWN0aW9uVmVjdG9yLHZpZXdEaXJlY3Rpb25XKTwxLjApXFxue1xcbnJlZnJhY3Rpb25Db2xvcj10ZXh0dXJlQ3ViZShyZWZyYWN0aW9uQ3ViZVNhbXBsZXIscmVmcmFjdGlvblZlY3RvcikucmdiKnZSZWZyYWN0aW9uSW5mb3MueDtcXG59XFxuI2Vsc2VcXG52ZWMzIHZSZWZyYWN0aW9uVVZXPXZlYzMocmVmcmFjdGlvbk1hdHJpeCoodmlldyp2ZWM0KHZQb3NpdGlvblcrcmVmcmFjdGlvblZlY3Rvcip2UmVmcmFjdGlvbkluZm9zLnosMS4wKSkpO1xcbnZlYzIgcmVmcmFjdGlvbkNvb3Jkcz12UmVmcmFjdGlvblVWVy54eS92UmVmcmFjdGlvblVWVy56O1xcbnJlZnJhY3Rpb25Db29yZHMueT0xLjAtcmVmcmFjdGlvbkNvb3Jkcy55O1xcbnJlZnJhY3Rpb25Db2xvcj10ZXh0dXJlMkQocmVmcmFjdGlvbjJEU2FtcGxlcixyZWZyYWN0aW9uQ29vcmRzKS5yZ2IqdlJlZnJhY3Rpb25JbmZvcy54O1xcbiNlbmRpZlxcbiNlbmRpZlxcblxcbnZlYzMgcmVmbGVjdGlvbkNvbG9yPXZlYzMoMC4sMC4sMC4pO1xcbiNpZmRlZiBSRUZMRUNUSU9OXFxudmVjMyB2UmVmbGVjdGlvblVWVz1jb21wdXRlUmVmbGVjdGlvbkNvb3Jkcyh2ZWM0KHZQb3NpdGlvblcsMS4wKSxub3JtYWxXKTtcXG4jaWZkZWYgUkVGTEVDVElPTk1BUF8zRFxcbiNpZmRlZiBST1VHSE5FU1NcXG5mbG9hdCBiaWFzPXZSZWZsZWN0aW9uSW5mb3MueTtcXG4jaWZkZWYgU1BFQ1VMQVJURVJNXFxuI2lmZGVmIFNQRUNVTEFSXFxuI2lmZGVmIEdMT1NTSU5FU1NcXG5iaWFzKj0oMS4wLXNwZWN1bGFyTWFwQ29sb3IuYSk7XFxuI2VuZGlmXFxuI2VuZGlmXFxuI2VuZGlmXFxucmVmbGVjdGlvbkNvbG9yPXRleHR1cmVDdWJlKHJlZmxlY3Rpb25DdWJlU2FtcGxlcix2UmVmbGVjdGlvblVWVyxiaWFzKS5yZ2IqdlJlZmxlY3Rpb25JbmZvcy54O1xcbiNlbHNlXFxucmVmbGVjdGlvbkNvbG9yPXRleHR1cmVDdWJlKHJlZmxlY3Rpb25DdWJlU2FtcGxlcix2UmVmbGVjdGlvblVWVykucmdiKnZSZWZsZWN0aW9uSW5mb3MueDtcXG4jZW5kaWZcXG4jZWxzZVxcbnZlYzIgY29vcmRzPXZSZWZsZWN0aW9uVVZXLnh5O1xcbiNpZmRlZiBSRUZMRUNUSU9OTUFQX1BST0pFQ1RJT05cXG5jb29yZHMvPXZSZWZsZWN0aW9uVVZXLno7XFxuI2VuZGlmXFxuY29vcmRzLnk9MS4wLWNvb3Jkcy55O1xcbnJlZmxlY3Rpb25Db2xvcj10ZXh0dXJlMkQocmVmbGVjdGlvbjJEU2FtcGxlcixjb29yZHMpLnJnYip2UmVmbGVjdGlvbkluZm9zLng7XFxuI2VuZGlmXFxuI2lmZGVmIFJFRkxFQ1RJT05GUkVTTkVMXFxuZmxvYXQgcmVmbGVjdGlvbkZyZXNuZWxUZXJtPWNvbXB1dGVGcmVzbmVsVGVybSh2aWV3RGlyZWN0aW9uVyxub3JtYWxXLHJlZmxlY3Rpb25SaWdodENvbG9yLmEscmVmbGVjdGlvbkxlZnRDb2xvci5hKTtcXG4jaWZkZWYgUkVGTEVDVElPTkZSRVNORUxGUk9NU1BFQ1VMQVJcXG4jaWZkZWYgU1BFQ1VMQVJURVJNXFxucmVmbGVjdGlvbkNvbG9yKj1zcGVjdWxhckNvbG9yLnJnYiooMS4wLXJlZmxlY3Rpb25GcmVzbmVsVGVybSkrcmVmbGVjdGlvbkZyZXNuZWxUZXJtKnJlZmxlY3Rpb25SaWdodENvbG9yLnJnYjtcXG4jZWxzZVxcbnJlZmxlY3Rpb25Db2xvcio9cmVmbGVjdGlvbkxlZnRDb2xvci5yZ2IqKDEuMC1yZWZsZWN0aW9uRnJlc25lbFRlcm0pK3JlZmxlY3Rpb25GcmVzbmVsVGVybSpyZWZsZWN0aW9uUmlnaHRDb2xvci5yZ2I7XFxuI2VuZGlmXFxuI2Vsc2VcXG5yZWZsZWN0aW9uQ29sb3IqPXJlZmxlY3Rpb25MZWZ0Q29sb3IucmdiKigxLjAtcmVmbGVjdGlvbkZyZXNuZWxUZXJtKStyZWZsZWN0aW9uRnJlc25lbFRlcm0qcmVmbGVjdGlvblJpZ2h0Q29sb3IucmdiO1xcbiNlbmRpZlxcbiNlbmRpZlxcbiNlbmRpZlxcbiNpZmRlZiBSRUZSQUNUSU9ORlJFU05FTFxcbmZsb2F0IHJlZnJhY3Rpb25GcmVzbmVsVGVybT1jb21wdXRlRnJlc25lbFRlcm0odmlld0RpcmVjdGlvblcsbm9ybWFsVyxyZWZyYWN0aW9uUmlnaHRDb2xvci5hLHJlZnJhY3Rpb25MZWZ0Q29sb3IuYSk7XFxucmVmcmFjdGlvbkNvbG9yKj1yZWZyYWN0aW9uTGVmdENvbG9yLnJnYiooMS4wLXJlZnJhY3Rpb25GcmVzbmVsVGVybSkrcmVmcmFjdGlvbkZyZXNuZWxUZXJtKnJlZnJhY3Rpb25SaWdodENvbG9yLnJnYjtcXG4jZW5kaWZcXG4jaWZkZWYgT1BBQ0lUWVxcbnZlYzQgb3BhY2l0eU1hcD10ZXh0dXJlMkQob3BhY2l0eVNhbXBsZXIsdk9wYWNpdHlVVik7XFxuI2lmZGVmIE9QQUNJVFlSR0JcXG5vcGFjaXR5TWFwLnJnYj1vcGFjaXR5TWFwLnJnYip2ZWMzKDAuMywwLjU5LDAuMTEpO1xcbmFscGhhKj0ob3BhY2l0eU1hcC54K29wYWNpdHlNYXAueStvcGFjaXR5TWFwLnopKiB2T3BhY2l0eUluZm9zLnk7XFxuI2Vsc2VcXG5hbHBoYSo9b3BhY2l0eU1hcC5hKnZPcGFjaXR5SW5mb3MueTtcXG4jZW5kaWZcXG4jZW5kaWZcXG4jaWZkZWYgVkVSVEVYQUxQSEFcXG5hbHBoYSo9dkNvbG9yLmE7XFxuI2VuZGlmXFxuI2lmZGVmIE9QQUNJVFlGUkVTTkVMXFxuZmxvYXQgb3BhY2l0eUZyZXNuZWxUZXJtPWNvbXB1dGVGcmVzbmVsVGVybSh2aWV3RGlyZWN0aW9uVyxub3JtYWxXLG9wYWNpdHlQYXJ0cy56LG9wYWNpdHlQYXJ0cy53KTtcXG5hbHBoYSs9b3BhY2l0eVBhcnRzLngqKDEuMC1vcGFjaXR5RnJlc25lbFRlcm0pK29wYWNpdHlGcmVzbmVsVGVybSpvcGFjaXR5UGFydHMueTtcXG4jZW5kaWZcXG5cXG52ZWMzIGVtaXNzaXZlQ29sb3I9dkVtaXNzaXZlQ29sb3I7XFxuI2lmZGVmIEVNSVNTSVZFXFxuZW1pc3NpdmVDb2xvcis9dGV4dHVyZTJEKGVtaXNzaXZlU2FtcGxlcix2RW1pc3NpdmVVVikucmdiKnZFbWlzc2l2ZUluZm9zLnk7XFxuI2VuZGlmXFxuI2lmZGVmIEVNSVNTSVZFRlJFU05FTFxcbmZsb2F0IGVtaXNzaXZlRnJlc25lbFRlcm09Y29tcHV0ZUZyZXNuZWxUZXJtKHZpZXdEaXJlY3Rpb25XLG5vcm1hbFcsZW1pc3NpdmVSaWdodENvbG9yLmEsZW1pc3NpdmVMZWZ0Q29sb3IuYSk7XFxuZW1pc3NpdmVDb2xvcio9ZW1pc3NpdmVMZWZ0Q29sb3IucmdiKigxLjAtZW1pc3NpdmVGcmVzbmVsVGVybSkrZW1pc3NpdmVGcmVzbmVsVGVybSplbWlzc2l2ZVJpZ2h0Q29sb3IucmdiO1xcbiNlbmRpZlxcblxcbiNpZmRlZiBESUZGVVNFRlJFU05FTFxcbmZsb2F0IGRpZmZ1c2VGcmVzbmVsVGVybT1jb21wdXRlRnJlc25lbFRlcm0odmlld0RpcmVjdGlvblcsbm9ybWFsVyxkaWZmdXNlUmlnaHRDb2xvci5hLGRpZmZ1c2VMZWZ0Q29sb3IuYSk7XFxuZGlmZnVzZUJhc2UqPWRpZmZ1c2VMZWZ0Q29sb3IucmdiKigxLjAtZGlmZnVzZUZyZXNuZWxUZXJtKStkaWZmdXNlRnJlc25lbFRlcm0qZGlmZnVzZVJpZ2h0Q29sb3IucmdiO1xcbiNlbmRpZlxcblxcbiNpZmRlZiBFTUlTU0lWRUFTSUxMVU1JTkFUSU9OXFxudmVjMyBmaW5hbERpZmZ1c2U9Y2xhbXAoZGlmZnVzZUJhc2UqZGlmZnVzZUNvbG9yK3ZBbWJpZW50Q29sb3IsMC4wLDEuMCkqYmFzZUNvbG9yLnJnYjtcXG4jZWxzZVxcbiNpZmRlZiBMSU5LRU1JU1NJVkVXSVRIRElGRlVTRVxcbnZlYzMgZmluYWxEaWZmdXNlPWNsYW1wKChkaWZmdXNlQmFzZStlbWlzc2l2ZUNvbG9yKSpkaWZmdXNlQ29sb3IrdkFtYmllbnRDb2xvciwwLjAsMS4wKSpiYXNlQ29sb3IucmdiO1xcbiNlbHNlXFxudmVjMyBmaW5hbERpZmZ1c2U9Y2xhbXAoZGlmZnVzZUJhc2UqZGlmZnVzZUNvbG9yK2VtaXNzaXZlQ29sb3IrdkFtYmllbnRDb2xvciwwLjAsMS4wKSpiYXNlQ29sb3IucmdiO1xcbiNlbmRpZlxcbiNlbmRpZlxcbiNpZmRlZiBTUEVDVUxBUlRFUk1cXG52ZWMzIGZpbmFsU3BlY3VsYXI9c3BlY3VsYXJCYXNlKnNwZWN1bGFyQ29sb3I7XFxuI2Vsc2VcXG52ZWMzIGZpbmFsU3BlY3VsYXI9dmVjMygwLjApO1xcbiNlbmRpZlxcbiNpZmRlZiBTUEVDVUxBUk9WRVJBTFBIQVxcbmFscGhhPWNsYW1wKGFscGhhK2RvdChmaW5hbFNwZWN1bGFyLHZlYzMoMC4zLDAuNTksMC4xMSkpLDAuLDEuKTtcXG4jZW5kaWZcXG4jaWZkZWYgUkVGTEVDVElPTk9WRVJBTFBIQVxcbmFscGhhPWNsYW1wKGFscGhhK2RvdChyZWZsZWN0aW9uQ29sb3IsdmVjMygwLjMsMC41OSwwLjExKSksMC4sMS4pO1xcbiNlbmRpZlxcblxcbiNpZmRlZiBFTUlTU0lWRUFTSUxMVU1JTkFUSU9OXFxudmVjNCBjb2xvcj12ZWM0KGNsYW1wKGZpbmFsRGlmZnVzZSpiYXNlQW1iaWVudENvbG9yK2ZpbmFsU3BlY3VsYXIrcmVmbGVjdGlvbkNvbG9yK2VtaXNzaXZlQ29sb3IrcmVmcmFjdGlvbkNvbG9yLDAuMCwxLjApLGFscGhhKTtcXG4jZWxzZVxcbnZlYzQgY29sb3I9dmVjNChmaW5hbERpZmZ1c2UqYmFzZUFtYmllbnRDb2xvcitmaW5hbFNwZWN1bGFyK3JlZmxlY3Rpb25Db2xvcityZWZyYWN0aW9uQ29sb3IsYWxwaGEpO1xcbiNlbmRpZlxcbiNpZmRlZiBMSUdIVE1BUFxcbnZlYzMgbGlnaHRtYXBDb2xvcj10ZXh0dXJlMkQobGlnaHRtYXBTYW1wbGVyLHZMaWdodG1hcFVWKS5yZ2IqdkxpZ2h0bWFwSW5mb3MueTtcXG4jaWZkZWYgVVNFTElHSFRNQVBBU1NIQURPV01BUFxcbmNvbG9yLnJnYio9bGlnaHRtYXBDb2xvcjtcXG4jZWxzZVxcbmNvbG9yLnJnYis9bGlnaHRtYXBDb2xvcjtcXG4jZW5kaWZcXG4jZW5kaWZcXG4jaW5jbHVkZTxsb2dEZXB0aEZyYWdtZW50PlxcbiNpbmNsdWRlPGZvZ0ZyYWdtZW50PlxcbmdsX0ZyYWdDb2xvcj1jb2xvcjtcXG59XCIsXG5kZWZhdWx0VmVydGV4U2hhZGVyOlwiXFxuYXR0cmlidXRlIHZlYzMgcG9zaXRpb247XFxuI2lmZGVmIE5PUk1BTFxcbmF0dHJpYnV0ZSB2ZWMzIG5vcm1hbDtcXG4jZW5kaWZcXG4jaWZkZWYgVVYxXFxuYXR0cmlidXRlIHZlYzIgdXY7XFxuI2VuZGlmXFxuI2lmZGVmIFVWMlxcbmF0dHJpYnV0ZSB2ZWMyIHV2MjtcXG4jZW5kaWZcXG4jaWZkZWYgVkVSVEVYQ09MT1JcXG5hdHRyaWJ1dGUgdmVjNCBjb2xvcjtcXG4jZW5kaWZcXG4jaW5jbHVkZTxib25lc0RlY2xhcmF0aW9uPlxcblxcbiNpbmNsdWRlPGluc3RhbmNlc0RlY2xhcmF0aW9uPlxcbnVuaWZvcm0gbWF0NCB2aWV3O1xcbnVuaWZvcm0gbWF0NCB2aWV3UHJvamVjdGlvbjtcXG4jaWZkZWYgRElGRlVTRVxcbnZhcnlpbmcgdmVjMiB2RGlmZnVzZVVWO1xcbnVuaWZvcm0gbWF0NCBkaWZmdXNlTWF0cml4O1xcbnVuaWZvcm0gdmVjMiB2RGlmZnVzZUluZm9zO1xcbiNlbmRpZlxcbiNpZmRlZiBBTUJJRU5UXFxudmFyeWluZyB2ZWMyIHZBbWJpZW50VVY7XFxudW5pZm9ybSBtYXQ0IGFtYmllbnRNYXRyaXg7XFxudW5pZm9ybSB2ZWMyIHZBbWJpZW50SW5mb3M7XFxuI2VuZGlmXFxuI2lmZGVmIE9QQUNJVFlcXG52YXJ5aW5nIHZlYzIgdk9wYWNpdHlVVjtcXG51bmlmb3JtIG1hdDQgb3BhY2l0eU1hdHJpeDtcXG51bmlmb3JtIHZlYzIgdk9wYWNpdHlJbmZvcztcXG4jZW5kaWZcXG4jaWZkZWYgRU1JU1NJVkVcXG52YXJ5aW5nIHZlYzIgdkVtaXNzaXZlVVY7XFxudW5pZm9ybSB2ZWMyIHZFbWlzc2l2ZUluZm9zO1xcbnVuaWZvcm0gbWF0NCBlbWlzc2l2ZU1hdHJpeDtcXG4jZW5kaWZcXG4jaWZkZWYgTElHSFRNQVBcXG52YXJ5aW5nIHZlYzIgdkxpZ2h0bWFwVVY7XFxudW5pZm9ybSB2ZWMyIHZMaWdodG1hcEluZm9zO1xcbnVuaWZvcm0gbWF0NCBsaWdodG1hcE1hdHJpeDtcXG4jZW5kaWZcXG4jaWYgZGVmaW5lZChTUEVDVUxBUikgJiYgZGVmaW5lZChTUEVDVUxBUlRFUk0pXFxudmFyeWluZyB2ZWMyIHZTcGVjdWxhclVWO1xcbnVuaWZvcm0gdmVjMiB2U3BlY3VsYXJJbmZvcztcXG51bmlmb3JtIG1hdDQgc3BlY3VsYXJNYXRyaXg7XFxuI2VuZGlmXFxuI2lmZGVmIEJVTVBcXG52YXJ5aW5nIHZlYzIgdkJ1bXBVVjtcXG51bmlmb3JtIHZlYzMgdkJ1bXBJbmZvcztcXG51bmlmb3JtIG1hdDQgYnVtcE1hdHJpeDtcXG4jZW5kaWZcXG4jaW5jbHVkZTxwb2ludENsb3VkVmVydGV4RGVjbGFyYXRpb24+XFxuXFxudmFyeWluZyB2ZWMzIHZQb3NpdGlvblc7XFxuI2lmZGVmIE5PUk1BTFxcbnZhcnlpbmcgdmVjMyB2Tm9ybWFsVztcXG4jZW5kaWZcXG4jaWZkZWYgVkVSVEVYQ09MT1JcXG52YXJ5aW5nIHZlYzQgdkNvbG9yO1xcbiNlbmRpZlxcbiNpbmNsdWRlPGNsaXBQbGFuZVZlcnRleERlY2xhcmF0aW9uPlxcbiNpbmNsdWRlPGZvZ1ZlcnRleERlY2xhcmF0aW9uPlxcbiNpbmNsdWRlPHNoYWRvd3NWZXJ0ZXhEZWNsYXJhdGlvbj5bMC4ubWF4U2ltdWx0YW5lb3VzTGlnaHRzXVxcbiNpZmRlZiBSRUZMRUNUSU9OTUFQX1NLWUJPWFxcbnZhcnlpbmcgdmVjMyB2UG9zaXRpb25VVlc7XFxuI2VuZGlmXFxuI2lmZGVmIFJFRkxFQ1RJT05NQVBfRVFVSVJFQ1RBTkdVTEFSX0ZJWEVEXFxudmFyeWluZyB2ZWMzIHZEaXJlY3Rpb25XO1xcbiNlbmRpZlxcbiNpbmNsdWRlPGxvZ0RlcHRoRGVjbGFyYXRpb24+XFxudm9pZCBtYWluKHZvaWQpIHtcXG4jaWZkZWYgUkVGTEVDVElPTk1BUF9TS1lCT1hcXG52UG9zaXRpb25VVlc9cG9zaXRpb247XFxuI2VuZGlmIFxcbiNpbmNsdWRlPGluc3RhbmNlc1ZlcnRleD5cXG4jaW5jbHVkZTxib25lc1ZlcnRleD5cXG5nbF9Qb3NpdGlvbj12aWV3UHJvamVjdGlvbipmaW5hbFdvcmxkKnZlYzQocG9zaXRpb24sMS4wKTtcXG52ZWM0IHdvcmxkUG9zPWZpbmFsV29ybGQqdmVjNChwb3NpdGlvbiwxLjApO1xcbnZQb3NpdGlvblc9dmVjMyh3b3JsZFBvcyk7XFxuI2lmZGVmIE5PUk1BTFxcbnZOb3JtYWxXPW5vcm1hbGl6ZSh2ZWMzKGZpbmFsV29ybGQqdmVjNChub3JtYWwsMC4wKSkpO1xcbiNlbmRpZlxcbiNpZmRlZiBSRUZMRUNUSU9OTUFQX0VRVUlSRUNUQU5HVUxBUl9GSVhFRFxcbnZEaXJlY3Rpb25XPW5vcm1hbGl6ZSh2ZWMzKGZpbmFsV29ybGQqdmVjNChwb3NpdGlvbiwwLjApKSk7XFxuI2VuZGlmXFxuXFxuI2lmbmRlZiBVVjFcXG52ZWMyIHV2PXZlYzIoMC4sMC4pO1xcbiNlbmRpZlxcbiNpZm5kZWYgVVYyXFxudmVjMiB1djI9dmVjMigwLiwwLik7XFxuI2VuZGlmXFxuI2lmZGVmIERJRkZVU0VcXG5pZiAodkRpZmZ1c2VJbmZvcy54ID09IDAuKVxcbntcXG52RGlmZnVzZVVWPXZlYzIoZGlmZnVzZU1hdHJpeCp2ZWM0KHV2LDEuMCwwLjApKTtcXG59XFxuZWxzZVxcbntcXG52RGlmZnVzZVVWPXZlYzIoZGlmZnVzZU1hdHJpeCp2ZWM0KHV2MiwxLjAsMC4wKSk7XFxufVxcbiNlbmRpZlxcbiNpZmRlZiBBTUJJRU5UXFxuaWYgKHZBbWJpZW50SW5mb3MueCA9PSAwLilcXG57XFxudkFtYmllbnRVVj12ZWMyKGFtYmllbnRNYXRyaXgqdmVjNCh1diwxLjAsMC4wKSk7XFxufVxcbmVsc2VcXG57XFxudkFtYmllbnRVVj12ZWMyKGFtYmllbnRNYXRyaXgqdmVjNCh1djIsMS4wLDAuMCkpO1xcbn1cXG4jZW5kaWZcXG4jaWZkZWYgT1BBQ0lUWVxcbmlmICh2T3BhY2l0eUluZm9zLnggPT0gMC4pXFxue1xcbnZPcGFjaXR5VVY9dmVjMihvcGFjaXR5TWF0cml4KnZlYzQodXYsMS4wLDAuMCkpO1xcbn1cXG5lbHNlXFxue1xcbnZPcGFjaXR5VVY9dmVjMihvcGFjaXR5TWF0cml4KnZlYzQodXYyLDEuMCwwLjApKTtcXG59XFxuI2VuZGlmXFxuI2lmZGVmIEVNSVNTSVZFXFxuaWYgKHZFbWlzc2l2ZUluZm9zLnggPT0gMC4pXFxue1xcbnZFbWlzc2l2ZVVWPXZlYzIoZW1pc3NpdmVNYXRyaXgqdmVjNCh1diwxLjAsMC4wKSk7XFxufVxcbmVsc2VcXG57XFxudkVtaXNzaXZlVVY9dmVjMihlbWlzc2l2ZU1hdHJpeCp2ZWM0KHV2MiwxLjAsMC4wKSk7XFxufVxcbiNlbmRpZlxcbiNpZmRlZiBMSUdIVE1BUFxcbmlmICh2TGlnaHRtYXBJbmZvcy54ID09IDAuKVxcbntcXG52TGlnaHRtYXBVVj12ZWMyKGxpZ2h0bWFwTWF0cml4KnZlYzQodXYsMS4wLDAuMCkpO1xcbn1cXG5lbHNlXFxue1xcbnZMaWdodG1hcFVWPXZlYzIobGlnaHRtYXBNYXRyaXgqdmVjNCh1djIsMS4wLDAuMCkpO1xcbn1cXG4jZW5kaWZcXG4jaWYgZGVmaW5lZChTUEVDVUxBUikgJiYgZGVmaW5lZChTUEVDVUxBUlRFUk0pXFxuaWYgKHZTcGVjdWxhckluZm9zLnggPT0gMC4pXFxue1xcbnZTcGVjdWxhclVWPXZlYzIoc3BlY3VsYXJNYXRyaXgqdmVjNCh1diwxLjAsMC4wKSk7XFxufVxcbmVsc2VcXG57XFxudlNwZWN1bGFyVVY9dmVjMihzcGVjdWxhck1hdHJpeCp2ZWM0KHV2MiwxLjAsMC4wKSk7XFxufVxcbiNlbmRpZlxcbiNpZmRlZiBCVU1QXFxuaWYgKHZCdW1wSW5mb3MueCA9PSAwLilcXG57XFxudkJ1bXBVVj12ZWMyKGJ1bXBNYXRyaXgqdmVjNCh1diwxLjAsMC4wKSk7XFxufVxcbmVsc2VcXG57XFxudkJ1bXBVVj12ZWMyKGJ1bXBNYXRyaXgqdmVjNCh1djIsMS4wLDAuMCkpO1xcbn1cXG4jZW5kaWZcXG4jaW5jbHVkZTxjbGlwUGxhbmVWZXJ0ZXg+XFxuI2luY2x1ZGU8Zm9nVmVydGV4PlxcbiNpbmNsdWRlPHNoYWRvd3NWZXJ0ZXg+WzAuLm1heFNpbXVsdGFuZW91c0xpZ2h0c11cXG5cXG4jaWZkZWYgVkVSVEVYQ09MT1JcXG52Q29sb3I9Y29sb3I7XFxuI2VuZGlmXFxuI2luY2x1ZGU8cG9pbnRDbG91ZFZlcnRleD5cXG4jaW5jbHVkZTxsb2dEZXB0aFZlcnRleD5cXG59XCIsZGVwdGhQaXhlbFNoYWRlcjpcIiNpZmRlZiBBTFBIQVRFU1RcXG52YXJ5aW5nIHZlYzIgdlVWO1xcbnVuaWZvcm0gc2FtcGxlcjJEIGRpZmZ1c2VTYW1wbGVyO1xcbiNlbmRpZlxcbnVuaWZvcm0gZmxvYXQgZmFyO1xcbnZvaWQgbWFpbih2b2lkKVxcbntcXG4jaWZkZWYgQUxQSEFURVNUXFxuaWYgKHRleHR1cmUyRChkaWZmdXNlU2FtcGxlcix2VVYpLmE8MC40KVxcbmRpc2NhcmQ7XFxuI2VuZGlmXFxuZmxvYXQgZGVwdGg9KGdsX0ZyYWdDb29yZC56L2dsX0ZyYWdDb29yZC53KS9mYXI7XFxuZ2xfRnJhZ0NvbG9yPXZlYzQoZGVwdGgsZGVwdGgqZGVwdGgsMC4wLDEuMCk7XFxufVwiLGRlcHRoVmVydGV4U2hhZGVyOlwiXFxuYXR0cmlidXRlIHZlYzMgcG9zaXRpb247XFxuI2luY2x1ZGU8Ym9uZXNEZWNsYXJhdGlvbj5cXG5cXG4jaW5jbHVkZTxpbnN0YW5jZXNEZWNsYXJhdGlvbj5cXG51bmlmb3JtIG1hdDQgdmlld1Byb2plY3Rpb247XFxuI2lmIGRlZmluZWQoQUxQSEFURVNUKSB8fCBkZWZpbmVkKE5FRURfVVYpXFxudmFyeWluZyB2ZWMyIHZVVjtcXG51bmlmb3JtIG1hdDQgZGlmZnVzZU1hdHJpeDtcXG4jaWZkZWYgVVYxXFxuYXR0cmlidXRlIHZlYzIgdXY7XFxuI2VuZGlmXFxuI2lmZGVmIFVWMlxcbmF0dHJpYnV0ZSB2ZWMyIHV2MjtcXG4jZW5kaWZcXG4jZW5kaWZcXG52b2lkIG1haW4odm9pZClcXG57XFxuI2luY2x1ZGU8aW5zdGFuY2VzVmVydGV4PlxcbiNpbmNsdWRlPGJvbmVzVmVydGV4PlxcbmdsX1Bvc2l0aW9uPXZpZXdQcm9qZWN0aW9uKmZpbmFsV29ybGQqdmVjNChwb3NpdGlvbiwxLjApO1xcbiNpZiBkZWZpbmVkKEFMUEhBVEVTVCkgfHwgZGVmaW5lZChCQVNJQ19SRU5ERVIpXFxuI2lmZGVmIFVWMVxcbnZVVj12ZWMyKGRpZmZ1c2VNYXRyaXgqdmVjNCh1diwxLjAsMC4wKSk7XFxuI2VuZGlmXFxuI2lmZGVmIFVWMlxcbnZVVj12ZWMyKGRpZmZ1c2VNYXRyaXgqdmVjNCh1djIsMS4wLDAuMCkpO1xcbiNlbmRpZlxcbiNlbmRpZlxcbn1cIixkZXB0aEJveEJsdXJQaXhlbFNoYWRlcjpcIlxcbnZhcnlpbmcgdmVjMiB2VVY7XFxudW5pZm9ybSBzYW1wbGVyMkQgdGV4dHVyZVNhbXBsZXI7XFxuXFxudW5pZm9ybSB2ZWMyIHNjcmVlblNpemU7XFxudm9pZCBtYWluKHZvaWQpXFxue1xcbnZlYzQgY29sb3JEZXB0aD12ZWM0KDAuMCk7XFxuZm9yIChpbnQgeD0tT0ZGU0VUOyB4PD1PRkZTRVQ7IHgrKylcXG5mb3IgKGludCB5PS1PRkZTRVQ7IHk8PU9GRlNFVDsgeSsrKVxcbmNvbG9yRGVwdGgrPXRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcix2VVYrdmVjMih4LHkpL3NjcmVlblNpemUpO1xcbmdsX0ZyYWdDb2xvcj0oY29sb3JEZXB0aC9mbG9hdCgoT0ZGU0VUKjIrMSkqKE9GRlNFVCoyKzEpKSk7XFxufVwiLGRlcHRoT2ZGaWVsZFBpeGVsU2hhZGVyOlwiXFxuXFxuXFxuXFxuXFxudW5pZm9ybSBzYW1wbGVyMkQgdGV4dHVyZVNhbXBsZXI7XFxudW5pZm9ybSBzYW1wbGVyMkQgaGlnaGxpZ2h0c1NhbXBsZXI7XFxudW5pZm9ybSBzYW1wbGVyMkQgZGVwdGhTYW1wbGVyO1xcbnVuaWZvcm0gc2FtcGxlcjJEIGdyYWluU2FtcGxlcjtcXG5cXG51bmlmb3JtIGZsb2F0IGdyYWluX2Ftb3VudDtcXG51bmlmb3JtIGJvb2wgYmx1cl9ub2lzZTtcXG51bmlmb3JtIGZsb2F0IHNjcmVlbl93aWR0aDtcXG51bmlmb3JtIGZsb2F0IHNjcmVlbl9oZWlnaHQ7XFxudW5pZm9ybSBmbG9hdCBkaXN0b3J0aW9uO1xcbnVuaWZvcm0gYm9vbCBkb2ZfZW5hYmxlZDtcXG5cXG51bmlmb3JtIGZsb2F0IHNjcmVlbl9kaXN0YW5jZTsgXFxudW5pZm9ybSBmbG9hdCBhcGVydHVyZTtcXG51bmlmb3JtIGZsb2F0IGRhcmtlbjtcXG51bmlmb3JtIGZsb2F0IGVkZ2VfYmx1cjtcXG51bmlmb3JtIGJvb2wgaGlnaGxpZ2h0cztcXG5cXG51bmlmb3JtIGZsb2F0IG5lYXI7XFxudW5pZm9ybSBmbG9hdCBmYXI7XFxuXFxudmFyeWluZyB2ZWMyIHZVVjtcXG5cXG4jZGVmaW5lIFBJIDMuMTQxNTkyNjVcXG4jZGVmaW5lIFRXT1BJIDYuMjgzMTg1MzBcXG4jZGVmaW5lIGludmVyc2VfZm9jYWxfbGVuZ3RoIDAuMSBcXG5cXG52ZWMyIGNlbnRlcmVkX3NjcmVlbl9wb3M7XFxudmVjMiBkaXN0b3J0ZWRfY29vcmRzO1xcbmZsb2F0IHJhZGl1czI7XFxuZmxvYXQgcmFkaXVzO1xcblxcbnZlYzIgcmFuZCh2ZWMyIGNvKVxcbntcXG5mbG9hdCBub2lzZTE9KGZyYWN0KHNpbihkb3QoY28sdmVjMigxMi45ODk4LDc4LjIzMykpKSo0Mzc1OC41NDUzKSk7XFxuZmxvYXQgbm9pc2UyPShmcmFjdChzaW4oZG90KGNvLHZlYzIoMTIuOTg5OCw3OC4yMzMpKjIuMCkpKjQzNzU4LjU0NTMpKTtcXG5yZXR1cm4gY2xhbXAodmVjMihub2lzZTEsbm9pc2UyKSwwLjAsMS4wKTtcXG59XFxuXFxudmVjMiBnZXREaXN0b3J0ZWRDb29yZHModmVjMiBjb29yZHMpIHtcXG5pZiAoZGlzdG9ydGlvbiA9PSAwLjApIHsgcmV0dXJuIGNvb3JkczsgfVxcbnZlYzIgZGlyZWN0aW9uPTEuMCpub3JtYWxpemUoY2VudGVyZWRfc2NyZWVuX3Bvcyk7XFxudmVjMiBkaXN0X2Nvb3Jkcz12ZWMyKDAuNSwwLjUpO1xcbmRpc3RfY29vcmRzLng9MC41K2RpcmVjdGlvbi54KnJhZGl1czIqMS4wO1xcbmRpc3RfY29vcmRzLnk9MC41K2RpcmVjdGlvbi55KnJhZGl1czIqMS4wO1xcbmZsb2F0IGRpc3RfYW1vdW50PWNsYW1wKGRpc3RvcnRpb24qMC4yMywwLjAsMS4wKTtcXG5kaXN0X2Nvb3Jkcz1taXgoY29vcmRzLGRpc3RfY29vcmRzLGRpc3RfYW1vdW50KTtcXG5yZXR1cm4gZGlzdF9jb29yZHM7XFxufVxcblxcbmZsb2F0IHNhbXBsZVNjcmVlbihpbm91dCB2ZWM0IGNvbG9yLGNvbnN0IGluIHZlYzIgb2Zmc2V0LGNvbnN0IGluIGZsb2F0IHdlaWdodCkge1xcblxcbnZlYzIgY29vcmRzPWRpc3RvcnRlZF9jb29yZHM7XFxuZmxvYXQgYW5nbGU9cmFuZChjb29yZHMqMTAwLjApLngqVFdPUEk7XFxuY29vcmRzKz12ZWMyKG9mZnNldC54KmNvcyhhbmdsZSktb2Zmc2V0Lnkqc2luKGFuZ2xlKSxvZmZzZXQueCpzaW4oYW5nbGUpK29mZnNldC55KmNvcyhhbmdsZSkpO1xcbmNvbG9yKz10ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsY29vcmRzKSp3ZWlnaHQ7XFxucmV0dXJuIHdlaWdodDtcXG59XFxuXFxuZmxvYXQgZ2V0Qmx1ckxldmVsKGZsb2F0IHNpemUpIHtcXG5yZXR1cm4gbWluKDMuMCxjZWlsKHNpemUvMS4wKSk7XFxufVxcblxcbnZlYzQgZ2V0Qmx1ckNvbG9yKGZsb2F0IHNpemUpIHtcXG52ZWM0IGNvbD10ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsZGlzdG9ydGVkX2Nvb3Jkcyk7XFxuaWYgKHNpemUgPT0gMC4wKSB7IHJldHVybiBjb2w7IH1cXG5cXG5cXG5mbG9hdCBibHVyX2xldmVsPWdldEJsdXJMZXZlbChzaXplKTtcXG5mbG9hdCB3PShzaXplL3NjcmVlbl93aWR0aCk7XFxuZmxvYXQgaD0oc2l6ZS9zY3JlZW5faGVpZ2h0KTtcXG5mbG9hdCB0b3RhbF93ZWlnaHQ9MS4wO1xcbnZlYzIgc2FtcGxlX2Nvb3JkcztcXG50b3RhbF93ZWlnaHQrPXNhbXBsZVNjcmVlbihjb2wsdmVjMigtMC41MCp3LDAuMjQqaCksMC45Myk7XFxudG90YWxfd2VpZ2h0Kz1zYW1wbGVTY3JlZW4oY29sLHZlYzIoMC4zMCp3LC0wLjc1KmgpLDAuOTApO1xcbnRvdGFsX3dlaWdodCs9c2FtcGxlU2NyZWVuKGNvbCx2ZWMyKDAuMzYqdywwLjk2KmgpLDAuODcpO1xcbnRvdGFsX3dlaWdodCs9c2FtcGxlU2NyZWVuKGNvbCx2ZWMyKC0xLjA4KncsLTAuNTUqaCksMC44NSk7XFxudG90YWxfd2VpZ2h0Kz1zYW1wbGVTY3JlZW4oY29sLHZlYzIoMS4zMyp3LC0wLjM3KmgpLDAuODMpO1xcbnRvdGFsX3dlaWdodCs9c2FtcGxlU2NyZWVuKGNvbCx2ZWMyKC0wLjgyKncsMS4zMSpoKSwwLjgwKTtcXG50b3RhbF93ZWlnaHQrPXNhbXBsZVNjcmVlbihjb2wsdmVjMigtMC4zMSp3LC0xLjY3KmgpLDAuNzgpO1xcbnRvdGFsX3dlaWdodCs9c2FtcGxlU2NyZWVuKGNvbCx2ZWMyKDEuNDcqdywxLjExKmgpLDAuNzYpO1xcbnRvdGFsX3dlaWdodCs9c2FtcGxlU2NyZWVuKGNvbCx2ZWMyKC0xLjk3KncsMC4xOSpoKSwwLjc0KTtcXG50b3RhbF93ZWlnaHQrPXNhbXBsZVNjcmVlbihjb2wsdmVjMigxLjQyKncsLTEuNTcqaCksMC43Mik7XFxuaWYgKGJsdXJfbGV2ZWw+MS4wKSB7XFxudG90YWxfd2VpZ2h0Kz1zYW1wbGVTY3JlZW4oY29sLHZlYzIoMC4wMSp3LDIuMjUqaCksMC43MCk7XFxudG90YWxfd2VpZ2h0Kz1zYW1wbGVTY3JlZW4oY29sLHZlYzIoLTEuNjIqdywtMS43NCpoKSwwLjY3KTtcXG50b3RhbF93ZWlnaHQrPXNhbXBsZVNjcmVlbihjb2wsdmVjMigyLjQ5KncsMC4yMCpoKSwwLjY1KTtcXG50b3RhbF93ZWlnaHQrPXNhbXBsZVNjcmVlbihjb2wsdmVjMigtMi4wNyp3LDEuNjEqaCksMC42Myk7XFxudG90YWxfd2VpZ2h0Kz1zYW1wbGVTY3JlZW4oY29sLHZlYzIoMC40Nip3LC0yLjcwKmgpLDAuNjEpO1xcbnRvdGFsX3dlaWdodCs9c2FtcGxlU2NyZWVuKGNvbCx2ZWMyKDEuNTUqdywyLjQwKmgpLDAuNTkpO1xcbnRvdGFsX3dlaWdodCs9c2FtcGxlU2NyZWVuKGNvbCx2ZWMyKC0yLjg4KncsLTAuNzUqaCksMC41Nik7XFxudG90YWxfd2VpZ2h0Kz1zYW1wbGVTY3JlZW4oY29sLHZlYzIoMi43Myp3LC0xLjQ0KmgpLDAuNTQpO1xcbnRvdGFsX3dlaWdodCs9c2FtcGxlU2NyZWVuKGNvbCx2ZWMyKC0xLjA4KncsMy4wMipoKSwwLjUyKTtcXG50b3RhbF93ZWlnaHQrPXNhbXBsZVNjcmVlbihjb2wsdmVjMigtMS4yOCp3LC0zLjA1KmgpLDAuNDkpO1xcbn1cXG5pZiAoYmx1cl9sZXZlbD4yLjApIHtcXG50b3RhbF93ZWlnaHQrPXNhbXBsZVNjcmVlbihjb2wsdmVjMigzLjExKncsMS40MypoKSwwLjQ2KTtcXG50b3RhbF93ZWlnaHQrPXNhbXBsZVNjcmVlbihjb2wsdmVjMigtMy4zNip3LDEuMDgqaCksMC40NCk7XFxudG90YWxfd2VpZ2h0Kz1zYW1wbGVTY3JlZW4oY29sLHZlYzIoMS44MCp3LC0zLjE2KmgpLDAuNDEpO1xcbnRvdGFsX3dlaWdodCs9c2FtcGxlU2NyZWVuKGNvbCx2ZWMyKDAuODMqdywzLjY1KmgpLDAuMzgpO1xcbnRvdGFsX3dlaWdodCs9c2FtcGxlU2NyZWVuKGNvbCx2ZWMyKC0zLjE2KncsLTIuMTkqaCksMC4zNCk7XFxudG90YWxfd2VpZ2h0Kz1zYW1wbGVTY3JlZW4oY29sLHZlYzIoMy45Mip3LC0wLjUzKmgpLDAuMzEpO1xcbnRvdGFsX3dlaWdodCs9c2FtcGxlU2NyZWVuKGNvbCx2ZWMyKC0yLjU5KncsMy4xMipoKSwwLjI2KTtcXG50b3RhbF93ZWlnaHQrPXNhbXBsZVNjcmVlbihjb2wsdmVjMigtMC4yMCp3LC00LjE1KmgpLDAuMjIpO1xcbnRvdGFsX3dlaWdodCs9c2FtcGxlU2NyZWVuKGNvbCx2ZWMyKDMuMDIqdywzLjAwKmgpLDAuMTUpO1xcbn1cXG5jb2wvPXRvdGFsX3dlaWdodDsgXFxuXFxuaWYgKGRhcmtlbj4wLjApIHtcXG5jb2wucmdiKj1jbGFtcCgwLjMsMS4wLDEuMDUtc2l6ZSowLjUqZGFya2VuKTtcXG59XFxuXFxuXFxuXFxuXFxucmV0dXJuIGNvbDtcXG59XFxudm9pZCBtYWluKHZvaWQpXFxue1xcblxcbmNlbnRlcmVkX3NjcmVlbl9wb3M9dmVjMih2VVYueC0wLjUsdlVWLnktMC41KTtcXG5yYWRpdXMyPWNlbnRlcmVkX3NjcmVlbl9wb3MueCpjZW50ZXJlZF9zY3JlZW5fcG9zLngrY2VudGVyZWRfc2NyZWVuX3Bvcy55KmNlbnRlcmVkX3NjcmVlbl9wb3MueTtcXG5yYWRpdXM9c3FydChyYWRpdXMyKTtcXG5kaXN0b3J0ZWRfY29vcmRzPWdldERpc3RvcnRlZENvb3Jkcyh2VVYpOyBcXG52ZWMyIHRleGVsc19jb29yZHM9dmVjMih2VVYueCpzY3JlZW5fd2lkdGgsdlVWLnkqc2NyZWVuX2hlaWdodCk7IFxcbmZsb2F0IGRlcHRoPXRleHR1cmUyRChkZXB0aFNhbXBsZXIsZGlzdG9ydGVkX2Nvb3JkcykucjsgXFxuZmxvYXQgZGlzdGFuY2U9bmVhcisoZmFyLW5lYXIpKmRlcHRoOyBcXG52ZWM0IGNvbG9yPXRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcix2VVYpOyBcXG5cXG5cXG5mbG9hdCBjb2M9YWJzKGFwZXJ0dXJlKihzY3JlZW5fZGlzdGFuY2UqKGludmVyc2VfZm9jYWxfbGVuZ3RoLTEuMC9kaXN0YW5jZSktMS4wKSk7XFxuXFxuaWYgKGRvZl9lbmFibGVkID09IGZhbHNlIHx8IGNvYzwwLjA3KSB7IGNvYz0wLjA7IH1cXG5cXG5mbG9hdCBlZGdlX2JsdXJfYW1vdW50PTAuMDtcXG5pZiAoZWRnZV9ibHVyPjAuMCkge1xcbmVkZ2VfYmx1cl9hbW91bnQ9Y2xhbXAoKHJhZGl1cyoyLjAtMS4wKzAuMTUqZWRnZV9ibHVyKSoxLjUsMC4wLDEuMCkqMS4zO1xcbn1cXG5cXG5mbG9hdCBibHVyX2Ftb3VudD1tYXgoZWRnZV9ibHVyX2Ftb3VudCxjb2MpO1xcblxcbmlmIChibHVyX2Ftb3VudCA9PSAwLjApIHtcXG5nbF9GcmFnQ29sb3I9dGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLGRpc3RvcnRlZF9jb29yZHMpO1xcbn1cXG5lbHNlIHtcXG5cXG5nbF9GcmFnQ29sb3I9Z2V0Qmx1ckNvbG9yKGJsdXJfYW1vdW50KjEuNyk7XFxuXFxuaWYgKGhpZ2hsaWdodHMpIHtcXG5nbF9GcmFnQ29sb3IucmdiKz1jbGFtcChjb2MsMC4wLDEuMCkqdGV4dHVyZTJEKGhpZ2hsaWdodHNTYW1wbGVyLGRpc3RvcnRlZF9jb29yZHMpLnJnYjtcXG59XFxuaWYgKGJsdXJfbm9pc2UpIHtcXG5cXG52ZWMyIG5vaXNlPXJhbmQoZGlzdG9ydGVkX2Nvb3JkcykqMC4wMSpibHVyX2Ftb3VudDtcXG52ZWMyIGJsdXJyZWRfY29vcmQ9dmVjMihkaXN0b3J0ZWRfY29vcmRzLngrbm9pc2UueCxkaXN0b3J0ZWRfY29vcmRzLnkrbm9pc2UueSk7XFxuZ2xfRnJhZ0NvbG9yPTAuMDQqdGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLGJsdXJyZWRfY29vcmQpKzAuOTYqZ2xfRnJhZ0NvbG9yO1xcbn1cXG59XFxuXFxuaWYgKGdyYWluX2Ftb3VudD4wLjApIHtcXG52ZWM0IGdyYWluX2NvbG9yPXRleHR1cmUyRChncmFpblNhbXBsZXIsdGV4ZWxzX2Nvb3JkcyowLjAwMyk7XFxuZ2xfRnJhZ0NvbG9yLnJnYis9KC0wLjUrZ3JhaW5fY29sb3IucmdiKSowLjMwKmdyYWluX2Ftb3VudDtcXG59XFxufVxcblwiLGRpc3BsYXlQYXNzUGl4ZWxTaGFkZXI6XCJcXG52YXJ5aW5nIHZlYzIgdlVWO1xcbnVuaWZvcm0gc2FtcGxlcjJEIHRleHR1cmVTYW1wbGVyO1xcbnVuaWZvcm0gc2FtcGxlcjJEIHBhc3NTYW1wbGVyO1xcbnZvaWQgbWFpbih2b2lkKVxcbntcXG5nbF9GcmFnQ29sb3I9dGV4dHVyZTJEKHBhc3NTYW1wbGVyLHZVVik7XFxufVwiLGVsbGlwc2UyZFBpeGVsU2hhZGVyOlwidmFyeWluZyB2ZWM0IHZDb2xvcjtcXG52b2lkIG1haW4odm9pZCkge1xcbmdsX0ZyYWdDb2xvcj12Q29sb3I7XFxufVwiLGVsbGlwc2UyZFZlcnRleFNoYWRlcjpcIlxcbiNpZmRlZiBJbnN0YW5jZWRcXG4jZGVmaW5lIGF0dCBhdHRyaWJ1dGVcXG4jZWxzZVxcbiNkZWZpbmUgYXR0IHVuaWZvcm1cXG4jZW5kaWZcXG5hdHRyaWJ1dGUgZmxvYXQgaW5kZXg7XFxuYXR0IHZlYzIgekJpYXM7XFxuYXR0IHZlYzQgdHJhbnNmb3JtWDtcXG5hdHQgdmVjNCB0cmFuc2Zvcm1ZO1xcbiNpZmRlZiBCb3JkZXJcXG5hdHQgZmxvYXQgYm9yZGVyVGhpY2tuZXNzO1xcbiNlbmRpZlxcbiNpZmRlZiBGaWxsU29saWRcXG5hdHQgdmVjNCBmaWxsU29saWRDb2xvcjtcXG4jZW5kaWZcXG4jaWZkZWYgQm9yZGVyU29saWRcXG5hdHQgdmVjNCBib3JkZXJTb2xpZENvbG9yO1xcbiNlbmRpZlxcbiNpZmRlZiBGaWxsR3JhZGllbnRcXG5hdHQgdmVjNCBmaWxsR3JhZGllbnRDb2xvcjE7XFxuYXR0IHZlYzQgZmlsbEdyYWRpZW50Q29sb3IyO1xcbmF0dCB2ZWM0IGZpbGxHcmFkaWVudFRZO1xcbiNlbmRpZlxcbiNpZmRlZiBCb3JkZXJHcmFkaWVudFxcbmF0dCB2ZWM0IGJvcmRlckdyYWRpZW50Q29sb3IxO1xcbmF0dCB2ZWM0IGJvcmRlckdyYWRpZW50Q29sb3IyO1xcbmF0dCB2ZWM0IGJvcmRlckdyYWRpZW50VFk7XFxuI2VuZGlmXFxuXFxuYXR0IHZlYzMgcHJvcGVydGllcztcXG4jZGVmaW5lIFRXT1BJIDYuMjgzMTg1MzBcXG5cXG52YXJ5aW5nIHZlYzIgdlVWO1xcbnZhcnlpbmcgdmVjNCB2Q29sb3I7XFxudm9pZCBtYWluKHZvaWQpIHtcXG52ZWMyIHBvczI7XFxuI2lmZGVmIEJvcmRlclxcbmZsb2F0IHc9cHJvcGVydGllcy54O1xcbmZsb2F0IGg9cHJvcGVydGllcy55O1xcbmZsb2F0IG1zPXByb3BlcnRpZXMuejtcXG52ZWMyIGJvcmRlck9mZnNldD12ZWMyKDEuMCwxLjApO1xcbmZsb2F0IHNlZ2k9aW5kZXg7XFxuaWYgKGluZGV4PG1zKSB7XFxuYm9yZGVyT2Zmc2V0PXZlYzIoMS4wLShib3JkZXJUaGlja25lc3MqMi4wL3cpLDEuMC0oYm9yZGVyVGhpY2tuZXNzKjIuMC9oKSk7XFxufVxcbmVsc2Uge1xcbnNlZ2ktPW1zO1xcbn1cXG5mbG9hdCBhbmdsZT1UV09QSSpzZWdpL21zO1xcbnBvczIueD0oY29zKGFuZ2xlKS8yLjApKzAuNTtcXG5wb3MyLnk9KHNpbihhbmdsZSkvMi4wKSswLjU7XFxucG9zMi54PSgocG9zMi54LTAuNSkqYm9yZGVyT2Zmc2V0LngpKzAuNTtcXG5wb3MyLnk9KChwb3MyLnktMC41KSpib3JkZXJPZmZzZXQueSkrMC41O1xcbiNlbHNlXFxuaWYgKGluZGV4ID09IDAuMCkge1xcbnBvczI9dmVjMigwLjUsMC41KTtcXG59XFxuZWxzZSB7XFxuZmxvYXQgbXM9cHJvcGVydGllcy56O1xcbmZsb2F0IGFuZ2xlPVRXT1BJKihpbmRleC0xLjApL21zO1xcbnBvczIueD0oY29zKGFuZ2xlKS8yLjApKzAuNTtcXG5wb3MyLnk9KHNpbihhbmdsZSkvMi4wKSswLjU7XFxufVxcbiNlbmRpZlxcbiNpZmRlZiBGaWxsU29saWRcXG52Q29sb3I9ZmlsbFNvbGlkQ29sb3I7XFxuI2VuZGlmXFxuI2lmZGVmIEJvcmRlclNvbGlkXFxudkNvbG9yPWJvcmRlclNvbGlkQ29sb3I7XFxuI2VuZGlmXFxuI2lmZGVmIEZpbGxHcmFkaWVudFxcbmZsb2F0IHY9ZG90KHZlYzQocG9zMi54eSwxLDEpLGZpbGxHcmFkaWVudFRZKTtcXG52Q29sb3I9bWl4KGZpbGxHcmFkaWVudENvbG9yMixmaWxsR3JhZGllbnRDb2xvcjEsdik7IFxcbiNlbmRpZlxcbiNpZmRlZiBCb3JkZXJHcmFkaWVudFxcbmZsb2F0IHY9ZG90KHZlYzQocG9zMi54eSwxLDEpLGJvcmRlckdyYWRpZW50VFkpO1xcbnZDb2xvcj1taXgoYm9yZGVyR3JhZGllbnRDb2xvcjIsYm9yZGVyR3JhZGllbnRDb2xvcjEsdik7IFxcbiNlbmRpZlxcbnZlYzQgcG9zO1xcbnBvcy54eT1wb3MyLnh5KnByb3BlcnRpZXMueHk7XFxucG9zLno9MS4wO1xcbnBvcy53PTEuMDtcXG5nbF9Qb3NpdGlvbj12ZWM0KGRvdChwb3MsdHJhbnNmb3JtWCksZG90KHBvcyx0cmFuc2Zvcm1ZKSx6Qmlhcy54LDEpO1xcbn1cIixmaWx0ZXJQaXhlbFNoYWRlcjpcIlxcbnZhcnlpbmcgdmVjMiB2VVY7XFxudW5pZm9ybSBzYW1wbGVyMkQgdGV4dHVyZVNhbXBsZXI7XFxudW5pZm9ybSBtYXQ0IGtlcm5lbE1hdHJpeDtcXG52b2lkIG1haW4odm9pZClcXG57XFxudmVjMyBiYXNlQ29sb3I9dGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVikucmdiO1xcbnZlYzMgdXBkYXRlZENvbG9yPShrZXJuZWxNYXRyaXgqdmVjNChiYXNlQ29sb3IsMS4wKSkucmdiO1xcbmdsX0ZyYWdDb2xvcj12ZWM0KHVwZGF0ZWRDb2xvciwxLjApO1xcbn1cIixmeGFhUGl4ZWxTaGFkZXI6XCIjZGVmaW5lIEZYQUFfUkVEVUNFX01JTiAoMS4wLzEyOC4wKVxcbiNkZWZpbmUgRlhBQV9SRURVQ0VfTVVMICgxLjAvOC4wKVxcbiNkZWZpbmUgRlhBQV9TUEFOX01BWCA4LjBcXG52YXJ5aW5nIHZlYzIgdlVWO1xcbnVuaWZvcm0gc2FtcGxlcjJEIHRleHR1cmVTYW1wbGVyO1xcbnVuaWZvcm0gdmVjMiB0ZXhlbFNpemU7XFxudm9pZCBtYWluKCl7XFxudmVjMiBsb2NhbFRleGVsU2l6ZT10ZXhlbFNpemU7XFxudmVjNCByZ2JOVz10ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsKHZVVit2ZWMyKC0xLjAsLTEuMCkqbG9jYWxUZXhlbFNpemUpKTtcXG52ZWM0IHJnYk5FPXRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlciwodlVWK3ZlYzIoMS4wLC0xLjApKmxvY2FsVGV4ZWxTaXplKSk7XFxudmVjNCByZ2JTVz10ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsKHZVVit2ZWMyKC0xLjAsMS4wKSpsb2NhbFRleGVsU2l6ZSkpO1xcbnZlYzQgcmdiU0U9dGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLCh2VVYrdmVjMigxLjAsMS4wKSpsb2NhbFRleGVsU2l6ZSkpO1xcbnZlYzQgcmdiTT10ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWKTtcXG52ZWM0IGx1bWE9dmVjNCgwLjI5OSwwLjU4NywwLjExNCwxLjApO1xcbmZsb2F0IGx1bWFOVz1kb3QocmdiTlcsbHVtYSk7XFxuZmxvYXQgbHVtYU5FPWRvdChyZ2JORSxsdW1hKTtcXG5mbG9hdCBsdW1hU1c9ZG90KHJnYlNXLGx1bWEpO1xcbmZsb2F0IGx1bWFTRT1kb3QocmdiU0UsbHVtYSk7XFxuZmxvYXQgbHVtYU09ZG90KHJnYk0sbHVtYSk7XFxuZmxvYXQgbHVtYU1pbj1taW4obHVtYU0sbWluKG1pbihsdW1hTlcsbHVtYU5FKSxtaW4obHVtYVNXLGx1bWFTRSkpKTtcXG5mbG9hdCBsdW1hTWF4PW1heChsdW1hTSxtYXgobWF4KGx1bWFOVyxsdW1hTkUpLG1heChsdW1hU1csbHVtYVNFKSkpO1xcbnZlYzIgZGlyPXZlYzIoLSgobHVtYU5XK2x1bWFORSktKGx1bWFTVytsdW1hU0UpKSwoKGx1bWFOVytsdW1hU1cpLShsdW1hTkUrbHVtYVNFKSkpO1xcbmZsb2F0IGRpclJlZHVjZT1tYXgoXFxuKGx1bWFOVytsdW1hTkUrbHVtYVNXK2x1bWFTRSkqKDAuMjUqRlhBQV9SRURVQ0VfTVVMKSxcXG5GWEFBX1JFRFVDRV9NSU4pO1xcbmZsb2F0IHJjcERpck1pbj0xLjAvKG1pbihhYnMoZGlyLngpLGFicyhkaXIueSkpK2RpclJlZHVjZSk7XFxuZGlyPW1pbih2ZWMyKEZYQUFfU1BBTl9NQVgsRlhBQV9TUEFOX01BWCksXFxubWF4KHZlYzIoLUZYQUFfU1BBTl9NQVgsLUZYQUFfU1BBTl9NQVgpLFxcbmRpcipyY3BEaXJNaW4pKSpsb2NhbFRleGVsU2l6ZTtcXG52ZWM0IHJnYkE9MC41KihcXG50ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK2RpciooMS4wLzMuMC0wLjUpKSArXFxudGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVitkaXIqKDIuMC8zLjAtMC41KSkpO1xcbnZlYzQgcmdiQj1yZ2JBKjAuNSswLjI1KihcXG50ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK2RpciotMC41KSArXFxudGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVitkaXIqMC41KSk7XFxuZmxvYXQgbHVtYUI9ZG90KHJnYkIsbHVtYSk7XFxuaWYgKChsdW1hQjxsdW1hTWluKSB8fCAobHVtYUI+bHVtYU1heCkpIHtcXG5nbF9GcmFnQ29sb3I9cmdiQTtcXG59XFxuZWxzZSB7XFxuZ2xfRnJhZ0NvbG9yPXJnYkI7XFxufVxcbn1cIixoZHJQaXhlbFNoYWRlcjpcInVuaWZvcm0gc2FtcGxlcjJEIHRleHR1cmVTYW1wbGVyO1xcbnZhcnlpbmcgdmVjMiB2VVY7XFxuI2lmIGRlZmluZWQoR0FVU1NJQU5fQkxVUl9IKSB8fCBkZWZpbmVkKEdBVVNTSUFOX0JMVVJfVilcXG51bmlmb3JtIGZsb2F0IGJsdXJPZmZzZXRzWzldO1xcbnVuaWZvcm0gZmxvYXQgYmx1cldlaWdodHNbOV07XFxudW5pZm9ybSBmbG9hdCBtdWx0aXBsaWVyO1xcbnZvaWQgbWFpbih2b2lkKSB7XFxudmVjNCBjb2xvcj12ZWM0KDAuMCwwLjAsMC4wLDAuMCk7XFxuZm9yIChpbnQgaT0wOyBpPDk7IGkrKykge1xcbiNpZmRlZiBHQVVTU0lBTl9CTFVSX0hcXG5jb2xvcis9KHRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcix2VVYrdmVjMihibHVyT2Zmc2V0c1tpXSptdWx0aXBsaWVyLDAuMCkpKmJsdXJXZWlnaHRzW2ldKTtcXG4jZWxzZVxcbmNvbG9yKz0odGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVit2ZWMyKDAuMCxibHVyT2Zmc2V0c1tpXSptdWx0aXBsaWVyKSkqYmx1cldlaWdodHNbaV0pO1xcbiNlbmRpZlxcbn1cXG5jb2xvci5hPTEuMDtcXG5nbF9GcmFnQ29sb3I9Y29sb3I7XFxufVxcbiNlbmRpZlxcbiNpZiBkZWZpbmVkKFRFWFRVUkVfQURERVIpXFxudW5pZm9ybSBzYW1wbGVyMkQgb3RoZXJTYW1wbGVyO1xcbnZvaWQgbWFpbigpIHtcXG52ZWM0IHN1bT10ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWKSt0ZXh0dXJlMkQob3RoZXJTYW1wbGVyLHZVVik7XFxuc3VtLmE9Y2xhbXAoc3VtLmEsMC4wLDEuMCk7XFxuZ2xfRnJhZ0NvbG9yPXN1bTtcXG59XFxuI2VuZGlmXFxuI2lmIGRlZmluZWQoTFVNSU5BTkNFX0dFTkVSQVRPUilcXG51bmlmb3JtIHZlYzIgbHVtT2Zmc2V0c1s0XTtcXG52b2lkIG1haW4oKSB7XFxuZmxvYXQgYXZlcmFnZT0wLjA7XFxudmVjNCBjb2xvcj12ZWM0KDAuMCwwLjAsMC4wLDAuMCk7XFxuZmxvYXQgbWF4aW11bT0tMWUyMDtcXG5mb3IgKGludCBpPTA7IGk8NDsgaSsrKSB7XFxuY29sb3I9dGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVitsdW1PZmZzZXRzW2ldKTtcXG5mbG9hdCBHcmV5VmFsdWU9bGVuZ3RoKGNvbG9yLnJnYik7XFxubWF4aW11bT1tYXgobWF4aW11bSxHcmV5VmFsdWUpO1xcbmF2ZXJhZ2UrPSgwLjI1KmxvZygxZS01K0dyZXlWYWx1ZSkpO1xcbn1cXG5hdmVyYWdlPWV4cChhdmVyYWdlKTtcXG5nbF9GcmFnQ29sb3I9dmVjNChhdmVyYWdlLG1heGltdW0sMC4wLDEuMCk7XFxufVxcbiNlbmRpZlxcbiNpZiBkZWZpbmVkKERPV05fU0FNUExFKVxcbnVuaWZvcm0gdmVjMiBkc09mZnNldHNbOV07XFxudW5pZm9ybSBmbG9hdCBoYWxmRGVzdFBpeGVsU2l6ZTtcXG4jaWZkZWYgRklOQUxfRE9XTl9TQU1QTEVcXG52ZWM0IHBhY2soZmxvYXQgdmFsdWUpIHtcXG5jb25zdCB2ZWM0IGJpdF9zaGlmdD12ZWM0KDI1NS4wKjI1NS4wKjI1NS4wLDI1NS4wKjI1NS4wLDI1NS4wLDEuMCk7XFxuY29uc3QgdmVjNCBiaXRfbWFzaz12ZWM0KDAuMCwxLjAvMjU1LjAsMS4wLzI1NS4wLDEuMC8yNTUuMCk7XFxudmVjNCByZXM9ZnJhY3QodmFsdWUqYml0X3NoaWZ0KTtcXG5yZXMtPXJlcy54eHl6KmJpdF9tYXNrO1xcbnJldHVybiByZXM7XFxufVxcbiNlbmRpZlxcbnZvaWQgbWFpbigpIHtcXG52ZWM0IGNvbG9yPXZlYzQoMC4wLDAuMCwwLjAsMC4wKTtcXG5mbG9hdCBhdmVyYWdlPTAuMDtcXG5mb3IgKGludCBpPTA7IGk8OTsgaSsrKSB7XFxuY29sb3I9dGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVit2ZWMyKGhhbGZEZXN0UGl4ZWxTaXplLGhhbGZEZXN0UGl4ZWxTaXplKStkc09mZnNldHNbaV0pO1xcbmF2ZXJhZ2UrPWNvbG9yLnI7XFxufVxcbmF2ZXJhZ2UvPTkuMDtcXG4jaWZuZGVmIEZJTkFMX0RPV05fU0FNUExFXFxuZ2xfRnJhZ0NvbG9yPXZlYzQoYXZlcmFnZSxhdmVyYWdlLDAuMCwxLjApO1xcbiNlbHNlXFxuZ2xfRnJhZ0NvbG9yPXBhY2soYXZlcmFnZSk7XFxuI2VuZGlmXFxufVxcbiNlbmRpZlxcbiNpZiBkZWZpbmVkKEJSSUdIVF9QQVNTKVxcbnVuaWZvcm0gdmVjMiBkc09mZnNldHNbNF07XFxudW5pZm9ybSBmbG9hdCBicmlnaHRUaHJlc2hvbGQ7XFxudm9pZCBtYWluKCkge1xcbnZlYzQgYXZlcmFnZT12ZWM0KDAuMCwwLjAsMC4wLDAuMCk7XFxuYXZlcmFnZT10ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK3ZlYzIoZHNPZmZzZXRzWzBdLngsZHNPZmZzZXRzWzBdLnkpKTtcXG5hdmVyYWdlKz10ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK3ZlYzIoZHNPZmZzZXRzWzFdLngsZHNPZmZzZXRzWzFdLnkpKTtcXG5hdmVyYWdlKz10ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK3ZlYzIoZHNPZmZzZXRzWzJdLngsZHNPZmZzZXRzWzJdLnkpKTtcXG5hdmVyYWdlKz10ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK3ZlYzIoZHNPZmZzZXRzWzNdLngsZHNPZmZzZXRzWzNdLnkpKTtcXG5hdmVyYWdlKj0wLjI1O1xcbmZsb2F0IGx1bWluYW5jZT1sZW5ndGgoYXZlcmFnZS5yZ2IpO1xcbmlmIChsdW1pbmFuY2U8YnJpZ2h0VGhyZXNob2xkKSB7XFxuYXZlcmFnZT12ZWM0KDAuMCwwLjAsMC4wLDEuMCk7XFxufVxcbmdsX0ZyYWdDb2xvcj1hdmVyYWdlO1xcbn1cXG4jZW5kaWZcXG4jaWYgZGVmaW5lZChET1dOX1NBTVBMRV9YNClcXG51bmlmb3JtIHZlYzIgZHNPZmZzZXRzWzE2XTtcXG52b2lkIG1haW4oKSB7XFxudmVjNCBhdmVyYWdlPXZlYzQoMC4wLDAuMCwwLjAsMC4wKTtcXG5hdmVyYWdlPXRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcix2VVYrZHNPZmZzZXRzWzBdKTtcXG5hdmVyYWdlKz10ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK2RzT2Zmc2V0c1sxXSk7XFxuYXZlcmFnZSs9dGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVitkc09mZnNldHNbMl0pO1xcbmF2ZXJhZ2UrPXRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcix2VVYrZHNPZmZzZXRzWzNdKTtcXG5hdmVyYWdlKz10ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK2RzT2Zmc2V0c1s0XSk7XFxuYXZlcmFnZSs9dGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVitkc09mZnNldHNbNV0pO1xcbmF2ZXJhZ2UrPXRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcix2VVYrZHNPZmZzZXRzWzZdKTtcXG5hdmVyYWdlKz10ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK2RzT2Zmc2V0c1s3XSk7XFxuYXZlcmFnZSs9dGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVitkc09mZnNldHNbOF0pO1xcbmF2ZXJhZ2UrPXRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcix2VVYrZHNPZmZzZXRzWzldKTtcXG5hdmVyYWdlKz10ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK2RzT2Zmc2V0c1sxMF0pO1xcbmF2ZXJhZ2UrPXRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcix2VVYrZHNPZmZzZXRzWzExXSk7XFxuYXZlcmFnZSs9dGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVitkc09mZnNldHNbMTJdKTtcXG5hdmVyYWdlKz10ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK2RzT2Zmc2V0c1sxM10pO1xcbmF2ZXJhZ2UrPXRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcix2VVYrZHNPZmZzZXRzWzE0XSk7XFxuYXZlcmFnZSs9dGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVitkc09mZnNldHNbMTVdKTtcXG5hdmVyYWdlLz0xNi4wO1xcbmdsX0ZyYWdDb2xvcj1hdmVyYWdlO1xcbn1cXG4jZW5kaWZcXG4jaWYgZGVmaW5lZChIRFIpXFxudW5pZm9ybSBzYW1wbGVyMkQgb3RoZXJTYW1wbGVyO1xcbnVuaWZvcm0gZmxvYXQgZXhwb3N1cmU7XFxudW5pZm9ybSBmbG9hdCBhdmdMdW1pbmFuY2U7XFxudm9pZCBtYWluKCkge1xcbnZlYzQgY29sb3I9dGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVikrdGV4dHVyZTJEKG90aGVyU2FtcGxlcix2VVYpO1xcbnZlYzQgYWRqdXN0ZWRDb2xvcj1jb2xvci9hdmdMdW1pbmFuY2UqZXhwb3N1cmU7XFxuY29sb3I9YWRqdXN0ZWRDb2xvcjtcXG5jb2xvci5hPTEuMDtcXG5nbF9GcmFnQ29sb3I9Y29sb3I7XFxufVxcbiNlbmRpZlxcblwiLGxheWVyUGl4ZWxTaGFkZXI6XCJcXG52YXJ5aW5nIHZlYzIgdlVWO1xcbnVuaWZvcm0gc2FtcGxlcjJEIHRleHR1cmVTYW1wbGVyO1xcblxcbnVuaWZvcm0gdmVjNCBjb2xvcjtcXG52b2lkIG1haW4odm9pZCkge1xcbnZlYzQgYmFzZUNvbG9yPXRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcix2VVYpO1xcbiNpZmRlZiBBTFBIQVRFU1RcXG5pZiAoYmFzZUNvbG9yLmE8MC40KVxcbmRpc2NhcmQ7XFxuI2VuZGlmXFxuZ2xfRnJhZ0NvbG9yPWJhc2VDb2xvcipjb2xvcjtcXG59XCIsbGF5ZXJWZXJ0ZXhTaGFkZXI6XCJcXG5hdHRyaWJ1dGUgdmVjMiBwb3NpdGlvbjtcXG5cXG51bmlmb3JtIHZlYzIgc2NhbGU7XFxudW5pZm9ybSB2ZWMyIG9mZnNldDtcXG51bmlmb3JtIG1hdDQgdGV4dHVyZU1hdHJpeDtcXG5cXG52YXJ5aW5nIHZlYzIgdlVWO1xcbmNvbnN0IHZlYzIgbWFkZD12ZWMyKDAuNSwwLjUpO1xcbnZvaWQgbWFpbih2b2lkKSB7IFxcbnZlYzIgc2hpZnRlZFBvc2l0aW9uPXBvc2l0aW9uKnNjYWxlK29mZnNldDtcXG52VVY9dmVjMih0ZXh0dXJlTWF0cml4KnZlYzQoc2hpZnRlZFBvc2l0aW9uKm1hZGQrbWFkZCwxLjAsMC4wKSk7XFxuZ2xfUG9zaXRpb249dmVjNChzaGlmdGVkUG9zaXRpb24sMC4wLDEuMCk7XFxufVwiLGxlZ2FjeWRlZmF1bHRQaXhlbFNoYWRlcjpcIiNkZWZpbmUgTUFQX1BST0pFQ1RJT04gNC5cXG5cXG51bmlmb3JtIHZlYzMgdkV5ZVBvc2l0aW9uO1xcbnVuaWZvcm0gdmVjMyB2QW1iaWVudENvbG9yO1xcbnVuaWZvcm0gdmVjNCB2RGlmZnVzZUNvbG9yO1xcbiNpZmRlZiBTUEVDVUxBUlRFUk1cXG51bmlmb3JtIHZlYzQgdlNwZWN1bGFyQ29sb3I7XFxuI2VuZGlmXFxudW5pZm9ybSB2ZWMzIHZFbWlzc2l2ZUNvbG9yO1xcblxcbnZhcnlpbmcgdmVjMyB2UG9zaXRpb25XO1xcbnZhcnlpbmcgdmVjMyB2Tm9ybWFsVztcXG4jaWZkZWYgVkVSVEVYQ09MT1JcXG52YXJ5aW5nIHZlYzQgdkNvbG9yO1xcbiNlbmRpZlxcblxcbiNpbmNsdWRlPGxpZ2h0RnJhZ21lbnREZWNsYXJhdGlvbj5bMC4uM11cXG4jaW5jbHVkZTxsaWdodHNGcmFnbWVudEZ1bmN0aW9ucz5cXG4jaW5jbHVkZTxzaGFkb3dzRnJhZ21lbnRGdW5jdGlvbnM+XFxuXFxuI2lmZGVmIERJRkZVU0VcXG52YXJ5aW5nIHZlYzIgdkRpZmZ1c2VVVjtcXG51bmlmb3JtIHNhbXBsZXIyRCBkaWZmdXNlU2FtcGxlcjtcXG51bmlmb3JtIHZlYzIgdkRpZmZ1c2VJbmZvcztcXG4jZW5kaWZcXG4jaWZkZWYgQU1CSUVOVFxcbnZhcnlpbmcgdmVjMiB2QW1iaWVudFVWO1xcbnVuaWZvcm0gc2FtcGxlcjJEIGFtYmllbnRTYW1wbGVyO1xcbnVuaWZvcm0gdmVjMiB2QW1iaWVudEluZm9zO1xcbiNlbmRpZlxcbiNpZmRlZiBPUEFDSVRZIFxcbnZhcnlpbmcgdmVjMiB2T3BhY2l0eVVWO1xcbnVuaWZvcm0gc2FtcGxlcjJEIG9wYWNpdHlTYW1wbGVyO1xcbnVuaWZvcm0gdmVjMiB2T3BhY2l0eUluZm9zO1xcbiNlbmRpZlxcbiNpZmRlZiBSRUZMRUNUSU9OXFxudmFyeWluZyB2ZWMzIHZSZWZsZWN0aW9uVVZXO1xcbiNpZmRlZiBSRUZMRUNUSU9OTUFQXzNEXFxudW5pZm9ybSBzYW1wbGVyQ3ViZSByZWZsZWN0aW9uQ3ViZVNhbXBsZXI7XFxuI2Vsc2VcXG51bmlmb3JtIHNhbXBsZXIyRCByZWZsZWN0aW9uMkRTYW1wbGVyO1xcbiNlbmRpZlxcbnVuaWZvcm0gdmVjMiB2UmVmbGVjdGlvbkluZm9zO1xcbiNlbmRpZlxcbiNpZmRlZiBFTUlTU0lWRVxcbnZhcnlpbmcgdmVjMiB2RW1pc3NpdmVVVjtcXG51bmlmb3JtIHZlYzIgdkVtaXNzaXZlSW5mb3M7XFxudW5pZm9ybSBzYW1wbGVyMkQgZW1pc3NpdmVTYW1wbGVyO1xcbiNlbmRpZlxcbiNpZiBkZWZpbmVkKFNQRUNVTEFSKSAmJiBkZWZpbmVkKFNQRUNVTEFSVEVSTSlcXG52YXJ5aW5nIHZlYzIgdlNwZWN1bGFyVVY7XFxudW5pZm9ybSB2ZWMyIHZTcGVjdWxhckluZm9zO1xcbnVuaWZvcm0gc2FtcGxlcjJEIHNwZWN1bGFyU2FtcGxlcjtcXG4jZW5kaWZcXG5cXG4jaW5jbHVkZTxmcmVzbmVsRnVuY3Rpb24+XFxuI2lmZGVmIERJRkZVU0VGUkVTTkVMXFxudW5pZm9ybSB2ZWM0IGRpZmZ1c2VMZWZ0Q29sb3I7XFxudW5pZm9ybSB2ZWM0IGRpZmZ1c2VSaWdodENvbG9yO1xcbiNlbmRpZlxcbiNpZmRlZiBPUEFDSVRZRlJFU05FTFxcbnVuaWZvcm0gdmVjNCBvcGFjaXR5UGFydHM7XFxuI2VuZGlmXFxuI2lmZGVmIFJFRkxFQ1RJT05GUkVTTkVMXFxudW5pZm9ybSB2ZWM0IHJlZmxlY3Rpb25MZWZ0Q29sb3I7XFxudW5pZm9ybSB2ZWM0IHJlZmxlY3Rpb25SaWdodENvbG9yO1xcbiNlbmRpZlxcbiNpZmRlZiBFTUlTU0lWRUZSRVNORUxcXG51bmlmb3JtIHZlYzQgZW1pc3NpdmVMZWZ0Q29sb3I7XFxudW5pZm9ybSB2ZWM0IGVtaXNzaXZlUmlnaHRDb2xvcjtcXG4jZW5kaWZcXG4jaW5jbHVkZTxjbGlwUGxhbmVGcmFnbWVudERlY2xhcmF0aW9uPlxcbiNpbmNsdWRlPGZvZ0ZyYWdtZW50RGVjbGFyYXRpb24+XFxudm9pZCBtYWluKHZvaWQpIHtcXG4jaW5jbHVkZTxjbGlwUGxhbmVGcmFnbWVudD5cXG52ZWMzIHZpZXdEaXJlY3Rpb25XPW5vcm1hbGl6ZSh2RXllUG9zaXRpb24tdlBvc2l0aW9uVyk7XFxuXFxudmVjNCBiYXNlQ29sb3I9dmVjNCgxLiwxLiwxLiwxLik7XFxudmVjMyBkaWZmdXNlQ29sb3I9dkRpZmZ1c2VDb2xvci5yZ2I7XFxuI2lmZGVmIERJRkZVU0VcXG5iYXNlQ29sb3I9dGV4dHVyZTJEKGRpZmZ1c2VTYW1wbGVyLHZEaWZmdXNlVVYpO1xcbiNpZmRlZiBBTFBIQVRFU1RcXG5pZiAoYmFzZUNvbG9yLmE8MC40KVxcbmRpc2NhcmQ7XFxuI2VuZGlmXFxuYmFzZUNvbG9yLnJnYio9dkRpZmZ1c2VJbmZvcy55O1xcbiNlbmRpZlxcbiNpZmRlZiBWRVJURVhDT0xPUlxcbmJhc2VDb2xvci5yZ2IqPXZDb2xvci5yZ2I7XFxuI2VuZGlmXFxuXFxudmVjMyBub3JtYWxXPW5vcm1hbGl6ZSh2Tm9ybWFsVyk7XFxuXFxudmVjMyBiYXNlQW1iaWVudENvbG9yPXZlYzMoMS4sMS4sMS4pO1xcbiNpZmRlZiBBTUJJRU5UXFxuYmFzZUFtYmllbnRDb2xvcj10ZXh0dXJlMkQoYW1iaWVudFNhbXBsZXIsdkFtYmllbnRVVikucmdiKnZBbWJpZW50SW5mb3MueTtcXG4jZW5kaWZcXG5cXG52ZWMzIGRpZmZ1c2VCYXNlPXZlYzMoMC4sMC4sMC4pO1xcbmxpZ2h0aW5nSW5mbyBpbmZvO1xcbmZsb2F0IGdsb3NzaW5lc3M9MC47XFxuI2lmZGVmIFNQRUNVTEFSVEVSTVxcbnZlYzMgc3BlY3VsYXJCYXNlPXZlYzMoMC4sMC4sMC4pO1xcbmdsb3NzaW5lc3M9dlNwZWN1bGFyQ29sb3IuYTtcXG4jZW5kaWZcXG5mbG9hdCBzaGFkb3c9MS47XFxuI2luY2x1ZGU8bGlnaHRGcmFnbWVudD5bMC4uM11cXG5cXG52ZWMzIHJlZmxlY3Rpb25Db2xvcj12ZWMzKDAuLDAuLDAuKTtcXG4jaWZkZWYgUkVGTEVDVElPTlxcbiNpZmRlZiBSRUZMRUNUSU9OTUFQXzNEXFxucmVmbGVjdGlvbkNvbG9yPXRleHR1cmVDdWJlKHJlZmxlY3Rpb25DdWJlU2FtcGxlcix2UmVmbGVjdGlvblVWVykucmdiKnZSZWZsZWN0aW9uSW5mb3MueDtcXG4jZWxzZVxcbnZlYzIgY29vcmRzPXZSZWZsZWN0aW9uVVZXLnh5O1xcbiNpZmRlZiBSRUZMRUNUSU9OTUFQX1BST0pFQ1RJT05cXG5jb29yZHMvPXZSZWZsZWN0aW9uVVZXLno7XFxuI2VuZGlmXFxuY29vcmRzLnk9MS4wLWNvb3Jkcy55O1xcbnJlZmxlY3Rpb25Db2xvcj10ZXh0dXJlMkQocmVmbGVjdGlvbjJEU2FtcGxlcixjb29yZHMpLnJnYip2UmVmbGVjdGlvbkluZm9zLng7XFxuI2VuZGlmXFxuI2lmZGVmIFJFRkxFQ1RJT05GUkVTTkVMXFxuZmxvYXQgcmVmbGVjdGlvbkZyZXNuZWxUZXJtPWNvbXB1dGVGcmVzbmVsVGVybSh2aWV3RGlyZWN0aW9uVyxub3JtYWxXLHJlZmxlY3Rpb25SaWdodENvbG9yLmEscmVmbGVjdGlvbkxlZnRDb2xvci5hKTtcXG5yZWZsZWN0aW9uQ29sb3IqPXJlZmxlY3Rpb25MZWZ0Q29sb3IucmdiKigxLjAtcmVmbGVjdGlvbkZyZXNuZWxUZXJtKStyZWZsZWN0aW9uRnJlc25lbFRlcm0qcmVmbGVjdGlvblJpZ2h0Q29sb3IucmdiO1xcbiNlbmRpZlxcbiNlbmRpZlxcblxcbmZsb2F0IGFscGhhPXZEaWZmdXNlQ29sb3IuYTtcXG4jaWZkZWYgT1BBQ0lUWVxcbnZlYzQgb3BhY2l0eU1hcD10ZXh0dXJlMkQob3BhY2l0eVNhbXBsZXIsdk9wYWNpdHlVVik7XFxuI2lmZGVmIE9QQUNJVFlSR0JcXG5vcGFjaXR5TWFwLnJnYj1vcGFjaXR5TWFwLnJnYip2ZWMzKDAuMywwLjU5LDAuMTEpO1xcbmFscGhhKj0ob3BhY2l0eU1hcC54K29wYWNpdHlNYXAueStvcGFjaXR5TWFwLnopKiB2T3BhY2l0eUluZm9zLnk7XFxuI2Vsc2VcXG5hbHBoYSo9b3BhY2l0eU1hcC5hKnZPcGFjaXR5SW5mb3MueTtcXG4jZW5kaWZcXG4jZW5kaWZcXG4jaWZkZWYgVkVSVEVYQUxQSEFcXG5hbHBoYSo9dkNvbG9yLmE7XFxuI2VuZGlmXFxuI2lmZGVmIE9QQUNJVFlGUkVTTkVMXFxuZmxvYXQgb3BhY2l0eUZyZXNuZWxUZXJtPWNvbXB1dGVGcmVzbmVsVGVybSh2aWV3RGlyZWN0aW9uVyxub3JtYWxXLG9wYWNpdHlQYXJ0cy56LG9wYWNpdHlQYXJ0cy53KTtcXG5hbHBoYSs9b3BhY2l0eVBhcnRzLngqKDEuMC1vcGFjaXR5RnJlc25lbFRlcm0pK29wYWNpdHlGcmVzbmVsVGVybSpvcGFjaXR5UGFydHMueTtcXG4jZW5kaWZcXG5cXG52ZWMzIGVtaXNzaXZlQ29sb3I9dkVtaXNzaXZlQ29sb3I7XFxuI2lmZGVmIEVNSVNTSVZFXFxuZW1pc3NpdmVDb2xvcis9dGV4dHVyZTJEKGVtaXNzaXZlU2FtcGxlcix2RW1pc3NpdmVVVikucmdiKnZFbWlzc2l2ZUluZm9zLnk7XFxuI2VuZGlmXFxuI2lmZGVmIEVNSVNTSVZFRlJFU05FTFxcbmZsb2F0IGVtaXNzaXZlRnJlc25lbFRlcm09Y29tcHV0ZUZyZXNuZWxUZXJtKHZpZXdEaXJlY3Rpb25XLG5vcm1hbFcsZW1pc3NpdmVSaWdodENvbG9yLmEsZW1pc3NpdmVMZWZ0Q29sb3IuYSk7XFxuZW1pc3NpdmVDb2xvcio9ZW1pc3NpdmVMZWZ0Q29sb3IucmdiKigxLjAtZW1pc3NpdmVGcmVzbmVsVGVybSkrZW1pc3NpdmVGcmVzbmVsVGVybSplbWlzc2l2ZVJpZ2h0Q29sb3IucmdiO1xcbiNlbmRpZlxcblxcbiNpZmRlZiBTUEVDVUxBUlRFUk1cXG52ZWMzIHNwZWN1bGFyQ29sb3I9dlNwZWN1bGFyQ29sb3IucmdiO1xcbiNpZmRlZiBTUEVDVUxBUlxcbnNwZWN1bGFyQ29sb3I9dGV4dHVyZTJEKHNwZWN1bGFyU2FtcGxlcix2U3BlY3VsYXJVVikucmdiKnZTcGVjdWxhckluZm9zLnk7XFxuI2VuZGlmXFxuI2VuZGlmXFxuXFxuI2lmZGVmIERJRkZVU0VGUkVTTkVMXFxuZmxvYXQgZGlmZnVzZUZyZXNuZWxUZXJtPWNvbXB1dGVGcmVzbmVsVGVybSh2aWV3RGlyZWN0aW9uVyxub3JtYWxXLGRpZmZ1c2VSaWdodENvbG9yLmEsZGlmZnVzZUxlZnRDb2xvci5hKTtcXG5kaWZmdXNlQmFzZSo9ZGlmZnVzZUxlZnRDb2xvci5yZ2IqKDEuMC1kaWZmdXNlRnJlc25lbFRlcm0pK2RpZmZ1c2VGcmVzbmVsVGVybSpkaWZmdXNlUmlnaHRDb2xvci5yZ2I7XFxuI2VuZGlmXFxuXFxudmVjMyBmaW5hbERpZmZ1c2U9Y2xhbXAoZGlmZnVzZUJhc2UqZGlmZnVzZUNvbG9yK2VtaXNzaXZlQ29sb3IrdkFtYmllbnRDb2xvciwwLjAsMS4wKSpiYXNlQ29sb3IucmdiO1xcbiNpZmRlZiBTUEVDVUxBUlRFUk1cXG52ZWMzIGZpbmFsU3BlY3VsYXI9c3BlY3VsYXJCYXNlKnNwZWN1bGFyQ29sb3I7XFxuI2Vsc2VcXG52ZWMzIGZpbmFsU3BlY3VsYXI9dmVjMygwLjApO1xcbiNlbmRpZlxcbnZlYzQgY29sb3I9dmVjNChmaW5hbERpZmZ1c2UqYmFzZUFtYmllbnRDb2xvcitmaW5hbFNwZWN1bGFyK3JlZmxlY3Rpb25Db2xvcixhbHBoYSk7XFxuI2luY2x1ZGU8Zm9nRnJhZ21lbnQ+XFxuZ2xfRnJhZ0NvbG9yPWNvbG9yO1xcbn1cIixsZWdhY3lkZWZhdWx0VmVydGV4U2hhZGVyOlwiXFxuYXR0cmlidXRlIHZlYzMgcG9zaXRpb247XFxuYXR0cmlidXRlIHZlYzMgbm9ybWFsO1xcbiNpZmRlZiBVVjFcXG5hdHRyaWJ1dGUgdmVjMiB1djtcXG4jZW5kaWZcXG4jaWZkZWYgVVYyXFxuYXR0cmlidXRlIHZlYzIgdXYyO1xcbiNlbmRpZlxcbiNpZmRlZiBWRVJURVhDT0xPUlxcbmF0dHJpYnV0ZSB2ZWM0IGNvbG9yO1xcbiNlbmRpZlxcbiNpbmNsdWRlPGJvbmVzRGVjbGFyYXRpb24+XFxuXFxudW5pZm9ybSBtYXQ0IHdvcmxkO1xcbnVuaWZvcm0gbWF0NCB2aWV3O1xcbnVuaWZvcm0gbWF0NCB2aWV3UHJvamVjdGlvbjtcXG4jaWZkZWYgRElGRlVTRVxcbnZhcnlpbmcgdmVjMiB2RGlmZnVzZVVWO1xcbnVuaWZvcm0gbWF0NCBkaWZmdXNlTWF0cml4O1xcbnVuaWZvcm0gdmVjMiB2RGlmZnVzZUluZm9zO1xcbiNlbmRpZlxcbiNpZmRlZiBBTUJJRU5UXFxudmFyeWluZyB2ZWMyIHZBbWJpZW50VVY7XFxudW5pZm9ybSBtYXQ0IGFtYmllbnRNYXRyaXg7XFxudW5pZm9ybSB2ZWMyIHZBbWJpZW50SW5mb3M7XFxuI2VuZGlmXFxuI2lmZGVmIE9QQUNJVFlcXG52YXJ5aW5nIHZlYzIgdk9wYWNpdHlVVjtcXG51bmlmb3JtIG1hdDQgb3BhY2l0eU1hdHJpeDtcXG51bmlmb3JtIHZlYzIgdk9wYWNpdHlJbmZvcztcXG4jZW5kaWZcXG4jaWZkZWYgRU1JU1NJVkVcXG52YXJ5aW5nIHZlYzIgdkVtaXNzaXZlVVY7XFxudW5pZm9ybSB2ZWMyIHZFbWlzc2l2ZUluZm9zO1xcbnVuaWZvcm0gbWF0NCBlbWlzc2l2ZU1hdHJpeDtcXG4jZW5kaWZcXG4jaWYgZGVmaW5lZChTUEVDVUxBUikgJiYgZGVmaW5lZChTUEVDVUxBUlRFUk0pXFxudmFyeWluZyB2ZWMyIHZTcGVjdWxhclVWO1xcbnVuaWZvcm0gdmVjMiB2U3BlY3VsYXJJbmZvcztcXG51bmlmb3JtIG1hdDQgc3BlY3VsYXJNYXRyaXg7XFxuI2VuZGlmXFxuI2lmZGVmIEJVTVBcXG52YXJ5aW5nIHZlYzIgdkJ1bXBVVjtcXG51bmlmb3JtIHZlYzIgdkJ1bXBJbmZvcztcXG51bmlmb3JtIG1hdDQgYnVtcE1hdHJpeDtcXG4jZW5kaWZcXG5cXG52YXJ5aW5nIHZlYzMgdlBvc2l0aW9uVztcXG52YXJ5aW5nIHZlYzMgdk5vcm1hbFc7XFxuI2lmZGVmIFZFUlRFWENPTE9SXFxudmFyeWluZyB2ZWM0IHZDb2xvcjtcXG4jZW5kaWZcXG4jaW5jbHVkZTxjbGlwUGxhbmVWZXJ0ZXhEZWNsYXJhdGlvbj5cXG4jaW5jbHVkZTxmb2dWZXJ0ZXhEZWNsYXJhdGlvbj5cXG4jaW5jbHVkZTxzaGFkb3dzVmVydGV4RGVjbGFyYXRpb24+WzAuLm1heFNpbXVsdGFuZW91c0xpZ2h0c11cXG4jaWZkZWYgUkVGTEVDVElPTlxcbnVuaWZvcm0gdmVjMyB2RXllUG9zaXRpb247XFxudmFyeWluZyB2ZWMzIHZSZWZsZWN0aW9uVVZXO1xcbnVuaWZvcm0gbWF0NCByZWZsZWN0aW9uTWF0cml4O1xcbnZlYzMgY29tcHV0ZVJlZmxlY3Rpb25Db29yZHModmVjNCB3b3JsZFBvcyx2ZWMzIHdvcmxkTm9ybWFsKVxcbntcXG4jaWZkZWYgUkVGTEVDVElPTk1BUF9TUEhFUklDQUxcXG52ZWMzIGNvb3Jkcz12ZWMzKHZpZXcqdmVjNCh3b3JsZE5vcm1hbCwwLjApKTtcXG5yZXR1cm4gdmVjMyhyZWZsZWN0aW9uTWF0cml4KnZlYzQoY29vcmRzLDEuMCkpO1xcbiNlbmRpZlxcbiNpZmRlZiBSRUZMRUNUSU9OTUFQX1BMQU5BUlxcbnZlYzMgdmlld0Rpcj13b3JsZFBvcy54eXotdkV5ZVBvc2l0aW9uO1xcbnZlYzMgY29vcmRzPW5vcm1hbGl6ZShyZWZsZWN0KHZpZXdEaXIsd29ybGROb3JtYWwpKTtcXG5yZXR1cm4gdmVjMyhyZWZsZWN0aW9uTWF0cml4KnZlYzQoY29vcmRzLDEpKTtcXG4jZW5kaWZcXG4jaWZkZWYgUkVGTEVDVElPTk1BUF9DVUJJQ1xcbnZlYzMgdmlld0Rpcj13b3JsZFBvcy54eXotdkV5ZVBvc2l0aW9uO1xcbnZlYzMgY29vcmRzPXJlZmxlY3Qodmlld0Rpcix3b3JsZE5vcm1hbCk7XFxuI2lmZGVmIElOVkVSVENVQklDTUFQXFxuY29vcmRzLnk9MS4wLWNvb3Jkcy55O1xcbiNlbmRpZlxcbnJldHVybiB2ZWMzKHJlZmxlY3Rpb25NYXRyaXgqdmVjNChjb29yZHMsMCkpO1xcbiNlbmRpZlxcbiNpZmRlZiBSRUZMRUNUSU9OTUFQX1BST0pFQ1RJT05cXG5yZXR1cm4gdmVjMyhyZWZsZWN0aW9uTWF0cml4Kih2aWV3KndvcmxkUG9zKSk7XFxuI2VuZGlmXFxuI2lmZGVmIFJFRkxFQ1RJT05NQVBfU0tZQk9YXFxucmV0dXJuIHBvc2l0aW9uO1xcbiNlbmRpZlxcbiNpZmRlZiBSRUZMRUNUSU9OTUFQX0VYUExJQ0lUXFxucmV0dXJuIHZlYzMoMCwwLDApO1xcbiNlbmRpZlxcbn1cXG4jZW5kaWZcXG52b2lkIG1haW4odm9pZCkge1xcbm1hdDQgZmluYWxXb3JsZD13b3JsZDtcXG4jaW5jbHVkZTxib25lc1ZlcnRleD5cXG5nbF9Qb3NpdGlvbj12aWV3UHJvamVjdGlvbipmaW5hbFdvcmxkKnZlYzQocG9zaXRpb24sMS4wKTtcXG52ZWM0IHdvcmxkUG9zPWZpbmFsV29ybGQqdmVjNChwb3NpdGlvbiwxLjApO1xcbnZQb3NpdGlvblc9dmVjMyh3b3JsZFBvcyk7XFxudk5vcm1hbFc9bm9ybWFsaXplKHZlYzMoZmluYWxXb3JsZCp2ZWM0KG5vcm1hbCwwLjApKSk7XFxuXFxuI2lmbmRlZiBVVjFcXG52ZWMyIHV2PXZlYzIoMC4sMC4pO1xcbiNlbmRpZlxcbiNpZm5kZWYgVVYyXFxudmVjMiB1djI9dmVjMigwLiwwLik7XFxuI2VuZGlmXFxuI2lmZGVmIERJRkZVU0VcXG5pZiAodkRpZmZ1c2VJbmZvcy54ID09IDAuKVxcbntcXG52RGlmZnVzZVVWPXZlYzIoZGlmZnVzZU1hdHJpeCp2ZWM0KHV2LDEuMCwwLjApKTtcXG59XFxuZWxzZVxcbntcXG52RGlmZnVzZVVWPXZlYzIoZGlmZnVzZU1hdHJpeCp2ZWM0KHV2MiwxLjAsMC4wKSk7XFxufVxcbiNlbmRpZlxcbiNpZmRlZiBBTUJJRU5UXFxuaWYgKHZBbWJpZW50SW5mb3MueCA9PSAwLilcXG57XFxudkFtYmllbnRVVj12ZWMyKGFtYmllbnRNYXRyaXgqdmVjNCh1diwxLjAsMC4wKSk7XFxufVxcbmVsc2VcXG57XFxudkFtYmllbnRVVj12ZWMyKGFtYmllbnRNYXRyaXgqdmVjNCh1djIsMS4wLDAuMCkpO1xcbn1cXG4jZW5kaWZcXG4jaWZkZWYgT1BBQ0lUWVxcbmlmICh2T3BhY2l0eUluZm9zLnggPT0gMC4pXFxue1xcbnZPcGFjaXR5VVY9dmVjMihvcGFjaXR5TWF0cml4KnZlYzQodXYsMS4wLDAuMCkpO1xcbn1cXG5lbHNlXFxue1xcbnZPcGFjaXR5VVY9dmVjMihvcGFjaXR5TWF0cml4KnZlYzQodXYyLDEuMCwwLjApKTtcXG59XFxuI2VuZGlmXFxuI2lmZGVmIFJFRkxFQ1RJT05cXG52UmVmbGVjdGlvblVWVz1jb21wdXRlUmVmbGVjdGlvbkNvb3Jkcyh2ZWM0KHZQb3NpdGlvblcsMS4wKSx2Tm9ybWFsVyk7XFxuI2VuZGlmXFxuI2lmZGVmIEVNSVNTSVZFXFxuaWYgKHZFbWlzc2l2ZUluZm9zLnggPT0gMC4pXFxue1xcbnZFbWlzc2l2ZVVWPXZlYzIoZW1pc3NpdmVNYXRyaXgqdmVjNCh1diwxLjAsMC4wKSk7XFxufVxcbmVsc2VcXG57XFxudkVtaXNzaXZlVVY9dmVjMihlbWlzc2l2ZU1hdHJpeCp2ZWM0KHV2MiwxLjAsMC4wKSk7XFxufVxcbiNlbmRpZlxcbiNpZiBkZWZpbmVkKFNQRUNVTEFSKSAmJiBkZWZpbmVkKFNQRUNVTEFSVEVSTSlcXG5pZiAodlNwZWN1bGFySW5mb3MueCA9PSAwLilcXG57XFxudlNwZWN1bGFyVVY9dmVjMihzcGVjdWxhck1hdHJpeCp2ZWM0KHV2LDEuMCwwLjApKTtcXG59XFxuZWxzZVxcbntcXG52U3BlY3VsYXJVVj12ZWMyKHNwZWN1bGFyTWF0cml4KnZlYzQodXYyLDEuMCwwLjApKTtcXG59XFxuI2VuZGlmXFxuI2lmZGVmIEJVTVBcXG5pZiAodkJ1bXBJbmZvcy54ID09IDAuKVxcbntcXG52QnVtcFVWPXZlYzIoYnVtcE1hdHJpeCp2ZWM0KHV2LDEuMCwwLjApKTtcXG59XFxuZWxzZVxcbntcXG52QnVtcFVWPXZlYzIoYnVtcE1hdHJpeCp2ZWM0KHV2MiwxLjAsMC4wKSk7XFxufVxcbiNlbmRpZlxcbiNpbmNsdWRlPGNsaXBQbGFuZVZlcnRleD5cXG4jaW5jbHVkZTxmb2dWZXJ0ZXg+XFxuI2luY2x1ZGU8c2hhZG93c1ZlcnRleD5bMC4ubWF4U2ltdWx0YW5lb3VzTGlnaHRzXVxcblxcbiNpZmRlZiBWRVJURVhDT0xPUlxcbnZDb2xvcj1jb2xvcjtcXG4jZW5kaWZcXG59XCIsbGVnYWN5cGJyUGl4ZWxTaGFkZXI6XCJwcmVjaXNpb24gbWVkaXVtcCBmbG9hdDtcXG5cXG4jZGVmaW5lIFJFQ0lQUk9DQUxfUEkyIDAuMTU5MTU0OTRcXG4jZGVmaW5lIEZSRVNORUxfTUFYSU1VTV9PTl9ST1VHSCAwLjI1XFxudW5pZm9ybSB2ZWMzIHZFeWVQb3NpdGlvbjtcXG51bmlmb3JtIHZlYzMgdkFtYmllbnRDb2xvcjtcXG51bmlmb3JtIHZlYzQgdkFsYmVkb0NvbG9yO1xcbnVuaWZvcm0gdmVjMyB2UmVmbGVjdGlvbkNvbG9yO1xcblxcbnVuaWZvcm0gdmVjNCB2TGlnaHRpbmdJbnRlbnNpdHk7XFxudW5pZm9ybSB2ZWM0IHZDYW1lcmFJbmZvcztcXG4jaWZkZWYgT1ZFUkxPQURFRFZBTFVFU1xcbnVuaWZvcm0gdmVjNCB2T3ZlcmxvYWRlZEludGVuc2l0eTtcXG51bmlmb3JtIHZlYzMgdk92ZXJsb2FkZWRBbWJpZW50O1xcbnVuaWZvcm0gdmVjMyB2T3ZlcmxvYWRlZEFsYmVkbztcXG51bmlmb3JtIHZlYzMgdk92ZXJsb2FkZWRSZWZsZWN0aXZpdHk7XFxudW5pZm9ybSB2ZWMzIHZPdmVybG9hZGVkRW1pc3NpdmU7XFxudW5pZm9ybSB2ZWMzIHZPdmVybG9hZGVkUmVmbGVjdGlvbjtcXG51bmlmb3JtIHZlYzMgdk92ZXJsb2FkZWRNaWNyb1N1cmZhY2U7XFxuI2VuZGlmXFxuI2lmZGVmIE9WRVJMT0FERURTSEFET1dWQUxVRVNcXG51bmlmb3JtIHZlYzQgdk92ZXJsb2FkZWRTaGFkb3dJbnRlbnNpdHk7XFxuI2VuZGlmXFxudW5pZm9ybSB2ZWM0IHZSZWZsZWN0aXZpdHlDb2xvcjtcXG51bmlmb3JtIHZlYzMgdkVtaXNzaXZlQ29sb3I7XFxuXFxudmFyeWluZyB2ZWMzIHZQb3NpdGlvblc7XFxuI2lmZGVmIE5PUk1BTFxcbnZhcnlpbmcgdmVjMyB2Tm9ybWFsVztcXG4jZW5kaWZcXG4jaWZkZWYgVkVSVEVYQ09MT1JcXG52YXJ5aW5nIHZlYzQgdkNvbG9yO1xcbiNlbmRpZlxcblxcbiNpbmNsdWRlPGxpZ2h0RnJhZ21lbnREZWNsYXJhdGlvbj5bMC4ubWF4U2ltdWx0YW5lb3VzTGlnaHRzXVxcblxcbiNpZmRlZiBBTEJFRE9cXG52YXJ5aW5nIHZlYzIgdkFsYmVkb1VWO1xcbnVuaWZvcm0gc2FtcGxlcjJEIGFsYmVkb1NhbXBsZXI7XFxudW5pZm9ybSB2ZWMyIHZBbGJlZG9JbmZvcztcXG4jZW5kaWZcXG4jaWZkZWYgQU1CSUVOVFxcbnZhcnlpbmcgdmVjMiB2QW1iaWVudFVWO1xcbnVuaWZvcm0gc2FtcGxlcjJEIGFtYmllbnRTYW1wbGVyO1xcbnVuaWZvcm0gdmVjMiB2QW1iaWVudEluZm9zO1xcbiNlbmRpZlxcbiNpZmRlZiBPUEFDSVRZIFxcbnZhcnlpbmcgdmVjMiB2T3BhY2l0eVVWO1xcbnVuaWZvcm0gc2FtcGxlcjJEIG9wYWNpdHlTYW1wbGVyO1xcbnVuaWZvcm0gdmVjMiB2T3BhY2l0eUluZm9zO1xcbiNlbmRpZlxcbiNpZmRlZiBFTUlTU0lWRVxcbnZhcnlpbmcgdmVjMiB2RW1pc3NpdmVVVjtcXG51bmlmb3JtIHZlYzIgdkVtaXNzaXZlSW5mb3M7XFxudW5pZm9ybSBzYW1wbGVyMkQgZW1pc3NpdmVTYW1wbGVyO1xcbiNlbmRpZlxcbiNpZmRlZiBMSUdIVE1BUFxcbnZhcnlpbmcgdmVjMiB2TGlnaHRtYXBVVjtcXG51bmlmb3JtIHZlYzIgdkxpZ2h0bWFwSW5mb3M7XFxudW5pZm9ybSBzYW1wbGVyMkQgbGlnaHRtYXBTYW1wbGVyO1xcbiNlbmRpZlxcbiNpZiBkZWZpbmVkKFJFRkxFQ1RJVklUWSlcXG52YXJ5aW5nIHZlYzIgdlJlZmxlY3Rpdml0eVVWO1xcbnVuaWZvcm0gdmVjMiB2UmVmbGVjdGl2aXR5SW5mb3M7XFxudW5pZm9ybSBzYW1wbGVyMkQgcmVmbGVjdGl2aXR5U2FtcGxlcjtcXG4jZW5kaWZcXG4jaW5jbHVkZTxjbGlwUGxhbmVGcmFnbWVudERlY2xhcmF0aW9uPlxcbiNpZmRlZiBDQU1FUkFDT0xPUkdSQURJTkdcXG51bmlmb3JtIHNhbXBsZXIyRCBjYW1lcmFDb2xvckdyYWRpbmcyRFNhbXBsZXI7XFxudW5pZm9ybSB2ZWM0IHZDYW1lcmFDb2xvckdyYWRpbmdJbmZvcztcXG51bmlmb3JtIHZlYzQgdkNhbWVyYUNvbG9yR3JhZGluZ1NjYWxlT2Zmc2V0O1xcbiNlbmRpZlxcblxcbiNpbmNsdWRlPHBickZ1bmN0aW9ucz5cXG4jaW5jbHVkZTxoYXJtb25pY3NGdW5jdGlvbnM+XFxuI2luY2x1ZGU8cGJyTGlnaHRGdW5jdGlvbnM+XFxudm9pZCBtYWluKHZvaWQpIHtcXG4jaW5jbHVkZTxjbGlwUGxhbmVGcmFnbWVudD5cXG52ZWMzIHZpZXdEaXJlY3Rpb25XPW5vcm1hbGl6ZSh2RXllUG9zaXRpb24tdlBvc2l0aW9uVyk7XFxuXFxudmVjNCBzdXJmYWNlQWxiZWRvPXZlYzQoMS4sMS4sMS4sMS4pO1xcbnZlYzMgc3VyZmFjZUFsYmVkb0NvbnRyaWJ1dGlvbj12QWxiZWRvQ29sb3IucmdiO1xcblxcbmZsb2F0IGFscGhhPXZBbGJlZG9Db2xvci5hO1xcbiNpZmRlZiBBTEJFRE9cXG5zdXJmYWNlQWxiZWRvPXRleHR1cmUyRChhbGJlZG9TYW1wbGVyLHZBbGJlZG9VVik7XFxuc3VyZmFjZUFsYmVkbz12ZWM0KHRvTGluZWFyU3BhY2Uoc3VyZmFjZUFsYmVkby5yZ2IpLHN1cmZhY2VBbGJlZG8uYSk7XFxuI2lmZGVmIEFMUEhBVEVTVFxcbmlmIChiYXNlQ29sb3IuYTwwLjQpXFxuZGlzY2FyZDtcXG4jZW5kaWZcXG4jaWZkZWYgQUxQSEFGUk9NQUxCRURPXFxuYWxwaGEqPXN1cmZhY2VBbGJlZG8uYTtcXG4jZW5kaWZcXG5zdXJmYWNlQWxiZWRvLnJnYio9dkFsYmVkb0luZm9zLnk7XFxuI2Vsc2VcXG5cXG5zdXJmYWNlQWxiZWRvLnJnYj1zdXJmYWNlQWxiZWRvQ29udHJpYnV0aW9uO1xcbnN1cmZhY2VBbGJlZG9Db250cmlidXRpb249dmVjMygxLiwxLiwxLik7XFxuI2VuZGlmXFxuI2lmZGVmIFZFUlRFWENPTE9SXFxuYmFzZUNvbG9yLnJnYio9dkNvbG9yLnJnYjtcXG4jZW5kaWZcXG4jaWZkZWYgT1ZFUkxPQURFRFZBTFVFU1xcbnN1cmZhY2VBbGJlZG8ucmdiPW1peChzdXJmYWNlQWxiZWRvLnJnYix2T3ZlcmxvYWRlZEFsYmVkbyx2T3ZlcmxvYWRlZEludGVuc2l0eS55KTtcXG4jZW5kaWZcXG5cXG4jaWZkZWYgTk9STUFMXFxudmVjMyBub3JtYWxXPW5vcm1hbGl6ZSh2Tm9ybWFsVyk7XFxuI2Vsc2VcXG52ZWMzIG5vcm1hbFc9dmVjMygxLjAsMS4wLDEuMCk7XFxuI2VuZGlmXFxuXFxudmVjMyBhbWJpZW50Q29sb3I9dmVjMygxLiwxLiwxLik7XFxuI2lmZGVmIEFNQklFTlRcXG5hbWJpZW50Q29sb3I9dGV4dHVyZTJEKGFtYmllbnRTYW1wbGVyLHZBbWJpZW50VVYpLnJnYip2QW1iaWVudEluZm9zLnk7XFxuI2lmZGVmIE9WRVJMT0FERURWQUxVRVNcXG5hbWJpZW50Q29sb3IucmdiPW1peChhbWJpZW50Q29sb3IucmdiLHZPdmVybG9hZGVkQW1iaWVudCx2T3ZlcmxvYWRlZEludGVuc2l0eS54KTtcXG4jZW5kaWZcXG4jZW5kaWZcXG5cXG5mbG9hdCBtaWNyb1N1cmZhY2U9dlJlZmxlY3Rpdml0eUNvbG9yLmE7XFxudmVjMyBzdXJmYWNlUmVmbGVjdGl2aXR5Q29sb3I9dlJlZmxlY3Rpdml0eUNvbG9yLnJnYjtcXG4jaWZkZWYgT1ZFUkxPQURFRFZBTFVFU1xcbnN1cmZhY2VSZWZsZWN0aXZpdHlDb2xvci5yZ2I9bWl4KHN1cmZhY2VSZWZsZWN0aXZpdHlDb2xvci5yZ2Isdk92ZXJsb2FkZWRSZWZsZWN0aXZpdHksdk92ZXJsb2FkZWRJbnRlbnNpdHkueik7XFxuI2VuZGlmXFxuI2lmZGVmIFJFRkxFQ1RJVklUWVxcbnZlYzQgc3VyZmFjZVJlZmxlY3Rpdml0eUNvbG9yTWFwPXRleHR1cmUyRChyZWZsZWN0aXZpdHlTYW1wbGVyLHZSZWZsZWN0aXZpdHlVVik7XFxuc3VyZmFjZVJlZmxlY3Rpdml0eUNvbG9yPXN1cmZhY2VSZWZsZWN0aXZpdHlDb2xvck1hcC5yZ2I7XFxuc3VyZmFjZVJlZmxlY3Rpdml0eUNvbG9yPXRvTGluZWFyU3BhY2Uoc3VyZmFjZVJlZmxlY3Rpdml0eUNvbG9yKTtcXG4jaWZkZWYgT1ZFUkxPQURFRFZBTFVFU1xcbnN1cmZhY2VSZWZsZWN0aXZpdHlDb2xvcj1taXgoc3VyZmFjZVJlZmxlY3Rpdml0eUNvbG9yLHZPdmVybG9hZGVkUmVmbGVjdGl2aXR5LHZPdmVybG9hZGVkSW50ZW5zaXR5LnopO1xcbiNlbmRpZlxcbiNpZmRlZiBNSUNST1NVUkZBQ0VGUk9NUkVGTEVDVElWSVRZTUFQXFxubWljcm9TdXJmYWNlPXN1cmZhY2VSZWZsZWN0aXZpdHlDb2xvck1hcC5hO1xcbiNlbHNlXFxuI2lmZGVmIE1JQ1JPU1VSRkFDRUFVVE9NQVRJQ1xcbm1pY3JvU3VyZmFjZT1jb21wdXRlRGVmYXVsdE1pY3JvU3VyZmFjZShtaWNyb1N1cmZhY2Usc3VyZmFjZVJlZmxlY3Rpdml0eUNvbG9yKTtcXG4jZW5kaWZcXG4jZW5kaWZcXG4jZW5kaWZcXG4jaWZkZWYgT1ZFUkxPQURFRFZBTFVFU1xcbm1pY3JvU3VyZmFjZT1taXgobWljcm9TdXJmYWNlLHZPdmVybG9hZGVkTWljcm9TdXJmYWNlLngsdk92ZXJsb2FkZWRNaWNyb1N1cmZhY2UueSk7XFxuI2VuZGlmXFxuXFxuZmxvYXQgTmRvdFY9bWF4KDAuMDAwMDAwMDAwMDEsZG90KG5vcm1hbFcsdmlld0RpcmVjdGlvblcpKTtcXG5cXG5taWNyb1N1cmZhY2U9Y2xhbXAobWljcm9TdXJmYWNlLDAuLDEuKSowLjk4O1xcblxcbmZsb2F0IHJvdWdobmVzcz1jbGFtcCgxLi1taWNyb1N1cmZhY2UsMC4wMDAwMDEsMS4wKTtcXG5cXG52ZWMzIGxpZ2h0RGlmZnVzZUNvbnRyaWJ1dGlvbj12ZWMzKDAuLDAuLDAuKTtcXG4jaWZkZWYgT1ZFUkxPQURFRFNIQURPV1ZBTFVFU1xcbnZlYzMgc2hhZG93ZWRPbmx5TGlnaHREaWZmdXNlQ29udHJpYnV0aW9uPXZlYzMoMS4sMS4sMS4pO1xcbiNlbmRpZlxcbiNpZmRlZiBTUEVDVUxBUlRFUk1cXG52ZWMzIGxpZ2h0U3BlY3VsYXJDb250cmlidXRpb249IHZlYzMoMC4sMC4sMC4pO1xcbiNlbmRpZlxcbmZsb2F0IG5vdFNoYWRvd0xldmVsPTEuOyBcXG5mbG9hdCBOZG90TD0tMS47XFxubGlnaHRpbmdJbmZvIGluZm87XFxuI2luY2x1ZGU8cGJyTGlnaHRGdW5jdGlvbnNDYWxsPlswLi5tYXhTaW11bHRhbmVvdXNMaWdodHNdXFxuI2lmZGVmIFNQRUNVTEFSVEVSTVxcbmxpZ2h0U3BlY3VsYXJDb250cmlidXRpb24qPXZMaWdodGluZ0ludGVuc2l0eS53O1xcbiNlbmRpZlxcbiNpZmRlZiBPUEFDSVRZXFxudmVjNCBvcGFjaXR5TWFwPXRleHR1cmUyRChvcGFjaXR5U2FtcGxlcix2T3BhY2l0eVVWKTtcXG4jaWZkZWYgT1BBQ0lUWVJHQlxcbm9wYWNpdHlNYXAucmdiPW9wYWNpdHlNYXAucmdiKnZlYzMoMC4zLDAuNTksMC4xMSk7XFxuYWxwaGEqPShvcGFjaXR5TWFwLngrb3BhY2l0eU1hcC55K29wYWNpdHlNYXAueikqIHZPcGFjaXR5SW5mb3MueTtcXG4jZWxzZVxcbmFscGhhKj1vcGFjaXR5TWFwLmEqdk9wYWNpdHlJbmZvcy55O1xcbiNlbmRpZlxcbiNlbmRpZlxcbiNpZmRlZiBWRVJURVhBTFBIQVxcbmFscGhhKj12Q29sb3IuYTtcXG4jZW5kaWZcXG5cXG52ZWMzIGVudmlyb25tZW50UmFkaWFuY2U9dlJlZmxlY3Rpb25Db2xvci5yZ2I7XFxudmVjMyBlbnZpcm9ubWVudElycmFkaWFuY2U9dlJlZmxlY3Rpb25Db2xvci5yZ2I7XFxuI2lmZGVmIE9WRVJMT0FERURWQUxVRVNcXG5lbnZpcm9ubWVudElycmFkaWFuY2U9bWl4KGVudmlyb25tZW50SXJyYWRpYW5jZSx2T3ZlcmxvYWRlZFJlZmxlY3Rpb24sdk92ZXJsb2FkZWRNaWNyb1N1cmZhY2Uueik7XFxuZW52aXJvbm1lbnRSYWRpYW5jZT1taXgoZW52aXJvbm1lbnRSYWRpYW5jZSx2T3ZlcmxvYWRlZFJlZmxlY3Rpb24sdk92ZXJsb2FkZWRNaWNyb1N1cmZhY2Uueik7XFxuI2VuZGlmXFxuZW52aXJvbm1lbnRSYWRpYW5jZSo9dkxpZ2h0aW5nSW50ZW5zaXR5Lno7XFxuZW52aXJvbm1lbnRJcnJhZGlhbmNlKj12TGlnaHRpbmdJbnRlbnNpdHkuejtcXG5cXG52ZWMzIHNwZWN1bGFyRW52aXJvbm1lbnRSMD1zdXJmYWNlUmVmbGVjdGl2aXR5Q29sb3IucmdiO1xcbnZlYzMgc3BlY3VsYXJFbnZpcm9ubWVudFI5MD12ZWMzKDEuMCwxLjAsMS4wKTtcXG52ZWMzIHNwZWN1bGFyRW52aXJvbm1lbnRSZWZsZWN0YW5jZT1GcmVzbmVsU2NobGlja0Vudmlyb25tZW50R0dYKGNsYW1wKE5kb3RWLDAuLDEuKSxzcGVjdWxhckVudmlyb25tZW50UjAsc3BlY3VsYXJFbnZpcm9ubWVudFI5MCxzcXJ0KG1pY3JvU3VyZmFjZSkpO1xcblxcbmZsb2F0IHJlZmxlY3RhbmNlPW1heChtYXgoc3VyZmFjZVJlZmxlY3Rpdml0eUNvbG9yLnIsc3VyZmFjZVJlZmxlY3Rpdml0eUNvbG9yLmcpLHN1cmZhY2VSZWZsZWN0aXZpdHlDb2xvci5iKTtcXG5zdXJmYWNlQWxiZWRvLnJnYj0oMS4tcmVmbGVjdGFuY2UpKnN1cmZhY2VBbGJlZG8ucmdiO1xcbmVudmlyb25tZW50UmFkaWFuY2UqPXNwZWN1bGFyRW52aXJvbm1lbnRSZWZsZWN0YW5jZTtcXG5cXG52ZWMzIHN1cmZhY2VFbWlzc2l2ZUNvbG9yPXZFbWlzc2l2ZUNvbG9yO1xcbiNpZmRlZiBFTUlTU0lWRVxcbnZlYzMgZW1pc3NpdmVDb2xvclRleD10ZXh0dXJlMkQoZW1pc3NpdmVTYW1wbGVyLHZFbWlzc2l2ZVVWKS5yZ2I7XFxuc3VyZmFjZUVtaXNzaXZlQ29sb3I9dG9MaW5lYXJTcGFjZShlbWlzc2l2ZUNvbG9yVGV4LnJnYikqc3VyZmFjZUVtaXNzaXZlQ29sb3IqdkVtaXNzaXZlSW5mb3MueTtcXG4jZW5kaWZcXG4jaWZkZWYgT1ZFUkxPQURFRFZBTFVFU1xcbnN1cmZhY2VFbWlzc2l2ZUNvbG9yPW1peChzdXJmYWNlRW1pc3NpdmVDb2xvcix2T3ZlcmxvYWRlZEVtaXNzaXZlLHZPdmVybG9hZGVkSW50ZW5zaXR5LncpO1xcbiNlbmRpZlxcblxcbiNpZmRlZiBFTUlTU0lWRUFTSUxMVU1JTkFUSU9OXFxudmVjMyBmaW5hbERpZmZ1c2U9bWF4KGxpZ2h0RGlmZnVzZUNvbnRyaWJ1dGlvbipzdXJmYWNlQWxiZWRvQ29udHJpYnV0aW9uK3ZBbWJpZW50Q29sb3IsMC4wKSpzdXJmYWNlQWxiZWRvLnJnYjtcXG4jaWZkZWYgT1ZFUkxPQURFRFNIQURPV1ZBTFVFU1xcbnNoYWRvd2VkT25seUxpZ2h0RGlmZnVzZUNvbnRyaWJ1dGlvbj1tYXgoc2hhZG93ZWRPbmx5TGlnaHREaWZmdXNlQ29udHJpYnV0aW9uKnN1cmZhY2VBbGJlZG9Db250cmlidXRpb24rdkFtYmllbnRDb2xvciwwLjApKnN1cmZhY2VBbGJlZG8ucmdiO1xcbiNlbmRpZlxcbiNlbHNlXFxuI2lmZGVmIExJTktFTUlTU0lWRVdJVEhBTEJFRE9cXG52ZWMzIGZpbmFsRGlmZnVzZT1tYXgoKGxpZ2h0RGlmZnVzZUNvbnRyaWJ1dGlvbitzdXJmYWNlRW1pc3NpdmVDb2xvcikqc3VyZmFjZUFsYmVkb0NvbnRyaWJ1dGlvbit2QW1iaWVudENvbG9yLDAuMCkqc3VyZmFjZUFsYmVkby5yZ2I7XFxuI2lmZGVmIE9WRVJMT0FERURTSEFET1dWQUxVRVNcXG5zaGFkb3dlZE9ubHlMaWdodERpZmZ1c2VDb250cmlidXRpb249bWF4KChzaGFkb3dlZE9ubHlMaWdodERpZmZ1c2VDb250cmlidXRpb24rc3VyZmFjZUVtaXNzaXZlQ29sb3IpKnN1cmZhY2VBbGJlZG9Db250cmlidXRpb24rdkFtYmllbnRDb2xvciwwLjApKnN1cmZhY2VBbGJlZG8ucmdiO1xcbiNlbmRpZlxcbiNlbHNlXFxudmVjMyBmaW5hbERpZmZ1c2U9bWF4KGxpZ2h0RGlmZnVzZUNvbnRyaWJ1dGlvbipzdXJmYWNlQWxiZWRvQ29udHJpYnV0aW9uK3N1cmZhY2VFbWlzc2l2ZUNvbG9yK3ZBbWJpZW50Q29sb3IsMC4wKSpzdXJmYWNlQWxiZWRvLnJnYjtcXG4jaWZkZWYgT1ZFUkxPQURFRFNIQURPV1ZBTFVFU1xcbnNoYWRvd2VkT25seUxpZ2h0RGlmZnVzZUNvbnRyaWJ1dGlvbj1tYXgoc2hhZG93ZWRPbmx5TGlnaHREaWZmdXNlQ29udHJpYnV0aW9uKnN1cmZhY2VBbGJlZG9Db250cmlidXRpb24rc3VyZmFjZUVtaXNzaXZlQ29sb3IrdkFtYmllbnRDb2xvciwwLjApKnN1cmZhY2VBbGJlZG8ucmdiO1xcbiNlbmRpZlxcbiNlbmRpZlxcbiNlbmRpZlxcbiNpZmRlZiBPVkVSTE9BREVEU0hBRE9XVkFMVUVTXFxuZmluYWxEaWZmdXNlPW1peChmaW5hbERpZmZ1c2Usc2hhZG93ZWRPbmx5TGlnaHREaWZmdXNlQ29udHJpYnV0aW9uLCgxLjAtdk92ZXJsb2FkZWRTaGFkb3dJbnRlbnNpdHkueSkpO1xcbiNlbmRpZlxcbiNpZmRlZiBTUEVDVUxBUlRFUk1cXG52ZWMzIGZpbmFsU3BlY3VsYXI9bGlnaHRTcGVjdWxhckNvbnRyaWJ1dGlvbipzdXJmYWNlUmVmbGVjdGl2aXR5Q29sb3I7XFxuI2Vsc2VcXG52ZWMzIGZpbmFsU3BlY3VsYXI9dmVjMygwLjApO1xcbiNlbmRpZlxcbiNpZmRlZiBTUEVDVUxBUk9WRVJBTFBIQVxcbmFscGhhPWNsYW1wKGFscGhhK2dldEx1bWluYW5jZShmaW5hbFNwZWN1bGFyKSwwLiwxLik7XFxuI2VuZGlmXFxuI2lmZGVmIFJBRElBTkNFT1ZFUkFMUEhBXFxuYWxwaGE9Y2xhbXAoYWxwaGErZ2V0THVtaW5hbmNlKGVudmlyb25tZW50UmFkaWFuY2UpLDAuLDEuKTtcXG4jZW5kaWZcXG5cXG5cXG4jaWZkZWYgRU1JU1NJVkVBU0lMTFVNSU5BVElPTlxcbnZlYzQgZmluYWxDb2xvcj12ZWM0KGZpbmFsRGlmZnVzZSphbWJpZW50Q29sb3IqdkxpZ2h0aW5nSW50ZW5zaXR5Lngrc3VyZmFjZUFsYmVkby5yZ2IqZW52aXJvbm1lbnRJcnJhZGlhbmNlK2ZpbmFsU3BlY3VsYXIqdkxpZ2h0aW5nSW50ZW5zaXR5LngrZW52aXJvbm1lbnRSYWRpYW5jZStzdXJmYWNlRW1pc3NpdmVDb2xvcip2TGlnaHRpbmdJbnRlbnNpdHkueSxhbHBoYSk7XFxuI2Vsc2VcXG52ZWM0IGZpbmFsQ29sb3I9dmVjNChmaW5hbERpZmZ1c2UqYW1iaWVudENvbG9yKnZMaWdodGluZ0ludGVuc2l0eS54K3N1cmZhY2VBbGJlZG8ucmdiKmVudmlyb25tZW50SXJyYWRpYW5jZStmaW5hbFNwZWN1bGFyKnZMaWdodGluZ0ludGVuc2l0eS54K2Vudmlyb25tZW50UmFkaWFuY2UsYWxwaGEpO1xcbiNlbmRpZlxcbmZpbmFsQ29sb3I9bWF4KGZpbmFsQ29sb3IsMC4wKTtcXG4jaWZkZWYgQ0FNRVJBVE9ORU1BUFxcbmZpbmFsQ29sb3IucmdiPXRvbmVNYXBzKGZpbmFsQ29sb3IucmdiKTtcXG4jZW5kaWZcXG5maW5hbENvbG9yLnJnYj10b0dhbW1hU3BhY2UoZmluYWxDb2xvci5yZ2IpO1xcbiNpZmRlZiBDQU1FUkFDT05UUkFTVFxcbmZpbmFsQ29sb3I9Y29udHJhc3RzKGZpbmFsQ29sb3IpO1xcbiNlbmRpZlxcbmZpbmFsQ29sb3IucmdiPWNsYW1wKGZpbmFsQ29sb3IucmdiLDAuLDEuKTtcXG4jaWZkZWYgQ0FNRVJBQ09MT1JHUkFESU5HXFxuZmluYWxDb2xvcj1jb2xvckdyYWRlcyhmaW5hbENvbG9yLGNhbWVyYUNvbG9yR3JhZGluZzJEU2FtcGxlcix2Q2FtZXJhQ29sb3JHcmFkaW5nSW5mb3MsdkNhbWVyYUNvbG9yR3JhZGluZ1NjYWxlT2Zmc2V0KTtcXG4jZW5kaWZcXG5nbF9GcmFnQ29sb3I9ZmluYWxDb2xvcjtcXG59XCIsXG5sZWdhY3lwYnJWZXJ0ZXhTaGFkZXI6XCJwcmVjaXNpb24gbWVkaXVtcCBmbG9hdDtcXG5cXG5hdHRyaWJ1dGUgdmVjMyBwb3NpdGlvbjtcXG5hdHRyaWJ1dGUgdmVjMyBub3JtYWw7XFxuI2lmZGVmIFVWMVxcbmF0dHJpYnV0ZSB2ZWMyIHV2O1xcbiNlbmRpZlxcbiNpZmRlZiBVVjJcXG5hdHRyaWJ1dGUgdmVjMiB1djI7XFxuI2VuZGlmXFxuI2lmZGVmIFZFUlRFWENPTE9SXFxuYXR0cmlidXRlIHZlYzQgY29sb3I7XFxuI2VuZGlmXFxuI2luY2x1ZGU8Ym9uZXNEZWNsYXJhdGlvbj5cXG5cXG51bmlmb3JtIG1hdDQgd29ybGQ7XFxudW5pZm9ybSBtYXQ0IHZpZXc7XFxudW5pZm9ybSBtYXQ0IHZpZXdQcm9qZWN0aW9uO1xcbiNpZmRlZiBBTEJFRE9cXG52YXJ5aW5nIHZlYzIgdkFsYmVkb1VWO1xcbnVuaWZvcm0gbWF0NCBhbGJlZG9NYXRyaXg7XFxudW5pZm9ybSB2ZWMyIHZBbGJlZG9JbmZvcztcXG4jZW5kaWZcXG4jaWZkZWYgQU1CSUVOVFxcbnZhcnlpbmcgdmVjMiB2QW1iaWVudFVWO1xcbnVuaWZvcm0gbWF0NCBhbWJpZW50TWF0cml4O1xcbnVuaWZvcm0gdmVjMiB2QW1iaWVudEluZm9zO1xcbiNlbmRpZlxcbiNpZmRlZiBPUEFDSVRZXFxudmFyeWluZyB2ZWMyIHZPcGFjaXR5VVY7XFxudW5pZm9ybSBtYXQ0IG9wYWNpdHlNYXRyaXg7XFxudW5pZm9ybSB2ZWMyIHZPcGFjaXR5SW5mb3M7XFxuI2VuZGlmXFxuI2lmZGVmIEVNSVNTSVZFXFxudmFyeWluZyB2ZWMyIHZFbWlzc2l2ZVVWO1xcbnVuaWZvcm0gdmVjMiB2RW1pc3NpdmVJbmZvcztcXG51bmlmb3JtIG1hdDQgZW1pc3NpdmVNYXRyaXg7XFxuI2VuZGlmXFxuI2lmIGRlZmluZWQoUkVGTEVDVElWSVRZKVxcbnZhcnlpbmcgdmVjMiB2UmVmbGVjdGl2aXR5VVY7XFxudW5pZm9ybSB2ZWMyIHZSZWZsZWN0aXZpdHlJbmZvcztcXG51bmlmb3JtIG1hdDQgcmVmbGVjdGl2aXR5TWF0cml4O1xcbiNlbmRpZlxcblxcbnZhcnlpbmcgdmVjMyB2UG9zaXRpb25XO1xcbnZhcnlpbmcgdmVjMyB2Tm9ybWFsVztcXG4jaWZkZWYgVkVSVEVYQ09MT1JcXG52YXJ5aW5nIHZlYzQgdkNvbG9yO1xcbiNlbmRpZlxcbiNpbmNsdWRlPGNsaXBQbGFuZVZlcnRleERlY2xhcmF0aW9uPlxcbnZvaWQgbWFpbih2b2lkKSB7XFxubWF0NCBmaW5hbFdvcmxkPXdvcmxkO1xcbiNpbmNsdWRlPGJvbmVzVmVydGV4PlxcbmdsX1Bvc2l0aW9uPXZpZXdQcm9qZWN0aW9uKmZpbmFsV29ybGQqdmVjNChwb3NpdGlvbiwxLjApO1xcbnZlYzQgd29ybGRQb3M9ZmluYWxXb3JsZCp2ZWM0KHBvc2l0aW9uLDEuMCk7XFxudlBvc2l0aW9uVz12ZWMzKHdvcmxkUG9zKTtcXG52Tm9ybWFsVz1ub3JtYWxpemUodmVjMyhmaW5hbFdvcmxkKnZlYzQobm9ybWFsLDAuMCkpKTtcXG5cXG4jaWZuZGVmIFVWMVxcbnZlYzIgdXY9dmVjMigwLiwwLik7XFxuI2VuZGlmXFxuI2lmbmRlZiBVVjJcXG52ZWMyIHV2Mj12ZWMyKDAuLDAuKTtcXG4jZW5kaWZcXG4jaWZkZWYgQUxCRURPXFxuaWYgKHZBbGJlZG9JbmZvcy54ID09IDAuKVxcbntcXG52QWxiZWRvVVY9dmVjMihhbGJlZG9NYXRyaXgqdmVjNCh1diwxLjAsMC4wKSk7XFxufVxcbmVsc2VcXG57XFxudkFsYmVkb1VWPXZlYzIoYWxiZWRvTWF0cml4KnZlYzQodXYyLDEuMCwwLjApKTtcXG59XFxuI2VuZGlmXFxuI2lmZGVmIEFNQklFTlRcXG5pZiAodkFtYmllbnRJbmZvcy54ID09IDAuKVxcbntcXG52QW1iaWVudFVWPXZlYzIoYW1iaWVudE1hdHJpeCp2ZWM0KHV2LDEuMCwwLjApKTtcXG59XFxuZWxzZVxcbntcXG52QW1iaWVudFVWPXZlYzIoYW1iaWVudE1hdHJpeCp2ZWM0KHV2MiwxLjAsMC4wKSk7XFxufVxcbiNlbmRpZlxcbiNpZmRlZiBPUEFDSVRZXFxuaWYgKHZPcGFjaXR5SW5mb3MueCA9PSAwLilcXG57XFxudk9wYWNpdHlVVj12ZWMyKG9wYWNpdHlNYXRyaXgqdmVjNCh1diwxLjAsMC4wKSk7XFxufVxcbmVsc2VcXG57XFxudk9wYWNpdHlVVj12ZWMyKG9wYWNpdHlNYXRyaXgqdmVjNCh1djIsMS4wLDAuMCkpO1xcbn1cXG4jZW5kaWZcXG4jaWZkZWYgRU1JU1NJVkVcXG5pZiAodkVtaXNzaXZlSW5mb3MueCA9PSAwLilcXG57XFxudkVtaXNzaXZlVVY9dmVjMihlbWlzc2l2ZU1hdHJpeCp2ZWM0KHV2LDEuMCwwLjApKTtcXG59XFxuZWxzZVxcbntcXG52RW1pc3NpdmVVVj12ZWMyKGVtaXNzaXZlTWF0cml4KnZlYzQodXYyLDEuMCwwLjApKTtcXG59XFxuI2VuZGlmXFxuI2lmIGRlZmluZWQoUkVGTEVDVElWSVRZKVxcbmlmICh2UmVmbGVjdGl2aXR5SW5mb3MueCA9PSAwLilcXG57XFxudlJlZmxlY3Rpdml0eVVWPXZlYzIocmVmbGVjdGl2aXR5TWF0cml4KnZlYzQodXYsMS4wLDAuMCkpO1xcbn1cXG5lbHNlXFxue1xcbnZSZWZsZWN0aXZpdHlVVj12ZWMyKHJlZmxlY3Rpdml0eU1hdHJpeCp2ZWM0KHV2MiwxLjAsMC4wKSk7XFxufVxcbiNlbmRpZlxcbiNpbmNsdWRlPGNsaXBQbGFuZVZlcnRleD5cXG5cXG4jaWZkZWYgVkVSVEVYQ09MT1JcXG52Q29sb3I9Y29sb3I7XFxuI2VuZGlmXFxufVwiLGxlbnNGbGFyZVBpeGVsU2hhZGVyOlwiXFxudmFyeWluZyB2ZWMyIHZVVjtcXG51bmlmb3JtIHNhbXBsZXIyRCB0ZXh0dXJlU2FtcGxlcjtcXG5cXG51bmlmb3JtIHZlYzQgY29sb3I7XFxudm9pZCBtYWluKHZvaWQpIHtcXG52ZWM0IGJhc2VDb2xvcj10ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWKTtcXG5nbF9GcmFnQ29sb3I9YmFzZUNvbG9yKmNvbG9yO1xcbn1cIixsZW5zRmxhcmVWZXJ0ZXhTaGFkZXI6XCJcXG5hdHRyaWJ1dGUgdmVjMiBwb3NpdGlvbjtcXG5cXG51bmlmb3JtIG1hdDQgdmlld3BvcnRNYXRyaXg7XFxuXFxudmFyeWluZyB2ZWMyIHZVVjtcXG5jb25zdCB2ZWMyIG1hZGQ9dmVjMigwLjUsMC41KTtcXG52b2lkIG1haW4odm9pZCkgeyBcXG52VVY9cG9zaXRpb24qbWFkZCttYWRkO1xcbmdsX1Bvc2l0aW9uPXZpZXdwb3J0TWF0cml4KnZlYzQocG9zaXRpb24sMC4wLDEuMCk7XFxufVwiLGxlbnNIaWdobGlnaHRzUGl4ZWxTaGFkZXI6XCJcXG51bmlmb3JtIHNhbXBsZXIyRCB0ZXh0dXJlU2FtcGxlcjsgXFxuXFxudW5pZm9ybSBmbG9hdCBnYWluO1xcbnVuaWZvcm0gZmxvYXQgdGhyZXNob2xkO1xcbnVuaWZvcm0gZmxvYXQgc2NyZWVuX3dpZHRoO1xcbnVuaWZvcm0gZmxvYXQgc2NyZWVuX2hlaWdodDtcXG5cXG52YXJ5aW5nIHZlYzIgdlVWO1xcblxcbnZlYzQgaGlnaGxpZ2h0Q29sb3IodmVjNCBjb2xvcikge1xcbnZlYzQgaGlnaGxpZ2h0PWNvbG9yO1xcbmZsb2F0IGx1bWluYW5jZT1kb3QoaGlnaGxpZ2h0LnJnYix2ZWMzKDAuMjEyNSwwLjcxNTQsMC4wNzIxKSk7XFxuZmxvYXQgbHVtX3RocmVzaG9sZDtcXG5pZiAodGhyZXNob2xkPjEuMCkgeyBsdW1fdGhyZXNob2xkPTAuOTQrMC4wMSp0aHJlc2hvbGQ7IH1cXG5lbHNlIHsgbHVtX3RocmVzaG9sZD0wLjUrMC40NCp0aHJlc2hvbGQ7IH1cXG5sdW1pbmFuY2U9Y2xhbXAoKGx1bWluYW5jZS1sdW1fdGhyZXNob2xkKSooMS4wLygxLjAtbHVtX3RocmVzaG9sZCkpLDAuMCwxLjApO1xcbmhpZ2hsaWdodCo9bHVtaW5hbmNlKmdhaW47XFxuaGlnaGxpZ2h0LmE9MS4wO1xcbnJldHVybiBoaWdobGlnaHQ7XFxufVxcbnZvaWQgbWFpbih2b2lkKVxcbntcXG52ZWM0IG9yaWdpbmFsPXRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcix2VVYpO1xcblxcbmlmIChnYWluID09IC0xLjApIHtcXG5nbF9GcmFnQ29sb3I9dmVjNCgwLjAsMC4wLDAuMCwxLjApO1xcbnJldHVybjtcXG59XFxuZmxvYXQgdz0yLjAvc2NyZWVuX3dpZHRoO1xcbmZsb2F0IGg9Mi4wL3NjcmVlbl9oZWlnaHQ7XFxuZmxvYXQgd2VpZ2h0PTEuMDtcXG5cXG52ZWM0IGJsdXJyZWQ9dmVjNCgwLjAsMC4wLDAuMCwwLjApO1xcbiNpZmRlZiBQRU5UQUdPTlxcbmJsdXJyZWQrPWhpZ2hsaWdodENvbG9yKHRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcix2VVYrdmVjMigtMC44NCp3LDAuNDMqaCkpKTtcXG5ibHVycmVkKz1oaWdobGlnaHRDb2xvcih0ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK3ZlYzIoMC40OCp3LC0xLjI5KmgpKSk7XFxuYmx1cnJlZCs9aGlnaGxpZ2h0Q29sb3IodGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVit2ZWMyKDAuNjEqdywxLjUxKmgpKSk7XFxuYmx1cnJlZCs9aGlnaGxpZ2h0Q29sb3IodGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVit2ZWMyKC0xLjU1KncsLTAuNzQqaCkpKTtcXG5ibHVycmVkKz1oaWdobGlnaHRDb2xvcih0ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK3ZlYzIoMS43MSp3LC0wLjUyKmgpKSk7XFxuYmx1cnJlZCs9aGlnaGxpZ2h0Q29sb3IodGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVit2ZWMyKC0wLjk0KncsMS41OSpoKSkpO1xcbmJsdXJyZWQrPWhpZ2hsaWdodENvbG9yKHRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcix2VVYrdmVjMigtMC40MCp3LC0xLjg3KmgpKSk7XFxuYmx1cnJlZCs9aGlnaGxpZ2h0Q29sb3IodGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVit2ZWMyKDEuNjIqdywxLjE2KmgpKSk7XFxuYmx1cnJlZCs9aGlnaGxpZ2h0Q29sb3IodGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVit2ZWMyKC0yLjA5KncsMC4yNSpoKSkpO1xcbmJsdXJyZWQrPWhpZ2hsaWdodENvbG9yKHRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcix2VVYrdmVjMigxLjQ2KncsLTEuNzEqaCkpKTtcXG5ibHVycmVkKz1oaWdobGlnaHRDb2xvcih0ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK3ZlYzIoMC4wOCp3LDIuNDIqaCkpKTtcXG5ibHVycmVkKz1oaWdobGlnaHRDb2xvcih0ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK3ZlYzIoLTEuODUqdywtMS44OSpoKSkpO1xcbmJsdXJyZWQrPWhpZ2hsaWdodENvbG9yKHRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcix2VVYrdmVjMigyLjg5KncsMC4xNipoKSkpO1xcbmJsdXJyZWQrPWhpZ2hsaWdodENvbG9yKHRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcix2VVYrdmVjMigtMi4yOSp3LDEuODgqaCkpKTtcXG5ibHVycmVkKz1oaWdobGlnaHRDb2xvcih0ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK3ZlYzIoMC40MCp3LC0yLjgxKmgpKSk7XFxuYmx1cnJlZCs9aGlnaGxpZ2h0Q29sb3IodGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVit2ZWMyKDEuNTQqdywyLjI2KmgpKSk7XFxuYmx1cnJlZCs9aGlnaGxpZ2h0Q29sb3IodGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVit2ZWMyKC0yLjYwKncsLTAuNjEqaCkpKTtcXG5ibHVycmVkKz1oaWdobGlnaHRDb2xvcih0ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK3ZlYzIoMi4zMSp3LC0xLjMwKmgpKSk7XFxuYmx1cnJlZCs9aGlnaGxpZ2h0Q29sb3IodGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVit2ZWMyKC0wLjgzKncsMi41MypoKSkpO1xcbmJsdXJyZWQrPWhpZ2hsaWdodENvbG9yKHRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcix2VVYrdmVjMigtMS4xMip3LC0yLjQ4KmgpKSk7XFxuYmx1cnJlZCs9aGlnaGxpZ2h0Q29sb3IodGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVit2ZWMyKDIuNjAqdywxLjExKmgpKSk7XFxuYmx1cnJlZCs9aGlnaGxpZ2h0Q29sb3IodGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVit2ZWMyKC0yLjgyKncsMC45OSpoKSkpO1xcbmJsdXJyZWQrPWhpZ2hsaWdodENvbG9yKHRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcix2VVYrdmVjMigxLjUwKncsLTIuODEqaCkpKTtcXG5ibHVycmVkKz1oaWdobGlnaHRDb2xvcih0ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK3ZlYzIoMC44NSp3LDMuMzMqaCkpKTtcXG5ibHVycmVkKz1oaWdobGlnaHRDb2xvcih0ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK3ZlYzIoLTIuOTQqdywtMS45MipoKSkpO1xcbmJsdXJyZWQrPWhpZ2hsaWdodENvbG9yKHRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcix2VVYrdmVjMigzLjI3KncsLTAuNTMqaCkpKTtcXG5ibHVycmVkKz1oaWdobGlnaHRDb2xvcih0ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK3ZlYzIoLTEuOTUqdywyLjQ4KmgpKSk7XFxuYmx1cnJlZCs9aGlnaGxpZ2h0Q29sb3IodGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVit2ZWMyKC0wLjIzKncsLTMuMDQqaCkpKTtcXG5ibHVycmVkKz1oaWdobGlnaHRDb2xvcih0ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK3ZlYzIoMi4xNyp3LDIuMDUqaCkpKTtcXG5ibHVycmVkKz1oaWdobGlnaHRDb2xvcih0ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK3ZlYzIoLTIuOTcqdywtMC4wNCpoKSkpO1xcbmJsdXJyZWQrPWhpZ2hsaWdodENvbG9yKHRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcix2VVYrdmVjMigyLjI1KncsLTIuMDAqaCkpKTtcXG5ibHVycmVkKz1oaWdobGlnaHRDb2xvcih0ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK3ZlYzIoLTAuMzEqdywzLjA4KmgpKSk7XFxuYmx1cnJlZCs9aGlnaGxpZ2h0Q29sb3IodGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVit2ZWMyKC0xLjk0KncsLTIuNTkqaCkpKTtcXG5ibHVycmVkKz1oaWdobGlnaHRDb2xvcih0ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK3ZlYzIoMy4zNyp3LDAuNjQqaCkpKTtcXG5ibHVycmVkKz1oaWdobGlnaHRDb2xvcih0ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK3ZlYzIoLTMuMTMqdywxLjkzKmgpKSk7XFxuYmx1cnJlZCs9aGlnaGxpZ2h0Q29sb3IodGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVit2ZWMyKDEuMDMqdywtMy42NSpoKSkpO1xcbmJsdXJyZWQrPWhpZ2hsaWdodENvbG9yKHRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcix2VVYrdmVjMigxLjYwKncsMy4xNypoKSkpO1xcbmJsdXJyZWQrPWhpZ2hsaWdodENvbG9yKHRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcix2VVYrdmVjMigtMy4xNCp3LC0xLjE5KmgpKSk7XFxuYmx1cnJlZCs9aGlnaGxpZ2h0Q29sb3IodGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVit2ZWMyKDMuMDAqdywtMS4xOSpoKSkpO1xcbiNlbHNlXFxuYmx1cnJlZCs9aGlnaGxpZ2h0Q29sb3IodGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVit2ZWMyKC0wLjg1KncsMC4zNipoKSkpO1xcbmJsdXJyZWQrPWhpZ2hsaWdodENvbG9yKHRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcix2VVYrdmVjMigwLjUyKncsLTEuMTQqaCkpKTtcXG5ibHVycmVkKz1oaWdobGlnaHRDb2xvcih0ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK3ZlYzIoMC40Nip3LDEuNDIqaCkpKTtcXG5ibHVycmVkKz1oaWdobGlnaHRDb2xvcih0ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK3ZlYzIoLTEuNDYqdywtMC44MypoKSkpO1xcbmJsdXJyZWQrPWhpZ2hsaWdodENvbG9yKHRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcix2VVYrdmVjMigxLjc5KncsLTAuNDIqaCkpKTtcXG5ibHVycmVkKz1oaWdobGlnaHRDb2xvcih0ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK3ZlYzIoLTEuMTEqdywxLjYyKmgpKSk7XFxuYmx1cnJlZCs9aGlnaGxpZ2h0Q29sb3IodGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVit2ZWMyKC0wLjI5KncsLTIuMDcqaCkpKTtcXG5ibHVycmVkKz1oaWdobGlnaHRDb2xvcih0ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK3ZlYzIoMS42OSp3LDEuMzkqaCkpKTtcXG5ibHVycmVkKz1oaWdobGlnaHRDb2xvcih0ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK3ZlYzIoLTIuMjgqdywwLjEyKmgpKSk7XFxuYmx1cnJlZCs9aGlnaGxpZ2h0Q29sb3IodGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVit2ZWMyKDEuNjUqdywtMS42OSpoKSkpO1xcbmJsdXJyZWQrPWhpZ2hsaWdodENvbG9yKHRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcix2VVYrdmVjMigtMC4wOCp3LDIuNDQqaCkpKTtcXG5ibHVycmVkKz1oaWdobGlnaHRDb2xvcih0ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK3ZlYzIoLTEuNjMqdywtMS45MCpoKSkpO1xcbmJsdXJyZWQrPWhpZ2hsaWdodENvbG9yKHRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcix2VVYrdmVjMigyLjU1KncsMC4zMSpoKSkpO1xcbmJsdXJyZWQrPWhpZ2hsaWdodENvbG9yKHRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcix2VVYrdmVjMigtMi4xMyp3LDEuNTIqaCkpKTtcXG5ibHVycmVkKz1oaWdobGlnaHRDb2xvcih0ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK3ZlYzIoMC41Nip3LC0yLjYxKmgpKSk7XFxuYmx1cnJlZCs9aGlnaGxpZ2h0Q29sb3IodGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVit2ZWMyKDEuMzgqdywyLjM0KmgpKSk7XFxuYmx1cnJlZCs9aGlnaGxpZ2h0Q29sb3IodGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVit2ZWMyKC0yLjY0KncsLTAuODEqaCkpKTtcXG5ibHVycmVkKz1oaWdobGlnaHRDb2xvcih0ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK3ZlYzIoMi41Myp3LC0xLjIxKmgpKSk7XFxuYmx1cnJlZCs9aGlnaGxpZ2h0Q29sb3IodGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVit2ZWMyKC0xLjA2KncsMi42MypoKSkpO1xcbmJsdXJyZWQrPWhpZ2hsaWdodENvbG9yKHRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcix2VVYrdmVjMigtMS4wMCp3LC0yLjY5KmgpKSk7XFxuYmx1cnJlZCs9aGlnaGxpZ2h0Q29sb3IodGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVit2ZWMyKDIuNTkqdywxLjMyKmgpKSk7XFxuYmx1cnJlZCs9aGlnaGxpZ2h0Q29sb3IodGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVit2ZWMyKC0yLjgyKncsMC43OCpoKSkpO1xcbmJsdXJyZWQrPWhpZ2hsaWdodENvbG9yKHRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcix2VVYrdmVjMigxLjU3KncsLTIuNTAqaCkpKTtcXG5ibHVycmVkKz1oaWdobGlnaHRDb2xvcih0ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK3ZlYzIoMC41NCp3LDIuOTMqaCkpKTtcXG5ibHVycmVkKz1oaWdobGlnaHRDb2xvcih0ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK3ZlYzIoLTIuMzkqdywtMS44MSpoKSkpO1xcbmJsdXJyZWQrPWhpZ2hsaWdodENvbG9yKHRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcix2VVYrdmVjMigzLjAxKncsLTAuMjgqaCkpKTtcXG5ibHVycmVkKz1oaWdobGlnaHRDb2xvcih0ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK3ZlYzIoLTIuMDQqdywyLjI1KmgpKSk7XFxuYmx1cnJlZCs9aGlnaGxpZ2h0Q29sb3IodGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVit2ZWMyKC0wLjAyKncsLTMuMDUqaCkpKTtcXG5ibHVycmVkKz1oaWdobGlnaHRDb2xvcih0ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK3ZlYzIoMi4wOSp3LDIuMjUqaCkpKTtcXG5ibHVycmVkKz1oaWdobGlnaHRDb2xvcih0ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK3ZlYzIoLTMuMDcqdywtMC4yNSpoKSkpO1xcbmJsdXJyZWQrPWhpZ2hsaWdodENvbG9yKHRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcix2VVYrdmVjMigyLjQ0KncsLTEuOTAqaCkpKTtcXG5ibHVycmVkKz1oaWdobGlnaHRDb2xvcih0ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK3ZlYzIoLTAuNTIqdywzLjA1KmgpKSk7XFxuYmx1cnJlZCs9aGlnaGxpZ2h0Q29sb3IodGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVit2ZWMyKC0xLjY4KncsLTIuNjEqaCkpKTtcXG5ibHVycmVkKz1oaWdobGlnaHRDb2xvcih0ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK3ZlYzIoMy4wMSp3LDAuNzkqaCkpKTtcXG5ibHVycmVkKz1oaWdobGlnaHRDb2xvcih0ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWK3ZlYzIoLTIuNzYqdywxLjQ2KmgpKSk7XFxuYmx1cnJlZCs9aGlnaGxpZ2h0Q29sb3IodGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVit2ZWMyKDEuMDUqdywtMi45NCpoKSkpO1xcbmJsdXJyZWQrPWhpZ2hsaWdodENvbG9yKHRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcix2VVYrdmVjMigxLjIxKncsMi44OCpoKSkpO1xcbmJsdXJyZWQrPWhpZ2hsaWdodENvbG9yKHRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcix2VVYrdmVjMigtMi44NCp3LC0xLjMwKmgpKSk7XFxuYmx1cnJlZCs9aGlnaGxpZ2h0Q29sb3IodGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVit2ZWMyKDIuOTgqdywtMC45NipoKSkpO1xcbiNlbmRpZlxcbmJsdXJyZWQvPTM5LjA7XFxuZ2xfRnJhZ0NvbG9yPWJsdXJyZWQ7XFxuXFxufVwiLGxpbmVQaXhlbFNoYWRlcjpcInVuaWZvcm0gdmVjNCBjb2xvcjtcXG52b2lkIG1haW4odm9pZCkge1xcbmdsX0ZyYWdDb2xvcj1jb2xvcjtcXG59XCIsbGluZVZlcnRleFNoYWRlcjpcIlxcbmF0dHJpYnV0ZSB2ZWMzIHBvc2l0aW9uO1xcbmF0dHJpYnV0ZSB2ZWM0IG5vcm1hbDtcXG5cXG51bmlmb3JtIG1hdDQgd29ybGRWaWV3UHJvamVjdGlvbjtcXG51bmlmb3JtIGZsb2F0IHdpZHRoO1xcbnVuaWZvcm0gZmxvYXQgYXNwZWN0UmF0aW87XFxudm9pZCBtYWluKHZvaWQpIHtcXG52ZWM0IHZpZXdQb3NpdGlvbj13b3JsZFZpZXdQcm9qZWN0aW9uKnZlYzQocG9zaXRpb24sMS4wKTtcXG52ZWM0IHZpZXdQb3NpdGlvbk5leHQ9d29ybGRWaWV3UHJvamVjdGlvbip2ZWM0KG5vcm1hbC54eXosMS4wKTtcXG52ZWMyIGN1cnJlbnRTY3JlZW49dmlld1Bvc2l0aW9uLnh5L3ZpZXdQb3NpdGlvbi53O1xcbnZlYzIgbmV4dFNjcmVlbj12aWV3UG9zaXRpb25OZXh0Lnh5L3ZpZXdQb3NpdGlvbk5leHQudztcXG5jdXJyZW50U2NyZWVuLngqPWFzcGVjdFJhdGlvO1xcbm5leHRTY3JlZW4ueCo9YXNwZWN0UmF0aW87XFxudmVjMiBkaXI9bm9ybWFsaXplKG5leHRTY3JlZW4tY3VycmVudFNjcmVlbik7XFxudmVjMiBub3JtYWxEaXI9dmVjMigtZGlyLnksZGlyLngpO1xcbm5vcm1hbERpcio9d2lkdGgvMi4wO1xcbm5vcm1hbERpci54Lz1hc3BlY3RSYXRpbztcXG52ZWM0IG9mZnNldD12ZWM0KG5vcm1hbERpcipub3JtYWwudywwLjAsMC4wKTtcXG5nbF9Qb3NpdGlvbj12aWV3UG9zaXRpb24rb2Zmc2V0O1xcbn1cIixsaW5lczJkUGl4ZWxTaGFkZXI6XCJ2YXJ5aW5nIHZlYzQgdkNvbG9yO1xcbnZvaWQgbWFpbih2b2lkKSB7XFxuZ2xfRnJhZ0NvbG9yPXZDb2xvcjtcXG59XCIsbGluZXMyZFZlcnRleFNoYWRlcjpcIlxcbiNpZmRlZiBJbnN0YW5jZWRcXG4jZGVmaW5lIGF0dCBhdHRyaWJ1dGVcXG4jZWxzZVxcbiNkZWZpbmUgYXR0IHVuaWZvcm1cXG4jZW5kaWZcXG5hdHRyaWJ1dGUgdmVjMiBwb3NpdGlvbjtcXG5hdHQgdmVjMiB6QmlhcztcXG5hdHQgdmVjNCB0cmFuc2Zvcm1YO1xcbmF0dCB2ZWM0IHRyYW5zZm9ybVk7XFxuI2lmZGVmIEZpbGxTb2xpZFxcbmF0dCB2ZWM0IGZpbGxTb2xpZENvbG9yO1xcbiNlbmRpZlxcbiNpZmRlZiBCb3JkZXJTb2xpZFxcbmF0dCB2ZWM0IGJvcmRlclNvbGlkQ29sb3I7XFxuI2VuZGlmXFxuI2lmZGVmIEZpbGxHcmFkaWVudFxcbmF0dCB2ZWMyIGJvdW5kaW5nTWluO1xcbmF0dCB2ZWMyIGJvdW5kaW5nTWF4O1xcbmF0dCB2ZWM0IGZpbGxHcmFkaWVudENvbG9yMTtcXG5hdHQgdmVjNCBmaWxsR3JhZGllbnRDb2xvcjI7XFxuYXR0IHZlYzQgZmlsbEdyYWRpZW50VFk7XFxuI2VuZGlmXFxuI2lmZGVmIEJvcmRlckdyYWRpZW50XFxuYXR0IHZlYzQgYm9yZGVyR3JhZGllbnRDb2xvcjE7XFxuYXR0IHZlYzQgYm9yZGVyR3JhZGllbnRDb2xvcjI7XFxuYXR0IHZlYzQgYm9yZGVyR3JhZGllbnRUWTtcXG4jZW5kaWZcXG4jZGVmaW5lIFRXT1BJIDYuMjgzMTg1MzBcXG5cXG52YXJ5aW5nIHZlYzIgdlVWO1xcbnZhcnlpbmcgdmVjNCB2Q29sb3I7XFxudm9pZCBtYWluKHZvaWQpIHtcXG4jaWZkZWYgRmlsbFNvbGlkXFxudkNvbG9yPWZpbGxTb2xpZENvbG9yO1xcbiNlbmRpZlxcbiNpZmRlZiBCb3JkZXJTb2xpZFxcbnZDb2xvcj1ib3JkZXJTb2xpZENvbG9yO1xcbiNlbmRpZlxcbiNpZmRlZiBGaWxsR3JhZGllbnRcXG5mbG9hdCB2PWRvdCh2ZWM0KChwb3NpdGlvbi54eS1ib3VuZGluZ01pbikvKGJvdW5kaW5nTWF4LWJvdW5kaW5nTWluKSwxLDEpLGZpbGxHcmFkaWVudFRZKTtcXG52Q29sb3I9bWl4KGZpbGxHcmFkaWVudENvbG9yMixmaWxsR3JhZGllbnRDb2xvcjEsdik7IFxcbiNlbmRpZlxcbiNpZmRlZiBCb3JkZXJHcmFkaWVudFxcbmZsb2F0IHY9ZG90KHZlYzQoKHBvc2l0aW9uLnh5LWJvdW5kaW5nTWluKS8oYm91bmRpbmdNYXgtYm91bmRpbmdNaW4pLDEsMSksYm9yZGVyR3JhZGllbnRUWSk7XFxudkNvbG9yPW1peChib3JkZXJHcmFkaWVudENvbG9yMixib3JkZXJHcmFkaWVudENvbG9yMSx2KTsgXFxuI2VuZGlmXFxudmVjNCBwb3M7XFxucG9zLnh5PXBvc2l0aW9uLnh5O1xcbnBvcy56PTEuMDtcXG5wb3Mudz0xLjA7XFxuZ2xfUG9zaXRpb249dmVjNChkb3QocG9zLHRyYW5zZm9ybVgpLGRvdChwb3MsdHJhbnNmb3JtWSksekJpYXMueCwxKTtcXG59XCIsb3V0bGluZVBpeGVsU2hhZGVyOlwidW5pZm9ybSB2ZWM0IGNvbG9yO1xcbiNpZmRlZiBBTFBIQVRFU1RcXG52YXJ5aW5nIHZlYzIgdlVWO1xcbnVuaWZvcm0gc2FtcGxlcjJEIGRpZmZ1c2VTYW1wbGVyO1xcbiNlbmRpZlxcbnZvaWQgbWFpbih2b2lkKSB7XFxuI2lmZGVmIEFMUEhBVEVTVFxcbmlmICh0ZXh0dXJlMkQoZGlmZnVzZVNhbXBsZXIsdlVWKS5hPDAuNClcXG5kaXNjYXJkO1xcbiNlbmRpZlxcbmdsX0ZyYWdDb2xvcj1jb2xvcjtcXG59XCIsb3V0bGluZVZlcnRleFNoYWRlcjpcIlxcbmF0dHJpYnV0ZSB2ZWMzIHBvc2l0aW9uO1xcbmF0dHJpYnV0ZSB2ZWMzIG5vcm1hbDtcXG4jaW5jbHVkZTxib25lc0RlY2xhcmF0aW9uPlxcblxcbnVuaWZvcm0gZmxvYXQgb2Zmc2V0O1xcbiNpbmNsdWRlPGluc3RhbmNlc0RlY2xhcmF0aW9uPlxcbnVuaWZvcm0gbWF0NCB2aWV3UHJvamVjdGlvbjtcXG4jaWZkZWYgQUxQSEFURVNUXFxudmFyeWluZyB2ZWMyIHZVVjtcXG51bmlmb3JtIG1hdDQgZGlmZnVzZU1hdHJpeDtcXG4jaWZkZWYgVVYxXFxuYXR0cmlidXRlIHZlYzIgdXY7XFxuI2VuZGlmXFxuI2lmZGVmIFVWMlxcbmF0dHJpYnV0ZSB2ZWMyIHV2MjtcXG4jZW5kaWZcXG4jZW5kaWZcXG52b2lkIG1haW4odm9pZClcXG57XFxudmVjMyBvZmZzZXRQb3NpdGlvbj1wb3NpdGlvbitub3JtYWwqb2Zmc2V0O1xcbiNpbmNsdWRlPGluc3RhbmNlc1ZlcnRleD5cXG4jaW5jbHVkZTxib25lc1ZlcnRleD5cXG5nbF9Qb3NpdGlvbj12aWV3UHJvamVjdGlvbipmaW5hbFdvcmxkKnZlYzQob2Zmc2V0UG9zaXRpb24sMS4wKTtcXG4jaWZkZWYgQUxQSEFURVNUXFxuI2lmZGVmIFVWMVxcbnZVVj12ZWMyKGRpZmZ1c2VNYXRyaXgqdmVjNCh1diwxLjAsMC4wKSk7XFxuI2VuZGlmXFxuI2lmZGVmIFVWMlxcbnZVVj12ZWMyKGRpZmZ1c2VNYXRyaXgqdmVjNCh1djIsMS4wLDAuMCkpO1xcbiNlbmRpZlxcbiNlbmRpZlxcbn1cXG5cIixwYXJ0aWNsZXNQaXhlbFNoYWRlcjpcIlxcbnZhcnlpbmcgdmVjMiB2VVY7XFxudmFyeWluZyB2ZWM0IHZDb2xvcjtcXG51bmlmb3JtIHZlYzQgdGV4dHVyZU1hc2s7XFxudW5pZm9ybSBzYW1wbGVyMkQgZGlmZnVzZVNhbXBsZXI7XFxuI2lmZGVmIENMSVBQTEFORVxcbnZhcnlpbmcgZmxvYXQgZkNsaXBEaXN0YW5jZTtcXG4jZW5kaWZcXG52b2lkIG1haW4odm9pZCkge1xcbiNpZmRlZiBDTElQUExBTkVcXG5pZiAoZkNsaXBEaXN0YW5jZT4wLjApXFxuZGlzY2FyZDtcXG4jZW5kaWZcXG52ZWM0IGJhc2VDb2xvcj10ZXh0dXJlMkQoZGlmZnVzZVNhbXBsZXIsdlVWKTtcXG5nbF9GcmFnQ29sb3I9KGJhc2VDb2xvcip0ZXh0dXJlTWFzaysodmVjNCgxLiwxLiwxLiwxLiktdGV4dHVyZU1hc2spKSp2Q29sb3I7XFxufVwiLHBhcnRpY2xlc1ZlcnRleFNoYWRlcjpcIlxcbmF0dHJpYnV0ZSB2ZWMzIHBvc2l0aW9uO1xcbmF0dHJpYnV0ZSB2ZWM0IGNvbG9yO1xcbmF0dHJpYnV0ZSB2ZWM0IG9wdGlvbnM7XFxuXFxudW5pZm9ybSBtYXQ0IHZpZXc7XFxudW5pZm9ybSBtYXQ0IHByb2plY3Rpb247XFxuXFxudmFyeWluZyB2ZWMyIHZVVjtcXG52YXJ5aW5nIHZlYzQgdkNvbG9yO1xcbiNpZmRlZiBDTElQUExBTkVcXG51bmlmb3JtIHZlYzQgdkNsaXBQbGFuZTtcXG51bmlmb3JtIG1hdDQgaW52VmlldztcXG52YXJ5aW5nIGZsb2F0IGZDbGlwRGlzdGFuY2U7XFxuI2VuZGlmXFxudm9pZCBtYWluKHZvaWQpIHsgXFxudmVjMyB2aWV3UG9zPSh2aWV3KnZlYzQocG9zaXRpb24sMS4wKSkueHl6OyBcXG52ZWMzIGNvcm5lclBvcztcXG5mbG9hdCBzaXplPW9wdGlvbnMueTtcXG5mbG9hdCBhbmdsZT1vcHRpb25zLng7XFxudmVjMiBvZmZzZXQ9b3B0aW9ucy56dztcXG5jb3JuZXJQb3M9dmVjMyhvZmZzZXQueC0wLjUsb2Zmc2V0LnktMC41LDAuKSpzaXplO1xcblxcbnZlYzMgcm90YXRlZENvcm5lcjtcXG5yb3RhdGVkQ29ybmVyLng9Y29ybmVyUG9zLngqY29zKGFuZ2xlKS1jb3JuZXJQb3MueSpzaW4oYW5nbGUpO1xcbnJvdGF0ZWRDb3JuZXIueT1jb3JuZXJQb3MueCpzaW4oYW5nbGUpK2Nvcm5lclBvcy55KmNvcyhhbmdsZSk7XFxucm90YXRlZENvcm5lci56PTAuO1xcblxcbnZpZXdQb3MrPXJvdGF0ZWRDb3JuZXI7XFxuZ2xfUG9zaXRpb249cHJvamVjdGlvbip2ZWM0KHZpZXdQb3MsMS4wKTsgXFxudkNvbG9yPWNvbG9yO1xcbnZVVj1vZmZzZXQ7XFxuXFxuI2lmZGVmIENMSVBQTEFORVxcbnZlYzQgd29ybGRQb3M9aW52Vmlldyp2ZWM0KHZpZXdQb3MsMS4wKTtcXG5mQ2xpcERpc3RhbmNlPWRvdCh3b3JsZFBvcyx2Q2xpcFBsYW5lKTtcXG4jZW5kaWZcXG59XCIscGFzc1BpeGVsU2hhZGVyOlwiXFxudmFyeWluZyB2ZWMyIHZVVjtcXG51bmlmb3JtIHNhbXBsZXIyRCB0ZXh0dXJlU2FtcGxlcjtcXG52b2lkIG1haW4odm9pZCkgXFxue1xcbmdsX0ZyYWdDb2xvcj10ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWKTtcXG59XCIscGJyUGl4ZWxTaGFkZXI6XCIjaWZkZWYgQlVNUFxcbiNleHRlbnNpb24gR0xfT0VTX3N0YW5kYXJkX2Rlcml2YXRpdmVzIDogZW5hYmxlXFxuI2VuZGlmXFxuI2lmZGVmIExPREJBU0VETUlDUk9TRlVSQUNFXFxuI2V4dGVuc2lvbiBHTF9FWFRfc2hhZGVyX3RleHR1cmVfbG9kIDogZW5hYmxlXFxuI2VuZGlmXFxuI2lmZGVmIExPR0FSSVRITUlDREVQVEhcXG4jZXh0ZW5zaW9uIEdMX0VYVF9mcmFnX2RlcHRoIDogZW5hYmxlXFxuI2VuZGlmXFxucHJlY2lzaW9uIGhpZ2hwIGZsb2F0O1xcbnVuaWZvcm0gdmVjMyB2RXllUG9zaXRpb247XFxudW5pZm9ybSB2ZWMzIHZBbWJpZW50Q29sb3I7XFxudW5pZm9ybSB2ZWMzIHZSZWZsZWN0aW9uQ29sb3I7XFxudW5pZm9ybSB2ZWM0IHZBbGJlZG9Db2xvcjtcXG5cXG51bmlmb3JtIHZlYzQgdkxpZ2h0aW5nSW50ZW5zaXR5O1xcbnVuaWZvcm0gdmVjNCB2Q2FtZXJhSW5mb3M7XFxuI2lmZGVmIE9WRVJMT0FERURWQUxVRVNcXG51bmlmb3JtIHZlYzQgdk92ZXJsb2FkZWRJbnRlbnNpdHk7XFxudW5pZm9ybSB2ZWMzIHZPdmVybG9hZGVkQW1iaWVudDtcXG51bmlmb3JtIHZlYzMgdk92ZXJsb2FkZWRBbGJlZG87XFxudW5pZm9ybSB2ZWMzIHZPdmVybG9hZGVkUmVmbGVjdGl2aXR5O1xcbnVuaWZvcm0gdmVjMyB2T3ZlcmxvYWRlZEVtaXNzaXZlO1xcbnVuaWZvcm0gdmVjMyB2T3ZlcmxvYWRlZFJlZmxlY3Rpb247XFxudW5pZm9ybSB2ZWMzIHZPdmVybG9hZGVkTWljcm9TdXJmYWNlO1xcbiNlbmRpZlxcbiNpZmRlZiBPVkVSTE9BREVEU0hBRE9XVkFMVUVTXFxudW5pZm9ybSB2ZWM0IHZPdmVybG9hZGVkU2hhZG93SW50ZW5zaXR5O1xcbiNlbmRpZlxcbiNpZiBkZWZpbmVkKFJFRkxFQ1RJT04pIHx8IGRlZmluZWQoUkVGUkFDVElPTilcXG51bmlmb3JtIHZlYzIgdk1pY3Jvc3VyZmFjZVRleHR1cmVMb2RzO1xcbiNlbmRpZlxcbnVuaWZvcm0gdmVjNCB2UmVmbGVjdGl2aXR5Q29sb3I7XFxudW5pZm9ybSB2ZWMzIHZFbWlzc2l2ZUNvbG9yO1xcblxcbnZhcnlpbmcgdmVjMyB2UG9zaXRpb25XO1xcbiNpZmRlZiBOT1JNQUxcXG52YXJ5aW5nIHZlYzMgdk5vcm1hbFc7XFxuI2VuZGlmXFxuI2lmZGVmIFZFUlRFWENPTE9SXFxudmFyeWluZyB2ZWM0IHZDb2xvcjtcXG4jZW5kaWZcXG5cXG4jaW5jbHVkZTxsaWdodEZyYWdtZW50RGVjbGFyYXRpb24+WzAuLm1heFNpbXVsdGFuZW91c0xpZ2h0c11cXG5cXG4jaWZkZWYgQUxCRURPXFxudmFyeWluZyB2ZWMyIHZBbGJlZG9VVjtcXG51bmlmb3JtIHNhbXBsZXIyRCBhbGJlZG9TYW1wbGVyO1xcbnVuaWZvcm0gdmVjMiB2QWxiZWRvSW5mb3M7XFxuI2VuZGlmXFxuI2lmZGVmIEFNQklFTlRcXG52YXJ5aW5nIHZlYzIgdkFtYmllbnRVVjtcXG51bmlmb3JtIHNhbXBsZXIyRCBhbWJpZW50U2FtcGxlcjtcXG51bmlmb3JtIHZlYzIgdkFtYmllbnRJbmZvcztcXG4jZW5kaWZcXG4jaWZkZWYgT1BBQ0lUWSBcXG52YXJ5aW5nIHZlYzIgdk9wYWNpdHlVVjtcXG51bmlmb3JtIHNhbXBsZXIyRCBvcGFjaXR5U2FtcGxlcjtcXG51bmlmb3JtIHZlYzIgdk9wYWNpdHlJbmZvcztcXG4jZW5kaWZcXG4jaWZkZWYgRU1JU1NJVkVcXG52YXJ5aW5nIHZlYzIgdkVtaXNzaXZlVVY7XFxudW5pZm9ybSB2ZWMyIHZFbWlzc2l2ZUluZm9zO1xcbnVuaWZvcm0gc2FtcGxlcjJEIGVtaXNzaXZlU2FtcGxlcjtcXG4jZW5kaWZcXG4jaWZkZWYgTElHSFRNQVBcXG52YXJ5aW5nIHZlYzIgdkxpZ2h0bWFwVVY7XFxudW5pZm9ybSB2ZWMyIHZMaWdodG1hcEluZm9zO1xcbnVuaWZvcm0gc2FtcGxlcjJEIGxpZ2h0bWFwU2FtcGxlcjtcXG4jZW5kaWZcXG4jaWYgZGVmaW5lZChSRUZMRUNUSVZJVFkpXFxudmFyeWluZyB2ZWMyIHZSZWZsZWN0aXZpdHlVVjtcXG51bmlmb3JtIHZlYzIgdlJlZmxlY3Rpdml0eUluZm9zO1xcbnVuaWZvcm0gc2FtcGxlcjJEIHJlZmxlY3Rpdml0eVNhbXBsZXI7XFxuI2VuZGlmXFxuXFxuI2luY2x1ZGU8ZnJlc25lbEZ1bmN0aW9uPlxcbiNpZmRlZiBPUEFDSVRZRlJFU05FTFxcbnVuaWZvcm0gdmVjNCBvcGFjaXR5UGFydHM7XFxuI2VuZGlmXFxuI2lmZGVmIEVNSVNTSVZFRlJFU05FTFxcbnVuaWZvcm0gdmVjNCBlbWlzc2l2ZUxlZnRDb2xvcjtcXG51bmlmb3JtIHZlYzQgZW1pc3NpdmVSaWdodENvbG9yO1xcbiNlbmRpZlxcblxcbiNpZiBkZWZpbmVkKFJFRkxFQ1RJT05NQVBfU1BIRVJJQ0FMKSB8fCBkZWZpbmVkKFJFRkxFQ1RJT05NQVBfUFJPSkVDVElPTikgfHwgZGVmaW5lZChSRUZSQUNUSU9OKVxcbnVuaWZvcm0gbWF0NCB2aWV3O1xcbiNlbmRpZlxcblxcbiNpZmRlZiBSRUZSQUNUSU9OXFxudW5pZm9ybSB2ZWM0IHZSZWZyYWN0aW9uSW5mb3M7XFxuI2lmZGVmIFJFRlJBQ1RJT05NQVBfM0RcXG51bmlmb3JtIHNhbXBsZXJDdWJlIHJlZnJhY3Rpb25DdWJlU2FtcGxlcjtcXG4jZWxzZVxcbnVuaWZvcm0gc2FtcGxlcjJEIHJlZnJhY3Rpb24yRFNhbXBsZXI7XFxudW5pZm9ybSBtYXQ0IHJlZnJhY3Rpb25NYXRyaXg7XFxuI2VuZGlmXFxuI2VuZGlmXFxuXFxuI2lmZGVmIFJFRkxFQ1RJT05cXG51bmlmb3JtIHZlYzIgdlJlZmxlY3Rpb25JbmZvcztcXG4jaWZkZWYgUkVGTEVDVElPTk1BUF8zRFxcbnVuaWZvcm0gc2FtcGxlckN1YmUgcmVmbGVjdGlvbkN1YmVTYW1wbGVyO1xcbiNlbHNlXFxudW5pZm9ybSBzYW1wbGVyMkQgcmVmbGVjdGlvbjJEU2FtcGxlcjtcXG4jZW5kaWZcXG4jaWZkZWYgUkVGTEVDVElPTk1BUF9TS1lCT1hcXG52YXJ5aW5nIHZlYzMgdlBvc2l0aW9uVVZXO1xcbiNlbHNlXFxuI2lmZGVmIFJFRkxFQ1RJT05NQVBfRVFVSVJFQ1RBTkdVTEFSX0ZJWEVEXFxudmFyeWluZyB2ZWMzIHZEaXJlY3Rpb25XO1xcbiNlbmRpZlxcbiNpZiBkZWZpbmVkKFJFRkxFQ1RJT05NQVBfUExBTkFSKSB8fCBkZWZpbmVkKFJFRkxFQ1RJT05NQVBfQ1VCSUMpIHx8IGRlZmluZWQoUkVGTEVDVElPTk1BUF9QUk9KRUNUSU9OKVxcbnVuaWZvcm0gbWF0NCByZWZsZWN0aW9uTWF0cml4O1xcbiNlbmRpZlxcbiNlbmRpZlxcbiNpbmNsdWRlPHJlZmxlY3Rpb25GdW5jdGlvbj5cXG4jZW5kaWZcXG4jaWZkZWYgQ0FNRVJBQ09MT1JHUkFESU5HXFxuI2luY2x1ZGU8Y29sb3JHcmFkaW5nRGVmaW5pdGlvbj5cXG4jZW5kaWZcXG4jaWZkZWYgQ0FNRVJBQ09MT1JDVVJWRVNcXG4jaW5jbHVkZTxjb2xvckN1cnZlc0RlZmluaXRpb24+XFxuI2VuZGlmXFxuXFxuI2luY2x1ZGU8cGJyU2hhZG93RnVuY3Rpb25zPlxcbiNpbmNsdWRlPHBickZ1bmN0aW9ucz5cXG4jaWZkZWYgQ0FNRVJBQ09MT1JHUkFESU5HXFxuI2luY2x1ZGU8Y29sb3JHcmFkaW5nPlxcbiNlbmRpZlxcbiNpZmRlZiBDQU1FUkFDT0xPUkNVUlZFU1xcbiNpbmNsdWRlPGNvbG9yQ3VydmVzPlxcbiNlbmRpZlxcbiNpbmNsdWRlPGhhcm1vbmljc0Z1bmN0aW9ucz5cXG4jaW5jbHVkZTxwYnJMaWdodEZ1bmN0aW9ucz5cXG4jaW5jbHVkZTxidW1wRnJhZ21lbnRGdW5jdGlvbnM+XFxuI2luY2x1ZGU8Y2xpcFBsYW5lRnJhZ21lbnREZWNsYXJhdGlvbj5cXG4jaW5jbHVkZTxsb2dEZXB0aERlY2xhcmF0aW9uPlxcblxcbiNpbmNsdWRlPGZvZ0ZyYWdtZW50RGVjbGFyYXRpb24+XFxudm9pZCBtYWluKHZvaWQpIHtcXG4jaW5jbHVkZTxjbGlwUGxhbmVGcmFnbWVudD5cXG52ZWMzIHZpZXdEaXJlY3Rpb25XPW5vcm1hbGl6ZSh2RXllUG9zaXRpb24tdlBvc2l0aW9uVyk7XFxuXFxudmVjNCBzdXJmYWNlQWxiZWRvPXZlYzQoMS4sMS4sMS4sMS4pO1xcbnZlYzMgc3VyZmFjZUFsYmVkb0NvbnRyaWJ1dGlvbj12QWxiZWRvQ29sb3IucmdiO1xcblxcbmZsb2F0IGFscGhhPXZBbGJlZG9Db2xvci5hO1xcbiNpZmRlZiBBTEJFRE9cXG5zdXJmYWNlQWxiZWRvPXRleHR1cmUyRChhbGJlZG9TYW1wbGVyLHZBbGJlZG9VVik7XFxuc3VyZmFjZUFsYmVkbz12ZWM0KHRvTGluZWFyU3BhY2Uoc3VyZmFjZUFsYmVkby5yZ2IpLHN1cmZhY2VBbGJlZG8uYSk7XFxuI2lmbmRlZiBMSU5LUkVGUkFDVElPTlRPVFJBTlNQQVJFTkNZXFxuI2lmZGVmIEFMUEhBVEVTVFxcbmlmIChzdXJmYWNlQWxiZWRvLmE8MC40KVxcbmRpc2NhcmQ7XFxuI2VuZGlmXFxuI2VuZGlmXFxuI2lmZGVmIEFMUEhBRlJPTUFMQkVET1xcbmFscGhhKj1zdXJmYWNlQWxiZWRvLmE7XFxuI2VuZGlmXFxuc3VyZmFjZUFsYmVkby5yZ2IqPXZBbGJlZG9JbmZvcy55O1xcbiNlbHNlXFxuXFxuc3VyZmFjZUFsYmVkby5yZ2I9c3VyZmFjZUFsYmVkb0NvbnRyaWJ1dGlvbjtcXG5zdXJmYWNlQWxiZWRvQ29udHJpYnV0aW9uPXZlYzMoMS4sMS4sMS4pO1xcbiNlbmRpZlxcbiNpZmRlZiBWRVJURVhDT0xPUlxcbnN1cmZhY2VBbGJlZG8ucmdiKj12Q29sb3IucmdiO1xcbiNlbmRpZlxcbiNpZmRlZiBPVkVSTE9BREVEVkFMVUVTXFxuc3VyZmFjZUFsYmVkby5yZ2I9bWl4KHN1cmZhY2VBbGJlZG8ucmdiLHZPdmVybG9hZGVkQWxiZWRvLHZPdmVybG9hZGVkSW50ZW5zaXR5LnkpO1xcbiNlbmRpZlxcblxcbiNpZmRlZiBOT1JNQUxcXG52ZWMzIG5vcm1hbFc9bm9ybWFsaXplKHZOb3JtYWxXKTtcXG4jZWxzZVxcbnZlYzMgbm9ybWFsVz12ZWMzKDEuMCwxLjAsMS4wKTtcXG4jZW5kaWZcXG4jaW5jbHVkZTxidW1wRnJhZ21lbnQ+XFxuXFxudmVjMyBhbWJpZW50Q29sb3I9dmVjMygxLiwxLiwxLik7XFxuI2lmZGVmIEFNQklFTlRcXG5hbWJpZW50Q29sb3I9dGV4dHVyZTJEKGFtYmllbnRTYW1wbGVyLHZBbWJpZW50VVYpLnJnYip2QW1iaWVudEluZm9zLnk7XFxuI2lmZGVmIE9WRVJMT0FERURWQUxVRVNcXG5hbWJpZW50Q29sb3IucmdiPW1peChhbWJpZW50Q29sb3IucmdiLHZPdmVybG9hZGVkQW1iaWVudCx2T3ZlcmxvYWRlZEludGVuc2l0eS54KTtcXG4jZW5kaWZcXG4jZW5kaWZcXG5cXG5mbG9hdCBtaWNyb1N1cmZhY2U9dlJlZmxlY3Rpdml0eUNvbG9yLmE7XFxudmVjMyBzdXJmYWNlUmVmbGVjdGl2aXR5Q29sb3I9dlJlZmxlY3Rpdml0eUNvbG9yLnJnYjtcXG4jaWZkZWYgT1ZFUkxPQURFRFZBTFVFU1xcbnN1cmZhY2VSZWZsZWN0aXZpdHlDb2xvci5yZ2I9bWl4KHN1cmZhY2VSZWZsZWN0aXZpdHlDb2xvci5yZ2Isdk92ZXJsb2FkZWRSZWZsZWN0aXZpdHksdk92ZXJsb2FkZWRJbnRlbnNpdHkueik7XFxuI2VuZGlmXFxuI2lmZGVmIFJFRkxFQ1RJVklUWVxcbnZlYzQgc3VyZmFjZVJlZmxlY3Rpdml0eUNvbG9yTWFwPXRleHR1cmUyRChyZWZsZWN0aXZpdHlTYW1wbGVyLHZSZWZsZWN0aXZpdHlVVik7XFxuc3VyZmFjZVJlZmxlY3Rpdml0eUNvbG9yPXN1cmZhY2VSZWZsZWN0aXZpdHlDb2xvck1hcC5yZ2I7XFxuc3VyZmFjZVJlZmxlY3Rpdml0eUNvbG9yPXRvTGluZWFyU3BhY2Uoc3VyZmFjZVJlZmxlY3Rpdml0eUNvbG9yKTtcXG4jaWZkZWYgT1ZFUkxPQURFRFZBTFVFU1xcbnN1cmZhY2VSZWZsZWN0aXZpdHlDb2xvcj1taXgoc3VyZmFjZVJlZmxlY3Rpdml0eUNvbG9yLHZPdmVybG9hZGVkUmVmbGVjdGl2aXR5LHZPdmVybG9hZGVkSW50ZW5zaXR5LnopO1xcbiNlbmRpZlxcbiNpZmRlZiBNSUNST1NVUkZBQ0VGUk9NUkVGTEVDVElWSVRZTUFQXFxubWljcm9TdXJmYWNlPXN1cmZhY2VSZWZsZWN0aXZpdHlDb2xvck1hcC5hO1xcbiNlbHNlXFxuI2lmZGVmIE1JQ1JPU1VSRkFDRUFVVE9NQVRJQ1xcbm1pY3JvU3VyZmFjZT1jb21wdXRlRGVmYXVsdE1pY3JvU3VyZmFjZShtaWNyb1N1cmZhY2Usc3VyZmFjZVJlZmxlY3Rpdml0eUNvbG9yKTtcXG4jZW5kaWZcXG4jZW5kaWZcXG4jZW5kaWZcXG4jaWZkZWYgT1ZFUkxPQURFRFZBTFVFU1xcbm1pY3JvU3VyZmFjZT1taXgobWljcm9TdXJmYWNlLHZPdmVybG9hZGVkTWljcm9TdXJmYWNlLngsdk92ZXJsb2FkZWRNaWNyb1N1cmZhY2UueSk7XFxuI2VuZGlmXFxuXFxuZmxvYXQgTmRvdFY9bWF4KDAuMDAwMDAwMDAwMDEsZG90KG5vcm1hbFcsdmlld0RpcmVjdGlvblcpKTtcXG5cXG5taWNyb1N1cmZhY2U9Y2xhbXAobWljcm9TdXJmYWNlLDAuLDEuKSowLjk4O1xcblxcbmZsb2F0IHJvdWdobmVzcz1jbGFtcCgxLi1taWNyb1N1cmZhY2UsMC4wMDAwMDEsMS4wKTtcXG5cXG52ZWMzIGxpZ2h0RGlmZnVzZUNvbnRyaWJ1dGlvbj12ZWMzKDAuLDAuLDAuKTtcXG4jaWZkZWYgT1ZFUkxPQURFRFNIQURPV1ZBTFVFU1xcbnZlYzMgc2hhZG93ZWRPbmx5TGlnaHREaWZmdXNlQ29udHJpYnV0aW9uPXZlYzMoMS4sMS4sMS4pO1xcbiNlbmRpZlxcbiNpZmRlZiBTUEVDVUxBUlRFUk1cXG52ZWMzIGxpZ2h0U3BlY3VsYXJDb250cmlidXRpb249dmVjMygwLiwwLiwwLik7XFxuI2VuZGlmXFxuZmxvYXQgbm90U2hhZG93TGV2ZWw9MS47IFxcbmZsb2F0IE5kb3RMPS0xLjtcXG5saWdodGluZ0luZm8gaW5mbztcXG5cXG5mbG9hdCByZWZsZWN0YW5jZT1tYXgobWF4KHN1cmZhY2VSZWZsZWN0aXZpdHlDb2xvci5yLHN1cmZhY2VSZWZsZWN0aXZpdHlDb2xvci5nKSxzdXJmYWNlUmVmbGVjdGl2aXR5Q29sb3IuYik7XFxuXFxuXFxuZmxvYXQgcmVmbGVjdGFuY2U5MD1jbGFtcChyZWZsZWN0YW5jZSoyNS4wLDAuMCwxLjApO1xcbnZlYzMgc3BlY3VsYXJFbnZpcm9ubWVudFIwPXN1cmZhY2VSZWZsZWN0aXZpdHlDb2xvci5yZ2I7XFxudmVjMyBzcGVjdWxhckVudmlyb25tZW50UjkwPXZlYzMoMS4wLDEuMCwxLjApKnJlZmxlY3RhbmNlOTA7XFxuI2luY2x1ZGU8cGJyTGlnaHRGdW5jdGlvbnNDYWxsPlswLi5tYXhTaW11bHRhbmVvdXNMaWdodHNdXFxuI2lmZGVmIFNQRUNVTEFSVEVSTVxcbmxpZ2h0U3BlY3VsYXJDb250cmlidXRpb24qPXZMaWdodGluZ0ludGVuc2l0eS53O1xcbiNlbmRpZlxcbiNpZmRlZiBPUEFDSVRZXFxudmVjNCBvcGFjaXR5TWFwPXRleHR1cmUyRChvcGFjaXR5U2FtcGxlcix2T3BhY2l0eVVWKTtcXG4jaWZkZWYgT1BBQ0lUWVJHQlxcbm9wYWNpdHlNYXAucmdiPW9wYWNpdHlNYXAucmdiKnZlYzMoMC4zLDAuNTksMC4xMSk7XFxuYWxwaGEqPShvcGFjaXR5TWFwLngrb3BhY2l0eU1hcC55K29wYWNpdHlNYXAueikqIHZPcGFjaXR5SW5mb3MueTtcXG4jZWxzZVxcbmFscGhhKj1vcGFjaXR5TWFwLmEqdk9wYWNpdHlJbmZvcy55O1xcbiNlbmRpZlxcbiNlbmRpZlxcbiNpZmRlZiBWRVJURVhBTFBIQVxcbmFscGhhKj12Q29sb3IuYTtcXG4jZW5kaWZcXG4jaWZkZWYgT1BBQ0lUWUZSRVNORUxcXG5mbG9hdCBvcGFjaXR5RnJlc25lbFRlcm09Y29tcHV0ZUZyZXNuZWxUZXJtKHZpZXdEaXJlY3Rpb25XLG5vcm1hbFcsb3BhY2l0eVBhcnRzLnosb3BhY2l0eVBhcnRzLncpO1xcbmFscGhhKz1vcGFjaXR5UGFydHMueCooMS4wLW9wYWNpdHlGcmVzbmVsVGVybSkrb3BhY2l0eUZyZXNuZWxUZXJtKm9wYWNpdHlQYXJ0cy55O1xcbiNlbmRpZlxcblxcbnZlYzMgc3VyZmFjZVJlZnJhY3Rpb25Db2xvcj12ZWMzKDAuLDAuLDAuKTtcXG5cXG4jaWZkZWYgTE9EQkFTRURNSUNST1NGVVJBQ0VcXG5mbG9hdCBhbHBoYUc9Y29udmVydFJvdWdobmVzc1RvQXZlcmFnZVNsb3BlKHJvdWdobmVzcyk7XFxuI2VuZGlmXFxuI2lmZGVmIFJFRlJBQ1RJT05cXG52ZWMzIHJlZnJhY3Rpb25WZWN0b3I9cmVmcmFjdCgtdmlld0RpcmVjdGlvblcsbm9ybWFsVyx2UmVmcmFjdGlvbkluZm9zLnkpO1xcbiNpZmRlZiBMT0RCQVNFRE1JQ1JPU0ZVUkFDRVxcbiNpZmRlZiBVU0VQTVJFTVJFRlJBQ1RJT05cXG5mbG9hdCBsb2RSZWZyYWN0aW9uPWdldE1pcE1hcEluZGV4RnJvbUF2ZXJhZ2VTbG9wZVdpdGhQTVJFTSh2TWljcm9zdXJmYWNlVGV4dHVyZUxvZHMueSxhbHBoYUcpO1xcbiNlbHNlXFxuZmxvYXQgbG9kUmVmcmFjdGlvbj1nZXRNaXBNYXBJbmRleEZyb21BdmVyYWdlU2xvcGUodk1pY3Jvc3VyZmFjZVRleHR1cmVMb2RzLnksYWxwaGFHKTtcXG4jZW5kaWZcXG4jZWxzZVxcbmZsb2F0IGJpYXNSZWZyYWN0aW9uPSh2TWljcm9zdXJmYWNlVGV4dHVyZUxvZHMueSsyLikqKDEuMC1taWNyb1N1cmZhY2UpO1xcbiNlbmRpZlxcbiNpZmRlZiBSRUZSQUNUSU9OTUFQXzNEXFxucmVmcmFjdGlvblZlY3Rvci55PXJlZnJhY3Rpb25WZWN0b3IueSp2UmVmcmFjdGlvbkluZm9zLnc7XFxuaWYgKGRvdChyZWZyYWN0aW9uVmVjdG9yLHZpZXdEaXJlY3Rpb25XKTwxLjApXFxue1xcbiNpZmRlZiBMT0RCQVNFRE1JQ1JPU0ZVUkFDRVxcbiNpZmRlZiBVU0VQTVJFTVJFRlJBQ1RJT05cXG5cXG5pZiAoKHZNaWNyb3N1cmZhY2VUZXh0dXJlTG9kcy55LWxvZFJlZnJhY3Rpb24pPjQuMClcXG57XFxuXFxuZmxvYXQgc2NhbGVSZWZyYWN0aW9uPTEuLWV4cDIobG9kUmVmcmFjdGlvbikvZXhwMih2TWljcm9zdXJmYWNlVGV4dHVyZUxvZHMueSk7IFxcbmZsb2F0IG1heFJlZnJhY3Rpb249bWF4KG1heChhYnMocmVmcmFjdGlvblZlY3Rvci54KSxhYnMocmVmcmFjdGlvblZlY3Rvci55KSksYWJzKHJlZnJhY3Rpb25WZWN0b3IueikpO1xcbmlmIChhYnMocmVmcmFjdGlvblZlY3Rvci54KSAhPSBtYXhSZWZyYWN0aW9uKSByZWZyYWN0aW9uVmVjdG9yLngqPXNjYWxlUmVmcmFjdGlvbjtcXG5pZiAoYWJzKHJlZnJhY3Rpb25WZWN0b3IueSkgIT0gbWF4UmVmcmFjdGlvbikgcmVmcmFjdGlvblZlY3Rvci55Kj1zY2FsZVJlZnJhY3Rpb247XFxuaWYgKGFicyhyZWZyYWN0aW9uVmVjdG9yLnopICE9IG1heFJlZnJhY3Rpb24pIHJlZnJhY3Rpb25WZWN0b3Iueio9c2NhbGVSZWZyYWN0aW9uO1xcbn1cXG4jZW5kaWZcXG5zdXJmYWNlUmVmcmFjdGlvbkNvbG9yPXRleHR1cmVDdWJlTG9kRVhUKHJlZnJhY3Rpb25DdWJlU2FtcGxlcixyZWZyYWN0aW9uVmVjdG9yLGxvZFJlZnJhY3Rpb24pLnJnYip2UmVmcmFjdGlvbkluZm9zLng7XFxuI2Vsc2VcXG5zdXJmYWNlUmVmcmFjdGlvbkNvbG9yPXRleHR1cmVDdWJlKHJlZnJhY3Rpb25DdWJlU2FtcGxlcixyZWZyYWN0aW9uVmVjdG9yLGJpYXNSZWZyYWN0aW9uKS5yZ2IqdlJlZnJhY3Rpb25JbmZvcy54O1xcbiNlbmRpZlxcbn1cXG4jaWZuZGVmIFJFRlJBQ1RJT05NQVBJTkxJTkVBUlNQQUNFXFxuc3VyZmFjZVJlZnJhY3Rpb25Db2xvcj10b0xpbmVhclNwYWNlKHN1cmZhY2VSZWZyYWN0aW9uQ29sb3IucmdiKTtcXG4jZW5kaWZcXG4jZWxzZVxcbnZlYzMgdlJlZnJhY3Rpb25VVlc9dmVjMyhyZWZyYWN0aW9uTWF0cml4Kih2aWV3KnZlYzQodlBvc2l0aW9uVytyZWZyYWN0aW9uVmVjdG9yKnZSZWZyYWN0aW9uSW5mb3MueiwxLjApKSk7XFxudmVjMiByZWZyYWN0aW9uQ29vcmRzPXZSZWZyYWN0aW9uVVZXLnh5L3ZSZWZyYWN0aW9uVVZXLno7XFxucmVmcmFjdGlvbkNvb3Jkcy55PTEuMC1yZWZyYWN0aW9uQ29vcmRzLnk7XFxuI2lmZGVmIExPREJBU0VETUlDUk9TRlVSQUNFXFxuc3VyZmFjZVJlZnJhY3Rpb25Db2xvcj10ZXh0dXJlMkRMb2RFWFQocmVmcmFjdGlvbjJEU2FtcGxlcixyZWZyYWN0aW9uQ29vcmRzLGxvZFJlZnJhY3Rpb24pLnJnYip2UmVmcmFjdGlvbkluZm9zLng7XFxuI2Vsc2VcXG5zdXJmYWNlUmVmcmFjdGlvbkNvbG9yPXRleHR1cmUyRChyZWZyYWN0aW9uMkRTYW1wbGVyLHJlZnJhY3Rpb25Db29yZHMsYmlhc1JlZnJhY3Rpb24pLnJnYip2UmVmcmFjdGlvbkluZm9zLng7XFxuI2VuZGlmIFxcbnN1cmZhY2VSZWZyYWN0aW9uQ29sb3I9dG9MaW5lYXJTcGFjZShzdXJmYWNlUmVmcmFjdGlvbkNvbG9yLnJnYik7XFxuI2VuZGlmXFxuI2VuZGlmXFxuXFxudmVjMyBlbnZpcm9ubWVudFJhZGlhbmNlPXZSZWZsZWN0aW9uQ29sb3IucmdiO1xcbnZlYzMgZW52aXJvbm1lbnRJcnJhZGlhbmNlPXZSZWZsZWN0aW9uQ29sb3IucmdiO1xcbiNpZmRlZiBSRUZMRUNUSU9OXFxudmVjMyB2UmVmbGVjdGlvblVWVz1jb21wdXRlUmVmbGVjdGlvbkNvb3Jkcyh2ZWM0KHZQb3NpdGlvblcsMS4wKSxub3JtYWxXKTtcXG4jaWZkZWYgTE9EQkFTRURNSUNST1NGVVJBQ0VcXG4jaWZkZWYgVVNFUE1SRU1SRUZMRUNUSU9OXFxuZmxvYXQgbG9kUmVmbGVjdGlvbj1nZXRNaXBNYXBJbmRleEZyb21BdmVyYWdlU2xvcGVXaXRoUE1SRU0odk1pY3Jvc3VyZmFjZVRleHR1cmVMb2RzLngsYWxwaGFHKTtcXG4jZWxzZVxcbmZsb2F0IGxvZFJlZmxlY3Rpb249Z2V0TWlwTWFwSW5kZXhGcm9tQXZlcmFnZVNsb3BlKHZNaWNyb3N1cmZhY2VUZXh0dXJlTG9kcy54LGFscGhhRyk7XFxuI2VuZGlmXFxuI2Vsc2VcXG5mbG9hdCBiaWFzUmVmbGVjdGlvbj0odk1pY3Jvc3VyZmFjZVRleHR1cmVMb2RzLngrMi4pKigxLjAtbWljcm9TdXJmYWNlKTtcXG4jZW5kaWZcXG4jaWZkZWYgUkVGTEVDVElPTk1BUF8zRFxcbiNpZmRlZiBMT0RCQVNFRE1JQ1JPU0ZVUkFDRVxcbiNpZmRlZiBVU0VQTVJFTVJFRkxFQ1RJT05cXG5cXG5pZiAoKHZNaWNyb3N1cmZhY2VUZXh0dXJlTG9kcy55LWxvZFJlZmxlY3Rpb24pPjQuMClcXG57XFxuXFxuZmxvYXQgc2NhbGVSZWZsZWN0aW9uPTEuLWV4cDIobG9kUmVmbGVjdGlvbikvZXhwMih2TWljcm9zdXJmYWNlVGV4dHVyZUxvZHMueCk7IFxcbmZsb2F0IG1heFJlZmxlY3Rpb249bWF4KG1heChhYnModlJlZmxlY3Rpb25VVlcueCksYWJzKHZSZWZsZWN0aW9uVVZXLnkpKSxhYnModlJlZmxlY3Rpb25VVlcueikpO1xcbmlmIChhYnModlJlZmxlY3Rpb25VVlcueCkgIT0gbWF4UmVmbGVjdGlvbikgdlJlZmxlY3Rpb25VVlcueCo9c2NhbGVSZWZsZWN0aW9uO1xcbmlmIChhYnModlJlZmxlY3Rpb25VVlcueSkgIT0gbWF4UmVmbGVjdGlvbikgdlJlZmxlY3Rpb25VVlcueSo9c2NhbGVSZWZsZWN0aW9uO1xcbmlmIChhYnModlJlZmxlY3Rpb25VVlcueikgIT0gbWF4UmVmbGVjdGlvbikgdlJlZmxlY3Rpb25VVlcueio9c2NhbGVSZWZsZWN0aW9uO1xcbn1cXG4jZW5kaWZcXG5lbnZpcm9ubWVudFJhZGlhbmNlPXRleHR1cmVDdWJlTG9kRVhUKHJlZmxlY3Rpb25DdWJlU2FtcGxlcix2UmVmbGVjdGlvblVWVyxsb2RSZWZsZWN0aW9uKS5yZ2IqdlJlZmxlY3Rpb25JbmZvcy54O1xcbiNlbHNlXFxuZW52aXJvbm1lbnRSYWRpYW5jZT10ZXh0dXJlQ3ViZShyZWZsZWN0aW9uQ3ViZVNhbXBsZXIsdlJlZmxlY3Rpb25VVlcsYmlhc1JlZmxlY3Rpb24pLnJnYip2UmVmbGVjdGlvbkluZm9zLng7XFxuI2VuZGlmXFxuI2lmZGVmIFVTRVNQSEVSSUNBTEZST01SRUZMRUNUSU9OTUFQXFxuI2lmbmRlZiBSRUZMRUNUSU9OTUFQX1NLWUJPWFxcbnZlYzMgbm9ybWFsRW52aXJvbm1lbnRTcGFjZT0ocmVmbGVjdGlvbk1hdHJpeCp2ZWM0KG5vcm1hbFcsMSkpLnh5ejtcXG5lbnZpcm9ubWVudElycmFkaWFuY2U9RW52aXJvbm1lbnRJcnJhZGlhbmNlKG5vcm1hbEVudmlyb25tZW50U3BhY2UpO1xcbiNlbmRpZlxcbiNlbHNlXFxuZW52aXJvbm1lbnRSYWRpYW5jZT10b0xpbmVhclNwYWNlKGVudmlyb25tZW50UmFkaWFuY2UucmdiKTtcXG5lbnZpcm9ubWVudElycmFkaWFuY2U9dGV4dHVyZUN1YmUocmVmbGVjdGlvbkN1YmVTYW1wbGVyLG5vcm1hbFcsMjAuKS5yZ2IqdlJlZmxlY3Rpb25JbmZvcy54O1xcbmVudmlyb25tZW50SXJyYWRpYW5jZT10b0xpbmVhclNwYWNlKGVudmlyb25tZW50SXJyYWRpYW5jZS5yZ2IpO1xcbmVudmlyb25tZW50SXJyYWRpYW5jZSo9MC4yOyBcXG4jZW5kaWZcXG4jZWxzZVxcbnZlYzIgY29vcmRzPXZSZWZsZWN0aW9uVVZXLnh5O1xcbiNpZmRlZiBSRUZMRUNUSU9OTUFQX1BST0pFQ1RJT05cXG5jb29yZHMvPXZSZWZsZWN0aW9uVVZXLno7XFxuI2VuZGlmXFxuY29vcmRzLnk9MS4wLWNvb3Jkcy55O1xcbiNpZmRlZiBMT0RCQVNFRE1JQ1JPU0ZVUkFDRVxcbmVudmlyb25tZW50UmFkaWFuY2U9dGV4dHVyZTJETG9kRVhUKHJlZmxlY3Rpb24yRFNhbXBsZXIsY29vcmRzLGxvZFJlZmxlY3Rpb24pLnJnYip2UmVmbGVjdGlvbkluZm9zLng7XFxuI2Vsc2VcXG5lbnZpcm9ubWVudFJhZGlhbmNlPXRleHR1cmUyRChyZWZsZWN0aW9uMkRTYW1wbGVyLGNvb3JkcyxiaWFzUmVmbGVjdGlvbikucmdiKnZSZWZsZWN0aW9uSW5mb3MueDtcXG4jZW5kaWZcXG5lbnZpcm9ubWVudFJhZGlhbmNlPXRvTGluZWFyU3BhY2UoZW52aXJvbm1lbnRSYWRpYW5jZS5yZ2IpO1xcbmVudmlyb25tZW50SXJyYWRpYW5jZT10ZXh0dXJlMkQocmVmbGVjdGlvbjJEU2FtcGxlcixjb29yZHMsMjAuKS5yZ2IqdlJlZmxlY3Rpb25JbmZvcy54O1xcbmVudmlyb25tZW50SXJyYWRpYW5jZT10b0xpbmVhclNwYWNlKGVudmlyb25tZW50SXJyYWRpYW5jZS5yZ2IpO1xcbiNlbmRpZlxcbiNlbmRpZlxcbiNpZmRlZiBPVkVSTE9BREVEVkFMVUVTXFxuZW52aXJvbm1lbnRJcnJhZGlhbmNlPW1peChlbnZpcm9ubWVudElycmFkaWFuY2Usdk92ZXJsb2FkZWRSZWZsZWN0aW9uLHZPdmVybG9hZGVkTWljcm9TdXJmYWNlLnopO1xcbmVudmlyb25tZW50UmFkaWFuY2U9bWl4KGVudmlyb25tZW50UmFkaWFuY2Usdk92ZXJsb2FkZWRSZWZsZWN0aW9uLHZPdmVybG9hZGVkTWljcm9TdXJmYWNlLnopO1xcbiNlbmRpZlxcbmVudmlyb25tZW50UmFkaWFuY2UqPXZMaWdodGluZ0ludGVuc2l0eS56O1xcbmVudmlyb25tZW50SXJyYWRpYW5jZSo9dkxpZ2h0aW5nSW50ZW5zaXR5Lno7XFxuXFxudmVjMyBzcGVjdWxhckVudmlyb25tZW50UmVmbGVjdGFuY2U9RnJlc25lbFNjaGxpY2tFbnZpcm9ubWVudEdHWChjbGFtcChOZG90ViwwLiwxLiksc3BlY3VsYXJFbnZpcm9ubWVudFIwLHNwZWN1bGFyRW52aXJvbm1lbnRSOTAsc3FydChtaWNyb1N1cmZhY2UpKTtcXG5cXG52ZWMzIHJlZnJhY3RhbmNlPXZlYzMoMC4wLDAuMCwwLjApO1xcbiNpZmRlZiBSRUZSQUNUSU9OXFxudmVjMyB0cmFuc21pc3Npb249dmVjMygxLjAsMS4wLDEuMCk7XFxuI2lmZGVmIExJTktSRUZSQUNUSU9OVE9UUkFOU1BBUkVOQ1lcXG5cXG50cmFuc21pc3Npb24qPSgxLjAtYWxwaGEpO1xcblxcblxcbnZlYzMgbWl4ZWRBbGJlZG89c3VyZmFjZUFsYmVkb0NvbnRyaWJ1dGlvbi5yZ2Iqc3VyZmFjZUFsYmVkby5yZ2I7XFxuZmxvYXQgbWF4Q2hhbm5lbD1tYXgobWF4KG1peGVkQWxiZWRvLnIsbWl4ZWRBbGJlZG8uZyksbWl4ZWRBbGJlZG8uYik7XFxudmVjMyB0aW50PWNsYW1wKG1heENoYW5uZWwqbWl4ZWRBbGJlZG8sMC4wLDEuMCk7XFxuXFxuc3VyZmFjZUFsYmVkb0NvbnRyaWJ1dGlvbio9YWxwaGE7XFxuXFxuZW52aXJvbm1lbnRJcnJhZGlhbmNlKj1hbHBoYTtcXG5cXG5zdXJmYWNlUmVmcmFjdGlvbkNvbG9yKj10aW50O1xcblxcbmFscGhhPTEuMDtcXG4jZW5kaWZcXG5cXG52ZWMzIGJvdW5jZVNwZWN1bGFyRW52aXJvbm1lbnRSZWZsZWN0YW5jZT0oMi4wKnNwZWN1bGFyRW52aXJvbm1lbnRSZWZsZWN0YW5jZSkvKDEuMCtzcGVjdWxhckVudmlyb25tZW50UmVmbGVjdGFuY2UpO1xcbnNwZWN1bGFyRW52aXJvbm1lbnRSZWZsZWN0YW5jZT1taXgoYm91bmNlU3BlY3VsYXJFbnZpcm9ubWVudFJlZmxlY3RhbmNlLHNwZWN1bGFyRW52aXJvbm1lbnRSZWZsZWN0YW5jZSxhbHBoYSk7XFxuXFxudHJhbnNtaXNzaW9uKj0xLjAtc3BlY3VsYXJFbnZpcm9ubWVudFJlZmxlY3RhbmNlO1xcblxcbnJlZnJhY3RhbmNlPXN1cmZhY2VSZWZyYWN0aW9uQ29sb3IqdHJhbnNtaXNzaW9uO1xcbiNlbmRpZlxcblxcbnN1cmZhY2VBbGJlZG8ucmdiPSgxLi1yZWZsZWN0YW5jZSkqc3VyZmFjZUFsYmVkby5yZ2I7XFxucmVmcmFjdGFuY2UqPXZMaWdodGluZ0ludGVuc2l0eS56O1xcbmVudmlyb25tZW50UmFkaWFuY2UqPXNwZWN1bGFyRW52aXJvbm1lbnRSZWZsZWN0YW5jZTtcXG5cXG52ZWMzIHN1cmZhY2VFbWlzc2l2ZUNvbG9yPXZFbWlzc2l2ZUNvbG9yO1xcbiNpZmRlZiBFTUlTU0lWRVxcbnZlYzMgZW1pc3NpdmVDb2xvclRleD10ZXh0dXJlMkQoZW1pc3NpdmVTYW1wbGVyLHZFbWlzc2l2ZVVWKS5yZ2I7XFxuc3VyZmFjZUVtaXNzaXZlQ29sb3I9dG9MaW5lYXJTcGFjZShlbWlzc2l2ZUNvbG9yVGV4LnJnYikqc3VyZmFjZUVtaXNzaXZlQ29sb3IqdkVtaXNzaXZlSW5mb3MueTtcXG4jZW5kaWZcXG4jaWZkZWYgT1ZFUkxPQURFRFZBTFVFU1xcbnN1cmZhY2VFbWlzc2l2ZUNvbG9yPW1peChzdXJmYWNlRW1pc3NpdmVDb2xvcix2T3ZlcmxvYWRlZEVtaXNzaXZlLHZPdmVybG9hZGVkSW50ZW5zaXR5LncpO1xcbiNlbmRpZlxcbiNpZmRlZiBFTUlTU0lWRUZSRVNORUxcXG5mbG9hdCBlbWlzc2l2ZUZyZXNuZWxUZXJtPWNvbXB1dGVGcmVzbmVsVGVybSh2aWV3RGlyZWN0aW9uVyxub3JtYWxXLGVtaXNzaXZlUmlnaHRDb2xvci5hLGVtaXNzaXZlTGVmdENvbG9yLmEpO1xcbnN1cmZhY2VFbWlzc2l2ZUNvbG9yKj1lbWlzc2l2ZUxlZnRDb2xvci5yZ2IqKDEuMC1lbWlzc2l2ZUZyZXNuZWxUZXJtKStlbWlzc2l2ZUZyZXNuZWxUZXJtKmVtaXNzaXZlUmlnaHRDb2xvci5yZ2I7XFxuI2VuZGlmXFxuXFxuI2lmZGVmIEVNSVNTSVZFQVNJTExVTUlOQVRJT05cXG52ZWMzIGZpbmFsRGlmZnVzZT1tYXgobGlnaHREaWZmdXNlQ29udHJpYnV0aW9uKnN1cmZhY2VBbGJlZG9Db250cmlidXRpb24rdkFtYmllbnRDb2xvciwwLjApKnN1cmZhY2VBbGJlZG8ucmdiO1xcbiNpZmRlZiBPVkVSTE9BREVEU0hBRE9XVkFMVUVTXFxuc2hhZG93ZWRPbmx5TGlnaHREaWZmdXNlQ29udHJpYnV0aW9uPW1heChzaGFkb3dlZE9ubHlMaWdodERpZmZ1c2VDb250cmlidXRpb24qc3VyZmFjZUFsYmVkb0NvbnRyaWJ1dGlvbit2QW1iaWVudENvbG9yLDAuMCkqc3VyZmFjZUFsYmVkby5yZ2I7XFxuI2VuZGlmXFxuI2Vsc2VcXG4jaWZkZWYgTElOS0VNSVNTSVZFV0lUSEFMQkVET1xcbnZlYzMgZmluYWxEaWZmdXNlPW1heCgobGlnaHREaWZmdXNlQ29udHJpYnV0aW9uK3N1cmZhY2VFbWlzc2l2ZUNvbG9yKSpzdXJmYWNlQWxiZWRvQ29udHJpYnV0aW9uK3ZBbWJpZW50Q29sb3IsMC4wKSpzdXJmYWNlQWxiZWRvLnJnYjtcXG4jaWZkZWYgT1ZFUkxPQURFRFNIQURPV1ZBTFVFU1xcbnNoYWRvd2VkT25seUxpZ2h0RGlmZnVzZUNvbnRyaWJ1dGlvbj1tYXgoKHNoYWRvd2VkT25seUxpZ2h0RGlmZnVzZUNvbnRyaWJ1dGlvbitzdXJmYWNlRW1pc3NpdmVDb2xvcikqc3VyZmFjZUFsYmVkb0NvbnRyaWJ1dGlvbit2QW1iaWVudENvbG9yLDAuMCkqc3VyZmFjZUFsYmVkby5yZ2I7XFxuI2VuZGlmXFxuI2Vsc2VcXG52ZWMzIGZpbmFsRGlmZnVzZT1tYXgobGlnaHREaWZmdXNlQ29udHJpYnV0aW9uKnN1cmZhY2VBbGJlZG9Db250cmlidXRpb24rc3VyZmFjZUVtaXNzaXZlQ29sb3IrdkFtYmllbnRDb2xvciwwLjApKnN1cmZhY2VBbGJlZG8ucmdiO1xcbiNpZmRlZiBPVkVSTE9BREVEU0hBRE9XVkFMVUVTXFxuc2hhZG93ZWRPbmx5TGlnaHREaWZmdXNlQ29udHJpYnV0aW9uPW1heChzaGFkb3dlZE9ubHlMaWdodERpZmZ1c2VDb250cmlidXRpb24qc3VyZmFjZUFsYmVkb0NvbnRyaWJ1dGlvbitzdXJmYWNlRW1pc3NpdmVDb2xvcit2QW1iaWVudENvbG9yLDAuMCkqc3VyZmFjZUFsYmVkby5yZ2I7XFxuI2VuZGlmXFxuI2VuZGlmXFxuI2VuZGlmXFxuI2lmZGVmIE9WRVJMT0FERURTSEFET1dWQUxVRVNcXG5maW5hbERpZmZ1c2U9bWl4KGZpbmFsRGlmZnVzZSxzaGFkb3dlZE9ubHlMaWdodERpZmZ1c2VDb250cmlidXRpb24sKDEuMC12T3ZlcmxvYWRlZFNoYWRvd0ludGVuc2l0eS55KSk7XFxuI2VuZGlmXFxuI2lmZGVmIFNQRUNVTEFSVEVSTVxcbnZlYzMgZmluYWxTcGVjdWxhcj1saWdodFNwZWN1bGFyQ29udHJpYnV0aW9uKnN1cmZhY2VSZWZsZWN0aXZpdHlDb2xvcjtcXG4jZWxzZVxcbnZlYzMgZmluYWxTcGVjdWxhcj12ZWMzKDAuMCk7XFxuI2VuZGlmXFxuI2lmZGVmIFNQRUNVTEFST1ZFUkFMUEhBXFxuYWxwaGE9Y2xhbXAoYWxwaGErZ2V0THVtaW5hbmNlKGZpbmFsU3BlY3VsYXIpLDAuLDEuKTtcXG4jZW5kaWZcXG4jaWZkZWYgUkFESUFOQ0VPVkVSQUxQSEFcXG5hbHBoYT1jbGFtcChhbHBoYStnZXRMdW1pbmFuY2UoZW52aXJvbm1lbnRSYWRpYW5jZSksMC4sMS4pO1xcbiNlbmRpZlxcblxcblxcbiNpZmRlZiBFTUlTU0lWRUFTSUxMVU1JTkFUSU9OXFxudmVjNCBmaW5hbENvbG9yPXZlYzQoZmluYWxEaWZmdXNlKmFtYmllbnRDb2xvcip2TGlnaHRpbmdJbnRlbnNpdHkueCtzdXJmYWNlQWxiZWRvLnJnYiplbnZpcm9ubWVudElycmFkaWFuY2UrZmluYWxTcGVjdWxhcip2TGlnaHRpbmdJbnRlbnNpdHkueCtlbnZpcm9ubWVudFJhZGlhbmNlK3N1cmZhY2VFbWlzc2l2ZUNvbG9yKnZMaWdodGluZ0ludGVuc2l0eS55K3JlZnJhY3RhbmNlLGFscGhhKTtcXG4jZWxzZVxcbnZlYzQgZmluYWxDb2xvcj12ZWM0KGZpbmFsRGlmZnVzZSphbWJpZW50Q29sb3IqdkxpZ2h0aW5nSW50ZW5zaXR5Lngrc3VyZmFjZUFsYmVkby5yZ2IqZW52aXJvbm1lbnRJcnJhZGlhbmNlK2ZpbmFsU3BlY3VsYXIqdkxpZ2h0aW5nSW50ZW5zaXR5LngrZW52aXJvbm1lbnRSYWRpYW5jZStyZWZyYWN0YW5jZSxhbHBoYSk7XFxuI2VuZGlmXFxuI2lmZGVmIExJR0hUTUFQXFxudmVjMyBsaWdodG1hcENvbG9yPXRleHR1cmUyRChsaWdodG1hcFNhbXBsZXIsdkxpZ2h0bWFwVVYpLnJnYip2TGlnaHRtYXBJbmZvcy55O1xcbiNpZmRlZiBVU0VMSUdIVE1BUEFTU0hBRE9XTUFQXFxuZmluYWxDb2xvci5yZ2IqPWxpZ2h0bWFwQ29sb3I7XFxuI2Vsc2VcXG5maW5hbENvbG9yLnJnYis9bGlnaHRtYXBDb2xvcjtcXG4jZW5kaWZcXG4jZW5kaWZcXG5maW5hbENvbG9yPW1heChmaW5hbENvbG9yLDAuMCk7XFxuI2lmZGVmIENBTUVSQVRPTkVNQVBcXG5maW5hbENvbG9yLnJnYj10b25lTWFwcyhmaW5hbENvbG9yLnJnYik7XFxuI2VuZGlmXFxuZmluYWxDb2xvci5yZ2I9dG9HYW1tYVNwYWNlKGZpbmFsQ29sb3IucmdiKTtcXG4jaW5jbHVkZTxsb2dEZXB0aEZyYWdtZW50PlxcbiNpbmNsdWRlPGZvZ0ZyYWdtZW50Pihjb2xvcixmaW5hbENvbG9yKVxcbiNpZmRlZiBDQU1FUkFDT05UUkFTVFxcbmZpbmFsQ29sb3I9Y29udHJhc3RzKGZpbmFsQ29sb3IpO1xcbiNlbmRpZlxcbmZpbmFsQ29sb3IucmdiPWNsYW1wKGZpbmFsQ29sb3IucmdiLDAuLDEuKTtcXG4jaWZkZWYgQ0FNRVJBQ09MT1JHUkFESU5HXFxuZmluYWxDb2xvcj1jb2xvckdyYWRlcyhmaW5hbENvbG9yKTtcXG4jZW5kaWZcXG4jaWZkZWYgQ0FNRVJBQ09MT1JDVVJWRVNcXG5maW5hbENvbG9yLnJnYj1hcHBseUNvbG9yQ3VydmVzKGZpbmFsQ29sb3IucmdiKTtcXG4jZW5kaWZcXG5cXG5cXG5cXG5cXG5cXG5cXG5cXG5cXG5cXG5cXG5cXG5cXG5cXG5cXG5cXG5cXG5cXG5cXG5cXG5nbF9GcmFnQ29sb3I9ZmluYWxDb2xvcjtcXG59XCIscGJyVmVydGV4U2hhZGVyOlwicHJlY2lzaW9uIGhpZ2hwIGZsb2F0O1xcblxcbmF0dHJpYnV0ZSB2ZWMzIHBvc2l0aW9uO1xcbiNpZmRlZiBOT1JNQUxcXG5hdHRyaWJ1dGUgdmVjMyBub3JtYWw7XFxuI2VuZGlmXFxuI2lmZGVmIFVWMVxcbmF0dHJpYnV0ZSB2ZWMyIHV2O1xcbiNlbmRpZlxcbiNpZmRlZiBVVjJcXG5hdHRyaWJ1dGUgdmVjMiB1djI7XFxuI2VuZGlmXFxuI2lmZGVmIFZFUlRFWENPTE9SXFxuYXR0cmlidXRlIHZlYzQgY29sb3I7XFxuI2VuZGlmXFxuI2luY2x1ZGU8Ym9uZXNEZWNsYXJhdGlvbj5cXG5cXG4jaW5jbHVkZTxpbnN0YW5jZXNEZWNsYXJhdGlvbj5cXG51bmlmb3JtIG1hdDQgdmlldztcXG51bmlmb3JtIG1hdDQgdmlld1Byb2plY3Rpb247XFxuI2lmZGVmIEFMQkVET1xcbnZhcnlpbmcgdmVjMiB2QWxiZWRvVVY7XFxudW5pZm9ybSBtYXQ0IGFsYmVkb01hdHJpeDtcXG51bmlmb3JtIHZlYzIgdkFsYmVkb0luZm9zO1xcbiNlbmRpZlxcbiNpZmRlZiBBTUJJRU5UXFxudmFyeWluZyB2ZWMyIHZBbWJpZW50VVY7XFxudW5pZm9ybSBtYXQ0IGFtYmllbnRNYXRyaXg7XFxudW5pZm9ybSB2ZWMyIHZBbWJpZW50SW5mb3M7XFxuI2VuZGlmXFxuI2lmZGVmIE9QQUNJVFlcXG52YXJ5aW5nIHZlYzIgdk9wYWNpdHlVVjtcXG51bmlmb3JtIG1hdDQgb3BhY2l0eU1hdHJpeDtcXG51bmlmb3JtIHZlYzIgdk9wYWNpdHlJbmZvcztcXG4jZW5kaWZcXG4jaWZkZWYgRU1JU1NJVkVcXG52YXJ5aW5nIHZlYzIgdkVtaXNzaXZlVVY7XFxudW5pZm9ybSB2ZWMyIHZFbWlzc2l2ZUluZm9zO1xcbnVuaWZvcm0gbWF0NCBlbWlzc2l2ZU1hdHJpeDtcXG4jZW5kaWZcXG4jaWZkZWYgTElHSFRNQVBcXG52YXJ5aW5nIHZlYzIgdkxpZ2h0bWFwVVY7XFxudW5pZm9ybSB2ZWMyIHZMaWdodG1hcEluZm9zO1xcbnVuaWZvcm0gbWF0NCBsaWdodG1hcE1hdHJpeDtcXG4jZW5kaWZcXG4jaWYgZGVmaW5lZChSRUZMRUNUSVZJVFkpXFxudmFyeWluZyB2ZWMyIHZSZWZsZWN0aXZpdHlVVjtcXG51bmlmb3JtIHZlYzIgdlJlZmxlY3Rpdml0eUluZm9zO1xcbnVuaWZvcm0gbWF0NCByZWZsZWN0aXZpdHlNYXRyaXg7XFxuI2VuZGlmXFxuI2lmZGVmIEJVTVBcXG52YXJ5aW5nIHZlYzIgdkJ1bXBVVjtcXG51bmlmb3JtIHZlYzMgdkJ1bXBJbmZvcztcXG51bmlmb3JtIG1hdDQgYnVtcE1hdHJpeDtcXG4jZW5kaWZcXG4jaWZkZWYgUE9JTlRTSVpFXFxudW5pZm9ybSBmbG9hdCBwb2ludFNpemU7XFxuI2VuZGlmXFxuXFxudmFyeWluZyB2ZWMzIHZQb3NpdGlvblc7XFxuI2lmZGVmIE5PUk1BTFxcbnZhcnlpbmcgdmVjMyB2Tm9ybWFsVztcXG4jZW5kaWZcXG4jaWZkZWYgVkVSVEVYQ09MT1JcXG52YXJ5aW5nIHZlYzQgdkNvbG9yO1xcbiNlbmRpZlxcbiNpbmNsdWRlPGNsaXBQbGFuZVZlcnRleERlY2xhcmF0aW9uPlxcbiNpbmNsdWRlPGZvZ1ZlcnRleERlY2xhcmF0aW9uPlxcbiNpbmNsdWRlPHNoYWRvd3NWZXJ0ZXhEZWNsYXJhdGlvbj5bMC4ubWF4U2ltdWx0YW5lb3VzTGlnaHRzXVxcbiNpZmRlZiBSRUZMRUNUSU9OTUFQX1NLWUJPWFxcbnZhcnlpbmcgdmVjMyB2UG9zaXRpb25VVlc7XFxuI2VuZGlmXFxuI2lmZGVmIFJFRkxFQ1RJT05NQVBfRVFVSVJFQ1RBTkdVTEFSX0ZJWEVEXFxudmFyeWluZyB2ZWMzIHZEaXJlY3Rpb25XO1xcbiNlbmRpZlxcbiNpbmNsdWRlPGxvZ0RlcHRoRGVjbGFyYXRpb24+XFxudm9pZCBtYWluKHZvaWQpIHtcXG4jaWZkZWYgUkVGTEVDVElPTk1BUF9TS1lCT1hcXG52UG9zaXRpb25VVlc9cG9zaXRpb247XFxuI2VuZGlmIFxcbiNpbmNsdWRlPGluc3RhbmNlc1ZlcnRleD5cXG4jaW5jbHVkZTxib25lc1ZlcnRleD5cXG5nbF9Qb3NpdGlvbj12aWV3UHJvamVjdGlvbipmaW5hbFdvcmxkKnZlYzQocG9zaXRpb24sMS4wKTtcXG52ZWM0IHdvcmxkUG9zPWZpbmFsV29ybGQqdmVjNChwb3NpdGlvbiwxLjApO1xcbnZQb3NpdGlvblc9dmVjMyh3b3JsZFBvcyk7XFxuI2lmZGVmIE5PUk1BTFxcbnZOb3JtYWxXPW5vcm1hbGl6ZSh2ZWMzKGZpbmFsV29ybGQqdmVjNChub3JtYWwsMC4wKSkpO1xcbiNlbmRpZlxcbiNpZmRlZiBSRUZMRUNUSU9OTUFQX0VRVUlSRUNUQU5HVUxBUl9GSVhFRFxcbnZEaXJlY3Rpb25XPW5vcm1hbGl6ZSh2ZWMzKGZpbmFsV29ybGQqdmVjNChwb3NpdGlvbiwwLjApKSk7XFxuI2VuZGlmXFxuXFxuI2lmbmRlZiBVVjFcXG52ZWMyIHV2PXZlYzIoMC4sMC4pO1xcbiNlbmRpZlxcbiNpZm5kZWYgVVYyXFxudmVjMiB1djI9dmVjMigwLiwwLik7XFxuI2VuZGlmXFxuI2lmZGVmIEFMQkVET1xcbmlmICh2QWxiZWRvSW5mb3MueCA9PSAwLilcXG57XFxudkFsYmVkb1VWPXZlYzIoYWxiZWRvTWF0cml4KnZlYzQodXYsMS4wLDAuMCkpO1xcbn1cXG5lbHNlXFxue1xcbnZBbGJlZG9VVj12ZWMyKGFsYmVkb01hdHJpeCp2ZWM0KHV2MiwxLjAsMC4wKSk7XFxufVxcbiNlbmRpZlxcbiNpZmRlZiBBTUJJRU5UXFxuaWYgKHZBbWJpZW50SW5mb3MueCA9PSAwLilcXG57XFxudkFtYmllbnRVVj12ZWMyKGFtYmllbnRNYXRyaXgqdmVjNCh1diwxLjAsMC4wKSk7XFxufVxcbmVsc2VcXG57XFxudkFtYmllbnRVVj12ZWMyKGFtYmllbnRNYXRyaXgqdmVjNCh1djIsMS4wLDAuMCkpO1xcbn1cXG4jZW5kaWZcXG4jaWZkZWYgT1BBQ0lUWVxcbmlmICh2T3BhY2l0eUluZm9zLnggPT0gMC4pXFxue1xcbnZPcGFjaXR5VVY9dmVjMihvcGFjaXR5TWF0cml4KnZlYzQodXYsMS4wLDAuMCkpO1xcbn1cXG5lbHNlXFxue1xcbnZPcGFjaXR5VVY9dmVjMihvcGFjaXR5TWF0cml4KnZlYzQodXYyLDEuMCwwLjApKTtcXG59XFxuI2VuZGlmXFxuI2lmZGVmIEVNSVNTSVZFXFxuaWYgKHZFbWlzc2l2ZUluZm9zLnggPT0gMC4pXFxue1xcbnZFbWlzc2l2ZVVWPXZlYzIoZW1pc3NpdmVNYXRyaXgqdmVjNCh1diwxLjAsMC4wKSk7XFxufVxcbmVsc2VcXG57XFxudkVtaXNzaXZlVVY9dmVjMihlbWlzc2l2ZU1hdHJpeCp2ZWM0KHV2MiwxLjAsMC4wKSk7XFxufVxcbiNlbmRpZlxcbiNpZmRlZiBMSUdIVE1BUFxcbmlmICh2TGlnaHRtYXBJbmZvcy54ID09IDAuKVxcbntcXG52TGlnaHRtYXBVVj12ZWMyKGxpZ2h0bWFwTWF0cml4KnZlYzQodXYsMS4wLDAuMCkpO1xcbn1cXG5lbHNlXFxue1xcbnZMaWdodG1hcFVWPXZlYzIobGlnaHRtYXBNYXRyaXgqdmVjNCh1djIsMS4wLDAuMCkpO1xcbn1cXG4jZW5kaWZcXG4jaWYgZGVmaW5lZChSRUZMRUNUSVZJVFkpXFxuaWYgKHZSZWZsZWN0aXZpdHlJbmZvcy54ID09IDAuKVxcbntcXG52UmVmbGVjdGl2aXR5VVY9dmVjMihyZWZsZWN0aXZpdHlNYXRyaXgqdmVjNCh1diwxLjAsMC4wKSk7XFxufVxcbmVsc2VcXG57XFxudlJlZmxlY3Rpdml0eVVWPXZlYzIocmVmbGVjdGl2aXR5TWF0cml4KnZlYzQodXYyLDEuMCwwLjApKTtcXG59XFxuI2VuZGlmXFxuI2lmZGVmIEJVTVBcXG5pZiAodkJ1bXBJbmZvcy54ID09IDAuKVxcbntcXG52QnVtcFVWPXZlYzIoYnVtcE1hdHJpeCp2ZWM0KHV2LDEuMCwwLjApKTtcXG59XFxuZWxzZVxcbntcXG52QnVtcFVWPXZlYzIoYnVtcE1hdHJpeCp2ZWM0KHV2MiwxLjAsMC4wKSk7XFxufVxcbiNlbmRpZlxcblxcbiNpbmNsdWRlPGNsaXBQbGFuZVZlcnRleD5cXG5cXG4jaW5jbHVkZTxmb2dWZXJ0ZXg+XFxuXFxuI2luY2x1ZGU8c2hhZG93c1ZlcnRleD5bMC4ubWF4U2ltdWx0YW5lb3VzTGlnaHRzXVxcblxcbiNpZmRlZiBWRVJURVhDT0xPUlxcbnZDb2xvcj1jb2xvcjtcXG4jZW5kaWZcXG5cXG4jaWZkZWYgUE9JTlRTSVpFXFxuZ2xfUG9pbnRTaXplPXBvaW50U2l6ZTtcXG4jZW5kaWZcXG5cXG4jaW5jbHVkZTxsb2dEZXB0aFZlcnRleD5cXG59XCIsXG5wb3N0cHJvY2Vzc1ZlcnRleFNoYWRlcjpcIlxcbmF0dHJpYnV0ZSB2ZWMyIHBvc2l0aW9uO1xcbnVuaWZvcm0gdmVjMiBzY2FsZTtcXG5cXG52YXJ5aW5nIHZlYzIgdlVWO1xcbmNvbnN0IHZlYzIgbWFkZD12ZWMyKDAuNSwwLjUpO1xcbnZvaWQgbWFpbih2b2lkKSB7IFxcbnZVVj0ocG9zaXRpb24qbWFkZCttYWRkKSpzY2FsZTtcXG5nbF9Qb3NpdGlvbj12ZWM0KHBvc2l0aW9uLDAuMCwxLjApO1xcbn1cIixwcm9jZWR1cmFsVmVydGV4U2hhZGVyOlwiXFxuYXR0cmlidXRlIHZlYzIgcG9zaXRpb247XFxuXFxudmFyeWluZyB2ZWMyIHZQb3NpdGlvbjtcXG52YXJ5aW5nIHZlYzIgdlVWO1xcbmNvbnN0IHZlYzIgbWFkZD12ZWMyKDAuNSwwLjUpO1xcbnZvaWQgbWFpbih2b2lkKSB7IFxcbnZQb3NpdGlvbj1wb3NpdGlvbjtcXG52VVY9cG9zaXRpb24qbWFkZCttYWRkO1xcbmdsX1Bvc2l0aW9uPXZlYzQocG9zaXRpb24sMC4wLDEuMCk7XFxufVwiLHJlY3QyZFBpeGVsU2hhZGVyOlwidmFyeWluZyB2ZWM0IHZDb2xvcjtcXG52b2lkIG1haW4odm9pZCkge1xcbmdsX0ZyYWdDb2xvcj12Q29sb3I7XFxufVwiLHJlY3QyZFZlcnRleFNoYWRlcjpcIlxcbiNpZmRlZiBJbnN0YW5jZWRcXG4jZGVmaW5lIGF0dCBhdHRyaWJ1dGVcXG4jZWxzZVxcbiNkZWZpbmUgYXR0IHVuaWZvcm1cXG4jZW5kaWZcXG5hdHRyaWJ1dGUgZmxvYXQgaW5kZXg7XFxuYXR0IHZlYzIgekJpYXM7XFxuYXR0IHZlYzQgdHJhbnNmb3JtWDtcXG5hdHQgdmVjNCB0cmFuc2Zvcm1ZO1xcbiNpZmRlZiBCb3JkZXJcXG5hdHQgZmxvYXQgYm9yZGVyVGhpY2tuZXNzO1xcbiNlbmRpZlxcbiNpZmRlZiBGaWxsU29saWRcXG5hdHQgdmVjNCBmaWxsU29saWRDb2xvcjtcXG4jZW5kaWZcXG4jaWZkZWYgQm9yZGVyU29saWRcXG5hdHQgdmVjNCBib3JkZXJTb2xpZENvbG9yO1xcbiNlbmRpZlxcbiNpZmRlZiBGaWxsR3JhZGllbnRcXG5hdHQgdmVjNCBmaWxsR3JhZGllbnRDb2xvcjE7XFxuYXR0IHZlYzQgZmlsbEdyYWRpZW50Q29sb3IyO1xcbmF0dCB2ZWM0IGZpbGxHcmFkaWVudFRZO1xcbiNlbmRpZlxcbiNpZmRlZiBCb3JkZXJHcmFkaWVudFxcbmF0dCB2ZWM0IGJvcmRlckdyYWRpZW50Q29sb3IxO1xcbmF0dCB2ZWM0IGJvcmRlckdyYWRpZW50Q29sb3IyO1xcbmF0dCB2ZWM0IGJvcmRlckdyYWRpZW50VFk7XFxuI2VuZGlmXFxuXFxuYXR0IHZlYzMgcHJvcGVydGllcztcXG5cXG4jZGVmaW5lIHJzdWIwIDE3LjBcXG4jZGVmaW5lIHJzdWIxIDMzLjBcXG4jZGVmaW5lIHJzdWIyIDQ5LjBcXG4jZGVmaW5lIHJzdWIzIDY1LjBcXG4jZGVmaW5lIHJzdWIgNjQuMFxcbiNkZWZpbmUgVFdPUEkgNi4yODMxODUzMFxcblxcbnZhcnlpbmcgdmVjMiB2VVY7XFxudmFyeWluZyB2ZWM0IHZDb2xvcjtcXG52b2lkIG1haW4odm9pZCkge1xcbnZlYzIgcG9zMjtcXG5cXG5pZiAocHJvcGVydGllcy56ID09IDAuMCkge1xcbiNpZmRlZiBCb3JkZXJcXG5mbG9hdCB3PXByb3BlcnRpZXMueDtcXG5mbG9hdCBoPXByb3BlcnRpZXMueTtcXG52ZWMyIGJvcmRlck9mZnNldD12ZWMyKDEuMCwxLjApO1xcbmZsb2F0IHNlZ2k9aW5kZXg7XFxuaWYgKGluZGV4PDQuMCkge1xcbmJvcmRlck9mZnNldD12ZWMyKDEuMC0oYm9yZGVyVGhpY2tuZXNzKjIuMC93KSwxLjAtKGJvcmRlclRoaWNrbmVzcyoyLjAvaCkpO1xcbn1cXG5lbHNlIHtcXG5zZWdpLT00LjA7XFxufVxcbmlmIChzZWdpID09IDAuMCkge1xcbnBvczI9dmVjMigxLjAsMS4wKTtcXG59IFxcbmVsc2UgaWYgKHNlZ2kgPT0gMS4wKSB7XFxucG9zMj12ZWMyKDEuMCwwLjApO1xcbn1cXG5lbHNlIGlmIChzZWdpID09IDIuMCkge1xcbnBvczI9dmVjMigwLjAsMC4wKTtcXG59IFxcbmVsc2Uge1xcbnBvczI9dmVjMigwLjAsMS4wKTtcXG59XFxucG9zMi54PSgocG9zMi54LTAuNSkqYm9yZGVyT2Zmc2V0LngpKzAuNTtcXG5wb3MyLnk9KChwb3MyLnktMC41KSpib3JkZXJPZmZzZXQueSkrMC41O1xcbiNlbHNlXFxuaWYgKGluZGV4ID09IDAuMCkge1xcbnBvczI9dmVjMigwLjUsMC41KTtcXG59XFxuZWxzZSBpZiAoaW5kZXggPT0gMS4wKSB7XFxucG9zMj12ZWMyKDEuMCwxLjApO1xcbn1cXG5lbHNlIGlmIChpbmRleCA9PSAyLjApIHtcXG5wb3MyPXZlYzIoMS4wLDAuMCk7XFxufVxcbmVsc2UgaWYgKGluZGV4ID09IDMuMCkge1xcbnBvczI9dmVjMigwLjAsMC4wKTtcXG59XFxuZWxzZSB7XFxucG9zMj12ZWMyKDAuMCwxLjApO1xcbn1cXG4jZW5kaWZcXG59XFxuZWxzZVxcbntcXG4jaWZkZWYgQm9yZGVyXFxuZmxvYXQgdz1wcm9wZXJ0aWVzLng7XFxuZmxvYXQgaD1wcm9wZXJ0aWVzLnk7XFxuZmxvYXQgcj1wcm9wZXJ0aWVzLno7XFxuZmxvYXQgbnJ1PXIvdztcXG5mbG9hdCBucnY9ci9oO1xcbnZlYzIgYm9yZGVyT2Zmc2V0PXZlYzIoMS4wLDEuMCk7XFxuZmxvYXQgc2VnaT1pbmRleDtcXG5pZiAoaW5kZXg8cnN1Yikge1xcbmJvcmRlck9mZnNldD12ZWMyKDEuMC0oYm9yZGVyVGhpY2tuZXNzKjIuMC93KSwxLjAtKGJvcmRlclRoaWNrbmVzcyoyLjAvaCkpO1xcbn1cXG5lbHNlIHtcXG5zZWdpLT1yc3ViO1xcbn1cXG5cXG5pZiAoc2VnaTxyc3ViMCkge1xcbnBvczI9dmVjMigxLjAtbnJ1LG5ydik7XFxufVxcblxcbmVsc2UgaWYgKHNlZ2k8cnN1YjEpIHtcXG5wb3MyPXZlYzIobnJ1LG5ydik7XFxufVxcblxcbmVsc2UgaWYgKHNlZ2k8cnN1YjIpIHtcXG5wb3MyPXZlYzIobnJ1LDEuMC1ucnYpO1xcbn1cXG5cXG5lbHNlIHtcXG5wb3MyPXZlYzIoMS4wLW5ydSwxLjAtbnJ2KTtcXG59XFxuZmxvYXQgYW5nbGU9VFdPUEktKChpbmRleC0xLjApKlRXT1BJLyhyc3ViLTAuNSkpO1xcbnBvczIueCs9Y29zKGFuZ2xlKSpucnU7XFxucG9zMi55Kz1zaW4oYW5nbGUpKm5ydjtcXG5wb3MyLng9KChwb3MyLngtMC41KSpib3JkZXJPZmZzZXQueCkrMC41O1xcbnBvczIueT0oKHBvczIueS0wLjUpKmJvcmRlck9mZnNldC55KSswLjU7XFxuI2Vsc2VcXG5pZiAoaW5kZXggPT0gMC4wKSB7XFxucG9zMj12ZWMyKDAuNSwwLjUpO1xcbn1cXG5lbHNlIHtcXG5mbG9hdCB3PXByb3BlcnRpZXMueDtcXG5mbG9hdCBoPXByb3BlcnRpZXMueTtcXG5mbG9hdCByPXByb3BlcnRpZXMuejtcXG5mbG9hdCBucnU9ci93O1xcbmZsb2F0IG5ydj1yL2g7XFxuXFxuaWYgKGluZGV4PHJzdWIwKSB7XFxucG9zMj12ZWMyKDEuMC1ucnUsbnJ2KTtcXG59XFxuXFxuZWxzZSBpZiAoaW5kZXg8cnN1YjEpIHtcXG5wb3MyPXZlYzIobnJ1LG5ydik7XFxufVxcblxcbmVsc2UgaWYgKGluZGV4PHJzdWIyKSB7XFxucG9zMj12ZWMyKG5ydSwxLjAtbnJ2KTtcXG59XFxuXFxuZWxzZSB7XFxucG9zMj12ZWMyKDEuMC1ucnUsMS4wLW5ydik7XFxufVxcbmZsb2F0IGFuZ2xlPVRXT1BJLSgoaW5kZXgtMS4wKSpUV09QSS8ocnN1Yi0wLjUpKTtcXG5wb3MyLngrPWNvcyhhbmdsZSkqbnJ1O1xcbnBvczIueSs9c2luKGFuZ2xlKSpucnY7XFxufVxcbiNlbmRpZlxcbn1cXG4jaWZkZWYgRmlsbFNvbGlkXFxudkNvbG9yPWZpbGxTb2xpZENvbG9yO1xcbiNlbmRpZlxcbiNpZmRlZiBCb3JkZXJTb2xpZFxcbnZDb2xvcj1ib3JkZXJTb2xpZENvbG9yO1xcbiNlbmRpZlxcbiNpZmRlZiBGaWxsR3JhZGllbnRcXG5mbG9hdCB2PWRvdCh2ZWM0KHBvczIueHksMSwxKSxmaWxsR3JhZGllbnRUWSk7XFxudkNvbG9yPW1peChmaWxsR3JhZGllbnRDb2xvcjIsZmlsbEdyYWRpZW50Q29sb3IxLHYpOyBcXG4jZW5kaWZcXG4jaWZkZWYgQm9yZGVyR3JhZGllbnRcXG5mbG9hdCB2PWRvdCh2ZWM0KHBvczIueHksMSwxKSxib3JkZXJHcmFkaWVudFRZKTtcXG52Q29sb3I9bWl4KGJvcmRlckdyYWRpZW50Q29sb3IyLGJvcmRlckdyYWRpZW50Q29sb3IxLHYpOyBcXG4jZW5kaWZcXG52ZWM0IHBvcztcXG5wb3MueHk9cG9zMi54eSpwcm9wZXJ0aWVzLnh5O1xcbnBvcy56PTEuMDtcXG5wb3Mudz0xLjA7XFxuZ2xfUG9zaXRpb249dmVjNChkb3QocG9zLHRyYW5zZm9ybVgpLGRvdChwb3MsdHJhbnNmb3JtWSksekJpYXMueCwxKTtcXG59XCIscmVmcmFjdGlvblBpeGVsU2hhZGVyOlwiXFxudmFyeWluZyB2ZWMyIHZVVjtcXG51bmlmb3JtIHNhbXBsZXIyRCB0ZXh0dXJlU2FtcGxlcjtcXG51bmlmb3JtIHNhbXBsZXIyRCByZWZyYWN0aW9uU2FtcGxlcjtcXG5cXG51bmlmb3JtIHZlYzMgYmFzZUNvbG9yO1xcbnVuaWZvcm0gZmxvYXQgZGVwdGg7XFxudW5pZm9ybSBmbG9hdCBjb2xvckxldmVsO1xcbnZvaWQgbWFpbigpIHtcXG5mbG9hdCByZWY9MS4wLXRleHR1cmUyRChyZWZyYWN0aW9uU2FtcGxlcix2VVYpLnI7XFxudmVjMiB1dj12VVYtdmVjMigwLjUpO1xcbnZlYzIgb2Zmc2V0PXV2KmRlcHRoKnJlZjtcXG52ZWMzIHNvdXJjZUNvbG9yPXRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcix2VVYtb2Zmc2V0KS5yZ2I7XFxuZ2xfRnJhZ0NvbG9yPXZlYzQoc291cmNlQ29sb3Irc291cmNlQ29sb3IqcmVmKmNvbG9yTGV2ZWwsMS4wKTtcXG59XCIsc2hhZG93TWFwUGl4ZWxTaGFkZXI6XCJ2ZWM0IHBhY2soZmxvYXQgZGVwdGgpXFxue1xcbmNvbnN0IHZlYzQgYml0X3NoaWZ0PXZlYzQoMjU1LjAqMjU1LjAqMjU1LjAsMjU1LjAqMjU1LjAsMjU1LjAsMS4wKTtcXG5jb25zdCB2ZWM0IGJpdF9tYXNrPXZlYzQoMC4wLDEuMC8yNTUuMCwxLjAvMjU1LjAsMS4wLzI1NS4wKTtcXG52ZWM0IHJlcz1mcmFjdChkZXB0aCpiaXRfc2hpZnQpO1xcbnJlcy09cmVzLnh4eXoqYml0X21hc2s7XFxucmV0dXJuIHJlcztcXG59XFxuXFxudmVjMiBwYWNrSGFsZihmbG9hdCBkZXB0aCkgXFxueyBcXG5jb25zdCB2ZWMyIGJpdE9mZnNldD12ZWMyKDEuMC8yNTUuLDAuKTtcXG52ZWMyIGNvbG9yPXZlYzIoZGVwdGgsZnJhY3QoZGVwdGgqMjU1LikpO1xcbnJldHVybiBjb2xvci0oY29sb3IueXkqYml0T2Zmc2V0KTtcXG59XFxudmFyeWluZyB2ZWM0IHZQb3NpdGlvbjtcXG4jaWZkZWYgQUxQSEFURVNUXFxudmFyeWluZyB2ZWMyIHZVVjtcXG51bmlmb3JtIHNhbXBsZXIyRCBkaWZmdXNlU2FtcGxlcjtcXG4jZW5kaWZcXG4jaWZkZWYgQ1VCRU1BUFxcbnVuaWZvcm0gdmVjMyBsaWdodFBvc2l0aW9uO1xcbnVuaWZvcm0gdmVjMiBkZXB0aFZhbHVlcztcXG4jZW5kaWZcXG52b2lkIG1haW4odm9pZClcXG57XFxuI2lmZGVmIEFMUEhBVEVTVFxcbmlmICh0ZXh0dXJlMkQoZGlmZnVzZVNhbXBsZXIsdlVWKS5hPDAuNClcXG5kaXNjYXJkO1xcbiNlbmRpZlxcbiNpZmRlZiBDVUJFTUFQXFxudmVjMyBkaXJlY3Rpb25Ub0xpZ2h0PXZQb3NpdGlvbi54eXotbGlnaHRQb3NpdGlvbjtcXG5mbG9hdCBkZXB0aD1sZW5ndGgoZGlyZWN0aW9uVG9MaWdodCk7XFxuZGVwdGg9KGRlcHRoLWRlcHRoVmFsdWVzLngpLyhkZXB0aFZhbHVlcy55LWRlcHRoVmFsdWVzLngpO1xcbmRlcHRoPWNsYW1wKGRlcHRoLDAuLDEuMCk7XFxuI2Vsc2VcXG5mbG9hdCBkZXB0aD12UG9zaXRpb24uei92UG9zaXRpb24udztcXG5kZXB0aD1kZXB0aCowLjUrMC41O1xcbiNlbmRpZlxcbiNpZmRlZiBWU01cXG5mbG9hdCBtb21lbnQxPWRlcHRoO1xcbmZsb2F0IG1vbWVudDI9bW9tZW50MSptb21lbnQxO1xcbmdsX0ZyYWdDb2xvcj12ZWM0KHBhY2tIYWxmKG1vbWVudDEpLHBhY2tIYWxmKG1vbWVudDIpKTtcXG4jZWxzZVxcbmdsX0ZyYWdDb2xvcj1wYWNrKGRlcHRoKTtcXG4jZW5kaWZcXG59XCIsc2hhZG93TWFwVmVydGV4U2hhZGVyOlwiXFxuYXR0cmlidXRlIHZlYzMgcG9zaXRpb247XFxuI2luY2x1ZGU8Ym9uZXNEZWNsYXJhdGlvbj5cXG5cXG4jaW5jbHVkZTxpbnN0YW5jZXNEZWNsYXJhdGlvbj5cXG51bmlmb3JtIG1hdDQgdmlld1Byb2plY3Rpb247XFxudmFyeWluZyB2ZWM0IHZQb3NpdGlvbjtcXG4jaWZkZWYgQUxQSEFURVNUXFxudmFyeWluZyB2ZWMyIHZVVjtcXG51bmlmb3JtIG1hdDQgZGlmZnVzZU1hdHJpeDtcXG4jaWZkZWYgVVYxXFxuYXR0cmlidXRlIHZlYzIgdXY7XFxuI2VuZGlmXFxuI2lmZGVmIFVWMlxcbmF0dHJpYnV0ZSB2ZWMyIHV2MjtcXG4jZW5kaWZcXG4jZW5kaWZcXG52b2lkIG1haW4odm9pZClcXG57XFxuI2luY2x1ZGU8aW5zdGFuY2VzVmVydGV4PlxcbiNpbmNsdWRlPGJvbmVzVmVydGV4PlxcbiNpZmRlZiBDVUJFTUFQXFxudlBvc2l0aW9uPWZpbmFsV29ybGQqdmVjNChwb3NpdGlvbiwxLjApO1xcbmdsX1Bvc2l0aW9uPXZpZXdQcm9qZWN0aW9uKmZpbmFsV29ybGQqdmVjNChwb3NpdGlvbiwxLjApO1xcbiNlbHNlXFxudlBvc2l0aW9uPXZpZXdQcm9qZWN0aW9uKmZpbmFsV29ybGQqdmVjNChwb3NpdGlvbiwxLjApO1xcbmdsX1Bvc2l0aW9uPXZQb3NpdGlvbjtcXG4jZW5kaWZcXG4jaWZkZWYgQUxQSEFURVNUXFxuI2lmZGVmIFVWMVxcbnZVVj12ZWMyKGRpZmZ1c2VNYXRyaXgqdmVjNCh1diwxLjAsMC4wKSk7XFxuI2VuZGlmXFxuI2lmZGVmIFVWMlxcbnZVVj12ZWMyKGRpZmZ1c2VNYXRyaXgqdmVjNCh1djIsMS4wLDAuMCkpO1xcbiNlbmRpZlxcbiNlbmRpZlxcbn1cIixzcHJpdGUyZFBpeGVsU2hhZGVyOlwidmFyeWluZyB2ZWMyIHZVVjtcXG51bmlmb3JtIHNhbXBsZXIyRCBkaWZmdXNlU2FtcGxlcjtcXG52b2lkIG1haW4odm9pZCkge1xcbnZlYzQgY29sb3I9dGV4dHVyZTJEKGRpZmZ1c2VTYW1wbGVyLHZVVik7XFxuaWYgKGNvbG9yLmEgPT0gMC4wNSkge1xcbmRpc2NhcmQ7XFxufVxcbmdsX0ZyYWdDb2xvcj1jb2xvcjtcXG59XCIsc3ByaXRlMmRWZXJ0ZXhTaGFkZXI6XCJcXG4jaWZkZWYgSW5zdGFuY2VkXFxuI2RlZmluZSBhdHQgYXR0cmlidXRlXFxuI2Vsc2VcXG4jZGVmaW5lIGF0dCB1bmlmb3JtXFxuI2VuZGlmXFxuXFxuYXR0cmlidXRlIGZsb2F0IGluZGV4O1xcbmF0dCB2ZWMyIHRvcExlZnRVVjtcXG5hdHQgdmVjMiBzaXplVVY7XFxuYXR0IHZlYzIgdGV4dHVyZVNpemU7XFxuXFxuYXR0IHZlYzMgcHJvcGVydGllcztcXG5hdHQgdmVjMiB6QmlhcztcXG5hdHQgdmVjNCB0cmFuc2Zvcm1YO1xcbmF0dCB2ZWM0IHRyYW5zZm9ybVk7XFxuXFxuXFxudmFyeWluZyB2ZWMyIHZVVjtcXG52YXJ5aW5nIHZlYzQgdkNvbG9yO1xcbnZvaWQgbWFpbih2b2lkKSB7XFxudmVjMiBwb3MyO1xcblxcbnZlYzIgb2ZmPXZlYzIoMC4wLDAuMCk7XFxuZmxvYXQgZnJhbWU9cHJvcGVydGllcy54O1xcbmZsb2F0IGludmVydFk9cHJvcGVydGllcy55O1xcbmZsb2F0IGFsaWduVG9QaXhlbD1wcm9wZXJ0aWVzLno7XFxuXFxuaWYgKGluZGV4ID09IDAuMCkge1xcbnBvczI9dmVjMigwLjAsMC4wKTtcXG52VVY9dmVjMih0b3BMZWZ0VVYueCsoZnJhbWUqc2l6ZVVWLngpK29mZi54LHRvcExlZnRVVi55LW9mZi55KTtcXG59XFxuXFxuZWxzZSBpZiAoaW5kZXggPT0gMS4wKSB7XFxucG9zMj12ZWMyKDAuMCwxLjApO1xcbnZVVj12ZWMyKHRvcExlZnRVVi54KyhmcmFtZSpzaXplVVYueCkrb2ZmLngsKHRvcExlZnRVVi55K3NpemVVVi55KSk7XFxufVxcblxcbmVsc2UgaWYgKGluZGV4ID09IDIuMCkge1xcbnBvczI9dmVjMiggMS4wLDEuMCk7XFxudlVWPXZlYzIodG9wTGVmdFVWLngrc2l6ZVVWLngrKGZyYW1lKnNpemVVVi54KSwodG9wTGVmdFVWLnkrc2l6ZVVWLnkpKTtcXG59XFxuXFxuZWxzZSBpZiAoaW5kZXggPT0gMy4wKSB7XFxucG9zMj12ZWMyKCAxLjAsMC4wKTtcXG52VVY9dmVjMih0b3BMZWZ0VVYueCtzaXplVVYueCsoZnJhbWUqc2l6ZVVWLngpLHRvcExlZnRVVi55LW9mZi55KTtcXG59XFxuaWYgKGludmVydFkgPT0gMS4wKSB7XFxudlVWLnk9MS4wLXZVVi55O1xcbn1cXG52ZWM0IHBvcztcXG5pZiAoYWxpZ25Ub1BpeGVsID09IDEuMClcXG57XFxucG9zLnh5PWZsb29yKHBvczIueHkqc2l6ZVVWKnRleHR1cmVTaXplKTtcXG59IGVsc2Uge1xcbnBvcy54eT1wb3MyLnh5KnNpemVVVip0ZXh0dXJlU2l6ZTtcXG59XFxucG9zLno9MS4wO1xcbnBvcy53PTEuMDtcXG5nbF9Qb3NpdGlvbj12ZWM0KGRvdChwb3MsdHJhbnNmb3JtWCksZG90KHBvcyx0cmFuc2Zvcm1ZKSx6Qmlhcy54LDEpO1xcbn0gXCIsc3ByaXRlc1BpeGVsU2hhZGVyOlwidW5pZm9ybSBib29sIGFscGhhVGVzdDtcXG52YXJ5aW5nIHZlYzQgdkNvbG9yO1xcblxcbnZhcnlpbmcgdmVjMiB2VVY7XFxudW5pZm9ybSBzYW1wbGVyMkQgZGlmZnVzZVNhbXBsZXI7XFxuXFxuI2luY2x1ZGU8Zm9nRnJhZ21lbnREZWNsYXJhdGlvbj5cXG52b2lkIG1haW4odm9pZCkge1xcbnZlYzQgY29sb3I9dGV4dHVyZTJEKGRpZmZ1c2VTYW1wbGVyLHZVVik7XFxuaWYgKGFscGhhVGVzdCkgXFxue1xcbmlmIChjb2xvci5hPDAuOTUpXFxuZGlzY2FyZDtcXG59XFxuY29sb3IqPXZDb2xvcjtcXG4jaW5jbHVkZTxmb2dGcmFnbWVudD5cXG5nbF9GcmFnQ29sb3I9Y29sb3I7XFxufVwiLHNwcml0ZXNWZXJ0ZXhTaGFkZXI6XCJcXG5hdHRyaWJ1dGUgdmVjNCBwb3NpdGlvbjtcXG5hdHRyaWJ1dGUgdmVjNCBvcHRpb25zO1xcbmF0dHJpYnV0ZSB2ZWM0IGNlbGxJbmZvO1xcbmF0dHJpYnV0ZSB2ZWM0IGNvbG9yO1xcblxcbnVuaWZvcm0gdmVjMiB0ZXh0dXJlSW5mb3M7XFxudW5pZm9ybSBtYXQ0IHZpZXc7XFxudW5pZm9ybSBtYXQ0IHByb2plY3Rpb247XFxuXFxudmFyeWluZyB2ZWMyIHZVVjtcXG52YXJ5aW5nIHZlYzQgdkNvbG9yO1xcbiNpbmNsdWRlPGZvZ1ZlcnRleERlY2xhcmF0aW9uPlxcbnZvaWQgbWFpbih2b2lkKSB7IFxcbnZlYzMgdmlld1Bvcz0odmlldyp2ZWM0KHBvc2l0aW9uLnh5eiwxLjApKS54eXo7IFxcbnZlYzIgY29ybmVyUG9zO1xcbmZsb2F0IGFuZ2xlPXBvc2l0aW9uLnc7XFxudmVjMiBzaXplPXZlYzIob3B0aW9ucy54LG9wdGlvbnMueSk7XFxudmVjMiBvZmZzZXQ9b3B0aW9ucy56dztcXG52ZWMyIHV2U2NhbGU9dGV4dHVyZUluZm9zLnh5O1xcbmNvcm5lclBvcz12ZWMyKG9mZnNldC54LTAuNSxvZmZzZXQueS0wLjUpKnNpemU7XFxuXFxudmVjMyByb3RhdGVkQ29ybmVyO1xcbnJvdGF0ZWRDb3JuZXIueD1jb3JuZXJQb3MueCpjb3MoYW5nbGUpLWNvcm5lclBvcy55KnNpbihhbmdsZSk7XFxucm90YXRlZENvcm5lci55PWNvcm5lclBvcy54KnNpbihhbmdsZSkrY29ybmVyUG9zLnkqY29zKGFuZ2xlKTtcXG5yb3RhdGVkQ29ybmVyLno9MC47XFxuXFxudmlld1Bvcys9cm90YXRlZENvcm5lcjtcXG5nbF9Qb3NpdGlvbj1wcm9qZWN0aW9uKnZlYzQodmlld1BvcywxLjApOyBcXG5cXG52Q29sb3I9Y29sb3I7XFxuXFxudmVjMiB1dk9mZnNldD12ZWMyKGFicyhvZmZzZXQueC1jZWxsSW5mby54KSwxLjAtYWJzKG9mZnNldC55LWNlbGxJbmZvLnkpKTtcXG52VVY9KHV2T2Zmc2V0K2NlbGxJbmZvLnp3KSp1dlNjYWxlO1xcblxcbiNpZmRlZiBGT0dcXG5mRm9nRGlzdGFuY2U9dmlld1Bvcy56O1xcbiNlbmRpZlxcbn1cIixzc2FvUGl4ZWxTaGFkZXI6XCJcXG51bmlmb3JtIHNhbXBsZXIyRCB0ZXh0dXJlU2FtcGxlcjtcXG52YXJ5aW5nIHZlYzIgdlVWO1xcbiNpZmRlZiBTU0FPXFxudW5pZm9ybSBzYW1wbGVyMkQgcmFuZG9tU2FtcGxlcjtcXG51bmlmb3JtIGZsb2F0IHJhbmRUZXh0dXJlVGlsZXM7XFxudW5pZm9ybSBmbG9hdCBzYW1wbGVzRmFjdG9yO1xcbnVuaWZvcm0gdmVjMyBzYW1wbGVTcGhlcmVbU0FNUExFU107XFxudW5pZm9ybSBmbG9hdCB0b3RhbFN0cmVuZ3RoO1xcbnVuaWZvcm0gZmxvYXQgcmFkaXVzO1xcbnVuaWZvcm0gZmxvYXQgYXJlYTtcXG51bmlmb3JtIGZsb2F0IGZhbGxPZmY7XFxudW5pZm9ybSBmbG9hdCBiYXNlO1xcbnZlYzMgbm9ybWFsRnJvbURlcHRoKGZsb2F0IGRlcHRoLHZlYzIgY29vcmRzKVxcbntcXG52ZWMyIG9mZnNldDE9dmVjMigwLjAscmFkaXVzKTtcXG52ZWMyIG9mZnNldDI9dmVjMihyYWRpdXMsMC4wKTtcXG5mbG9hdCBkZXB0aDE9dGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLGNvb3JkcytvZmZzZXQxKS5yO1xcbmZsb2F0IGRlcHRoMj10ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsY29vcmRzK29mZnNldDIpLnI7XFxudmVjMyBwMT12ZWMzKG9mZnNldDEsZGVwdGgxLWRlcHRoKTtcXG52ZWMzIHAyPXZlYzMob2Zmc2V0MixkZXB0aDItZGVwdGgpO1xcbnZlYzMgbm9ybWFsPWNyb3NzKHAxLHAyKTtcXG5ub3JtYWwuej0tbm9ybWFsLno7XFxucmV0dXJuIG5vcm1hbGl6ZShub3JtYWwpO1xcbn1cXG52b2lkIG1haW4oKVxcbntcXG52ZWMzIHJhbmRvbT1ub3JtYWxpemUodGV4dHVyZTJEKHJhbmRvbVNhbXBsZXIsdlVWKnJhbmRUZXh0dXJlVGlsZXMpLnJnYik7XFxuZmxvYXQgZGVwdGg9dGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVikucjtcXG52ZWMzIHBvc2l0aW9uPXZlYzModlVWLGRlcHRoKTtcXG52ZWMzIG5vcm1hbD1ub3JtYWxGcm9tRGVwdGgoZGVwdGgsdlVWKTtcXG5mbG9hdCByYWRpdXNEZXB0aD1yYWRpdXMvZGVwdGg7XFxuZmxvYXQgb2NjbHVzaW9uPTAuMDtcXG52ZWMzIHJheTtcXG52ZWMzIGhlbWlSYXk7XFxuZmxvYXQgb2NjbHVzaW9uRGVwdGg7XFxuZmxvYXQgZGlmZmVyZW5jZTtcXG5mb3IgKGludCBpPTA7IGk8U0FNUExFUzsgaSsrKVxcbntcXG5yYXk9cmFkaXVzRGVwdGgqcmVmbGVjdChzYW1wbGVTcGhlcmVbaV0scmFuZG9tKTtcXG5oZW1pUmF5PXBvc2l0aW9uK3NpZ24oZG90KHJheSxub3JtYWwpKSpyYXk7XFxub2NjbHVzaW9uRGVwdGg9dGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLGNsYW1wKGhlbWlSYXkueHksdmVjMigwLjAwMSwwLjAwMSksdmVjMigwLjk5OSwwLjk5OSkpKS5yO1xcbmRpZmZlcmVuY2U9ZGVwdGgtb2NjbHVzaW9uRGVwdGg7XFxub2NjbHVzaW9uKz1zdGVwKGZhbGxPZmYsZGlmZmVyZW5jZSkqKDEuMC1zbW9vdGhzdGVwKGZhbGxPZmYsYXJlYSxkaWZmZXJlbmNlKSk7XFxufVxcbmZsb2F0IGFvPTEuMC10b3RhbFN0cmVuZ3RoKm9jY2x1c2lvbipzYW1wbGVzRmFjdG9yO1xcbmZsb2F0IHJlc3VsdD1jbGFtcChhbytiYXNlLDAuMCwxLjApO1xcbmdsX0ZyYWdDb2xvci5yPXJlc3VsdDtcXG5nbF9GcmFnQ29sb3IuZz1yZXN1bHQ7XFxuZ2xfRnJhZ0NvbG9yLmI9cmVzdWx0O1xcbmdsX0ZyYWdDb2xvci5hPTEuMDtcXG59XFxuI2VuZGlmXFxuI2lmZGVmIEJJTEFURVJBTF9CTFVSXFxudW5pZm9ybSBzYW1wbGVyMkQgZGVwdGhTYW1wbGVyO1xcbnVuaWZvcm0gZmxvYXQgb3V0U2l6ZTtcXG51bmlmb3JtIGZsb2F0IHNhbXBsZXJPZmZzZXRzW1NBTVBMRVNdO1xcbnZvaWQgbWFpbigpXFxue1xcbmZsb2F0IHRleGVsc2l6ZT0xLjAvb3V0U2l6ZTtcXG5mbG9hdCBjb21wYXJlRGVwdGg9dGV4dHVyZTJEKGRlcHRoU2FtcGxlcix2VVYpLnI7XFxuZmxvYXQgcmVzdWx0PTAuMDtcXG5mbG9hdCB3ZWlnaHRTdW09MC4wO1xcbmZvciAoaW50IGk9MDsgaTxTQU1QTEVTOyArK2kpXFxue1xcbiNpZmRlZiBCSUxBVEVSQUxfQkxVUl9IXFxudmVjMiBzYW1wbGVPZmZzZXQ9dmVjMih0ZXhlbHNpemUqc2FtcGxlck9mZnNldHNbaV0sMC4wKTtcXG4jZWxzZVxcbnZlYzIgc2FtcGxlT2Zmc2V0PXZlYzIoMC4wLHRleGVsc2l6ZSpzYW1wbGVyT2Zmc2V0c1tpXSk7XFxuI2VuZGlmXFxudmVjMiBzYW1wbGVQb3M9dlVWK3NhbXBsZU9mZnNldDtcXG5mbG9hdCBzYW1wbGVEZXB0aD10ZXh0dXJlMkQoZGVwdGhTYW1wbGVyLHNhbXBsZVBvcykucjtcXG5mbG9hdCB3ZWlnaHQ9KDEuMC8oMC4wMDAxK2Ficyhjb21wYXJlRGVwdGgtc2FtcGxlRGVwdGgpKSk7XFxucmVzdWx0Kz10ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsc2FtcGxlUG9zKS5yKndlaWdodDtcXG53ZWlnaHRTdW0rPXdlaWdodDtcXG59XFxucmVzdWx0Lz13ZWlnaHRTdW07XFxuZ2xfRnJhZ0NvbG9yLnJnYj12ZWMzKHJlc3VsdCk7XFxuZ2xfRnJhZ0NvbG9yLmE9MS4wO1xcbn1cXG4jZW5kaWZcXG5cIixzc2FvQ29tYmluZVBpeGVsU2hhZGVyOlwidW5pZm9ybSBzYW1wbGVyMkQgdGV4dHVyZVNhbXBsZXI7XFxudW5pZm9ybSBzYW1wbGVyMkQgb3JpZ2luYWxDb2xvcjtcXG52YXJ5aW5nIHZlYzIgdlVWO1xcbnZvaWQgbWFpbih2b2lkKSB7XFxudmVjNCBzc2FvQ29sb3I9dGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVik7XFxudmVjNCBzY2VuZUNvbG9yPXRleHR1cmUyRChvcmlnaW5hbENvbG9yLHZVVik7XFxuZ2xfRnJhZ0NvbG9yPXNjZW5lQ29sb3Iqc3Nhb0NvbG9yO1xcbn1cXG5cIixzdGVyZW9zY29waWNJbnRlcmxhY2VQaXhlbFNoYWRlcjpcImNvbnN0IHZlYzMgVFdPPXZlYzMoMi4wLDIuMCwyLjApO1xcbnZhcnlpbmcgdmVjMiB2VVY7XFxudW5pZm9ybSBzYW1wbGVyMkQgY2FtQVNhbXBsZXI7XFxudW5pZm9ybSBzYW1wbGVyMkQgdGV4dHVyZVNhbXBsZXI7XFxudW5pZm9ybSB2ZWMyIHN0ZXBTaXplO1xcbnZvaWQgbWFpbih2b2lkKVxcbntcXG5ib29sIHVzZUNhbUI7XFxudmVjMiB0ZXhDb29yZDE7XFxudmVjMiB0ZXhDb29yZDI7XFxudmVjMyBmcmFnMTtcXG52ZWMzIGZyYWcyO1xcbiNpZmRlZiBJU19TVEVSRU9TQ09QSUNfSE9SSVpcXG51c2VDYW1CPXZVVi54PjAuNTtcXG50ZXhDb29yZDE9dmVjMih1c2VDYW1CID8gKHZVVi54LTAuNSkqMi4wIDogdlVWLngqMi4wLHZVVi55KTtcXG50ZXhDb29yZDI9dmVjMih0ZXhDb29yZDEueCtzdGVwU2l6ZS54LHZVVi55KTtcXG4jZWxzZVxcbnVzZUNhbUI9dlVWLnk+MC41O1xcbnRleENvb3JkMT12ZWMyKHZVVi54LHVzZUNhbUIgPyAodlVWLnktMC41KSoyLjAgOiB2VVYueSoyLjApO1xcbnRleENvb3JkMj12ZWMyKHZVVi54LHRleENvb3JkMS55K3N0ZXBTaXplLnkpO1xcbiNlbmRpZlxcblxcbmlmICh1c2VDYW1CKXtcXG5mcmFnMT10ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdGV4Q29vcmQxKS5yZ2I7XFxuZnJhZzI9dGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHRleENvb3JkMikucmdiO1xcbn1lbHNle1xcbmZyYWcxPXRleHR1cmUyRChjYW1BU2FtcGxlciAsdGV4Q29vcmQxKS5yZ2I7XFxuZnJhZzI9dGV4dHVyZTJEKGNhbUFTYW1wbGVyICx0ZXhDb29yZDIpLnJnYjtcXG59XFxuZ2xfRnJhZ0NvbG9yPXZlYzQoKGZyYWcxK2ZyYWcyKS9UV08sMS4wKTtcXG59XCIsdGV4dDJkUGl4ZWxTaGFkZXI6XCJ2YXJ5aW5nIHZlYzQgdkNvbG9yO1xcbnZhcnlpbmcgdmVjMiB2VVY7XFxuXFxudW5pZm9ybSBzYW1wbGVyMkQgZGlmZnVzZVNhbXBsZXI7XFxudm9pZCBtYWluKHZvaWQpIHtcXG52ZWM0IGNvbG9yPXRleHR1cmUyRChkaWZmdXNlU2FtcGxlcix2VVYpO1xcbmlmIChjb2xvci5hPDAuMDUpXFxuZGlzY2FyZDtcXG5nbF9GcmFnQ29sb3I9Y29sb3IqdkNvbG9yO1xcbn1cIix0ZXh0MmRWZXJ0ZXhTaGFkZXI6XCJcXG4jaWZkZWYgSW5zdGFuY2VkXFxuI2RlZmluZSBhdHQgYXR0cmlidXRlXFxuI2Vsc2VcXG4jZGVmaW5lIGF0dCB1bmlmb3JtXFxuI2VuZGlmXFxuXFxuYXR0cmlidXRlIGZsb2F0IGluZGV4O1xcbmF0dCB2ZWMyIHpCaWFzO1xcbmF0dCB2ZWM0IHRyYW5zZm9ybVg7XFxuYXR0IHZlYzQgdHJhbnNmb3JtWTtcXG5hdHQgdmVjMiB0b3BMZWZ0VVY7XFxuYXR0IHZlYzIgc2l6ZVVWO1xcbmF0dCB2ZWMyIHRleHR1cmVTaXplO1xcbmF0dCB2ZWM0IGNvbG9yO1xcblxcbnZhcnlpbmcgdmVjMiB2VVY7XFxudmFyeWluZyB2ZWM0IHZDb2xvcjtcXG52b2lkIG1haW4odm9pZCkge1xcbnZlYzIgcG9zMjtcXG5cXG5pZiAoaW5kZXggPT0gMC4wKSB7XFxucG9zMj12ZWMyKDAuMCwwLjApO1xcbnZVVj12ZWMyKHRvcExlZnRVVi54LHRvcExlZnRVVi55K3NpemVVVi55KTtcXG59XFxuXFxuZWxzZSBpZiAoaW5kZXggPT0gMS4wKSB7XFxucG9zMj12ZWMyKDAuMCwxLjApO1xcbnZVVj12ZWMyKHRvcExlZnRVVi54LHRvcExlZnRVVi55KTtcXG59XFxuXFxuZWxzZSBpZiAoaW5kZXggPT0gMi4wKSB7XFxucG9zMj12ZWMyKDEuMCwxLjApO1xcbnZVVj12ZWMyKHRvcExlZnRVVi54K3NpemVVVi54LHRvcExlZnRVVi55KTtcXG59XFxuXFxuZWxzZSBpZiAoaW5kZXggPT0gMy4wKSB7XFxucG9zMj12ZWMyKDEuMCwwLjApO1xcbnZVVj12ZWMyKHRvcExlZnRVVi54K3NpemVVVi54LHRvcExlZnRVVi55K3NpemVVVi55KTtcXG59XFxuXFxudlVWPShmbG9vcih2VVYqdGV4dHVyZVNpemUpK3ZlYzIoMC4wLDAuMCkpL3RleHR1cmVTaXplO1xcbnZDb2xvcj1jb2xvcjtcXG52ZWM0IHBvcztcXG5wb3MueHk9Zmxvb3IocG9zMi54eSpzaXplVVYqdGV4dHVyZVNpemUpOyBcXG5wb3Muej0xLjA7XFxucG9zLnc9MS4wO1xcbmdsX1Bvc2l0aW9uPXZlYzQoZG90KHBvcyx0cmFuc2Zvcm1YKSxkb3QocG9zLHRyYW5zZm9ybVkpLHpCaWFzLngsMSk7XFxufVwiLHRvbmVtYXBQaXhlbFNoYWRlcjpcIlxcbnZhcnlpbmcgdmVjMiB2VVY7XFxudW5pZm9ybSBzYW1wbGVyMkQgdGV4dHVyZVNhbXBsZXI7XFxuXFxudW5pZm9ybSBmbG9hdCBfRXhwb3N1cmVBZGp1c3RtZW50O1xcbiNpZiBkZWZpbmVkKEhBQkxFX1RPTkVNQVBQSU5HKVxcbmNvbnN0IGZsb2F0IEE9MC4xNTtcXG5jb25zdCBmbG9hdCBCPTAuNTA7XFxuY29uc3QgZmxvYXQgQz0wLjEwO1xcbmNvbnN0IGZsb2F0IEQ9MC4yMDtcXG5jb25zdCBmbG9hdCBFPTAuMDI7XFxuY29uc3QgZmxvYXQgRj0wLjMwO1xcbmNvbnN0IGZsb2F0IFc9MTEuMjtcXG4jZW5kaWZcXG5mbG9hdCBMdW1pbmFuY2UodmVjMyBjKVxcbntcXG5yZXR1cm4gZG90KGMsdmVjMygwLjIyLDAuNzA3LDAuMDcxKSk7XFxufVxcbnZvaWQgbWFpbih2b2lkKSBcXG57XFxudmVjMyBjb2xvdXI9dGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVikucmdiO1xcbiNpZiBkZWZpbmVkKFJFSU5IQVJEX1RPTkVNQVBQSU5HKVxcbmZsb2F0IGx1bT1MdW1pbmFuY2UoY29sb3VyLnJnYik7IFxcbmZsb2F0IGx1bVRtPWx1bSpfRXhwb3N1cmVBZGp1c3RtZW50O1xcbmZsb2F0IHNjYWxlPWx1bVRtLygxLjArbHVtVG0pOyBcXG5jb2xvdXIqPXNjYWxlL2x1bTtcXG4jZWxpZiBkZWZpbmVkKEhBQkxFX1RPTkVNQVBQSU5HKVxcbmNvbG91cio9X0V4cG9zdXJlQWRqdXN0bWVudDtcXG5jb25zdCBmbG9hdCBFeHBvc3VyZUJpYXM9Mi4wO1xcbnZlYzMgeD1FeHBvc3VyZUJpYXMqY29sb3VyO1xcbnZlYzMgY3Vycj0oKHgqKEEqeCtDKkIpK0QqRSkvKHgqKEEqeCtCKStEKkYpKS1FL0Y7XFxueD12ZWMzKFcsVyxXKTtcXG52ZWMzIHdoaXRlU2NhbGU9MS4wLygoKHgqKEEqeCtDKkIpK0QqRSkvKHgqKEEqeCtCKStEKkYpKS1FL0YpO1xcbmNvbG91cj1jdXJyKndoaXRlU2NhbGU7XFxuI2VsaWYgZGVmaW5lZChPUFRJTUlaRURfSEVKSURBV1NPTl9UT05FTUFQUElORylcXG5jb2xvdXIqPV9FeHBvc3VyZUFkanVzdG1lbnQ7XFxudmVjMyBYPW1heCh2ZWMzKDAuMCwwLjAsMC4wKSxjb2xvdXItMC4wMDQpO1xcbnZlYzMgcmV0Q29sb3I9KFgqKDYuMipYKzAuNSkpLyhYKig2LjIqWCsxLjcpKzAuMDYpO1xcbmNvbG91cj1yZXRDb2xvcipyZXRDb2xvcjtcXG4jZWxpZiBkZWZpbmVkKFBIT1RPR1JBUEhJQ19UT05FTUFQUElORylcXG5jb2xvdXI9dmVjMygxLjAsMS4wLDEuMCktZXhwMigtX0V4cG9zdXJlQWRqdXN0bWVudCpjb2xvdXIpO1xcbiNlbmRpZlxcbmdsX0ZyYWdDb2xvcj12ZWM0KGNvbG91ci5yZ2IsMS4wKTtcXG59XCIsdm9sdW1ldHJpY0xpZ2h0U2NhdHRlcmluZ1BpeGVsU2hhZGVyOlwidW5pZm9ybSBzYW1wbGVyMkQgdGV4dHVyZVNhbXBsZXI7XFxudW5pZm9ybSBzYW1wbGVyMkQgbGlnaHRTY2F0dGVyaW5nU2FtcGxlcjtcXG51bmlmb3JtIGZsb2F0IGRlY2F5O1xcbnVuaWZvcm0gZmxvYXQgZXhwb3N1cmU7XFxudW5pZm9ybSBmbG9hdCB3ZWlnaHQ7XFxudW5pZm9ybSBmbG9hdCBkZW5zaXR5O1xcbnVuaWZvcm0gdmVjMiBtZXNoUG9zaXRpb25PblNjcmVlbjtcXG52YXJ5aW5nIHZlYzIgdlVWO1xcbnZvaWQgbWFpbih2b2lkKSB7XFxudmVjMiB0Yz12VVY7XFxudmVjMiBkZWx0YVRleENvb3JkPSh0Yy1tZXNoUG9zaXRpb25PblNjcmVlbi54eSk7XFxuZGVsdGFUZXhDb29yZCo9MS4wL2Zsb2F0KE5VTV9TQU1QTEVTKSpkZW5zaXR5O1xcbmZsb2F0IGlsbHVtaW5hdGlvbkRlY2F5PTEuMDtcXG52ZWM0IGNvbG9yPXRleHR1cmUyRChsaWdodFNjYXR0ZXJpbmdTYW1wbGVyLHRjKSowLjQ7XFxuZm9yKGludCBpPTA7IGk8TlVNX1NBTVBMRVM7IGkrKykge1xcbnRjLT1kZWx0YVRleENvb3JkO1xcbnZlYzQgc2FtcGxlPXRleHR1cmUyRChsaWdodFNjYXR0ZXJpbmdTYW1wbGVyLHRjKSowLjQ7XFxuc2FtcGxlKj1pbGx1bWluYXRpb25EZWNheSp3ZWlnaHQ7XFxuY29sb3IrPXNhbXBsZTtcXG5pbGx1bWluYXRpb25EZWNheSo9ZGVjYXk7XFxufVxcbnZlYzQgcmVhbENvbG9yPXRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcix2VVYpO1xcbmdsX0ZyYWdDb2xvcj0oKHZlYzQoKHZlYzMoY29sb3Iucixjb2xvci5nLGNvbG9yLmIpKmV4cG9zdXJlKSwxKSkrKHJlYWxDb2xvciooMS41LTAuNCkpKTtcXG59XFxuXCIsdm9sdW1ldHJpY0xpZ2h0U2NhdHRlcmluZ1Bhc3NQaXhlbFNoYWRlcjpcIiNpZiBkZWZpbmVkKEFMUEhBVEVTVCkgfHwgZGVmaW5lZChORUVEX1VWKVxcbnZhcnlpbmcgdmVjMiB2VVY7XFxuI2VuZGlmXFxuI2lmIGRlZmluZWQoQUxQSEFURVNUKVxcbnVuaWZvcm0gc2FtcGxlcjJEIGRpZmZ1c2VTYW1wbGVyO1xcbiNlbmRpZlxcbnZvaWQgbWFpbih2b2lkKVxcbntcXG4jaWYgZGVmaW5lZChBTFBIQVRFU1QpXFxudmVjNCBkaWZmdXNlQ29sb3I9dGV4dHVyZTJEKGRpZmZ1c2VTYW1wbGVyLHZVVik7XFxuaWYgKGRpZmZ1c2VDb2xvci5hPDAuNClcXG5kaXNjYXJkO1xcbiNlbmRpZlxcbmdsX0ZyYWdDb2xvcj12ZWM0KDAuMCwwLjAsMC4wLDEuMCk7XFxufVxcblwiLHZyRGlzdG9ydGlvbkNvcnJlY3Rpb25QaXhlbFNoYWRlcjpcIlxcbnZhcnlpbmcgdmVjMiB2VVY7XFxudW5pZm9ybSBzYW1wbGVyMkQgdGV4dHVyZVNhbXBsZXI7XFxudW5pZm9ybSB2ZWMyIExlbnNDZW50ZXI7XFxudW5pZm9ybSB2ZWMyIFNjYWxlO1xcbnVuaWZvcm0gdmVjMiBTY2FsZUluO1xcbnVuaWZvcm0gdmVjNCBIbWRXYXJwUGFyYW07XFxudmVjMiBIbWRXYXJwKHZlYzIgaW4wMSkge1xcbnZlYzIgdGhldGE9KGluMDEtTGVuc0NlbnRlcikqU2NhbGVJbjsgXFxuZmxvYXQgclNxPXRoZXRhLngqdGhldGEueCt0aGV0YS55KnRoZXRhLnk7XFxudmVjMiBydmVjdG9yPXRoZXRhKihIbWRXYXJwUGFyYW0ueCtIbWRXYXJwUGFyYW0ueSpyU3ErSG1kV2FycFBhcmFtLnoqclNxKnJTcStIbWRXYXJwUGFyYW0udypyU3EqclNxKnJTcSk7XFxucmV0dXJuIExlbnNDZW50ZXIrU2NhbGUqcnZlY3RvcjtcXG59XFxudm9pZCBtYWluKHZvaWQpXFxue1xcbnZlYzIgdGM9SG1kV2FycCh2VVYpO1xcbmlmICh0Yy54IDwwLjAgfHwgdGMueD4xLjAgfHwgdGMueTwwLjAgfHwgdGMueT4xLjApXFxuZ2xfRnJhZ0NvbG9yPXZlYzQoMC4wLDAuMCwwLjAsMS4wKTtcXG5lbHNle1xcbmdsX0ZyYWdDb2xvcj12ZWM0KHRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcix0YykucmdiLDEuMCk7XFxufVxcbn1cIn0sQkFCWUxPTi5FZmZlY3QuSW5jbHVkZXNTaGFkZXJzU3RvcmU9e2JvbmVzRGVjbGFyYXRpb246XCIjaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+MFxcbnVuaWZvcm0gbWF0NCBtQm9uZXNbQm9uZXNQZXJNZXNoXTtcXG5hdHRyaWJ1dGUgdmVjNCBtYXRyaWNlc0luZGljZXM7XFxuYXR0cmlidXRlIHZlYzQgbWF0cmljZXNXZWlnaHRzO1xcbiNpZiBOVU1fQk9ORV9JTkZMVUVOQ0VSUz40XFxuYXR0cmlidXRlIHZlYzQgbWF0cmljZXNJbmRpY2VzRXh0cmE7XFxuYXR0cmlidXRlIHZlYzQgbWF0cmljZXNXZWlnaHRzRXh0cmE7XFxuI2VuZGlmXFxuI2VuZGlmXCIsYm9uZXNWZXJ0ZXg6XCIjaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+MFxcbm1hdDQgaW5mbHVlbmNlO1xcbmluZmx1ZW5jZT1tQm9uZXNbaW50KG1hdHJpY2VzSW5kaWNlc1swXSldKm1hdHJpY2VzV2VpZ2h0c1swXTtcXG4jaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+MVxcbmluZmx1ZW5jZSs9bUJvbmVzW2ludChtYXRyaWNlc0luZGljZXNbMV0pXSptYXRyaWNlc1dlaWdodHNbMV07XFxuI2VuZGlmIFxcbiNpZiBOVU1fQk9ORV9JTkZMVUVOQ0VSUz4yXFxuaW5mbHVlbmNlKz1tQm9uZXNbaW50KG1hdHJpY2VzSW5kaWNlc1syXSldKm1hdHJpY2VzV2VpZ2h0c1syXTtcXG4jZW5kaWYgXFxuI2lmIE5VTV9CT05FX0lORkxVRU5DRVJTPjNcXG5pbmZsdWVuY2UrPW1Cb25lc1tpbnQobWF0cmljZXNJbmRpY2VzWzNdKV0qbWF0cmljZXNXZWlnaHRzWzNdO1xcbiNlbmRpZiBcXG4jaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+NFxcbmluZmx1ZW5jZSs9bUJvbmVzW2ludChtYXRyaWNlc0luZGljZXNFeHRyYVswXSldKm1hdHJpY2VzV2VpZ2h0c0V4dHJhWzBdO1xcbiNlbmRpZiBcXG4jaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+NVxcbmluZmx1ZW5jZSs9bUJvbmVzW2ludChtYXRyaWNlc0luZGljZXNFeHRyYVsxXSldKm1hdHJpY2VzV2VpZ2h0c0V4dHJhWzFdO1xcbiNlbmRpZiBcXG4jaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+NlxcbmluZmx1ZW5jZSs9bUJvbmVzW2ludChtYXRyaWNlc0luZGljZXNFeHRyYVsyXSldKm1hdHJpY2VzV2VpZ2h0c0V4dHJhWzJdO1xcbiNlbmRpZiBcXG4jaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+N1xcbmluZmx1ZW5jZSs9bUJvbmVzW2ludChtYXRyaWNlc0luZGljZXNFeHRyYVszXSldKm1hdHJpY2VzV2VpZ2h0c0V4dHJhWzNdO1xcbiNlbmRpZiBcXG5maW5hbFdvcmxkPWZpbmFsV29ybGQqaW5mbHVlbmNlO1xcbiNlbmRpZlwiLGJ1bXBGcmFnbWVudDpcIiNpZmRlZiBCVU1QXFxudmVjMiBidW1wVVY9dkJ1bXBVVjtcXG4jZW5kaWZcXG4jaWYgZGVmaW5lZChCVU1QKSB8fCBkZWZpbmVkKFBBUkFMTEFYKVxcbm1hdDMgVEJOPWNvdGFuZ2VudF9mcmFtZShub3JtYWxXKnZCdW1wSW5mb3MueSwtdmlld0RpcmVjdGlvblcsYnVtcFVWKTtcXG4jZW5kaWZcXG4jaWZkZWYgUEFSQUxMQVhcXG5tYXQzIGludlRCTj10cmFuc3Bvc2VNYXQzKFRCTik7XFxuI2lmZGVmIFBBUkFMTEFYT0NDTFVTSU9OXFxudmVjMiB1dk9mZnNldD1wYXJhbGxheE9jY2x1c2lvbihpbnZUQk4qLXZpZXdEaXJlY3Rpb25XLGludlRCTipub3JtYWxXLGJ1bXBVVix2QnVtcEluZm9zLnopO1xcbiNlbHNlXFxudmVjMiB1dk9mZnNldD1wYXJhbGxheE9mZnNldChpbnZUQk4qdmlld0RpcmVjdGlvblcsdkJ1bXBJbmZvcy56KTtcXG4jZW5kaWZcXG5kaWZmdXNlVVYrPXV2T2Zmc2V0O1xcbmJ1bXBVVis9dXZPZmZzZXQ7XFxuI2VuZGlmXFxuI2lmZGVmIEJVTVBcXG5ub3JtYWxXPXBlcnR1cmJOb3JtYWwodmlld0RpcmVjdGlvblcsVEJOLGJ1bXBVVik7XFxuI2VuZGlmXCIsYnVtcEZyYWdtZW50RnVuY3Rpb25zOlwiI2lmZGVmIEJVTVBcXG52YXJ5aW5nIHZlYzIgdkJ1bXBVVjtcXG51bmlmb3JtIHZlYzMgdkJ1bXBJbmZvcztcXG51bmlmb3JtIHNhbXBsZXIyRCBidW1wU2FtcGxlcjtcXG5cXG5tYXQzIGNvdGFuZ2VudF9mcmFtZSh2ZWMzIG5vcm1hbCx2ZWMzIHAsdmVjMiB1dilcXG57XFxuXFxudmVjMyBkcDE9ZEZkeChwKTtcXG52ZWMzIGRwMj1kRmR5KHApO1xcbnZlYzIgZHV2MT1kRmR4KHV2KTtcXG52ZWMyIGR1djI9ZEZkeSh1dik7XFxuXFxudmVjMyBkcDJwZXJwPWNyb3NzKGRwMixub3JtYWwpO1xcbnZlYzMgZHAxcGVycD1jcm9zcyhub3JtYWwsZHAxKTtcXG52ZWMzIHRhbmdlbnQ9ZHAycGVycCpkdXYxLngrZHAxcGVycCpkdXYyLng7XFxudmVjMyBiaW5vcm1hbD1kcDJwZXJwKmR1djEueStkcDFwZXJwKmR1djIueTtcXG5cXG5mbG9hdCBpbnZtYXg9aW52ZXJzZXNxcnQobWF4KGRvdCh0YW5nZW50LHRhbmdlbnQpLGRvdChiaW5vcm1hbCxiaW5vcm1hbCkpKTtcXG5yZXR1cm4gbWF0Myh0YW5nZW50Kmludm1heCxiaW5vcm1hbCppbnZtYXgsbm9ybWFsKTtcXG59XFxudmVjMyBwZXJ0dXJiTm9ybWFsKHZlYzMgdmlld0RpcixtYXQzIGNvdGFuZ2VudEZyYW1lLHZlYzIgdXYpXFxue1xcbnZlYzMgbWFwPXRleHR1cmUyRChidW1wU2FtcGxlcix1dikueHl6O1xcbiNpZmRlZiBJTlZFUlROT1JNQUxNQVBYXFxubWFwLng9MS4wLW1hcC54O1xcbiNlbmRpZlxcbiNpZmRlZiBJTlZFUlROT1JNQUxNQVBZXFxubWFwLnk9MS4wLW1hcC55O1xcbiNlbmRpZlxcbm1hcD1tYXAqMjU1Li8xMjcuLTEyOC4vMTI3LjtcXG5yZXR1cm4gbm9ybWFsaXplKGNvdGFuZ2VudEZyYW1lKm1hcCk7XFxufVxcbiNpZmRlZiBQQVJBTExBWFxcbmNvbnN0IGZsb2F0IG1pblNhbXBsZXM9NC47XFxuY29uc3QgZmxvYXQgbWF4U2FtcGxlcz0xNS47XFxuY29uc3QgaW50IGlNYXhTYW1wbGVzPTE1O1xcblxcbnZlYzIgcGFyYWxsYXhPY2NsdXNpb24odmVjMyB2Vmlld0RpckNvVCx2ZWMzIHZOb3JtYWxDb1QsdmVjMiB0ZXhDb29yZCxmbG9hdCBwYXJhbGxheFNjYWxlKSB7XFxuZmxvYXQgcGFyYWxsYXhMaW1pdD1sZW5ndGgodlZpZXdEaXJDb1QueHkpL3ZWaWV3RGlyQ29ULno7XFxucGFyYWxsYXhMaW1pdCo9cGFyYWxsYXhTY2FsZTtcXG52ZWMyIHZPZmZzZXREaXI9bm9ybWFsaXplKHZWaWV3RGlyQ29ULnh5KTtcXG52ZWMyIHZNYXhPZmZzZXQ9dk9mZnNldERpcipwYXJhbGxheExpbWl0O1xcbmZsb2F0IG51bVNhbXBsZXM9bWF4U2FtcGxlcysoZG90KHZWaWV3RGlyQ29ULHZOb3JtYWxDb1QpKihtaW5TYW1wbGVzLW1heFNhbXBsZXMpKTtcXG5mbG9hdCBzdGVwU2l6ZT0xLjAvbnVtU2FtcGxlcztcXG5cXG5mbG9hdCBjdXJyUmF5SGVpZ2h0PTEuMDtcXG52ZWMyIHZDdXJyT2Zmc2V0PXZlYzIoMCwwKTtcXG52ZWMyIHZMYXN0T2Zmc2V0PXZlYzIoMCwwKTtcXG5mbG9hdCBsYXN0U2FtcGxlZEhlaWdodD0xLjA7XFxuZmxvYXQgY3VyclNhbXBsZWRIZWlnaHQ9MS4wO1xcbmZvciAoaW50IGk9MDsgaTxpTWF4U2FtcGxlczsgaSsrKVxcbntcXG5jdXJyU2FtcGxlZEhlaWdodD10ZXh0dXJlMkQoYnVtcFNhbXBsZXIsdkJ1bXBVVit2Q3Vyck9mZnNldCkudztcXG5cXG5pZiAoY3VyclNhbXBsZWRIZWlnaHQ+Y3VyclJheUhlaWdodClcXG57XFxuZmxvYXQgZGVsdGExPWN1cnJTYW1wbGVkSGVpZ2h0LWN1cnJSYXlIZWlnaHQ7XFxuZmxvYXQgZGVsdGEyPShjdXJyUmF5SGVpZ2h0K3N0ZXBTaXplKS1sYXN0U2FtcGxlZEhlaWdodDtcXG5mbG9hdCByYXRpbz1kZWx0YTEvKGRlbHRhMStkZWx0YTIpO1xcbnZDdXJyT2Zmc2V0PShyYXRpbykqIHZMYXN0T2Zmc2V0KygxLjAtcmF0aW8pKnZDdXJyT2Zmc2V0O1xcblxcbmJyZWFrO1xcbn1cXG5lbHNlXFxue1xcbmN1cnJSYXlIZWlnaHQtPXN0ZXBTaXplO1xcbnZMYXN0T2Zmc2V0PXZDdXJyT2Zmc2V0O1xcbnZDdXJyT2Zmc2V0Kz1zdGVwU2l6ZSp2TWF4T2Zmc2V0O1xcbmxhc3RTYW1wbGVkSGVpZ2h0PWN1cnJTYW1wbGVkSGVpZ2h0O1xcbn1cXG59XFxucmV0dXJuIHZDdXJyT2Zmc2V0O1xcbn1cXG52ZWMyIHBhcmFsbGF4T2Zmc2V0KHZlYzMgdmlld0RpcixmbG9hdCBoZWlnaHRTY2FsZSlcXG57XFxuXFxuZmxvYXQgaGVpZ2h0PXRleHR1cmUyRChidW1wU2FtcGxlcix2QnVtcFVWKS53O1xcbnZlYzIgdGV4Q29vcmRPZmZzZXQ9aGVpZ2h0U2NhbGUqdmlld0Rpci54eSpoZWlnaHQ7XFxucmV0dXJuIC10ZXhDb29yZE9mZnNldDtcXG59XFxuI2VuZGlmXFxuI2VuZGlmXCIsY2xpcFBsYW5lRnJhZ21lbnQ6XCIjaWZkZWYgQ0xJUFBMQU5FXFxuaWYgKGZDbGlwRGlzdGFuY2U+MC4wKVxcbntcXG5kaXNjYXJkO1xcbn1cXG4jZW5kaWZcIixjbGlwUGxhbmVGcmFnbWVudERlY2xhcmF0aW9uOlwiI2lmZGVmIENMSVBQTEFORVxcbnZhcnlpbmcgZmxvYXQgZkNsaXBEaXN0YW5jZTtcXG4jZW5kaWZcIixjbGlwUGxhbmVWZXJ0ZXg6XCIjaWZkZWYgQ0xJUFBMQU5FXFxuZkNsaXBEaXN0YW5jZT1kb3Qod29ybGRQb3MsdkNsaXBQbGFuZSk7XFxuI2VuZGlmXCIsY2xpcFBsYW5lVmVydGV4RGVjbGFyYXRpb246XCIjaWZkZWYgQ0xJUFBMQU5FXFxudW5pZm9ybSB2ZWM0IHZDbGlwUGxhbmU7XFxudmFyeWluZyBmbG9hdCBmQ2xpcERpc3RhbmNlO1xcbiNlbmRpZlwiLGNvbG9yQ3VydmVzOlwiY29uc3QgdmVjMyBIRFRWUmVjNzA5X1JHQkx1bWluYW5jZUNvZWZmaWNpZW50cz12ZWMzKDAuMjEyNiwwLjcxNTIsMC4wNzIyKTtcXG52ZWMzIGFwcGx5Q29sb3JDdXJ2ZXModmVjMyBvcmlnaW5hbCkge1xcbnZlYzMgcmVzdWx0PW9yaWdpbmFsO1xcblxcblxcblxcbmZsb2F0IGx1bWE9ZG90KHJlc3VsdC5yZ2IsSERUVlJlYzcwOV9SR0JMdW1pbmFuY2VDb2VmZmljaWVudHMpO1xcbnZlYzIgY3VydmVNaXg9Y2xhbXAodmVjMihsdW1hKjMuMC0xLjUsbHVtYSotMy4wKzEuNSksdmVjMigwLjAsMC4wKSx2ZWMyKDEuMCwxLjApKTtcXG52ZWM0IGNvbG9yQ3VydmU9dkNhbWVyYUNvbG9yQ3VydmVOZXV0cmFsK2N1cnZlTWl4LngqdkNhbWVyYUNvbG9yQ3VydmVQb3NpdGl2ZS1jdXJ2ZU1peC55KnZDYW1lcmFDb2xvckN1cnZlTmVnYXRpdmU7XFxucmVzdWx0LnJnYio9Y29sb3JDdXJ2ZS5yZ2I7XFxucmVzdWx0LnJnYj1taXgodmVjMyhsdW1hLGx1bWEsbHVtYSkscmVzdWx0LnJnYixjb2xvckN1cnZlLmEpO1xcbnJldHVybiByZXN1bHQ7XFxufVwiLGNvbG9yQ3VydmVzRGVmaW5pdGlvbjpcInVuaWZvcm0gdmVjNCB2Q2FtZXJhQ29sb3JDdXJ2ZU5ldXRyYWw7XFxudW5pZm9ybSB2ZWM0IHZDYW1lcmFDb2xvckN1cnZlUG9zaXRpdmU7XFxudW5pZm9ybSB2ZWM0IHZDYW1lcmFDb2xvckN1cnZlTmVnYXRpdmU7XCIsY29sb3JHcmFkaW5nOlwidmVjNCBjb2xvckdyYWRlcyh2ZWM0IGNvbG9yKSBcXG57IFxcblxcbmZsb2F0IHNsaWNlQ29udGludW91cz1jb2xvci56KnZDYW1lcmFDb2xvckdyYWRpbmdJbmZvcy56O1xcbmZsb2F0IHNsaWNlSW50ZWdlcj1mbG9vcihzbGljZUNvbnRpbnVvdXMpO1xcblxcblxcbmZsb2F0IHNsaWNlRnJhY3Rpb249c2xpY2VDb250aW51b3VzLXNsaWNlSW50ZWdlcjsgXFxuXFxudmVjMiBzbGljZVVWPWNvbG9yLnh5KnZDYW1lcmFDb2xvckdyYWRpbmdTY2FsZU9mZnNldC54eSt2Q2FtZXJhQ29sb3JHcmFkaW5nU2NhbGVPZmZzZXQuenc7XFxuXFxuXFxuc2xpY2VVVi54Kz1zbGljZUludGVnZXIqdkNhbWVyYUNvbG9yR3JhZGluZ0luZm9zLnc7XFxudmVjNCBzbGljZTBDb2xvcj10ZXh0dXJlMkQoY2FtZXJhQ29sb3JHcmFkaW5nMkRTYW1wbGVyLHNsaWNlVVYpO1xcbnNsaWNlVVYueCs9dkNhbWVyYUNvbG9yR3JhZGluZ0luZm9zLnc7XFxudmVjNCBzbGljZTFDb2xvcj10ZXh0dXJlMkQoY2FtZXJhQ29sb3JHcmFkaW5nMkRTYW1wbGVyLHNsaWNlVVYpO1xcbnZlYzMgcmVzdWx0PW1peChzbGljZTBDb2xvci5yZ2Isc2xpY2UxQ29sb3IucmdiLHNsaWNlRnJhY3Rpb24pO1xcbmNvbG9yLnJnYj1taXgoY29sb3IucmdiLHJlc3VsdCx2Q2FtZXJhQ29sb3JHcmFkaW5nSW5mb3MueCk7XFxucmV0dXJuIGNvbG9yO1xcbn1cIixjb2xvckdyYWRpbmdEZWZpbml0aW9uOlwidW5pZm9ybSBzYW1wbGVyMkQgY2FtZXJhQ29sb3JHcmFkaW5nMkRTYW1wbGVyO1xcbnVuaWZvcm0gdmVjNCB2Q2FtZXJhQ29sb3JHcmFkaW5nSW5mb3M7XFxudW5pZm9ybSB2ZWM0IHZDYW1lcmFDb2xvckdyYWRpbmdTY2FsZU9mZnNldDtcIixmb2dGcmFnbWVudDpcIiNpZmRlZiBGT0dcXG5mbG9hdCBmb2c9Q2FsY0ZvZ0ZhY3RvcigpO1xcbmNvbG9yLnJnYj1mb2cqY29sb3IucmdiKygxLjAtZm9nKSp2Rm9nQ29sb3I7XFxuI2VuZGlmXCIsZm9nRnJhZ21lbnREZWNsYXJhdGlvbjpcIiNpZmRlZiBGT0dcXG4jZGVmaW5lIEZPR01PREVfTk9ORSAwLlxcbiNkZWZpbmUgRk9HTU9ERV9FWFAgMS5cXG4jZGVmaW5lIEZPR01PREVfRVhQMiAyLlxcbiNkZWZpbmUgRk9HTU9ERV9MSU5FQVIgMy5cXG4jZGVmaW5lIEUgMi43MTgyOFxcbnVuaWZvcm0gdmVjNCB2Rm9nSW5mb3M7XFxudW5pZm9ybSB2ZWMzIHZGb2dDb2xvcjtcXG52YXJ5aW5nIGZsb2F0IGZGb2dEaXN0YW5jZTtcXG5mbG9hdCBDYWxjRm9nRmFjdG9yKClcXG57XFxuZmxvYXQgZm9nQ29lZmY9MS4wO1xcbmZsb2F0IGZvZ1N0YXJ0PXZGb2dJbmZvcy55O1xcbmZsb2F0IGZvZ0VuZD12Rm9nSW5mb3MuejtcXG5mbG9hdCBmb2dEZW5zaXR5PXZGb2dJbmZvcy53O1xcbmlmIChGT0dNT0RFX0xJTkVBUiA9PSB2Rm9nSW5mb3MueClcXG57XFxuZm9nQ29lZmY9KGZvZ0VuZC1mRm9nRGlzdGFuY2UpLyhmb2dFbmQtZm9nU3RhcnQpO1xcbn1cXG5lbHNlIGlmIChGT0dNT0RFX0VYUCA9PSB2Rm9nSW5mb3MueClcXG57XFxuZm9nQ29lZmY9MS4wL3BvdyhFLGZGb2dEaXN0YW5jZSpmb2dEZW5zaXR5KTtcXG59XFxuZWxzZSBpZiAoRk9HTU9ERV9FWFAyID09IHZGb2dJbmZvcy54KVxcbntcXG5mb2dDb2VmZj0xLjAvcG93KEUsZkZvZ0Rpc3RhbmNlKmZGb2dEaXN0YW5jZSpmb2dEZW5zaXR5KmZvZ0RlbnNpdHkpO1xcbn1cXG5yZXR1cm4gY2xhbXAoZm9nQ29lZmYsMC4wLDEuMCk7XFxufVxcbiNlbmRpZlwiLGZvZ1ZlcnRleDpcIiNpZmRlZiBGT0dcXG5mRm9nRGlzdGFuY2U9KHZpZXcqd29ybGRQb3MpLno7XFxuI2VuZGlmXCIsZm9nVmVydGV4RGVjbGFyYXRpb246XCIjaWZkZWYgRk9HXFxudmFyeWluZyBmbG9hdCBmRm9nRGlzdGFuY2U7XFxuI2VuZGlmXCIsZnJlc25lbEZ1bmN0aW9uOlwiI2lmZGVmIEZSRVNORUxcXG5mbG9hdCBjb21wdXRlRnJlc25lbFRlcm0odmVjMyB2aWV3RGlyZWN0aW9uLHZlYzMgd29ybGROb3JtYWwsZmxvYXQgYmlhcyxmbG9hdCBwb3dlcilcXG57XFxuZmxvYXQgZnJlc25lbFRlcm09cG93KGJpYXMrYWJzKGRvdCh2aWV3RGlyZWN0aW9uLHdvcmxkTm9ybWFsKSkscG93ZXIpO1xcbnJldHVybiBjbGFtcChmcmVzbmVsVGVybSwwLiwxLik7XFxufVxcbiNlbmRpZlwiLGhhcm1vbmljc0Z1bmN0aW9uczpcIiNpZmRlZiBVU0VTUEhFUklDQUxGUk9NUkVGTEVDVElPTk1BUFxcbnVuaWZvcm0gdmVjMyB2U3BoZXJpY2FsWDtcXG51bmlmb3JtIHZlYzMgdlNwaGVyaWNhbFk7XFxudW5pZm9ybSB2ZWMzIHZTcGhlcmljYWxaO1xcbnVuaWZvcm0gdmVjMyB2U3BoZXJpY2FsWFg7XFxudW5pZm9ybSB2ZWMzIHZTcGhlcmljYWxZWTtcXG51bmlmb3JtIHZlYzMgdlNwaGVyaWNhbFpaO1xcbnVuaWZvcm0gdmVjMyB2U3BoZXJpY2FsWFk7XFxudW5pZm9ybSB2ZWMzIHZTcGhlcmljYWxZWjtcXG51bmlmb3JtIHZlYzMgdlNwaGVyaWNhbFpYO1xcbnZlYzMgRW52aXJvbm1lbnRJcnJhZGlhbmNlKHZlYzMgbm9ybWFsKVxcbntcXG5cXG5cXG5cXG52ZWMzIHJlc3VsdCA9XFxudlNwaGVyaWNhbFgqbm9ybWFsLnggK1xcbnZTcGhlcmljYWxZKm5vcm1hbC55ICtcXG52U3BoZXJpY2FsWipub3JtYWwueiArXFxudlNwaGVyaWNhbFhYKm5vcm1hbC54Km5vcm1hbC54ICtcXG52U3BoZXJpY2FsWVkqbm9ybWFsLnkqbm9ybWFsLnkgK1xcbnZTcGhlcmljYWxaWipub3JtYWwueipub3JtYWwueiArXFxudlNwaGVyaWNhbFlaKm5vcm1hbC55Km5vcm1hbC56ICtcXG52U3BoZXJpY2FsWlgqbm9ybWFsLnoqbm9ybWFsLnggK1xcbnZTcGhlcmljYWxYWSpub3JtYWwueCpub3JtYWwueTtcXG5yZXR1cm4gcmVzdWx0LnJnYjtcXG59XFxuI2VuZGlmXCIsaGVscGVyRnVuY3Rpb25zOlwibWF0MyB0cmFuc3Bvc2VNYXQzKG1hdDMgaW5NYXRyaXgpIHtcXG52ZWMzIGkwPWluTWF0cml4WzBdO1xcbnZlYzMgaTE9aW5NYXRyaXhbMV07XFxudmVjMyBpMj1pbk1hdHJpeFsyXTtcXG5tYXQzIG91dE1hdHJpeD1tYXQzKFxcbnZlYzMoaTAueCxpMS54LGkyLngpLFxcbnZlYzMoaTAueSxpMS55LGkyLnkpLFxcbnZlYzMoaTAueixpMS56LGkyLnopXFxuKTtcXG5yZXR1cm4gb3V0TWF0cml4O1xcbn1cIixpbnN0YW5jZXNEZWNsYXJhdGlvbjpcIiNpZmRlZiBJTlNUQU5DRVNcXG5hdHRyaWJ1dGUgdmVjNCB3b3JsZDA7XFxuYXR0cmlidXRlIHZlYzQgd29ybGQxO1xcbmF0dHJpYnV0ZSB2ZWM0IHdvcmxkMjtcXG5hdHRyaWJ1dGUgdmVjNCB3b3JsZDM7XFxuI2Vsc2VcXG51bmlmb3JtIG1hdDQgd29ybGQ7XFxuI2VuZGlmXCIsaW5zdGFuY2VzVmVydGV4OlwiI2lmZGVmIElOU1RBTkNFU1xcbm1hdDQgZmluYWxXb3JsZD1tYXQ0KHdvcmxkMCx3b3JsZDEsd29ybGQyLHdvcmxkMyk7XFxuI2Vsc2VcXG5tYXQ0IGZpbmFsV29ybGQ9d29ybGQ7XFxuI2VuZGlmXCIsbGlnaHRGcmFnbWVudDpcIiNpZmRlZiBMSUdIVHtYfVxcbiNpZm5kZWYgU1BFQ1VMQVJURVJNXFxudmVjMyB2TGlnaHRTcGVjdWxhcntYfT12ZWMzKDAuKTtcXG4jZW5kaWZcXG4jaWZkZWYgU1BPVExJR0hUe1h9XFxuaW5mbz1jb21wdXRlU3BvdExpZ2h0aW5nKHZpZXdEaXJlY3Rpb25XLG5vcm1hbFcsdkxpZ2h0RGF0YXtYfSx2TGlnaHREaXJlY3Rpb257WH0sdkxpZ2h0RGlmZnVzZXtYfS5yZ2IsdkxpZ2h0U3BlY3VsYXJ7WH0sdkxpZ2h0RGlmZnVzZXtYfS5hLGdsb3NzaW5lc3MpO1xcbiNlbmRpZlxcbiNpZmRlZiBIRU1JTElHSFR7WH1cXG5pbmZvPWNvbXB1dGVIZW1pc3BoZXJpY0xpZ2h0aW5nKHZpZXdEaXJlY3Rpb25XLG5vcm1hbFcsdkxpZ2h0RGF0YXtYfSx2TGlnaHREaWZmdXNle1h9LnJnYix2TGlnaHRTcGVjdWxhcntYfSx2TGlnaHRHcm91bmR7WH0sZ2xvc3NpbmVzcyk7XFxuI2VuZGlmXFxuI2lmIGRlZmluZWQoUE9JTlRMSUdIVHtYfSkgfHwgZGVmaW5lZChESVJMSUdIVHtYfSlcXG5pbmZvPWNvbXB1dGVMaWdodGluZyh2aWV3RGlyZWN0aW9uVyxub3JtYWxXLHZMaWdodERhdGF7WH0sdkxpZ2h0RGlmZnVzZXtYfS5yZ2IsdkxpZ2h0U3BlY3VsYXJ7WH0sdkxpZ2h0RGlmZnVzZXtYfS5hLGdsb3NzaW5lc3MpO1xcbiNlbmRpZlxcbiNpZmRlZiBTSEFET1d7WH1cXG4jaWZkZWYgU0hBRE9XVlNNe1h9XFxuc2hhZG93PWNvbXB1dGVTaGFkb3dXaXRoVlNNKHZQb3NpdGlvbkZyb21MaWdodHtYfSxzaGFkb3dTYW1wbGVye1h9LHNoYWRvd3NJbmZve1h9Lnosc2hhZG93c0luZm97WH0ueCk7XFxuI2Vsc2VcXG4jaWZkZWYgU0hBRE9XUENGe1h9XFxuI2lmIGRlZmluZWQoUE9JTlRMSUdIVHtYfSlcXG5zaGFkb3c9Y29tcHV0ZVNoYWRvd1dpdGhQQ0ZDdWJlKHZMaWdodERhdGF7WH0ueHl6LHNoYWRvd1NhbXBsZXJ7WH0sc2hhZG93c0luZm97WH0ueSxzaGFkb3dzSW5mb3tYfS56LHNoYWRvd3NJbmZve1h9LngpO1xcbiNlbHNlXFxuc2hhZG93PWNvbXB1dGVTaGFkb3dXaXRoUENGKHZQb3NpdGlvbkZyb21MaWdodHtYfSxzaGFkb3dTYW1wbGVye1h9LHNoYWRvd3NJbmZve1h9Lnksc2hhZG93c0luZm97WH0ueixzaGFkb3dzSW5mb3tYfS54KTtcXG4jZW5kaWZcXG4jZWxzZVxcbiNpZiBkZWZpbmVkKFBPSU5UTElHSFR7WH0pXFxuc2hhZG93PWNvbXB1dGVTaGFkb3dDdWJlKHZMaWdodERhdGF7WH0ueHl6LHNoYWRvd1NhbXBsZXJ7WH0sc2hhZG93c0luZm97WH0ueCxzaGFkb3dzSW5mb3tYfS56KTtcXG4jZWxzZVxcbnNoYWRvdz1jb21wdXRlU2hhZG93KHZQb3NpdGlvbkZyb21MaWdodHtYfSxzaGFkb3dTYW1wbGVye1h9LHNoYWRvd3NJbmZve1h9Lngsc2hhZG93c0luZm97WH0ueik7XFxuI2VuZGlmXFxuI2VuZGlmXFxuI2VuZGlmXFxuI2Vsc2VcXG5zaGFkb3c9MS47XFxuI2VuZGlmXFxuZGlmZnVzZUJhc2UrPWluZm8uZGlmZnVzZSpzaGFkb3c7XFxuI2lmZGVmIFNQRUNVTEFSVEVSTVxcbnNwZWN1bGFyQmFzZSs9aW5mby5zcGVjdWxhcipzaGFkb3c7XFxuI2VuZGlmXFxuI2VuZGlmXCIsbGlnaHRGcmFnbWVudERlY2xhcmF0aW9uOlwiI2lmZGVmIExJR0hUe1h9XFxudW5pZm9ybSB2ZWM0IHZMaWdodERhdGF7WH07XFxudW5pZm9ybSB2ZWM0IHZMaWdodERpZmZ1c2V7WH07XFxuI2lmZGVmIFNQRUNVTEFSVEVSTVxcbnVuaWZvcm0gdmVjMyB2TGlnaHRTcGVjdWxhcntYfTtcXG4jZW5kaWZcXG4jaWZkZWYgU0hBRE9Xe1h9XFxuI2lmIGRlZmluZWQoU1BPVExJR0hUe1h9KSB8fCBkZWZpbmVkKERJUkxJR0hUe1h9KVxcbnZhcnlpbmcgdmVjNCB2UG9zaXRpb25Gcm9tTGlnaHR7WH07XFxudW5pZm9ybSBzYW1wbGVyMkQgc2hhZG93U2FtcGxlcntYfTtcXG4jZWxzZVxcbnVuaWZvcm0gc2FtcGxlckN1YmUgc2hhZG93U2FtcGxlcntYfTtcXG4jZW5kaWZcXG51bmlmb3JtIHZlYzMgc2hhZG93c0luZm97WH07XFxuI2VuZGlmXFxuI2lmZGVmIFNQT1RMSUdIVHtYfVxcbnVuaWZvcm0gdmVjNCB2TGlnaHREaXJlY3Rpb257WH07XFxuI2VuZGlmXFxuI2lmZGVmIEhFTUlMSUdIVHtYfVxcbnVuaWZvcm0gdmVjMyB2TGlnaHRHcm91bmR7WH07XFxuI2VuZGlmXFxuI2VuZGlmXCIsbGlnaHRzRnJhZ21lbnRGdW5jdGlvbnM6XCJcXG5zdHJ1Y3QgbGlnaHRpbmdJbmZvXFxue1xcbnZlYzMgZGlmZnVzZTtcXG4jaWZkZWYgU1BFQ1VMQVJURVJNXFxudmVjMyBzcGVjdWxhcjtcXG4jZW5kaWZcXG59O1xcbmxpZ2h0aW5nSW5mbyBjb21wdXRlTGlnaHRpbmcodmVjMyB2aWV3RGlyZWN0aW9uVyx2ZWMzIHZOb3JtYWwsdmVjNCBsaWdodERhdGEsdmVjMyBkaWZmdXNlQ29sb3IsdmVjMyBzcGVjdWxhckNvbG9yLGZsb2F0IHJhbmdlLGZsb2F0IGdsb3NzaW5lc3MpIHtcXG5saWdodGluZ0luZm8gcmVzdWx0O1xcbnZlYzMgbGlnaHRWZWN0b3JXO1xcbmZsb2F0IGF0dGVudWF0aW9uPTEuMDtcXG5pZiAobGlnaHREYXRhLncgPT0gMC4pXFxue1xcbnZlYzMgZGlyZWN0aW9uPWxpZ2h0RGF0YS54eXotdlBvc2l0aW9uVztcXG5hdHRlbnVhdGlvbj1tYXgoMC4sMS4wLWxlbmd0aChkaXJlY3Rpb24pL3JhbmdlKTtcXG5saWdodFZlY3Rvclc9bm9ybWFsaXplKGRpcmVjdGlvbik7XFxufVxcbmVsc2VcXG57XFxubGlnaHRWZWN0b3JXPW5vcm1hbGl6ZSgtbGlnaHREYXRhLnh5eik7XFxufVxcblxcbmZsb2F0IG5kbD1tYXgoMC4sZG90KHZOb3JtYWwsbGlnaHRWZWN0b3JXKSk7XFxucmVzdWx0LmRpZmZ1c2U9bmRsKmRpZmZ1c2VDb2xvciphdHRlbnVhdGlvbjtcXG4jaWZkZWYgU1BFQ1VMQVJURVJNXFxuXFxudmVjMyBhbmdsZVc9bm9ybWFsaXplKHZpZXdEaXJlY3Rpb25XK2xpZ2h0VmVjdG9yVyk7XFxuZmxvYXQgc3BlY0NvbXA9bWF4KDAuLGRvdCh2Tm9ybWFsLGFuZ2xlVykpO1xcbnNwZWNDb21wPXBvdyhzcGVjQ29tcCxtYXgoMS4sZ2xvc3NpbmVzcykpO1xcbnJlc3VsdC5zcGVjdWxhcj1zcGVjQ29tcCpzcGVjdWxhckNvbG9yKmF0dGVudWF0aW9uO1xcbiNlbmRpZlxcbnJldHVybiByZXN1bHQ7XFxufVxcbmxpZ2h0aW5nSW5mbyBjb21wdXRlU3BvdExpZ2h0aW5nKHZlYzMgdmlld0RpcmVjdGlvblcsdmVjMyB2Tm9ybWFsLHZlYzQgbGlnaHREYXRhLHZlYzQgbGlnaHREaXJlY3Rpb24sdmVjMyBkaWZmdXNlQ29sb3IsdmVjMyBzcGVjdWxhckNvbG9yLGZsb2F0IHJhbmdlLGZsb2F0IGdsb3NzaW5lc3MpIHtcXG5saWdodGluZ0luZm8gcmVzdWx0O1xcbnZlYzMgZGlyZWN0aW9uPWxpZ2h0RGF0YS54eXotdlBvc2l0aW9uVztcXG52ZWMzIGxpZ2h0VmVjdG9yVz1ub3JtYWxpemUoZGlyZWN0aW9uKTtcXG5mbG9hdCBhdHRlbnVhdGlvbj1tYXgoMC4sMS4wLWxlbmd0aChkaXJlY3Rpb24pL3JhbmdlKTtcXG5cXG5mbG9hdCBjb3NBbmdsZT1tYXgoMC4sZG90KC1saWdodERpcmVjdGlvbi54eXosbGlnaHRWZWN0b3JXKSk7XFxuaWYgKGNvc0FuZ2xlPj1saWdodERpcmVjdGlvbi53KVxcbntcXG5jb3NBbmdsZT1tYXgoMC4scG93KGNvc0FuZ2xlLGxpZ2h0RGF0YS53KSk7XFxuYXR0ZW51YXRpb24qPWNvc0FuZ2xlO1xcblxcbmZsb2F0IG5kbD1tYXgoMC4sZG90KHZOb3JtYWwsLWxpZ2h0RGlyZWN0aW9uLnh5eikpO1xcbnJlc3VsdC5kaWZmdXNlPW5kbCpkaWZmdXNlQ29sb3IqYXR0ZW51YXRpb247XFxuI2lmZGVmIFNQRUNVTEFSVEVSTVxcblxcbnZlYzMgYW5nbGVXPW5vcm1hbGl6ZSh2aWV3RGlyZWN0aW9uVy1saWdodERpcmVjdGlvbi54eXopO1xcbmZsb2F0IHNwZWNDb21wPW1heCgwLixkb3Qodk5vcm1hbCxhbmdsZVcpKTtcXG5zcGVjQ29tcD1wb3coc3BlY0NvbXAsbWF4KDEuLGdsb3NzaW5lc3MpKTtcXG5yZXN1bHQuc3BlY3VsYXI9c3BlY0NvbXAqc3BlY3VsYXJDb2xvciphdHRlbnVhdGlvbjtcXG4jZW5kaWZcXG5yZXR1cm4gcmVzdWx0O1xcbn1cXG5yZXN1bHQuZGlmZnVzZT12ZWMzKDAuKTtcXG4jaWZkZWYgU1BFQ1VMQVJURVJNXFxucmVzdWx0LnNwZWN1bGFyPXZlYzMoMC4pO1xcbiNlbmRpZlxcbnJldHVybiByZXN1bHQ7XFxufVxcbmxpZ2h0aW5nSW5mbyBjb21wdXRlSGVtaXNwaGVyaWNMaWdodGluZyh2ZWMzIHZpZXdEaXJlY3Rpb25XLHZlYzMgdk5vcm1hbCx2ZWM0IGxpZ2h0RGF0YSx2ZWMzIGRpZmZ1c2VDb2xvcix2ZWMzIHNwZWN1bGFyQ29sb3IsdmVjMyBncm91bmRDb2xvcixmbG9hdCBnbG9zc2luZXNzKSB7XFxubGlnaHRpbmdJbmZvIHJlc3VsdDtcXG5cXG5mbG9hdCBuZGw9ZG90KHZOb3JtYWwsbGlnaHREYXRhLnh5eikqMC41KzAuNTtcXG5yZXN1bHQuZGlmZnVzZT1taXgoZ3JvdW5kQ29sb3IsZGlmZnVzZUNvbG9yLG5kbCk7XFxuI2lmZGVmIFNQRUNVTEFSVEVSTVxcblxcbnZlYzMgYW5nbGVXPW5vcm1hbGl6ZSh2aWV3RGlyZWN0aW9uVytsaWdodERhdGEueHl6KTtcXG5mbG9hdCBzcGVjQ29tcD1tYXgoMC4sZG90KHZOb3JtYWwsYW5nbGVXKSk7XFxuc3BlY0NvbXA9cG93KHNwZWNDb21wLG1heCgxLixnbG9zc2luZXNzKSk7XFxucmVzdWx0LnNwZWN1bGFyPXNwZWNDb21wKnNwZWN1bGFyQ29sb3I7XFxuI2VuZGlmXFxucmV0dXJuIHJlc3VsdDtcXG59XFxuXCIsbG9nRGVwdGhEZWNsYXJhdGlvbjpcIiNpZmRlZiBMT0dBUklUSE1JQ0RFUFRIXFxudW5pZm9ybSBmbG9hdCBsb2dhcml0aG1pY0RlcHRoQ29uc3RhbnQ7XFxudmFyeWluZyBmbG9hdCB2RnJhZ21lbnREZXB0aDtcXG4jZW5kaWZcIixsb2dEZXB0aEZyYWdtZW50OlwiI2lmZGVmIExPR0FSSVRITUlDREVQVEhcXG5nbF9GcmFnRGVwdGhFWFQ9bG9nMih2RnJhZ21lbnREZXB0aCkqbG9nYXJpdGhtaWNEZXB0aENvbnN0YW50KjAuNTtcXG4jZW5kaWZcIixsb2dEZXB0aFZlcnRleDpcIiNpZmRlZiBMT0dBUklUSE1JQ0RFUFRIXFxudkZyYWdtZW50RGVwdGg9MS4wK2dsX1Bvc2l0aW9uLnc7XFxuZ2xfUG9zaXRpb24uej1sb2cyKG1heCgwLjAwMDAwMSx2RnJhZ21lbnREZXB0aCkpKmxvZ2FyaXRobWljRGVwdGhDb25zdGFudDtcXG4jZW5kaWZcIixwYnJGdW5jdGlvbnM6XCJcXG4jZGVmaW5lIFJFQ0lQUk9DQUxfUEkyIDAuMTU5MTU0OTRcXG4jZGVmaW5lIEZSRVNORUxfTUFYSU1VTV9PTl9ST1VHSCAwLjI1XFxuXFxuY29uc3QgZmxvYXQga1BpPTMuMTQxNTkyNjUzNTg5NzkzMjM4NDYyNjQzMzgzMjc5NTtcXG5jb25zdCBmbG9hdCBrUm91Z25oZXNzVG9BbHBoYVNjYWxlPTAuMTtcXG5jb25zdCBmbG9hdCBrUm91Z25oZXNzVG9BbHBoYU9mZnNldD0wLjI5MjQ4MTI1O1xcbmZsb2F0IFNxdWFyZShmbG9hdCB2YWx1ZSlcXG57XFxucmV0dXJuIHZhbHVlKnZhbHVlO1xcbn1cXG5mbG9hdCBnZXRMdW1pbmFuY2UodmVjMyBjb2xvcilcXG57XFxucmV0dXJuIGNsYW1wKGRvdChjb2xvcix2ZWMzKDAuMjEyNiwwLjcxNTIsMC4wNzIyKSksMC4sMS4pO1xcbn1cXG5mbG9hdCBjb252ZXJ0Um91Z2huZXNzVG9BdmVyYWdlU2xvcGUoZmxvYXQgcm91Z2huZXNzKVxcbntcXG5cXG5jb25zdCBmbG9hdCBrTWluaW11bVZhcmlhbmNlPTAuMDAwNTtcXG5mbG9hdCBhbHBoYUc9U3F1YXJlKHJvdWdobmVzcykra01pbmltdW1WYXJpYW5jZTtcXG5yZXR1cm4gYWxwaGFHO1xcbn1cXG5cXG5mbG9hdCBnZXRNaXBNYXBJbmRleEZyb21BdmVyYWdlU2xvcGUoZmxvYXQgbWF4TWlwTGV2ZWwsZmxvYXQgYWxwaGEpXFxue1xcblxcblxcblxcblxcblxcblxcblxcbmZsb2F0IG1pcD1rUm91Z25oZXNzVG9BbHBoYU9mZnNldCttYXhNaXBMZXZlbCsobWF4TWlwTGV2ZWwqa1JvdWduaGVzc1RvQWxwaGFTY2FsZSpsb2cyKGFscGhhKSk7XFxucmV0dXJuIGNsYW1wKG1pcCwwLixtYXhNaXBMZXZlbCk7XFxufVxcbmZsb2F0IGdldE1pcE1hcEluZGV4RnJvbUF2ZXJhZ2VTbG9wZVdpdGhQTVJFTShmbG9hdCBtYXhNaXBMZXZlbCxmbG9hdCBhbHBoYUcpXFxue1xcbmZsb2F0IHNwZWN1bGFyUG93ZXI9Y2xhbXAoMi4vYWxwaGFHLTIuLDAuMDAwMDAxLDIwNDguKTtcXG5cXG5yZXR1cm4gY2xhbXAoLSAwLjUqbG9nMihzcGVjdWxhclBvd2VyKSs1LjUsMC4sbWF4TWlwTGV2ZWwpO1xcbn1cXG5cXG5mbG9hdCBzbWl0aFZpc2liaWxpdHlHMV9Ucm93YnJpZGdlUmVpdHpHR1goZmxvYXQgZG90LGZsb2F0IGFscGhhRylcXG57XFxuZmxvYXQgdGFuU3F1YXJlZD0oMS4wLWRvdCpkb3QpLyhkb3QqZG90KTtcXG5yZXR1cm4gMi4wLygxLjArc3FydCgxLjArYWxwaGFHKmFscGhhRyp0YW5TcXVhcmVkKSk7XFxufVxcbmZsb2F0IHNtaXRoVmlzaWJpbGl0eUdfVHJvd2JyaWRnZVJlaXR6R0dYX1dhbHRlcihmbG9hdCBOZG90TCxmbG9hdCBOZG90VixmbG9hdCBhbHBoYUcpXFxue1xcbnJldHVybiBzbWl0aFZpc2liaWxpdHlHMV9Ucm93YnJpZGdlUmVpdHpHR1goTmRvdEwsYWxwaGFHKSpzbWl0aFZpc2liaWxpdHlHMV9Ucm93YnJpZGdlUmVpdHpHR1goTmRvdFYsYWxwaGFHKTtcXG59XFxuXFxuXFxuZmxvYXQgbm9ybWFsRGlzdHJpYnV0aW9uRnVuY3Rpb25fVHJvd2JyaWRnZVJlaXR6R0dYKGZsb2F0IE5kb3RILGZsb2F0IGFscGhhRylcXG57XFxuXFxuXFxuXFxuZmxvYXQgYTI9U3F1YXJlKGFscGhhRyk7XFxuZmxvYXQgZD1OZG90SCpOZG90SCooYTItMS4wKSsxLjA7XFxucmV0dXJuIGEyLyhrUGkqZCpkKTtcXG59XFxudmVjMyBmcmVzbmVsU2NobGlja0dHWChmbG9hdCBWZG90SCx2ZWMzIHJlZmxlY3RhbmNlMCx2ZWMzIHJlZmxlY3RhbmNlOTApXFxue1xcbnJldHVybiByZWZsZWN0YW5jZTArKHJlZmxlY3RhbmNlOTAtcmVmbGVjdGFuY2UwKSpwb3coY2xhbXAoMS4wLVZkb3RILDAuLDEuKSw1LjApO1xcbn1cXG52ZWMzIEZyZXNuZWxTY2hsaWNrRW52aXJvbm1lbnRHR1goZmxvYXQgVmRvdE4sdmVjMyByZWZsZWN0YW5jZTAsdmVjMyByZWZsZWN0YW5jZTkwLGZsb2F0IHNtb290aG5lc3MpXFxue1xcblxcbmZsb2F0IHdlaWdodD1taXgoRlJFU05FTF9NQVhJTVVNX09OX1JPVUdILDEuMCxzbW9vdGhuZXNzKTtcXG5yZXR1cm4gcmVmbGVjdGFuY2UwK3dlaWdodCoocmVmbGVjdGFuY2U5MC1yZWZsZWN0YW5jZTApKnBvdyhjbGFtcCgxLjAtVmRvdE4sMC4sMS4pLDUuMCk7XFxufVxcblxcbnZlYzMgY29tcHV0ZVNwZWN1bGFyVGVybShmbG9hdCBOZG90SCxmbG9hdCBOZG90TCxmbG9hdCBOZG90VixmbG9hdCBWZG90SCxmbG9hdCByb3VnaG5lc3MsdmVjMyBzcGVjdWxhckNvbG9yLHZlYzMgcmVmbGVjdGFuY2U5MClcXG57XFxuZmxvYXQgYWxwaGFHPWNvbnZlcnRSb3VnaG5lc3NUb0F2ZXJhZ2VTbG9wZShyb3VnaG5lc3MpO1xcbmZsb2F0IGRpc3RyaWJ1dGlvbj1ub3JtYWxEaXN0cmlidXRpb25GdW5jdGlvbl9Ucm93YnJpZGdlUmVpdHpHR1goTmRvdEgsYWxwaGFHKTtcXG5mbG9hdCB2aXNpYmlsaXR5PXNtaXRoVmlzaWJpbGl0eUdfVHJvd2JyaWRnZVJlaXR6R0dYX1dhbHRlcihOZG90TCxOZG90VixhbHBoYUcpO1xcbnZpc2liaWxpdHkvPSg0LjAqTmRvdEwqTmRvdFYpOyBcXG52ZWMzIGZyZXNuZWw9ZnJlc25lbFNjaGxpY2tHR1goVmRvdEgsc3BlY3VsYXJDb2xvcixyZWZsZWN0YW5jZTkwKTtcXG5mbG9hdCBzcGVjVGVybT1tYXgoMC4sdmlzaWJpbGl0eSpkaXN0cmlidXRpb24pKk5kb3RMO1xcbnJldHVybiBmcmVzbmVsKnNwZWNUZXJtKmtQaTsgXFxufVxcbmZsb2F0IGNvbXB1dGVEaWZmdXNlVGVybShmbG9hdCBOZG90TCxmbG9hdCBOZG90VixmbG9hdCBWZG90SCxmbG9hdCByb3VnaG5lc3MpXFxue1xcblxcblxcbmZsb2F0IGRpZmZ1c2VGcmVzbmVsTlY9cG93KGNsYW1wKDEuMC1OZG90TCwwLjAwMDAwMSwxLiksNS4wKTtcXG5mbG9hdCBkaWZmdXNlRnJlc25lbE5MPXBvdyhjbGFtcCgxLjAtTmRvdFYsMC4wMDAwMDEsMS4pLDUuMCk7XFxuZmxvYXQgZGlmZnVzZUZyZXNuZWw5MD0wLjUrMi4wKlZkb3RIKlZkb3RIKnJvdWdobmVzcztcXG5mbG9hdCBkaWZmdXNlRnJlc25lbFRlcm0gPVxcbigxLjArKGRpZmZ1c2VGcmVzbmVsOTAtMS4wKSpkaWZmdXNlRnJlc25lbE5MKSAqXFxuKDEuMCsoZGlmZnVzZUZyZXNuZWw5MC0xLjApKmRpZmZ1c2VGcmVzbmVsTlYpO1xcbnJldHVybiBkaWZmdXNlRnJlc25lbFRlcm0qTmRvdEw7XFxuXFxuXFxufVxcbmZsb2F0IGFkanVzdFJvdWdobmVzc0Zyb21MaWdodFByb3BlcnRpZXMoZmxvYXQgcm91Z2huZXNzLGZsb2F0IGxpZ2h0UmFkaXVzLGZsb2F0IGxpZ2h0RGlzdGFuY2UpXFxue1xcbiNpZmRlZiBVU0VQSFlTSUNBTExJR0hURkFMTE9GRlxcblxcbmZsb2F0IGxpZ2h0Um91Z2huZXNzPWxpZ2h0UmFkaXVzL2xpZ2h0RGlzdGFuY2U7XFxuXFxuZmxvYXQgdG90YWxSb3VnaG5lc3M9Y2xhbXAobGlnaHRSb3VnaG5lc3Mrcm91Z2huZXNzLDAuLDEuKTtcXG5yZXR1cm4gdG90YWxSb3VnaG5lc3M7XFxuI2Vsc2VcXG5yZXR1cm4gcm91Z2huZXNzO1xcbiNlbmRpZlxcbn1cXG5mbG9hdCBjb21wdXRlRGVmYXVsdE1pY3JvU3VyZmFjZShmbG9hdCBtaWNyb1N1cmZhY2UsdmVjMyByZWZsZWN0aXZpdHlDb2xvcilcXG57XFxuZmxvYXQga1JlZmxlY3Rpdml0eU5vQWxwaGFXb3JrZmxvd19TbW9vdGhuZXNzTWF4PTAuOTU7XFxuZmxvYXQgcmVmbGVjdGl2aXR5THVtaW5hbmNlPWdldEx1bWluYW5jZShyZWZsZWN0aXZpdHlDb2xvcik7XFxuZmxvYXQgcmVmbGVjdGl2aXR5THVtYT1zcXJ0KHJlZmxlY3Rpdml0eUx1bWluYW5jZSk7XFxubWljcm9TdXJmYWNlPXJlZmxlY3Rpdml0eUx1bWEqa1JlZmxlY3Rpdml0eU5vQWxwaGFXb3JrZmxvd19TbW9vdGhuZXNzTWF4O1xcbnJldHVybiBtaWNyb1N1cmZhY2U7XFxufVxcbnZlYzMgdG9MaW5lYXJTcGFjZSh2ZWMzIGNvbG9yKVxcbntcXG5yZXR1cm4gdmVjMyhwb3coY29sb3IuciwyLjIpLHBvdyhjb2xvci5nLDIuMikscG93KGNvbG9yLmIsMi4yKSk7XFxufVxcbnZlYzMgdG9HYW1tYVNwYWNlKHZlYzMgY29sb3IpXFxue1xcbnJldHVybiB2ZWMzKHBvdyhjb2xvci5yLDEuMC8yLjIpLHBvdyhjb2xvci5nLDEuMC8yLjIpLHBvdyhjb2xvci5iLDEuMC8yLjIpKTtcXG59XFxuI2lmZGVmIENBTUVSQVRPTkVNQVBcXG52ZWMzIHRvbmVNYXBzKHZlYzMgY29sb3IpXFxue1xcbmNvbG9yPW1heChjb2xvciwwLjApO1xcblxcbmNvbG9yLnJnYj1jb2xvci5yZ2IqdkNhbWVyYUluZm9zLng7XFxuZmxvYXQgdHVuaW5nPTEuNTsgXFxuXFxuXFxudmVjMyB0b25lbWFwcGVkPTEuMC1leHAyKC1jb2xvci5yZ2IqdHVuaW5nKTsgXFxuY29sb3IucmdiPW1peChjb2xvci5yZ2IsdG9uZW1hcHBlZCwxLjApO1xcbnJldHVybiBjb2xvcjtcXG59XFxuI2VuZGlmXFxuI2lmZGVmIENBTUVSQUNPTlRSQVNUXFxudmVjNCBjb250cmFzdHModmVjNCBjb2xvcilcXG57XFxuY29sb3I9Y2xhbXAoY29sb3IsMC4wLDEuMCk7XFxudmVjMyByZXN1bHRIaWdoQ29udHJhc3Q9Y29sb3IucmdiKmNvbG9yLnJnYiooMy4wLTIuMCpjb2xvci5yZ2IpO1xcbmZsb2F0IGNvbnRyYXN0PXZDYW1lcmFJbmZvcy55O1xcbmlmIChjb250cmFzdDwxLjApXFxue1xcblxcbmNvbG9yLnJnYj1taXgodmVjMygwLjUsMC41LDAuNSksY29sb3IucmdiLGNvbnRyYXN0KTtcXG59XFxuZWxzZVxcbntcXG5cXG5jb2xvci5yZ2I9bWl4KGNvbG9yLnJnYixyZXN1bHRIaWdoQ29udHJhc3QsY29udHJhc3QtMS4wKTtcXG59XFxucmV0dXJuIGNvbG9yO1xcbn1cXG4jZW5kaWZcIixcbnBickxpZ2h0RnVuY3Rpb25zOlwiXFxuc3RydWN0IGxpZ2h0aW5nSW5mb1xcbntcXG52ZWMzIGRpZmZ1c2U7XFxuI2lmZGVmIFNQRUNVTEFSVEVSTVxcbnZlYzMgc3BlY3VsYXI7XFxuI2VuZGlmXFxufTtcXG5mbG9hdCBjb21wdXRlRGlzdGFuY2VMaWdodEZhbGxvZmYodmVjMyBsaWdodE9mZnNldCxmbG9hdCBsaWdodERpc3RhbmNlU3F1YXJlZCxmbG9hdCByYW5nZSlcXG57IFxcbiNpZmRlZiBVU0VQSFlTSUNBTExJR0hURkFMTE9GRlxcbmZsb2F0IGxpZ2h0RGlzdGFuY2VGYWxsb2ZmPTEuMC8oKGxpZ2h0RGlzdGFuY2VTcXVhcmVkKzAuMDAwMSkpO1xcbiNlbHNlXFxuZmxvYXQgbGlnaHREaXN0YW5jZUZhbGxvZmY9bWF4KDAuLDEuMC1sZW5ndGgobGlnaHRPZmZzZXQpL3JhbmdlKTtcXG4jZW5kaWZcXG5yZXR1cm4gbGlnaHREaXN0YW5jZUZhbGxvZmY7XFxufVxcbmZsb2F0IGNvbXB1dGVEaXJlY3Rpb25hbExpZ2h0RmFsbG9mZih2ZWMzIGxpZ2h0RGlyZWN0aW9uLHZlYzMgZGlyZWN0aW9uVG9MaWdodENlbnRlclcsZmxvYXQgbGlnaHRBbmdsZSxmbG9hdCBleHBvbmVudClcXG57XFxuZmxvYXQgZmFsbG9mZj0wLjA7XFxuI2lmZGVmIFVTRVBIWVNJQ0FMTElHSFRGQUxMT0ZGXFxuZmxvYXQgY29zSGFsZkFuZ2xlPWNvcyhsaWdodEFuZ2xlKjAuNSk7XFxuY29uc3QgZmxvYXQga01pbnVzTG9nMkNvbmVBbmdsZUludGVuc2l0eVJhdGlvPTYuNjQzODU2MTg5Nzc7IFxcblxcblxcblxcblxcblxcbmZsb2F0IGNvbmNlbnRyYXRpb25LYXBwYT1rTWludXNMb2cyQ29uZUFuZ2xlSW50ZW5zaXR5UmF0aW8vKDEuMC1jb3NIYWxmQW5nbGUpO1xcblxcblxcbnZlYzQgbGlnaHREaXJlY3Rpb25TcHJlYWRTRz12ZWM0KC1saWdodERpcmVjdGlvbipjb25jZW50cmF0aW9uS2FwcGEsLWNvbmNlbnRyYXRpb25LYXBwYSk7XFxuZmFsbG9mZj1leHAyKGRvdCh2ZWM0KGRpcmVjdGlvblRvTGlnaHRDZW50ZXJXLDEuMCksbGlnaHREaXJlY3Rpb25TcHJlYWRTRykpO1xcbiNlbHNlXFxuZmxvYXQgY29zQW5nbGU9bWF4KDAuMDAwMDAwMDAwMDAwMDAxLGRvdCgtbGlnaHREaXJlY3Rpb24sZGlyZWN0aW9uVG9MaWdodENlbnRlclcpKTtcXG5pZiAoY29zQW5nbGU+PWxpZ2h0QW5nbGUpXFxue1xcbmZhbGxvZmY9bWF4KDAuLHBvdyhjb3NBbmdsZSxleHBvbmVudCkpO1xcbn1cXG4jZW5kaWZcXG5yZXR1cm4gZmFsbG9mZjtcXG59XFxubGlnaHRpbmdJbmZvIGNvbXB1dGVMaWdodGluZyh2ZWMzIHZpZXdEaXJlY3Rpb25XLHZlYzMgdk5vcm1hbCx2ZWM0IGxpZ2h0RGF0YSx2ZWMzIGRpZmZ1c2VDb2xvcix2ZWMzIHNwZWN1bGFyQ29sb3IsZmxvYXQgcmFuZ2VSYWRpdXMsZmxvYXQgcm91Z2huZXNzLGZsb2F0IE5kb3RWLHZlYzMgcmVmbGVjdGFuY2U5MCxvdXQgZmxvYXQgTmRvdEwpIHtcXG5saWdodGluZ0luZm8gcmVzdWx0O1xcbnZlYzMgbGlnaHREaXJlY3Rpb247XFxuZmxvYXQgYXR0ZW51YXRpb249MS4wO1xcbmZsb2F0IGxpZ2h0RGlzdGFuY2U7XFxuXFxuaWYgKGxpZ2h0RGF0YS53ID09IDAuKVxcbntcXG52ZWMzIGxpZ2h0T2Zmc2V0PWxpZ2h0RGF0YS54eXotdlBvc2l0aW9uVztcXG5mbG9hdCBsaWdodERpc3RhbmNlU3F1YXJlZD1kb3QobGlnaHRPZmZzZXQsbGlnaHRPZmZzZXQpO1xcbmF0dGVudWF0aW9uPWNvbXB1dGVEaXN0YW5jZUxpZ2h0RmFsbG9mZihsaWdodE9mZnNldCxsaWdodERpc3RhbmNlU3F1YXJlZCxyYW5nZVJhZGl1cyk7XFxubGlnaHREaXN0YW5jZT1zcXJ0KGxpZ2h0RGlzdGFuY2VTcXVhcmVkKTtcXG5saWdodERpcmVjdGlvbj1ub3JtYWxpemUobGlnaHRPZmZzZXQpO1xcbn1cXG5cXG5lbHNlXFxue1xcbmxpZ2h0RGlzdGFuY2U9bGVuZ3RoKC1saWdodERhdGEueHl6KTtcXG5saWdodERpcmVjdGlvbj1ub3JtYWxpemUoLWxpZ2h0RGF0YS54eXopO1xcbn1cXG5cXG5yb3VnaG5lc3M9YWRqdXN0Um91Z2huZXNzRnJvbUxpZ2h0UHJvcGVydGllcyhyb3VnaG5lc3MscmFuZ2VSYWRpdXMsbGlnaHREaXN0YW5jZSk7XFxuXFxudmVjMyBIPW5vcm1hbGl6ZSh2aWV3RGlyZWN0aW9uVytsaWdodERpcmVjdGlvbik7XFxuTmRvdEw9bWF4KDAuMDAwMDAwMDAwMDEsZG90KHZOb3JtYWwsbGlnaHREaXJlY3Rpb24pKTtcXG5mbG9hdCBWZG90SD1jbGFtcCgwLjAwMDAwMDAwMDAxLDEuMCxkb3Qodmlld0RpcmVjdGlvblcsSCkpO1xcbmZsb2F0IGRpZmZ1c2VUZXJtPWNvbXB1dGVEaWZmdXNlVGVybShOZG90TCxOZG90VixWZG90SCxyb3VnaG5lc3MpO1xcbnJlc3VsdC5kaWZmdXNlPWRpZmZ1c2VUZXJtKmRpZmZ1c2VDb2xvciphdHRlbnVhdGlvbjtcXG4jaWZkZWYgU1BFQ1VMQVJURVJNXFxuXFxuZmxvYXQgTmRvdEg9bWF4KDAuMDAwMDAwMDAwMDEsZG90KHZOb3JtYWwsSCkpO1xcbnZlYzMgc3BlY1Rlcm09Y29tcHV0ZVNwZWN1bGFyVGVybShOZG90SCxOZG90TCxOZG90VixWZG90SCxyb3VnaG5lc3Msc3BlY3VsYXJDb2xvcixyZWZsZWN0YW5jZTkwKTtcXG5yZXN1bHQuc3BlY3VsYXI9c3BlY1Rlcm0qYXR0ZW51YXRpb247XFxuI2VuZGlmXFxucmV0dXJuIHJlc3VsdDtcXG59XFxubGlnaHRpbmdJbmZvIGNvbXB1dGVTcG90TGlnaHRpbmcodmVjMyB2aWV3RGlyZWN0aW9uVyx2ZWMzIHZOb3JtYWwsdmVjNCBsaWdodERhdGEsdmVjNCBsaWdodERpcmVjdGlvbix2ZWMzIGRpZmZ1c2VDb2xvcix2ZWMzIHNwZWN1bGFyQ29sb3IsZmxvYXQgcmFuZ2VSYWRpdXMsZmxvYXQgcm91Z2huZXNzLGZsb2F0IE5kb3RWLHZlYzMgcmVmbGVjdGFuY2U5MCxvdXQgZmxvYXQgTmRvdEwpIHtcXG5saWdodGluZ0luZm8gcmVzdWx0O1xcbnZlYzMgbGlnaHRPZmZzZXQ9bGlnaHREYXRhLnh5ei12UG9zaXRpb25XO1xcbnZlYzMgZGlyZWN0aW9uVG9MaWdodENlbnRlclc9bm9ybWFsaXplKGxpZ2h0T2Zmc2V0KTtcXG5cXG5mbG9hdCBsaWdodERpc3RhbmNlU3F1YXJlZD1kb3QobGlnaHRPZmZzZXQsbGlnaHRPZmZzZXQpO1xcbmZsb2F0IGF0dGVudWF0aW9uPWNvbXB1dGVEaXN0YW5jZUxpZ2h0RmFsbG9mZihsaWdodE9mZnNldCxsaWdodERpc3RhbmNlU3F1YXJlZCxyYW5nZVJhZGl1cyk7XFxuXFxuZmxvYXQgZGlyZWN0aW9uYWxBdHRlbnVhdGlvbj1jb21wdXRlRGlyZWN0aW9uYWxMaWdodEZhbGxvZmYobGlnaHREaXJlY3Rpb24ueHl6LGRpcmVjdGlvblRvTGlnaHRDZW50ZXJXLGxpZ2h0RGlyZWN0aW9uLncsbGlnaHREYXRhLncpO1xcbmF0dGVudWF0aW9uKj1kaXJlY3Rpb25hbEF0dGVudWF0aW9uO1xcblxcbmZsb2F0IGxpZ2h0RGlzdGFuY2U9c3FydChsaWdodERpc3RhbmNlU3F1YXJlZCk7XFxucm91Z2huZXNzPWFkanVzdFJvdWdobmVzc0Zyb21MaWdodFByb3BlcnRpZXMocm91Z2huZXNzLHJhbmdlUmFkaXVzLGxpZ2h0RGlzdGFuY2UpO1xcblxcbnZlYzMgSD1ub3JtYWxpemUodmlld0RpcmVjdGlvblctbGlnaHREaXJlY3Rpb24ueHl6KTtcXG5OZG90TD1tYXgoMC4wMDAwMDAwMDAwMSxkb3Qodk5vcm1hbCwtbGlnaHREaXJlY3Rpb24ueHl6KSk7XFxuZmxvYXQgVmRvdEg9Y2xhbXAoZG90KHZpZXdEaXJlY3Rpb25XLEgpLDAuMDAwMDAwMDAwMDEsMS4wKTtcXG5mbG9hdCBkaWZmdXNlVGVybT1jb21wdXRlRGlmZnVzZVRlcm0oTmRvdEwsTmRvdFYsVmRvdEgscm91Z2huZXNzKTtcXG5yZXN1bHQuZGlmZnVzZT1kaWZmdXNlVGVybSpkaWZmdXNlQ29sb3IqYXR0ZW51YXRpb247XFxuI2lmZGVmIFNQRUNVTEFSVEVSTVxcblxcbmZsb2F0IE5kb3RIPW1heCgwLjAwMDAwMDAwMDAxLGRvdCh2Tm9ybWFsLEgpKTtcXG52ZWMzIHNwZWNUZXJtPWNvbXB1dGVTcGVjdWxhclRlcm0oTmRvdEgsTmRvdEwsTmRvdFYsVmRvdEgscm91Z2huZXNzLHNwZWN1bGFyQ29sb3IscmVmbGVjdGFuY2U5MCk7XFxucmVzdWx0LnNwZWN1bGFyPXNwZWNUZXJtKmF0dGVudWF0aW9uO1xcbiNlbmRpZlxcbnJldHVybiByZXN1bHQ7XFxufVxcbmxpZ2h0aW5nSW5mbyBjb21wdXRlSGVtaXNwaGVyaWNMaWdodGluZyh2ZWMzIHZpZXdEaXJlY3Rpb25XLHZlYzMgdk5vcm1hbCx2ZWM0IGxpZ2h0RGF0YSx2ZWMzIGRpZmZ1c2VDb2xvcix2ZWMzIHNwZWN1bGFyQ29sb3IsdmVjMyBncm91bmRDb2xvcixmbG9hdCByb3VnaG5lc3MsZmxvYXQgTmRvdFYsdmVjMyByZWZsZWN0YW5jZTkwLG91dCBmbG9hdCBOZG90TCkge1xcbmxpZ2h0aW5nSW5mbyByZXN1bHQ7XFxuXFxuXFxuXFxuTmRvdEw9ZG90KHZOb3JtYWwsbGlnaHREYXRhLnh5eikqMC41KzAuNTtcXG5yZXN1bHQuZGlmZnVzZT1taXgoZ3JvdW5kQ29sb3IsZGlmZnVzZUNvbG9yLE5kb3RMKTtcXG4jaWZkZWYgU1BFQ1VMQVJURVJNXFxuXFxudmVjMyBsaWdodFZlY3Rvclc9bm9ybWFsaXplKGxpZ2h0RGF0YS54eXopO1xcbnZlYzMgSD1ub3JtYWxpemUodmlld0RpcmVjdGlvblcrbGlnaHRWZWN0b3JXKTtcXG5mbG9hdCBOZG90SD1tYXgoMC4wMDAwMDAwMDAwMSxkb3Qodk5vcm1hbCxIKSk7XFxuTmRvdEw9bWF4KDAuMDAwMDAwMDAwMDEsTmRvdEwpO1xcbmZsb2F0IFZkb3RIPWNsYW1wKDAuMDAwMDAwMDAwMDEsMS4wLGRvdCh2aWV3RGlyZWN0aW9uVyxIKSk7XFxudmVjMyBzcGVjVGVybT1jb21wdXRlU3BlY3VsYXJUZXJtKE5kb3RILE5kb3RMLE5kb3RWLFZkb3RILHJvdWdobmVzcyxzcGVjdWxhckNvbG9yLHJlZmxlY3RhbmNlOTApO1xcbnJlc3VsdC5zcGVjdWxhcj1zcGVjVGVybTtcXG4jZW5kaWZcXG5yZXR1cm4gcmVzdWx0O1xcbn1cIixwYnJMaWdodEZ1bmN0aW9uc0NhbGw6XCIjaWZkZWYgTElHSFR7WH1cXG4jaWZuZGVmIFNQRUNVTEFSVEVSTVxcbnZlYzMgdkxpZ2h0U3BlY3VsYXJ7WH09dmVjMygwLjApO1xcbiNlbmRpZlxcbiNpZmRlZiBTUE9UTElHSFR7WH1cXG5pbmZvPWNvbXB1dGVTcG90TGlnaHRpbmcodmlld0RpcmVjdGlvblcsbm9ybWFsVyx2TGlnaHREYXRhe1h9LHZMaWdodERpcmVjdGlvbntYfSx2TGlnaHREaWZmdXNle1h9LnJnYix2TGlnaHRTcGVjdWxhcntYfSx2TGlnaHREaWZmdXNle1h9LmEscm91Z2huZXNzLE5kb3RWLHNwZWN1bGFyRW52aXJvbm1lbnRSOTAsTmRvdEwpO1xcbiNlbmRpZlxcbiNpZmRlZiBIRU1JTElHSFR7WH1cXG5pbmZvPWNvbXB1dGVIZW1pc3BoZXJpY0xpZ2h0aW5nKHZpZXdEaXJlY3Rpb25XLG5vcm1hbFcsdkxpZ2h0RGF0YXtYfSx2TGlnaHREaWZmdXNle1h9LnJnYix2TGlnaHRTcGVjdWxhcntYfSx2TGlnaHRHcm91bmR7WH0scm91Z2huZXNzLE5kb3RWLHNwZWN1bGFyRW52aXJvbm1lbnRSOTAsTmRvdEwpO1xcbiNlbmRpZlxcbiNpZiBkZWZpbmVkKFBPSU5UTElHSFR7WH0pIHx8IGRlZmluZWQoRElSTElHSFR7WH0pXFxuaW5mbz1jb21wdXRlTGlnaHRpbmcodmlld0RpcmVjdGlvblcsbm9ybWFsVyx2TGlnaHREYXRhe1h9LHZMaWdodERpZmZ1c2V7WH0ucmdiLHZMaWdodFNwZWN1bGFye1h9LHZMaWdodERpZmZ1c2V7WH0uYSxyb3VnaG5lc3MsTmRvdFYsc3BlY3VsYXJFbnZpcm9ubWVudFI5MCxOZG90TCk7XFxuI2VuZGlmXFxuI2lmZGVmIFNIQURPV3tYfVxcbiNpZmRlZiBTSEFET1dWU017WH1cXG5ub3RTaGFkb3dMZXZlbD1jb21wdXRlU2hhZG93V2l0aFZTTSh2UG9zaXRpb25Gcm9tTGlnaHR7WH0sc2hhZG93U2FtcGxlcntYfSxzaGFkb3dzSW5mb3tYfS56LHNoYWRvd3NJbmZve1h9LngpO1xcbiNlbHNlXFxuI2lmZGVmIFNIQURPV1BDRntYfVxcbiNpZiBkZWZpbmVkKFBPSU5UTElHSFR7WH0pXFxubm90U2hhZG93TGV2ZWw9Y29tcHV0ZVNoYWRvd1dpdGhQQ0ZDdWJlKHZMaWdodERhdGF7WH0ueHl6LHNoYWRvd1NhbXBsZXJ7WH0sc2hhZG93c0luZm97WH0ueSxzaGFkb3dzSW5mb3tYfS56LHNoYWRvd3NJbmZve1h9LngpO1xcbiNlbHNlXFxubm90U2hhZG93TGV2ZWw9Y29tcHV0ZVNoYWRvd1dpdGhQQ0YodlBvc2l0aW9uRnJvbUxpZ2h0e1h9LHNoYWRvd1NhbXBsZXJ7WH0sc2hhZG93c0luZm97WH0ueSxzaGFkb3dzSW5mb3tYfS56LHNoYWRvd3NJbmZve1h9LngpO1xcbiNlbmRpZlxcbiNlbHNlXFxuI2lmIGRlZmluZWQoUE9JTlRMSUdIVHtYfSlcXG5ub3RTaGFkb3dMZXZlbD1jb21wdXRlU2hhZG93Q3ViZSh2TGlnaHREYXRhe1h9Lnh5eixzaGFkb3dTYW1wbGVye1h9LHNoYWRvd3NJbmZve1h9Lngsc2hhZG93c0luZm97WH0ueik7XFxuI2Vsc2VcXG5ub3RTaGFkb3dMZXZlbD1jb21wdXRlU2hhZG93KHZQb3NpdGlvbkZyb21MaWdodHtYfSxzaGFkb3dTYW1wbGVye1h9LHNoYWRvd3NJbmZve1h9Lngsc2hhZG93c0luZm97WH0ueik7XFxuI2VuZGlmXFxuI2VuZGlmXFxuI2VuZGlmXFxuI2Vsc2VcXG5ub3RTaGFkb3dMZXZlbD0xLjtcXG4jZW5kaWZcXG5saWdodERpZmZ1c2VDb250cmlidXRpb24rPWluZm8uZGlmZnVzZSpub3RTaGFkb3dMZXZlbDtcXG4jaWZkZWYgT1ZFUkxPQURFRFNIQURPV1ZBTFVFU1xcbmlmIChOZG90TDwwLjAwMDAwMDAwMDAxMSlcXG57XFxubm90U2hhZG93TGV2ZWw9MS47XFxufVxcbnNoYWRvd2VkT25seUxpZ2h0RGlmZnVzZUNvbnRyaWJ1dGlvbio9bm90U2hhZG93TGV2ZWw7XFxuI2VuZGlmXFxuI2lmZGVmIFNQRUNVTEFSVEVSTVxcbmxpZ2h0U3BlY3VsYXJDb250cmlidXRpb24rPWluZm8uc3BlY3VsYXIqbm90U2hhZG93TGV2ZWw7XFxuI2VuZGlmXFxuI2VuZGlmXCIscGJyU2hhZG93RnVuY3Rpb25zOlwiXFxuI2lmZGVmIFNIQURPV1NcXG5mbG9hdCB1bnBhY2sodmVjNCBjb2xvcilcXG57XFxuY29uc3QgdmVjNCBiaXRfc2hpZnQ9dmVjNCgxLjAvKDI1NS4wKjI1NS4wKjI1NS4wKSwxLjAvKDI1NS4wKjI1NS4wKSwxLjAvMjU1LjAsMS4wKTtcXG5yZXR1cm4gZG90KGNvbG9yLGJpdF9zaGlmdCk7XFxufVxcbnVuaWZvcm0gdmVjMiBkZXB0aFZhbHVlcztcXG5mbG9hdCBjb21wdXRlU2hhZG93Q3ViZSh2ZWMzIGxpZ2h0UG9zaXRpb24sc2FtcGxlckN1YmUgc2hhZG93U2FtcGxlcixmbG9hdCBkYXJrbmVzcyxmbG9hdCBiaWFzKVxcbntcXG52ZWMzIGRpcmVjdGlvblRvTGlnaHQ9dlBvc2l0aW9uVy1saWdodFBvc2l0aW9uO1xcbmZsb2F0IGRlcHRoPWxlbmd0aChkaXJlY3Rpb25Ub0xpZ2h0KTtcXG5kZXB0aD1jbGFtcChkZXB0aCwwLiwxLjApO1xcbmRpcmVjdGlvblRvTGlnaHQ9bm9ybWFsaXplKGRpcmVjdGlvblRvTGlnaHQpO1xcbmRpcmVjdGlvblRvTGlnaHQueSA9LWRpcmVjdGlvblRvTGlnaHQueTtcXG5mbG9hdCBzaGFkb3c9dW5wYWNrKHRleHR1cmVDdWJlKHNoYWRvd1NhbXBsZXIsZGlyZWN0aW9uVG9MaWdodCkpK2JpYXM7XFxuaWYgKGRlcHRoPnNoYWRvdylcXG57XFxuI2lmZGVmIE9WRVJMT0FERURTSEFET1dWQUxVRVNcXG5yZXR1cm4gbWl4KDEuMCxkYXJrbmVzcyx2T3ZlcmxvYWRlZFNoYWRvd0ludGVuc2l0eS54KTtcXG4jZWxzZVxcbnJldHVybiBkYXJrbmVzcztcXG4jZW5kaWZcXG59XFxucmV0dXJuIDEuMDtcXG59XFxuZmxvYXQgY29tcHV0ZVNoYWRvd1dpdGhQQ0ZDdWJlKHZlYzMgbGlnaHRQb3NpdGlvbixzYW1wbGVyQ3ViZSBzaGFkb3dTYW1wbGVyLGZsb2F0IG1hcFNpemUsZmxvYXQgYmlhcyxmbG9hdCBkYXJrbmVzcylcXG57XFxudmVjMyBkaXJlY3Rpb25Ub0xpZ2h0PXZQb3NpdGlvblctbGlnaHRQb3NpdGlvbjtcXG5mbG9hdCBkZXB0aD1sZW5ndGgoZGlyZWN0aW9uVG9MaWdodCk7XFxuZGVwdGg9KGRlcHRoLWRlcHRoVmFsdWVzLngpLyhkZXB0aFZhbHVlcy55LWRlcHRoVmFsdWVzLngpO1xcbmRlcHRoPWNsYW1wKGRlcHRoLDAuLDEuMCk7XFxuZGlyZWN0aW9uVG9MaWdodD1ub3JtYWxpemUoZGlyZWN0aW9uVG9MaWdodCk7XFxuZGlyZWN0aW9uVG9MaWdodC55PS1kaXJlY3Rpb25Ub0xpZ2h0Lnk7XFxuZmxvYXQgdmlzaWJpbGl0eT0xLjtcXG52ZWMzIHBvaXNzb25EaXNrWzRdO1xcbnBvaXNzb25EaXNrWzBdPXZlYzMoLTEuMCwxLjAsLTEuMCk7XFxucG9pc3NvbkRpc2tbMV09dmVjMygxLjAsLTEuMCwtMS4wKTtcXG5wb2lzc29uRGlza1syXT12ZWMzKC0xLjAsLTEuMCwtMS4wKTtcXG5wb2lzc29uRGlza1szXT12ZWMzKDEuMCwtMS4wLDEuMCk7XFxuXFxuZmxvYXQgYmlhc2VkRGVwdGg9ZGVwdGgtYmlhcztcXG5pZiAodW5wYWNrKHRleHR1cmVDdWJlKHNoYWRvd1NhbXBsZXIsZGlyZWN0aW9uVG9MaWdodCtwb2lzc29uRGlza1swXSptYXBTaXplKSk8Ymlhc2VkRGVwdGgpIHZpc2liaWxpdHktPTAuMjU7XFxuaWYgKHVucGFjayh0ZXh0dXJlQ3ViZShzaGFkb3dTYW1wbGVyLGRpcmVjdGlvblRvTGlnaHQrcG9pc3NvbkRpc2tbMV0qbWFwU2l6ZSkpPGJpYXNlZERlcHRoKSB2aXNpYmlsaXR5LT0wLjI1O1xcbmlmICh1bnBhY2sodGV4dHVyZUN1YmUoc2hhZG93U2FtcGxlcixkaXJlY3Rpb25Ub0xpZ2h0K3BvaXNzb25EaXNrWzJdKm1hcFNpemUpKTxiaWFzZWREZXB0aCkgdmlzaWJpbGl0eS09MC4yNTtcXG5pZiAodW5wYWNrKHRleHR1cmVDdWJlKHNoYWRvd1NhbXBsZXIsZGlyZWN0aW9uVG9MaWdodCtwb2lzc29uRGlza1szXSptYXBTaXplKSk8Ymlhc2VkRGVwdGgpIHZpc2liaWxpdHktPTAuMjU7XFxuI2lmZGVmIE9WRVJMT0FERURTSEFET1dWQUxVRVNcXG5yZXR1cm4gbWluKDEuMCxtaXgoMS4wLHZpc2liaWxpdHkrZGFya25lc3Msdk92ZXJsb2FkZWRTaGFkb3dJbnRlbnNpdHkueCkpO1xcbiNlbHNlXFxucmV0dXJuIG1pbigxLjAsdmlzaWJpbGl0eStkYXJrbmVzcyk7XFxuI2VuZGlmXFxufVxcbmZsb2F0IGNvbXB1dGVTaGFkb3codmVjNCB2UG9zaXRpb25Gcm9tTGlnaHQsc2FtcGxlcjJEIHNoYWRvd1NhbXBsZXIsZmxvYXQgZGFya25lc3MsZmxvYXQgYmlhcylcXG57XFxudmVjMyBkZXB0aD12UG9zaXRpb25Gcm9tTGlnaHQueHl6L3ZQb3NpdGlvbkZyb21MaWdodC53O1xcbmRlcHRoPTAuNSpkZXB0aCt2ZWMzKDAuNSk7XFxudmVjMiB1dj1kZXB0aC54eTtcXG5pZiAodXYueDwwLiB8fCB1di54PjEuMCB8fCB1di55PDAuIHx8IHV2Lnk+MS4wKVxcbntcXG5yZXR1cm4gMS4wO1xcbn1cXG5mbG9hdCBzaGFkb3c9dW5wYWNrKHRleHR1cmUyRChzaGFkb3dTYW1wbGVyLHV2KSkrYmlhcztcXG5pZiAoZGVwdGguej5zaGFkb3cpXFxue1xcbiNpZmRlZiBPVkVSTE9BREVEU0hBRE9XVkFMVUVTXFxucmV0dXJuIG1peCgxLjAsZGFya25lc3Msdk92ZXJsb2FkZWRTaGFkb3dJbnRlbnNpdHkueCk7XFxuI2Vsc2VcXG5yZXR1cm4gZGFya25lc3M7XFxuI2VuZGlmXFxufVxcbnJldHVybiAxLjtcXG59XFxuZmxvYXQgY29tcHV0ZVNoYWRvd1dpdGhQQ0YodmVjNCB2UG9zaXRpb25Gcm9tTGlnaHQsc2FtcGxlcjJEIHNoYWRvd1NhbXBsZXIsZmxvYXQgbWFwU2l6ZSxmbG9hdCBiaWFzLGZsb2F0IGRhcmtuZXNzKVxcbntcXG52ZWMzIGRlcHRoPXZQb3NpdGlvbkZyb21MaWdodC54eXovdlBvc2l0aW9uRnJvbUxpZ2h0Lnc7XFxuZGVwdGg9MC41KmRlcHRoK3ZlYzMoMC41KTtcXG52ZWMyIHV2PWRlcHRoLnh5O1xcbmlmICh1di54PDAuIHx8IHV2Lng+MS4wIHx8IHV2Lnk8MC4gfHwgdXYueT4xLjApXFxue1xcbnJldHVybiAxLjA7XFxufVxcbmZsb2F0IHZpc2liaWxpdHk9MS47XFxudmVjMiBwb2lzc29uRGlza1s0XTtcXG5wb2lzc29uRGlza1swXT12ZWMyKC0wLjk0MjAxNjI0LC0wLjM5OTA2MjE2KTtcXG5wb2lzc29uRGlza1sxXT12ZWMyKDAuOTQ1NTg2MDksLTAuNzY4OTA3MjUpO1xcbnBvaXNzb25EaXNrWzJdPXZlYzIoLTAuMDk0MTg0MTAxLC0wLjkyOTM4ODcwKTtcXG5wb2lzc29uRGlza1szXT12ZWMyKDAuMzQ0OTU5MzgsMC4yOTM4Nzc2MCk7XFxuXFxuZmxvYXQgYmlhc2VkRGVwdGg9ZGVwdGguei1iaWFzO1xcbmlmICh1bnBhY2sodGV4dHVyZTJEKHNoYWRvd1NhbXBsZXIsdXYrcG9pc3NvbkRpc2tbMF0qbWFwU2l6ZSkpPGJpYXNlZERlcHRoKSB2aXNpYmlsaXR5LT0wLjI1O1xcbmlmICh1bnBhY2sodGV4dHVyZTJEKHNoYWRvd1NhbXBsZXIsdXYrcG9pc3NvbkRpc2tbMV0qbWFwU2l6ZSkpPGJpYXNlZERlcHRoKSB2aXNpYmlsaXR5LT0wLjI1O1xcbmlmICh1bnBhY2sodGV4dHVyZTJEKHNoYWRvd1NhbXBsZXIsdXYrcG9pc3NvbkRpc2tbMl0qbWFwU2l6ZSkpPGJpYXNlZERlcHRoKSB2aXNpYmlsaXR5LT0wLjI1O1xcbmlmICh1bnBhY2sodGV4dHVyZTJEKHNoYWRvd1NhbXBsZXIsdXYrcG9pc3NvbkRpc2tbM10qbWFwU2l6ZSkpPGJpYXNlZERlcHRoKSB2aXNpYmlsaXR5LT0wLjI1O1xcbiNpZmRlZiBPVkVSTE9BREVEU0hBRE9XVkFMVUVTXFxucmV0dXJuIG1pbigxLjAsbWl4KDEuMCx2aXNpYmlsaXR5K2RhcmtuZXNzLHZPdmVybG9hZGVkU2hhZG93SW50ZW5zaXR5LngpKTtcXG4jZWxzZVxcbnJldHVybiBtaW4oMS4wLHZpc2liaWxpdHkrZGFya25lc3MpO1xcbiNlbmRpZlxcbn1cXG5cXG5mbG9hdCB1bnBhY2tIYWxmKHZlYzIgY29sb3IpXFxue1xcbnJldHVybiBjb2xvci54Kyhjb2xvci55LzI1NS4wKTtcXG59XFxuZmxvYXQgbGluc3RlcChmbG9hdCBsb3csZmxvYXQgaGlnaCxmbG9hdCB2KSB7XFxucmV0dXJuIGNsYW1wKCh2LWxvdykvKGhpZ2gtbG93KSwwLjAsMS4wKTtcXG59XFxuZmxvYXQgQ2hlYnljaGV2SW5lcXVhbGl0eSh2ZWMyIG1vbWVudHMsZmxvYXQgY29tcGFyZSxmbG9hdCBiaWFzKVxcbntcXG5mbG9hdCBwPXNtb290aHN0ZXAoY29tcGFyZS1iaWFzLGNvbXBhcmUsbW9tZW50cy54KTtcXG5mbG9hdCB2YXJpYW5jZT1tYXgobW9tZW50cy55LW1vbWVudHMueCptb21lbnRzLngsMC4wMik7XFxuZmxvYXQgZD1jb21wYXJlLW1vbWVudHMueDtcXG5mbG9hdCBwX21heD1saW5zdGVwKDAuMiwxLjAsdmFyaWFuY2UvKHZhcmlhbmNlK2QqZCkpO1xcbnJldHVybiBjbGFtcChtYXgocCxwX21heCksMC4wLDEuMCk7XFxufVxcbmZsb2F0IGNvbXB1dGVTaGFkb3dXaXRoVlNNKHZlYzQgdlBvc2l0aW9uRnJvbUxpZ2h0LHNhbXBsZXIyRCBzaGFkb3dTYW1wbGVyLGZsb2F0IGJpYXMsZmxvYXQgZGFya25lc3MpXFxue1xcbnZlYzMgZGVwdGg9dlBvc2l0aW9uRnJvbUxpZ2h0Lnh5ei92UG9zaXRpb25Gcm9tTGlnaHQudztcXG5kZXB0aD0wLjUqZGVwdGgrdmVjMygwLjUpO1xcbnZlYzIgdXY9ZGVwdGgueHk7XFxuaWYgKHV2Lng8MC4gfHwgdXYueD4xLjAgfHwgdXYueTwwLiB8fCB1di55PjEuMCB8fCBkZXB0aC56Pj0xLjApXFxue1xcbnJldHVybiAxLjA7XFxufVxcbnZlYzQgdGV4ZWw9dGV4dHVyZTJEKHNoYWRvd1NhbXBsZXIsdXYpO1xcbnZlYzIgbW9tZW50cz12ZWMyKHVucGFja0hhbGYodGV4ZWwueHkpLHVucGFja0hhbGYodGV4ZWwuencpKTtcXG4jaWZkZWYgT1ZFUkxPQURFRFNIQURPV1ZBTFVFU1xcbnJldHVybiBtaW4oMS4wLG1peCgxLjAsMS4wLUNoZWJ5Y2hldkluZXF1YWxpdHkobW9tZW50cyxkZXB0aC56LGJpYXMpK2RhcmtuZXNzLHZPdmVybG9hZGVkU2hhZG93SW50ZW5zaXR5LngpKTtcXG4jZWxzZVxcbnJldHVybiBtaW4oMS4wLDEuMC1DaGVieWNoZXZJbmVxdWFsaXR5KG1vbWVudHMsZGVwdGgueixiaWFzKStkYXJrbmVzcyk7XFxuI2VuZGlmXFxufVxcbiNlbmRpZlwiLHBvaW50Q2xvdWRWZXJ0ZXg6XCIjaWZkZWYgUE9JTlRTSVpFXFxuZ2xfUG9pbnRTaXplPXBvaW50U2l6ZTtcXG4jZW5kaWZcIixwb2ludENsb3VkVmVydGV4RGVjbGFyYXRpb246XCIjaWZkZWYgUE9JTlRTSVpFXFxudW5pZm9ybSBmbG9hdCBwb2ludFNpemU7XFxuI2VuZGlmXCIscmVmbGVjdGlvbkZ1bmN0aW9uOlwidmVjMyBjb21wdXRlUmVmbGVjdGlvbkNvb3Jkcyh2ZWM0IHdvcmxkUG9zLHZlYzMgd29ybGROb3JtYWwpXFxue1xcbiNpZmRlZiBSRUZMRUNUSU9OTUFQX0VRVUlSRUNUQU5HVUxBUl9GSVhFRFxcbnZlYzMgZGlyZWN0aW9uPW5vcm1hbGl6ZSh2RGlyZWN0aW9uVyk7XFxuZmxvYXQgdD1jbGFtcChkaXJlY3Rpb24ueSotMC41KzAuNSwwLiwxLjApO1xcbmZsb2F0IHM9YXRhbihkaXJlY3Rpb24ueixkaXJlY3Rpb24ueCkqUkVDSVBST0NBTF9QSTIrMC41O1xcbnJldHVybiB2ZWMzKHMsdCwwKTtcXG4jZW5kaWZcXG4jaWZkZWYgUkVGTEVDVElPTk1BUF9FUVVJUkVDVEFOR1VMQVJcXG52ZWMzIGNhbWVyYVRvVmVydGV4PW5vcm1hbGl6ZSh3b3JsZFBvcy54eXotdkV5ZVBvc2l0aW9uKTtcXG52ZWMzIHI9cmVmbGVjdChjYW1lcmFUb1ZlcnRleCx3b3JsZE5vcm1hbCk7XFxuZmxvYXQgdD1jbGFtcChyLnkqLTAuNSswLjUsMC4sMS4wKTtcXG5mbG9hdCBzPWF0YW4oci56LHIueCkqUkVDSVBST0NBTF9QSTIrMC41O1xcbnJldHVybiB2ZWMzKHMsdCwwKTtcXG4jZW5kaWZcXG4jaWZkZWYgUkVGTEVDVElPTk1BUF9TUEhFUklDQUxcXG52ZWMzIHZpZXdEaXI9bm9ybWFsaXplKHZlYzModmlldyp3b3JsZFBvcykpO1xcbnZlYzMgdmlld05vcm1hbD1ub3JtYWxpemUodmVjMyh2aWV3KnZlYzQod29ybGROb3JtYWwsMC4wKSkpO1xcbnZlYzMgcj1yZWZsZWN0KHZpZXdEaXIsdmlld05vcm1hbCk7XFxuci56PXIuei0xLjA7XFxuZmxvYXQgbT0yLjAqbGVuZ3RoKHIpO1xcbnJldHVybiB2ZWMzKHIueC9tKzAuNSwxLjAtci55L20tMC41LDApO1xcbiNlbmRpZlxcbiNpZmRlZiBSRUZMRUNUSU9OTUFQX1BMQU5BUlxcbnZlYzMgdmlld0Rpcj13b3JsZFBvcy54eXotdkV5ZVBvc2l0aW9uO1xcbnZlYzMgY29vcmRzPW5vcm1hbGl6ZShyZWZsZWN0KHZpZXdEaXIsd29ybGROb3JtYWwpKTtcXG5yZXR1cm4gdmVjMyhyZWZsZWN0aW9uTWF0cml4KnZlYzQoY29vcmRzLDEpKTtcXG4jZW5kaWZcXG4jaWZkZWYgUkVGTEVDVElPTk1BUF9DVUJJQ1xcbnZlYzMgdmlld0Rpcj13b3JsZFBvcy54eXotdkV5ZVBvc2l0aW9uO1xcbnZlYzMgY29vcmRzPXJlZmxlY3Qodmlld0Rpcix3b3JsZE5vcm1hbCk7XFxuI2lmZGVmIElOVkVSVENVQklDTUFQXFxuY29vcmRzLnk9MS4wLWNvb3Jkcy55O1xcbiNlbmRpZlxcbnJldHVybiB2ZWMzKHJlZmxlY3Rpb25NYXRyaXgqdmVjNChjb29yZHMsMCkpO1xcbiNlbmRpZlxcbiNpZmRlZiBSRUZMRUNUSU9OTUFQX1BST0pFQ1RJT05cXG5yZXR1cm4gdmVjMyhyZWZsZWN0aW9uTWF0cml4Kih2aWV3KndvcmxkUG9zKSk7XFxuI2VuZGlmXFxuI2lmZGVmIFJFRkxFQ1RJT05NQVBfU0tZQk9YXFxucmV0dXJuIHZQb3NpdGlvblVWVztcXG4jZW5kaWZcXG4jaWZkZWYgUkVGTEVDVElPTk1BUF9FWFBMSUNJVFxcbnJldHVybiB2ZWMzKDAsMCwwKTtcXG4jZW5kaWZcXG59XCIsc2hhZG93c0ZyYWdtZW50RnVuY3Rpb25zOlwiI2lmZGVmIFNIQURPV1NcXG5mbG9hdCB1bnBhY2sodmVjNCBjb2xvcilcXG57XFxuY29uc3QgdmVjNCBiaXRfc2hpZnQ9dmVjNCgxLjAvKDI1NS4wKjI1NS4wKjI1NS4wKSwxLjAvKDI1NS4wKjI1NS4wKSwxLjAvMjU1LjAsMS4wKTtcXG5yZXR1cm4gZG90KGNvbG9yLGJpdF9zaGlmdCk7XFxufVxcbnVuaWZvcm0gdmVjMiBkZXB0aFZhbHVlcztcXG5mbG9hdCBjb21wdXRlU2hhZG93Q3ViZSh2ZWMzIGxpZ2h0UG9zaXRpb24sc2FtcGxlckN1YmUgc2hhZG93U2FtcGxlcixmbG9hdCBkYXJrbmVzcyxmbG9hdCBiaWFzKVxcbntcXG52ZWMzIGRpcmVjdGlvblRvTGlnaHQ9dlBvc2l0aW9uVy1saWdodFBvc2l0aW9uO1xcbmZsb2F0IGRlcHRoPWxlbmd0aChkaXJlY3Rpb25Ub0xpZ2h0KTtcXG5kZXB0aD0oZGVwdGgtZGVwdGhWYWx1ZXMueCkvKGRlcHRoVmFsdWVzLnktZGVwdGhWYWx1ZXMueCk7XFxuZGVwdGg9Y2xhbXAoZGVwdGgsMC4sMS4wKTtcXG5kaXJlY3Rpb25Ub0xpZ2h0PW5vcm1hbGl6ZShkaXJlY3Rpb25Ub0xpZ2h0KTtcXG5kaXJlY3Rpb25Ub0xpZ2h0Lnk9LWRpcmVjdGlvblRvTGlnaHQueTtcXG5mbG9hdCBzaGFkb3c9dW5wYWNrKHRleHR1cmVDdWJlKHNoYWRvd1NhbXBsZXIsZGlyZWN0aW9uVG9MaWdodCkpK2JpYXM7XFxuaWYgKGRlcHRoPnNoYWRvdylcXG57XFxucmV0dXJuIGRhcmtuZXNzO1xcbn1cXG5yZXR1cm4gMS4wO1xcbn1cXG5mbG9hdCBjb21wdXRlU2hhZG93V2l0aFBDRkN1YmUodmVjMyBsaWdodFBvc2l0aW9uLHNhbXBsZXJDdWJlIHNoYWRvd1NhbXBsZXIsZmxvYXQgbWFwU2l6ZSxmbG9hdCBiaWFzLGZsb2F0IGRhcmtuZXNzKVxcbntcXG52ZWMzIGRpcmVjdGlvblRvTGlnaHQ9dlBvc2l0aW9uVy1saWdodFBvc2l0aW9uO1xcbmZsb2F0IGRlcHRoPWxlbmd0aChkaXJlY3Rpb25Ub0xpZ2h0KTtcXG5kZXB0aD0oZGVwdGgtZGVwdGhWYWx1ZXMueCkvKGRlcHRoVmFsdWVzLnktZGVwdGhWYWx1ZXMueCk7XFxuZGVwdGg9Y2xhbXAoZGVwdGgsMC4sMS4wKTtcXG5kaXJlY3Rpb25Ub0xpZ2h0PW5vcm1hbGl6ZShkaXJlY3Rpb25Ub0xpZ2h0KTtcXG5kaXJlY3Rpb25Ub0xpZ2h0Lnk9LWRpcmVjdGlvblRvTGlnaHQueTtcXG5mbG9hdCB2aXNpYmlsaXR5PTEuO1xcbnZlYzMgcG9pc3NvbkRpc2tbNF07XFxucG9pc3NvbkRpc2tbMF09dmVjMygtMS4wLDEuMCwtMS4wKTtcXG5wb2lzc29uRGlza1sxXT12ZWMzKDEuMCwtMS4wLC0xLjApO1xcbnBvaXNzb25EaXNrWzJdPXZlYzMoLTEuMCwtMS4wLC0xLjApO1xcbnBvaXNzb25EaXNrWzNdPXZlYzMoMS4wLC0xLjAsMS4wKTtcXG5cXG5mbG9hdCBiaWFzZWREZXB0aD1kZXB0aC1iaWFzO1xcbmlmICh1bnBhY2sodGV4dHVyZUN1YmUoc2hhZG93U2FtcGxlcixkaXJlY3Rpb25Ub0xpZ2h0K3BvaXNzb25EaXNrWzBdKm1hcFNpemUpKTxiaWFzZWREZXB0aCkgdmlzaWJpbGl0eS09MC4yNTtcXG5pZiAodW5wYWNrKHRleHR1cmVDdWJlKHNoYWRvd1NhbXBsZXIsZGlyZWN0aW9uVG9MaWdodCtwb2lzc29uRGlza1sxXSptYXBTaXplKSk8Ymlhc2VkRGVwdGgpIHZpc2liaWxpdHktPTAuMjU7XFxuaWYgKHVucGFjayh0ZXh0dXJlQ3ViZShzaGFkb3dTYW1wbGVyLGRpcmVjdGlvblRvTGlnaHQrcG9pc3NvbkRpc2tbMl0qbWFwU2l6ZSkpPGJpYXNlZERlcHRoKSB2aXNpYmlsaXR5LT0wLjI1O1xcbmlmICh1bnBhY2sodGV4dHVyZUN1YmUoc2hhZG93U2FtcGxlcixkaXJlY3Rpb25Ub0xpZ2h0K3BvaXNzb25EaXNrWzNdKm1hcFNpemUpKTxiaWFzZWREZXB0aCkgdmlzaWJpbGl0eS09MC4yNTtcXG5yZXR1cm4gbWluKDEuMCx2aXNpYmlsaXR5K2RhcmtuZXNzKTtcXG59XFxuZmxvYXQgY29tcHV0ZVNoYWRvdyh2ZWM0IHZQb3NpdGlvbkZyb21MaWdodCxzYW1wbGVyMkQgc2hhZG93U2FtcGxlcixmbG9hdCBkYXJrbmVzcyxmbG9hdCBiaWFzKVxcbntcXG52ZWMzIGRlcHRoPXZQb3NpdGlvbkZyb21MaWdodC54eXovdlBvc2l0aW9uRnJvbUxpZ2h0Lnc7XFxuZGVwdGg9MC41KmRlcHRoK3ZlYzMoMC41KTtcXG52ZWMyIHV2PWRlcHRoLnh5O1xcbmlmICh1di54PDAuIHx8IHV2Lng+MS4wIHx8IHV2Lnk8MC4gfHwgdXYueT4xLjApXFxue1xcbnJldHVybiAxLjA7XFxufVxcbmZsb2F0IHNoYWRvdz11bnBhY2sodGV4dHVyZTJEKHNoYWRvd1NhbXBsZXIsdXYpKStiaWFzO1xcbmlmIChkZXB0aC56PnNoYWRvdylcXG57XFxucmV0dXJuIGRhcmtuZXNzO1xcbn1cXG5yZXR1cm4gMS47XFxufVxcbmZsb2F0IGNvbXB1dGVTaGFkb3dXaXRoUENGKHZlYzQgdlBvc2l0aW9uRnJvbUxpZ2h0LHNhbXBsZXIyRCBzaGFkb3dTYW1wbGVyLGZsb2F0IG1hcFNpemUsZmxvYXQgYmlhcyxmbG9hdCBkYXJrbmVzcylcXG57XFxudmVjMyBkZXB0aD12UG9zaXRpb25Gcm9tTGlnaHQueHl6L3ZQb3NpdGlvbkZyb21MaWdodC53O1xcbmRlcHRoPTAuNSpkZXB0aCt2ZWMzKDAuNSk7XFxudmVjMiB1dj1kZXB0aC54eTtcXG5pZiAodXYueDwwLiB8fCB1di54PjEuMCB8fCB1di55PDAuIHx8IHV2Lnk+MS4wKVxcbntcXG5yZXR1cm4gMS4wO1xcbn1cXG5mbG9hdCB2aXNpYmlsaXR5PTEuO1xcbnZlYzIgcG9pc3NvbkRpc2tbNF07XFxucG9pc3NvbkRpc2tbMF09dmVjMigtMC45NDIwMTYyNCwtMC4zOTkwNjIxNik7XFxucG9pc3NvbkRpc2tbMV09dmVjMigwLjk0NTU4NjA5LC0wLjc2ODkwNzI1KTtcXG5wb2lzc29uRGlza1syXT12ZWMyKC0wLjA5NDE4NDEwMSwtMC45MjkzODg3MCk7XFxucG9pc3NvbkRpc2tbM109dmVjMigwLjM0NDk1OTM4LDAuMjkzODc3NjApO1xcblxcbmZsb2F0IGJpYXNlZERlcHRoPWRlcHRoLnotYmlhcztcXG5pZiAodW5wYWNrKHRleHR1cmUyRChzaGFkb3dTYW1wbGVyLHV2K3BvaXNzb25EaXNrWzBdKm1hcFNpemUpKTxiaWFzZWREZXB0aCkgdmlzaWJpbGl0eS09MC4yNTtcXG5pZiAodW5wYWNrKHRleHR1cmUyRChzaGFkb3dTYW1wbGVyLHV2K3BvaXNzb25EaXNrWzFdKm1hcFNpemUpKTxiaWFzZWREZXB0aCkgdmlzaWJpbGl0eS09MC4yNTtcXG5pZiAodW5wYWNrKHRleHR1cmUyRChzaGFkb3dTYW1wbGVyLHV2K3BvaXNzb25EaXNrWzJdKm1hcFNpemUpKTxiaWFzZWREZXB0aCkgdmlzaWJpbGl0eS09MC4yNTtcXG5pZiAodW5wYWNrKHRleHR1cmUyRChzaGFkb3dTYW1wbGVyLHV2K3BvaXNzb25EaXNrWzNdKm1hcFNpemUpKTxiaWFzZWREZXB0aCkgdmlzaWJpbGl0eS09MC4yNTtcXG5yZXR1cm4gbWluKDEuMCx2aXNpYmlsaXR5K2RhcmtuZXNzKTtcXG59XFxuXFxuZmxvYXQgdW5wYWNrSGFsZih2ZWMyIGNvbG9yKVxcbntcXG5yZXR1cm4gY29sb3IueCsoY29sb3IueS8yNTUuMCk7XFxufVxcbmZsb2F0IGxpbnN0ZXAoZmxvYXQgbG93LGZsb2F0IGhpZ2gsZmxvYXQgdikge1xcbnJldHVybiBjbGFtcCgodi1sb3cpLyhoaWdoLWxvdyksMC4wLDEuMCk7XFxufVxcbmZsb2F0IENoZWJ5Y2hldkluZXF1YWxpdHkodmVjMiBtb21lbnRzLGZsb2F0IGNvbXBhcmUsZmxvYXQgYmlhcylcXG57XFxuZmxvYXQgcD1zbW9vdGhzdGVwKGNvbXBhcmUtYmlhcyxjb21wYXJlLG1vbWVudHMueCk7XFxuZmxvYXQgdmFyaWFuY2U9bWF4KG1vbWVudHMueS1tb21lbnRzLngqbW9tZW50cy54LDAuMDIpO1xcbmZsb2F0IGQ9Y29tcGFyZS1tb21lbnRzLng7XFxuZmxvYXQgcF9tYXg9bGluc3RlcCgwLjIsMS4wLHZhcmlhbmNlLyh2YXJpYW5jZStkKmQpKTtcXG5yZXR1cm4gY2xhbXAobWF4KHAscF9tYXgpLDAuMCwxLjApO1xcbn1cXG5mbG9hdCBjb21wdXRlU2hhZG93V2l0aFZTTSh2ZWM0IHZQb3NpdGlvbkZyb21MaWdodCxzYW1wbGVyMkQgc2hhZG93U2FtcGxlcixmbG9hdCBiaWFzLGZsb2F0IGRhcmtuZXNzKVxcbntcXG52ZWMzIGRlcHRoPXZQb3NpdGlvbkZyb21MaWdodC54eXovdlBvc2l0aW9uRnJvbUxpZ2h0Lnc7XFxuZGVwdGg9MC41KmRlcHRoK3ZlYzMoMC41KTtcXG52ZWMyIHV2PWRlcHRoLnh5O1xcbmlmICh1di54PDAuIHx8IHV2Lng+MS4wIHx8IHV2Lnk8MC4gfHwgdXYueT4xLjAgfHwgZGVwdGguej49MS4wKVxcbntcXG5yZXR1cm4gMS4wO1xcbn1cXG52ZWM0IHRleGVsPXRleHR1cmUyRChzaGFkb3dTYW1wbGVyLHV2KTtcXG52ZWMyIG1vbWVudHM9dmVjMih1bnBhY2tIYWxmKHRleGVsLnh5KSx1bnBhY2tIYWxmKHRleGVsLnp3KSk7XFxucmV0dXJuIG1pbigxLjAsMS4wLUNoZWJ5Y2hldkluZXF1YWxpdHkobW9tZW50cyxkZXB0aC56LGJpYXMpK2RhcmtuZXNzKTtcXG59XFxuI2VuZGlmXCIsc2hhZG93c1ZlcnRleDpcIiNpZmRlZiBTSEFET1dTXFxuI2lmIGRlZmluZWQoU1BPVExJR0hUe1h9KSB8fCBkZWZpbmVkKERJUkxJR0hUe1h9KVxcbnZQb3NpdGlvbkZyb21MaWdodHtYfT1saWdodE1hdHJpeHtYfSp3b3JsZFBvcztcXG4jZW5kaWZcXG4jZW5kaWZcIixzaGFkb3dzVmVydGV4RGVjbGFyYXRpb246XCIjaWZkZWYgU0hBRE9XU1xcbiNpZiBkZWZpbmVkKFNQT1RMSUdIVHtYfSkgfHwgZGVmaW5lZChESVJMSUdIVHtYfSlcXG51bmlmb3JtIG1hdDQgbGlnaHRNYXRyaXh7WH07XFxudmFyeWluZyB2ZWM0IHZQb3NpdGlvbkZyb21MaWdodHtYfTtcXG4jZW5kaWZcXG4jZW5kaWZcXG5cIn0sQkFCWUxPTi5Db2xsaXNpb25Xb3JrZXI9J3ZhciBCQUJZTE9OOyFmdW5jdGlvbih0KXt2YXIgZT1mdW5jdGlvbih0LGUsbyxpKXtyZXR1cm4gdC54Pm8ueCtpPyExOm8ueC1pPmUueD8hMTp0Lnk+by55K2k/ITE6by55LWk+ZS55PyExOnQuej5vLnoraT8hMTohKG8uei1pPmUueil9LG89ZnVuY3Rpb24odCxlLG8saSl7dmFyIHM9ZSplLTQqdCpvLHI9e3Jvb3Q6MCxmb3VuZDohMX07aWYoMD5zKXJldHVybiByO3ZhciBuPU1hdGguc3FydChzKSxjPSgtZS1uKS8oMip0KSxoPSgtZStuKS8oMip0KTtpZihjPmgpe3ZhciBhPWg7aD1jLGM9YX1yZXR1cm4gYz4wJiZpPmM/KHIucm9vdD1jLHIuZm91bmQ9ITAscik6aD4wJiZpPmg/KHIucm9vdD1oLHIuZm91bmQ9ITAscik6cn0saT1mdW5jdGlvbigpe2Z1bmN0aW9uIGkoKXt0aGlzLnJhZGl1cz1uZXcgdC5WZWN0b3IzKDEsMSwxKSx0aGlzLnJldHJ5PTAsdGhpcy5iYXNlUG9pbnRXb3JsZD10LlZlY3RvcjMuWmVybygpLHRoaXMudmVsb2NpdHlXb3JsZD10LlZlY3RvcjMuWmVybygpLHRoaXMubm9ybWFsaXplZFZlbG9jaXR5PXQuVmVjdG9yMy5aZXJvKCksdGhpcy5fY29sbGlzaW9uUG9pbnQ9dC5WZWN0b3IzLlplcm8oKSx0aGlzLl9wbGFuZUludGVyc2VjdGlvblBvaW50PXQuVmVjdG9yMy5aZXJvKCksdGhpcy5fdGVtcFZlY3Rvcj10LlZlY3RvcjMuWmVybygpLHRoaXMuX3RlbXBWZWN0b3IyPXQuVmVjdG9yMy5aZXJvKCksdGhpcy5fdGVtcFZlY3RvcjM9dC5WZWN0b3IzLlplcm8oKSx0aGlzLl90ZW1wVmVjdG9yND10LlZlY3RvcjMuWmVybygpLHRoaXMuX2VkZ2U9dC5WZWN0b3IzLlplcm8oKSx0aGlzLl9iYXNlVG9WZXJ0ZXg9dC5WZWN0b3IzLlplcm8oKSx0aGlzLl9kZXN0aW5hdGlvblBvaW50PXQuVmVjdG9yMy5aZXJvKCksdGhpcy5fc2xpZGVQbGFuZU5vcm1hbD10LlZlY3RvcjMuWmVybygpLHRoaXMuX2Rpc3BsYWNlbWVudFZlY3Rvcj10LlZlY3RvcjMuWmVybygpfXJldHVybiBpLnByb3RvdHlwZS5faW5pdGlhbGl6ZT1mdW5jdGlvbihlLG8saSl7dGhpcy52ZWxvY2l0eT1vLHQuVmVjdG9yMy5Ob3JtYWxpemVUb1JlZihvLHRoaXMubm9ybWFsaXplZFZlbG9jaXR5KSx0aGlzLmJhc2VQb2ludD1lLGUubXVsdGlwbHlUb1JlZih0aGlzLnJhZGl1cyx0aGlzLmJhc2VQb2ludFdvcmxkKSxvLm11bHRpcGx5VG9SZWYodGhpcy5yYWRpdXMsdGhpcy52ZWxvY2l0eVdvcmxkKSx0aGlzLnZlbG9jaXR5V29ybGRMZW5ndGg9dGhpcy52ZWxvY2l0eVdvcmxkLmxlbmd0aCgpLHRoaXMuZXBzaWxvbj1pLHRoaXMuY29sbGlzaW9uRm91bmQ9ITF9LGkucHJvdG90eXBlLl9jaGVja1BvaW50SW5UcmlhbmdsZT1mdW5jdGlvbihlLG8saSxzLHIpe28uc3VidHJhY3RUb1JlZihlLHRoaXMuX3RlbXBWZWN0b3IpLGkuc3VidHJhY3RUb1JlZihlLHRoaXMuX3RlbXBWZWN0b3IyKSx0LlZlY3RvcjMuQ3Jvc3NUb1JlZih0aGlzLl90ZW1wVmVjdG9yLHRoaXMuX3RlbXBWZWN0b3IyLHRoaXMuX3RlbXBWZWN0b3I0KTt2YXIgbj10LlZlY3RvcjMuRG90KHRoaXMuX3RlbXBWZWN0b3I0LHIpO3JldHVybiAwPm4/ITE6KHMuc3VidHJhY3RUb1JlZihlLHRoaXMuX3RlbXBWZWN0b3IzKSx0LlZlY3RvcjMuQ3Jvc3NUb1JlZih0aGlzLl90ZW1wVmVjdG9yMix0aGlzLl90ZW1wVmVjdG9yMyx0aGlzLl90ZW1wVmVjdG9yNCksbj10LlZlY3RvcjMuRG90KHRoaXMuX3RlbXBWZWN0b3I0LHIpLDA+bj8hMToodC5WZWN0b3IzLkNyb3NzVG9SZWYodGhpcy5fdGVtcFZlY3RvcjMsdGhpcy5fdGVtcFZlY3Rvcix0aGlzLl90ZW1wVmVjdG9yNCksbj10LlZlY3RvcjMuRG90KHRoaXMuX3RlbXBWZWN0b3I0LHIpLG4+PTApKX0saS5wcm90b3R5cGUuX2NhbkRvQ29sbGlzaW9uPWZ1bmN0aW9uKG8saSxzLHIpe3ZhciBuPXQuVmVjdG9yMy5EaXN0YW5jZSh0aGlzLmJhc2VQb2ludFdvcmxkLG8pLGM9TWF0aC5tYXgodGhpcy5yYWRpdXMueCx0aGlzLnJhZGl1cy55LHRoaXMucmFkaXVzLnopO3JldHVybiBuPnRoaXMudmVsb2NpdHlXb3JsZExlbmd0aCtjK2k/ITE6ISFlKHMscix0aGlzLmJhc2VQb2ludFdvcmxkLHRoaXMudmVsb2NpdHlXb3JsZExlbmd0aCtjKX0saS5wcm90b3R5cGUuX3Rlc3RUcmlhbmdsZT1mdW5jdGlvbihlLGkscyxyLG4sYyl7dmFyIGgsYT0hMTtpfHwoaT1bXSksaVtlXXx8KGlbZV09bmV3IHQuUGxhbmUoMCwwLDAsMCksaVtlXS5jb3B5RnJvbVBvaW50cyhzLHIsbikpO3ZhciBsPWlbZV07aWYoY3x8bC5pc0Zyb250RmFjaW5nVG8odGhpcy5ub3JtYWxpemVkVmVsb2NpdHksMCkpe3ZhciBfPWwuc2lnbmVkRGlzdGFuY2VUbyh0aGlzLmJhc2VQb2ludCksZD10LlZlY3RvcjMuRG90KGwubm9ybWFsLHRoaXMudmVsb2NpdHkpO2lmKDA9PWQpe2lmKE1hdGguYWJzKF8pPj0xKXJldHVybjthPSEwLGg9MH1lbHNle2g9KC0xLV8pL2Q7dmFyIFY9KDEtXykvZDtpZihoPlYpe3ZhciB1PVY7Vj1oLGg9dX1pZihoPjF8fDA+VilyZXR1cm47MD5oJiYoaD0wKSxoPjEmJihoPTEpfXRoaXMuX2NvbGxpc2lvblBvaW50LmNvcHlGcm9tRmxvYXRzKDAsMCwwKTt2YXIgUD0hMSxwPTE7aWYoYXx8KHRoaXMuYmFzZVBvaW50LnN1YnRyYWN0VG9SZWYobC5ub3JtYWwsdGhpcy5fcGxhbmVJbnRlcnNlY3Rpb25Qb2ludCksdGhpcy52ZWxvY2l0eS5zY2FsZVRvUmVmKGgsdGhpcy5fdGVtcFZlY3RvciksdGhpcy5fcGxhbmVJbnRlcnNlY3Rpb25Qb2ludC5hZGRJblBsYWNlKHRoaXMuX3RlbXBWZWN0b3IpLHRoaXMuX2NoZWNrUG9pbnRJblRyaWFuZ2xlKHRoaXMuX3BsYW5lSW50ZXJzZWN0aW9uUG9pbnQscyxyLG4sbC5ub3JtYWwpJiYoUD0hMCxwPWgsdGhpcy5fY29sbGlzaW9uUG9pbnQuY29weUZyb20odGhpcy5fcGxhbmVJbnRlcnNlY3Rpb25Qb2ludCkpKSwhUCl7dmFyIG09dGhpcy52ZWxvY2l0eS5sZW5ndGhTcXVhcmVkKCksZj1tO3RoaXMuYmFzZVBvaW50LnN1YnRyYWN0VG9SZWYocyx0aGlzLl90ZW1wVmVjdG9yKTt2YXIgVD0yKnQuVmVjdG9yMy5Eb3QodGhpcy52ZWxvY2l0eSx0aGlzLl90ZW1wVmVjdG9yKSxiPXRoaXMuX3RlbXBWZWN0b3IubGVuZ3RoU3F1YXJlZCgpLTEseT1vKGYsVCxiLHApO3kuZm91bmQmJihwPXkucm9vdCxQPSEwLHRoaXMuX2NvbGxpc2lvblBvaW50LmNvcHlGcm9tKHMpKSx0aGlzLmJhc2VQb2ludC5zdWJ0cmFjdFRvUmVmKHIsdGhpcy5fdGVtcFZlY3RvciksVD0yKnQuVmVjdG9yMy5Eb3QodGhpcy52ZWxvY2l0eSx0aGlzLl90ZW1wVmVjdG9yKSxiPXRoaXMuX3RlbXBWZWN0b3IubGVuZ3RoU3F1YXJlZCgpLTEseT1vKGYsVCxiLHApLHkuZm91bmQmJihwPXkucm9vdCxQPSEwLHRoaXMuX2NvbGxpc2lvblBvaW50LmNvcHlGcm9tKHIpKSx0aGlzLmJhc2VQb2ludC5zdWJ0cmFjdFRvUmVmKG4sdGhpcy5fdGVtcFZlY3RvciksVD0yKnQuVmVjdG9yMy5Eb3QodGhpcy52ZWxvY2l0eSx0aGlzLl90ZW1wVmVjdG9yKSxiPXRoaXMuX3RlbXBWZWN0b3IubGVuZ3RoU3F1YXJlZCgpLTEseT1vKGYsVCxiLHApLHkuZm91bmQmJihwPXkucm9vdCxQPSEwLHRoaXMuX2NvbGxpc2lvblBvaW50LmNvcHlGcm9tKG4pKSxyLnN1YnRyYWN0VG9SZWYocyx0aGlzLl9lZGdlKSxzLnN1YnRyYWN0VG9SZWYodGhpcy5iYXNlUG9pbnQsdGhpcy5fYmFzZVRvVmVydGV4KTt2YXIgZz10aGlzLl9lZGdlLmxlbmd0aFNxdWFyZWQoKSx2PXQuVmVjdG9yMy5Eb3QodGhpcy5fZWRnZSx0aGlzLnZlbG9jaXR5KSxSPXQuVmVjdG9yMy5Eb3QodGhpcy5fZWRnZSx0aGlzLl9iYXNlVG9WZXJ0ZXgpO2lmKGY9ZyotbSt2KnYsVD1nKigyKnQuVmVjdG9yMy5Eb3QodGhpcy52ZWxvY2l0eSx0aGlzLl9iYXNlVG9WZXJ0ZXgpKS0yKnYqUixiPWcqKDEtdGhpcy5fYmFzZVRvVmVydGV4Lmxlbmd0aFNxdWFyZWQoKSkrUipSLHk9byhmLFQsYixwKSx5LmZvdW5kKXt2YXIgRD0odip5LnJvb3QtUikvZztEPj0wJiYxPj1EJiYocD15LnJvb3QsUD0hMCx0aGlzLl9lZGdlLnNjYWxlSW5QbGFjZShEKSxzLmFkZFRvUmVmKHRoaXMuX2VkZ2UsdGhpcy5fY29sbGlzaW9uUG9pbnQpKX1uLnN1YnRyYWN0VG9SZWYocix0aGlzLl9lZGdlKSxyLnN1YnRyYWN0VG9SZWYodGhpcy5iYXNlUG9pbnQsdGhpcy5fYmFzZVRvVmVydGV4KSxnPXRoaXMuX2VkZ2UubGVuZ3RoU3F1YXJlZCgpLHY9dC5WZWN0b3IzLkRvdCh0aGlzLl9lZGdlLHRoaXMudmVsb2NpdHkpLFI9dC5WZWN0b3IzLkRvdCh0aGlzLl9lZGdlLHRoaXMuX2Jhc2VUb1ZlcnRleCksZj1nKi1tK3YqdixUPWcqKDIqdC5WZWN0b3IzLkRvdCh0aGlzLnZlbG9jaXR5LHRoaXMuX2Jhc2VUb1ZlcnRleCkpLTIqdipSLGI9ZyooMS10aGlzLl9iYXNlVG9WZXJ0ZXgubGVuZ3RoU3F1YXJlZCgpKStSKlIseT1vKGYsVCxiLHApLHkuZm91bmQmJihEPSh2Knkucm9vdC1SKS9nLEQ+PTAmJjE+PUQmJihwPXkucm9vdCxQPSEwLHRoaXMuX2VkZ2Uuc2NhbGVJblBsYWNlKEQpLHIuYWRkVG9SZWYodGhpcy5fZWRnZSx0aGlzLl9jb2xsaXNpb25Qb2ludCkpKSxzLnN1YnRyYWN0VG9SZWYobix0aGlzLl9lZGdlKSxuLnN1YnRyYWN0VG9SZWYodGhpcy5iYXNlUG9pbnQsdGhpcy5fYmFzZVRvVmVydGV4KSxnPXRoaXMuX2VkZ2UubGVuZ3RoU3F1YXJlZCgpLHY9dC5WZWN0b3IzLkRvdCh0aGlzLl9lZGdlLHRoaXMudmVsb2NpdHkpLFI9dC5WZWN0b3IzLkRvdCh0aGlzLl9lZGdlLHRoaXMuX2Jhc2VUb1ZlcnRleCksZj1nKi1tK3YqdixUPWcqKDIqdC5WZWN0b3IzLkRvdCh0aGlzLnZlbG9jaXR5LHRoaXMuX2Jhc2VUb1ZlcnRleCkpLTIqdipSLGI9ZyooMS10aGlzLl9iYXNlVG9WZXJ0ZXgubGVuZ3RoU3F1YXJlZCgpKStSKlIseT1vKGYsVCxiLHApLHkuZm91bmQmJihEPSh2Knkucm9vdC1SKS9nLEQ+PTAmJjE+PUQmJihwPXkucm9vdCxQPSEwLHRoaXMuX2VkZ2Uuc2NhbGVJblBsYWNlKEQpLG4uYWRkVG9SZWYodGhpcy5fZWRnZSx0aGlzLl9jb2xsaXNpb25Qb2ludCkpKX1pZihQKXt2YXIgeD1wKnRoaXMudmVsb2NpdHkubGVuZ3RoKCk7KCF0aGlzLmNvbGxpc2lvbkZvdW5kfHx4PHRoaXMubmVhcmVzdERpc3RhbmNlKSYmKHRoaXMuaW50ZXJzZWN0aW9uUG9pbnQ/dGhpcy5pbnRlcnNlY3Rpb25Qb2ludC5jb3B5RnJvbSh0aGlzLl9jb2xsaXNpb25Qb2ludCk6dGhpcy5pbnRlcnNlY3Rpb25Qb2ludD10aGlzLl9jb2xsaXNpb25Qb2ludC5jbG9uZSgpLHRoaXMubmVhcmVzdERpc3RhbmNlPXgsdGhpcy5jb2xsaXNpb25Gb3VuZD0hMCl9fX0saS5wcm90b3R5cGUuX2NvbGxpZGU9ZnVuY3Rpb24odCxlLG8saSxzLHIsbil7Zm9yKHZhciBjPWk7cz5jO2MrPTMpe3ZhciBoPWVbb1tjXS1yXSxhPWVbb1tjKzFdLXJdLGw9ZVtvW2MrMl0tcl07dGhpcy5fdGVzdFRyaWFuZ2xlKGMsdCxsLGEsaCxuKX19LGkucHJvdG90eXBlLl9nZXRSZXNwb25zZT1mdW5jdGlvbihlLG8pe2UuYWRkVG9SZWYobyx0aGlzLl9kZXN0aW5hdGlvblBvaW50KSxvLnNjYWxlSW5QbGFjZSh0aGlzLm5lYXJlc3REaXN0YW5jZS9vLmxlbmd0aCgpKSx0aGlzLmJhc2VQb2ludC5hZGRUb1JlZihvLGUpLGUuc3VidHJhY3RUb1JlZih0aGlzLmludGVyc2VjdGlvblBvaW50LHRoaXMuX3NsaWRlUGxhbmVOb3JtYWwpLHRoaXMuX3NsaWRlUGxhbmVOb3JtYWwubm9ybWFsaXplKCksdGhpcy5fc2xpZGVQbGFuZU5vcm1hbC5zY2FsZVRvUmVmKHRoaXMuZXBzaWxvbix0aGlzLl9kaXNwbGFjZW1lbnRWZWN0b3IpLGUuYWRkSW5QbGFjZSh0aGlzLl9kaXNwbGFjZW1lbnRWZWN0b3IpLHRoaXMuaW50ZXJzZWN0aW9uUG9pbnQuYWRkSW5QbGFjZSh0aGlzLl9kaXNwbGFjZW1lbnRWZWN0b3IpLHRoaXMuX3NsaWRlUGxhbmVOb3JtYWwuc2NhbGVJblBsYWNlKHQuUGxhbmUuU2lnbmVkRGlzdGFuY2VUb1BsYW5lRnJvbVBvc2l0aW9uQW5kTm9ybWFsKHRoaXMuaW50ZXJzZWN0aW9uUG9pbnQsdGhpcy5fc2xpZGVQbGFuZU5vcm1hbCx0aGlzLl9kZXN0aW5hdGlvblBvaW50KSksdGhpcy5fZGVzdGluYXRpb25Qb2ludC5zdWJ0cmFjdEluUGxhY2UodGhpcy5fc2xpZGVQbGFuZU5vcm1hbCksdGhpcy5fZGVzdGluYXRpb25Qb2ludC5zdWJ0cmFjdFRvUmVmKHRoaXMuaW50ZXJzZWN0aW9uUG9pbnQsbyl9LGl9KCk7dC5Db2xsaWRlcj1pfShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihvKXtvLldvcmtlckluY2x1ZGVkPSEwO3ZhciBlPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gbygpe3RoaXMuX21lc2hlcz17fSx0aGlzLl9nZW9tZXRyaWVzPXt9fXJldHVybiBvLnByb3RvdHlwZS5nZXRNZXNoZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fbWVzaGVzfSxvLnByb3RvdHlwZS5nZXRHZW9tZXRyaWVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2dlb21ldHJpZXN9LG8ucHJvdG90eXBlLmdldE1lc2g9ZnVuY3Rpb24obyl7cmV0dXJuIHRoaXMuX21lc2hlc1tvXX0sby5wcm90b3R5cGUuYWRkTWVzaD1mdW5jdGlvbihvKXt0aGlzLl9tZXNoZXNbby51bmlxdWVJZF09b30sby5wcm90b3R5cGUucmVtb3ZlTWVzaD1mdW5jdGlvbihvKXtkZWxldGUgdGhpcy5fbWVzaGVzW29dfSxvLnByb3RvdHlwZS5nZXRHZW9tZXRyeT1mdW5jdGlvbihvKXtyZXR1cm4gdGhpcy5fZ2VvbWV0cmllc1tvXX0sby5wcm90b3R5cGUuYWRkR2VvbWV0cnk9ZnVuY3Rpb24obyl7dGhpcy5fZ2VvbWV0cmllc1tvLmlkXT1vfSxvLnByb3RvdHlwZS5yZW1vdmVHZW9tZXRyeT1mdW5jdGlvbihvKXtkZWxldGUgdGhpcy5fZ2VvbWV0cmllc1tvXX0sb30oKTtvLkNvbGxpc2lvbkNhY2hlPWU7dmFyIGk9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUsaSxyKXt0aGlzLmNvbGxpZGVyPWUsdGhpcy5fY29sbGlzaW9uQ2FjaGU9aSx0aGlzLmZpbmFsUG9zaXRpb249cix0aGlzLmNvbGxpc2lvbnNTY2FsaW5nTWF0cml4PW8uTWF0cml4Llplcm8oKSx0aGlzLmNvbGxpc2lvblRyYW5mb3JtYXRpb25NYXRyaXg9by5NYXRyaXguWmVybygpfXJldHVybiBlLnByb3RvdHlwZS5jb2xsaWRlV2l0aFdvcmxkPWZ1bmN0aW9uKG8sZSxpLHIpe3ZhciB0PS4wMTtpZih0aGlzLmNvbGxpZGVyLnJldHJ5Pj1pKXJldHVybiB2b2lkIHRoaXMuZmluYWxQb3NpdGlvbi5jb3B5RnJvbShvKTt0aGlzLmNvbGxpZGVyLl9pbml0aWFsaXplKG8sZSx0KTtmb3IodmFyIHMsbD10aGlzLl9jb2xsaXNpb25DYWNoZS5nZXRNZXNoZXMoKSxuPU9iamVjdC5rZXlzKGwpLGE9bi5sZW5ndGgsYz0wO2E+YzsrK2MpaWYocz1uW2NdLHBhcnNlSW50KHMpIT1yKXt2YXIgZD1sW3NdO2QuY2hlY2tDb2xsaXNpb25zJiZ0aGlzLmNoZWNrQ29sbGlzaW9uKGQpfXJldHVybiB0aGlzLmNvbGxpZGVyLmNvbGxpc2lvbkZvdW5kPygwPT09ZS54JiYwPT09ZS55JiYwPT09ZS56fHx0aGlzLmNvbGxpZGVyLl9nZXRSZXNwb25zZShvLGUpLGUubGVuZ3RoKCk8PXQ/dm9pZCB0aGlzLmZpbmFsUG9zaXRpb24uY29weUZyb20obyk6KHRoaXMuY29sbGlkZXIucmV0cnkrKyx2b2lkIHRoaXMuY29sbGlkZVdpdGhXb3JsZChvLGUsaSxyKSkpOnZvaWQgby5hZGRUb1JlZihlLHRoaXMuZmluYWxQb3NpdGlvbil9LGUucHJvdG90eXBlLmNoZWNrQ29sbGlzaW9uPWZ1bmN0aW9uKGUpe2lmKHRoaXMuY29sbGlkZXIuX2NhbkRvQ29sbGlzaW9uKG8uVmVjdG9yMy5Gcm9tQXJyYXkoZS5zcGhlcmVDZW50ZXIpLGUuc3BoZXJlUmFkaXVzLG8uVmVjdG9yMy5Gcm9tQXJyYXkoZS5ib3hNaW5pbXVtKSxvLlZlY3RvcjMuRnJvbUFycmF5KGUuYm94TWF4aW11bSkpKXtvLk1hdHJpeC5TY2FsaW5nVG9SZWYoMS90aGlzLmNvbGxpZGVyLnJhZGl1cy54LDEvdGhpcy5jb2xsaWRlci5yYWRpdXMueSwxL3RoaXMuY29sbGlkZXIucmFkaXVzLnosdGhpcy5jb2xsaXNpb25zU2NhbGluZ01hdHJpeCk7dmFyIGk9by5NYXRyaXguRnJvbUFycmF5KGUud29ybGRNYXRyaXhGcm9tQ2FjaGUpO2kubXVsdGlwbHlUb1JlZih0aGlzLmNvbGxpc2lvbnNTY2FsaW5nTWF0cml4LHRoaXMuY29sbGlzaW9uVHJhbmZvcm1hdGlvbk1hdHJpeCksdGhpcy5wcm9jZXNzQ29sbGlzaW9uc0ZvclN1Yk1lc2hlcyh0aGlzLmNvbGxpc2lvblRyYW5mb3JtYXRpb25NYXRyaXgsZSl9fSxlLnByb3RvdHlwZS5wcm9jZXNzQ29sbGlzaW9uc0ZvclN1Yk1lc2hlcz1mdW5jdGlvbihvLGUpe3ZhciBpPWUuc3ViTWVzaGVzLHI9aS5sZW5ndGg7aWYoIWUuZ2VvbWV0cnlJZClyZXR1cm4gdm9pZCBjb25zb2xlLmxvZyhcIm5vIG1lc2ggZ2VvbWV0cnkgaWRcIik7dmFyIHQ9dGhpcy5fY29sbGlzaW9uQ2FjaGUuZ2V0R2VvbWV0cnkoZS5nZW9tZXRyeUlkKTtpZighdClyZXR1cm4gdm9pZCBjb25zb2xlLmxvZyhcImNvdWxkblxcJ3QgZmluZCBnZW9tZXRyeVwiLGUuZ2VvbWV0cnlJZCk7Zm9yKHZhciBzPTA7cj5zO3MrKyl7dmFyIGw9aVtzXTtyPjEmJiF0aGlzLmNoZWNrU3VibWVzaENvbGxpc2lvbihsKXx8KHRoaXMuY29sbGlkZUZvclN1Yk1lc2gobCxvLHQpLHRoaXMuY29sbGlkZXIuY29sbGlzaW9uRm91bmQmJih0aGlzLmNvbGxpZGVyLmNvbGxpZGVkTWVzaD1lLnVuaXF1ZUlkKSl9fSxlLnByb3RvdHlwZS5jb2xsaWRlRm9yU3ViTWVzaD1mdW5jdGlvbihlLGkscil7aWYoIXIucG9zaXRpb25zQXJyYXkpe3IucG9zaXRpb25zQXJyYXk9W107Zm9yKHZhciB0PTAscz1yLnBvc2l0aW9ucy5sZW5ndGg7cz50O3QrPTMpe3ZhciBsPW8uVmVjdG9yMy5Gcm9tQXJyYXkoW3IucG9zaXRpb25zW3RdLHIucG9zaXRpb25zW3QrMV0sci5wb3NpdGlvbnNbdCsyXV0pO3IucG9zaXRpb25zQXJyYXkucHVzaChsKX19aWYoIWUuX2xhc3RDb2xsaWRlcldvcmxkVmVydGljZXN8fCFlLl9sYXN0Q29sbGlkZXJUcmFuc2Zvcm1NYXRyaXguZXF1YWxzKGkpKXtlLl9sYXN0Q29sbGlkZXJUcmFuc2Zvcm1NYXRyaXg9aS5jbG9uZSgpLGUuX2xhc3RDb2xsaWRlcldvcmxkVmVydGljZXM9W10sZS5fdHJpYW5nbGVQbGFuZXM9W107Zm9yKHZhciBuPWUudmVydGljZXNTdGFydCxhPWUudmVydGljZXNTdGFydCtlLnZlcnRpY2VzQ291bnQsdD1uO2E+dDt0KyspZS5fbGFzdENvbGxpZGVyV29ybGRWZXJ0aWNlcy5wdXNoKG8uVmVjdG9yMy5UcmFuc2Zvcm1Db29yZGluYXRlcyhyLnBvc2l0aW9uc0FycmF5W3RdLGkpKX10aGlzLmNvbGxpZGVyLl9jb2xsaWRlKGUuX3RyaWFuZ2xlUGxhbmVzLGUuX2xhc3RDb2xsaWRlcldvcmxkVmVydGljZXMsci5pbmRpY2VzLGUuaW5kZXhTdGFydCxlLmluZGV4U3RhcnQrZS5pbmRleENvdW50LGUudmVydGljZXNTdGFydCxlLmhhc01hdGVyaWFsKX0sZS5wcm90b3R5cGUuY2hlY2tTdWJtZXNoQ29sbGlzaW9uPWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmNvbGxpZGVyLl9jYW5Eb0NvbGxpc2lvbihvLlZlY3RvcjMuRnJvbUFycmF5KGUuc3BoZXJlQ2VudGVyKSxlLnNwaGVyZVJhZGl1cyxvLlZlY3RvcjMuRnJvbUFycmF5KGUuYm94TWluaW11bSksby5WZWN0b3IzLkZyb21BcnJheShlLmJveE1heGltdW0pKX0sZX0oKTtvLkNvbGxpZGVXb3JrZXI9aTt2YXIgcj1mdW5jdGlvbigpe2Z1bmN0aW9uIHIoKXt9cmV0dXJuIHIucHJvdG90eXBlLm9uSW5pdD1mdW5jdGlvbihpKXt0aGlzLl9jb2xsaXNpb25DYWNoZT1uZXcgZTt2YXIgcj17ZXJyb3I6by5Xb3JrZXJSZXBseVR5cGUuU1VDQ0VTUyx0YXNrVHlwZTpvLldvcmtlclRhc2tUeXBlLklOSVR9O3Bvc3RNZXNzYWdlKHIsdm9pZCAwKX0sci5wcm90b3R5cGUub25VcGRhdGU9ZnVuY3Rpb24oZSl7dmFyIGk9dGhpcyxyPXtlcnJvcjpvLldvcmtlclJlcGx5VHlwZS5TVUNDRVNTLHRhc2tUeXBlOm8uV29ya2VyVGFza1R5cGUuVVBEQVRFfTt0cnl7Zm9yKHZhciB0IGluIGUudXBkYXRlZEdlb21ldHJpZXMpZS51cGRhdGVkR2VvbWV0cmllcy5oYXNPd25Qcm9wZXJ0eSh0KSYmdGhpcy5fY29sbGlzaW9uQ2FjaGUuYWRkR2VvbWV0cnkoZS51cGRhdGVkR2VvbWV0cmllc1t0XSk7Zm9yKHZhciBzIGluIGUudXBkYXRlZE1lc2hlcyllLnVwZGF0ZWRNZXNoZXMuaGFzT3duUHJvcGVydHkocykmJnRoaXMuX2NvbGxpc2lvbkNhY2hlLmFkZE1lc2goZS51cGRhdGVkTWVzaGVzW3NdKTtlLnJlbW92ZWRHZW9tZXRyaWVzLmZvckVhY2goZnVuY3Rpb24obyl7aS5fY29sbGlzaW9uQ2FjaGUucmVtb3ZlR2VvbWV0cnkobyl9KSxlLnJlbW92ZWRNZXNoZXMuZm9yRWFjaChmdW5jdGlvbihvKXtpLl9jb2xsaXNpb25DYWNoZS5yZW1vdmVNZXNoKG8pfSl9Y2F0Y2gobCl7ci5lcnJvcj1vLldvcmtlclJlcGx5VHlwZS5VTktOT1dOX0VSUk9SfXBvc3RNZXNzYWdlKHIsdm9pZCAwKX0sci5wcm90b3R5cGUub25Db2xsaXNpb249ZnVuY3Rpb24oZSl7dmFyIHI9by5WZWN0b3IzLlplcm8oKSx0PW5ldyBvLkNvbGxpZGVyO3QucmFkaXVzPW8uVmVjdG9yMy5Gcm9tQXJyYXkoZS5jb2xsaWRlci5yYWRpdXMpO3ZhciBzPW5ldyBpKHQsdGhpcy5fY29sbGlzaW9uQ2FjaGUscik7cy5jb2xsaWRlV2l0aFdvcmxkKG8uVmVjdG9yMy5Gcm9tQXJyYXkoZS5jb2xsaWRlci5wb3NpdGlvbiksby5WZWN0b3IzLkZyb21BcnJheShlLmNvbGxpZGVyLnZlbG9jaXR5KSxlLm1heGltdW1SZXRyeSxlLmV4Y2x1ZGVkTWVzaFVuaXF1ZUlkKTt2YXIgbD17Y29sbGlkZWRNZXNoVW5pcXVlSWQ6dC5jb2xsaWRlZE1lc2gsY29sbGlzaW9uSWQ6ZS5jb2xsaXNpb25JZCxuZXdQb3NpdGlvbjpyLmFzQXJyYXkoKX0sbj17ZXJyb3I6by5Xb3JrZXJSZXBseVR5cGUuU1VDQ0VTUyx0YXNrVHlwZTpvLldvcmtlclRhc2tUeXBlLkNPTExJREUscGF5bG9hZDpsfTtwb3N0TWVzc2FnZShuLHZvaWQgMCl9LHJ9KCk7by5Db2xsaXNpb25EZXRlY3RvclRyYW5zZmVyYWJsZT1yO3RyeXtpZihzZWxmJiZzZWxmIGluc3RhbmNlb2YgV29ya2VyR2xvYmFsU2NvcGUpe3dpbmRvdz17fSxvLkNvbGxpZGVyfHwoaW1wb3J0U2NyaXB0cyhcIi4vYmFieWxvbi5jb2xsaXNpb25Db29yZGluYXRvci5qc1wiKSxpbXBvcnRTY3JpcHRzKFwiLi9iYWJ5bG9uLmNvbGxpZGVyLmpzXCIpLGltcG9ydFNjcmlwdHMoXCIuLi9NYXRoL2JhYnlsb24ubWF0aC5qc1wiKSk7dmFyIHQ9bmV3IHIscz1mdW5jdGlvbihlKXt2YXIgaT1lLmRhdGE7c3dpdGNoKGkudGFza1R5cGUpe2Nhc2Ugby5Xb3JrZXJUYXNrVHlwZS5JTklUOnQub25Jbml0KGkucGF5bG9hZCk7YnJlYWs7Y2FzZSBvLldvcmtlclRhc2tUeXBlLkNPTExJREU6dC5vbkNvbGxpc2lvbihpLnBheWxvYWQpO2JyZWFrO2Nhc2Ugby5Xb3JrZXJUYXNrVHlwZS5VUERBVEU6dC5vblVwZGF0ZShpLnBheWxvYWQpfX07c2VsZi5vbm1lc3NhZ2U9c319Y2F0Y2gobCl7Y29uc29sZS5sb2coXCJzaW5nbGUgd29ya2VyIGluaXRcIil9fShCQUJZTE9OfHwoQkFCWUxPTj17fSkpO3ZhciBCQUJZTE9OOyFmdW5jdGlvbihlKXtlLkNvbGxpc2lvbldvcmtlcj1cIlwiLGZ1bmN0aW9uKGUpe2VbZS5JTklUPTBdPVwiSU5JVFwiLGVbZS5VUERBVEU9MV09XCJVUERBVEVcIixlW2UuQ09MTElERT0yXT1cIkNPTExJREVcIn0oZS5Xb3JrZXJUYXNrVHlwZXx8KGUuV29ya2VyVGFza1R5cGU9e30pKTt2YXIgbz1lLldvcmtlclRhc2tUeXBlOyFmdW5jdGlvbihlKXtlW2UuU1VDQ0VTUz0wXT1cIlNVQ0NFU1NcIixlW2UuVU5LTk9XTl9FUlJPUj0xXT1cIlVOS05PV05fRVJST1JcIn0oZS5Xb3JrZXJSZXBseVR5cGV8fChlLldvcmtlclJlcGx5VHlwZT17fSkpO3ZhciBpPWUuV29ya2VyUmVwbHlUeXBlLHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KCl7dmFyIHI9dGhpczt0aGlzLl9zY2FsZWRQb3NpdGlvbj1lLlZlY3RvcjMuWmVybygpLHRoaXMuX3NjYWxlZFZlbG9jaXR5PWUuVmVjdG9yMy5aZXJvKCksdGhpcy5vbk1lc2hVcGRhdGVkPWZ1bmN0aW9uKGUpe3IuX2FkZFVwZGF0ZU1lc2hlc0xpc3RbZS51bmlxdWVJZF09dC5TZXJpYWxpemVNZXNoKGUpfSx0aGlzLm9uR2VvbWV0cnlVcGRhdGVkPWZ1bmN0aW9uKGUpe3IuX2FkZFVwZGF0ZUdlb21ldHJpZXNMaXN0W2UuaWRdPXQuU2VyaWFsaXplR2VvbWV0cnkoZSl9LHRoaXMuX2FmdGVyUmVuZGVyPWZ1bmN0aW9uKCl7aWYoci5faW5pdCYmISgwPT1yLl90b1JlbW92ZUdlb21ldHJ5QXJyYXkubGVuZ3RoJiYwPT1yLl90b1JlbW92ZU1lc2hlc0FycmF5Lmxlbmd0aCYmMD09T2JqZWN0LmtleXMoci5fYWRkVXBkYXRlR2VvbWV0cmllc0xpc3QpLmxlbmd0aCYmMD09T2JqZWN0LmtleXMoci5fYWRkVXBkYXRlTWVzaGVzTGlzdCkubGVuZ3RofHxyLl9ydW5uaW5nVXBkYXRlZD40KSl7KytyLl9ydW5uaW5nVXBkYXRlZDt2YXIgZT17dXBkYXRlZE1lc2hlczpyLl9hZGRVcGRhdGVNZXNoZXNMaXN0LHVwZGF0ZWRHZW9tZXRyaWVzOnIuX2FkZFVwZGF0ZUdlb21ldHJpZXNMaXN0LHJlbW92ZWRHZW9tZXRyaWVzOnIuX3RvUmVtb3ZlR2VvbWV0cnlBcnJheSxyZW1vdmVkTWVzaGVzOnIuX3RvUmVtb3ZlTWVzaGVzQXJyYXl9LGk9e3BheWxvYWQ6ZSx0YXNrVHlwZTpvLlVQREFURX0sdD1bXTtmb3IodmFyIHMgaW4gZS51cGRhdGVkR2VvbWV0cmllcyllLnVwZGF0ZWRHZW9tZXRyaWVzLmhhc093blByb3BlcnR5KHMpJiYodC5wdXNoKGkucGF5bG9hZC51cGRhdGVkR2VvbWV0cmllc1tzXS5pbmRpY2VzLmJ1ZmZlciksdC5wdXNoKGkucGF5bG9hZC51cGRhdGVkR2VvbWV0cmllc1tzXS5ub3JtYWxzLmJ1ZmZlciksdC5wdXNoKGkucGF5bG9hZC51cGRhdGVkR2VvbWV0cmllc1tzXS5wb3NpdGlvbnMuYnVmZmVyKSk7ci5fd29ya2VyLnBvc3RNZXNzYWdlKGksdCksci5fYWRkVXBkYXRlTWVzaGVzTGlzdD17fSxyLl9hZGRVcGRhdGVHZW9tZXRyaWVzTGlzdD17fSxyLl90b1JlbW92ZUdlb21ldHJ5QXJyYXk9W10sci5fdG9SZW1vdmVNZXNoZXNBcnJheT1bXX19LHRoaXMuX29uTWVzc2FnZUZyb21Xb3JrZXI9ZnVuY3Rpb24odCl7dmFyIHM9dC5kYXRhO2lmKHMuZXJyb3IhPWkuU1VDQ0VTUylyZXR1cm4gdm9pZCBlLlRvb2xzLldhcm4oXCJlcnJvciByZXR1cm5lZCBmcm9tIHdvcmtlciFcIik7c3dpdGNoKHMudGFza1R5cGUpe2Nhc2Ugby5JTklUOnIuX2luaXQ9ITAsci5fc2NlbmUubWVzaGVzLmZvckVhY2goZnVuY3Rpb24oZSl7ci5vbk1lc2hBZGRlZChlKX0pLHIuX3NjZW5lLmdldEdlb21ldHJpZXMoKS5mb3JFYWNoKGZ1bmN0aW9uKGUpe3Iub25HZW9tZXRyeUFkZGVkKGUpfSk7YnJlYWs7Y2FzZSBvLlVQREFURTpyLl9ydW5uaW5nVXBkYXRlZC0tO2JyZWFrO2Nhc2Ugby5DT0xMSURFOnIuX3J1bm5pbmdDb2xsaXNpb25UYXNrPSExO3ZhciBuPXMucGF5bG9hZDtpZighci5fY29sbGlzaW9uc0NhbGxiYWNrQXJyYXlbbi5jb2xsaXNpb25JZF0pcmV0dXJuO3IuX2NvbGxpc2lvbnNDYWxsYmFja0FycmF5W24uY29sbGlzaW9uSWRdKG4uY29sbGlzaW9uSWQsZS5WZWN0b3IzLkZyb21BcnJheShuLm5ld1Bvc2l0aW9uKSxyLl9zY2VuZS5nZXRNZXNoQnlVbmlxdWVJRChuLmNvbGxpZGVkTWVzaFVuaXF1ZUlkKSksci5fY29sbGlzaW9uc0NhbGxiYWNrQXJyYXlbbi5jb2xsaXNpb25JZF09dm9pZCAwfX0sdGhpcy5fY29sbGlzaW9uc0NhbGxiYWNrQXJyYXk9W10sdGhpcy5faW5pdD0hMSx0aGlzLl9ydW5uaW5nVXBkYXRlZD0wLHRoaXMuX3J1bm5pbmdDb2xsaXNpb25UYXNrPSExLHRoaXMuX2FkZFVwZGF0ZU1lc2hlc0xpc3Q9e30sdGhpcy5fYWRkVXBkYXRlR2VvbWV0cmllc0xpc3Q9e30sdGhpcy5fdG9SZW1vdmVHZW9tZXRyeUFycmF5PVtdLHRoaXMuX3RvUmVtb3ZlTWVzaGVzQXJyYXk9W119cmV0dXJuIHQucHJvdG90eXBlLmdldE5ld1Bvc2l0aW9uPWZ1bmN0aW9uKGUsaSx0LHIscyxuLGEpe2lmKHRoaXMuX2luaXQmJiF0aGlzLl9jb2xsaXNpb25zQ2FsbGJhY2tBcnJheVthXSYmIXRoaXMuX2NvbGxpc2lvbnNDYWxsYmFja0FycmF5W2ErMWU1XSl7ZS5kaXZpZGVUb1JlZih0LnJhZGl1cyx0aGlzLl9zY2FsZWRQb3NpdGlvbiksaS5kaXZpZGVUb1JlZih0LnJhZGl1cyx0aGlzLl9zY2FsZWRWZWxvY2l0eSksdGhpcy5fY29sbGlzaW9uc0NhbGxiYWNrQXJyYXlbYV09bjt2YXIgZD17Y29sbGlkZXI6e3Bvc2l0aW9uOnRoaXMuX3NjYWxlZFBvc2l0aW9uLmFzQXJyYXkoKSx2ZWxvY2l0eTp0aGlzLl9zY2FsZWRWZWxvY2l0eS5hc0FycmF5KCkscmFkaXVzOnQucmFkaXVzLmFzQXJyYXkoKX0sY29sbGlzaW9uSWQ6YSxleGNsdWRlZE1lc2hVbmlxdWVJZDpzP3MudW5pcXVlSWQ6bnVsbCxtYXhpbXVtUmV0cnk6cn0sbD17cGF5bG9hZDpkLHRhc2tUeXBlOm8uQ09MTElERX07dGhpcy5fd29ya2VyLnBvc3RNZXNzYWdlKGwpfX0sdC5wcm90b3R5cGUuaW5pdD1mdW5jdGlvbihpKXt0aGlzLl9zY2VuZT1pLHRoaXMuX3NjZW5lLnJlZ2lzdGVyQWZ0ZXJSZW5kZXIodGhpcy5fYWZ0ZXJSZW5kZXIpO3ZhciB0PWUuV29ya2VySW5jbHVkZWQ/ZS5FbmdpbmUuQ29kZVJlcG9zaXRvcnkrXCJDb2xsaXNpb25zL2JhYnlsb24uY29sbGlzaW9uV29ya2VyLmpzXCI6VVJMLmNyZWF0ZU9iamVjdFVSTChuZXcgQmxvYihbZS5Db2xsaXNpb25Xb3JrZXJdLHt0eXBlOlwiYXBwbGljYXRpb24vamF2YXNjcmlwdFwifSkpO3RoaXMuX3dvcmtlcj1uZXcgV29ya2VyKHQpLHRoaXMuX3dvcmtlci5vbm1lc3NhZ2U9dGhpcy5fb25NZXNzYWdlRnJvbVdvcmtlcjt2YXIgcj17cGF5bG9hZDp7fSx0YXNrVHlwZTpvLklOSVR9O3RoaXMuX3dvcmtlci5wb3N0TWVzc2FnZShyKX0sdC5wcm90b3R5cGUuZGVzdHJveT1mdW5jdGlvbigpe3RoaXMuX3NjZW5lLnVucmVnaXN0ZXJBZnRlclJlbmRlcih0aGlzLl9hZnRlclJlbmRlciksdGhpcy5fd29ya2VyLnRlcm1pbmF0ZSgpfSx0LnByb3RvdHlwZS5vbk1lc2hBZGRlZD1mdW5jdGlvbihlKXtlLnJlZ2lzdGVyQWZ0ZXJXb3JsZE1hdHJpeFVwZGF0ZSh0aGlzLm9uTWVzaFVwZGF0ZWQpLHRoaXMub25NZXNoVXBkYXRlZChlKX0sdC5wcm90b3R5cGUub25NZXNoUmVtb3ZlZD1mdW5jdGlvbihlKXt0aGlzLl90b1JlbW92ZU1lc2hlc0FycmF5LnB1c2goZS51bmlxdWVJZCl9LHQucHJvdG90eXBlLm9uR2VvbWV0cnlBZGRlZD1mdW5jdGlvbihlKXtlLm9uR2VvbWV0cnlVcGRhdGVkPXRoaXMub25HZW9tZXRyeVVwZGF0ZWQsdGhpcy5vbkdlb21ldHJ5VXBkYXRlZChlKX0sdC5wcm90b3R5cGUub25HZW9tZXRyeURlbGV0ZWQ9ZnVuY3Rpb24oZSl7dGhpcy5fdG9SZW1vdmVHZW9tZXRyeUFycmF5LnB1c2goZS5pZCl9LHQuU2VyaWFsaXplTWVzaD1mdW5jdGlvbihvKXt2YXIgaT1bXTtvLnN1Yk1lc2hlcyYmKGk9by5zdWJNZXNoZXMubWFwKGZ1bmN0aW9uKGUsbyl7cmV0dXJue3Bvc2l0aW9uOm8sdmVydGljZXNTdGFydDplLnZlcnRpY2VzU3RhcnQsdmVydGljZXNDb3VudDplLnZlcnRpY2VzQ291bnQsaW5kZXhTdGFydDplLmluZGV4U3RhcnQsaW5kZXhDb3VudDplLmluZGV4Q291bnQsaGFzTWF0ZXJpYWw6ISFlLmdldE1hdGVyaWFsKCksc3BoZXJlQ2VudGVyOmUuZ2V0Qm91bmRpbmdJbmZvKCkuYm91bmRpbmdTcGhlcmUuY2VudGVyV29ybGQuYXNBcnJheSgpLHNwaGVyZVJhZGl1czplLmdldEJvdW5kaW5nSW5mbygpLmJvdW5kaW5nU3BoZXJlLnJhZGl1c1dvcmxkLGJveE1pbmltdW06ZS5nZXRCb3VuZGluZ0luZm8oKS5ib3VuZGluZ0JveC5taW5pbXVtV29ybGQuYXNBcnJheSgpLGJveE1heGltdW06ZS5nZXRCb3VuZGluZ0luZm8oKS5ib3VuZGluZ0JveC5tYXhpbXVtV29ybGQuYXNBcnJheSgpfX0pKTt2YXIgdD1udWxsO3JldHVybiBvIGluc3RhbmNlb2YgZS5NZXNoP3Q9by5nZW9tZXRyeT9vLmdlb21ldHJ5LmlkOm51bGw6byBpbnN0YW5jZW9mIGUuSW5zdGFuY2VkTWVzaCYmKHQ9by5zb3VyY2VNZXNoJiZvLnNvdXJjZU1lc2guZ2VvbWV0cnk/by5zb3VyY2VNZXNoLmdlb21ldHJ5LmlkOm51bGwpLHt1bmlxdWVJZDpvLnVuaXF1ZUlkLGlkOm8uaWQsbmFtZTpvLm5hbWUsZ2VvbWV0cnlJZDp0LHNwaGVyZUNlbnRlcjpvLmdldEJvdW5kaW5nSW5mbygpLmJvdW5kaW5nU3BoZXJlLmNlbnRlcldvcmxkLmFzQXJyYXkoKSxzcGhlcmVSYWRpdXM6by5nZXRCb3VuZGluZ0luZm8oKS5ib3VuZGluZ1NwaGVyZS5yYWRpdXNXb3JsZCxib3hNaW5pbXVtOm8uZ2V0Qm91bmRpbmdJbmZvKCkuYm91bmRpbmdCb3gubWluaW11bVdvcmxkLmFzQXJyYXkoKSxib3hNYXhpbXVtOm8uZ2V0Qm91bmRpbmdJbmZvKCkuYm91bmRpbmdCb3gubWF4aW11bVdvcmxkLmFzQXJyYXkoKSx3b3JsZE1hdHJpeEZyb21DYWNoZTpvLndvcmxkTWF0cml4RnJvbUNhY2hlLmFzQXJyYXkoKSxzdWJNZXNoZXM6aSxjaGVja0NvbGxpc2lvbnM6by5jaGVja0NvbGxpc2lvbnN9fSx0LlNlcmlhbGl6ZUdlb21ldHJ5PWZ1bmN0aW9uKG8pe3JldHVybntpZDpvLmlkLHBvc2l0aW9uczpuZXcgRmxvYXQzMkFycmF5KG8uZ2V0VmVydGljZXNEYXRhKGUuVmVydGV4QnVmZmVyLlBvc2l0aW9uS2luZCl8fFtdKSxub3JtYWxzOm5ldyBGbG9hdDMyQXJyYXkoby5nZXRWZXJ0aWNlc0RhdGEoZS5WZXJ0ZXhCdWZmZXIuTm9ybWFsS2luZCl8fFtdKSxpbmRpY2VzOm5ldyBJbnQzMkFycmF5KG8uZ2V0SW5kaWNlcygpfHxbXSl9fSx0fSgpO2UuQ29sbGlzaW9uQ29vcmRpbmF0b3JXb3JrZXI9dDt2YXIgcj1mdW5jdGlvbigpe2Z1bmN0aW9uIG8oKXt0aGlzLl9zY2FsZWRQb3NpdGlvbj1lLlZlY3RvcjMuWmVybygpLHRoaXMuX3NjYWxlZFZlbG9jaXR5PWUuVmVjdG9yMy5aZXJvKCksdGhpcy5fZmluYWxQb3NpdGlvbj1lLlZlY3RvcjMuWmVybygpfXJldHVybiBvLnByb3RvdHlwZS5nZXROZXdQb3NpdGlvbj1mdW5jdGlvbihlLG8saSx0LHIscyxuKXtlLmRpdmlkZVRvUmVmKGkucmFkaXVzLHRoaXMuX3NjYWxlZFBvc2l0aW9uKSxvLmRpdmlkZVRvUmVmKGkucmFkaXVzLHRoaXMuX3NjYWxlZFZlbG9jaXR5KSxpLmNvbGxpZGVkTWVzaD1udWxsLGkucmV0cnk9MCxpLmluaXRpYWxWZWxvY2l0eT10aGlzLl9zY2FsZWRWZWxvY2l0eSxpLmluaXRpYWxQb3NpdGlvbj10aGlzLl9zY2FsZWRQb3NpdGlvbix0aGlzLl9jb2xsaWRlV2l0aFdvcmxkKHRoaXMuX3NjYWxlZFBvc2l0aW9uLHRoaXMuX3NjYWxlZFZlbG9jaXR5LGksdCx0aGlzLl9maW5hbFBvc2l0aW9uLHIpLHRoaXMuX2ZpbmFsUG9zaXRpb24ubXVsdGlwbHlJblBsYWNlKGkucmFkaXVzKSxzKG4sdGhpcy5fZmluYWxQb3NpdGlvbixpLmNvbGxpZGVkTWVzaCl9LG8ucHJvdG90eXBlLmluaXQ9ZnVuY3Rpb24oZSl7dGhpcy5fc2NlbmU9ZX0sby5wcm90b3R5cGUuZGVzdHJveT1mdW5jdGlvbigpe30sby5wcm90b3R5cGUub25NZXNoQWRkZWQ9ZnVuY3Rpb24oZSl7fSxvLnByb3RvdHlwZS5vbk1lc2hVcGRhdGVkPWZ1bmN0aW9uKGUpe30sby5wcm90b3R5cGUub25NZXNoUmVtb3ZlZD1mdW5jdGlvbihlKXt9LG8ucHJvdG90eXBlLm9uR2VvbWV0cnlBZGRlZD1mdW5jdGlvbihlKXt9LG8ucHJvdG90eXBlLm9uR2VvbWV0cnlVcGRhdGVkPWZ1bmN0aW9uKGUpe30sby5wcm90b3R5cGUub25HZW9tZXRyeURlbGV0ZWQ9ZnVuY3Rpb24oZSl7fSxvLnByb3RvdHlwZS5fY29sbGlkZVdpdGhXb3JsZD1mdW5jdGlvbihvLGksdCxyLHMsbil7dm9pZCAwPT09biYmKG49bnVsbCk7dmFyIGE9MTAqZS5FbmdpbmUuQ29sbGlzaW9uc0Vwc2lsb247aWYodC5yZXRyeT49cilyZXR1cm4gdm9pZCBzLmNvcHlGcm9tKG8pO3QuX2luaXRpYWxpemUobyxpLGEpO2Zvcih2YXIgZD0wO2Q8dGhpcy5fc2NlbmUubWVzaGVzLmxlbmd0aDtkKyspe3ZhciBsPXRoaXMuX3NjZW5lLm1lc2hlc1tkXTtsLmlzRW5hYmxlZCgpJiZsLmNoZWNrQ29sbGlzaW9ucyYmbC5zdWJNZXNoZXMmJmwhPT1uJiZsLl9jaGVja0NvbGxpc2lvbih0KX1yZXR1cm4gdC5jb2xsaXNpb25Gb3VuZD8oMD09PWkueCYmMD09PWkueSYmMD09PWkuenx8dC5fZ2V0UmVzcG9uc2UobyxpKSxpLmxlbmd0aCgpPD1hP3ZvaWQgcy5jb3B5RnJvbShvKToodC5yZXRyeSsrLHZvaWQgdGhpcy5fY29sbGlkZVdpdGhXb3JsZChvLGksdCxyLHMsbikpKTp2b2lkIG8uYWRkVG9SZWYoaSxzKX0sb30oKTtlLkNvbGxpc2lvbkNvb3JkaW5hdG9yTGVnYWN5PXJ9KEJBQllMT058fChCQUJZTE9OPXt9KSk7dmFyIEJBQllMT047IWZ1bmN0aW9uKHQpe3QuVG9HYW1tYVNwYWNlPTEvMi4yLHQuVG9MaW5lYXJTcGFjZT0yLjIsdC5FcHNpbG9uPS4wMDE7dmFyIGk9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KCl7fXJldHVybiB0LldpdGhpbkVwc2lsb249ZnVuY3Rpb24odCxpLG4pe3ZvaWQgMD09PW4mJihuPTEuNDAxMjk4ZS00NSk7dmFyIHI9dC1pO3JldHVybiByPj0tbiYmbj49cn0sdC5Ub0hleD1mdW5jdGlvbih0KXt2YXIgaT10LnRvU3RyaW5nKDE2KTtyZXR1cm4gMTU+PXQ/KFwiMFwiK2kpLnRvVXBwZXJDYXNlKCk6aS50b1VwcGVyQ2FzZSgpfSx0LlNpZ249ZnVuY3Rpb24odCl7cmV0dXJuIHQ9K3QsMD09PXR8fGlzTmFOKHQpP3Q6dD4wPzE6LTF9LHQuQ2xhbXA9ZnVuY3Rpb24odCxpLG4pe3JldHVybiB2b2lkIDA9PT1pJiYoaT0wKSx2b2lkIDA9PT1uJiYobj0xKSxNYXRoLm1pbihuLE1hdGgubWF4KGksdCkpfSx0fSgpO3QuTWF0aFRvb2xzPWk7dmFyIG49ZnVuY3Rpb24oKXtmdW5jdGlvbiBuKHQsaSxuKXt2b2lkIDA9PT10JiYodD0wKSx2b2lkIDA9PT1pJiYoaT0wKSx2b2lkIDA9PT1uJiYobj0wKSx0aGlzLnI9dCx0aGlzLmc9aSx0aGlzLmI9bn1yZXR1cm4gbi5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm5cIntSOiBcIit0aGlzLnIrXCIgRzpcIit0aGlzLmcrXCIgQjpcIit0aGlzLmIrXCJ9XCJ9LG4ucHJvdG90eXBlLmdldENsYXNzTmFtZT1mdW5jdGlvbigpe3JldHVyblwiQ29sb3IzXCJ9LG4ucHJvdG90eXBlLmdldEhhc2hDb2RlPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5yfHwwO3JldHVybiB0PTM5Nyp0Xih0aGlzLmd8fDApLHQ9Mzk3KnReKHRoaXMuYnx8MCl9LG4ucHJvdG90eXBlLnRvQXJyYXk9ZnVuY3Rpb24odCxpKXtyZXR1cm4gdm9pZCAwPT09aSYmKGk9MCksdFtpXT10aGlzLnIsdFtpKzFdPXRoaXMuZyx0W2krMl09dGhpcy5iLHRoaXN9LG4ucHJvdG90eXBlLnRvQ29sb3I0PWZ1bmN0aW9uKHQpe3JldHVybiB2b2lkIDA9PT10JiYodD0xKSxuZXcgcih0aGlzLnIsdGhpcy5nLHRoaXMuYix0KX0sbi5wcm90b3R5cGUuYXNBcnJheT1mdW5jdGlvbigpe3ZhciB0PVtdO3JldHVybiB0aGlzLnRvQXJyYXkodCwwKSx0fSxuLnByb3RvdHlwZS50b0x1bWluYW5jZT1mdW5jdGlvbigpe3JldHVybi4zKnRoaXMucisuNTkqdGhpcy5nKy4xMSp0aGlzLmJ9LG4ucHJvdG90eXBlLm11bHRpcGx5PWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgbih0aGlzLnIqdC5yLHRoaXMuZyp0LmcsdGhpcy5iKnQuYil9LG4ucHJvdG90eXBlLm11bHRpcGx5VG9SZWY9ZnVuY3Rpb24odCxpKXtyZXR1cm4gaS5yPXRoaXMucip0LnIsaS5nPXRoaXMuZyp0LmcsaS5iPXRoaXMuYip0LmIsdGhpc30sbi5wcm90b3R5cGUuZXF1YWxzPWZ1bmN0aW9uKHQpe3JldHVybiB0JiZ0aGlzLnI9PT10LnImJnRoaXMuZz09PXQuZyYmdGhpcy5iPT09dC5ifSxuLnByb3RvdHlwZS5lcXVhbHNGbG9hdHM9ZnVuY3Rpb24odCxpLG4pe3JldHVybiB0aGlzLnI9PT10JiZ0aGlzLmc9PT1pJiZ0aGlzLmI9PT1ufSxuLnByb3RvdHlwZS5zY2FsZT1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG4odGhpcy5yKnQsdGhpcy5nKnQsdGhpcy5iKnQpfSxuLnByb3RvdHlwZS5zY2FsZVRvUmVmPWZ1bmN0aW9uKHQsaSl7cmV0dXJuIGkucj10aGlzLnIqdCxpLmc9dGhpcy5nKnQsaS5iPXRoaXMuYip0LHRoaXN9LG4ucHJvdG90eXBlLmFkZD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG4odGhpcy5yK3Qucix0aGlzLmcrdC5nLHRoaXMuYit0LmIpfSxuLnByb3RvdHlwZS5hZGRUb1JlZj1mdW5jdGlvbih0LGkpe3JldHVybiBpLnI9dGhpcy5yK3QucixpLmc9dGhpcy5nK3QuZyxpLmI9dGhpcy5iK3QuYix0aGlzfSxuLnByb3RvdHlwZS5zdWJ0cmFjdD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG4odGhpcy5yLXQucix0aGlzLmctdC5nLHRoaXMuYi10LmIpfSxuLnByb3RvdHlwZS5zdWJ0cmFjdFRvUmVmPWZ1bmN0aW9uKHQsaSl7cmV0dXJuIGkucj10aGlzLnItdC5yLGkuZz10aGlzLmctdC5nLGkuYj10aGlzLmItdC5iLHRoaXN9LG4ucHJvdG90eXBlLmNsb25lPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBuKHRoaXMucix0aGlzLmcsdGhpcy5iKX0sbi5wcm90b3R5cGUuY29weUZyb209ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMucj10LnIsdGhpcy5nPXQuZyx0aGlzLmI9dC5iLHRoaXN9LG4ucHJvdG90eXBlLmNvcHlGcm9tRmxvYXRzPWZ1bmN0aW9uKHQsaSxuKXtyZXR1cm4gdGhpcy5yPXQsdGhpcy5nPWksdGhpcy5iPW4sdGhpc30sbi5wcm90b3R5cGUudG9IZXhTdHJpbmc9ZnVuY3Rpb24oKXt2YXIgdD0yNTUqdGhpcy5yfDAsbj0yNTUqdGhpcy5nfDAscj0yNTUqdGhpcy5ifDA7cmV0dXJuXCIjXCIraS5Ub0hleCh0KStpLlRvSGV4KG4pK2kuVG9IZXgocil9LG4ucHJvdG90eXBlLnRvTGluZWFyU3BhY2U9ZnVuY3Rpb24oKXt2YXIgdD1uZXcgbjtyZXR1cm4gdGhpcy50b0xpbmVhclNwYWNlVG9SZWYodCksdH0sbi5wcm90b3R5cGUudG9MaW5lYXJTcGFjZVRvUmVmPWZ1bmN0aW9uKGkpe3JldHVybiBpLnI9TWF0aC5wb3codGhpcy5yLHQuVG9MaW5lYXJTcGFjZSksaS5nPU1hdGgucG93KHRoaXMuZyx0LlRvTGluZWFyU3BhY2UpLGkuYj1NYXRoLnBvdyh0aGlzLmIsdC5Ub0xpbmVhclNwYWNlKSx0aGlzfSxuLnByb3RvdHlwZS50b0dhbW1hU3BhY2U9ZnVuY3Rpb24oKXt2YXIgdD1uZXcgbjtyZXR1cm4gdGhpcy50b0dhbW1hU3BhY2VUb1JlZih0KSx0fSxuLnByb3RvdHlwZS50b0dhbW1hU3BhY2VUb1JlZj1mdW5jdGlvbihpKXtyZXR1cm4gaS5yPU1hdGgucG93KHRoaXMucix0LlRvR2FtbWFTcGFjZSksaS5nPU1hdGgucG93KHRoaXMuZyx0LlRvR2FtbWFTcGFjZSksaS5iPU1hdGgucG93KHRoaXMuYix0LlRvR2FtbWFTcGFjZSksdGhpc30sbi5Gcm9tSGV4U3RyaW5nPWZ1bmN0aW9uKHQpe2lmKFwiI1wiIT09dC5zdWJzdHJpbmcoMCwxKXx8NyE9PXQubGVuZ3RoKXJldHVybiBuZXcgbigwLDAsMCk7dmFyIGk9cGFyc2VJbnQodC5zdWJzdHJpbmcoMSwzKSwxNikscj1wYXJzZUludCh0LnN1YnN0cmluZygzLDUpLDE2KSxvPXBhcnNlSW50KHQuc3Vic3RyaW5nKDUsNyksMTYpO3JldHVybiBuLkZyb21JbnRzKGkscixvKX0sbi5Gcm9tQXJyYXk9ZnVuY3Rpb24odCxpKXtyZXR1cm4gdm9pZCAwPT09aSYmKGk9MCksbmV3IG4odFtpXSx0W2krMV0sdFtpKzJdKX0sbi5Gcm9tSW50cz1mdW5jdGlvbih0LGkscil7cmV0dXJuIG5ldyBuKHQvMjU1LGkvMjU1LHIvMjU1KX0sbi5MZXJwPWZ1bmN0aW9uKHQsaSxyKXt2YXIgbz10LnIrKGkuci10LnIpKnIscz10LmcrKGkuZy10LmcpKnIsZT10LmIrKGkuYi10LmIpKnI7cmV0dXJuIG5ldyBuKG8scyxlKX0sbi5SZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IG4oMSwwLDApfSxuLkdyZWVuPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBuKDAsMSwwKX0sbi5CbHVlPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBuKDAsMCwxKX0sbi5CbGFjaz1mdW5jdGlvbigpe3JldHVybiBuZXcgbigwLDAsMCl9LG4uV2hpdGU9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IG4oMSwxLDEpfSxuLlB1cnBsZT1mdW5jdGlvbigpe3JldHVybiBuZXcgbiguNSwwLC41KX0sbi5NYWdlbnRhPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBuKDEsMCwxKX0sbi5ZZWxsb3c9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IG4oMSwxLDApfSxuLkdyYXk9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IG4oLjUsLjUsLjUpfSxufSgpO3QuQ29sb3IzPW47dmFyIHI9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQsaSxuLHIpe3RoaXMucj10LHRoaXMuZz1pLHRoaXMuYj1uLHRoaXMuYT1yfXJldHVybiB0LnByb3RvdHlwZS5hZGRJblBsYWNlPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnIrPXQucix0aGlzLmcrPXQuZyx0aGlzLmIrPXQuYix0aGlzLmErPXQuYSx0aGlzfSx0LnByb3RvdHlwZS5hc0FycmF5PWZ1bmN0aW9uKCl7dmFyIHQ9W107cmV0dXJuIHRoaXMudG9BcnJheSh0LDApLHR9LHQucHJvdG90eXBlLnRvQXJyYXk9ZnVuY3Rpb24odCxpKXtyZXR1cm4gdm9pZCAwPT09aSYmKGk9MCksdFtpXT10aGlzLnIsdFtpKzFdPXRoaXMuZyx0W2krMl09dGhpcy5iLHRbaSszXT10aGlzLmEsdGhpc30sdC5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGkpe3JldHVybiBuZXcgdCh0aGlzLnIraS5yLHRoaXMuZytpLmcsdGhpcy5iK2kuYix0aGlzLmEraS5hKX0sdC5wcm90b3R5cGUuc3VidHJhY3Q9ZnVuY3Rpb24oaSl7cmV0dXJuIG5ldyB0KHRoaXMuci1pLnIsdGhpcy5nLWkuZyx0aGlzLmItaS5iLHRoaXMuYS1pLmEpfSx0LnByb3RvdHlwZS5zdWJ0cmFjdFRvUmVmPWZ1bmN0aW9uKHQsaSl7cmV0dXJuIGkucj10aGlzLnItdC5yLGkuZz10aGlzLmctdC5nLGkuYj10aGlzLmItdC5iLGkuYT10aGlzLmEtdC5hLHRoaXN9LHQucHJvdG90eXBlLnNjYWxlPWZ1bmN0aW9uKGkpe3JldHVybiBuZXcgdCh0aGlzLnIqaSx0aGlzLmcqaSx0aGlzLmIqaSx0aGlzLmEqaSl9LHQucHJvdG90eXBlLnNjYWxlVG9SZWY9ZnVuY3Rpb24odCxpKXtyZXR1cm4gaS5yPXRoaXMucip0LGkuZz10aGlzLmcqdCxpLmI9dGhpcy5iKnQsaS5hPXRoaXMuYSp0LHRoaXN9LHQucHJvdG90eXBlLm11bHRpcGx5PWZ1bmN0aW9uKGkpe3JldHVybiBuZXcgdCh0aGlzLnIqaS5yLHRoaXMuZyppLmcsdGhpcy5iKmkuYix0aGlzLmEqaS5hKX0sdC5wcm90b3R5cGUubXVsdGlwbHlUb1JlZj1mdW5jdGlvbih0LGkpe3JldHVybiBpLnI9dGhpcy5yKnQucixpLmc9dGhpcy5nKnQuZyxpLmI9dGhpcy5iKnQuYixpLmE9dGhpcy5hKnQuYSxpfSx0LnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVyblwie1I6IFwiK3RoaXMucitcIiBHOlwiK3RoaXMuZytcIiBCOlwiK3RoaXMuYitcIiBBOlwiK3RoaXMuYStcIn1cIn0sdC5wcm90b3R5cGUuZ2V0Q2xhc3NOYW1lPWZ1bmN0aW9uKCl7cmV0dXJuXCJDb2xvcjRcIn0sdC5wcm90b3R5cGUuZ2V0SGFzaENvZGU9ZnVuY3Rpb24oKXt2YXIgdD10aGlzLnJ8fDA7cmV0dXJuIHQ9Mzk3KnReKHRoaXMuZ3x8MCksdD0zOTcqdF4odGhpcy5ifHwwKSx0PTM5Nyp0Xih0aGlzLmF8fDApfSx0LnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbigpe3JldHVybiBuZXcgdCh0aGlzLnIsdGhpcy5nLHRoaXMuYix0aGlzLmEpfSx0LnByb3RvdHlwZS5jb3B5RnJvbT1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5yPXQucix0aGlzLmc9dC5nLHRoaXMuYj10LmIsdGhpcy5hPXQuYSx0aGlzfSx0LnByb3RvdHlwZS50b0hleFN0cmluZz1mdW5jdGlvbigpe3ZhciB0PTI1NSp0aGlzLnJ8MCxuPTI1NSp0aGlzLmd8MCxyPTI1NSp0aGlzLmJ8MCxvPTI1NSp0aGlzLmF8MDtyZXR1cm5cIiNcIitpLlRvSGV4KHQpK2kuVG9IZXgobikraS5Ub0hleChyKStpLlRvSGV4KG8pfSx0LkZyb21IZXhTdHJpbmc9ZnVuY3Rpb24oaSl7aWYoXCIjXCIhPT1pLnN1YnN0cmluZygwLDEpfHw5IT09aS5sZW5ndGgpcmV0dXJuIG5ldyB0KDAsMCwwLDApO3ZhciBuPXBhcnNlSW50KGkuc3Vic3RyaW5nKDEsMyksMTYpLHI9cGFyc2VJbnQoaS5zdWJzdHJpbmcoMyw1KSwxNiksbz1wYXJzZUludChpLnN1YnN0cmluZyg1LDcpLDE2KSxzPXBhcnNlSW50KGkuc3Vic3RyaW5nKDcsOSksMTYpO3JldHVybiB0LkZyb21JbnRzKG4scixvLHMpfSx0LkxlcnA9ZnVuY3Rpb24oaSxuLHIpe3ZhciBvPW5ldyB0KDAsMCwwLDApO3JldHVybiB0LkxlcnBUb1JlZihpLG4scixvKSxvfSx0LkxlcnBUb1JlZj1mdW5jdGlvbih0LGksbixyKXtyLnI9dC5yKyhpLnItdC5yKSpuLHIuZz10LmcrKGkuZy10LmcpKm4sci5iPXQuYisoaS5iLXQuYikqbixyLmE9dC5hKyhpLmEtdC5hKSpufSx0LkZyb21BcnJheT1mdW5jdGlvbihpLG4pe3JldHVybiB2b2lkIDA9PT1uJiYobj0wKSxuZXcgdChpW25dLGlbbisxXSxpW24rMl0saVtuKzNdKX0sdC5Gcm9tSW50cz1mdW5jdGlvbihpLG4scixvKXtyZXR1cm4gbmV3IHQoaS8yNTUsbi8yNTUsci8yNTUsby8yNTUpfSx0LkNoZWNrQ29sb3JzND1mdW5jdGlvbih0LGkpe2lmKHQubGVuZ3RoPT09MyppKXtmb3IodmFyIG49W10scj0wO3I8dC5sZW5ndGg7cis9Myl7dmFyIG89ci8zKjQ7bltvXT10W3JdLG5bbysxXT10W3IrMV0sbltvKzJdPXRbcisyXSxuW28rM109MX1yZXR1cm4gbn1yZXR1cm4gdH0sdH0oKTt0LkNvbG9yND1yO3ZhciBvPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gbih0LGkpe3RoaXMueD10LHRoaXMueT1pfXJldHVybiBuLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVyblwie1g6IFwiK3RoaXMueCtcIiBZOlwiK3RoaXMueStcIn1cIn0sbi5wcm90b3R5cGUuZ2V0Q2xhc3NOYW1lPWZ1bmN0aW9uKCl7cmV0dXJuXCJWZWN0b3IyXCJ9LG4ucHJvdG90eXBlLmdldEhhc2hDb2RlPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy54fHwwO3JldHVybiB0PTM5Nyp0Xih0aGlzLnl8fDApfSxuLnByb3RvdHlwZS50b0FycmF5PWZ1bmN0aW9uKHQsaSl7cmV0dXJuIHZvaWQgMD09PWkmJihpPTApLHRbaV09dGhpcy54LHRbaSsxXT10aGlzLnksdGhpc30sbi5wcm90b3R5cGUuYXNBcnJheT1mdW5jdGlvbigpe3ZhciB0PVtdO3JldHVybiB0aGlzLnRvQXJyYXkodCwwKSx0fSxuLnByb3RvdHlwZS5jb3B5RnJvbT1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy54PXQueCx0aGlzLnk9dC55LHRoaXN9LG4ucHJvdG90eXBlLmNvcHlGcm9tRmxvYXRzPWZ1bmN0aW9uKHQsaSl7cmV0dXJuIHRoaXMueD10LHRoaXMueT1pLHRoaXN9LG4ucHJvdG90eXBlLmFkZD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG4odGhpcy54K3QueCx0aGlzLnkrdC55KX0sbi5wcm90b3R5cGUuYWRkVG9SZWY9ZnVuY3Rpb24odCxpKXtyZXR1cm4gaS54PXRoaXMueCt0LngsaS55PXRoaXMueSt0LnksdGhpc30sbi5wcm90b3R5cGUuYWRkVmVjdG9yMz1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG4odGhpcy54K3QueCx0aGlzLnkrdC55KX0sbi5wcm90b3R5cGUuc3VidHJhY3Q9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBuKHRoaXMueC10LngsdGhpcy55LXQueSl9LG4ucHJvdG90eXBlLnN1YnRyYWN0VG9SZWY9ZnVuY3Rpb24odCxpKXtyZXR1cm4gaS54PXRoaXMueC10LngsaS55PXRoaXMueS10LnksdGhpc30sbi5wcm90b3R5cGUuc3VidHJhY3RJblBsYWNlPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLngtPXQueCx0aGlzLnktPXQueSx0aGlzfSxuLnByb3RvdHlwZS5tdWx0aXBseUluUGxhY2U9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMueCo9dC54LHRoaXMueSo9dC55LHRoaXN9LG4ucHJvdG90eXBlLm11bHRpcGx5PWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgbih0aGlzLngqdC54LHRoaXMueSp0LnkpfSxuLnByb3RvdHlwZS5tdWx0aXBseVRvUmVmPWZ1bmN0aW9uKHQsaSl7cmV0dXJuIGkueD10aGlzLngqdC54LGkueT10aGlzLnkqdC55LHRoaXN9LG4ucHJvdG90eXBlLm11bHRpcGx5QnlGbG9hdHM9ZnVuY3Rpb24odCxpKXtyZXR1cm4gbmV3IG4odGhpcy54KnQsdGhpcy55KmkpfSxuLnByb3RvdHlwZS5kaXZpZGU9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBuKHRoaXMueC90LngsdGhpcy55L3QueSl9LG4ucHJvdG90eXBlLmRpdmlkZVRvUmVmPWZ1bmN0aW9uKHQsaSl7cmV0dXJuIGkueD10aGlzLngvdC54LGkueT10aGlzLnkvdC55LHRoaXN9LG4ucHJvdG90eXBlLm5lZ2F0ZT1mdW5jdGlvbigpe3JldHVybiBuZXcgbigtdGhpcy54LC10aGlzLnkpfSxuLnByb3RvdHlwZS5zY2FsZUluUGxhY2U9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMueCo9dCx0aGlzLnkqPXQsdGhpc30sbi5wcm90b3R5cGUuc2NhbGU9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBuKHRoaXMueCp0LHRoaXMueSp0KX0sbi5wcm90b3R5cGUuZXF1YWxzPWZ1bmN0aW9uKHQpe3JldHVybiB0JiZ0aGlzLng9PT10LngmJnRoaXMueT09PXQueX0sbi5wcm90b3R5cGUuZXF1YWxzV2l0aEVwc2lsb249ZnVuY3Rpb24obixyKXtyZXR1cm4gdm9pZCAwPT09ciYmKHI9dC5FcHNpbG9uKSxuJiZpLldpdGhpbkVwc2lsb24odGhpcy54LG4ueCxyKSYmaS5XaXRoaW5FcHNpbG9uKHRoaXMueSxuLnkscil9LG4ucHJvdG90eXBlLmxlbmd0aD1mdW5jdGlvbigpe3JldHVybiBNYXRoLnNxcnQodGhpcy54KnRoaXMueCt0aGlzLnkqdGhpcy55KX0sbi5wcm90b3R5cGUubGVuZ3RoU3F1YXJlZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLngqdGhpcy54K3RoaXMueSp0aGlzLnl9LG4ucHJvdG90eXBlLm5vcm1hbGl6ZT1mdW5jdGlvbigpe3ZhciB0PXRoaXMubGVuZ3RoKCk7aWYoMD09PXQpcmV0dXJuIHRoaXM7dmFyIGk9MS90O3JldHVybiB0aGlzLngqPWksdGhpcy55Kj1pLHRoaXN9LG4ucHJvdG90eXBlLmNsb25lPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBuKHRoaXMueCx0aGlzLnkpfSxuLlplcm89ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IG4oMCwwKX0sbi5Gcm9tQXJyYXk9ZnVuY3Rpb24odCxpKXtyZXR1cm4gdm9pZCAwPT09aSYmKGk9MCksbmV3IG4odFtpXSx0W2krMV0pfSxuLkZyb21BcnJheVRvUmVmPWZ1bmN0aW9uKHQsaSxuKXtuLng9dFtpXSxuLnk9dFtpKzFdfSxuLkNhdG11bGxSb209ZnVuY3Rpb24odCxpLHIsbyxzKXt2YXIgZT1zKnMsaD1zKmUsYT0uNSooMippLngrKC10Lngrci54KSpzKygyKnQueC01KmkueCs0KnIueC1vLngpKmUrKC10LngrMyppLngtMypyLngrby54KSpoKSx1PS41KigyKmkueSsoLXQueStyLnkpKnMrKDIqdC55LTUqaS55KzQqci55LW8ueSkqZSsoLXQueSszKmkueS0zKnIueStvLnkpKmgpO3JldHVybiBuZXcgbihhLHUpfSxuLkNsYW1wPWZ1bmN0aW9uKHQsaSxyKXt2YXIgbz10Lng7bz1vPnIueD9yLng6byxvPW88aS54P2kueDpvO3ZhciBzPXQueTtyZXR1cm4gcz1zPnIueT9yLnk6cyxzPXM8aS55P2kueTpzLG5ldyBuKG8scyl9LG4uSGVybWl0ZT1mdW5jdGlvbih0LGkscixvLHMpe3ZhciBlPXMqcyxoPXMqZSxhPTIqaC0zKmUrMSx1PS0yKmgrMyplLG09aC0yKmUrcyx5PWgtZSxjPXQueCphK3IueCp1K2kueCptK28ueCp5LHA9dC55KmErci55KnUraS55Km0rby55Knk7cmV0dXJuIG5ldyBuKGMscCl9LG4uTGVycD1mdW5jdGlvbih0LGkscil7dmFyIG89dC54KyhpLngtdC54KSpyLHM9dC55KyhpLnktdC55KSpyO3JldHVybiBuZXcgbihvLHMpfSxuLkRvdD1mdW5jdGlvbih0LGkpe3JldHVybiB0LngqaS54K3QueSppLnl9LG4uTm9ybWFsaXplPWZ1bmN0aW9uKHQpe3ZhciBpPXQuY2xvbmUoKTtyZXR1cm4gaS5ub3JtYWxpemUoKSxpfSxuLk1pbmltaXplPWZ1bmN0aW9uKHQsaSl7dmFyIHI9dC54PGkueD90Lng6aS54LG89dC55PGkueT90Lnk6aS55O3JldHVybiBuZXcgbihyLG8pfSxuLk1heGltaXplPWZ1bmN0aW9uKHQsaSl7dmFyIHI9dC54PmkueD90Lng6aS54LG89dC55PmkueT90Lnk6aS55O3JldHVybiBuZXcgbihyLG8pfSxuLlRyYW5zZm9ybT1mdW5jdGlvbih0LGkpe3ZhciByPW4uWmVybygpO3JldHVybiBuLlRyYW5zZm9ybVRvUmVmKHQsaSxyKSxyfSxuLlRyYW5zZm9ybVRvUmVmPWZ1bmN0aW9uKHQsaSxuKXt2YXIgcj10LngqaS5tWzBdK3QueSppLm1bNF0raS5tWzEyXSxvPXQueCppLm1bMV0rdC55KmkubVs1XStpLm1bMTNdO24ueD1yLG4ueT1vfSxuLlBvaW50SW5UcmlhbmdsZT1mdW5jdGlvbih0LGksbixyKXt2YXIgbz0uNSooLW4ueSpyLngraS55Kigtbi54K3IueCkraS54KihuLnktci55KStuLngqci55KSxzPTA+bz8tMToxLGU9KGkueSpyLngtaS54KnIueSsoci55LWkueSkqdC54KyhpLngtci54KSp0LnkpKnMsaD0oaS54Km4ueS1pLnkqbi54KyhpLnktbi55KSp0LngrKG4ueC1pLngpKnQueSkqcztyZXR1cm4gZT4wJiZoPjAmJjIqbypzPmUraH0sbi5EaXN0YW5jZT1mdW5jdGlvbih0LGkpe3JldHVybiBNYXRoLnNxcnQobi5EaXN0YW5jZVNxdWFyZWQodCxpKSl9LG4uRGlzdGFuY2VTcXVhcmVkPWZ1bmN0aW9uKHQsaSl7dmFyIG49dC54LWkueCxyPXQueS1pLnk7cmV0dXJuIG4qbityKnJ9LG4uRGlzdGFuY2VPZlBvaW50RnJvbVNlZ21lbnQ9ZnVuY3Rpb24odCxpLHIpe3ZhciBvPW4uRGlzdGFuY2VTcXVhcmVkKGkscik7aWYoMD09PW8pcmV0dXJuIG4uRGlzdGFuY2UodCxpKTt2YXIgcz1yLnN1YnRyYWN0KGkpLGU9TWF0aC5tYXgoMCxNYXRoLm1pbigxLG4uRG90KHQuc3VidHJhY3QoaSkscykvbykpLGg9aS5hZGQocy5tdWx0aXBseUJ5RmxvYXRzKGUsZSkpO3JldHVybiBuLkRpc3RhbmNlKHQsaCl9LG59KCk7dC5WZWN0b3IyPW87dmFyIHM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBuKHQsaSxuKXt0aGlzLng9dCx0aGlzLnk9aSx0aGlzLno9bn1yZXR1cm4gbi5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm5cIntYOiBcIit0aGlzLngrXCIgWTpcIit0aGlzLnkrXCIgWjpcIit0aGlzLnorXCJ9XCJ9LG4ucHJvdG90eXBlLmdldENsYXNzTmFtZT1mdW5jdGlvbigpe3JldHVyblwiVmVjdG9yM1wifSxuLnByb3RvdHlwZS5nZXRIYXNoQ29kZT1mdW5jdGlvbigpe3ZhciB0PXRoaXMueHx8MDtyZXR1cm4gdD0zOTcqdF4odGhpcy55fHwwKSx0PTM5Nyp0Xih0aGlzLnp8fDApfSxuLnByb3RvdHlwZS5hc0FycmF5PWZ1bmN0aW9uKCl7dmFyIHQ9W107cmV0dXJuIHRoaXMudG9BcnJheSh0LDApLHR9LG4ucHJvdG90eXBlLnRvQXJyYXk9ZnVuY3Rpb24odCxpKXtyZXR1cm4gdm9pZCAwPT09aSYmKGk9MCksdFtpXT10aGlzLngsdFtpKzFdPXRoaXMueSx0W2krMl09dGhpcy56LHRoaXN9LG4ucHJvdG90eXBlLnRvUXVhdGVybmlvbj1mdW5jdGlvbigpe3ZhciB0PW5ldyBhKDAsMCwwLDEpLGk9TWF0aC5jb3MoLjUqKHRoaXMueCt0aGlzLnopKSxuPU1hdGguc2luKC41Kih0aGlzLngrdGhpcy56KSkscj1NYXRoLmNvcyguNSoodGhpcy56LXRoaXMueCkpLG89TWF0aC5zaW4oLjUqKHRoaXMuei10aGlzLngpKSxzPU1hdGguY29zKC41KnRoaXMueSksZT1NYXRoLnNpbiguNSp0aGlzLnkpO3JldHVybiB0Lng9ciplLHQueT0tbyplLHQuej1uKnMsdC53PWkqcyx0fSxuLnByb3RvdHlwZS5hZGRJblBsYWNlPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLngrPXQueCx0aGlzLnkrPXQueSx0aGlzLnorPXQueix0aGlzfSxuLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBuKHRoaXMueCt0LngsdGhpcy55K3QueSx0aGlzLnordC56KX0sbi5wcm90b3R5cGUuYWRkVG9SZWY9ZnVuY3Rpb24odCxpKXtyZXR1cm4gaS54PXRoaXMueCt0LngsaS55PXRoaXMueSt0LnksaS56PXRoaXMueit0LnosdGhpc30sbi5wcm90b3R5cGUuc3VidHJhY3RJblBsYWNlPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLngtPXQueCx0aGlzLnktPXQueSx0aGlzLnotPXQueix0aGlzfSxuLnByb3RvdHlwZS5zdWJ0cmFjdD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG4odGhpcy54LXQueCx0aGlzLnktdC55LHRoaXMuei10LnopfSxuLnByb3RvdHlwZS5zdWJ0cmFjdFRvUmVmPWZ1bmN0aW9uKHQsaSl7cmV0dXJuIGkueD10aGlzLngtdC54LGkueT10aGlzLnktdC55LGkuej10aGlzLnotdC56LHRoaXN9LG4ucHJvdG90eXBlLnN1YnRyYWN0RnJvbUZsb2F0cz1mdW5jdGlvbih0LGkscil7cmV0dXJuIG5ldyBuKHRoaXMueC10LHRoaXMueS1pLHRoaXMuei1yKX0sbi5wcm90b3R5cGUuc3VidHJhY3RGcm9tRmxvYXRzVG9SZWY9ZnVuY3Rpb24odCxpLG4scil7cmV0dXJuIHIueD10aGlzLngtdCxyLnk9dGhpcy55LWksci56PXRoaXMuei1uLHRoaXN9LG4ucHJvdG90eXBlLm5lZ2F0ZT1mdW5jdGlvbigpe3JldHVybiBuZXcgbigtdGhpcy54LC10aGlzLnksLXRoaXMueil9LG4ucHJvdG90eXBlLnNjYWxlSW5QbGFjZT1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy54Kj10LHRoaXMueSo9dCx0aGlzLnoqPXQsdGhpc30sbi5wcm90b3R5cGUuc2NhbGU9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBuKHRoaXMueCp0LHRoaXMueSp0LHRoaXMueip0KX0sbi5wcm90b3R5cGUuc2NhbGVUb1JlZj1mdW5jdGlvbih0LGkpe2kueD10aGlzLngqdCxpLnk9dGhpcy55KnQsaS56PXRoaXMueip0fSxuLnByb3RvdHlwZS5lcXVhbHM9ZnVuY3Rpb24odCl7cmV0dXJuIHQmJnRoaXMueD09PXQueCYmdGhpcy55PT09dC55JiZ0aGlzLno9PT10Lnp9LG4ucHJvdG90eXBlLmVxdWFsc1dpdGhFcHNpbG9uPWZ1bmN0aW9uKG4scil7cmV0dXJuIHZvaWQgMD09PXImJihyPXQuRXBzaWxvbiksbiYmaS5XaXRoaW5FcHNpbG9uKHRoaXMueCxuLngscikmJmkuV2l0aGluRXBzaWxvbih0aGlzLnksbi55LHIpJiZpLldpdGhpbkVwc2lsb24odGhpcy56LG4ueixyKX0sbi5wcm90b3R5cGUuZXF1YWxzVG9GbG9hdHM9ZnVuY3Rpb24odCxpLG4pe3JldHVybiB0aGlzLng9PT10JiZ0aGlzLnk9PT1pJiZ0aGlzLno9PT1ufSxuLnByb3RvdHlwZS5tdWx0aXBseUluUGxhY2U9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMueCo9dC54LHRoaXMueSo9dC55LHRoaXMueio9dC56LHRoaXN9LG4ucHJvdG90eXBlLm11bHRpcGx5PWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgbih0aGlzLngqdC54LHRoaXMueSp0LnksdGhpcy56KnQueil9LG4ucHJvdG90eXBlLm11bHRpcGx5VG9SZWY9ZnVuY3Rpb24odCxpKXtyZXR1cm4gaS54PXRoaXMueCp0LngsaS55PXRoaXMueSp0LnksaS56PXRoaXMueip0LnosdGhpc30sbi5wcm90b3R5cGUubXVsdGlwbHlCeUZsb2F0cz1mdW5jdGlvbih0LGkscil7cmV0dXJuIG5ldyBuKHRoaXMueCp0LHRoaXMueSppLHRoaXMueipyKX0sbi5wcm90b3R5cGUuZGl2aWRlPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgbih0aGlzLngvdC54LHRoaXMueS90LnksdGhpcy56L3Queil9LG4ucHJvdG90eXBlLmRpdmlkZVRvUmVmPWZ1bmN0aW9uKHQsaSl7cmV0dXJuIGkueD10aGlzLngvdC54LGkueT10aGlzLnkvdC55LGkuej10aGlzLnovdC56LHRoaXN9LG4ucHJvdG90eXBlLk1pbmltaXplSW5QbGFjZT1mdW5jdGlvbih0KXtyZXR1cm4gdC54PHRoaXMueCYmKHRoaXMueD10LngpLHQueTx0aGlzLnkmJih0aGlzLnk9dC55KSx0Lno8dGhpcy56JiYodGhpcy56PXQueiksdGhpc30sbi5wcm90b3R5cGUuTWF4aW1pemVJblBsYWNlPWZ1bmN0aW9uKHQpe3JldHVybiB0Lng+dGhpcy54JiYodGhpcy54PXQueCksdC55PnRoaXMueSYmKHRoaXMueT10LnkpLHQuej50aGlzLnomJih0aGlzLno9dC56KSx0aGlzfSxuLnByb3RvdHlwZS5sZW5ndGg9ZnVuY3Rpb24oKXtyZXR1cm4gTWF0aC5zcXJ0KHRoaXMueCp0aGlzLngrdGhpcy55KnRoaXMueSt0aGlzLnoqdGhpcy56KX0sbi5wcm90b3R5cGUubGVuZ3RoU3F1YXJlZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLngqdGhpcy54K3RoaXMueSp0aGlzLnkrdGhpcy56KnRoaXMuen0sbi5wcm90b3R5cGUubm9ybWFsaXplPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5sZW5ndGgoKTtpZigwPT09dHx8MT09PXQpcmV0dXJuIHRoaXM7dmFyIGk9MS90O3JldHVybiB0aGlzLngqPWksdGhpcy55Kj1pLHRoaXMueio9aSx0aGlzfSxuLnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbigpe3JldHVybiBuZXcgbih0aGlzLngsdGhpcy55LHRoaXMueil9LG4ucHJvdG90eXBlLmNvcHlGcm9tPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLng9dC54LHRoaXMueT10LnksdGhpcy56PXQueix0aGlzfSxuLnByb3RvdHlwZS5jb3B5RnJvbUZsb2F0cz1mdW5jdGlvbih0LGksbil7cmV0dXJuIHRoaXMueD10LHRoaXMueT1pLHRoaXMuej1uLHRoaXN9LG4uR2V0Q2xpcEZhY3Rvcj1mdW5jdGlvbih0LGkscixvKXt2YXIgcz1uLkRvdCh0LHIpLW8sZT1uLkRvdChpLHIpLW8saD1zLyhzLWUpO3JldHVybiBofSxuLkZyb21BcnJheT1mdW5jdGlvbih0LGkpe3JldHVybiBpfHwoaT0wKSxuZXcgbih0W2ldLHRbaSsxXSx0W2krMl0pfSxuLkZyb21GbG9hdEFycmF5PWZ1bmN0aW9uKHQsaSl7cmV0dXJuIGl8fChpPTApLG5ldyBuKHRbaV0sdFtpKzFdLHRbaSsyXSl9LG4uRnJvbUFycmF5VG9SZWY9ZnVuY3Rpb24odCxpLG4pe24ueD10W2ldLG4ueT10W2krMV0sbi56PXRbaSsyXX0sbi5Gcm9tRmxvYXRBcnJheVRvUmVmPWZ1bmN0aW9uKHQsaSxuKXtuLng9dFtpXSxuLnk9dFtpKzFdLG4uej10W2krMl19LG4uRnJvbUZsb2F0c1RvUmVmPWZ1bmN0aW9uKHQsaSxuLHIpe3IueD10LHIueT1pLHIuej1ufSxuLlplcm89ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IG4oMCwwLDApfSxuLlVwPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBuKDAsMSwwKX0sbi5UcmFuc2Zvcm1Db29yZGluYXRlcz1mdW5jdGlvbih0LGkpe3ZhciByPW4uWmVybygpO3JldHVybiBuLlRyYW5zZm9ybUNvb3JkaW5hdGVzVG9SZWYodCxpLHIpLHJ9LG4uVHJhbnNmb3JtQ29vcmRpbmF0ZXNUb1JlZj1mdW5jdGlvbih0LGksbil7dmFyIHI9dC54KmkubVswXSt0LnkqaS5tWzRdK3QueippLm1bOF0raS5tWzEyXSxvPXQueCppLm1bMV0rdC55KmkubVs1XSt0LnoqaS5tWzldK2kubVsxM10scz10LngqaS5tWzJdK3QueSppLm1bNl0rdC56KmkubVsxMF0raS5tWzE0XSxlPXQueCppLm1bM10rdC55KmkubVs3XSt0LnoqaS5tWzExXStpLm1bMTVdO24ueD1yL2Usbi55PW8vZSxuLno9cy9lfSxuLlRyYW5zZm9ybUNvb3JkaW5hdGVzRnJvbUZsb2F0c1RvUmVmPWZ1bmN0aW9uKHQsaSxuLHIsbyl7dmFyIHM9dCpyLm1bMF0raSpyLm1bNF0rbipyLm1bOF0rci5tWzEyXSxlPXQqci5tWzFdK2kqci5tWzVdK24qci5tWzldK3IubVsxM10saD10KnIubVsyXStpKnIubVs2XStuKnIubVsxMF0rci5tWzE0XSxhPXQqci5tWzNdK2kqci5tWzddK24qci5tWzExXStyLm1bMTVdO28ueD1zL2Esby55PWUvYSxvLno9aC9hfSxuLlRyYW5zZm9ybU5vcm1hbD1mdW5jdGlvbih0LGkpe3ZhciByPW4uWmVybygpO3JldHVybiBuLlRyYW5zZm9ybU5vcm1hbFRvUmVmKHQsaSxyKSxyfSxuLlRyYW5zZm9ybU5vcm1hbFRvUmVmPWZ1bmN0aW9uKHQsaSxuKXtuLng9dC54KmkubVswXSt0LnkqaS5tWzRdK3QueippLm1bOF0sbi55PXQueCppLm1bMV0rdC55KmkubVs1XSt0LnoqaS5tWzldLG4uej10LngqaS5tWzJdK3QueSppLm1bNl0rdC56KmkubVsxMF19LG4uVHJhbnNmb3JtTm9ybWFsRnJvbUZsb2F0c1RvUmVmPWZ1bmN0aW9uKHQsaSxuLHIsbyl7by54PXQqci5tWzBdK2kqci5tWzRdK24qci5tWzhdLG8ueT10KnIubVsxXStpKnIubVs1XStuKnIubVs5XSxvLno9dCpyLm1bMl0raSpyLm1bNl0rbipyLm1bMTBdfSxuLkNhdG11bGxSb209ZnVuY3Rpb24odCxpLHIsbyxzKXt2YXIgZT1zKnMsaD1zKmUsYT0uNSooMippLngrKC10Lngrci54KSpzKygyKnQueC01KmkueCs0KnIueC1vLngpKmUrKC10LngrMyppLngtMypyLngrby54KSpoKSx1PS41KigyKmkueSsoLXQueStyLnkpKnMrKDIqdC55LTUqaS55KzQqci55LW8ueSkqZSsoLXQueSszKmkueS0zKnIueStvLnkpKmgpLG09LjUqKDIqaS56KygtdC56K3IueikqcysoMip0LnotNSppLnorNCpyLnotby56KSplKygtdC56KzMqaS56LTMqci56K28ueikqaCk7cmV0dXJuIG5ldyBuKGEsdSxtKX0sbi5DbGFtcD1mdW5jdGlvbih0LGkscil7dmFyIG89dC54O289bz5yLng/ci54Om8sbz1vPGkueD9pLng6bzt2YXIgcz10Lnk7cz1zPnIueT9yLnk6cyxzPXM8aS55P2kueTpzO3ZhciBlPXQuejtyZXR1cm4gZT1lPnIuej9yLno6ZSxlPWU8aS56P2kuejplLG5ldyBuKG8scyxlKX0sbi5IZXJtaXRlPWZ1bmN0aW9uKHQsaSxyLG8scyl7dmFyIGU9cypzLGg9cyplLGE9MipoLTMqZSsxLHU9LTIqaCszKmUsbT1oLTIqZStzLHk9aC1lLGM9dC54KmErci54KnUraS54Km0rby54KnkscD10LnkqYStyLnkqdStpLnkqbStvLnkqeSxmPXQueiphK3Iueip1K2kueiptK28ueip5O3JldHVybiBuZXcgbihjLHAsZil9LG4uTGVycD1mdW5jdGlvbih0LGkscil7dmFyIG89dC54KyhpLngtdC54KSpyLHM9dC55KyhpLnktdC55KSpyLGU9dC56KyhpLnotdC56KSpyO3JldHVybiBuZXcgbihvLHMsZSl9LG4uRG90PWZ1bmN0aW9uKHQsaSl7cmV0dXJuIHQueCppLngrdC55KmkueSt0LnoqaS56fSxuLkNyb3NzPWZ1bmN0aW9uKHQsaSl7dmFyIHI9bi5aZXJvKCk7cmV0dXJuIG4uQ3Jvc3NUb1JlZih0LGkscikscn0sbi5Dcm9zc1RvUmVmPWZ1bmN0aW9uKHQsaSxuKXtNLlZlY3RvcjNbMF0ueD10LnkqaS56LXQueippLnksTS5WZWN0b3IzWzBdLnk9dC56KmkueC10LngqaS56LE0uVmVjdG9yM1swXS56PXQueCppLnktdC55KmkueCxuLmNvcHlGcm9tKE0uVmVjdG9yM1swXSl9LG4uTm9ybWFsaXplPWZ1bmN0aW9uKHQpe3ZhciBpPW4uWmVybygpO3JldHVybiBuLk5vcm1hbGl6ZVRvUmVmKHQsaSksaX0sbi5Ob3JtYWxpemVUb1JlZj1mdW5jdGlvbih0LGkpe2kuY29weUZyb20odCksaS5ub3JtYWxpemUoKX0sbi5Qcm9qZWN0PWZ1bmN0aW9uKHQsaSxyLG8pe3ZhciBzPW8ud2lkdGgsZT1vLmhlaWdodCxoPW8ueCxhPW8ueSxtPXUuRnJvbVZhbHVlcyhzLzIsMCwwLDAsMCwtZS8yLDAsMCwwLDAsMSwwLGgrcy8yLGUvMithLDAsMSkseT1pLm11bHRpcGx5KHIpLm11bHRpcGx5KG0pO3JldHVybiBuLlRyYW5zZm9ybUNvb3JkaW5hdGVzKHQseSl9LG4uVW5wcm9qZWN0RnJvbVRyYW5zZm9ybT1mdW5jdGlvbih0LHIsbyxzLGUpe3ZhciBoPXMubXVsdGlwbHkoZSk7aC5pbnZlcnQoKSx0Lng9dC54L3IqMi0xLHQueT0tKHQueS9vKjItMSk7dmFyIGE9bi5UcmFuc2Zvcm1Db29yZGluYXRlcyh0LGgpLHU9dC54KmgubVszXSt0LnkqaC5tWzddK3QueipoLm1bMTFdK2gubVsxNV07cmV0dXJuIGkuV2l0aGluRXBzaWxvbih1LDEpJiYoYT1hLnNjYWxlKDEvdSkpLGF9LG4uVW5wcm9qZWN0PWZ1bmN0aW9uKHQscixvLHMsZSxoKXt2YXIgYT1zLm11bHRpcGx5KGUpLm11bHRpcGx5KGgpO2EuaW52ZXJ0KCk7dmFyIHU9bmV3IG4odC54L3IqMi0xLC0odC55L28qMi0xKSx0LnopLG09bi5UcmFuc2Zvcm1Db29yZGluYXRlcyh1LGEpLHk9dS54KmEubVszXSt1LnkqYS5tWzddK3UueiphLm1bMTFdK2EubVsxNV07cmV0dXJuIGkuV2l0aGluRXBzaWxvbih5LDEpJiYobT1tLnNjYWxlKDEveSkpLG19LG4uTWluaW1pemU9ZnVuY3Rpb24odCxpKXt2YXIgbj10LmNsb25lKCk7cmV0dXJuIG4uTWluaW1pemVJblBsYWNlKGkpLG59LG4uTWF4aW1pemU9ZnVuY3Rpb24odCxpKXt2YXIgbj10LmNsb25lKCk7cmV0dXJuIG4uTWF4aW1pemVJblBsYWNlKGkpLG59LG4uRGlzdGFuY2U9ZnVuY3Rpb24odCxpKXtyZXR1cm4gTWF0aC5zcXJ0KG4uRGlzdGFuY2VTcXVhcmVkKHQsaSkpfSxuLkRpc3RhbmNlU3F1YXJlZD1mdW5jdGlvbih0LGkpe3ZhciBuPXQueC1pLngscj10LnktaS55LG89dC56LWkuejtyZXR1cm4gbipuK3IqcitvKm99LG4uQ2VudGVyPWZ1bmN0aW9uKHQsaSl7dmFyIG49dC5hZGQoaSk7cmV0dXJuIG4uc2NhbGVJblBsYWNlKC41KSxufSxuLlJvdGF0aW9uRnJvbUF4aXM9ZnVuY3Rpb24odCxpLHIpe3ZhciBvPW4uWmVybygpO3JldHVybiBuLlJvdGF0aW9uRnJvbUF4aXNUb1JlZih0LGkscixvKSxvfSxuLlJvdGF0aW9uRnJvbUF4aXNUb1JlZj1mdW5jdGlvbihyLG8scyxlKXt2YXIgaD1yLm5vcm1hbGl6ZSgpLGE9cy5ub3JtYWxpemUoKSx1PXAuWCxtPXAuWSx5PTAsYz0wLGY9MCxsPTAseD0wLHo9MCx3PTAsdj0tMSxkPTAsZz1NLlZlY3RvcjNbMF0sVD0wLFI9TS5WZWN0b3IzWzFdO2kuV2l0aGluRXBzaWxvbihhLnosMCx0LkVwc2lsb24pP3o9MTppLldpdGhpbkVwc2lsb24oYS54LDAsdC5FcHNpbG9uKT9sPTE6KHc9YS56L2EueCxsPS13Kk1hdGguc3FydCgxLygxK3cqdykpLHo9TWF0aC5zcXJ0KDEvKDErdyp3KSkpLFIueD1sLFIueT14LFIuej16LFIubm9ybWFsaXplKCksbi5Dcm9zc1RvUmVmKGgsUixnKSxnLm5vcm1hbGl6ZSgpLG4uRG90KGEsZyk8MCYmKHY9MSksVD1uLkRvdChoLFIpLFQ9TWF0aC5taW4oMSxNYXRoLm1heCgtMSxUKSksZj1NYXRoLmFjb3MoVCkqdixuLkRvdChSLHUpPDAmJihmPU1hdGguUEkrZixSPVIuc2NhbGVJblBsYWNlKC0xKSxkKyspO3ZhciBfPU0uVmVjdG9yM1syXSxiPU0uVmVjdG9yM1szXTtsPTAseD0wLHo9MCx2PS0xLGkuV2l0aGluRXBzaWxvbihhLnosMCx0LkVwc2lsb24pP2w9MToodz1SLnovUi54LGw9LXcqTWF0aC5zcXJ0KDEvKDErdyp3KSksej1NYXRoLnNxcnQoMS8oMSt3KncpKSksXy54PWwsXy55PXgsXy56PXosXy5ub3JtYWxpemUoKSxuLkNyb3NzVG9SZWYoXyxSLGIpLGIubm9ybWFsaXplKCksbi5Dcm9zc1RvUmVmKGEsXyxnKSxnLm5vcm1hbGl6ZSgpLG4uRG90KFIsZyk8MCYmKHY9MSksVD1uLkRvdChhLF8pLFQ9TWF0aC5taW4oMSxNYXRoLm1heCgtMSxUKSksYz1NYXRoLmFjb3MoVCkqdixuLkRvdChiLG0pPDAmJihjPU1hdGguUEkrYyxkKyspLHY9LTEsbi5Dcm9zc1RvUmVmKHUsUixnKSxnLm5vcm1hbGl6ZSgpLG4uRG90KGcsbSk8MCYmKHY9MSksVD1uLkRvdChSLHUpLFQ9TWF0aC5taW4oMSxNYXRoLm1heCgtMSxUKSkseT0tTWF0aC5hY29zKFQpKnYsMD5UJiYyPmQmJih5PU1hdGguUEkreSksZS54PWMsZS55PXksZS56PWZ9LG59KCk7dC5WZWN0b3IzPXM7dmFyIGU9ZnVuY3Rpb24oKXtmdW5jdGlvbiBuKHQsaSxuLHIpe3RoaXMueD10LHRoaXMueT1pLHRoaXMuej1uLHRoaXMudz1yfXJldHVybiBuLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVyblwie1g6IFwiK3RoaXMueCtcIiBZOlwiK3RoaXMueStcIiBaOlwiK3RoaXMueitcIlc6XCIrdGhpcy53K1wifVwifSxuLnByb3RvdHlwZS5nZXRDbGFzc05hbWU9ZnVuY3Rpb24oKXtyZXR1cm5cIlZlY3RvcjRcIn0sbi5wcm90b3R5cGUuZ2V0SGFzaENvZGU9ZnVuY3Rpb24oKXt2YXIgdD10aGlzLnh8fDA7cmV0dXJuIHQ9Mzk3KnReKHRoaXMueXx8MCksdD0zOTcqdF4odGhpcy56fHwwKSx0PTM5Nyp0Xih0aGlzLnd8fDApfSxuLnByb3RvdHlwZS5hc0FycmF5PWZ1bmN0aW9uKCl7dmFyIHQ9W107cmV0dXJuIHRoaXMudG9BcnJheSh0LDApLHR9LG4ucHJvdG90eXBlLnRvQXJyYXk9ZnVuY3Rpb24odCxpKXtyZXR1cm4gdm9pZCAwPT09aSYmKGk9MCksdFtpXT10aGlzLngsdFtpKzFdPXRoaXMueSx0W2krMl09dGhpcy56LHRbaSszXT10aGlzLncsdGhpc30sbi5wcm90b3R5cGUuYWRkSW5QbGFjZT1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy54Kz10LngsdGhpcy55Kz10LnksdGhpcy56Kz10LnosdGhpcy53Kz10LncsdGhpc30sbi5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgbih0aGlzLngrdC54LHRoaXMueSt0LnksdGhpcy56K3Queix0aGlzLncrdC53KX0sbi5wcm90b3R5cGUuYWRkVG9SZWY9ZnVuY3Rpb24odCxpKXtyZXR1cm4gaS54PXRoaXMueCt0LngsaS55PXRoaXMueSt0LnksaS56PXRoaXMueit0LnosaS53PXRoaXMudyt0LncsdGhpc30sbi5wcm90b3R5cGUuc3VidHJhY3RJblBsYWNlPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLngtPXQueCx0aGlzLnktPXQueSx0aGlzLnotPXQueix0aGlzLnctPXQudyx0aGlzfSxuLnByb3RvdHlwZS5zdWJ0cmFjdD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG4odGhpcy54LXQueCx0aGlzLnktdC55LHRoaXMuei10LnosdGhpcy53LXQudyl9LG4ucHJvdG90eXBlLnN1YnRyYWN0VG9SZWY9ZnVuY3Rpb24odCxpKXtyZXR1cm4gaS54PXRoaXMueC10LngsaS55PXRoaXMueS10LnksaS56PXRoaXMuei10LnosaS53PXRoaXMudy10LncsdGhpc30sbi5wcm90b3R5cGUuc3VidHJhY3RGcm9tRmxvYXRzPWZ1bmN0aW9uKHQsaSxyLG8pe3JldHVybiBuZXcgbih0aGlzLngtdCx0aGlzLnktaSx0aGlzLnotcix0aGlzLnctbyl9LG4ucHJvdG90eXBlLnN1YnRyYWN0RnJvbUZsb2F0c1RvUmVmPWZ1bmN0aW9uKHQsaSxuLHIsbyl7cmV0dXJuIG8ueD10aGlzLngtdCxvLnk9dGhpcy55LWksby56PXRoaXMuei1uLG8udz10aGlzLnctcix0aGlzfSxuLnByb3RvdHlwZS5uZWdhdGU9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IG4oLXRoaXMueCwtdGhpcy55LC10aGlzLnosLXRoaXMudyl9LG4ucHJvdG90eXBlLnNjYWxlSW5QbGFjZT1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy54Kj10LHRoaXMueSo9dCx0aGlzLnoqPXQsdGhpcy53Kj10LHRoaXN9LG4ucHJvdG90eXBlLnNjYWxlPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgbih0aGlzLngqdCx0aGlzLnkqdCx0aGlzLnoqdCx0aGlzLncqdCl9LG4ucHJvdG90eXBlLnNjYWxlVG9SZWY9ZnVuY3Rpb24odCxpKXtpLng9dGhpcy54KnQsaS55PXRoaXMueSp0LGkuej10aGlzLnoqdCxpLnc9dGhpcy53KnR9LG4ucHJvdG90eXBlLmVxdWFscz1mdW5jdGlvbih0KXtyZXR1cm4gdCYmdGhpcy54PT09dC54JiZ0aGlzLnk9PT10LnkmJnRoaXMuej09PXQueiYmdGhpcy53PT09dC53fSxuLnByb3RvdHlwZS5lcXVhbHNXaXRoRXBzaWxvbj1mdW5jdGlvbihuLHIpe3JldHVybiB2b2lkIDA9PT1yJiYocj10LkVwc2lsb24pLG4mJmkuV2l0aGluRXBzaWxvbih0aGlzLngsbi54LHIpJiZpLldpdGhpbkVwc2lsb24odGhpcy55LG4ueSxyKSYmaS5XaXRoaW5FcHNpbG9uKHRoaXMueixuLnoscikmJmkuV2l0aGluRXBzaWxvbih0aGlzLncsbi53LHIpfSxuLnByb3RvdHlwZS5lcXVhbHNUb0Zsb2F0cz1mdW5jdGlvbih0LGksbixyKXtyZXR1cm4gdGhpcy54PT09dCYmdGhpcy55PT09aSYmdGhpcy56PT09biYmdGhpcy53PT09cn0sbi5wcm90b3R5cGUubXVsdGlwbHlJblBsYWNlPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLngqPXQueCx0aGlzLnkqPXQueSx0aGlzLnoqPXQueix0aGlzLncqPXQudyx0aGlzfSxuLnByb3RvdHlwZS5tdWx0aXBseT1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG4odGhpcy54KnQueCx0aGlzLnkqdC55LHRoaXMueip0LnosdGhpcy53KnQudyl9LG4ucHJvdG90eXBlLm11bHRpcGx5VG9SZWY9ZnVuY3Rpb24odCxpKXtyZXR1cm4gaS54PXRoaXMueCp0LngsaS55PXRoaXMueSp0LnksaS56PXRoaXMueip0LnosaS53PXRoaXMudyp0LncsdGhpc30sbi5wcm90b3R5cGUubXVsdGlwbHlCeUZsb2F0cz1mdW5jdGlvbih0LGkscixvKXtyZXR1cm4gbmV3IG4odGhpcy54KnQsdGhpcy55KmksdGhpcy56KnIsdGhpcy53Km8pfSxuLnByb3RvdHlwZS5kaXZpZGU9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBuKHRoaXMueC90LngsdGhpcy55L3QueSx0aGlzLnovdC56LHRoaXMudy90LncpfSxuLnByb3RvdHlwZS5kaXZpZGVUb1JlZj1mdW5jdGlvbih0LGkpe3JldHVybiBpLng9dGhpcy54L3QueCxpLnk9dGhpcy55L3QueSxpLno9dGhpcy56L3QueixpLnc9dGhpcy53L3Qudyx0aGlzfSxuLnByb3RvdHlwZS5NaW5pbWl6ZUluUGxhY2U9ZnVuY3Rpb24odCl7cmV0dXJuIHQueDx0aGlzLngmJih0aGlzLng9dC54KSx0Lnk8dGhpcy55JiYodGhpcy55PXQueSksdC56PHRoaXMueiYmKHRoaXMuej10LnopLHQudzx0aGlzLncmJih0aGlzLnc9dC53KSx0aGlzfSxuLnByb3RvdHlwZS5NYXhpbWl6ZUluUGxhY2U9ZnVuY3Rpb24odCl7cmV0dXJuIHQueD50aGlzLngmJih0aGlzLng9dC54KSx0Lnk+dGhpcy55JiYodGhpcy55PXQueSksdC56PnRoaXMueiYmKHRoaXMuej10LnopLHQudz50aGlzLncmJih0aGlzLnc9dC53KSx0aGlzfSxuLnByb3RvdHlwZS5sZW5ndGg9ZnVuY3Rpb24oKXtyZXR1cm4gTWF0aC5zcXJ0KHRoaXMueCp0aGlzLngrdGhpcy55KnRoaXMueSt0aGlzLnoqdGhpcy56K3RoaXMudyp0aGlzLncpfSxuLnByb3RvdHlwZS5sZW5ndGhTcXVhcmVkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMueCp0aGlzLngrdGhpcy55KnRoaXMueSt0aGlzLnoqdGhpcy56K3RoaXMudyp0aGlzLnd9LG4ucHJvdG90eXBlLm5vcm1hbGl6ZT1mdW5jdGlvbigpe3ZhciB0PXRoaXMubGVuZ3RoKCk7aWYoMD09PXQpcmV0dXJuIHRoaXM7dmFyIGk9MS90O3JldHVybiB0aGlzLngqPWksdGhpcy55Kj1pLHRoaXMueio9aSx0aGlzLncqPWksdGhpc30sbi5wcm90b3R5cGUudG9WZWN0b3IzPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBzKHRoaXMueCx0aGlzLnksdGhpcy56KX0sbi5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IG4odGhpcy54LHRoaXMueSx0aGlzLnosdGhpcy53KX0sbi5wcm90b3R5cGUuY29weUZyb209ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMueD10LngsdGhpcy55PXQueSx0aGlzLno9dC56LHRoaXMudz10LncsdGhpc30sbi5wcm90b3R5cGUuY29weUZyb21GbG9hdHM9ZnVuY3Rpb24odCxpLG4scil7cmV0dXJuIHRoaXMueD10LHRoaXMueT1pLHRoaXMuej1uLHRoaXMudz1yLHRoaXN9LG4uRnJvbUFycmF5PWZ1bmN0aW9uKHQsaSl7cmV0dXJuIGl8fChpPTApLG5ldyBuKHRbaV0sdFtpKzFdLHRbaSsyXSx0W2krM10pfSxuLkZyb21BcnJheVRvUmVmPWZ1bmN0aW9uKHQsaSxuKXtuLng9dFtpXSxuLnk9dFtpKzFdLG4uej10W2krMl0sbi53PXRbaSszXX0sbi5Gcm9tRmxvYXRBcnJheVRvUmVmPWZ1bmN0aW9uKHQsaSxuKXtuLng9dFtpXSxuLnk9dFtpKzFdLG4uej10W2krMl0sbi53PXRbaSszXX0sbi5Gcm9tRmxvYXRzVG9SZWY9ZnVuY3Rpb24odCxpLG4scixvKXtvLng9dCxvLnk9aSxvLno9bixvLnc9cn0sbi5aZXJvPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBuKDAsMCwwLDApfSxuLk5vcm1hbGl6ZT1mdW5jdGlvbih0KXt2YXIgaT1uLlplcm8oKTtyZXR1cm4gbi5Ob3JtYWxpemVUb1JlZih0LGkpLGl9LG4uTm9ybWFsaXplVG9SZWY9ZnVuY3Rpb24odCxpKXtpLmNvcHlGcm9tKHQpLGkubm9ybWFsaXplKCl9LG4uTWluaW1pemU9ZnVuY3Rpb24odCxpKXt2YXIgbj10LmNsb25lKCk7cmV0dXJuIG4uTWluaW1pemVJblBsYWNlKGkpLG59LG4uTWF4aW1pemU9ZnVuY3Rpb24odCxpKXt2YXIgbj10LmNsb25lKCk7cmV0dXJuIG4uTWF4aW1pemVJblBsYWNlKGkpLG59LG4uRGlzdGFuY2U9ZnVuY3Rpb24odCxpKXtyZXR1cm4gTWF0aC5zcXJ0KG4uRGlzdGFuY2VTcXVhcmVkKHQsaSkpfSxuLkRpc3RhbmNlU3F1YXJlZD1mdW5jdGlvbih0LGkpe3ZhciBuPXQueC1pLngscj10LnktaS55LG89dC56LWkueixzPXQudy1pLnc7cmV0dXJuIG4qbityKnIrbypvK3Mqc30sbi5DZW50ZXI9ZnVuY3Rpb24odCxpKXt2YXIgbj10LmFkZChpKTtyZXR1cm4gbi5zY2FsZUluUGxhY2UoLjUpLG59LG59KCk7dC5WZWN0b3I0PWU7dmFyIGg9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQsaSl7dGhpcy53aWR0aD10LHRoaXMuaGVpZ2h0PWl9cmV0dXJuIHQucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuXCJ7VzogXCIrdGhpcy53aWR0aCtcIiwgSDogXCIrdGhpcy5oZWlnaHQrXCJ9XCJ9LHQucHJvdG90eXBlLmdldENsYXNzTmFtZT1mdW5jdGlvbigpe3JldHVyblwiU2l6ZVwifSx0LnByb3RvdHlwZS5nZXRIYXNoQ29kZT1mdW5jdGlvbigpe3ZhciB0PXRoaXMud2lkdGh8fDA7cmV0dXJuIHQ9Mzk3KnReKHRoaXMuaGVpZ2h0fHwwKX0sdC5wcm90b3R5cGUuY29weUZyb209ZnVuY3Rpb24odCl7dGhpcy53aWR0aD10LndpZHRoLHRoaXMuaGVpZ2h0PXQuaGVpZ2h0fSx0LnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbigpe3JldHVybiBuZXcgdCh0aGlzLndpZHRoLHRoaXMuaGVpZ2h0KX0sdC5wcm90b3R5cGUuZXF1YWxzPWZ1bmN0aW9uKHQpe3JldHVybiB0P3RoaXMud2lkdGg9PT10LndpZHRoJiZ0aGlzLmhlaWdodD09PXQuaGVpZ2h0OiExfSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJzdXJmYWNlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLndpZHRoKnRoaXMuaGVpZ2h0fSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLHQuWmVybz1mdW5jdGlvbigpe3JldHVybiBuZXcgdCgwLDApfSx0LnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oaSl7dmFyIG49bmV3IHQodGhpcy53aWR0aCtpLndpZHRoLHRoaXMuaGVpZ2h0K2kuaGVpZ2h0KTtyZXR1cm4gbn0sdC5wcm90b3R5cGUuc3Vic3RyYWN0PWZ1bmN0aW9uKGkpe3ZhciBuPW5ldyB0KHRoaXMud2lkdGgtaS53aWR0aCx0aGlzLmhlaWdodC1pLmhlaWdodCk7cmV0dXJuIG59LHQuTGVycD1mdW5jdGlvbihpLG4scil7dmFyIG89aS53aWR0aCsobi53aWR0aC1pLndpZHRoKSpyLHM9aS5oZWlnaHQrKG4uaGVpZ2h0LWkuaGVpZ2h0KSpyO3JldHVybiBuZXcgdChvLHMpfSx0fSgpO3QuU2l6ZT1oO3ZhciBhPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGksbixyKXt2b2lkIDA9PT10JiYodD0wKSx2b2lkIDA9PT1pJiYoaT0wKSx2b2lkIDA9PT1uJiYobj0wKSx2b2lkIDA9PT1yJiYocj0xKSx0aGlzLng9dCx0aGlzLnk9aSx0aGlzLno9bix0aGlzLnc9cn1yZXR1cm4gdC5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm5cIntYOiBcIit0aGlzLngrXCIgWTpcIit0aGlzLnkrXCIgWjpcIit0aGlzLnorXCIgVzpcIit0aGlzLncrXCJ9XCJ9LHQucHJvdG90eXBlLmdldENsYXNzTmFtZT1mdW5jdGlvbigpe3JldHVyblwiUXVhdGVybmlvblwifSx0LnByb3RvdHlwZS5nZXRIYXNoQ29kZT1mdW5jdGlvbigpe3ZhciB0PXRoaXMueHx8MDtyZXR1cm4gdD0zOTcqdF4odGhpcy55fHwwKSx0PTM5Nyp0Xih0aGlzLnp8fDApLHQ9Mzk3KnReKHRoaXMud3x8MCl9LHQucHJvdG90eXBlLmFzQXJyYXk9ZnVuY3Rpb24oKXtyZXR1cm5bdGhpcy54LHRoaXMueSx0aGlzLnosdGhpcy53XX0sdC5wcm90b3R5cGUuZXF1YWxzPWZ1bmN0aW9uKHQpe3JldHVybiB0JiZ0aGlzLng9PT10LngmJnRoaXMueT09PXQueSYmdGhpcy56PT09dC56JiZ0aGlzLnc9PT10Lnd9LHQucHJvdG90eXBlLmNsb25lPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyB0KHRoaXMueCx0aGlzLnksdGhpcy56LHRoaXMudyl9LHQucHJvdG90eXBlLmNvcHlGcm9tPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLng9dC54LHRoaXMueT10LnksdGhpcy56PXQueix0aGlzLnc9dC53LHRoaXN9LHQucHJvdG90eXBlLmNvcHlGcm9tRmxvYXRzPWZ1bmN0aW9uKHQsaSxuLHIpe3JldHVybiB0aGlzLng9dCx0aGlzLnk9aSx0aGlzLno9bix0aGlzLnc9cix0aGlzfSx0LnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oaSl7cmV0dXJuIG5ldyB0KHRoaXMueCtpLngsdGhpcy55K2kueSx0aGlzLnoraS56LHRoaXMudytpLncpfSx0LnByb3RvdHlwZS5zdWJ0cmFjdD1mdW5jdGlvbihpKXtyZXR1cm4gbmV3IHQodGhpcy54LWkueCx0aGlzLnktaS55LHRoaXMuei1pLnosdGhpcy53LWkudyl9LHQucHJvdG90eXBlLnNjYWxlPWZ1bmN0aW9uKGkpe3JldHVybiBuZXcgdCh0aGlzLngqaSx0aGlzLnkqaSx0aGlzLnoqaSx0aGlzLncqaSl9LHQucHJvdG90eXBlLm11bHRpcGx5PWZ1bmN0aW9uKGkpe3ZhciBuPW5ldyB0KDAsMCwwLDEpO3JldHVybiB0aGlzLm11bHRpcGx5VG9SZWYoaSxuKSxufSx0LnByb3RvdHlwZS5tdWx0aXBseVRvUmVmPWZ1bmN0aW9uKHQsaSl7dmFyIG49dGhpcy54KnQudyt0aGlzLnkqdC56LXRoaXMueip0LnkrdGhpcy53KnQueCxyPS10aGlzLngqdC56K3RoaXMueSp0LncrdGhpcy56KnQueCt0aGlzLncqdC55LG89dGhpcy54KnQueS10aGlzLnkqdC54K3RoaXMueip0LncrdGhpcy53KnQueixzPS10aGlzLngqdC54LXRoaXMueSp0LnktdGhpcy56KnQueit0aGlzLncqdC53O3JldHVybiBpLmNvcHlGcm9tRmxvYXRzKG4scixvLHMpLHRoaXN9LHQucHJvdG90eXBlLm11bHRpcGx5SW5QbGFjZT1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5tdWx0aXBseVRvUmVmKHQsdGhpcyksdGhpc30sdC5wcm90b3R5cGUuY29uanVnYXRlVG9SZWY9ZnVuY3Rpb24odCl7cmV0dXJuIHQuY29weUZyb21GbG9hdHMoLXRoaXMueCwtdGhpcy55LC10aGlzLnosdGhpcy53KSx0aGlzfSx0LnByb3RvdHlwZS5jb25qdWdhdGVJblBsYWNlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMueCo9LTEsdGhpcy55Kj0tMSx0aGlzLnoqPS0xLHRoaXN9LHQucHJvdG90eXBlLmNvbmp1Z2F0ZT1mdW5jdGlvbigpe3ZhciBpPW5ldyB0KC10aGlzLngsLXRoaXMueSwtdGhpcy56LHRoaXMudyk7cmV0dXJuIGl9LHQucHJvdG90eXBlLmxlbmd0aD1mdW5jdGlvbigpe3JldHVybiBNYXRoLnNxcnQodGhpcy54KnRoaXMueCt0aGlzLnkqdGhpcy55K3RoaXMueip0aGlzLnordGhpcy53KnRoaXMudyl9LHQucHJvdG90eXBlLm5vcm1hbGl6ZT1mdW5jdGlvbigpe3ZhciB0PTEvdGhpcy5sZW5ndGgoKTtyZXR1cm4gdGhpcy54Kj10LHRoaXMueSo9dCx0aGlzLnoqPXQsdGhpcy53Kj10LHRoaXN9LHQucHJvdG90eXBlLnRvRXVsZXJBbmdsZXM9ZnVuY3Rpb24odCl7dm9pZCAwPT09dCYmKHQ9XCJZWlhcIik7dmFyIGk9cy5aZXJvKCk7cmV0dXJuIHRoaXMudG9FdWxlckFuZ2xlc1RvUmVmKGksdCksaX0sdC5wcm90b3R5cGUudG9FdWxlckFuZ2xlc1RvUmVmPWZ1bmN0aW9uKHQsaSl7dm9pZCAwPT09aSYmKGk9XCJZWlhcIik7dmFyIG4scixvLHM9dGhpcy54LGU9dGhpcy55LGg9dGhpcy56LGE9dGhpcy53O3N3aXRjaChpKXtjYXNlXCJZWlhcIjp2YXIgdT1zKmUraCphO2lmKHU+LjQ5OSYmKG49MipNYXRoLmF0YW4yKHMsYSkscj1NYXRoLlBJLzIsbz0wKSwtLjQ5OT51JiYobj0tMipNYXRoLmF0YW4yKHMsYSkscj0tTWF0aC5QSS8yLG89MCksaXNOYU4obikpe3ZhciBtPXMqcyx5PWUqZSxjPWgqaDtuPU1hdGguYXRhbjIoMiplKmEtMipzKmgsMS0yKnktMipjKSxyPU1hdGguYXNpbigyKnUpLG89TWF0aC5hdGFuMigyKnMqYS0yKmUqaCwxLTIqbS0yKmMpfWJyZWFrO2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKFwiRXVsZXIgb3JkZXIgXCIraStcIiBub3Qgc3VwcG9ydGVkIHlldC5cIil9cmV0dXJuIHQueT1uLHQuej1yLHQueD1vLHRoaXN9LHQucHJvdG90eXBlLnRvUm90YXRpb25NYXRyaXg9ZnVuY3Rpb24odCl7dmFyIGk9dGhpcy54KnRoaXMueCxuPXRoaXMueSp0aGlzLnkscj10aGlzLnoqdGhpcy56LG89dGhpcy54KnRoaXMueSxzPXRoaXMueip0aGlzLncsZT10aGlzLnoqdGhpcy54LGg9dGhpcy55KnRoaXMudyxhPXRoaXMueSp0aGlzLnosdT10aGlzLngqdGhpcy53O3JldHVybiB0Lm1bMF09MS0yKihuK3IpLHQubVsxXT0yKihvK3MpLHQubVsyXT0yKihlLWgpLHQubVszXT0wLHQubVs0XT0yKihvLXMpLHQubVs1XT0xLTIqKHIraSksdC5tWzZdPTIqKGErdSksdC5tWzddPTAsdC5tWzhdPTIqKGUraCksdC5tWzldPTIqKGEtdSksdC5tWzEwXT0xLTIqKG4raSksdC5tWzExXT0wLHQubVsxMl09MCx0Lm1bMTNdPTAsdC5tWzE0XT0wLHQubVsxNV09MSx0aGlzfSx0LnByb3RvdHlwZS5mcm9tUm90YXRpb25NYXRyaXg9ZnVuY3Rpb24oaSl7cmV0dXJuIHQuRnJvbVJvdGF0aW9uTWF0cml4VG9SZWYoaSx0aGlzKSx0aGlzfSx0LkZyb21Sb3RhdGlvbk1hdHJpeD1mdW5jdGlvbihpKXt2YXIgbj1uZXcgdDtyZXR1cm4gdC5Gcm9tUm90YXRpb25NYXRyaXhUb1JlZihpLG4pLG59LHQuRnJvbVJvdGF0aW9uTWF0cml4VG9SZWY9ZnVuY3Rpb24odCxpKXt2YXIgbixyPXQubSxvPXJbMF0scz1yWzRdLGU9cls4XSxoPXJbMV0sYT1yWzVdLHU9cls5XSxtPXJbMl0seT1yWzZdLGM9clsxMF0scD1vK2ErYztwPjA/KG49LjUvTWF0aC5zcXJ0KHArMSksaS53PS4yNS9uLGkueD0oeS11KSpuLGkueT0oZS1tKSpuLGkuej0oaC1zKSpuKTpvPmEmJm8+Yz8obj0yKk1hdGguc3FydCgxK28tYS1jKSxpLnc9KHktdSkvbixpLng9LjI1Km4saS55PShzK2gpL24saS56PShlK20pL24pOmE+Yz8obj0yKk1hdGguc3FydCgxK2Etby1jKSxpLnc9KGUtbSkvbixpLng9KHMraCkvbixpLnk9LjI1Km4saS56PSh1K3kpL24pOihuPTIqTWF0aC5zcXJ0KDErYy1vLWEpLGkudz0oaC1zKS9uLGkueD0oZSttKS9uLGkueT0odSt5KS9uLGkuej0uMjUqbil9LHQuSW52ZXJzZT1mdW5jdGlvbihpKXtyZXR1cm4gbmV3IHQoLWkueCwtaS55LC1pLnosaS53KX0sdC5JZGVudGl0eT1mdW5jdGlvbigpe3JldHVybiBuZXcgdCgwLDAsMCwxKX0sdC5Sb3RhdGlvbkF4aXM9ZnVuY3Rpb24oaSxuKXt2YXIgcj1uZXcgdCxvPU1hdGguc2luKG4vMik7cmV0dXJuIGkubm9ybWFsaXplKCksci53PU1hdGguY29zKG4vMiksci54PWkueCpvLHIueT1pLnkqbyxyLno9aS56Km8scn0sdC5Gcm9tQXJyYXk9ZnVuY3Rpb24oaSxuKXtyZXR1cm4gbnx8KG49MCksbmV3IHQoaVtuXSxpW24rMV0saVtuKzJdLGlbbiszXSl9LHQuUm90YXRpb25ZYXdQaXRjaFJvbGw9ZnVuY3Rpb24oaSxuLHIpe3ZhciBvPW5ldyB0O3JldHVybiB0LlJvdGF0aW9uWWF3UGl0Y2hSb2xsVG9SZWYoaSxuLHIsbyksb30sdC5Sb3RhdGlvbllhd1BpdGNoUm9sbFRvUmVmPWZ1bmN0aW9uKHQsaSxuLHIpe3ZhciBvPS41Km4scz0uNSppLGU9LjUqdCxoPU1hdGguc2luKG8pLGE9TWF0aC5jb3MobyksdT1NYXRoLnNpbihzKSxtPU1hdGguY29zKHMpLHk9TWF0aC5zaW4oZSksYz1NYXRoLmNvcyhlKTtyLng9Yyp1KmEreSptKmgsci55PXkqbSphLWMqdSpoLHIuej1jKm0qaC15KnUqYSxyLnc9YyptKmEreSp1Kmh9LHQuUm90YXRpb25BbHBoYUJldGFHYW1tYT1mdW5jdGlvbihpLG4scil7dmFyIG89bmV3IHQ7cmV0dXJuIHQuUm90YXRpb25BbHBoYUJldGFHYW1tYVRvUmVmKGksbixyLG8pLG99LHQuUm90YXRpb25BbHBoYUJldGFHYW1tYVRvUmVmPWZ1bmN0aW9uKHQsaSxuLHIpe3ZhciBvPS41KihuK3QpLHM9LjUqKG4tdCksZT0uNSppO3IueD1NYXRoLmNvcyhzKSpNYXRoLnNpbihlKSxyLnk9TWF0aC5zaW4ocykqTWF0aC5zaW4oZSksci56PU1hdGguc2luKG8pKk1hdGguY29zKGUpLHIudz1NYXRoLmNvcyhvKSpNYXRoLmNvcyhlKX0sdC5TbGVycD1mdW5jdGlvbihpLG4scil7dmFyIG8scyxlPXIsaD1pLngqbi54K2kueSpuLnkraS56Km4ueitpLncqbi53LGE9ITE7aWYoMD5oJiYoYT0hMCxoPS1oKSxoPi45OTk5OTkpcz0xLWUsbz1hPy1lOmU7ZWxzZXt2YXIgdT1NYXRoLmFjb3MoaCksbT0xL01hdGguc2luKHUpO3M9TWF0aC5zaW4oKDEtZSkqdSkqbSxvPWE/LU1hdGguc2luKGUqdSkqbTpNYXRoLnNpbihlKnUpKm19cmV0dXJuIG5ldyB0KHMqaS54K28qbi54LHMqaS55K28qbi55LHMqaS56K28qbi56LHMqaS53K28qbi53KX0sdH0oKTt0LlF1YXRlcm5pb249YTt2YXIgdT1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoKXt0aGlzLm09bmV3IEZsb2F0MzJBcnJheSgxNil9cmV0dXJuIHQucHJvdG90eXBlLmlzSWRlbnRpdHk9ZnVuY3Rpb24oKXtyZXR1cm4gMSE9PXRoaXMubVswXXx8MSE9PXRoaXMubVs1XXx8MSE9PXRoaXMubVsxMF18fDEhPT10aGlzLm1bMTVdPyExOjA9PT10aGlzLm1bMV0mJjA9PT10aGlzLm1bMl0mJjA9PT10aGlzLm1bM10mJjA9PT10aGlzLm1bNF0mJjA9PT10aGlzLm1bNl0mJjA9PT10aGlzLm1bN10mJjA9PT10aGlzLm1bOF0mJjA9PT10aGlzLm1bOV0mJjA9PT10aGlzLm1bMTFdJiYwPT09dGhpcy5tWzEyXSYmMD09PXRoaXMubVsxM10mJjA9PT10aGlzLm1bMTRdfSx0LnByb3RvdHlwZS5kZXRlcm1pbmFudD1mdW5jdGlvbigpe3ZhciB0PXRoaXMubVsxMF0qdGhpcy5tWzE1XS10aGlzLm1bMTFdKnRoaXMubVsxNF0saT10aGlzLm1bOV0qdGhpcy5tWzE1XS10aGlzLm1bMTFdKnRoaXMubVsxM10sbj10aGlzLm1bOV0qdGhpcy5tWzE0XS10aGlzLm1bMTBdKnRoaXMubVsxM10scj10aGlzLm1bOF0qdGhpcy5tWzE1XS10aGlzLm1bMTFdKnRoaXMubVsxMl0sbz10aGlzLm1bOF0qdGhpcy5tWzE0XS10aGlzLm1bMTBdKnRoaXMubVsxMl0scz10aGlzLm1bOF0qdGhpcy5tWzEzXS10aGlzLm1bOV0qdGhpcy5tWzEyXTtyZXR1cm4gdGhpcy5tWzBdKih0aGlzLm1bNV0qdC10aGlzLm1bNl0qaSt0aGlzLm1bN10qbiktdGhpcy5tWzFdKih0aGlzLm1bNF0qdC10aGlzLm1bNl0qcit0aGlzLm1bN10qbykrdGhpcy5tWzJdKih0aGlzLm1bNF0qaS10aGlzLm1bNV0qcit0aGlzLm1bN10qcyktdGhpcy5tWzNdKih0aGlzLm1bNF0qbi10aGlzLm1bNV0qbyt0aGlzLm1bNl0qcyl9LHQucHJvdG90eXBlLnRvQXJyYXk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tfSx0LnByb3RvdHlwZS5hc0FycmF5PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudG9BcnJheSgpfSx0LnByb3RvdHlwZS5pbnZlcnQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbnZlcnRUb1JlZih0aGlzKSx0aGlzfSx0LnByb3RvdHlwZS5yZXNldD1mdW5jdGlvbigpe2Zvcih2YXIgdD0wOzE2PnQ7dCsrKXRoaXMubVt0XT0wO3JldHVybiB0aGlzfSx0LnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oaSl7dmFyIG49bmV3IHQ7cmV0dXJuIHRoaXMuYWRkVG9SZWYoaSxuKSxufSx0LnByb3RvdHlwZS5hZGRUb1JlZj1mdW5jdGlvbih0LGkpe2Zvcih2YXIgbj0wOzE2Pm47bisrKWkubVtuXT10aGlzLm1bbl0rdC5tW25dO3JldHVybiB0aGlzfSx0LnByb3RvdHlwZS5hZGRUb1NlbGY9ZnVuY3Rpb24odCl7Zm9yKHZhciBpPTA7MTY+aTtpKyspdGhpcy5tW2ldKz10Lm1baV07cmV0dXJuIHRoaXN9LHQucHJvdG90eXBlLmludmVydFRvUmVmPWZ1bmN0aW9uKHQpe3ZhciBpPXRoaXMubVswXSxuPXRoaXMubVsxXSxyPXRoaXMubVsyXSxvPXRoaXMubVszXSxzPXRoaXMubVs0XSxlPXRoaXMubVs1XSxoPXRoaXMubVs2XSxhPXRoaXMubVs3XSx1PXRoaXMubVs4XSxtPXRoaXMubVs5XSx5PXRoaXMubVsxMF0sYz10aGlzLm1bMTFdLHA9dGhpcy5tWzEyXSxmPXRoaXMubVsxM10sbD10aGlzLm1bMTRdLHg9dGhpcy5tWzE1XSx6PXkqeC1jKmwsdz1tKngtYypmLHY9bSpsLXkqZixkPXUqeC1jKnAsZz11KmwteSpwLFQ9dSpmLW0qcCxSPWUqei1oKncrYSp2LF89LShzKnotaCpkK2EqZyksTT1zKnctZSpkK2EqVCxiPS0ocyp2LWUqZytoKlQpLEY9MS8oaSpSK24qXytyKk0rbypiKSxBPWgqeC1hKmwsTD1lKngtYSpmLFA9ZSpsLWgqZixDPXMqeC1hKnAsWj1zKmwtaCpwLFM9cypmLWUqcCxJPWgqYy1hKnkscT1lKmMtYSptLEg9ZSp5LWgqbSxOPXMqYy1hKnUsVj1zKnktaCp1LEQ9cyptLWUqdTtyZXR1cm4gdC5tWzBdPVIqRix0Lm1bNF09XypGLHQubVs4XT1NKkYsdC5tWzEyXT1iKkYsdC5tWzFdPS0obip6LXIqdytvKnYpKkYsdC5tWzVdPShpKnotcipkK28qZykqRix0Lm1bOV09LShpKnctbipkK28qVCkqRix0Lm1bMTNdPShpKnYtbipnK3IqVCkqRix0Lm1bMl09KG4qQS1yKkwrbypQKSpGLHQubVs2XT0tKGkqQS1yKkMrbypaKSpGLHQubVsxMF09KGkqTC1uKkMrbypTKSpGLHQubVsxNF09LShpKlAtbipaK3IqUykqRix0Lm1bM109LShuKkktcipxK28qSCkqRix0Lm1bN109KGkqSS1yKk4rbypWKSpGLHQubVsxMV09LShpKnEtbipOK28qRCkqRix0Lm1bMTVdPShpKkgtbipWK3IqRCkqRix0aGlzfSx0LnByb3RvdHlwZS5zZXRUcmFuc2xhdGlvbj1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5tWzEyXT10LngsdGhpcy5tWzEzXT10LnksdGhpcy5tWzE0XT10LnosdGhpc30sdC5wcm90b3R5cGUuZ2V0VHJhbnNsYXRpb249ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHModGhpcy5tWzEyXSx0aGlzLm1bMTNdLHRoaXMubVsxNF0pfSx0LnByb3RvdHlwZS5tdWx0aXBseT1mdW5jdGlvbihpKXt2YXIgbj1uZXcgdDtyZXR1cm4gdGhpcy5tdWx0aXBseVRvUmVmKGksbiksbn0sdC5wcm90b3R5cGUuY29weUZyb209ZnVuY3Rpb24odCl7Zm9yKHZhciBpPTA7MTY+aTtpKyspdGhpcy5tW2ldPXQubVtpXTtyZXR1cm4gdGhpc30sdC5wcm90b3R5cGUuY29weVRvQXJyYXk9ZnVuY3Rpb24odCxpKXt2b2lkIDA9PT1pJiYoaT0wKTtmb3IodmFyIG49MDsxNj5uO24rKyl0W2krbl09dGhpcy5tW25dO3JldHVybiB0aGlzfSx0LnByb3RvdHlwZS5tdWx0aXBseVRvUmVmPWZ1bmN0aW9uKHQsaSl7cmV0dXJuIHRoaXMubXVsdGlwbHlUb0FycmF5KHQsaS5tLDApLHRoaXN9LHQucHJvdG90eXBlLm11bHRpcGx5VG9BcnJheT1mdW5jdGlvbih0LGksbil7dmFyIHI9dGhpcy5tWzBdLG89dGhpcy5tWzFdLHM9dGhpcy5tWzJdLGU9dGhpcy5tWzNdLGg9dGhpcy5tWzRdLGE9dGhpcy5tWzVdLHU9dGhpcy5tWzZdLG09dGhpcy5tWzddLHk9dGhpcy5tWzhdLGM9dGhpcy5tWzldLHA9dGhpcy5tWzEwXSxmPXRoaXMubVsxMV0sbD10aGlzLm1bMTJdLHg9dGhpcy5tWzEzXSx6PXRoaXMubVsxNF0sdz10aGlzLm1bMTVdLHY9dC5tWzBdLGQ9dC5tWzFdLGc9dC5tWzJdLFQ9dC5tWzNdLFI9dC5tWzRdLF89dC5tWzVdLE09dC5tWzZdLGI9dC5tWzddLEY9dC5tWzhdLEE9dC5tWzldLEw9dC5tWzEwXSxQPXQubVsxMV0sQz10Lm1bMTJdLFo9dC5tWzEzXSxTPXQubVsxNF0sST10Lm1bMTVdO3JldHVybiBpW25dPXIqditvKlIrcypGK2UqQyxpW24rMV09cipkK28qXytzKkErZSpaLGlbbisyXT1yKmcrbypNK3MqTCtlKlMsaVtuKzNdPXIqVCtvKmIrcypQK2UqSSxpW24rNF09aCp2K2EqUit1KkYrbSpDLGlbbis1XT1oKmQrYSpfK3UqQSttKlosaVtuKzZdPWgqZythKk0rdSpMK20qUyxpW24rN109aCpUK2EqYit1KlArbSpJLGlbbis4XT15KnYrYypSK3AqRitmKkMsXFxuaVtuKzldPXkqZCtjKl8rcCpBK2YqWixpW24rMTBdPXkqZytjKk0rcCpMK2YqUyxpW24rMTFdPXkqVCtjKmIrcCpQK2YqSSxpW24rMTJdPWwqdit4KlIreipGK3cqQyxpW24rMTNdPWwqZCt4Kl8reipBK3cqWixpW24rMTRdPWwqZyt4Kk0reipMK3cqUyxpW24rMTVdPWwqVCt4KmIreipQK3cqSSx0aGlzfSx0LnByb3RvdHlwZS5lcXVhbHM9ZnVuY3Rpb24odCl7cmV0dXJuIHQmJnRoaXMubVswXT09PXQubVswXSYmdGhpcy5tWzFdPT09dC5tWzFdJiZ0aGlzLm1bMl09PT10Lm1bMl0mJnRoaXMubVszXT09PXQubVszXSYmdGhpcy5tWzRdPT09dC5tWzRdJiZ0aGlzLm1bNV09PT10Lm1bNV0mJnRoaXMubVs2XT09PXQubVs2XSYmdGhpcy5tWzddPT09dC5tWzddJiZ0aGlzLm1bOF09PT10Lm1bOF0mJnRoaXMubVs5XT09PXQubVs5XSYmdGhpcy5tWzEwXT09PXQubVsxMF0mJnRoaXMubVsxMV09PT10Lm1bMTFdJiZ0aGlzLm1bMTJdPT09dC5tWzEyXSYmdGhpcy5tWzEzXT09PXQubVsxM10mJnRoaXMubVsxNF09PT10Lm1bMTRdJiZ0aGlzLm1bMTVdPT09dC5tWzE1XX0sdC5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oKXtyZXR1cm4gdC5Gcm9tVmFsdWVzKHRoaXMubVswXSx0aGlzLm1bMV0sdGhpcy5tWzJdLHRoaXMubVszXSx0aGlzLm1bNF0sdGhpcy5tWzVdLHRoaXMubVs2XSx0aGlzLm1bN10sdGhpcy5tWzhdLHRoaXMubVs5XSx0aGlzLm1bMTBdLHRoaXMubVsxMV0sdGhpcy5tWzEyXSx0aGlzLm1bMTNdLHRoaXMubVsxNF0sdGhpcy5tWzE1XSl9LHQucHJvdG90eXBlLmdldENsYXNzTmFtZT1mdW5jdGlvbigpe3JldHVyblwiTWF0cml4XCJ9LHQucHJvdG90eXBlLmdldEhhc2hDb2RlPWZ1bmN0aW9uKCl7Zm9yKHZhciB0PXRoaXMubVswXXx8MCxpPTE7MTY+aTtpKyspdD0zOTcqdF4odGhpcy5tW2ldfHwwKTtyZXR1cm4gdH0sdC5wcm90b3R5cGUuZGVjb21wb3NlPWZ1bmN0aW9uKG4scixvKXtvLng9dGhpcy5tWzEyXSxvLnk9dGhpcy5tWzEzXSxvLno9dGhpcy5tWzE0XTt2YXIgcz1pLlNpZ24odGhpcy5tWzBdKnRoaXMubVsxXSp0aGlzLm1bMl0qdGhpcy5tWzNdKTwwPy0xOjEsZT1pLlNpZ24odGhpcy5tWzRdKnRoaXMubVs1XSp0aGlzLm1bNl0qdGhpcy5tWzddKTwwPy0xOjEsaD1pLlNpZ24odGhpcy5tWzhdKnRoaXMubVs5XSp0aGlzLm1bMTBdKnRoaXMubVsxMV0pPDA/LTE6MTtpZihuLng9cypNYXRoLnNxcnQodGhpcy5tWzBdKnRoaXMubVswXSt0aGlzLm1bMV0qdGhpcy5tWzFdK3RoaXMubVsyXSp0aGlzLm1bMl0pLG4ueT1lKk1hdGguc3FydCh0aGlzLm1bNF0qdGhpcy5tWzRdK3RoaXMubVs1XSp0aGlzLm1bNV0rdGhpcy5tWzZdKnRoaXMubVs2XSksbi56PWgqTWF0aC5zcXJ0KHRoaXMubVs4XSp0aGlzLm1bOF0rdGhpcy5tWzldKnRoaXMubVs5XSt0aGlzLm1bMTBdKnRoaXMubVsxMF0pLDA9PT1uLnh8fDA9PT1uLnl8fDA9PT1uLnopcmV0dXJuIHIueD0wLHIueT0wLHIuej0wLHIudz0xLCExO3ZhciB1PXQuRnJvbVZhbHVlcyh0aGlzLm1bMF0vbi54LHRoaXMubVsxXS9uLngsdGhpcy5tWzJdL24ueCwwLHRoaXMubVs0XS9uLnksdGhpcy5tWzVdL24ueSx0aGlzLm1bNl0vbi55LDAsdGhpcy5tWzhdL24ueix0aGlzLm1bOV0vbi56LHRoaXMubVsxMF0vbi56LDAsMCwwLDAsMSk7cmV0dXJuIGEuRnJvbVJvdGF0aW9uTWF0cml4VG9SZWYodSxyKSwhMH0sdC5Gcm9tQXJyYXk9ZnVuY3Rpb24oaSxuKXt2YXIgcj1uZXcgdDtyZXR1cm4gbnx8KG49MCksdC5Gcm9tQXJyYXlUb1JlZihpLG4scikscn0sdC5Gcm9tQXJyYXlUb1JlZj1mdW5jdGlvbih0LGksbil7Zm9yKHZhciByPTA7MTY+cjtyKyspbi5tW3JdPXRbcitpXX0sdC5Gcm9tRmxvYXQzMkFycmF5VG9SZWZTY2FsZWQ9ZnVuY3Rpb24odCxpLG4scil7Zm9yKHZhciBvPTA7MTY+bztvKyspci5tW29dPXRbbytpXSpufSx0LkZyb21WYWx1ZXNUb1JlZj1mdW5jdGlvbih0LGksbixyLG8scyxlLGgsYSx1LG0seSxjLHAsZixsLHgpe3gubVswXT10LHgubVsxXT1pLHgubVsyXT1uLHgubVszXT1yLHgubVs0XT1vLHgubVs1XT1zLHgubVs2XT1lLHgubVs3XT1oLHgubVs4XT1hLHgubVs5XT11LHgubVsxMF09bSx4Lm1bMTFdPXkseC5tWzEyXT1jLHgubVsxM109cCx4Lm1bMTRdPWYseC5tWzE1XT1sfSx0LnByb3RvdHlwZS5nZXRSb3c9ZnVuY3Rpb24odCl7aWYoMD50fHx0PjMpcmV0dXJuIG51bGw7dmFyIGk9NCp0O3JldHVybiBuZXcgZSh0aGlzLm1baSswXSx0aGlzLm1baSsxXSx0aGlzLm1baSsyXSx0aGlzLm1baSszXSl9LHQucHJvdG90eXBlLnNldFJvdz1mdW5jdGlvbih0LGkpe2lmKDA+dHx8dD4zKXJldHVybiB0aGlzO3ZhciBuPTQqdDtyZXR1cm4gdGhpcy5tW24rMF09aS54LHRoaXMubVtuKzFdPWkueSx0aGlzLm1bbisyXT1pLnosdGhpcy5tW24rM109aS53LHRoaXN9LHQuRnJvbVZhbHVlcz1mdW5jdGlvbihpLG4scixvLHMsZSxoLGEsdSxtLHksYyxwLGYsbCx4KXt2YXIgej1uZXcgdDtyZXR1cm4gei5tWzBdPWksei5tWzFdPW4sei5tWzJdPXIsei5tWzNdPW8sei5tWzRdPXMsei5tWzVdPWUsei5tWzZdPWgsei5tWzddPWEsei5tWzhdPXUsei5tWzldPW0sei5tWzEwXT15LHoubVsxMV09Yyx6Lm1bMTJdPXAsei5tWzEzXT1mLHoubVsxNF09bCx6Lm1bMTVdPXgsen0sdC5Db21wb3NlPWZ1bmN0aW9uKGksbixyKXt2YXIgbz10LkZyb21WYWx1ZXMoaS54LDAsMCwwLDAsaS55LDAsMCwwLDAsaS56LDAsMCwwLDAsMSkscz10LklkZW50aXR5KCk7cmV0dXJuIG4udG9Sb3RhdGlvbk1hdHJpeChzKSxvPW8ubXVsdGlwbHkocyksby5zZXRUcmFuc2xhdGlvbihyKSxvfSx0LklkZW50aXR5PWZ1bmN0aW9uKCl7cmV0dXJuIHQuRnJvbVZhbHVlcygxLDAsMCwwLDAsMSwwLDAsMCwwLDEsMCwwLDAsMCwxKX0sdC5JZGVudGl0eVRvUmVmPWZ1bmN0aW9uKGkpe3QuRnJvbVZhbHVlc1RvUmVmKDEsMCwwLDAsMCwxLDAsMCwwLDAsMSwwLDAsMCwwLDEsaSl9LHQuWmVybz1mdW5jdGlvbigpe3JldHVybiB0LkZyb21WYWx1ZXMoMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCl9LHQuUm90YXRpb25YPWZ1bmN0aW9uKGkpe3ZhciBuPW5ldyB0O3JldHVybiB0LlJvdGF0aW9uWFRvUmVmKGksbiksbn0sdC5JbnZlcnQ9ZnVuY3Rpb24oaSl7dmFyIG49bmV3IHQ7cmV0dXJuIGkuaW52ZXJ0VG9SZWYobiksbn0sdC5Sb3RhdGlvblhUb1JlZj1mdW5jdGlvbih0LGkpe3ZhciBuPU1hdGguc2luKHQpLHI9TWF0aC5jb3ModCk7aS5tWzBdPTEsaS5tWzE1XT0xLGkubVs1XT1yLGkubVsxMF09cixpLm1bOV09LW4saS5tWzZdPW4saS5tWzFdPTAsaS5tWzJdPTAsaS5tWzNdPTAsaS5tWzRdPTAsaS5tWzddPTAsaS5tWzhdPTAsaS5tWzExXT0wLGkubVsxMl09MCxpLm1bMTNdPTAsaS5tWzE0XT0wfSx0LlJvdGF0aW9uWT1mdW5jdGlvbihpKXt2YXIgbj1uZXcgdDtyZXR1cm4gdC5Sb3RhdGlvbllUb1JlZihpLG4pLG59LHQuUm90YXRpb25ZVG9SZWY9ZnVuY3Rpb24odCxpKXt2YXIgbj1NYXRoLnNpbih0KSxyPU1hdGguY29zKHQpO2kubVs1XT0xLGkubVsxNV09MSxpLm1bMF09cixpLm1bMl09LW4saS5tWzhdPW4saS5tWzEwXT1yLGkubVsxXT0wLGkubVszXT0wLGkubVs0XT0wLGkubVs2XT0wLGkubVs3XT0wLGkubVs5XT0wLGkubVsxMV09MCxpLm1bMTJdPTAsaS5tWzEzXT0wLGkubVsxNF09MH0sdC5Sb3RhdGlvblo9ZnVuY3Rpb24oaSl7dmFyIG49bmV3IHQ7cmV0dXJuIHQuUm90YXRpb25aVG9SZWYoaSxuKSxufSx0LlJvdGF0aW9uWlRvUmVmPWZ1bmN0aW9uKHQsaSl7dmFyIG49TWF0aC5zaW4odCkscj1NYXRoLmNvcyh0KTtpLm1bMTBdPTEsaS5tWzE1XT0xLGkubVswXT1yLGkubVsxXT1uLGkubVs0XT0tbixpLm1bNV09cixpLm1bMl09MCxpLm1bM109MCxpLm1bNl09MCxpLm1bN109MCxpLm1bOF09MCxpLm1bOV09MCxpLm1bMTFdPTAsaS5tWzEyXT0wLGkubVsxM109MCxpLm1bMTRdPTB9LHQuUm90YXRpb25BeGlzPWZ1bmN0aW9uKGksbil7dmFyIHI9dC5aZXJvKCk7cmV0dXJuIHQuUm90YXRpb25BeGlzVG9SZWYoaSxuLHIpLHJ9LHQuUm90YXRpb25BeGlzVG9SZWY9ZnVuY3Rpb24odCxpLG4pe3ZhciByPU1hdGguc2luKC1pKSxvPU1hdGguY29zKC1pKSxzPTEtbzt0Lm5vcm1hbGl6ZSgpLG4ubVswXT10LngqdC54KnMrbyxuLm1bMV09dC54KnQueSpzLXQueipyLG4ubVsyXT10LngqdC56KnMrdC55KnIsbi5tWzNdPTAsbi5tWzRdPXQueSp0Lngqcyt0LnoqcixuLm1bNV09dC55KnQueSpzK28sbi5tWzZdPXQueSp0Lnoqcy10LngqcixuLm1bN109MCxuLm1bOF09dC56KnQueCpzLXQueSpyLG4ubVs5XT10LnoqdC55KnMrdC54KnIsbi5tWzEwXT10LnoqdC56KnMrbyxuLm1bMTFdPTAsbi5tWzE1XT0xfSx0LlJvdGF0aW9uWWF3UGl0Y2hSb2xsPWZ1bmN0aW9uKGksbixyKXt2YXIgbz1uZXcgdDtyZXR1cm4gdC5Sb3RhdGlvbllhd1BpdGNoUm9sbFRvUmVmKGksbixyLG8pLG99LHQuUm90YXRpb25ZYXdQaXRjaFJvbGxUb1JlZj1mdW5jdGlvbih0LGksbixyKXthLlJvdGF0aW9uWWF3UGl0Y2hSb2xsVG9SZWYodCxpLG4sdGhpcy5fdGVtcFF1YXRlcm5pb24pLHRoaXMuX3RlbXBRdWF0ZXJuaW9uLnRvUm90YXRpb25NYXRyaXgocil9LHQuU2NhbGluZz1mdW5jdGlvbihpLG4scil7dmFyIG89dC5aZXJvKCk7cmV0dXJuIHQuU2NhbGluZ1RvUmVmKGksbixyLG8pLG99LHQuU2NhbGluZ1RvUmVmPWZ1bmN0aW9uKHQsaSxuLHIpe3IubVswXT10LHIubVsxXT0wLHIubVsyXT0wLHIubVszXT0wLHIubVs0XT0wLHIubVs1XT1pLHIubVs2XT0wLHIubVs3XT0wLHIubVs4XT0wLHIubVs5XT0wLHIubVsxMF09bixyLm1bMTFdPTAsci5tWzEyXT0wLHIubVsxM109MCxyLm1bMTRdPTAsci5tWzE1XT0xfSx0LlRyYW5zbGF0aW9uPWZ1bmN0aW9uKGksbixyKXt2YXIgbz10LklkZW50aXR5KCk7cmV0dXJuIHQuVHJhbnNsYXRpb25Ub1JlZihpLG4scixvKSxvfSx0LlRyYW5zbGF0aW9uVG9SZWY9ZnVuY3Rpb24oaSxuLHIsbyl7dC5Gcm9tVmFsdWVzVG9SZWYoMSwwLDAsMCwwLDEsMCwwLDAsMCwxLDAsaSxuLHIsMSxvKX0sdC5MZXJwPWZ1bmN0aW9uKGksbixyKXtmb3IodmFyIG89dC5aZXJvKCkscz0wOzE2PnM7cysrKW8ubVtzXT1pLm1bc10qKDEtcikrbi5tW3NdKnI7cmV0dXJuIG99LHQuRGVjb21wb3NlTGVycD1mdW5jdGlvbihpLG4scil7dmFyIG89bmV3IHMoMCwwLDApLGU9bmV3IGEsaD1uZXcgcygwLDAsMCk7aS5kZWNvbXBvc2UobyxlLGgpO3ZhciB1PW5ldyBzKDAsMCwwKSxtPW5ldyBhLHk9bmV3IHMoMCwwLDApO24uZGVjb21wb3NlKHUsbSx5KTt2YXIgYz1zLkxlcnAobyx1LHIpLHA9YS5TbGVycChlLG0sciksZj1zLkxlcnAoaCx5LHIpO3JldHVybiB0LkNvbXBvc2UoYyxwLGYpfSx0Lkxvb2tBdExIPWZ1bmN0aW9uKGksbixyKXt2YXIgbz10Llplcm8oKTtyZXR1cm4gdC5Mb29rQXRMSFRvUmVmKGksbixyLG8pLG99LHQuTG9va0F0TEhUb1JlZj1mdW5jdGlvbihpLG4scixvKXtuLnN1YnRyYWN0VG9SZWYoaSx0aGlzLl96QXhpcyksdGhpcy5fekF4aXMubm9ybWFsaXplKCkscy5Dcm9zc1RvUmVmKHIsdGhpcy5fekF4aXMsdGhpcy5feEF4aXMpLDA9PT10aGlzLl94QXhpcy5sZW5ndGhTcXVhcmVkKCk/dGhpcy5feEF4aXMueD0xOnRoaXMuX3hBeGlzLm5vcm1hbGl6ZSgpLHMuQ3Jvc3NUb1JlZih0aGlzLl96QXhpcyx0aGlzLl94QXhpcyx0aGlzLl95QXhpcyksdGhpcy5feUF4aXMubm9ybWFsaXplKCk7dmFyIGU9LXMuRG90KHRoaXMuX3hBeGlzLGkpLGg9LXMuRG90KHRoaXMuX3lBeGlzLGkpLGE9LXMuRG90KHRoaXMuX3pBeGlzLGkpO3JldHVybiB0LkZyb21WYWx1ZXNUb1JlZih0aGlzLl94QXhpcy54LHRoaXMuX3lBeGlzLngsdGhpcy5fekF4aXMueCwwLHRoaXMuX3hBeGlzLnksdGhpcy5feUF4aXMueSx0aGlzLl96QXhpcy55LDAsdGhpcy5feEF4aXMueix0aGlzLl95QXhpcy56LHRoaXMuX3pBeGlzLnosMCxlLGgsYSwxLG8pfSx0Lk9ydGhvTEg9ZnVuY3Rpb24oaSxuLHIsbyl7dmFyIHM9dC5aZXJvKCk7cmV0dXJuIHQuT3J0aG9MSFRvUmVmKGksbixyLG8scyksc30sdC5PcnRob0xIVG9SZWY9ZnVuY3Rpb24oaSxuLHIsbyxzKXt2YXIgZT0yL2ksaD0yL24sYT0xLyhvLXIpLHU9ci8oci1vKTt0LkZyb21WYWx1ZXNUb1JlZihlLDAsMCwwLDAsaCwwLDAsMCwwLGEsMCwwLDAsdSwxLHMpfSx0Lk9ydGhvT2ZmQ2VudGVyTEg9ZnVuY3Rpb24oaSxuLHIsbyxzLGUpe3ZhciBoPXQuWmVybygpO3JldHVybiB0Lk9ydGhvT2ZmQ2VudGVyTEhUb1JlZihpLG4scixvLHMsZSxoKSxofSx0Lk9ydGhvT2ZmQ2VudGVyTEhUb1JlZj1mdW5jdGlvbih0LGksbixyLG8scyxlKXtlLm1bMF09Mi8oaS10KSxlLm1bMV09ZS5tWzJdPWUubVszXT0wLGUubVs1XT0yLyhyLW4pLGUubVs0XT1lLm1bNl09ZS5tWzddPTAsZS5tWzEwXT0tMS8oby1zKSxlLm1bOF09ZS5tWzldPWUubVsxMV09MCxlLm1bMTJdPSh0K2kpLyh0LWkpLGUubVsxM109KHIrbikvKG4tciksZS5tWzE0XT1vLyhvLXMpLGUubVsxNV09MX0sdC5QZXJzcGVjdGl2ZUxIPWZ1bmN0aW9uKGksbixyLG8pe3ZhciBzPXQuWmVybygpO3JldHVybiBzLm1bMF09MipyL2kscy5tWzFdPXMubVsyXT1zLm1bM109MCxzLm1bNV09MipyL24scy5tWzRdPXMubVs2XT1zLm1bN109MCxzLm1bMTBdPS1vLyhyLW8pLHMubVs4XT1zLm1bOV09MCxzLm1bMTFdPTEscy5tWzEyXT1zLm1bMTNdPXMubVsxNV09MCxzLm1bMTRdPXIqby8oci1vKSxzfSx0LlBlcnNwZWN0aXZlRm92TEg9ZnVuY3Rpb24oaSxuLHIsbyl7dmFyIHM9dC5aZXJvKCk7cmV0dXJuIHQuUGVyc3BlY3RpdmVGb3ZMSFRvUmVmKGksbixyLG8scyksc30sdC5QZXJzcGVjdGl2ZUZvdkxIVG9SZWY9ZnVuY3Rpb24odCxpLG4scixvLHMpe3ZvaWQgMD09PXMmJihzPSEwKTt2YXIgZT0xL01hdGgudGFuKC41KnQpO3M/by5tWzBdPWUvaTpvLm1bMF09ZSxvLm1bMV09by5tWzJdPW8ubVszXT0wLHM/by5tWzVdPWU6by5tWzVdPWUqaSxvLm1bNF09by5tWzZdPW8ubVs3XT0wLG8ubVs4XT1vLm1bOV09MCxvLm1bMTBdPS1yLyhuLXIpLG8ubVsxMV09MSxvLm1bMTJdPW8ubVsxM109by5tWzE1XT0wLG8ubVsxNF09bipyLyhuLXIpfSx0LkdldEZpbmFsTWF0cml4PWZ1bmN0aW9uKGksbixyLG8scyxlKXt2YXIgaD1pLndpZHRoLGE9aS5oZWlnaHQsdT1pLngsbT1pLnkseT10LkZyb21WYWx1ZXMoaC8yLDAsMCwwLDAsLWEvMiwwLDAsMCwwLGUtcywwLHUraC8yLGEvMittLHMsMSk7cmV0dXJuIG4ubXVsdGlwbHkocikubXVsdGlwbHkobykubXVsdGlwbHkoeSl9LHQuR2V0QXNNYXRyaXgyeDI9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBGbG9hdDMyQXJyYXkoW3QubVswXSx0Lm1bMV0sdC5tWzRdLHQubVs1XV0pfSx0LkdldEFzTWF0cml4M3gzPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgRmxvYXQzMkFycmF5KFt0Lm1bMF0sdC5tWzFdLHQubVsyXSx0Lm1bNF0sdC5tWzVdLHQubVs2XSx0Lm1bOF0sdC5tWzldLHQubVsxMF1dKX0sdC5UcmFuc3Bvc2U9ZnVuY3Rpb24oaSl7dmFyIG49bmV3IHQ7cmV0dXJuIG4ubVswXT1pLm1bMF0sbi5tWzFdPWkubVs0XSxuLm1bMl09aS5tWzhdLG4ubVszXT1pLm1bMTJdLG4ubVs0XT1pLm1bMV0sbi5tWzVdPWkubVs1XSxuLm1bNl09aS5tWzldLG4ubVs3XT1pLm1bMTNdLG4ubVs4XT1pLm1bMl0sbi5tWzldPWkubVs2XSxuLm1bMTBdPWkubVsxMF0sbi5tWzExXT1pLm1bMTRdLG4ubVsxMl09aS5tWzNdLG4ubVsxM109aS5tWzddLG4ubVsxNF09aS5tWzExXSxuLm1bMTVdPWkubVsxNV0sbn0sdC5SZWZsZWN0aW9uPWZ1bmN0aW9uKGkpe3ZhciBuPW5ldyB0O3JldHVybiB0LlJlZmxlY3Rpb25Ub1JlZihpLG4pLG59LHQuUmVmbGVjdGlvblRvUmVmPWZ1bmN0aW9uKHQsaSl7dC5ub3JtYWxpemUoKTt2YXIgbj10Lm5vcm1hbC54LHI9dC5ub3JtYWwueSxvPXQubm9ybWFsLnoscz0tMipuLGU9LTIqcixoPS0yKm87aS5tWzBdPXMqbisxLGkubVsxXT1lKm4saS5tWzJdPWgqbixpLm1bM109MCxpLm1bNF09cypyLGkubVs1XT1lKnIrMSxpLm1bNl09aCpyLGkubVs3XT0wLGkubVs4XT1zKm8saS5tWzldPWUqbyxpLm1bMTBdPWgqbysxLGkubVsxMV09MCxpLm1bMTJdPXMqdC5kLGkubVsxM109ZSp0LmQsaS5tWzE0XT1oKnQuZCxpLm1bMTVdPTF9LHQuX3RlbXBRdWF0ZXJuaW9uPW5ldyBhLHQuX3hBeGlzPXMuWmVybygpLHQuX3lBeGlzPXMuWmVybygpLHQuX3pBeGlzPXMuWmVybygpLHR9KCk7dC5NYXRyaXg9dTt2YXIgbT1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCxpLG4scil7dGhpcy5ub3JtYWw9bmV3IHModCxpLG4pLHRoaXMuZD1yfXJldHVybiB0LnByb3RvdHlwZS5hc0FycmF5PWZ1bmN0aW9uKCl7cmV0dXJuW3RoaXMubm9ybWFsLngsdGhpcy5ub3JtYWwueSx0aGlzLm5vcm1hbC56LHRoaXMuZF19LHQucHJvdG90eXBlLmNsb25lPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyB0KHRoaXMubm9ybWFsLngsdGhpcy5ub3JtYWwueSx0aGlzLm5vcm1hbC56LHRoaXMuZCl9LHQucHJvdG90eXBlLmdldENsYXNzTmFtZT1mdW5jdGlvbigpe3JldHVyblwiUGxhbmVcIn0sdC5wcm90b3R5cGUuZ2V0SGFzaENvZGU9ZnVuY3Rpb24oKXt2YXIgdD10aGlzLm5vcm1hbC5nZXRIYXNoQ29kZSgpO3JldHVybiB0PTM5Nyp0Xih0aGlzLmR8fDApfSx0LnByb3RvdHlwZS5ub3JtYWxpemU9ZnVuY3Rpb24oKXt2YXIgdD1NYXRoLnNxcnQodGhpcy5ub3JtYWwueCp0aGlzLm5vcm1hbC54K3RoaXMubm9ybWFsLnkqdGhpcy5ub3JtYWwueSt0aGlzLm5vcm1hbC56KnRoaXMubm9ybWFsLnopLGk9MDtyZXR1cm4gMCE9PXQmJihpPTEvdCksdGhpcy5ub3JtYWwueCo9aSx0aGlzLm5vcm1hbC55Kj1pLHRoaXMubm9ybWFsLnoqPWksdGhpcy5kKj1pLHRoaXN9LHQucHJvdG90eXBlLnRyYW5zZm9ybT1mdW5jdGlvbihpKXt2YXIgbj11LlRyYW5zcG9zZShpKSxyPXRoaXMubm9ybWFsLngsbz10aGlzLm5vcm1hbC55LHM9dGhpcy5ub3JtYWwueixlPXRoaXMuZCxoPXIqbi5tWzBdK28qbi5tWzFdK3Mqbi5tWzJdK2Uqbi5tWzNdLGE9cipuLm1bNF0rbypuLm1bNV0rcypuLm1bNl0rZSpuLm1bN10sbT1yKm4ubVs4XStvKm4ubVs5XStzKm4ubVsxMF0rZSpuLm1bMTFdLHk9cipuLm1bMTJdK28qbi5tWzEzXStzKm4ubVsxNF0rZSpuLm1bMTVdO3JldHVybiBuZXcgdChoLGEsbSx5KX0sdC5wcm90b3R5cGUuZG90Q29vcmRpbmF0ZT1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5ub3JtYWwueCp0LngrdGhpcy5ub3JtYWwueSp0LnkrdGhpcy5ub3JtYWwueip0LnordGhpcy5kfSx0LnByb3RvdHlwZS5jb3B5RnJvbVBvaW50cz1mdW5jdGlvbih0LGksbil7dmFyIHIsbz1pLngtdC54LHM9aS55LXQueSxlPWkuei10LnosaD1uLngtdC54LGE9bi55LXQueSx1PW4uei10LnosbT1zKnUtZSphLHk9ZSpoLW8qdSxjPW8qYS1zKmgscD1NYXRoLnNxcnQobSptK3kqeStjKmMpO3JldHVybiByPTAhPT1wPzEvcDowLHRoaXMubm9ybWFsLng9bSpyLHRoaXMubm9ybWFsLnk9eSpyLHRoaXMubm9ybWFsLno9YypyLHRoaXMuZD0tKHRoaXMubm9ybWFsLngqdC54K3RoaXMubm9ybWFsLnkqdC55K3RoaXMubm9ybWFsLnoqdC56KSx0aGlzfSx0LnByb3RvdHlwZS5pc0Zyb250RmFjaW5nVG89ZnVuY3Rpb24odCxpKXt2YXIgbj1zLkRvdCh0aGlzLm5vcm1hbCx0KTtyZXR1cm4gaT49bn0sdC5wcm90b3R5cGUuc2lnbmVkRGlzdGFuY2VUbz1mdW5jdGlvbih0KXtyZXR1cm4gcy5Eb3QodCx0aGlzLm5vcm1hbCkrdGhpcy5kfSx0LkZyb21BcnJheT1mdW5jdGlvbihpKXtyZXR1cm4gbmV3IHQoaVswXSxpWzFdLGlbMl0saVszXSl9LHQuRnJvbVBvaW50cz1mdW5jdGlvbihpLG4scil7dmFyIG89bmV3IHQoMCwwLDAsMCk7cmV0dXJuIG8uY29weUZyb21Qb2ludHMoaSxuLHIpLG99LHQuRnJvbVBvc2l0aW9uQW5kTm9ybWFsPWZ1bmN0aW9uKGksbil7dmFyIHI9bmV3IHQoMCwwLDAsMCk7cmV0dXJuIG4ubm9ybWFsaXplKCksci5ub3JtYWw9bixyLmQ9LShuLngqaS54K24ueSppLnkrbi56Kmkueikscn0sdC5TaWduZWREaXN0YW5jZVRvUGxhbmVGcm9tUG9zaXRpb25BbmROb3JtYWw9ZnVuY3Rpb24odCxpLG4pe3ZhciByPS0oaS54KnQueCtpLnkqdC55K2kueip0LnopO3JldHVybiBzLkRvdChuLGkpK3J9LHR9KCk7dC5QbGFuZT1tO3ZhciB5PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGksbixyKXt0aGlzLng9dCx0aGlzLnk9aSx0aGlzLndpZHRoPW4sdGhpcy5oZWlnaHQ9cn1yZXR1cm4gdC5wcm90b3R5cGUudG9HbG9iYWw9ZnVuY3Rpb24oaSxuKXtyZXR1cm4gbmV3IHQodGhpcy54KmksdGhpcy55Km4sdGhpcy53aWR0aCppLHRoaXMuaGVpZ2h0Km4pfSx0fSgpO3QuVmlld3BvcnQ9eTt2YXIgYz1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoKXt9cmV0dXJuIHQuR2V0UGxhbmVzPWZ1bmN0aW9uKGkpe2Zvcih2YXIgbj1bXSxyPTA7Nj5yO3IrKyluLnB1c2gobmV3IG0oMCwwLDAsMCkpO3JldHVybiB0LkdldFBsYW5lc1RvUmVmKGksbiksbn0sdC5HZXRQbGFuZXNUb1JlZj1mdW5jdGlvbih0LGkpe2lbMF0ubm9ybWFsLng9dC5tWzNdK3QubVsyXSxpWzBdLm5vcm1hbC55PXQubVs3XSt0Lm1bNl0saVswXS5ub3JtYWwuej10Lm1bMTFdK3QubVsxMF0saVswXS5kPXQubVsxNV0rdC5tWzE0XSxpWzBdLm5vcm1hbGl6ZSgpLGlbMV0ubm9ybWFsLng9dC5tWzNdLXQubVsyXSxpWzFdLm5vcm1hbC55PXQubVs3XS10Lm1bNl0saVsxXS5ub3JtYWwuej10Lm1bMTFdLXQubVsxMF0saVsxXS5kPXQubVsxNV0tdC5tWzE0XSxpWzFdLm5vcm1hbGl6ZSgpLGlbMl0ubm9ybWFsLng9dC5tWzNdK3QubVswXSxpWzJdLm5vcm1hbC55PXQubVs3XSt0Lm1bNF0saVsyXS5ub3JtYWwuej10Lm1bMTFdK3QubVs4XSxpWzJdLmQ9dC5tWzE1XSt0Lm1bMTJdLGlbMl0ubm9ybWFsaXplKCksaVszXS5ub3JtYWwueD10Lm1bM10tdC5tWzBdLGlbM10ubm9ybWFsLnk9dC5tWzddLXQubVs0XSxpWzNdLm5vcm1hbC56PXQubVsxMV0tdC5tWzhdLGlbM10uZD10Lm1bMTVdLXQubVsxMl0saVszXS5ub3JtYWxpemUoKSxpWzRdLm5vcm1hbC54PXQubVszXS10Lm1bMV0saVs0XS5ub3JtYWwueT10Lm1bN10tdC5tWzVdLGlbNF0ubm9ybWFsLno9dC5tWzExXS10Lm1bOV0saVs0XS5kPXQubVsxNV0tdC5tWzEzXSxpWzRdLm5vcm1hbGl6ZSgpLGlbNV0ubm9ybWFsLng9dC5tWzNdK3QubVsxXSxpWzVdLm5vcm1hbC55PXQubVs3XSt0Lm1bNV0saVs1XS5ub3JtYWwuej10Lm1bMTFdK3QubVs5XSxpWzVdLmQ9dC5tWzE1XSt0Lm1bMTNdLGlbNV0ubm9ybWFsaXplKCl9LHR9KCk7dC5GcnVzdHVtPWMsZnVuY3Rpb24odCl7dFt0LkxPQ0FMPTBdPVwiTE9DQUxcIix0W3QuV09STEQ9MV09XCJXT1JMRFwifSh0LlNwYWNlfHwodC5TcGFjZT17fSkpO3ZhciBwPSh0LlNwYWNlLGZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCgpe31yZXR1cm4gdC5YPW5ldyBzKDEsMCwwKSx0Llk9bmV3IHMoMCwxLDApLHQuWj1uZXcgcygwLDAsMSksdH0oKSk7dC5BeGlzPXA7dmFyIGY9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KCl7fXJldHVybiB0LmludGVycG9sYXRlPWZ1bmN0aW9uKHQsaSxuLHIsbyl7Zm9yKHZhciBzPTEtMypyKzMqaSxlPTMqci02KmksaD0zKmksYT10LHU9MDs1PnU7dSsrKXt2YXIgbT1hKmEseT1tKmEsYz1zKnkrZSptK2gqYSxwPTEvKDMqcyptKzIqZSphK2gpO2EtPShjLXQpKnAsYT1NYXRoLm1pbigxLE1hdGgubWF4KDAsYSkpfXJldHVybiAzKk1hdGgucG93KDEtYSwyKSphKm4rMyooMS1hKSpNYXRoLnBvdyhhLDIpKm8rTWF0aC5wb3coYSwzKX0sdH0oKTt0LkJlemllckN1cnZlPWYsZnVuY3Rpb24odCl7dFt0LkNXPTBdPVwiQ1dcIix0W3QuQ0NXPTFdPVwiQ0NXXCJ9KHQuT3JpZW50YXRpb258fCh0Lk9yaWVudGF0aW9uPXt9KSk7dmFyIGw9dC5PcmllbnRhdGlvbix4PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0KXt2YXIgaT10aGlzO3RoaXMuZGVncmVlcz1mdW5jdGlvbigpe3JldHVybiAxODAqaS5fcmFkaWFucy9NYXRoLlBJfSx0aGlzLnJhZGlhbnM9ZnVuY3Rpb24oKXtyZXR1cm4gaS5fcmFkaWFuc30sdGhpcy5fcmFkaWFucz10LHRoaXMuX3JhZGlhbnM8MCYmKHRoaXMuX3JhZGlhbnMrPTIqTWF0aC5QSSl9cmV0dXJuIHQuQmV0d2VlblR3b1BvaW50cz1mdW5jdGlvbihpLG4pe3ZhciByPW4uc3VidHJhY3QoaSksbz1NYXRoLmF0YW4yKHIueSxyLngpO3JldHVybiBuZXcgdChvKX0sdC5Gcm9tUmFkaWFucz1mdW5jdGlvbihpKXtyZXR1cm4gbmV3IHQoaSl9LHQuRnJvbURlZ3JlZXM9ZnVuY3Rpb24oaSl7cmV0dXJuIG5ldyB0KGkqTWF0aC5QSS8xODApfSx0fSgpO3QuQW5nbGU9eDt2YXIgej1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCxpLG4pe3RoaXMuc3RhcnRQb2ludD10LHRoaXMubWlkUG9pbnQ9aSx0aGlzLmVuZFBvaW50PW47dmFyIHI9TWF0aC5wb3coaS54LDIpK01hdGgucG93KGkueSwyKSxzPShNYXRoLnBvdyh0LngsMikrTWF0aC5wb3codC55LDIpLXIpLzIsZT0oci1NYXRoLnBvdyhuLngsMiktTWF0aC5wb3cobi55LDIpKS8yLGg9KHQueC1pLngpKihpLnktbi55KS0oaS54LW4ueCkqKHQueS1pLnkpO3RoaXMuY2VudGVyUG9pbnQ9bmV3IG8oKHMqKGkueS1uLnkpLWUqKHQueS1pLnkpKS9oLCgodC54LWkueCkqZS0oaS54LW4ueCkqcykvaCksdGhpcy5yYWRpdXM9dGhpcy5jZW50ZXJQb2ludC5zdWJ0cmFjdCh0aGlzLnN0YXJ0UG9pbnQpLmxlbmd0aCgpLHRoaXMuc3RhcnRBbmdsZT14LkJldHdlZW5Ud29Qb2ludHModGhpcy5jZW50ZXJQb2ludCx0aGlzLnN0YXJ0UG9pbnQpO3ZhciBhPXRoaXMuc3RhcnRBbmdsZS5kZWdyZWVzKCksdT14LkJldHdlZW5Ud29Qb2ludHModGhpcy5jZW50ZXJQb2ludCx0aGlzLm1pZFBvaW50KS5kZWdyZWVzKCksbT14LkJldHdlZW5Ud29Qb2ludHModGhpcy5jZW50ZXJQb2ludCx0aGlzLmVuZFBvaW50KS5kZWdyZWVzKCk7dS1hPjE4MCYmKHUtPTM2MCksLTE4MD51LWEmJih1Kz0zNjApLG0tdT4xODAmJihtLT0zNjApLC0xODA+bS11JiYobSs9MzYwKSx0aGlzLm9yaWVudGF0aW9uPTA+dS1hP2wuQ1c6bC5DQ1csdGhpcy5hbmdsZT14LkZyb21EZWdyZWVzKHRoaXMub3JpZW50YXRpb249PT1sLkNXP2EtbTptLWEpfXJldHVybiB0fSgpO3QuQXJjMj16O3ZhciB3PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGkpe3RoaXMuX3BvaW50cz1uZXcgQXJyYXksdGhpcy5fbGVuZ3RoPTAsdGhpcy5jbG9zZWQ9ITEsdGhpcy5fcG9pbnRzLnB1c2gobmV3IG8odCxpKSl9cmV0dXJuIHQucHJvdG90eXBlLmFkZExpbmVUbz1mdW5jdGlvbih0LGkpe2lmKGNsb3NlZClyZXR1cm4gdGhpczt2YXIgbj1uZXcgbyh0LGkpLHI9dGhpcy5fcG9pbnRzW3RoaXMuX3BvaW50cy5sZW5ndGgtMV07cmV0dXJuIHRoaXMuX3BvaW50cy5wdXNoKG4pLHRoaXMuX2xlbmd0aCs9bi5zdWJ0cmFjdChyKS5sZW5ndGgoKSx0aGlzfSx0LnByb3RvdHlwZS5hZGRBcmNUbz1mdW5jdGlvbih0LGksbixyLHMpe2lmKHZvaWQgMD09PXMmJihzPTM2KSxjbG9zZWQpcmV0dXJuIHRoaXM7dmFyIGU9dGhpcy5fcG9pbnRzW3RoaXMuX3BvaW50cy5sZW5ndGgtMV0saD1uZXcgbyh0LGkpLGE9bmV3IG8obixyKSx1PW5ldyB6KGUsaCxhKSxtPXUuYW5nbGUucmFkaWFucygpL3M7dS5vcmllbnRhdGlvbj09PWwuQ1cmJihtKj0tMSk7Zm9yKHZhciB5PXUuc3RhcnRBbmdsZS5yYWRpYW5zKCkrbSxjPTA7cz5jO2MrKyl7dmFyIHA9TWF0aC5jb3MoeSkqdS5yYWRpdXMrdS5jZW50ZXJQb2ludC54LGY9TWF0aC5zaW4oeSkqdS5yYWRpdXMrdS5jZW50ZXJQb2ludC55O3RoaXMuYWRkTGluZVRvKHAsZikseSs9bX1yZXR1cm4gdGhpc30sdC5wcm90b3R5cGUuY2xvc2U9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jbG9zZWQ9ITAsdGhpc30sdC5wcm90b3R5cGUubGVuZ3RoPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5fbGVuZ3RoO2lmKCF0aGlzLmNsb3NlZCl7dmFyIGk9dGhpcy5fcG9pbnRzW3RoaXMuX3BvaW50cy5sZW5ndGgtMV0sbj10aGlzLl9wb2ludHNbMF07dCs9bi5zdWJ0cmFjdChpKS5sZW5ndGgoKX1yZXR1cm4gdH0sdC5wcm90b3R5cGUuZ2V0UG9pbnRzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3BvaW50c30sdC5wcm90b3R5cGUuZ2V0UG9pbnRBdExlbmd0aFBvc2l0aW9uPWZ1bmN0aW9uKHQpe2lmKDA+dHx8dD4xKXJldHVybiBvLlplcm8oKTtmb3IodmFyIGk9dCp0aGlzLmxlbmd0aCgpLG49MCxyPTA7cjx0aGlzLl9wb2ludHMubGVuZ3RoO3IrKyl7dmFyIHM9KHIrMSkldGhpcy5fcG9pbnRzLmxlbmd0aCxlPXRoaXMuX3BvaW50c1tyXSxoPXRoaXMuX3BvaW50c1tzXSxhPWguc3VidHJhY3QoZSksdT1hLmxlbmd0aCgpK247aWYoaT49biYmdT49aSl7dmFyIG09YS5ub3JtYWxpemUoKSx5PWktbjtyZXR1cm4gbmV3IG8oZS54K20ueCp5LGUueSttLnkqeSl9bj11fXJldHVybiBvLlplcm8oKX0sdC5TdGFydGluZ0F0PWZ1bmN0aW9uKGksbil7cmV0dXJuIG5ldyB0KGksbil9LHR9KCk7dC5QYXRoMj13O3ZhciB2PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gbih0LGksbil7dGhpcy5wYXRoPXQsdGhpcy5fY3VydmU9bmV3IEFycmF5LHRoaXMuX2Rpc3RhbmNlcz1uZXcgQXJyYXksdGhpcy5fdGFuZ2VudHM9bmV3IEFycmF5LHRoaXMuX25vcm1hbHM9bmV3IEFycmF5LHRoaXMuX2Jpbm9ybWFscz1uZXcgQXJyYXk7Zm9yKHZhciByPTA7cjx0Lmxlbmd0aDtyKyspdGhpcy5fY3VydmVbcl09dFtyXS5jbG9uZSgpO3RoaXMuX3Jhdz1ufHwhMSx0aGlzLl9jb21wdXRlKGkpfXJldHVybiBuLnByb3RvdHlwZS5nZXRDdXJ2ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9jdXJ2ZX0sbi5wcm90b3R5cGUuZ2V0VGFuZ2VudHM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fdGFuZ2VudHN9LG4ucHJvdG90eXBlLmdldE5vcm1hbHM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fbm9ybWFsc30sbi5wcm90b3R5cGUuZ2V0Qmlub3JtYWxzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2Jpbm9ybWFsc30sbi5wcm90b3R5cGUuZ2V0RGlzdGFuY2VzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2Rpc3RhbmNlc30sbi5wcm90b3R5cGUudXBkYXRlPWZ1bmN0aW9uKHQsaSl7Zm9yKHZhciBuPTA7bjx0Lmxlbmd0aDtuKyspdGhpcy5fY3VydmVbbl0ueD10W25dLngsdGhpcy5fY3VydmVbbl0ueT10W25dLnksdGhpcy5fY3VydmVbbl0uej10W25dLno7cmV0dXJuIHRoaXMuX2NvbXB1dGUoaSksdGhpc30sbi5wcm90b3R5cGUuX2NvbXB1dGU9ZnVuY3Rpb24odCl7dmFyIGk9dGhpcy5fY3VydmUubGVuZ3RoO3RoaXMuX3RhbmdlbnRzWzBdPXRoaXMuX2dldEZpcnN0Tm9uTnVsbFZlY3RvcigwKSx0aGlzLl9yYXd8fHRoaXMuX3RhbmdlbnRzWzBdLm5vcm1hbGl6ZSgpLHRoaXMuX3RhbmdlbnRzW2ktMV09dGhpcy5fY3VydmVbaS0xXS5zdWJ0cmFjdCh0aGlzLl9jdXJ2ZVtpLTJdKSx0aGlzLl9yYXd8fHRoaXMuX3RhbmdlbnRzW2ktMV0ubm9ybWFsaXplKCk7dmFyIG49dGhpcy5fdGFuZ2VudHNbMF0scj10aGlzLl9ub3JtYWxWZWN0b3IodGhpcy5fY3VydmVbMF0sbix0KTt0aGlzLl9ub3JtYWxzWzBdPXIsdGhpcy5fcmF3fHx0aGlzLl9ub3JtYWxzWzBdLm5vcm1hbGl6ZSgpLHRoaXMuX2Jpbm9ybWFsc1swXT1zLkNyb3NzKG4sdGhpcy5fbm9ybWFsc1swXSksdGhpcy5fcmF3fHx0aGlzLl9iaW5vcm1hbHNbMF0ubm9ybWFsaXplKCksdGhpcy5fZGlzdGFuY2VzWzBdPTA7Zm9yKHZhciBvLGUsaCxhLHU9MTtpPnU7dSsrKW89dGhpcy5fZ2V0TGFzdE5vbk51bGxWZWN0b3IodSksaS0xPnUmJihlPXRoaXMuX2dldEZpcnN0Tm9uTnVsbFZlY3Rvcih1KSx0aGlzLl90YW5nZW50c1t1XT1vLmFkZChlKSx0aGlzLl90YW5nZW50c1t1XS5ub3JtYWxpemUoKSksdGhpcy5fZGlzdGFuY2VzW3VdPXRoaXMuX2Rpc3RhbmNlc1t1LTFdK28ubGVuZ3RoKCksaD10aGlzLl90YW5nZW50c1t1XSxhPXRoaXMuX2Jpbm9ybWFsc1t1LTFdLHRoaXMuX25vcm1hbHNbdV09cy5Dcm9zcyhhLGgpLHRoaXMuX3Jhd3x8dGhpcy5fbm9ybWFsc1t1XS5ub3JtYWxpemUoKSx0aGlzLl9iaW5vcm1hbHNbdV09cy5Dcm9zcyhoLHRoaXMuX25vcm1hbHNbdV0pLHRoaXMuX3Jhd3x8dGhpcy5fYmlub3JtYWxzW3VdLm5vcm1hbGl6ZSgpfSxuLnByb3RvdHlwZS5fZ2V0Rmlyc3ROb25OdWxsVmVjdG9yPWZ1bmN0aW9uKHQpe2Zvcih2YXIgaT0xLG49dGhpcy5fY3VydmVbdCtpXS5zdWJ0cmFjdCh0aGlzLl9jdXJ2ZVt0XSk7MD09PW4ubGVuZ3RoKCkmJnQraSsxPHRoaXMuX2N1cnZlLmxlbmd0aDspaSsrLG49dGhpcy5fY3VydmVbdCtpXS5zdWJ0cmFjdCh0aGlzLl9jdXJ2ZVt0XSk7cmV0dXJuIG59LG4ucHJvdG90eXBlLl9nZXRMYXN0Tm9uTnVsbFZlY3Rvcj1mdW5jdGlvbih0KXtmb3IodmFyIGk9MSxuPXRoaXMuX2N1cnZlW3RdLnN1YnRyYWN0KHRoaXMuX2N1cnZlW3QtaV0pOzA9PT1uLmxlbmd0aCgpJiZ0PmkrMTspaSsrLG49dGhpcy5fY3VydmVbdF0uc3VidHJhY3QodGhpcy5fY3VydmVbdC1pXSk7cmV0dXJuIG59LG4ucHJvdG90eXBlLl9ub3JtYWxWZWN0b3I9ZnVuY3Rpb24obixyLG8pe3ZhciBlO2lmKHZvaWQgMD09PW98fG51bGw9PT1vKXt2YXIgaDtpLldpdGhpbkVwc2lsb24oci55LDEsdC5FcHNpbG9uKT9pLldpdGhpbkVwc2lsb24oci54LDEsdC5FcHNpbG9uKT9pLldpdGhpbkVwc2lsb24oci56LDEsdC5FcHNpbG9uKXx8KGg9bmV3IHMoMCwwLDEpKTpoPW5ldyBzKDEsMCwwKTpoPW5ldyBzKDAsLTEsMCksZT1zLkNyb3NzKHIsaCl9ZWxzZSBlPXMuQ3Jvc3MocixvKSxzLkNyb3NzVG9SZWYoZSxyLGUpO3JldHVybiBlLm5vcm1hbGl6ZSgpLGV9LG59KCk7dC5QYXRoM0Q9djt2YXIgZD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCl7dGhpcy5fbGVuZ3RoPTAsdGhpcy5fcG9pbnRzPXQsdGhpcy5fbGVuZ3RoPXRoaXMuX2NvbXB1dGVMZW5ndGgodCl9cmV0dXJuIHQuQ3JlYXRlUXVhZHJhdGljQmV6aWVyPWZ1bmN0aW9uKGksbixyLG8pe289bz4yP286Mztmb3IodmFyIGU9bmV3IEFycmF5LGg9ZnVuY3Rpb24odCxpLG4scil7dmFyIG89KDEtdCkqKDEtdCkqaSsyKnQqKDEtdCkqbit0KnQqcjtyZXR1cm4gb30sYT0wO28+PWE7YSsrKWUucHVzaChuZXcgcyhoKGEvbyxpLngsbi54LHIueCksaChhL28saS55LG4ueSxyLnkpLGgoYS9vLGkueixuLnosci56KSkpO3JldHVybiBuZXcgdChlKX0sdC5DcmVhdGVDdWJpY0Jlemllcj1mdW5jdGlvbihpLG4scixvLGUpe2U9ZT4zP2U6NDtmb3IodmFyIGg9bmV3IEFycmF5LGE9ZnVuY3Rpb24odCxpLG4scixvKXt2YXIgcz0oMS10KSooMS10KSooMS10KSppKzMqdCooMS10KSooMS10KSpuKzMqdCp0KigxLXQpKnIrdCp0KnQqbztyZXR1cm4gc30sdT0wO2U+PXU7dSsrKWgucHVzaChuZXcgcyhhKHUvZSxpLngsbi54LHIueCxvLngpLGEodS9lLGkueSxuLnksci55LG8ueSksYSh1L2UsaS56LG4ueixyLnosby56KSkpO3JldHVybiBuZXcgdChoKX0sdC5DcmVhdGVIZXJtaXRlU3BsaW5lPWZ1bmN0aW9uKGksbixyLG8sZSl7Zm9yKHZhciBoPW5ldyBBcnJheSxhPTEvZSx1PTA7ZT49dTt1KyspaC5wdXNoKHMuSGVybWl0ZShpLG4scixvLHUqYSkpO3JldHVybiBuZXcgdChoKX0sdC5wcm90b3R5cGUuZ2V0UG9pbnRzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3BvaW50c30sdC5wcm90b3R5cGUubGVuZ3RoPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2xlbmd0aH0sdC5wcm90b3R5cGVbXCJjb250aW51ZVwiXT1mdW5jdGlvbihpKXtmb3IodmFyIG49dGhpcy5fcG9pbnRzW3RoaXMuX3BvaW50cy5sZW5ndGgtMV0scj10aGlzLl9wb2ludHMuc2xpY2UoKSxvPWkuZ2V0UG9pbnRzKCkscz0xO3M8by5sZW5ndGg7cysrKXIucHVzaChvW3NdLnN1YnRyYWN0KG9bMF0pLmFkZChuKSk7dmFyIGU9bmV3IHQocik7cmV0dXJuIGV9LHQucHJvdG90eXBlLl9jb21wdXRlTGVuZ3RoPWZ1bmN0aW9uKHQpe2Zvcih2YXIgaT0wLG49MTtuPHQubGVuZ3RoO24rKylpKz10W25dLnN1YnRyYWN0KHRbbi0xXSkubGVuZ3RoKCk7cmV0dXJuIGl9LHR9KCk7dC5DdXJ2ZTM9ZDt2YXIgZz1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoKXt0aGlzLkwwMD1zLlplcm8oKSx0aGlzLkwxXzE9cy5aZXJvKCksdGhpcy5MMTA9cy5aZXJvKCksdGhpcy5MMTE9cy5aZXJvKCksdGhpcy5MMl8yPXMuWmVybygpLHRoaXMuTDJfMT1zLlplcm8oKSx0aGlzLkwyMD1zLlplcm8oKSx0aGlzLkwyMT1zLlplcm8oKSx0aGlzLkwyMj1zLlplcm8oKX1yZXR1cm4gdC5wcm90b3R5cGUuYWRkTGlnaHQ9ZnVuY3Rpb24odCxpLG4pe3ZhciByPW5ldyBzKGkucixpLmcsaS5iKSxvPXIuc2NhbGUobik7dGhpcy5MMDA9dGhpcy5MMDAuYWRkKG8uc2NhbGUoLjI4MjA5NSkpLHRoaXMuTDFfMT10aGlzLkwxXzEuYWRkKG8uc2NhbGUoLjQ4ODYwMyp0LnkpKSx0aGlzLkwxMD10aGlzLkwxMC5hZGQoby5zY2FsZSguNDg4NjAzKnQueikpLHRoaXMuTDExPXRoaXMuTDExLmFkZChvLnNjYWxlKC40ODg2MDMqdC54KSksdGhpcy5MMl8yPXRoaXMuTDJfMi5hZGQoby5zY2FsZSgxLjA5MjU0OCp0LngqdC55KSksdGhpcy5MMl8xPXRoaXMuTDJfMS5hZGQoby5zY2FsZSgxLjA5MjU0OCp0LnkqdC56KSksdGhpcy5MMjE9dGhpcy5MMjEuYWRkKG8uc2NhbGUoMS4wOTI1NDgqdC54KnQueikpLHRoaXMuTDIwPXRoaXMuTDIwLmFkZChvLnNjYWxlKC4zMTUzOTIqKDMqdC56KnQuei0xKSkpLHRoaXMuTDIyPXRoaXMuTDIyLmFkZChvLnNjYWxlKC41NDYyNzQqKHQueCp0LngtdC55KnQueSkpKX0sdC5wcm90b3R5cGUuc2NhbGU9ZnVuY3Rpb24odCl7dGhpcy5MMDA9dGhpcy5MMDAuc2NhbGUodCksdGhpcy5MMV8xPXRoaXMuTDFfMS5zY2FsZSh0KSx0aGlzLkwxMD10aGlzLkwxMC5zY2FsZSh0KSx0aGlzLkwxMT10aGlzLkwxMS5zY2FsZSh0KSx0aGlzLkwyXzI9dGhpcy5MMl8yLnNjYWxlKHQpLHRoaXMuTDJfMT10aGlzLkwyXzEuc2NhbGUodCksdGhpcy5MMjA9dGhpcy5MMjAuc2NhbGUodCksdGhpcy5MMjE9dGhpcy5MMjEuc2NhbGUodCksdGhpcy5MMjI9dGhpcy5MMjIuc2NhbGUodCl9LHR9KCk7dC5TcGhlcmljYWxIYXJtb25pY3M9Zzt2YXIgVD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoKXt0aGlzLng9cy5aZXJvKCksdGhpcy55PXMuWmVybygpLHRoaXMuej1zLlplcm8oKSx0aGlzLnh4PXMuWmVybygpLHRoaXMueXk9cy5aZXJvKCksdGhpcy56ej1zLlplcm8oKSx0aGlzLnh5PXMuWmVybygpLHRoaXMueXo9cy5aZXJvKCksdGhpcy56eD1zLlplcm8oKX1yZXR1cm4gdC5wcm90b3R5cGUuYWRkQW1iaWVudD1mdW5jdGlvbih0KXt2YXIgaT1uZXcgcyh0LnIsdC5nLHQuYik7dGhpcy54eD10aGlzLnh4LmFkZChpKSx0aGlzLnl5PXRoaXMueXkuYWRkKGkpLHRoaXMueno9dGhpcy56ei5hZGQoaSl9LHQuZ2V0U3BoZXJpY2FsUG9seW5vbWlhbEZyb21IYXJtb25pY3M9ZnVuY3Rpb24oaSl7dmFyIG49bmV3IHQ7cmV0dXJuIG4ueD1pLkwxMS5zY2FsZSgxLjAyMzMzKSxuLnk9aS5MMV8xLnNjYWxlKDEuMDIzMzMpLG4uej1pLkwxMC5zY2FsZSgxLjAyMzMzKSxuLnh4PWkuTDAwLnNjYWxlKC44ODYyNzcpLnN1YnRyYWN0KGkuTDIwLnNjYWxlKC4yNDc3MDgpKS5hZGQoaS5MMjIuc2NhbGUoLjQyOTA0MykpLG4ueXk9aS5MMDAuc2NhbGUoLjg4NjI3Nykuc3VidHJhY3QoaS5MMjAuc2NhbGUoLjI0NzcwOCkpLnN1YnRyYWN0KGkuTDIyLnNjYWxlKC40MjkwNDMpKSxuLnp6PWkuTDAwLnNjYWxlKC44ODYyNzcpLmFkZChpLkwyMC5zY2FsZSguNDk1NDE3KSksbi55ej1pLkwyXzEuc2NhbGUoLjg1ODA4Niksbi56eD1pLkwyMS5zY2FsZSguODU4MDg2KSxuLnh5PWkuTDJfMi5zY2FsZSguODU4MDg2KSxufSx0fSgpO3QuU3BoZXJpY2FsUG9seW5vbWlhbD1UO3ZhciBSPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGkpe3ZvaWQgMD09PXQmJih0PXMuWmVybygpKSx2b2lkIDA9PT1pJiYoaT1zLlVwKCkpLHRoaXMucG9zaXRpb249dCx0aGlzLm5vcm1hbD1pfXJldHVybiB0LnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbigpe3JldHVybiBuZXcgdCh0aGlzLnBvc2l0aW9uLmNsb25lKCksdGhpcy5ub3JtYWwuY2xvbmUoKSl9LHR9KCk7dC5Qb3NpdGlvbk5vcm1hbFZlcnRleD1SO3ZhciBfPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGksbil7dm9pZCAwPT09dCYmKHQ9cy5aZXJvKCkpLHZvaWQgMD09PWkmJihpPXMuVXAoKSksdm9pZCAwPT09biYmKG49by5aZXJvKCkpLHRoaXMucG9zaXRpb249dCx0aGlzLm5vcm1hbD1pLHRoaXMudXY9bn1yZXR1cm4gdC5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHQodGhpcy5wb3NpdGlvbi5jbG9uZSgpLHRoaXMubm9ybWFsLmNsb25lKCksdGhpcy51di5jbG9uZSgpKX0sdH0oKTt0LlBvc2l0aW9uTm9ybWFsVGV4dHVyZVZlcnRleD1fO3ZhciBNPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCgpe31yZXR1cm4gdC5Db2xvcjM9W24uQmxhY2soKSxuLkJsYWNrKCksbi5CbGFjaygpXSx0LlZlY3RvcjI9W28uWmVybygpLG8uWmVybygpLG8uWmVybygpXSx0LlZlY3RvcjM9W3MuWmVybygpLHMuWmVybygpLHMuWmVybygpLHMuWmVybygpLHMuWmVybygpLHMuWmVybygpLHMuWmVybygpLHMuWmVybygpLHMuWmVybygpXSx0LlZlY3RvcjQ9W2UuWmVybygpLGUuWmVybygpLGUuWmVybygpXSx0LlF1YXRlcm5pb249W25ldyBhKDAsMCwwLDApXSx0Lk1hdHJpeD1bdS5aZXJvKCksdS5aZXJvKCksdS5aZXJvKCksdS5aZXJvKCksdS5aZXJvKCksdS5aZXJvKCksdS5aZXJvKCksdS5aZXJvKCldLHR9KCk7dC5UbXA9TX0oQkFCWUxPTnx8KEJBQllMT049e30pKTsnLFxuKFwidW5kZWZpbmVkXCIhPXR5cGVvZiB3aW5kb3cmJndpbmRvdy5tb2R1bGV8fFwidW5kZWZpbmVkXCIhPXR5cGVvZiBtb2R1bGUpJiZcInVuZGVmaW5lZFwiIT10eXBlb2YgbW9kdWxlLmV4cG9ydHMmJihtb2R1bGUuZXhwb3J0cz1CQUJZTE9OKTsiLCIoZnVuY3Rpb24gKGdsb2JhbCwgbW9kdWxlKSB7XG5cbiAgdmFyIGV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cztcblxuICAvKipcbiAgICogRXhwb3J0cy5cbiAgICovXG5cbiAgbW9kdWxlLmV4cG9ydHMgPSBleHBlY3Q7XG4gIGV4cGVjdC5Bc3NlcnRpb24gPSBBc3NlcnRpb247XG5cbiAgLyoqXG4gICAqIEV4cG9ydHMgdmVyc2lvbi5cbiAgICovXG5cbiAgZXhwZWN0LnZlcnNpb24gPSAnMC4zLjEnO1xuXG4gIC8qKlxuICAgKiBQb3NzaWJsZSBhc3NlcnRpb24gZmxhZ3MuXG4gICAqL1xuXG4gIHZhciBmbGFncyA9IHtcbiAgICAgIG5vdDogWyd0bycsICdiZScsICdoYXZlJywgJ2luY2x1ZGUnLCAnb25seSddXG4gICAgLCB0bzogWydiZScsICdoYXZlJywgJ2luY2x1ZGUnLCAnb25seScsICdub3QnXVxuICAgICwgb25seTogWydoYXZlJ11cbiAgICAsIGhhdmU6IFsnb3duJ11cbiAgICAsIGJlOiBbJ2FuJ11cbiAgfTtcblxuICBmdW5jdGlvbiBleHBlY3QgKG9iaikge1xuICAgIHJldHVybiBuZXcgQXNzZXJ0aW9uKG9iaik7XG4gIH1cblxuICAvKipcbiAgICogQ29uc3RydWN0b3JcbiAgICpcbiAgICogQGFwaSBwcml2YXRlXG4gICAqL1xuXG4gIGZ1bmN0aW9uIEFzc2VydGlvbiAob2JqLCBmbGFnLCBwYXJlbnQpIHtcbiAgICB0aGlzLm9iaiA9IG9iajtcbiAgICB0aGlzLmZsYWdzID0ge307XG5cbiAgICBpZiAodW5kZWZpbmVkICE9IHBhcmVudCkge1xuICAgICAgdGhpcy5mbGFnc1tmbGFnXSA9IHRydWU7XG5cbiAgICAgIGZvciAodmFyIGkgaW4gcGFyZW50LmZsYWdzKSB7XG4gICAgICAgIGlmIChwYXJlbnQuZmxhZ3MuaGFzT3duUHJvcGVydHkoaSkpIHtcbiAgICAgICAgICB0aGlzLmZsYWdzW2ldID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHZhciAkZmxhZ3MgPSBmbGFnID8gZmxhZ3NbZmxhZ10gOiBrZXlzKGZsYWdzKVxuICAgICAgLCBzZWxmID0gdGhpcztcblxuICAgIGlmICgkZmxhZ3MpIHtcbiAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gJGZsYWdzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAvLyBhdm9pZCByZWN1cnNpb25cbiAgICAgICAgaWYgKHRoaXMuZmxhZ3NbJGZsYWdzW2ldXSkgY29udGludWU7XG5cbiAgICAgICAgdmFyIG5hbWUgPSAkZmxhZ3NbaV1cbiAgICAgICAgICAsIGFzc2VydGlvbiA9IG5ldyBBc3NlcnRpb24odGhpcy5vYmosIG5hbWUsIHRoaXMpXG5cbiAgICAgICAgaWYgKCdmdW5jdGlvbicgPT0gdHlwZW9mIEFzc2VydGlvbi5wcm90b3R5cGVbbmFtZV0pIHtcbiAgICAgICAgICAvLyBjbG9uZSB0aGUgZnVuY3Rpb24sIG1ha2Ugc3VyZSB3ZSBkb250IHRvdWNoIHRoZSBwcm90IHJlZmVyZW5jZVxuICAgICAgICAgIHZhciBvbGQgPSB0aGlzW25hbWVdO1xuICAgICAgICAgIHRoaXNbbmFtZV0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gb2xkLmFwcGx5KHNlbGYsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgfTtcblxuICAgICAgICAgIGZvciAodmFyIGZuIGluIEFzc2VydGlvbi5wcm90b3R5cGUpIHtcbiAgICAgICAgICAgIGlmIChBc3NlcnRpb24ucHJvdG90eXBlLmhhc093blByb3BlcnR5KGZuKSAmJiBmbiAhPSBuYW1lKSB7XG4gICAgICAgICAgICAgIHRoaXNbbmFtZV1bZm5dID0gYmluZChhc3NlcnRpb25bZm5dLCBhc3NlcnRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzW25hbWVdID0gYXNzZXJ0aW9uO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFBlcmZvcm1zIGFuIGFzc2VydGlvblxuICAgKlxuICAgKiBAYXBpIHByaXZhdGVcbiAgICovXG5cbiAgQXNzZXJ0aW9uLnByb3RvdHlwZS5hc3NlcnQgPSBmdW5jdGlvbiAodHJ1dGgsIG1zZywgZXJyb3IsIGV4cGVjdGVkKSB7XG4gICAgdmFyIG1zZyA9IHRoaXMuZmxhZ3Mubm90ID8gZXJyb3IgOiBtc2dcbiAgICAgICwgb2sgPSB0aGlzLmZsYWdzLm5vdCA/ICF0cnV0aCA6IHRydXRoXG4gICAgICAsIGVycjtcblxuICAgIGlmICghb2spIHtcbiAgICAgIGVyciA9IG5ldyBFcnJvcihtc2cuY2FsbCh0aGlzKSk7XG4gICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDMpIHtcbiAgICAgICAgZXJyLmFjdHVhbCA9IHRoaXMub2JqO1xuICAgICAgICBlcnIuZXhwZWN0ZWQgPSBleHBlY3RlZDtcbiAgICAgICAgZXJyLnNob3dEaWZmID0gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIHRocm93IGVycjtcbiAgICB9XG5cbiAgICB0aGlzLmFuZCA9IG5ldyBBc3NlcnRpb24odGhpcy5vYmopO1xuICB9O1xuXG4gIC8qKlxuICAgKiBDaGVjayBpZiB0aGUgdmFsdWUgaXMgdHJ1dGh5XG4gICAqXG4gICAqIEBhcGkgcHVibGljXG4gICAqL1xuXG4gIEFzc2VydGlvbi5wcm90b3R5cGUub2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5hc3NlcnQoXG4gICAgICAgICEhdGhpcy5vYmpcbiAgICAgICwgZnVuY3Rpb24oKXsgcmV0dXJuICdleHBlY3RlZCAnICsgaSh0aGlzLm9iaikgKyAnIHRvIGJlIHRydXRoeScgfVxuICAgICAgLCBmdW5jdGlvbigpeyByZXR1cm4gJ2V4cGVjdGVkICcgKyBpKHRoaXMub2JqKSArICcgdG8gYmUgZmFsc3knIH0pO1xuICB9O1xuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGFuIGFub255bW91cyBmdW5jdGlvbiB3aGljaCBjYWxscyBmbiB3aXRoIGFyZ3VtZW50cy5cbiAgICpcbiAgICogQGFwaSBwdWJsaWNcbiAgICovXG5cbiAgQXNzZXJ0aW9uLnByb3RvdHlwZS53aXRoQXJncyA9IGZ1bmN0aW9uKCkge1xuICAgIGV4cGVjdCh0aGlzLm9iaikudG8uYmUuYSgnZnVuY3Rpb24nKTtcbiAgICB2YXIgZm4gPSB0aGlzLm9iajtcbiAgICB2YXIgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7XG4gICAgcmV0dXJuIGV4cGVjdChmdW5jdGlvbigpIHsgZm4uYXBwbHkobnVsbCwgYXJncyk7IH0pO1xuICB9O1xuXG4gIC8qKlxuICAgKiBBc3NlcnQgdGhhdCB0aGUgZnVuY3Rpb24gdGhyb3dzLlxuICAgKlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufFJlZ0V4cH0gY2FsbGJhY2ssIG9yIHJlZ2V4cCB0byBtYXRjaCBlcnJvciBzdHJpbmcgYWdhaW5zdFxuICAgKiBAYXBpIHB1YmxpY1xuICAgKi9cblxuICBBc3NlcnRpb24ucHJvdG90eXBlLnRocm93RXJyb3IgPVxuICBBc3NlcnRpb24ucHJvdG90eXBlLnRocm93RXhjZXB0aW9uID0gZnVuY3Rpb24gKGZuKSB7XG4gICAgZXhwZWN0KHRoaXMub2JqKS50by5iZS5hKCdmdW5jdGlvbicpO1xuXG4gICAgdmFyIHRocm93biA9IGZhbHNlXG4gICAgICAsIG5vdCA9IHRoaXMuZmxhZ3Mubm90O1xuXG4gICAgdHJ5IHtcbiAgICAgIHRoaXMub2JqKCk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgaWYgKGlzUmVnRXhwKGZuKSkge1xuICAgICAgICB2YXIgc3ViamVjdCA9ICdzdHJpbmcnID09IHR5cGVvZiBlID8gZSA6IGUubWVzc2FnZTtcbiAgICAgICAgaWYgKG5vdCkge1xuICAgICAgICAgIGV4cGVjdChzdWJqZWN0KS50by5ub3QubWF0Y2goZm4pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGV4cGVjdChzdWJqZWN0KS50by5tYXRjaChmbik7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoJ2Z1bmN0aW9uJyA9PSB0eXBlb2YgZm4pIHtcbiAgICAgICAgZm4oZSk7XG4gICAgICB9XG4gICAgICB0aHJvd24gPSB0cnVlO1xuICAgIH1cblxuICAgIGlmIChpc1JlZ0V4cChmbikgJiYgbm90KSB7XG4gICAgICAvLyBpbiB0aGUgcHJlc2VuY2Ugb2YgYSBtYXRjaGVyLCBlbnN1cmUgdGhlIGBub3RgIG9ubHkgYXBwbGllcyB0b1xuICAgICAgLy8gdGhlIG1hdGNoaW5nLlxuICAgICAgdGhpcy5mbGFncy5ub3QgPSBmYWxzZTtcbiAgICB9XG5cbiAgICB2YXIgbmFtZSA9IHRoaXMub2JqLm5hbWUgfHwgJ2ZuJztcbiAgICB0aGlzLmFzc2VydChcbiAgICAgICAgdGhyb3duXG4gICAgICAsIGZ1bmN0aW9uKCl7IHJldHVybiAnZXhwZWN0ZWQgJyArIG5hbWUgKyAnIHRvIHRocm93IGFuIGV4Y2VwdGlvbicgfVxuICAgICAgLCBmdW5jdGlvbigpeyByZXR1cm4gJ2V4cGVjdGVkICcgKyBuYW1lICsgJyBub3QgdG8gdGhyb3cgYW4gZXhjZXB0aW9uJyB9KTtcbiAgfTtcblxuICAvKipcbiAgICogQ2hlY2tzIGlmIHRoZSBhcnJheSBpcyBlbXB0eS5cbiAgICpcbiAgICogQGFwaSBwdWJsaWNcbiAgICovXG5cbiAgQXNzZXJ0aW9uLnByb3RvdHlwZS5lbXB0eSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXhwZWN0YXRpb247XG5cbiAgICBpZiAoJ29iamVjdCcgPT0gdHlwZW9mIHRoaXMub2JqICYmIG51bGwgIT09IHRoaXMub2JqICYmICFpc0FycmF5KHRoaXMub2JqKSkge1xuICAgICAgaWYgKCdudW1iZXInID09IHR5cGVvZiB0aGlzLm9iai5sZW5ndGgpIHtcbiAgICAgICAgZXhwZWN0YXRpb24gPSAhdGhpcy5vYmoubGVuZ3RoO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZXhwZWN0YXRpb24gPSAha2V5cyh0aGlzLm9iaikubGVuZ3RoO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoJ3N0cmluZycgIT0gdHlwZW9mIHRoaXMub2JqKSB7XG4gICAgICAgIGV4cGVjdCh0aGlzLm9iaikudG8uYmUuYW4oJ29iamVjdCcpO1xuICAgICAgfVxuXG4gICAgICBleHBlY3QodGhpcy5vYmopLnRvLmhhdmUucHJvcGVydHkoJ2xlbmd0aCcpO1xuICAgICAgZXhwZWN0YXRpb24gPSAhdGhpcy5vYmoubGVuZ3RoO1xuICAgIH1cblxuICAgIHRoaXMuYXNzZXJ0KFxuICAgICAgICBleHBlY3RhdGlvblxuICAgICAgLCBmdW5jdGlvbigpeyByZXR1cm4gJ2V4cGVjdGVkICcgKyBpKHRoaXMub2JqKSArICcgdG8gYmUgZW1wdHknIH1cbiAgICAgICwgZnVuY3Rpb24oKXsgcmV0dXJuICdleHBlY3RlZCAnICsgaSh0aGlzLm9iaikgKyAnIHRvIG5vdCBiZSBlbXB0eScgfSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIENoZWNrcyBpZiB0aGUgb2JqIGV4YWN0bHkgZXF1YWxzIGFub3RoZXIuXG4gICAqXG4gICAqIEBhcGkgcHVibGljXG4gICAqL1xuXG4gIEFzc2VydGlvbi5wcm90b3R5cGUuYmUgPVxuICBBc3NlcnRpb24ucHJvdG90eXBlLmVxdWFsID0gZnVuY3Rpb24gKG9iaikge1xuICAgIHRoaXMuYXNzZXJ0KFxuICAgICAgICBvYmogPT09IHRoaXMub2JqXG4gICAgICAsIGZ1bmN0aW9uKCl7IHJldHVybiAnZXhwZWN0ZWQgJyArIGkodGhpcy5vYmopICsgJyB0byBlcXVhbCAnICsgaShvYmopIH1cbiAgICAgICwgZnVuY3Rpb24oKXsgcmV0dXJuICdleHBlY3RlZCAnICsgaSh0aGlzLm9iaikgKyAnIHRvIG5vdCBlcXVhbCAnICsgaShvYmopIH0pO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIC8qKlxuICAgKiBDaGVja3MgaWYgdGhlIG9iaiBzb3J0b2YgZXF1YWxzIGFub3RoZXIuXG4gICAqXG4gICAqIEBhcGkgcHVibGljXG4gICAqL1xuXG4gIEFzc2VydGlvbi5wcm90b3R5cGUuZXFsID0gZnVuY3Rpb24gKG9iaikge1xuICAgIHRoaXMuYXNzZXJ0KFxuICAgICAgICBleHBlY3QuZXFsKHRoaXMub2JqLCBvYmopXG4gICAgICAsIGZ1bmN0aW9uKCl7IHJldHVybiAnZXhwZWN0ZWQgJyArIGkodGhpcy5vYmopICsgJyB0byBzb3J0IG9mIGVxdWFsICcgKyBpKG9iaikgfVxuICAgICAgLCBmdW5jdGlvbigpeyByZXR1cm4gJ2V4cGVjdGVkICcgKyBpKHRoaXMub2JqKSArICcgdG8gc29ydCBvZiBub3QgZXF1YWwgJyArIGkob2JqKSB9XG4gICAgICAsIG9iaik7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIEFzc2VydCB3aXRoaW4gc3RhcnQgdG8gZmluaXNoIChpbmNsdXNpdmUpLlxuICAgKlxuICAgKiBAcGFyYW0ge051bWJlcn0gc3RhcnRcbiAgICogQHBhcmFtIHtOdW1iZXJ9IGZpbmlzaFxuICAgKiBAYXBpIHB1YmxpY1xuICAgKi9cblxuICBBc3NlcnRpb24ucHJvdG90eXBlLndpdGhpbiA9IGZ1bmN0aW9uIChzdGFydCwgZmluaXNoKSB7XG4gICAgdmFyIHJhbmdlID0gc3RhcnQgKyAnLi4nICsgZmluaXNoO1xuICAgIHRoaXMuYXNzZXJ0KFxuICAgICAgICB0aGlzLm9iaiA+PSBzdGFydCAmJiB0aGlzLm9iaiA8PSBmaW5pc2hcbiAgICAgICwgZnVuY3Rpb24oKXsgcmV0dXJuICdleHBlY3RlZCAnICsgaSh0aGlzLm9iaikgKyAnIHRvIGJlIHdpdGhpbiAnICsgcmFuZ2UgfVxuICAgICAgLCBmdW5jdGlvbigpeyByZXR1cm4gJ2V4cGVjdGVkICcgKyBpKHRoaXMub2JqKSArICcgdG8gbm90IGJlIHdpdGhpbiAnICsgcmFuZ2UgfSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIEFzc2VydCB0eXBlb2YgLyBpbnN0YW5jZSBvZlxuICAgKlxuICAgKiBAYXBpIHB1YmxpY1xuICAgKi9cblxuICBBc3NlcnRpb24ucHJvdG90eXBlLmEgPVxuICBBc3NlcnRpb24ucHJvdG90eXBlLmFuID0gZnVuY3Rpb24gKHR5cGUpIHtcbiAgICBpZiAoJ3N0cmluZycgPT0gdHlwZW9mIHR5cGUpIHtcbiAgICAgIC8vIHByb3BlciBlbmdsaXNoIGluIGVycm9yIG1zZ1xuICAgICAgdmFyIG4gPSAvXlthZWlvdV0vLnRlc3QodHlwZSkgPyAnbicgOiAnJztcblxuICAgICAgLy8gdHlwZW9mIHdpdGggc3VwcG9ydCBmb3IgJ2FycmF5J1xuICAgICAgdGhpcy5hc3NlcnQoXG4gICAgICAgICAgJ2FycmF5JyA9PSB0eXBlID8gaXNBcnJheSh0aGlzLm9iaikgOlxuICAgICAgICAgICAgJ3JlZ2V4cCcgPT0gdHlwZSA/IGlzUmVnRXhwKHRoaXMub2JqKSA6XG4gICAgICAgICAgICAgICdvYmplY3QnID09IHR5cGVcbiAgICAgICAgICAgICAgICA/ICdvYmplY3QnID09IHR5cGVvZiB0aGlzLm9iaiAmJiBudWxsICE9PSB0aGlzLm9ialxuICAgICAgICAgICAgICAgIDogdHlwZSA9PSB0eXBlb2YgdGhpcy5vYmpcbiAgICAgICAgLCBmdW5jdGlvbigpeyByZXR1cm4gJ2V4cGVjdGVkICcgKyBpKHRoaXMub2JqKSArICcgdG8gYmUgYScgKyBuICsgJyAnICsgdHlwZSB9XG4gICAgICAgICwgZnVuY3Rpb24oKXsgcmV0dXJuICdleHBlY3RlZCAnICsgaSh0aGlzLm9iaikgKyAnIG5vdCB0byBiZSBhJyArIG4gKyAnICcgKyB0eXBlIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBpbnN0YW5jZW9mXG4gICAgICB2YXIgbmFtZSA9IHR5cGUubmFtZSB8fCAnc3VwcGxpZWQgY29uc3RydWN0b3InO1xuICAgICAgdGhpcy5hc3NlcnQoXG4gICAgICAgICAgdGhpcy5vYmogaW5zdGFuY2VvZiB0eXBlXG4gICAgICAgICwgZnVuY3Rpb24oKXsgcmV0dXJuICdleHBlY3RlZCAnICsgaSh0aGlzLm9iaikgKyAnIHRvIGJlIGFuIGluc3RhbmNlIG9mICcgKyBuYW1lIH1cbiAgICAgICAgLCBmdW5jdGlvbigpeyByZXR1cm4gJ2V4cGVjdGVkICcgKyBpKHRoaXMub2JqKSArICcgbm90IHRvIGJlIGFuIGluc3RhbmNlIG9mICcgKyBuYW1lIH0pO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIC8qKlxuICAgKiBBc3NlcnQgbnVtZXJpYyB2YWx1ZSBhYm92ZSBfbl8uXG4gICAqXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBuXG4gICAqIEBhcGkgcHVibGljXG4gICAqL1xuXG4gIEFzc2VydGlvbi5wcm90b3R5cGUuZ3JlYXRlclRoYW4gPVxuICBBc3NlcnRpb24ucHJvdG90eXBlLmFib3ZlID0gZnVuY3Rpb24gKG4pIHtcbiAgICB0aGlzLmFzc2VydChcbiAgICAgICAgdGhpcy5vYmogPiBuXG4gICAgICAsIGZ1bmN0aW9uKCl7IHJldHVybiAnZXhwZWN0ZWQgJyArIGkodGhpcy5vYmopICsgJyB0byBiZSBhYm92ZSAnICsgbiB9XG4gICAgICAsIGZ1bmN0aW9uKCl7IHJldHVybiAnZXhwZWN0ZWQgJyArIGkodGhpcy5vYmopICsgJyB0byBiZSBiZWxvdyAnICsgbiB9KTtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICAvKipcbiAgICogQXNzZXJ0IG51bWVyaWMgdmFsdWUgYmVsb3cgX25fLlxuICAgKlxuICAgKiBAcGFyYW0ge051bWJlcn0gblxuICAgKiBAYXBpIHB1YmxpY1xuICAgKi9cblxuICBBc3NlcnRpb24ucHJvdG90eXBlLmxlc3NUaGFuID1cbiAgQXNzZXJ0aW9uLnByb3RvdHlwZS5iZWxvdyA9IGZ1bmN0aW9uIChuKSB7XG4gICAgdGhpcy5hc3NlcnQoXG4gICAgICAgIHRoaXMub2JqIDwgblxuICAgICAgLCBmdW5jdGlvbigpeyByZXR1cm4gJ2V4cGVjdGVkICcgKyBpKHRoaXMub2JqKSArICcgdG8gYmUgYmVsb3cgJyArIG4gfVxuICAgICAgLCBmdW5jdGlvbigpeyByZXR1cm4gJ2V4cGVjdGVkICcgKyBpKHRoaXMub2JqKSArICcgdG8gYmUgYWJvdmUgJyArIG4gfSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIEFzc2VydCBzdHJpbmcgdmFsdWUgbWF0Y2hlcyBfcmVnZXhwXy5cbiAgICpcbiAgICogQHBhcmFtIHtSZWdFeHB9IHJlZ2V4cFxuICAgKiBAYXBpIHB1YmxpY1xuICAgKi9cblxuICBBc3NlcnRpb24ucHJvdG90eXBlLm1hdGNoID0gZnVuY3Rpb24gKHJlZ2V4cCkge1xuICAgIHRoaXMuYXNzZXJ0KFxuICAgICAgICByZWdleHAuZXhlYyh0aGlzLm9iailcbiAgICAgICwgZnVuY3Rpb24oKXsgcmV0dXJuICdleHBlY3RlZCAnICsgaSh0aGlzLm9iaikgKyAnIHRvIG1hdGNoICcgKyByZWdleHAgfVxuICAgICAgLCBmdW5jdGlvbigpeyByZXR1cm4gJ2V4cGVjdGVkICcgKyBpKHRoaXMub2JqKSArICcgbm90IHRvIG1hdGNoICcgKyByZWdleHAgfSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIEFzc2VydCBwcm9wZXJ0eSBcImxlbmd0aFwiIGV4aXN0cyBhbmQgaGFzIHZhbHVlIG9mIF9uXy5cbiAgICpcbiAgICogQHBhcmFtIHtOdW1iZXJ9IG5cbiAgICogQGFwaSBwdWJsaWNcbiAgICovXG5cbiAgQXNzZXJ0aW9uLnByb3RvdHlwZS5sZW5ndGggPSBmdW5jdGlvbiAobikge1xuICAgIGV4cGVjdCh0aGlzLm9iaikudG8uaGF2ZS5wcm9wZXJ0eSgnbGVuZ3RoJyk7XG4gICAgdmFyIGxlbiA9IHRoaXMub2JqLmxlbmd0aDtcbiAgICB0aGlzLmFzc2VydChcbiAgICAgICAgbiA9PSBsZW5cbiAgICAgICwgZnVuY3Rpb24oKXsgcmV0dXJuICdleHBlY3RlZCAnICsgaSh0aGlzLm9iaikgKyAnIHRvIGhhdmUgYSBsZW5ndGggb2YgJyArIG4gKyAnIGJ1dCBnb3QgJyArIGxlbiB9XG4gICAgICAsIGZ1bmN0aW9uKCl7IHJldHVybiAnZXhwZWN0ZWQgJyArIGkodGhpcy5vYmopICsgJyB0byBub3QgaGF2ZSBhIGxlbmd0aCBvZiAnICsgbGVuIH0pO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIC8qKlxuICAgKiBBc3NlcnQgcHJvcGVydHkgX25hbWVfIGV4aXN0cywgd2l0aCBvcHRpb25hbCBfdmFsXy5cbiAgICpcbiAgICogQHBhcmFtIHtTdHJpbmd9IG5hbWVcbiAgICogQHBhcmFtIHtNaXhlZH0gdmFsXG4gICAqIEBhcGkgcHVibGljXG4gICAqL1xuXG4gIEFzc2VydGlvbi5wcm90b3R5cGUucHJvcGVydHkgPSBmdW5jdGlvbiAobmFtZSwgdmFsKSB7XG4gICAgaWYgKHRoaXMuZmxhZ3Mub3duKSB7XG4gICAgICB0aGlzLmFzc2VydChcbiAgICAgICAgICBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodGhpcy5vYmosIG5hbWUpXG4gICAgICAgICwgZnVuY3Rpb24oKXsgcmV0dXJuICdleHBlY3RlZCAnICsgaSh0aGlzLm9iaikgKyAnIHRvIGhhdmUgb3duIHByb3BlcnR5ICcgKyBpKG5hbWUpIH1cbiAgICAgICAgLCBmdW5jdGlvbigpeyByZXR1cm4gJ2V4cGVjdGVkICcgKyBpKHRoaXMub2JqKSArICcgdG8gbm90IGhhdmUgb3duIHByb3BlcnR5ICcgKyBpKG5hbWUpIH0pO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuZmxhZ3Mubm90ICYmIHVuZGVmaW5lZCAhPT0gdmFsKSB7XG4gICAgICBpZiAodW5kZWZpbmVkID09PSB0aGlzLm9ialtuYW1lXSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoaSh0aGlzLm9iaikgKyAnIGhhcyBubyBwcm9wZXJ0eSAnICsgaShuYW1lKSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhciBoYXNQcm9wO1xuICAgICAgdHJ5IHtcbiAgICAgICAgaGFzUHJvcCA9IG5hbWUgaW4gdGhpcy5vYmpcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgaGFzUHJvcCA9IHVuZGVmaW5lZCAhPT0gdGhpcy5vYmpbbmFtZV1cbiAgICAgIH1cblxuICAgICAgdGhpcy5hc3NlcnQoXG4gICAgICAgICAgaGFzUHJvcFxuICAgICAgICAsIGZ1bmN0aW9uKCl7IHJldHVybiAnZXhwZWN0ZWQgJyArIGkodGhpcy5vYmopICsgJyB0byBoYXZlIGEgcHJvcGVydHkgJyArIGkobmFtZSkgfVxuICAgICAgICAsIGZ1bmN0aW9uKCl7IHJldHVybiAnZXhwZWN0ZWQgJyArIGkodGhpcy5vYmopICsgJyB0byBub3QgaGF2ZSBhIHByb3BlcnR5ICcgKyBpKG5hbWUpIH0pO1xuICAgIH1cblxuICAgIGlmICh1bmRlZmluZWQgIT09IHZhbCkge1xuICAgICAgdGhpcy5hc3NlcnQoXG4gICAgICAgICAgdmFsID09PSB0aGlzLm9ialtuYW1lXVxuICAgICAgICAsIGZ1bmN0aW9uKCl7IHJldHVybiAnZXhwZWN0ZWQgJyArIGkodGhpcy5vYmopICsgJyB0byBoYXZlIGEgcHJvcGVydHkgJyArIGkobmFtZSlcbiAgICAgICAgICArICcgb2YgJyArIGkodmFsKSArICcsIGJ1dCBnb3QgJyArIGkodGhpcy5vYmpbbmFtZV0pIH1cbiAgICAgICAgLCBmdW5jdGlvbigpeyByZXR1cm4gJ2V4cGVjdGVkICcgKyBpKHRoaXMub2JqKSArICcgdG8gbm90IGhhdmUgYSBwcm9wZXJ0eSAnICsgaShuYW1lKVxuICAgICAgICAgICsgJyBvZiAnICsgaSh2YWwpIH0pO1xuICAgIH1cblxuICAgIHRoaXMub2JqID0gdGhpcy5vYmpbbmFtZV07XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIEFzc2VydCB0aGF0IHRoZSBhcnJheSBjb250YWlucyBfb2JqXyBvciBzdHJpbmcgY29udGFpbnMgX29ial8uXG4gICAqXG4gICAqIEBwYXJhbSB7TWl4ZWR9IG9ianxzdHJpbmdcbiAgICogQGFwaSBwdWJsaWNcbiAgICovXG5cbiAgQXNzZXJ0aW9uLnByb3RvdHlwZS5zdHJpbmcgPVxuICBBc3NlcnRpb24ucHJvdG90eXBlLmNvbnRhaW4gPSBmdW5jdGlvbiAob2JqKSB7XG4gICAgaWYgKCdzdHJpbmcnID09IHR5cGVvZiB0aGlzLm9iaikge1xuICAgICAgdGhpcy5hc3NlcnQoXG4gICAgICAgICAgfnRoaXMub2JqLmluZGV4T2Yob2JqKVxuICAgICAgICAsIGZ1bmN0aW9uKCl7IHJldHVybiAnZXhwZWN0ZWQgJyArIGkodGhpcy5vYmopICsgJyB0byBjb250YWluICcgKyBpKG9iaikgfVxuICAgICAgICAsIGZ1bmN0aW9uKCl7IHJldHVybiAnZXhwZWN0ZWQgJyArIGkodGhpcy5vYmopICsgJyB0byBub3QgY29udGFpbiAnICsgaShvYmopIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmFzc2VydChcbiAgICAgICAgICB+aW5kZXhPZih0aGlzLm9iaiwgb2JqKVxuICAgICAgICAsIGZ1bmN0aW9uKCl7IHJldHVybiAnZXhwZWN0ZWQgJyArIGkodGhpcy5vYmopICsgJyB0byBjb250YWluICcgKyBpKG9iaikgfVxuICAgICAgICAsIGZ1bmN0aW9uKCl7IHJldHVybiAnZXhwZWN0ZWQgJyArIGkodGhpcy5vYmopICsgJyB0byBub3QgY29udGFpbiAnICsgaShvYmopIH0pO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICAvKipcbiAgICogQXNzZXJ0IGV4YWN0IGtleXMgb3IgaW5jbHVzaW9uIG9mIGtleXMgYnkgdXNpbmdcbiAgICogdGhlIGAub3duYCBtb2RpZmllci5cbiAgICpcbiAgICogQHBhcmFtIHtBcnJheXxTdHJpbmcgLi4ufSBrZXlzXG4gICAqIEBhcGkgcHVibGljXG4gICAqL1xuXG4gIEFzc2VydGlvbi5wcm90b3R5cGUua2V5ID1cbiAgQXNzZXJ0aW9uLnByb3RvdHlwZS5rZXlzID0gZnVuY3Rpb24gKCRrZXlzKSB7XG4gICAgdmFyIHN0clxuICAgICAgLCBvayA9IHRydWU7XG5cbiAgICAka2V5cyA9IGlzQXJyYXkoJGtleXMpXG4gICAgICA/ICRrZXlzXG4gICAgICA6IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7XG5cbiAgICBpZiAoISRrZXlzLmxlbmd0aCkgdGhyb3cgbmV3IEVycm9yKCdrZXlzIHJlcXVpcmVkJyk7XG5cbiAgICB2YXIgYWN0dWFsID0ga2V5cyh0aGlzLm9iailcbiAgICAgICwgbGVuID0gJGtleXMubGVuZ3RoO1xuXG4gICAgLy8gSW5jbHVzaW9uXG4gICAgb2sgPSBldmVyeSgka2V5cywgZnVuY3Rpb24gKGtleSkge1xuICAgICAgcmV0dXJuIH5pbmRleE9mKGFjdHVhbCwga2V5KTtcbiAgICB9KTtcblxuICAgIC8vIFN0cmljdFxuICAgIGlmICghdGhpcy5mbGFncy5ub3QgJiYgdGhpcy5mbGFncy5vbmx5KSB7XG4gICAgICBvayA9IG9rICYmICRrZXlzLmxlbmd0aCA9PSBhY3R1YWwubGVuZ3RoO1xuICAgIH1cblxuICAgIC8vIEtleSBzdHJpbmdcbiAgICBpZiAobGVuID4gMSkge1xuICAgICAgJGtleXMgPSBtYXAoJGtleXMsIGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgcmV0dXJuIGkoa2V5KTtcbiAgICAgIH0pO1xuICAgICAgdmFyIGxhc3QgPSAka2V5cy5wb3AoKTtcbiAgICAgIHN0ciA9ICRrZXlzLmpvaW4oJywgJykgKyAnLCBhbmQgJyArIGxhc3Q7XG4gICAgfSBlbHNlIHtcbiAgICAgIHN0ciA9IGkoJGtleXNbMF0pO1xuICAgIH1cblxuICAgIC8vIEZvcm1cbiAgICBzdHIgPSAobGVuID4gMSA/ICdrZXlzICcgOiAna2V5ICcpICsgc3RyO1xuXG4gICAgLy8gSGF2ZSAvIGluY2x1ZGVcbiAgICBzdHIgPSAoIXRoaXMuZmxhZ3Mub25seSA/ICdpbmNsdWRlICcgOiAnb25seSBoYXZlICcpICsgc3RyO1xuXG4gICAgLy8gQXNzZXJ0aW9uXG4gICAgdGhpcy5hc3NlcnQoXG4gICAgICAgIG9rXG4gICAgICAsIGZ1bmN0aW9uKCl7IHJldHVybiAnZXhwZWN0ZWQgJyArIGkodGhpcy5vYmopICsgJyB0byAnICsgc3RyIH1cbiAgICAgICwgZnVuY3Rpb24oKXsgcmV0dXJuICdleHBlY3RlZCAnICsgaSh0aGlzLm9iaikgKyAnIHRvIG5vdCAnICsgc3RyIH0pO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIEFzc2VydCBhIGZhaWx1cmUuXG4gICAqXG4gICAqIEBwYXJhbSB7U3RyaW5nIC4uLn0gY3VzdG9tIG1lc3NhZ2VcbiAgICogQGFwaSBwdWJsaWNcbiAgICovXG4gIEFzc2VydGlvbi5wcm90b3R5cGUuZmFpbCA9IGZ1bmN0aW9uIChtc2cpIHtcbiAgICB2YXIgZXJyb3IgPSBmdW5jdGlvbigpIHsgcmV0dXJuIG1zZyB8fCBcImV4cGxpY2l0IGZhaWx1cmVcIjsgfVxuICAgIHRoaXMuYXNzZXJ0KGZhbHNlLCBlcnJvciwgZXJyb3IpO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIC8qKlxuICAgKiBGdW5jdGlvbiBiaW5kIGltcGxlbWVudGF0aW9uLlxuICAgKi9cblxuICBmdW5jdGlvbiBiaW5kIChmbiwgc2NvcGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIGZuLmFwcGx5KHNjb3BlLCBhcmd1bWVudHMpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBBcnJheSBldmVyeSBjb21wYXRpYmlsaXR5XG4gICAqXG4gICAqIEBzZWUgYml0Lmx5LzVGcTFOMlxuICAgKiBAYXBpIHB1YmxpY1xuICAgKi9cblxuICBmdW5jdGlvbiBldmVyeSAoYXJyLCBmbiwgdGhpc09iaikge1xuICAgIHZhciBzY29wZSA9IHRoaXNPYmogfHwgZ2xvYmFsO1xuICAgIGZvciAodmFyIGkgPSAwLCBqID0gYXJyLmxlbmd0aDsgaSA8IGo7ICsraSkge1xuICAgICAgaWYgKCFmbi5jYWxsKHNjb3BlLCBhcnJbaV0sIGksIGFycikpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBcnJheSBpbmRleE9mIGNvbXBhdGliaWxpdHkuXG4gICAqXG4gICAqIEBzZWUgYml0Lmx5L2E1RHhhMlxuICAgKiBAYXBpIHB1YmxpY1xuICAgKi9cblxuICBmdW5jdGlvbiBpbmRleE9mIChhcnIsIG8sIGkpIHtcbiAgICBpZiAoQXJyYXkucHJvdG90eXBlLmluZGV4T2YpIHtcbiAgICAgIHJldHVybiBBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKGFyciwgbywgaSk7XG4gICAgfVxuXG4gICAgaWYgKGFyci5sZW5ndGggPT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIC0xO1xuICAgIH1cblxuICAgIGZvciAodmFyIGogPSBhcnIubGVuZ3RoLCBpID0gaSA8IDAgPyBpICsgaiA8IDAgPyAwIDogaSArIGogOiBpIHx8IDBcbiAgICAgICAgOyBpIDwgaiAmJiBhcnJbaV0gIT09IG87IGkrKyk7XG5cbiAgICByZXR1cm4gaiA8PSBpID8gLTEgOiBpO1xuICB9XG5cbiAgLy8gaHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vMTA0NDEyOC9cbiAgdmFyIGdldE91dGVySFRNTCA9IGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICBpZiAoJ291dGVySFRNTCcgaW4gZWxlbWVudCkgcmV0dXJuIGVsZW1lbnQub3V0ZXJIVE1MO1xuICAgIHZhciBucyA9IFwiaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbFwiO1xuICAgIHZhciBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMobnMsICdfJyk7XG4gICAgdmFyIHhtbFNlcmlhbGl6ZXIgPSBuZXcgWE1MU2VyaWFsaXplcigpO1xuICAgIHZhciBodG1sO1xuICAgIGlmIChkb2N1bWVudC54bWxWZXJzaW9uKSB7XG4gICAgICByZXR1cm4geG1sU2VyaWFsaXplci5zZXJpYWxpemVUb1N0cmluZyhlbGVtZW50KTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGVsZW1lbnQuY2xvbmVOb2RlKGZhbHNlKSk7XG4gICAgICBodG1sID0gY29udGFpbmVyLmlubmVySFRNTC5yZXBsYWNlKCc+PCcsICc+JyArIGVsZW1lbnQuaW5uZXJIVE1MICsgJzwnKTtcbiAgICAgIGNvbnRhaW5lci5pbm5lckhUTUwgPSAnJztcbiAgICAgIHJldHVybiBodG1sO1xuICAgIH1cbiAgfTtcblxuICAvLyBSZXR1cm5zIHRydWUgaWYgb2JqZWN0IGlzIGEgRE9NIGVsZW1lbnQuXG4gIHZhciBpc0RPTUVsZW1lbnQgPSBmdW5jdGlvbiAob2JqZWN0KSB7XG4gICAgaWYgKHR5cGVvZiBIVE1MRWxlbWVudCA9PT0gJ29iamVjdCcpIHtcbiAgICAgIHJldHVybiBvYmplY3QgaW5zdGFuY2VvZiBIVE1MRWxlbWVudDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG9iamVjdCAmJlxuICAgICAgICB0eXBlb2Ygb2JqZWN0ID09PSAnb2JqZWN0JyAmJlxuICAgICAgICBvYmplY3Qubm9kZVR5cGUgPT09IDEgJiZcbiAgICAgICAgdHlwZW9mIG9iamVjdC5ub2RlTmFtZSA9PT0gJ3N0cmluZyc7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBJbnNwZWN0cyBhbiBvYmplY3QuXG4gICAqXG4gICAqIEBzZWUgdGFrZW4gZnJvbSBub2RlLmpzIGB1dGlsYCBtb2R1bGUgKGNvcHlyaWdodCBKb3llbnQsIE1JVCBsaWNlbnNlKVxuICAgKiBAYXBpIHByaXZhdGVcbiAgICovXG5cbiAgZnVuY3Rpb24gaSAob2JqLCBzaG93SGlkZGVuLCBkZXB0aCkge1xuICAgIHZhciBzZWVuID0gW107XG5cbiAgICBmdW5jdGlvbiBzdHlsaXplIChzdHIpIHtcbiAgICAgIHJldHVybiBzdHI7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZm9ybWF0ICh2YWx1ZSwgcmVjdXJzZVRpbWVzKSB7XG4gICAgICAvLyBQcm92aWRlIGEgaG9vayBmb3IgdXNlci1zcGVjaWZpZWQgaW5zcGVjdCBmdW5jdGlvbnMuXG4gICAgICAvLyBDaGVjayB0aGF0IHZhbHVlIGlzIGFuIG9iamVjdCB3aXRoIGFuIGluc3BlY3QgZnVuY3Rpb24gb24gaXRcbiAgICAgIGlmICh2YWx1ZSAmJiB0eXBlb2YgdmFsdWUuaW5zcGVjdCA9PT0gJ2Z1bmN0aW9uJyAmJlxuICAgICAgICAgIC8vIEZpbHRlciBvdXQgdGhlIHV0aWwgbW9kdWxlLCBpdCdzIGluc3BlY3QgZnVuY3Rpb24gaXMgc3BlY2lhbFxuICAgICAgICAgIHZhbHVlICE9PSBleHBvcnRzICYmXG4gICAgICAgICAgLy8gQWxzbyBmaWx0ZXIgb3V0IGFueSBwcm90b3R5cGUgb2JqZWN0cyB1c2luZyB0aGUgY2lyY3VsYXIgY2hlY2suXG4gICAgICAgICAgISh2YWx1ZS5jb25zdHJ1Y3RvciAmJiB2YWx1ZS5jb25zdHJ1Y3Rvci5wcm90b3R5cGUgPT09IHZhbHVlKSkge1xuICAgICAgICByZXR1cm4gdmFsdWUuaW5zcGVjdChyZWN1cnNlVGltZXMpO1xuICAgICAgfVxuXG4gICAgICAvLyBQcmltaXRpdmUgdHlwZXMgY2Fubm90IGhhdmUgcHJvcGVydGllc1xuICAgICAgc3dpdGNoICh0eXBlb2YgdmFsdWUpIHtcbiAgICAgICAgY2FzZSAndW5kZWZpbmVkJzpcbiAgICAgICAgICByZXR1cm4gc3R5bGl6ZSgndW5kZWZpbmVkJywgJ3VuZGVmaW5lZCcpO1xuXG4gICAgICAgIGNhc2UgJ3N0cmluZyc6XG4gICAgICAgICAgdmFyIHNpbXBsZSA9ICdcXCcnICsganNvbi5zdHJpbmdpZnkodmFsdWUpLnJlcGxhY2UoL15cInxcIiQvZywgJycpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvJy9nLCBcIlxcXFwnXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvXFxcXFwiL2csICdcIicpICsgJ1xcJyc7XG4gICAgICAgICAgcmV0dXJuIHN0eWxpemUoc2ltcGxlLCAnc3RyaW5nJyk7XG5cbiAgICAgICAgY2FzZSAnbnVtYmVyJzpcbiAgICAgICAgICByZXR1cm4gc3R5bGl6ZSgnJyArIHZhbHVlLCAnbnVtYmVyJyk7XG5cbiAgICAgICAgY2FzZSAnYm9vbGVhbic6XG4gICAgICAgICAgcmV0dXJuIHN0eWxpemUoJycgKyB2YWx1ZSwgJ2Jvb2xlYW4nKTtcbiAgICAgIH1cbiAgICAgIC8vIEZvciBzb21lIHJlYXNvbiB0eXBlb2YgbnVsbCBpcyBcIm9iamVjdFwiLCBzbyBzcGVjaWFsIGNhc2UgaGVyZS5cbiAgICAgIGlmICh2YWx1ZSA9PT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gc3R5bGl6ZSgnbnVsbCcsICdudWxsJyk7XG4gICAgICB9XG5cbiAgICAgIGlmIChpc0RPTUVsZW1lbnQodmFsdWUpKSB7XG4gICAgICAgIHJldHVybiBnZXRPdXRlckhUTUwodmFsdWUpO1xuICAgICAgfVxuXG4gICAgICAvLyBMb29rIHVwIHRoZSBrZXlzIG9mIHRoZSBvYmplY3QuXG4gICAgICB2YXIgdmlzaWJsZV9rZXlzID0ga2V5cyh2YWx1ZSk7XG4gICAgICB2YXIgJGtleXMgPSBzaG93SGlkZGVuID8gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXModmFsdWUpIDogdmlzaWJsZV9rZXlzO1xuXG4gICAgICAvLyBGdW5jdGlvbnMgd2l0aG91dCBwcm9wZXJ0aWVzIGNhbiBiZSBzaG9ydGN1dHRlZC5cbiAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdmdW5jdGlvbicgJiYgJGtleXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIGlmIChpc1JlZ0V4cCh2YWx1ZSkpIHtcbiAgICAgICAgICByZXR1cm4gc3R5bGl6ZSgnJyArIHZhbHVlLCAncmVnZXhwJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdmFyIG5hbWUgPSB2YWx1ZS5uYW1lID8gJzogJyArIHZhbHVlLm5hbWUgOiAnJztcbiAgICAgICAgICByZXR1cm4gc3R5bGl6ZSgnW0Z1bmN0aW9uJyArIG5hbWUgKyAnXScsICdzcGVjaWFsJyk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gRGF0ZXMgd2l0aG91dCBwcm9wZXJ0aWVzIGNhbiBiZSBzaG9ydGN1dHRlZFxuICAgICAgaWYgKGlzRGF0ZSh2YWx1ZSkgJiYgJGtleXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHJldHVybiBzdHlsaXplKHZhbHVlLnRvVVRDU3RyaW5nKCksICdkYXRlJyk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIEVycm9yIG9iamVjdHMgY2FuIGJlIHNob3J0Y3V0dGVkXG4gICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgICByZXR1cm4gc3R5bGl6ZShcIltcIit2YWx1ZS50b1N0cmluZygpK1wiXVwiLCAnRXJyb3InKTtcbiAgICAgIH1cblxuICAgICAgdmFyIGJhc2UsIHR5cGUsIGJyYWNlcztcbiAgICAgIC8vIERldGVybWluZSB0aGUgb2JqZWN0IHR5cGVcbiAgICAgIGlmIChpc0FycmF5KHZhbHVlKSkge1xuICAgICAgICB0eXBlID0gJ0FycmF5JztcbiAgICAgICAgYnJhY2VzID0gWydbJywgJ10nXTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHR5cGUgPSAnT2JqZWN0JztcbiAgICAgICAgYnJhY2VzID0gWyd7JywgJ30nXTtcbiAgICAgIH1cblxuICAgICAgLy8gTWFrZSBmdW5jdGlvbnMgc2F5IHRoYXQgdGhleSBhcmUgZnVuY3Rpb25zXG4gICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHZhciBuID0gdmFsdWUubmFtZSA/ICc6ICcgKyB2YWx1ZS5uYW1lIDogJyc7XG4gICAgICAgIGJhc2UgPSAoaXNSZWdFeHAodmFsdWUpKSA/ICcgJyArIHZhbHVlIDogJyBbRnVuY3Rpb24nICsgbiArICddJztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGJhc2UgPSAnJztcbiAgICAgIH1cblxuICAgICAgLy8gTWFrZSBkYXRlcyB3aXRoIHByb3BlcnRpZXMgZmlyc3Qgc2F5IHRoZSBkYXRlXG4gICAgICBpZiAoaXNEYXRlKHZhbHVlKSkge1xuICAgICAgICBiYXNlID0gJyAnICsgdmFsdWUudG9VVENTdHJpbmcoKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCRrZXlzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICByZXR1cm4gYnJhY2VzWzBdICsgYmFzZSArIGJyYWNlc1sxXTtcbiAgICAgIH1cblxuICAgICAgaWYgKHJlY3Vyc2VUaW1lcyA8IDApIHtcbiAgICAgICAgaWYgKGlzUmVnRXhwKHZhbHVlKSkge1xuICAgICAgICAgIHJldHVybiBzdHlsaXplKCcnICsgdmFsdWUsICdyZWdleHAnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gc3R5bGl6ZSgnW09iamVjdF0nLCAnc3BlY2lhbCcpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHNlZW4ucHVzaCh2YWx1ZSk7XG5cbiAgICAgIHZhciBvdXRwdXQgPSBtYXAoJGtleXMsIGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgdmFyIG5hbWUsIHN0cjtcbiAgICAgICAgaWYgKHZhbHVlLl9fbG9va3VwR2V0dGVyX18pIHtcbiAgICAgICAgICBpZiAodmFsdWUuX19sb29rdXBHZXR0ZXJfXyhrZXkpKSB7XG4gICAgICAgICAgICBpZiAodmFsdWUuX19sb29rdXBTZXR0ZXJfXyhrZXkpKSB7XG4gICAgICAgICAgICAgIHN0ciA9IHN0eWxpemUoJ1tHZXR0ZXIvU2V0dGVyXScsICdzcGVjaWFsJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBzdHIgPSBzdHlsaXplKCdbR2V0dGVyXScsICdzcGVjaWFsJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmICh2YWx1ZS5fX2xvb2t1cFNldHRlcl9fKGtleSkpIHtcbiAgICAgICAgICAgICAgc3RyID0gc3R5bGl6ZSgnW1NldHRlcl0nLCAnc3BlY2lhbCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoaW5kZXhPZih2aXNpYmxlX2tleXMsIGtleSkgPCAwKSB7XG4gICAgICAgICAgbmFtZSA9ICdbJyArIGtleSArICddJztcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXN0cikge1xuICAgICAgICAgIGlmIChpbmRleE9mKHNlZW4sIHZhbHVlW2tleV0pIDwgMCkge1xuICAgICAgICAgICAgaWYgKHJlY3Vyc2VUaW1lcyA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICBzdHIgPSBmb3JtYXQodmFsdWVba2V5XSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBzdHIgPSBmb3JtYXQodmFsdWVba2V5XSwgcmVjdXJzZVRpbWVzIC0gMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc3RyLmluZGV4T2YoJ1xcbicpID4gLTEpIHtcbiAgICAgICAgICAgICAgaWYgKGlzQXJyYXkodmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgc3RyID0gbWFwKHN0ci5zcGxpdCgnXFxuJyksIGZ1bmN0aW9uIChsaW5lKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gJyAgJyArIGxpbmU7XG4gICAgICAgICAgICAgICAgfSkuam9pbignXFxuJykuc3Vic3RyKDIpO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHN0ciA9ICdcXG4nICsgbWFwKHN0ci5zcGxpdCgnXFxuJyksIGZ1bmN0aW9uIChsaW5lKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gJyAgICcgKyBsaW5lO1xuICAgICAgICAgICAgICAgIH0pLmpvaW4oJ1xcbicpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHN0ciA9IHN0eWxpemUoJ1tDaXJjdWxhcl0nLCAnc3BlY2lhbCcpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIG5hbWUgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgaWYgKHR5cGUgPT09ICdBcnJheScgJiYga2V5Lm1hdGNoKC9eXFxkKyQvKSkge1xuICAgICAgICAgICAgcmV0dXJuIHN0cjtcbiAgICAgICAgICB9XG4gICAgICAgICAgbmFtZSA9IGpzb24uc3RyaW5naWZ5KCcnICsga2V5KTtcbiAgICAgICAgICBpZiAobmFtZS5tYXRjaCgvXlwiKFthLXpBLVpfXVthLXpBLVpfMC05XSopXCIkLykpIHtcbiAgICAgICAgICAgIG5hbWUgPSBuYW1lLnN1YnN0cigxLCBuYW1lLmxlbmd0aCAtIDIpO1xuICAgICAgICAgICAgbmFtZSA9IHN0eWxpemUobmFtZSwgJ25hbWUnKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbmFtZSA9IG5hbWUucmVwbGFjZSgvJy9nLCBcIlxcXFwnXCIpXG4gICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9cXFxcXCIvZywgJ1wiJylcbiAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoLyheXCJ8XCIkKS9nLCBcIidcIik7XG4gICAgICAgICAgICBuYW1lID0gc3R5bGl6ZShuYW1lLCAnc3RyaW5nJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG5hbWUgKyAnOiAnICsgc3RyO1xuICAgICAgfSk7XG5cbiAgICAgIHNlZW4ucG9wKCk7XG5cbiAgICAgIHZhciBudW1MaW5lc0VzdCA9IDA7XG4gICAgICB2YXIgbGVuZ3RoID0gcmVkdWNlKG91dHB1dCwgZnVuY3Rpb24gKHByZXYsIGN1cikge1xuICAgICAgICBudW1MaW5lc0VzdCsrO1xuICAgICAgICBpZiAoaW5kZXhPZihjdXIsICdcXG4nKSA+PSAwKSBudW1MaW5lc0VzdCsrO1xuICAgICAgICByZXR1cm4gcHJldiArIGN1ci5sZW5ndGggKyAxO1xuICAgICAgfSwgMCk7XG5cbiAgICAgIGlmIChsZW5ndGggPiA1MCkge1xuICAgICAgICBvdXRwdXQgPSBicmFjZXNbMF0gK1xuICAgICAgICAgICAgICAgICAoYmFzZSA9PT0gJycgPyAnJyA6IGJhc2UgKyAnXFxuICcpICtcbiAgICAgICAgICAgICAgICAgJyAnICtcbiAgICAgICAgICAgICAgICAgb3V0cHV0LmpvaW4oJyxcXG4gICcpICtcbiAgICAgICAgICAgICAgICAgJyAnICtcbiAgICAgICAgICAgICAgICAgYnJhY2VzWzFdO1xuXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBvdXRwdXQgPSBicmFjZXNbMF0gKyBiYXNlICsgJyAnICsgb3V0cHV0LmpvaW4oJywgJykgKyAnICcgKyBicmFjZXNbMV07XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgfVxuICAgIHJldHVybiBmb3JtYXQob2JqLCAodHlwZW9mIGRlcHRoID09PSAndW5kZWZpbmVkJyA/IDIgOiBkZXB0aCkpO1xuICB9XG5cbiAgZXhwZWN0LnN0cmluZ2lmeSA9IGk7XG5cbiAgZnVuY3Rpb24gaXNBcnJheSAoYXIpIHtcbiAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGFyKSA9PT0gJ1tvYmplY3QgQXJyYXldJztcbiAgfVxuXG4gIGZ1bmN0aW9uIGlzUmVnRXhwKHJlKSB7XG4gICAgdmFyIHM7XG4gICAgdHJ5IHtcbiAgICAgIHMgPSAnJyArIHJlO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmUgaW5zdGFuY2VvZiBSZWdFeHAgfHwgLy8gZWFzeSBjYXNlXG4gICAgICAgICAgIC8vIGR1Y2stdHlwZSBmb3IgY29udGV4dC1zd2l0Y2hpbmcgZXZhbGN4IGNhc2VcbiAgICAgICAgICAgdHlwZW9mKHJlKSA9PT0gJ2Z1bmN0aW9uJyAmJlxuICAgICAgICAgICByZS5jb25zdHJ1Y3Rvci5uYW1lID09PSAnUmVnRXhwJyAmJlxuICAgICAgICAgICByZS5jb21waWxlICYmXG4gICAgICAgICAgIHJlLnRlc3QgJiZcbiAgICAgICAgICAgcmUuZXhlYyAmJlxuICAgICAgICAgICBzLm1hdGNoKC9eXFwvLipcXC9bZ2ltXXswLDN9JC8pO1xuICB9XG5cbiAgZnVuY3Rpb24gaXNEYXRlKGQpIHtcbiAgICByZXR1cm4gZCBpbnN0YW5jZW9mIERhdGU7XG4gIH1cblxuICBmdW5jdGlvbiBrZXlzIChvYmopIHtcbiAgICBpZiAoT2JqZWN0LmtleXMpIHtcbiAgICAgIHJldHVybiBPYmplY3Qua2V5cyhvYmopO1xuICAgIH1cblxuICAgIHZhciBrZXlzID0gW107XG5cbiAgICBmb3IgKHZhciBpIGluIG9iaikge1xuICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGkpKSB7XG4gICAgICAgIGtleXMucHVzaChpKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4ga2V5cztcbiAgfVxuXG4gIGZ1bmN0aW9uIG1hcCAoYXJyLCBtYXBwZXIsIHRoYXQpIHtcbiAgICBpZiAoQXJyYXkucHJvdG90eXBlLm1hcCkge1xuICAgICAgcmV0dXJuIEFycmF5LnByb3RvdHlwZS5tYXAuY2FsbChhcnIsIG1hcHBlciwgdGhhdCk7XG4gICAgfVxuXG4gICAgdmFyIG90aGVyPSBuZXcgQXJyYXkoYXJyLmxlbmd0aCk7XG5cbiAgICBmb3IgKHZhciBpPSAwLCBuID0gYXJyLmxlbmd0aDsgaTxuOyBpKyspXG4gICAgICBpZiAoaSBpbiBhcnIpXG4gICAgICAgIG90aGVyW2ldID0gbWFwcGVyLmNhbGwodGhhdCwgYXJyW2ldLCBpLCBhcnIpO1xuXG4gICAgcmV0dXJuIG90aGVyO1xuICB9XG5cbiAgZnVuY3Rpb24gcmVkdWNlIChhcnIsIGZ1bikge1xuICAgIGlmIChBcnJheS5wcm90b3R5cGUucmVkdWNlKSB7XG4gICAgICByZXR1cm4gQXJyYXkucHJvdG90eXBlLnJlZHVjZS5hcHBseShcbiAgICAgICAgICBhcnJcbiAgICAgICAgLCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpXG4gICAgICApO1xuICAgIH1cblxuICAgIHZhciBsZW4gPSArdGhpcy5sZW5ndGg7XG5cbiAgICBpZiAodHlwZW9mIGZ1biAhPT0gXCJmdW5jdGlvblwiKVxuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigpO1xuXG4gICAgLy8gbm8gdmFsdWUgdG8gcmV0dXJuIGlmIG5vIGluaXRpYWwgdmFsdWUgYW5kIGFuIGVtcHR5IGFycmF5XG4gICAgaWYgKGxlbiA9PT0gMCAmJiBhcmd1bWVudHMubGVuZ3RoID09PSAxKVxuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigpO1xuXG4gICAgdmFyIGkgPSAwO1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID49IDIpIHtcbiAgICAgIHZhciBydiA9IGFyZ3VtZW50c1sxXTtcbiAgICB9IGVsc2Uge1xuICAgICAgZG8ge1xuICAgICAgICBpZiAoaSBpbiB0aGlzKSB7XG4gICAgICAgICAgcnYgPSB0aGlzW2krK107XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBpZiBhcnJheSBjb250YWlucyBubyB2YWx1ZXMsIG5vIGluaXRpYWwgdmFsdWUgdG8gcmV0dXJuXG4gICAgICAgIGlmICgrK2kgPj0gbGVuKVxuICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoKTtcbiAgICAgIH0gd2hpbGUgKHRydWUpO1xuICAgIH1cblxuICAgIGZvciAoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgIGlmIChpIGluIHRoaXMpXG4gICAgICAgIHJ2ID0gZnVuLmNhbGwobnVsbCwgcnYsIHRoaXNbaV0sIGksIHRoaXMpO1xuICAgIH1cblxuICAgIHJldHVybiBydjtcbiAgfVxuXG4gIC8qKlxuICAgKiBBc3NlcnRzIGRlZXAgZXF1YWxpdHlcbiAgICpcbiAgICogQHNlZSB0YWtlbiBmcm9tIG5vZGUuanMgYGFzc2VydGAgbW9kdWxlIChjb3B5cmlnaHQgSm95ZW50LCBNSVQgbGljZW5zZSlcbiAgICogQGFwaSBwcml2YXRlXG4gICAqL1xuXG4gIGV4cGVjdC5lcWwgPSBmdW5jdGlvbiBlcWwoYWN0dWFsLCBleHBlY3RlZCkge1xuICAgIC8vIDcuMS4gQWxsIGlkZW50aWNhbCB2YWx1ZXMgYXJlIGVxdWl2YWxlbnQsIGFzIGRldGVybWluZWQgYnkgPT09LlxuICAgIGlmIChhY3R1YWwgPT09IGV4cGVjdGVkKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGVsc2UgaWYgKCd1bmRlZmluZWQnICE9IHR5cGVvZiBCdWZmZXJcbiAgICAgICYmIEJ1ZmZlci5pc0J1ZmZlcihhY3R1YWwpICYmIEJ1ZmZlci5pc0J1ZmZlcihleHBlY3RlZCkpIHtcbiAgICAgIGlmIChhY3R1YWwubGVuZ3RoICE9IGV4cGVjdGVkLmxlbmd0aCkgcmV0dXJuIGZhbHNlO1xuXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFjdHVhbC5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoYWN0dWFsW2ldICE9PSBleHBlY3RlZFtpXSkgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdHJ1ZTtcblxuICAgICAgLy8gNy4yLiBJZiB0aGUgZXhwZWN0ZWQgdmFsdWUgaXMgYSBEYXRlIG9iamVjdCwgdGhlIGFjdHVhbCB2YWx1ZSBpc1xuICAgICAgLy8gZXF1aXZhbGVudCBpZiBpdCBpcyBhbHNvIGEgRGF0ZSBvYmplY3QgdGhhdCByZWZlcnMgdG8gdGhlIHNhbWUgdGltZS5cbiAgICB9IGVsc2UgaWYgKGFjdHVhbCBpbnN0YW5jZW9mIERhdGUgJiYgZXhwZWN0ZWQgaW5zdGFuY2VvZiBEYXRlKSB7XG4gICAgICByZXR1cm4gYWN0dWFsLmdldFRpbWUoKSA9PT0gZXhwZWN0ZWQuZ2V0VGltZSgpO1xuXG4gICAgICAvLyA3LjMuIE90aGVyIHBhaXJzIHRoYXQgZG8gbm90IGJvdGggcGFzcyB0eXBlb2YgdmFsdWUgPT0gXCJvYmplY3RcIixcbiAgICAgIC8vIGVxdWl2YWxlbmNlIGlzIGRldGVybWluZWQgYnkgPT0uXG4gICAgfSBlbHNlIGlmICh0eXBlb2YgYWN0dWFsICE9ICdvYmplY3QnICYmIHR5cGVvZiBleHBlY3RlZCAhPSAnb2JqZWN0Jykge1xuICAgICAgcmV0dXJuIGFjdHVhbCA9PSBleHBlY3RlZDtcbiAgICAvLyBJZiBib3RoIGFyZSByZWd1bGFyIGV4cHJlc3Npb24gdXNlIHRoZSBzcGVjaWFsIGByZWdFeHBFcXVpdmAgbWV0aG9kXG4gICAgLy8gdG8gZGV0ZXJtaW5lIGVxdWl2YWxlbmNlLlxuICAgIH0gZWxzZSBpZiAoaXNSZWdFeHAoYWN0dWFsKSAmJiBpc1JlZ0V4cChleHBlY3RlZCkpIHtcbiAgICAgIHJldHVybiByZWdFeHBFcXVpdihhY3R1YWwsIGV4cGVjdGVkKTtcbiAgICAvLyA3LjQuIEZvciBhbGwgb3RoZXIgT2JqZWN0IHBhaXJzLCBpbmNsdWRpbmcgQXJyYXkgb2JqZWN0cywgZXF1aXZhbGVuY2UgaXNcbiAgICAvLyBkZXRlcm1pbmVkIGJ5IGhhdmluZyB0aGUgc2FtZSBudW1iZXIgb2Ygb3duZWQgcHJvcGVydGllcyAoYXMgdmVyaWZpZWRcbiAgICAvLyB3aXRoIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCksIHRoZSBzYW1lIHNldCBvZiBrZXlzXG4gICAgLy8gKGFsdGhvdWdoIG5vdCBuZWNlc3NhcmlseSB0aGUgc2FtZSBvcmRlciksIGVxdWl2YWxlbnQgdmFsdWVzIGZvciBldmVyeVxuICAgIC8vIGNvcnJlc3BvbmRpbmcga2V5LCBhbmQgYW4gaWRlbnRpY2FsIFwicHJvdG90eXBlXCIgcHJvcGVydHkuIE5vdGU6IHRoaXNcbiAgICAvLyBhY2NvdW50cyBmb3IgYm90aCBuYW1lZCBhbmQgaW5kZXhlZCBwcm9wZXJ0aWVzIG9uIEFycmF5cy5cbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG9iakVxdWl2KGFjdHVhbCwgZXhwZWN0ZWQpO1xuICAgIH1cbiAgfTtcblxuICBmdW5jdGlvbiBpc1VuZGVmaW5lZE9yTnVsbCAodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZDtcbiAgfVxuXG4gIGZ1bmN0aW9uIGlzQXJndW1lbnRzIChvYmplY3QpIHtcbiAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG9iamVjdCkgPT0gJ1tvYmplY3QgQXJndW1lbnRzXSc7XG4gIH1cblxuICBmdW5jdGlvbiByZWdFeHBFcXVpdiAoYSwgYikge1xuICAgIHJldHVybiBhLnNvdXJjZSA9PT0gYi5zb3VyY2UgJiYgYS5nbG9iYWwgPT09IGIuZ2xvYmFsICYmXG4gICAgICAgICAgIGEuaWdub3JlQ2FzZSA9PT0gYi5pZ25vcmVDYXNlICYmIGEubXVsdGlsaW5lID09PSBiLm11bHRpbGluZTtcbiAgfVxuXG4gIGZ1bmN0aW9uIG9iakVxdWl2IChhLCBiKSB7XG4gICAgaWYgKGlzVW5kZWZpbmVkT3JOdWxsKGEpIHx8IGlzVW5kZWZpbmVkT3JOdWxsKGIpKVxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIC8vIGFuIGlkZW50aWNhbCBcInByb3RvdHlwZVwiIHByb3BlcnR5LlxuICAgIGlmIChhLnByb3RvdHlwZSAhPT0gYi5wcm90b3R5cGUpIHJldHVybiBmYWxzZTtcbiAgICAvL35+fkkndmUgbWFuYWdlZCB0byBicmVhayBPYmplY3Qua2V5cyB0aHJvdWdoIHNjcmV3eSBhcmd1bWVudHMgcGFzc2luZy5cbiAgICAvLyAgIENvbnZlcnRpbmcgdG8gYXJyYXkgc29sdmVzIHRoZSBwcm9ibGVtLlxuICAgIGlmIChpc0FyZ3VtZW50cyhhKSkge1xuICAgICAgaWYgKCFpc0FyZ3VtZW50cyhiKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICBhID0gcFNsaWNlLmNhbGwoYSk7XG4gICAgICBiID0gcFNsaWNlLmNhbGwoYik7XG4gICAgICByZXR1cm4gZXhwZWN0LmVxbChhLCBiKTtcbiAgICB9XG4gICAgdHJ5e1xuICAgICAgdmFyIGthID0ga2V5cyhhKSxcbiAgICAgICAga2IgPSBrZXlzKGIpLFxuICAgICAgICBrZXksIGk7XG4gICAgfSBjYXRjaCAoZSkgey8vaGFwcGVucyB3aGVuIG9uZSBpcyBhIHN0cmluZyBsaXRlcmFsIGFuZCB0aGUgb3RoZXIgaXNuJ3RcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgLy8gaGF2aW5nIHRoZSBzYW1lIG51bWJlciBvZiBvd25lZCBwcm9wZXJ0aWVzIChrZXlzIGluY29ycG9yYXRlcyBoYXNPd25Qcm9wZXJ0eSlcbiAgICBpZiAoa2EubGVuZ3RoICE9IGtiLmxlbmd0aClcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICAvL3RoZSBzYW1lIHNldCBvZiBrZXlzIChhbHRob3VnaCBub3QgbmVjZXNzYXJpbHkgdGhlIHNhbWUgb3JkZXIpLFxuICAgIGthLnNvcnQoKTtcbiAgICBrYi5zb3J0KCk7XG4gICAgLy9+fn5jaGVhcCBrZXkgdGVzdFxuICAgIGZvciAoaSA9IGthLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICBpZiAoa2FbaV0gIT0ga2JbaV0pXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgLy9lcXVpdmFsZW50IHZhbHVlcyBmb3IgZXZlcnkgY29ycmVzcG9uZGluZyBrZXksIGFuZFxuICAgIC8vfn5+cG9zc2libHkgZXhwZW5zaXZlIGRlZXAgdGVzdFxuICAgIGZvciAoaSA9IGthLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICBrZXkgPSBrYVtpXTtcbiAgICAgIGlmICghZXhwZWN0LmVxbChhW2tleV0sIGJba2V5XSkpXG4gICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgdmFyIGpzb24gPSAoZnVuY3Rpb24gKCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaWYgKCdvYmplY3QnID09IHR5cGVvZiBKU09OICYmIEpTT04ucGFyc2UgJiYgSlNPTi5zdHJpbmdpZnkpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgICAgcGFyc2U6IG5hdGl2ZUpTT04ucGFyc2VcbiAgICAgICAgLCBzdHJpbmdpZnk6IG5hdGl2ZUpTT04uc3RyaW5naWZ5XG4gICAgICB9XG4gICAgfVxuXG4gICAgdmFyIEpTT04gPSB7fTtcblxuICAgIGZ1bmN0aW9uIGYobikge1xuICAgICAgICAvLyBGb3JtYXQgaW50ZWdlcnMgdG8gaGF2ZSBhdCBsZWFzdCB0d28gZGlnaXRzLlxuICAgICAgICByZXR1cm4gbiA8IDEwID8gJzAnICsgbiA6IG47XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZGF0ZShkLCBrZXkpIHtcbiAgICAgIHJldHVybiBpc0Zpbml0ZShkLnZhbHVlT2YoKSkgP1xuICAgICAgICAgIGQuZ2V0VVRDRnVsbFllYXIoKSAgICAgKyAnLScgK1xuICAgICAgICAgIGYoZC5nZXRVVENNb250aCgpICsgMSkgKyAnLScgK1xuICAgICAgICAgIGYoZC5nZXRVVENEYXRlKCkpICAgICAgKyAnVCcgK1xuICAgICAgICAgIGYoZC5nZXRVVENIb3VycygpKSAgICAgKyAnOicgK1xuICAgICAgICAgIGYoZC5nZXRVVENNaW51dGVzKCkpICAgKyAnOicgK1xuICAgICAgICAgIGYoZC5nZXRVVENTZWNvbmRzKCkpICAgKyAnWicgOiBudWxsO1xuICAgIH1cblxuICAgIHZhciBjeCA9IC9bXFx1MDAwMFxcdTAwYWRcXHUwNjAwLVxcdTA2MDRcXHUwNzBmXFx1MTdiNFxcdTE3YjVcXHUyMDBjLVxcdTIwMGZcXHUyMDI4LVxcdTIwMmZcXHUyMDYwLVxcdTIwNmZcXHVmZWZmXFx1ZmZmMC1cXHVmZmZmXS9nLFxuICAgICAgICBlc2NhcGFibGUgPSAvW1xcXFxcXFwiXFx4MDAtXFx4MWZcXHg3Zi1cXHg5ZlxcdTAwYWRcXHUwNjAwLVxcdTA2MDRcXHUwNzBmXFx1MTdiNFxcdTE3YjVcXHUyMDBjLVxcdTIwMGZcXHUyMDI4LVxcdTIwMmZcXHUyMDYwLVxcdTIwNmZcXHVmZWZmXFx1ZmZmMC1cXHVmZmZmXS9nLFxuICAgICAgICBnYXAsXG4gICAgICAgIGluZGVudCxcbiAgICAgICAgbWV0YSA9IHsgICAgLy8gdGFibGUgb2YgY2hhcmFjdGVyIHN1YnN0aXR1dGlvbnNcbiAgICAgICAgICAgICdcXGInOiAnXFxcXGInLFxuICAgICAgICAgICAgJ1xcdCc6ICdcXFxcdCcsXG4gICAgICAgICAgICAnXFxuJzogJ1xcXFxuJyxcbiAgICAgICAgICAgICdcXGYnOiAnXFxcXGYnLFxuICAgICAgICAgICAgJ1xccic6ICdcXFxccicsXG4gICAgICAgICAgICAnXCInIDogJ1xcXFxcIicsXG4gICAgICAgICAgICAnXFxcXCc6ICdcXFxcXFxcXCdcbiAgICAgICAgfSxcbiAgICAgICAgcmVwO1xuXG5cbiAgICBmdW5jdGlvbiBxdW90ZShzdHJpbmcpIHtcblxuICAvLyBJZiB0aGUgc3RyaW5nIGNvbnRhaW5zIG5vIGNvbnRyb2wgY2hhcmFjdGVycywgbm8gcXVvdGUgY2hhcmFjdGVycywgYW5kIG5vXG4gIC8vIGJhY2tzbGFzaCBjaGFyYWN0ZXJzLCB0aGVuIHdlIGNhbiBzYWZlbHkgc2xhcCBzb21lIHF1b3RlcyBhcm91bmQgaXQuXG4gIC8vIE90aGVyd2lzZSB3ZSBtdXN0IGFsc28gcmVwbGFjZSB0aGUgb2ZmZW5kaW5nIGNoYXJhY3RlcnMgd2l0aCBzYWZlIGVzY2FwZVxuICAvLyBzZXF1ZW5jZXMuXG5cbiAgICAgICAgZXNjYXBhYmxlLmxhc3RJbmRleCA9IDA7XG4gICAgICAgIHJldHVybiBlc2NhcGFibGUudGVzdChzdHJpbmcpID8gJ1wiJyArIHN0cmluZy5yZXBsYWNlKGVzY2FwYWJsZSwgZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICAgIHZhciBjID0gbWV0YVthXTtcbiAgICAgICAgICAgIHJldHVybiB0eXBlb2YgYyA9PT0gJ3N0cmluZycgPyBjIDpcbiAgICAgICAgICAgICAgICAnXFxcXHUnICsgKCcwMDAwJyArIGEuY2hhckNvZGVBdCgwKS50b1N0cmluZygxNikpLnNsaWNlKC00KTtcbiAgICAgICAgfSkgKyAnXCInIDogJ1wiJyArIHN0cmluZyArICdcIic7XG4gICAgfVxuXG5cbiAgICBmdW5jdGlvbiBzdHIoa2V5LCBob2xkZXIpIHtcblxuICAvLyBQcm9kdWNlIGEgc3RyaW5nIGZyb20gaG9sZGVyW2tleV0uXG5cbiAgICAgICAgdmFyIGksICAgICAgICAgIC8vIFRoZSBsb29wIGNvdW50ZXIuXG4gICAgICAgICAgICBrLCAgICAgICAgICAvLyBUaGUgbWVtYmVyIGtleS5cbiAgICAgICAgICAgIHYsICAgICAgICAgIC8vIFRoZSBtZW1iZXIgdmFsdWUuXG4gICAgICAgICAgICBsZW5ndGgsXG4gICAgICAgICAgICBtaW5kID0gZ2FwLFxuICAgICAgICAgICAgcGFydGlhbCxcbiAgICAgICAgICAgIHZhbHVlID0gaG9sZGVyW2tleV07XG5cbiAgLy8gSWYgdGhlIHZhbHVlIGhhcyBhIHRvSlNPTiBtZXRob2QsIGNhbGwgaXQgdG8gb2J0YWluIGEgcmVwbGFjZW1lbnQgdmFsdWUuXG5cbiAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgRGF0ZSkge1xuICAgICAgICAgICAgdmFsdWUgPSBkYXRlKGtleSk7XG4gICAgICAgIH1cblxuICAvLyBJZiB3ZSB3ZXJlIGNhbGxlZCB3aXRoIGEgcmVwbGFjZXIgZnVuY3Rpb24sIHRoZW4gY2FsbCB0aGUgcmVwbGFjZXIgdG9cbiAgLy8gb2J0YWluIGEgcmVwbGFjZW1lbnQgdmFsdWUuXG5cbiAgICAgICAgaWYgKHR5cGVvZiByZXAgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHZhbHVlID0gcmVwLmNhbGwoaG9sZGVyLCBrZXksIHZhbHVlKTtcbiAgICAgICAgfVxuXG4gIC8vIFdoYXQgaGFwcGVucyBuZXh0IGRlcGVuZHMgb24gdGhlIHZhbHVlJ3MgdHlwZS5cblxuICAgICAgICBzd2l0Y2ggKHR5cGVvZiB2YWx1ZSkge1xuICAgICAgICBjYXNlICdzdHJpbmcnOlxuICAgICAgICAgICAgcmV0dXJuIHF1b3RlKHZhbHVlKTtcblxuICAgICAgICBjYXNlICdudW1iZXInOlxuXG4gIC8vIEpTT04gbnVtYmVycyBtdXN0IGJlIGZpbml0ZS4gRW5jb2RlIG5vbi1maW5pdGUgbnVtYmVycyBhcyBudWxsLlxuXG4gICAgICAgICAgICByZXR1cm4gaXNGaW5pdGUodmFsdWUpID8gU3RyaW5nKHZhbHVlKSA6ICdudWxsJztcblxuICAgICAgICBjYXNlICdib29sZWFuJzpcbiAgICAgICAgY2FzZSAnbnVsbCc6XG5cbiAgLy8gSWYgdGhlIHZhbHVlIGlzIGEgYm9vbGVhbiBvciBudWxsLCBjb252ZXJ0IGl0IHRvIGEgc3RyaW5nLiBOb3RlOlxuICAvLyB0eXBlb2YgbnVsbCBkb2VzIG5vdCBwcm9kdWNlICdudWxsJy4gVGhlIGNhc2UgaXMgaW5jbHVkZWQgaGVyZSBpblxuICAvLyB0aGUgcmVtb3RlIGNoYW5jZSB0aGF0IHRoaXMgZ2V0cyBmaXhlZCBzb21lZGF5LlxuXG4gICAgICAgICAgICByZXR1cm4gU3RyaW5nKHZhbHVlKTtcblxuICAvLyBJZiB0aGUgdHlwZSBpcyAnb2JqZWN0Jywgd2UgbWlnaHQgYmUgZGVhbGluZyB3aXRoIGFuIG9iamVjdCBvciBhbiBhcnJheSBvclxuICAvLyBudWxsLlxuXG4gICAgICAgIGNhc2UgJ29iamVjdCc6XG5cbiAgLy8gRHVlIHRvIGEgc3BlY2lmaWNhdGlvbiBibHVuZGVyIGluIEVDTUFTY3JpcHQsIHR5cGVvZiBudWxsIGlzICdvYmplY3QnLFxuICAvLyBzbyB3YXRjaCBvdXQgZm9yIHRoYXQgY2FzZS5cblxuICAgICAgICAgICAgaWYgKCF2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAnbnVsbCc7XG4gICAgICAgICAgICB9XG5cbiAgLy8gTWFrZSBhbiBhcnJheSB0byBob2xkIHRoZSBwYXJ0aWFsIHJlc3VsdHMgb2Ygc3RyaW5naWZ5aW5nIHRoaXMgb2JqZWN0IHZhbHVlLlxuXG4gICAgICAgICAgICBnYXAgKz0gaW5kZW50O1xuICAgICAgICAgICAgcGFydGlhbCA9IFtdO1xuXG4gIC8vIElzIHRoZSB2YWx1ZSBhbiBhcnJheT9cblxuICAgICAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuYXBwbHkodmFsdWUpID09PSAnW29iamVjdCBBcnJheV0nKSB7XG5cbiAgLy8gVGhlIHZhbHVlIGlzIGFuIGFycmF5LiBTdHJpbmdpZnkgZXZlcnkgZWxlbWVudC4gVXNlIG51bGwgYXMgYSBwbGFjZWhvbGRlclxuICAvLyBmb3Igbm9uLUpTT04gdmFsdWVzLlxuXG4gICAgICAgICAgICAgICAgbGVuZ3RoID0gdmFsdWUubGVuZ3RoO1xuICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICAgICAgICAgICAgICBwYXJ0aWFsW2ldID0gc3RyKGksIHZhbHVlKSB8fCAnbnVsbCc7XG4gICAgICAgICAgICAgICAgfVxuXG4gIC8vIEpvaW4gYWxsIG9mIHRoZSBlbGVtZW50cyB0b2dldGhlciwgc2VwYXJhdGVkIHdpdGggY29tbWFzLCBhbmQgd3JhcCB0aGVtIGluXG4gIC8vIGJyYWNrZXRzLlxuXG4gICAgICAgICAgICAgICAgdiA9IHBhcnRpYWwubGVuZ3RoID09PSAwID8gJ1tdJyA6IGdhcCA/XG4gICAgICAgICAgICAgICAgICAgICdbXFxuJyArIGdhcCArIHBhcnRpYWwuam9pbignLFxcbicgKyBnYXApICsgJ1xcbicgKyBtaW5kICsgJ10nIDpcbiAgICAgICAgICAgICAgICAgICAgJ1snICsgcGFydGlhbC5qb2luKCcsJykgKyAnXSc7XG4gICAgICAgICAgICAgICAgZ2FwID0gbWluZDtcbiAgICAgICAgICAgICAgICByZXR1cm4gdjtcbiAgICAgICAgICAgIH1cblxuICAvLyBJZiB0aGUgcmVwbGFjZXIgaXMgYW4gYXJyYXksIHVzZSBpdCB0byBzZWxlY3QgdGhlIG1lbWJlcnMgdG8gYmUgc3RyaW5naWZpZWQuXG5cbiAgICAgICAgICAgIGlmIChyZXAgJiYgdHlwZW9mIHJlcCA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgICAgICBsZW5ndGggPSByZXAubGVuZ3RoO1xuICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHJlcFtpXSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGsgPSByZXBbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICB2ID0gc3RyKGssIHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFydGlhbC5wdXNoKHF1b3RlKGspICsgKGdhcCA/ICc6ICcgOiAnOicpICsgdik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuXG4gIC8vIE90aGVyd2lzZSwgaXRlcmF0ZSB0aHJvdWdoIGFsbCBvZiB0aGUga2V5cyBpbiB0aGUgb2JqZWN0LlxuXG4gICAgICAgICAgICAgICAgZm9yIChrIGluIHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodmFsdWUsIGspKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2ID0gc3RyKGssIHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFydGlhbC5wdXNoKHF1b3RlKGspICsgKGdhcCA/ICc6ICcgOiAnOicpICsgdik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgLy8gSm9pbiBhbGwgb2YgdGhlIG1lbWJlciB0ZXh0cyB0b2dldGhlciwgc2VwYXJhdGVkIHdpdGggY29tbWFzLFxuICAvLyBhbmQgd3JhcCB0aGVtIGluIGJyYWNlcy5cblxuICAgICAgICAgICAgdiA9IHBhcnRpYWwubGVuZ3RoID09PSAwID8gJ3t9JyA6IGdhcCA/XG4gICAgICAgICAgICAgICAgJ3tcXG4nICsgZ2FwICsgcGFydGlhbC5qb2luKCcsXFxuJyArIGdhcCkgKyAnXFxuJyArIG1pbmQgKyAnfScgOlxuICAgICAgICAgICAgICAgICd7JyArIHBhcnRpYWwuam9pbignLCcpICsgJ30nO1xuICAgICAgICAgICAgZ2FwID0gbWluZDtcbiAgICAgICAgICAgIHJldHVybiB2O1xuICAgICAgICB9XG4gICAgfVxuXG4gIC8vIElmIHRoZSBKU09OIG9iamVjdCBkb2VzIG5vdCB5ZXQgaGF2ZSBhIHN0cmluZ2lmeSBtZXRob2QsIGdpdmUgaXQgb25lLlxuXG4gICAgSlNPTi5zdHJpbmdpZnkgPSBmdW5jdGlvbiAodmFsdWUsIHJlcGxhY2VyLCBzcGFjZSkge1xuXG4gIC8vIFRoZSBzdHJpbmdpZnkgbWV0aG9kIHRha2VzIGEgdmFsdWUgYW5kIGFuIG9wdGlvbmFsIHJlcGxhY2VyLCBhbmQgYW4gb3B0aW9uYWxcbiAgLy8gc3BhY2UgcGFyYW1ldGVyLCBhbmQgcmV0dXJucyBhIEpTT04gdGV4dC4gVGhlIHJlcGxhY2VyIGNhbiBiZSBhIGZ1bmN0aW9uXG4gIC8vIHRoYXQgY2FuIHJlcGxhY2UgdmFsdWVzLCBvciBhbiBhcnJheSBvZiBzdHJpbmdzIHRoYXQgd2lsbCBzZWxlY3QgdGhlIGtleXMuXG4gIC8vIEEgZGVmYXVsdCByZXBsYWNlciBtZXRob2QgY2FuIGJlIHByb3ZpZGVkLiBVc2Ugb2YgdGhlIHNwYWNlIHBhcmFtZXRlciBjYW5cbiAgLy8gcHJvZHVjZSB0ZXh0IHRoYXQgaXMgbW9yZSBlYXNpbHkgcmVhZGFibGUuXG5cbiAgICAgICAgdmFyIGk7XG4gICAgICAgIGdhcCA9ICcnO1xuICAgICAgICBpbmRlbnQgPSAnJztcblxuICAvLyBJZiB0aGUgc3BhY2UgcGFyYW1ldGVyIGlzIGEgbnVtYmVyLCBtYWtlIGFuIGluZGVudCBzdHJpbmcgY29udGFpbmluZyB0aGF0XG4gIC8vIG1hbnkgc3BhY2VzLlxuXG4gICAgICAgIGlmICh0eXBlb2Ygc3BhY2UgPT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgc3BhY2U7IGkgKz0gMSkge1xuICAgICAgICAgICAgICAgIGluZGVudCArPSAnICc7XG4gICAgICAgICAgICB9XG5cbiAgLy8gSWYgdGhlIHNwYWNlIHBhcmFtZXRlciBpcyBhIHN0cmluZywgaXQgd2lsbCBiZSB1c2VkIGFzIHRoZSBpbmRlbnQgc3RyaW5nLlxuXG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHNwYWNlID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgaW5kZW50ID0gc3BhY2U7XG4gICAgICAgIH1cblxuICAvLyBJZiB0aGVyZSBpcyBhIHJlcGxhY2VyLCBpdCBtdXN0IGJlIGEgZnVuY3Rpb24gb3IgYW4gYXJyYXkuXG4gIC8vIE90aGVyd2lzZSwgdGhyb3cgYW4gZXJyb3IuXG5cbiAgICAgICAgcmVwID0gcmVwbGFjZXI7XG4gICAgICAgIGlmIChyZXBsYWNlciAmJiB0eXBlb2YgcmVwbGFjZXIgIT09ICdmdW5jdGlvbicgJiZcbiAgICAgICAgICAgICAgICAodHlwZW9mIHJlcGxhY2VyICE9PSAnb2JqZWN0JyB8fFxuICAgICAgICAgICAgICAgIHR5cGVvZiByZXBsYWNlci5sZW5ndGggIT09ICdudW1iZXInKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdKU09OLnN0cmluZ2lmeScpO1xuICAgICAgICB9XG5cbiAgLy8gTWFrZSBhIGZha2Ugcm9vdCBvYmplY3QgY29udGFpbmluZyBvdXIgdmFsdWUgdW5kZXIgdGhlIGtleSBvZiAnJy5cbiAgLy8gUmV0dXJuIHRoZSByZXN1bHQgb2Ygc3RyaW5naWZ5aW5nIHRoZSB2YWx1ZS5cblxuICAgICAgICByZXR1cm4gc3RyKCcnLCB7Jyc6IHZhbHVlfSk7XG4gICAgfTtcblxuICAvLyBJZiB0aGUgSlNPTiBvYmplY3QgZG9lcyBub3QgeWV0IGhhdmUgYSBwYXJzZSBtZXRob2QsIGdpdmUgaXQgb25lLlxuXG4gICAgSlNPTi5wYXJzZSA9IGZ1bmN0aW9uICh0ZXh0LCByZXZpdmVyKSB7XG4gICAgLy8gVGhlIHBhcnNlIG1ldGhvZCB0YWtlcyBhIHRleHQgYW5kIGFuIG9wdGlvbmFsIHJldml2ZXIgZnVuY3Rpb24sIGFuZCByZXR1cm5zXG4gICAgLy8gYSBKYXZhU2NyaXB0IHZhbHVlIGlmIHRoZSB0ZXh0IGlzIGEgdmFsaWQgSlNPTiB0ZXh0LlxuXG4gICAgICAgIHZhciBqO1xuXG4gICAgICAgIGZ1bmN0aW9uIHdhbGsoaG9sZGVyLCBrZXkpIHtcblxuICAgIC8vIFRoZSB3YWxrIG1ldGhvZCBpcyB1c2VkIHRvIHJlY3Vyc2l2ZWx5IHdhbGsgdGhlIHJlc3VsdGluZyBzdHJ1Y3R1cmUgc29cbiAgICAvLyB0aGF0IG1vZGlmaWNhdGlvbnMgY2FuIGJlIG1hZGUuXG5cbiAgICAgICAgICAgIHZhciBrLCB2LCB2YWx1ZSA9IGhvbGRlcltrZXldO1xuICAgICAgICAgICAgaWYgKHZhbHVlICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGsgaW4gdmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh2YWx1ZSwgaykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHYgPSB3YWxrKHZhbHVlLCBrKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZVtrXSA9IHY7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB2YWx1ZVtrXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXZpdmVyLmNhbGwoaG9sZGVyLCBrZXksIHZhbHVlKTtcbiAgICAgICAgfVxuXG5cbiAgICAvLyBQYXJzaW5nIGhhcHBlbnMgaW4gZm91ciBzdGFnZXMuIEluIHRoZSBmaXJzdCBzdGFnZSwgd2UgcmVwbGFjZSBjZXJ0YWluXG4gICAgLy8gVW5pY29kZSBjaGFyYWN0ZXJzIHdpdGggZXNjYXBlIHNlcXVlbmNlcy4gSmF2YVNjcmlwdCBoYW5kbGVzIG1hbnkgY2hhcmFjdGVyc1xuICAgIC8vIGluY29ycmVjdGx5LCBlaXRoZXIgc2lsZW50bHkgZGVsZXRpbmcgdGhlbSwgb3IgdHJlYXRpbmcgdGhlbSBhcyBsaW5lIGVuZGluZ3MuXG5cbiAgICAgICAgdGV4dCA9IFN0cmluZyh0ZXh0KTtcbiAgICAgICAgY3gubGFzdEluZGV4ID0gMDtcbiAgICAgICAgaWYgKGN4LnRlc3QodGV4dCkpIHtcbiAgICAgICAgICAgIHRleHQgPSB0ZXh0LnJlcGxhY2UoY3gsIGZ1bmN0aW9uIChhKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICdcXFxcdScgK1xuICAgICAgICAgICAgICAgICAgICAoJzAwMDAnICsgYS5jaGFyQ29kZUF0KDApLnRvU3RyaW5nKDE2KSkuc2xpY2UoLTQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgIC8vIEluIHRoZSBzZWNvbmQgc3RhZ2UsIHdlIHJ1biB0aGUgdGV4dCBhZ2FpbnN0IHJlZ3VsYXIgZXhwcmVzc2lvbnMgdGhhdCBsb29rXG4gICAgLy8gZm9yIG5vbi1KU09OIHBhdHRlcm5zLiBXZSBhcmUgZXNwZWNpYWxseSBjb25jZXJuZWQgd2l0aCAnKCknIGFuZCAnbmV3J1xuICAgIC8vIGJlY2F1c2UgdGhleSBjYW4gY2F1c2UgaW52b2NhdGlvbiwgYW5kICc9JyBiZWNhdXNlIGl0IGNhbiBjYXVzZSBtdXRhdGlvbi5cbiAgICAvLyBCdXQganVzdCB0byBiZSBzYWZlLCB3ZSB3YW50IHRvIHJlamVjdCBhbGwgdW5leHBlY3RlZCBmb3Jtcy5cblxuICAgIC8vIFdlIHNwbGl0IHRoZSBzZWNvbmQgc3RhZ2UgaW50byA0IHJlZ2V4cCBvcGVyYXRpb25zIGluIG9yZGVyIHRvIHdvcmsgYXJvdW5kXG4gICAgLy8gY3JpcHBsaW5nIGluZWZmaWNpZW5jaWVzIGluIElFJ3MgYW5kIFNhZmFyaSdzIHJlZ2V4cCBlbmdpbmVzLiBGaXJzdCB3ZVxuICAgIC8vIHJlcGxhY2UgdGhlIEpTT04gYmFja3NsYXNoIHBhaXJzIHdpdGggJ0AnIChhIG5vbi1KU09OIGNoYXJhY3RlcikuIFNlY29uZCwgd2VcbiAgICAvLyByZXBsYWNlIGFsbCBzaW1wbGUgdmFsdWUgdG9rZW5zIHdpdGggJ10nIGNoYXJhY3RlcnMuIFRoaXJkLCB3ZSBkZWxldGUgYWxsXG4gICAgLy8gb3BlbiBicmFja2V0cyB0aGF0IGZvbGxvdyBhIGNvbG9uIG9yIGNvbW1hIG9yIHRoYXQgYmVnaW4gdGhlIHRleHQuIEZpbmFsbHksXG4gICAgLy8gd2UgbG9vayB0byBzZWUgdGhhdCB0aGUgcmVtYWluaW5nIGNoYXJhY3RlcnMgYXJlIG9ubHkgd2hpdGVzcGFjZSBvciAnXScgb3JcbiAgICAvLyAnLCcgb3IgJzonIG9yICd7JyBvciAnfScuIElmIHRoYXQgaXMgc28sIHRoZW4gdGhlIHRleHQgaXMgc2FmZSBmb3IgZXZhbC5cblxuICAgICAgICBpZiAoL15bXFxdLDp7fVxcc10qJC9cbiAgICAgICAgICAgICAgICAudGVzdCh0ZXh0LnJlcGxhY2UoL1xcXFwoPzpbXCJcXFxcXFwvYmZucnRdfHVbMC05YS1mQS1GXXs0fSkvZywgJ0AnKVxuICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvXCJbXlwiXFxcXFxcblxccl0qXCJ8dHJ1ZXxmYWxzZXxudWxsfC0/XFxkKyg/OlxcLlxcZCopPyg/OltlRV1bK1xcLV0/XFxkKyk/L2csICddJylcbiAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoLyg/Ol58OnwsKSg/OlxccypcXFspKy9nLCAnJykpKSB7XG5cbiAgICAvLyBJbiB0aGUgdGhpcmQgc3RhZ2Ugd2UgdXNlIHRoZSBldmFsIGZ1bmN0aW9uIHRvIGNvbXBpbGUgdGhlIHRleHQgaW50byBhXG4gICAgLy8gSmF2YVNjcmlwdCBzdHJ1Y3R1cmUuIFRoZSAneycgb3BlcmF0b3IgaXMgc3ViamVjdCB0byBhIHN5bnRhY3RpYyBhbWJpZ3VpdHlcbiAgICAvLyBpbiBKYXZhU2NyaXB0OiBpdCBjYW4gYmVnaW4gYSBibG9jayBvciBhbiBvYmplY3QgbGl0ZXJhbC4gV2Ugd3JhcCB0aGUgdGV4dFxuICAgIC8vIGluIHBhcmVucyB0byBlbGltaW5hdGUgdGhlIGFtYmlndWl0eS5cblxuICAgICAgICAgICAgaiA9IGV2YWwoJygnICsgdGV4dCArICcpJyk7XG5cbiAgICAvLyBJbiB0aGUgb3B0aW9uYWwgZm91cnRoIHN0YWdlLCB3ZSByZWN1cnNpdmVseSB3YWxrIHRoZSBuZXcgc3RydWN0dXJlLCBwYXNzaW5nXG4gICAgLy8gZWFjaCBuYW1lL3ZhbHVlIHBhaXIgdG8gYSByZXZpdmVyIGZ1bmN0aW9uIGZvciBwb3NzaWJsZSB0cmFuc2Zvcm1hdGlvbi5cblxuICAgICAgICAgICAgcmV0dXJuIHR5cGVvZiByZXZpdmVyID09PSAnZnVuY3Rpb24nID9cbiAgICAgICAgICAgICAgICB3YWxrKHsnJzogan0sICcnKSA6IGo7XG4gICAgICAgIH1cblxuICAgIC8vIElmIHRoZSB0ZXh0IGlzIG5vdCBKU09OIHBhcnNlYWJsZSwgdGhlbiBhIFN5bnRheEVycm9yIGlzIHRocm93bi5cblxuICAgICAgICB0aHJvdyBuZXcgU3ludGF4RXJyb3IoJ0pTT04ucGFyc2UnKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIEpTT047XG4gIH0pKCk7XG5cbiAgaWYgKCd1bmRlZmluZWQnICE9IHR5cGVvZiB3aW5kb3cpIHtcbiAgICB3aW5kb3cuZXhwZWN0ID0gbW9kdWxlLmV4cG9ydHM7XG4gIH1cblxufSkoXG4gICAgdGhpc1xuICAsICd1bmRlZmluZWQnICE9IHR5cGVvZiBtb2R1bGUgPyBtb2R1bGUgOiB7ZXhwb3J0czoge319XG4pO1xuIiwiLyohXG4gKiBUaGUgYnVmZmVyIG1vZHVsZSBmcm9tIG5vZGUuanMsIGZvciB0aGUgYnJvd3Nlci5cbiAqXG4gKiBAYXV0aG9yICAgRmVyb3NzIEFib3VraGFkaWplaCA8ZmVyb3NzQGZlcm9zcy5vcmc+IDxodHRwOi8vZmVyb3NzLm9yZz5cbiAqIEBsaWNlbnNlICBNSVRcbiAqL1xuLyogZXNsaW50LWRpc2FibGUgbm8tcHJvdG8gKi9cblxuJ3VzZSBzdHJpY3QnXG5cbnZhciBiYXNlNjQgPSByZXF1aXJlKCdiYXNlNjQtanMnKVxudmFyIGllZWU3NTQgPSByZXF1aXJlKCdpZWVlNzU0JylcbnZhciBpc0FycmF5ID0gcmVxdWlyZSgnaXNhcnJheScpXG5cbmV4cG9ydHMuQnVmZmVyID0gQnVmZmVyXG5leHBvcnRzLlNsb3dCdWZmZXIgPSBTbG93QnVmZmVyXG5leHBvcnRzLklOU1BFQ1RfTUFYX0JZVEVTID0gNTBcbkJ1ZmZlci5wb29sU2l6ZSA9IDgxOTIgLy8gbm90IHVzZWQgYnkgdGhpcyBpbXBsZW1lbnRhdGlvblxuXG52YXIgcm9vdFBhcmVudCA9IHt9XG5cbi8qKlxuICogSWYgYEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUYDpcbiAqICAgPT09IHRydWUgICAgVXNlIFVpbnQ4QXJyYXkgaW1wbGVtZW50YXRpb24gKGZhc3Rlc3QpXG4gKiAgID09PSBmYWxzZSAgIFVzZSBPYmplY3QgaW1wbGVtZW50YXRpb24gKG1vc3QgY29tcGF0aWJsZSwgZXZlbiBJRTYpXG4gKlxuICogQnJvd3NlcnMgdGhhdCBzdXBwb3J0IHR5cGVkIGFycmF5cyBhcmUgSUUgMTArLCBGaXJlZm94IDQrLCBDaHJvbWUgNyssIFNhZmFyaSA1LjErLFxuICogT3BlcmEgMTEuNissIGlPUyA0LjIrLlxuICpcbiAqIER1ZSB0byB2YXJpb3VzIGJyb3dzZXIgYnVncywgc29tZXRpbWVzIHRoZSBPYmplY3QgaW1wbGVtZW50YXRpb24gd2lsbCBiZSB1c2VkIGV2ZW5cbiAqIHdoZW4gdGhlIGJyb3dzZXIgc3VwcG9ydHMgdHlwZWQgYXJyYXlzLlxuICpcbiAqIE5vdGU6XG4gKlxuICogICAtIEZpcmVmb3ggNC0yOSBsYWNrcyBzdXBwb3J0IGZvciBhZGRpbmcgbmV3IHByb3BlcnRpZXMgdG8gYFVpbnQ4QXJyYXlgIGluc3RhbmNlcyxcbiAqICAgICBTZWU6IGh0dHBzOi8vYnVnemlsbGEubW96aWxsYS5vcmcvc2hvd19idWcuY2dpP2lkPTY5NTQzOC5cbiAqXG4gKiAgIC0gU2FmYXJpIDUtNyBsYWNrcyBzdXBwb3J0IGZvciBjaGFuZ2luZyB0aGUgYE9iamVjdC5wcm90b3R5cGUuY29uc3RydWN0b3JgIHByb3BlcnR5XG4gKiAgICAgb24gb2JqZWN0cy5cbiAqXG4gKiAgIC0gQ2hyb21lIDktMTAgaXMgbWlzc2luZyB0aGUgYFR5cGVkQXJyYXkucHJvdG90eXBlLnN1YmFycmF5YCBmdW5jdGlvbi5cbiAqXG4gKiAgIC0gSUUxMCBoYXMgYSBicm9rZW4gYFR5cGVkQXJyYXkucHJvdG90eXBlLnN1YmFycmF5YCBmdW5jdGlvbiB3aGljaCByZXR1cm5zIGFycmF5cyBvZlxuICogICAgIGluY29ycmVjdCBsZW5ndGggaW4gc29tZSBzaXR1YXRpb25zLlxuXG4gKiBXZSBkZXRlY3QgdGhlc2UgYnVnZ3kgYnJvd3NlcnMgYW5kIHNldCBgQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlRgIHRvIGBmYWxzZWAgc28gdGhleVxuICogZ2V0IHRoZSBPYmplY3QgaW1wbGVtZW50YXRpb24sIHdoaWNoIGlzIHNsb3dlciBidXQgYmVoYXZlcyBjb3JyZWN0bHkuXG4gKi9cbkJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUID0gZ2xvYmFsLlRZUEVEX0FSUkFZX1NVUFBPUlQgIT09IHVuZGVmaW5lZFxuICA/IGdsb2JhbC5UWVBFRF9BUlJBWV9TVVBQT1JUXG4gIDogdHlwZWRBcnJheVN1cHBvcnQoKVxuXG5mdW5jdGlvbiB0eXBlZEFycmF5U3VwcG9ydCAoKSB7XG4gIGZ1bmN0aW9uIEJhciAoKSB7fVxuICB0cnkge1xuICAgIHZhciBhcnIgPSBuZXcgVWludDhBcnJheSgxKVxuICAgIGFyci5mb28gPSBmdW5jdGlvbiAoKSB7IHJldHVybiA0MiB9XG4gICAgYXJyLmNvbnN0cnVjdG9yID0gQmFyXG4gICAgcmV0dXJuIGFyci5mb28oKSA9PT0gNDIgJiYgLy8gdHlwZWQgYXJyYXkgaW5zdGFuY2VzIGNhbiBiZSBhdWdtZW50ZWRcbiAgICAgICAgYXJyLmNvbnN0cnVjdG9yID09PSBCYXIgJiYgLy8gY29uc3RydWN0b3IgY2FuIGJlIHNldFxuICAgICAgICB0eXBlb2YgYXJyLnN1YmFycmF5ID09PSAnZnVuY3Rpb24nICYmIC8vIGNocm9tZSA5LTEwIGxhY2sgYHN1YmFycmF5YFxuICAgICAgICBhcnIuc3ViYXJyYXkoMSwgMSkuYnl0ZUxlbmd0aCA9PT0gMCAvLyBpZTEwIGhhcyBicm9rZW4gYHN1YmFycmF5YFxuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cbn1cblxuZnVuY3Rpb24ga01heExlbmd0aCAoKSB7XG4gIHJldHVybiBCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVFxuICAgID8gMHg3ZmZmZmZmZlxuICAgIDogMHgzZmZmZmZmZlxufVxuXG4vKipcbiAqIENsYXNzOiBCdWZmZXJcbiAqID09PT09PT09PT09PT1cbiAqXG4gKiBUaGUgQnVmZmVyIGNvbnN0cnVjdG9yIHJldHVybnMgaW5zdGFuY2VzIG9mIGBVaW50OEFycmF5YCB0aGF0IGFyZSBhdWdtZW50ZWRcbiAqIHdpdGggZnVuY3Rpb24gcHJvcGVydGllcyBmb3IgYWxsIHRoZSBub2RlIGBCdWZmZXJgIEFQSSBmdW5jdGlvbnMuIFdlIHVzZVxuICogYFVpbnQ4QXJyYXlgIHNvIHRoYXQgc3F1YXJlIGJyYWNrZXQgbm90YXRpb24gd29ya3MgYXMgZXhwZWN0ZWQgLS0gaXQgcmV0dXJuc1xuICogYSBzaW5nbGUgb2N0ZXQuXG4gKlxuICogQnkgYXVnbWVudGluZyB0aGUgaW5zdGFuY2VzLCB3ZSBjYW4gYXZvaWQgbW9kaWZ5aW5nIHRoZSBgVWludDhBcnJheWBcbiAqIHByb3RvdHlwZS5cbiAqL1xuZnVuY3Rpb24gQnVmZmVyIChhcmcpIHtcbiAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIEJ1ZmZlcikpIHtcbiAgICAvLyBBdm9pZCBnb2luZyB0aHJvdWdoIGFuIEFyZ3VtZW50c0FkYXB0b3JUcmFtcG9saW5lIGluIHRoZSBjb21tb24gY2FzZS5cbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDEpIHJldHVybiBuZXcgQnVmZmVyKGFyZywgYXJndW1lbnRzWzFdKVxuICAgIHJldHVybiBuZXcgQnVmZmVyKGFyZylcbiAgfVxuXG4gIGlmICghQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICB0aGlzLmxlbmd0aCA9IDBcbiAgICB0aGlzLnBhcmVudCA9IHVuZGVmaW5lZFxuICB9XG5cbiAgLy8gQ29tbW9uIGNhc2UuXG4gIGlmICh0eXBlb2YgYXJnID09PSAnbnVtYmVyJykge1xuICAgIHJldHVybiBmcm9tTnVtYmVyKHRoaXMsIGFyZylcbiAgfVxuXG4gIC8vIFNsaWdodGx5IGxlc3MgY29tbW9uIGNhc2UuXG4gIGlmICh0eXBlb2YgYXJnID09PSAnc3RyaW5nJykge1xuICAgIHJldHVybiBmcm9tU3RyaW5nKHRoaXMsIGFyZywgYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHNbMV0gOiAndXRmOCcpXG4gIH1cblxuICAvLyBVbnVzdWFsLlxuICByZXR1cm4gZnJvbU9iamVjdCh0aGlzLCBhcmcpXG59XG5cbmZ1bmN0aW9uIGZyb21OdW1iZXIgKHRoYXQsIGxlbmd0aCkge1xuICB0aGF0ID0gYWxsb2NhdGUodGhhdCwgbGVuZ3RoIDwgMCA/IDAgOiBjaGVja2VkKGxlbmd0aCkgfCAwKVxuICBpZiAoIUJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgdGhhdFtpXSA9IDBcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHRoYXRcbn1cblxuZnVuY3Rpb24gZnJvbVN0cmluZyAodGhhdCwgc3RyaW5nLCBlbmNvZGluZykge1xuICBpZiAodHlwZW9mIGVuY29kaW5nICE9PSAnc3RyaW5nJyB8fCBlbmNvZGluZyA9PT0gJycpIGVuY29kaW5nID0gJ3V0ZjgnXG5cbiAgLy8gQXNzdW1wdGlvbjogYnl0ZUxlbmd0aCgpIHJldHVybiB2YWx1ZSBpcyBhbHdheXMgPCBrTWF4TGVuZ3RoLlxuICB2YXIgbGVuZ3RoID0gYnl0ZUxlbmd0aChzdHJpbmcsIGVuY29kaW5nKSB8IDBcbiAgdGhhdCA9IGFsbG9jYXRlKHRoYXQsIGxlbmd0aClcblxuICB0aGF0LndyaXRlKHN0cmluZywgZW5jb2RpbmcpXG4gIHJldHVybiB0aGF0XG59XG5cbmZ1bmN0aW9uIGZyb21PYmplY3QgKHRoYXQsIG9iamVjdCkge1xuICBpZiAoQnVmZmVyLmlzQnVmZmVyKG9iamVjdCkpIHJldHVybiBmcm9tQnVmZmVyKHRoYXQsIG9iamVjdClcblxuICBpZiAoaXNBcnJheShvYmplY3QpKSByZXR1cm4gZnJvbUFycmF5KHRoYXQsIG9iamVjdClcblxuICBpZiAob2JqZWN0ID09IG51bGwpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdtdXN0IHN0YXJ0IHdpdGggbnVtYmVyLCBidWZmZXIsIGFycmF5IG9yIHN0cmluZycpXG4gIH1cblxuICBpZiAodHlwZW9mIEFycmF5QnVmZmVyICE9PSAndW5kZWZpbmVkJykge1xuICAgIGlmIChvYmplY3QuYnVmZmVyIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHtcbiAgICAgIHJldHVybiBmcm9tVHlwZWRBcnJheSh0aGF0LCBvYmplY3QpXG4gICAgfVxuICAgIGlmIChvYmplY3QgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikge1xuICAgICAgcmV0dXJuIGZyb21BcnJheUJ1ZmZlcih0aGF0LCBvYmplY3QpXG4gICAgfVxuICB9XG5cbiAgaWYgKG9iamVjdC5sZW5ndGgpIHJldHVybiBmcm9tQXJyYXlMaWtlKHRoYXQsIG9iamVjdClcblxuICByZXR1cm4gZnJvbUpzb25PYmplY3QodGhhdCwgb2JqZWN0KVxufVxuXG5mdW5jdGlvbiBmcm9tQnVmZmVyICh0aGF0LCBidWZmZXIpIHtcbiAgdmFyIGxlbmd0aCA9IGNoZWNrZWQoYnVmZmVyLmxlbmd0aCkgfCAwXG4gIHRoYXQgPSBhbGxvY2F0ZSh0aGF0LCBsZW5ndGgpXG4gIGJ1ZmZlci5jb3B5KHRoYXQsIDAsIDAsIGxlbmd0aClcbiAgcmV0dXJuIHRoYXRcbn1cblxuZnVuY3Rpb24gZnJvbUFycmF5ICh0aGF0LCBhcnJheSkge1xuICB2YXIgbGVuZ3RoID0gY2hlY2tlZChhcnJheS5sZW5ndGgpIHwgMFxuICB0aGF0ID0gYWxsb2NhdGUodGhhdCwgbGVuZ3RoKVxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSArPSAxKSB7XG4gICAgdGhhdFtpXSA9IGFycmF5W2ldICYgMjU1XG4gIH1cbiAgcmV0dXJuIHRoYXRcbn1cblxuLy8gRHVwbGljYXRlIG9mIGZyb21BcnJheSgpIHRvIGtlZXAgZnJvbUFycmF5KCkgbW9ub21vcnBoaWMuXG5mdW5jdGlvbiBmcm9tVHlwZWRBcnJheSAodGhhdCwgYXJyYXkpIHtcbiAgdmFyIGxlbmd0aCA9IGNoZWNrZWQoYXJyYXkubGVuZ3RoKSB8IDBcbiAgdGhhdCA9IGFsbG9jYXRlKHRoYXQsIGxlbmd0aClcbiAgLy8gVHJ1bmNhdGluZyB0aGUgZWxlbWVudHMgaXMgcHJvYmFibHkgbm90IHdoYXQgcGVvcGxlIGV4cGVjdCBmcm9tIHR5cGVkXG4gIC8vIGFycmF5cyB3aXRoIEJZVEVTX1BFUl9FTEVNRU5UID4gMSBidXQgaXQncyBjb21wYXRpYmxlIHdpdGggdGhlIGJlaGF2aW9yXG4gIC8vIG9mIHRoZSBvbGQgQnVmZmVyIGNvbnN0cnVjdG9yLlxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSArPSAxKSB7XG4gICAgdGhhdFtpXSA9IGFycmF5W2ldICYgMjU1XG4gIH1cbiAgcmV0dXJuIHRoYXRcbn1cblxuZnVuY3Rpb24gZnJvbUFycmF5QnVmZmVyICh0aGF0LCBhcnJheSkge1xuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICAvLyBSZXR1cm4gYW4gYXVnbWVudGVkIGBVaW50OEFycmF5YCBpbnN0YW5jZSwgZm9yIGJlc3QgcGVyZm9ybWFuY2VcbiAgICBhcnJheS5ieXRlTGVuZ3RoXG4gICAgdGhhdCA9IEJ1ZmZlci5fYXVnbWVudChuZXcgVWludDhBcnJheShhcnJheSkpXG4gIH0gZWxzZSB7XG4gICAgLy8gRmFsbGJhY2s6IFJldHVybiBhbiBvYmplY3QgaW5zdGFuY2Ugb2YgdGhlIEJ1ZmZlciBjbGFzc1xuICAgIHRoYXQgPSBmcm9tVHlwZWRBcnJheSh0aGF0LCBuZXcgVWludDhBcnJheShhcnJheSkpXG4gIH1cbiAgcmV0dXJuIHRoYXRcbn1cblxuZnVuY3Rpb24gZnJvbUFycmF5TGlrZSAodGhhdCwgYXJyYXkpIHtcbiAgdmFyIGxlbmd0aCA9IGNoZWNrZWQoYXJyYXkubGVuZ3RoKSB8IDBcbiAgdGhhdCA9IGFsbG9jYXRlKHRoYXQsIGxlbmd0aClcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkgKz0gMSkge1xuICAgIHRoYXRbaV0gPSBhcnJheVtpXSAmIDI1NVxuICB9XG4gIHJldHVybiB0aGF0XG59XG5cbi8vIERlc2VyaWFsaXplIHsgdHlwZTogJ0J1ZmZlcicsIGRhdGE6IFsxLDIsMywuLi5dIH0gaW50byBhIEJ1ZmZlciBvYmplY3QuXG4vLyBSZXR1cm5zIGEgemVyby1sZW5ndGggYnVmZmVyIGZvciBpbnB1dHMgdGhhdCBkb24ndCBjb25mb3JtIHRvIHRoZSBzcGVjLlxuZnVuY3Rpb24gZnJvbUpzb25PYmplY3QgKHRoYXQsIG9iamVjdCkge1xuICB2YXIgYXJyYXlcbiAgdmFyIGxlbmd0aCA9IDBcblxuICBpZiAob2JqZWN0LnR5cGUgPT09ICdCdWZmZXInICYmIGlzQXJyYXkob2JqZWN0LmRhdGEpKSB7XG4gICAgYXJyYXkgPSBvYmplY3QuZGF0YVxuICAgIGxlbmd0aCA9IGNoZWNrZWQoYXJyYXkubGVuZ3RoKSB8IDBcbiAgfVxuICB0aGF0ID0gYWxsb2NhdGUodGhhdCwgbGVuZ3RoKVxuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpICs9IDEpIHtcbiAgICB0aGF0W2ldID0gYXJyYXlbaV0gJiAyNTVcbiAgfVxuICByZXR1cm4gdGhhdFxufVxuXG5pZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgQnVmZmVyLnByb3RvdHlwZS5fX3Byb3RvX18gPSBVaW50OEFycmF5LnByb3RvdHlwZVxuICBCdWZmZXIuX19wcm90b19fID0gVWludDhBcnJheVxufSBlbHNlIHtcbiAgLy8gcHJlLXNldCBmb3IgdmFsdWVzIHRoYXQgbWF5IGV4aXN0IGluIHRoZSBmdXR1cmVcbiAgQnVmZmVyLnByb3RvdHlwZS5sZW5ndGggPSB1bmRlZmluZWRcbiAgQnVmZmVyLnByb3RvdHlwZS5wYXJlbnQgPSB1bmRlZmluZWRcbn1cblxuZnVuY3Rpb24gYWxsb2NhdGUgKHRoYXQsIGxlbmd0aCkge1xuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICAvLyBSZXR1cm4gYW4gYXVnbWVudGVkIGBVaW50OEFycmF5YCBpbnN0YW5jZSwgZm9yIGJlc3QgcGVyZm9ybWFuY2VcbiAgICB0aGF0ID0gQnVmZmVyLl9hdWdtZW50KG5ldyBVaW50OEFycmF5KGxlbmd0aCkpXG4gICAgdGhhdC5fX3Byb3RvX18gPSBCdWZmZXIucHJvdG90eXBlXG4gIH0gZWxzZSB7XG4gICAgLy8gRmFsbGJhY2s6IFJldHVybiBhbiBvYmplY3QgaW5zdGFuY2Ugb2YgdGhlIEJ1ZmZlciBjbGFzc1xuICAgIHRoYXQubGVuZ3RoID0gbGVuZ3RoXG4gICAgdGhhdC5faXNCdWZmZXIgPSB0cnVlXG4gIH1cblxuICB2YXIgZnJvbVBvb2wgPSBsZW5ndGggIT09IDAgJiYgbGVuZ3RoIDw9IEJ1ZmZlci5wb29sU2l6ZSA+Pj4gMVxuICBpZiAoZnJvbVBvb2wpIHRoYXQucGFyZW50ID0gcm9vdFBhcmVudFxuXG4gIHJldHVybiB0aGF0XG59XG5cbmZ1bmN0aW9uIGNoZWNrZWQgKGxlbmd0aCkge1xuICAvLyBOb3RlOiBjYW5ub3QgdXNlIGBsZW5ndGggPCBrTWF4TGVuZ3RoYCBoZXJlIGJlY2F1c2UgdGhhdCBmYWlscyB3aGVuXG4gIC8vIGxlbmd0aCBpcyBOYU4gKHdoaWNoIGlzIG90aGVyd2lzZSBjb2VyY2VkIHRvIHplcm8uKVxuICBpZiAobGVuZ3RoID49IGtNYXhMZW5ndGgoKSkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdBdHRlbXB0IHRvIGFsbG9jYXRlIEJ1ZmZlciBsYXJnZXIgdGhhbiBtYXhpbXVtICcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICdzaXplOiAweCcgKyBrTWF4TGVuZ3RoKCkudG9TdHJpbmcoMTYpICsgJyBieXRlcycpXG4gIH1cbiAgcmV0dXJuIGxlbmd0aCB8IDBcbn1cblxuZnVuY3Rpb24gU2xvd0J1ZmZlciAoc3ViamVjdCwgZW5jb2RpbmcpIHtcbiAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFNsb3dCdWZmZXIpKSByZXR1cm4gbmV3IFNsb3dCdWZmZXIoc3ViamVjdCwgZW5jb2RpbmcpXG5cbiAgdmFyIGJ1ZiA9IG5ldyBCdWZmZXIoc3ViamVjdCwgZW5jb2RpbmcpXG4gIGRlbGV0ZSBidWYucGFyZW50XG4gIHJldHVybiBidWZcbn1cblxuQnVmZmVyLmlzQnVmZmVyID0gZnVuY3Rpb24gaXNCdWZmZXIgKGIpIHtcbiAgcmV0dXJuICEhKGIgIT0gbnVsbCAmJiBiLl9pc0J1ZmZlcilcbn1cblxuQnVmZmVyLmNvbXBhcmUgPSBmdW5jdGlvbiBjb21wYXJlIChhLCBiKSB7XG4gIGlmICghQnVmZmVyLmlzQnVmZmVyKGEpIHx8ICFCdWZmZXIuaXNCdWZmZXIoYikpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdBcmd1bWVudHMgbXVzdCBiZSBCdWZmZXJzJylcbiAgfVxuXG4gIGlmIChhID09PSBiKSByZXR1cm4gMFxuXG4gIHZhciB4ID0gYS5sZW5ndGhcbiAgdmFyIHkgPSBiLmxlbmd0aFxuXG4gIHZhciBpID0gMFxuICB2YXIgbGVuID0gTWF0aC5taW4oeCwgeSlcbiAgd2hpbGUgKGkgPCBsZW4pIHtcbiAgICBpZiAoYVtpXSAhPT0gYltpXSkgYnJlYWtcblxuICAgICsraVxuICB9XG5cbiAgaWYgKGkgIT09IGxlbikge1xuICAgIHggPSBhW2ldXG4gICAgeSA9IGJbaV1cbiAgfVxuXG4gIGlmICh4IDwgeSkgcmV0dXJuIC0xXG4gIGlmICh5IDwgeCkgcmV0dXJuIDFcbiAgcmV0dXJuIDBcbn1cblxuQnVmZmVyLmlzRW5jb2RpbmcgPSBmdW5jdGlvbiBpc0VuY29kaW5nIChlbmNvZGluZykge1xuICBzd2l0Y2ggKFN0cmluZyhlbmNvZGluZykudG9Mb3dlckNhc2UoKSkge1xuICAgIGNhc2UgJ2hleCc6XG4gICAgY2FzZSAndXRmOCc6XG4gICAgY2FzZSAndXRmLTgnOlxuICAgIGNhc2UgJ2FzY2lpJzpcbiAgICBjYXNlICdiaW5hcnknOlxuICAgIGNhc2UgJ2Jhc2U2NCc6XG4gICAgY2FzZSAncmF3JzpcbiAgICBjYXNlICd1Y3MyJzpcbiAgICBjYXNlICd1Y3MtMic6XG4gICAgY2FzZSAndXRmMTZsZSc6XG4gICAgY2FzZSAndXRmLTE2bGUnOlxuICAgICAgcmV0dXJuIHRydWVcbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuIGZhbHNlXG4gIH1cbn1cblxuQnVmZmVyLmNvbmNhdCA9IGZ1bmN0aW9uIGNvbmNhdCAobGlzdCwgbGVuZ3RoKSB7XG4gIGlmICghaXNBcnJheShsaXN0KSkgdGhyb3cgbmV3IFR5cGVFcnJvcignbGlzdCBhcmd1bWVudCBtdXN0IGJlIGFuIEFycmF5IG9mIEJ1ZmZlcnMuJylcblxuICBpZiAobGlzdC5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gbmV3IEJ1ZmZlcigwKVxuICB9XG5cbiAgdmFyIGlcbiAgaWYgKGxlbmd0aCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgbGVuZ3RoID0gMFxuICAgIGZvciAoaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICBsZW5ndGggKz0gbGlzdFtpXS5sZW5ndGhcbiAgICB9XG4gIH1cblxuICB2YXIgYnVmID0gbmV3IEJ1ZmZlcihsZW5ndGgpXG4gIHZhciBwb3MgPSAwXG4gIGZvciAoaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgdmFyIGl0ZW0gPSBsaXN0W2ldXG4gICAgaXRlbS5jb3B5KGJ1ZiwgcG9zKVxuICAgIHBvcyArPSBpdGVtLmxlbmd0aFxuICB9XG4gIHJldHVybiBidWZcbn1cblxuZnVuY3Rpb24gYnl0ZUxlbmd0aCAoc3RyaW5nLCBlbmNvZGluZykge1xuICBpZiAodHlwZW9mIHN0cmluZyAhPT0gJ3N0cmluZycpIHN0cmluZyA9ICcnICsgc3RyaW5nXG5cbiAgdmFyIGxlbiA9IHN0cmluZy5sZW5ndGhcbiAgaWYgKGxlbiA9PT0gMCkgcmV0dXJuIDBcblxuICAvLyBVc2UgYSBmb3IgbG9vcCB0byBhdm9pZCByZWN1cnNpb25cbiAgdmFyIGxvd2VyZWRDYXNlID0gZmFsc2VcbiAgZm9yICg7Oykge1xuICAgIHN3aXRjaCAoZW5jb2RpbmcpIHtcbiAgICAgIGNhc2UgJ2FzY2lpJzpcbiAgICAgIGNhc2UgJ2JpbmFyeSc6XG4gICAgICAvLyBEZXByZWNhdGVkXG4gICAgICBjYXNlICdyYXcnOlxuICAgICAgY2FzZSAncmF3cyc6XG4gICAgICAgIHJldHVybiBsZW5cbiAgICAgIGNhc2UgJ3V0ZjgnOlxuICAgICAgY2FzZSAndXRmLTgnOlxuICAgICAgICByZXR1cm4gdXRmOFRvQnl0ZXMoc3RyaW5nKS5sZW5ndGhcbiAgICAgIGNhc2UgJ3VjczInOlxuICAgICAgY2FzZSAndWNzLTInOlxuICAgICAgY2FzZSAndXRmMTZsZSc6XG4gICAgICBjYXNlICd1dGYtMTZsZSc6XG4gICAgICAgIHJldHVybiBsZW4gKiAyXG4gICAgICBjYXNlICdoZXgnOlxuICAgICAgICByZXR1cm4gbGVuID4+PiAxXG4gICAgICBjYXNlICdiYXNlNjQnOlxuICAgICAgICByZXR1cm4gYmFzZTY0VG9CeXRlcyhzdHJpbmcpLmxlbmd0aFxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgaWYgKGxvd2VyZWRDYXNlKSByZXR1cm4gdXRmOFRvQnl0ZXMoc3RyaW5nKS5sZW5ndGggLy8gYXNzdW1lIHV0ZjhcbiAgICAgICAgZW5jb2RpbmcgPSAoJycgKyBlbmNvZGluZykudG9Mb3dlckNhc2UoKVxuICAgICAgICBsb3dlcmVkQ2FzZSA9IHRydWVcbiAgICB9XG4gIH1cbn1cbkJ1ZmZlci5ieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aFxuXG5mdW5jdGlvbiBzbG93VG9TdHJpbmcgKGVuY29kaW5nLCBzdGFydCwgZW5kKSB7XG4gIHZhciBsb3dlcmVkQ2FzZSA9IGZhbHNlXG5cbiAgc3RhcnQgPSBzdGFydCB8IDBcbiAgZW5kID0gZW5kID09PSB1bmRlZmluZWQgfHwgZW5kID09PSBJbmZpbml0eSA/IHRoaXMubGVuZ3RoIDogZW5kIHwgMFxuXG4gIGlmICghZW5jb2RpbmcpIGVuY29kaW5nID0gJ3V0ZjgnXG4gIGlmIChzdGFydCA8IDApIHN0YXJ0ID0gMFxuICBpZiAoZW5kID4gdGhpcy5sZW5ndGgpIGVuZCA9IHRoaXMubGVuZ3RoXG4gIGlmIChlbmQgPD0gc3RhcnQpIHJldHVybiAnJ1xuXG4gIHdoaWxlICh0cnVlKSB7XG4gICAgc3dpdGNoIChlbmNvZGluZykge1xuICAgICAgY2FzZSAnaGV4JzpcbiAgICAgICAgcmV0dXJuIGhleFNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpXG5cbiAgICAgIGNhc2UgJ3V0ZjgnOlxuICAgICAgY2FzZSAndXRmLTgnOlxuICAgICAgICByZXR1cm4gdXRmOFNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpXG5cbiAgICAgIGNhc2UgJ2FzY2lpJzpcbiAgICAgICAgcmV0dXJuIGFzY2lpU2xpY2UodGhpcywgc3RhcnQsIGVuZClcblxuICAgICAgY2FzZSAnYmluYXJ5JzpcbiAgICAgICAgcmV0dXJuIGJpbmFyeVNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpXG5cbiAgICAgIGNhc2UgJ2Jhc2U2NCc6XG4gICAgICAgIHJldHVybiBiYXNlNjRTbGljZSh0aGlzLCBzdGFydCwgZW5kKVxuXG4gICAgICBjYXNlICd1Y3MyJzpcbiAgICAgIGNhc2UgJ3Vjcy0yJzpcbiAgICAgIGNhc2UgJ3V0ZjE2bGUnOlxuICAgICAgY2FzZSAndXRmLTE2bGUnOlxuICAgICAgICByZXR1cm4gdXRmMTZsZVNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpXG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGlmIChsb3dlcmVkQ2FzZSkgdGhyb3cgbmV3IFR5cGVFcnJvcignVW5rbm93biBlbmNvZGluZzogJyArIGVuY29kaW5nKVxuICAgICAgICBlbmNvZGluZyA9IChlbmNvZGluZyArICcnKS50b0xvd2VyQ2FzZSgpXG4gICAgICAgIGxvd2VyZWRDYXNlID0gdHJ1ZVxuICAgIH1cbiAgfVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gdG9TdHJpbmcgKCkge1xuICB2YXIgbGVuZ3RoID0gdGhpcy5sZW5ndGggfCAwXG4gIGlmIChsZW5ndGggPT09IDApIHJldHVybiAnJ1xuICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIHV0ZjhTbGljZSh0aGlzLCAwLCBsZW5ndGgpXG4gIHJldHVybiBzbG93VG9TdHJpbmcuYXBwbHkodGhpcywgYXJndW1lbnRzKVxufVxuXG5CdWZmZXIucHJvdG90eXBlLmVxdWFscyA9IGZ1bmN0aW9uIGVxdWFscyAoYikge1xuICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihiKSkgdGhyb3cgbmV3IFR5cGVFcnJvcignQXJndW1lbnQgbXVzdCBiZSBhIEJ1ZmZlcicpXG4gIGlmICh0aGlzID09PSBiKSByZXR1cm4gdHJ1ZVxuICByZXR1cm4gQnVmZmVyLmNvbXBhcmUodGhpcywgYikgPT09IDBcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5pbnNwZWN0ID0gZnVuY3Rpb24gaW5zcGVjdCAoKSB7XG4gIHZhciBzdHIgPSAnJ1xuICB2YXIgbWF4ID0gZXhwb3J0cy5JTlNQRUNUX01BWF9CWVRFU1xuICBpZiAodGhpcy5sZW5ndGggPiAwKSB7XG4gICAgc3RyID0gdGhpcy50b1N0cmluZygnaGV4JywgMCwgbWF4KS5tYXRjaCgvLnsyfS9nKS5qb2luKCcgJylcbiAgICBpZiAodGhpcy5sZW5ndGggPiBtYXgpIHN0ciArPSAnIC4uLiAnXG4gIH1cbiAgcmV0dXJuICc8QnVmZmVyICcgKyBzdHIgKyAnPidcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5jb21wYXJlID0gZnVuY3Rpb24gY29tcGFyZSAoYikge1xuICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihiKSkgdGhyb3cgbmV3IFR5cGVFcnJvcignQXJndW1lbnQgbXVzdCBiZSBhIEJ1ZmZlcicpXG4gIGlmICh0aGlzID09PSBiKSByZXR1cm4gMFxuICByZXR1cm4gQnVmZmVyLmNvbXBhcmUodGhpcywgYilcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5pbmRleE9mID0gZnVuY3Rpb24gaW5kZXhPZiAodmFsLCBieXRlT2Zmc2V0KSB7XG4gIGlmIChieXRlT2Zmc2V0ID4gMHg3ZmZmZmZmZikgYnl0ZU9mZnNldCA9IDB4N2ZmZmZmZmZcbiAgZWxzZSBpZiAoYnl0ZU9mZnNldCA8IC0weDgwMDAwMDAwKSBieXRlT2Zmc2V0ID0gLTB4ODAwMDAwMDBcbiAgYnl0ZU9mZnNldCA+Pj0gMFxuXG4gIGlmICh0aGlzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIC0xXG4gIGlmIChieXRlT2Zmc2V0ID49IHRoaXMubGVuZ3RoKSByZXR1cm4gLTFcblxuICAvLyBOZWdhdGl2ZSBvZmZzZXRzIHN0YXJ0IGZyb20gdGhlIGVuZCBvZiB0aGUgYnVmZmVyXG4gIGlmIChieXRlT2Zmc2V0IDwgMCkgYnl0ZU9mZnNldCA9IE1hdGgubWF4KHRoaXMubGVuZ3RoICsgYnl0ZU9mZnNldCwgMClcblxuICBpZiAodHlwZW9mIHZhbCA9PT0gJ3N0cmluZycpIHtcbiAgICBpZiAodmFsLmxlbmd0aCA9PT0gMCkgcmV0dXJuIC0xIC8vIHNwZWNpYWwgY2FzZTogbG9va2luZyBmb3IgZW1wdHkgc3RyaW5nIGFsd2F5cyBmYWlsc1xuICAgIHJldHVybiBTdHJpbmcucHJvdG90eXBlLmluZGV4T2YuY2FsbCh0aGlzLCB2YWwsIGJ5dGVPZmZzZXQpXG4gIH1cbiAgaWYgKEJ1ZmZlci5pc0J1ZmZlcih2YWwpKSB7XG4gICAgcmV0dXJuIGFycmF5SW5kZXhPZih0aGlzLCB2YWwsIGJ5dGVPZmZzZXQpXG4gIH1cbiAgaWYgKHR5cGVvZiB2YWwgPT09ICdudW1iZXInKSB7XG4gICAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUICYmIFVpbnQ4QXJyYXkucHJvdG90eXBlLmluZGV4T2YgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHJldHVybiBVaW50OEFycmF5LnByb3RvdHlwZS5pbmRleE9mLmNhbGwodGhpcywgdmFsLCBieXRlT2Zmc2V0KVxuICAgIH1cbiAgICByZXR1cm4gYXJyYXlJbmRleE9mKHRoaXMsIFsgdmFsIF0sIGJ5dGVPZmZzZXQpXG4gIH1cblxuICBmdW5jdGlvbiBhcnJheUluZGV4T2YgKGFyciwgdmFsLCBieXRlT2Zmc2V0KSB7XG4gICAgdmFyIGZvdW5kSW5kZXggPSAtMVxuICAgIGZvciAodmFyIGkgPSAwOyBieXRlT2Zmc2V0ICsgaSA8IGFyci5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKGFycltieXRlT2Zmc2V0ICsgaV0gPT09IHZhbFtmb3VuZEluZGV4ID09PSAtMSA/IDAgOiBpIC0gZm91bmRJbmRleF0pIHtcbiAgICAgICAgaWYgKGZvdW5kSW5kZXggPT09IC0xKSBmb3VuZEluZGV4ID0gaVxuICAgICAgICBpZiAoaSAtIGZvdW5kSW5kZXggKyAxID09PSB2YWwubGVuZ3RoKSByZXR1cm4gYnl0ZU9mZnNldCArIGZvdW5kSW5kZXhcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGZvdW5kSW5kZXggPSAtMVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gLTFcbiAgfVxuXG4gIHRocm93IG5ldyBUeXBlRXJyb3IoJ3ZhbCBtdXN0IGJlIHN0cmluZywgbnVtYmVyIG9yIEJ1ZmZlcicpXG59XG5cbi8vIGBnZXRgIGlzIGRlcHJlY2F0ZWRcbkJ1ZmZlci5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gZ2V0IChvZmZzZXQpIHtcbiAgY29uc29sZS5sb2coJy5nZXQoKSBpcyBkZXByZWNhdGVkLiBBY2Nlc3MgdXNpbmcgYXJyYXkgaW5kZXhlcyBpbnN0ZWFkLicpXG4gIHJldHVybiB0aGlzLnJlYWRVSW50OChvZmZzZXQpXG59XG5cbi8vIGBzZXRgIGlzIGRlcHJlY2F0ZWRcbkJ1ZmZlci5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24gc2V0ICh2LCBvZmZzZXQpIHtcbiAgY29uc29sZS5sb2coJy5zZXQoKSBpcyBkZXByZWNhdGVkLiBBY2Nlc3MgdXNpbmcgYXJyYXkgaW5kZXhlcyBpbnN0ZWFkLicpXG4gIHJldHVybiB0aGlzLndyaXRlVUludDgodiwgb2Zmc2V0KVxufVxuXG5mdW5jdGlvbiBoZXhXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7XG4gIG9mZnNldCA9IE51bWJlcihvZmZzZXQpIHx8IDBcbiAgdmFyIHJlbWFpbmluZyA9IGJ1Zi5sZW5ndGggLSBvZmZzZXRcbiAgaWYgKCFsZW5ndGgpIHtcbiAgICBsZW5ndGggPSByZW1haW5pbmdcbiAgfSBlbHNlIHtcbiAgICBsZW5ndGggPSBOdW1iZXIobGVuZ3RoKVxuICAgIGlmIChsZW5ndGggPiByZW1haW5pbmcpIHtcbiAgICAgIGxlbmd0aCA9IHJlbWFpbmluZ1xuICAgIH1cbiAgfVxuXG4gIC8vIG11c3QgYmUgYW4gZXZlbiBudW1iZXIgb2YgZGlnaXRzXG4gIHZhciBzdHJMZW4gPSBzdHJpbmcubGVuZ3RoXG4gIGlmIChzdHJMZW4gJSAyICE9PSAwKSB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgaGV4IHN0cmluZycpXG5cbiAgaWYgKGxlbmd0aCA+IHN0ckxlbiAvIDIpIHtcbiAgICBsZW5ndGggPSBzdHJMZW4gLyAyXG4gIH1cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgIHZhciBwYXJzZWQgPSBwYXJzZUludChzdHJpbmcuc3Vic3RyKGkgKiAyLCAyKSwgMTYpXG4gICAgaWYgKGlzTmFOKHBhcnNlZCkpIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBoZXggc3RyaW5nJylcbiAgICBidWZbb2Zmc2V0ICsgaV0gPSBwYXJzZWRcbiAgfVxuICByZXR1cm4gaVxufVxuXG5mdW5jdGlvbiB1dGY4V3JpdGUgKGJ1Ziwgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkge1xuICByZXR1cm4gYmxpdEJ1ZmZlcih1dGY4VG9CeXRlcyhzdHJpbmcsIGJ1Zi5sZW5ndGggLSBvZmZzZXQpLCBidWYsIG9mZnNldCwgbGVuZ3RoKVxufVxuXG5mdW5jdGlvbiBhc2NpaVdyaXRlIChidWYsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpIHtcbiAgcmV0dXJuIGJsaXRCdWZmZXIoYXNjaWlUb0J5dGVzKHN0cmluZyksIGJ1Ziwgb2Zmc2V0LCBsZW5ndGgpXG59XG5cbmZ1bmN0aW9uIGJpbmFyeVdyaXRlIChidWYsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpIHtcbiAgcmV0dXJuIGFzY2lpV3JpdGUoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKVxufVxuXG5mdW5jdGlvbiBiYXNlNjRXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7XG4gIHJldHVybiBibGl0QnVmZmVyKGJhc2U2NFRvQnl0ZXMoc3RyaW5nKSwgYnVmLCBvZmZzZXQsIGxlbmd0aClcbn1cblxuZnVuY3Rpb24gdWNzMldyaXRlIChidWYsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpIHtcbiAgcmV0dXJuIGJsaXRCdWZmZXIodXRmMTZsZVRvQnl0ZXMoc3RyaW5nLCBidWYubGVuZ3RoIC0gb2Zmc2V0KSwgYnVmLCBvZmZzZXQsIGxlbmd0aClcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZSA9IGZ1bmN0aW9uIHdyaXRlIChzdHJpbmcsIG9mZnNldCwgbGVuZ3RoLCBlbmNvZGluZykge1xuICAvLyBCdWZmZXIjd3JpdGUoc3RyaW5nKVxuICBpZiAob2Zmc2V0ID09PSB1bmRlZmluZWQpIHtcbiAgICBlbmNvZGluZyA9ICd1dGY4J1xuICAgIGxlbmd0aCA9IHRoaXMubGVuZ3RoXG4gICAgb2Zmc2V0ID0gMFxuICAvLyBCdWZmZXIjd3JpdGUoc3RyaW5nLCBlbmNvZGluZylcbiAgfSBlbHNlIGlmIChsZW5ndGggPT09IHVuZGVmaW5lZCAmJiB0eXBlb2Ygb2Zmc2V0ID09PSAnc3RyaW5nJykge1xuICAgIGVuY29kaW5nID0gb2Zmc2V0XG4gICAgbGVuZ3RoID0gdGhpcy5sZW5ndGhcbiAgICBvZmZzZXQgPSAwXG4gIC8vIEJ1ZmZlciN3cml0ZShzdHJpbmcsIG9mZnNldFssIGxlbmd0aF1bLCBlbmNvZGluZ10pXG4gIH0gZWxzZSBpZiAoaXNGaW5pdGUob2Zmc2V0KSkge1xuICAgIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgICBpZiAoaXNGaW5pdGUobGVuZ3RoKSkge1xuICAgICAgbGVuZ3RoID0gbGVuZ3RoIHwgMFxuICAgICAgaWYgKGVuY29kaW5nID09PSB1bmRlZmluZWQpIGVuY29kaW5nID0gJ3V0ZjgnXG4gICAgfSBlbHNlIHtcbiAgICAgIGVuY29kaW5nID0gbGVuZ3RoXG4gICAgICBsZW5ndGggPSB1bmRlZmluZWRcbiAgICB9XG4gIC8vIGxlZ2FjeSB3cml0ZShzdHJpbmcsIGVuY29kaW5nLCBvZmZzZXQsIGxlbmd0aCkgLSByZW1vdmUgaW4gdjAuMTNcbiAgfSBlbHNlIHtcbiAgICB2YXIgc3dhcCA9IGVuY29kaW5nXG4gICAgZW5jb2RpbmcgPSBvZmZzZXRcbiAgICBvZmZzZXQgPSBsZW5ndGggfCAwXG4gICAgbGVuZ3RoID0gc3dhcFxuICB9XG5cbiAgdmFyIHJlbWFpbmluZyA9IHRoaXMubGVuZ3RoIC0gb2Zmc2V0XG4gIGlmIChsZW5ndGggPT09IHVuZGVmaW5lZCB8fCBsZW5ndGggPiByZW1haW5pbmcpIGxlbmd0aCA9IHJlbWFpbmluZ1xuXG4gIGlmICgoc3RyaW5nLmxlbmd0aCA+IDAgJiYgKGxlbmd0aCA8IDAgfHwgb2Zmc2V0IDwgMCkpIHx8IG9mZnNldCA+IHRoaXMubGVuZ3RoKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ2F0dGVtcHQgdG8gd3JpdGUgb3V0c2lkZSBidWZmZXIgYm91bmRzJylcbiAgfVxuXG4gIGlmICghZW5jb2RpbmcpIGVuY29kaW5nID0gJ3V0ZjgnXG5cbiAgdmFyIGxvd2VyZWRDYXNlID0gZmFsc2VcbiAgZm9yICg7Oykge1xuICAgIHN3aXRjaCAoZW5jb2RpbmcpIHtcbiAgICAgIGNhc2UgJ2hleCc6XG4gICAgICAgIHJldHVybiBoZXhXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKVxuXG4gICAgICBjYXNlICd1dGY4JzpcbiAgICAgIGNhc2UgJ3V0Zi04JzpcbiAgICAgICAgcmV0dXJuIHV0ZjhXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKVxuXG4gICAgICBjYXNlICdhc2NpaSc6XG4gICAgICAgIHJldHVybiBhc2NpaVdyaXRlKHRoaXMsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpXG5cbiAgICAgIGNhc2UgJ2JpbmFyeSc6XG4gICAgICAgIHJldHVybiBiaW5hcnlXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKVxuXG4gICAgICBjYXNlICdiYXNlNjQnOlxuICAgICAgICAvLyBXYXJuaW5nOiBtYXhMZW5ndGggbm90IHRha2VuIGludG8gYWNjb3VudCBpbiBiYXNlNjRXcml0ZVxuICAgICAgICByZXR1cm4gYmFzZTY0V3JpdGUodGhpcywgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aClcblxuICAgICAgY2FzZSAndWNzMic6XG4gICAgICBjYXNlICd1Y3MtMic6XG4gICAgICBjYXNlICd1dGYxNmxlJzpcbiAgICAgIGNhc2UgJ3V0Zi0xNmxlJzpcbiAgICAgICAgcmV0dXJuIHVjczJXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKVxuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICBpZiAobG93ZXJlZENhc2UpIHRocm93IG5ldyBUeXBlRXJyb3IoJ1Vua25vd24gZW5jb2Rpbmc6ICcgKyBlbmNvZGluZylcbiAgICAgICAgZW5jb2RpbmcgPSAoJycgKyBlbmNvZGluZykudG9Mb3dlckNhc2UoKVxuICAgICAgICBsb3dlcmVkQ2FzZSA9IHRydWVcbiAgICB9XG4gIH1cbn1cblxuQnVmZmVyLnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiB0b0pTT04gKCkge1xuICByZXR1cm4ge1xuICAgIHR5cGU6ICdCdWZmZXInLFxuICAgIGRhdGE6IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKHRoaXMuX2FyciB8fCB0aGlzLCAwKVxuICB9XG59XG5cbmZ1bmN0aW9uIGJhc2U2NFNsaWNlIChidWYsIHN0YXJ0LCBlbmQpIHtcbiAgaWYgKHN0YXJ0ID09PSAwICYmIGVuZCA9PT0gYnVmLmxlbmd0aCkge1xuICAgIHJldHVybiBiYXNlNjQuZnJvbUJ5dGVBcnJheShidWYpXG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGJhc2U2NC5mcm9tQnl0ZUFycmF5KGJ1Zi5zbGljZShzdGFydCwgZW5kKSlcbiAgfVxufVxuXG5mdW5jdGlvbiB1dGY4U2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkge1xuICBlbmQgPSBNYXRoLm1pbihidWYubGVuZ3RoLCBlbmQpXG4gIHZhciByZXMgPSBbXVxuXG4gIHZhciBpID0gc3RhcnRcbiAgd2hpbGUgKGkgPCBlbmQpIHtcbiAgICB2YXIgZmlyc3RCeXRlID0gYnVmW2ldXG4gICAgdmFyIGNvZGVQb2ludCA9IG51bGxcbiAgICB2YXIgYnl0ZXNQZXJTZXF1ZW5jZSA9IChmaXJzdEJ5dGUgPiAweEVGKSA/IDRcbiAgICAgIDogKGZpcnN0Qnl0ZSA+IDB4REYpID8gM1xuICAgICAgOiAoZmlyc3RCeXRlID4gMHhCRikgPyAyXG4gICAgICA6IDFcblxuICAgIGlmIChpICsgYnl0ZXNQZXJTZXF1ZW5jZSA8PSBlbmQpIHtcbiAgICAgIHZhciBzZWNvbmRCeXRlLCB0aGlyZEJ5dGUsIGZvdXJ0aEJ5dGUsIHRlbXBDb2RlUG9pbnRcblxuICAgICAgc3dpdGNoIChieXRlc1BlclNlcXVlbmNlKSB7XG4gICAgICAgIGNhc2UgMTpcbiAgICAgICAgICBpZiAoZmlyc3RCeXRlIDwgMHg4MCkge1xuICAgICAgICAgICAgY29kZVBvaW50ID0gZmlyc3RCeXRlXG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGNhc2UgMjpcbiAgICAgICAgICBzZWNvbmRCeXRlID0gYnVmW2kgKyAxXVxuICAgICAgICAgIGlmICgoc2Vjb25kQnl0ZSAmIDB4QzApID09PSAweDgwKSB7XG4gICAgICAgICAgICB0ZW1wQ29kZVBvaW50ID0gKGZpcnN0Qnl0ZSAmIDB4MUYpIDw8IDB4NiB8IChzZWNvbmRCeXRlICYgMHgzRilcbiAgICAgICAgICAgIGlmICh0ZW1wQ29kZVBvaW50ID4gMHg3Rikge1xuICAgICAgICAgICAgICBjb2RlUG9pbnQgPSB0ZW1wQ29kZVBvaW50XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGNhc2UgMzpcbiAgICAgICAgICBzZWNvbmRCeXRlID0gYnVmW2kgKyAxXVxuICAgICAgICAgIHRoaXJkQnl0ZSA9IGJ1ZltpICsgMl1cbiAgICAgICAgICBpZiAoKHNlY29uZEJ5dGUgJiAweEMwKSA9PT0gMHg4MCAmJiAodGhpcmRCeXRlICYgMHhDMCkgPT09IDB4ODApIHtcbiAgICAgICAgICAgIHRlbXBDb2RlUG9pbnQgPSAoZmlyc3RCeXRlICYgMHhGKSA8PCAweEMgfCAoc2Vjb25kQnl0ZSAmIDB4M0YpIDw8IDB4NiB8ICh0aGlyZEJ5dGUgJiAweDNGKVxuICAgICAgICAgICAgaWYgKHRlbXBDb2RlUG9pbnQgPiAweDdGRiAmJiAodGVtcENvZGVQb2ludCA8IDB4RDgwMCB8fCB0ZW1wQ29kZVBvaW50ID4gMHhERkZGKSkge1xuICAgICAgICAgICAgICBjb2RlUG9pbnQgPSB0ZW1wQ29kZVBvaW50XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGNhc2UgNDpcbiAgICAgICAgICBzZWNvbmRCeXRlID0gYnVmW2kgKyAxXVxuICAgICAgICAgIHRoaXJkQnl0ZSA9IGJ1ZltpICsgMl1cbiAgICAgICAgICBmb3VydGhCeXRlID0gYnVmW2kgKyAzXVxuICAgICAgICAgIGlmICgoc2Vjb25kQnl0ZSAmIDB4QzApID09PSAweDgwICYmICh0aGlyZEJ5dGUgJiAweEMwKSA9PT0gMHg4MCAmJiAoZm91cnRoQnl0ZSAmIDB4QzApID09PSAweDgwKSB7XG4gICAgICAgICAgICB0ZW1wQ29kZVBvaW50ID0gKGZpcnN0Qnl0ZSAmIDB4RikgPDwgMHgxMiB8IChzZWNvbmRCeXRlICYgMHgzRikgPDwgMHhDIHwgKHRoaXJkQnl0ZSAmIDB4M0YpIDw8IDB4NiB8IChmb3VydGhCeXRlICYgMHgzRilcbiAgICAgICAgICAgIGlmICh0ZW1wQ29kZVBvaW50ID4gMHhGRkZGICYmIHRlbXBDb2RlUG9pbnQgPCAweDExMDAwMCkge1xuICAgICAgICAgICAgICBjb2RlUG9pbnQgPSB0ZW1wQ29kZVBvaW50XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChjb2RlUG9pbnQgPT09IG51bGwpIHtcbiAgICAgIC8vIHdlIGRpZCBub3QgZ2VuZXJhdGUgYSB2YWxpZCBjb2RlUG9pbnQgc28gaW5zZXJ0IGFcbiAgICAgIC8vIHJlcGxhY2VtZW50IGNoYXIgKFUrRkZGRCkgYW5kIGFkdmFuY2Ugb25seSAxIGJ5dGVcbiAgICAgIGNvZGVQb2ludCA9IDB4RkZGRFxuICAgICAgYnl0ZXNQZXJTZXF1ZW5jZSA9IDFcbiAgICB9IGVsc2UgaWYgKGNvZGVQb2ludCA+IDB4RkZGRikge1xuICAgICAgLy8gZW5jb2RlIHRvIHV0ZjE2IChzdXJyb2dhdGUgcGFpciBkYW5jZSlcbiAgICAgIGNvZGVQb2ludCAtPSAweDEwMDAwXG4gICAgICByZXMucHVzaChjb2RlUG9pbnQgPj4+IDEwICYgMHgzRkYgfCAweEQ4MDApXG4gICAgICBjb2RlUG9pbnQgPSAweERDMDAgfCBjb2RlUG9pbnQgJiAweDNGRlxuICAgIH1cblxuICAgIHJlcy5wdXNoKGNvZGVQb2ludClcbiAgICBpICs9IGJ5dGVzUGVyU2VxdWVuY2VcbiAgfVxuXG4gIHJldHVybiBkZWNvZGVDb2RlUG9pbnRzQXJyYXkocmVzKVxufVxuXG4vLyBCYXNlZCBvbiBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8yMjc0NzI3Mi82ODA3NDIsIHRoZSBicm93c2VyIHdpdGhcbi8vIHRoZSBsb3dlc3QgbGltaXQgaXMgQ2hyb21lLCB3aXRoIDB4MTAwMDAgYXJncy5cbi8vIFdlIGdvIDEgbWFnbml0dWRlIGxlc3MsIGZvciBzYWZldHlcbnZhciBNQVhfQVJHVU1FTlRTX0xFTkdUSCA9IDB4MTAwMFxuXG5mdW5jdGlvbiBkZWNvZGVDb2RlUG9pbnRzQXJyYXkgKGNvZGVQb2ludHMpIHtcbiAgdmFyIGxlbiA9IGNvZGVQb2ludHMubGVuZ3RoXG4gIGlmIChsZW4gPD0gTUFYX0FSR1VNRU5UU19MRU5HVEgpIHtcbiAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShTdHJpbmcsIGNvZGVQb2ludHMpIC8vIGF2b2lkIGV4dHJhIHNsaWNlKClcbiAgfVxuXG4gIC8vIERlY29kZSBpbiBjaHVua3MgdG8gYXZvaWQgXCJjYWxsIHN0YWNrIHNpemUgZXhjZWVkZWRcIi5cbiAgdmFyIHJlcyA9ICcnXG4gIHZhciBpID0gMFxuICB3aGlsZSAoaSA8IGxlbikge1xuICAgIHJlcyArPSBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KFxuICAgICAgU3RyaW5nLFxuICAgICAgY29kZVBvaW50cy5zbGljZShpLCBpICs9IE1BWF9BUkdVTUVOVFNfTEVOR1RIKVxuICAgIClcbiAgfVxuICByZXR1cm4gcmVzXG59XG5cbmZ1bmN0aW9uIGFzY2lpU2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkge1xuICB2YXIgcmV0ID0gJydcbiAgZW5kID0gTWF0aC5taW4oYnVmLmxlbmd0aCwgZW5kKVxuXG4gIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IGVuZDsgaSsrKSB7XG4gICAgcmV0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYnVmW2ldICYgMHg3RilcbiAgfVxuICByZXR1cm4gcmV0XG59XG5cbmZ1bmN0aW9uIGJpbmFyeVNsaWNlIChidWYsIHN0YXJ0LCBlbmQpIHtcbiAgdmFyIHJldCA9ICcnXG4gIGVuZCA9IE1hdGgubWluKGJ1Zi5sZW5ndGgsIGVuZClcblxuICBmb3IgKHZhciBpID0gc3RhcnQ7IGkgPCBlbmQ7IGkrKykge1xuICAgIHJldCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGJ1ZltpXSlcbiAgfVxuICByZXR1cm4gcmV0XG59XG5cbmZ1bmN0aW9uIGhleFNsaWNlIChidWYsIHN0YXJ0LCBlbmQpIHtcbiAgdmFyIGxlbiA9IGJ1Zi5sZW5ndGhcblxuICBpZiAoIXN0YXJ0IHx8IHN0YXJ0IDwgMCkgc3RhcnQgPSAwXG4gIGlmICghZW5kIHx8IGVuZCA8IDAgfHwgZW5kID4gbGVuKSBlbmQgPSBsZW5cblxuICB2YXIgb3V0ID0gJydcbiAgZm9yICh2YXIgaSA9IHN0YXJ0OyBpIDwgZW5kOyBpKyspIHtcbiAgICBvdXQgKz0gdG9IZXgoYnVmW2ldKVxuICB9XG4gIHJldHVybiBvdXRcbn1cblxuZnVuY3Rpb24gdXRmMTZsZVNsaWNlIChidWYsIHN0YXJ0LCBlbmQpIHtcbiAgdmFyIGJ5dGVzID0gYnVmLnNsaWNlKHN0YXJ0LCBlbmQpXG4gIHZhciByZXMgPSAnJ1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGJ5dGVzLmxlbmd0aDsgaSArPSAyKSB7XG4gICAgcmVzICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYnl0ZXNbaV0gKyBieXRlc1tpICsgMV0gKiAyNTYpXG4gIH1cbiAgcmV0dXJuIHJlc1xufVxuXG5CdWZmZXIucHJvdG90eXBlLnNsaWNlID0gZnVuY3Rpb24gc2xpY2UgKHN0YXJ0LCBlbmQpIHtcbiAgdmFyIGxlbiA9IHRoaXMubGVuZ3RoXG4gIHN0YXJ0ID0gfn5zdGFydFxuICBlbmQgPSBlbmQgPT09IHVuZGVmaW5lZCA/IGxlbiA6IH5+ZW5kXG5cbiAgaWYgKHN0YXJ0IDwgMCkge1xuICAgIHN0YXJ0ICs9IGxlblxuICAgIGlmIChzdGFydCA8IDApIHN0YXJ0ID0gMFxuICB9IGVsc2UgaWYgKHN0YXJ0ID4gbGVuKSB7XG4gICAgc3RhcnQgPSBsZW5cbiAgfVxuXG4gIGlmIChlbmQgPCAwKSB7XG4gICAgZW5kICs9IGxlblxuICAgIGlmIChlbmQgPCAwKSBlbmQgPSAwXG4gIH0gZWxzZSBpZiAoZW5kID4gbGVuKSB7XG4gICAgZW5kID0gbGVuXG4gIH1cblxuICBpZiAoZW5kIDwgc3RhcnQpIGVuZCA9IHN0YXJ0XG5cbiAgdmFyIG5ld0J1ZlxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICBuZXdCdWYgPSBCdWZmZXIuX2F1Z21lbnQodGhpcy5zdWJhcnJheShzdGFydCwgZW5kKSlcbiAgfSBlbHNlIHtcbiAgICB2YXIgc2xpY2VMZW4gPSBlbmQgLSBzdGFydFxuICAgIG5ld0J1ZiA9IG5ldyBCdWZmZXIoc2xpY2VMZW4sIHVuZGVmaW5lZClcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNsaWNlTGVuOyBpKyspIHtcbiAgICAgIG5ld0J1ZltpXSA9IHRoaXNbaSArIHN0YXJ0XVxuICAgIH1cbiAgfVxuXG4gIGlmIChuZXdCdWYubGVuZ3RoKSBuZXdCdWYucGFyZW50ID0gdGhpcy5wYXJlbnQgfHwgdGhpc1xuXG4gIHJldHVybiBuZXdCdWZcbn1cblxuLypcbiAqIE5lZWQgdG8gbWFrZSBzdXJlIHRoYXQgYnVmZmVyIGlzbid0IHRyeWluZyB0byB3cml0ZSBvdXQgb2YgYm91bmRzLlxuICovXG5mdW5jdGlvbiBjaGVja09mZnNldCAob2Zmc2V0LCBleHQsIGxlbmd0aCkge1xuICBpZiAoKG9mZnNldCAlIDEpICE9PSAwIHx8IG9mZnNldCA8IDApIHRocm93IG5ldyBSYW5nZUVycm9yKCdvZmZzZXQgaXMgbm90IHVpbnQnKVxuICBpZiAob2Zmc2V0ICsgZXh0ID4gbGVuZ3RoKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignVHJ5aW5nIHRvIGFjY2VzcyBiZXlvbmQgYnVmZmVyIGxlbmd0aCcpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnRMRSA9IGZ1bmN0aW9uIHJlYWRVSW50TEUgKG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHtcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCBieXRlTGVuZ3RoLCB0aGlzLmxlbmd0aClcblxuICB2YXIgdmFsID0gdGhpc1tvZmZzZXRdXG4gIHZhciBtdWwgPSAxXG4gIHZhciBpID0gMFxuICB3aGlsZSAoKytpIDwgYnl0ZUxlbmd0aCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgIHZhbCArPSB0aGlzW29mZnNldCArIGldICogbXVsXG4gIH1cblxuICByZXR1cm4gdmFsXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnRCRSA9IGZ1bmN0aW9uIHJlYWRVSW50QkUgKG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHtcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCB8IDBcbiAgaWYgKCFub0Fzc2VydCkge1xuICAgIGNoZWNrT2Zmc2V0KG9mZnNldCwgYnl0ZUxlbmd0aCwgdGhpcy5sZW5ndGgpXG4gIH1cblxuICB2YXIgdmFsID0gdGhpc1tvZmZzZXQgKyAtLWJ5dGVMZW5ndGhdXG4gIHZhciBtdWwgPSAxXG4gIHdoaWxlIChieXRlTGVuZ3RoID4gMCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgIHZhbCArPSB0aGlzW29mZnNldCArIC0tYnl0ZUxlbmd0aF0gKiBtdWxcbiAgfVxuXG4gIHJldHVybiB2YWxcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludDggPSBmdW5jdGlvbiByZWFkVUludDggKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCAxLCB0aGlzLmxlbmd0aClcbiAgcmV0dXJuIHRoaXNbb2Zmc2V0XVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRVSW50MTZMRSA9IGZ1bmN0aW9uIHJlYWRVSW50MTZMRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDIsIHRoaXMubGVuZ3RoKVxuICByZXR1cm4gdGhpc1tvZmZzZXRdIHwgKHRoaXNbb2Zmc2V0ICsgMV0gPDwgOClcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludDE2QkUgPSBmdW5jdGlvbiByZWFkVUludDE2QkUgKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCAyLCB0aGlzLmxlbmd0aClcbiAgcmV0dXJuICh0aGlzW29mZnNldF0gPDwgOCkgfCB0aGlzW29mZnNldCArIDFdXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnQzMkxFID0gZnVuY3Rpb24gcmVhZFVJbnQzMkxFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpXG5cbiAgcmV0dXJuICgodGhpc1tvZmZzZXRdKSB8XG4gICAgICAodGhpc1tvZmZzZXQgKyAxXSA8PCA4KSB8XG4gICAgICAodGhpc1tvZmZzZXQgKyAyXSA8PCAxNikpICtcbiAgICAgICh0aGlzW29mZnNldCArIDNdICogMHgxMDAwMDAwKVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRVSW50MzJCRSA9IGZ1bmN0aW9uIHJlYWRVSW50MzJCRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKVxuXG4gIHJldHVybiAodGhpc1tvZmZzZXRdICogMHgxMDAwMDAwKSArXG4gICAgKCh0aGlzW29mZnNldCArIDFdIDw8IDE2KSB8XG4gICAgKHRoaXNbb2Zmc2V0ICsgMl0gPDwgOCkgfFxuICAgIHRoaXNbb2Zmc2V0ICsgM10pXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEludExFID0gZnVuY3Rpb24gcmVhZEludExFIChvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7XG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGggfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgYnl0ZUxlbmd0aCwgdGhpcy5sZW5ndGgpXG5cbiAgdmFyIHZhbCA9IHRoaXNbb2Zmc2V0XVxuICB2YXIgbXVsID0gMVxuICB2YXIgaSA9IDBcbiAgd2hpbGUgKCsraSA8IGJ5dGVMZW5ndGggJiYgKG11bCAqPSAweDEwMCkpIHtcbiAgICB2YWwgKz0gdGhpc1tvZmZzZXQgKyBpXSAqIG11bFxuICB9XG4gIG11bCAqPSAweDgwXG5cbiAgaWYgKHZhbCA+PSBtdWwpIHZhbCAtPSBNYXRoLnBvdygyLCA4ICogYnl0ZUxlbmd0aClcblxuICByZXR1cm4gdmFsXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEludEJFID0gZnVuY3Rpb24gcmVhZEludEJFIChvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7XG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGggfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgYnl0ZUxlbmd0aCwgdGhpcy5sZW5ndGgpXG5cbiAgdmFyIGkgPSBieXRlTGVuZ3RoXG4gIHZhciBtdWwgPSAxXG4gIHZhciB2YWwgPSB0aGlzW29mZnNldCArIC0taV1cbiAgd2hpbGUgKGkgPiAwICYmIChtdWwgKj0gMHgxMDApKSB7XG4gICAgdmFsICs9IHRoaXNbb2Zmc2V0ICsgLS1pXSAqIG11bFxuICB9XG4gIG11bCAqPSAweDgwXG5cbiAgaWYgKHZhbCA+PSBtdWwpIHZhbCAtPSBNYXRoLnBvdygyLCA4ICogYnl0ZUxlbmd0aClcblxuICByZXR1cm4gdmFsXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEludDggPSBmdW5jdGlvbiByZWFkSW50OCAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDEsIHRoaXMubGVuZ3RoKVxuICBpZiAoISh0aGlzW29mZnNldF0gJiAweDgwKSkgcmV0dXJuICh0aGlzW29mZnNldF0pXG4gIHJldHVybiAoKDB4ZmYgLSB0aGlzW29mZnNldF0gKyAxKSAqIC0xKVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRJbnQxNkxFID0gZnVuY3Rpb24gcmVhZEludDE2TEUgKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCAyLCB0aGlzLmxlbmd0aClcbiAgdmFyIHZhbCA9IHRoaXNbb2Zmc2V0XSB8ICh0aGlzW29mZnNldCArIDFdIDw8IDgpXG4gIHJldHVybiAodmFsICYgMHg4MDAwKSA/IHZhbCB8IDB4RkZGRjAwMDAgOiB2YWxcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50MTZCRSA9IGZ1bmN0aW9uIHJlYWRJbnQxNkJFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgMiwgdGhpcy5sZW5ndGgpXG4gIHZhciB2YWwgPSB0aGlzW29mZnNldCArIDFdIHwgKHRoaXNbb2Zmc2V0XSA8PCA4KVxuICByZXR1cm4gKHZhbCAmIDB4ODAwMCkgPyB2YWwgfCAweEZGRkYwMDAwIDogdmFsXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEludDMyTEUgPSBmdW5jdGlvbiByZWFkSW50MzJMRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKVxuXG4gIHJldHVybiAodGhpc1tvZmZzZXRdKSB8XG4gICAgKHRoaXNbb2Zmc2V0ICsgMV0gPDwgOCkgfFxuICAgICh0aGlzW29mZnNldCArIDJdIDw8IDE2KSB8XG4gICAgKHRoaXNbb2Zmc2V0ICsgM10gPDwgMjQpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEludDMyQkUgPSBmdW5jdGlvbiByZWFkSW50MzJCRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKVxuXG4gIHJldHVybiAodGhpc1tvZmZzZXRdIDw8IDI0KSB8XG4gICAgKHRoaXNbb2Zmc2V0ICsgMV0gPDwgMTYpIHxcbiAgICAodGhpc1tvZmZzZXQgKyAyXSA8PCA4KSB8XG4gICAgKHRoaXNbb2Zmc2V0ICsgM10pXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEZsb2F0TEUgPSBmdW5jdGlvbiByZWFkRmxvYXRMRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKVxuICByZXR1cm4gaWVlZTc1NC5yZWFkKHRoaXMsIG9mZnNldCwgdHJ1ZSwgMjMsIDQpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEZsb2F0QkUgPSBmdW5jdGlvbiByZWFkRmxvYXRCRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKVxuICByZXR1cm4gaWVlZTc1NC5yZWFkKHRoaXMsIG9mZnNldCwgZmFsc2UsIDIzLCA0KVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWREb3VibGVMRSA9IGZ1bmN0aW9uIHJlYWREb3VibGVMRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDgsIHRoaXMubGVuZ3RoKVxuICByZXR1cm4gaWVlZTc1NC5yZWFkKHRoaXMsIG9mZnNldCwgdHJ1ZSwgNTIsIDgpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZERvdWJsZUJFID0gZnVuY3Rpb24gcmVhZERvdWJsZUJFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgOCwgdGhpcy5sZW5ndGgpXG4gIHJldHVybiBpZWVlNzU0LnJlYWQodGhpcywgb2Zmc2V0LCBmYWxzZSwgNTIsIDgpXG59XG5cbmZ1bmN0aW9uIGNoZWNrSW50IChidWYsIHZhbHVlLCBvZmZzZXQsIGV4dCwgbWF4LCBtaW4pIHtcbiAgaWYgKCFCdWZmZXIuaXNCdWZmZXIoYnVmKSkgdGhyb3cgbmV3IFR5cGVFcnJvcignYnVmZmVyIG11c3QgYmUgYSBCdWZmZXIgaW5zdGFuY2UnKVxuICBpZiAodmFsdWUgPiBtYXggfHwgdmFsdWUgPCBtaW4pIHRocm93IG5ldyBSYW5nZUVycm9yKCd2YWx1ZSBpcyBvdXQgb2YgYm91bmRzJylcbiAgaWYgKG9mZnNldCArIGV4dCA+IGJ1Zi5sZW5ndGgpIHRocm93IG5ldyBSYW5nZUVycm9yKCdpbmRleCBvdXQgb2YgcmFuZ2UnKVxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlVUludExFID0gZnVuY3Rpb24gd3JpdGVVSW50TEUgKHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGggfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoKSwgMClcblxuICB2YXIgbXVsID0gMVxuICB2YXIgaSA9IDBcbiAgdGhpc1tvZmZzZXRdID0gdmFsdWUgJiAweEZGXG4gIHdoaWxlICgrK2kgPCBieXRlTGVuZ3RoICYmIChtdWwgKj0gMHgxMDApKSB7XG4gICAgdGhpc1tvZmZzZXQgKyBpXSA9ICh2YWx1ZSAvIG11bCkgJiAweEZGXG4gIH1cblxuICByZXR1cm4gb2Zmc2V0ICsgYnl0ZUxlbmd0aFxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlVUludEJFID0gZnVuY3Rpb24gd3JpdGVVSW50QkUgKHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGggfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoKSwgMClcblxuICB2YXIgaSA9IGJ5dGVMZW5ndGggLSAxXG4gIHZhciBtdWwgPSAxXG4gIHRoaXNbb2Zmc2V0ICsgaV0gPSB2YWx1ZSAmIDB4RkZcbiAgd2hpbGUgKC0taSA+PSAwICYmIChtdWwgKj0gMHgxMDApKSB7XG4gICAgdGhpc1tvZmZzZXQgKyBpXSA9ICh2YWx1ZSAvIG11bCkgJiAweEZGXG4gIH1cblxuICByZXR1cm4gb2Zmc2V0ICsgYnl0ZUxlbmd0aFxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlVUludDggPSBmdW5jdGlvbiB3cml0ZVVJbnQ4ICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDEsIDB4ZmYsIDApXG4gIGlmICghQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHZhbHVlID0gTWF0aC5mbG9vcih2YWx1ZSlcbiAgdGhpc1tvZmZzZXRdID0gKHZhbHVlICYgMHhmZilcbiAgcmV0dXJuIG9mZnNldCArIDFcbn1cblxuZnVuY3Rpb24gb2JqZWN0V3JpdGVVSW50MTYgKGJ1ZiwgdmFsdWUsIG9mZnNldCwgbGl0dGxlRW5kaWFuKSB7XG4gIGlmICh2YWx1ZSA8IDApIHZhbHVlID0gMHhmZmZmICsgdmFsdWUgKyAxXG4gIGZvciAodmFyIGkgPSAwLCBqID0gTWF0aC5taW4oYnVmLmxlbmd0aCAtIG9mZnNldCwgMik7IGkgPCBqOyBpKyspIHtcbiAgICBidWZbb2Zmc2V0ICsgaV0gPSAodmFsdWUgJiAoMHhmZiA8PCAoOCAqIChsaXR0bGVFbmRpYW4gPyBpIDogMSAtIGkpKSkpID4+PlxuICAgICAgKGxpdHRsZUVuZGlhbiA/IGkgOiAxIC0gaSkgKiA4XG4gIH1cbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnQxNkxFID0gZnVuY3Rpb24gd3JpdGVVSW50MTZMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAyLCAweGZmZmYsIDApXG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSAmIDB4ZmYpXG4gICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSA+Pj4gOClcbiAgfSBlbHNlIHtcbiAgICBvYmplY3RXcml0ZVVJbnQxNih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCB0cnVlKVxuICB9XG4gIHJldHVybiBvZmZzZXQgKyAyXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50MTZCRSA9IGZ1bmN0aW9uIHdyaXRlVUludDE2QkUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgMiwgMHhmZmZmLCAwKVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgPj4+IDgpXG4gICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSAmIDB4ZmYpXG4gIH0gZWxzZSB7XG4gICAgb2JqZWN0V3JpdGVVSW50MTYodGhpcywgdmFsdWUsIG9mZnNldCwgZmFsc2UpXG4gIH1cbiAgcmV0dXJuIG9mZnNldCArIDJcbn1cblxuZnVuY3Rpb24gb2JqZWN0V3JpdGVVSW50MzIgKGJ1ZiwgdmFsdWUsIG9mZnNldCwgbGl0dGxlRW5kaWFuKSB7XG4gIGlmICh2YWx1ZSA8IDApIHZhbHVlID0gMHhmZmZmZmZmZiArIHZhbHVlICsgMVxuICBmb3IgKHZhciBpID0gMCwgaiA9IE1hdGgubWluKGJ1Zi5sZW5ndGggLSBvZmZzZXQsIDQpOyBpIDwgajsgaSsrKSB7XG4gICAgYnVmW29mZnNldCArIGldID0gKHZhbHVlID4+PiAobGl0dGxlRW5kaWFuID8gaSA6IDMgLSBpKSAqIDgpICYgMHhmZlxuICB9XG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50MzJMRSA9IGZ1bmN0aW9uIHdyaXRlVUludDMyTEUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgNCwgMHhmZmZmZmZmZiwgMClcbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgdGhpc1tvZmZzZXQgKyAzXSA9ICh2YWx1ZSA+Pj4gMjQpXG4gICAgdGhpc1tvZmZzZXQgKyAyXSA9ICh2YWx1ZSA+Pj4gMTYpXG4gICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSA+Pj4gOClcbiAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgJiAweGZmKVxuICB9IGVsc2Uge1xuICAgIG9iamVjdFdyaXRlVUludDMyKHRoaXMsIHZhbHVlLCBvZmZzZXQsIHRydWUpXG4gIH1cbiAgcmV0dXJuIG9mZnNldCArIDRcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnQzMkJFID0gZnVuY3Rpb24gd3JpdGVVSW50MzJCRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCA0LCAweGZmZmZmZmZmLCAwKVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgPj4+IDI0KVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgPj4+IDE2KVxuICAgIHRoaXNbb2Zmc2V0ICsgMl0gPSAodmFsdWUgPj4+IDgpXG4gICAgdGhpc1tvZmZzZXQgKyAzXSA9ICh2YWx1ZSAmIDB4ZmYpXG4gIH0gZWxzZSB7XG4gICAgb2JqZWN0V3JpdGVVSW50MzIodGhpcywgdmFsdWUsIG9mZnNldCwgZmFsc2UpXG4gIH1cbiAgcmV0dXJuIG9mZnNldCArIDRcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZUludExFID0gZnVuY3Rpb24gd3JpdGVJbnRMRSAodmFsdWUsIG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSB7XG4gICAgdmFyIGxpbWl0ID0gTWF0aC5wb3coMiwgOCAqIGJ5dGVMZW5ndGggLSAxKVxuXG4gICAgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgYnl0ZUxlbmd0aCwgbGltaXQgLSAxLCAtbGltaXQpXG4gIH1cblxuICB2YXIgaSA9IDBcbiAgdmFyIG11bCA9IDFcbiAgdmFyIHN1YiA9IHZhbHVlIDwgMCA/IDEgOiAwXG4gIHRoaXNbb2Zmc2V0XSA9IHZhbHVlICYgMHhGRlxuICB3aGlsZSAoKytpIDwgYnl0ZUxlbmd0aCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgIHRoaXNbb2Zmc2V0ICsgaV0gPSAoKHZhbHVlIC8gbXVsKSA+PiAwKSAtIHN1YiAmIDB4RkZcbiAgfVxuXG4gIHJldHVybiBvZmZzZXQgKyBieXRlTGVuZ3RoXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnRCRSA9IGZ1bmN0aW9uIHdyaXRlSW50QkUgKHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkge1xuICAgIHZhciBsaW1pdCA9IE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoIC0gMSlcblxuICAgIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIGxpbWl0IC0gMSwgLWxpbWl0KVxuICB9XG5cbiAgdmFyIGkgPSBieXRlTGVuZ3RoIC0gMVxuICB2YXIgbXVsID0gMVxuICB2YXIgc3ViID0gdmFsdWUgPCAwID8gMSA6IDBcbiAgdGhpc1tvZmZzZXQgKyBpXSA9IHZhbHVlICYgMHhGRlxuICB3aGlsZSAoLS1pID49IDAgJiYgKG11bCAqPSAweDEwMCkpIHtcbiAgICB0aGlzW29mZnNldCArIGldID0gKCh2YWx1ZSAvIG11bCkgPj4gMCkgLSBzdWIgJiAweEZGXG4gIH1cblxuICByZXR1cm4gb2Zmc2V0ICsgYnl0ZUxlbmd0aFxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlSW50OCA9IGZ1bmN0aW9uIHdyaXRlSW50OCAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAxLCAweDdmLCAtMHg4MClcbiAgaWYgKCFCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkgdmFsdWUgPSBNYXRoLmZsb29yKHZhbHVlKVxuICBpZiAodmFsdWUgPCAwKSB2YWx1ZSA9IDB4ZmYgKyB2YWx1ZSArIDFcbiAgdGhpc1tvZmZzZXRdID0gKHZhbHVlICYgMHhmZilcbiAgcmV0dXJuIG9mZnNldCArIDFcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZUludDE2TEUgPSBmdW5jdGlvbiB3cml0ZUludDE2TEUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgMiwgMHg3ZmZmLCAtMHg4MDAwKVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgJiAweGZmKVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgPj4+IDgpXG4gIH0gZWxzZSB7XG4gICAgb2JqZWN0V3JpdGVVSW50MTYodGhpcywgdmFsdWUsIG9mZnNldCwgdHJ1ZSlcbiAgfVxuICByZXR1cm4gb2Zmc2V0ICsgMlxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlSW50MTZCRSA9IGZ1bmN0aW9uIHdyaXRlSW50MTZCRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAyLCAweDdmZmYsIC0weDgwMDApXG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSA+Pj4gOClcbiAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlICYgMHhmZilcbiAgfSBlbHNlIHtcbiAgICBvYmplY3RXcml0ZVVJbnQxNih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBmYWxzZSlcbiAgfVxuICByZXR1cm4gb2Zmc2V0ICsgMlxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlSW50MzJMRSA9IGZ1bmN0aW9uIHdyaXRlSW50MzJMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCA0LCAweDdmZmZmZmZmLCAtMHg4MDAwMDAwMClcbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlICYgMHhmZilcbiAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlID4+PiA4KVxuICAgIHRoaXNbb2Zmc2V0ICsgMl0gPSAodmFsdWUgPj4+IDE2KVxuICAgIHRoaXNbb2Zmc2V0ICsgM10gPSAodmFsdWUgPj4+IDI0KVxuICB9IGVsc2Uge1xuICAgIG9iamVjdFdyaXRlVUludDMyKHRoaXMsIHZhbHVlLCBvZmZzZXQsIHRydWUpXG4gIH1cbiAgcmV0dXJuIG9mZnNldCArIDRcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZUludDMyQkUgPSBmdW5jdGlvbiB3cml0ZUludDMyQkUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgNCwgMHg3ZmZmZmZmZiwgLTB4ODAwMDAwMDApXG4gIGlmICh2YWx1ZSA8IDApIHZhbHVlID0gMHhmZmZmZmZmZiArIHZhbHVlICsgMVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgPj4+IDI0KVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgPj4+IDE2KVxuICAgIHRoaXNbb2Zmc2V0ICsgMl0gPSAodmFsdWUgPj4+IDgpXG4gICAgdGhpc1tvZmZzZXQgKyAzXSA9ICh2YWx1ZSAmIDB4ZmYpXG4gIH0gZWxzZSB7XG4gICAgb2JqZWN0V3JpdGVVSW50MzIodGhpcywgdmFsdWUsIG9mZnNldCwgZmFsc2UpXG4gIH1cbiAgcmV0dXJuIG9mZnNldCArIDRcbn1cblxuZnVuY3Rpb24gY2hlY2tJRUVFNzU0IChidWYsIHZhbHVlLCBvZmZzZXQsIGV4dCwgbWF4LCBtaW4pIHtcbiAgaWYgKHZhbHVlID4gbWF4IHx8IHZhbHVlIDwgbWluKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcigndmFsdWUgaXMgb3V0IG9mIGJvdW5kcycpXG4gIGlmIChvZmZzZXQgKyBleHQgPiBidWYubGVuZ3RoKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignaW5kZXggb3V0IG9mIHJhbmdlJylcbiAgaWYgKG9mZnNldCA8IDApIHRocm93IG5ldyBSYW5nZUVycm9yKCdpbmRleCBvdXQgb2YgcmFuZ2UnKVxufVxuXG5mdW5jdGlvbiB3cml0ZUZsb2F0IChidWYsIHZhbHVlLCBvZmZzZXQsIGxpdHRsZUVuZGlhbiwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkge1xuICAgIGNoZWNrSUVFRTc1NChidWYsIHZhbHVlLCBvZmZzZXQsIDQsIDMuNDAyODIzNDY2Mzg1Mjg4NmUrMzgsIC0zLjQwMjgyMzQ2NjM4NTI4ODZlKzM4KVxuICB9XG4gIGllZWU3NTQud3JpdGUoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBsaXR0bGVFbmRpYW4sIDIzLCA0KVxuICByZXR1cm4gb2Zmc2V0ICsgNFxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlRmxvYXRMRSA9IGZ1bmN0aW9uIHdyaXRlRmxvYXRMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgcmV0dXJuIHdyaXRlRmxvYXQodGhpcywgdmFsdWUsIG9mZnNldCwgdHJ1ZSwgbm9Bc3NlcnQpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVGbG9hdEJFID0gZnVuY3Rpb24gd3JpdGVGbG9hdEJFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICByZXR1cm4gd3JpdGVGbG9hdCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBmYWxzZSwgbm9Bc3NlcnQpXG59XG5cbmZ1bmN0aW9uIHdyaXRlRG91YmxlIChidWYsIHZhbHVlLCBvZmZzZXQsIGxpdHRsZUVuZGlhbiwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkge1xuICAgIGNoZWNrSUVFRTc1NChidWYsIHZhbHVlLCBvZmZzZXQsIDgsIDEuNzk3NjkzMTM0ODYyMzE1N0UrMzA4LCAtMS43OTc2OTMxMzQ4NjIzMTU3RSszMDgpXG4gIH1cbiAgaWVlZTc1NC53cml0ZShidWYsIHZhbHVlLCBvZmZzZXQsIGxpdHRsZUVuZGlhbiwgNTIsIDgpXG4gIHJldHVybiBvZmZzZXQgKyA4XG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVEb3VibGVMRSA9IGZ1bmN0aW9uIHdyaXRlRG91YmxlTEUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHJldHVybiB3cml0ZURvdWJsZSh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCB0cnVlLCBub0Fzc2VydClcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZURvdWJsZUJFID0gZnVuY3Rpb24gd3JpdGVEb3VibGVCRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgcmV0dXJuIHdyaXRlRG91YmxlKHRoaXMsIHZhbHVlLCBvZmZzZXQsIGZhbHNlLCBub0Fzc2VydClcbn1cblxuLy8gY29weSh0YXJnZXRCdWZmZXIsIHRhcmdldFN0YXJ0PTAsIHNvdXJjZVN0YXJ0PTAsIHNvdXJjZUVuZD1idWZmZXIubGVuZ3RoKVxuQnVmZmVyLnByb3RvdHlwZS5jb3B5ID0gZnVuY3Rpb24gY29weSAodGFyZ2V0LCB0YXJnZXRTdGFydCwgc3RhcnQsIGVuZCkge1xuICBpZiAoIXN0YXJ0KSBzdGFydCA9IDBcbiAgaWYgKCFlbmQgJiYgZW5kICE9PSAwKSBlbmQgPSB0aGlzLmxlbmd0aFxuICBpZiAodGFyZ2V0U3RhcnQgPj0gdGFyZ2V0Lmxlbmd0aCkgdGFyZ2V0U3RhcnQgPSB0YXJnZXQubGVuZ3RoXG4gIGlmICghdGFyZ2V0U3RhcnQpIHRhcmdldFN0YXJ0ID0gMFxuICBpZiAoZW5kID4gMCAmJiBlbmQgPCBzdGFydCkgZW5kID0gc3RhcnRcblxuICAvLyBDb3B5IDAgYnl0ZXM7IHdlJ3JlIGRvbmVcbiAgaWYgKGVuZCA9PT0gc3RhcnQpIHJldHVybiAwXG4gIGlmICh0YXJnZXQubGVuZ3RoID09PSAwIHx8IHRoaXMubGVuZ3RoID09PSAwKSByZXR1cm4gMFxuXG4gIC8vIEZhdGFsIGVycm9yIGNvbmRpdGlvbnNcbiAgaWYgKHRhcmdldFN0YXJ0IDwgMCkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCd0YXJnZXRTdGFydCBvdXQgb2YgYm91bmRzJylcbiAgfVxuICBpZiAoc3RhcnQgPCAwIHx8IHN0YXJ0ID49IHRoaXMubGVuZ3RoKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignc291cmNlU3RhcnQgb3V0IG9mIGJvdW5kcycpXG4gIGlmIChlbmQgPCAwKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignc291cmNlRW5kIG91dCBvZiBib3VuZHMnKVxuXG4gIC8vIEFyZSB3ZSBvb2I/XG4gIGlmIChlbmQgPiB0aGlzLmxlbmd0aCkgZW5kID0gdGhpcy5sZW5ndGhcbiAgaWYgKHRhcmdldC5sZW5ndGggLSB0YXJnZXRTdGFydCA8IGVuZCAtIHN0YXJ0KSB7XG4gICAgZW5kID0gdGFyZ2V0Lmxlbmd0aCAtIHRhcmdldFN0YXJ0ICsgc3RhcnRcbiAgfVxuXG4gIHZhciBsZW4gPSBlbmQgLSBzdGFydFxuICB2YXIgaVxuXG4gIGlmICh0aGlzID09PSB0YXJnZXQgJiYgc3RhcnQgPCB0YXJnZXRTdGFydCAmJiB0YXJnZXRTdGFydCA8IGVuZCkge1xuICAgIC8vIGRlc2NlbmRpbmcgY29weSBmcm9tIGVuZFxuICAgIGZvciAoaSA9IGxlbiAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICB0YXJnZXRbaSArIHRhcmdldFN0YXJ0XSA9IHRoaXNbaSArIHN0YXJ0XVxuICAgIH1cbiAgfSBlbHNlIGlmIChsZW4gPCAxMDAwIHx8ICFCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIC8vIGFzY2VuZGluZyBjb3B5IGZyb20gc3RhcnRcbiAgICBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgIHRhcmdldFtpICsgdGFyZ2V0U3RhcnRdID0gdGhpc1tpICsgc3RhcnRdXG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHRhcmdldC5fc2V0KHRoaXMuc3ViYXJyYXkoc3RhcnQsIHN0YXJ0ICsgbGVuKSwgdGFyZ2V0U3RhcnQpXG4gIH1cblxuICByZXR1cm4gbGVuXG59XG5cbi8vIGZpbGwodmFsdWUsIHN0YXJ0PTAsIGVuZD1idWZmZXIubGVuZ3RoKVxuQnVmZmVyLnByb3RvdHlwZS5maWxsID0gZnVuY3Rpb24gZmlsbCAodmFsdWUsIHN0YXJ0LCBlbmQpIHtcbiAgaWYgKCF2YWx1ZSkgdmFsdWUgPSAwXG4gIGlmICghc3RhcnQpIHN0YXJ0ID0gMFxuICBpZiAoIWVuZCkgZW5kID0gdGhpcy5sZW5ndGhcblxuICBpZiAoZW5kIDwgc3RhcnQpIHRocm93IG5ldyBSYW5nZUVycm9yKCdlbmQgPCBzdGFydCcpXG5cbiAgLy8gRmlsbCAwIGJ5dGVzOyB3ZSdyZSBkb25lXG4gIGlmIChlbmQgPT09IHN0YXJ0KSByZXR1cm5cbiAgaWYgKHRoaXMubGVuZ3RoID09PSAwKSByZXR1cm5cblxuICBpZiAoc3RhcnQgPCAwIHx8IHN0YXJ0ID49IHRoaXMubGVuZ3RoKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignc3RhcnQgb3V0IG9mIGJvdW5kcycpXG4gIGlmIChlbmQgPCAwIHx8IGVuZCA+IHRoaXMubGVuZ3RoKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignZW5kIG91dCBvZiBib3VuZHMnKVxuXG4gIHZhciBpXG4gIGlmICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInKSB7XG4gICAgZm9yIChpID0gc3RhcnQ7IGkgPCBlbmQ7IGkrKykge1xuICAgICAgdGhpc1tpXSA9IHZhbHVlXG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHZhciBieXRlcyA9IHV0ZjhUb0J5dGVzKHZhbHVlLnRvU3RyaW5nKCkpXG4gICAgdmFyIGxlbiA9IGJ5dGVzLmxlbmd0aFxuICAgIGZvciAoaSA9IHN0YXJ0OyBpIDwgZW5kOyBpKyspIHtcbiAgICAgIHRoaXNbaV0gPSBieXRlc1tpICUgbGVuXVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiB0aGlzXG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIG5ldyBgQXJyYXlCdWZmZXJgIHdpdGggdGhlICpjb3BpZWQqIG1lbW9yeSBvZiB0aGUgYnVmZmVyIGluc3RhbmNlLlxuICogQWRkZWQgaW4gTm9kZSAwLjEyLiBPbmx5IGF2YWlsYWJsZSBpbiBicm93c2VycyB0aGF0IHN1cHBvcnQgQXJyYXlCdWZmZXIuXG4gKi9cbkJ1ZmZlci5wcm90b3R5cGUudG9BcnJheUJ1ZmZlciA9IGZ1bmN0aW9uIHRvQXJyYXlCdWZmZXIgKCkge1xuICBpZiAodHlwZW9mIFVpbnQ4QXJyYXkgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgICByZXR1cm4gKG5ldyBCdWZmZXIodGhpcykpLmJ1ZmZlclxuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgYnVmID0gbmV3IFVpbnQ4QXJyYXkodGhpcy5sZW5ndGgpXG4gICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gYnVmLmxlbmd0aDsgaSA8IGxlbjsgaSArPSAxKSB7XG4gICAgICAgIGJ1ZltpXSA9IHRoaXNbaV1cbiAgICAgIH1cbiAgICAgIHJldHVybiBidWYuYnVmZmVyXG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0J1ZmZlci50b0FycmF5QnVmZmVyIG5vdCBzdXBwb3J0ZWQgaW4gdGhpcyBicm93c2VyJylcbiAgfVxufVxuXG4vLyBIRUxQRVIgRlVOQ1RJT05TXG4vLyA9PT09PT09PT09PT09PT09XG5cbnZhciBCUCA9IEJ1ZmZlci5wcm90b3R5cGVcblxuLyoqXG4gKiBBdWdtZW50IGEgVWludDhBcnJheSAqaW5zdGFuY2UqIChub3QgdGhlIFVpbnQ4QXJyYXkgY2xhc3MhKSB3aXRoIEJ1ZmZlciBtZXRob2RzXG4gKi9cbkJ1ZmZlci5fYXVnbWVudCA9IGZ1bmN0aW9uIF9hdWdtZW50IChhcnIpIHtcbiAgYXJyLmNvbnN0cnVjdG9yID0gQnVmZmVyXG4gIGFyci5faXNCdWZmZXIgPSB0cnVlXG5cbiAgLy8gc2F2ZSByZWZlcmVuY2UgdG8gb3JpZ2luYWwgVWludDhBcnJheSBzZXQgbWV0aG9kIGJlZm9yZSBvdmVyd3JpdGluZ1xuICBhcnIuX3NldCA9IGFyci5zZXRcblxuICAvLyBkZXByZWNhdGVkXG4gIGFyci5nZXQgPSBCUC5nZXRcbiAgYXJyLnNldCA9IEJQLnNldFxuXG4gIGFyci53cml0ZSA9IEJQLndyaXRlXG4gIGFyci50b1N0cmluZyA9IEJQLnRvU3RyaW5nXG4gIGFyci50b0xvY2FsZVN0cmluZyA9IEJQLnRvU3RyaW5nXG4gIGFyci50b0pTT04gPSBCUC50b0pTT05cbiAgYXJyLmVxdWFscyA9IEJQLmVxdWFsc1xuICBhcnIuY29tcGFyZSA9IEJQLmNvbXBhcmVcbiAgYXJyLmluZGV4T2YgPSBCUC5pbmRleE9mXG4gIGFyci5jb3B5ID0gQlAuY29weVxuICBhcnIuc2xpY2UgPSBCUC5zbGljZVxuICBhcnIucmVhZFVJbnRMRSA9IEJQLnJlYWRVSW50TEVcbiAgYXJyLnJlYWRVSW50QkUgPSBCUC5yZWFkVUludEJFXG4gIGFyci5yZWFkVUludDggPSBCUC5yZWFkVUludDhcbiAgYXJyLnJlYWRVSW50MTZMRSA9IEJQLnJlYWRVSW50MTZMRVxuICBhcnIucmVhZFVJbnQxNkJFID0gQlAucmVhZFVJbnQxNkJFXG4gIGFyci5yZWFkVUludDMyTEUgPSBCUC5yZWFkVUludDMyTEVcbiAgYXJyLnJlYWRVSW50MzJCRSA9IEJQLnJlYWRVSW50MzJCRVxuICBhcnIucmVhZEludExFID0gQlAucmVhZEludExFXG4gIGFyci5yZWFkSW50QkUgPSBCUC5yZWFkSW50QkVcbiAgYXJyLnJlYWRJbnQ4ID0gQlAucmVhZEludDhcbiAgYXJyLnJlYWRJbnQxNkxFID0gQlAucmVhZEludDE2TEVcbiAgYXJyLnJlYWRJbnQxNkJFID0gQlAucmVhZEludDE2QkVcbiAgYXJyLnJlYWRJbnQzMkxFID0gQlAucmVhZEludDMyTEVcbiAgYXJyLnJlYWRJbnQzMkJFID0gQlAucmVhZEludDMyQkVcbiAgYXJyLnJlYWRGbG9hdExFID0gQlAucmVhZEZsb2F0TEVcbiAgYXJyLnJlYWRGbG9hdEJFID0gQlAucmVhZEZsb2F0QkVcbiAgYXJyLnJlYWREb3VibGVMRSA9IEJQLnJlYWREb3VibGVMRVxuICBhcnIucmVhZERvdWJsZUJFID0gQlAucmVhZERvdWJsZUJFXG4gIGFyci53cml0ZVVJbnQ4ID0gQlAud3JpdGVVSW50OFxuICBhcnIud3JpdGVVSW50TEUgPSBCUC53cml0ZVVJbnRMRVxuICBhcnIud3JpdGVVSW50QkUgPSBCUC53cml0ZVVJbnRCRVxuICBhcnIud3JpdGVVSW50MTZMRSA9IEJQLndyaXRlVUludDE2TEVcbiAgYXJyLndyaXRlVUludDE2QkUgPSBCUC53cml0ZVVJbnQxNkJFXG4gIGFyci53cml0ZVVJbnQzMkxFID0gQlAud3JpdGVVSW50MzJMRVxuICBhcnIud3JpdGVVSW50MzJCRSA9IEJQLndyaXRlVUludDMyQkVcbiAgYXJyLndyaXRlSW50TEUgPSBCUC53cml0ZUludExFXG4gIGFyci53cml0ZUludEJFID0gQlAud3JpdGVJbnRCRVxuICBhcnIud3JpdGVJbnQ4ID0gQlAud3JpdGVJbnQ4XG4gIGFyci53cml0ZUludDE2TEUgPSBCUC53cml0ZUludDE2TEVcbiAgYXJyLndyaXRlSW50MTZCRSA9IEJQLndyaXRlSW50MTZCRVxuICBhcnIud3JpdGVJbnQzMkxFID0gQlAud3JpdGVJbnQzMkxFXG4gIGFyci53cml0ZUludDMyQkUgPSBCUC53cml0ZUludDMyQkVcbiAgYXJyLndyaXRlRmxvYXRMRSA9IEJQLndyaXRlRmxvYXRMRVxuICBhcnIud3JpdGVGbG9hdEJFID0gQlAud3JpdGVGbG9hdEJFXG4gIGFyci53cml0ZURvdWJsZUxFID0gQlAud3JpdGVEb3VibGVMRVxuICBhcnIud3JpdGVEb3VibGVCRSA9IEJQLndyaXRlRG91YmxlQkVcbiAgYXJyLmZpbGwgPSBCUC5maWxsXG4gIGFyci5pbnNwZWN0ID0gQlAuaW5zcGVjdFxuICBhcnIudG9BcnJheUJ1ZmZlciA9IEJQLnRvQXJyYXlCdWZmZXJcblxuICByZXR1cm4gYXJyXG59XG5cbnZhciBJTlZBTElEX0JBU0U2NF9SRSA9IC9bXitcXC8wLTlBLVphLXotX10vZ1xuXG5mdW5jdGlvbiBiYXNlNjRjbGVhbiAoc3RyKSB7XG4gIC8vIE5vZGUgc3RyaXBzIG91dCBpbnZhbGlkIGNoYXJhY3RlcnMgbGlrZSBcXG4gYW5kIFxcdCBmcm9tIHRoZSBzdHJpbmcsIGJhc2U2NC1qcyBkb2VzIG5vdFxuICBzdHIgPSBzdHJpbmd0cmltKHN0cikucmVwbGFjZShJTlZBTElEX0JBU0U2NF9SRSwgJycpXG4gIC8vIE5vZGUgY29udmVydHMgc3RyaW5ncyB3aXRoIGxlbmd0aCA8IDIgdG8gJydcbiAgaWYgKHN0ci5sZW5ndGggPCAyKSByZXR1cm4gJydcbiAgLy8gTm9kZSBhbGxvd3MgZm9yIG5vbi1wYWRkZWQgYmFzZTY0IHN0cmluZ3MgKG1pc3NpbmcgdHJhaWxpbmcgPT09KSwgYmFzZTY0LWpzIGRvZXMgbm90XG4gIHdoaWxlIChzdHIubGVuZ3RoICUgNCAhPT0gMCkge1xuICAgIHN0ciA9IHN0ciArICc9J1xuICB9XG4gIHJldHVybiBzdHJcbn1cblxuZnVuY3Rpb24gc3RyaW5ndHJpbSAoc3RyKSB7XG4gIGlmIChzdHIudHJpbSkgcmV0dXJuIHN0ci50cmltKClcbiAgcmV0dXJuIHN0ci5yZXBsYWNlKC9eXFxzK3xcXHMrJC9nLCAnJylcbn1cblxuZnVuY3Rpb24gdG9IZXggKG4pIHtcbiAgaWYgKG4gPCAxNikgcmV0dXJuICcwJyArIG4udG9TdHJpbmcoMTYpXG4gIHJldHVybiBuLnRvU3RyaW5nKDE2KVxufVxuXG5mdW5jdGlvbiB1dGY4VG9CeXRlcyAoc3RyaW5nLCB1bml0cykge1xuICB1bml0cyA9IHVuaXRzIHx8IEluZmluaXR5XG4gIHZhciBjb2RlUG9pbnRcbiAgdmFyIGxlbmd0aCA9IHN0cmluZy5sZW5ndGhcbiAgdmFyIGxlYWRTdXJyb2dhdGUgPSBudWxsXG4gIHZhciBieXRlcyA9IFtdXG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgIGNvZGVQb2ludCA9IHN0cmluZy5jaGFyQ29kZUF0KGkpXG5cbiAgICAvLyBpcyBzdXJyb2dhdGUgY29tcG9uZW50XG4gICAgaWYgKGNvZGVQb2ludCA+IDB4RDdGRiAmJiBjb2RlUG9pbnQgPCAweEUwMDApIHtcbiAgICAgIC8vIGxhc3QgY2hhciB3YXMgYSBsZWFkXG4gICAgICBpZiAoIWxlYWRTdXJyb2dhdGUpIHtcbiAgICAgICAgLy8gbm8gbGVhZCB5ZXRcbiAgICAgICAgaWYgKGNvZGVQb2ludCA+IDB4REJGRikge1xuICAgICAgICAgIC8vIHVuZXhwZWN0ZWQgdHJhaWxcbiAgICAgICAgICBpZiAoKHVuaXRzIC09IDMpID4gLTEpIGJ5dGVzLnB1c2goMHhFRiwgMHhCRiwgMHhCRClcbiAgICAgICAgICBjb250aW51ZVxuICAgICAgICB9IGVsc2UgaWYgKGkgKyAxID09PSBsZW5ndGgpIHtcbiAgICAgICAgICAvLyB1bnBhaXJlZCBsZWFkXG4gICAgICAgICAgaWYgKCh1bml0cyAtPSAzKSA+IC0xKSBieXRlcy5wdXNoKDB4RUYsIDB4QkYsIDB4QkQpXG4gICAgICAgICAgY29udGludWVcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHZhbGlkIGxlYWRcbiAgICAgICAgbGVhZFN1cnJvZ2F0ZSA9IGNvZGVQb2ludFxuXG4gICAgICAgIGNvbnRpbnVlXG4gICAgICB9XG5cbiAgICAgIC8vIDIgbGVhZHMgaW4gYSByb3dcbiAgICAgIGlmIChjb2RlUG9pbnQgPCAweERDMDApIHtcbiAgICAgICAgaWYgKCh1bml0cyAtPSAzKSA+IC0xKSBieXRlcy5wdXNoKDB4RUYsIDB4QkYsIDB4QkQpXG4gICAgICAgIGxlYWRTdXJyb2dhdGUgPSBjb2RlUG9pbnRcbiAgICAgICAgY29udGludWVcbiAgICAgIH1cblxuICAgICAgLy8gdmFsaWQgc3Vycm9nYXRlIHBhaXJcbiAgICAgIGNvZGVQb2ludCA9IChsZWFkU3Vycm9nYXRlIC0gMHhEODAwIDw8IDEwIHwgY29kZVBvaW50IC0gMHhEQzAwKSArIDB4MTAwMDBcbiAgICB9IGVsc2UgaWYgKGxlYWRTdXJyb2dhdGUpIHtcbiAgICAgIC8vIHZhbGlkIGJtcCBjaGFyLCBidXQgbGFzdCBjaGFyIHdhcyBhIGxlYWRcbiAgICAgIGlmICgodW5pdHMgLT0gMykgPiAtMSkgYnl0ZXMucHVzaCgweEVGLCAweEJGLCAweEJEKVxuICAgIH1cblxuICAgIGxlYWRTdXJyb2dhdGUgPSBudWxsXG5cbiAgICAvLyBlbmNvZGUgdXRmOFxuICAgIGlmIChjb2RlUG9pbnQgPCAweDgwKSB7XG4gICAgICBpZiAoKHVuaXRzIC09IDEpIDwgMCkgYnJlYWtcbiAgICAgIGJ5dGVzLnB1c2goY29kZVBvaW50KVxuICAgIH0gZWxzZSBpZiAoY29kZVBvaW50IDwgMHg4MDApIHtcbiAgICAgIGlmICgodW5pdHMgLT0gMikgPCAwKSBicmVha1xuICAgICAgYnl0ZXMucHVzaChcbiAgICAgICAgY29kZVBvaW50ID4+IDB4NiB8IDB4QzAsXG4gICAgICAgIGNvZGVQb2ludCAmIDB4M0YgfCAweDgwXG4gICAgICApXG4gICAgfSBlbHNlIGlmIChjb2RlUG9pbnQgPCAweDEwMDAwKSB7XG4gICAgICBpZiAoKHVuaXRzIC09IDMpIDwgMCkgYnJlYWtcbiAgICAgIGJ5dGVzLnB1c2goXG4gICAgICAgIGNvZGVQb2ludCA+PiAweEMgfCAweEUwLFxuICAgICAgICBjb2RlUG9pbnQgPj4gMHg2ICYgMHgzRiB8IDB4ODAsXG4gICAgICAgIGNvZGVQb2ludCAmIDB4M0YgfCAweDgwXG4gICAgICApXG4gICAgfSBlbHNlIGlmIChjb2RlUG9pbnQgPCAweDExMDAwMCkge1xuICAgICAgaWYgKCh1bml0cyAtPSA0KSA8IDApIGJyZWFrXG4gICAgICBieXRlcy5wdXNoKFxuICAgICAgICBjb2RlUG9pbnQgPj4gMHgxMiB8IDB4RjAsXG4gICAgICAgIGNvZGVQb2ludCA+PiAweEMgJiAweDNGIHwgMHg4MCxcbiAgICAgICAgY29kZVBvaW50ID4+IDB4NiAmIDB4M0YgfCAweDgwLFxuICAgICAgICBjb2RlUG9pbnQgJiAweDNGIHwgMHg4MFxuICAgICAgKVxuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgY29kZSBwb2ludCcpXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGJ5dGVzXG59XG5cbmZ1bmN0aW9uIGFzY2lpVG9CeXRlcyAoc3RyKSB7XG4gIHZhciBieXRlQXJyYXkgPSBbXVxuICBmb3IgKHZhciBpID0gMDsgaSA8IHN0ci5sZW5ndGg7IGkrKykge1xuICAgIC8vIE5vZGUncyBjb2RlIHNlZW1zIHRvIGJlIGRvaW5nIHRoaXMgYW5kIG5vdCAmIDB4N0YuLlxuICAgIGJ5dGVBcnJheS5wdXNoKHN0ci5jaGFyQ29kZUF0KGkpICYgMHhGRilcbiAgfVxuICByZXR1cm4gYnl0ZUFycmF5XG59XG5cbmZ1bmN0aW9uIHV0ZjE2bGVUb0J5dGVzIChzdHIsIHVuaXRzKSB7XG4gIHZhciBjLCBoaSwgbG9cbiAgdmFyIGJ5dGVBcnJheSA9IFtdXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgaSsrKSB7XG4gICAgaWYgKCh1bml0cyAtPSAyKSA8IDApIGJyZWFrXG5cbiAgICBjID0gc3RyLmNoYXJDb2RlQXQoaSlcbiAgICBoaSA9IGMgPj4gOFxuICAgIGxvID0gYyAlIDI1NlxuICAgIGJ5dGVBcnJheS5wdXNoKGxvKVxuICAgIGJ5dGVBcnJheS5wdXNoKGhpKVxuICB9XG5cbiAgcmV0dXJuIGJ5dGVBcnJheVxufVxuXG5mdW5jdGlvbiBiYXNlNjRUb0J5dGVzIChzdHIpIHtcbiAgcmV0dXJuIGJhc2U2NC50b0J5dGVBcnJheShiYXNlNjRjbGVhbihzdHIpKVxufVxuXG5mdW5jdGlvbiBibGl0QnVmZmVyIChzcmMsIGRzdCwgb2Zmc2V0LCBsZW5ndGgpIHtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgIGlmICgoaSArIG9mZnNldCA+PSBkc3QubGVuZ3RoKSB8fCAoaSA+PSBzcmMubGVuZ3RoKSkgYnJlYWtcbiAgICBkc3RbaSArIG9mZnNldF0gPSBzcmNbaV1cbiAgfVxuICByZXR1cm4gaVxufVxuIiwidmFyIGxvb2t1cCA9ICdBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvJztcblxuOyhmdW5jdGlvbiAoZXhwb3J0cykge1xuXHQndXNlIHN0cmljdCc7XG5cbiAgdmFyIEFyciA9ICh0eXBlb2YgVWludDhBcnJheSAhPT0gJ3VuZGVmaW5lZCcpXG4gICAgPyBVaW50OEFycmF5XG4gICAgOiBBcnJheVxuXG5cdHZhciBQTFVTICAgPSAnKycuY2hhckNvZGVBdCgwKVxuXHR2YXIgU0xBU0ggID0gJy8nLmNoYXJDb2RlQXQoMClcblx0dmFyIE5VTUJFUiA9ICcwJy5jaGFyQ29kZUF0KDApXG5cdHZhciBMT1dFUiAgPSAnYScuY2hhckNvZGVBdCgwKVxuXHR2YXIgVVBQRVIgID0gJ0EnLmNoYXJDb2RlQXQoMClcblx0dmFyIFBMVVNfVVJMX1NBRkUgPSAnLScuY2hhckNvZGVBdCgwKVxuXHR2YXIgU0xBU0hfVVJMX1NBRkUgPSAnXycuY2hhckNvZGVBdCgwKVxuXG5cdGZ1bmN0aW9uIGRlY29kZSAoZWx0KSB7XG5cdFx0dmFyIGNvZGUgPSBlbHQuY2hhckNvZGVBdCgwKVxuXHRcdGlmIChjb2RlID09PSBQTFVTIHx8XG5cdFx0ICAgIGNvZGUgPT09IFBMVVNfVVJMX1NBRkUpXG5cdFx0XHRyZXR1cm4gNjIgLy8gJysnXG5cdFx0aWYgKGNvZGUgPT09IFNMQVNIIHx8XG5cdFx0ICAgIGNvZGUgPT09IFNMQVNIX1VSTF9TQUZFKVxuXHRcdFx0cmV0dXJuIDYzIC8vICcvJ1xuXHRcdGlmIChjb2RlIDwgTlVNQkVSKVxuXHRcdFx0cmV0dXJuIC0xIC8vbm8gbWF0Y2hcblx0XHRpZiAoY29kZSA8IE5VTUJFUiArIDEwKVxuXHRcdFx0cmV0dXJuIGNvZGUgLSBOVU1CRVIgKyAyNiArIDI2XG5cdFx0aWYgKGNvZGUgPCBVUFBFUiArIDI2KVxuXHRcdFx0cmV0dXJuIGNvZGUgLSBVUFBFUlxuXHRcdGlmIChjb2RlIDwgTE9XRVIgKyAyNilcblx0XHRcdHJldHVybiBjb2RlIC0gTE9XRVIgKyAyNlxuXHR9XG5cblx0ZnVuY3Rpb24gYjY0VG9CeXRlQXJyYXkgKGI2NCkge1xuXHRcdHZhciBpLCBqLCBsLCB0bXAsIHBsYWNlSG9sZGVycywgYXJyXG5cblx0XHRpZiAoYjY0Lmxlbmd0aCAlIDQgPiAwKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgc3RyaW5nLiBMZW5ndGggbXVzdCBiZSBhIG11bHRpcGxlIG9mIDQnKVxuXHRcdH1cblxuXHRcdC8vIHRoZSBudW1iZXIgb2YgZXF1YWwgc2lnbnMgKHBsYWNlIGhvbGRlcnMpXG5cdFx0Ly8gaWYgdGhlcmUgYXJlIHR3byBwbGFjZWhvbGRlcnMsIHRoYW4gdGhlIHR3byBjaGFyYWN0ZXJzIGJlZm9yZSBpdFxuXHRcdC8vIHJlcHJlc2VudCBvbmUgYnl0ZVxuXHRcdC8vIGlmIHRoZXJlIGlzIG9ubHkgb25lLCB0aGVuIHRoZSB0aHJlZSBjaGFyYWN0ZXJzIGJlZm9yZSBpdCByZXByZXNlbnQgMiBieXRlc1xuXHRcdC8vIHRoaXMgaXMganVzdCBhIGNoZWFwIGhhY2sgdG8gbm90IGRvIGluZGV4T2YgdHdpY2Vcblx0XHR2YXIgbGVuID0gYjY0Lmxlbmd0aFxuXHRcdHBsYWNlSG9sZGVycyA9ICc9JyA9PT0gYjY0LmNoYXJBdChsZW4gLSAyKSA/IDIgOiAnPScgPT09IGI2NC5jaGFyQXQobGVuIC0gMSkgPyAxIDogMFxuXG5cdFx0Ly8gYmFzZTY0IGlzIDQvMyArIHVwIHRvIHR3byBjaGFyYWN0ZXJzIG9mIHRoZSBvcmlnaW5hbCBkYXRhXG5cdFx0YXJyID0gbmV3IEFycihiNjQubGVuZ3RoICogMyAvIDQgLSBwbGFjZUhvbGRlcnMpXG5cblx0XHQvLyBpZiB0aGVyZSBhcmUgcGxhY2Vob2xkZXJzLCBvbmx5IGdldCB1cCB0byB0aGUgbGFzdCBjb21wbGV0ZSA0IGNoYXJzXG5cdFx0bCA9IHBsYWNlSG9sZGVycyA+IDAgPyBiNjQubGVuZ3RoIC0gNCA6IGI2NC5sZW5ndGhcblxuXHRcdHZhciBMID0gMFxuXG5cdFx0ZnVuY3Rpb24gcHVzaCAodikge1xuXHRcdFx0YXJyW0wrK10gPSB2XG5cdFx0fVxuXG5cdFx0Zm9yIChpID0gMCwgaiA9IDA7IGkgPCBsOyBpICs9IDQsIGogKz0gMykge1xuXHRcdFx0dG1wID0gKGRlY29kZShiNjQuY2hhckF0KGkpKSA8PCAxOCkgfCAoZGVjb2RlKGI2NC5jaGFyQXQoaSArIDEpKSA8PCAxMikgfCAoZGVjb2RlKGI2NC5jaGFyQXQoaSArIDIpKSA8PCA2KSB8IGRlY29kZShiNjQuY2hhckF0KGkgKyAzKSlcblx0XHRcdHB1c2goKHRtcCAmIDB4RkYwMDAwKSA+PiAxNilcblx0XHRcdHB1c2goKHRtcCAmIDB4RkYwMCkgPj4gOClcblx0XHRcdHB1c2godG1wICYgMHhGRilcblx0XHR9XG5cblx0XHRpZiAocGxhY2VIb2xkZXJzID09PSAyKSB7XG5cdFx0XHR0bXAgPSAoZGVjb2RlKGI2NC5jaGFyQXQoaSkpIDw8IDIpIHwgKGRlY29kZShiNjQuY2hhckF0KGkgKyAxKSkgPj4gNClcblx0XHRcdHB1c2godG1wICYgMHhGRilcblx0XHR9IGVsc2UgaWYgKHBsYWNlSG9sZGVycyA9PT0gMSkge1xuXHRcdFx0dG1wID0gKGRlY29kZShiNjQuY2hhckF0KGkpKSA8PCAxMCkgfCAoZGVjb2RlKGI2NC5jaGFyQXQoaSArIDEpKSA8PCA0KSB8IChkZWNvZGUoYjY0LmNoYXJBdChpICsgMikpID4+IDIpXG5cdFx0XHRwdXNoKCh0bXAgPj4gOCkgJiAweEZGKVxuXHRcdFx0cHVzaCh0bXAgJiAweEZGKVxuXHRcdH1cblxuXHRcdHJldHVybiBhcnJcblx0fVxuXG5cdGZ1bmN0aW9uIHVpbnQ4VG9CYXNlNjQgKHVpbnQ4KSB7XG5cdFx0dmFyIGksXG5cdFx0XHRleHRyYUJ5dGVzID0gdWludDgubGVuZ3RoICUgMywgLy8gaWYgd2UgaGF2ZSAxIGJ5dGUgbGVmdCwgcGFkIDIgYnl0ZXNcblx0XHRcdG91dHB1dCA9IFwiXCIsXG5cdFx0XHR0ZW1wLCBsZW5ndGhcblxuXHRcdGZ1bmN0aW9uIGVuY29kZSAobnVtKSB7XG5cdFx0XHRyZXR1cm4gbG9va3VwLmNoYXJBdChudW0pXG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gdHJpcGxldFRvQmFzZTY0IChudW0pIHtcblx0XHRcdHJldHVybiBlbmNvZGUobnVtID4+IDE4ICYgMHgzRikgKyBlbmNvZGUobnVtID4+IDEyICYgMHgzRikgKyBlbmNvZGUobnVtID4+IDYgJiAweDNGKSArIGVuY29kZShudW0gJiAweDNGKVxuXHRcdH1cblxuXHRcdC8vIGdvIHRocm91Z2ggdGhlIGFycmF5IGV2ZXJ5IHRocmVlIGJ5dGVzLCB3ZSdsbCBkZWFsIHdpdGggdHJhaWxpbmcgc3R1ZmYgbGF0ZXJcblx0XHRmb3IgKGkgPSAwLCBsZW5ndGggPSB1aW50OC5sZW5ndGggLSBleHRyYUJ5dGVzOyBpIDwgbGVuZ3RoOyBpICs9IDMpIHtcblx0XHRcdHRlbXAgPSAodWludDhbaV0gPDwgMTYpICsgKHVpbnQ4W2kgKyAxXSA8PCA4KSArICh1aW50OFtpICsgMl0pXG5cdFx0XHRvdXRwdXQgKz0gdHJpcGxldFRvQmFzZTY0KHRlbXApXG5cdFx0fVxuXG5cdFx0Ly8gcGFkIHRoZSBlbmQgd2l0aCB6ZXJvcywgYnV0IG1ha2Ugc3VyZSB0byBub3QgZm9yZ2V0IHRoZSBleHRyYSBieXRlc1xuXHRcdHN3aXRjaCAoZXh0cmFCeXRlcykge1xuXHRcdFx0Y2FzZSAxOlxuXHRcdFx0XHR0ZW1wID0gdWludDhbdWludDgubGVuZ3RoIC0gMV1cblx0XHRcdFx0b3V0cHV0ICs9IGVuY29kZSh0ZW1wID4+IDIpXG5cdFx0XHRcdG91dHB1dCArPSBlbmNvZGUoKHRlbXAgPDwgNCkgJiAweDNGKVxuXHRcdFx0XHRvdXRwdXQgKz0gJz09J1xuXHRcdFx0XHRicmVha1xuXHRcdFx0Y2FzZSAyOlxuXHRcdFx0XHR0ZW1wID0gKHVpbnQ4W3VpbnQ4Lmxlbmd0aCAtIDJdIDw8IDgpICsgKHVpbnQ4W3VpbnQ4Lmxlbmd0aCAtIDFdKVxuXHRcdFx0XHRvdXRwdXQgKz0gZW5jb2RlKHRlbXAgPj4gMTApXG5cdFx0XHRcdG91dHB1dCArPSBlbmNvZGUoKHRlbXAgPj4gNCkgJiAweDNGKVxuXHRcdFx0XHRvdXRwdXQgKz0gZW5jb2RlKCh0ZW1wIDw8IDIpICYgMHgzRilcblx0XHRcdFx0b3V0cHV0ICs9ICc9J1xuXHRcdFx0XHRicmVha1xuXHRcdH1cblxuXHRcdHJldHVybiBvdXRwdXRcblx0fVxuXG5cdGV4cG9ydHMudG9CeXRlQXJyYXkgPSBiNjRUb0J5dGVBcnJheVxuXHRleHBvcnRzLmZyb21CeXRlQXJyYXkgPSB1aW50OFRvQmFzZTY0XG59KHR5cGVvZiBleHBvcnRzID09PSAndW5kZWZpbmVkJyA/ICh0aGlzLmJhc2U2NGpzID0ge30pIDogZXhwb3J0cykpXG4iLCJleHBvcnRzLnJlYWQgPSBmdW5jdGlvbiAoYnVmZmVyLCBvZmZzZXQsIGlzTEUsIG1MZW4sIG5CeXRlcykge1xuICB2YXIgZSwgbVxuICB2YXIgZUxlbiA9IG5CeXRlcyAqIDggLSBtTGVuIC0gMVxuICB2YXIgZU1heCA9ICgxIDw8IGVMZW4pIC0gMVxuICB2YXIgZUJpYXMgPSBlTWF4ID4+IDFcbiAgdmFyIG5CaXRzID0gLTdcbiAgdmFyIGkgPSBpc0xFID8gKG5CeXRlcyAtIDEpIDogMFxuICB2YXIgZCA9IGlzTEUgPyAtMSA6IDFcbiAgdmFyIHMgPSBidWZmZXJbb2Zmc2V0ICsgaV1cblxuICBpICs9IGRcblxuICBlID0gcyAmICgoMSA8PCAoLW5CaXRzKSkgLSAxKVxuICBzID4+PSAoLW5CaXRzKVxuICBuQml0cyArPSBlTGVuXG4gIGZvciAoOyBuQml0cyA+IDA7IGUgPSBlICogMjU2ICsgYnVmZmVyW29mZnNldCArIGldLCBpICs9IGQsIG5CaXRzIC09IDgpIHt9XG5cbiAgbSA9IGUgJiAoKDEgPDwgKC1uQml0cykpIC0gMSlcbiAgZSA+Pj0gKC1uQml0cylcbiAgbkJpdHMgKz0gbUxlblxuICBmb3IgKDsgbkJpdHMgPiAwOyBtID0gbSAqIDI1NiArIGJ1ZmZlcltvZmZzZXQgKyBpXSwgaSArPSBkLCBuQml0cyAtPSA4KSB7fVxuXG4gIGlmIChlID09PSAwKSB7XG4gICAgZSA9IDEgLSBlQmlhc1xuICB9IGVsc2UgaWYgKGUgPT09IGVNYXgpIHtcbiAgICByZXR1cm4gbSA/IE5hTiA6ICgocyA/IC0xIDogMSkgKiBJbmZpbml0eSlcbiAgfSBlbHNlIHtcbiAgICBtID0gbSArIE1hdGgucG93KDIsIG1MZW4pXG4gICAgZSA9IGUgLSBlQmlhc1xuICB9XG4gIHJldHVybiAocyA/IC0xIDogMSkgKiBtICogTWF0aC5wb3coMiwgZSAtIG1MZW4pXG59XG5cbmV4cG9ydHMud3JpdGUgPSBmdW5jdGlvbiAoYnVmZmVyLCB2YWx1ZSwgb2Zmc2V0LCBpc0xFLCBtTGVuLCBuQnl0ZXMpIHtcbiAgdmFyIGUsIG0sIGNcbiAgdmFyIGVMZW4gPSBuQnl0ZXMgKiA4IC0gbUxlbiAtIDFcbiAgdmFyIGVNYXggPSAoMSA8PCBlTGVuKSAtIDFcbiAgdmFyIGVCaWFzID0gZU1heCA+PiAxXG4gIHZhciBydCA9IChtTGVuID09PSAyMyA/IE1hdGgucG93KDIsIC0yNCkgLSBNYXRoLnBvdygyLCAtNzcpIDogMClcbiAgdmFyIGkgPSBpc0xFID8gMCA6IChuQnl0ZXMgLSAxKVxuICB2YXIgZCA9IGlzTEUgPyAxIDogLTFcbiAgdmFyIHMgPSB2YWx1ZSA8IDAgfHwgKHZhbHVlID09PSAwICYmIDEgLyB2YWx1ZSA8IDApID8gMSA6IDBcblxuICB2YWx1ZSA9IE1hdGguYWJzKHZhbHVlKVxuXG4gIGlmIChpc05hTih2YWx1ZSkgfHwgdmFsdWUgPT09IEluZmluaXR5KSB7XG4gICAgbSA9IGlzTmFOKHZhbHVlKSA/IDEgOiAwXG4gICAgZSA9IGVNYXhcbiAgfSBlbHNlIHtcbiAgICBlID0gTWF0aC5mbG9vcihNYXRoLmxvZyh2YWx1ZSkgLyBNYXRoLkxOMilcbiAgICBpZiAodmFsdWUgKiAoYyA9IE1hdGgucG93KDIsIC1lKSkgPCAxKSB7XG4gICAgICBlLS1cbiAgICAgIGMgKj0gMlxuICAgIH1cbiAgICBpZiAoZSArIGVCaWFzID49IDEpIHtcbiAgICAgIHZhbHVlICs9IHJ0IC8gY1xuICAgIH0gZWxzZSB7XG4gICAgICB2YWx1ZSArPSBydCAqIE1hdGgucG93KDIsIDEgLSBlQmlhcylcbiAgICB9XG4gICAgaWYgKHZhbHVlICogYyA+PSAyKSB7XG4gICAgICBlKytcbiAgICAgIGMgLz0gMlxuICAgIH1cblxuICAgIGlmIChlICsgZUJpYXMgPj0gZU1heCkge1xuICAgICAgbSA9IDBcbiAgICAgIGUgPSBlTWF4XG4gICAgfSBlbHNlIGlmIChlICsgZUJpYXMgPj0gMSkge1xuICAgICAgbSA9ICh2YWx1ZSAqIGMgLSAxKSAqIE1hdGgucG93KDIsIG1MZW4pXG4gICAgICBlID0gZSArIGVCaWFzXG4gICAgfSBlbHNlIHtcbiAgICAgIG0gPSB2YWx1ZSAqIE1hdGgucG93KDIsIGVCaWFzIC0gMSkgKiBNYXRoLnBvdygyLCBtTGVuKVxuICAgICAgZSA9IDBcbiAgICB9XG4gIH1cblxuICBmb3IgKDsgbUxlbiA+PSA4OyBidWZmZXJbb2Zmc2V0ICsgaV0gPSBtICYgMHhmZiwgaSArPSBkLCBtIC89IDI1NiwgbUxlbiAtPSA4KSB7fVxuXG4gIGUgPSAoZSA8PCBtTGVuKSB8IG1cbiAgZUxlbiArPSBtTGVuXG4gIGZvciAoOyBlTGVuID4gMDsgYnVmZmVyW29mZnNldCArIGldID0gZSAmIDB4ZmYsIGkgKz0gZCwgZSAvPSAyNTYsIGVMZW4gLT0gOCkge31cblxuICBidWZmZXJbb2Zmc2V0ICsgaSAtIGRdIHw9IHMgKiAxMjhcbn1cbiIsInZhciB0b1N0cmluZyA9IHt9LnRvU3RyaW5nO1xuXG5tb2R1bGUuZXhwb3J0cyA9IEFycmF5LmlzQXJyYXkgfHwgZnVuY3Rpb24gKGFycikge1xuICByZXR1cm4gdG9TdHJpbmcuY2FsbChhcnIpID09ICdbb2JqZWN0IEFycmF5XSc7XG59O1xuIiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxudmFyIGV4cGVjdCA9IHJlcXVpcmUoJ2V4cGVjdC5qcycpO1xyXG52YXIgQkFCWUxPTiA9IHJlcXVpcmUoJ2JhYnlsb25qcycpO1xyXG5cclxuZGVzY3JpYmUoJ3ducC9saWIvY29sbGlzaW9uLWdqay1lcGEnLCBmdW5jdGlvbigpIHtcclxuICAgIHZhciBjb2xsaXNpb25uZXIgPSByZXF1aXJlKCcuLi9jb2xsaXNpb24tZ2prLWVwYScpO1xyXG5cclxuICAgIHZhciBwb2ludHMxID0gW107XHJcblxyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBNYXRoLlBJICogMjsgaSArPSBNYXRoLlBJIC8gNCkge1xyXG4gICAgICAgIHBvaW50czEucHVzaChuZXcgQkFCWUxPTi5WZWN0b3IyKE1hdGguY29zKGkpICogMiwgTWF0aC5zaW4oaSkgKiAyKSk7XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIHBvaW50czNkMSA9IFtdO1xyXG4gICAgZm9yIChpID0gMDsgaSA8IE1hdGguUEkgKiAyOyBpICs9IE1hdGguUEkgLzQpIHtcclxuICAgICAgICBmb3IgKHZhciBqID0gTWF0aC5QSSAvIDI7IGogPCAzICogTWF0aC5QSSAvIDI7IGogKz0gTWF0aC5QSSAvNCkge1xyXG4gICAgICAgICAgICBwb2ludHMzZDEucHVzaChuZXcgQkFCWUxPTi5WZWN0b3IzKE1hdGguY29zKGopICogTWF0aC5jb3MoaSkgKiAyLCBNYXRoLmNvcyhqKSAqIE1hdGguc2luKGkpICogMiwgTWF0aC5zaW4oaikgKiAyKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGl0KCdjaGVja3MgaWYgdHdvIGNsb3VkIG9mIHBvaW50IGludGVyc2VjdCBpbiAyZCcsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgMTsgayArPSAwLjMpIHtcclxuICAgICAgICAgICAgdmFyIHBvaW50czIgPSBbXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBNYXRoLlBJICogMjsgaSArPSBNYXRoLlBJIC8gNCkge1xyXG4gICAgICAgICAgICAgICAgcG9pbnRzMi5wdXNoKG5ldyBCQUJZTE9OLlZlY3RvcjIoTWF0aC5jb3MoaSkgKyBrLCBNYXRoLnNpbihpKSArIGspKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZXhwZWN0KGNvbGxpc2lvbm5lci5pc0ludGVyc2VjdGluZyhwb2ludHMxLCBwb2ludHMyKSkudG8uYmUodHJ1ZSk7XHJcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBjb2xsaXNpb25uZXIuaW50ZXJzZWN0KHBvaW50czEsIHBvaW50czIpO1xyXG5cclxuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHBvaW50czIubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHBvaW50czJbaV0uYWRkVG9SZWYocmVzdWx0LCBwb2ludHMyW2ldKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZXhwZWN0KGNvbGxpc2lvbm5lci5pc0ludGVyc2VjdGluZyhwb2ludHMxLCBwb2ludHMyKSkudG8uYmUoZmFsc2UpO1xyXG4gICAgICAgICAgICBleHBlY3QoY29sbGlzaW9ubmVyLmludGVyc2VjdChwb2ludHMxLCBwb2ludHMyKSkudG8uYmUuZXFsKGZhbHNlKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnY2hlY2tzIGlmIHR3byBjbG91ZCBvZiBwb2ludCBub3QgaW50ZXJzZWN0IGluIDJkJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHBvaW50czIgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IE1hdGguUEkgKiAyOyBpICs9IE1hdGguUEkgLyA0KSB7XHJcbiAgICAgICAgICAgIHBvaW50czIucHVzaChuZXcgQkFCWUxPTi5WZWN0b3IyKE1hdGguY29zKGkpICsgMy4xLCBNYXRoLnNpbihpKSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBleHBlY3QoY29sbGlzaW9ubmVyLmlzSW50ZXJzZWN0aW5nKHBvaW50czEsIHBvaW50czIpKS50by5iZShmYWxzZSk7XHJcbiAgICAgICAgZXhwZWN0KGNvbGxpc2lvbm5lci5pbnRlcnNlY3QocG9pbnRzMSwgcG9pbnRzMikpLnRvLmJlLmVxbChmYWxzZSk7XHJcbiAgICB9KTtcclxuXHJcblxyXG5cclxuICAgIGl0KCdjaGVja3MgaWYgdHdvIGNsb3VkIG9mIHBvaW50IGludGVyc2VjdCBpbiAzZCcsIGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IDE7IGsgKz0gMC4zKSB7XHJcbiAgICAgICAgICAgIHZhciBwb2ludHMzZDIgPSBbXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBNYXRoLlBJICogMjsgaSArPSBNYXRoLlBJIC8gNCkge1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IE1hdGguUEkgLyAyOyBqIDwgMyAqIE1hdGguUEkgLyAyOyBqICs9IE1hdGguUEkgLyA0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcG9pbnRzM2QyLnB1c2gobmV3IEJBQllMT04uVmVjdG9yMyhNYXRoLmNvcyhqKSAqIE1hdGguY29zKGkpICsgaywgTWF0aC5jb3MoaikgKiBNYXRoLnNpbihpKSArIGssIE1hdGguc2luKGopICsgaykpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGV4cGVjdChjb2xsaXNpb25uZXIuaXNJbnRlcnNlY3RpbmcocG9pbnRzM2QxLCBwb2ludHMzZDIpKS50by5iZSh0cnVlKTtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGNvbGxpc2lvbm5lci5pbnRlcnNlY3QocG9pbnRzM2QxLCBwb2ludHMzZDIpO1xyXG4gICAgICAgICAgICByZXN1bHQuYWRkVG9SZWYocmVzdWx0LmNsb25lKCkubm9ybWFsaXplKCkuc2NhbGUoMC4wNSksIHJlc3VsdCk7XHJcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBwb2ludHMzZDIubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHBvaW50czNkMltpXS5hZGRUb1JlZihyZXN1bHQsIHBvaW50czNkMltpXSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGV4cGVjdChjb2xsaXNpb25uZXIuaXNJbnRlcnNlY3RpbmcocG9pbnRzM2QxLCBwb2ludHMzZDIpKS50by5iZShmYWxzZSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChjb2xsaXNpb25uZXIuaW50ZXJzZWN0KHBvaW50czNkMSwgcG9pbnRzM2QyKSkudG8uYmUuZXFsKGZhbHNlKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ2NoZWNrcyBpZiB0d28gY2xvdWQgb2YgcG9pbnQgbm90IGludGVyc2VjdCBpbiAzZCcsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBwb2ludHMzZDIgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IE1hdGguUEkgKiAyOyBpICs9IE1hdGguUEkgLyA0KSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGogPSBNYXRoLlBJIC8gMjsgaiA8IDMgKiBNYXRoLlBJIC8gMjsgaiArPSBNYXRoLlBJIC8gNCkge1xyXG4gICAgICAgICAgICAgICAgcG9pbnRzM2QyLnB1c2gobmV3IEJBQllMT04uVmVjdG9yMyhNYXRoLmNvcyhqKSAqIE1hdGguY29zKGkpICsgMy4xLCBNYXRoLmNvcyhqKSAqIE1hdGguc2luKGkpLCBNYXRoLnNpbihqKSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGV4cGVjdChjb2xsaXNpb25uZXIuaXNJbnRlcnNlY3RpbmcocG9pbnRzM2QxLCBwb2ludHMzZDIpKS50by5iZShmYWxzZSk7XHJcbiAgICAgICAgZXhwZWN0KGNvbGxpc2lvbm5lci5pbnRlcnNlY3QocG9pbnRzM2QxLCBwb2ludHMzZDIpKS50by5iZS5lcWwoZmFsc2UpO1xyXG4gICAgfSk7XHJcbn0pOyJdfQ==
