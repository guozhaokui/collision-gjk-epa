!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.Collisiongjkepa=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";var d=function(a,b,c){this.a=a,this.b=b,this.c=c,this.n=a.constructor.Cross(b.subtract(a),c.subtract(a)).normalize()},e={EPSILON:1e-6,_getNormal:function(a,b,c){var d=a.constructor.Dot,e=d(a,c),f=d(b,c),g=b.scale(e).subtract(a.scale(f)).normalize();return g},_getBarycenter:function(a){for(var b=a[0].constructor.Zero(),c=0;c<a.length;c++)b.addToRef(a[c],b);return b.scaleInPlace(1/a.length,b),b},_getFarthestPointInDirection:function(a,b){for(var c=a[0].constructor.Dot,d=c(a[0],b),e=0,f=1;f<a.length;f++){var g=c(a[f],b);g>d&&(d=g,e=f)}return a[e]},_getNearestEdge:function(a){for(var b,c,d=1/0,e=0;e<a.length;e++){var f=(e+1)%a.length,g=a[e],h=a[f],i=h.subtract(g);if(0!==i.lengthSquared()){var j=g,k=this._getNormal(i,j,i);0===k.lengthSquared()&&(k.y=-i.x,k.x=i.y);var l=Math.abs(k.constructor.Dot(k,g));l<d&&(d=l,b=f,c=k)}}return{distance:d,index:b,normal:c}},_getNearestTriangle:function(a){for(var b,c=1/0,d=0;d<a.length;d++){var e=a[d],f=Math.abs(e.n.constructor.Dot(e.n,e.a));f<c&&(c=f,b=d)}return{distance:c,index:b}},_containsLine:function(a,b){var c=a[1],d=a[0],e=d.subtract(c),f=c.scale(-1);return 0!==e.lengthSquared()?b.copyFrom(this._getNormal(e,f,e)):b.copyFrom(f),!1},_containsTriangle:function(a,b){var c=a[2],d=a[2].constructor.Dot,e=a[1],f=a[0],g=e.subtract(c),h=f.subtract(c),i=c.scale(-1),j=this._getNormal(h,g,g),k=this._getNormal(g,h,h);if(d(j,i)>0)a.splice(0,1),b.copyFrom(j);else{if(!(d(k,i)>0)){if(void 0===b.z)return!0;var l=a[2].constructor.Cross(g,h);return b.copyFrom(l),d(l,i)<=0&&(a[0]=e,a[1]=f,a[2]=c,b.copyFrom(l.scale(-1))),!1}a.splice(1,1),b.copyFrom(k)}},_containsTetrahedron:function(a,b){var c=a[3],d=c.constructor.Dot,e=c.constructor.Cross,f=a[2],g=a[1],h=a[0],i=f.subtract(c),j=g.subtract(c),k=h.subtract(c),l=c.scale(-1),m=e(i,j),n=e(j,k),o=e(k,i),p=1,q=2,r=4,s=(d(m,l)>0?p:0)|(d(n,l)>0?q:0)|(d(o,l)>0?r:0);switch(s){case p:return this._checkTetrahedron(l,i,j,m,b,a);case q:return a[2]=g,a[1]=h,this._checkTetrahedron(l,j,k,n,b,a);case r:return a[1]=f,a[2]=h,this._checkTetrahedron(l,k,i,o,b,a);case p|q:return this._checkTwoTetrahedron(l,i,j,m,b,a);case q|r:return a[2]=g,a[1]=h,a[0]=f,this._checkTwoTetrahedron(l,j,k,n,b,a);case r|p:return a[1]=f,a[2]=h,a[0]=g,this._checkTwoTetrahedron(l,k,i,o,b,a)}return!0},_checkTwoTetrahedron:function(a,b,c,d,e,f){var g=d.constructor.Cross(d,c);if(g.constructor.Dot(g,a)>0)return f[2]=f[1],f[1]=f[0],b=f[2].subtract(f[3]),c=f[1].subtract(f[3]),d=b.constructor.Cross(b,c),this._checkTetrahedron(a,b,c,d,e,f);var h=d.constructor.Cross(b,d);return h.constructor.Dot(h,a)>0?(f.splice(0,2),e.copyFrom(this._getNormal(b,a,b)),!1):void 0},_checkTetrahedron:function(a,b,c,d,e,f){var g=d.constructor.Cross(d,c);if(g.constructor.Dot(g,a)>0)return f[2]=f[3],f.splice(3,1),f.splice(0,1),e.copyFrom(this._getNormal(c,a,c)),!1;var h=b.constructor.Cross(b,d);return h.constructor.Dot(h,a)>0?(f.splice(0,2),e.copyFrom(this._getNormal(b,a,b)),!1):(f.splice(0,1),e.copyFrom(d),!1)},_addEdge:function(a,b){for(var c=0;c<a.length;c++)if(a[c].a===b.b&&a[c].b===b.a)return void a.splice(c,1);a.push(b)},support:function(a,b,c){c.normalize();var d=this._getFarthestPointInDirection(a,c),e=this._getFarthestPointInDirection(b,c.scale(-1)),f=d.subtract(e);return f},containsOrigin:function(a,b){return 2===a.length?this._containsLine(a,b):3===a.length?this._containsTriangle(a,b):4===a.length&&this._containsTetrahedron(a,b)},check:function(a,b){var c,d=0,e=[],f=this._getBarycenter(a),g=this._getBarycenter(b),h=f.subtract(g).normalize();if(h.lengthSquared()<this.EPSILON&&(h.x=1),c=e[0]=this.support(a,b,h),c.constructor.Dot(c,h)<=0)return!1;h.scaleInPlace(-1,h);for(var i=b.length*a.length;d<i;){if(0===h.lengthSquared()&&e.length>=2){h=e[e.length-1].subtract(e[e.length-2]);var j=h.y;h.y=-h.x,h.x=j}if(c=this.support(a,b,h),c.constructor.Dot(c,h)<=0)return!1;if(e.push(c),this.containsOrigin(e,h))return e;d++}},findResponseWithEdge:function(a,b,c){var d=this._getNearestEdge(c),e=this.support(a,b,d.normal),f=Math.abs(e.constructor.Dot(e,d.normal));return f-d.distance<=this.EPSILON?d.normal.scale(d.distance):(c.splice(d.index,0,e),!1)},findResponseWithTriangle:function(a,b,c){if(0===c.length)return!1;var e=this._getNearestTriangle(c),f=c[e.index],g=this.support(a,b,f.n),h=Math.abs(g.constructor.Dot(g,f.n));if(h-e.distance<=this.EPSILON)return f.n.scale(e.distance);for(var i=[],j=c.length-1;j>=0;j--)f=c[j],f.n.constructor.Dot(f.n,g.subtract(c[j].a))>0&&(this._addEdge(i,{a:f.a,b:f.b}),this._addEdge(i,{a:f.b,b:f.c}),this._addEdge(i,{a:f.c,b:f.a}),c.splice(j,1));for(var j=0;j<i.length;j++)f=new d(g,i[j].a,i[j].b),0!==f.n.length()&&c.push(f);return!1},getResponse:function(a,b,c){for(var e,f=0,g=void 0!==c[0].z?[new d(c[0],c[1],c[2]),new d(c[0],c[2],c[3]),new d(c[0],c[3],c[1]),new d(c[1],c[3],c[2])]:null,h=b.length*a.length;f<h;){if(e=void 0===c[0].z?this.findResponseWithEdge(a,b,c):this.findResponseWithTriangle(a,b,g)){var i=e.clone().normalize().scaleInPlace(this.EPSILON);return e.addToRef(i,e)}f++}return!1},isIntersecting:function(a,b){return!!this.check(a,b)},intersect:function(a,b){var c=this.check(a,b);return!!c&&this.getResponse(a,b,c)}};b.exports=e},{}]},{},[1])(1)});